     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas RE Interest statement print ICD 1')              *
     F*****************************************************************
     F*                                                               *
     F*  Midas     - Retail Module
     F*                                                               *
     F*  RE3761 - INTEREST STATEMENT PRINT ICD 1                      *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
     F*                                                               *
      *  Last Amend No. MD057283           Date 19May21               *
      *  Prev Amend No. CER050             Date 16Jun19               *
      *                 MD046248           Date 27Oct17               *
      *                 MD038030           Date 01Apr16               *
      *                 MD037149           Date 11May16               *
      *                 CGL165             Date 17Feb15               *
      *                 MD024700           Date 03Apr14               *
      *                 CRE083             Date 06Aug12               *
      *                 CRE075             Date 06Dec10               *
      *                 CER059             Date 19Jul10               *
      *                 BUG26838           Date 18Dec09               *
      *                 BUG23123           Date 09Mar09               *
      *                 CER048             Date 19May08               *
      *                 CER016             Date 19May08               *
      *                 CER047             Date 19May08               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 164890             Date 06Jun06               *
      *                 CDL013             Date 11Jul06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027A            Date 11May06               *
      *                 CSD027             Date 09Dec05               *
      *                 235917             Date 08Sep05               *
      *                 CGL035             Date 01Mar05               *
      *                 CGL031             Date 05Jul04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4.01 -------------------------------------------*
      *                 194059             Date 06Aug01               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 195835             Date 23Jul01               *
      *                 182452             Date 20Jun01               *
      *                 CDE002             Date 21Dec99               *
      * Midas DBA 3.05 -----------------------------------------------*
      * Midas DBA 3.03 -----------------------------------------------*
      *                 143079             Date 08Nov99               *
      * Midas DBA 3.02 -----------------------------------------------*
      *                 CFT004             Date 27Jul99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*                 153001             Date 26Apr99               *
     F*                 130468             Date 29Apr99               *
     F*                 104618             DATE 19May98               *
     F*                 125176             DATE 10Feb98               *
     F*                 121125             DATE 09Feb98               *
     F*                 105294             DATE 05SEP97               *
     F*                 CRE001             Date 18Feb97               *
     F*                 CRE003             Date 10JUN96               *
     F*                 098818             DATE 15APR96               *
     F*                 S01408             DATE 16APR96               *
     F*                 088762             DATE 24OCT95               *
     F*                 085171             DATE 03APR95               *
     F*                 099505             DATE 26FEB96               *
     F*                 094663             DATE 26NOV95               *
     F*                 094674             DATE 26NOV95               *
     F*                 094657             DATE 25NOV95               *
     F*                 094337             DATE 18NOV95               *
     F*                 094431             DATE 16OCT95               *
     F*                 086087             DATE 22AUG95               *
     F*                 085713             DATE 06Apr95               *
     F*                 075075             DATE 08AUG94               *
     F*                 085250             DATE 13APR95               *
     F*                 064051      BT     DATE 07MAR94               *
     F*                 058684      BT     DATE 07MAR94               *
     F*                 040447             DATE 28SEP93               *
     F*                 S01413 *CREATE     DATE 13APR93               *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
      *  MD057283 - If initial threshold is specified on the interest *
      *             calc. type,calculation of interest will only start*
      *             when balance exceeds initial threshold. Interest  *
      *             rates on this part of the report should be shown  *
      *             as zero since no interest is calculated.          *
      *  CER050 - Annualised Percentage Rate                          *
      *  MD046248 - Finastra Rebranding                               *
      *  MD038030 - With CFT004 on, address is not printed on         *
      *             statement. Use a different variable for CRE083.   *
      *  MD037149 - ORF Queries not running (Recompile)               *
      *  CGL165 - Dual Withholding Tax (Recompile)                    *
      *  MD024700 - Recompile due to changes in RE3764CR, RE3764DR,   *
      *             and RE3765CH.                                     *
      *  CRE083 - COB Restructure - RE COB Optimisation Phase 1       *
      *  CRE075 - Effective Date for Retail Accounts (Recompile)      *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  BUG26838 - RE3764CR did not show 3rd tax details             *
      *  BUG23123 - Report: Does not show Retail Account Number       *
      *                     Date is not Midas Standard Date           *
      *                     Period should be actual int. calc. period *
      *                     Secondary Tax amount is not printed       *
      *                     Added field TSSLID                        *
      *                     (Recompile)                               *
      *  CER048 - German Features - Taxes                             *
      *  CER016 - German Interest Calculation: Upgrade of FGE059      *
      *           to Midas Plus                                       *
      *  CER047 - German Features LF037-00 Reporting §24c KWG         *
      *           (Recompile)                                         *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (Recompile)                                         *
      *  164890 - CPF5075 is encountered: Changed field is not a      *
      *           correct zoned decimal number.                       *
      *           143079 incomplete.                                  *
      *  CDL013 - Tiered Withholding Tax                              *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027A - Conversion Of Customer Number to Alpha             *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  235917 - No EU tax printed for joint accounts                *
      *  CGL035 - EUSD Upgrade to MidasPlus                           *
      *  CGL031 - Taxation of Savings Income                          *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  194059 - Rename TRAT in files REHRDJ and REHRCJ.             *
      *  195835 - Add a DUMP in DBSR                                  *
      *  182452 - Errors on the Retail Interest capitalisation        *
      *           report for interest types 03 and 04.  Amendments    *
      *           include:                                            *
      *           1. move the history balance to the output field     *
      *              to display the running balance every change in   *
      *              value date.                                      *
      *           2. for int. types 03 and 04, print only the no. of  *
      *              days and the running balance in the subtotal.    *
      *           3. checked the interest types (DCICT/DDICT) from    *
      *              REHISL instead of the RECAPM to avoid errors     *
      *              when there is a change of interest types between *
      *              capitalisations.                                 *
      *           4. Prevent DBError at 22 in REHRCJ.                 *
      *              Applied fix 183573.                              *
      *           5. Prevent DBError at 09, 06, 04 and 02 in REHISL.  *
      *              Applied fix 194056.                              *
      *  CDE002 - Revenue Analysis - Recompiled due to changes in     *
      *           PF/RETAXJL.                                         *
     F*  143079 - I/O error - initialise fields.                      *
      *  CFT004 - Straight Through Processing Phase 2                 *
      *           International Bank Account Numbers (IBAN)           *
     F*  153001 - A/c failed to close because minimum charge posted   *
     F*           so balance was not zero. For closure capitalisation *
     F*           no rebate or minimum/maximum charge is applied.     *
     F*  130468 - BRT not deducted from CR interest adjustments.      *
     F*  104618 - Choose correct BRT rate in same way as RE3664.      *
     F*  125176 - Correct errors found when comparing RE3763 reports. *
     F*           1) Correct charges report (various errors).         *
     F*           2) Ensure opening rate shown correctly when start   *
     F*              point is a/c header history record.              *
     F*           3) Correct reporting of alternative account.        *
     F*           4) Use correct narrative for CR interest adjustment.*
     F*           5) Correct manual adjustment processing.            *
     F*           6) Ensure 1st interest line is printed.             *
     F*           7) Prevent wrong amount of interest being reported  *
     F*              when interim cap. record encountered.            *
     F*           8) Make reporting of generated adjs. consistent and *
     F*              in correct date sequence, and also report them   *
     F*              for DR/CR only non-management cap.               *
     F*           9) Correct date checks for backvalued entries and   *
     F*              ensure dates & narr. reported for rate change.   *
     F*          10) Remove redundant code in CRSR & DRSR.            *
     F*          11) Correct wrong no. of days reported when 'B' rec. *
     F*              is start point for the other side (both cap.).   *
     F*           Use 'For balances over' narrative against initial   *
     F*           threshold for debit rates. (104306)                 *
     F*           Posting displayed with wrong sign due to DRCR from  *
     F*           manual adjustment being used. (102649)              *
     F*           1) Opening rate/rate changes reported incorrectly   *
     F*           if interest type is changed. (102646)               *
     F*           2) Interest sometimes incorrect for both DR & CR    *
     F*           cap.; pgm should subtract interest reported so far  *
     F*           instead of interest from previous hist. rec.(102646)*
     F*           Back valued postings displayed twice for both DR &  *
     F*           CR cap. with different last cap. dates. Also no     *
     F*           check on the date when reporting manual adjustments.*
     F*           Also interest reported work fields not initialised  *
     F*           causing incorrect interest. (102645)                *
     F*           1) Opening balance not reported for DR only cap.    *
     F*           2) Missing initial days/product/int. line. (102643) *
     F*           1st line of tiered/threshold rate displayed twice   *
     F*           on debit report. (102642)                           *
     F*  121125 - Generated adjustment still shows on OSIC (with      *
     F*           opposite sign) after being posted. CSGADI & CSGACI  *
     F*           now output to RECAPM instead of REHISPS so ensure   *
     F*           they are correctly reported by this pgm.            *
     F*  105294 -  This report can fail on a DB error but not stop    *
     F*            the COB. Review U7U8LR processing.                 *
     F*  CRE001 - Overdraft Interest Calculations:                    *
     F*         - Include changes to O/D Line and Additional O/D Rate *
     F*           to report.                                          *
     F*  CRE003 -  Ledger Balance Accruals                             *
     F*  098818 - Allow for interest capital indicator on REHISPS     *
     F*           to retain its original values of 'C' 'D' 'Y' &      *
     F*           ' ' to be used by input cycle enquiries.            *
     F*  S01408 -  Addition of hook RE3761CCP2                        *
     F*            Addition of hook RE3761CCP1                        *
     F*  088762 -  History posting for the start of the next          *
     F*            capitalization period is being process for the     *
     F*            current period causing an extra line to be printed.*
     F*  085171 -  Work fields not reset - balance printed from       *
     F*            previous account.                                  *
     F*         -  Line 'Total' sometimes printed with amount = 0     *
     F*  099505 - BRT amount coming out as negative causing total CR  *
     F*           interest to be incorrect. (Caused by 094337.)       *
     F*  094663 - Detail line occasionally output twice in error.     *
     F*  094674 - Ensure 'CR' is printed for all credit amounts.      *
     F*           Otherwise blank (never DR or -).                    *
     F*  094657 - Suppress customer address details if specified.     *
     F*  094337 - Amend 085713 to output heading directly without     *
     F*           setting overflow, to avoid double heading output.   *
     F*         - Incorporate Lux fixes to bring program up to date.  *
     F*          - Total interest does not include adjustment.        *
     F*          - Rounding difference on rebate to Retail II.        *
     F*          - Output correct opening rate.                       *
     F*          - Rate in error when the S record is read.           *
     F*          - Output charges correctly.                          *
     F*          - Alternate account details are not output.          *
     F*          - Wrong narrative output for manual adjustment.      *
     F*         -  Incorrect back value credit in B1LT               *
     F*         -  Output Back Value Rate                             *
     F*         Note - this fix supercedes 085250 which has been      *
     F*                removed                                        *
     F*  094431 - When manual adjustments were printed the interest   *
     F*           from a MADJDR or MADJCR line must be deducted from  *
     F*           the next STOTDR or STOTCR line.                     *
     F*         - Recompiled over changed REHISSL and REHPOPH.        *  *
     F*  086087 - 1. BRT not deducted from total interest.            *
     F*           2. Cannot tell if tiered or threshold interest and  *
     F*              layout difficult to read. Change format to same  *
     F*              as in RE3364E and display 'tiered'/'threshold'.  *
     F*           3. For both DR & CR cap., total DR and CR interest  *
     F*              calculated incorrectly.                          *
     F*           4. No. of days badly aligned (change to PRTFs).     *
     F*           5. If 1st history record read is the 'B' rec. the   *
     F*              start balance may be wrong as the work fields    *
     F*              are not cleared/set up.                          *
     F*  085713 - Headings omitted .                                  *
     F*           Overflow Indicators seton when files opened , to    *
     F*           trigger headings 1st time.                          *
     F*           Detail (charges) print conditioned on CHGT (on REIAC*
     F*           not being 0 .                                       *
     F*           Charges headings only printed when required by print*
     F*           of detail . When detail printed overflow indicator  *
     F*           checked for headings .                              *
     F*  075075 - TOTAL line is sometimes omitted.                    *
     F*         - Remova all references to SR/POSTSR since this was   *
     F*           removed on upgrade to R10 - not annotated.          *
     F*  085250 -  Incorrect back value credit in B1LT               *
     F*         -  Output Back Value Rate                             *
     F*  064041 - Show correct manual adjustement & back value mvt    *
     F*  058684 - Interest sometimes calculated with the balance from *
     F*           previous account                                    *
     F*  040447 - Print the right opening rate (Apply a part of      *
     F*           30119 in RE3762 PGM)                                *
     F*  S01413 - Retail 3 Incorporation                              *
     F*                                                               *
     F*****************************************************************
     F/COPY WNCPYSRC,REH00372
     FRECAPML IF  E           K        DISK
     F/COPY WNCPYSRC,REH00369
     FCLINT   IF  E           K        DISK
     FREHISL  IF  E           K        DISK
     FREHISSL IF  E           K        DISK
     F            REHISPSF                          KRENAMEREADJF
     FRECOM   IF  E           K        DISK
     FREHPOPL IF  E           K        DISK
     F            REHPOSPF                          KRENAMEREHPOPLF
     FREHPOPH IF  E           K        DISK
     F            REHPOSPF                          KRENAMEREHPOPHF
     FACCRACJ IF  E           K        DISK
     FREHRDJ  IF  E           K        DISK
     FREHRCJ  IF  E           K        DISK
     FREHPOML2IF  E           K        DISK
     F*ABTB55*IF**E                    DISK                         085250094337
     FTABTBRE IF  E                    DISK                           UC
     FRECRG   IF  E           K        DISK                               094337
     F            RECRGAF                           KIGNORE               094337
     F            RECRGZF                           KIGNORE               094337
     FSDCURRL0IF  E           K        DISK
     FSDMMODPDIF  E                    DISK
     FRETAXJL IF  E           K        DISK
     FACCNT   IF  E           K        DISK
     FSDBRTDL1IF  E           K        DISK
      *                                                                                       CGL031
     FSDCSINL7IF  E           K        DISK                                                   CGL031
     F                                              KINFSR *PSSR                              CGL031
      ***Midas*SD*Customer*Income*by*Account*Number****                                CGL031 235917
      ** Midas SD Customer Income - Customer Number Retrieve Index                            235917
     FSDCSINLCIF  E           K        DISK         KINFSR *PSSR                              235917
     F            SDCSIND0                          KRENAMESDCSINDC                           235917
      ** Midas SD Customer Income - Joint A/c Number Retrieve Index                           235917
     FSDJACCL1IF  E           K        DISK                                                   235917
      ** Midas SD Joint A/c Member Details - Retrieve Index                                   235917
      *                                                                                       CGL031
     FACCNTBY0IF  E           K        DISK                                                   CER050
     FREAPRHI0IF  E           K        DISK                                                   CER050
     FREAPRHI1IF  E           K        DISK                                                   CER050
     F            REAPRHD0                          KRENAMEREAPRHD1                           CER050
     F/COPY WNCPYSRC,RE3761F003
     FRE3765CHO   E             74     PRINTER      KINFDS SPOOL2     UC
     FRE3764DRO   E             73     PRINTER      KINFDS SPOOL1     UC
     FRE3764CRO   E             75     PRINTER      KINFDS SPOOL      UC
     FRE3764AUO   E             72     PRINTER      KINFDS SPOOLU
     F/COPY WNCPYSRC,RE3761F001
     F*****************************************************************
     F*                                                               *
     F*   F U N C T I O N   O F   I N D I C A T O R S                 *
     F*                                                               *
     F*   01  DEBIT CAPITALISATION                                    *
     F*   02  CREDIT CAPITALISATION                                   *
     F*   20  IN CASE OF BACK VALUE PROCESSING                        *
     F*   22  OUTPUT BRT DETAILS TO REPORT                            *
     F*   23  PRINT CUSTOMER ADDRESS DETAILS                          *   094657
     F*   30  CAPITALISATION IS ON DEMAND OR FOR MANAGEMENT STMT.     *   104618
     F*   41  TO PRINT SIGN FOR WITHHOLDING TAX                       *
     F*   48  TOTAL CREDITED                                          *
     F*   49  TOTAL DEBITED                                           *
     F*   50  USE WITH REDETM                                         *
     F*   51  USE WITH REHISL                                         *
     F*   52  USE WITH REHISL                                         *
     F*   55  Do not report exchange rate for alt. a/c in diff. ccy   *   125176
     F*   60  USE WITH REHRDJ AND REHRCJ                              *
     F*   70  MANAGEMENT STATEMENT PRINT                              *
     F*   73  OVERFLOW INDICATORE ON PRINTER FOR DEBIT AND CREDIT     *
     F*   80  NUMBER OF DECIMAL POSITION WITH CURRENCY = 0            *
     F*   81  NUMBER OF DECIMAL POSITION WITH CURRENCY = 1            *
     F*   82  NUMBER OF DECIMAL POSITION WITH CURRENCY = 2            *
     F*   83  NUMBER OF DECIMAL POSITION WITH CURRENCY = 3            *
     F****84**RATE*OUTPUT**                                           *   086087
     F*   84  Tiered interest                                         *   086087
     F****85**RATE*OUTPUT**                                           *   086087
     F*   85  Threshold interest                                      *   086087
     F*   79  MULTIBRANCHING OUTPUT INDICATOR                         *
     F*   86  MULTIBRANCHING INDICATOR MBIN = 'Y'                     *
     F*   87  CAPITALISATION TO AN ACCOUNT IN DIFFERENT CURRENCY      *
     F******* AND MULTIBRANCH PRESENT *********************************   125176
     F*   88  CHARGES FOR MULTIPLE TRANSACTION PRESENT                *
     F*   89  USE TO PRINT END OF AUDIT WHEN DB ERROR                 *
     F*   96  CURRENCIES ARRAY IS FULL                                *
     F*   97  USE IF CURRENCY EXIST                                   *
     F*   98  DATF = M                                                *
     F*   99  GENERAL ERROR AND CHAINING                              *
     F*                                                               *
     F*   U7  DATABASE ERROR                                          *
     F*   U8  DATABASE ERROR                                          *
     F*   LR  END OF PROGRAM                                          *
     F*                                                               *
     F*   DBERROR NUMBER MAXIMUM 52 (INCLUDE)                         *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
     F*   S U B R O U T I N E   I N D E X                             *
     F*                                                               *
     F*   BOTHSR - Credit and Debit processing                        *
     F*   B1EQ   - When debit and credit begin at the same date       *
     F*   B1GT   - When debit begin before credit                     *
     F*   B1LT   - When credit begin before debit                     *
     F*   CALBRT - Calculate base rate tax                            *
     F*   CLMSG  - Clear message                                      *
     F*   CRSR   - Credit only processing                             *
     F*   DAYTSR - Prepare and output days total                      *
     F*   DBSR   - Database error handling                            *
     F*   DRSR   - Debit only processing                              *
     F*   DETPR  - Detail processing                                  *
     F*   FIRST  - First cycle                                        *
     F*   ITYPCR - Interest type greater than 2                       *
     F*   ITYPDR - Interest type greater than 2                       *
     F*   MAIN   - Main processing                                    *
     F*   OPENCR - Credit opening bal and credit opening rate output  *
     F*   OPENDR - Debit opening bal and debit opening rate output    *
     F*   OVERDC - Subroutine for processing overflow on RE3764DC     *
     F*   RATEC  - Prepare and output credit rate change              *
     F*   RATED  - Prepare and output debit rate change               *
     F*   RATESR - Rate change processing                             *
     F*   RCRSR  - Credit rate change output                          *
     F*   RDRSR  - Debit rate change output                           *
     F*   TOTAL  - Total processing                                   *
     F*   TOTSR  - Days total output for crdeit and debit             *
     F*   ZICD   - Find number of days to calculate interest according*
     F*            to calculation basis                               *
     F*   *PSSR  - Error subroutine for certain access object errors  *
     F*****************************************************************
     F/EJECT
     F/COPY WNCPYSRC,RE3761F002
     E                    CCYA      200  3
     E                    DPA       200  1 0
     E                    RTA        12 11 7                              086087
     E                    BLA        12 15 0                              086087
     E                    CMD     1   1 39
     E                    CPY@    1   1 80
     E********************NAR        34 39                                064051
     E/COPY WNCPYSRC,RE3761E003
     E                    NAR        39 39                                CRE001
     E/COPY WNCPYSRC,RE3761E001
     E***********         NAR        36 39                         064051 CRE001
     E/COPY WNCPYSRC,RE3761E002
     E/COPY ZSRSRC,ZDATE2Z1
     IRECRGDF                                                             094337
     I*                                                                   094337
     I** RENAME RECRGDF FORMAT - RECRGD FILE                              094337
     I*                                                                   094337
     I              RECI                            GRECI                 094337
     I              ACOD                            GACOD                 094337
     IREADJF
     I*
     I** RENAME READJF   FORMAT FIELDS - REHISSL FILE
     I*
     I              RECI                            ARECI
     I              BRCA                            ABRCA
     I              CNUM                            ACNUM
     I              CCY                             ACCY
     I              ACOD                            AACOD
     I              ACSQ                            AACSQ
     I              HISD                            AHISD
     I              HISB                            AHISB
     I              MNBL                            AMNBL
     I              PCHGAR                          ACHGAR
     I              TCHGAR                          ATHGAR
     I              PCHGAN                          ACHGAN
     I              TCHGAN                          ATHGAN
     I              DICT                            ADICT
     I              DRCB                            ADRCB
     I              DRCD                            ADRCD
     I              DAIC                            ADAIC
     I              PMADI                           APMADI
     I              TMADI                           ATMADI
     I              PDID                            APDID
     I              DMINT                           ADMINT
     I              DRIP                            ADRIP
     I              DRIS                            ADRIS
     I              CICT                            ACICT
     I              CRCB                            ACRCB
     I              CRCD                            ACRCD
     I              CAIC                            ACAIC
     I              PMACI                           APMACI
     I              TMACI                           ATMACI
     I              PCID                            APCID
     I              CMINT                           ACMINT
     I              CRIP                            ACRIP
     I              CRIS                            ACRIS
     I              STBL                            ASTBL
     I              CHGP                            ACHGP
     IREHISPSF
     I*
     I** RENAME REHISPSF FORMAT FIELDS - REHISL  FILE
     I*
     I              RECI                            DRECI
     I              BRCA                            SBRCA
     I              CNUM                            SCNUM
     I              CCY                             SCCY
     I              ACOD                            SACOD
     I              ACSQ                            SACSQ
     I              HISD                            DHISD
     I              HISB                            DHISB
     I              MNBL                            SMNBL
     I              PCHGAR                          SCHGAR
     I              TCHGAR                          STHGAR
     I              PCHGAN                          SCHGAN
     I              TCHGAN                          STHGAN
     I              DICT                            DDICT
     I              DRCB                            SDRCB
     I              DRCD                            SDRCD
     I              DAIC                            SDAIC
     I              PMADI                           SPMADI
     I              TMADI                           STMADI
     I              PDID                            SPDID
     I              DMINT                           SDMINT
     I              DRIP                            SDRIP
     I              DRIS                            SDRIS
     I              SDCI                            SSDCI                 125176
     I              CICT                            DCICT
     I              CRCB                            SCRCB
     I              CRCD                            SCRCD
     I              CAIC                            SCAIC
     I              PMACI                           SPMACI
     I              TMACI                           STMACI
     I              PCID                            SPCID
     I              CMINT                           SCMINT
     I              CRIP                            SCRIP
     I              CRIS                            SCRIS
     I              SCCI                            SSCCI                 125176
     I              STBL                            SSTBL
     I              CHGP                            SCHGP
     IREHISPPF
     I*
     I** RENAME REHISPPF FORMAT FIELDS - REHISL  FILE
     I*
     I              RECI                            DRECI
     I              BRCA                            DBRCA
     I              CNUM                            DCNUM
     I              CCY                             DCCY
     I              ACOD                            DACOD
     I              ACSQ                            DACSQ
     I              HISD                            DHISD
     I              HISB                            DHISB
     I              MNBL                            DMNBL
     I              CHGAR                           DCHGAR
     I              TCHGAR                          DTHGAR
     I              CHGAN                           DCHGAN
     I              TCHGAN                          DTHGAN
     I              DMVT                            DDMVT
     I              DICT                            DDICT
     I              DRCB                            DDRCB
     I              DRCD                            DDRCD
     I              DAID                            DDAID
     I              MADI                            DMADI
     I              TMADI                           DTMADI
     I              PDID                            DPDID
     I              DMINT                           DDMINT
     I              CMVT                            DCMVT
     I              CICT                            DCICT
     I              CRCB                            DCRCB
     I              CRCD                            DCRCD
     I              CAID                            DCAID
     I              MACI                            DMACI
     I              TMACI                           DTMACI
     I              PCID                            DPCID
     I              CMINT                           DCMINT
     I              DICI                            DDICI
     I              CICI                            DCICI
     I              DRCI                            DDRCI
     I              CRCI                            DCRCI
     I              VDTC                            DVDTC
     I              ADTY                            DADTY
     I              ALTI                            DALTI
     I              MNBCP                           DMNBCP
     IREHISPMF
     I*
     I** RENAME REHISPMF FORMAT FIELDS - REHISL  FILE
     I*
     I              RECI                            DRECI
     I              HISD                            MHISD
     I*
     IREHRDJF
     I*
     I** RENAME REHRDJF  FORMAT FIELDS - REHRDJ  FILE
     I*
     I              RECI                            RRECI
     I              PSTD                            RPSTD
     I              VALD                            RVALD
     I              HISD                            RHISD
     I              PNAR                            RPNAR
     I              DRCR                            RDRCR
     I              TRAT                            RTRAT                                     194059
     I*
     IREHRCJF
     I*
     I** RENAME REHRCJF  FORMAT FIELDS - REHRCJ  FILE
     I*
     I              RECI                            RRECI
     I              PSTD                            RPSTD
     I              VALD                            RVALD
     I              HISD                            RHISD
     I              PNAR                            RPNAR
     I              DRCR                            RDRCR
     I              TRAT                            RTRAT                                     194059
     I*
     IREHPOSMF
     I*
     I** RENAME REHPOSMF FORMAT FIELDS - REHPOML2 FILE
     I*
     I              HISD                            MAHISD
     I              DRCR                            MADRCR                125176
     I*
     I* BRT ICD
     ISDBRTDD0
     I              ACOD                            ACODXX
     I/COPY WNCPYSRC,RE3761I004
     I*
     ICPYR@#      DS
     I*
     I** DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     I*
     I                                        1  80 CPY@
     I**
     ISDBANK    E DSSDBANKPD
     I              BJURPT                          TITL
     I**  EXTERNAL DS FOR BANK DETAILS
     I**
     ISDRETL    E DSSDRETLPD                                              094337
     I              BMLDAI                          LDAC                  094337
     I**  Retail Details                                                  094337
     I*                                                                   094337
     I** KEY DATA STRUCTURE : CHKEY TO CHAIN TO RECRG FILE                094337
     I*                                                                   094337
     I            DS                                                      094337
     I                                        1  12 CHKEY                 094337
     I                                        1   1 BLANK1                094337
     I                                        2   30CHGT                  094337
     I                                        4   80CHST                  094337
     I                                        9  11 WCCCY                 094337
     I                                       12  12 ENDK                  094337
     I*
     I** DATA STRUCTURE FOR BEGINNING DATE
     I*
     I            DS
     I                                        1   60SRES
     I                                        1   20ZISD
     I                                        3   40ZISM
     I                                        5   60ZISY
     I*
     I** DATA STRUCTURE FOR FINISHING DATE
     I*
     I            DS
     I                                        1   60FRES
     I                                        1   20ZIFD
     I                                        3   40ZIFM
     I                                        5   60ZIFY
     I*
     I** DATA STRUCTURE FOR CURRENCY DECIMAL
     I*
     I            DS
     I                                        1  150HISB0
     I                                        1  151HISB1
     I                                        1  152HISB2
     I                                        1  153HISB3
     I*
     I            DS
     I                                        1  150TCHR0
     I                                        1  151TCHR1
     I                                        1  152TCHR2
     I                                        1  153TCHR3
     I*
     I            DS
     I                                        1  150TCHN0
     I                                        1  151TCHN1
     I                                        1  152TCHN2
     I                                        1  153TCHN3
     I*
     I            DS
     I                                        1  150CHGP0
     I                                        1  151CHGP1
     I                                        1  152CHGP2
     I                                        1  153CHGP3
     I*
     I            DS
     I                                        1  150CHGR0
     I                                        1  151CHGR1
     I                                        1  152CHGR2
     I                                        1  153CHGR3
     I*
     I            DS
     I                                        1  150CHGN0
     I                                        1  151CHGN1
     I                                        1  152CHGN2
     I                                        1  153CHGN3
     I*
     I            DS
     I                                        1  150TINTD0
     I                                        1  151TINTD1
     I                                        1  152TINTD2
     I                                        1  153TINTD3
     I*
     I            DS
     I                                        1  150TINTC0
     I                                        1  151TINTC1
     I                                        1  152TINTC2
     I                                        1  153TINTC3
     I*
     I            DS
     I                                        1  150TGINT0
     I                                        1  151TGINT1
     I                                        1  152TGINT2
     I                                        1  153TGINT3
     I*
     I            DS
     I                                        1  150BRTOT0
     I                                        1  151BRTOT1
     I                                        1  152BRTOT2
     I                                        1  153BRTOT3
      *                                                                                       CGL031
     I            DS                                                                          CGL031
     I                                        1  150EUTAX0                                    CGL031
     I                                        1  151EUTAX1                                    CGL031
     I                                        1  152EUTAX2                                    CGL031
     I                                        1  153EUTAX3                                    CGL031
      *                                                                                       CER048
     I            DS                                                                          CER048
     I                                        1  150STAX0                                     CER048
     I                                        1  151STAX1                                     CER048
     I                                        1  152STAX2                                     CER048
     I                                        1  153STAX3                                     CER048
      *                                                                                     BUG26838
     I            DS                                                                        BUG26838
     I                                        1  150TTAX0                                   BUG26838
     I                                        1  151TTAX1                                   BUG26838
     I                                        1  152TTAX2                                   BUG26838
     I                                        1  153TTAX3                                   BUG26838
     I*
     I            DS
     I                                        1  150PSTD0
     I                                        1  151PSTD1
     I                                        1  152PSTD2
     I                                        1  153PSTD3
     I*
     I            DS
     I                                        1  150INTC0
     I                                        1  151INTC1
     I                                        1  152INTC2
     I                                        1  153INTC3
     I*
     I            DS
     I                                        1  150INTD0
     I                                        1  151INTD1
     I                                        1  152INTD2
     I                                        1  153INTD3
     I*
     I            DS
     I                                        1  150NUMB0
     I                                        1  151NUMB1
     I                                        1  152NUMB2
     I                                        1  153NUMB3
      *                                                                   086087
     I            DS                                                      086087
     I                                        1  117ORAT1                 086087
     I                                        1  11 ORATC                 086087
     I*
     I            DS
     I                                        1  150OBAL01
     I                                        1  151OBAL11
     I                                        1  152OBAL21
     I                                        1  153OBAL31
     I                                        1  15 OBALC                 086087
     I*
     I************DS                                                      086087
     I************                            1  150OBAL02                086087
     I************                            1  151OBAL12                086087
     I************                            1  152OBAL22                086087
     I************                            1  153OBAL32                086087
     I*
     I************DS                                                      086087
     I************                            1  150OBAL03                086087
     I************                            1  151OBAL13                086087
     I************                            1  152OBAL23                086087
     I************                            1  153OBAL33                086087
     I*
     I** DATA STRUCTURE FOR RATE SPREAD
     I*
     I**********  DS                                                      086087
     I**********                              1  36 RAT2                  086087
     I**********                          P   1   67RAT21                 086087
     I**********                          P   7  127RAT22                 086087
     I**********                          P  13  187RAT23                 086087
     I**********                          P  19  247RAT24                 086087
     I**********                          P  25  307RAT25                 086087
     I**********                          P  31  367RAT26                 086087
     I**********                              1   6 RATC21                086087
     I**********                              7  12 RATC22                086087
     I**********                             13  18 RATC23                086087
     I**********                             19  24 RATC24                086087
     I**********                             25  30 RATC25                086087
     I**********                             31  36 RATC26                086087
     I*
     I**********  DS                                                      086087
     I**********                              1  36 RAT3                  086087
     I**********                          P   1   67RAT31                 086087
     I**********                          P   7  127RAT32                 086087
     I**********                          P  13  187RAT33                 086087
     I**********                          P  19  247RAT34                 086087
     I**********                          P  25  307RAT35                 086087
     I**********                          P  31  367RAT36                 086087
     I**********                              1   6 RATC31                086087
     I**********                              7  12 RATC32                086087
     I**********                             13  18 RATC33                086087
     I**********                             19  24 RATC34                086087
     I**********                             25  30 RATC35                086087
     I**********                             31  36 RATC36                086087
      *                                                                   086087
      * Define rates as an array                                          086087
     I            DS                                                      086087
     I                                        1  72 RAT23                 086087
     I                                        1  36 RAT2                  086087
     I                                       37  72 RAT3                  086087
     I                                    P   1  72 RTA                   086087
     I*
     I** DATA STRUCTURE FOR BALANCE
     I*
     I**********  DS                                                      086087
     I**********                              1  48 BAL2                  086087
     I**********                          P   1   80BAL21                 086087
     I**********                          P   9  160BAL22                 086087
     I**********                          P  17  240BAL23                 086087
     I**********                          P  25  320BAL24                 086087
     I**********                          P  33  400BAL25                 086087
     I**********                          P  41  480BAL26                 086087
     I**********                              1   8 BALC21         040447 086087
     I**********                              9  16 BALC22         040447 086087
     I**********                             17  24 BALC23         040447 086087
     I**********                             25  32 BALC24         040447 086087
     I**********                             33  40 BALC25         040447 086087
     I**********                             41  48 BALC26         040447 086087
     I*
     I**********  DS                                                      086087
     I**********                              1  48 BAL3                  086087
     I**********                          P   1   80BAL31                 086087
     I**********                          P   9  160BAL32                 086087
     I**********                          P  17  240BAL33                 086087
     I**********                          P  25  320BAL34                 086087
     I**********                          P  33  400BAL35                 086087
     I**********                          P  41  480BAL36                 086087
     I**********                              1   8 BALC31         040447 086087
     I**********                              9  16 BALC32         040447 086087
     I**********                             17  24 BALC33         040447 086087
     I**********                             25  32 BALC34         040447 086087
     I**********                             33  40 BALC35         040447 086087
     I**********                             41  48 BALC36         040447 086087
      *                                                                   086087
      * Define balances as an array                                       086087
     I            DS                                                      086087
     I                                        1  96 BAL23                 086087
     I                                        1  48 BAL2                  086087
     I                                       49  96 BAL3                  086087
     I                                    P   1  96 BLA                   086087
     I*
     I** DATA STRUCTURE FOR DATE FORMAT DD/MM/YY
     I*
     I            DS
     I                                        1   60RESULT
     I                                        1   20ZDAY
     I                                        3   40ZMTH
     I                                        5   60ZYEAR
     I*
     IOKEYD       DS
     I**********                              1  18 OKEY                                      CGL029
     I                                        1  24 OKEY                                      CGL029
     I                                        1   3 OBRCA
     I**********                              4   90OCNUM                                   CSD027A
     I                                        4   9 OCNUM                                   CSD027A
     I                                       10  12 OCCY
     I**********                             13  160OACOD                                     CGL029
     I**********                             17  180OACSQ                                     CGL029
     I**********                          P  19  210OLDID                                     CGL029
     I                                       13  220OACOD                                     CGL029
     I                                       23  240OACSQ                                     CGL029
     I                                    P  25  260OLDID                                     CGL029
     I*
     I**   NAME OF MESSAGE FILE
     I*
     I            DS
     I                                        1  39 CMD1
     I                                       16  17 FILT1
     I                                       33  34 FILT2
     I*
     I                                        1   8 ADREF1
     I                                        1   1 WRCDT
     I*
     IRKEY2       DS
     I**********                              1  18 RKEY                                      CGL029
     I                                        1  24 RKEY                                      CGL029
     I                                        1   3 CBRCA
     I**********                              4   90CCNUM                                     CSD027
     I                                        4   9 CCNUM                                     CSD027
     I                                       10  12 CCCY
     I**********                             13  160CACOD                                     CGL029
     I**********                             17  180CACSQ                                     CGL029
     I**********                             19  230WDATE                                     CGL029
     I                                       13  220CACOD                                     CGL029
     I                                       23  240CACSQ                                     CGL029
     I                                       25  290WDATE                                     CGL029
     I                                        1   3 CBRCA2
     I*
     I** LOCAL DATA AREA FOR DATABASE ERROR DETAILS
     I*
     ILDA        UDS                            256
     I                                      134 141 DBFILE
     I                                      142 170 DBKEY
     I                                      171 180 DBPGM
     I                                      181 1830DBASE
     I/COPY WNCPYSRC,RE3761I001
     I********************************************************************
     I**
     I**   FILE INFORMATION DATA STRUCTURE - P1
     I**
     ISPOOL       DS
     I                                       83  92 SFILE
     I                                    B 123 1240SFNUM
     I**
     ISPOOL1      DS
     I                                       83  92 SFILE1
     I                                    B 123 1240SFNUM1
     I**
     ISPOOL2      DS
     I                                       83  92 SFILE2
     I                                    B 123 1240SFNUM2
     I**
     I**   FILE INFORMATION DATA STRUCTURE - AU
     I**
     ISPOOLU      DS
     I                                       83  92 SFILEU
     I                                    B 123 1240SFNUMU
     I**
     I** DATA AREA RUNDAT
     I**
     IRUNDT       DS
     I                                        1   7 RUNA
     I                                    P   8  100RUND
     I                                       11  11 SSF
     I                                       12  12 DATF
     I                                       13  13 MBIN
     I/COPY WNCPYSRC,RE3761I003
     ISDBRCH    E DSSDBRCHPD
     I**
     I              A8BRNM                          BRNM
     ISCSARD    E DSSCSARDPD                                              CFT004
      ** MIDAS Switchable Features Accessed Via Access Program            CFT004
      *                                                                   CFT004
     IACCNTB    E DSACCNTAB                                               CFT004
      ** MIDAS Account Master Details Accessed Via Access Program         CFT004
      *                                                                   CFT004
     I              ADREF1                          ADREFX                CFT004
     I              LCD                             LCDX                  CFT004
     IDSFDY     E DSDSFDY
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE
     I*
     I*
     IDSSDY     E DSDSSDY                                                 CFT004
      *                                                                   CFT004
      ** Long data structure for access programs.                         CFT004
     I*
      ** Work Variables
     I              'DspZeroIntRate'      C         WSYSVL                                  MD057283
      *
     I/COPY WNCPYSRC,RE3761I002
     C*===================================================================
     C                     MOVEACPY@      BIS@   80
     C           *NAMVAR   DEFN           LDA
     C*
     C** Key lists
     C*
     C*
     C** Key field to access to file
     C*
     C**  Klist to access ACCNT
     C*
     C           KACCNT    KLIST
     C                     KFLD           CCNUM
     C                     KFLD           CCCY
     C                     KFLD           CACOD
     C                     KFLD           CACSQ
     C                     KFLD           CBRCA
     C*
     C**  Klist to chain on RECOM
     C*
     C           KLIST0    KLIST
     C                     KFLD           CBRCA
     C                     KFLD           CCNUM
     C                     KFLD           CCCY
     C                     KFLD           CACOD
     C                     KFLD           CACSQ
     C*
     C**  Klist to chain on REDETM
     C*
     C           KLIST1    KLIST
     C                     KFLD           CBRCA
     C                     KFLD           CCNUM
     C                     KFLD           CCCY
     C                     KFLD           CACOD
     C                     KFLD           CACSQ
     C*
     C**  Klist to read REHISL for debit
     C*
     C           KLIST2    KLIST
     C                     KFLD           CBRCA
     C                     KFLD           CCNUM
     C                     KFLD           CCCY
     C                     KFLD           CACOD
     C                     KFLD           CACSQ
     C                     KFLD           CLDID
     C*
     C**  Klist to read REHISL for credit
     C*
     C           KLIST3    KLIST
     C                     KFLD           CBRCA
     C                     KFLD           CCNUM
     C                     KFLD           CCCY
     C                     KFLD           CACOD
     C                     KFLD           CACSQ
     C                     KFLD           CLCID
     C*
     C**  Klist to read CLINT
     C*
     C           KLIST4    KLIST
     C                     KFLD           CCNUM
     C                     KFLD           RCDT
     C*
     C**  Klist to chain on REHRDJ
     C*
     C           KLIST5    KLIST
     C                     KFLD           CBRCA
     C                     KFLD           CCNUM
     C                     KFLD           CCCY
     C                     KFLD           CACOD
     C                     KFLD           CACSQ
     C                     KFLD           DDRCD
     C*
     C**  Klist to chain on REHRCJ
     C*
     C           KLIST6    KLIST
     C                     KFLD           CBRCA
     C                     KFLD           CCNUM
     C                     KFLD           CCCY
     C                     KFLD           CACOD
     C                     KFLD           CACSQ
     C                     KFLD           DCRCD
     C*
     C**  Klist to chain on REHPOML2
     C*
     C           KLIST9    KLIST
     C                     KFLD           CBRCA
     C                     KFLD           CCNUM
     C                     KFLD           CCCY
     C                     KFLD           CACOD
     C                     KFLD           CACSQ
     C                     KFLD           DHISD
     C*                                                                   040447
     C**  KLIST TO ACCESS REHRDJ AND REHRCJ                               040447
     C*                                                                   040447
     C***********KEODLF    KLIST                                    040447094337
     C***********          KFLD           CBRCD                     040447094337
     C***********          KFLD           CCNUM                     040447094337
     C***********          KFLD           CCCYD                     040447094337
     C***********          KFLD           CACOD                     040447094337
     C***********          KFLD           CACSQ                     040447094337
     C***********          KFLD           KDATE                     040447094337
      *                                                                                       CGL031
      ** Key fields to access LF/SDCSINL7.                                                    CGL031
      *                                                                                       CGL031
     C           KCSIN     KLIST                                                              CGL031
     C                     KFLD           KRDNB   50                                          CGL031
     C                     KFLD           KMODI   1                                           CGL031
     C                     KFLD           KCUST   6                                           CGL031
     C                     KFLD           KSCCY   3                                           CGL031
     C**********           KFLD           KACOD   40                                   CGL031 CGL035
     C                     KFLD           KACOD  100                                          CGL035
     C                     KFLD           KACSQ   20                                          CGL031
     C                     KFLD           KBRCA   3                                           CGL031
     C*                                                                                       235917
      ** Key fields to access LF/SDCSINLC.                                                    235917
      *                                                                                       235917
     C           KLISTC    KLIST                                                              235917
     C                     KFLD           KRDNB                                               235917
     C                     KFLD           KMODI                                               235917
     C                     KFLD           KJOIN                                               235917
     C                     KFLD           KSCCY                                               235917
     C                     KFLD           KACOD                                               235917
     C                     KFLD           KACSQ                                               235917
     C                     KFLD           KBRCA                                               235917
     C*
     C** Parameter sent by the CL: It is the language code default
     C*
     C           *ENTRY    PLIST
     C                     PARM           DLGID
     C*
     C** Set up parameter to form output line
     C*
     C           ZA1311    PLIST
     C                     PARM           MSGID   7
     C                     PARM           MSGDT0 40
     C                     PARM           MSGDT1 40
     C                     PARM           MSGDT2 40
     C                     PARM           MSGDT3 40
     C                     PARM           MSGDT4 40
     C                     PARM           MSGDT5 40
     C                     PARM           MSGDT6 40
     C                     PARM           MSGDT7 40
     C                     PARM           MSGDT8 40
     C                     PARM           MSGDT9 40
     C                     PARM           MNARR 200
     C*
     C** Work fields definition
     C*
     C           *LIKE     DEFN LGID      OLGID
     C           *LIKE     DEFN CCICI     WTTI
     C           *LIKE     DEFN DDAID     WDAID
     C           *LIKE     DEFN DCAID     WCAID
     C           *LIKE     DEFN LGID      DLGID
     C           *LIKE     DEFN DBKEY     ERRDAT
     C********** *LIKE     DEFN CNUM      I     - 3                                           CSD027
     C                     Z-ADD*ZERO     I       30                                          CSD027
     C           *LIKE     DEFN RUND      PPSTD
     C           *LIKE     DEFN RUNA      PSTDO
     C           *LIKE     DEFN RUND      PVALD
     C           *LIKE     DEFN RUNA      VALDO
     C           *LIKE     DEFN ACNO      WACNO
     C           *LIKE     DEFN DCRCB     WCRCB
     C           *LIKE     DEFN DDRCB     WDRCB
     C           *LIKE     DEFN DHISB     WHISB
     C           *LIKE     DEFN DHISD     WHISD
     C           *LIKE     DEFN DHISD     WWHISD
     C           *LIKE     DEFN DHISD     WHISDC
     C           *LIKE     DEFN DHISD     WHISDD
     C           *LIKE     DEFN MNBL      WMNBL
     C           *LIKE     DEFN DHISB     W1STBL
     C           *LIKE     DEFN DHISB     W2STBL
     C           *LIKE     DEFN DHISB     DOHISB
     C           *LIKE     DEFN DHISB     COHISB
     C********** *LIKE     DEFN CNUM      ZERROR- 5                                           CSD027
     C                     Z-ADD*ZERO     ZERROR  10                                          CSD027
     C           *LIKE     DEFN RUND      ZIBEG
     C           *LIKE     DEFN RUND      ZIBW1
     C           *LIKE     DEFN RUND      ZIDREM
     C           *LIKE     DEFN CICT      ZIDW1
     C           *LIKE     DEFN RUND      ZIDW2
     C           *LIKE     DEFN RUND      ZID1
     C           *LIKE     DEFN RUND      ZID2
     C           *LIKE     DEFN RUND      ZIEND
     C           *LIKE     DEFN RUND      ZILPCP
     C           *LIKE     DEFN CICT      ZIMAN
     C           *LIKE     DEFN CICT      ZIM1
     C           *LIKE     DEFN RUND      ZIREM
     C           *LIKE     DEFN CICT      ZIY1
     C           *LIKE     DEFN SDAIC     @GADJ                           125176
     C*
     C                     Z-ADD0         TCHR0                           094337
     C                     Z-ADD0         TCHN0                           094337
     C/COPY WNCPYSRC,RE3761C007
     C*===================================================================
     C*
     C/EJECT
     C*===================================================================
     C** P R O G R A M     S T A R T
     C*===================================================================
     C*
     C** First cycle processing
     C*
     C                     EXSR FIRST
     C*
     C** Main processing
     C*
     C                     EXSR MAIN
     C*
     C** Total processing
     C*
     C                     EXSR TOTAL
     C/COPY WNCPYSRC,RE3761C020
     C*
     C*===================================================================
     C** P R O G R A M     E N D
     C*===================================================================
     C/EJECT
     C********************************************************************
     C**
     C** BOTHSR subroutine for debit and credit output processing
     C**
     C**     Called by       D E T P R
     C**
     C**     Calls           DBSR, B1EQ, B1LT, B1GT, RATESR
     C**                     TOTSR, ZICD
     C**
     C           BOTHSR    BEGSR                           **BOTHSR BEGSR*
     C*
     C                     MOVE '0'       *IN72
     C                     MOVE '0'       *IN73
     C                     MOVE '0'       *IN74
     C                     MOVE '0'       *IN75
     C/COPY WNCPYSRC,RE3761C057
     C*
     C**********           Z-ADD*ZERO     BDATE   50               094337 125176
     C***********KLIST2    CHAINREHISL               52                   064051
     C           KLIST2    SETLLREHISL               52                   064051
     C           KLIST1    READEREHISL                   52               064051
     C*
     C           *IN52     IFEQ '1'                        - B1
     C                     Z-ADDCLDID     WDATE
     C                     Z-ADD1         DBASE
     C                     MOVE 'REHISL'  DBFILE           ***************
     C                     MOVELRKEY2     DBKEY            **DB ERROR 01**
     C                     MOVEA'1'       *IN,89           ***************
     C                     EXSR DBSR
     C                     END                             - E1
      *                                                                   182452
      ** Ignore REHISPM records.                                          182452
      *                                                                   182452
     C           DRECI     DOWEQ'M'                                       182452
     C           KLIST1    READEREHISL                   52               182452
     C                     END                                            182452
     C*
     C           DRECI     IFEQ 'B'                        - B1
     C                     Z-ADD*ZEROS    W1STBL
     C                     Z-ADDDDRCD     WWDRCD  50                      040447
     C                     Z-ADDDCRCD     WWCRCD  50                      040447
     C                     Z-ADDDHISD     BDATE   50                      094337
     C                     Z-ADDDDRCB     WDRCBD                          125176
     C                     ELSE                            - X1
     C           DRECI     IFEQ 'S'                        - B2
     C                     Z-ADDSSTBL     W1STBL
     C                     Z-ADDSDRCD     WWDRCD                          040447
     C                     Z-ADDSCRCD     WWCRCD                          040447
     C                     Z-ADDSDRCB     WDRCBD                          125176
     C                     ELSE                            - X2
     C                     Z-ADDCLDID     WDATE
     C                     Z-ADD2         DBASE
     C                     MOVE 'REHISL'  DBFILE           ***************
     C                     MOVELRKEY2     DBKEY            **DB ERROR 02**
     C                     MOVEA'1'       *IN,89           ***************
     C                     EXSR DBSR
     C                     END                             - E2
     C*
     C                     END                             - E1
     C*
     C                     Z-ADDDHISB     DOHISB
     C                     Z-ADDDHISB     WHISBD                          085171
     C                     Z-ADDCLDID     WHISDD
     C                     Z-ADDDRIR      WWDRIR 117
     C                     Z-ADD0         WMNBLD                          085171
     C                     Z-ADD0         WDAIDD                          085171
     C                     Z-ADD0         WCAIDD                          085171
     C*
     C***********KLIST3    CHAINREHISL               52                64051
     C           KLIST3    SETLLREHISL               52                64051
     C           KLIST1    READEREHISL                   52            64051
     C*
     C           *IN52     IFEQ '1'                        - B1
     C                     Z-ADDCLCID     WDATE
     C                     Z-ADD3         DBASE
     C                     MOVE 'REHISL'  DBFILE           ***************
     C                     MOVELRKEY2     DBKEY            **DB ERROR 03**
     C                     MOVEA'1'       *IN,89           ***************
     C                     EXSR DBSR
     C                     END                             - E1
      *                                                                   182452
      ** Ignore REHISPM records.                                          182452
      *                                                                   182452
     C           DRECI     DOWEQ'M'                                       182452
     C           KLIST1    READEREHISL                   52               182452
     C                     END                                            182452
     C*
     C           DRECI     IFEQ 'B'                        - B1
     C                     Z-ADD*ZEROS    W2STBL
     C                     Z-ADDDHISD     BDATE                           125176
     C                     Z-ADDDCRCB     WCRCBC                          125176
     C                     ELSE                            - X1
     C           DRECI     IFEQ 'S'                        - B2
     C                     Z-ADDSSTBL     W2STBL
     C                     Z-ADDSCRCB     WCRCBC                          125176
     C                     ELSE                            - X2
     C                     Z-ADDCLCID     WDATE
     C                     Z-ADD4         DBASE
     C                     MOVE 'REHISL'  DBFILE           ***************
     C                     MOVELRKEY2     DBKEY            **DB ERROR 04**
     C                     MOVEA'1'       *IN,89           ***************
     C                     EXSR DBSR
     C                     END                             - E2
     C                     END                             - E1
     C*
     C                     Z-ADDDHISB     COHISB
     C                     Z-ADDDHISB     WHISBC                          085171
     C                     Z-ADDCLCID     WHISDC
     C                     Z-ADDCRIR      WWCRIR 117
     C                     Z-ADD0         WMNBLC                          085171
     C/COPY WNCPYSRC,RE3761C058
     C*
     C           CLDID     IFLT CLCID                      - B1
     C***********KLIST2    CHAINREHISL               52                  64051
     C           KLIST2    SETLLREHISL                                   64051
     C           KLIST1    READEREHISL                   52              64051
     C                     END                             - E1
     C*
     C                     MOVE '0'       *IN65
     C           ACNO      IFNE *ZEROS
     C                     MOVE '1'       *IN65
     C                     END
     C/COPY WNCPYSRC,RE3761C016
     C                     WRITEHEADDR
     C                     WRITEHEADCR
     C*
     C**Charge*report if necessary                                        085713
     C***********                                                         085713
     C***********CCICI     IFNE *BLANK                                    085713
     C***********CCHGP     ANDNE*ZERO                                     085713
     C***********          WRITEHEADCH                                    085713
     C***********          END                                            085713
      *                                                                   125176
      * Charge report if necessary                                        125176
     C           CCICI     IFNE *BLANK                                    125176
     C           CCHGP     ANDNE*ZERO                                     125176
     C                     WRITEHEADCH                                    125176
     C                     END                                            125176
     C*
     C                     MOVE *BLANKS   VALDA
     C*
     C                     EXSR CLMSG
     C                     MOVELNAR,1     TNARR
     C*
     C                     Z-ADDW1STBL    HISB0
     C                     Z-ADDDHISB     WHISB
     C*
     C**  B/F balance output
     C*
     C                     WRITETITLEDR
     C                     Z-ADDW2STBL    HISB0
     C                     WRITETITLECR
     C*
     C**  Process back value and opening
     C*
     C           CLDID     CASEQCLCID     B1EQ
     C           CLDID     CASLTCLCID     B1LT
     C           CLDID     CASGTCLCID     B1GT
     C*                    CAS            DBSR
     C                     END
      *                                                                   182452
     C                     MOVE CLCID     WSMNTC  50                      182452
     C                     MOVE CLDID     WSMNTD  50                      182452
      *                                                                   125176
     C                     MOVE *BLANK    @ADJF                           125176
     C*
     C           DRECI     IFEQ 'S'                        - B1
     C                     Z-ADDDHISD     WWHISD
     C                     Z-ADDDHISB     WHISB
     C                     Z-ADDSMNBL     WMNBL
     C                     Z-ADDDDRCB     WDRCB
     C                     Z-ADDDCRCB     WCRCB
      *                                                                   125176
      * Generated adj. on start date has already been reported, but set   125176
      * flag to ensure balance change is reported (as hist. balance is    125176
      * updated but DMVT/CMVT not updated with gen. adj.).                125176
     C           *IN70     IFEQ '1'                                       125176
     C           SDAIC     IFNE *ZEROS                                    125176
     C           SSDCI     ANDEQ'Y'                                       125176
     C                     MOVE 'Y'       @ADJF                           125176
     C                     END                                            125176
     C           SCAIC     IFNE *ZEROS                                    125176
     C           SSCCI     ANDEQ'Y'                                       125176
     C                     MOVE 'Y'       @ADJF                           125176
     C                     END                                            125176
     C                     END                                            125176
      *                                                                   125176
     C           KLIST1    READEREHISL                   51
      *                                                                   125176
      * Bypass interim capitalisation records                             125176
     C           *IN51     DOWEQ'0'                                       125176
     C           DRECI     ANDEQ'S'                                       125176
     C           DHISD     ANDLTCHISD                                     125176
      *                                                                   125176
      * If management cap. check for generated adjustment after start     125176
      * date. This can only occur if CLDID *NE CLCID; for the side with   125176
      * the earlier start date there can be an adj. for the other side.   125176
     C           *IN70     IFEQ '1'                                       125176
     C           *IN51     ANDEQ'0'                                       125176
     C           DRECI     ANDEQ'S'                                       125176
     C           DHISD     ANDLTCHISD                                     125176
     C           SDAIC     IFNE *ZEROS                                    125176
     C           SDICI     ANDNE*BLANK                                    125176
     C           SSDCI     ANDEQ'Y'                                       125176
     C                     Z-ADDSDAIC     @GADJ                           125176
     C                     MOVE 'Y'       @ADJF                           125176
     C                     END                                            125176
     C           SCAIC     IFNE *ZEROS                                    125176
     C           SCICI     ANDNE*BLANK                                    125176
     C           SSCCI     ANDEQ'Y'                                       125176
     C                     Z-SUBSCAIC     @GADJ                           125176
     C                     MOVE 'Y'       @ADJF                           125176
     C                     END                                            125176
     C                     END                                            125176
      *                                                                   125176
     C           KLIST1    READEREHISL                   51               125176
     C                     ENDDO                                          125176
     C*
     C           *IN51     IFEQ '0'                        - B2
     C           WWHISD    ANDNEDHISD
     C           DRECI     ANDNE'S'
     C*
     C********** CDICT     IFLT 3                          - B1           182452
     C********** CCICT     ANDLT3                                         182452
     C           DDICT     IFLT 3                          - B1           182452
     C           DCICT     ANDLT3                                         182452
     C*
     C**  Process in case of interest type are both less than 3
     C*
     C********** WHISB     IFGT *ZEROS                     - B2           125176
     C*
     C****Process*when*change*rate*debit                                  125176
     C**  Output days/product/interest for debit side if relevant         125176
     C*
     C           DDRCI     IFEQ 'Y'                                       125176
     C           DDMVT     ORNE *ZEROS                                    125176
     C           DCMVT     ORNE *ZEROS                                    125176
     C           DMADI     ORNE *ZEROS                                    125176
     C           DHISD     IFGE CLDID                                     125176
     C           DHISD     ANDLTCHISD                                     125176
      *                                                                   125176
     C                     Z-ADDWDRCB     ZICALC
     C**********           Z-ADDWWHISD    ZIBEG                           125176
     C                     Z-ADDWHISDD    ZIBEG                           125176
     C                     Z-ADDDHISD     ZIEND
     C*
     C                     EXSR ZICD
     C*
     C                     Z-ADDZDAYN1    DAYS
     C                     Z-ADDDOHISB    HISB0
     C           HISB0     MULT DAYS      NUMB0
     C                     Z-ADDDDAID     INTD0
     C***********          Z-ADDDCAID     INTC0                           094337
     C**********           Z-SUBDCAID     INTC0                    094337 125176
     C*
     C           DAYS      IFNE *ZEROS                     - B3
     C*
     C***********WWHISD    IFGE CLDID                                      64051
     C********** WWHISD    IFGT CLDID                               64051 125176
     C*******************  EXSR OVERDR                                    094431
     C*******************  WRITESTOTDR                                    094431
     C                     MOVE 'DR'      DCFLAG  2                       094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C***********          END                                            125176
     C***********WWHISD    IFGE CLCID                                      64051
     C********** WWHISD    IFGT CLCID                               64051 125176
     C*******************  EXSR OVERCR                                    094431
     C*******************  WRITESTOTCR                                    094431
     C**********           MOVE 'CR'      DCFLAG                   094431 125176
     C**********           EXSR WST                 WRITE SUB TOT  094431 125176
     C**********           END                                            125176
     C*
     C* Charge report if necessary
     C*
     C**********           EXSR PRN1CH              chargesDetails1085713 125176
     C***********CCICI     IFNE *BLANK                     - B4           085713
     C***********DTHGAR    IFNE *ZERO                      - B5           085713
     C***********DTHGAN    ORNE *ZERO                                     085713
     C***********          Z-ADDDTHGAR    CHGR0                           085713
     C***********          Z-ADDDTHGAN    CHGN0                           085713
     C***********          Z-ADDNITMS     SNITMS                          085713
     C***********          WRITEPOSTCH                                    085713
     C***********          END                             - E5           085713
     C***********          END                             - E4           085713
     C*
     C                     END                             - E3
      *                                                                   125176
     C                     END                                            125176
     C                     END                                            125176
     C*
     C***********          ELSE                            - X2           125176
     C*
     C****Process*when*change*rate*credit                                 125176
     C**  Output days/product/interest for credit side if relevant        125176
     C*
     C           DCRCI     IFEQ 'Y'                                       125176
     C           DDMVT     ORNE *ZEROS                                    125176
     C           DCMVT     ORNE *ZEROS                                    125176
     C           DMACI     ORNE *ZEROS                                    125176
     C           DHISD     IFGE CLCID                                     125176
     C           DHISD     ANDLTCHISD                                     125176
      *                                                                   125176
     C                     Z-ADDWCRCB     ZICALC
     C***********          Z-ADDWWHISD    ZIBEG                           125176
     C                     Z-ADDWHISDC    ZIBEG                           125176
     C                     Z-ADDDHISD     ZIEND
     C*
     C                     EXSR ZICD
     C*
     C                     Z-ADDZDAYN1    DAYS
     C                     Z-ADDCOHISB    HISB0
     C           HISB0     MULT DAYS      NUMB0
     C***********          Z-ADDDDAID     INTD0                           125176
     C***********          Z-ADDDCAID     INTC0                           094337
     C                     Z-SUBDCAID     INTC0                           094337
     C*
     C           DAYS      IFNE *ZEROS                     - B3
     C*
     C***********WWHISD    IFGE CLDID                                     64051
     C********** WWHISD    IFGT CLDID                               64051 125176
     C*******************  EXSR OVERDR                                    094431
     C*******************  WRITESTOTDR                                    094431
     C***********          MOVE 'DR'      DCFLAG                   094431 125176
     C***********          EXSR WST                 WRITE SUB TOT  094431 125176
     C***********          END                                            125176
     C***********WWHISD    IFGE CLCID                                     64051
     C********** WWHISD    IFGT CLCID                               64051 125176
     C*******************  EXSR OVERCR                                    094431
     C*******************  WRITESTOTCR                                    094431
     C                     MOVE 'CR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C***********          END                                            125176
     C*
     C* Charge report if necessary
     C*
     C**********           EXSR PRN1CH              chargesDetails1085713 125176
     C***********CCICI     IFNE *BLANK                     - B4           085713
     C***********DTHGAR    IFNE *ZERO                      - B5           085713
     C***********DTHGAN    ORNE *ZERO                                     085713
     C***********          Z-ADDDTHGAR    CHGR0                           085713
     C***********          Z-ADDDTHGAN    CHGN0                           085713
     C***********          Z-ADDNITMS     SNITMS                          085713
     C***********          WRITEPOSTCH                                    085713
     C***********          END                             - E5           085713
     C***********          END                             - E4           085713
     C*
     C*
     C                     END                             - E3
     C*
     C                     END                             - E2
     C                     END                                            125176
     C*
     C                     ELSE                            - X1
     C*
     C********** CDICT     IFGT 2                          - B2           182452
     C********** CCICT     ANDGT2                                         182452
     C           DDICT     IFGT 2                          - B2           182452
     C           DCICT     ANDGT2                                         182452
     C*
     C**  Process in case of interest type are both greater than 3
     C*
     C**  Process output changing day
     C*
     C**********           Z-ADDWMNBL     HISB0                           182452
     C                     Z-ADDWHISB     HISB0                           182452
     C                     MOVE *ON       *IN25                           182452
     C*******************  EXSR OVERDR                                    094431
     C*******************  WRITESTOTDR                                    094431
     C                     MOVE 'DR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C*******************  EXSR OVERCR                                    094431
     C*******************  WRITESTOTCR                                    094431
     C                     MOVE 'CR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     MOVE *OFF      *IN25                           182452
     C*
     C           DRECI     IFEQ 'M'                        - B3
      *                                                                   182452
     C                     MOVE *ON       *IN26                           182452
      *                                                                   182452
      **  Transfer Midas date into DDMMMYY.                               182452
      *                                                                   182452
     C                     Z-ADDMHISD     ZDAYNO                          182452
     C                     EXSR ZDATE2                                    182452
     C                     MOVE ZADATE    WMNTA                           182452
     C*
     C           DSDAT     IFNE *ZEROS                     - B4
     C           MNBL      ANDGT*ZEROS
     C*
     C**  Process debit
     C*
     C                     Z-ADDWDRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDMHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C                     Z-ADDDINT      INTD0
     C                     Z-ADDMNBL      HISB0                           182452
     C           MNBL      MULT DAYS      NUMB0
     C           MHISD     IFGT CLDID                                      64051
     C*******************  EXSR OVERDR                                    094431
     C*******************  WRITESTOTDR                                    094431
     C                     MOVE 'DR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     END                                             64051
     C                     Z-ADDMHISD     WHISDD
     C                     Z-ADDMNBL      WMNBL
     C*
     C                     END                             - E4
     C*
     C           CSDAT     IFNE *ZEROS                     - B4
     C           MNBL      ANDLT*ZEROS
     C*
     C**  Process credit
     C*
     C                     Z-ADDWCRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDMHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C                     Z-SUBCINT      INTC0
     C                     Z-ADDMNBL      HISB0                           182452
     C           MNBL      MULT DAYS      NUMB0
     C           MHISD     IFGT CLCID                                      64051
     C*******************  EXSR OVERCR                                    094431
     C*******************  WRITESTOTCR                                    094431
     C                     MOVE 'CR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     END                                             64051
     C                     Z-ADDMHISD     WHISDC
     C                     Z-ADDMNBL      WMNBL
     C*
     C                     END                             - E4
     C                     MOVE *OFF      *IN26                           182452
     C*
     C**  Process until reading other than 'M'
     C*
     C           DRECI     DOWEQ'M'                        - B4
     C           *IN51     ANDEQ'0'
     C*
     C           KLIST1    READEREHISL                   51
     C*
     C           *IN51     IFEQ '0'                        - B5
     C*
     C           DRECI     IFEQ 'M'                        - B6
      *                                                                   182452
      **  Transfer Midas date into DDMMMYY.                               182452
      *                                                                   182452
     C                     Z-ADDMHISD     ZDAYNO                          182452
     C                     EXSR ZDATE2                                    182452
     C                     MOVE ZADATE    WMNTA                           182452
     C                     MOVE *ON       *IN26                           182452
     C*
     C           DSDAT     IFNE *ZEROS                     - B7
     C           MNBL      ANDGT*ZEROS
     C*
     C**  Process debit
     C*
     C                     Z-ADDWDRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDMHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C                     Z-ADDDINT      INTD0
     C                     Z-ADDMNBL      HISB0                           182452
     C           MNBL      MULT DAYS      NUMB0
     C           MHISD     IFGT CLDID                                      64051
     C*******************  EXSR OVERDR                                    094431
     C*******************  WRITESTOTDR                                    094431
     C                     MOVE 'DR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     END                                             64051
     C                     Z-ADDMHISD     WHISDD
     C                     Z-ADDMNBL      WMNBL
     C*
     C                     END                             - E7
     C*
     C           CSDAT     IFNE *ZEROS                     - B7
     C           MNBL      ANDLT*ZEROS
     C*
     C**  Process credit
     C*
     C                     Z-ADDWCRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDMHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C                     Z-SUBCINT      INTC0
     C                     Z-ADDMNBL      HISB0                           182452
     C           MNBL      MULT DAYS      NUMB0
     C           MHISD     IFGT CLCID                                      64051
     C*******************  EXSR OVERCR                                    094431
     C*******************  WRITESTOTCR                                    094431
     C                     MOVE 'CR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     END                                             64051
     C                     Z-ADDMHISD     WHISDC
     C                     Z-ADDMNBL      WMNBL
     C*
     C                     END                             - E7
     C                     MOVE *OFF      *IN26                           182452
     C*
     C                     ELSE                            - X6
     C                     MOVE *ON       *IN25                           182452
     C*
     C           DRECI     IFEQ 'S'                        - B7
     C*
     C**  Process a S record
     C*
     C***********SDICI     IFEQ 'Y'                        - B8          098818
     C           SDICI     IFNE *BLANKS                    - B8          098818
     C*
     C**  Process if debit capitalisation
     C*
     C                     Z-ADDWDRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDDHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C           SMNBL     MULT DAYS      NUMB0
     C*
     C           SMNBL     IFGT *ZEROS                     - B9
     C                     Z-ADDDINT      INTD0
     C                     Z-ADDWHISB     HISB0                           182452
     C           DHISD     IFGT CLDID                                      64051
     C*******************  EXSR OVERDR                                    094431
     C*******************  WRITESTOTDR                                    094431
     C                     MOVE 'DR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     END                                             64051
     C                     ELSE                            - X9
     C                     Z-SUBCINT      INTC0
     C                     Z-ADDWHISB     HISB0                           182452
     C           DHISD     IFGT CLCID                                      64051
     C*******************  EXSR OVERCR                                    094431
     C*******************  WRITESTOTCR                                    094431
     C                     MOVE 'CR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     END                                             64051
     C                     END                             - E9
     C*
     C                     Z-ADDDHISD     WHISDD
     C*
     C                     END                             - E8
     C*
     C***********SCICI     IFEQ 'Y'                        - B8          098818
     C           SCICI     IFNE *BLANKS                    - B8          098818
     C*
     C**  Process if credit capitalisation
     C*
     C                     Z-ADDWCRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDDHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C           SMNBL     MULT DAYS      NUMB0
     C*
     C           SMNBL     IFGT *ZEROS                     - B9
     C                     Z-ADDDINT      INTD0
     C                     Z-ADDWHISB     HISB0                           182452
     C           DHISD     IFGT CLDID                                      64051
     C*******************  EXSR OVERDR                                    094431
     C*******************  WRITESTOTDR                                    094431
     C                     MOVE 'DR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     END                                             64051
     C                     ELSE                            - X9
     C                     Z-SUBCINT      INTC0
     C                     Z-ADDWHISB     HISB0                           182452
     C           DHISD     IFGT CLCID                                      64051
     C*******************  EXSR OVERCR                                    094431
     C*******************  WRITESTOTCR                                    094431
     C                     MOVE 'CR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     END                                             64051
     C                     END                             - E9
     C*
     C                     Z-ADDDHISD     WHISDC
     C*
     C                     END                             - E8
     C*
      ** If MHISD is less than HISD, print another subtotal.              182452
      *                                                                   182452
     C                     ELSE                                           182452
     C           MHISD     IFLT HISD                                      182452
     C                     MOVE *ON       *IN25                           182452
     C                     Z-ADDWDRCB     ZICALC                          182452
     C                     Z-ADDMHISD     ZIBEG                           182452
     C                     Z-ADDHISD      ZIEND                           182452
     C                     EXSR ZICD                                      182452
     C                     Z-ADDZDAYN1    DAYS                            182452
     C                     Z-ADDWHISB     HISB0                           182452
     C                     MOVE 'DR'      DCFLAG                          182452
     C                     EXSR WST                                       182452
      *                                                                   182452
     C                     MOVE 'CR'      DCFLAG                          182452
     C                     EXSR WST                                       182452
     C                     MOVE *OFF      *IN25                           182452
     C                     ENDIF                                          182452
      *                                                                   182452
     C                     END                             - E7
      *                                                                   182452
     C                     MOVE *OFF      *IN25                           182452
     C*
     C                     END                             - E6
     C*
     C                     END                             - E5
     C*
     C                     END                             - E4
     C*
     C                     END                             - E3
     C*
     C                     ELSE                            - X2
     C*
     C********** CDICT     IFGT 2                          - B3           182452
     C********** CCICT     ANDLT3                                         182452
     C           DDICT     IFGT 2                          - B3           182452
     C           DCICT     ANDLT3                                         182452
     C*
     C**  Process in case of interest type credit is less than 3
     C**  and interest type debit is greater than 2
     C*
     C**  Process output changing day
     C*
     C                     MOVE *ON       *IN25                           182452
     C**********           Z-ADDWMNBL     HISB0                           182452
     C                     Z-ADDWHISB     HISB0                           182452
     C           DHISD     IFGT CLDID                                      64051
     C*******************  EXSR OVERDR                                    094431
     C*******************  WRITESTOTDR                                    094431
     C                     MOVE 'DR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     END                                             64051
     C                     MOVE *OFF      *IN25                           182452
     C           DHISD     IFGT CLCID                                      64051
     C*******************  EXSR OVERCR                                    094431
     C*******************  WRITESTOTCR                                    094431
     C                     MOVE 'CR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     END                                             64051
     C*
     C           DCRCI     IFEQ 'Y'                        - B4
     C*
     C**  Process when change rate credit
     C*
     C                     Z-ADDWCRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDDHISD     ZIEND
     C*
     C                     EXSR ZICD
     C*
     C                     Z-ADDZDAYN1    DAYS
     C                     Z-ADDWHISB     HISB0
     C           HISB0     MULT DAYS      NUMB0
     C           DDAID     SUB  WDAID     INTD0
     C           DCAID     SUB  WCAID     INTC0
     C                     Z-SUBINTC0     INTC0                           094337
     C*
     C           DAYS      IFNE *ZEROS                     - B5
     C*
     C           DHISD     IFGT CLDID                                      64051
     C*******************  EXSR OVERDR                                    094431
     C*******************  WRITESTOTDR                                    094431
     C                     MOVE 'DR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     END                                             64051
     C           DHISD     IFGT CLCID                                      64051
     C*******************  EXSR OVERCR                                    094431
     C*******************  WRITESTOTCR                                    094431
     C                     MOVE 'CR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     END                                             64051
     C*
     C* Charge report if necessary
     C*
     C                     EXSR PRN1CH                     chargesDetails1085713
     C***********CCICI     IFNE *BLANK                     - B6           085713
     C***********DTHGAR    IFNE *ZERO                      - B7           085713
     C***********DTHGAN    ORNE *ZERO                                     085713
     C***********          Z-ADDDTHGAR    CHGR0                           085713
     C***********          Z-ADDDTHGAN    CHGN0                           085713
     C***********          Z-ADDNITMS     SNITMS                          085713
     C***********          WRITEPOSTCH                                    085713
     C***********          END                             - E7           085713
     C***********          END                             - E6           085713
     C*
     C                     END                             - E5
     C*
     C                     END                             - E4
     C*
     C**  Process end of month or change rate for debit
     C*
     C           DRECI     IFEQ 'M'                        - B4
     C           DSDAT     ANDNE*ZEROS
     C*
      **  Transfer Midas Date into DDMMMYY.                               182452
      *                                                                   182452
     C                     Z-ADDMHISD     ZDAYNO                          182452
     C                     EXSR ZDATE2                                    182452
     C                     MOVE ZADATE    WMNTA                           182452
      *                                                                   182452
     C                     Z-ADDWDRCB     ZICALC
     C           WHISDD    IFEQ 0                                         064051
     C                     Z-ADDCLDID     WHISDD                          064051
     C                     END                                            064051
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDMHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C           MNBL      MULT DAYS      NUMB0
     C*
     C           MNBL      IFGT *ZEROS                     - B5
     C                     Z-ADDDINT      INTD0
     C                     Z-ADDMNBL      HISB0                           182452
     C           MHISD     IFGT CLDID                                      64051
     C*******************  EXSR OVERDR                                    094431
     C*******************  WRITESTOTDR                                    094431
     C                     MOVE *ON       *IN26                           182452
     C                     MOVE 'DR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     MOVE *OFF      *IN26                           182452
     C                     END                                             64051
     C**********           ELSE                            - X5           182452
     C**********           Z-SUBCINT      INTC0                           182452
     C********** MHISD     IFGT CLCID                               64051 182452
     C*******************  EXSR OVERCR                                    094431
     C*******************  WRITESTOTCR                                    094431
     C**********           MOVE 'CR'      DCFLAG                   094431 182452
     C**********           EXSR WST                        WRITE SU094431 182452
     C**********           END                                      64051 182452
     C                     END                             - E5
     C*
     C                     Z-ADDMHISD     WHISDD
     C                     Z-ADDMNBL      WMNBL
     C*
     C                     END                             - E4
     C*
     C           DRECI     DOWEQ'M'                        - B4
     C           *IN51     ANDEQ'0'
     C*
     C           KLIST1    READEREHISL                   51
     C*
     C           *IN51     IFEQ '0'                        - B5
     C*
     C           DRECI     IFEQ 'M'                        - B6
     C           DSDAT     ANDNE*ZEROS
      *                                                                   182452
      **  Transfer Midas Date into DDMMMYY.                               182452
      *                                                                   182452
     C                     Z-ADDMHISD     ZDAYNO                          182452
     C                     EXSR ZDATE2                                    182452
     C                     MOVE ZADATE    WMNTA                           182452
     C*
     C                     Z-ADDWDRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDMHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C           MNBL      MULT DAYS      NUMB0
     C*
     C           MNBL      IFGT *ZEROS                     - B7
     C                     Z-ADDDINT      INTD0
     C                     Z-ADDMNBL      HISB0                           182452
     C           MHISD     IFGT CLDID                                      64051
     C*******************  EXSR OVERDR                                    094431
     C*******************  WRITESTOTDR                                    094431
     C                     MOVE *ON       *IN26                           182452
     C                     MOVE 'DR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     MOVE *OFF      *IN26                           182452
     C                     END                                             64051
     C**********           ELSE                            - X7           182452
     C**********           Z-SUBCINT      INTC0                           182452
     C********** MHISD     IFGT CLCID                               64051 182452
     C*******************  EXSR OVERCR                                    094431
     C*******************  WRITESTOTCR                                    094431
     C**********           MOVE 'CR'      DCFLAG                   094431 182452
     C**********           EXSR WST                        WRITE SU094431 182452
     C**********           END                                      64051 182452
     C                     END                             - E7
     C*
     C                     Z-ADDMHISD     WHISDD
     C                     Z-ADDMNBL      WMNBL
     C*
     C                     ELSE                            - X6
     C*
     C                     MOVE *ON       *IN25                           182452
     C           DRECI     IFEQ 'S'                        - B7
     C***********SDICI     ANDEQ'Y'                                      098818
     C           SDICI     ANDNE*BLANKS                                  098818
     C*
     C                     Z-ADDWDRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDDHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C           SMNBL     MULT DAYS      NUMB0
     C*
     C           SMNBL     IFGT *ZEROS                     - B8
     C                     Z-ADDDINT      INTD0
     C                     Z-ADDWHISB     HISB0                           182452
     C           DHISD     IFGT CLDID                                      64051
     C*******************  EXSR OVERDR                                    094431
     C*******************  WRITESTOTDR                                    094431
     C                     MOVE 'DR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     END                                             64051
     C**********           ELSE                            - X8           182452
     C**********           Z-SUBCINT      INTC0                           182452
     C********** DHISD     IFGT CLCID                               64051 182452
     C*******************  EXSR OVERCR                                    094431
     C*******************  WRITESTOTCR                                    094431
     C**********           MOVE 'CR'      DCFLAG                   094431 182452
     C**********           EXSR WST                        WRITE SU094431 182452
     C**********           END                                      64051 182452
     C                     END                             - E8
     C*
      ** If MHISD is less than HISD, print another subtotal.              182452
      *                                                                   182452
     C                     ELSE                                           182452
     C           MHISD     IFLT HISD                                      182452
     C                     MOVE *ON       *IN25                           182452
     C                     Z-ADDWDRCB     ZICALC                          182452
     C                     Z-ADDMHISD     ZIBEG                           182452
     C                     Z-ADDHISD      ZIEND                           182452
     C                     EXSR ZICD                                      182452
     C                     Z-ADDZDAYN1    DAYS                            182452
     C                     Z-ADDWHISB     HISB0                           182452
     C                     MOVE 'DR'      DCFLAG                          182452
     C                     EXSR WST                                       182452
     C                     MOVE *OFF      *IN25                           182452
     C                     END                                            182452
     C                     Z-ADDDHISD     WHISDD
     C*
     C                     END                             - E7
     C*
     C                     MOVE *OFF      *IN25                           182452
      *                                                                   182452
     C                     END                             - E6
     C*
     C                     END                             - E5
     C*
     C                     END                             - E4
     C*
     C                     ELSE                            - X3
     C*
     C**  Process in case of interest type debit is less than 3
     C**  And interest type credit is greater than 2
     C*
     C**  Process output changing day
     C*
     C**********           Z-ADDWMNBL     HISB0                           182452
     C                     Z-ADDWHISB     HISB0                           182452
     C           DHISD     IFGT CLDID                                      64051
     C*******************  EXSR OVERDR                                    094431
     C*******************  WRITESTOTDR                                    094431
     C                     MOVE 'DR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     END                                             64051
     C                     MOVE *ON       *IN25                           182452
     C           DHISD     IFGT CLCID                                      64051
     C*******************  EXSR OVERCR                                    094431
     C*******************  WRITESTOTCR                                    094431
     C                     MOVE 'CR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     END                                             64051
     C                     MOVE *OFF      *IN25                           182452
     C*
     C           DDRCI     IFEQ 'Y'                        - B4
     C*
     C**  Debit rate change
     C*
     C                     Z-ADDWDRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDDHISD     ZIEND
     C*
     C                     EXSR ZICD
     C*
     C                     Z-ADDZDAYN1    DAYS
     C                     Z-ADDWHISB     HISB0
     C           HISB0     MULT DAYS      NUMB0
     C*
     C           DAYS      IFNE *ZEROS                     - B5
     C*
     C           DHISD     IFGT CLDID                                      64051
     C*******************  EXSR OVERDR                                    094431
     C*******************  WRITESTOTDR                                    094431
     C                     MOVE 'DR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     END                                             64051
     C           DHISD     IFGT CLCID                                      64051
     C*******************  EXSR OVERCR                                    094431
     C*******************  WRITESTOTCR                                    094431
     C                     MOVE 'CR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     END                                             64051
     C*
     C* Charge report if necessary
     C*
     C                     EXSR PRN1CH                     chargesDetails1085713
     C***********CCICI     IFNE *BLANK                     - B6           085713
     C***********DTHGAR    IFNE *ZERO                      - B7           085713
     C***********DTHGAN    ORNE *ZERO                                     085713
     C***********          Z-ADDDTHGAR    CHGR0                           085713
     C***********          Z-ADDDTHGAN    CHGN0                           085713
     C***********          Z-ADDNITMS     SNITMS                          085713
     C***********          WRITEPOSTCH                                    085713
     C***********          END                             - E7           085713
     C***********          END                             - E6           085713
     C*
     C                     END                             - E5
     C*
     C                     END                             - E4
     C*
     C**  Credit end of month or credit rate change
     C*
     C           DRECI     IFEQ 'M'                        - B4
     C           CSDAT     ANDNE*ZEROS
      *                                                                   182452
      **  Transfer Midas date into DDMMMYY.                               182452
      *                                                                   182452
     C                     Z-ADDMHISD     ZDAYNO                          182452
     C                     EXSR ZDATE2                                    182452
     C                     MOVE ZADATE    WMNTA                           182452
     C*
     C                     Z-ADDWCRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDMHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C           MNBL      MULT DAYS      NUMB0
     C*
     C           MNBL      IFGT *ZEROS                     - B5
     C                     Z-ADDDINT      INTD0
     C           MHISD     IFGT CLDID                                      64051
     C*******************  EXSR OVERDR                                    094431
     C*******************  WRITESTOTDR                                    094431
     C                     MOVE 'DR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     END                                             64051
     C                     ELSE                            - X5
     C                     Z-SUBCINT      INTC0
     C                     Z-ADDMNBL      HISB0                           182452
     C           MHISD     IFGT CLCID                                      64051
     C*******************  EXSR OVERCR                                    094431
     C*******************  WRITESTOTCR                                    094431
     C                     MOVE *ON       *IN26                           182452
     C                     MOVE 'CR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     MOVE *OFF      *IN26                           182452
     C                     END                                             64051
     C                     END                             - E5
     C*
     C                     Z-ADDMHISD     WHISDC
     C                     Z-ADDMNBL      WMNBL
     C*
     C                     END                             - E4
     C*
     C           DRECI     DOWEQ'M'                        - B4
     C           *IN51     ANDEQ'0'
      *                                                                   182452
      **  Transfer Midas date into DDMMMYY.                               182452
      *                                                                   182452
     C                     Z-ADDMHISD     ZDAYNO                          182452
     C                     EXSR ZDATE2                                    182452
     C                     MOVE ZADATE    WMNTA                           182452
     C*
     C           KLIST1    READEREHISL                   51
     C*
     C           *IN51     IFEQ '0'                        - B5
     C*
     C           DRECI     IFEQ 'M'                        - B6
     C           CSDAT     ANDNE*ZEROS
      *                                                                   182452
      **  Transfer Midas date into DDMMMYY.                               182452
      *                                                                   182452
     C                     Z-ADDMHISD     ZDAYNO                          182452
     C                     EXSR ZDATE2                                    182452
     C                     MOVE ZADATE    WMNTA                           182452
     C*
     C                     Z-ADDWCRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDMHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C           MNBL      MULT DAYS      NUMB0
     C*
     C           MNBL      IFGT *ZEROS                     - B7
     C                     Z-ADDDINT      INTD0
     C           MHISD     IFGT CLDID                                      64051
     C*******************  EXSR OVERDR                                    094431
     C*******************  WRITESTOTDR                                    094431
     C                     MOVE 'DR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     END                                             64051
     C                     ELSE                            - X7
     C                     Z-SUBCINT      INTC0
     C                     Z-ADDMNBL      HISB0                           182452
     C           MHISD     IFGT CLCID                                      64051
     C*******************  EXSR OVERCR                                    094431
     C*******************  WRITESTOTCR                                    094431
     C                     MOVE *ON       *IN26                           182452
     C                     MOVE 'CR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     MOVE *OFF      *IN26                           182452
     C                     END                                             64051
     C                     END                             - E7
     C*
     C                     Z-ADDMHISD     WHISDC
     C                     Z-ADDMNBL      WMNBL
     C*
     C                     ELSE                            - X6
     C*
     C                     MOVE *ON       *IN25                           182452
      *                                                                   182452
     C           DRECI     IFEQ 'S'                        - B7
     C***********SCICI     ANDEQ'Y'                                      098818
     C           SCICI     ANDNE*BLANKS                                  098818
     C*
     C                     Z-ADDWCRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDDHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C           SMNBL     MULT DAYS      NUMB0
     C*
     C           SMNBL     IFGT *ZEROS                     - B8
     C                     Z-ADDDINT      INTD0
     C           DHISD     IFGT CLDID                                      64051
     C*******************  EXSR OVERDR                                    094431
     C*******************  WRITESTOTDR                                    094431
     C                     MOVE 'DR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     END                                             64051
     C                     ELSE                            - X8
     C                     Z-SUBCINT      INTC0
     C                     Z-ADDWHISB     HISB0                           182452
     C           DHISD     IFGT CLCID                                      64051
     C*******************  EXSR OVERCR                                    094431
     C*******************  WRITESTOTCR                                    094431
     C                     MOVE 'CR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     END                                             64051
     C                     END                             - E8
     C*
      ** If MHISD is less than HISD, print another subtotal.              182452
      *                                                                   182452
     C                     ELSE                                           182452
     C           MHISD     IFLT HISD                                      182452
     C                     MOVE *ON       *IN25                           182452
     C                     Z-ADDWCRCB     ZICALC                          182452
     C                     Z-ADDMHISD     ZIBEG                           182452
     C                     Z-ADDHISD      ZIEND                           182452
     C                     EXSR ZICD                                      182452
     C                     Z-ADDZDAYN1    DAYS                            182452
     C                     Z-ADDWHISB     HISB0                           182452
     C                     MOVE 'CR'      DCFLAG                          182452
     C                     EXSR WST                                       182452
     C                     MOVE *OFF      *IN25                           182452
     C                     ENDIF                                          182452
     C                     Z-ADDDHISD     WHISDC
     C*
     C                     END                             - E7
     C*
     C                     MOVE *OFF      *IN25                           182452
      *                                                                   182452
     C                     END                             - E6
     C*
     C                     END                             - E5
     C*
     C                     END                             - E4
     C*
     C                     END                             - E3
     C*
     C                     END                             - E2
     C*
     C                     END                             - E1
     C*
     C                     END                             - E2
     C*
     C                     END                             - E1
     C*
      ** If CRE001 is switched ON and Overdraft Processed Ind. is 'Y'     CRE001
      ** then Output Overdraft Limit                                      CRE001
      *                                                                   CRE001
     C           CRE001    IFEQ 'Y'                          B1           CRE001
     C           ODLI      ANDEQ'Y'                          A1           CRE001
      *                                                                   CRE001
     C                     MOVE *BLANKS   ODLI                            CRE001
     C                     MOVE *BLANKS   PSTDO                           CRE001
     C                     Z-ADD*ZEROS    PPSTD                           CRE001
     C                     MOVE *BLANKS   PSTDA                           CRE001
      *                                                                   CRE001
      ** Convert Retail History Debit Date to DDMMMYY format              CRE001
     C           PVALD     IFNE WWHISD                       B2           CRE001
     C                     MOVELWWHISD    ZDAYNO                          CRE001
     C                     EXSR ZDATE2                                    CRE001
     C                     MOVE ZADATE    VALDO                           CRE001
      *                                                                   CRE001
      **  Handle Conversion Error.                                        CRE001
      *                                                                   CRE001
     C           ZERROR    IFNE 0                          - B3           CRE001
     C                     Z-ADDWWHISD    WDATE                           CRE001
     C                     Z-ADD421       DBASE                           CRE001
     C                     MOVEL'ZDAT2'   DBFILE           ***************CRE001
     C                     MOVELWDATE     DBKEY            **DB ERROR 421*CRE001
     C                     MOVEA'1'       *IN,89           ***************CRE001
     C                     EXSR DBSR                                      CRE001
     C                     ENDIF                           - E3           CRE001
      *                                                                   CRE001
      ** Set Pervious Posting Value to Current Retail History DR Date     CRE001
     C                     Z-ADDWWHISD    PVALD                           CRE001
      *                                                                   CRE001
     C                     ENDIF                           - E2           CRE001
      *                                                                   CRE001
     C                     MOVE VALDO     VALDA                           CRE001
      *                                                                   CRE001
     C                     MOVELNAR,39    NARR                            CRE001
      *                                                                   CRE001
     C                     Z-ADD*ZERO     WODRL  150                      CRE001
     C                     SELEC                                          CRE001
     C           DPA,I     WHEQ 0                                         CRE001
     C                     Z-ADDODRL      WODRL                           CRE001
     C           DPA,I     WHEQ 1                                         CRE001
     C           ODRL      MULT 10        WODRL                           CRE001
     C           DPA,I     WHEQ 2                                         CRE001
     C           ODRL      MULT 100       WODRL                           CRE001
     C           DPA,I     WHEQ 3                                         CRE001
     C           ODRL      MULT 1000      WODRL                           CRE001
     C                     ENDSL                                          CRE001
      *                                                                   CRE001
     C           WODRL     IFGT *ZEROS                     - B2           CRE001
     C                     Z-ADDWODRL     PSTD0                           CRE001
     C                     ELSE                            - X2           CRE001
     C                     Z-SUBWODRL     PSTD0                           CRE001
     C                     ENDIF                           - E2           CRE001
      *                                                                   CRE001
      **  Output Posting for Debit and Credit                             CRE001
      *                                                                   CRE001
     C                     EXSR OVERDR                                    CRE001
     C                     WRITEPOSTDR                                    CRE001
      *                                                                   CRE001
     C                     ENDIF                             E1           CRE001
      *                                                                   CRE001
     C           *IN51     DOWEQ'0'                        - B1
     C           DHISD     ANDLTCHISD
     C*
     C                     MOVEA'00'      *IN,53
      *                                                                   125176
      * Reported generated adjustment if found                            125176
     C           @ADJF     IFEQ 'Y'                                       125176
     C                     EXSR #ADJ                                      125176
      *                                                                   125176
     C           DHISD     IFGT CLDID                                     125176
     C                     EXSR OVERDR                                    125176
     C                     WRITEPOSTDR                                    125176
     C                     END                                            125176
     C           DHISD     IFGT CLCID                                     125176
     C                     EXSR OVERCR                                    125176
     C                     WRITEPOSTCR                                    125176
     C                     END                                            125176
      *                                                                   125176
     C           DHISD     IFGE CLDID                                     125176
     C                     MOVE '1'       *IN54                           125176
     C                     END                                            125176
     C           DHISD     IFGE CLCID                                     125176
     C                     MOVE '1'       *IN53                           125176
     C                     END                                            125176
     C                     END                                            125176
     C*
     C**  Process posting at the same date
     C*
     C           *IN50     DOWEQ'0'                        - B2
     C           DHISD     ANDEQHISD
     C*
     C           PPSTD     IFNE PSTD                       - B1
     C                     Z-ADDPSTD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    PSTDO
     C*
     C                     Z-ADDPSTD      PPSTD
     C*
     C                     END                             - E1
     C*
     C                     MOVE PSTDO     PSTDA
     C*
     C           PVALD     IFNE HISD                       - B1
     C                     Z-ADDHISD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALDO
     C*
     C                     Z-ADDHISD      PVALD
     C*
     C                     END                             - E1
     C*
     C                     MOVE VALDO     VALDA
     C*
     C                     MOVELPNAR      NARR
     C*
     C           DRCR      IFEQ 0                          - B1
     C                     Z-ADDPSTA      PSTD0
     C                     ELSE                            - X1
     C                     Z-SUBPSTA      PSTD0
     C                     END                             - E1
     C*
     C**  OUTPUT POSTING FOR DEBIT AND CREDIT
     C*
     C***********CLDID     IFLE HISD                                       64051
     C           HISD      IFGE CLDID                                      64051
     C***********HISD      ORLT CLDID                               64051 125176
     C***********PSTD      ANDGECLDID                               64051 125176
     C                     EXSR OVERDR
     C                     WRITEPOSTDR
     C/COPY WNCPYSRC,RE3761C033
     C                     MOVE '1'       *IN54
     C                     END
     C***********CLCID     IFLE HISD                                     064051
     C           HISD      IFGE CLCID                                    064051
     C***********HISD      ORLT CLCID                              064051 125176
     C***********PSTD      ANDGECLCID                              064051 125176
     C                     EXSR OVERCR
     C/COPY WNCPYSRC,RE3761C034
     C                     WRITEPOSTCR
     C                     MOVE '1'       *IN53
     C                     END
     C*
     C* CHARGE REPORT IF NECESSARY
     C*
     C           HISD      IFGE CLCID                                     125176
     C                     EXSR PRN2CH                     chargesDetails2085713
     C                     END                                            125176
     C***********CCICI     IFNE *BLANK                                    085713
     C***********CHGA      ANDNE*ZERO                                     085713
     C***********REBI      IFEQ 'Y'                                       085713
     C***********          Z-ADDCHGA      CHGR0                           085713
     C***********          Z-ADD*ZERO     CHGN0                           085713
     C***********          ELSE                                           085713
     C***********          Z-ADDCHGA      CHGN0                           085713
     C***********          Z-ADD*ZERO     CHGR0                           085713
     C***********          END                                            085713
     C***********          Z-ADDNITMS     SNITMS                          085713
     C***********          WRITEPOSTCH                                    085713
     C***********          END                                            085713
     C*
     C           KLIST1    READEREHPOPL                  50
     C*
     C                     END                             - E2
     C*
     C**  print the manual adjustment
     C*
     C           DMADI     IFNE *ZEROS
     C           DMACI     ORNE *ZEROS
     C*
     C           KLIST9    SETLLREHPOML2                 56
     C           KLIST9    READEREHPOML2                 56
     C           *IN56     DOWEQ'0'
     C*
     C           PPSTD     IFNE MAHISD                     - B1
     C                     Z-ADDMAHISD    ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    PSTDO
     C*
     C                     END                             - E1
     C*
     C                     MOVE PSTDO     PSTDA
     C*
     C           PVALD     IFNE VALD                       - B1
     C                     Z-ADDVALD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALDO
     C*
     C                     Z-ADDVALD      PVALD
     C*
     C                     END                             - E1
     C*
     C                     MOVE VALDO     VALDA
     C*
     C                     MOVELNAR,29    NARR
     C*
     C           DRIA      IFNE *ZEROS
     C           MAHISD    ANDGECLDID                                     125176
     C                     Z-ADDDRIA      INTD0
     C******************   EXSR OVERDR                                    094431
     C******************   WRITEMADJDR                                    094431
     C                     MOVE 'DR'      DCFLAG                          094431
     C                     EXSR WMA                        WRITE MAN ADJ  094431
     C                     Z-ADD*ZEROS    INTD0
     C                     MOVE '1'       *IN54
     C                     END
     C*
     C           CRIA      IFNE *ZEROS
     C           MAHISD    ANDGECLCID                                     125176
     C                     Z-ADDCRIA      INTC0
     C*******************  EXSR OVERCR                                    094431
     C*******************  WRITEMADJCR                                    094431
     C                     MOVE 'CR'      DCFLAG                          094431
     C                     EXSR WMA                        WRITE MAN ADJ  094431
     C                     Z-ADD*ZEROS    INTC0
     C                     MOVE '1'       *IN53
     C                     END
     C*
     C           KLIST9    READEREHPOML2                 56
     C*
     C                     END
     C*
     C                     END
     C*
     C*
     C**  Process in case there is one rate change
     C*
     C                     EXSR RATESR
     C*
     C**  Output subtotal line
     C*
     C           *IN51     IFEQ '0'                        - B2
     C           DHISD     ANDLTCHISD
     C*
     C**  Check interest type
     C*
     C********** CDICT     IFLT 3                          - B1           182452
     C********** CCICT     ANDLT3                                         182452
     C           DDICT     IFLT 3                          - B1           182452
     C           DCICT     ANDLT3                                         182452
     C*
     C**  Process in case of interest type are both less than 3
     C*
     C           DRECI     IFEQ 'D'
     C           DCMVT     ANDNE*ZEROS
     C           DDMVT     ORNE *ZEROS
     C           DRECI     ANDEQ'D'
     C           DMACI     ORNE *ZEROS
     C           DRECI     ANDEQ'D'
     C           DCRCI     ORNE *BLANKS
     C           DRECI     ANDEQ'D'
     C           @ADJF     OREQ 'Y'                                       125176
     C           DRECI     ANDEQ'D'                                       125176
     C           DRECI     OREQ 'S'
     C           SDRIP     ANDNE*ZEROS
     C           DRECI     OREQ 'S'
     C           SCRIP     ANDNE*ZEROS
     C*
     C***********WHISBC    IFGT *ZEROS                     - B3           125176
     C           WHISBC    IFGE *ZEROS                     - B3           125176
     C*
     C****Process*when*change*rate*debit                                  125176
     C**  Output days/product/interest line for credit                    125176
     C*
     C***********          Z-ADDWDRCBC    ZICALC                          125176
     C                     Z-ADDWCRCBC    ZICALC                          125176
     C                     Z-ADDWHISDC    ZIBEG
     C                     Z-ADDDHISD     ZIEND
     C*
     C                     EXSR ZICD
     C*
     C                     Z-ADDZDAYN1    DAYS
     C                     Z-ADDWHISBC    HISB0
     C           HISB0     MULT DAYS      NUMB0
     C*
     C                     Z-ADD*ZEROS    INTC0
     C           DAYS      IFGT *ZEROS                     - B3
     C*
     C           WHISDC    IFGE CLCID                      - B4
     C*******************  EXSR OVERCR                                    094431
     C*******************  WRITESTOTCR                                    094431
     C                     MOVE 'CR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     END                             - E4
     C                     END                             - E3
     C                     ELSE                            - X2
     C                     Z-ADDWCRCBC    ZICALC
     C                     Z-ADDWHISDC    ZIBEG
     C                     Z-ADDDHISD     ZIEND
     C*
     C                     EXSR ZICD
     C*
     C                     Z-ADDZDAYN1    DAYS
     C                     Z-ADDWHISBC    HISB0
     C           HISB0     MULT DAYS      NUMB0
     C***********DCAID     SUB  WCAIDC    INTC0                           094337
     C           DCAID     SUB  WCAIDD    INTC0                           094337
     C           DRECI     IFEQ 'S'
     C***********SCICI     IFEQ 'Y'                                       098818
     C           SCICI     IFNE *BLANKS                                   098818
     C***********SCRIP     SUB  WCAIDC    INTC0                           094337
     C           SCRIP     SUB  WCAIDD    INTC0                           094337
     C                     ADD  SGACI     INTC0
     C***********          Z-SUBINTC0     INTC0                     094337094674
     C                     ELSE
     C***********SCAIC     SUB  WCAIDC    INTC0                           094337
     C           SCAIC     SUB  WCAIDD    INTC0                           094337
     C***********          Z-SUBINTC0     INTC0                     094337094674
     C                     END
     C                     END
     C                     Z-SUBINTC0     INTC0                           094674
     C*
     C           DAYS      IFGT *ZEROS                     - B3
     C*
     C           WHISDC    IFGE CLCID                      - B4
     C*******************  EXSR OVERCR                                    094431
     C*******************  WRITESTOTCR                                    094431
     C                     MOVE 'CR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     END                             - E4
     C                     END                             - E3
     C                     END                             - E2
     C                     END                             - E2
     C*
     C           DDMVT     IFNE *ZEROS
     C           DRECI     ANDEQ'D'
     C           DCMVT     ORNE *ZEROS
     C           DRECI     ANDEQ'D'
     C           DMADI     ORNE *ZEROS
     C           DRECI     ANDEQ'D'
     C           DDRCI     ORNE *BLANKS
     C           DRECI     ANDEQ'D'
     C           @ADJF     OREQ 'Y'                                       125176
     C           DRECI     ANDEQ'D'                                       125176
     C           DRECI     OREQ 'S'
     C           SDRIP     ANDNE*ZEROS
     C           DRECI     OREQ 'S'
     C           SCRIP     ANDNE*ZEROS
     C*
     C           WHISBD    IFGT *ZEROS                     - B3
     C*
     C****Process*when*change*rate*debit                                  125176
     C**  Output days/product/interest line for debit                     125176
     C*
     C                     Z-ADDWDRCBD    ZICALC
     C                     Z-ADDWHISDD    ZIBEG
     C                     Z-ADDDHISD     ZIEND
     C*
     C                     EXSR ZICD
     C*
     C                     Z-ADDZDAYN1    DAYS
     C                     Z-ADDWHISBD    HISB0
     C           HISB0     MULT DAYS      NUMB0
     C           DDAID     SUB  WDAIDD    INTD0
     C           DRECI     IFEQ 'S'                        - B4
     C***********SDICI     IFEQ 'Y'                        - B5          098818
     C           SDICI     IFNE *BLANKS                    - B5          098818
     C           SDRIP     SUB  WDAIDD    INTD0
     C                     ADD  SGADI     INTD0
     C                     ELSE                            - X5
     C           SDAIC     SUB  WDAIDD    INTD0
     C                     END                             - E5
     C                     END                             - E4
     C*
     C           DAYS      IFGT *ZEROS                     - B4
     C*
     C           WHISDD    IFGE CLDID                      - B5
     C*******************  EXSR OVERDR                                    094431
     C*******************  WRITESTOTDR                                    094431
     C                     MOVE 'DR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     END                             - E5
     C                     END                             - E4
     C                     ELSE                            - X3
     C***********          Z-ADDWCRCBD    ZICALC                          125176
     C                     Z-ADDWDRCBD    ZICALC                          125176
     C                     Z-ADDWHISDD    ZIBEG
     C                     Z-ADDDHISD     ZIEND
     C*
     C                     EXSR ZICD
     C*
     C                     Z-ADDZDAYN1    DAYS
     C                     Z-ADDWHISBD    HISB0
     C           HISB0     MULT DAYS      NUMB0
     C                     Z-ADD*ZEROS    INTD0
     C*
     C           DAYS      IFGT *ZEROS                     - B4
     C*
     C           WHISDD    IFGE CLDID                      - B5
     C*******************  EXSR OVERDR                                    094431
     C*******************  WRITESTOTDR                                    094431
     C                     MOVE 'DR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     END                             - E5
     C                     END                             - E4
     C                     END                             - E3
     C                     END                             - E2
     C*
     C* Charge report if necessary
     C*
     C**********           EXSR PRN1CH              chargesDetails1085713 125176
     C***********CCICI     IFNE *BLANK                     - B4           085713
     C***********DTHGAR    IFNE *ZERO                      - B5           085713
     C***********DTHGAN    ORNE *ZERO                                     085713
     C***********          Z-ADDDTHGAR    CHGR0                           085713
     C***********          Z-ADDDTHGAN    CHGN0                           085713
     C***********          Z-ADDNITMS     SNITMS                          085713
     C***********          WRITEPOSTCH                                    085713
     C***********          END                             - E5           085713
     C***********          END                             - E4           085713
     C*
     C                     ELSE                            - X1
     C*
     C********** CDICT     IFGT 2                          - B2           182452
     C********** CCICT     ANDGT2                                         182452
     C           DDICT     IFGT 2                          - B2           182452
     C           DCICT     ANDGT2                                         182452
     C*
     C**  Process in case of interest type are both greater than 3
     C*
     C**  Process output changing day
     C*
     C           RECI      IFNE 'M'                                       182452
     C                     Z-ADDDHISD     ZIEND                           182452
     C                     ELSE                                           182452
     C                     Z-ADDMHISD     ZIEND                           182452
     C                     ENDIF                                          182452
      *                                                                   182452
     C                     MOVE *ON       *IN25                           182452
     C                     Z-ADDWDRCB     ZICALC                          182452
     C                     Z-ADDWHISDD    ZIBEG                           182452
     C                     EXSR ZICD                                      182452
     C                     Z-ADDZDAYN1    DAYS                            182452
     C**********           Z-ADDWMNBL     HISB0                           182452
     C                     Z-ADDWHISB     HISB0                           182452
     C*******************  EXSR OVERDR                                    094431
     C*******************  WRITESTOTDR                                    094431
     C                     MOVE 'DR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
      *                                                                   182452
     C                     Z-ADDWCRCB     ZICALC                          182452
     C                     Z-ADDWHISDC    ZIBEG                           182452
     C                     EXSR ZICD                                      182452
     C                     Z-ADDZDAYN1    DAYS                            182452
     C                     Z-ADDWHISB     HISB0                           182452
     C*******************  EXSR OVERCR                                    094431
     C*******************  WRITESTOTCR                                    094431
     C                     MOVE 'CR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     MOVE *OFF      *IN25                           182452
     C*
     C           DRECI     IFEQ 'M'                        - B3
     C*
     C                     MOVE *ON       *IN26                           182452
      *                                                                   182452
      **  Transfer Midas date into DDMMMYY.                               182452
      *                                                                   182452
     C                     Z-ADDMHISD     ZDAYNO                          182452
     C                     EXSR ZDATE2                                    182452
     C                     MOVE ZADATE    WMNTA                           182452
      *                                                                   182452
     C           DSDAT     IFNE *ZEROS                     - B4
     C           MNBL      ANDGT*ZEROS
     C*
     C**  Process debit
     C*
     C           RVALDD    IFGT WSMNTD                                    182452
     C                     Z-ADDRVALDD    WSMNTD                          182452
     C                     ENDIF                                          182452
     C                     Z-ADDWDRCB     ZICALC
     C**********           Z-ADDWWHISD    ZIBEG                           182452
     C                     Z-ADDWSMNTD    ZIBEG                           182452
     C                     Z-ADDMHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C                     Z-ADDDINT      INTD0
     C                     Z-ADDMNBL      HISB0                           182452
     C           MNBL      MULT DAYS      NUMB0
     C           MHISD     IFGT CLDID                                      64051
     C*******************  EXSR OVERDR                                    094431
     C*******************  WRITESTOTDR                                    094431
     C                     MOVE 'DR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     END                                             64051
     C                     Z-ADDMHISD     WHISDD
     C                     Z-ADDMHISD     WSMNTD                          182452
     C                     Z-ADDMNBL      WMNBL
     C*
     C                     END                             - E4
     C*
     C           CSDAT     IFNE *ZEROS                     - B4
     C           MNBL      ANDLT*ZEROS
     C*
     C**  Process credit
     C*
     C           RVALDC    IFGT WSMNTC                                    182452
     C                     Z-ADDRVALDC    WSMNTC                          182452
     C                     ENDIF                                          182452
     C                     Z-ADDWCRCB     ZICALC
     C**********           Z-ADDWWHISD    ZIBEG                           182452
     C                     Z-ADDWSMNTC    ZIBEG                           182452
     C                     Z-ADDMHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C                     Z-SUBCINT      INTC0
     C                     Z-ADDMNBL      HISB0                           182452
     C           MNBL      MULT DAYS      NUMB0
     C           MHISD     IFGT CLCID                                      64051
     C*******************  EXSR OVERCR                                    094431
     C*******************  WRITESTOTCR                                    094431
     C                     MOVE 'CR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     END                                             64051
     C                     Z-ADDMHISD     WHISDC
     C                     Z-ADDMHISD     WSMNTC                          182452
     C                     Z-ADDMNBL      WMNBL
     C*
     C                     END                             - E4
      *                                                                   182452
     C                     MOVE *OFF      *IN26                           182452
     C*
     C**  Process until reading other than 'M'
     C*
     C           DRECI     DOWEQ'M'                        - B4
     C           *IN51     ANDEQ'0'
     C*
     C           KLIST1    READEREHISL                   51
     C*
     C           *IN51     IFEQ '0'                        - B5
     C*
     C           DRECI     IFEQ 'M'                        - B6
      *                                                                   182452
      **  Transfer Midas date into DDMMMYY.                               182452
      *                                                                   182452
     C                     Z-ADDMHISD     ZDAYNO                          182452
     C                     EXSR ZDATE2                                    182452
     C                     MOVE ZADATE    WMNTA                           182452
     C*
     C                     MOVE *ON       *IN26                           182452
     C           DSDAT     IFNE *ZEROS                     - B7
     C           MNBL      ANDGT*ZEROS
     C*
     C**  Process debit
     C*
     C                     Z-ADDWDRCB     ZICALC
     C**********           Z-ADDWWHISD    ZIBEG                           182452
     C                     Z-ADDWSMNTD    ZIBEG                           182452
     C                     Z-ADDMHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C                     Z-ADDDINT      INTD0
     C                     Z-ADDMNBL      HISB0                           182452
     C           MNBL      MULT DAYS      NUMB0
     C           MHISD     IFGT CLDID                                      64051
     C*******************  EXSR OVERDR                                    094431
     C*******************  WRITESTOTDR                                    094431
     C                     MOVE 'DR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     END                                             64051
     C                     Z-ADDMHISD     WHISDD
     C                     Z-ADDMHISD     WSMNTD                          182452
     C                     Z-ADDMNBL      WMNBL
     C*
     C                     END                             - E7
     C*
     C           CSDAT     IFNE *ZEROS                     - B7
     C           MNBL      ANDLT*ZEROS
     C*
     C**  Process credit
     C*
     C                     Z-ADDWCRCB     ZICALC
     C**********           Z-ADDWWHISD    ZIBEG                           182452
     C                     Z-ADDWSMNTC    ZIBEG                           182452
     C                     Z-ADDMHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C                     Z-SUBCINT      INTC0
     C                     Z-ADDMNBL      HISB0                           182452
     C           MNBL      MULT DAYS      NUMB0
     C           MHISD     IFGT CLCID                                      64051
     C*******************  EXSR OVERCR                                    094431
     C*******************  WRITESTOTCR                                    094431
     C                     MOVE 'CR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     END                                             64051
     C                     Z-ADDMHISD     WHISDC
     C                     Z-ADDMHISD     WSMNTC                          182452
     C                     Z-ADDMNBL      WMNBL
     C*
     C                     END                             - E7
      *                                                                   182452
     C                     MOVE *OFF      *IN26                           182452
     C*
     C                     ELSE                            - X6
     C*
     C                     MOVE *ON       *IN25                           182452
      *                                                                   182452
     C           DRECI     IFEQ 'S'                        - B7
     C*
     C**  Process a S record
     C*
     C***********SDICI     IFEQ 'Y'                        - B8          098818
     C           SDICI     IFNE *BLANKS                    - B8          098818
     C*
     C**  Process if debit capitalisation
     C*
     C                     Z-ADDWDRCB     ZICALC
     C**********           Z-ADDWWHISD    ZIBEG                           182452
     C                     Z-ADDWSMNTD    ZIBEG                           182452
     C                     Z-ADDDHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C           SMNBL     MULT DAYS      NUMB0
     C*
     C           SMNBL     IFGT *ZEROS                     - B9
     C                     Z-ADDDINT      INTD0
     C                     Z-ADDWHISB     HISB0                           182452
     C           DHISD     IFGT CLDID                                      64051
     C*******************  EXSR OVERDR                                    094431
     C*******************  WRITESTOTDR                                    094431
     C                     MOVE 'DR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     END                                             64051
     C                     ELSE                            - X9
     C                     Z-SUBCINT      INTC0
     C                     Z-ADDWHISB     HISB0                           182452
     C           DHISD     IFGT CLCID                                      64051
     C*******************  EXSR OVERCR                                    094431
     C*******************  WRITESTOTCR                                    094431
     C                     MOVE 'CR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     END                                             64051
     C                     END                             - E9
     C*
     C                     Z-ADDDHISD     WHISDD
     C*
     C                     END                             - E8
     C*
     C***********SCICI     IFEQ 'Y'                        - B8          098818
     C           SCICI     IFNE *BLANKS                    - B8          098818
     C*
     C**  Process if credit capitalisation
     C*
     C                     Z-ADDWCRCB     ZICALC
     C**********           Z-ADDWWHISD    ZIBEG                          182452
     C                     Z-ADDWSMNTC    ZIBEG                          182452
     C                     Z-ADDDHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C           SMNBL     MULT DAYS      NUMB0
     C*
     C           SMNBL     IFGT *ZEROS                     - B9
     C                     Z-ADDDINT      INTD0
     C                     Z-ADDWHISB     HISB0                          182452
     C           DHISD     IFGT CLDID                                      64051
     C*******************  EXSR OVERDR                                    094431
     C*******************  WRITESTOTDR                                    094431
     C                     MOVE 'DR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     END                                             64051
     C                     ELSE                            - X9
     C                     Z-SUBCINT      INTC0
     C           DHISD     IFGT CLCID                                      64051
     C*******************  EXSR OVERCR                                    094431
     C*******************  WRITESTOTCR                                    094431
     C                     MOVE 'CR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     END                                             64051
     C                     END                             - E9
     C*
     C                     Z-ADDDHISD     WHISDC
     C*
     C                     END                             - E8
     C*
      ** If MHISD is less than HISD, print another subtotal.              182452
      *                                                                   182452
     C                     ELSE                                           182452
     C           MHISD     IFLT HISD                                      182452
     C                     MOVE *ON       *IN25                           182452
     C                     Z-ADDWDRCB     ZICALC                          182452
     C                     Z-ADDMHISD     ZIBEG                           182452
     C                     Z-ADDHISD      ZIEND                           182452
     C                     EXSR ZICD                                      182452
     C                     Z-ADDZDAYN1    DAYS                            182452
     C                     Z-ADDWHISB     HISB0                           182452
     C                     MOVE 'DR'      DCFLAG                          182452
     C                     EXSR WST                                       182452
      *                                                                   182452
     C                     MOVE 'CR'      DCFLAG                          182452
     C                     EXSR WST                                       182452
     C                     MOVE *OFF      *IN25                           182452
     C                     ENDIF                                          182452
     C                     END                             - E7
     C*
     C                     MOVE *OFF      *IN25                           182452
      *                                                                   182452
     C                     END                             - E6
     C*
     C                     END                             - E5
     C*
     C                     END                             - E4
     C*
     C                     END                             - E3
     C*
     C                     ELSE                            - X2
     C*
     C********** CDICT     IFGT 2                          - B3           182452
     C********** CCICT     ANDLT3                                         182452
     C           DDICT     IFGT 2                          - B3           182452
     C           DCICT     ANDLT3                                         182452
     C*
     C**  Process in case of interest type credit is less than 3
     C**  and interest type debit is greater than 2
     C*
     C**  Process output changing day
     C*
     C           RECI      IFNE 'M'                                       182452
     C                     Z-ADDDHISD     ZIEND                           182452
     C                     ELSE                                           182452
     C                     Z-ADDMHISD     ZIEND                           182452
     C                     ENDIF                                          182452
      *                                                                   182452
     C                     MOVE *ON       *IN25                           182452
     C**********           Z-ADDWMNBL     HISB0                           182452
     C                     Z-ADDWHISB     HISB0                           182452
     C           DHISD     IFGT CLDID                                      64051
     C*******************  EXSR OVERDR                                    094431
     C*******************  WRITESTOTDR                                    094431
     C                     Z-ADDWDRCB     ZICALC                          182452
     C                     Z-ADDWHISDD    ZIBEG                           182452
     C                     EXSR ZICD                                      182452
     C                     Z-ADDZDAYN1    DAYS                            182452
     C                     MOVE 'DR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     END                                             64051
     C                     MOVE *OFF      *IN25                           182452
      *                                                                   182452
     C           DHISD     IFGT CLCID                                      64051
     C*******************  EXSR OVERCR                                    094431
     C*******************  WRITESTOTCR                                    094431
     C                     Z-ADDWCRCB     ZICALC                          182452
     C                     Z-ADDWHISDC    ZIBEG                           182452
     C                     EXSR ZICD                                      182452
     C                     Z-ADDZDAYN1    DAYS                            182452
     C                     MOVE 'CR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     END                                             64051
     C*
     C           DCRCI     IFEQ 'Y'                        - B4
     C*
     C**  Process when change rate credit
     C*
     C                     Z-ADDWCRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDDHISD     ZIEND
     C*
     C                     EXSR ZICD
     C*
     C                     Z-ADDZDAYN1    DAYS
     C                     Z-ADDWHISB     HISB0
     C           HISB0     MULT DAYS      NUMB0
     C           DDAID     SUB  WDAID     INTD0
     C           DCAID     SUB  WCAID     INTC0
     C                     Z-SUBINTC0     INTC0                           094337
     C*
     C           DAYS      IFNE *ZEROS                     - B5
     C*
     C           DHISD     IFGT CLDID                                      64051
     C*******************  EXSR OVERDR                                    094431
     C*******************  WRITESTOTDR                                    094431
     C                     MOVE 'DR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     END                                             64051
     C           DHISD     IFGT CLCID                                      64051
     C*******************  EXSR OVERCR                                    094431
     C*******************  WRITESTOTCR                                    094431
     C                     MOVE 'CR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     END                                             64051
     C*
     C* Charge report if necessary
     C*
     C                     EXSR PRN1CH                     chargesDetails1085713
     C***********CCICI     IFNE *BLANK                     - B6           085713
     C***********DTHGAR    IFNE *ZERO                      - B7           085713
     C***********DTHGAN    ORNE *ZERO                                     085713
     C***********          Z-ADDDTHGAR    CHGR0                           085713
     C***********          Z-ADDDTHGAN    CHGN0                           085713
     C***********          Z-ADDNITMS     SNITMS                          085713
     C***********          WRITEPOSTCH                                    085713
     C***********          END                             - E7           085713
     C***********          END                             - E6           085713
     C*
     C                     END                             - E5
     C*
     C                     END                             - E4
     C*
     C**  Process end of month or change rate for debit
     C*
     C           DRECI     IFEQ 'M'                        - B4
     C           DSDAT     ANDNE*ZEROS
     C*
      **  Transfer Midas Date into DDMMMYY.                               182452
      *                                                                   182452
     C                     Z-ADDMHISD     ZDAYNO                          182452
     C                     EXSR ZDATE2                                    182452
     C                     MOVE ZADATE    WMNTA                           182452
      *                                                                   182452
     C           RVALDD    IFGT WSMNTD                                    182452
     C                     Z-ADDRVALDD    WSMNTD                          182452
     C                     ENDIF                                          182452
      *                                                                   182452
     C                     Z-ADDWDRCB     ZICALC
     C**********           Z-ADDWWHISD    ZIBEG                           182452
     C                     Z-ADDWSMNTD    ZIBEG                           182452
     C                     Z-ADDMHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C                     Z-ADDMNBL      HISB0                           182452
     C           MNBL      MULT DAYS      NUMB0
     C*
     C           MNBL      IFGT *ZEROS                     - B5
     C                     Z-ADDDINT      INTD0
     C           MHISD     IFGT CLDID                                      64051
     C*******************  EXSR OVERDR                                    094431
     C*******************  WRITESTOTDR                                    094431
     C                     MOVE *ON       *IN26                           182452
     C                     MOVE 'DR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     MOVE *OFF      *IN26                           182452
     C                     END                                             64051
     C**********           ELSE                            - X5           182452
     C**********           Z-SUBCINT      INTC0                           182452
     C********** MHISD     IFGT CLCID                               64051 182452
     C*******************  EXSR OVERCR                                    094431
     C*******************  WRITESTOTCR                                    094431
     C**********           MOVE 'CR'      DCFLAG                   094431 182452
     C**********           EXSR WST                        WRITE SU094431 182452
     C**********           END                                      64051 182452
     C                     END                             - E5
     C*
     C                     Z-ADDMHISD     WHISDD
     C                     Z-ADDMHISD     WSMNTD                          182452
     C                     Z-ADDMNBL      WMNBL
     C*
     C                     END                             - E4
     C*
     C           DRECI     DOWEQ'M'                        - B4
     C           *IN51     ANDEQ'0'
     C*
     C           KLIST1    READEREHISL                   51
     C*
     C           *IN51     IFEQ '0'                        - B5
     C*
     C           DRECI     IFEQ 'M'                        - B6
     C           DSDAT     ANDNE*ZEROS
      *                                                                   182452
      **  Transfer Midas Date into DDMMMYY.                               182452
      *                                                                   182452
     C                     Z-ADDMHISD     ZDAYNO                          182452
     C                     EXSR ZDATE2                                    182452
     C                     MOVE ZADATE    WMNTA                           182452
     C*
     C                     Z-ADDWDRCB     ZICALC
     C**********           Z-ADDWWHISD    ZIBEG                           182452
     C                     Z-ADDWSMNTD    ZIBEG                           182452
     C                     Z-ADDMHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C           MNBL      MULT DAYS      NUMB0
     C*
     C           MNBL      IFGT *ZEROS                     - B7
     C                     Z-ADDDINT      INTD0
     C                     Z-ADDMNBL      HISB0                           182452
     C           MHISD     IFGT CLDID                                      64051
     C*******************  EXSR OVERDR                                    094431
     C*******************  WRITESTOTDR                                    094431
     C                     MOVE *ON       *IN26                           182452
     C                     MOVE 'DR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     MOVE *OFF      *IN26                           182452
     C                     END                                             64051
     C**********           ELSE                            - X7           182452
     C**********           Z-SUBCINT      INTC0                           182452
     C********** MHISD     IFGT CLCID                               64051 182452
     C*******************  EXSR OVERCR                                    094431
     C*******************  WRITESTOTCR                                    094431
     C**********           MOVE 'CR'      DCFLAG                   094431 182452
     C**********           EXSR WST                        WRITE SU094431 182452
     C**********           END                                      64051 182452
     C                     END                             - E7
     C*
     C                     Z-ADDMHISD     WHISDD
     C                     Z-ADDMHISD     WSMNTD                          182452
     C                     Z-ADDMNBL      WMNBL
     C*
     C                     ELSE                            - X6
     C*
     C                     MOVE *ON       *IN25                           182452
      *                                                                   182452
     C           DRECI     IFEQ 'S'                        - B7
     C***********SDICI     ANDEQ'Y'                                      098818
     C           SDICI     ANDNE*BLANKS                                  098818
     C*
     C                     Z-ADDWDRCB     ZICALC
     C**********           Z-ADDWWHISD    ZIBEG                           182452
     C                     Z-ADDWSMNTD    ZIBEG                           182452
     C                     Z-ADDDHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C           SMNBL     MULT DAYS      NUMB0
     C*
     C           SMNBL     IFGT *ZEROS                     - B8
     C                     Z-ADDDINT      INTD0
     C                     Z-ADDWHISB     HISB0                           182452
     C           DHISD     IFGT CLDID                                      64051
     C*******************  EXSR OVERDR                                    094431
     C*******************  WRITESTOTDR                                    094431
     C                     MOVE 'DR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     END                                             64051
     C**********           ELSE                            - X8           182452
     C**********           Z-SUBCINT      INTC0                           182452
     C********** DHISD     IFGT CLCID                               64051 182452
     C*******************  EXSR OVERCR                                    094431
     C*******************  WRITESTOTCR                                    094431
     C**********           MOVE 'CR'      DCFLAG                   094431 182452
     C**********           EXSR WST                        WRITE SU094431 182452
     C**********           END                                      64051 182452
     C                     END                             - E8
     C*
      ** If MHISD is less than HISD, print another subtotal.              182452
      *                                                                   182452
     C                     ELSE                                           182452
     C           MHISD     IFLT HISD                                      182452
     C                     MOVE *ON       *IN25                           182452
     C                     Z-ADDWDRCB     ZICALC                          182452
     C                     Z-ADDMHISD     ZIBEG                           182452
     C                     Z-ADDHISD      ZIEND                           182452
     C                     EXSR ZICD                                      182452
     C                     Z-ADDZDAYN1    DAYS                            182452
     C                     Z-ADDWHISB     HISB0                           182452
     C                     MOVE 'DR'      DCFLAG                          182452
     C                     EXSR WST                                       182452
     C                     MOVE *OFF      *IN25                           182452
     C                     END                                            182452
      *                                                                   182452
     C                     Z-ADDDHISD     WHISDD
     C*
     C                     END                             - E7
     C*
     C                     MOVE *OFF      *IN25                           182452
      *                                                                   182452
     C                     END                             - E6
     C*
     C                     END                             - E5
     C*
     C                     END                             - E4
     C*
     C                     ELSE                            - X3
     C*
     C**  Process in case of interest type debit is less than 3
     C**  and interest type credit is greater than 2
     C*
     C**  Process output changing day
     C*
     C           RECI      IFNE 'M'                                       182452
     C                     Z-ADDDHISD     ZIEND                           182452
     C                     ELSE                                           182452
     C                     Z-ADDMHISD     ZIEND                           182452
     C                     ENDIF                                          182452
      *                                                                   182452
     C**********           Z-ADDWMNBL     HISB0                           182452
     C                     Z-ADDWHISB     HISB0                           182452
     C           DHISD     IFGT CLDID                                      64051
     C*******************  EXSR OVERDR                                    094431
     C*******************  WRITESTOTDR                                    094431
     C                     Z-ADDWDRCB     ZICALC                          182452
     C                     Z-ADDWHISDC    ZIBEG                           182452
     C                     EXSR ZICD                                      182452
     C                     Z-ADDZDAYN1    DAYS                            182452
     C                     MOVE 'DR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     END                                             64051
     C                     MOVE *ON       *IN25                           182452
     C           DHISD     IFGT CLCID                                      64051
     C*******************  EXSR OVERCR                                    094431
     C*******************  WRITESTOTCR                                    094431
     C                     Z-ADDWCRCB     ZICALC                          182452
     C                     Z-ADDWHISDC    ZIBEG                           182452
     C                     EXSR ZICD                                      182452
     C                     Z-ADDZDAYN1    DAYS                            182452
     C                     MOVE 'CR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     END                                             64051
     C                     MOVE *OFF      *IN25                           182452
     C*
     C           DDRCI     IFEQ 'Y'                        - B4
     C*
     C**  Debit rate change
     C*
     C                     Z-ADDWDRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDDHISD     ZIEND
     C*
     C                     EXSR ZICD
     C*
     C                     Z-ADDZDAYN1    DAYS
     C                     Z-ADDWHISB     HISB0
     C           HISB0     MULT DAYS      NUMB0
     C*
     C           DAYS      IFNE *ZEROS                     - B5
     C*
     C           DHISD     IFGT CLDID                                      64051
     C*******************  EXSR OVERDR                                    094431
     C*******************  WRITESTOTDR                                    094431
     C                     MOVE 'DR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     END                                             64051
     C           DHISD     IFGT CLCID                                      64051
     C*******************  EXSR OVERCR                                    094431
     C*******************  WRITESTOTCR                                    094431
     C                     MOVE 'CR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     END                                             64051
     C*
     C* Charge report if necessary
     C*
     C                     EXSR PRN1CH                     chargesDetails1085713
     C***********CCICI     IFNE *BLANK                     - B6           085713
     C***********DTHGAR    IFNE *ZERO                      - B7           085713
     C***********DTHGAN    ORNE *ZERO                                     085713
     C***********          Z-ADDDTHGAR    CHGR0                           085713
     C***********          Z-ADDDTHGAN    CHGN0                           085713
     C***********          Z-ADDNITMS     SNITMS                          085713
     C***********          WRITEPOSTCH                                    085713
     C***********          END                             - E7           085713
     C***********          END                             - E6           085713
     C*
     C                     END                             - E5
     C*
     C                     END                             - E4
     C*
     C**  Credit end of month or credit rate change
     C*
     C           DRECI     IFEQ 'M'                        - B4
     C           CSDAT     ANDNE*ZEROS
      *                                                                   182452
      **  Transfer Midas date into DDMMMYY.                               182452
      *                                                                   182452
     C                     Z-ADDMHISD     ZDAYNO                          182452
     C                     EXSR ZDATE2                                    182452
     C                     MOVE ZADATE    WMNTA                           182452
      *                                                                   182452
     C           RVALDC    IFGT WSMNTC                                    182452
     C                     Z-ADDRVALDC    WSMNTC                          182452
     C                     ENDIF                                          182452
     C*
     C                     Z-ADDWCRCB     ZICALC
     C**********           Z-ADDWWHISD    ZIBEG                           182452
     C                     Z-ADDWSMNTC    ZIBEG                           182452
     C                     Z-ADDMHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C                     Z-ADDMNBL      HISB0                           182452
     C           MNBL      MULT DAYS      NUMB0
     C*
     C           MNBL      IFGT *ZEROS                     - B5
     C**********           Z-ADDDINT      INTD0                           182452
     C********** MHISD     IFGT CLDID                               64051 182452
     C*******************  EXSR OVERDR                                    094431
     C*******************  WRITESTOTDR                                    094431
     C**********           MOVE 'DR'      DCFLAG                   094431 182452
     C**********           EXSR WST                        WRITE SU094431 182452
     C**********           END                                      64051 182452
     C                     ELSE                            - X5
     C                     Z-SUBCINT      INTC0
     C           MHISD     IFGT CLCID                                      64051
     C*******************  EXSR OVERCR                                    094431
     C*******************  WRITESTOTCR                                    094431
     C                     MOVE *ON       *IN26                           182452
     C                     MOVE 'CR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     MOVE *OFF      *IN26                           182452
     C                     END                                             64051
     C                     END                             - E5
     C*
     C                     Z-ADDMHISD     WHISDC
     C                     Z-ADDMHISD     WSMNTC                          182452
     C                     Z-ADDMNBL      WMNBL
     C*
     C                     END                             - E4
     C*
     C           DRECI     DOWEQ'M'                        - B4
     C           *IN51     ANDEQ'0'
     C*
     C           KLIST1    READEREHISL                   51
     C*
     C           *IN51     IFEQ '0'                        - B5
     C*
     C           DRECI     IFEQ 'M'                        - B6
     C           CSDAT     ANDNE*ZEROS
      *                                                                   182452
      **  Transfer Midas date into DDMMMYY.                               182452
      *                                                                   182452
     C                     Z-ADDMHISD     ZDAYNO                          182452
     C                     EXSR ZDATE2                                    182452
     C                     MOVE ZADATE    WMNTA                           182452
     C*
     C                     Z-ADDWCRCB     ZICALC
     C**********           Z-ADDWWHISD    ZIBEG                           182452
     C                     Z-ADDWSMNTC    ZIBEG                           182452
     C                     Z-ADDMHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C           MNBL      MULT DAYS      NUMB0
     C*
     C           MNBL      IFGT *ZEROS                     - B7
     C**********           Z-ADDDINT      INTD0                           182452
     C********** MHISD     IFGT CLDID                               64051 182452
     C*******************  EXSR OVERDR                                    094431
     C*******************  WRITESTOTDR                                    094431
     C**********           MOVE 'DR'      DCFLAG                   094431 182452
     C**********           EXSR WST                        WRITE SU094431 182452
     C**********           END                                      64051 182452
     C                     ELSE                            - X7
     C                     Z-SUBCINT      INTC0
     C                     Z-ADDMNBL      HISB0                           182452
     C           MHISD     IFGT CLCID                                      64051
     C*******************  EXSR OVERCR                                    094431
     C*******************  WRITESTOTCR                                    094431
     C                     MOVE *ON       *IN26                           182452
     C                     MOVE 'CR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     MOVE *OFF      *IN26                           182452
     C                     END                                             64051
     C                     END                             - E7
     C*
     C                     Z-ADDMHISD     WHISDC
     C                     Z-ADDMHISD     WSMNTC                          182452
     C                     Z-ADDMNBL      WMNBL
     C*
     C                     ELSE                            - X6
     C*
     C                     MOVE *ON       *IN25                           182452
      *                                                                   182452
     C           DRECI     IFEQ 'S'                        - B7
     C***********SCICI     ANDEQ'Y'                                      098818
     C           SCICI     ANDNE*BLANKS                                  098818
     C*
     C                     Z-ADDWCRCB     ZICALC
     C**********           Z-ADDWWHISD    ZIBEG                           182452
     C                     Z-ADDWSMNTC    ZIBEG                           182452
     C                     Z-ADDDHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C           SMNBL     MULT DAYS      NUMB0
     C*
     C           SMNBL     IFGT *ZEROS                     - B8
     C**********           Z-ADDDINT      INTD0                           182452
     C********** DHISD     IFGT CLDID                               64051 182452
     C*******************  EXSR OVERDR                                    094431
     C*******************  WRITESTOTDR                                    094431
     C**********           MOVE 'DR'      DCFLAG                   094431 182452
     C**********           EXSR WST                        WRITE SU094431 182452
     C**********           END                                      64051 182452
     C                     ELSE                            - X8
     C                     Z-SUBCINT      INTC0
     C                     Z-ADDWHISB     HISB0                           182452
     C           DHISD     IFGT CLCID                                      64051
     C*******************  EXSR OVERCR                                    094431
     C*******************  WRITESTOTCR                                    094431
     C                     MOVE 'CR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     END                                             64051
     C                     END                             - E8
     C*
      ** If MHISD is less than HISD, print another subtotal.              182452
      *                                                                   182452
     C                     ELSE                                           182452
     C           MHISD     IFLT HISD                                      182452
     C                     MOVE *ON       *IN25                           182452
     C                     Z-ADDWCRCB     ZICALC                          182452
     C                     Z-ADDMHISD     ZIBEG                           182452
     C                     Z-ADDHISD      ZIEND                           182452
     C                     EXSR ZICD                                      182452
     C                     Z-ADDZDAYN1    DAYS                            182452
     C                     Z-ADDWHISB     HISB0                           182452
     C                     MOVE 'CR'      DCFLAG                          182452
     C                     EXSR WST                                       182452
     C                     MOVE *OFF      *IN25                           182452
     C                     ENDIF                                          182452
     C                     Z-ADDDHISD     WHISDC
     C*
     C                     END                             - E7
     C*
     C                     MOVE *OFF      *IN25                           182452
      *                                                                   182452
     C                     END                             - E6
     C*
     C                     END                             - E5
     C*
     C                     END                             - E4
     C*
     C                     END                             - E3
     C*
     C                     END                             - E2
     C*
     C                     END                             - E1
     C*
      ** If CRE001 is switched ON and Overdraft Processed Ind. is 'Y'     CRE001
      ** then Output Overdraft Limit                                      CRE001
      *                                                                   CRE001
     C           CRE001    IFEQ 'Y'                          B1           CRE001
     C           ODLI      ANDEQ'Y'                          A1           CRE001
      *                                                                   CRE001
     C                     MOVE *BLANKS   ODLI                            CRE001
     C                     MOVE *BLANKS   PSTDO                           CRE001
     C                     Z-ADD*ZEROS    PPSTD                           CRE001
     C                     MOVE *BLANKS   PSTDA                           CRE001
      *                                                                   CRE001
      ** Convert Retail History Debit Date to DDMMMYY format              CRE001
     C           PVALD     IFNE WWHISD                       B2           CRE001
     C                     MOVELWWHISD    ZDAYNO                          CRE001
     C                     EXSR ZDATE2                                    CRE001
     C                     MOVE ZADATE    VALDO                           CRE001
      *                                                                   CRE001
      **  Handle Conversion Error.                                        CRE001
      *                                                                   CRE001
     C           ZERROR    IFNE 0                          - B3           CRE001
     C                     Z-ADDWWHISD    WDATE                           CRE001
     C                     Z-ADD421       DBASE                           CRE001
     C                     MOVEL'ZDAT2'   DBFILE           ***************CRE001
     C                     MOVELWDATE     DBKEY            **DB ERROR 421*CRE001
     C                     MOVEA'1'       *IN,89           ***************CRE001
     C                     EXSR DBSR                                      CRE001
     C                     ENDIF                           - E3           CRE001
      *                                                                   CRE001
      ** Set Pervious Posting Value to Current Retail History DR Date     CRE001
     C                     Z-ADDWWHISD    PVALD                           CRE001
      *                                                                   CRE001
     C                     ENDIF                           - E2           CRE001
      *                                                                   CRE001
     C                     MOVE VALDO     VALDA                           CRE001
      *                                                                   CRE001
     C                     MOVELNAR,39    NARR                            CRE001
      *                                                                   CRE001
     C                     Z-ADD*ZERO     WODRL  150                      CRE001
     C                     SELEC                                          CRE001
     C           DPA,I     WHEQ 0                                         CRE001
     C                     Z-ADDODRL      WODRL                           CRE001
     C           DPA,I     WHEQ 1                                         CRE001
     C           ODRL      MULT 10        WODRL                           CRE001
     C           DPA,I     WHEQ 2                                         CRE001
     C           ODRL      MULT 100       WODRL                           CRE001
     C           DPA,I     WHEQ 3                                         CRE001
     C           ODRL      MULT 1000      WODRL                           CRE001
     C                     ENDSL                                          CRE001
      *                                                                   CRE001
     C           WODRL     IFGT *ZEROS                     - B2           CRE001
     C                     Z-ADDWODRL     PSTD0                           CRE001
     C                     ELSE                            - X2           CRE001
     C                     Z-SUBWODRL     PSTD0                           CRE001
     C                     ENDIF                           - E2           CRE001
      *                                                                   CRE001
      **  Output Posting for Debit and Credit                             CRE001
      *                                                                   CRE001
     C                     EXSR OVERDR                                    CRE001
     C                     WRITEPOSTDR                                    CRE001
      *                                                                   CRE001
     C                     ENDIF                             E1           CRE001
      *                                                                   CRE001
     C                     END                             - E2
     C*
     C                     END                             - E1
      *                                                                   CRE001
      ** If CRE001 is switched ON and Overdraft Processed Ind. is 'Y'     CRE001
      ** then Output Overdraft Limit                                      CRE001
      *                                                                   CRE001
     C           CRE001    IFEQ 'Y'                          B3           CRE001
     C           ODLI      ANDEQ'Y'                          A3           CRE001
      *                                                                   CRE001
     C                     MOVE *BLANKS   ODLI                            CRE001
     C                     MOVE *BLANKS   PSTDO                           CRE001
     C                     Z-ADD*ZEROS    PPSTD                           CRE001
     C                     MOVE *BLANKS   PSTDA                           CRE001
      *                                                                   CRE001
     C           PVALD     IFNE DHISD                      - B4           CRE001
      *                                                                   CRE001
      ** Convert History Debit Capitalisation Date to DDMMMYY Format      CRE001
     C                     MOVELDHISD     ZDAYNO                          CRE001
     C                     EXSR ZDATE2                                    CRE001
     C                     MOVE ZADATE    VALDO                           CRE001
      *                                                                   CRE001
      ** Handle Conversion Error.                                         CRE001
      *                                                                   CRE001
     C           ZERROR    IFNE 0                          - B5           CRE001
     C                     Z-ADDDHISD     WDATE                           CRE001
     C                     Z-ADD421       DBASE                           CRE001
     C                     MOVEL'ZDAT2'   DBFILE           ***************CRE001
     C                     MOVELWDATE     DBKEY            **DB ERROR 421*CRE001
     C                     MOVEA'1'       *IN,89           ***************CRE001
     C                     EXSR DBSR                                      CRE001
     C                     ENDIF                           - E5           CRE001
      *                                                                   CRE001
     C                     Z-ADDDHISD     PVALD                           CRE001
      *                                                                   CRE001
     C                     ENDIF                           - E4           CRE001
      *                                                                   CRE001
     C                     MOVE VALDO     VALDA                           CRE001
      *                                                                   CRE001
     C                     MOVELNAR,39    NARR                            CRE001
      *                                                                   CRE001
     C                     Z-ADD*ZERO     WODRL  150                      CRE001
     C                     SELEC                                          CRE001
     C           DPA,I     WHEQ 0                                         CRE001
     C                     Z-ADDODRL      WODRL                           CRE001
     C           DPA,I     WHEQ 1                                         CRE001
     C           ODRL      MULT 10        WODRL                           CRE001
     C           DPA,I     WHEQ 2                                         CRE001
     C           ODRL      MULT 100       WODRL                           CRE001
     C           DPA,I     WHEQ 3                                         CRE001
     C           ODRL      MULT 1000      WODRL                           CRE001
     C                     ENDSL                                          CRE001
      *                                                                   CRE001
     C           WODRL     IFGT *ZEROS                     - B4           CRE001
     C                     Z-ADDWODRL     PSTD0                           CRE001
     C                     ELSE                            - X4           CRE001
     C                     Z-SUBWODRL     PSTD0                           CRE001
     C                     ENDIF                           - E4           CRE001
      *                                                                   CRE001
      **  Output Posting for Debit and Credit                             CRE001
      *                                                                   CRE001
     C                     EXSR OVERDR                                    CRE001
     C                     WRITEPOSTDR                                    CRE001
      *                                                                   CRE001
     C                     ENDIF                             E3           CRE001
     C*
     C**  Transfer date MIDAS into DDMMMYY
     C*
     C           PVALD     IFNE CHISD                      - B1
     C                     Z-ADDCHISD     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALDO
     C*
     C                     MOVE CHISD     PVALD
     C*
     C                     END                             - E1
     C*
     C                     MOVE VALDO     VALDA
     C*
     C********** WHISB     IFGT *ZEROS                                    125176
     C***********CDAIC     SUB  WDAIDD    INTD0                           094674
     C********** CDAIC     SUB  WDAID     INTD0                    094674 125176
     C           CDAIC     SUB  WDAIDD    INTD0                           125176
     C                     SUB  MADR#     INTD0                           125176
     C**********           ELSE                                           125176
     C**********           Z-ADD*ZEROS    INTD0                           125176
     C**********           END                                            125176
     C                     Z-ADDWDRCBD    ZICALC
     C                     Z-ADDWHISDD    ZIBEG
     C                     Z-ADDCHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C                     Z-ADDWHISB     HISB0
     C           HISB0     MULT DAYS      NUMB0
     C********** DHISD     IFGT CLDID                               64051 125176
     C           DAYS      IFNE *ZEROS                                    125176
     C*******************  EXSR OVERDR                                    094431
     C*******************  WRITESTOTDR                                    094431
     C                     MOVE 'DR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     END                                             64051
     C********** WHISB     IFLT *ZEROS                                    125176
     C***********CCAIC     SUB  WCAIDC    INTC0                           094337
     C***********CCAIC     SUB  WCAIDD    INTC0                     094337094674
     C********** CCAIC     SUB  WCAID     INTC0                    094674 125176
     C           CCAIC     SUB  WCAIDD    INTC0                           125176
     C                     SUB  MACR#     INTC0                           125176
     C***********          Z-SUBINTC0     INTC0                     094337094674
     C**********           ELSE                                           125176
     C**********           Z-ADD*ZEROS    INTC0                           125176
     C**********           END                                            125176
     C                     Z-SUBINTC0     INTC0                           094674
     C                     Z-ADDWCRCBC    ZICALC
     C                     Z-ADDWHISDC    ZIBEG
     C                     Z-ADDCHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C                     Z-ADDWHISB     HISB0
     C           HISB0     MULT DAYS      NUMB0
     C********** DHISD     IFGT CLCID                               64051 125176
     C           DAYS      IFNE *ZEROS                                    125176
     C*******************  EXSR OVERCR                                    094431
     C*******************  WRITESTOTCR                                    094431
     C                     MOVE 'CR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     END                                             64051
     C*
     C**  Prepare C/F balance
     C*
     C                     EXSR CLMSG
     C                     MOVELNAR,6     TNARR
     C*
     C                     Z-ADDCHISB     HISB0
     C*
     C**  Output balance C/F
     C*
     C********** DHISD     IFGT CLDID                               64051 125176
     C                     EXSR OVERDR
     C                     WRITETITLEDR
     C**********           END                                      64051 125176
     C********** DHISD     IFGT CLCID                               64051 125176
     C                     EXSR OVERCR
     C                     WRITETITLECR
     C**********           END                                      64051 125176
     C*
     C**  Prepare total interest output
     C*
     C                     Z-ADDWDRCB     ZICALC
     C                     Z-ADDCLDID     ZIBEG
     C                     Z-ADDCHISD     ZIEND
     C                     EXSR ZICD
     C*
     C                     Z-ADDZDAYN1    DAYS
     C*
     C                     EXSR CLMSG
     C                     MOVELNAR,5     XNARR
     C*
     C                     Z-ADDCDAIC     TINTD0
     C***********          Z-ADDCCAIC     TINTC0                          094337
     C                     Z-SUBCCAIC     TINTC0                          094337
     C*
     C**  Output total interest
     C*
     C                     EXSR OVERDR
     C                     WRITETOTALDR
     C                     Z-ADDWCRCB     ZICALC
     C                     Z-ADDCLCID     ZIBEG
     C                     Z-ADDCHISD     ZIEND
     C                     EXSR ZICD
     C*
     C                     Z-ADDZDAYN1    DAYS
     C*
     C                     EXSR CALBRT
      *                                                                                       CGL031
     C           CGL031    IFEQ 'Y'                                                           CGL031
     C                     MOVE *ON       *IN21                                               CGL031
     C                     EXSR CALEUT                                                        CGL031
     C                     ENDIF                                                              CGL031
      *                                                                                       CGL031
     C/COPY WNCPYSRC,RE3761C001
     C*
     C                     EXSR OVERCR
     C                     WRITETOTALCR
     C           CSGADI    IFNE *ZERO                                     094337
     C                     EXSR CLMSG                                     094337
     C                     Z-ADDCSGADI    TINTD0                          094337
     C                     MOVELNAR,23    DNARR                           094337
     C                     EXSR OVERDR                                    094337
     C                     WRITETOTDDR                                    094337
     C                     END                                            094337
     C           CSGACI    IFNE *ZERO                                     094337
     C                     EXSR CLMSG                                     094337
     C                     Z-SUBCSGACI    TINTC0                          094337
     C                     MOVELNAR,23    DNARR                           094337
     C                     EXSR OVERCR                                    094337
     C                     WRITETOTDCR                                    094337
     C                     END                                            094337
     C/COPY WNCPYSRC,RE3761C045
      *                                                                   130468
      * Report BRT if required                                            130468
     C           *IN22     IFEQ '1'                                       130468
     C                     EXSR OVERCR                                    130468
     C                     WRITETOTBRT                                    130468
     C                     END                                            130468
      *                                                                                       CGL031
      ** Report EUT if required                                                               CGL031
      *                                                                                       CGL031
     C           *IN21     IFEQ *ON                                                           CGL031
     C                     EXSR OVERCR                                                        CGL031
     C                     WRITEEUWTAX                                                        CGL031
      *                                                                                       CER048
      ** Print Secondary Tax Amount                                                           CER048
      *                                                                                       CER048
     C           CER048    IFEQ 'Y'                                                           CER048
      *                                                                                       CER048
     C                     EXSR OVERCR                                                        CER048
     C                     WRITESECTAX                                                        CER048
      *                                                                                       CER048
     C                     ENDIF                                                              CER048
      *                                                                                       CER048
      ** Print Third Tax Amount                                                             BUG26838
      *                                                                                     BUG26838
     C           CER054    IFEQ 'Y'                                                         BUG26838
      *                                                                                     BUG26838
     C                     EXSR OVERCR                                                      BUG26838
     C                     WRITETHRTAX                                                      BUG26838
      *                                                                                     BUG26838
     C                     ENDIF                                                            BUG26838
      *                                                                                     BUG26838
     C                     END                                                                CGL031
      *                                                                                       CGL031
     C/COPY WNCPYSRC,RE3761C046
     C*                                                                   094337
     C* CHARGE REPORT IF NECESSARY                                        094337
     C*                                                                   094337
     C           CCICI     IFNE *BLANK                                    094337
     C********** CHGT      ANDNE*ZERO                              094337 125176
     C           CCHGP     ANDNE*ZERO                                     125176
     C                     Z-ADDCCHGP     CHGP0                           094337
     C                     MOVELNAR,22    XNARR                           125176
     C                     Z-ADD0         PSTD0                           125176
     C                     EXSR OVERCH                                    125176
     C                     WRITESTOTCH                                    125176
     C*                                                                   094337
     C** PREPARE REBATE                                                   094337
     C*                                                                   094337
     C                     EXSR REBSR                                     094337
     C**********           EXSR OVERCH                             094337 125176
     C**********           WRITESTOTCH                             094337 125176
     C           REBATE    IFNE 0                                         125176
     C**********           MOVELNAR,35    XNARR                    094337 125176
     C                     MOVELNAR,36    XNARR                           125176
     C                     Z-ADDCMNBCP    PSTD0                           094337
     C                     Z-ADDREBATE    TCHR0                           094337
     C                     WRITESREBCH                                    094337
     C                     END                                            125176
     C**********           MOVELNAR,36    XNARR                    094337 125176
     C                     MOVELNAR,21    XNARR                           125176
     C                     WRITETOTALCH                                   094337
     C                     END                                            094337
     C*
     C**  Prepare total commission output
     C*
     C*
     C**  Prepare fixed commission output
     C*
     C***********          MOVE '0'       *IN59                           094337
     C                     MOVE '1'       *IN59                           094337
     C*
     C           FXDC      IFNE *ZERO                      - B1
     C                     EXSR CLMSG
     C                     MOVELNAR,28    DNARR
     C*
     C                     Z-ADDFXDC      TINTD0
     C                     EXSR OVERDR
     C                     WRITETOTDDR
     C                     MOVE '1'       *IN59
     C                     END                             - E1
     C*
     C**  Prepare commission on debit interest
     C*
     C           *IN70     IFEQ '1'                        - B1
     C*
     C           CDIE      IFNE *ZERO                      - B2
     C                     EXSR CLMSG
     C                     MOVELNAR,17    DNARR
     C*
     C                     Z-ADDCDIE      TINTD0
     C                     EXSR OVERDR
     C                     WRITETOTDDR
     C                     MOVE '1'       *IN59
     C                     END                             - E2
     C*
     C*
     C**  Prepare account commission
     C*
     C           ACCEA     IFNE *ZERO                      - B2
     C                     EXSR CLMSG
     C                     MOVELNAR,18    DNARR
     C*
     C                     Z-ADDACCEA     TINTD0
     C                     EXSR OVERDR
     C                     WRITETOTDDR
     C                     MOVE '1'       *IN59
     C                     END                             - E2
     C*
     C*
     C**  Prepare H/O commission
     C*
     C           CHDBE     IFNE *ZERO                      - B2
     C                     EXSR CLMSG
     C                     MOVELNAR,19    DNARR
     C*
     C                     Z-ADDCHDBE     TINTD0
     C                     EXSR OVERDR
     C                     WRITETOTDDR
     C                     MOVE '1'       *IN59
     C                     END                             - E2
     C*
     C**  Prepare commission on minimum balance
     C*
     C           CMBE      IFNE *ZERO                      - B2
     C                     EXSR CLMSG
     C                     MOVELNAR,20    DNARR
     C*
     C                     Z-ADDCMBE      TINTD0
     C                     EXSR OVERDR
     C                     WRITETOTDDR
     C                     MOVE '1'       *IN59
     C                     END                             - E2
     C*
     C**  Prepare inactive commission
     C*
     C           IACE      IFNE *ZERO                      - B2
     C                     EXSR CLMSG
     C                     MOVELNAR,30    DNARR
     C*
     C                     Z-ADDIACE      TINTD0
     C                     EXSR OVERDR
     C                     WRITETOTDDR
     C                     MOVE '1'       *IN59
     C                     END                             - E2
     C*
     C                     ELSE                            - X1
     C*
     C           CDICA     IFNE *ZERO                      - B2
     C                     EXSR CLMSG
     C                     MOVELNAR,17    DNARR
     C*
     C           CDICA     SUB  CCDIC     TINTD0
     C                     EXSR OVERDR
     C                     WRITETOTDDR
     C                     MOVE '1'       *IN59
     C                     END                             - E2
     C*
     C*
     C**  Prepare account commission
     C*
     C           ACCC      IFNE *ZERO                      - B2
     C                     EXSR CLMSG
     C                     MOVELNAR,18    DNARR
     C*
     C           ACCC      SUB  CACCC     TINTD0
     C                     EXSR OVERDR
     C                     WRITETOTDDR
     C                     MOVE '1'       *IN59
     C                     END                             - E2
     C*
     C*
     C**  Prepare H/O commission
     C*
     C           CHDBC     IFNE *ZERO                      - B2
     C                     EXSR CLMSG
     C                     MOVELNAR,19    DNARR
     C*
     C           CHDBC     SUB  CCHDBC    TINTD0
     C                     EXSR OVERDR
     C                     WRITETOTDDR
     C                     MOVE '1'       *IN59
     C                     END                             - E2
     C*
     C**  Prepare commission on minimum balance
     C*
     C           CMBC      IFNE *ZERO                      - B2
     C                     EXSR CLMSG
     C                     MOVELNAR,20    DNARR
     C*
     C           CMBC      SUB  CCMBC     TINTD0
     C                     EXSR OVERDR
     C                     WRITETOTDDR
     C                     MOVE '1'       *IN59
     C                     END                             - E2
     C*
     C**  Prepare VAT
     C*
     C           VATAM     IFNE *ZERO                      - B2
     C                     EXSR CLMSG
     C                     MOVELNAR,24    DNARR
     C*
     C                     Z-ADDVATAM     TINTD0
     C                     EXSR OVERDR
     C                     WRITETOTDDR
     C                     MOVE '1'       *IN59
     C                     END                             - E2
     C*
     C**  Prepare inactive commission
     C*
     C           IACCC     IFNE *ZERO                      - B2
     C                     EXSR CLMSG
     C                     MOVELNAR,30    DNARR
     C*
     C                     Z-ADDIACCC     TINTD0
     C                     EXSR OVERDR
     C                     WRITETOTDDR
     C                     MOVE '1'       *IN59
     C                     END                             - E2
     C*
     C                     END                             - E1
     C*
     C**  Prepare extra daily statment commission
     C*
     C           NOIP      ADD  CCINST    CCINST
     C           CCINST    IFNE *ZERO                      - B2
     C                     EXSR CLMSG
     C                     MOVELNAR,34    DNARR
     C*
     C                     Z-ADDCCINST    TINTD0
     C                     EXSR OVERDR
     C                     WRITETOTDDR
     C                     MOVE '1'       *IN59
     C                     END                             - E2
     C/COPY WNCPYSRC,RE3761C008
     C*
     C**  Prepare total charges
     C*
     C           CCHGP     IFNE *ZERO                      - B1
     C                     EXSR CLMSG
     C                     MOVELNAR,22    DNARR
     C*
     C                     Z-ADDCCHGP     TINTC0
     C                     EXSR OVERCR
     C                     WRITETOTDCR
     C                     MOVE '1'       *IN59
     C                     END                             - E1
     C*
     C*
     C**  Prepare withholding tax output
     C*
     C           WWCINW    IFNE *ZEROS                     - B1
     C                     EXSR CLMSG
     C**********           MOVEL*BLANKS   NCACP  19                                           CGL029
     C                     MOVEL*BLANKS   NCACP  25                                           CGL029
     C           CACP      IFNE *BLANKS                    - B2
     C                     MOVEL' BY '    NCACP
     C                     MOVE CACP      NCACP
     C                     END                             - E2
     C                     MOVELNAR,26    DNARR
     C                     MOVE NCACP     DNARR
     C*
     C                     Z-ADD*ZEROS    TINTD0
     C                     Z-ADDWWCINW    TINTC0
     C                     EXSR OVERCR
     C                     MOVE '1'       *IN41
     C                     WRITETOTDCR
     C                     MOVE '0'       *IN41
     C                     MOVE '1'       *IN59
     C                     END                             - E1
     C*
     C**  Prepare total
     C*
     C                     Z-ADD*ZERO     TINTD0
     C                     Z-ADD*ZERO     TINTC0                          086087
     C/COPY WNCPYSRC,RE3761C002
     C                     ADD  CCINST    TINTD0
     C           *IN70     IFEQ '0'                        - B2
     C                     ADD  CDICA     TINTD0
     C                     ADD  ACCC      TINTD0
     C                     ADD  CHDBC     TINTD0
     C                     ADD  CMBC      TINTD0
     C                     ADD  VATAM     TINTD0
     C                     ADD  IACCC     TINTD0
     C**********           ADD  CSGADI    TINTD0                   094337 121125
     C                     ELSE                            - X2
     C                     ADD  CDIE      TINTD0
     C                     ADD  ACCEA     TINTD0
     C                     ADD  CHDBE     TINTD0
     C                     ADD  CMBE      TINTD0
     C                     ADD  IACE      TINTD0
     C**********           ADD  CSGADI    TINTD0                   094337 121125
     C                     END                             - E2
     C                     ADD  FXDC      TINTD0
     C                     ADD  CSGADI    TINTD0                          121125
     C/COPY WNCPYSRC,RE3761C009
     C           CSDCI     IFEQ 'Y'                        - B1
     C           CSDCI     OREQ 'I'
     C           CSDCI     OREQ 'A'
     C                     ADD  CDAIC     TINTD0
     C                     END                             - E1
     C           CSCCI     IFEQ 'Y'
     C           CSCCI     OREQ 'I'
     C           CSCCI     OREQ 'A'
     C***********          SUB  CCAIC     TINTD0                          086087
     C***********          ADD  WWCINW    TINTD0                          086087
     C                     SUB  CCAIC     TINTC0                          086087
     C                     ADD  WWCINW    TINTC0                          086087
     C                     END                                            130468
      *                                                                   086087
      * Add BRT if applicable                                             086087
     C           *IN22     IFEQ '1'                                       086087
     C                     ADD  BRTOT0    TINTC0                          086087
     C                     END                                            086087
      *                                                                                       CGL031
      ** Add EUT if applicable                                                                CGL031
      *                                                                                       CGL031
     C           *IN21     IFEQ *ON                                                           CGL031
     C                     ADD  EUTAX0    TINTC0                                              CGL031
      *                                                                                       CER048
      ** Add Secondary Tax, if applicable                                                     CER048
      *                                                                                       CER048
     C           CER048    IFEQ 'Y'                                                           CER048
     C           TINTC0    ADD  STAX0     TINTC0                                              CER048
     C                     ENDIF                                                              CER048
      *                                                                                       CER048
      ** Add Third Tax, if applicable                                                       BUG26838
      *                                                                                     BUG26838
     C           CER054    IFEQ 'Y'                                                         BUG26838
     C           TINTC0    ADD  TTAX0     TINTC0                                            BUG26838
     C                     ENDIF                                                            BUG26838
      *                                                                                     BUG26838
     C                     END                                                                CGL031
      *                                                                                       CGL031
     C/COPY WNCPYSRC,RE3761C030
     C**********           END                                            130468
     C           CSCHGI    IFEQ 'Y'
     C           CSCHGI    OREQ 'I'
     C           CSCHGI    OREQ 'A'
     C           CSCHGI    OREQ 'L'                                       085171
     C           CSCHGI    OREQ 'O'                                       085171
     C***********          ADD  CCHGP     TINTD0                          086087
     C                     ADD  CCHGP     TINTC0                          086087
     C**********           ADD  CSGACI    TINTC0                   094337 121125
     C                     END
     C                     SUB  CSGACI    TINTC0                          121125
     C                     EXSR CLMSG
     C                     MOVELNAR,21    DNARR
     C*
     C***********          Z-ADDTINTD0    TINTC0                          086087
     C************IN59     IFEQ '1'                                       075075
     C                     EXSR OVERDR
     C                     WRITETOTDDR
     C                     EXSR OVERCR
     C                     WRITETOTDCR
     C***********          END                                            075075
     C*
     C***Capitalisation*to*an*account in different currency and           125176
     C***multibranch*is*present                                           125176
     C*
      * Report alternative a/c for DR interest if used                    125176
     C           DACP      IFNE *BLANK                                    125176
      *                                                                   125176
      * If capitalisation to a/c in different ccy, report exchange rate   125176
     C           *IN87     IFEQ '1'                        - B1
     C********** DACP      IFNE *BLANK                     - E1    094337 125176
     C********** DEXRT     IFNE *ZEROS                     - B2           125176
     C           DEXRT     ANDNE*ZEROS                                    125176
     C**********           EXSR CLMSG                                     125176
     C**********           MOVELNAR,32    NARR                            125176
     C                     Z-ADDDEXRT     RATE
     C                     MOVE '0'       *IN55                           125176
     C                     ELSE                                           125176
     C                     MOVE '1'       *IN55                           125176
     C                     END                                            094337
      *                                                                   125176
     C                     EXSR CLMSG                                     125176
     C                     MOVELNAR,32    NARR                            125176
     C***********          MOVELSDACP     MIDK                            094337
     C                     MOVELDACP      MIDK                            094337
     C***********          MOVE '1'       *IN55                    094337 125176
     C                     EXSR OVERDR
     C                     WRITEALTNDR
     C***********          EXSR OVERCR                                    094337
     C***********          WRITEALTNCR                                    094337
     C**********           MOVE '0'       *IN55                    094337 125176
     C                     END                             - E2
      *                                                                   125176
      * Report alternative a/c for CR interest if used                    125176
     C           CACP      IFNE *BLANK                     - E1           094337
      *                                                                   125176
      * If capitalisation to a/c in different ccy, report exchange rate   125176
     C           *IN87     IFEQ '1'                                       125176
     C********** CEXRT     IFNE *ZEROS                     - B2           125176
     C           CEXRT     ANDNE*ZEROS                                    125176
     C**********           EXSR CLMSG                                     125176
     C**********           MOVELNAR,31    NARR                            125176
     C                     Z-ADDCEXRT     RATE
     C                     MOVE '0'       *IN55                           125176
     C                     ELSE                                           125176
     C                     MOVE '1'       *IN55                           125176
     C                     END                                            094337
      *                                                                   125176
     C                     EXSR CLMSG                                     125176
     C                     MOVELNAR,31    NARR                            125176
     C***********          MOVELSCACP     MIDK                            094337
     C                     MOVELCACP      MIDK                            094337
     C**********           MOVE '1'       *IN55                    094337 125176
     C***********          EXSR OVERDR                                    094337
     C***********          WRITEALTNDR                                    094337
     C                     EXSR OVERCR
     C                     WRITEALTNCR
     C**********           MOVE '0'       *IN55                    094337 125176
     C                     END                             - E2
     C*                                                                   094337
      * Report alternative a/c for charges if used                        125176
     C           CHAC      IFNE *BLANK                     - E1           094337
      *                                                                   125176
      * If capitalisation to a/c in different ccy, report exchange rate   125176
     C           *IN87     IFEQ '1'                                       125176
     C********** CHXRT     IFNE *ZEROS                     - B2           125176
     C           CHXRT     ANDNE*ZEROS                                    125176
     C**********           EXSR CLMSG                                     125176
     C**********           MOVELNAR,33    NARR                            125176
     C                     Z-ADDCHXRT     RATE
     C                     MOVE '0'       *IN55                           125176
     C                     ELSE                                           125176
     C                     MOVE '1'       *IN55                           125176
     C                     END                             - E2           094337
      *                                                                   125176
     C                     EXSR CLMSG                                     125176
     C                     MOVELNAR,33    NARR                            125176
     C***********          MOVELSCHAC     MIDK                            094337
     C                     MOVELCHAC      MIDK                            094337
     C***********          EXSR OVERDR                     - B2           094337
     C***********          WRITEALTNDR                     - B2           094337
     C                     EXSR OVERCR
     C                     WRITEALTNCR
     C                     END                             - E2
     C**********           END                             - E1           125176
     C*
     C           *IN70     IFEQ '1'                        - B1
     C                     EXSR OVERDR
     C                     WRITETOTMDR
     C                     EXSR OVERCR
     C                     WRITETOTMCR
     C                     END
     C*
     C/COPY WNCPYSRC,RE3761C013
     C           CER050    IFEQ 'Y'                                                           CER050
      *                                                                                       CER050
      * Only print APR if not management statement                                            CER050
      *                                                                                       CER050
     C           *IN70     IFEQ '0'                        B001                               CER050
      *                                                                                       CER050
     C                     MOVEA'00'      *IN,61                                              CER050
      *                                                                                       CER050
     C           KACCNT    CHAINACCNTBY0             99                                       CER050
     C           *IN99     IFEQ '0'                                                           CER050
      *                                                                                       CER050
      * Run this process only if APR is set to 'Y'                                            CER050
      *                                                                                       CER050
     C           ATAPRC    IFEQ 'Y'                                                           CER050
     C                     EXSR SRAPRD                                                        CER050
     C                     EXSR SRAPRC                                                        CER050
     C                     ENDIF                                                              CER050
     C                     ENDIF                                                              CER050
      *                                                                                       CER050
     C                     ENDIF                                                              CER050
      *                                                                                       CER050
     C                     ENDIF                                                              CER050
      *                                                                                       CER050
     C                     ENDSR                           **BOTHSR ENDSR*
     C********************************************************************
     C/EJECT                                                              125176
      ********************************************************************125176
      **                                                                  125176
      ** #ADJ subroutine to set up generated adjustment for report        125176
      **                                                                  125176
      **     Called by       BOTHSR, CRSR, DRSR                           125176
      **                                                                  125176
     C           #ADJ      BEGSR                           ** #ADJ BEGSR**125176
      *                                                                   125176
     C           PPSTD     IFNE RUND                                      125176
     C                     Z-ADDRUND      ZDAYNO                          125176
     C                     EXSR ZDATE2                                    125176
     C                     MOVE ZADATE    PSTDO                           125176
     C                     Z-ADDRUND      PPSTD                           125176
     C                     END                                            125176
     C                     MOVE PSTDO     PSTDA                           125176
      *                                                                   125176
     C           PVALD     IFNE DHISD                                     125176
     C                     Z-ADDDHISD     ZDAYNO                          125176
     C                     EXSR ZDATE2                                    125176
     C                     MOVE ZADATE    VALDO                           125176
     C                     Z-ADDDHISD     PVALD                           125176
     C                     END                                            125176
     C                     MOVE VALDO     VALDA                           125176
      *                                                                   125176
     C                     MOVELNAR,23    NARR                            125176
     C                     Z-ADD@GADJ     PSTD0                           125176
     C                     MOVE *BLANK    @ADJF                           125176
      *                                                                   125176
     C                     ENDSR                                          125176
      *                                                                   125176
      ********************************************************************125176
     C/EJECT
      ********************************************************************094337
      **                                                                  094337
      ** REBSR subroutine for rebate calculation                          094337
      **                                                                  094337
      **     Called by                                                    094337
      **                                                                  094337
      **     Calls           DBSR,                                        094337
      **                                                                  094337
     C           REBSR     BEGSR                           **REBSR  BEGSR 094337
      *                                                                   153001
      * If closure capitalisation, no rebate or minimum/maximum charge.   153001
     C                     Z-ADD*ZERO     REBATE                          153001
     C                     MOVE *BLANK    MINMAX                          153001
      *                                                                   153001
     C           CCICI     IFNE 'C'                                       153001
      *                                                                   153001
     C           *LIKE     DEFN HISB      REBATE                          094337
     C                     MOVE CCCY      WCCCY                           094337
     C                     MOVE *BLANK    BLANK1                          094337
     C                     MOVE 'D'       ENDK                            094337
     C*                                                                   094337
     C** ACCESS RECRG FILE                                                094337
     C*                                                                   094337
     C           CHKEY     CHAINRECRG                99                   094337
     C*                                                                   094337
     C** ERROR IN RECRG                                                   094337
     C*                                                                   094337
     C           *IN99     IFEQ '1'                        - B1           094337
     C                     Z-ADD20        DBASE            ************** 094337
     C                     MOVE 'RECRG'   DBFILE           **DB ERROR 20* 094337
     C                     MOVELCHKEY     DBKEY            ************** 094337
     C                     MOVEA'1'       *IN,89                          094337
     C                     EXSR DBSR                                      094337
     C                     END                             - E1           094337
     C*                                                                   094337
     C**********           Z-ADD*ZERO     REBATE                   094337 153001
     C           CMNBCP    IFLE EXBL                       - B1           094337
     C           PERM      ANDGT*ZEROS                                    094337
     C*                                                                   094337
     C** CALCULATE REBATE CHARGES                                         094337
     C*                                                                   094337
     C           CMNBCP    ADD  EXBL      REBATE                          094337
     C           REBATE    DIV  PERM      REBATE                          094337
     C           REBATE    MULT REB       REBATE                          094337
     C                     END                             - E1           094337
     C*                                                                   094337
     C**********           MOVE *BLANK    MINMAX                   094337 153001
     C           CCHGP     IFEQ MINC                       - E1           094337
     C           CCHGP     ANDNE*ZERO                      - E1           094337
     C                     MOVE 'MINIMUM' MINMAX  7                       094337
     C                     END                             - E1           094337
     C           CCHGP     IFEQ MAXC                       - E1           094337
     C           CCHGP     ANDNE*ZERO                      - E1           094337
     C                     MOVE 'MAXIMUM' MINMAX  7                       094337
     C                     END                             - E1           094337
     C*                                                                   094337
     C                     MOVELNAR,34    XNARR                           094337
     C                     Z-ADDCSTBL     PSTD0                           094337
      *                                                                   153001
     C                     ENDIF                                          153001
      *                                                                   153001
     C                     ENDSR                           **REBSR  ENDSR 094337
      ********************************************************************094337
     C/EJECT                                                              094337
     C********************************************************************
     C**
     C** B1EQ subroutine for begin when same date
     C**
     C**     Called by       B O T H S R
     C**
     C**     Calls           DBSR
     C**
     C           B1EQ      BEGSR                           **B1EQ   BEGSR*
     C*
     C           KLIST2    SETLLREHPOPH
     C*
     C           KLIST1    READEREHPOPH                  50
     C*
     C**  BACK VALUE PROCESSING
     C*
     C           *IN50     DOWEQ'0'                        - B1
     C***********PSTD      ANDLTCHISD                                     040447
     C***********PSTD      ANDGECLDID                               040447085250
     C           PSTD      ANDLECHISD                                     085250
     C*
      * If last day accruals a backvalued item posted on cap. value       125176
      * date is already reflected in that capitalisation.                 125176
      * If first day accruals a backvalued item posted on cap. value      125176
      * date is not reflected in that capitalisation as the cap. value    125176
      * date is cap. date + 1.                                            125176
     C           HISD      IFLT CLDID
     C           PSTD      ANDGTCLDID
     C********** LDAC      ANDEQ'N'                                085250 125176
     C           LDAC      ANDEQ'Y'                                       125176
     C           HISD      ORLT CLDID                                     085250
     C           PSTD      ANDGECLDID                                     085250
     C********** LDAC      ANDEQ'Y'                                085250 125176
     C           LDAC      ANDEQ'N'                                       125176
     C*
     C********** RECI      IFEQ 'P'                                085250 125176
     C*
     C           PPSTD     IFNE PSTD                       - B1
     C                     Z-ADDPSTD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    PSTDO
     C*
     C                     Z-ADDPSTD      PPSTD
     C*
     C                     END                             - E1
     C*
     C                     MOVE PSTDO     PSTDA
     C*
     C           PVALD     IFNE HISD                       - B1
     C                     Z-ADDHISD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALDO
     C*
     C                     Z-ADDHISD      PVALD
     C*
     C                     END                             - E1
     C*
     C                     MOVE VALDO     VALDA
     C*
     C                     MOVELPNAR      NARR
      *                                                                   125176
     C           RECI      IFEQ 'P'                                       125176
     C*
     C           DRCR      IFEQ 0                          - B1
     C                     Z-ADDPSTA      PSTD0
     C                     ELSE                            - X1
     C                     Z-SUBPSTA      PSTD0
     C                     END                             - E1
     C*
     C**  OUTPUT POSTING FOR DEBIT AND CREDIT
     C*
     C                     EXSR OVERDR
     C                     WRITEPOSTDR
     C                     MOVE '1'       *IN54
     C                     EXSR OVERCR
     C                     WRITEPOSTCR
     C/COPY WNCPYSRC,RE3761C035
     C                     MOVE '1'       *IN53
     C*
     C* CHARGE REPORT IF NECESSARY
     C*
     C                     EXSR PRN2CH                     chargesDetails2085713
     C***********CCICI     IFNE *BLANK                                    085713
     C***********CHGA      ANDNE*ZERO                                     085713
     C***********REBI      IFEQ 'Y'                                       085713
     C***********          Z-ADDCHGA      CHGR0                           085713
     C***********          Z-ADD*ZERO     CHGN0                           085713
     C***********          ELSE                                           085713
     C***********          Z-ADDCHGA      CHGN0                           085713
     C***********          Z-ADD*ZERO     CHGR0                           085713
     C***********          END                                            085713
     C***********          Z-ADDNITMS     SNITMS                          085713
     C***********          WRITEPOSTCH                                    085713
     C***********          END                                            085713
     C                     ELSE                                           094337
     C           DRCR      IFEQ 1                                         094337
     C                     Z-ADDHISD      DCRCD                           094337
     C                     EXSR RATEC                                     094337
     C                     ELSE                                           094337
     C                     Z-ADDHISD      DDRCD                           094337
     C                     EXSR RATED                                     094337
     C                     END                                            094337
     C                     END                                            094337
     C*
     C                     END
     C*
     C           KLIST1    READEREHPOPH                  50
     C*
     C                     END                             - E1
      *                                                                   125176
      * If a management cap. check for generated adjustments              125176
     C           *IN70     IFEQ '1'                        - B1
     C           KLIST1    SETLLREHISSL                  20
     C*
      * Report adjustments before start date                              125176
     C           *IN20     IFEQ '1'                        - B2
     C           KLIST1    READEREADJF                   20
     C           *IN20     DOWEQ'0'                        - B3
     C********** AHISD     ANDLTCHISD                                     64051
     C           AHISD     ANDLTCLDID                                     64051
     C*
     C** PRINT INTEREST OF THE BACK VALUE DATE
     C*
     C           SDCI      IFEQ 'Y'
     C           SCCI      OREQ 'Y'
     C*
     C           PPSTD     IFNE RUND                       - B1
     C                     Z-ADDRUND      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    PSTDO
     C*
     C                     Z-ADDRUND      PPSTD
     C*
     C                     END                             - E1
     C*
     C                     MOVE PSTDO     PSTDA
     C*
     C           PVALD     IFNE AHISD                      - B1
     C                     Z-ADDAHISD     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALDO
     C*
     C                     Z-ADDAHISD     PVALD
     C*
     C                     END                             - E1
     C*
     C                     MOVE VALDO     VALDA
     C*
     C                     MOVELNAR,23    NARR
     C*
     C           SDCI      IFEQ 'Y'
     C********** SGADI     ANDNE*ZEROS                                   064051
     C           ADAIC     ANDNE*ZEROS                                   064051
     C******************** Z-ADDSGADI     PSTD0                           064051
     C                     Z-ADDADAIC     PSTD0                           064051
     C                     EXSR OVERDR
     C                     WRITEPOSTDR
     C                     EXSR OVERCR
     C                     WRITEPOSTCR
     C                     END
     C           SCCI      IFEQ 'Y'
     C********** SGACI     ANDNE*ZEROS                                   064051
     C           ACAIC     ANDNE*ZEROS                                   064051
     C******************** Z-ADDSGACI     PSTD0                           064051
     C                     Z-SUBACAIC     PSTD0                           064051
     C                     EXSR OVERDR
     C                     WRITEPOSTDR
     C                     EXSR OVERCR
     C                     WRITEPOSTCR
     C                     END
     C*
     C                     END
     C*
     C           KLIST1    READEREADJF                   20
     C                     END                             - E3
     C*
     C                     END                             - E2
     C                     END                             - E1
     C*
     C**  PREPARE OPENING BALANCE
     C*
     C           PVALD     IFNE CLDID                      - B1
     C                     Z-ADDCLDID     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALDO
     C*
     C                     Z-ADDCLDID     PVALD
     C*
     C                     END                             - E1
     C*
     C                     MOVE VALDO     VALDA
     C*
     C                     Z-ADDDOHISB    HISB0
     C                     Z-ADDDOHISB    WHISBD                          094337
     C*
     C**  OPENING BALANCE DEBIT OUPUT
     C*
     C                     EXSR CLMSG
     C                     MOVELNAR,15    TNARR
     C*
     C                     EXSR OVERDR
     C                     WRITETITLEDR
     C                     Z-ADDCOHISB    HISB0
     C                     Z-ADDCOHISB    WHISBC                          094337
     C*
     C**  OPENING BALANCE CREDIT OUTPUT
     C*
     C                     EXSR CLMSG
     C                     MOVELNAR,16    TNARR
     C*
     C                     EXSR OVERCR
     C                     WRITETITLECR
     C*
     C                     MOVE *BLANKS   VALDA
     C                     MOVE *BLANKS   PSTDA
     C*
     C                     EXSR CLMSG
     C******************** MOVELNAR,3     RNARR                           040447
     C*
     C**  OPENING RATE DEBIT OUTPUT
     C*
     C******************** Z-ADDDRIR      RATE                            040447
     C******************** EXSR OVERDR                                    040447
     C******************** WRITERATEDR                                    040447
     C*                                                                   040447
     C**  ACCESS REHRDJ (REHPOSR1 REHPOSR2 REHPOSR3) WHICH CONTAINS       040447
     C**  THE GOOD DATES FOR DEBIT RATE CHANGE TO                         040447
     C*                                                                   040447
     C***********          Z-ADDWWDRCD    KDATE   50                040447094337
     C***********KEODLF    CHAINREHRDJ               60             040447094337
     C           KLIST2    SETLLREHRDJ                                    094337
     C           KLIST1    REDPEREHRDJ                   60               094337
     C*                                                                   040447
     C           *IN60     IFEQ '1'                        - B1           094337
     C           BDATE     ANDEQCLDID                      - B1           094337
     C           KLIST2    SETLLREHRDJ                                    094337
     C           KLIST2    READEREHRDJ                   60               094337
     C                     END                                            094337
     C           *IN60     IFEQ '1'                        - B1           040447
     C                     Z-ADD*ZEROS    DRIR                            040447
     C                     Z-ADD*ZEROS    INTP                            125176
     C                     Z-ADD*ZEROS    INST                            125176
     C                     Z-ADD*ZEROS    INRT                            125176
     C                     END                             - E1           040447
     C*                                                                   040447
     C                     EXSR CLMSG                                     040447
     C                     MOVELNAR,3     RNARR                           040447
     C*                                                                   040447
     C                     MOVE *BLANKS   PSTDA                           040447
     C                     MOVE *BLANKS   VALDA                           040447
     C*                                                                   040447
     C**  OUTPUT DEBIT RATE CHANGE TO                                     040447
     C*                                                                   040447
     C*   CHANGE NARRAT. 'RATE CHANGE TO' TO 'OPENING RATE'               040447
     C                     MOVE 'Y'       OPN     1                       040447
     C                     EXSR RDRSR                                     040447
     C                     MOVE ' '       OPN     1                       040447
     C*
     C******************** EXSR CLMSG                                     040447
     C******************** MOVELNAR,8     RNARR                           040447
      *                                                                   CRE001
      ** If CRE001 is switched ON                                         CRE001
      *                                                                   CRE001
     C           CRE001    IFEQ 'Y'                                       CRE001
      *                                                                   CRE001
      **    Output Overdraft Limit                                        CRE001
     C                     EXSR CLMSG                                     CRE001
     C                     MOVELNAR,38    ONARR                           CRE001
     C                     MOVE ODRL      OODRL                           CRE001
     C                     EXSR OVERDR                                    CRE001
     C                     WRITEODLNDC                                    CRE001
      *                                                                   CRE001
      **    Output Additional Overdraft Rate                              CRE001
     C                     EXSR CLMSG                                     CRE001
     C                     MOVELNAR,37    ONARR                           CRE001
     C                     MOVE AODR      OAODR                           CRE001
     C                     EXSR OVERDR                                    CRE001
     C                     WRITEAODRDC                                    CRE001
      *                                                                   CRE001
     C                     ENDIF                                          CRE001
     C*
     C**  OPENING RATE CREDIT OUPUT
     C*
     C******************** Z-ADDCRIR      RATE                            040447
     C******************** EXSR OVERCR                                    040447
     C******************** WRITERATECR                                    040447
     C*                                                                   040447
     C**  ACCESS REHRCJ (REHPOSR1 REHPOSR2 REHPOSR3) WHICH CONTAINS       040447
     C**  THE GOOD DATES FOR CREDIT RATE CHANGE TO                        040447
     C*                                                                   040447
     C***********          Z-ADDWWCRCD    KDATE                     040447094337
     C***********KEODLF    CHAINREHRCJ               60             040447094337
     C           KLIST3    SETLLREHRCJ                                    094337
     C           KLIST1    REDPEREHRCJ                   60               094337
     C*                                                                   040447
     C           *IN60     IFEQ '1'                        - B1           094337
     C           BDATE     ANDEQCLCID                      - B1           094337
     C           KLIST3    SETLLREHRCJ                                    094337
     C           KLIST3    READEREHRCJ                   60               094337
     C                     END                                            094337
     C           *IN60     IFEQ '1'                        - B1           040447
     C                     Z-ADD*ZEROS    CRIR                            040447
     C                     Z-ADD*ZEROS    INTP                            125176
     C                     Z-ADD*ZEROS    INST                            125176
     C                     Z-ADD*ZEROS    INRT                            125176
     C                     END                             - E1           040447
     C*                                                                   040447
     C                     EXSR CLMSG                                     040447
     C                     MOVELNAR,8     RNARR                           040447
     C*                                                                   040447
     C                     MOVE *BLANKS   PSTDA                           040447
     C                     MOVE *BLANKS   VALDA                           040447
     C*                                                                   040447
     C**  OUTPUT DEBIT RATE CHANGE TO                                     040447
     C*                                                                   040447
     C*   CHANGE NARRAT. 'RATE CHANGE TO' TO 'OPENING RATE'               040447
     C                     MOVE 'Y'       OPN     1                       040447
     C                     EXSR RCRSR                                     040447
     C                     MOVE ' '       OPN     1                       040447
      *                                                                   125176
      * If a management cap. report any adjustments on start date.        125176
     C           *IN70     IFEQ '1'                        - B0           64051
     C           KLIST1    SETLLREHISSL                  20               64051
     C*                                                                   64051
     C           *IN20     IFEQ '1'                        - B1           64051
     C           KLIST1    READEREADJF                   20               64051
     C           *IN20     DOWEQ'0'                        - B2           64051
     C           AHISD     IFEQ CLDID                      - B3           64051
     C*                                                                   64051
     C** PRINT INTEREST OF THE BACK VALUE DATE                            64051
     C*                                                                   64051
     C           SDCI      IFEQ 'Y'                        - B4           64051
     C           SCCI      OREQ 'Y'                                       64051
     C*                                                                   64051
     C           PPSTD     IFNE RUND                       - B5           64051
     C                     Z-ADDRUND      ZDAYNO                          64051
     C                     EXSR ZDATE2                                    64051
     C                     MOVE ZADATE    PSTDO                           64051
     C*                                                                   64051
     C                     Z-ADDRUND      PPSTD                           64051
     C*                                                                   64051
     C                     END                             - E5           64051
     C*                                                                   64051
     C                     MOVE PSTDO     PSTDA                           64051
     C*                                                                   64051
     C           PVALD     IFNE AHISD                      - B5           64051
     C                     Z-ADDAHISD     ZDAYNO                          64051
     C                     CALL 'ZDATA2'                                  64051
     C                     MOVE ZADATE    VALDO                           064051
     C*                                                                   64051
     C                     Z-ADDAHISD     PVALD                           64051
     C*                                                                   64051
     C                     END                             - E5           64051
     C*                                                                   64051
     C                     MOVE VALDO     VALDA                           64051
     C*                                                                   64051
     C                     MOVELNAR,23    NARR                            64051
     C*                                                                   64051
     C           SDCI      IFEQ 'Y'                        - B5           64051
     C           ADAIC     ANDNE*ZEROS                                   064051
     C                     Z-ADDADAIC     PSTD0                           64051
     C                     EXSR OVERDR                                    64051
     C                     WRITEPOSTDR                                    64051
     C                     EXSR OVERCR                                    64051
     C                     WRITEPOSTCR                                    64051
     C                     END                               - E5         64051
     C           SCCI      IFEQ 'Y'                          - B5         64051
     C           ACAIC     ANDNE*ZEROS                                   064051
     C**********           MOVELNAR,28    NARR                      64051 125176
     C                     Z-SUBACAIC     PSTD0                           64051
     C                     EXSR OVERDR                                    64051
     C                     WRITEPOSTDR                                    64051
     C                     EXSR OVERCR                                    64051
     C                     WRITEPOSTCR                                    64051
     C                     END                               - E5         64051
     C*                                                                   64051
     C*                                                                   64051
     C                     END                             - E4           64051
     C*                                                                   64051
     C                     END                             - E3           64051
     C           KLIST1    READEREADJF                   20               64051
     C*                                                                   64051
     C                     END                             - E2           64051
     C                     END                             - E1           64051
     C                     END                             - E0           64051
     C*
     C           KLIST2    SETLLREHPOPL
     C           KLIST1    READEREHPOPL                  50
     C*
     C                     ENDSR                           **B1EQ   ENDSR*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** B1GT subroutine for begin when debit greater than credit
     C**
     C**     Called by       B O T H S R
     C**
     C**     Calls           DBSR, OPENCR, OPENDR
     C**
     C           B1GT      BEGSR                           **B1GT   BEGSR*
     C*
     C           KLIST3    SETLLREHPOPH
     C*
     C           KLIST1    READEREHPOPH                  50
     C*
     C           *IN50     DOWEQ'0'                        - B1
     C           PSTD      ANDGECLCID                                     040447
     C*
     C****BACK*VALUE*PROCESSING*FOR*DEBIT*AND*CREDIT                      125176
      * Report backvalued postings/rate changes before CR start date      125176
     C*
     C           HISD      IFLT CLCID
     C           PSTD      ANDGTCLCID
     C********** LDAC      ANDEQ'N'                                094337 125176
     C           LDAC      ANDEQ'Y'                                       125176
     C           HISD      ORLT CLCID                                     094337
     C           PSTD      ANDGECLCID                                     094337
     C********** LDAC      ANDEQ'Y'                                094337 125176
     C           LDAC      ANDEQ'N'                                       125176
     C*
     C           PPSTD     IFNE PSTD                       - B1
     C                     Z-ADDPSTD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    PSTDO
     C*
     C                     Z-ADDPSTD      PPSTD
     C*
     C                     END                             - E1
     C*
     C                     MOVE PSTDO     PSTDA
     C*
     C           PVALD     IFNE HISD                       - B1
     C                     Z-ADDHISD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALDO
     C*
     C                     Z-ADDHISD      PVALD
     C*
     C                     END                             - E1
     C*
     C                     MOVE VALDO     VALDA
     C*
     C                     MOVELPNAR      NARR
      *                                                                   125176
     C           RECI      IFEQ 'P'                                       125176
     C*
     C           DRCR      IFEQ 0                          - B1
     C                     Z-ADDPSTA      PSTD0
     C                     ELSE                            - X1
     C                     Z-SUBPSTA      PSTD0
     C                     END                             - E1
     C*
     C**  OUTPUT POSTING FOR CREDIT
     C*
     C********** RECI      IFEQ 'P'                                094337 125176
     C                     EXSR OVERCR
     C                     WRITEPOSTCR
     C/COPY WNCPYSRC,RE3761C036
     C*
     C* CHARGE REPORT IF NECESSARY
     C*
     C                     EXSR PRN2CH                     chargesDetails2085713
     C***********CCICI     IFNE *BLANK                                    085713
     C***********CHGA      ANDNE*ZERO                                     085713
     C***********REBI      IFEQ 'Y'                                       085713
     C***********          Z-ADDCHGA      CHGR0                           085713
     C***********          Z-ADD*ZERO     CHGN0                           085713
     C***********          ELSE                                           085713
     C***********          Z-ADDCHGA      CHGN0                           085713
     C***********          Z-ADD*ZERO     CHGR0                           085713
     C***********          END                                            085713
     C***********          Z-ADDNITMS     SNITMS                          085713
     C***********          WRITEPOSTCH                                    085713
     C***********          END                                            085713
     C                     ELSE                                           094337
     C           DRCR      IFEQ 1                                         094337
     C                     Z-ADDHISD      DCRCD                           094337
     C                     EXSR OVERCR                                    094337
     C                     EXSR RATEC                                     094337
     C                     END                                            094337
     C                     END                                            094337
     C*
     C                     END
     C*
     C           KLIST1    READEREHPOPH                  50
     C*
     C                     END                             - E1
     C********** *IN70     IFEQ '1'                        - B1           125176
     C********** KLIST1    SETLLREHISSL                  20               125176
     C*
     C********** *IN20     IFEQ '1'                        - B2           125176
     C********** KLIST1    READEREADJF                   20               125176
     C********** *IN20     DOWEQ'0'                        - B3           125176
     C********** AHISD     ANDLTCLCID                                     125176
     C********** AHISD     ANDLTCHISD                                     125176
     C*
     C***PRINT*INTEREST*OF THE BACK VALUE DATE                            125176
     C*
     C********** SDCI      IFEQ 'Y'                                       125176
     C********** SCCI      OREQ 'Y'                                       125176
     C*
     C********** PPSTD     IFNE RUND                       - B1           125176
     C**********           Z-ADDRUND      ZDAYNO                          125176
     C**********           EXSR ZDATE2                                    125176
     C**********           MOVE ZADATE    PSTDO                           125176
     C*
     C**********           Z-ADDRUND      PPSTD                           125176
     C*
     C**********           END                             - E1           125176
     C*
     C**********           MOVE PSTDO     PSTDA                           125176
     C*
     C********** PVALD     IFNE AHISD                      - B1           125176
     C**********           Z-ADDAHISD     ZDAYNO                          125176
     C**********           EXSR ZDATE2                                    125176
     C**********           MOVE ZADATE    VALDO                           125176
     C*
     C**********           Z-ADDAHISD     PVALD                           125176
     C*
     C**********           END                             - E1           125176
     C*
     C**********           MOVE VALDO     VALDA                           125176
     C*
     C**********           MOVELNAR,23    NARR                            125176
     C*
     C********** SDCI      IFEQ 'Y'                                       125176
     C********** SGADI     ANDNE*ZEROS                                   064051
     C********** ADAIC     ANDNE*ZEROS                             064051 125176
     C******************** Z-ADDSGADI     PSTD0                           064051
     C**********           Z-ADDADAIC     PSTD0                    064051 125176
     C**********           EXSR OVERDR                                    125176
     C**********           WRITEPOSTDR                                    125176
     C**********           EXSR OVERCR                                    125176
     C**********           WRITEPOSTCR                                    125176
     C**********           END                                            125176
     C********** SCCI      IFEQ 'Y'                                       125176
     C********** SGACI     ANDNE*ZEROS                                   064051
     C********** ACAIC     ANDNE*ZEROS                             064051 125176
     C**********           MOVELNAR,28    NARR                      64051 125176
     C******************** Z-ADDSGACI     PSTD0                           064051
     C**********           Z-SUBACAIC     PSTD0                    064051 125176
     C**********           EXSR OVERDR                                    125176
     C**********           WRITEPOSTDR                                    125176
     C**********           EXSR OVERCR                                    125176
     C**********           WRITEPOSTCR                                    125176
     C**********           END                                            125176
     C*
     C**********           END                                            125176
     C*
     C********** KLIST1    READEREADJF                   20               125176
     C**********           END                             - E3           125176
     C*
     C**********           ELSE                                           125176
     C**********           MOVE '1'       *IN20                           125176
     C*
     C**********           END                             - E2           125176
     C**********           END                             - E1           125176
     C*
     C****OPENING*BALANCE*AND OPENING RATE FOR CREDIT                     125176
     C*
     C**********           EXSR OPENCR                                    125176
     C*
     C           KLIST2    SETLLREHPOPH
     C*
     C           KLIST1    READEREHPOPH                  50
     C*
     C           *IN50     DOWEQ'0'                        - B1
     C***********PSTD      ANDLTCHISD                                     040447
     C***********PSTD      ANDGECLDID                               040447085250
     C           PSTD      ANDLECHISD                                     085250
     C*
     C****BACK*VALUE*PROCESSING*FOR*DEBIT*AND*POSTING*FOR*CREDIT          125176
      * Report backvalued postings/rate changes before DR start date      125176
     C*
     C           HISD      IFLT CLDID
     C           PSTD      ANDGTCLDID
     C********** LDAC      ANDEQ'N'                                085250 125176
     C           LDAC      ANDEQ'Y'                                       125176
     C           HISD      ORLT CLDID                                     085250
     C           PSTD      ANDGECLDID                                     085250
     C********** LDAC      ANDEQ'Y'                                085250 125176
     C           LDAC      ANDEQ'N'                                       125176
     C*
     C***********RECI      IFEQ 'P'                                 085250094337
     C***********DRCR      IFEQ 1                                   085250094337
     C***********          Z-ADDHISD      DCRCD                     085250094337
     C***********          EXSR RATEC                               085250094337
     C***********          ELSE                                     085250094337
     C***********          Z-ADDHISD      DDRCD                     085250094337
     C***********          EXSR RATED                               085250094337
     C***********          END                                      085250094337
     C***********          END                                      085250094337
     C*                                                                   085250
     C           PPSTD     IFNE PSTD                       - B1
     C                     Z-ADDPSTD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    PSTDO
     C*
     C                     Z-ADDPSTD      PPSTD
     C*
     C                     END                             - E1
     C*
     C                     MOVE PSTDO     PSTDA
     C*
     C           PVALD     IFNE HISD                       - B1
     C                     Z-ADDHISD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALDO
     C*
     C                     Z-ADDHISD      PVALD
     C*
     C                     END                             - E1
     C*
     C                     MOVE VALDO     VALDA
     C*
     C                     MOVELPNAR      NARR
      *                                                                   125176
     C           RECI      IFEQ 'P'                                       125176
     C*
     C           DRCR      IFEQ 0                          - B1
     C                     Z-ADDPSTA      PSTD0
     C                     ELSE                            - X1
     C                     Z-SUBPSTA      PSTD0
     C                     END                             - E1
     C********** RECI      IFEQ 'P'                                       125176
     C*
     C****OUTPUT*POSTING*FOR*CREDIT                                       125176
      * Output to debit report                                            125176
     C*
     C                     EXSR OVERDR
     C                     WRITEPOSTDR
     C/COPY WNCPYSRC,RE3761C037
     C                     ELSE                                           094337
     C           DRCR      IFEQ 0                                         094337
     C                     Z-ADDHISD      DDRCD                           094337
     C                     EXSR RATED                                     094337
     C                     END                                            094337
     C                     END                                            094337
     C*
     C                     END
     C*
     C           KLIST1    READEREHPOPH                  50
     C*
     C                     END                             - E1
      *                                                                   125176
      * If a management cap. check for generated adjustments.             125176
     C           *IN70     IFEQ '1'                        - B1           125176
     C           KLIST1    SETLLREHISSL                  20               125176
      *                                                                   125176
      * Report adjustments before CR start date (on both reports).        125176
     C           *IN20     IFEQ '1'                        - B2           125176
     C           KLIST1    READEREADJF                   20               125176
     C           *IN20     DOWEQ'0'                        - B3           125176
     C           AHISD     ANDLTCLCID                                     125176
      *                                                                   125176
     C           SDCI      IFEQ 'Y'                                       125176
     C           SCCI      OREQ 'Y'                                       125176
      *                                                                   125176
     C           PPSTD     IFNE RUND                                      125176
     C                     Z-ADDRUND      ZDAYNO                          125176
     C                     EXSR ZDATE2                                    125176
     C                     MOVE ZADATE    PSTDO                           125176
     C                     Z-ADDRUND      PPSTD                           125176
     C                     END                                            125176
     C                     MOVE PSTDO     PSTDA                           125176
      *                                                                   125176
     C           PVALD     IFNE AHISD                                     125176
     C                     Z-ADDAHISD     ZDAYNO                          125176
     C                     EXSR ZDATE2                                    125176
     C                     MOVE ZADATE    VALDO                           125176
     C                     Z-ADDAHISD     PVALD                           125176
     C                     END                                            125176
     C                     MOVE VALDO     VALDA                           125176
      *                                                                   125176
     C                     MOVELNAR,23    NARR                            125176
      *                                                                   125176
     C           SDCI      IFEQ 'Y'                                       125176
     C           ADAIC     ANDNE*ZEROS                                    125176
     C                     Z-ADDADAIC     PSTD0                           125176
     C                     EXSR OVERDR                                    125176
     C                     WRITEPOSTDR                                    125176
     C                     EXSR OVERCR                                    125176
     C                     WRITEPOSTCR                                    125176
     C                     END                                            125176
      *                                                                   125176
     C           SCCI      IFEQ 'Y'                                       125176
     C           ACAIC     ANDNE*ZEROS                                    125176
     C                     Z-SUBACAIC     PSTD0                           125176
     C                     EXSR OVERDR                                    125176
     C                     WRITEPOSTDR                                    125176
     C                     EXSR OVERCR                                    125176
     C                     WRITEPOSTCR                                    125176
     C                     END                                            125176
      *                                                                   125176
     C                     END                                            125176
      *                                                                   125176
     C           KLIST1    READEREADJF                   20               125176
     C                     END                             - E3           125176
      *                                                                   125176
     C                     ELSE                                           125176
     C                     MOVE '1'       *IN20                           125176
      *                                                                   125176
     C                     END                             - E2           125176
     C                     END                             - E1           125176
      *                                                                   125176
      * Opening balance and opening rate for credit                       125176
     C                     EXSR OPENCR                                    125176
      *                                                                   125176
      * If management cap. check for generated adjs. before DR start      125176
      * date. Report on DR side but only report on CR side if on CR       125176
      * start date (for CR side later adjs. are reported as found on      125176
      * REHISL so they are in date sequence).                             125176
     C           *IN70     IFEQ '1'                        - B1
     C           *IN20     DOWEQ'0'                        - B3
     C           AHISD     ANDLTCLDID
     C           AHISD     ANDLTCHISD
     C*
     C** PRINT INTEREST OF THE BACK VALUE DATE
     C*
     C           SDCI      IFEQ 'Y'
     C           SCCI      OREQ 'Y'
     C*
     C           PPSTD     IFNE RUND                       - B1
     C                     Z-ADDRUND      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    PSTDO
     C*
     C                     Z-ADDRUND      PPSTD
     C*
     C                     END                             - E1
     C*
     C                     MOVE PSTDO     PSTDA
     C*
     C           PVALD     IFNE AHISD                      - B1
     C                     Z-ADDAHISD     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALDO
     C*
     C                     Z-ADDAHISD     PVALD
     C*
     C                     END                             - E1
     C*
     C                     MOVE VALDO     VALDA
     C*
     C                     MOVELNAR,23    NARR
     C           SDCI      IFEQ 'Y'
     C********** SGADI     ANDNE*ZEROS                                   064051
     C           ADAIC     ANDNE*ZEROS                                   064051
     C******************** Z-ADDSGADI     PSTD0                           064051
     C                     Z-ADDADAIC     PSTD0                           064051
     C                     EXSR OVERDR
     C                     WRITEPOSTDR
     C           AHISD     IFEQ CLCID                                     125176
     C                     EXSR OVERCR
     C                     WRITEPOSTCR
     C                     END                                            125176
     C                     END
     C           SCCI      IFEQ 'Y'
     C********** SGACI     ANDNE*ZEROS                                   064051
     C           ACAIC     ANDNE*ZEROS                                   064051
     C**********           MOVELNAR,28    NARR                      64051 125176
     C******************** Z-ADDSGACI     PSTD0                           064051
     C                     Z-SUBACAIC     PSTD0                           064051
     C                     EXSR OVERDR
     C                     WRITEPOSTDR
     C           AHISD     IFEQ CLCID                                     125176
     C                     EXSR OVERCR
     C                     WRITEPOSTCR
     C                     END                                            125176
     C                     END
     C*
     C*
     C                     END
     C*
     C           KLIST1    READEREADJF                   20
     C                     END                             - E3
     C*
     C                     END                             - E1
     C*
     C**  OPENING BALANCE AND OPENING RATE FOR DEBIT
     C*
     C                     EXSR OPENDR
     C*
      * Report any remaining adjustments on the DR report only (must      125176
      * be on DR start date).                                             125176
     C           *IN70     IFEQ '1'                        - B1
     C*
     C********** *IN20     DOWEQ'0'                        - B2           125176
     C           *IN20     ANDEQ'0'                                       125176
     C           AHISD     ANDLTCHISD
     C*
     C** PRINT INTEREST OF THE BACK VALUE DATE
     C*
     C           SDCI      IFEQ 'Y'                        - B3
     C********** SCCI      OREQ 'Y'                                       125176
     C*
     C           PPSTD     IFNE RUND                       - B4
     C                     Z-ADDRUND      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    PSTDO
     C*
     C                     Z-ADDRUND      PPSTD
     C*
     C                     END                             - E4
     C*
     C                     MOVE PSTDO     PSTDA
     C*
     C           PVALD     IFNE AHISD                      - B4
     C                     Z-ADDAHISD     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALDO
     C*
     C                     Z-ADDAHISD     PVALD
     C*
     C                     END                             - E4
     C*
     C                     MOVE VALDO     VALDA
     C*
     C                     MOVELNAR,23    NARR
     C*
     C           SDCI      IFEQ 'Y'                        - B4
     C********** SGADI     ANDNE*ZEROS                                   064051
     C           ADAIC     ANDNE*ZEROS                                   064051
     C******************** Z-ADDSGADI     PSTD0                           064051
     C                     Z-ADDADAIC     PSTD0                           064051
     C                     EXSR OVERDR
     C                     WRITEPOSTDR
     C**********           EXSR OVERCR                                    125176
     C**********           WRITEPOSTCR                                    125176
     C                     END                             - E4
     C********** SCCI      IFEQ 'Y'                        - B4           125176
     C********** SGACI     ANDNE*ZEROS                                   064051
     C********** ACAIC     ANDNE*ZEROS                             064051 125176
     C**********           MOVELNAR,28    NARR                      64051 125176
     C******************** Z-ADDSGACI     PSTD0                           064051
     C**********           Z-SUBACAIC     PSTD0                    064051 125176
     C**********           EXSR OVERDR                                    125176
     C**********           WRITEPOSTDR                                    125176
     C**********           EXSR OVERCR                                    125176
     C**********           WRITEPOSTCR                                    125176
     C**********           END                             - E4           125176
     C*
     C                     END                             - E3
     C*
     C********** KLIST1    READEREADJF                   20               125176
     C*
     C**********           END                             - E2           125176
     C*
     C                     END                             - E1
     C*
     C           KLIST3    SETLLREHPOPL
     C           KLIST1    READEREHPOPL                  50
     C*
     C                     ENDSR                           **B1GT   ENDSR*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** B1LT subroutine for begin when debit lower than credit
     C**
     C**     Called by       B O T H S R
     C**
     C**     Calls           DBSR,  OPENCR, OPENDR
     C**
     C           B1LT      BEGSR                           **B1LT   BEGSR*
     C*
     C           KLIST2    SETLLREHPOPH
     C*
     C           KLIST1    READEREHPOPH                  50
     C*
     C           *IN50     DOWEQ'0'                        - B1
     C           PSTD      ANDGECLDID                                     040447
     C*
     C****BACK*VALUE*PROCESSING*FOR*DEBIT*AND*CREDIT                      125176
      * Report backvalued postings/rate changes before DR start date      125176
     C*
     C           HISD      IFLT CLDID
     C           PSTD      ANDGTCLDID
     C********** LDAC      ANDEQ'N'                                094337 125176
     C           LDAC      ANDEQ'Y'                                       125176
     C           HISD      ORLT CLDID                                     094337
     C           PSTD      ANDGECLDID                                     094337
     C********** LDAC      ANDEQ'Y'                                094337 125176
     C           LDAC      ANDEQ'N'                                       125176
     C*
     C           PPSTD     IFNE PSTD                       - B1
     C                     Z-ADDPSTD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    PSTDO
     C*
     C                     Z-ADDPSTD      PPSTD
     C*
     C                     END                             - E1
     C*
     C                     MOVE PSTDO     PSTDA
     C*
     C           PVALD     IFNE HISD                       - B1
     C                     Z-ADDHISD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALDO
     C*
     C                     Z-ADDHISD      PVALD
     C*
     C                     END                             - E1
     C*
     C                     MOVE VALDO     VALDA
     C*
     C                     MOVELPNAR      NARR
      *                                                                   125176
     C           RECI      IFEQ 'P'                                       125176
     C*
     C           DRCR      IFEQ 0                          - B1
     C                     Z-ADDPSTA      PSTD0
     C                     ELSE                            - X1
     C                     Z-SUBPSTA      PSTD0
     C                     END                             - E1
     C********** RECI      IFEQ 'P'                                094337 125176
     C*
     C****OUTPUT*POSTING*FOR*CREDIT                                       125176
      * Output posting/rate change to debit report                        125176
     C*
     C                     EXSR OVERDR
     C                     WRITEPOSTDR
     C/COPY WNCPYSRC,RE3761C038
     C                     ELSE                                           094337
     C           DRCR      IFEQ 0                                         094337
     C                     Z-ADDHISD      DDRCD                           094337
     C                     EXSR RATED                                     094337
     C                     END                                            094337
     C                     END                                            094337
     C*
     C                     END
     C*
     C           KLIST1    READEREHPOPH                  50
     C*
     C                     END                             - E1
     C********** *IN70     IFEQ '1'                        - B1           125176
     C********** KLIST1    SETLLREHISSL                  20               125176
     C*
     C********** *IN20     IFEQ '1'                        - B2           125176
     C********** KLIST1    READEREADJF                   20               125176
     C********** *IN20     DOWEQ'0'                        - B3           125176
     C********** AHISD     ANDLTCLDID                                     125176
     C********** AHISD     ANDLTCHISD                                     125176
     C*
     C***PRINT*INTEREST*OF THE BACK VALUE DATE                            125176
     C*
     C********** SDCI      IFEQ 'Y'                                       125176
     C********** SCCI      OREQ 'Y'                                       125176
     C*
     C********** PPSTD     IFNE RUND                       - B1           125176
     C**********           Z-ADDRUND      ZDAYNO                          125176
     C**********           EXSR ZDATE2                                    125176
     C**********           MOVE ZADATE    PSTDO                           125176
     C*
     C**********           Z-ADDRUND      PPSTD                           125176
     C*
     C**********           END                             - E1           125176
     C*
     C**********           MOVE PSTDO     PSTDA                           125176
     C*
     C********** PVALD     IFNE AHISD                      - B1           125176
     C**********           Z-ADDAHISD     ZDAYNO                          125176
     C**********           EXSR ZDATE2                                    125176
     C**********           MOVE ZADATE    VALDO                           125176
     C*
     C**********           Z-ADDAHISD     PVALD                           125176
     C*
     C**********           END                             - E1           125176
     C*
     C**********           MOVE VALDO     VALDA                           125176
     C*
     C**********           MOVELNAR,23    NARR                            125176
     C********** SDCI      IFEQ 'Y'                                       125176
     C********** SGADI     ANDNE*ZEROS                                   064051
     C********** ADAIC     ANDNE*ZEROS                             064051 125176
     C******************** Z-ADDSGADI     PSTD0                           064051
     C**********           Z-ADDADAIC     PSTD0                    064051 125176
     C**********           EXSR OVERDR                                    125176
     C**********           WRITEPOSTDR                                    125176
     C**********           EXSR OVERCR                                    125176
     C**********           WRITEPOSTCR                                    125176
     C**********           END                                            125176
     C********** SCCI      IFEQ 'Y'                                       125176
     C********** SGACI     ANDNE*ZEROS                                   064051
     C********** ACAIC     ANDNE*ZEROS                             064051 125176
     C**********           MOVELNAR,28    NARR                      64051 125176
     C******************** Z-ADDSGACI     PSTD0                           064051
     C**********           Z-SUBACAIC     PSTD0                    064051 125176
     C**********           EXSR OVERDR                                    125176
     C**********           WRITEPOSTDR                                    125176
     C**********           EXSR OVERCR                                    125176
     C**********           WRITEPOSTCR                                    125176
     C**********           END                                            125176
     C*
     C**********           END                                            125176
     C*
     C********** KLIST1    READEREADJF                   20               125176
     C**********           END                             - E3           125176
     C*
     C**********           ELSE                                           125176
     C**********           MOVE '1'       *IN20                           125176
     C*
     C**********           END                             - E2           125176
     C**********           END                             - E1           125176
     C*
     C****OPENING*BALANCE*AND OPENING RATE FOR DEBIT                      125176
     C*
     C**********           EXSR OPENDR                                    125176
     C*
     C           KLIST3    SETLLREHPOPH                                   094337
     C*                                                                   094337
     C           KLIST1    READEREHPOPH                  50               094337
     C           *IN50     DOWEQ'0'                        - B1
     C***********PSTD      ANDGECLCID                                     085250
     C           PSTD      ANDLECHISD                                     085250
     C*
     C****BACK*VALUE*PROCESSING*FOR*CREDIT*AND*POSTING*FOR*DEBIT          125176
      * Report backvalued postings/rate changes before CR start date      125176
     C*
     C           HISD      IFLT CLCID
     C           PSTD      ANDGTCLCID
     C********** LDAC      ANDEQ'N'                                085250 125176
     C           LDAC      ANDEQ'Y'                                       125176
     C           HISD      ORLT CLCID                                     085250
     C           PSTD      ANDGECLCID                                     085250
     C********** LDAC      ANDEQ'Y'                                085250 125176
     C           LDAC      ANDEQ'N'                                       125176
     C*
     C           PPSTD     IFNE PSTD                       - B1
     C                     Z-ADDPSTD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    PSTDO
     C*
     C                     Z-ADDPSTD      PPSTD
     C*
     C                     END                             - E1
     C*
     C                     MOVE PSTDO     PSTDA
     C*
     C           PVALD     IFNE HISD                       - B1
     C                     Z-ADDHISD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALDO
     C*
     C                     Z-ADDHISD      PVALD
     C*
     C                     END                             - E1
     C*
     C                     MOVE VALDO     VALDA
     C*
     C                     MOVELPNAR      NARR
      *                                                                   125176
     C           RECI      IFEQ 'P'                                       125176
     C*
     C           DRCR      IFEQ 0                          - B1
     C                     Z-ADDPSTA      PSTD0
     C                     ELSE                            - X1
     C                     Z-SUBPSTA      PSTD0
     C                     END                             - E1
     C********** RECI      IFEQ 'P'                                085250 125176
     C*
     C**  OUTPUT POSTING FOR CREDIT
     C*
     C                     EXSR OVERCR
     C                     WRITEPOSTCR
     C/COPY WNCPYSRC,RE3761C039
     C*
     C* CHARGE REPORT IF NECESSARY
     C*
     C                     EXSR PRN2CH                     chargesDetails2085713
     C***********CCICI     IFNE *BLANK                                    085713
     C***********CHGA      ANDNE*ZERO                                     085713
     C***********REBI      IFEQ 'Y'                                       085713
     C***********          Z-ADDCHGA      CHGR0                           085713
     C***********          Z-ADD*ZERO     CHGN0                           085713
     C***********          ELSE                                           085713
     C***********          Z-ADDCHGA      CHGN0                           085713
     C***********          Z-ADD*ZERO     CHGR0                           085713
     C***********          END                                            085713
     C***********          Z-ADDNITMS     SNITMS                          085713
     C***********          WRITEPOSTCH                                    085713
     C***********          END                                            085713
     C*
     C                     ELSE                                           085250
     C           DRCR      IFEQ 1                                         085250
     C                     Z-ADDHISD      DCRCD                           085250
     C                     EXSR RATEC                                     085250
     C                     END                                            085250
     C                     END                                            085250
     C                     END
     C*
     C           KLIST1    READEREHPOPH                  50
     C*
     C                     END                             - E1
      *                                                                   125176
      * If a management cap. check for generated adjustments.             125176
     C           *IN70     IFEQ '1'                        - B1           125176
     C           KLIST1    SETLLREHISSL                  20               125176
      *                                                                   125176
      * Report adjustments before DR start date (on both reports).        125176
     C           *IN20     IFEQ '1'                        - B2           125176
     C           KLIST1    READEREADJF                   20               125176
     C           *IN20     DOWEQ'0'                        - B3           125176
     C           AHISD     ANDLTCLDID                                     125176
      *                                                                   125176
     C           SDCI      IFEQ 'Y'                                       125176
     C           SCCI      OREQ 'Y'                                       125176
      *                                                                   125176
     C           PPSTD     IFNE RUND                                      125176
     C                     Z-ADDRUND      ZDAYNO                          125176
     C                     EXSR ZDATE2                                    125176
     C                     MOVE ZADATE    PSTDO                           125176
     C                     Z-ADDRUND      PPSTD                           125176
     C                     END                                            125176
     C                     MOVE PSTDO     PSTDA                           125176
      *                                                                   125176
     C           PVALD     IFNE AHISD                                     125176
     C                     Z-ADDAHISD     ZDAYNO                          125176
     C                     EXSR ZDATE2                                    125176
     C                     MOVE ZADATE    VALDO                           125176
     C                     Z-ADDAHISD     PVALD                           125176
     C                     END                                            125176
     C                     MOVE VALDO     VALDA                           125176
      *                                                                   125176
     C                     MOVELNAR,23    NARR                            125176
      *                                                                   125176
     C           SDCI      IFEQ 'Y'                                       125176
     C           ADAIC     ANDNE*ZEROS                                    125176
     C                     Z-ADDADAIC     PSTD0                           125176
     C                     EXSR OVERDR                                    125176
     C                     WRITEPOSTDR                                    125176
     C                     EXSR OVERCR                                    125176
     C                     WRITEPOSTCR                                    125176
     C                     END                                            125176
      *                                                                   125176
     C           SCCI      IFEQ 'Y'                                       125176
     C           ACAIC     ANDNE*ZEROS                                    125176
     C                     Z-SUBACAIC     PSTD0                           125176
     C                     EXSR OVERDR                                    125176
     C                     WRITEPOSTDR                                    125176
     C                     EXSR OVERCR                                    125176
     C                     WRITEPOSTCR                                    125176
     C                     END                                            125176
      *                                                                   125176
     C                     END                                            125176
      *                                                                   125176
     C           KLIST1    READEREADJF                   20               125176
     C                     END                             - E3           125176
      *                                                                   125176
     C                     ELSE                                           125176
     C                     MOVE '1'       *IN20                           125176
      *                                                                   125176
     C                     END                             - E2           125176
     C                     END                             - E1           125176
      *                                                                   125176
      * Opening balance and opening rate for debit                        125176
     C                     EXSR OPENDR                                    125176
     C*
      * If management cap. check for generated adjs. before CR start      125176
      * date. Report on CR side but only report on DR side if on DR       125176
      * start date (for DR side later adjs. are reported as found on      125176
      * REHISL so they are in date sequence).                             125176
     C           *IN70     IFEQ '1'                        - B1
     C*
     C           *IN20     DOWEQ'0'                        - B3
     C           AHISD     ANDLTCLCID                                     125176
     C           AHISD     ANDLTCHISD
     C*
     C** PRINT INTEREST OF THE BACK VALUE DATE
     C*
     C           SDCI      IFEQ 'Y'
     C           SCCI      OREQ 'Y'
     C*
     C           PPSTD     IFNE RUND                       - B1
     C                     Z-ADDRUND      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    PSTDO
     C*
     C                     Z-ADDRUND      PPSTD
     C*
     C                     END                             - E1
     C*
     C                     MOVE PSTDO     PSTDA
     C*
     C           PVALD     IFNE AHISD                      - B1
     C                     Z-ADDAHISD     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALDO
     C*
     C                     Z-ADDAHISD     PVALD
     C*
     C                     END                             - E1
     C*
     C                     MOVE VALDO     VALDA
     C*
     C                     MOVELNAR,23    NARR
     C           SDCI      IFEQ 'Y'
     C********** SGADI     ANDNE*ZEROS                                   064051
     C           ADAIC     ANDNE*ZEROS                                   064051
     C******************** Z-ADDSGADI     PSTD0                           064051
     C                     Z-ADDADAIC     PSTD0                           064051
     C                     EXSR OVERCR
     C                     WRITEPOSTCR
     C           AHISD     IFEQ CLDID                                     125176
     C                     EXSR OVERDR
     C                     WRITEPOSTDR
     C                     END                                            125176
     C                     END
     C           SCCI      IFEQ 'Y'
     C********** SGACI     ANDNE*ZEROS                                   064051
     C           ACAIC     ANDNE*ZEROS                                   064051
     C**********           MOVELNAR,28    NARR                      64051 125176
     C******************** Z-ADDSGACI     PSTD0                           064051
     C                     Z-SUBACAIC     PSTD0                           064051
     C                     EXSR OVERCR
     C                     WRITEPOSTCR
     C           AHISD     IFEQ CLDID                                     125176
     C                     EXSR OVERDR
     C                     WRITEPOSTDR
     C                     END                                            125176
     C                     END
     C*
     C                     END
     C*
     C           KLIST1    READEREADJF                   20
     C                     END                             - E3
     C*
     C                     END                             - E1
     C*
     C**  OPENING BALANCE AND OPENING RATE FOR CREDIT
     C*
     C                     EXSR OPENCR
     C*
      * Report any remaining adjustments on the CR report only (must      125176
      * be on CR start date).                                             125176
     C           *IN70     IFEQ '1'                        - B1
     C*
     C********** *IN20     DOWEQ'0'                        - B2           125176
     C           *IN20     ANDEQ'0'                                       125176
     C           AHISD     ANDLTCHISD
     C*
     C** PRINT INTEREST OF THE BACK VALUE DATE
     C*
     C********** SDCI      IFEQ 'Y'                        - B3           125176
     C********** SCCI      OREQ 'Y'                                       125176
     C           SCCI      IFEQ 'Y'                                       125176
     C*
     C           PPSTD     IFNE RUND                       - B4
     C                     Z-ADDRUND      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    PSTDO
     C*
     C                     Z-ADDRUND      PPSTD
     C*
     C                     END                             - E4
     C*
     C                     MOVE PSTDO     PSTDA
     C*
     C           PVALD     IFNE AHISD                      - B4
     C                     Z-ADDAHISD     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALDO
     C*
     C                     Z-ADDAHISD     PVALD
     C*
     C                     END                             - E4
     C*
     C                     MOVE VALDO     VALDA
     C*
     C                     MOVELNAR,23    NARR
     C*
     C********** SDCI      IFEQ 'Y'                        - B4           125176
     C********** SGADI     ANDNE*ZEROS                                   064051
     C********** ADAIC     ANDNE*ZEROS                             064051 125176
     C******************** Z-ADDSGADI     PSTD0                           064051
     C**********           Z-ADDADAIC     PSTD0                    064051 125176
     C**********           EXSR OVERDR                                    125176
     C**********           WRITEPOSTDR                                    125176
     C**********           EXSR OVERCR                                    125176
     C**********           WRITEPOSTCR                                    125176
     C**********           END                             - E4           125176
     C           SCCI      IFEQ 'Y'                        - B4
     C********** SGACI     ANDNE*ZEROS                                   064051
     C           ACAIC     ANDNE*ZEROS                                   064051
     C**********           MOVELNAR,28    NARR                      64051 125176
     C******************** Z-ADDSGACI     PSTD0                           064051
     C                     Z-SUBACAIC     PSTD0                           064051
     C**********           EXSR OVERDR                                    125176
     C**********           WRITEPOSTDR                                    125176
     C                     EXSR OVERCR
     C                     WRITEPOSTCR
     C                     END                             - E4
     C*
     C                     END                             - E3
     C*
     C********** KLIST1    READEREADJF                   20               125176
     C*
     C**********           END                             - E2           125176
     C*
     C                     END                             - E1
     C*
     C           KLIST2    SETLLREHPOPL
     C           KLIST1    READEREHPOPL                  50
     C*
     C                     ENDSR                           **B1LT   ENDSR*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C***
     C***   CLEAR INPUT VARIABLES OF MESSAGE
     C***
     C           CLMSG     BEGSR                           ** SR CLMSG **
     C                     MOVEL*BLANK    MSGDT0
     C                     MOVEL*BLANK    MSGDT1
     C                     MOVEL*BLANK    MSGDT2
     C                     MOVEL*BLANK    MSGDT3
     C                     MOVEL*BLANK    MSGDT4
     C                     MOVEL*BLANK    MSGDT5
     C                     MOVEL*BLANK    MSGDT6
     C                     MOVEL*BLANK    MSGDT7
     C                     MOVEL*BLANK    MSGDT8
     C                     MOVEL*BLANK    MSGDT9
     C                     MOVEL*BLANK    MNARR
     C                     ENDSR                           **CLMSG ENDSR**
     C**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** CRSR subroutine for credit output processing
     C**
     C**     Called by       DETPR
     C**
     C**     Calls           DBSR, DAYTSR, RATEC, ITYPCR, ZICD, OVERDC
     C**
     C           CRSR      BEGSR                           **CRSR BEGSR**
     C*
     C**  OUTPUT HEADER LINES
     C*
     C                     MOVE '0'       *IN65
     C           ACNO      IFNE *ZEROS
     C                     MOVE '1'       *IN65
     C                     END
     C/COPY WNCPYSRC,RE3761C017
     C                     WRITEHEADCR
     C*
     C**CHARGE*REPORT IF NECESSARY                                        085713
     C***********                                                         085713
     C***********CCICI     IFNE *BLANK                                    085713
     C***********CCHGP     ANDNE*ZERO                                     085713
     C***********          WRITEHEADCH                                    085713
     C***********          END                                            085713
      *                                                                   125176
      * Charge report if necessary                                        125176
     C           CCICI     IFNE *BLANK                                    125176
     C           CCHGP     ANDNE*ZERO                                     125176
     C                     WRITEHEADCH                                    125176
     C                     END                                            125176
     C*
     C**  ACCESS REHISL WITH LAST CREDIT CAPITALISATION DATE
     C*
     C***********KLIST3    CHAINREHISL               52                   64051
     C           KLIST3    SETLLREHISL               52                   64051
     C*                                                                   64051
     C           KLIST1    READEREHISL                   52               64051
     C*
     C           *IN52     IFEQ '1'                        - B1
     C                     Z-ADDCLCID     WDATE
     C                     Z-ADD5         DBASE
     C                     MOVE 'REHISL'  DBFILE           ***************
     C                     MOVELRKEY2     DBKEY            **DB ERROR 05**
     C                     MOVEA'1'       *IN,89           ***************
     C                     EXSR DBSR
     C                     END                             - E1
     C*
     C           *IN52     DOWEQ'0'                        - B1
     C           DRECI     ANDEQ'S'
     C***********SDICI     ANDEQ'Y'                                      098818
     C           SDICI     ANDNE*BLANKS                                  098818
     C           SCICI     ANDEQ*BLANKS
     C           DHISD     ANDLTCHISD
     C           *IN52     OREQ '0'
     C           DRECI     ANDEQ'D'
     C           DCRCI     ANDEQ*BLANKS
     C           DDMVT     ANDEQ*ZERO                                     094337
     C           DCMVT     ANDEQ*ZERO                                     094337
     C           DMACI     ANDEQ*ZERO                                     094337
     C***********DDRCI     ANDEQ'Y'                                       094337
     C           DRECI     OREQ 'M'                                       182452
     C*
     C           KLIST1    READEREHISL                   52
     C*
     C                     END                             - E1
     C*
     C**  PREPARE B/F BALANCE
     C*
     C           DRECI     IFEQ 'B'                        - B1
     C                     Z-ADD*ZEROS    HISB0
     C                     Z-ADDDHISD     BDATE   50                      094337
     C                     ELSE                            - X1
     C           DRECI     IFEQ 'S'                        - B2
     C                     Z-ADDSSTBL     HISB0
     C                     ELSE                            - X2
     C                     Z-ADDCLCID     WDATE
     C                     Z-ADD6         DBASE
     C                     MOVE 'REHISL'  DBFILE           ***************
     C                     MOVELRKEY2     DBKEY            **DB ERROR 06**
     C                     MOVEA'1'       *IN,89           ***************
     C                     EXSR DBSR
     C                     END                             - E2
     C                     END                             - E1
     C*
     C                     Z-ADDDHISB     COHISB
     C                     Z-ADDDHISB     WHISB                           058684
     C                     MOVE *BLANKS   VALDA
     C*
     C                     EXSR CLMSG
     C                     MOVELNAR,1     TNARR
     C*
     C**  OUTPUT B/F BALANCE
     C*
     C                     EXSR OVERCR
     C                     WRITETITLECR
     C*
     C           KLIST3    SETLLREHPOPH
     C*
     C           KLIST1    READEREHPOPH                  50
     C*
     C**  BACK VALUE PROCESSING START
     C*
     C           *IN50     DOWEQ'0'                        - B1
     C***********PSTD      ANDGECLCID                                     094337
     C           PSTD      ANDLECHISD                                     094337
     C*
     C**  TRANSFER DATE MIDAS INTO DDMMMYY
     C*
      * If last day accruals a backvalued item posted on cap. value       125176
      * date is already reflected in that capitalisation.                 125176
      * If first day accruals a backvalued item posted on cap. value      125176
      * date is not reflected in that capitalisation as the cap. value    125176
      * date is cap. date + 1.                                            125176
     C           HISD      IFLT CLCID
     C           PSTD      ANDGTCLCID
     C********** LDAC      ANDEQ'N'                                094337 125176
     C           LDAC      ANDEQ'Y'                                       125176
     C           HISD      ORLT CLCID                                     094337
     C           PSTD      ANDGECLCID                                     094337
     C********** LDAC      ANDEQ'Y'                                094337 125176
     C           LDAC      ANDEQ'N'                                       125176
     C*
     C           PPSTD     IFNE PSTD                       - B2
     C                     Z-ADDPSTD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    PSTDO
     C*
     C                     Z-ADDPSTD      PPSTD
     C                     END                             - E2
     C*
     C                     MOVE PSTDO     PSTDA
     C*
     C**  TRANSFER DATE MIDAS INTO DDMMMYY
     C*
     C           PVALD     IFNE HISD                       - B2
     C                     Z-ADDHISD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALDO
     C*
     C                     Z-ADDHISD      PVALD
     C                     END                             - E2
     C*
     C                     MOVELPNAR      NARR
     C                     MOVE VALDO     VALDA
     C*
     C**  CHECK IF DEBIT OR CREDIT
     C*
     C           RECI      IFEQ 'P'                        - B3           094337
     C           DRCR      IFEQ 0                          - B2
     C           TURN      IFNE 'Y'
     C                     MOVE '1'       *IN33
     C                     END
     C                     Z-ADDPSTA      PSTD0
     C                     ELSE                            - X2
     C                     Z-SUBPSTA      PSTD0
     C                     END                             - E2
     C*
     C**  OUTPUT BACK VALUE
     C*
     C                     EXSR OVERCR
     C                     WRITEPOSTCR
     C/COPY WNCPYSRC,RE3761C040
     C*
     C                     MOVE '0'       *IN33
     C*
     C***********          END                              - E3          094337
     C*
     C* CHARGE REPORT IF NECESSARY
     C*
     C                     EXSR PRN2CH                     chargesDetails2085713
     C***********CCICI     IFNE *BLANK                                    085713
     C***********CHGA      ANDNE*ZERO                                     085713
     C***********REBI      IFEQ 'Y'                                       085713
     C***********          Z-ADDCHGA      CHGR0                           085713
     C***********          Z-ADD*ZERO     CHGN0                           085713
     C***********          ELSE                                           085713
     C***********          Z-ADDCHGA      CHGN0                           085713
     C***********          Z-ADD*ZERO     CHGR0                           085713
     C***********          END                                            085713
     C***********          Z-ADDNITMS     SNITMS                          085713
     C***********          WRITEPOSTCH                                    085713
     C***********          END                                            085713
     C                     ELSE                             - X3          094337
     C           DRCR      IFEQ 1                           - B4          094337
     C                     Z-ADDHISD      DCRCD                           094337
     C                     EXSR RATEC                                     094337
     C                     END                              - E4          094337
     C                     END                              - E3          094337
      *
     C                     END                              - E2          094337
     C*
     C           KLIST1    READEREHPOPH                  50
     C*
     C                     END                             - E1
     C*
      * Generated adjustments going to the a/c should be reported for     125176
      * both management and non-management CR only cap. as they affect    125176
      * the balance and DR adjs. would not be posted at a CR only cap.    125176
     C********** *IN70     IFEQ '1'                        - B1           125176
     C           KLIST1    SETLLREHISSL                  20
     C*
      * Report generated adjustments before start date                    125176
     C           *IN20     IFEQ '1'                        - B2
     C           KLIST1    READEREADJF                   20
     C           *IN20     DOWEQ'0'                        - B3
     C********** AHISD     ANDLECLCID                                     125176
     C           AHISD     ANDLTCLCID                                     125176
     C           AHISD     ANDLTCHISD
     C*
     C** PRINT INTEREST OF THE BACK VALUE DATE
     C*
     C***********SDCI      IFEQ 'Y'                        - B4           094337
     C***********SCCI      OREQ 'Y'                                       094337
     C           SCCI      IFEQ 'Y'                                       094337
     C           SDCI      OREQ 'Y'                                       125176
     C*
     C           PPSTD     IFNE RUND                       - B5
     C                     Z-ADDRUND      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    PSTDO
     C*
     C                     Z-ADDRUND      PPSTD
     C*
     C                     END                             - E5
     C*
     C                     MOVE PSTDO     PSTDA
     C*
     C           PVALD     IFNE AHISD                      - B5
     C                     Z-ADDAHISD     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALDO
     C*
     C                     Z-ADDAHISD     PVALD
     C*
     C                     END                             - E5
     C*
     C                     MOVE VALDO     VALDA
     C*
     C                     MOVELNAR,23    NARR
     C*
     C           SDCI      IFEQ 'Y'                        - B5
     C********** SGADI     ANDNE*ZEROS                                   064051
     C           ADAIC     ANDNE*ZEROS                                   064051
     C******************** Z-ADDSGADI     PSTD0                           064051
     C                     Z-ADDADAIC     PSTD0                           064051
     C                     EXSR OVERCR
     C                     WRITEPOSTCR
     C                     END                             - E5
     C           SCCI      IFEQ 'Y'                        - B5
     C********** SGACI     ANDNE*ZEROS                                   064051
     C           ACAIC     ANDNE*ZEROS                                   064051
     C**********           MOVELNAR,28    NARR                      64051 125176
     C******************** Z-ADDSGACI     PSTD0                           064051
     C                     Z-SUBACAIC     PSTD0                           064051
     C                     EXSR OVERCR
     C                     WRITEPOSTCR
     C                     END                             - E5
     C*
     C                     END                             - E4
     C*
     C           KLIST1    READEREADJF                   20
     C                     END                             - E3
     C*
     C                     ELSE                                           125176
     C                     MOVE '1'       *IN20                           125176
     C                     END                             - E2
     C*
     C**********           END                             - E1           125176
     C*
     C**  BACK VALUE PROCESSING END
     C*
     C           KLIST3    SETLLREHPOPL
     C           KLIST1    READEREHPOPL                  50
     C*
     C**  PREPARE OPENING BALANCE OUTPUT
     C*
     C           DRECI     IFEQ 'B'                        - B1
     C                     Z-ADDDHISB     WHISB
     C                     ELSE                            - X1
     C           DRECI     IFEQ 'S'                        - B2
     C                     Z-ADDSSTBL     WHISB
     C                     END                             - E2
     C                     END                             - E1
     C                     Z-ADDCOHISB    HISB0
     C                     Z-ADDCOHISB    WHISBC                          094337
     C*
     C                     EXSR CLMSG
     C                     MOVELNAR,2     TNARR
     C*
     C**  SAVE IN CASE OF NO POSTING
     C*
     C                     Z-ADDCLCID     WHISD
     C*
     C**  TRANSFER DATE MIDAS INTO DDMMMYY
     C*
     C           CLCID     IFNE PVALD                      - B1
     C*
     C                     Z-ADDCLCID     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALDO
     C*
     C                     Z-ADDCLCID     PVALD
     C*
     C                     END                             - E1
     C*
     C                     MOVE VALDO     VALDA
      *                                                                   182452
      ** Save opening date.                                               182452
      *                                                                   182452
     C                     Z-ADDCLCID     WSMNT   50                      182452
     C*
     C**  OUTPUT OPENING BALANCE
     C*
     C                     EXSR OVERCR
     C                     WRITETITLECR
     C*
     C**  PREPARE OPENING RATE OUTPUT
     C*
     C                     MOVE *BLANKS   VALDA
     C                     MOVE *BLANKS   PSTDA
     C*
     C                     EXSR CLMSG
     C                     MOVELNAR,8     RNARR
     C*
     C**  OUTPUT OPENING RATE
     C*
      *                                                                   094337
      **  ACCESS REHRCJ (REHPOSR1 REHPOSR2 REHPOSR3) WHICH CONTAINS       094337
      **  THE GOOD DATES FOR DEBIT RATE CHANGE TO                         094337
      *                                                                   094337
     C           KLIST3    SETLLREHRCJ                                    094337
     C           KLIST1    REDPEREHRCJ                   60               094337
      *                                                                   094337
     C           *IN60     IFEQ '1'                        - B1           094337
     C           BDATE     ANDEQCLCID                      - B1           094337
     C           KLIST3    SETLLREHRCJ                                    094337
     C           KLIST3    READEREHRCJ                   60               094337
     C                     END                                            094337
      *                                                                   094337
     C           *IN60     IFEQ '1'                        - B1           094337
     C                     Z-ADD*ZEROS    CRIR                            094337
     C                     Z-ADD*ZEROS    INTP                            125176
     C                     Z-ADD*ZEROS    INST                            125176
     C                     Z-ADD*ZEROS    INRT                            125176
     C                     END                             - E1           094337
      *                                                                   094337
     C                     EXSR CLMSG                                     094337
     C                     MOVELNAR,8     RNARR                           094337
      *                                                                   094337
     C                     MOVE *BLANKS   PSTDA                           094337
     C                     MOVE *BLANKS   VALDA                           094337
      *                                                                   094337
      **  OUTPUT CREDIT RATE CHANGE TO                                    094337
      *                                                                   094337
      *   CHANGE NARRAT. 'RATE CHANGE TO' TO 'OPENING RATE'               094337
     C                     MOVE 'Y'       OPN     1                       094337
     C                     EXSR RCRSR                                     094337
     C                     MOVE ' '       OPN     1                       094337
     C***********          Z-ADDCRIR      RATE                            094337
     C***********          EXSRDOVERCR                                    094337
     C***********          WRITERATECR                                    094337
      *                                                                   125176
      * Report generated adjustments on start date                        125176
     C           *IN20     IFEQ '0'                                       125176
     C           AHISD     ANDEQCLCID                                     125176
      *                                                                   125176
     C           SDCI      IFEQ 'Y'                                       125176
     C           SCCI      OREQ 'Y'                                       125176
      *                                                                   125176
     C           PPSTD     IFNE RUND                                      125176
     C                     Z-ADDRUND      ZDAYNO                          125176
     C                     EXSR ZDATE2                                    125176
     C                     MOVE ZADATE    PSTDO                           125176
     C                     Z-ADDRUND      PPSTD                           125176
     C                     END                                            125176
     C                     MOVE PSTDO     PSTDA                           125176
      *                                                                   125176
     C           PVALD     IFNE AHISD                                     125176
     C                     Z-ADDAHISD     ZDAYNO                          125176
     C                     EXSR ZDATE2                                    125176
     C                     MOVE ZADATE    VALDO                           125176
     C                     Z-ADDAHISD     PVALD                           125176
     C                     END                                            125176
     C                     MOVE VALDO     VALDA                           125176
      *                                                                   125176
     C                     MOVELNAR,23    NARR                            125176
      *                                                                   125176
     C           SDCI      IFEQ 'Y'                                       125176
     C           ADAIC     ANDNE*ZEROS                                    125176
     C                     MOVE 'Y'       @ADJF                           125176
     C                     Z-ADDADAIC     PSTD0                           125176
     C                     EXSR OVERCR                                    125176
     C                     WRITEPOSTCR                                    125176
     C                     END                                            125176
      *                                                                   125176
     C           SCCI      IFEQ 'Y'                                       125176
     C           ACAIC     ANDNE*ZEROS                                    125176
     C                     MOVE 'Y'       @ADJF                           125176
     C                     Z-SUBACAIC     PSTD0                           125176
     C                     EXSR OVERCR                                    125176
     C                     WRITEPOSTCR                                    125176
     C                     END                                            125176
      *                                                                   125176
     C                     END                                            125176
     C                     END                                            125176
     C*
     C           DRECI     IFEQ 'S'                        - B1
     C                     Z-ADDDHISD     WHISD
     C                     Z-ADDDHISB     WHISB
     C                     Z-ADDSMNBL     WMNBL
     C                     Z-ADDDDRCB     WDRCB
     C                     Z-ADDDCRCB     WCRCB
     C           KLIST1    READEREHISL                   51
     C*
     C           *IN51     DOWEQ'0'                        - B2
     C           DRECI     ANDEQ'S'
     C***********SDICI     ANDEQ'Y'                                       094337
     C********** SCICI     ANDEQ*BLANKS                                   125176
     C           DHISD     ANDLTCHISD
     C           *IN51     OREQ '0'
     C           DRECI     ANDEQ'D'
     C           DCRCI     ANDEQ*BLANKS
     C********** DDRCI     ANDEQ'Y'                                       125176
     C           DDMVT     ANDEQ*ZERO                                     094337
     C           DCMVT     ANDEQ*ZERO                                     094337
     C           DMACI     ANDEQ*ZERO                                     094337
     C           @ADJF     ANDEQ*BLANKS                                   125176
      *                                                                   125176
      * Check for generated adjustment after start date (must be DR).     125176
     C           *IN51     IFEQ '0'                                       125176
     C           DRECI     ANDEQ'S'                                       125176
     C           DHISD     ANDLTCHISD                                     125176
     C           SDAIC     ANDNE*ZEROS                                    125176
     C           SSDCI     ANDEQ'Y'                                       125176
     C                     Z-ADDSDAIC     @GADJ                           125176
     C                     MOVE 'Y'       @ADJF                           125176
     C                     END                                            125176
      *                                                                   125176
     C           KLIST1    READEREHISL                   51
     C                     END                             - E2
     C**If*the*history*record found is the start of the next       088762 125176
     C**capitalization*date then do not process.                   088762 125176
     C********** *IN51     IFEQ '0'                                088762 125176
     C********** DRECI     ANDEQ'S'                                088762 125176
     C********** DHISD     ANDEQCHISD                              088762 125176
     C**********           SETON                     51            088762 125176
     C**********           ENDIF                                   088762 125176
     C*
     C********** *IN51     IFEQ '0'                        - B2           094663
     C***********WHISD     ANDNEDHISD                                     094663
     C*
     C***********CCICT     IFLT 3                          - B3           094663
     C***********          Z-ADDWCRCB     ZICALC                          094663
     C***********          Z-ADDWHISD     ZIBEG                           094663
     C***********          Z-ADDDHISD     ZIEND                           094663
     C***********          EXSR DAYCSR                                    094663
     C***********          ELSE                            - X3           094663
     C***********          EXSR ITYPCR                                    094663
     C***********          END                             - E3           094663
     C*
     C***********          END                             - E2           094663
     C           *IN51     IFEQ '0'                        - B2           125176
     C           WHISD     ANDNEDHISD                                     125176
     C           DHISD     ANDLTCHISD                                     125176
     C********** CCICT     IFLT 3                          - B3    125176 182452
     C           DCICT     IFLT 3                          - B3           182452
     C                     Z-ADDWCRCB     ZICALC                          125176
     C                     Z-ADDWHISD     ZIBEG                           125176
     C                     Z-ADDDHISD     ZIEND                           125176
     C                     EXSR DAYCSR                                    125176
     C                     ELSE                            - X3           125176
     C                     EXSR ITYPCR                                    125176
     C                     END                             - E3           125176
     C                     END                             - E2           125176
     C*
     C                     END                             - E1
     C*
     C           *IN51     DOWEQ'0'                        - B1
     C           DHISD     ANDLTCHISD
      *                                                                   125176
      * Report generated adjustment after start date if found             125176
     C           @ADJF     IFEQ 'Y'                                       125176
     C                     EXSR #ADJ                                      125176
     C           DHISD     IFGT CLCID                                     125176
     C                     EXSR OVERCR                                    125176
     C                     WRITEPOSTCR                                    125176
     C                     END                                            125176
     C                     END                                            125176
     C*
     C**  PROCESS POSTING AT THE SAME DATE
     C*
     C           *IN50     DOWEQ'0'                        - B2
     C           DHISD     ANDEQHISD
     C*
     C**  TRANSFER DATE MIDAS INTO DDMMMYY
     C*
     C           PPSTD     IFNE PSTD                       - B3
     C                     Z-ADDPSTD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    PSTDO
     C*
     C                     END                             - E3
     C*
     C**  TRANSFER DATE MIDAS INTO DDMMMYY
     C*
     C           PVALD     IFNE HISD                       - B3
     C                     Z-ADDHISD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALDO
     C*
     C                     END                             - E3
     C*
     C                     MOVE VALDO     VALDA
     C                     MOVE PSTDO     PSTDA
     C                     MOVELPNAR      NARR
     C*
     C**  CHECK IF DEBIT OR CREDIT
     C*
     C           DRCR      IFEQ 0                          - B3
     C           TURN      IFNE 'Y'
     C                     MOVE '1'       *IN33
     C                     END
     C                     Z-ADDPSTA      PSTD0
     C                     ELSE                            - X3
     C                     Z-SUBPSTA      PSTD0
     C                     END                             - E3
     C*
     C**  OUTPUT POSTING
     C*
     C                     EXSR OVERCR
     C                     WRITEPOSTCR
     C/COPY WNCPYSRC,RE3761C041
     C*
     C                     MOVE '0'       *IN33
     C*
     C* CHARGE REPORT IF NECESSARY
     C*
     C                     EXSR PRN2CH                     chargesDetails2085713
     C***********CCICI     IFNE *BLANK                                    085713
     C***********CHGA      ANDNE*ZERO                                     085713
     C***********REBI      IFEQ 'Y'                                       085713
     C***********          Z-ADDCHGA      CHGR0                           085713
     C***********          Z-ADD*ZERO     CHGN0                           085713
     C***********          ELSE                                           085713
     C***********          Z-ADDCHGA      CHGN0                           085713
     C***********          Z-ADD*ZERO     CHGR0                           085713
     C***********          END                                            085713
     C***********          Z-ADDNITMS     SNITMS                          085713
     C***********          WRITEPOSTCH                                    085713
     C***********          END                                            085713
     C*
     C                     Z-ADDPSTD      PPSTD
     C                     Z-ADDHISD      PVALD
     C*
     C           KLIST1    READEREHPOPL                  50
     C*
     C                     END                             - E2
     C*
     C** PRINT THE MANUAL ADJUSTEMENT
     C*
     C           DMACI     IFNE *ZEROS
     C*
     C           KLIST9    SETLLREHPOML2                 56
     C           KLIST9    READEREHPOML2                 56
     C           *IN56     DOWEQ'0'
     C*
     C           PPSTD     IFNE MAHISD                     - B1
     C                     Z-ADDMAHISD    ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    PSTDO
     C*
     C                     END                             - E1
     C*
     C                     MOVE PSTDO     PSTDA
     C*
     C           PVALD     IFNE VALD                       - B1
     C                     Z-ADDVALD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALDO
     C*
     C                     Z-ADDVALD      PVALD
     C*
     C                     END                             - E1
     C*
     C                     MOVE VALDO     VALDA
     C*
     C                     MOVELNAR,29    NARR
     C*
     C           CRIA      IFNE *ZEROS
     C                     Z-ADDCRIA      INTC0
     C*******************  EXSR OVERCR                                    094431
     C*******************  WRITEMADJCR                                    094431
     C                     MOVE 'CR'      DCFLAG                          094431
     C                     EXSR WMA                        WRITE MAN ADJ  094431
     C                     Z-ADD*ZEROS    INTC0
     C                     END
     C*
     C           KLIST9    READEREHPOML2                 56
     C*
     C                     END
     C*
     C                     END
     C*
     C**  CREDIT RATE CHANGE TO
     C*
     C           DCRCI     IFEQ 'Y'                        - B2
     C           DRECI     ANDNE'B'
     C           DRECI     ANDNE'M'                                       182452
     C*
     C                     EXSR RATEC
     C*
     C                     END                             - E2
     C*
     C**  SAVE REHISL  AS PREVIOUS
     C*
     C                     Z-ADDDHISD     WHISD
     C                     Z-ADDDHISB     WHISB
     C                     MOVE DDRCB     WDRCB
     C                     Z-ADDDCRCB     WCRCB
     C                     Z-ADDDCAID     WCAID
     C                     Z-ADDDDAID     WDAID
     C*
     C           KLIST1    READEREHISL                   51
     C*
     C           *IN51     DOWEQ'0'                        - B2
     C           DRECI     ANDEQ'S'
     C***********SDICI     ANDEQ'Y'                                       094337
     C********** SCICI     ANDEQ*BLANKS                                   125176
     C           DHISD     ANDLTCHISD
     C           *IN51     OREQ '0'
     C           DRECI     ANDEQ'D'
     C           DCRCI     ANDEQ*BLANKS
     C***********DDRCI     ANDEQ'Y'                                       094337
     C           DDMVT     ANDEQ*ZEROS
     C           DCMVT     ANDEQ*ZEROS
     C           DMACI     ANDEQ*ZERO                                     094337
     C           @ADJF     ANDEQ*BLANKS                                   125176
      *                                                                   125176
      * Check for DR generated adjustment                                 125176
     C           *IN51     IFEQ '0'                                       125176
     C           DRECI     ANDEQ'S'                                       125176
     C           DHISD     ANDLTCHISD                                     125176
     C           SDAIC     ANDNE*ZEROS                                    125176
     C           SSDCI     ANDEQ'Y'                                       125176
     C                     Z-ADDSDAIC     @GADJ                           125176
     C                     MOVE 'Y'       @ADJF                           125176
     C                     END                                            125176
     C*
     C           KLIST1    READEREHISL                   51
     C*
     C                     END                             - E2
     C*
     C**  OUTPUT SUBTOTAL LINE
     C*
     C           *IN51     IFEQ '0'                        - B2
     C           DHISD     ANDLTCHISD
     C*
     C********** CCICT     IFLT 3                          - B3           182452
     C           DCICT     IFLT 3                          - B3           182452
     C                     Z-ADDWCRCB     ZICALC
     C                     Z-ADDWHISD     ZIBEG
     C                     Z-ADDDHISD     ZIEND
     C                     EXSR DAYCSR
     C                     ELSE                            - X3
     C                     EXSR ITYPCR
     C                     END                             - E3
     C*
     C********** *IN51     DOWEQ'0'                        - B3           125176
     C********** DHISD     ANDLTHISD                                      125176
     C********** CHISD     ANDLTHISD                                      125176
     C*
     C***PRINT*THE*MANUAL*ADJUSTEMENT                                     125176
     C*
     C********** DMACI     IFNE *ZEROS                                    125176
     C*
     C********** KLIST9    SETLLREHPOML2                 56               125176
     C********** KLIST9    READEREHPOML2                 56               125176
     C********** *IN56     DOWEQ'0'                                       125176
     C*
     C********** PPSTD     IFNE MAHISD                     - B1           125176
     C**********           Z-ADDMAHISD    ZDAYNO                          125176
     C**********           EXSR ZDATE2                                    125176
     C**********           MOVE ZADATE    PSTDO                           125176
     C*
     C**********           END                             - E1           125176
     C*
     C**********           MOVE PSTDO     PSTDA                           125176
     C*
     C********** PVALD     IFNE VALD                       - B1           125176
     C**********           Z-ADDVALD      ZDAYNO                          125176
     C**********           EXSR ZDATE2                                    125176
     C**********           MOVE ZADATE    VALDO                           125176
     C*
     C**********           Z-ADDVALD      PVALD                           125176
     C*
     C**********           END                             - E1           125176
     C*
     C**********           MOVE VALDO     VALDA                           125176
     C*
     C**********           MOVELNAR,29    NARR                            125176
     C*
     C********** CRIA      IFNE *ZEROS                                    125176
     C**********           Z-ADDCRIA      INTC0                           125176
     C*******************  EXSR OVERCR                                    094431
     C*******************  WRITEMADJCR                                    094431
     C**********           MOVE 'CR'      DCFLAG                   094431 125176
     C**********           EXSR WMA                 WRITE MAN ADJ  094431 125176
     C**********           Z-ADD*ZEROS    INTC0                           125176
     C**********           END                                            125176
     C*
     C********** KLIST9    READEREHPOML2                 56               125176
     C*
     C**********           END                                            125176
     C*
     C**********           END                                            125176
     C*
     C*
     C****CHECK*IF*READ*RECORD*IS*A*CHANGE*RATE                           125176
     C*
     C********** DCRCI     IFEQ 'Y'                        - B4           125176
     C********** DRECI     ANDNE'B'                                       125176
     C*
     C**********           EXSR RATEC                                     125176
     C*
     C*
     C****SAVE*REHISL**AS*PREVIOUS                                        125176
     C*
     C**********           Z-ADDDHISD     WHISD                           125176
     C**********           Z-ADDDHISB     WHISB                           125176
     C**********           MOVE DDRCB     WDRCB                           125176
     C**********           Z-ADDDCRCB     WCRCB                           125176
     C**********           Z-ADDDCAID     WCAID                           125176
     C**********           Z-ADDDDAID     WDAID                           125176
     C*
     C********** KLIST1    READEREHISL                   51               125176
     C*
     C********** *IN51     DOWEQ'0'                        - B5           125176
     C********** DRECI     ANDEQ'S'                                       125176
     C***********SDICI     ANDEQ'Y'                                       094337
     C********** SCICI     ANDEQ*BLANKS                                   125176
     C********** DHISD     ANDLTCHISD                                     125176
     C********** *IN51     OREQ '0'                                       125176
     C********** DRECI     ANDEQ'D'                                       125176
     C********** DCRCI     ANDEQ*BLANKS                                   125176
     C***********DDRCI     ANDEQ'Y'                                       094337
     C********** DDMVT     ANDEQ*ZEROS                             094337 125176
     C********** DCMVT     ANDEQ*ZEROS                             094337 125176
     C********** DMACI     ANDEQ*ZEROS                             094337 125176
     C*
     C********** KLIST1    READEREHISL                   51               125176
     C*
     C**********           END                             - E5           125176
     C*
     C********** CCICT     IFLT 3                          - B5           125176
     C**********           Z-ADDWCRCB     ZICALC                          125176
     C**********           Z-ADDWHISD     ZIBEG                           125176
     C**********           Z-ADDDHISD     ZIEND                           125176
     C**********           EXSR DAYCSR                                    125176
     C**********           ELSE                            - X5           125176
     C**********           EXSR ITYPCR                                    125176
     C**********           END                             - E5           125176
     C*
     C**********           ELSE                            - X4           125176
     C*
     C***********KLIST1    READEREHISL                   51               125176
     C*
     C********** *IN51     DOWEQ'0'                        - B5           125176
     C***********DRECI     ANDEQ'S'                                       125176
     C***********SDICI     ANDEQ'Y'                                       094337
     C***********SCICI     ANDEQ*BLANKS                                   125176
     C***********DHISD     ANDLTCHISD                                     125176
     C********** *IN51     OREQ '0'                                       125176
     C***********DRECI     ANDEQ'D'                                       125176
     C***********DCRCI     ANDEQ*BLANKS                                   125176
     C***********DDRCI     ANDEQ'Y'                                       094337
     C***********DDMVT     ANDEQ*ZEROS                             094337 125176
     C***********DCMVT     ANDEQ*ZEROS                             094337 125176
     C***********DMACI     ANDEQ*ZEROS                             094337 125176
     C*
     C***********KLIST1    READEREHISL                   51               125176
     C*
     C***********          END                             - E5           125176
     C*
     C***********          END                             - E4           125176
     C*
     C**********           END                             - E3           125176
     C*
     C                     END                             - E2
     C*
     C                     END                             - E1
     C*
     C********** KLIST3    SETLLREHISL                   52               125176
     C*
     C********** *IN52     IFEQ '0'                        - B1           125176
     C**********           Z-ADDCLCID     WDATE                           125176
     C**********           Z-ADD7         DBASE                           125176
     C**********           MOVE 'REHISL'  DBFILE           ***************125176
     C**********           MOVELRKEY2     DBKEY            **DB ERROR 07**125176
     C**********           MOVEA'1'       *IN,89           ***************125176
     C**********           EXSR DBSR                                      125176
     C**********           END                             - E1           125176
     C*
     C********** KLIST1    READEREHISL                   52               125176
     C*
     C********** *IN52     DOWEQ'0'                        - B1           125176
     C********** DRECI     ANDEQ'S'                                       125176
     C***********SDICI     ANDEQ'Y'                                       094337
     C********** SCICI     ANDEQ*BLANKS                                   125176
     C********** DHISD     ANDLTCHISD                                     125176
     C********** *IN52     OREQ '0'                                       125176
     C********** DRECI     ANDEQ'D'                                       125176
     C********** DCRCI     ANDEQ*BLANKS                                   125176
     C***********DDRCI     ANDEQ'Y'                                       094337
     C********** DDMVT     ANDEQ*ZEROS                             094337 125176
     C********** DCMVT     ANDEQ*ZEROS                             094337 125176
     C********** DMACI     ANDEQ*ZEROS                             094337 125176
     C*
     C********** KLIST1    READEREHISL                   52               125176
     C*
     C**********           END                             - E1           125176
     C*
     C           DCICT     IFLT 3                          - B1
     C*
     C                     Z-ADDWCRCB     ZICALC
     C                     Z-ADDWHISD     ZIBEG
     C                     Z-ADDCHISD     ZIEND
     C*
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C*
     C                     Z-ADDWHISB     HISB0
     C           HISB0     MULT DAYS      NUMB0
     C*
     C********** WHISB     IFGT *ZEROS                     - B1           125176
     C********** CDAIC     SUB  WDAID     INTD0                           125176
     C**********           Z-ADD*ZEROS    INTC0                           125176
     C**********           ELSE                            - X1           125176
     C           CCAIC     SUB  WCAID     INTC0
     C                     SUB  MACR#     INTC0                           125176
     C                     Z-SUBINTC0     INTC0
     C**********           Z-ADD*ZEROS    INTD0                           125176
     C**********           END                             - E1           125176
     C*
     C**  OUTPUT SUBTOTAL
     C*
     C*******************  EXSR OVERCR                                    094431
     C*******************  WRITESTOTCR                                    094431
     C                     MOVE 'CR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C*
     C* CHARGE REPORT IF NECESSARY
     C*
     C**********           EXSR PRN1CH              chargesDetails1085713 125176
     C***********CCICI     IFNE *BLANK                                    085713
     C***********DTHGAR    IFNE *ZERO                                     085713
     C***********DTHGAN    ORNE *ZERO                                     085713
     C***********          Z-ADDDTHGAR    CHGR0                           085713
     C***********          Z-ADDDTHGAN    CHGN0                           085713
     C***********          Z-ADDNITMS     SNITMS                          085713
     C***********          WRITEPOSTCH                                    085713
     C***********          END                                            085713
     C***********          END                                            085713
     C*
     C                     END                             - E1
     C*
     C** PREPARE C/F BALANCE
     C*
     C                     EXSR CLMSG
     C                     MOVELNAR,6     TNARR
     C*
     C**  TRANSFER DATE MIDAS INTO DDMMMYY
     C*
     C           PVALD     IFNE CHISD                      - B1
     C                     Z-ADDCHISD     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALDO
     C*
     C                     MOVE CHISD     PVALD
     C*
     C                     END                             - E1
     C*
     C                     MOVE VALDO     VALDA
     C                     Z-ADDCHISB     HISB0
     C*
     C**  OUTPUT BALANCE C/F
     C*
     C                     EXSR OVERCR
     C                     WRITETITLECR
     C*
     C**  PREPARE TOTAL INTEREST OUTPUT
     C*
     C                     Z-ADDWCRCB     ZICALC
     C                     Z-ADDCLCID     ZIBEG
     C                     Z-ADDCHISD     ZIEND
     C                     EXSR ZICD
     C*
     C                     Z-ADDZDAYN1    DAYS
     C*
     C                     EXSR CLMSG
     C                     MOVELNAR,5     XNARR
     C*
     C***********          Z-ADDCCAIC     TINTC0                          094337
     C                     Z-SUBCCAIC     TINTC0                          094337
     C*
     C**  OUTPUT TOTAL INTEREST
     C*
     C                     EXSR CALBRT
      *                                                                                       CGL031
     C           CGL031    IFEQ 'Y'                                                           CGL031
     C                     MOVE *ON       *IN21                                               CGL031
     C                     EXSR CALEUT                                                        CGL031
     C                     ENDIF                                                              CGL031
      *                                                                                       CGL031
     C/COPY WNCPYSRC,RE3761C003
     C*
     C                     EXSR OVERCR
     C                     WRITETOTALCR
     C           CSGACI    IFNE *ZERO                                     094337
     C                     EXSR CLMSG                                     094337
     C                     Z-SUBCSGACI    TINTC0                          094337
     C                     MOVELNAR,23    DNARR                           094337
     C                     EXSR OVERCR                                    094337
     C                     WRITETOTDCR                                    094337
     C                     END                                            094337
     C/COPY WNCPYSRC,RE3761C047
      *                                                                   130468
      * Report BRT if required                                            130468
     C           *IN22     IFEQ '1'                                       130468
     C                     EXSR OVERCR                                    130468
     C                     WRITETOTBRT                                    130468
     C                     END                                            130468
      *                                                                                       CGL031
      ** Report EUT if required                                                               CGL031
      *                                                                                       CGL031
     C           *IN21     IFEQ *ON                                                           CGL031
     C                     EXSR OVERCR                                                        CGL031
     C                     WRITEEUWTAX                                                        CGL031
      *                                                                                       CER048
      ** Print Secondary Tax Amount                                                           CER048
      *                                                                                       CER048
     C           CER048    IFEQ 'Y'                                                           CER048
      *                                                                                       CER048
     C                     EXSR OVERCR                                                        CER048
     C                     WRITESECTAX                                                        CER048
      *                                                                                       CER048
     C                     ENDIF                                                              CER048
      *                                                                                       CER048
      ** Print Third Tax Amount                                                             BUG26838
      *                                                                                     BUG26838
     C           CER054    IFEQ 'Y'                                                         BUG26838
      *                                                                                     BUG26838
     C                     EXSR OVERCR                                                      BUG26838
     C                     WRITETHRTAX                                                      BUG26838
      *                                                                                     BUG26838
     C                     ENDIF                                                            BUG26838
      *                                                                                     BUG26838
     C                     END                                                                CGL031
      *                                                                                       CGL031
     C/COPY WNCPYSRC,RE3761C048
     C*
     C* CHARGE REPORT IF NECESSARY
     C*
     C           CCICI     IFNE *BLANK
     C********** CHGT      ANDNE*ZERO                              094337 125176
     C***********CCHGP     ANDNE*ZERO                                     094337
     C           CCHGP     ANDNE*ZERO                                     125176
     C                     Z-ADDCCHGP     CHGP0
     C                     Z-ADD0         PSTD0                           125176
     C                     MOVELNAR,22    XNARR                           125176
     C                     EXSR OVERCH                                    125176
     C                     WRITESTOTCH                                    125176
     C*                                                                   094337
     C** PREPARE REBATE                                                   094337
     C*                                                                   094337
     C                     EXSR REBSR                                     094337
     C**********           EXSR OVERCH                             094337 125176
     C**********           WRITESTOTCH                             094337 125176
     C           REBATE    IFNE 0                                         125176
     C**********           MOVELNAR,35    XNARR                    094337 125176
     C                     MOVELNAR,36    XNARR                           125176
     C                     Z-ADDCMNBCP    PSTD0                           094337
     C                     Z-ADDREBATE    TCHR0                           094337
     C                     WRITESREBCH                                    094337
     C                     END                                            125176
     C**********           MOVELNAR,36    XNARR                    094337 125176
     C                     MOVELNAR,21    XNARR                           125176
     C                     WRITETOTALCH
     C                     END
     C*                                                                   085171
     C                     MOVE '0'       *IN59                           085171
     C*
     C**  PREPARE TOTAL CHARGES
     C*
     C           CCHGP     IFNE *ZERO                      - B1
     C                     EXSR CLMSG
     C                     MOVELNAR,22    DNARR
     C*
     C                     Z-ADDCCHGP     TINTC0
     C                     EXSR OVERCR
     C                     WRITETOTDCR
     C                     MOVE '1'       *IN59                           085171
     C                     END                             -E1
     C*
     C***********          MOVE '0'       *IN59                           085171
     C*
     C**  PREPARE WITHHOLDING TAX OUTPUT
     C*
     C           WWCINW    IFNE *ZEROS                     - B1
     C                     EXSR CLMSG
     C                     MOVEL*BLANKS   NCACP
     C           CACP      IFNE *BLANKS                    - B2
     C                     MOVEL' BY '    NCACP
     C                     MOVE CACP      NCACP
     C                     END                             - E2
     C                     MOVELNAR,26    DNARR
     C                     MOVE NCACP     DNARR
     C*
     C                     Z-ADD*ZEROS    TINTD0
     C                     Z-ADDWWCINW    TINTC0
     C                     EXSR OVERCR
     C                     WRITETOTDCR
     C                     MOVE '1'       *IN59
     C                     END                             - E1
     C*
     C**  PREPARE TOTAL
     C*
     C                     Z-ADD*ZERO     TINTC0
     C/COPY WNCPYSRC,RE3761C004
     C           CSCCI     IFEQ 'Y'
     C           CSCCI     OREQ 'I'
     C           CSCCI     OREQ 'A'
     C*
     C                     Z-SUBCCAIC     TINTC0
     C**********           SUB  CSGACI    TINTC0                   094337 121125
     C                     ADD  WWCINW    TINTC0                          125176
     C                     END                                            130468
      *                                                                   086087
      * Add BRT if applicable                                             086087
     C           *IN22     IFEQ '1'                                       086087
     C                     ADD  BRTOT0    TINTC0                          086087
     C                     END                                            086087
      *                                                                                       CGL031
      ** Add EUT if applicable                                                                CGL031
      *                                                                                       CGL031
     C           *IN21     IFEQ *ON                                                           CGL031
     C                     ADD  EUTAX0    TINTC0                                              CGL031
      *                                                                                       CER048
      ** Add Secondary Tax, if applicable                                                     CER048
      *                                                                                       CER048
     C           CER048    IFEQ 'Y'                                                           CER048
     C           TINTC0    ADD  STAX0     TINTC0                                              CER048
     C                     ENDIF                                                              CER048
      *                                                                                       CER048
      ** Add Third Tax, if applicable                                                       BUG26838
      *                                                                                     BUG26838
     C           CER054    IFEQ 'Y'                                                         BUG26838
     C           TINTC0    ADD  TTAX0     TINTC0                                            BUG26838
     C                     ENDIF                                                            BUG26838
      *                                                                                     BUG26838
     C                     END                                                                CGL031
      *                                                                                       CGL031
     C/COPY WNCPYSRC,RE3761C031
     C**********           END                                            130468
     C           CSCHGI    IFEQ 'Y'
     C           CSCHGI    OREQ 'I'
     C           CSCHGI    OREQ 'A'
     C           CSCHGI    OREQ 'L'                                       085171
     C           CSCHGI    OREQ 'O'                                       085171
     C*
     C                     ADD  CCHGP     TINTC0
     C                     END
     C***********          SUB  WWCINW    TINTC0                          086087
     C***********          ADD  WWCINW    TINTC0                   086087 125176
     C                     SUB  CSGACI    TINTC0                          121125
     C                     EXSR CLMSG
     C                     MOVELNAR,21    DNARR
     C*
     C                     EXSR OVERCR
     C                     WRITETOTDCR
     C*
     C**  PREPARE TOTAL CREDITED OUTPUT
     C*
     C***********          EXSR CLMSG                                     085171
     C***********          MOVELNAR,10    DNARR                           085171
     C*
     C***********          Z-ADD*ZEROS    TINTD0                          085171
     C*
     C**  OUTPUT TOTAL CREDITED
     C*
     C************IN59     IFEQ '1'                                 085171075075
     C***********          EXSR OVERCR                              085171094337
     C***********          WRITETOTDCR                              085171094337
     C***********          END                                      085171075075
     C*
     C***CAPITALISATION*TO*AN*ACCOUNT IN DIFFERENT CURRENCY AND           125176
     C***MULTIBRANCH*IS*PRESENT                                           125176
     C*
     C********** *IN87     IFEQ '1'                        - B1           125176
     C***********DEXRT     IFNE *ZEROS                     - B2           094337
     C***********          EXSR CLMSG                                     094337
     C***********          MOVELNAR,32    NARR                            094337
     C***********          Z-ADDDEXRT     RATE                            094337
     C***********          MOVELSDACP     MIDK                            094337
     C***********          EXSR OVERCR                                    094337
     C***********          WRITEALTNCR                                    094337
     C***********          END                             - E2           094337
      *                                                                   125176
      * Report alternative a/c for CR interest if used                    125176
     C           CACP      IFNE *BLANKS                    - B2           094337
      *                                                                   125176
      * If capitalisation to a/c in different ccy, report exchange rate   125176
     C           *IN87     IFEQ '1'                                       125176
     C********** CEXRT     IFNE *ZEROS                     - B2           125176
     C           CEXRT     ANDNE*ZEROS                                    125176
     C**********           EXSR CLMSG                                     125176
     C**********           MOVELNAR,31    NARR                            125176
     C                     Z-ADDCEXRT     RATE
     C                     MOVE '0'       *IN55                           125176
     C                     ELSE                                           125176
     C                     MOVE '1'       *IN55                           125176
     C                     END                                            094337
      *                                                                   125176
     C                     EXSR CLMSG                                     125176
     C                     MOVELNAR,31    NARR                            125176
     C***********          MOVELSCACP     MIDK                            094337
     C                     MOVELCACP      MIDK                            094337
     C**********           MOVE '1'       *IN55                    094337 125176
     C                     EXSR OVERCR
     C                     WRITEALTNCR
     C**********           MOVE '0'       *IN55                    094337 125176
     C                     END                             - E2
      *                                                                   125176
      * Report alternative a/c for charges if used                        125176
     C           CHAC      IFNE *BLANKS                    - B2           094337
      *                                                                   125176
      * If capitalisation to a/c in different ccy, report exchange rate   125176
     C           *IN87     IFEQ '1'                                       125176
     C********** CHXRT     IFNE *ZEROS                     - B2           125176
     C           CHXRT     ANDNE*ZEROS                                    125176
     C**********           EXSR CLMSG                                     125176
     C**********           MOVELNAR,33    NARR                            125176
     C                     Z-ADDCHXRT     RATE
     C                     MOVE '0'       *IN55                           125176
     C                     ELSE                                           125176
     C                     MOVE '1'       *IN55                           125176
     C                     END                             - E2           094337
      *                                                                   125176
     C                     EXSR CLMSG                                     125176
     C                     MOVELNAR,33    NARR                            125176
     C***********          MOVELSCHAC     MIDK                            094337
     C                     MOVELCHAC      MIDK                            094337
     C                     EXSR OVERCR
     C                     WRITEALTNCR
     C                     END                             - E2
     C**********           END                             - E1           125176
     C*
     C           *IN70     IFEQ '1'                        - B1
     C                     EXSR OVERCR
     C                     WRITETOTMCR
     C                     END
     C*
     C/COPY WNCPYSRC,RE3761C014
     C           CER050    IFEQ 'Y'                                                           CER050
      *                                                                                       CER050
      * Only print APR if not management statement                                            CER050
      *                                                                                       CER050
     C           *IN70     IFEQ '0'                        B001                               CER050
      *                                                                                       CER050
     C                     MOVEA'00'      *IN,61                                              CER050
      *                                                                                       CER050
     C           KACCNT    CHAINACCNTBY0             99                                       CER050
     C           *IN99     IFEQ '0'                                                           CER050
      *                                                                                       CER050
      * Run this process only if APR is set to 'Y'                                            CER050
      *                                                                                       CER050
     C           ATAPRC    IFEQ 'Y'                        B002                               CER050
     C                     EXSR SRAPRC                                                        CER050
     C                     ENDIF                                                              CER050
     C                     ENDIF                                                              CER050
     C                     ENDIF                                                              CER050
     C                     ENDIF                                                              CER050
      *                                                                                       CER050
     C                     ENDSR                           **CRSR ENDSR**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** DAYCSR subroutine to prepare and output days total
     C**
     C**     Called by       CRSR, DRSR
     C**
     C**     Calls           ZICD
     C**
     C           DAYCSR    BEGSR                           **DAYCSR BEGSR*
     C*
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C*
     C                     Z-ADDWHISB     HISB0
     C           HISB0     MULT DAYS      NUMB0
     C*
     C           DCAID     SUB  WCAID     INTC0
     C                     Z-SUBINTC0     INTC0
      *                                                                   CRE001
      ** If CRE001 is switched ON, then output 'Overdraft Limit'          CRE001
      *                                                                   CRE001
     C           CRE001    IFEQ 'Y'                                       CRE001
     C                     EXSR CLMSG                                     CRE001
     C                     MOVELNAR,38    ONARR                           CRE001
     C                     MOVE ODRL      OODRL                           CRE001
     C                     EXSR OVERDR                                    CRE001
     C                     WRITEODLNDC                                    CRE001
     C                     ENDIF                                          CRE001
     C*
     C**  OUTPUT SUBTOTAL
     C*
     C*******************  EXSR OVERCR                                    094431
     C*******************  WRITESTOTCR                                    094431
     C                     MOVE 'CR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C*
     C* CHARGE REPORT IF NECESSARY
     C*
     C**********           EXSR PRN1CH              chargesDetails1085713 125176
     C***********CCICI     IFNE *BLANK                     - B4           085713
     C***********DTHGAR    IFNE *ZERO                      - B5           085713
     C***********DTHGAN    ORNE *ZERO                                     085713
     C***********          Z-ADDDTHGAR    CHGR0                           085713
     C***********          Z-ADDDTHGAN    CHGN0                           085713
     C***********          Z-ADDNITMS     SNITMS                          085713
     C***********          WRITEPOSTCH                                    085713
     C***********          END                             - E5           085713
     C***********          END                             - E4           085713
     C*
     C                     ENDSR                           **DAYCSR ENDSR*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** DAYDSR subroutine to prepare and output days total
     C**
     C**     Called by       CRSR, DRSR
     C**
     C**     Calls           ZICD
     C**
     C           DAYDSR    BEGSR                           **DAYDSR BEGSR*
     C*
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C*
     C                     Z-ADDWHISB     HISB0
     C           HISB0     MULT DAYS      NUMB0
     C*
     C           DDAID     SUB  WDAID     INTD0
      *                                                                   CRE001
      ** If CRE001 is switched ON, then output 'Overdraft Limit'          CRE001
      *                                                                   CRE001
     C           CRE001    IFEQ 'Y'                                       CRE001
     C                     EXSR CLMSG                                     CRE001
     C                     MOVELNAR,38    ONARR                           CRE001
     C                     MOVE ODRL      OODRL                           CRE001
     C                     EXSR OVERDR                                    CRE001
     C                     WRITEODLNDC                                    CRE001
     C                     ENDIF                                          CRE001
     C*
     C**  OUTPUT SUBTOTAL
     C*
     C*******************  EXSR OVERDR                                    094431
     C*******************  WRITESTOTDR                                    094431
     C                     MOVE 'DR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C*
     C* CHARGE REPORT IF NECESSARY
     C*
     C**********           EXSR PRN1CH              chargesDetails1085713 125176
     C***********CCICI     IFNE *BLANK                                    085713
     C***********DTHGAR    IFNE *ZERO                                     085713
     C***********DTHGAN    ORNE *ZERO                                     085713
     C***********          Z-ADDDTHGAR    CHGR0                           085713
     C***********          Z-ADDDTHGAN    CHGN0                           085713
     C***********          Z-ADDNITMS     SNITMS                          085713
     C***********          WRITEPOSTCH                                    085713
     C***********          END                                            085713
     C***********          END                                            085713
     C*
     C                     ENDSR                           **DAYDSR ENDSR*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** DBSR subroutine for database error handling
     C**
     C**     Called by       DETPR, DRSR, RATED, RATEC, CRSR, RDRSR,
     C**                     RCRSR, BOTHSR, B1LT, B1GT, B1EQ,
     C**                     OPENDR, OPENCR, ZICD, FIRST
     C**
     C**     Calls           -
     C**
     C           DBSR      BEGSR                           **DBSR BEGSR**
     C*
     C                     MOVE '1'       *INU7
     C                     MOVE '1'       *INU8
     C                     DUMP                                           195835
     C                     MOVE '1'       *INLR                           LN0112
     C                     WRITEERRAU
     C*
     C                     MOVE *BLANKS   DBFILE
     C                     MOVE *BLANKS   DBKEY
     C                     Z-ADD*ZEROS    DBASE
     C*
     C           *IN72     IFEQ '1'                        - B1
     C                     WRITEHEADAU
     C                     MOVE '0'       *IN72
     C                     END
     C*
     C                     ENDSR                           **DBSR ENDSR**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** DRSR subroutine for debit output processing
     C**
     C**     Called by       D E T P R
     C**
     C**     Calls           DBSR, DAYTSR, ITYPDR, RATED, ZICD, OVERDC
     C**
     C           DRSR      BEGSR                           **DRSR BEGSR**
     C*
     C**  OUTPUT HEADER LINES
     C*
     C                     MOVE '0'       *IN65
     C           ACNO      IFNE *ZEROS
     C                     MOVE '1'       *IN65
     C                     END
     C/COPY WNCPYSRC,RE3761C018
     C                     WRITEHEADDR
     C*
     C**  ACCESS REHISL WITH LAST DEBIT CAPITALISATION DATE
     C*
     C***********KLIST2    CHAINREHISL               52                   64051
     C***********KLIST2    SETLLREHISL               51             64051 182452
     C*                                                                   64051
     C***********KLIST1    READEREHISL                   51         64051 182452
     C           KLIST2    SETLLREHISL               52                   182452
     C           KLIST1    READEREHISL                   52               182452
     C*
     C           *IN52     IFEQ '1'                        - B1
     C                     Z-ADDCLDID     WDATE
     C                     Z-ADD8         DBASE
     C                     MOVE 'REHISL'  DBFILE           ***************
     C                     MOVELRKEY2     DBKEY            **DB ERROR 08**
     C                     MOVEA'1'       *IN,89           ***************
     C                     EXSR DBSR
     C                     END                             - E1
     C**********           Z-ADD*ZERO     BDATE   50               094337 125176
     C*
     C           *IN52     DOWEQ'0'                        - B1
     C           DRECI     ANDEQ'S'
     C***********SCICI     ANDEQ'Y'                                       094337
     C           SDICI     ANDEQ*BLANKS
     C           DHISD     ANDLTCHISD
     C           *IN52     OREQ '0'
     C           DRECI     ANDEQ'D'
     C           DDRCI     ANDEQ*BLANKS
     C***********DCRCI     ANDEQ*BLANKS                                   094337
     C           DMADI     ANDEQ*ZEROS
     C***********DMACI     ANDNE*ZEROS                                    094337
     C           DDMVT     ANDEQ*ZEROS
     C           DCMVT     ANDEQ*ZEROS
     C           *IN52     OREQ '0'                                       182452
     C           DRECI     ANDEQ'M'                                       182452
     C********** *IN52     OREQ '0'                                       094337
     C***********DRECI     ANDEQ'D'                                       094337
     C***********DDRCI     ANDEQ*BLANKS                                   094337
     C***********DCRCI     ANDEQ'Y'                                       094337
     C***********DMADI     ANDEQ*ZEROS                                    094337
     C***********DMACI     ANDEQ*ZEROS                                    094337
     C***********DDMVT     ANDEQ*ZEROS                                    094337
     C***********DCMVT     ANDEQ*ZEROS                                    094337
     C********** *IN52     OREQ '0'                                       094337
     C***********DRECI     ANDEQ'D'                                       094337
     C***********DDRCI     ANDEQ*BLANKS                                   094337
     C***********DCRCI     ANDEQ'Y'                                       094337
     C***********DMADI     ANDEQ*ZEROS                                    094337
     C***********DMACI     ANDNE*ZEROS                                    094337
     C***********DDMVT     ANDEQ*ZEROS                                    094337
     C***********DCMVT     ANDEQ*ZEROS                                    094337
     C*
     C           KLIST1    READEREHISL                   52
     C*
     C                     END                             - E1
     C*
     C**  PREPARE B/F BALANCE
     C*
     C           DRECI     IFEQ 'B'                        - B1
     C                     Z-ADD*ZEROS    HISB0
     C                     Z-ADDDHISD     BDATE   50                      094337
     C                     ELSE                            - X1
     C           DRECI     IFEQ 'S'                        - B2
     C                     Z-ADDSSTBL     HISB0
     C                     ELSE                            - X2
     C                     Z-ADDCLDID     WDATE
     C                     Z-ADD9         DBASE
     C                     MOVE 'REHISL'  DBFILE           ***************
     C                     MOVELRKEY2     DBKEY            **DB ERROR 09**
     C                     MOVEA'1'       *IN,89           ***************
     C                     EXSR DBSR
     C                     END                             - E2
     C                     END                             - E1
     C*
     C                     Z-ADDDHISB     DOHISB
     C                     Z-ADDDHISB     WHISB                           058684
     C                     MOVE *BLANKS   VALDA
     C*
     C                     EXSR CLMSG
     C                     MOVELNAR,1     TNARR
     C*
     C**  OUTPUT B/F BALANCE
     C*
     C                     EXSR OVERDR
     C                     WRITETITLEDR
     C*
     C           KLIST2    SETLLREHPOPH
     C*
     C           KLIST1    READEREHPOPH                  50
     C*
     C**  BACK VALUE PROCESSING START
     C*
     C           *IN50     DOWEQ'0'                        - B1
     C***********PSTD      ANDGECLDID                                     094337
     C           PSTD      ANDLECHISD                                     094337
     C*
     C**  TRANSFER DATE MIDAS INTO DDMMMYY
     C*
      * If last day accruals a backvalued item posted on cap. value       125176
      * date is already reflected in that capitalisation.                 125176
      * If first day accruals a backvalued item posted on cap. value      125176
      * date is not reflected in that capitalisation as the cap. value    125176
      * date is cap. date + 1.                                            125176
     C           HISD      IFLT CLDID
     C           PSTD      ANDGTCLDID
     C********** LDAC      ANDEQ'N'                                094337 125176
     C           LDAC      ANDEQ'Y'                                       125176
     C           HISD      ORLT CLDID                                     094337
     C           PSTD      ANDGECLDID                                     094337
     C********** LDAC      ANDEQ'Y'                                094337 125176
     C           LDAC      ANDEQ'N'                                       125176
     C*
     C           PPSTD     IFNE PSTD                       - B2
     C                     Z-ADDPSTD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    PSTDO
     C*
     C                     Z-ADDPSTD      PPSTD
     C                     END                             - E2
     C*
     C                     MOVE PSTDO     PSTDA
     C*
     C**  TRANSFER DATE MIDAS INTO DDMMMYY
     C*
     C           PVALD     IFNE HISD                       - B2
     C                     Z-ADDHISD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALDO
     C*
     C                     Z-ADDHISD      PVALD
     C                     END                             - E2
     C*
     C                     MOVELPNAR      NARR
     C                     MOVE VALDO     VALDA
      *                                                                   125176
     C           RECI      IFEQ 'P'                                       125176
     C*
     C**  CHECK IF DEBIT OR CREDIT
     C*
     C           DRCR      IFEQ 0                          - B2
     C           TURN      IFNE 'Y'
     C                     MOVE '1'       *IN33
     C                     END
     C                     Z-ADDPSTA      PSTD0
     C                     ELSE                            - X2
     C                     Z-SUBPSTA      PSTD0
     C                     END                             - E2
     C********** RECI      IFEQ 'P'                                094337 125176
     C*
     C**  OUTPUT BACK VALUE
     C*
     C                     EXSR OVERDR
     C                     WRITEPOSTDR
     C/COPY WNCPYSRC,RE3761C042
     C                     ELSE                                           094337
     C           DRCR      IFEQ 0                                         094337
     C                     Z-ADDHISD      DDRCD                           094337
     C                     EXSR RATED                                     094337
     C                     END                                            094337
     C                     END                                            094337
     C*
     C                     MOVE '0'       *IN33
     C*
     C                     END
     C*
     C           KLIST1    READEREHPOPH                  50
     C*
     C                     END                             - E1
     C*
      * Generated adjustments going to the a/c should be reported for     125176
      * both management and non-management DR only cap. as they affect    125176
      * the balance and CR adjs. would not be posted at a DR only cap.    125176
     C********** *IN70     IFEQ '1'                        - B1           125176
     C           KLIST1    SETLLREHISSL                  20
     C*
      * Report generated adjustments before start date                    125176
     C           *IN20     IFEQ '1'                        - B2
     C           KLIST1    READEREADJF                   20
     C           *IN20     DOWEQ'0'                        - B3
     C           AHISD     ANDLTCLDID
     C           AHISD     ANDLTCHISD
     C*
     C** PRINT INTEREST OF THE BACK VALUE DATE
     C*
     C           SDCI      IFEQ 'Y'                        - B4
     C***********SCCI      OREQ 'Y'                                       094337
     C           SCCI      OREQ 'Y'                                       125176
     C*
     C           PPSTD     IFNE RUND                       - B5
     C                     Z-ADDRUND      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    PSTDO
     C*
     C                     Z-ADDRUND      PPSTD
     C*
     C                     END                             - E5
     C*
     C                     MOVE PSTDO     PSTDA
     C*
     C           PVALD     IFNE AHISD                      - B5
     C                     Z-ADDAHISD     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALDO
     C*
     C                     Z-ADDAHISD     PVALD
     C*
     C                     END                             - E5
     C*
     C                     MOVE VALDO     VALDA
     C*
     C                     MOVELNAR,23    NARR
     C*
     C           SDCI      IFEQ 'Y'                        - B5
     C********** SGADI     ANDNE*ZEROS                                   064051
     C           ADAIC     ANDNE*ZEROS                                   064051
     C******************** Z-ADDSGADI     PSTD0                           064051
     C                     Z-ADDADAIC     PSTD0                           064051
     C                     EXSR OVERDR
     C                     WRITEPOSTDR
     C                     END                             - E5
     C           SCCI      IFEQ 'Y'                        - B5
     C********** SGACI     ANDNE*ZEROS                                   064051
     C           ACAIC     ANDNE*ZEROS                                   064051
     C**********           MOVELNAR,28    NARR                      64051 125176
     C******************** Z-ADDSGACI     PSTD0                           064051
     C                     Z-SUBACAIC     PSTD0                           064051
     C                     EXSR OVERDR
     C                     WRITEPOSTDR
     C                     END                             - E5
     C*
     C                     END                             - E4
     C*
     C           KLIST1    READEREADJF                   20
     C                     END                             - E3
     C*
     C                     ELSE
     C                     MOVE '1'       *IN20
     C                     END                             - E2
     C*
     C**********           END                             - E1           125176
     C*
     C**  BACK VALUE PROCESSING END
     C*
     C           KLIST2    SETLLREHPOPL
     C           KLIST1    READEREHPOPL                  50
     C*
     C**  PREPARE OPENING BALANCE OUTPUT
     C*
     C           DRECI     IFEQ 'B'                        - B1
     C                     Z-ADDDHISB     WHISB
     C                     ELSE                            - X1
     C           DRECI     IFEQ 'S'                        - B2
     C                     Z-ADDSSTBL     WHISB
     C                     END                             - E2
     C                     END                             - E1
     C                     Z-ADDDOHISB    HISB0
     C                     Z-ADDDOHISB    WHISBD                          094337
     C*
     C                     EXSR CLMSG
     C                     MOVELNAR,2     TNARR
     C*
     C**  SAVE IN CASE OF NO POSTING
     C*
     C                     Z-ADDCLDID     WHISD
     C*
     C**  TRANSFER DATE MIDAS INTO DDMMMYY
     C*
     C           CLDID     IFNE PVALD                      - B1
     C*
     C                     Z-ADDCLDID     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALDO
     C*
     C                     Z-ADDCLDID     PVALD
     C*
     C                     END                             - E1
     C*
     C                     MOVE VALDO     VALDA
      *                                                                   182452
      ** Save opening date.                                               182452
      *                                                                   182452
     C                     Z-ADDCLDID     WSMNT   50                      182452
     C*
     C**  OUTPUT OPENING BALANCE
     C*
     C                     EXSR OVERDR                                    125176
     C                     WRITETITLEDR                                   125176
      *                                                                   094337
      **  ACCESS REHRDJ (REHPOSR1 REHPOSR2 REHPOSR3) WHICH CONTAINS       094337
      **  THE GOOD DATES FOR DEBIT RATE CHANGE TO                         094337
      *                                                                   094337
     C           KLIST2    SETLLREHRDJ                                    094337
     C           KLIST1    REDPEREHRDJ                   60               094337
      *                                                                   094337
     C           *IN60     IFEQ '1'                        - B1           094337
     C           BDATE     ANDEQCLDID                      - B1           094337
     C           KLIST2    SETLLREHRDJ                                    094337
     C           KLIST2    READEREHRDJ                   60               094337
     C                     END                                            094337
      *                                                                   094337
     C           *IN60     IFEQ '1'                        - B1           094337
     C                     Z-ADD*ZEROS    DRIR                            094337
     C                     Z-ADD*ZEROS    INTP                            125176
     C                     Z-ADD*ZEROS    INST                            125176
     C                     Z-ADD*ZEROS    INRT                            125176
     C                     END                             - E1           094337
      *                                                                   094337
     C                     EXSR CLMSG                                     094337
     C                     MOVELNAR,3     RNARR                           094337
      *                                                                   094337
     C                     MOVE *BLANKS   PSTDA                           094337
     C                     MOVE *BLANKS   VALDA                           094337
      *                                                                   094337
      **  OUTPUT CREDIT RATE CHANGE TO                                    094337
      *                                                                   094337
      *   CHANGE NARRAT. 'RATE CHANGE TO' TO 'OPENING RATE'               094337
     C                     MOVE 'Y'       OPN     1                       094337
     C                     EXSR RDRSR                                     094337
     C                     MOVE ' '       OPN     1                       094337
     C***********          EXSR OVERDR                                    094337
     C***********          WRITETITLEDR                                   094337
     C*
     C**  PREPARE OPENING RATE OUTPUT
     C*
     C***********          MOVE *BLANKS   VALDA                           094337
     C***********          MOVE *BLANKS   PSTDA                           094337
     C*
     C***********          EXSR CLMSG                                     094337
     C***********          MOVELNAR,3     RNARR                           094337
     C*
     C**  OUTPUT OPENING RATE
     C*
     C***********          Z-ADDDRIRR     RATE                            094337
     C***********          EXSR OVERDR                                    094337
     C***********          WRITERATEDR                                    094337
     C*
      * Report generated adjustments on start date                        125176
     C********** *IN70     IFEQ '1'                        - B1           125176
     C********** *IN20     DOWEQ'0'                        - B3           125176
     C           *IN20     IFEQ '0'                        - B3           125176
     C           AHISD     ANDEQCLDID                                     125176
     C           AHISD     ANDLTCHISD
     C*
     C** PRINT INTEREST OF THE BACK VALUE DATE
     C*
     C           SDCI      IFEQ 'Y'                        - B4
     C           SCCI      OREQ 'Y'
     C*
     C           PPSTD     IFNE RUND                       - B5
     C                     Z-ADDRUND      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    PSTDO
     C*
     C                     Z-ADDRUND      PPSTD
     C*
     C                     END                             - E5
     C*
     C                     MOVE PSTDO     PSTDA
     C*
     C           PVALD     IFNE AHISD                      - B5
     C                     Z-ADDAHISD     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALDO
     C*
     C                     Z-ADDAHISD     PVALD
     C*
     C                     END                             - E5
     C*
     C                     MOVE VALDO     VALDA
     C*
     C                     MOVELNAR,23    NARR
     C*
     C           SDCI      IFEQ 'Y'                        - B5
     C********** SGADI     ANDNE*ZEROS                              B8899064051
     C           ADAIC     ANDNE*ZEROS                                   064051
     C                     MOVE 'Y'       @ADJF                           125176
     C******************** Z-ADDSGADI     PSTD0                     B8899 064051
     C                     Z-ADDADAIC     PSTD0                           064051
     C                     EXSR OVERDR
     C                     WRITEPOSTDR
     C                     END                             - E5
     C           SCCI      IFEQ 'Y'                        - B5
     C********** SGACI     ANDNE*ZEROS                                   064051
     C           ACAIC     ANDNE*ZEROS                                   064051
     C                     MOVE 'Y'       @ADJF                           125176
     C**********           MOVELNAR,28    NARR                      64051 125176
     C******************** Z-ADDSGACI     PSTD0                           064051
     C                     Z-SUBACAIC     PSTD0                           064051
     C                     EXSR OVERDR
     C                     WRITEPOSTDR
     C                     END                             - E5
     C*
     C                     END                             - E4
     C*
     C********** KLIST1    READEREADJF                   20               125176
     C*
     C                     END                             - E2
     C*
     C**********           END                             - E1           125176
     C*
     C           DRECI     IFEQ 'S'                        - B1
     C                     Z-ADDDHISD     WHISD
     C                     Z-ADDDHISB     WHISB
     C                     Z-ADDSMNBL     WMNBL
     C                     Z-ADDDDRCB     WDRCB
     C                     Z-ADDDCRCB     WCRCB
     C           KLIST1    READEREHISL                   51
     C*
     C           *IN51     DOWEQ'0'                        - B2
     C           DRECI     ANDEQ'S'
     C           DHISD     ANDLTCHISD                                     125176
     C           *IN51     OREQ '0'                                       125176
     C           DRECI     ANDEQ'D'                                       125176
     C           DDRCI     ANDEQ*BLANKS                                   125176
     C           DDMVT     ANDEQ*ZEROS                                    125176
     C           DCMVT     ANDEQ*ZEROS                                    125176
     C           DMADI     ANDEQ*ZEROS                                    125176
     C           @ADJF     ANDEQ*BLANKS                                   125176
      *                                                                   125176
      * Check for generated adjustment after start date (must be CR).     125176
     C           *IN51     IFEQ '0'                                       125176
     C           DRECI     ANDEQ'S'                                       125176
     C           DHISD     ANDLTCHISD                                     125176
     C           SCAIC     ANDNE*ZEROS                                    125176
     C           SSCCI     ANDEQ'Y'                                       125176
     C                     Z-SUBSCAIC     @GADJ                           125176
     C                     MOVE 'Y'       @ADJF                           125176
     C                     END                                            125176
      *                                                                   125176
     C           KLIST1    READEREHISL                   51
     C                     END                             - E2
     C*
     C********** *IN51     IFEQ '0'                        - B2           094663
     C***********WHISD     ANDNEDHISD                                     094663
     C*
     C***********CDICT     IFLT 3                          - B3           094663
     C***********          Z-ADDWDRCB     ZICALC                          094663
     C***********          Z-ADDWHISD     ZIBEG                           094663
     C***********          Z-ADDDHISD     ZIEND                           094663
     C***********          EXSR DAYDSR                                    094663
     C***********          ELSE                            - X3           094663
     C***********          EXSR ITYPDR                                    094663
     C***********          END                             - E3           094663
     C*
     C***********          END                             - E2           094663
     C           *IN51     IFEQ '0'                        - B2           125176
     C           WHISD     ANDNEDHISD                                     125176
     C           DHISD     ANDLTCHISD                                     125176
     C********** CDICT     IFLT 3                          - B3    125176 182452
     C           DDICT     IFLT 3                          - B3           182452
     C                     Z-ADDWDRCB     ZICALC                          125176
     C                     Z-ADDWHISD     ZIBEG                           125176
     C                     Z-ADDDHISD     ZIEND                           125176
     C                     EXSR DAYDSR                                    125176
     C                     ELSE                            - X3           125176
     C                     EXSR ITYPDR                                    125176
     C                     END                             - E3           125176
     C                     END                             - E2           125176
     C*
     C                     END                             - E1
     C*
     C           *IN51     DOWEQ'0'                        - B1
     C           DHISD     ANDLTCHISD
      *                                                                   125176
      * Report generated adjustment after start date if found             125176
     C           @ADJF     IFEQ 'Y'                                       125176
     C                     EXSR #ADJ                                      125176
     C           DHISD     IFGT CLDID                                     125176
     C                     EXSR OVERDR                                    125176
     C                     WRITEPOSTDR                                    125176
     C                     END                                            125176
     C                     END                                            125176
     C*
     C**  PROCESS POSTING AT THE SAME DATE
     C*
     C           *IN50     DOWEQ'0'                        - B2
     C           DHISD     ANDEQHISD
     C*
     C**  TRANSFER DATE MIDAS INTO DDMMMYY
     C*
     C           PPSTD     IFNE PSTD                       - B3
     C                     Z-ADDPSTD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    PSTDO
     C*
     C                     Z-ADDPSTD      PPSTD
     C*
     C                     END                             - E3
     C*
     C**  TRANSFER DATE MIDAS INTO DDMMMYY
     C*
     C           PVALD     IFNE HISD                       - B3
     C                     Z-ADDHISD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALDO
     C*
     C                     Z-ADDHISD      PVALD
     C*
     C                     END                             - E3
     C*
     C                     MOVE VALDO     VALDA
     C                     MOVE PSTDO     PSTDA
     C                     MOVELPNAR      NARR
     C*
     C**  CHECK IF DEBIT OR CREDIT
     C*
     C           DRCR      IFEQ 0                          - B3
     C                     Z-ADDPSTA      PSTD0
     C           TURN      IFNE 'Y'
     C                     MOVE '1'       *IN33
     C                     END
     C                     ELSE                            - X3
     C                     Z-SUBPSTA      PSTD0
     C                     END                             - E3
     C*
     C**  OUPUT POSTING
     C*
     C                     EXSR OVERDR
     C                     WRITEPOSTDR
     C/COPY WNCPYSRC,RE3761C043
     C*
     C                     MOVE '0'       *IN33
     C*
     C           KLIST1    READEREHPOPL                  50
     C*
     C                     END                             - E2
     C*
     C** PRINT THE MANUAL ADJUSTEMENT
     C*
     C           DMADI     IFNE *ZEROS
     C*
     C           KLIST9    SETLLREHPOML2                 56
     C           KLIST9    READEREHPOML2                 56
     C           *IN56     DOWEQ'0'
     C*
     C           PPSTD     IFNE MAHISD                     - B1
     C                     Z-ADDMAHISD    ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    PSTDO
     C*
     C                     END                             - E1
     C*
     C                     MOVE PSTDO     PSTDA
     C*
     C           PVALD     IFNE VALD                       - B1
     C                     Z-ADDVALD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALDO
     C*
     C                     Z-ADDVALD      PVALD
     C*
     C                     END                             - E1
     C*
     C                     MOVE VALDO     VALDA
     C*
     C                     MOVELNAR,29    NARR
     C*
     C           DRIA      IFNE *ZEROS
     C                     Z-ADDDRIA      INTD0
     C******************   EXSR OVERDR                                    094431
     C******************   WRITEMADJDR                                    094431
     C                     MOVE 'DR'      DCFLAG                          094431
     C                     EXSR WMA                        WRITE MAN ADJ  094431
     C                     Z-ADD*ZEROS    INTD0
     C                     END
     C*
     C           KLIST9    READEREHPOML2                 56
     C*
     C                     END
     C*
     C                     END
     C*
     C*
     C**  DEBIT RATE CHANGE TO
     C*
     C           DDRCI     IFEQ 'Y'                        - B2
     C           DRECI     ANDNE'B'
     C           DRECI     ANDNE'M'                                       182452
     C*
     C                     EXSR RATED
     C*
     C                     END                             - E2
     C*
     C**  SAVE REHISL  AS PREVIOUS
     C*
     C                     Z-ADDDHISD     WHISD
     C                     Z-ADDDHISB     WHISB
     C                     MOVE DDRCB     WDRCB
     C                     Z-ADDDCRCB     WCRCB
     C                     Z-ADDDCAID     WCAID
     C                     Z-ADDDDAID     WDAID
     C*
     C           KLIST1    READEREHISL                   51
     C*
     C           *IN51     DOWEQ'0'                        - B2
     C           DRECI     ANDEQ'S'
     C***********SCICI     ANDEQ'Y'                                       094337
     C********** SDICI     ANDEQ*BLANKS                                   125176
     C           DHISD     ANDLTCHISD
     C           *IN51     OREQ '0'
     C           DRECI     ANDEQ'D'
     C           DDRCI     ANDEQ*BLANKS
     C***********DCRCI     ANDEQ*BLANKS                                   094337
     C           DMADI     ANDEQ*ZEROS
     C***********DMACI     ANDNE*ZEROS                                    094337
     C           DDMVT     ANDEQ*ZEROS
     C           DCMVT     ANDEQ*ZEROS
     C           @ADJF     ANDEQ*BLANKS                                   125176
     C********** *IN52     OREQ '0'                                       094337
     C***********DRECI     ANDEQ'D'                                       094337
     C***********DDRCI     ANDEQ*BLANKS                                   094337
     C***********DCRCI     ANDEQ'Y'                                       094337
     C***********DMADI     ANDEQ*ZEROS                                    094337
     C***********DMACI     ANDEQ*ZEROS                                    094337
     C***********DDMVT     ANDEQ*ZEROS                                    094337
     C***********DCMVT     ANDEQ*ZEROS                                    094337
     C********** *IN52     OREQ '0'                                       094337
     C***********DRECI     ANDEQ'D'                                       094337
     C***********DDRCI     ANDEQ*BLANKS                                   094337
     C***********DCRCI     ANDEQ'Y'                                       094337
     C***********DMADI     ANDEQ*ZEROS                                    094337
     C***********DMACI     ANDNE*ZEROS                                    094337
     C***********DDMVT     ANDEQ*ZEROS                                    094337
     C***********DCMVT     ANDEQ*ZEROS                                    094337
      *                                                                   125176
      * Check for CR generated adjustment                                 125176
     C           *IN51     IFEQ '0'                                       125176
     C           DRECI     ANDEQ'S'                                       125176
     C           DHISD     ANDLTCHISD                                     125176
     C           SCAIC     ANDNE*ZEROS                                    125176
     C           SSCCI     ANDEQ'Y'                                       125176
     C                     Z-SUBSCAIC     @GADJ                           125176
     C                     MOVE 'Y'       @ADJF                           125176
     C                     END                                            125176
     C*
     C           KLIST1    READEREHISL                   51
     C*
     C                     END                             - E2
     C*
     C**  OUTPUT SUBTOTAL LINE
     C*
     C           *IN51     IFEQ '0'                        - B2
     C           DHISD     ANDLTCHISD
     C*
     C********** CDICT     IFLT 3                          - B3           182452
     C           DDICT     IFLT 3                          - B3           182452
     C                     Z-ADDWDRCB     ZICALC
     C                     Z-ADDWHISD     ZIBEG
     C                     Z-ADDDHISD     ZIEND
     C                     EXSR DAYDSR
     C                     ELSE                            - X3
     C                     EXSR ITYPDR
     C                     END                             - E3
     C*
     C********** *IN51     DOWEQ'0'                        - B3           125176
     C********** DHISD     ANDLTHISD                                      125176
     C********** CHISD     ANDLTHISD                                      125176
     C*
     C***PRINT*THE*MANUAL*ADJUSTEMENT                                     125176
     C*
     C********** DMADI     IFNE *ZEROS                                    125176
     C*
     C********** KLIST9    SETLLREHPOML2                 56               125176
     C********** KLIST9    READEREHPOML2                 56               125176
     C********** *IN56     DOWEQ'0'                                       125176
     C*
     C********** PPSTD     IFNE HISD                       - B1           125176
     C**********           Z-ADDHISD      ZDAYNO                          125176
     C**********           EXSR ZDATE2                                    125176
     C**********           MOVE ZADATE    PSTDO                           125176
     C*
     C**********           END                             - E1           125176
     C*
     C**********           MOVE PSTDO     PSTDA                           125176
     C*
     C********** PVALD     IFNE VALD                       - B1           125176
     C**********           Z-ADDVALD      ZDAYNO                          125176
     C**********           EXSR ZDATE2                                    125176
     C**********           MOVE ZADATE    VALDO                           125176
     C*
     C**********           Z-ADDVALD      PVALD                           125176
     C*
     C**********           END                             - E1           125176
     C*
     C**********           MOVE VALDO     VALDA                           125176
     C*
     C**********           MOVELNAR,29    NARR                            125176
     C*
     C********** DRIA      IFNE *ZEROS                                    125176
     C**********           Z-ADDDRIA      INTD0                           125176
     C******************   EXSR OVERDR                                    094431
     C******************   WRITEMADJDR                                    094431
     C**********           MOVE 'DR'      DCFLAG                   094431 125176
     C**********           EXSR WMA                 WRITE MAN ADJ  094431 125176
     C**********           Z-ADD*ZEROS    INTD0                           125176
     C**********           END                                            125176
     C*
     C********** KLIST9    READEREHPOML2                 56               125176
     C*
     C**********           END                                            125176
     C*
     C**********           END                                            125176
     C*
     C*
     C****CHECK*IF*READ*RECORD*IS*A*CHANGE*RATE                           125176
     C*
     C********** DDRCI     IFEQ 'Y'                        - B4           125176
     C********** DRECI     ANDNE'B'                                       125176
     C*
     C**********           EXSR RATED                                     125176
     C*
     C****SAVE*REHISL**AS*PREVIOUS                                        125176
     C*
     C**********           Z-ADDDHISD     WHISD                           125176
     C**********           Z-ADDDHISB     WHISB                           125176
     C**********           MOVE DDRCB     WDRCB                           125176
     C**********           Z-ADDDCRCB     WCRCB                           125176
     C**********           Z-ADDDCAID     WCAID                           125176
     C**********           Z-ADDDDAID     WDAID                           125176
     C*
     C********** KLIST1    READEREHISL                   51               125176
     C*
     C********** *IN51     DOWEQ'0'                        - B5           125176
     C********** DRECI     ANDEQ'S'                                       125176
     C***********SCICI     ANDEQ'Y'                                       094337
     C********** SDICI     ANDEQ*BLANKS                                   125176
     C********** DHISD     ANDLTCHISD                                     125176
     C********** *IN51     OREQ '0'                                       125176
     C********** DRECI     ANDEQ'D'                                       125176
     C********** DDRCI     ANDEQ*BLANKS                                   125176
     C***********DCRCI     ANDEQ*BLANKS                                   094337
     C********** DMADI     ANDEQ*ZEROS                                    125176
     C***********DMACI     ANDNE*ZEROS                                    094337
     C********** DDMVT     ANDEQ*ZEROS                                    125176
     C********** DCMVT     ANDEQ*ZEROS                                    125176
     C********** *IN52     OREQ '0'                                       094337
     C***********DRECI     ANDEQ'D'                                       094337
     C***********DDRCI     ANDEQ*BLANKS                                   094337
     C***********DCRCI     ANDEQ'Y'                                       094337
     C***********DMADI     ANDEQ*ZEROS                                    094337
     C***********DMACI     ANDEQ*ZEROS                                    094337
     C***********DDMVT     ANDEQ*ZEROS                                    094337
     C***********DCMVT     ANDEQ*ZEROS                                    094337
     C********** *IN52     OREQ '0'                                       094337
     C***********DRECI     ANDEQ'D'                                       094337
     C***********DDRCI     ANDEQ*BLANKS                                   094337
     C***********DCRCI     ANDEQ'Y'                                       094337
     C***********DMADI     ANDEQ*ZEROS                                    094337
     C***********DMACI     ANDNE*ZEROS                                    094337
     C***********DDMVT     ANDEQ*ZEROS                                    094337
     C***********DCMVT     ANDEQ*ZEROS                                    094337
     C*
     C********** KLIST1    READEREHISL                   51               125176
     C*
     C**********           END                             - E5           125176
     C*
     C********** CDICT     IFLT 3                          - B5           125176
     C**********           Z-ADDWDRCB     ZICALC                          125176
     C**********           Z-ADDWHISD     ZIBEG                           125176
     C**********           Z-ADDDHISD     ZIEND                           125176
     C**********           EXSR DAYDSR                                    125176
     C**********           ELSE                            - X5           125176
     C**********           EXSR ITYPDR                                    125176
     C**********           END                             - E5           125176
     C*
     C**********           ELSE                            - X4           125176
     C*
     C********** KLIST1    READEREHISL                   51               125176
     C*
     C********** *IN51     DOWEQ'0'                        - B5           125176
     C***********DRECI     ANDEQ'S'                                       125176
     C***********SCICI     ANDEQ'Y'                                       094337
     C***********SDICI     ANDEQ*BLANKS                                   125176
     C***********DHISD     ANDLTCHISD                                     125176
     C********** *IN51     OREQ '0'                                       125176
     C***********DRECI     ANDEQ'D'                                       125176
     C***********DDRCI     ANDEQ*BLANKS                                   125176
     C***********DCRCI     ANDEQ*BLANKS                                   094337
     C***********DMADI     ANDEQ*ZEROS                                    125176
     C***********DMACI     ANDNE*ZEROS                                    094337
     C***********DDMVT     ANDEQ*ZEROS                                    125176
     C***********DCMVT     ANDEQ*ZEROS                                    125176
     C********** *IN52     OREQ '0'                                       094337
     C***********DRECI     ANDEQ'D'                                       094337
     C***********DDRCI     ANDEQ*BLANKS                                   094337
     C***********DCRCI     ANDEQ'Y'                                       094337
     C***********DMADI     ANDEQ*ZEROS                                    094337
     C***********DMACI     ANDEQ*ZEROS                                    094337
     C***********DDMVT     ANDEQ*ZEROS                                    094337
     C***********DCMVT     ANDEQ*ZEROS                                    094337
     C********** *IN52     OREQ '0'                                       094337
     C***********DRECI     ANDEQ'D'                                       094337
     C***********DDRCI     ANDEQ*BLANKS                                   094337
     C***********DCRCI     ANDEQ'Y'                                       094337
     C***********DMADI     ANDEQ*ZEROS                                    094337
     C***********DMACI     ANDNE*ZEROS                                    094337
     C***********DDMVT     ANDEQ*ZEROS                                    094337
     C***********DCMVT     ANDEQ*ZEROS                                    094337
     C*
     C***********KLIST1    READEREHISL                   51               125176
     C*
     C***********          END                             - E5           125176
     C*
     C**********           END                             - E4           125176
     C*
     C**********           END                             - E3           125176
     C*
     C                     END                             - E2
     C*
     C                     END                             - E1
     C*
     C********** KLIST2    SETLLREHISL                   52               125176
     C*
     C********** *IN52     IFEQ '0'                        - B1           125176
     C**********           Z-ADDCLDID     WDATE                           125176
     C**********           Z-ADD10        DBASE                           125176
     C**********           MOVE 'REHISL'  DBFILE           ***************125176
     C**********           MOVELRKEY2     DBKEY            **DB ERROR 10**125176
     C**********           MOVEA'1'       *IN,89           ***************125176
     C**********           EXSR DBSR                                      125176
     C**********           END                             - E1           125176
     C*
     C********** KLIST1    READEREHISL                   52               125176
     C*
     C********** *IN52     DOWEQ'0'                        - B1           125176
     C********** DRECI     ANDEQ'S'                                       125176
     C***********SCICI     ANDEQ'Y'                                       094337
     C********** SDICI     ANDEQ*BLANKS                                   125176
     C********** DHISD     ANDLTCHISD                                     125176
     C********** *IN52     OREQ '0'                                       125176
     C********** DRECI     ANDEQ'D'                                       125176
     C********** DDRCI     ANDEQ*BLANKS                                   125176
     C***********DCRCI     ANDEQ*BLANKS                                   094337
     C********** DMADI     ANDEQ*ZEROS                                    125176
     C***********DMACI     ANDNE*ZEROS                                    094337
     C********** DDMVT     ANDEQ*ZEROS                                    125176
     C********** DCMVT     ANDEQ*ZEROS                                    125176
     C********** *IN52     OREQ '0'                                       094337
     C***********DRECI     ANDEQ'D'                                       094337
     C***********DDRCI     ANDEQ*BLANKS                                   094337
     C***********DCRCI     ANDEQ'Y'                                       094337
     C***********DMADI     ANDEQ*ZEROS                                    094337
     C***********DMACI     ANDEQ*ZEROS                                    094337
     C***********DDMVT     ANDEQ*ZEROS                                    094337
     C***********DCMVT     ANDEQ*ZEROS                                    094337
     C********** *IN52     OREQ '0'                                       094337
     C***********DRECI     ANDEQ'D'                                       094337
     C***********DDRCI     ANDEQ*BLANKS                                   094337
     C***********DCRCI     ANDEQ'Y'                                       094337
     C***********DMADI     ANDEQ*ZEROS                                    094337
     C***********DMACI     ANDNE*ZEROS                                    094337
     C***********DDMVT     ANDEQ*ZEROS                                    094337
     C***********DCMVT     ANDEQ*ZEROS                                    094337
     C*
     C********** KLIST1    READEREHISL                   52               125176
     C*
     C**********           END                             - E1           125176
     C*
     C           DDICT     IFLT 3                          - B1
     C*
     C                     Z-ADDWDRCB     ZICALC
     C                     Z-ADDWHISD     ZIBEG
     C                     Z-ADDCHISD     ZIEND
     C*
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C*
     C                     Z-ADDWHISB     HISB0
     C           HISB0     MULT DAYS      NUMB0
     C*
     C********** WHISB     IFGT *ZEROS                     - B1           125176
     C           CDAIC     SUB  WDAID     INTD0
     C                     SUB  MADR#     INTD0                           125176
     C**********           Z-ADD*ZEROS    INTC0                           125176
     C**********           ELSE                            - X1           125176
     C********** CCAIC     SUB  WCAID     INTC0                           125176
     C**********           Z-SUBINTC0     INTC0                           125176
     C**********           Z-ADD*ZEROS    INTD0                           125176
     C**********           END                             - E1           125176
     C*
     C**  OUTPUT SUBTOTAL
     C*
     C*******************  EXSR OVERDR                                    094431
     C*******************  WRITESTOTDR                                    094431
     C                     MOVE 'DR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C*
     C* CHARGE REPORT IF NECESSARY
     C*
     C**********           EXSR PRN1CH              chargesDetails1085713 125176
     C***********CCICI     IFNE *BLANK                                    085713
     C***********DTHGAR    IFNE *ZERO                                     085713
     C***********DTHGAN    ORNE *ZERO                                     085713
     C***********          Z-ADDDTHGAR    CHGR0                           085713
     C***********          Z-ADDDTHGAN    CHGN0                           085713
     C***********          Z-ADDNITMS     SNITMS                          085713
     C***********          WRITEPOSTCH                                    085713
     C***********          END                                            085713
     C***********          END                                            085713
     C*
     C                     END                             - E1
     C*
     C** PREPARE C/F BALANCE
     C*
     C                     EXSR CLMSG
     C                     MOVELNAR,6     TNARR
     C*
     C**  TRANSFER DATE MIDAS INTO DDMMMYY
     C*
     C           PVALD     IFNE CHISD                      - B1
     C                     Z-ADDCHISD     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALDO
     C*
     C                     MOVE CHISD     PVALD
     C*
     C                     END                             - E1
     C*
     C                     MOVE VALDO     VALDA
     C                     Z-ADDCHISB     HISB0
     C*
     C**  OUTPUT BALANCE C/F
     C*
     C                     EXSR OVERDR
     C                     WRITETITLEDR
     C*
     C**  PREPARE TOTAL INTEREST OUTPUT
     C*
     C                     Z-ADDWDRCB     ZICALC
     C                     Z-ADDCLDID     ZIBEG
     C                     Z-ADDCHISD     ZIEND
     C                     EXSR ZICD
     C*
     C                     Z-ADDZDAYN1    DAYS
     C*
     C                     EXSR CLMSG
     C                     MOVELNAR,5     XNARR
     C*
     C                     Z-ADDCDAIC     TINTD0
     C*
     C**  OUTPUT TOTAL INTEREST
     C*
     C                     EXSR OVERDR
     C                     WRITETOTALDR
     C           CSGADI    IFNE *ZERO                                     094337
     C                     EXSR CLMSG                                     094337
     C                     Z-ADDCSGADI    TINTD0                          094337
     C                     MOVELNAR,23    DNARR                           094337
     C                     EXSR OVERDR                                    094337
     C                     WRITETOTDDR                                    094337
     C                     END                                            094337
     C*
     C**  PREPARE TOTAL COMMISSION OUTPUT
     C*
     C***********          MOVE '0'       *IN59                           094337
     C                     MOVE '1'       *IN59                           094337
     C*
     C**  PREPARE FIXED COMMISSION OUTPUT
     C*
     C           FXDC      IFNE *ZERO                      - B1
     C                     EXSR CLMSG
     C                     MOVELNAR,28    DNARR
     C*
     C                     Z-ADDFXDC      TINTD0
     C                     EXSR OVERDR
     C                     WRITETOTDDR
     C                     MOVE '1'       *IN59
     C                     END                             - E1
     C*
     C**  PREPARE COMMISSION ON DEBIT INTEREST
     C*
     C           *IN70     IFEQ '1'                        - B1
     C*
     C           CDIE      IFNE *ZERO                      - B2
     C                     EXSR CLMSG
     C                     MOVELNAR,17    DNARR
     C*
     C                     Z-ADDCDIE      TINTD0
     C                     EXSR OVERDR
     C                     WRITETOTDDR
     C                     MOVE '1'       *IN59
     C                     END                             - E2
     C*
     C**  PREPARE ACCOUNT COMMISSION
     C*
     C           ACCEA     IFNE *ZERO                      - B2
     C                     EXSR CLMSG
     C                     MOVELNAR,18    DNARR
     C*
     C                     Z-ADDACCEA     TINTD0
     C                     EXSR OVERDR
     C                     WRITETOTDDR
     C                     MOVE '1'       *IN59
     C                     END                             - E2
     C*
     C**  PREPARE H/O COMMISSION
     C*
     C           CHDBE     IFNE *ZERO                      - B2
     C                     EXSR CLMSG
     C                     MOVELNAR,19    DNARR
     C*
     C                     Z-ADDCHDBE     TINTD0
     C                     EXSR OVERDR
     C                     WRITETOTDDR
     C                     MOVE '1'       *IN59
     C                     END                             - E2
     C*
     C**  PREPARE COMMISSION ON MINIMUM BALANCE
     C*
     C           CMBE      IFNE *ZERO                      - B2
     C                     EXSR CLMSG
     C                     MOVELNAR,20    DNARR
     C*
     C                     Z-ADDCMBE      TINTD0
     C                     EXSR OVERDR
     C                     WRITETOTDDR
     C                     MOVE '1'       *IN59
     C                     END                             - E2
     C*
     C**  Prepare inactive commission
     C*
     C           IACE      IFNE *ZERO                      - B2
     C                     EXSR CLMSG
     C                     MOVELNAR,30    DNARR
     C*
     C                     Z-ADDIACE      TINTD0
     C                     EXSR OVERDR
     C                     WRITETOTDDR
     C                     MOVE '1'       *IN59
     C                     END                             - E2
     C*
     C                     ELSE                            - X1
     C*
     C           CDICA     IFNE *ZERO                      - B2
     C                     EXSR CLMSG
     C                     MOVELNAR,17    DNARR
     C*
     C           CDICA     SUB  CCDIC     TINTD0
     C                     EXSR OVERDR
     C                     WRITETOTDDR
     C                     MOVE '1'       *IN59
     C                     END                             - E2
     C*
     C**  PREPARE ACCOUNT COMMISSION
     C*
     C           ACCC      IFNE *ZERO                      - B2
     C                     EXSR CLMSG
     C                     MOVELNAR,18    DNARR
     C*
     C           ACCC      SUB  CACCC     TINTD0
     C                     EXSR OVERDR
     C                     WRITETOTDDR
     C                     MOVE '1'       *IN59
     C                     END                             - E2
     C*
     C**  PREPARE H/O COMMISSION
     C*
     C           CHDBC     IFNE *ZERO                      - B2
     C                     EXSR CLMSG
     C                     MOVELNAR,19    DNARR
     C*
     C           CHDBC     SUB  CCHDBC    TINTD0
     C                     EXSR OVERDR
     C                     WRITETOTDDR
     C                     MOVE '1'       *IN59
     C                     END                             - E2
     C*
     C**  PREPARE COMMISSION ON MINIMUM BALANCE
     C*
     C           CMBC      IFNE *ZERO                      - B2
     C                     EXSR CLMSG
     C                     MOVELNAR,20    DNARR
     C*
     C           CMBC      SUB  CCMBC     TINTD0
     C                     EXSR OVERDR
     C                     WRITETOTDDR
     C                     MOVE '1'       *IN59
     C                     END                             - E2
     C*
     C**  PREPARE VAT
     C*
     C           VATAM     IFNE *ZERO                      - B2
     C                     EXSR CLMSG
     C                     MOVELNAR,24    DNARR
     C*
     C                     Z-ADDVATAM     TINTD0
     C                     EXSR OVERDR
     C                     WRITETOTDDR
     C                     MOVE '1'       *IN59
     C                     END                             - E2
     C*
     C**  Prepare inactive commission
     C*
     C           IACCC     IFNE *ZERO                      - B2
     C                     EXSR CLMSG
     C                     MOVELNAR,30    DNARR
     C*
     C                     Z-ADDIACCC     TINTD0
     C                     EXSR OVERDR
     C                     WRITETOTDDR
     C                     MOVE '1'       *IN59
     C                     END                             - E2
     C*
     C                     END                             - E1
     C*
     C**  Prepare extra daily statment commission
     C*
     C           NOIP      ADD  CCINST    CCINST
     C           CCINST    IFNE *ZERO                      - B2
     C                     EXSR CLMSG
     C                     MOVELNAR,34    DNARR
     C*
     C                     Z-ADDCCINST    TINTD0
     C                     EXSR OVERDR
     C                     WRITETOTDDR
     C                     MOVE '1'       *IN59
     C                     END                             - E2
     C/COPY WNCPYSRC,RE3761C010
     C*
     C**  PREPARE TOTAL
     C*
     C                     Z-ADD*ZERO     TINTD0
     C/COPY WNCPYSRC,RE3761C005
     C           CSDCI     IFEQ 'Y'
     C           CSDCI     OREQ 'I'
     C           CSDCI     OREQ 'A'
     C           CDAIC     ADD  FXDC      TINTD0
     C/COPY WNCPYSRC,RE3761C011
     C                     ADD  CDICA     TINTD0
     C                     ADD  ACCC      TINTD0
     C                     ADD  CHDBC     TINTD0
     C                     ADD  CMBC      TINTD0
     C                     ADD  VATAM     TINTD0
     C                     ADD  IACCC     TINTD0
     C                     ADD  CCINST    TINTD0
     C**********           ADD  CSGADI    TINTD0                   094337 121125
     C                     END
     C                     ADD  CSGADI    TINTD0                          121125
     C                     EXSR CLMSG
     C                     MOVELNAR,21    DNARR
     C*
     C           *IN59     IFEQ '1'                                       085171
     C                     EXSR OVERDR
     C                     WRITETOTDDR
     C                     END                                            085171
     C*
     C***CAPITALISATION*TO*AN*ACCOUNT IN DIFFERENT CURRENCY AND           125176
     C***MULTIBRANCH*IS*PRESENT                                           125176
     C*
      * Report alternative a/c for DR interest if used                    125176
     C           DACP      IFNE *BLANK                                    125176
      *                                                                   125176
      * If capitalisation to a/c in different ccy, report exchange rate   125176
     C           *IN87     IFEQ '1'                        - B1
     C********** DACP      IFNE *BLANKS                    - E2    094337 125176
     C********** DEXRT     IFNE *ZEROS                     - B2           125176
     C           DEXRT     ANDNE*ZEROS                                    125176
     C**********           EXSR CLMSG                                     125176
     C**********           MOVELNAR,32    NARR                            125176
     C                     Z-ADDDEXRT     RATE
     C                     MOVE '0'       *IN55                           125176
     C                     ELSE                                           125176
     C                     MOVE '1'       *IN55                           125176
     C                     END                                            094337
      *                                                                   125176
     C                     EXSR CLMSG                                     125176
     C                     MOVELNAR,32    NARR                            125176
     C***********          MOVELSDACP     MIDK                            094337
     C                     MOVELDACP      MIDK                            094337
     C**********           MOVE '1'       *IN55                    094337 125176
     C                     EXSR OVERDR
     C                     WRITEALTNDR
     C**********           MOVE '0'       *IN55                    094337 125176
     C                     END                             - E2
     C***********CEXRT     IFNE *ZEROS                     - B2           094337
     C***********          EXSR CLMSG                                     094337
     C***********          MOVELNAR,31    NARR                            094337
     C***********          Z-ADDCEXRT     RATE                            094337
     C***********          MOVELSCACP     MIDK                            094337
     C***********          EXSR OVERDR                                    094337
     C***********          WRITEALTNDR                                    094337
     C***********          END                             - E2           094337
     C***********CHXRT     IFNE *ZEROS                     - B2           094337
     C***********          EXSR CLMSG                                     094337
     C***********          MOVELNAR,33    NARR                            094337
     C***********          Z-ADDCHXRT     RATE                            094337
     C***********          MOVELSCHAC     MIDK                            094337
     C***********          EXSR OVERDR                                    094337
     C***********          WRITEALTNDR                                    094377
     C***********          END                             - E2           094337
     C**********           END                             - E1           125176
     C*
     C           *IN70     IFEQ '1'                        - B1
     C                     EXSR OVERDR
     C                     WRITETOTMDR
     C                     END
     C*
     C/COPY WNCPYSRC,RE3761C015
     C           CER050    IFEQ 'Y'                                                           CER050
      *                                                                                       CER050
      * Only print APR if not management statement                                            CER050
      *                                                                                       CER050
     C           *IN70     IFEQ '0'                        B001                               CER050
      *                                                                                       CER050
     C                     MOVE *OFF      *IN61                                               CER050
      *                                                                                       CER050
     C           KACCNT    CHAINACCNTBY0             99                                       CER050
     C           *IN99     IFEQ '0'                                                           CER050
      *                                                                                       CER050
      * Run this process only if APR is set to 'Y'                                            CER050
      *                                                                                       CER050
     C           ATAPRC    IFEQ 'Y'                                                           CER050
     C                     EXSR SRAPRD                                                        CER050
     C                     ENDIF                                                              CER050
     C                     ENDIF                                                              CER050
      *                                                                                       CER050
     C                     ENDIF                                                              CER050
      *                                                                                       CER050
     C                     ENDIF                                                              CER050
     C                     ENDSR                           **DRSR ENDSR**
     C*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** DETPR subroutine for detail processing
     C**
     C**     Called by       M A I N
     C**
     C**     Calls         BOTHSR, DRSR, CRSR, DBSR
     C**
     C           DETPR     BEGSR                           **DETPR BEGSR**
     C*
     C/COPY WNCPYSRC,RE3761C059
     C**  ACCESS ACCRACJ (ACCNTAB, REIACD, REACRD)
     C*
     C           KLIST1    CHAINACCRACJ              99
     C           *IN99     IFEQ '1'                        - B1
     C                     Z-ADD11        DBASE            ***************
     C                     MOVE 'ACCRACJ' DBFILE           **DB ERROR 11**
     C                     MOVELRKEY      DBKEY            ***************
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E1
     C*                                                                   094657
     C**  Set indicator for address print.                                094657
     C*                                                                   094657
     C                     MOVE '0'       *IN23                           094657
     C                     TESTB'2'       GLBT           23               094657
     C*
     C**  INITIALIZE TAXES WORK FIELDS
     C*
     C                     Z-ADD*ZEROS    WWCINW 150
     C                     MOVEL*BLANK    #JITAX  1
      *                                                                   CFT004
     C                     MOVEL*BLANKS   RIBAN                           CFT004
     C                     MOVE '0'       *IN04                           CFT004
     C           CFT004    IFEQ 'Y'                                       CFT004
     C                     MOVELCCNUM     WCNUM   6                       CFT004
     C**********           MOVELCACOD     WACOD   4                                    CFT004 CGL029
     C                     MOVELCACOD     WACOD  10                                           CGL029
     C                     MOVELCACSQ     WACSQ   2                       CFT004
     C                     CALL 'AOACCTR0'                                CFT004
     C                     PARM *BLANKS   PRTCD                           CFT004
     C                     PARM '*KEY   ' POPTN                           CFT004
     C                     PARM *BLANK    PRETL  10                       CFT004
     C                     PARM WCNUM     PCNUM   6                       CFT004
     C                     PARM CCCY      PCUCD   3                       CFT004
     C**********           PARM WACOD     PACCD   4                                    CFT004 CGL029
     C                     PARM WACOD     PACCD  10                                           CGL029
     C                     PARM WACSQ     PACSQ   2                       CFT004
     C                     PARM CBRCA     PBRCA   3                       CFT004
     C           ACCNTB    PARM ACCNTB    DSSDY                           CFT004
      *                                                                   CFT004
     C           PRTCD     IFNE *BLANKS                                   CFT004
     C                     Z-ADD28        DBASE            ************   CFT004
     C                     MOVEL'ACCNTAB' DBFILE           * DBERR 28 *   CFT004
     C                     MOVELRKEY      DBKEY            ************   CFT004
     C                     MOVE '1'       *IN89                           CFT004
     C                     EXSR DBSR                                      CFT004
     C                     ENDIF                                          CFT004
      *                                                                   CFT004
      ** Format International Bank Account Numbers                        CFT004
      *                                                                   CFT004
     C           IBAN      IFNE *BLANKS                                   CFT004
     C                     CALL 'AOIBANR3'                                CFT004
     C                     PARM *BLANKS   PRTCD   7                       CFT004
     C                     PARM IBAN      PIBAN  47                       CFT004
     C                     PARM *BLANKS   PIWITH 47                       CFT004
     C                     PARM *BLANKS   PINOBL 34                       CFT004
      *                                                                   CFT004
     C           PRTCD     IFEQ *BLANKS                                   CFT004
     C                     MOVELPIWITH    RIBAN                           CFT004
     C                     MOVE '1'       *IN04                           CFT004
     C                     ENDIF                                          CFT004
     C                     ENDIF                                          CFT004
      *                                                                   CFT004
     C                     ENDIF                                          CFT004
      *                                                                   CFT004
     C*
     C**  RETAIL WITHHOLDING TAX INSTALLED ...
     C*
     C           BGNTST    IFEQ 'Y'                        - B1
     C*
     C           CCICI     IFEQ 'Y'                        - B2
     C           CCICI     OREQ 'C'
     C           CCICI     OREQ 'D'
     C*
     C           KLIST1    CHAINRETAXJL              99
     C           *IN99     IFEQ '1'                        - B3
     C                     Z-ADD12        DBASE            ***************
     C                     MOVEL'RETAXJL' DBFILE           **DB ERROR 12**
     C                     MOVELRKEY      DBKEY            ***************
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     ELSE                            - X3
     C           #JITAX    IFEQ 'Y'                        - B4
     C/COPY WNCPYSRC,RE3761C044
     C                     Z-ADD#JCINW    WWCINW
     C                     END                             - E4
      *                                                                                       CDL013
      ** If Tiered Withholding Tax feature is switched ON                                     CDL013
     C           CDL013    IFEQ '1'                                                           CDL013
     C           #JITAX    ANDNE'0'                                                           CDL013
     C                     Z-ADD#JCINW    WWCINW                                              CDL013
     C                     ENDIF                                                              CDL013
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3761CCP2                                           S01408
     C*                                                                   S01408
     C*
     C                     END                             - E3
     C*
     C                     END                             - E2
     C*
     C                     END                             - E1
     C*
     C**  ACCESS CLINT FOR CLIENT INFORMATION (ADDRESS, NAME, ETC)
     C*
      *                                                                                       CRE083
      ** IF THE CUSTOMER NUMBER IS THE SAME AS THE PREVIOUS                                   CRE083
      ** CUSTOMER NUMBER NO NEED TO ACCESS CLINT                                              CRE083
      *                                                                                       CRE083
     C********** CCNUM     IFNE PCNUM                                                CRE083 MD038030
     C           CCNUM     IFNE XCNUM                                                       MD038030
      *                                                                                       CRE083
     C                     MOVE 'B'       RCDT
     C           KLIST4    CHAINCLINT                99
     C           *IN99     IFEQ '1'                        - B1
     C                     MOVELCCNUM     DBKEY
     C                     Z-ADD13        DBASE            ***************
     C                     MOVE 'CLINT'   DBFILE           **DB ERROR 13**
     C                     MOVELRCDT      DBKEY            ***************
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E1
      *                                                                                       CRE083
     C**********           MOVE CCNUM     PCNUM   6                                  CRE083 MD038030
     C                     MOVE CCNUM     XCNUM   6                                         MD038030
     C                     END                                                                CRE083
     C*
     C** CHECK IF CURRENCY EXIST
     C*
     C                     Z-ADD1         I
     C           CCCY      LOKUPCCYA,I                   97
     C*
     C           *IN97     IFEQ *ZERO                      - B1
     C                     Z-ADD14        DBASE            ***************
     C                     MOVE 'SDCURRPD'DBFILE           **DB ERROR 14**
     C                     MOVELCCCY      DBKEY            ***************
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E1
     C*
     C                     MOVE ACNO      WACNO
     C/COPY WNCPYSRC,RE3761C063
     C*
     C** CHECK NUMBER OF DECIMAL OF CURRENCY
     C*
     C                     MOVEA'0000'    *IN,80
     C*
     C           DPA,I     IFEQ 0                          - B1
     C                     MOVE '1'       *IN80
     C                     ELSE                            - X1
     C           DPA,I     IFEQ 1                          - B2
     C                     MOVE '1'       *IN81
     C                     ELSE                            - X2
     C           DPA,I     IFEQ 2                          - B3
     C                     MOVE '1'       *IN82
     C                     ELSE                            - X3
     C                     MOVE '1'       *IN83
     C                     END                             - E3
     C                     END                             - E2
     C                     END                             - E1
     C*
     C                     MOVEA'00'      *IN,01
     C*
     C**  DEFINE CAPITALISATION TO BE PROCESSED
     C*
     C           CDICI     IFNE *BLANKS                    - B1
     C                     MOVE '1'       *IN01
     C                     END                             - E1
     C*
     C           CCICI     IFNE *BLANKS                    - B1
     C                     MOVE '1'       *IN02
     C                     END                             - E1
     C*
     C           CCICI     IFNE *BLANKS                    - B1
     C           CDICI     ANDNE*BLANKS
     C                     EXSR BOTHSR
     C                     ELSE                            - X1
     C           CCICI     IFNE *BLANKS                    - B2
     C                     EXSR CRSR
     C                     END                             - E2
     C           CDICI     IFNE *BLANKS                    - B2
     C                     EXSR DRSR
     C                     END                             - E2
     C                     END                             - E1
     C*
     C                     EXSR INITPR
     C*
     C                     ENDSR                           **DETPR ENDSR**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** FIRST subroutine to execute first cycle.
     C**
     C**     Called by       S T A R T
     C**     Calls           DBSR
     C**
     C           FIRST     BEGSR                           **FIRST BEGSR**
     C*
     C** PREPARE DBPGM, DBKEY AND ERRDAT VARIABLES
     C*
     C                     MOVE 'RE3761  'DBPGM
     C                     MOVE *BLANKS   DBKEY
     C                     MOVE *BLANKS   DBASE
     C           *NAMVAR   DEFN RUNDAT    RUNDT
     C                     IN   RUNDT
     C           MBIN      IFEQ 'Y'
     C                     SETON                     86
     C                     END
     C**
     C**   ACCESS BANK DETAILS
     C**
     C                     CALL 'AOBANKR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C           SDBANK    PARM SDBANK    DSFDY
     C*
     C           @RTCD     IFNE *BLANK
     C*********************SETON                     U7U8LR               LN0112
     C                     MOVEL'SDBANKPD'DBFILE
     C                     MOVEL@OPTN     DBKEY            ***************
     C                     MOVEL@OPTN     DBOPTN  7        **DB ERROR 15**
     C                     Z-ADD15        DBASE            ***************
     C                     EXSR DBSR
     C                     GOTO ENDFST
     C                     END
     C*                                                                   094337
     C**   Access Retail Details.                                         094337
     C*                                                                   094337
     C                     CALL 'AORETLR0'                                094337
     C                     PARM *BLANKS   @RTCD   7                       094337
     C                     PARM '*FIRST ' @OPTN   7                       094337
     C           SDRETL    PARM SDRETL    DSFDY                           094337
     C           @RTCD     IFNE *BLANK                                    094337
     C           *LOCK     IN   LDA                                       094337
     C                     MOVEL'SDRETLPD'DBFILE           ***************094337
     C                     MOVEL@OPTN     DBKEY            * DB ERROR 27 *094337
     C                     MOVEL@OPTN     DBOPTN  7        ***************094337
     C                     Z-ADD027       DBASE                           094337
     C                     OUT  LDA                                       094337
     C                     EXSR DBSR                                      094337
     C                     GOTO ENDFST                                    094337
     C                     END                                            094337
     C**                                                                  CRE003
     C**   SET OFF W-PRINT-INDICATOR                                      CRE003
     C**                                                                  CRE003
     C                     SETOF                     69                   CRE003
     C**                                                                  CRE003
     C**   IF ACCRUAL ON CLEARED BALANCES FLAG= 'N' SET ON W-PRINT-INDICATCRE003
     C**                                                                  CRE003
     C           BMCBAI    IFEQ 'N'                                       CRE003
     C                     SETON                     69                   CRE003
     C                     END                                            CRE003
     C*
     C** OUTPUT AUDIT HEADER
     C*
     C                     WRITEHEADAU
     C*
     C** INITIALISE WORK FIELDS
     C*
     C                     Z-ADD*ZEROS    PPSTD
     C                     Z-ADD*ZEROS    PVALD
     C/COPY WNCPYSRC,RE3761C055
     C                     Z-ADD1         PAGD
     C                     Z-ADD1         PAGC
     C/COPY WNCPYSRC,RE3761C056
     C                     Z-ADD1         PAGN
     C                     Z-ADD1         PAGE
     C                     Z-ADD*ZEROS    DHISD
     C                     Z-ADD*ZEROS    WHISD
     C                     Z-ADD*ZEROS    DAYS
     C                     Z-ADD*ZEROS    NUMB0
     C                     Z-ADD*ZEROS    HISB0
     C                     Z-ADD*ZEROS    INTD0
     C                     Z-ADD*ZEROS    INTC0
     C                     Z-ADD*ZEROS    TINTD0
     C                     Z-ADD*ZEROS    TINTC0
     C                     Z-ADD*ZEROS    ZICALC  20
     C                     Z-ADD*ZEROS    WDAID
     C                     Z-ADD*ZEROS    WCAID
     C                     Z-ADD*ZEROS    RTA                             125176
     C                     Z-ADD*ZEROS    BLA                             143079
     C                     Z-ADD*ZEROS    OBAL11                                              164890
     C                     Z-ADD*ZEROS    OBAL21                                              164890
     C                     Z-ADD*ZEROS    OBAL31                                              164890
     C                     CLEARORAT1                                                         164890
     C                     CLEAROBAL01                                                        164890
     C*
     C**  SET UP WORK FIELD FOR OVERRIDE MESSAGE FILE
     C*
     C                     Z-ADD39        MSGLEN 155
     C***********                                                         094337
     C***OPEN*ICD TABLE FOR RETAIL                                        094337
     C***********                                                         094337
     C***********1         CHAINTABTB55              99            085250 094337
     C************IN99     IFEQ '1'                        - B1    085250 094337
     C***********RECI      ORNE 'D'                                085250 094337
     C***********          Z-ADD16        DBASE     ***************085250 094337
     C***********          MOVE 'TABTB55' DBFILE    **DB ERROR 16**085250 094337
     C***********          MOVEL*BLANKS   DBKEY     ***************085250 094337
     C***********          MOVEA'0'       *IN,89                   085250 094337
     C***********          EXSR DBSR                               085250 094337
     C***********          END                             - E1    085250 094337
     C*
     C** OPEN ICD TABLE FOR RETAIL
     C*
     C                     OPEN TABTBRE
     C           1         CHAINTABTBRE              99
     C*
     C           *IN99     IFEQ '1'                        - B1
     C           RECI      ORNE 'D'
     C                     Z-ADD16        DBASE            ***************
     C                     MOVE 'TABTBRE' DBFILE           **DB ERROR 16**
     C                     MOVEL*BLANKS   DBKEY            ***************
     C                     MOVEA'0'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E1
     C*
     C** CHECK IF CHARGES FOR MULTIPLE TRANSACTION IS PRESENT
     C*
     C           CMTR      IFEQ 'Y'                        - B1
     C                     MOVE '1'       *IN88
     C                     ELSE                            - X1
     C                     MOVE '0'       *IN88
     C                     END                             - E1
     C*
     C** CHECK IF CAPITALISATION TO AN ACCOUNT IN DIFFERENT CURRENCY
     C** AND MULTIBRANCH IS PRESENT
     C*
     C           CDFC      IFEQ 'Y'                        - B1
     C                     MOVE '1'       *IN87
     C                     ELSE                            - X1
     C                     MOVE '0'       *IN87
     C                     END                             - E1
     C*
     C                     CLOSETABTBRE
     C*
     C*
     C* CHECK FOR SWISS TAXES PRESENT
     C*
     C           1         SETLLSDMMODPD
     C                     READ SDMMODPD                 99
     C           *IN99     IFEQ '1'                        - B1
     C                     Z-ADD17        DBASE            ***************
     C                     MOVEL'SDMMODPD'DBFILE           **DB ERROR 17**
     C                     MOVEL'MMOD'    DBKEY            ***************
     C                     MOVEA'0'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E1
      *                                                                                       CER050
      ** Check if CER050 is on.                                                               CER050
      *                                                                                       CER050
     C                     CALL 'AOSARDR0'                                                    CER050
     C                     PARM *BLANKS   @RTCD   7                                           CER050
     C                     PARM '*VERIFY' @OPTN                                               CER050
     C                     PARM 'CER050'  @SARD   6                                           CER050
      *                                                                                       CER050
     C           @RTCD     IFEQ *BLANK                                                        CER050
     C                     MOVE 'Y'       CER050  1                                           CER050
     C                     ELSE                                                               CER050
     C                     MOVE 'N'       CER050                                              CER050
     C                     ENDIF                                                              CER050
      *                                                                   CRE001
      ** Access SAR Details File to determine if CRE001 is installed      CRE001
      *                                                                   CRE001
     C                     CALL 'AOSARDR0'                                CRE001
     C                     PARM *BLANKS   @RTCD   7                       CRE001
     C                     PARM '*VERIFY' @OPTN                           CRE001
     C                     PARM 'CRE001'  @SARD   6                       CRE001
      *                                                                   CRE001
      ** Handle Datebase Error.                                           CRE001
     C           @RTCD     IFNE *BLANK                                    CRE001
     C           @RTCD     ANDNE'*NRF   '                  ***************CRE001
     C                     MOVEL'SCSARDPD'DBFILE           **DB ERROR 25**CRE001
     C                     MOVEL@RTCD     DBKEY            ***************CRE001
     C                     Z-ADD25        DBASE                           CRE001
     C                     EXSR DBSR                                      CRE001
     C                     GOTO ENDFST                                    CRE001
     C                     ENDIF                                          CRE001
      *                                                                   CRE001
      ** CRE001 is installed                                              CRE001
     C           @RTCD     IFEQ *BLANK                                    CRE001
     C                     MOVE 'Y'       CRE001  1                       CRE001
     C                     ELSE                                           CRE001
     C                     MOVE 'N'       CRE001                          CRE001
     C                     ENDIF                                          CRE001
     C/COPY WNCPYSRC,RE3761C022
      *                                                                   CRE001
     C                     EXSR MULTL
     C**
     C** Check date format
     C**
     C           DATF      COMP 'M'                      98
     C**
     C** ACCESS SAR DETAILS FILE TO DETERMINE IF BRT SAR IS INSTALLED
     C**
     C                     CALL 'AOSARDR0'
     C                     PARM '       ' @RTCD
     C                     PARM '*VERIFY' @OPTN
     C                     PARM 'S01383'  @SARD   6
     C           @RTCD     IFNE *BLANK
     C           @RTCD     ANDNE'*NRF   '                  ***************
     C*********************SETON                     U7U8LR**DB ERROR 18**LN0112
     C                     MOVEL'SCSARDPD'DBFILE           ***************
     C                     MOVEL@RTCD     DBKEY
     C                     Z-ADD18        DBASE
     C                     EXSR DBSR                                      LN0112
     C                     GOTO ENDFST
     C                     END
     C           @RTCD     IFEQ *BLANK
     C                     MOVEL'Y'       S01383  1
     C                     END
     C*
     C** IF BRT SAR INSTALLED
     C*
     C           S01383    IFEQ 'Y'                        B001
     C*
     C** ACCESS BRT INSTALLATION CONTROL DATA
     C*
     C                     MOVE 'D'       RECI
     C           RECI      CHAINSDBRTDD0             99
     C           *IN99     IFEQ '1'                        ***************
     C*********************SETON                     U7U8LR**DB ERROR 19**LN0112
     C                     MOVEL'SDBRTDPD'DBFILE           ***************
     C                     MOVELRECI      DBKEY
     C                     Z-ADD19        DBASE
     C                     EXSR DBSR                                      LN0112
     C                     GOTO ENDFST
     C                     END
     C                     END                             E001
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3761CCP1                                           S01408
     C*                                                                   S01408
      *                                                                                       CDL013
      ***   Check if CAR CDL013 is installed                                                  CDL013
     C                     CALL 'AOSARDR0'                                                    CDL013
     C                     PARM *BLANKS   @RTCD   7                                           CDL013
     C                     PARM '*VERIFY' @OPTN   7                                           CDL013
     C                     PARM 'CDL013'  @SARD   6                                           CDL013
      *                                                                                       CDL013
      ** If call to program fails perform standard database error                             CDL013
      ** processing                                                                           CDL013
     C           @RTCD     IFNE *BLANK                                                        CDL013
     C           @RTCD     ANDNE'*NRF   '                                                     CDL013
     C                     MOVEL'SCSARDPD'DBFILE                                              CDL013
     C                     MOVEL@RTCD     DBKEY                                               CDL013
     C                     MOVEA'1'       *IN,89                                              CDL013
     C                     Z-ADD29        DBASE                                               CDL013
     C                     EXSR DBSR                                                          CDL013
     C                     ENDIF                                                              CDL013
      *                                                                                       CDL013
      ***   CAR CDL013 is installed                                                           CDL013
     C           @RTCD     IFEQ *BLANKS                                                       CDL013
     C                     MOVE '1'       CDL013  1                                           CDL013
     C                     ENDIF                                                              CDL013
      ** Check if CGL031 is enabled                                                           CGL031
      *                                                                                       CGL031
     C                     CALL 'AOSARDR0'                                                    CGL031
     C                     PARM *BLANKS   PRTCD   7                                           CGL031
     C                     PARM '*VERIFY' POPTN   7                                           CGL031
     C                     PARM 'CGL031'  PSARD   6                                           CGL031
     C           SCSARD    PARM SCSARD    DSFDY                                               CGL031
      *                                                                                       CGL031
     C                     MOVE 'N'       CGL031  1                                           CGL031
      *                                                                                       CGL031
     C           PRTCD     IFEQ *BLANKS                                                       CGL031
     C                     MOVE 'Y'       CGL031                                              CGL031
     C                     ELSE                                                               CGL031
      *                                                                                       CGL031
      ** Handle Datebase Error.                                                               CGL031
      *                                                                                       CGL031
     C           PRTCD     IFNE '*NRF   '                                                     CGL031
     C           *LOCK     IN   LDA                                                           CGL031
     C                     MOVEL'SCSARDPD'DBFILE                                              CGL031
     C                     MOVEL'CGL031'  DBKEY                                               CGL031
     C                     Z-ADD31        DBASE                                               CGL031
     C                     OUT  LDA                                                           CGL031
     C                     EXSR *PSSR                                                         CGL031
     C                     ENDIF                                                              CGL031
      *                                                                                       CGL031
     C                     ENDIF                                                              CGL031
     C*
     C                     Z-ADDTGINT0    TGINT0
     C                     Z-ADDWKBRT     WKBRT   75
     C                     Z-ADDBRTOT0    BRTOT0
     C                     Z-ADDBRTOT1    BRTOT1 151
     C*
     C                     EXSR CCYARR
      *                                                                   CFT004
      **  Access SAR details file to see if CFT004 is installed.          CFT004
      *                                                                   CFT004
     C                     CALL 'AOSARDR0'                                CFT004
     C                     PARM *BLANKS   PRTCD   7                       CFT004
     C                     PARM '*VERIFY' POPTN   7                       CFT004
     C                     PARM 'CFT004'  PSARD   6                       CFT004
     C           SCSARD    PARM SCSARD    DSSDY                           CFT004
     C*                                                                   CFT004
     C                     MOVE 'N'       CFT004                          CFT004
     C           PRTCD     IFEQ *BLANKS                                   CFT004
     C                     MOVE 'Y'       CFT004  1                       CFT004
     C                     ENDIF                                          CFT004
      *                                                                                       CER016
      ** Access SAR Details File to dertermine if CER016 is installed                         CER016
      *                                                                                       CER016
     C                     CALL 'AOSARDR0'                                                    CER016
     C                     PARM *BLANKS   PRTCD                                               CER016
     C                     PARM '*VERIFY' POPTN                                               CER016
     C                     PARM 'CER016'  PSARD                                               CER016
     C           SCSARD    PARM SCSARD    DSSDY                                               CER016
      *                                                                                       CER016
      ** CER016 if installed                                                                  CER016
      *                                                                                       CER016
     C           PRTCD     IFEQ *BLANKS                                                       CER016
     C                     MOVE 'Y'       CER016  1                                           CER016
      *                                                                                       CER016
     C                     ELSE                                                               CER016
     C                     MOVE 'N'       CER016                                              CER016
     C                     ENDIF                                                              CER016
      *                                                                                       CER016
      ** Databse error                                                                        CER016
      *                                                                                       CER016
     C           PRTCD     IFNE *BLANKS                                                       CER016
     C           PRTCD     ANDNE'*NRF    '                                                    CER016
     C           *LOCK     IN   LDA                                                           CER016
     C                     MOVEL'SCSARDPD'DBFILE                                              CER016
     C                     MOVEL'CER016'  DBKEY                                               CER016
     C                     Z-ADD029       DBASE                                               CER016
     C                     OUT  LDA                                                           CER016
     C                     EXSR *PSSR                                                         CER016
      *                                                                                       CER016
     C                     ENDIF                                                              CER016
     C*
     C           ENDFST    TAG
      *                                                                                       CER048
      ** Check if CER048 is enabled                                                           CER048
      *                                                                                       CER048
     C                     CALL 'AOSARDR0'                                                    CER048
     C                     PARM *BLANKS   PRTCD                                               CER048
     C                     PARM '*VERIFY' POPTN                                               CER048
     C                     PARM 'CER048'  PSARD                                               CER048
     C           SCSARD    PARM SCSARD    DSFDY                                               CER048
      *                                                                                       CER048
     C                     MOVE 'N'       CER048  1                                           CER048
      *                                                                                       CER048
     C           PRTCD     IFEQ *BLANKS                                                       CER048
      *                                                                                       CER048
     C                     MOVE 'Y'       CER048                                              CER048
     C                     ELSE                                                               CER048
     C           PRTCD     IFNE '*NRF'                                                        CER048
      *                                                                                       CER048
     C                     MOVE 'SCSARDPD'DBFILE                                              CER048
     C                     MOVE 'CER048'  DBKEY                                               CER048
     C                     MOVE 32        DBASE                                               CER048
     C                     EXSR DBSR                                                          CER048
     C                     GOTO ENDFST                                                        CER048
      *                                                                                       CER048
     C                     ENDIF                                                              CER048
      *                                                                                       CER048
     C                     ENDIF                                                              CER048
      *                                                                                       CER048
      ** Check if CER054 is enabled                                                         BUG26838
      *                                                                                     BUG26838
     C                     CALL 'AOSARDR0'                                                  BUG26838
     C                     PARM *BLANKS   PRTCD                                             BUG26838
     C                     PARM '*VERIFY' POPTN                                             BUG26838
     C                     PARM 'CER054'  PSARD                                             BUG26838
     C           SCSARD    PARM SCSARD    DSFDY                                             BUG26838
      *                                                                                     BUG26838
     C                     MOVE 'N'       CER054  1                                         BUG26838
      *                                                                                     BUG26838
     C           PRTCD     IFEQ *BLANKS                                                     BUG26838
      *                                                                                     BUG26838
     C                     MOVE 'Y'       CER054                                            BUG26838
     C                     ELSE                                                             BUG26838
     C           PRTCD     IFNE '*NRF'                                                      BUG26838
      *                                                                                     BUG26838
     C                     MOVE 'SCSARDPD'DBFILE                                            BUG26838
     C                     MOVE 'CER054'  DBKEY                                             BUG26838
     C                     MOVE 32        DBASE                                             BUG26838
     C                     EXSR DBSR                                                        BUG26838
     C                     GOTO ENDFST                                                      BUG26838
      *                                                                                     BUG26838
     C                     ENDIF                                                            BUG26838
      *                                                                                     BUG26838
     C                     ENDIF                                                            BUG26838
      *                                                                                     MD057283
      ** Call AOSVALR0 to check system value to zeroised interest rate if                   MD057283
      ** initial threshold is greater than the level balance.                               MD057283
      *                                                                                     MD057283
     C                     CALL 'AOSVALR0'                                                  MD057283
     C                     PARM *BLANKS   PRTCD   7                                         MD057283
     C                     PARM WSYSVL    WSVLK1 20                                         MD057283
     C                     PARM           WSVL1 200                                         MD057283
     C                     PARM *BLANKS   WSVLK2 20                                         MD057283
     C                     PARM           WSVL2 200                                         MD057283
     C                     PARM *BLANKS   WSVLK3 20                                         MD057283
     C                     PARM           WSVL3 200                                         MD057283
     C                     PARM *BLANKS   WSVLK4 20                                         MD057283
     C                     PARM           WSVL4 200                                         MD057283
     C                     PARM *BLANKS   WSVLK5 20                                         MD057283
     C                     PARM           WSVL5 200                                         MD057283
     C                     PARM *BLANKS   WSVLK6 20                                         MD057283
     C                     PARM           WSVL6 200                                         MD057283
     C                     PARM *BLANKS   WSVLK7 20                                         MD057283
     C                     PARM           WSVL7 200                                         MD057283
     C                     PARM *BLANKS   WSVLK8 20                                         MD057283
     C                     PARM           WSVL8 200                                         MD057283
     C                     PARM *BLANKS   WSVLK9 20                                         MD057283
     C                     PARM           WSVL9 200                                         MD057283
     C                     PARM *BLANKS   WSVLK0 20                                         MD057283
     C                     PARM           WSVL0 200                                         MD057283
      *                                                                                     MD057283
     C           PRTCD     IFNE *BLANKS                                                     MD057283
     C           WSVL1     ANDEQ'*NRF   '                                                   MD057283
     C                     EXSR *PSSR                                                       MD057283
     C                     ELSE                                                             MD057283
     C                     MOVELWSVL1     WZERAT  1                                         MD057283
     C                     ENDIF                                                            MD057283
     C*
     C                     ENDSR                           **FIRST ENDSR**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** INITPR SUBROUTINE TO INITIALIZE ALL FIELDS TO BE PRINTED
     C**
     C**     Called by       DETPR
     C**     Calls           -
     C**
     C           INITPR    BEGSR                           **INITPR BEGSR**
     C*
     C                     MOVE *BLANKS   PSTDA
     C                     MOVE *BLANKS   VALDA
     C                     MOVE *BLANKS   NARR
     C                     MOVE *BLANKS   RNARR
     C                     MOVE *BLANKS   TNARR
     C                     MOVE *BLANKS   XNARR
     C                     MOVE *BLANKS   DNARR
     C                     MOVE *BLANKS   BNARR
     C*
     C                     Z-ADD*ZEROS    PSTD0
     C                     Z-ADD*ZEROS    RATE
     C                     Z-ADD*ZEROS    DAYS
     C                     Z-ADD*ZEROS    NUMB0
     C                     Z-ADD*ZEROS    HISB0
     C                     Z-ADD*ZEROS    INTD0
     C                     Z-ADD*ZEROS    INTC0
     C                     Z-ADD*ZEROS    TINTD0
     C                     Z-ADD*ZEROS    TINTC0
     C                     Z-ADD*ZEROS    ORAT1
     C***********          Z-ADD*ZEROS    ORAT2                           086087
     C***********          Z-ADD*ZEROS    ORAT3                           086087
     C                     Z-ADD*ZEROS    OBAL01
     C***********          Z-ADD*ZEROS    OBAL02                          086087
     C***********          Z-ADD*ZEROS    OBAL03                          086087
     C                     Z-ADD*ZEROS    WHISDC
     C                     Z-ADD*ZEROS    WHISDD
     C                     Z-ADD*ZEROS    WCAIDD                          125176
     C                     Z-ADD*ZEROS    WDAIDD                          125176
     C                     Z-ADD*ZEROS    TGINT0
     C                     Z-ADD*ZEROS    WKBRT
     C                     Z-ADD*ZEROS    BRTOT0
     C                     Z-ADD*ZEROS    BRTOT1
     C                     Z-ADD*ZEROS    EUTAX0                                              CGL031
     C                     Z-ADD*ZEROS    STAX0                                               CER048
     C                     Z-ADD*ZEROS    TTAX0                                             BUG26838
     C                     Z-ADD*ZEROS    BDATE                           125176
     C                     Z-ADD*ZEROS    MADR#                           125176
     C                     Z-ADD*ZEROS    MACR#                           125176
     C                     Z-ADD*ZEROS    TCHN0                           125176
     C                     Z-ADD*ZEROS    TCHR0                           125176
     C                     MOVE *BLANK    @ADJF   1                       125176
     C                     Z-ADD*ZEROS    OBAL11                                              164890
     C                     Z-ADD*ZEROS    OBAL21                                              164890
     C                     Z-ADD*ZEROS    OBAL31                                              164890
     C/COPY WNCPYSRC,RE3761C032
     C*
     C                     ENDSR                           **INITPR ENDSR*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** MULTL MULTILANGUAGE SUBROUTINE
     C**
     C**     Called by       FIRST, MAIN
     C**     Calls           ZA1310
     C**
     C           MULTL     BEGSR                           **MULTL BEGSR**
     C/COPY WNCPYSRC,RE3761C060
     C                     EXSR CLMSG
     C                     MOVEL'RES0001' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,1
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0002' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,2
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0003' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,3
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0004' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,4
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0005' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,5
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0006' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,6
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0007' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,7
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0008' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,8
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0009' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,9
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0010' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,10
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0011' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,11
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0012' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,12
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0013' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,13
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0014' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,14
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0015' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,15
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0016' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,16
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0017' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,17
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0018' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,18
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0019' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,19
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0020' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,20
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0021' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,21
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0022' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,22
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0023' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,23
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0024' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,24
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0025' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,25
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'TAS0001' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,26
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0033' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,27
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0035' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,28
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0039' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,29
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0040' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,30
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0041' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,31
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0042' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,32
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0043' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,33
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0044' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,34
     C                     MOVEL*BLANKS   MNARR
     C*                                                                   064051
     C                     EXSR CLMSG                                     064051
     C                     MOVEL'RES0045' MSGID                           064051
     C                     CALL 'ZA1310'  ZA1311                          064051
     C                     MOVELMNARR     NAR,35                          064051
     C                     MOVEL*BLANKS   MNARR                           064051
     C*
     C                     EXSR CLMSG                                     094337
     C                     MOVEL'RES0046' MSGID                           094337
     C                     CALL 'ZA1310'  ZA1311                          094337
     C                     MOVELMNARR     NAR,36                          094337
     C                     MOVEL*BLANKS   MNARR                           094337
      *                                                                   CRE001
      ** If CRE001 is switched ON                                         CRE001
      *                                                                   CRE001
     C           CRE001    IFEQ 'Y'                                       CRE001
      *                                                                   CRE001
     C                     EXSR CLMSG                                     CRE001
     C                     MOVEL'RES0034' MSGID                           CRE001
     C                     CALL 'ZA1310'  ZA1311                          CRE001
     C                     MOVELMNARR     NAR,37                          CRE001
     C                     MOVEL*BLANKS   MNARR                           CRE001
      *                                                                   CRE001
     C                     EXSR CLMSG                                     CRE001
     C                     MOVEL'RES0033' MSGID                           CRE001
     C                     CALL 'ZA1310'  ZA1311                          CRE001
     C                     MOVELMNARR     NAR,38                          CRE001
     C                     MOVEL*BLANKS   MNARR                           CRE001
      *                                                                   CRE001
     C                     EXSR CLMSG                                     CRE001
     C                     MOVEL'RES0037' MSGID                           CRE001
     C                     CALL 'ZA1310'  ZA1311                          CRE001
     C                     MOVELMNARR     NAR,39                          CRE001
     C                     MOVEL*BLANKS   MNARR                           CRE001
      *                                                                   CRE001
     C                     ENDIF                                          CRE001
      *                                                                   094337
     C/COPY WNCPYSRC,RE3761C012
     C                     ENDSR                           **MULTL ENDSR**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** ITYPCR subroutine for interest type greater than 2
     C**
     C**     Called by       CRSR, TOTSR
     C**
     C**     Calls           ZICD
     C**
     C           ITYPCR    BEGSR                           **ITYPCR BEGSR*
      *                                                                   182452
      **  Prepare subtotal output for every change in value date.         182452
      *                                                                   182452
     C           DRECI     IFNE 'M'                                       182452
     C                     Z-ADDDHISD     ZIEND                           182452
     C                     ELSE                                           182452
     C                     Z-ADDMHISD     ZIEND                           182452
     C                     ENDIF                                          182452
      *                                                                   182452
     C                     Z-ADDPVALD     ZIBEG                           182452
     C                     Z-ADDWCRCB     ZICALC                          182452
      *                                                                   182452
     C                     EXSR ZICD                                      182452
      *                                                                   182452
     C                     Z-ADDZDAYN1    DAYS                            182452
     C                     Z-ADDWHISB     HISB0                           182452
     C                     MOVE 'CR'      DCFLAG                          182452
     C           DAYS      IFNE 0                                         182452
     C                     MOVE *ON       *IN25                           182452
     C                     EXSR WST                        WRITE SUBTOTAL 182452
     C                     MOVE *OFF      *IN25                           182452
     C                     ENDIF                                          182452
     C*
     C**  CHECK IF END OF MONTH OR RATE CHANGE CREDIT
     C*
     C           DRECI     IFEQ 'M'                        - B1
     C           CSDAT     ANDNE*ZEROS
      *                                                                   182452
      ** Prepare the monthly subtotal.                                    182452
      *                                                                   182452
     C                     MOVE *ON       *IN26                           182452
      *                                                                   182452
      **  Transfer Midas date into DDMMMYY                                182452
      *                                                                   182452
     C                     Z-ADDMHISD     ZDAYNO                          182452
     C                     EXSR ZDATE2                                    182452
     C                     MOVE ZADATE    WMNTA                           182452
      *                                                                   182452
     C           RVALDC    IFGT WSMNT                                     182452
     C                     Z-ADDRVALDC    WSMNT                           182452
     C                     ENDIF                                          182452
     C*
     C**********           Z-ADDWHISD     ZIBEG                           182452
     C                     Z-ADDWSMNT     ZIBEG                           182452
     C                     Z-ADDMHISD     ZIEND
     C                     Z-ADDWCRCB     ZICALC
     C*
     C                     EXSR ZICD
     C*
     C                     Z-ADDZDAYN1    DAYS
     C                     Z-ADDMNBL      HISB0                           182452
     C           MNBL      MULT DAYS      NUMB0
     C*
     C           MNBL      IFGT *ZEROS                     - B2
     C                     Z-ADDDINT      INTD0
     C***********          EXSR OVERCR                                    085713
     C***********          WRITESTOTCR                                    085713
     C***********                                                         085713
     C**CHARGE*REPORT IF NECESSARY                                        085713
     C***********                                                         085713
     C***********CCICI     IFNE *BLANK                     - B4           085713
     C***********DTHGAR    IFNE *ZERO                      - B5           085713
     C***********DTHGAN    ORNE *ZERO                                     085713
     C***********          Z-ADDDTHGAR    CHGR0                           085713
     C***********          Z-ADDDTHGAN    CHGN0                           085713
     C***********          Z-ADDNITMS     SNITMS                          085713
     C***********          WRITEPOSTCH                                    085713
     C***********          END                             - E5           085713
     C***********          END                             - E4           085713
     C                     ELSE                            - X2
     C                     Z-SUBCINT      INTC0
     C                     ENDIF                                          085713
      *                                                                   085713
     C*******************  EXSR OVERCR                                    094431
     C*******************  WRITESTOTCR                                    094431
     C                     MOVE 'CR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C*
     C* CHARGE REPORT IF NECESSARY
     C*
     C                     EXSR PRN1CH                     chargesDetails1085713
     C***********CCICI     IFNE *BLANK                                    085713
     C***********DTHGAR    IFNE *ZERO                                     085713
     C***********DTHGAN    ORNE *ZERO                                     085713
     C***********          Z-ADDDTHGAR    CHGR0                           085713
     C***********          Z-ADDDTHGAN    CHGN0                           085713
     C***********          Z-ADDNITMS     SNITMS                          085713
     C***********          WRITEPOSTCH                                    085713
     C***********          END                                            085713
     C***********          END                                            085713
     C***********          END                             - E2           085713
     C*
     C                     Z-ADDMHISD     WHISD
     C                     Z-ADDMHISD     WSMNT                           182452
     C                     Z-ADDMNBL      WMNBL
     C*
     C                     MOVE *OFF      *IN26                           182452
      *                                                                   182452
     C                     END                             - E1
     C*
     C           DRECI     DOWEQ'M'                        - B1
     C           *IN51     ANDEQ'0'
     C*
     C           KLIST1    READEREHISL                   51
     C*
     C           *IN51     IFNE '1'                        - B2
     C*
     C           DRECI     IFEQ 'M'                        - B3
     C           CSDAT     ANDNE*ZEROS
      *                                                                   182452
      **  Transfer Midas date into DDMMMYY                                182452
      *                                                                   182452
     C                     Z-ADDMHISD     ZDAYNO                          182452
     C                     EXSR ZDATE2                                    182452
     C                     MOVE ZADATE    WMNTA                           182452
     C*
     C                     MOVE *ON       *IN26                           182452
     C**********           Z-ADDWHISD     ZIBEG                           182452
     C                     Z-ADDWSMNT     ZIBEG                           182452
     C                     Z-ADDMHISD     ZIEND
     C                     Z-ADDWCRCB     ZICALC
     C*
     C                     EXSR ZICD
     C*
     C                     Z-ADDZDAYN1    DAYS
     C           MNBL      MULT DAYS      NUMB0
     C*
     C           MNBL      IFGT *ZEROS                     - B4
     C                     Z-ADDDINT      INTD0
     C***********          EXSR OVERCR                                    085713
     C***********          WRITESTOTCR                                    085713
     C***********                                                         085713
     C**CHARGE*REPORT IF NECESSARY                                        085713
     C***********                                                         085713
     C***********CCICI     IFNE *BLANK                     - B4           085713
     C***********DTHGAR    IFNE *ZERO                      - B5           085713
     C***********DTHGAN    ORNE *ZERO                                     085713
     C***********          Z-ADDDTHGAR    CHGR0                           085713
     C***********          Z-ADDDTHGAN    CHGN0                           085713
     C***********          Z-ADDNITMS     SNITMS                          085713
     C***********          WRITEPOSTCH                                    085713
     C***********          END                             - E6           085713
     C***********          END                             - E5           085713
     C                     ELSE                            - X4
     C                     Z-SUBCINT      INTC0
     C                     ENDIF                                          085713
     C*******************  EXSR OVERCR                                    094431
     C*******************  WRITESTOTCR                                    094431
     C                     MOVE 'CR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C*
     C* CHARGE REPORT IF NECESSARY
     C*
     C                     EXSR PRN1CH                     chargesDetails1085713
     C***********CCICI     IFNE *BLANK                                    085713
     C***********DTHGAR    IFNE *ZERO                                     085713
     C***********DTHGAN    ORNE *ZERO                                     085713
     C***********          Z-ADDDTHGAR    CHGR0                           085713
     C***********          Z-ADDDTHGAN    CHGN0                           085713
     C***********          Z-ADDNITMS     SNITMS                          085713
     C***********          WRITEPOSTCH                                    085713
     C***********          END                                            085713
     C***********          END                                            085713
     C***********          END                             - E4           085713
     C*
     C                     Z-ADDMHISD     WHISD
     C                     Z-ADDMHISD     WSMNT                           182452
     C                     Z-ADDMNBL      WMNBL
     C                     MOVE *OFF      *IN26                           182452
     C*
     C                     ELSE                            - X3
     C*
     C           DRECI     IFEQ 'S'                        - B4
     C***********SCICI     ANDEQ'Y'                                      098818
     C           SCICI     ANDNE*BLANKS                                  098818
     C*
     C                     MOVE *ON       *IN25                           182452
     C**********           Z-ADDWHISD     ZIBEG                           182452
     C                     Z-ADDWSMNT     ZIBEG                           182452
     C                     Z-ADDDHISD     ZIEND
     C                     Z-ADDWCRCB     ZICALC
     C*
     C                     EXSR ZICD
     C*
     C                     Z-ADDZDAYN1    DAYS
     C           SMNBL     MULT DAYS      NUMB0
     C                     Z-ADDWHISB     HISB0                           182452
     C*
     C           SMNBL     IFGT *ZEROS                     - B5
     C                     Z-ADDDINT      INTD0
     C                     ELSE                            - X5
     C                     Z-SUBCINT      INTC0
     C*******************  EXSR OVERCR                                    094431
     C*******************  WRITESTOTCR                                    094431
     C                     MOVE 'CR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C*
     C* CHARGE REPORT IF NECESSARY
     C*
     C                     EXSR PRN1CH                     chargesDetails1085713
     C***********CCICI     IFNE *BLANK                     - B4           085713
     C***********DTHGAR    IFNE *ZERO                      - B5           085713
     C***********DTHGAN    ORNE *ZERO                                     085713
     C***********          Z-ADDDTHGAR    CHGR0                           085713
     C***********          Z-ADDDTHGAN    CHGN0                           085713
     C***********          Z-ADDNITMS     SNITMS                          085713
     C***********          WRITEPOSTCH                                    085713
     C***********          END                             - E5           085713
     C***********          END                             - E4           085713
     C                     END                             - E5
     C                     MOVE *OFF      *IN25                           182452
     C*
      ** If MHISD is less than HISD, print another subtotal.              182452
      *                                                                   182452
     C                     ELSE                                           182452
     C           MHISD     IFLT HISD                                      182452
     C                     Z-ADDWCRCB     ZICALC                          182452
     C                     Z-ADDMHISD     ZIBEG                           182452
     C                     Z-ADDHISD      ZIEND                           182452
     C                     EXSR ZICD                                      182452
     C                     Z-ADDZDAYN1    DAYS                            182452
     C                     Z-ADDWHISB     HISB0                           182452
     C                     MOVE *ON       *IN25                           182452
     C                     MOVE 'CR'      DCFLAG                          182452
     C                     EXSR WST                                       182452
     C                     MOVE *OFF      *IN25                           182452
     C                     ENDIF                                          182452
      *                                                                   182452
     C                     Z-ADDDHISD     WHISD
     C*
     C                     END                             - E4
     C*
     C                     END                             - E3
     C*
     C                     END                             - E2
     C*
     C                     END                             - E1
     C*
     C                     ENDSR                           **ITYPCR ENDSR*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** ITYPDR subroutine for interest type greater than 2
     C**
     C**     Called by       DRSR; TOTSR
     C**
     C**     Calls           ZICD
     C**
     C           ITYPDR    BEGSR                           **ITYPDR BEGSR*
      *                                                                   182452
      **  Prepare subtotal output for every change in value date.         182452
      *                                                                   182452
     C           DRECI     IFNE 'M'                                       182452
     C                     Z-ADDDHISD     ZIEND                           182452
     C                     ELSE                                           182452
     C                     Z-ADDMHISD     ZIEND                           182452
     C                     ENDIF                                          182452
      *                                                                   182452
     C                     Z-ADDPVALD     ZIBEG                           182452
     C                     Z-ADDWCRCB     ZICALC                          182452
      *                                                                   182452
     C                     EXSR ZICD                                      182452
      *                                                                   182452
     C                     Z-ADDZDAYN1    DAYS                            182452
     C                     Z-ADDWHISB     HISB0                           182452
     C                     MOVE 'DR'      DCFLAG                          182452
     C           DAYS      IFNE 0                                         182452
     C                     MOVE *ON       *IN25                           182452
     C                     EXSR WST                        WRITE SUBTOTAL 182452
     C                     MOVE *OFF      *IN25                           182452
     C                     ENDIF                                          182452
     C*
     C**  CHECK IF END OF MONTH OR DEBIT RATE CHANGE
     C*
     C           DRECI     IFEQ 'M'                        - B1
     C           DSDAT     ANDNE*ZEROS
      *                                                                   182452
      ** Prepare the monthly subtotal.                                    182452
      *                                                                   182452
     C                     MOVE *ON       *IN26                           182452
      *                                                                   182452
      **  Transfer Midas date into DDMMMYY                                182452
      *                                                                   182452
     C                     Z-ADDMHISD     ZDAYNO                          182452
     C                     EXSR ZDATE2                                    182452
     C                     MOVE ZADATE    WMNTA                           182452
      *                                                                   182452
     C           RVALDD    IFGT WSMNT                                     182452
     C                     Z-ADDRVALDD    WSMNT                           182452
     C                     ENDIF                                          182452
     C*
     C**********           Z-ADDWHISD     ZIBEG                           182452
     C                     Z-ADDWSMNT     ZIBEG                           182452
     C                     Z-ADDMHISD     ZIEND
     C                     Z-ADDWDRCB     ZICALC
     C*
     C                     EXSR ZICD
     C*
     C                     Z-ADDZDAYN1    DAYS
     C           MNBL      MULT DAYS      NUMB0
     C                     Z-ADDMNBL      HISB0                           182452
     C*
     C           MNBL      IFGT *ZEROS                     - B2
     C                     Z-ADDDINT      INTD0
     C                     ELSE                            - X2
     C                     Z-SUBCINT      INTC0
     C*******************  EXSR OVERDR                                    094431
     C*******************  WRITESTOTDR                                    094431
     C                     MOVE 'DR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C*
     C* CHARGE REPORT IF NECESSARY
     C*
     C                     EXSR PRN1CH                     chargesDetails1085713
     C***********CCICI     IFNE *BLANK                                    085713
     C***********DTHGAR    IFNE *ZERO                                     085713
     C***********DTHGAN    ORNE *ZERO                                     085713
     C***********          Z-ADDDTHGAR    CHGR0                           085713
     C***********          Z-ADDDTHGAN    CHGN0                           085713
     C***********          Z-ADDNITMS     SNITMS                          085713
     C***********          WRITEPOSTCH                                    085713
     C***********          END                                            085713
     C***********          END                                            085713
     C                     END                             - E2
     C*
     C                     Z-ADDMHISD     WHISD
     C                     Z-ADDMHISD     WSMNT                           182452
     C                     Z-ADDMNBL      WMNBL
     C                     MOVE *OFF      *IN26                           182452
     C*
     C                     END                             - E1
     C*
     C           DRECI     DOWEQ'M'                        - B1
     C           *IN51     ANDEQ'0'
     C*
     C           KLIST1    READEREHISL                   51
     C*
     C           *IN51     IFNE '1'                        - B2
     C*
     C           DRECI     IFEQ 'M'                        - B3
     C           DSDAT     ANDNE*ZEROS
      *                                                                   182452
      **  Transfer Midas date into DDMMMYY                                182452
      *                                                                   182452
     C                     Z-ADDMHISD     ZDAYNO                          182452
     C                     EXSR ZDATE2                                    182452
     C                     MOVE ZADATE    WMNTA                           182452
     C*
     C                     MOVE *ON       *IN26                           182452
     C**********           Z-ADDWHISD     ZIBEG                           182452
     C                     Z-ADDWSMNT     ZIBEG                           182452
     C                     Z-ADDMHISD     ZIEND
     C                     Z-ADDWDRCB     ZICALC
     C*
     C                     EXSR ZICD
     C*
     C                     Z-ADDZDAYN1    DAYS
     C                     Z-ADDMNBL      HISB0                           182452
     C           MNBL      MULT DAYS      NUMB0
     C*
     C           MNBL      IFGT *ZEROS                     - B4
     C                     Z-ADDDINT      INTD0
     C***********          EXSR OVERDR                                    085713
     C***********          WRITESTOTDR                                    085713
     C***********                                                         085713
     C**CHARGE*REPORT IF NECESSARY                                        085713
     C***********                                                         085713
     C***********CCICI     IFNE *BLANK                                    085713
     C***********DTHGAR    IFNE *ZERO                                     085713
     C***********DTHGAN    ORNE *ZERO                                     085713
     C***********          Z-ADDDTHGAR    CHGR0                           085713
     C***********          Z-ADDDTHGAN    CHGN0                           085713
     C***********          Z-ADDNITMS     SNITMS                          085713
     C***********          WRITEPOSTCH                                    085713
     C***********          END                                            085713
     C***********          END                                            085713
     C                     ELSE                            - X4
     C                     Z-SUBCINT      INTC0
     C                     ENDIF                                          085713
      *                                                                   085713
     C*******************  EXSR OVERDR                                    094431
     C*******************  WRITESTOTDR                                    094431
     C                     MOVE 'DR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     MOVE *OFF      *IN26                           182452
     C*
     C* CHARGE REPORT IF NECESSARY
     C*
     C                     EXSR PRN1CH                     chargesDetails1085713
     C***********CCICI     IFNE *BLANK                                    085713
     C***********DTHGAR    IFNE *ZERO                                     085713
     C***********DTHGAN    ORNE *ZERO                                     085713
     C***********          Z-ADDDTHGAR    CHGR0                           085713
     C***********          Z-ADDDTHGAN    CHGN0                           085713
     C***********          Z-ADDNITMS     SNITMS                          085713
     C***********          WRITEPOSTCH                                    085713
     C***********          END                                            085713
     C***********          END                                            085713
     C***********          END                             - E4           085713
     C*
     C                     Z-ADDMHISD     WHISD
     C                     Z-ADDMHISD     WSMNT                           182452
     C                     Z-ADDMNBL      WMNBL
     C*
     C                     ELSE                            - X3
     C*
     C           DRECI     IFEQ 'S'                        - B4
     C***********SDICI     ANDEQ'Y'                                      098818
     C           SDICI     ANDNE*BLANKS                                  098818
     C                     MOVE *ON       *IN25                           182452
     C*
     C                     Z-ADDWHISD     ZIBEG
     C                     Z-ADDDHISD     ZIEND
     C                     Z-ADDWDRCB     ZICALC
     C*
     C                     EXSR ZICD
     C*
     C                     Z-ADDZDAYN1    DAYS
     C           SMNBL     MULT DAYS      NUMB0
     C*
     C           SMNBL     IFGT *ZEROS                     - B5
     C                     Z-ADDDINT      INTD0
     C***********          EXSR OVERDR                                    085713
     C***********          WRITESTOTDR                                    085713
     C***********                                                         085713
     C**CHARGE*REPORT IF NECESSARY                                        085713
     C***********                                                         085713
     C***********CCICI     IFNE *BLANK                     - B4           085713
     C***********DTHGAR    IFNE *ZERO                      - B5           085713
     C***********DTHGAN    ORNE *ZERO                                     085713
     C***********          Z-ADDDTHGAR    CHGR0                           085713
     C***********          Z-ADDDTHGAN    CHGN0                           085713
     C***********          Z-ADDNITMS     SNITMS                          085713
     C***********          WRITEPOSTCH                                    085713
     C***********          END                             - E5           085713
     C***********          END                             - E4           085713
     C                     ELSE                            - X5
     C                     Z-SUBCINT      INTC0
     C                     ENDIF                                          085713
      *                                                                   085713
     C*******************  EXSR OVERDR                                    094431
     C*******************  WRITESTOTDR                                    094431
     C                     MOVE 'DR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C                     MOVE *OFF      *IN25                           182452
     C*
     C* CHARGE REPORT IF NECESSARY
     C*
     C                     EXSR PRN1CH                     chargesDetails1085713
     C***********CCICI     IFNE *BLANK                     - B4           085713
     C***********DTHGAR    IFNE *ZERO                      - B5           085713
     C***********DTHGAN    ORNE *ZERO                                     085713
     C***********          Z-ADDDTHGAR    CHGR0                           085713
     C***********          Z-ADDDTHGAN    CHGN0                           085713
     C***********          Z-ADDNITMS     SNITMS                          085713
     C***********          WRITEPOSTCH                                    085713
     C***********          END                             - E7           085713
     C***********          END                             - E6           085713
     C***********          END                             - E5           085713
     C*
     C                     Z-ADDDHISD     WHISD
     C*
     C                     END                             - E4
     C*
     C                     END                             - E3
     C*
     C                     END                             - E2
     C*
     C                     END                             - E1
     C*
     C                     ENDSR                           **ITYPDR ENDSR*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** MAIN subroutine to execute main processing.
     C**
     C**     Called by       S T A R T
     C**
     C**     Calls           DETPR
     C**
     C           MAIN      BEGSR                           **MAIN BEGSR**
     C           *INLR     IFEQ '1'
     C                     GOTO END
     C                     END
     C*
     C** ACCESS RECAPM SEQUENTIALY
     C*
     C/COPY WNCPYSRC,REH00373
     C                     READ RECAPML                  LR
     C/COPY WNCPYSRC,REH00370
     C*
     C**  Call ZSFILE for initial OPEN
     C*
     C           *INLR     IFNE '1'
     C                     SETON                     79
     C                     OPEN RE3764CR
     C***********          MOVE *ON       *IN75      Overflow on.   085713094337
     C                     Z-ADDSFNUM     ZSNUM
     C                     OUT  LDA
     C                     CALL 'ZSFILE'
     C                     PARM           SEQ
     C                     PARM CBRCA     SENTY
     C                     PARM           SFILE
     C                     PARM           ZSNUM   60
     C                     PARM           ZSERR   1
     C           *LOCK     IN   LDA
     C*
     C           ZSERR     IFEQ 'Y'
     C** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM
     C** DBASE, DBFILE AND DBKEY SET WITHIN ZSFILE                        LN0112
     C                     MOVEA'1'       *IN,89                          LN0112
     C                     EXSR DBSR                                      LN0112
     C*********************SETON                     U7U8LR               LN0112
     C                     RETRN
     C                     END
     C*
     C                     OPEN RE3764DR
     C***********          MOVE *ON       *IN73      Overflow on.   085713094337
     C                     Z-ADDSFNUM1    ZSNUM1
     C                     OUT  LDA
     C                     CALL 'ZSFILE'
     C                     PARM           SEQ
     C                     PARM CBRCA     SENTY
     C                     PARM           SFILE1
     C                     PARM           ZSNUM1  60
     C                     PARM           ZSERR   1
     C           *LOCK     IN   LDA
     C*
     C           ZSERR     IFEQ 'Y'
     C** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM
     C** DBASE, DBFILE AND DBKEY SET WITHIN ZSFILE                        LN0112
     C                     MOVEA'1'       *IN,89                          LN0112
     C                     EXSR DBSR                                      LN0112
     C*********************SETON                     U7U8LR               LN0112
     C                     RETRN
     C                     END
     C*
     C                     OPEN RE3765CH
     C**********           MOVE *ON       *IN74       Overflow on. 085713 125176
     C                     Z-ADDSFNUM2    ZSNUM2
     C                     OUT  LDA
     C                     CALL 'ZSFILE'
     C                     PARM           SEQ
     C                     PARM CBRCA     SENTY
     C                     PARM           SFILE2
     C                     PARM           ZSNUM2  60
     C                     PARM           ZSERR   1
     C           *LOCK     IN   LDA
     C*
     C           ZSERR     IFEQ 'Y'
     C** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM
     C** DBASE, DBFILE AND DBKEY SET WITHIN ZSFILE                        LN0112
     C                     MOVEA'1'       *IN,89                          LN0112
     C                     EXSR DBSR                                      LN0112
     C*********************SETON                     U7U8LR               LN0112
     C                     RETRN
     C                     END
     C*
     C                     END
     C**
     C*
     C**  SAVE KEY TO CHECK BREAK
     C*
     C                     MOVE RKEY      OKEY
     C*
     C**  EXECUTE UNTIL EOF RECAPM
     C*
     C           *INLR     DOWEQ'0'                        - B1
     C/COPY WNCPYSRC,RE3761C026
     C*
     C**  TEST FOR MULTIBRANCH OUTPUT
     C*
     C           OBRCA     IFNE CBRCA
     C                     CLOSERE3764CR
     C                     CLOSERE3764DR
     C                     CLOSERE3765CH
     C/COPY WNCPYSRC,RE3761C021
     C                     SETON                     79
     C                     OPEN RE3764CR
     C***********          MOVE *ON       *IN75      Overflow on.   085713094337
     C                     Z-ADD1         PAGC
     C                     Z-ADDSFNUM     ZSNUM
     C                     OUT  LDA
     C                     CALL 'ZSFILE'
     C                     PARM           SEQ
     C                     PARM CBRCA     SENTY
     C                     PARM           SFILE
     C                     PARM           ZSNUM   60
     C                     PARM           ZSERR   1
     C           *LOCK     IN   LDA
     C*
     C           ZSERR     IFEQ 'Y'
     C** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM
     C** DBASE, DBFILE AND DBKEY SET WITHIN ZSFILE                        LN0112
     C                     MOVEA'1'       *IN,89                          LN0112
     C                     EXSR DBSR                                      LN0112
     C*********************SETON                     U7U8LR               LN0112
     C                     RETRN
     C                     END
     C*
     C                     OPEN RE3764DR
     C***********          MOVE *ON       *IN73      Overflow on.   085713094337
     C                     Z-ADD1         PAGD
     C                     Z-ADDSFNUM1    ZSNUM1
     C                     OUT  LDA
     C                     CALL 'ZSFILE'
     C                     PARM           SEQ
     C                     PARM CBRCA     SENTY
     C                     PARM           SFILE1
     C                     PARM           ZSNUM1  60
     C                     PARM           ZSERR   1
     C           *LOCK     IN   LDA
     C*
     C           ZSERR     IFEQ 'Y'
     C** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM
     C** DBASE, DBFILE AND DBKEY SET WITHIN ZSFILE                        LN0112
     C                     MOVEA'1'       *IN,89                          LN0112
     C                     EXSR DBSR                                      LN0112
     C*********************SETON                     U7U8LR               LN0112
     C                     RETRN
     C                     END
     C*
     C                     OPEN RE3765CH
     C**********           MOVE *ON       *IN74       Overflow on. 085713 125176
     C                     Z-ADD1         PAGN
     C                     Z-ADDSFNUM2    ZSNUM2
     C                     OUT  LDA
     C                     CALL 'ZSFILE'
     C                     PARM           SEQ
     C                     PARM CBRCA     SENTY
     C                     PARM           SFILE2
     C                     PARM           ZSNUM2  60
     C                     PARM           ZSERR   1
     C           *LOCK     IN   LDA
     C*
     C           ZSERR     IFEQ 'Y'
     C** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM
     C** DBASE, DBFILE AND DBKEY SET WITHIN ZSFILE                        LN0112
     C                     MOVEA'1'       *IN,89                          LN0112
     C                     EXSR DBSR                                      LN0112
     C*********************SETON                     U7U8LR               LN0112
     C                     RETRN
     C                     END
     C**
     C*    ACCESS BRANCH DETAILS
     C**
     C** GET BRANCH NAME, ONLY WHEN MBIN = 'Y'
     C**
     C           MBIN      IFEQ 'Y'
     C*
     C**********           CALL 'AOBRCHR0'                                                    CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM CBRCA     @DSNB   3
     C**********           PARM           SDBRCH                                              CGL029
     C                     PARM           DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS
     C                     MOVEL@DSNB     DBKEY
     C                     MOVEL'SDBRCHPD'DBFILE           ***************
     C                     Z-ADD20        DBASE            **DB ERROR 20**
     C*********************SETON                     U7U8LR***************LN0112
     C                     EXSR DBSR                       ***************LN0112
     C                     EXSR *PSSR
     C                     END
     C*
     C                     END
     C*
     C***U8******          GOTO END                                       105294
     C                     END
     C*
     C                     EXSR PRNO
     C           PRYES     IFEQ 'Y'                        - B2
     C*
     C**  CHECK IF IT IS THE SAME ACCOUNT
     C*
     C           RKEY      IFNE OKEY                       - B3
     C                     Z-ADD1         PAGD
     C                     Z-ADD1         PAGC
     C                     Z-ADD1         PAGN
     C                     MOVE RKEY      OKEY
     C*****************************************************************
     C** Multilanguage processing is currently not in use.
     C** Codings are asterisked but retained for future incorp.
     C*
     C** PROCESS FOR MULTILANGUAGE
     C*
     C***********LGID      IFEQ *BLANKS                    - B4
     C***********LGID      OREQ '00'
     C***********          MOVE DLGID     LGID
     C***********          END                             - E4
     C***********
     C***********LGID      IFNE OLGID                      - B4
     C*
     C*
     C**  DEFINE MESSAGE FILE
     C*
     C                     MOVE CMD,1     CMD1
     C***********          MOVELOLGID     FILT1
     C***********          MOVELLGID      FILT2
     C***********          CALL 'QCMDEXC'
     C***********          PARM           CMD1
     C***********          PARM           MSGLEN
     C*
     C***********          MOVE LGID      OLGID
     C***********          EXSR MULTL
     C*
     C***********          END                             - E4
     C*****************************************************************
     C*
     C                     END                             - E3
     C*
     C/COPY WNCPYSRC,RE3761C049
     C                     EXSR DETPR
     C***********          SETOF                     U7U8                 105294
     C*
     C** NUMBER OF PROCESSED RECORDS
     C*
     C                     ADD  1         NBRREC
     C/COPY WNCPYSRC,RE3761C050
     C*
     C                     END                             - E2
     C*
     C* RESET OVERFLOW INDICATOR AT CHANGE OF ACCOUNT
     C*
     C**********           MOVEA'00'      *IN,73                          125176
     C                     MOVEA'000'     *IN,73                          125176
     C                     MOVE '0'       *IN51
     C                     Z-ADD*ZEROS    WDAID
     C                     Z-ADD*ZEROS    WCAID
     C/COPY WNCPYSRC,REH00374
     C                     READ RECAPML                  LR
     C/COPY WNCPYSRC,REH00371
     C                     END                             - E1
     C*
     C           END       TAG
     C                     ENDSR                           **MAIN ENDSR**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** PRNO   subroutine TO DECIDE IF RECORD TO PRINT OR NO
     C**
     C**
     C**     Called by       START
     C**
     C**     Calls           -
     C**
     C           PRNO      BEGSR                           **PRNO   BEGSR*
     C*
     C                     MOVE 'N'       PRYES
     C                     MOVE '0'       *IN70
     C*
     C*  FOR MANAGEMENT OR DEMAND PRINT
     C*
     C           CDICI     IFEQ 'M'                        - B1
     C           CCICI     OREQ 'M'
     C           CDICI     OREQ 'D'
     C           CCICI     OREQ 'D'
     C                     MOVE 'Y'       PRYES   1
     C                     END                             - E1
     C           CDICI     IFEQ 'M'                        - B1
     C           CCICI     OREQ 'M'
     C                     MOVE '1'       *IN70
     C/COPY WNCPYSRC,RE3761C019
     C                     END                             - E1
     C*
     C*  ACCESS RECOM FOR COMMISSION DETAILS
     C*
     C           KLIST0    CHAINRECOM                99
     C           *IN99     IFEQ '1'                        ***************
     C                     Z-ADD21        DBASE            **DB ERROR 21**
     C                     MOVE 'RECOM  ' DBFILE           ***************
     C                     MOVELRKEY      DBKEY
     C                     EXSR DBSR
     C                     END
     C           CDICI     IFEQ 'C'
     C           CDICI     OREQ ' '
     C                     Z-ADD*ZERO     FXDC
     C                     END
     C           CDICA     SUB  CCDIC     CDICA
     C           ACCC      SUB  CACCC     ACCC
     C           CHDBC     SUB  CCHDBC    CHDBC
     C           CMBC      SUB  CCMBC     CMBC
     C*
     C*  IF CAPITALISATION OCCURS AT LEAST ONE AMOUNT MUST BE DIFFERENT
     C*  OF ZERO TO BE PRINTED.
     C*
     C           CDICI     IFNE ' '                        - B1
     C           CDAIC     IFNE *ZERO                      - B2
     C           CPMADI    ORNE *ZERO
     C           CTMADI    ORNE *ZERO
     C           CDMINT    ORNE *ZERO
     C           CSGADI    ORNE *ZERO
     C           FXDC      ORNE *ZERO
     C           ACCC      ORNE *ZERO
     C           CHDBC     ORNE *ZERO
     C           CMBC      ORNE *ZERO
     C           CDICA     ORNE *ZERO
     C                     MOVE 'Y'       PRYES   1
     C                     END                             - E2
     C                     END                             - E1
     C*
     C           CCICI     IFNE ' '                        - B1
     C           CCAIC     IFNE *ZERO
     C           CPMACI    ORNE *ZERO
     C           CTMACI    ORNE *ZERO
     C           CCMINT    ORNE *ZERO
     C           CSGACI    ORNE *ZERO
     C           CCHGP     ORNE *ZERO
     C                     MOVE 'Y'       PRYES   1
     C                     END                             - E2
     C                     END                             - E1
     C*
     C** ALWAYS PRINTED
     C*
     C                     MOVE 'Y'       PRYES   1
     C                     ENDSR                           **NOPR   ENDSR*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** OPENCR subroutine for credit output - opening balance and
     C**                                       opening rate
     C**
     C**     Called by       B1LT, B1GT
     C**
     C**     Calls           DBSR
     C**
     C           OPENCR    BEGSR                           **OPENCR BEGSR*
     C*
     C                     Z-ADDCOHISB    HISB0
     C                     Z-ADDCOHISB    WHISBC                          094337
     C*
     C                     EXSR CLMSG
     C                     MOVELNAR,16    TNARR
     C*
     C           PVALD     IFNE CLCID                      - B1
     C                     Z-ADDCLCID     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALDO
     C*
     C                     Z-ADDCLCID     PVALD
     C*
     C                     END                             - E1
     C*
     C                     MOVE VALDO     VALDA
     C*
     C**  OUTPUT OPENING BALANCE
     C*
     C                     EXSR OVERCR
     C                     WRITETITLECR
     C*
     C                     MOVE *BLANKS   VALDA
     C                     MOVE *BLANKS   PSTDA
     C*
     C                     EXSR CLMSG
     C                     MOVELNAR,8     RNARR
     C*
      *                                                                   094337
      **  ACCESS REHRDJ (REHPOSR1 REHPOSR2 REHPOSR3) WHICH CONTAINS       094337
      **  THE GOOD DATES FOR DEBIT RATE CHANGE TO                         094337
      *                                                                   094337
     C           KLIST3    SETLLREHRCJ                                    094337
     C           KLIST1    REDPEREHRCJ                   60               094337
      *                                                                   094337
     C           *IN60     IFEQ '1'                        - B1           094337
     C           BDATE     ANDEQCLCID                      - B1           094337
     C           KLIST3    SETLLREHRCJ                                    094337
     C           KLIST3    READEREHRCJ                   60               094337
     C                     END                                            094337
      *                                                                   094337
     C           *IN60     IFEQ '1'                        - B1           094337
     C                     Z-ADD*ZEROS    CRIR                            094337
     C                     Z-ADD*ZEROS    INTP                            125176
     C                     Z-ADD*ZEROS    INST                            125176
     C                     Z-ADD*ZEROS    INRT                            125176
     C                     END                             - E1           094337
      *                                                                   094337
     C                     EXSR CLMSG                                     094337
     C                     MOVELNAR,8     RNARR                           094337
      *                                                                   094337
     C                     MOVE *BLANKS   PSTDA                           094337
     C                     MOVE *BLANKS   VALDA                           094337
      *                                                                   094337
      **  OUTPUT CREDIT RATE CHANGE TO                                    094337
      *                                                                   094337
      *   CHANGE NARRAT. 'RATE CHANGE TO' TO 'OPENING RATE'               094337
     C                     MOVE 'Y'       OPN     1                       094337
     C                     EXSR RCRSR                                     094337
     C                     MOVE ' '       OPN     1                       094337
     C***********          Z-ADDWWCRIR    RATE                            094337
     C*
     C**  OUTPUT OPENING RATE
     C*
     C***********          EXSR OVERCR                                    094337
     C***********          WRITERATECR                                    094337
     C*
     C                     ENDSR                           **OPENCR ENDSR*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** OPENDR subroutine for debit output - opening balance and
     C**                                      opening rate
     C**
     C**     Called by       B1LT, B1GT
     C**
     C**     Calls           DBSR
     C**
     C           OPENDR    BEGSR                           **OPENDR BEGSR*
     C*
     C                     Z-ADDDOHISB    HISB0
     C                     Z-ADDDOHISB    WHISBD                          094337
     C*
     C                     EXSR CLMSG
     C                     MOVELNAR,15    TNARR
     C*
     C           PVALD     IFNE CLDID                      - B1
     C                     Z-ADDCLDID     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALDO
     C*
     C                     Z-ADDCLDID     PVALD
     C*
     C                     END                             - E1
     C*
     C                     MOVE VALDO     VALDA
     C*
     C**  OUTPUT OPENING BALANCE
     C*
     C                     EXSR OVERDR
     C                     WRITETITLEDR
     C*
     C                     MOVE *BLANKS   VALDA
     C                     MOVE *BLANKS   PSTDA
     C*
     C                     EXSR CLMSG
     C                     MOVELNAR,3     RNARR
     C*
      *                                                                   094337
      **  ACCESS REHRDJ (REHPOSR1 REHPOSR2 REHPOSR3) WHICH CONTAINS       094337
      **  THE GOOD DATES FOR DEBIT RATE CHANGE TO                         094337
      *                                                                   094337
     C           KLIST2    SETLLREHRDJ                                    094337
     C           KLIST1    REDPEREHRDJ                   60               094337
      *                                                                   094337
     C           *IN60     IFEQ '1'                        - B1           094337
     C           BDATE     ANDEQCLDID                      - B1           094337
     C           KLIST2    SETLLREHRDJ                                    094337
     C           KLIST2    READEREHRDJ                   60               094337
     C                     END                                            094337
      *                                                                   094337
     C           *IN60     IFEQ '1'                        - B1           094337
     C                     Z-ADD*ZEROS    DRIR                            094337
     C                     Z-ADD*ZEROS    INTP                            125176
     C                     Z-ADD*ZEROS    INST                            125176
     C                     Z-ADD*ZEROS    INRT                            125176
     C                     END                             - E1           094337
      *                                                                   094337
     C                     EXSR CLMSG                                     094337
     C                     MOVELNAR,3     RNARR                           094337
      *                                                                   094337
     C                     MOVE *BLANKS   PSTDA                           094337
     C                     MOVE *BLANKS   VALDA                           094337
      *                                                                   094337
      **  OUTPUT CREDIT RATE CHANGE TO                                    094337
      *                                                                   094337
      *   CHANGE NARRAT. 'RATE CHANGE TO' TO 'OPENING RATE'               094337
     C                     MOVE 'Y'       OPN     1                       094337
     C                     EXSR RDRSR                                     094337
     C                     MOVE ' '       OPN     1                       094337
     C***********          Z-ADDDRIR      RATE                            094337
     C*
     C**  OUTPUT OPENING RATE
     C*
     C***********          EXSR OVERDR                                    094337
     C***********          WRITERATEDR                                    094337
     C*
      ** If CRE001 is switched ON, then output 'Overdraft Limit'          CRE001
      *                                                                   CRE001
     C           CRE001    IFEQ 'Y'                                       CRE001
     C                     EXSR CLMSG                                     CRE001
     C                     MOVELNAR,38    ONARR                           CRE001
     C                     MOVE ODRL      OODRL                           CRE001
     C                     EXSR OVERDR                                    CRE001
     C                     WRITEODLNDC                                    CRE001
     C                     ENDIF                                          CRE001
      *                                                                   CRE001
     C                     ENDSR                           **OPENDR ENDSR*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** OVERDR subroutine for processing overflow on RE3764DR
     C**
     C**     Called by       CRSR, DRSR.
     C**
     C**     Calls           -
     C**
     C           OVERDR    BEGSR                           **OVERDR BEGSR*
     C/COPY WNCPYSRC,RE3761C023
     C*
     C**  CHECK IF OVERFLOW ON RE3764DR
     C*
     C           *IN73     IFEQ '1'                        - B1
     C                     ADD  1         PAGD
     C                     MOVE WACNO     ACNO
     C                     MOVE '0'       *IN65
     C           ACNO      IFNE *ZEROS
     C                     MOVE '1'       *IN65
     C                     END
     C                     WRITEHEADDR
     C                     MOVE '0'       *IN73
     C                     END                             - E1
      *                                                                   085713
     C                     ENDSR                           **OVERDR ENDSR*085713
      ********************************************************************085713
     C/EJECT
      ********************************************************************
      **                                                                  085713
      ** PRN1CH subroutine for processing details  on RE3765CH            085713
      **                                                                  085713
      **     Called by       CRSR, DRSR                                   085713
      **                                                                  085713
      **     Calls           -    OVERCH                                  085713
      **                                                                  085713
     C           PRN1CH    BEGSR                                          085713
      *                                                                   085713
      * Charge report if necessary                                        085713
     C           CHGT      IFNE 0                          CreditsCaptlsd 085713
     C           CCICI     ANDNE*BLANK                     CreditsCaptlsd 085713
      *                                                                   085713
     C           DTHGAR    IFNE *ZERO                      rebateableChg  085713
     C           DTHGAN    ORNE *ZERO                      non-rebatblChg 085713
     C                     Z-ADDDTHGAR    CHGR0                           085713
     C                     Z-ADDDTHGAN    CHGN0                           085713
     C                     Z-ADDNITMS     SNITMS                          085713
     C                     EXSR OVERCH                     ChargesOverflow085713
     C                     WRITEPOSTCH                     ChargesDetail  085713
     C                     ENDIF                                          085713
     C                     ENDIF                                          085713
      *                                                                   085713
     C                     ENDSR                                          085713
      ********************************************************************085713
      **                                                                  085713
      ** PRN2CH subroutine for processing details  on RE3765CH            085713
      **                                                                  085713
      **     Called by       CRSR, DRSR                                   085713
      **                                                                  085713
      **     Calls           -    OVERCH                                  085713
      **                                                                  085713
     C           PRN2CH    BEGSR                                          085713
      *                                                                   085713
      * Charge report if necessary                                        085713
     C           CHGT      IFNE 0                          CreditsCaptlsd 085713
     C           CCICI     ANDNE*BLANK                     CreditsCaptlsd 085713
     C           CHGA      ANDNE*ZERO
      *                                                                   085713
     C           REBI      IFEQ 'Y'                                       085713
     C                     Z-ADDCHGA      CHGR0                           085713
     C                     Z-ADD*ZERO     CHGN0                           085713
     C                     ADD  CHGA      TCHR0                           094337
     C                     ELSE                                           085713
     C                     Z-ADDCHGA      CHGN0                           085713
     C                     Z-ADD*ZERO     CHGR0                           085713
     C                     ADD  CHGA      TCHN0                           094337
     C                     ENDIF                                          085713
      *                                                                   085713
     C                     Z-ADDNITMS     SNITMS                          085713
     C                     EXSR OVERCH                     ChargesOverflow085713
     C                     WRITEPOSTCH                     ChargesDetail  085713
     C                     ENDIF                                          085713
      *                                                                   085713
     C                     ENDSR                                          085713
      ********************************************************************085713
      **                                                                  085713
      ** OVERCH subroutine for processing overflow on RE3765CH            085713
      **                                                                  085713
      **     Called by       PRN1CH PRN2CH                                085713
      **                                                                  085713
      **     Calls           -                                            085713
      **                                                                  085713
     C           OVERCH    BEGSR                                          085713
     C*
     C* CHARGE REPORT IF NECESSARY
     C*
     C           *IN74     IFEQ '1'                        - B1
     C           CHGT      ANDNE0                          Charges applied085713
     C           CCICI     ANDNE*BLANK                     Credits captlsd085713
     C***********CCICI     IFNE *BLANK                                    085713
     C***********CCHGP     ANDNE*ZERO                                     085713
     C                     ADD  1         PAGN
     C                     WRITEHEADCH
     C***********          MOVE '0'       *IN74                           085713
     C                     MOVE '0'       *IN74                           125176
     C                     END
     C***********          END                             - E1           085713
     C*
     C                     ENDSR
     C*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** OVERCR subroutine for processing overflow on RE3764CR
     C**
     C**     Called by       CRSR, DRSR
     C**
     C**     Calls           -
     C**
     C           OVERCR    BEGSR                           **OVERCR BEGSR*
     C/COPY WNCPYSRC,RE3761C024
     C*
     C**  CHECK IF OVERFLOW ON RE3764CR
     C*
     C           *IN75     IFEQ '1'                        - B1
     C                     ADD  1         PAGC
     C                     MOVE WACNO     ACNO
     C                     MOVE '0'       *IN65
     C           ACNO      IFNE *ZEROS
     C                     MOVE '1'       *IN65
     C                     END
     C                     WRITEHEADCR
     C                     MOVE '0'       *IN75
     C                     END                             - E1
     C*
     C**CHARGE*REPORT IF NECESSARY                                        085713
     C***********                                                         085713
     C************IN74     IFEQ '1'                        - B1           085713
     C***********CCICI     IFNE *BLANK                                    085713
     C***********CCHGP     ANDNE*ZERO                                     085713
     C***********          ADD  1         PAGN                            085713
     C***********          WRITEHEADCH                                    085713
     C***********          MOVE '0'       *IN74                           085713
     C***********          END                                            085713
     C***********          END                             - E1           085713
     C*
     C                     ENDSR                           **OVERCR ENDSR*
     C/COPY WNCPYSRC,RE3761C025
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** RATEC subroutine to prepare and output credit rate change
     C**
     C**     Called by       CRSR, RATESR
     C**
     C**     Calls           DBSR, RCRSR
     C**
     C           RATEC     BEGSR                           **RATEC BEGSR**
     C*
     C**  ACCESS REHRCJ (REHPOSR1 REHPOSR2 REHPOSR3) WHICH CONTAINS
     C**  THE GOOD DATES FOR CREDIT RATE CHANGE TO
     C*
     C***********KLIST6    CHAINREHRCJ               60               64051
     C           KLIST6    SETLLREHRCJ                   60           64051
     C*                                                               64051
     C           KLIST6    READEREHRCJ                   60              64051
     C*
     C           *IN60     IFEQ '1'                        - B1
     C                     Z-ADDDCRCD     WDATE
     C                     Z-ADD22        DBASE
     C                     MOVE 'REHRCJ'  DBFILE           ***************
     C                     MOVELRKEY2     DBKEY            **DB ERROR 22**
     C                     MOVEA'1'       *IN,89           ***************
     C                     EXSR DBSR
     C                     END                             - E1
     C*
     C**  TRANSFER DATE MIDAS INTO DDMMMYY
     C*
     C           PVALD     IFNE RVALD                      - B1
     C                     Z-ADDRVALD     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALDO
     C*
     C                     Z-ADDRVALD     PVALD
     C*
     C                     END                             - E1
      *                                                                   182452
      ** Save rate change value date.                                     182452
      *                                                                   182452
     C                     Z-ADDRVALD     RVALDC  50                      182452
     C*
     C**  TRANSFER DATE MIDAS INTO DDMMMYY
     C*
     C           PPSTD     IFNE RPSTD                      - B1
     C                     Z-ADDRPSTD     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    PSTDO
     C*
     C                     Z-ADDRPSTD     PPSTD
     C*
     C                     END                             - E1
     C*
     C**  PREPARE DEBIT RATE CHANGE TO OUTPUT
     C*
     C                     MOVE PSTDO     PSTDA
     C                     MOVE VALDO     VALDA
     C*
     C                     EXSR CLMSG
     C                     MOVELNAR,9     RNARR
     C*
     C**  OUTPUT DEBIT RATE CHANGE TO
     C*
     C                     EXSR RCRSR
     C*
     C                     ENDSR                           **RATEC ENDSR**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** RATED subroutine to prepare and output debit rate change
     C**
     C**     Called by       DRSR, RATESR
     C**
     C**     Calls           DBSR, RDRSR
     C**
     C           RATED     BEGSR                           **RATED BEGSR**
     C*
     C**  ACCESS REHRDJ (REHPOSR1 REHPOSR2 REHPOSR3) WHICH CONTAINS
     C**  THE GOOD DATES FOR DEBIT RATE CHANGE TO
     C*
     C***********KLIST5    CHAINREHRDJ               60                    64051
     C           KLIST5    SETLLREHRDJ                   60                64051
     C*                                                                    64051
     C           KLIST5    READEREHRDJ                   60                64051
     C*
     C           *IN60     IFEQ '1'                        - B1
     C                     Z-ADDDDRCD     WDATE
     C                     Z-ADD23        DBASE
     C                     MOVE 'REHRDJ'  DBFILE           ***************
     C                     MOVELRKEY2     DBKEY            **DB ERROR 23**
     C                     MOVEA'1'       *IN,89           ***************
     C                     EXSR DBSR
     C                     END                             - E1
     C*
     C**  TRANSFER DATE MIDAS INTO DDMMMYY
     C*
     C           PVALD     IFNE RVALD                      - B1
     C                     Z-ADDRVALD     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALDO
     C*
     C                     Z-ADDRVALD     PVALD
     C*
     C                     END                             - E1
      *                                                                   182452
      ** Save rate change value date.                                     182452
      *                                                                   182452
     C                     Z-ADDRVALD     RVALDD  50                      182452
     C*
     C**  TRANSFER DATE MIDAS INTO DDMMMYY
     C*
     C           PPSTD     IFNE RPSTD                      - B1
     C                     Z-ADDRPSTD     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    PSTDO
     C*
     C                     Z-ADDRPSTD     PPSTD
     C*
     C                     END                             - E1
     C*
     C**  PREPARE DEBIT RATE CHANGE TO OUTPUT
     C*
     C                     MOVE PSTDO     PSTDA
     C                     MOVE VALDO     VALDA
     C*
     C                     EXSR CLMSG
     C                     MOVELNAR,4     RNARR
     C*
     C**  OUTPUT DEBIT RATE CHANGE TO
     C*
     C                     EXSR RDRSR
     C*
      ** If CRE001 is switched ON, Output Additional Overdraft Rate       CRE001
      *                                                                   CRE001
     C           CRE001    IFEQ 'Y'                                       CRE001
     C                     EXSR CLMSG                                     CRE001
     C                     MOVELNAR,37    ONARR                           CRE001
     C                     MOVE AODR      OAODR                           CRE001
     C                     EXSR OVERDR                                    CRE001
     C                     WRITEAODRDC                                    CRE001
     C                     ENDIF                                          CRE001
      *                                                                   CRE001
     C                     ENDSR                           **RATED ENDSR**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** RATESR subroutine for debit and credit rate change
     C**
     C**     Called by       B O T H S R
     C**
     C**     Calls           RATEC,RATED
     C**
     C           RATESR    BEGSR                           **RATESR BEGSR*
     C*
     C                     Z-ADDDHISD     WWHISD
     C*
     C           DDRCI     IFEQ 'Y'                        - B1
     C           CLDID     ANDLEDDRCD
     C           DRECI     ANDNE'B'
     C           DRECI     ANDNE'S'                                       094337
     C           DRECI     ANDNE'M'                                       182452
     C*
     C**  DEBIT RATE CHANGE
     C*
     C                     EXSR RATED
     C*
     C                     MOVE '1'       *IN54
     C*
     C                     END                             - E1
     C*
     C           DCRCI     IFEQ 'Y'                        - B1
     C           CLCID     ANDLEDCRCD
     C           DRECI     ANDNE'B'
     C           DRECI     ANDNE'S'                                       094337
     C           DRECI     ANDNE'M'                                       182452
     C*
     C**  CREDIT RATE CHANGE
     C*
     C                     EXSR RATEC
     C*
     C                     MOVE '1'       *IN53
     C*
     C                     END                             - E1
     C*
     C**  SAVE REHISL  AS PREVIOUS
     C*
     C           *IN53     IFEQ '1'
     C********** DRECI     OREQ 'B'                                086087 125176
     C                     Z-ADDDHISD     WHISDC
     C                     Z-ADDDMNBL     WMNBLC 150
     C                     Z-ADDDHISB     WHISBC 150
     C**********           MOVE DDRCB     WDRCBC  10                      125176
     C                     Z-ADDDCRCB     WCRCBC  10
     C***********          Z-ADDDDAID     WDAIDC 150                      094337
     C**********           Z-ADDDDAID     WDAIDD                   094337 125176
     C***********          Z-ADDDCAID     WCAIDC 150                      094337
     C**********           Z-ADDDCAID     WCAIDD                   094337 125176
     C                     Z-ADDDCAID     WCAIDD 150                      125176
     C********** DRECI     IFEQ 'S'                                       125176
     C***********SDICI     IFEQ 'Y'                                       098818
     C********** SDICI     IFNE *BLANKS                            098818 125176
     C***********          Z-ADDSDRIP     WDAIDC 150                      094337
     C**********           Z-ADDSDRIP     WDAIDD                   094337 125176
     C**********           ELSE                                           125176
     C***********          Z-ADDSDAIC     WDAIDC 150                      094337
     C**********           Z-ADDSDAIC     WDAIDD                   094337 125176
     C**********           END                                            125176
     C**********           END                                            125176
     C           DRECI     IFEQ 'S'
     C***********SCICI     IFEQ 'Y'                                       098818
     C           SCICI     IFNE *BLANKS                                   098818
     C***********          Z-ADDSCRIP     WCAIDC 150                      094337
     C                     Z-ADDSCRIP     WCAIDD                          094337
     C                     ELSE
     C***********          Z-ADDSCAIC     WCAIDC 150                      095337
     C                     Z-ADDSCAIC     WCAIDD                          094337
     C                     END
     C                     END
     C                     END
     C*
     C**  SAVE REHISL  AS PREVIOUS
     C*
     C           *IN54     IFEQ '1'
     C********** DRECI     OREQ 'B'                                086087 125176
     C                     Z-ADDDHISD     WHISDD
     C                     Z-ADDDMNBL     WMNBLD 150
     C                     Z-ADDDHISB     WHISBD 150
     C                     MOVE DDRCB     WDRCBD  10
     C**********           Z-ADDDCRCB     WCRCBD  10                      125176
     C                     Z-ADDDDAID     WDAIDD 150
     C**********           Z-ADDDCAID     WCAIDD 150                      125176
     C           DRECI     IFEQ 'S'
     C***********SDICI     IFEQ 'Y'                                      098818
     C           SDICI     IFNE *BLANKS                                  098818
     C                     Z-ADDSDRIP     WDAIDD 150
     C                     ELSE
     C                     Z-ADDSDAIC     WDAIDD
     C                     END
     C                     END
     C********** DRECI     IFEQ 'S'                                       125176
     C***********SCICI     IFEQ 'Y'                                      098818
     C********** SCICI     IFNE *BLANKS                            098818 125176
     C**********           Z-ADDSCRIP     WCAIDD 150                      125176
     C**********           ELSE                                           125176
     C**********           Z-ADDSCAIC     WCAIDD                          125176
     C**********           END                                            125176
     C**********           END                                            125176
     C                     END
     C*
     C**  SAVE REHISL  AS PREVIOUS
     C*
     C                     Z-ADDDMNBL     WMNBL
     C                     Z-ADDDHISB     WHISB
     C                     MOVE DDRCB     WDRCB
     C                     Z-ADDDCRCB     WCRCB
     C                     Z-ADDDDAID     WDAID
     C                     Z-ADDDCAID     WCAID
     C           DRECI     IFEQ 'S'
     C***********SDICI     IFEQ 'Y'                                      098818
     C           SDICI     IFNE *BLANKS                                  098818
     C                     Z-ADDSDRIP     WDAID
     C                     ELSE
     C                     Z-ADDSDAIC     WDAID
     C                     END
     C                     END
     C           DRECI     IFEQ 'S'
     C***********SCICI     IFEQ 'Y'                                      098818
     C           SCICI     IFNE *BLANKS                                  098818
     C                     Z-ADDSCRIP     WCAID
     C                     ELSE
     C                     Z-ADDSCAIC     WCAID
     C                     END
     C                     END
     C*
     C                     MOVE *BLANKS   DDRCI
     C                     MOVE *BLANKS   DCRCI
     C*
     C           KLIST1    READEREHISL                   51
     C********** DRECI     IFEQ 'S'                                       125176
      *                                                                   125176
      * Bypass interim capitalisation records                             125176
     C           *IN51     DOWEQ'0'                                       125176
     C           DRECI     ANDEQ'S'                                       125176
     C           DHISD     ANDLTCHISD                                     125176
      *                                                                   125176
      * If management cap. check for generated adj. after start date.     125176
     C           *IN70     IFEQ '1'                                       125176
     C           *IN51     ANDEQ'0'                                       125176
     C           DRECI     ANDEQ'S'                                       125176
     C           DHISD     ANDLTCHISD                                     125176
     C           SDAIC     IFNE *ZEROS                                    125176
     C           SDICI     ANDNE*BLANK                                    125176
     C           SSDCI     ANDEQ'Y'                                       125176
     C                     Z-ADDSDAIC     @GADJ                           125176
     C                     MOVE 'Y'       @ADJF                           125176
     C                     END                                            125176
     C           SCAIC     IFNE *ZEROS                                    125176
     C           SCICI     ANDNE*BLANK                                    125176
     C           SSCCI     ANDEQ'Y'                                       125176
     C                     Z-SUBSCAIC     @GADJ                           125176
     C                     MOVE 'Y'       @ADJF                           125176
     C                     END                                            125176
     C                     END                                            125176
      *                                                                   125176
     C           KLIST1    READEREHISL                   51
     C                     END
     C*
     C                     ENDSR                           **RATESR ENDSR*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** RCRSR subroutine for credit rate output processing
     C**
     C**     Called by     RATEC
     C**
     C**     Calls         DBSR
     C**
     C           RCRSR     BEGSR                           **RCRSR BEGSR**
     C*
     C********** DCICT     IFEQ *ZEROS                     - B1           125176
     C/COPY WNCPYSRC,RE3761C027
     C           INTP      IFEQ *ZEROS                     - B1           125176
     C*
     C**********           Z-ADDCRIR      RATE                            125176
     C                     Z-ADDINRT      RATE                            125176
     C*
     C**  OUTPUT RATE CHANGE
     C*
     C                     EXSR OVERCR
     C                     WRITERATECR
     C*
     C                     ELSE                            - X1
     C*
     C                     EXSR CLMSG
     C           OPN       IFEQ 'Y'                                       040447
     C                     MOVELNAR,8     RNARR                           040447
     C                     ELSE                                           040447
     C                     MOVELNAR,12    RNARR
     C                     END                                            040447
      *                                                                   086087
      * Print 'tiered' or 'threshold'                                     086087
     C                     MOVEA'00'      *IN,84                          086087
     C           INTP      IFEQ 01                                        086087
     C           INTP      OREQ 03                                        086087
     C                     MOVE '1'       *IN84                           086087
     C                     ELSE                                           086087
     C                     MOVE '1'       *IN85                           086087
     C                     END                                            086087
     C*
     C                     EXSR OVERCR
     C                     WRITERAT1CR
     C*
     C           INTH      IFGT *ZEROS                     - B2
     C******************** Z-ADDINTH      HISB0                           040447
     C                     Z-SUBINTH      HISB0                           040447
     C*
     C***********          EXSR CLMSG                                     094337
     C***********          MOVELNAR,13    BNARR                           094337
     C*
     C                     ELSE                            - X2
     C******************** Z-SUBINTH      HISB0                           040447
     C                     Z-ADDINTH      HISB0                           040447
     C                     END                             - E2           094337
     C*
     C                     EXSR CLMSG
     C                     MOVELNAR,14    BNARR
     C*
     C***********          END                             - E2           094337
     C*
     C                     EXSR OVERCR
     C                     WRITERAT2CR
      *                                                                   086087
      * Output first tier/threshold                                       086087
     C                     Z-ADDRTA,1     ORAT1                           086087
     C                     Z-ADDBLA,1     OBAL01                          086087
      *                                                                                     MD057283
     C           INTH      IFGT OBAL01                                                      MD057283
     C           WZERAT    ANDEQ'Y'                                                         MD057283
     C                     Z-ADD*ZEROS    ORAT1                                             MD057283
     C                     ENDIF                                                            MD057283
     C*
     C***********          MOVEL*BLANKS   ORAT1                           086087
     C***********          MOVEL*BLANKS   OBAL01                          086087
     C***********          MOVEL*BLANKS   ORAT2                           086087
     C***********          MOVEL*BLANKS   OBAL02                          086087
     C***********          MOVEL*BLANKS   ORAT3                           086087
     C***********          MOVEL*BLANKS   OBAL03                          086087
     C***********          MOVEA'11'      *IN,84                          086087
     C*
     C***********RATC21*** IFNE *BLANKS                    - B2           040447
     C***********          Z-ADDRAT21     ORAT1                           086087
     C***********          Z-ADDBAL21     OBAL01                          086087
     C******************** ELSE                            - X2           040447
     C******************** Z-ADDCHISD     WDATE                           040447
     C******************** Z-ADD24        DBASE            ***************040447
     C******************** MOVE 'RATE '   DBFILE           **DB ERROR 24**040447
     C******************** MOVELWDATE     DBKEY            ***************040447
     C******************** MOVEA'1'       *IN,89                          040447
     C******************** EXSR DBSR                                      040447
     C******************** END                             - E2           040447
     C*
     C********** RATC22    IFNE *BLANKS                    - B2           040447
     C********** RAT22     IFNE *ZEROS                     - B2    040447 086087
     C********** BAL22     ORNE *ZEROS                             040447 086087
     C**********           Z-ADDRAT22     ORAT2                           086087
     C**********           Z-ADDBAL22     OBAL02                          086087
     C**********           MOVE *OFF      *IN84                           086087
     C********** RATC23    IFNE *BLANKS                    - B3           040447
     C********** RAT23     IFNE *ZEROS                     - B3    040447 086087
     C********** BAL23     ORNE *ZEROS                             040447 086087
     C**********           Z-ADDRAT23     ORAT3                           086087
     C**********           Z-ADDBAL23     OBAL03                          086087
     C**********           MOVE *OFF      *IN85                           086087
     C**********           ELSE                            - X3           086087
     C**********           MOVE '1'       *IN85                    040447 086087
     C**********           Z-ADD*ZEROS    ORAT3                           086087
     C**********           Z-ADD*ZEROS    OBAL03                          086087
     C**********           END                             - E3           086087
     C**********           ELSE                            - X2           086087
     C**********           MOVE '1'       *IN85                    040447 086087
     C**********           MOVE '1'       *IN84                    040447 086087
     C**********           Z-ADD*ZEROS    ORAT2                           086087
     C**********           Z-ADD*ZEROS    OBAL02                          086087
     C**********           END                             - E2           086087
     C*
     C                     EXSR OVERCR
     C                     WRITERAT3CR
     C**********           EXSR OVERCR                                    086087
     C**********           WRITERAT4CR                                    086087
     C***********          MOVE '0'       *IN84                           040447
     C***********          MOVE '0'       *IN85                           040447
     C*
     C**********           MOVEL*BLANKS   ORAT1                           086087
     C**********           MOVEL*BLANKS   OBAL01                          086087
     C**********           MOVEL*BLANKS   ORAT2                           086087
     C**********           MOVEL*BLANKS   OBAL02                          086087
     C**********           MOVEL*BLANKS   ORAT3                           086087
     C**********           MOVEL*BLANKS   OBAL03                          086087
     C**********           MOVEA'11'      *IN,84                          086087
     C*
     C********** RAT24     IFNE *ZEROS                     - B2    040447 086087
     C********** BAL24     ORNE *ZEROS                             040447 086087
     C********** RATC24    IFNE *BLANKS                    - B2           086087
     C********** BALC24    ORNE *BLANKS                            040447 086087
     C**********           Z-ADDRAT24     ORAT1                           086087
     C**********           Z-ADDBAL24     OBAL01                          086087
     C********** RAT25     IFNE *ZEROS                     - B3    040447 086087
     C********** BAL25     ORNE *ZEROS                             040447 086087
     C********** RATC25    IFNE *BLANKS                    - B3           086087
     C********** BALC25    ORNE *BLANKS                            040447 086087
     C**********           Z-ADDRAT25     ORAT2                           086087
     C**********           Z-ADDBAL25     OBAL02                          086087
     C**********           MOVE *OFF      *IN84                           086087
     C********** RATC26    IFNE *BLANKS                    - B4           040447
     C********** RAT26     IFNE *ZEROS                     - B4    040447 086087
     C********** BAL26     ORNE *ZEROS                             040447 086087
     C********** RATC26    IFNE *BLANKS                    - B4           086087
     C********** BALC26    ORNE *BLANKS                                   086087
     C**********           Z-ADDRAT26     ORAT3                           086087
     C**********           Z-ADDBAL26     OBAL03                          086087
     C**********           MOVE *OFF      *IN85                           086087
     C**********           ENDIF                                          086087
     C**********           ELSE                            - X4           086087
     C**********           MOVE '1'       *IN85                    040447 086087
     C**********           Z-ADD*ZEROS    ORAT3                           086087
     C**********           Z-ADD*ZEROS    OBAL03                          086087
     C**********           END                             - E4           086087
     C**********           END                                     040447 086087
     C**********           ELSE                            - X3           086087
     C**********           MOVE '1'       *IN84                    040447 086087
     C**********           MOVE '1'       *IN85                    040447 086087
     C**********           Z-ADD*ZEROS    ORAT2                           086087
     C**********           Z-ADD*ZEROS    OBAL02                          086087
     C**********           END                             - E3           086087
     C*
     C**********           EXSR OVERCR                                    086087
     C**********           WRITERAT3CR                                    086087
     C**********           EXSR OVERCR                                    086087
     C**********           WRITERAT4CR                                    086087
     C***********          MOVE '0'       *IN84                           040447
     C***********          MOVE '0'       *IN85                           040447
     C*
     C**********           MOVEL*BLANKS   ORAT1                           086087
     C**********           MOVEL*BLANKS   OBAL01                          086087
     C**********           MOVEL*BLANKS   ORAT2                           086087
     C**********           MOVEL*BLANKS   OBAL02                          086087
     C**********           MOVEL*BLANKS   ORAT3                           086087
     C**********           MOVEL*BLANKS   OBAL03                          086087
     C**********           MOVEA'11'      *IN,84                          086087
     C*
     C********** RAT31     IFNE *ZEROS                     - B3    040447 086087
     C********** BAL31     ORNE *ZEROS                             040447 086087
     C********** RATC31    IFNE *BLANKS                    - B3           086087
     C********** BALC31    ORNE *BLANKS                            040447 086087
     C**********           Z-ADDRAT31     ORAT1                           086087
     C**********           Z-ADDBAL31     OBAL01                          086087
     C********** RAT32     IFNE *ZEROS                     - B4    040447 086087
     C********** BAL32     ORNE *ZEROS                             040447 086087
     C********** RATC32    IFNE *BLANKS                    - B4           086087
     C********** BALC32    ORNE *BLANKS                            040447 086087
     C**********           Z-ADDRAT32     ORAT2                           086087
     C**********           Z-ADDBAL32     OBAL02                          086087
     C**********           MOVE *OFF      *IN84                           086087
     C********** RATC33    IFNE *BLANKS                    - B5           040447
     C********** RAT33     IFNE *ZEROS                     - B5    040447 086087
     C********** BAL33     ORNE *ZEROS                             040447 086087
     C********** RATC33    IFNE *BLANKS                    - B5           086087
     C********** BALC33    ORNE *BLANKS                                   086087
     C**********           Z-ADDRAT33     ORAT3                           086087
     C**********           Z-ADDBAL33     OBAL03                          086087
     C**********           MOVE *OFF      *IN85                           086087
     C**********           ENDIF                                          086087
     C**********           ELSE                            - X5           086087
     C**********           MOVE '1'       *IN85                    040447 086087
     C**********           Z-ADD*ZEROS    ORAT3                           086087
     C**********           Z-ADD*ZEROS    OBAL03                          086087
     C**********           END                             - E5           086087
     C**********           END                                     040447 086087
     C**********           ELSE                            - X4           086087
     C**********           MOVE '1'       *IN84                    040447 086087
     C**********           MOVE '1'       *IN85                    040447 086087
     C**********           Z-ADD*ZEROS    ORAT2                           086087
     C**********           Z-ADD*ZEROS    OBAL02                          086087
     C**********           END                             - E4           086087
     C*
     C**********           EXSR OVERCR                                    086087
     C**********           WRITERAT3CR                                    086087
     C**********           EXSR OVERCR                                    086087
     C**********           WRITERAT4CR                                    086087
     C***********          MOVE '0'       *IN84                           040447
     C***********          MOVE '0'       *IN85                           040447
     C*
     C**********           MOVEL*BLANKS   ORAT1                           086087
     C**********           MOVEL*BLANKS   OBAL01                          086087
     C**********           MOVEL*BLANKS   ORAT2                           086087
     C**********           MOVEL*BLANKS   OBAL02                          086087
     C**********           MOVEL*BLANKS   ORAT3                           086087
     C**********           MOVEL*BLANKS   OBAL03                          086087
     C**********           MOVEA'11'      *IN,84                          086087
     C*
     C********** RAT34     IFNE *ZEROS                     - B4    040447 086087
     C********** BAL34     ORNE *ZEROS                             040447 086087
     C********** RATC34    IFNE *BLANKS                    - B4           086087
     C********** BALC34    ORNE *BLANKS                            040447 086087
     C**********           Z-ADDRAT34     ORAT1                           086087
     C**********           Z-ADDBAL34     OBAL01                          086087
     C********** RAT35     IFNE *ZEROS                     - B5    040447 086087
     C********** BAL35     ORNE *ZEROS                             040447 086087
     C********** RATC35    IFNE *BLANKS                    - B5           086087
     C********** BALC35    ORNE *BLANKS                            040447 086087
     C**********           Z-ADDRAT35     ORAT2                           086087
     C**********           Z-ADDBAL35     OBAL02                          086087
     C**********           MOVE *OFF      *IN84                           086087
     C***********RATC36    IFNE *BLANKS                    - B6           040447
     C********** RAT36     IFNE *ZEROS                     - B6    040447 086087
     C********** BAL36     ORNE *ZEROS                             040447 086087
     C********** RATC36    IFNE *BLANKS                    - B6           086087
     C********** BALC36    ORNE *BLANKS                                   086087
     C**********           Z-ADDRAT36     ORAT3                           086087
     C**********           Z-ADDBAL36     OBAL03                          086087
     C**********           MOVE *OFF      *IN85                           086087
     C**********           ENDIF                                          086087
     C**********           ELSE                            - X6           086087
     C**********           MOVE '1'       *IN85                    040447 086087
     C**********           Z-ADD*ZEROS    ORAT3                           086087
     C**********           Z-ADD*ZEROS    OBAL03                          086087
     C**********           END                             - E6           086087
     C**********           END                                     040447 086087
     C**********           ELSE                            - X5           086087
     C**********           MOVE '1'       *IN84                    040447 086087
     C**********           MOVE '1'       *IN85                    040447 086087
     C**********           Z-ADD*ZEROS    ORAT2                           086087
     C**********           Z-ADD*ZEROS    OBAL02                          086087
     C**********           END                             - E5           086087
      *                                                                   086087
      * Output rest of rates & balances until zero/blanks found           086087
     C                     Z-ADD1         @R      20                      086087
     C           @R        DOUEQ12                                        086087
     C                     ADD  1         @R                              086087
     C                     MOVE *BLANKS   ORATC                           086087
     C                     MOVE *BLANKS   OBALC                           086087
     C                     Z-ADDRTA,@R    ORAT1                           086087
     C                     Z-ADDBLA,@R    OBAL01                          086087
     C           ORAT1     IFNE *ZEROS                                    086087
     C           ORATC     ANDNE*BLANKS                                   086087
     C           OBAL01    ORNE *ZEROS                                    086087
     C           OBALC     ANDNE*BLANKS                                   086087
     C           INTH      IFGT OBAL01                                                      MD057283
     C           WZERAT    ANDEQ'Y'                                                         MD057283
     C                     Z-ADD*ZEROS    ORAT1                                             MD057283
     C                     ENDIF                                                            MD057283
     C                     EXSR OVERCR                                    086087
     C                     WRITERAT3CR                                    086087
     C                     ELSE                                           086087
     C                     Z-ADD12        @R                              086087
     C                     END                                            086087
     C                     END                                            086087
     C*
     C**********           EXSR OVERCR                                    086087
     C**********           WRITERAT4CR                                    086087
     C**********           MOVE '0'       *IN84                    040447 086087
     C**********           MOVE '0'       *IN85                    040447 086087
     C*                                                                   040447
     C**********           END                                     040447 086087
     C*
     C**********           END                             - E4           086087
     C*                                                                   040447
     C**********           END                                     040447 086087
     C*
     C**********           END                             - E3           086087
     C*                                                                   040447
     C**********           END                                     040447 086087
     C*
     C**********           END                             - E2           086087
     C*
     C                     END                             - E1
     C*
     C                     ENDSR                           **RCRSR ENDSR**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** RDRSR subroutine for debit rate output processing
     C**
     C**     Called by     RATED
     C**
     C**     Calls         DBSR
     C**
     C           RDRSR     BEGSR                           **RDRSR BEGSR**
     C*
     C********** DDICT     IFEQ *ZEROS                     - B1           125176
     C/COPY WNCPYSRC,RE3761C028
     C           INTP      IFEQ *ZEROS                     - B1           125176
     C*
     C**********           Z-ADDDRIR      RATE                            125176
     C                     Z-ADDINRT      RATE                            125176
     C*
     C**  OUTPUT RATE CHANGE
     C*
     C                     EXSR OVERDR
     C                     WRITERATEDR
     C*
     C                     ELSE                            - X1
     C*
     C                     EXSR CLMSG
     C           OPN       IFEQ 'Y'                                       040447
     C                     MOVELNAR,3     RNARR                           040447
     C                     ELSE                                           040447
     C                     MOVELNAR,11    RNARR
     C                     END                                            040447
      *                                                                   086087
      * Print 'tiered' or 'threshold'                                     086087
     C                     MOVEA'00'      *IN,84                          086087
     C           INTP      IFEQ 01                                        086087
     C           INTP      OREQ 03                                        086087
     C                     MOVE '1'       *IN84                           086087
     C                     ELSE                                           086087
     C                     MOVE '1'       *IN85                           086087
     C                     END                                            086087
     C*
     C                     EXSR OVERDR
     C                     WRITERAT1DR
     C*
     C***********INTH      IFGT *ZEROS                     - B2           094337
     C******************** Z-ADDINTH      HISB0                           040447
     C***********          Z-SUBINTH      HISB0                     040447094337
     C*
     C                     EXSR CLMSG
     C***********          MOVELNAR,13    BNARR                           125176
     C                     MOVELNAR,14    BNARR                           125176
     C*
     C***********          ELSE                            - X2           094337
     C******************** Z-SUBINTH      HISB0                           040447
     C                     Z-ADDINTH      HISB0                           040447
     C*
     C***********          EXSR CLMSG                                     094337
     C***********          MOVELNAR,14    BNARR                           094337
     C*
     C***********          END                             - E2           094337
     C*
     C                     EXSR OVERDR
     C                     WRITERAT2DR
      *                                                                   086087
      * Output first tier/threshold                                       086087
     C                     Z-ADDRTA,1     ORAT1                           086087
     C                     Z-ADDBLA,1     OBAL01                          086087
      *                                                                                     MD057283
     C           INTH      IFGT OBAL01                                                      MD057283
     C           WZERAT    ANDEQ'Y'                                                         MD057283
     C                     Z-ADD*ZEROS    ORAT1                                             MD057283
     C                     ENDIF                                                            MD057283
     C*
     C***********          MOVEL*BLANKS   ORAT1                           086087
     C***********          MOVEL*BLANKS   OBAL01                          086087
     C***********          MOVEL*BLANKS   ORAT2                           086087
     C***********          MOVEL*BLANKS   OBAL02                          086087
     C***********          MOVEL*BLANKS   ORAT3                           086087
     C***********          MOVEL*BLANKS   OBAL03                          086087
     C***********          MOVEA'11'      *IN,84                          086087
     C*
     C********** RATC21    IFNE *BLANKS                    - B2           040447
     C***********          Z-ADDRAT21     ORAT1                           086087
     C***********          Z-ADDBAL21     OBAL01                          086087
     C******************** ELSE                            - X2           040447
     C******************** Z-ADDCHISD     WDATE                           040447
     C******************** Z-ADD25        DBASE            ***************040447
     C******************** MOVE 'RATE '   DBFILE           **DB ERROR 25**040447
     C******************** MOVELWDATE     DBKEY            ***************040447
     C******************** MOVEA'1'       *IN,89                          040447
     C******************** EXSR DBSR                                      040447
     C******************** END                             - E2           040447
     C*
     C********** RATC22    IFNE *BLANKS                    - B2           040447
     C********** RAT22     IFNE *ZEROS                     - B2    040447 086087
     C********** BAL22     ORNE *ZEROS                             040447 086087
     C**********           Z-ADDRAT22     ORAT2                           086087
     C**********           Z-ADDBAL22     OBAL02                          086087
     C**********           MOVE *OFF      *IN84                           086087
     C********** RATC23    IFNE *BLANKS                    - B3           040447
     C********** RAT23     IFNE *ZEROS                     - B3    040447 086087
     C********** BAL23     ORNE *ZEROS                             040447 086087
     C**********           Z-ADDRAT23     ORAT3                           086087
     C**********           Z-ADDBAL23     OBAL03                          086087
     C**********           MOVE *OFF      *IN85                           086087
     C**********           ELSE                            - X3           086087
     C**********           MOVE '1'       *IN85                    040447 086087
     C**********           Z-ADD*ZEROS    ORAT3                           086087
     C**********           Z-ADD*ZEROS    OBAL03                          086087
     C**********           END                             - E3           086087
     C**********           ELSE                            - X2           086087
     C**********           MOVE '1'       *IN85                    040447 086087
     C**********           MOVE '1'       *IN84                    040447 086087
     C**********           Z-ADD*ZEROS    ORAT2                           086087
     C**********           Z-ADD*ZEROS    OBAL02                          086087
     C**********           END                             - E2           086087
     C*
     C                     EXSR OVERDR
     C           OBALC     IFNE *BLANKS                                                       164890
     C                     WRITERAT3DR
     C                     ENDIF                                                              164890
     C**********           EXSR OVERDR                                    086087
     C**********           WRITERAT4DR                                    086087
     C***********          MOVE '0'       *IN84                           040447
     C***********          MOVE '0'       *IN85                           040447
     C*
     C**********           MOVEL*BLANKS   ORAT1                           086087
     C**********           MOVEL*BLANKS   OBAL01                          086087
     C**********           MOVEL*BLANKS   ORAT2                           086087
     C**********           MOVEL*BLANKS   OBAL02                          086087
     C**********           MOVEL*BLANKS   ORAT3                           086087
     C**********           MOVEL*BLANKS   OBAL03                          086087
     C**********           MOVEA'11'      *IN,84                          086087
     C*
     C********** RAT24     IFNE *ZEROS                     - B2    040447 086087
     C********** BAL24     ORNE *ZEROS                             040447 086087
     C********** RATC24    IFNE *BLANKS                    - B2           086087
     C********** BALC24    ORNE *BLANKS                            040447 086087
     C**********           Z-ADDRAT24     ORAT1                           086087
     C**********           Z-ADDBAL24     OBAL01                          086087
     C********** RAT25     IFNE *ZEROS                     - B3    040447 086087
     C********** BAL25     ORNE *ZEROS                             040447 086087
     C********** RATC25    IFNE *BLANKS                    - B3           086087
     C********** BALC25    ORNE *BLANKS                            040447 086087
     C**********           Z-ADDRAT25     ORAT2                           086087
     C**********           Z-ADDBAL25     OBAL02                          086087
     C**********           MOVE *OFF      *IN84                           086087
     C********** RATC26    IFNE *BLANKS                    - B4           040447
     C********** RAT26     IFNE *ZEROS                     - B4    040447 086087
     C********** BAL26     ORNE *ZEROS                             040447 086087
     C********** RATC26    IFNE *BLANKS                    - B4           086087
     C********** BALC26    ORNE *BLANKS                                   086087
     C**********           Z-ADDRAT26     ORAT3                           086087
     C**********           Z-ADDBAL26     OBAL03                          086087
     C**********           MOVE *OFF      *IN85                           086087
     C**********           ENDIF                                          086087
     C**********           ELSE                            - X4           086087
     C**********           MOVE '1'       *IN85                    040447 086087
     C**********           Z-ADD*ZEROS    ORAT3                           086087
     C**********           Z-ADD*ZEROS    OBAL03                          086087
     C**********           END                             - E4           086087
     C**********           END                                     040447 086087
     C**********           ELSE                            - X3           086087
     C**********           MOVE '1'       *IN84                    040447 086087
     C**********           MOVE '1'       *IN85                    040447 086087
     C**********           Z-ADD*ZEROS    ORAT2                           086087
     C**********           Z-ADD*ZEROS    OBAL02                          086087
     C**********           END                             - E3           086087
     C*
     C**********           EXSR OVERDR                                    086087
     C**********           WRITERAT3DR                                    086087
     C**********           EXSR OVERDR                                    086087
     C**********           WRITERAT4DR                                    086087
     C***********          MOVE '0'       *IN84                           040447
     C***********          MOVE '0'       *IN85                           040447
     C*
     C**********           MOVEL*BLANKS   ORAT1                           086087
     C**********           MOVEL*BLANKS   OBAL01                          086087
     C**********           MOVEL*BLANKS   ORAT2                           086087
     C**********           MOVEL*BLANKS   OBAL02                          086087
     C**********           MOVEL*BLANKS   ORAT3                           086087
     C**********           MOVEL*BLANKS   OBAL03                          086087
     C**********           MOVEA'11'      *IN,84                          086087
     C*
     C********** RAT31     IFNE *ZEROS                     - B3    040447 086087
     C********** BAL31     ORNE *ZEROS                             040447 086087
     C********** RATC31    IFNE *BLANKS                    - B3           086087
     C********** BALC31    ORNE *BLANKS                            040447 086087
     C**********           Z-ADDRAT31     ORAT1                           086087
     C**********           Z-ADDBAL31     OBAL01                          086087
     C********** RAT32     IFNE *ZEROS                     - B4    040447 086087
     C********** BAL32     ORNE *ZEROS                             040447 086087
     C********** RATC32    IFNE *BLANKS                    - B4           086087
     C********** BALC32    ORNE *BLANKS                            040447 086087
     C**********           Z-ADDRAT32     ORAT2                           086087
     C**********           Z-ADDBAL32     OBAL02                          086087
     C**********           MOVE *OFF      *IN84                           086087
     C***********RATC33    IFNE *BLANKS                    - B5           040447
     C********** RAT33     IFNE *ZEROS                     - B5    040447 086087
     C********** BAL33     ORNE *ZEROS                             040447 086087
     C********** RATC33    IFNE *BLANKS                    - B5           086087
     C********** BALC33    ORNE *BLANKS                                   086087
     C**********           Z-ADDRAT33     ORAT3                           086087
     C**********           Z-ADDBAL33     OBAL03                          086087
     C**********           MOVE *OFF      *IN85                           086087
     C**********           ENDIF                                          086087
     C**********           ELSE                            - X5           086087
     C**********           MOVE '1'       *IN85                    040447 086087
     C**********           Z-ADD*ZEROS    ORAT3                           086087
     C**********           Z-ADD*ZEROS    OBAL03                          086087
     C**********           END                             - E5           086087
     C**********           END                                     040447 086087
     C**********           ELSE                            - X4           086087
     C**********           MOVE '1'       *IN84                    040447 086087
     C**********           MOVE '1'       *IN85                    040447 086087
     C**********           Z-ADD*ZEROS    ORAT2                           086087
     C**********           Z-ADD*ZEROS    OBAL02                          086087
     C**********           END                             - E4           086087
     C*
     C**********           EXSR OVERDR                                    086087
     C**********           WRITERAT3DR                                    086087
     C**********           EXSR OVERDR                                    086087
     C**********           WRITERAT4DR                                    086087
     C***********          MOVE '0'       *IN84                           040447
     C***********          MOVE '0'       *IN85                           040447
     C*
     C**********           MOVEL*BLANKS   ORAT1                           086087
     C**********           MOVEL*BLANKS   OBAL01                          086087
     C**********           MOVEL*BLANKS   ORAT2                           086087
     C**********           MOVEL*BLANKS   OBAL02                          086087
     C**********           MOVEL*BLANKS   ORAT3                           086087
     C**********           MOVEL*BLANKS   OBAL03                          086087
     C**********           MOVEA'11'      *IN,84                          086087
     C*
     C********** RAT34     IFNE *ZEROS                     - B4    040447 086087
     C********** BAL34     ORNE *ZEROS                             040447 086087
     C********** RATC34    IFNE *BLANKS                    - B4           086087
     C********** BALC34    ORNE *BLANKS                            040447 086087
     C**********           Z-ADDRAT34     ORAT1                           086087
     C**********           Z-ADDBAL34     OBAL01                          086087
     C********** RAT35     IFNE *ZEROS                     - B5    040447 086087
     C********** BAL35     ORNE *ZEROS                             040447 086087
     C********** RATC35    IFNE *BLANKS                    - B5           086087
     C********** BALC35    ORNE *BLANKS                            040447 086087
     C**********           Z-ADDRAT35     ORAT2                           086087
     C**********           Z-ADDBAL35     OBAL02                          086087
     C**********           MOVE *OFF      *IN84                           086087
     C********** RATC36    IFNE *BLANKS                    - B6           040447
     C********** RAT36     IFNE *ZEROS                     - B6    040447 086087
     C********** BAL36     ORNE *ZEROS                             040447 086087
     C********** RATC36    IFNE *BLANKS                    - B6           086087
     C********** BALC36    ORNE *BLANKS                                   086087
     C**********           Z-ADDRAT36     ORAT3                           086087
     C**********           Z-ADDBAL36     OBAL03                          086087
     C**********           MOVE *OFF      *IN85                           086087
     C**********           ENDIF                                          086087
     C**********           ELSE                            - X6           086087
     C**********           MOVE '1'       *IN85                    040447 086087
     C**********           Z-ADD*ZEROS    ORAT3                           086087
     C**********           Z-ADD*ZEROS    OBAL03                          086087
     C**********           END                             - E6           086087
     C**********           END                                     040447 086087
     C**********           ELSE                            - X5           086087
     C**********           MOVE '1'       *IN84                    040447 086087
     C**********           MOVE '1'       *IN85                    040447 086087
     C**********           Z-ADD*ZEROS    ORAT2                           086087
     C**********           Z-ADD*ZEROS    OBAL02                          086087
     C**********           END                             - E5           086087
      *                                                                   086087
      * Output rest of rates & balances until zero/blanks found           086087
     C**********           Z-ADD0         @R                       086087 125176
     C                     Z-ADD1         @R                              125176
     C           @R        DOUEQ12                                        086087
     C                     ADD  1         @R                              086087
     C                     MOVE *BLANKS   ORATC                           086087
     C                     MOVE *BLANKS   OBALC                           086087
     C                     Z-ADDRTA,@R    ORAT1                           086087
     C                     Z-ADDBLA,@R    OBAL01                          086087
     C           ORAT1     IFNE *ZEROS                                    086087
     C           ORATC     ANDNE*BLANKS                                   086087
     C           OBAL01    ORNE *ZEROS                                    086087
     C           OBALC     ANDNE*BLANKS                                   086087
     C           INTH      IFGT OBAL01                                                      MD057283
     C           WZERAT    ANDEQ'Y'                                                         MD057283
     C                     Z-ADD*ZEROS    ORAT1                                             MD057283
     C                     ENDIF                                                            MD057283
     C                     EXSR OVERDR                                    086087
     C                     WRITERAT3DR                                    086087
     C                     ELSE                                           086087
     C                     Z-ADD12        @R                              086087
     C                     END                                            086087
     C                     END                                            086087
     C*
     C**********           EXSR OVERDR                                    086087
     C**********           WRITERAT4DR                                    086087
     C**********           MOVE '0'       *IN84                    040447 086087
     C**********           MOVE '0'       *IN85                    040447 086087
     C*                                                                   040447
     C**********           END                                     040447 086087
     C*
     C**********           END                             - E4           086087
     C*                                                                   040447
     C**********           END                                     040447 086087
     C*
     C**********           END                             - E3           086087
     C*                                                                   040447
     C**********           END                                     040447 086087
     C*
     C**********           END                             - E2           086087
     C*
     C                     END                             - E1
     C*
     C                     ENDSR                           **RDRSR ENDSR**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** TOTAL subroutine for total processing
     C**
     C**     Called by       S T A R T
     C**
     C**     Calls           -
     C**
     C           TOTAL     BEGSR                           **TOTAL BEGSR**
     C**
     C** SET UP FOR CONTROL REPORT
     C**
     C                     Z-ADDSFNUMU    ZSNUMU
     C                     OUT  LDA
     C                     CALL 'ZSFILE'
     C                     PARM           SEQ     5
     C                     PARM *BLANK    SENTY   3
     C                     PARM           SFILEU
     C                     PARM           ZSNUMU  60
     C                     PARM           ZSERR   1
     C           *LOCK     IN   LDA
     C*
     C           ZSERR     IFEQ 'Y'
     C** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM
     C** DBASE, DBFILE AND DBKEY SET WITHIN ZSFILE                        LN0112
     C                     MOVEA'1'       *IN,89                          LN0112
     C                     EXSR DBSR                                      LN0112
     C*********************SETON                     U7U8                 LN0112
     C                     RETRN                                          LN0112
     C                     END
     C*
     C                     WRITETOTALS
     C*
     C                     ENDSR                           **TOTAL ENDSR**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** TOTSR subroutine for days total output for credit and debit
     C**
     C**     Called by       B O T H S R
     C**
     C**     Calls           ZICD, ITYPDR, ITYPCR
     C**
     C           TOTSR     BEGSR                           **TOTSR  BEGSR*
     C*
     C           CDICT     IFLT 3                          - B1
     C*
     C           DDRCI     IFEQ 'Y'                        - B2
     C*
     C                     Z-ADDWDRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDDHISD     ZIEND
     C*
     C                     EXSR ZICD
     C*
     C                     Z-ADDZDAYN1    DAYS
     C                     Z-ADDWHISB     HISB0
     C           HISB0     MULT DAYS      NUMB0
     C*
     C*******************  EXSR OVERDR                                    094431
     C*******************  WRITESTOTDR                                    094431
     C                     MOVE 'DR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C*
     C* CHARGE REPORT IF NECESSARY
     C*
     C                     EXSR PRN1CH                     chargesDetails1085713
     C***********CCICI     IFNE *BLANK                     - B4           085713
     C***********DTHGAR    IFNE *ZERO                      - B5           085713
     C***********DTHGAN    ORNE *ZERO                                     085713
     C***********          Z-ADDDTHGAR    CHGR0                           085713
     C***********          Z-ADDDTHGAN    CHGN0                           085713
     C***********          Z-ADDNITMS     SNITMS                          085713
     C***********          WRITEPOSTCH                                    085713
     C***********          END                             - E5           085713
     C***********          END                             - E4           085713
     C*
     C                     END                             - E2
     C*
     C                     ELSE                            - X1
     C*
     C                     EXSR ITYPDR
     C*
     C                     END                             - E1
     C*
     C           DCRCI     IFEQ 'Y'                        - B1
     C*
     C           CCICT     IFLT 3                          - B2
     C*
     C                     Z-ADDWCRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDDHISD     ZIEND
     C*
     C                     EXSR ZICD
     C*
     C                     Z-ADDZDAYN1    DAYS
     C                     Z-ADDWHISB     HISB0
     C           HISB0     MULT DAYS      NUMB0
     C*
     C*******************  EXSR OVERCR                                    094431
     C*******************  WRITESTOTCR                                    094431
     C                     MOVE 'CR'      DCFLAG                          094431
     C                     EXSR WST                        WRITE SUB TOT  094431
     C*
     C* CHARGE REPORT IF NECESSARY
     C*
     C                     EXSR PRN1CH                     chargesDetails1085713
     C***********CCICI     IFNE *BLANK                     - B4           085713
     C***********DTHGAR    IFNE *ZERO                      - B5           085713
     C***********DTHGAN    ORNE *ZERO                                     085713
     C***********          Z-ADDDTHGAR    CHGR0                           085713
     C***********          Z-ADDDTHGAN    CHGN0                           085713
     C***********          Z-ADDNITMS     SNITMS                          085713
     C***********          WRITEPOSTCH                                    085713
     C***********          END                             - E5           085713
     C***********          END                             - E4           085713
     C*
     C                     ELSE                            - X2
     C*
     C                     EXSR ITYPCR
     C*
     C                     END                             - E2
     C*
     C                     END                             - E1
     C*
     C                     ENDSR                           **TOTSR  ENDSR*
     C********************************************************************
     C/EJECT
      ********************************************************************094431
      **                                                                  094431
      ** WMA   subroutine - Writes Manual adjustment print record.        094431
      **       Also accumulates the interest amount printed.              094431
      **                                                                  094431
      ********************************************************************094431
      **                                                                  094431
     C           WMA       BEGSR                                          094431
      *                                                                   094431
     C           *LIKE     DEFN INTD0     MADR#                           094431
     C           *LIKE     DEFN INTD0     MACR#                           094431
      *                                                                   094431
     C                     SELEC                                          094431
     C           DCFLAG    WHEQ 'DR'                                      094431
     C                     ADD  INTD0     MADR#                           094431
     C                     EXSR OVERDR                                    094431
     C                     WRITEMADJDR                                    094431
      *                                                                   094431
     C           DCFLAG    WHEQ 'CR'                                      094431
     C***********          ADD  INTD0     MACR#                     094431094674
     C                     ADD  INTC0     MACR#                           094674
     C                     Z-SUBINTC0     INTC0                           125176
     C                     EXSR OVERCR                                    094431
     C                     WRITEMADJCR                                    094431
     C                     ENDSL                                          094431
      *                                                                   094431
     C                     ENDSR                                          094431
      /EJECT                                                              094431
      ********************************************************************094431
      **                                                                  094431
      ** WST   subroutine - Writes 'Sub Total' print record               094431
      **       First deduct the accumulated Manual adjustment interest    094431
      **       since the last 'Sub Total' line                            094431
      **       Initialise Manual adjustment accumulator.                  094431
      **                                                                  094431
      ********************************************************************094431
      **                                                                  094431
     C           WST       BEGSR                                          094431
      *                                                                   094431
     C                     SELEC                                          094431
     C           DCFLAG    WHEQ 'DR'                                      094431
     C********** INTD0     SUB  MADR#     INTD0                    094431 125176
     C                     EXSR OVERDR                                    094431
     C/COPY WNCPYSRC,RE3761C061
     C                     WRITESTOTDR                                    094431
     C**********           Z-ADD*ZERO     MADR#                    094431 125176
      *                                                                   094431
     C           DCFLAG    WHEQ 'CR'                                      094431
     C***********INTD0     SUB  MACR#     INTD0                     094431094674
     C********** INTC0     SUB  MACR#     INTC0                    094674 125176
     C                     EXSR OVERCR                                    094431
     C/COPY WNCPYSRC,RE3761C062
     C                     WRITESTOTCR                                    094431
     C**********           Z-ADD*ZERO     MACR#                    094431 125176
     C                     ENDSL                                          094431
      *                                                                   094431
     C                     ENDSR                                          094431
     C********************************************************************094431
      /EJECT                                                              094431
     C********************************************************************
     C**
     C** CALBRT subroutine to calculate base rates tax
     C**
     C**     Called by       BOTHSR, CRSR
     C**
     C**     Calls           none
     C**
     C           CALBRT    BEGSR                           **CALBRT BEGSR**
     C*
     C** If BRT SAR installed
     C*
     C           S01383    IFEQ 'Y'                        B001
      *                                                                   086087
     C                     MOVE '0'       *IN22                           086087
      *                                                                                       CRE083
      ** IF CFT004 IS ON NO NEED TO ACCESS CLINT                                              CRE083
      *                                                                                       CRE083
     C           CFT004    IFNE 'Y'                                                           CRE083
     C*
     C** Access ACCNT to check if BRT liable
     C*
     C           KACCNT    CHAINACCNT                99
     C*
     C** Chain failure
     C*
     C           *IN99     IFEQ '1'                        B002***********
     C*********************SETON                     U7U8LR**DB ERROR 26**LN0112
     C                     MOVEL'ACCNT'   DBFILE           ***************
     C                     MOVELRKEY      DBKEY
     C                     Z-ADD26        DBASE
     C                     EXSR DBSR
     C                     END                             E002
     C**********           END                             E001           130468
     C                     END                                                                CRE083
      *                                                                   130468
      * Include CR interest adjustments when calculating BRT              130468
     C                     Z-ADDTINTC0    TGINT0                          130468
     C                     SUB  CSGACI    TINTC0                          130468
     C*
     C** If BRT liable
     C*
     C           BRTCA     IFEQ 'L'                        B001
     C           BRTCA     OREQ 'P'
     C*
     C**    and credit interest to be paid
     C*
     C**    Credit interest is now reverse sign.                          094337
     C***********TINTC0    IFGT 0                          B002           094337
     C           TINTC0    IFLT 0                          B002           094337
     C*
     C** Process record with BRT applied
     C*
     C                     SETON                     22
     C*
     C** Apply new or old rate?
     C*
     C***********HISD      IFGE DEFF                       B003           104618
     C***********          Z-ADDBRTR      BRT1    75                      104618
     C***********          ELSE                            X003           104618
     C***********          Z-ADDPBRTR     BRT1    75                      104618
     C***********          END                             E003           104618
     C*                                                                   104618
     C* IF DATE IS BEFORE 'DEFF' ON SDBRTDPD - USE PREV BRT RATE          104618
     C* OTHERWISE - USE CURRENT BRT RATE.                                 104618
     C*                                                                   104618
     C           CCICI     IFEQ 'D'                                       104618
     C           CCICI     OREQ 'M'                                       104618
     C                     MOVE '1'       *IN30                           104618
     C                     ELSE                                           104618
     C                     MOVE '0'       *IN30                           104618
     C                     END                                            104618
     C*                                                                   104618
     C           LDAC      IFEQ 'Y'                                       104618
     C*                                                                   104618
     C           *IN30     IFEQ '1'                                       104618
     C           RUND      IFLE DEFF                                      104618
     C                     Z-ADDPBRTR     BRT1    75                      104618
     C                     ELSE                                           104618
     C                     Z-ADDBRTR      BRT1                            104618
     C                     END                                            104618
     C                     END                                            104618
     C*                                                                   104618
     C           CCICI     IFEQ 'C'                                       104618
     C           RUND      IFLT DEFF                                      104618
     C                     Z-ADDPBRTR     BRT1                            104618
     C                     ELSE                                           104618
     C                     Z-ADDBRTR      BRT1                            104618
     C                     END                                            104618
     C                     END                                            104618
     C*                                                                   104618
     C           *IN30     IFEQ '0'                                       104618
     C           CCICI     ANDNE'C'                                       104618
     C           NCID      IFLE DEFF                                      104618
     C                     Z-ADDPBRTR     BRT1                            104618
     C                     ELSE                                           104618
     C                     Z-ADDBRTR      BRT1                            104618
     C                     END                                            104618
     C                     END                                            104618
     C*                                                                   104618
     C                     ELSE                                           104618
     C*                                                                   104618
     C           *IN30     IFEQ '1'                                       104618
     C           CCICI     OREQ 'C'                                       104618
     C           RUND      IFLT DEFF                                      104618
     C                     Z-ADDPBRTR     BRT1                            104618
     C                     ELSE                                           104618
     C                     Z-ADDBRTR      BRT1                            104618
     C                     END                                            104618
     C                     END                                            104618
     C*                                                                   104618
     C           *IN30     IFEQ '0'                                       104618
     C           CCICI     ANDNE'C'                                       104618
     C           NCID      IFLT DEFF                                      104618
     C                     Z-ADDPBRTR     BRT1                            104618
     C                     ELSE                                           104618
     C                     Z-ADDBRTR      BRT1                            104618
     C                     END                                            104618
     C                     END                                            104618
     C*                                                                   104618
     C                     END                                            104618
     C*
     C           BRTCA     IFEQ 'L'
     C                     Z-ADDBRT1      WKBRT   75
     C                     ELSE
     C           BRT1      MULT 0.5       WKBRT
     C                     END
     C*
     C           TINTC0    MULT WKBRT     BRTOT0
     C           BRTOT0    DIV  100       BRTOT0    H
      *                                                                   099505
      * If CR interest is negative, BRT amount must be positive.          099505
     C                     Z-SUBBRTOT0    BRTOT0                          099505
     C*
     C**********           Z-ADDTINTC0    TGINT0                          130468
     C***********          SUB  BRTOT0    TINTC0                          086087
     C                     END                             E002
     C*
     C                     END                             E001
      *                                                                   130468
     C                     Z-ADDTGINT0    TINTC0                          130468
     C                     END                                            130468
     C*
     C***********TINTC0    COMP 0                    4948                 094337
     C           TINTC0    COMP 0                    4849                 094337
     C                     ENDSR
      *****************************************************************                       CGL031
      /EJECT                                                                                  CGL031
      *****************************************************************                       CGL031
      *                                                               *                       CGL031
      *  CALEUT - Retrieves tax amount for EU withholding tax         *                       CGL031
      *                                                               *                       CGL031
      *****************************************************************                       CGL031
     C           CALEUT    BEGSR                                                              CGL031
      *                                                                                       CGL031
      ** Check if the customer is actually a Joint A/c.                                       235917
      *                                                                                       235917
     C                     MOVELCCNUM     KJANO   6                                           235917
     C           KJANO     CHAINSDJACCL1             60                                       235917
      *                                                                                       235917
     C                     MOVE 'N'       WJACC   1                                           235917
     C           *IN60     IFEQ *OFF                                                          235917
     C                     MOVE 'Y'       WJACC                                               235917
     C                     ENDIF                                                              235917
      *                                                                                       235917
      ** Initialise relevant variables                                                        CGL031
      *                                                                                       CGL031
     C                     Z-ADD*ZERO     EUTAX0                                              CGL031
     C                     Z-ADD*ZEROS    STAX0                                               CER048
     C                     Z-ADD*ZEROS    TTAX0                                             BUG26838
      *                                                                                       CGL031
      ** Read customer income records                                                         CGL031
      *                                                                                       CGL031
     C                     Z-ADDRUND      KRDNB                                               CGL031
     C                     MOVE 'G'       KMODI                                               CGL031
     C                     MOVE CCNUM     KCUST                                               CGL031
     C**********           MOVELCCNUM     KJOIN   60                                  235917 CSD027A
     C                     MOVELCCNUM     KJOIN   6                                          CSD027A
     C                     MOVE CCCY      KSCCY                                               CGL031
     C                     Z-ADDCACOD     KACOD                                               CGL031
     C                     Z-ADDCACSQ     KACSQ                                               CGL031
     C                     MOVE CBRCA     KBRCA                                               CGL031
      *                                                                                       CGL031
     C           WJACC     IFEQ 'Y'                                                           235917
     C           KLISTC    SETLLSDCSINLC                                                      235917
     C           KLISTC    READESDCSINLC                 60                                   235917
     C                     ELSE                                                               235917
     C           KCSIN     SETLLSDCSINL7                                                      CGL031
     C           KCSIN     READESDCSINL7                 60                                   CGL031
     C                     ENDIF                                                              235917
      *                                                                                       CGL031
     C           *IN60     DOWEQ*OFF                                                          CGL031
     C           TSSTAT    IFEQ 'T'                                                           CGL031
      *                                                                                       CGL031
      ** Accumulate tax amount in original ccy                                                CGL031
      *                                                                                       CGL031
     C                     ADD  TSTXSR    EUTAX0                                              CGL031
      *                                                                                       CER048
      ** Accumulate Secondary Tax Amount in Original Currency                                 CER048
      *                                                                                       CER048
     C           CER048    IFEQ 'Y'                                                           CER048
     C           STAX0     ADD  TSSTDO    STAX0                                               CER048
     C                     ENDIF                                                              CER048
      *                                                                                     BUG26838
      ** Accumulate Third Tax Amount in Original Currency                                   BUG26838
      *                                                                                     BUG26838
     C           CER054    IFEQ 'Y'                                                         BUG26838
     C           TTAX0     ADD  TSTTDO    TTAX0                                             BUG26838
     C                     ENDIF                                                            BUG26838
      *                                                                                       CGL031
     C                     ENDIF                                                              CGL031
     C*                                                                                       235917
     C           WJACC     IFEQ 'Y'                                                           235917
     C           KLISTC    READESDCSINLC                 60                                   235917
     C                     ELSE                                                               235917
     C           KCSIN     READESDCSINL7                 60                                   CGL031
     C                     ENDIF                                                              235917
     C*                                                                                       235917
     C                     ENDDO                                                              CGL031
      *                                                                                       CGL031
     C                     ENDSR                                                              CGL031
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C**   SR. TO SET UP AN ARRAY OF CURRENCIES AND AN ARRAY OF
     C**   DECIMAL PLACES FOR THOSE CURRENCIES.
     C**
     C           CCYARR    BEGSR                           *** CCYARR  ***
     C**
     C**   SET OFF ERROR INDICATOR
     C                     SETOF                     99
     C**
     C**   SET ARRAY INDEX TO ZERO.
     C                     Z-ADD0         X       30
     C**
     C**   SET UP KEY FOR CURRENCY TABLE.
     C                     MOVE *BLANKS   W@CKEY  3
     C**
     C**   SET LOWER LIMIT AND READ CURRENCY TABLE HEADER.
     C           W@CKEY    SETLLSDCURRL0
     C**
     C**   LOOP TO READ CURRENCY DETAIL RECORDS.
     C           XLOOP     TAG                             ** XLOOP TAG **
     C                     READ SDCURRL0                 99
     C**
     C**   END IF ALL CURRENCY RECORDS PROCESSED
     C   99                GOTO XEND
     C**
     C**   INCREMENT ARRAY INDEX.
     C           X         ADD  1         X
     C**
     C**   MOVE DATA INTO ARRAYS.
     C                     MOVE A6CYCD    CCYA,X
     C                     MOVE A6NBDP    DPA,X
     C/COPY WNCPYSRC,RE3761C064
     C**
     C**   CHECK FOR FULL ARRAY.96 ON IF FULL.
     C           X         COMP 200                      96
     C**
     C**   GO TO READ NEXT RECORD.
     C  N96                GOTO XLOOP
     C**
     C           XEND      TAG                             ** XEND TAG  **
     C                     ENDSR
     C**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** ZICD subroutine to find number of days to calculate interest
     C**      according to calculation basis
     C**
     C**     Called by       BOTHSR, CRSR, DAYTSR, DRSR, ITYPCR,
     C**                     ITYPDR, TOTSR
     C**
     C**     Calls           DBSR
     C**
     C           ZICD      BEGSR                           **ZICD BEGSR**
     C*
     C* TO DETERMINE NUMBER OF DAYS INTEREST TO BE CALCULATED
     C*
     C           ZIEND     SUB  ZIBEG     ZDAYN1
     C*
     C* CHECK FOR INTEREST CALCULATION BASIS
     C*
     C           ZICALC    IFEQ 3                          - B1
     C           ZICALC    OREQ 0                                                             CER016
     C/COPY WNCPYSRC,RE3761C029
     C           ZIEND     IFGT ZIBEG                      - B2
     C*
     C** CALCULATING DATE FROM DAY NUMBER (BEGINNING DATE)
     C*
     C                     Z-ADDZIBEG     ZDAYNO
     C                     EXSR ZDATE2
     C*
     C                     Z-ADDZDATE     SRES
     C*
     C** CALCULATING DATE FROM DAY NUMBER (FINISHING DATE)
     C*
     C                     Z-ADDZIEND     ZDAYNO
     C                     EXSR ZDATE2
     C*
     C                     Z-ADDZDATE     FRES
     C*
     C*
     C** IN ORDER FOR THE FINISH YEAR TO BE LESS THAN THE START YEAR IF ZIEND
     C** IS GREATER THAN ZIBEG, THEN THE DATE ZIEND MUST BE IN A DIFFERENT
     C** CENTURY TO ZIBEG. IF SO ADD 100 YEARS TO IT.
     C*
     C*
     C           ZIFY      IFLT ZISY                       - B3
     C           ZIFY      ADD  100       ZIFY2   30
     C                     ELSE                            - X3
     C                     Z-ADDZIFY      ZIFY2
     C                     END                             - E3
     C*
     C                     Z-ADDZISY      ZISY2   30
     C/COPY WNCPYSRC,RE3761C051
     C*
     C** DETERMINE WHETHER START YEAR IS A LEAP YEAR AND IF START MONTH
     C** IS FEBRUARY  THEN CONSIDER LAST DAY OF FEBRUARY AS DATE 30ND. OF THE
     C*  MONTH
     C*
     C           ZICALC    IFEQ 3                                                             CER016
     C           ZICALC    OREQ 0                                                             CER016
     C           CER016    ANDEQ'N'                                                           CER016
      *                                                                                       CER016
     C           ZISM      IFEQ 2                          - B3
     C           ZISY2     ADD  1900      ZLYCHK  40
     C           ZLYCHK    DIV  4         ZLYCHK
     C                     MVR            ZLYREM  20
     C           ZLYREM    IFEQ 0                          - B4
     C           ZISD      IFEQ 29                         - B5
     C                     Z-ADD30        ZISD
     C                     END                             - E5
     C                     ELSE                            - X4
     C           ZISD      IFEQ 28                         - B5
     C                     Z-ADD30        ZISD
     C                     END                             - E5
     C                     END                             - E4
     C                     END                             - E3
      *                                                                                       CER016
     C                     ENDIF                                                              CER016
     C/COPY WNCPYSRC,RE3761C052
     C*
     C           30        SUB  ZISD      ZID1
     C*
     C           ZID1      IFLT 0                          - B3
     C                     Z-ADD*ZEROS    ZID1
     C                     END                             - E3
     C*
     C           ZISM      IFEQ 12                         - B3
     C                     Z-ADD*ZEROS    ZISM
     C                     ADD  1         ZISY
     C                     ADD  1         ZISY2
     C                     END                             - E3
     C/COPY WNCPYSRC,RE3761C053
     C*
     C** DETERMINE WHETHER END YEAR IS A LEAP YEAR AND IF END MONTH IS FEBRUARY
     C*
     C           ZICALC    IFEQ 3                                                             CER016
     C           ZICALC    OREQ 0                                                             CER016
     C           CER016    ANDEQ'N'                                                           CER016
      *                                                                                       CER016
     C           ZIFM      IFEQ 2                          - B3
     C           ZIFY2     ADD  1900      ZLYCHK  40
     C           ZLYCHK    DIV  4         ZLYCHK
     C                     MVR            ZLYREM  20
     C           ZLYREM    IFEQ 0                          - B4
     C           ZIFD      IFEQ 29                         - B5
     C                     Z-ADD30        ZIFD
     C                     END                             - E5
     C                     ELSE                            - X4
     C           ZIFD      IFEQ 28                         - B5
     C                     Z-ADD30        ZIFD
     C                     END                             - E5
     C                     END                             - E4
     C                     END                             - E3
      *                                                                                       CER016
     C                     ENDIF                                                              CER016
     C/COPY WNCPYSRC,RE3761C054
     C*
     C           ZIFD      IFEQ 31                         - B3
     C                     ADD  30        ZID1
     C                     ELSE                            - X3
     C                     ADD  ZIFD      ZID1
     C                     END                             - E3
     C*
     C                     SUB  1         ZIFM
     C*
     C           ZISY      IFEQ ZIFY                       - B3
     C           ZIFM      SUB  ZISM      ZINOM   30
     C                     ELSE                            - X3
     C           12        SUB  ZISM      ZIM1
     C                     Z-ADD1         ZISM
     C*
     C** USE ENLARGE FIELDS THAT CAN HANDLE 1999 ONWARDS
     C*
     C                     ADD  1         ZISY2
     C           ZIFY2     SUB  ZISY2     ZIY1
     C           ZIY1      MULT 12        ZIM2    30
     C           ZIM2      ADD  ZIFM      ZIM2
     C           ZIM2      ADD  ZIM1      ZINOM
     C*
     C                     END                             - E3
     C*
     C           ZINOM     MULT 30        ZID2
     C           ZID2      ADD  ZID1      ZDAYN1
     C*
     C                     END                             - E2
     C*
     C                     END                             - E1
     C*
     C           ZICALC    IFEQ 4                          - B1
     C           ZICALC    OREQ 5
     C*
     C** ONE DAY IS SUBTRACTED FROM ZDAYN1 FOR EACH OCCURANCE OF 29 FEB IN THE
     C** THE INTEREST CALCULATION PERIOD INCLUSIVE OF ZIBEG AND ZIEND
     C*
     C** FIND NO OF FOUR YEAR PERIODS BETWEEN DATES
     C*
     C           ZDAYN1    DIV  1461      ZIMAN
     C                     MVR            ZIREM
     C*
     C** FIND NEXT 29 FEB DAY NO. ON OR AFTER ZIBEG.
     C*
     C           ZIBEG     SUB  60        ZIBW1
     C           ZIBW1     DIV  1461      ZIDW1
     C                     MVR            ZIDREM
     C*
     C           ZIDREM    IFEQ 0                          - B2
     C                     Z-ADDZIBEG     ZIDW2
     C                     END                             - E2
     C*
     C** ROUND UP RESULT
     C*
     C           ZIDW1     ADD  1         ZIDW2
     C*
     C** CALCULATE NEXT 29 FEB.
     C*
     C           ZIDW2     MULT 1461      ZIDW2
     C           ZIDW2     ADD  60        ZIDW2
     C*
     C** IF THIS NEXT 29 FEB. DAYNO - ZIBEG IS GREATER OR EQUAL TO ZIREM THEN
     C** ADD 1 TO ZIMAN.
     C*
     C           ZIDW2     SUB  ZIBEG     ZILPCP
     C*
     C           ZIREM     IFGE ZILPCP                     - B2
     C                     ADD  1         ZIMAN
     C                     END                             - E2
     C*
     C** SUBTRACT ZIMAN FROM ZDAYN1 TO GIVE VALUE OF ZDAYN1 REQUIRED FOR THIS
     C** INTEREST CALCULATION
     C*
     C           ZDAYN1    SUB  ZIMAN     ZDAYN1
     C*
     C                     END                             - E1
     C*
     C                     ENDSR                           **ZICD ENDSR**
     C********************************************************************
     C*
     C* *PSSR  --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS
     C*
     C* CALLED FROM: AFTER ABNORNAL OPERATION OCCURS
     C*
     C* CALLS: NOTHING
     C*
     C********************************************************************
     C*
     C           *PSSR     BEGSR                           ** *PSSR **
     C*
     C           @RUN      IFEQ *BLANKS
     C                     MOVE 'Y'       @RUN    1
     C                     DUMP
     C                     END
     C                     SETON                     U7U8LR               105294
     C*
     C                     ENDSR                           ** *PSSR **
     C*****************************************************************
      * SRAPRC - Credit Output Processing                                                     CER050
      ********************************************************************                    CER050
      *                                                                                       CER050
     C           SRAPRC    BEGSR                                                              CER050
      *                                                                                       CER050
     C                     MOVEL'APR Rate'TANAR                                               CER050
     C           ACNO      CHAINREAPRHI1             99                                       CER050
     C           *IN99     IFEQ *OFF                                                          CER050
     C                     EXSR OVERCR                                                        CER050
     C                     WRITEAPRCR                                                         CER050
     C                     ENDIF                                                              CER050
      *                                                                                       CER050
     C                     ENDSR                                                              CER050
      ********************************************************************                    CER050
      * SRAPRD - Debit Output Processing                                                      CER050
      ********************************************************************                    CER050
      *                                                                                       CER050
     C           SRAPRD    BEGSR                                                              CER050
      *                                                                                       CER050
     C                     MOVEL'APR Rate'TANAR                                               CER050
     C           ACNO      CHAINREAPRHI0             99                                       CER050
     C           *IN99     IFEQ *OFF                                                          CER050
     C                     EXSR OVERDR                                                        CER050
     C                     WRITEAPRDR                                                         CER050
     C                     ENDIF                                                              CER050
      *                                                                                       CER050
     C                     ENDSR                                                              CER050
      ********************************************************************                    CER050
     C/COPY ZSRSRC,ZDATE2Z2
     C/COPY WNCPYSRC,RE3761C006
**   CMD - COMMAND TO OVERIDE MESSAGE FILE
OVRMSGF MSGF(  REPRTMSGF) TOMSGF(GBREPRTMSGF)
**  CPY@
(c) Finastra International Limited 2001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
