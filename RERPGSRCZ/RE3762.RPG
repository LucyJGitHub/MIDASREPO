     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas RE Int statement print ICD 2 (no with/h tax)')   *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Retail Module                                        *
     F*                                                               *
     F*  RE3762 - INTEREST STATEMENT PRINT ICD 2                      *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
     F*                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      *  Prev Amend No. MD038030           Date 01Apr16               *
      *                 MD037149           Date 11May16               *
      *                 CGL165             Date 17Feb15               *
      *                 MD024700           Date 14Apr14               *
      *                 CRE083             Date 06Aug12               *
      *                 CRE075             Date 06Dec10               *
      *                 CER059             Date 19Jul10               *
      *                 BUG24136           Date 03Jun09               *
      *                 BUG23123           Date 09Mar09               *
      *                 CER048             Date 19May08               *
      *                 CER016             Date 19May08               *
      *                 CER047             Date 19May08               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CDL013             Date 11Jul06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027A            Date 11May06               *
      *                 CSD027             Date 09Dec05               *
      *                 235917             Date 08Sep05               *
      *                 CGL031             Date 05Jul04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4.01 -------------------------------------------*
      *                 194059             Date 06Aug01               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 182452             Date 20Jun01               *
      *                 CDE002             Date 21Dec99               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 180892             Date 14Nov00               *
      * Midas DBA 3.03 -----------------------------------------------*
      * Midas DBA 3.02 -----------------------------------------------*
      *                 CFT004             Date 27Jul99               *
      *                 160301             Date 05Jul99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*                 130468             Date 29Apr99               *
     F*                 104618             DATE 19May98               *
     F*                 125176             DATE 12Feb98               *
     F*                 105294             DATE 05Sep97               *
     F*                 114487             DATE 04SEP97               *
     F*                 CRE001             Date 18Feb97               *
     F*                 CRE003             Date 10Jun96               *
     F*                 094657             Date 25Nov95               *
     F*                 098818             DATE 15APR96               *
     F*                 094431             DATE 16OCT95               *
     F*                 S01408             DATE 16APR96               *
     F*                 S01408             DATE 31MAR96               *
     F*                 S01408             DATE 22FEB95               *
     F*                 040447             DATE 28SEP93               *
     F*                 S01413 *CREATE     DATE 13APR93               *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  MD038030 - With CFT004 on, address is not printed on         *
      *             statement. Use a different variable for CRE083.   *
      *  MD037149 - ORF Queries not running (Recompile)               *
      *  CGL165 - Dual Withholding Tax (Recompile)                    *
      *  MD024700 - Recompile due to changes in RE3764CR, RE3764DR,   *
      *             and RE3765CH.                                     *
      *  CRE083 - COB Restructure - RE COB Optimisation Phase 1       *
      *  CRE075 - Effective Date for Retail Accounts (Recompile)      *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  BUG24136 - Problem with data not showing on Retail Reports   *
      *             (Recompile)                                       *
      *  BUG23123 - Report: Does not show Retail Account Number       *
      *                     Date is not Midas Standard Date           *
      *                     Period should be actual int. calc. period *
      *                     Secondary Tax amount is not printed       *
      *                     Added field TSSLID                        *
      *                     (Recompile)                               *
      *  CER048 - German Features - Taxes                             *
      *  CER016 - German Interest Calculation: Upgrade of FGE059      *
      *           to Midas Plus                                       *
      *  CER047 - German Features LF037-00 Reporting §24c KWG         *
      *           (Recompile)                                         *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (Recompile)                                         *
      *  CDL013 - Tiered Withholding Tax                              *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027A - Conversion Of Customer Number to Alpha             *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  235917 - No EU tax printed for joint accounts                *
      *  CGL031 - Taxation On Savings Income                          *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  194059 - Rename TRAT in files REHRDJ and REHRCJ.             *
      *  182452 - Errors on the Retail Interest capitalisation        *
      *           report for interest types 03 and 04.  Amendments    *
      *           include:                                            *
      *           1. Move the history balance to the output field     *
      *              to display the running balance every change in   *
      *              value date.                                      *
      *           2. Checked the interest types (DCICT/DDICT) from    *
      *              REHISL instead of the RECAPM to avoid errors     *
      *              when there is a change of interest types between *
      *              capitalisations.                                 *
      *           3. Prevent DBError at 22 in REHRCJ.                 *
      *              Applied fix 183573.                              *
      *           4. Prevent DBError at 09, 06, 04 and 02 in REHISL.  *
      *              Applied fix 194056.                              *
      *  CDE002 - Revenue Analysis - Recompiled due to changes in     *
      *           PF/RETAXJL.                                         *
      *  180892 - Incorrect coding of CRE001 for overdraft printing.  *
      *           Re-apply CRE001 correctly for overdraft printing.   *
      *  CFT004 - Straight Through Processing Phase 2                 *
      *           International Bank Account Numbers (IBAN)           *
     F*  160301 - Interest adjustments and backvalued items reported  *
     F*           incorrectly and CR interest reported with the wrong *
     F*           sign. Apply changes as per RE3763/RE3761.           *
     F*  130468 - BRT not deducted from CR interest adjustments.      *
     F*           Also report total adjustments (CSGADI/CSGACI).      *
     F*  104618 - Choose correct BRT rate in same way as RE3664.      *
     F*  125176 - Amended to take account of changes to PRTF/RE3764DC *
     F*           for RE3763:                                         *
     F*           1. Use NUMB0/1/2/3 according to decimal places.     *
     F*           2. Rate change reporting as per RE3761 & RE3763.    *
     F*           3. Gen. adjs.: add posting date, take out hist. bal.*
     F*           4. Correct reporting of alternative a/c.            *
     F*           Also: Extra narratives set up as per RE3761/RE3763  *
     F*           (needed for (4)), backvalue processing amended to   *
     F*           cope with changed REHPOPH (LF now includes rate     *
     F*           changes) & missing call to B1LT added (1 line fix). *
     F*  105294 - This report can fail on a DB error but not stop     *
     F*           the COB. Review U7U8LR processing.                  *
     F*  114487 - Non-rebatable charge amount not set up causing      *
     F*           CPF5075 I/O error in RE3765CH.  Applied fix GEMS    *
     F*           No. 087916.  MSG array physically deleted for SC    *
     F*           114487.                                             *
     F*  CRE001 - Overdraft Interest Calculations                     *
     F*         - Include O/D Line and O/D Interest Rate Changes to   *
     F*           Debit Capitalisation Report.                        *
     F*  CRE003 - Ledger Balance Accruals                             *
     F*  094657 - Suppress customer address details if specified.     *
     F*  098818 - Allow for interest capital indicator on REHISPS     *
     F*           to retain its original values of 'C' 'D' 'Y' &      *
     F*           ' ' to be used by input cycle enquiries.            *
     F*  094431 - Recompiled over changed REHISSL and REHPOPH.        *
     F*  S01408 - Addition of core hook RE3762CCP8                    *
     F*  S01408 - Addition of core hook RE3762CCP7                    *
     F*  S01408 - Addition of core hook RE3762CPD1                    *
     F*           Addition of core hook RE3762CPD2                    *
     F*           Addition of core hook RE3762CCP4                    *
     F*           Addition of core hook RE3762CCPG                    *
     F*           Addition of core hook RE3762CCP1                    *
     F*           Addition of core hook RE3762CCP2                    *
     F*           Addition of core hook RE3762CCP3                    *
     F*           Addition of core hook RE3762CPDR                    *
     F*           Addition of core hook RE3762CCP5                    *
     F*           Addition of core hook RE3762CCP6                    *
     F*           Addition of core hook RE3762FFPG                    *
     F*           Addition of core hook RE3762IIPG                    *
     F*  040447 - Print the right opening rate (apply a part of       *
     F*           30119 in RE3762 pgm)                                *
     F*  S01413 - Retail 3 Incorporation                              *
     F*                                                               *
     F*****************************************************************
     FRECAPML IF  E           K        DISK
     FCLINT   IF  E           K        DISK
     FREHISL  IF  E           K        DISK
     FREHISSL IF  E           K        DISK
     F            REHISPSF                          KRENAMEREADJF
     FRECOM   IF  E           K        DISK
     FREHPOPL IF  E           K        DISK
     F            REHPOSPF                          KRENAMEREHPOPLF
     FREHPOPH IF  E           K        DISK
     F            REHPOSPF                          KRENAMEREHPOPHF
     FACCRACJ IF  E           K        DISK
     FREHRDJ  IF  E           K        DISK
     FREHRCJ  IF  E           K        DISK
     FRECRG   IF  E           K        DISK                               160301
     F            RECRGAF                           KIGNORE               160301
     F            RECRGZF                           KIGNORE               160301
     FTABTBRE IF  E                    DISK                           UC
     FSDCURRL0IF  E           K        DISK
     FSDCSINL7IF  E           K        DISK                                                   CGL031
      ** Midas SD Customer Income - Customer Number Retrieve Index                            235917
     FSDCSINLCIF  E           K        DISK                                                   235917
     F            SDCSIND0                          KRENAMESDCSINDC                           235917
      ** Midas SD Customer Income - Joint A/c Number Retrieve Index                           235917
     FSDJACCL1IF  E           K        DISK                                                   235917
      ** Midas SD Joint A/c Member Details - Retrieve Index                                   235917
     FSDMMODPDIF  E                    DISK
     FRETAXJL IF  E           K        DISK
     FACCNT   IF  E           K        DISK
     FSDBRTDL1IF  E           K        DISK
     F*                                                                   S01408
     F/COPY WNCPYSRC,RE3762FFPG                                           S01408
     F*                                                                   S01408
     FRE3765CHO   E             74     PRINTER      KINFDS SPOOL1     UC
     FRE3764DCO   E             73     PRINTER      KINFDS SPOOL      UC
     FRE3764AUO   E             72     PRINTER      KINFDS SPOOLU
     F*****************************************************************
     F*                                                               *
     F*  F U N C T I O N   O F  I N D I C A T O R S                   *
     F*                                                               *
     F*  01  DEBIT CAPITALISATION                                     *
     F*  02  CREDIT CAPITALISATION                                    *
     F*  03  SUMMARY CONSOLIDATED REPORT                              *
     F*  20  IN CASE OF BACK VALUE PROCESSING                         *
     F*  21  OUTPUT EUT DETAILS TO REPORT                             *                       CGL031
     F*  22  OUTPUT BRT DETAILS TO REPORT                             *
     F*  30  CAPITALISATION IS ON DEMAND OR FOR MANAGEMENT STMT.      *   104618
     F*  23  PRINT CUSTOMER ADDRESS DETAILS                           *   094657
     F*  41  TO PRINT SIGN FOR WITHHOLDING TAX                        *
     F*  48  TOTAL CREDITED                                           *
     F*  49  TOTAL DEBITED                                            *
     F*  50  USE WITH REDETM                                          *
     F*  51  USE WITH REHISL                                          *
     F*  52  USE WITH REHISL                                          *
     F*  55  Do not report exchange rate for alt. a/c in diff. ccy    *   125176
     F*  60  USE WITH REHRDJ AND REHRCJ                               *
     F*  70  MANAGEMENT STATEMENT PRINT                               *
     F*  73  OVERFLOW INDICATORE ON PRINTER FOR DEBIT AND CREDIT      *
     F*  80  NUMBER OF DECIMAL POSITION WITH CURRENCY = 0             *
     F*  81  NUMBER OF DECIMAL POSITION WITH CURRENCY = 1             *
     F*  82  NUMBER OF DECIMAL POSITION WITH CURRENCY = 2             *
     F*  83  NUMBER OF DECIMAL POSITION WITH CURRENCY = 3             *
     F*  84  Tiered interest                                          *   125176
     F***85**MULTIBRANCHING*OUTPUT*INDICATOR                          *   125176
     F*  85  Threshold interest                                       *   125176
     F*  86  MULTIBRANCHING INDICATOR MBIN = 'Y'                      *
     F*  87  CAPITALISATION TO AN ACCOUNT IN DIFFERENT CURRENCY       *
     F****** AND MULTIBRANCH PRESENT **********************************   125176
     F*  88  CHARGES FOR MULTIPLE TRANSACTION PRESENT                 *
     F*  89  USE TO PRINT END OF AUDIT WHEN DB ERROR                  *
     F*  96  CURRENCIES ARRAY IS FULL                                 *
     F*  97  USE IF CURRENCY EXIST                                    *
     F*  98  DATF = M                                                 *
     F*  99  GENERAL ERROR AND CHAINING                               *
     F*                                                               *
     F*  U1  MANAGEMENT STATEMENT PRINT                               *
     F*  U7  DATABASE ERROR                                           *
     F*  U8  DATABASE ERROR                                           *
     F*  LR  END OF PROGRAM                                           *
     F*                                                               *
     F*  DB ERROR NUMBER MAXIMUM 52 (INCLUDE)                         *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
     F*  S U B R O U T I N E   I N D E X                              *
     F*                                                               *
     F*  BOTHSR - Credit and Debit processing                         *
     F*  B1EQ   - When debit and credit begin at the same date        *
     F*  B1GT   - When debit begin before credit                      *
     F*  B1LT   - When credit begin before debit                      *
     F*  CALBRT - Calculate base rate tax                             *
     F*  CALEUT - Calculate EU withholding tax                        *                       CGL031
     F*  CLMSG  - Clear message                                       *
     F*  CRSR   - Credit only processing                              *
     F*  DAYTSR - Prepare and output days total                       *
     F*  DBSR   - Database error handling                             *
     F*  DRSR   - Debit only processing                               *
     F*  DETPR  - Detail processing                                   *
     F*  FIRST  - First cycle                                         *
     F*  ITYPCR - Interest type greater than 2                        *
     F*  ITYPDR - Interest type greater than 2                        *
     F*  MAIN   - Main processing                                     *
     F*  OPENCR - Credit opening bal and credit opening rate ouput    *
     F*  OPENDR - Debit opening bal and debit opening rate output     *
     F*  OVERDC - Subroutine for processing overflow on RE3764DC      *
     F*  POSTSR - Posting output                                      *
     F*  RATEC  - Prepare and output credit rate change               *
     F*  RATED  - Prepare and output debit rate change                *
     F*  RATESR - Rate change processing                              *
     F*  RCRSR  - Credit rate change output                           *
     F*  RDRSR  - Debit rate change output                            *
     F*  TOTAL  - Total processing                                    *
     F*  TOTSR  - Days total output for crdeit and debit              *
     F*  ZICD   - Find number of days to calculate interest according *
     F*           to calculation basis                                *
     F*  *PSSR  - Error subroutine for certain access object errors   *
     F*                                                               *
     F*****************************************************************
     F/SPACE 3
     E                    CCYA      200  3
     E                    DPA       200  1 0
     E                    RTA        12 11 7                              125176
     E                    BLA        12 15 0                              125176
     E                    CMD     1   1 39
     E                    CPY@    1   1 80
     E/COPY WNCPYSRC,RE3762E001
     E******************* NAR        26 39                                CRE001
     E******************* NAR        29 39                         CRE001 125176
     E******************* NAR        39 39                         125176 160301
     E                    NAR        41 39                                160301
     E/COPY WNCPYSRC,RE3762E002
     E***********         MSG     1   2 10                                114487
     E/COPY ZSRSRC,ZDATE2Z1
      *                                                                   160301
     IRECRGDF                                                             160301
     I*                                                                   160301
     I** RENAME RECRGDF FORMAT - RECRGD FILE                              160301
     I*                                                                   160301
     I              RECI                            GRECI                 160301
     I              ACOD                            GACOD                 160301
     IREADJF
     I*
     I** RENAME READJF   FORMAT FIELDS - REHISSL FILE
     I*
     I              RECI                            ARECI
     I              BRCA                            ABRCA
     I              CNUM                            ACNUM
     I              CCY                             ACCY
     I              ACOD                            AACOD
     I              ACSQ                            AACSQ
     I              HISD                            AHISD
     I              HISB                            AHISB
     I              MNBL                            AMNBL
     I              PCHGAR                          ACHGAR
     I              TCHGAR                          ATHGAR
     I              PCHGAN                          ACHGAN
     I              TCHGAN                          ATHGAN
     I              DICT                            ADICT
     I              DRIR                            ADRIR                 160301
     I              DRCB                            ADRCB
     I              DRCD                            ADRCD
     I              DAIC                            ADAIC
     I              PMADI                           APMADI
     I              TMADI                           ATMADI
     I              PDID                            APDID
     I              DMINT                           ADMINT
     I              SGADI                           ASGADI                160301
     I              DRIP                            ADRIP
     I              SDICI                           ASDICI                160301
     I              DRIS                            ADRIS
     I              SDACP                           ASDACP                160301
     I              SDCI                            ASDCI                 160301
     I              CICT                            ACICT
     I              CRCB                            ACRCB
     I              CRIR                            ACRIR                 160301
     I              CRCD                            ACRCD
     I              CAIC                            ACAIC
     I              PMACI                           APMACI
     I              TMACI                           ATMACI
     I              PCID                            APCID
     I              CMINT                           ACMINT
     I              SGACI                           ASGACI                160301
     I              CRIP                            ACRIP
     I              SCICI                           ASCICI                160301
     I              CRIS                            ACRIS
     I              SCACP                           ASCACP                160301
     I              SCCI                            ASCCI                 160301
     I              STBL                            ASTBL
     I              CHGP                            ACHGP
     I              SCHAC                           ASCHAC                160301
     I              MNBCP                           AMNBCP                160301
     I              SCHGI                           ASCHGI                160301
     I              TEGLIS                          AEGLIS                160301
     I              DEXRT                           ADEXRT                160301
     I              CEXRT                           ACEXRT                160301
     I              CHXRT                           ACHXRT                160301
     I              DRBR                            ADRBR                 160301
     I              CRBR                            ACRBR                 160301
     I              CHBR                            ACHBR                 160301
     I              AODR                            AAODR                 160301
     I              ODRL                            AODRL                 160301
     I              ODIA                            AODIA                 160301
     IREHISPSF
     I*
     I** RENAME REHISPSF FORMAT FIELDS - REHISL  FILE
     I*
     I              RECI                            DRECI
     I              BRCA                            SBRCA
     I              CNUM                            SCNUM
     I              CCY                             SCCY
     I              ACOD                            SACOD
     I              ACSQ                            SACSQ
     I              HISD                            DHISD
     I              HISB                            DHISB
     I              MNBL                            SMNBL
     I              PCHGAR                          SCHGAR
     I              TCHGAR                          STHGAR
     I              PCHGAN                          SCHGAN
     I              TCHGAN                          STHGAN
     I              DICT                            DDICT
     I              DRCB                            SDRCB
     I              DRCD                            SDRCD
     I              DAIC                            SDAIC
     I              PMADI                           SPMADI
     I************* TMADI                           STMADI                160301
     I              TMADI                           DTMADI                160301
     I              PDID                            SPDID
     I              DMINT                           SDMINT
     I              DRIP                            SDRIP
     I              DRIS                            SDRIS
     I              CICT                            DCICT
     I              CRCB                            SCRCB
     I              CRCD                            SCRCD
     I              CAIC                            SCAIC
     I              PMACI                           SPMACI
     I************* TMACI                           STMACI                160301
     I              TMACI                           DTMACI                160301
     I              PCID                            SPCID
     I              CMINT                           SCMINT
     I              CRIP                            SCRIP
     I              CRIS                            SCRIS
     I              STBL                            SSTBL
     I              CHGP                            SCHGP
     IREHISPPF
     I*
     I** RENAME REHISPPF FORMAT FIELDS - REHISL  FILE
     I*
     I              RECI                            DRECI
     I              BRCA                            DBRCA
     I              CNUM                            DCNUM
     I              CCY                             DCCY
     I              ACOD                            DACOD
     I              ACSQ                            DACSQ
     I              HISD                            DHISD
     I              HISB                            DHISB
     I              MNBL                            DMNBL
     I              CHGAR                           DCHGAR
     I              TCHGAR                          DTHGAR
     I              CHGAN                           DCHGAN
     I              TCHGAN                          DTHGAN
     I              DMVT                            DDMVT
     I              DICT                            DDICT
     I              DRCB                            DDRCB
     I              DRCD                            DDRCD
     I              DAID                            DDAID
     I              MADI                            DMADI
     I              TMADI                           DTMADI
     I              PDID                            DPDID
     I              DMINT                           DDMINT
     I              CMVT                            DCMVT
     I              CICT                            DCICT
     I              CRCB                            DCRCB
     I              CRCD                            DCRCD
     I              CAID                            DCAID
     I              MACI                            DMACI
     I              TMACI                           DTMACI
     I              PCID                            DPCID
     I              CMINT                           DCMINT
     I              DICI                            DDICI
     I              CICI                            DCICI
     I              DRCI                            DDRCI
     I              CRCI                            DCRCI
     I              VDTC                            DVDTC
     I              ADTY                            DADTY
     I              ALTI                            DALTI
     I              MNBCP                           DMNBCP
     IREHISPMF
     I*
     I** RENAME REHISPMF FORMAT FIELDS - REHISL  FILE
     I*
     I              RECI                            DRECI
     I              HISD                            MHISD
     I*
     IREHRDJF
     I*
     I** RENAME REHRDJF  FORMAT FIELDS - REHRDJ  FILE
     I*
     I              RECI                            RRECI
     I              PSTD                            RPSTD
     I              VALD                            RVALD
     I              HISD                            RHISD
     I              PNAR                            RPNAR
     I              DRCR                            RDRCR
     I              TRAT                            RTRAT                                     194059
     I*
     IREHRCJF
     I*
     I** RENAME REHRCJF  FORMAT FIELDS - REHRCJ  FILE
     I*
     I              RECI                            RRECI
     I              PSTD                            RPSTD
     I              VALD                            RVALD
     I              HISD                            RHISD
     I              PNAR                            RPNAR
     I              DRCR                            RDRCR
     I              TRAT                            RTRAT                                     194059
     I*
     I* BRT ICD
     ISDBRTDD0
     I              ACOD                            ACODXX
     I/COPY WNCPYSRC,RE3762I001
     I*
     ICPYR@#      DS
     I*
     I** DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     I*
     I                                        1  80 CPY@
     I*
     I**
     ISDBANK    E DSSDBANKPD
     I              BJURPT                          TITL
     I**  EXTERNAL DS FOR BANK DETAILS
     I**
     I*
     ISDRETL    E DSSDRETLPD                                              104618
     I              BMLDAI                          LDAC                  104618
     I              BMCBAI                          CBAI                  104618
     I              BMNDFV                          NDFV                  104618
     I              BMNDBI                          NDBI                  104618
     I              BMRCPI                          RCPT                  104618
     I              BMRANR                          RACN                  104618
     I**  Retail Details                                                  104618
     I*                                                                   104618
     I** Key data structure : CHKEY to chain to RECRG file                160301
     I*                                                                   160301
     I            DS                                                      160301
     I                                        1  12 CHKEY                 160301
     I                                        1   1 BLANK1                160301
     I                                        2   30CHGT                  160301
     I                                        4   80CHST                  160301
     I                                        9  11 WCCCY                 160301
     I                                       12  12 ENDK                  160301
     I*                                                                   160301
     I** DATA STRUCTURE FOR BEGINNING DATE
     I*
     I            DS
     I                                        1   60SRES
     I                                        1   20ZISD
     I                                        3   40ZISM
     I                                        5   60ZISY
     I*
     I** DATA STRUCTURE FOR FINISHING DATE
     I*
     I            DS
     I                                        1   60FRES
     I                                        1   20ZIFD
     I                                        3   40ZIFM
     I                                        5   60ZIFY
     I*
     I** DATA STRUCTURE FOR CURRENCY DECIMAL
     I*
     I            DS
     I                                        1  150HISB0
     I                                        1  151HISB1
     I                                        1  152HISB2
     I                                        1  153HISB3
      *                                                                   125176
     I            DS                                                      125176
     I                                        1  150NUMB0                 125176
     I                                        1  151NUMB1                 125176
     I                                        1  152NUMB2                 125176
     I                                        1  153NUMB3                 125176
     I*
     I            DS
     I                                        1  150TCHR0
     I                                        1  151TCHR1
     I                                        1  152TCHR2
     I                                        1  153TCHR3
     I*
     I            DS
     I                                        1  150TCHN0
     I                                        1  151TCHN1
     I                                        1  152TCHN2
     I                                        1  153TCHN3
     I*
     I            DS
     I                                        1  150CHGP0
     I                                        1  151CHGP1
     I                                        1  152CHGP2
     I                                        1  153CHGP3
     I*
     I            DS
     I                                        1  150CHGR0
     I                                        1  151CHGR1
     I                                        1  152CHGR2
     I                                        1  153CHGR3
     I*
     I            DS
     I                                        1  150CHGN0
     I                                        1  151CHGN1
     I                                        1  152CHGN2
     I                                        1  153CHGN3
     I*
     I            DS
     I                                        1  150TINTD0
     I                                        1  151TINTD1
     I                                        1  152TINTD2
     I                                        1  153TINTD3
     I*
     I            DS
     I                                        1  150TINTC0
     I                                        1  151TINTC1
     I                                        1  152TINTC2
     I                                        1  153TINTC3
     I*
     I            DS
     I                                        1  150TGINT0
     I                                        1  151TGINT1
     I                                        1  152TGINT2
     I                                        1  153TGINT3
     I*
     I            DS
     I                                        1  150BRTOT0
     I                                        1  151BRTOT1
     I                                        1  152BRTOT2
     I                                        1  153BRTOT3
      *                                                                                       CGL031
     I            DS                                                                          CGL031
     I                                        1  150EUTAX0                                    CGL031
     I                                        1  151EUTAX1                                    CGL031
     I                                        1  152EUTAX2                                    CGL031
     I                                        1  153EUTAX3                                    CGL031
     I*
      *                                                                                       CER048
     I            DS                                                                          CER048
     I                                        1  150STAX0                                     CER048
     I                                        1  151STAX1                                     CER048
     I                                        1  152STAX2                                     CER048
     I                                        1  153STAX3                                     CER048
     I            DS
     I                                        1  150PSTD0
     I                                        1  151PSTD1
     I                                        1  152PSTD2
     I                                        1  153PSTD3
     I*
     I            DS
     I                                        1  150INTC0
     I                                        1  151INTC1
     I                                        1  152INTC2
     I                                        1  153INTC3
     I*
     I            DS
     I                                        1  150INTD0
     I                                        1  151INTD1
     I                                        1  152INTD2
     I                                        1  153INTD3
     I*
     I            DS
     I                                        1  150MNBL
     I                                        1  150MNBL0
     I                                        1  151MNBL1
     I                                        1  152MNBL2
     I                                        1  153MNBL3
     I*
     I            DS
     I                                        1  150SMNBL
     I                                        1  150SMNBL0
     I                                        1  151SMNBL1
     I                                        1  152SMNBL2
     I                                        1  153SMNBL3
      *                                                                   125176
     I            DS                                                      125176
     I                                        1  117ORAT1                 125176
     I                                        1  11 ORATC                 125176
     I*
     I            DS
     I                                        1  150OBAL01
     I                                        1  151OBAL11
     I                                        1  152OBAL21
     I                                        1  153OBAL31
     I                                        1  15 OBALC                 125176
     I*
     I************DS                                                      125176
     I************                            1  150OBAL02                125176
     I************                            1  151OBAL12                125176
     I************                            1  152OBAL22                125176
     I************                            1  153OBAL32                125176
     I*
     I************DS                                                      125176
     I************                            1  150OBAL03                125176
     I************                            1  151OBAL13                125176
     I************                            1  152OBAL23                125176
     I************                            1  153OBAL33                125176
     I*
     I***DATA*STRUCTURE FOR RATE SPREAD                                   125176
     I*
     I**********  DS                                                      125176
     I**********                              1  36 RAT2                  125176
     I**********                          P   1   67RAT21                 125176
     I**********                          P   7  127RAT22                 125176
     I**********                          P  13  187RAT23                 125176
     I**********                          P  19  247RAT24                 125176
     I**********                          P  25  307RAT25                 125176
     I**********                          P  31  367RAT26                 125176
     I**********                              1   6 RATC21                125176
     I**********                              7  12 RATC22                125176
     I**********                             13  18 RATC23                125176
     I**********                             19  24 RATC24                125176
     I**********                             25  30 RATC25                125176
     I**********                             31  36 RATC26                125176
     I*
     I**********  DS                                                      125176
     I**********                              1  36 RAT3                  125176
     I**********                          P   1   67RAT31                 125176
     I**********                          P   7  127RAT32                 125176
     I**********                          P  13  187RAT33                 125176
     I**********                          P  19  247RAT34                 125176
     I**********                          P  25  307RAT35                 125176
     I**********                          P  31  367RAT36                 125176
     I**********                              1   6 RATC31                125176
     I**********                              7  12 RATC32                125176
     I**********                             13  18 RATC33                125176
     I**********                             19  24 RATC34                125176
     I**********                             25  30 RATC35                125176
     I**********                             31  36 RATC36                125176
      *                                                                   125176
      * Define rates as an array                                          125176
     I            DS                                                      125176
     I                                        1  72 RAT23                 125176
     I                                        1  36 RAT2                  125176
     I                                       37  72 RAT3                  125176
     I                                    P   1  72 RTA                   125176
     I*
     I***DATA*STRUCTURE*FOR*BALANCE                                       125176
     I*
     I**********  DS                                                      125176
     I**********                              1  48 BAL2                  125176
     I**********                          P   1   80BAL21                 125176
     I**********                          P   9  160BAL22                 125176
     I**********                          P  17  240BAL23                 125176
     I**********                          P  25  320BAL24                 125176
     I**********                          P  33  400BAL25                 125176
     I**********                          P  41  480BAL26                 125176
     I**********                              1   8 BALC21                125176
     I**********                              9  16 BALC22                125176
     I**********                             17  24 BALC23                125176
     I**********                             25  32 BALC24                125176
     I**********                             33  40 BALC25                125176
     I**********                             41  48 BALC26                125176
     I*
     I**********  DS                                                      125176
     I**********                              1  48 BAL3                  125176
     I**********                          P   1   80BAL31                 125176
     I**********                          P   9  160BAL32                 125176
     I**********                          P  17  240BAL33                 125176
     I**********                          P  25  320BAL34                 125176
     I**********                          P  33  400BAL35                 125176
     I**********                          P  41  480BAL36                 125176
     I**********                              1   8 BALC31                125176
     I**********                              9  16 BALC32                125176
     I**********                             17  24 BALC33                125176
     I**********                             25  32 BALC34                125176
     I**********                             33  40 BALC35                125176
     I**********                             41  48 BALC36                125176
      *                                                                   125176
      * Define balances as an array                                       125176
     I            DS                                                      125176
     I                                        1  96 BAL23                 125176
     I                                        1  48 BAL2                  125176
     I                                       49  96 BAL3                  125176
     I                                    P   1  96 BLA                   125176
     I*
     I** DATA STRUCTURE FOR DATE FORMAT DD/MM/YY
     I*
     I            DS
     I                                        1   60RESULT
     I                                        1   20ZDAY
     I                                        3   40ZMTH
     I                                        5   60ZYEAR
     I*
     IOKEYD       DS
     I**********                              1  18 OKEY                                      CGL029
     I                                        1  24 OKEY                                      CGL029
     I                                        1   3 OBRCA
     I**********                              4   90OCNUM                                    CSD027A
     I                                        4   9 OCNUM                                    CSD027A
     I                                       10  12 OCCY
     I**********                             13  160OACOD                                     CGL029
     I**********                             17  180OACSQ                                     CGL029
     I**********                          P  19  210OLDID                                     CGL029
     I                                       13  220OACOD                                     CGL029
     I                                       23  240OACSQ                                     CGL029
     I                                    P  25  270OLDID                                     CGL029
     I*
     I**   NAME OF MESSAGE FILE
     I*
     I            DS
     I                                        1  39 CMD1
     I                                       16  17 FILT1
     I                                       33  34 FILT2
     I*
     I                                        1   8 ADREF1
     I                                        1   1 WRCDT
     I*
     IRKEY2       DS
     I**********                              1  18 RKEY                                      CGL029
     I                                        1  24 RKEY                                      CGL029
     I                                        1   3 CBRCA
     I**********                              4   90CCNUM                                     CSD027
     I                                        4   9 CCNUM                                     CSD027
     I                                       10  12 CCCY
     I**********                             13  160CACOD                                     CGL029
     I**********                             17  180CACSQ                                     CGL029
     I**********                             19  230WDATE                                     CGL029
     I                                       13  220CACOD                                     CGL029
     I                                       23  240CACSQ                                     CGL029
     I                                       25  290WDATE                                     CGL029
     I                                        1   3 CBRCA2
     I*
     I** LOCAL DATA AREA FOR DATABASE ERROR DETAILS
     I*
     ILDA        UDS                            256
     I                                      134 141 DBFILE
     I                                      142 170 DBKEY
     I                                      171 180 DBPGM
     I                                      181 1830DBASE
     I*
     I********************************************************************
     I**
     I**   FILE INFORMATION DATA STRUCTURE - P1
     I**
     ISPOOL       DS
     I                                       83  92 SFILE
     I                                    B 123 1240SFNUM
     I**
     ISPOOL1      DS
     I                                       83  92 SFILE1
     I                                    B 123 1240SFNUM1
     I**
     I**   FILE INFORMATION DATA STRUCTURE - AU
     I**
     ISPOOLU      DS
     I                                       83  92 SFILEU
     I                                    B 123 1240SFNUMU
     I**
     I** DATA AREA RUNDAT
     I**
     IRUNDT       DS
     I                                        1   7 RUNA
     I                                    P   8  100RUND
     I                                       11  11 SSF
     I                                       12  12 DATF
     I                                       13  13 MBIN
     ISDBRCH    E DSSDBRCHPD
     I**
     I              A8BRNM                          BRNM
     I*                                                                   CRE003
     I*SDRETL****E DSSDRETLPD                                      CRE003 104618
     I*                                                                   CRE003
     I** Data structure for retail details                                CRE003
     I*                                                                   CRE003
     ISCSARD    E DSSCSARDPD                                              CFT004
      ** MIDAS Switchable Features Accessed Via Access Program            CFT004
      *                                                                   CFT004
     IACCNTB    E DSACCNTAB                                               CFT004
      ** MIDAS Account Master Details Accessed Via Access Program         CFT004
      *                                                                   CFT004
     I              ADREF1                          ADREFX                CFT004
     I              LCD                             LCDX                  CFT004
     IDSFDY     E DSDSFDY
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE
     I*
     IDSSDY     E DSDSSDY                                                 CFT004
      *                                                                   CFT004
      ** Long data structure for access programs.                         CFT004
     I*
     I*
     I*                                                                   S01408
     I/COPY WNCPYSRC,RE3762IIPG                                           S01408
     I*                                                                   S01408
     C*===================================================================
     C                     MOVEACPY@      BIS@   80
     C           *NAMVAR   DEFN           LDA
     C*
     C** KEY LISTS
     C*
     C*
     C** KEY FIELD TO ACCESS TO FILE
     C*
     C**  KLIST TO ACCESS ACCNT
     C*
     C           KACCNT    KLIST
     C                     KFLD           CCNUM
     C                     KFLD           CCCY
     C                     KFLD           CACOD
     C                     KFLD           CACSQ
     C                     KFLD           CBRCA
     C*
     C**  KLIST TO CHAIN ON RECOM
     C*
     C           KLIST0    KLIST
     C                     KFLD           CBRCA
     C                     KFLD           CCNUM
     C                     KFLD           CCCY
     C                     KFLD           CACOD
     C                     KFLD           CACSQ
     C*
     C**  KLIST TO CHAIN ON 0EDETM
     C*
     C           KLIST1    KLIST
     C                     KFLD           CBRCA
     C                     KFLD           CCNUM
     C                     KFLD           CCCY
     C                     KFLD           CACOD
     C                     KFLD           CACSQ
     C*
     C**  KLIST TO READ REHISL FOR DEBIT
     C*
     C           KLIST2    KLIST
     C                     KFLD           CBRCA
     C                     KFLD           CCNUM
     C                     KFLD           CCCY
     C                     KFLD           CACOD
     C                     KFLD           CACSQ
     C                     KFLD           CLDID
     C*
     C**  KLIST TO READ REHISL FOR CREDIT
     C*
     C           KLIST3    KLIST
     C                     KFLD           CBRCA
     C                     KFLD           CCNUM
     C                     KFLD           CCCY
     C                     KFLD           CACOD
     C                     KFLD           CACSQ
     C                     KFLD           CLCID
     C*
     C**  KLIST TO READ CLINT
     C*
     C           KLIST4    KLIST
     C                     KFLD           CCNUM
     C                     KFLD           RCDT
     C*
     C**  KLIST TO CHAIN ON REHRDJ
     C*
     C           KLIST5    KLIST
     C                     KFLD           CBRCA
     C                     KFLD           CCNUM
     C                     KFLD           CCCY
     C                     KFLD           CACOD
     C                     KFLD           CACSQ
     C                     KFLD           DDRCD
     C*
     C**  KLIST TO CHAIN ON REHRCJ
     C*
     C           KLIST6    KLIST
     C                     KFLD           CBRCA
     C                     KFLD           CCNUM
     C                     KFLD           CCCY
     C                     KFLD           CACOD
     C                     KFLD           CACSQ
     C                     KFLD           DCRCD
      *                                                                                       CGL031
      ** KLIST to read SDCSINL7                                                               CGL031
      *                                                                                       CGL031
     C           KLIST7    KLIST                                                              CGL031
     C                     KFLD           RUND                                                CGL031
     C                     KFLD           MODI    1                                           CGL031
     C                     KFLD           CCNUMX  6                                           CGL031
     C                     KFLD           CCCY                                                CGL031
     C                     KFLD           CACOD                                               CGL031
     C                     KFLD           CACSQ                                               CGL031
     C                     KFLD           CBRCA                                               CGL031
     C*                                                                                       235917
      ** Key fields to access LF/SDCSINLC.                                                    235917
      *                                                                                       235917
     C           KLISTC    KLIST                                                              235917
     C                     KFLD           RUND                                                235917
     C                     KFLD           MODI                                                235917
     C                     KFLD           KJOIN                                               235917
     C                     KFLD           CCCY                                                235917
     C                     KFLD           CACOD                                               235917
     C                     KFLD           CACSQ                                               235917
     C                     KFLD           CBRCA                                               235917
     C*
     C****KLIST*TO*ACCESS REHRDJ AND REHRCJ                               125176
     C*
     C********** KEODLF    KLIST                                          125176
     C**********           KFLD           CBRCA                           125176
     C**********           KFLD           CCNUM                           125176
     C**********           KFLD           CCCY                            125176
     C**********           KFLD           CACOD                           125176
     C**********           KFLD           CACSQ                           125176
     C**********           KFLD           KDATE                           125176
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3762CCPG                                           S01408
     C*                                                                   S01408
     C*
     C** PARAMTER SEND BY THE CL: IT IS THE LANGUAGE CODE DEFAULT
     C*
     C           *ENTRY    PLIST
     C                     PARM           DLGID
     C*
     C** SET UP PARAMETER TO FORM OUTPUT LINE
     C*
     C           ZA1311    PLIST
     C                     PARM           MSGID   7
     C                     PARM           MSGDT0 40
     C                     PARM           MSGDT1 40
     C                     PARM           MSGDT2 40
     C                     PARM           MSGDT3 40
     C                     PARM           MSGDT4 40
     C                     PARM           MSGDT5 40
     C                     PARM           MSGDT6 40
     C                     PARM           MSGDT7 40
     C                     PARM           MSGDT8 40
     C                     PARM           MSGDT9 40
     C                     PARM           MNARR 200
     C*
     C** WORK FIELDS DEFINITION
     C*
     C           *LIKE     DEFN LGID      OLGID
     C           *LIKE     DEFN DDAID     WDAID
     C           *LIKE     DEFN DCAID     WCAID
     C           *LIKE     DEFN LGID      DLGID
     C           *LIKE     DEFN DBKEY     ERRDAT
     C********** *LIKE     DEFN CNUM      I     - 3                                           CSD027
     C                     Z-ADD*ZEROS    I       30                                          CSD027
     C           *LIKE     DEFN RUND      PPSTD
     C           *LIKE     DEFN RUNA      PSTDO
     C           *LIKE     DEFN RUND      PVALD
     C           *LIKE     DEFN RUNA      VALDO
     C           *LIKE     DEFN ACNO      WACNO
     C           *LIKE     DEFN DCRCB     WCRCB
     C           *LIKE     DEFN DDRCB     WDRCB
     C           *LIKE     DEFN DHISB     WHISB
     C           *LIKE     DEFN DHISD     WHISD
     C           *LIKE     DEFN DHISD     WWHISD
     C           *LIKE     DEFN DHISD     WHISDC
     C           *LIKE     DEFN DHISD     WHISDD
     C           *LIKE     DEFN MNBL      WMNBL
     C           *LIKE     DEFN DHISB     W1STBL
     C           *LIKE     DEFN DHISB     W2STBL
     C           *LIKE     DEFN DHISB     DOHISB
     C           *LIKE     DEFN DHISB     COHISB
     C********** *LIKE     DEFN CNUM      ZERROR- 5                                           CSD027
     C                     Z-ADD*ZEROS    ZERROR  10                                          CSD027
     C           *LIKE     DEFN RUND      ZIBEG
     C           *LIKE     DEFN RUND      ZIBW1
     C           *LIKE     DEFN RUND      ZIDREM
     C           *LIKE     DEFN CICT      ZIDW1
     C           *LIKE     DEFN RUND      ZIDW2
     C           *LIKE     DEFN RUND      ZID1
     C           *LIKE     DEFN RUND      ZID2
     C           *LIKE     DEFN RUND      ZIEND
     C           *LIKE     DEFN RUND      ZILPCP
     C           *LIKE     DEFN CICT      ZIMAN
     C           *LIKE     DEFN CICT      ZIM1
     C           *LIKE     DEFN RUND      ZIREM
     C           *LIKE     DEFN CICT      ZIY1
     C           *LIKE     DEFN HISD      @HISD                           160301
     C           *LIKE     DEFN SDAIC     @GADJ                           160301
     C/COPY WNCPYSRC,RE3762C001
     C*
     C*===================================================================
     C*
     C/EJECT
     C*===================================================================
     C** P R O G R A M     S T A R T
     C*===================================================================
     C*
     C** FIRST CYCLE PROCESSING
     C*
     C                     EXSR FIRST
     C*
     C** MAIN PROCESSING
     C*
     C                     EXSR MAIN
     C*
     C** TOTAL PROCESSING
     C*
     C                     EXSR TOTAL
     C*
     C*===================================================================
     C** P R O G R A M     E N D
     C*===================================================================
     C/EJECT
     C********************************************************************
     C**
     C** BOTHSR subroutine for debit and credit output processing
     C**
     C**     Called by       D E T P R
     C**
     C**     Calls           DBSR, B1EQ, B1LT, B1GT, POSTSR, RATESR
     C**                     TOTSR, ZICD
     C**
     C           BOTHSR    BEGSR                           **BOTHSR BEGSR*
     C*
     C***********KLIST2    CHAINREHISL               52                   160301
     C           KLIST2    SETLLREHISL               52                   160301
     C           KLIST1    READEREHISL                   52               160301
     C*
     C           *IN52     IFEQ '1'                        - B1
     C                     Z-ADDCLDID     WDATE
     C                     Z-ADD1         DBASE
     C                     MOVE 'REHISL'  DBFILE           ***************
     C                     MOVELRKEY2     DBKEY            **DB ERROR 01**
     C                     MOVEA'1'       *IN,89           ***************
     C                     EXSR DBSR
     C                     END                             - E1
      *                                                                   182452
      ** Ignore REHISPM records.                                          182452
      *                                                                   182452
     C           DRECI     DOWEQ'M'                                       182452
     C           KLIST1    READEREHISL                   52               182452
     C                     END                                            182452
     C*
     C           DRECI     IFEQ 'B'                        - B1
     C                     Z-ADD*ZEROS    W1STBL
     C                     Z-ADDDDRCD     WWDRCD  50
     C                     Z-ADDDCRCD     WWCRCD  50
     C                     Z-ADDDHISD     BDATE                           125176
     C                     ELSE                            - X1
     C           DRECI     IFEQ 'S'                        - B2
     C                     Z-ADDSSTBL     W1STBL
     C                     Z-ADDSDRCD     WWDRCD
     C                     Z-ADDSCRCD     WWCRCD
     C                     ELSE                            - X2
     C                     Z-ADDCLDID     WDATE
     C                     Z-ADD2         DBASE
     C                     MOVE 'REHISL'  DBFILE           ***************
     C                     MOVELRKEY2     DBKEY            **DB ERROR 02**
     C                     MOVEA'1'       *IN,89           ***************
     C                     EXSR DBSR
     C                     END                             - E2
     C*
     C                     END                             - E1
     C*
     C                     Z-ADDDHISB     DOHISB
     C                     Z-ADDCLDID     WHISDD
     C                     Z-ADDDHISD     @HISD                           160301
     C*
     C***********KLIST3    CHAINREHISL               52                   160301
     C           KLIST3    SETLLREHISL               52                   160301
     C           KLIST1    READEREHISL                   52               160301
     C*
     C           *IN52     IFEQ '1'                        - B1
     C                     Z-ADDCLCID     WDATE
     C                     Z-ADD3         DBASE
     C                     MOVE 'REHISL'  DBFILE           ***************
     C                     MOVELRKEY2     DBKEY            **DB ERROR 03**
     C                     MOVEA'1'       *IN,89           ***************
     C                     EXSR DBSR
     C                     END                             - E1
      *                                                                   182452
      ** Ignore REHISPM records.                                          182452
      *                                                                   182452
     C           DRECI     DOWEQ'M'                                       182452
     C           KLIST1    READEREHISL                   52               182452
     C                     END                                            182452
     C*
     C           DRECI     IFEQ 'B'                        - B1
     C                     Z-ADD*ZEROS    W2STBL
     C                     Z-ADDDHISD     BDATE                           125176
     C                     ELSE                            - X1
     C           DRECI     IFEQ 'S'                        - B2
     C                     Z-ADDSSTBL     W2STBL
     C                     ELSE                            - X2
     C                     Z-ADDCLCID     WDATE
     C                     Z-ADD4         DBASE
     C                     MOVE 'REHISL'  DBFILE           ***************
     C                     MOVELRKEY2     DBKEY            **DB ERROR 04**
     C                     MOVEA'1'       *IN,89           ***************
     C                     EXSR DBSR
     C                     END                             - E2
     C                     END                             - E1
     C*
     C                     Z-ADDDHISB     COHISB
     C                     Z-ADDCLCID     WHISDC
     C*
     C           CLDID     IFLT CLCID                      - B1
     C                     Z-ADDDHISD     @HISD                           160301
     C***********KLIST2    CHAINREHISL               52                   160301
     C           KLIST2    SETLLREHISL                                    160301
     C           KLIST1    READEREHISL                   52               160301
     C                     END                             - E1
     C*
     C                     MOVE '0'       *IN65
     C           ACNO      IFNE *ZEROS
     C                     MOVE '1'       *IN65
     C                     END
     C/COPY WNCPYSRC,RE3762C010
     C                     WRITEHEADDC
     C*
     C* CHARGE REPORT IF NECESSARY
     C*
     C           CCICI     IFNE *BLANK
     C           CCHGP     ANDNE*ZERO
     C                     Z-ADDACNO      CHACNO 100
     C/COPY WNCPYSRC,RE3762C011
     C                     WRITEHEADCH
     C                     END
     C*
     C                     MOVE *BLANKS   VALDA
     C*
     C                     EXSR CLMSG
     C                     MOVELNAR,1     TNARR
     C*
      * If DR & CR start dates are different, print B/F balance for       160301
      * both sides with narrative showing which side it is for.           160301
     C           CLDID     IFLT CLCID                      - B1
     C                     MOVELNAR,40    TNARR                           160301
     C                     Z-ADDW1STBL    HISB0
     C                     ELSE                            - X1
     C           CLDID     IFGT CLCID                                     160301
     C                     MOVELNAR,41    TNARR                           160301
     C                     END                                            160301
     C                     Z-ADDW2STBL    HISB0
     C                     END                             - E1
     C                     Z-ADDDHISB     WHISB
     C*
     C**  B/F BALANCE OUTPUT
     C*
     C                     WRITETITLEDC
     C/COPY WNCPYSRC,RE3762C045
      *                                                                   160301
      * Output 2nd B/F balance if start dates different                   160301
     C           CLDID     IFNE CLCID                                     160301
      *                                                                   160301
     C           CLDID     IFGT CLCID                                     160301
     C                     MOVELNAR,40    TNARR                           160301
     C                     Z-ADDW1STBL    HISB0                           160301
     C                     ELSE                                           160301
     C                     MOVELNAR,41    TNARR                           160301
     C                     Z-ADDW2STBL    HISB0                           160301
     C                     END                                            160301
      *                                                                   160301
     C                     WRITETITLEDC                                   160301
     C/COPY WNCPYSRC,RE3762C046
     C                     END                                            160301
     C*
     C**  PROCESS BACK VALUE AND OPENING
     C*
     C           CLDID     CASEQCLCID     B1EQ
     C           CLDID     CASGTCLCID     B1GT
     C           CLDID     CASLTCLCID     B1LT                            125176
     C                     END
      *                                                                   160301
     C                     MOVE *BLANK    @ADJF                           160301
     C*
     C           DRECI     IFEQ 'S'                        - B1
     C                     Z-ADDDHISD     WWHISD
     C                     Z-ADDDHISB     WHISB
     C                     Z-ADDSMNBL     WMNBL
     C********** DCNUM     IFEQ CCNUM                                     160301
     C********** DCCY      ANDEQCCCY                                      160301
     C********** DACOD     ANDEQCACOD                                     160301
     C********** DACSQ     ANDEQCACSQ                                     160301
     C**********           Z-ADDDDRCB     WDRCB                           160301
     C**********           Z-ADDDCRCB     WCRCB                           160301
     C                     Z-ADDSDRCB     WDRCB                           160301
     C                     Z-ADDSCRCB     WCRCB                           160301
     C**********           END                                            160301
      *                                                                   160301
      * Report generated adjustment on start date (management cap.)       160301
     C           *IN70     IFEQ '1'                                       160301
     C                     Z-ADD*ZEROS    INTD0                           160301
     C                     Z-ADD*ZEROS    INTC0                           160301
      *                                                                   160301
     C           SDAIC     IFNE *ZEROS                                    160301
     C           SDICI     ANDNE*BLANK                                    160301
     C           SDCI      ANDEQ'Y'                                       160301
     C                     Z-ADDSDAIC     @GADJ                           160301
     C                     EXSR #ADJ                                      160301
     C           CLDID     IFEQ CLCID                                     160301
     C                     Z-ADDPSTD0     INTD0                           160301
     C                     ELSE                                           160301
     C                     EXSR OVERDC                                    160301
     C                     WRITEPOSTDC                                    160301
     C/COPY WNCPYSRC,RE3762C029
     C                     END                                            160301
     C                     MOVE 'Y'       @ADJF                           160301
     C                     END                                            160301
      *                                                                   160301
     C           SCAIC     IFNE *ZEROS                                    160301
     C           SCICI     ANDNE*BLANK                                    160301
     C           SCCI      ANDEQ'Y'                                       160301
     C                     Z-SUBSCAIC     @GADJ                           160301
     C                     EXSR #ADJ                                      160301
     C           CLDID     IFEQ CLCID                                     160301
     C                     Z-ADDPSTD0     INTC0                           160301
     C                     ELSE                                           160301
     C                     EXSR OVERDC                                    160301
     C                     WRITEPOSTDC                                    160301
     C/COPY WNCPYSRC,RE3762C030
     C                     END                                            160301
     C                     MOVE 'Y'       @ADJF                           160301
     C                     END                                            160301
      *                                                                   160301
      * If gen. adj. has not already been reported by backvalue process   160301
      * (B1GT or B1LT), report as interest instead of 'posting'.          160301
     C           CLDID     IFEQ CLCID                                     160301
     C           @ADJF     ANDEQ'Y'                                       160301
     C                     EXSR OVERDC                                    160301
     C                     WRITEMADJDC                                    160301
     C/COPY WNCPYSRC,RE3762C047
     C                     END                                            160301
      *                                                                   160301
     C                     MOVE *BLANK    @ADJF                           160301
     C                     END                                            160301
      *                                                                   160301
     C           KLIST1    READEREHISL                   51
     C*
      * Bypass any cap. records between DR & CR start dates               160301
     C           *IN51     DOWEQ'0'                        - B2
     C           DRECI     ANDEQ'S'
     C           DHISD     ANDLTCHISD                                     160301
      *                                                                   160301
      * If management cap. check for generated adjustment after start     160301
      * date. This can only occur if CLDID *NE CLCID; for the side with   160301
      * the earlier start date there can be an adj. for the other side.   160301
     C           *IN70     IFEQ '1'                                       160301
     C           *IN51     ANDEQ'0'                                       160301
     C           DRECI     ANDEQ'S'                                       160301
     C           DHISD     ANDLTCHISD                                     160301
     C           SDAIC     IFNE *ZEROS                                    160301
     C           SDICI     ANDNE*BLANK                                    160301
     C           SDCI      ANDEQ'Y'                                       160301
     C                     Z-ADDSDAIC     @GADJ                           160301
     C                     MOVE 'Y'       @ADJF                           160301
     C                     END                                            160301
     C           SCAIC     IFNE *ZEROS                                    160301
     C           SCICI     ANDNE*BLANK                                    160301
     C           SCCI      ANDEQ'Y'                                       160301
     C                     Z-SUBSCAIC     @GADJ                           160301
     C                     MOVE 'Y'       @ADJF                           160301
     C                     END                                            160301
     C                     END                                            160301
      *                                                                   160301
     C           KLIST1    READEREHISL                   51
     C                     END                             - E2
     C*
     C           *IN51     IFEQ '0'                        - B2
     C           WWHISD    ANDNEDHISD
     C           DHISD     ANDLTCHISD                                     160301
     C           DRECI     ANDNE'S'                                       160301
     C*
     C********** CDICT     IFLT 3                          - B1           182452
     C********** CCICT     ANDLT3                                         182452
     C           DDICT     IFLT 3                          - B1           182452
     C           DCICT     ANDLT3                                         182452
     C*
     C**  PROCESS IN CASE OF INTEREST TYPE ARE BOTH LESS THAN 3
     C*
     C           WHISB     IFGT *ZEROS                     - B2
     C*
     C****PROCESS*WHEN*CHANGE*RATE DEBIT                                  160301
     C*
     C                     Z-ADDWDRCB     ZICALC
     C                     ELSE                                           160301
     C                     Z-ADDWCRCB     ZICALC                          160301
     C                     END                                            160301
      *                                                                   160301
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDDHISD     ZIEND
     C*
     C                     EXSR ZICD
     C*
     C                     Z-ADDZDAYN1    DAYS
     C**********           Z-ADDDOHISB    HISB0                           160301
     C                     Z-ADDWHISB     HISB0                           160301
     C********** *IN80     IFEQ '1'                                       125176
     C           HISB0     MULT DAYS      NUMB0
     C**********           ELSE                                           125176
     C********** *IN81     IFEQ '1'                                       125176
     C********** HISB1     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** *IN82     IFEQ '1'                                       125176
     C********** HISB2     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** HISB3     MULT DAYS      NUMB0                           125176
     C**********           END                                            125176
     C**********           END                                            125176
     C**********           END                                            125176
     C********** NUMB0     DIV  100       NUMB0     H                     125176
      *                                                                   160301
     C           DRECI     IFEQ 'S'                                       160301
     C           SDICI     IFEQ *BLANKS                                   160301
     C                     Z-ADDSDAIC     INTD0                           160301
     C                     END                                            160301
     C           SCICI     IFEQ *BLANKS                                   160301
     C                     Z-SUBSCAIC     INTC0                           160301
     C                     END                                            160301
     C                     ELSE                                           160301
     C                     Z-ADDDDAID     INTD0
     C**********           Z-ADDDCAID     INTC0                           160301
     C                     Z-SUBDCAID     INTC0                           160301
     C                     END                                            160301
     C*
     C           DAYS      IFNE *ZEROS                     - B3
     C*
     C                     EXSR OVERDC
     C                     WRITESTOTDC
     C/COPY WNCPYSRC,RE3762C048
     C*
     C                     END                             - E3
     C*
     C**********           ELSE                            - X2           160301
     C*
     C****PROCESS*WHEN*CHANGE*RATE CREDIT                                 160301
     C*
     C**********           Z-ADDWCRCB     ZICALC                          160301
     C**********           Z-ADDWWHISD    ZIBEG                           160301
     C**********           Z-ADDDHISD     ZIEND                           160301
     C*
     C**********           EXSR ZICD                                      160301
     C*
     C**********           Z-ADDZDAYN1    DAYS                            160301
     C**********           Z-ADDCOHISB    HISB0                           160301
     C********** *IN80     IFEQ '1'                                       125176
     C********** HISB0     MULT DAYS      NUMB0                           160301
     C**********           ELSE                                           125176
     C********** *IN81     IFEQ '1'                                       125176
     C********** HISB1     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** *IN82     IFEQ '1'                                       125176
     C********** HISB2     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** HISB3     MULT DAYS      NUMB0                           125176
     C**********           END                                            125176
     C**********           END                                            125176
     C**********           END                                            125176
     C********** NUMB0     DIV  100       NUMB0     H                     125176
     C**********           Z-ADDDDAID     INTD0                           160301
     C**********           Z-ADDDCAID     INTC0                           160301
     C*
     C********** DAYS      IFNE *ZEROS                     - B3           160301
     C*
     C**********           EXSR OVERDC                                    160301
     C**********           WRITESTOTDC                                    160301
     C*
     C**********           END                             - E3           160301
     C*
     C**********           END                             - E2           160301
     C*
     C                     ELSE                            - X1
     C*
     C********** CDICT     IFGT 2                          - B2           182452
     C********** CCICT     ANDGT2                                         182452
     C           DDICT     IFGT 2                          - B2           182452
     C           DCICT     ANDGT2                                         182452
     C*
     C**  PROCESS IN CASE OF INTEREST TYPE ARE BOTH GREATER THAN 3
     C*
     C**  PROCESS OUTPUT CHANGING DAY
     C*
     C**********           Z-ADDWMNBL     HISB0                           182452
     C                     Z-ADDWHISB     HISB0                           182452
     C                     EXSR OVERDC
     C                     WRITEODAYDC
     C/COPY WNCPYSRC,RE3762C049
     C*
     C           DRECI     IFEQ 'M'                        - B3
      *                                                                   182452
      **  Transfer Midas date into DDMMMYY                                182452
      *                                                                   182452
     C                     Z-ADDMHISD     ZDAYNO                          182452
     C                     EXSR ZDATE2                                    182452
     C                     MOVE ZADATE    VALDA                           182452
     C*
     C           DSDAT     IFNE *ZEROS                     - B4
     C           MNBL      ANDGT*ZEROS
     C*
     C**  PROCESS DEBIT
     C*
     C                     Z-ADDWDRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDMHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C                     Z-ADDDINT      INTD0
     C                     Z-ADDMNBL      HISB0                           182452
     C********** *IN80     IFEQ '1'                                       125176
     C           MNBL0     MULT DAYS      NUMB0
     C**********           ELSE                                           125176
     C********** *IN81     IFEQ '1'                                       125176
     C********** MNBL1     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** *IN82     IFEQ '1'                                       125176
     C********** MNBL2     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** MNBL3     MULT DAYS      NUMB0                           125176
     C**********           END                                            125176
     C**********           END                                            125176
     C**********           END                                            125176
     C********** NUMB0     DIV  100       NUMB0     H                     125176
     C                     MOVE *ON       *IN25                           182452
     C                     EXSR OVERDC
     C                     WRITESTODDC
     C                     MOVE *OFF      *IN25                           182452
     C/COPY WNCPYSRC,RE3762C050
     C                     Z-ADDMHISD     WHISDD
     C                     Z-ADDMNBL      WMNBL
     C*
     C                     END                             - E4
     C*
     C           CSDAT     IFNE *ZEROS                     - B4
     C           MNBL      ANDLT*ZEROS
     C*
     C**  PROCESS CREDIT
     C*
     C                     Z-ADDWCRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDMHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C                     Z-SUBCINT      INTC0
     C                     Z-ADDMNBL      HISB0                           182452
     C********** *IN80     IFEQ '1'                                       125176
     C           MNBL0     MULT DAYS      NUMB0
     C**********           ELSE                                           125176
     C********** *IN81     IFEQ '1'                                       125176
     C********** MNBL1     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** *IN82     IFEQ '1'                                       125176
     C********** MNBL2     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** MNBL3     MULT DAYS      NUMB0                           125176
     C**********           END                                            125176
     C**********           END                                            125176
     C**********           END                                            125176
     C********** NUMB0     DIV  100       NUMB0     H                     125176
     C                     MOVE *ON       *IN25                           182452
     C                     EXSR OVERDC
     C                     WRITESTOCDC
     C                     MOVE *OFF      *IN25                           182452
     C/COPY WNCPYSRC,RE3762C051
     C                     Z-ADDMHISD     WHISDC
     C                     Z-ADDMNBL      WMNBL
     C*
     C                     END                             - E4
     C*
     C**  PROCESS UNTIL READING OTHER THAN 'M'
     C*
     C           DRECI     DOWEQ'M'                        - B4
     C           *IN51     ANDEQ'0'
     C*
     C           KLIST1    READEREHISL                   51
     C*
     C           *IN51     IFEQ '0'                        - B5
     C*
     C           DRECI     IFEQ 'M'                        - B6
      *                                                                   182452
      **  Transfer Midas date into DDMMMYY                                182452
      *                                                                   182452
     C                     Z-ADDMHISD     ZDAYNO                          182452
     C                     EXSR ZDATE2                                    182452
     C                     MOVE ZADATE    VALDA                           182452
     C*
     C           DSDAT     IFNE *ZEROS                     - B7
     C           MNBL      ANDGT*ZEROS
     C*
     C**  PROCESS DEBIT
     C*
     C                     Z-ADDWDRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDMHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C                     Z-ADDDINT      INTD0
     C                     Z-ADDMNBL      HISB0                           182452
     C********** *IN80     IFEQ '1'                                       125176
     C           MNBL0     MULT DAYS      NUMB0
     C**********           ELSE                                           125176
     C********** *IN81     IFEQ '1'                                       125176
     C********** MNBL1     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** *IN82     IFEQ '1'                                       125176
     C********** MNBL2     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** MNBL3     MULT DAYS      NUMB0                           125176
     C**********           END                                            125176
     C**********           END                                            125176
     C**********           END                                            125176
     C********** NUMB0     DIV  100       NUMB0     H                     125176
     C                     MOVE *ON       *IN25                           182452
     C                     EXSR OVERDC
     C                     WRITESTODDC
     C                     MOVE *OFF      *IN25                           182452
     C/COPY WNCPYSRC,RE3762C052
     C                     Z-ADDMHISD     WHISDD
     C                     Z-ADDMNBL      WMNBL
     C*
     C                     END                             - E7
     C*
     C           CSDAT     IFNE *ZEROS                     - B7
     C           MNBL      ANDLT*ZEROS
     C*
     C**  PROCESS CREDIT
     C*
     C                     Z-ADDWCRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDMHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C                     Z-SUBCINT      INTC0
     C                     Z-ADDMNBL      HISB0                           182452
     C********** *IN80     IFEQ '1'                                       125176
     C           MNBL0     MULT DAYS      NUMB0
     C**********           ELSE                                           125176
     C********** *IN81     IFEQ '1'                                       125176
     C********** MNBL1     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** *IN82     IFEQ '1'                                       125176
     C********** MNBL2     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** MNBL3     MULT DAYS      NUMB0                           125176
     C**********           END                                            125176
     C**********           END                                            125176
     C**********           END                                            125176
     C********** NUMB0     DIV  100       NUMB0     H                     125176
     C                     MOVE *ON       *IN25                           182452
     C                     EXSR OVERDC
     C                     WRITESTOCDC
     C                     MOVE *OFF      *IN25                           182452
     C/COPY WNCPYSRC,RE3762C053
     C                     Z-ADDMHISD     WHISDC
     C                     Z-ADDMNBL      WMNBL
     C*
     C                     END                             - E7
     C*
     C                     ELSE                            - X6
     C*
     C           DRECI     IFEQ 'S'                        - B7
     C*
     C**  PROCESS A S RECORD
     C*
     C***********SDICI     IFEQ 'Y'                        - B8          098818
     C           SDICI     IFNE *BLANKS                    - B8          098818
     C*
     C**  PROCESS IF DEBIT CAPITALISATION
     C*
     C                     Z-ADDWDRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDDHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C********** *IN80     IFEQ '1'                                       125176
     C           SMNBL0    MULT DAYS      NUMB0
     C**********           ELSE                                           125176
     C********** *IN81     IFEQ '1'                                       125176
     C********** SMNBL1    MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** *IN82     IFEQ '1'                                       125176
     C********** SMNBL2    MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** SMNBL3    MULT DAYS      NUMB0                           125176
     C**********           END                                            125176
     C**********           END                                            125176
     C**********           END                                            125176
     C********** NUMB0     DIV  100       NUMB0     H                     125176
     C*
     C           SMNBL     IFGT *ZEROS                     - B9
     C                     Z-ADDDINT      INTD0
     C                     EXSR OVERDC
     C                     WRITESTODDC
     C/COPY WNCPYSRC,RE3762C054
     C                     ELSE                            - X9
     C                     Z-SUBCINT      INTC0
     C                     EXSR OVERDC
     C                     WRITESTOCDC
     C/COPY WNCPYSRC,RE3762C055
     C                     END                             - E9
     C*
     C                     Z-ADDDHISD     WHISDD
     C*
     C                     END                             - E8
     C*
     C***********SCICI     IFEQ 'Y'                        - B8          098818
     C           SCICI     IFNE *BLANKS                    - B8          098818
     C*
     C**  PROCESS IF CREDIT CAPITALISATION
     C*
     C                     Z-ADDWCRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDDHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C********** *IN80     IFEQ '1'                                       125176
     C           SMNBL0    MULT DAYS      NUMB0
     C**********           ELSE                                           125176
     C********** *IN81     IFEQ '1'                                       125176
     C********** SMNBL1    MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** *IN82     IFEQ '1'                                       125176
     C********** SMNBL2    MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** SMNBL3    MULT DAYS      NUMB0                           125176
     C**********           END                                            125176
     C**********           END                                            125176
     C**********           END                                            125176
     C********** NUMB0     DIV  100       NUMB0     H                     125176
     C*
     C           SMNBL     IFGT *ZEROS                     - B9
     C                     Z-ADDDINT      INTD0
     C                     EXSR OVERDC
     C                     WRITESTODDC
     C/COPY WNCPYSRC,RE3762C056
     C                     ELSE                            - X9
     C                     Z-SUBCINT      INTC0
     C                     EXSR OVERDC
     C                     WRITESTOCDC
     C/COPY WNCPYSRC,RE3762C057
     C                     END                             - E9
     C*
     C                     Z-ADDDHISD     WHISDC
     C*
     C                     END                             - E8
     C*
     C                     END                             - E7
     C*
     C                     END                             - E6
     C*
     C                     END                             - E5
     C*
     C                     END                             - E4
     C*
     C                     END                             - E3
     C*
     C                     ELSE                            - X2
     C*
     C********** CDICT     IFGT 2                          - B3           182452
     C********** CCICT     ANDLT3                                         182452
     C           DDICT     IFGT 2                          - B3           182452
     C           DCICT     ANDLT3                                         182452
     C*
     C**  PROCESS IN CASE OF INTEREST TYPE CREDIT IS LESS THAN 3
     C**  AND INTEREST TYPE DEBIT IS GREATER THAN 2
     C*
     C**  PROCESS OUTPUT CHANGING DAY
     C*
     C**********           Z-ADDWMNBL     HISB0                           182452
     C                     Z-ADDWHISB     HISB0                           182452
     C                     EXSR OVERDC
     C                     WRITEODAYDC
     C/COPY WNCPYSRC,RE3762C058
     C*
     C           DCRCI     IFEQ 'Y'                        - B4
     C*
     C**  PROCESS WHEN CHANGE RATE CREDIT
     C*
     C                     Z-ADDWCRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDDHISD     ZIEND
     C*
     C                     EXSR ZICD
     C*
     C                     Z-ADDZDAYN1    DAYS
     C                     Z-ADDWHISB     HISB0
     C********** *IN80     IFEQ '1'                                       125176
     C           HISB0     MULT DAYS      NUMB0
     C**********           ELSE                                           125176
     C********** *IN81     IFEQ '1'                                       125176
     C********** HISB1     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** *IN82     IFEQ '1'                                       125176
     C********** HISB2     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** HISB3     MULT DAYS      NUMB0                           125176
     C**********           END                                            125176
     C**********           END                                            125176
     C**********           END                                            125176
     C********** NUMB0     DIV  100       NUMB0     H                     125176
     C           DDAID     SUB  WDAID     INTD0
     C           DCAID     SUB  WCAID     INTC0
     C*
     C           DAYS      IFNE *ZEROS                     - B5
     C*
     C                     EXSR OVERDC
     C                     WRITESTOTDC
     C/COPY WNCPYSRC,RE3762C059
     C*
     C                     END                             - E5
     C*
     C                     END                             - E4
     C*
     C**  PROCESS END OF MONTH OR CHANGE RATE FOR DEBIT
     C*
     C           DRECI     IFEQ 'M'                        - B4
     C           DSDAT     ANDNE*ZEROS
      *                                                                   182452
      **  Transfer Midas date into DDMMMYY                                182452
      *                                                                   182452
     C                     Z-ADDMHISD     ZDAYNO                          182452
     C                     EXSR ZDATE2                                    182452
     C                     MOVE ZADATE    VALDA                           182452
     C*
     C                     Z-ADDWDRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDMHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C********** *IN80     IFEQ '1'                                       125176
     C           MNBL0     MULT DAYS      NUMB0
     C**********           ELSE                                           125176
     C********** *IN81     IFEQ '1'                                       125176
     C********** MNBL1     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** *IN82     IFEQ '1'                                       125176
     C********** MNBL2     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** MNBL3     MULT DAYS      NUMB0                           125176
     C**********           END                                            125176
     C**********           END                                            125176
     C**********           END                                            125176
     C********** NUMB0     DIV  100       NUMB0     H                     125176
     C*
     C                     Z-ADDMNBL      HISB0                           182452
     C                     MOVE *ON       *IN25                           182452
     C           MNBL      IFGT *ZEROS                     - B5
     C                     Z-ADDDINT      INTD0
     C                     EXSR OVERDC
     C                     WRITESTODDC
     C/COPY WNCPYSRC,RE3762C060
     C                     ELSE                            - X5
     C                     Z-SUBCINT      INTC0
     C                     EXSR OVERDC
     C                     WRITESTOCDC
     C/COPY WNCPYSRC,RE3762C061
     C                     END                             - E5
     C                     MOVE *OFF      *IN25                           182452
     C*
     C                     Z-ADDMHISD     WHISDD
     C                     Z-ADDMNBL      WMNBL
     C*
     C                     END                             - E4
     C*
     C           DRECI     DOWEQ'M'                        - B4
     C           *IN51     ANDEQ'0'
     C*
     C           KLIST1    READEREHISL                   51
     C*
     C           *IN51     IFEQ '0'                        - B5
     C*
     C           DRECI     IFEQ 'M'                        - B6
     C           DSDAT     ANDNE*ZEROS
      *                                                                   182452
      **  Transfer Midas date into DDMMMYY                                182452
      *                                                                   182452
     C                     Z-ADDMHISD     ZDAYNO                          182452
     C                     EXSR ZDATE2                                    182452
     C                     MOVE ZADATE    VALDA                           182452
     C*
     C                     Z-ADDWDRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDMHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C********** *IN80     IFEQ '1'                                       125176
     C           MNBL0     MULT DAYS      NUMB0
     C**********           ELSE                                           125176
     C********** *IN81     IFEQ '1'                                       125176
     C********** MNBL1     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** *IN82     IFEQ '1'                                       125176
     C********** MNBL2     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** MNBL3     MULT DAYS      NUMB0                           125176
     C**********           END                                            125176
     C**********           END                                            125176
     C**********           END                                            125176
     C********** NUMB0     DIV  100       NUMB0     H                     125176
     C*
     C                     Z-ADDMNBL      HISB0                           182452
     C                     MOVE *ON       *IN25                           182452
     C           MNBL      IFGT *ZEROS                     - B7
     C                     Z-ADDDINT      INTD0
     C                     EXSR OVERDC
     C                     WRITESTODDC
     C/COPY WNCPYSRC,RE3762C062
     C                     ELSE                            - X7
     C                     Z-SUBCINT      INTC0
     C                     EXSR OVERDC
     C                     WRITESTOCDC
     C/COPY WNCPYSRC,RE3762C063
     C                     END                             - E7
     C                     MOVE *OFF      *IN25                           182452
     C*
     C                     Z-ADDMHISD     WHISDD
     C                     Z-ADDMNBL      WMNBL
     C*
     C                     ELSE                            - X6
     C*
     C           DRECI     IFEQ 'S'                        - B7
     C***********SDICI     ANDEQ'Y'                                      098818
     C           SDICI     ANDNE*BLANKS                                  098818
     C*
     C                     Z-ADDWDRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDDHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C********** *IN80     IFEQ '1'                                       125176
     C           SMNBL0    MULT DAYS      NUMB0
     C**********           ELSE                                           125176
     C********** *IN81     IFEQ '1'                                       125176
     C********** SMNBL1    MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** *IN82     IFEQ '1'                                       125176
     C********** SMNBL2    MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** SMNBL3    MULT DAYS      NUMB0                           125176
     C**********           END                                            125176
     C**********           END                                            125176
     C**********           END                                            125176
     C********** NUMB0     DIV  100       NUMB0     H                     125176
     C*
     C           SMNBL     IFGT *ZEROS                     - B8
     C                     Z-ADDDINT      INTD0
     C                     EXSR OVERDC
     C                     WRITESTODDC
     C/COPY WNCPYSRC,RE3762C064
     C                     ELSE                            - X8
     C                     Z-SUBCINT      INTC0
     C                     EXSR OVERDC
     C                     WRITESTOCDC
     C/COPY WNCPYSRC,RE3762C065
     C                     END                             - E8
     C*
     C                     Z-ADDDHISD     WHISDD
     C*
     C                     END                             - E7
     C*
     C                     END                             - E6
     C*
     C                     END                             - E5
     C*
     C                     END                             - E4
     C*
     C                     ELSE                            - X3
     C*
     C**  PROCESS IN CASE OF INTEREST TYPE DEBIT IS LESS THAN 3
     C**  AND INTEREST TYPE CREDIT IS GREATER THAN 2
     C*
     C**  PROCESS OUTPUT CHANGING DAY
     C*
     C**********           Z-ADDWMNBL     HISB0                           182452
     C                     Z-ADDWHISB     HISB0                           182452
     C                     EXSR OVERDC
     C                     WRITEODAYDC
     C/COPY WNCPYSRC,RE3762C066
     C*
     C           DDRCI     IFEQ 'Y'                        - B4
     C*
     C**  DEBIT RATE CHANGE
     C*
     C                     Z-ADDWDRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDDHISD     ZIEND
     C*
     C                     EXSR ZICD
     C*
     C                     Z-ADDZDAYN1    DAYS
     C                     Z-ADDWHISB     HISB0
     C********** *IN80     IFEQ '1'                                       125176
     C           HISB0     MULT DAYS      NUMB0
     C**********           ELSE                                           125176
     C********** *IN81     IFEQ '1'                                       125176
     C********** HISB1     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** *IN82     IFEQ '1'                                       125176
     C********** HISB2     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** HISB3     MULT DAYS      NUMB0                           125176
     C**********           END                                            125176
     C**********           END                                            125176
     C**********           END                                            125176
     C********** NUMB0     DIV  100       NUMB0     H                     125176
     C*
     C           DAYS      IFNE *ZEROS                     - B5
     C*
     C                     EXSR OVERDC
     C                     WRITESTOTDC
     C/COPY WNCPYSRC,RE3762C067
     C*
     C                     END                             - E5
     C*
     C                     END                             - E4
     C*
     C**  CREDIT END OF MONTH OR CREDIT RATE CHANGE
     C*
     C           DRECI     IFEQ 'M'                        - B4
     C           CSDAT     ANDNE*ZEROS
      *                                                                   182452
      **  Transfer Midas date into DDMMMYY                                182452
      *                                                                   182452
     C                     Z-ADDMHISD     ZDAYNO                          182452
     C                     EXSR ZDATE2                                    182452
     C                     MOVE ZADATE    VALDA                           182452
     C*
     C                     Z-ADDWCRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDMHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C********** *IN80     IFEQ '1'                                       125176
     C           MNBL0     MULT DAYS      NUMB0
     C**********           ELSE                                           125176
     C********** *IN81     IFEQ '1'                                       125176
     C********** MNBL1     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** *IN82     IFEQ '1'                                       125176
     C********** MNBL2     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** MNBL3     MULT DAYS      NUMB0                           125176
     C**********           END                                            125176
     C**********           END                                            125176
     C**********           END                                            125176
     C********** NUMB0     DIV  100       NUMB0     H                     125176
     C*
     C                     Z-ADDMNBL      HISB0                           182452
     C                     MOVE *ON       *IN25                           182452
     C           MNBL      IFGT *ZEROS                     - B5
     C                     Z-ADDDINT      INTD0
     C                     EXSR OVERDC
     C                     WRITESTODDC
     C/COPY WNCPYSRC,RE3762C068
     C                     ELSE                            - X5
     C                     Z-SUBCINT      INTC0
     C                     EXSR OVERDC
     C                     WRITESTOCDC
     C/COPY WNCPYSRC,RE3762C069
     C                     END                             - E5
     C                     MOVE *OFF      *IN25                           182452
     C*
     C                     Z-ADDMHISD     WHISDC
     C                     Z-ADDMNBL      WMNBL
     C*
     C                     END                             - E4
     C*
     C           DRECI     DOWEQ'M'                        - B4
     C           *IN51     ANDEQ'0'
     C*
     C           KLIST1    READEREHISL                   51
     C*
     C           *IN51     IFEQ '0'                        - B5
     C*
     C           DRECI     IFEQ 'M'                        - B6
     C           CSDAT     ANDNE*ZEROS
      *                                                                   182452
      **  Transfer Midas date into DDMMMYY                                182452
      *                                                                   182452
     C                     Z-ADDMHISD     ZDAYNO                          182452
     C                     EXSR ZDATE2                                    182452
     C                     MOVE ZADATE    VALDA                           182452
     C*
     C                     Z-ADDWCRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDMHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C********** *IN80     IFEQ '1'                                       125176
     C           MNBL0     MULT DAYS      NUMB0
     C**********           ELSE                                           125176
     C********** *IN81     IFEQ '1'                                       125176
     C********** MNBL1     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** *IN82     IFEQ '1'                                       125176
     C********** MNBL2     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** MNBL3     MULT DAYS      NUMB0                           125176
     C**********           END                                            125176
     C**********           END                                            125176
     C**********           END                                            125176
     C********** NUMB0     DIV  100       NUMB0     H                     125176
     C*
     C                     Z-ADDMNBL      HISB0                           182452
     C                     MOVE *ON       *IN25                           182452
     C           MNBL      IFGT *ZEROS                     - B7
     C                     Z-ADDDINT      INTD0
     C                     EXSR OVERDC
     C                     WRITESTODDC
     C/COPY WNCPYSRC,RE3762C070
     C                     ELSE                            - X7
     C                     Z-SUBCINT      INTC0
     C                     EXSR OVERDC
     C                     WRITESTOCDC
     C/COPY WNCPYSRC,RE3762C071
     C                     END                             - E7
     C                     MOVE *OFF      *IN25                           182452
     C*
     C                     Z-ADDMHISD     WHISDC
     C                     Z-ADDMNBL      WMNBL
     C*
     C                     ELSE                            - X6
     C*
     C           DRECI     IFEQ 'S'                        - B7
     C***********SCICI     ANDEQ'Y'                                      098818
     C           SCICI     ANDNE*BLANKS                                  098818
     C*
     C                     Z-ADDWCRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDDHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C********** *IN80     IFEQ '1'                                       125176
     C           SMNBL0    MULT DAYS      NUMB0
     C**********           ELSE                                           125176
     C********** *IN81     IFEQ '1'                                       125176
     C********** SMNBL1    MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** *IN82     IFEQ '1'                                       125176
     C********** SMNBL2    MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** SMNBL3    MULT DAYS      NUMB0                           125176
     C**********           END                                            125176
     C**********           END                                            125176
     C**********           END                                            125176
     C********** NUMB0     DIV  100       NUMB0     H                     125176
     C*
     C           SMNBL     IFGT *ZEROS                     - B8
     C                     Z-ADDDINT      INTD0
     C                     EXSR OVERDC
     C                     WRITESTODDC
     C/COPY WNCPYSRC,RE3762C072
     C                     ELSE                            - X8
     C                     Z-SUBCINT      INTC0
     C                     EXSR OVERDC
     C                     WRITESTOCDC
     C/COPY WNCPYSRC,RE3762C073
     C                     END                             - E8
     C*
     C                     Z-ADDDHISD     WHISDC
     C*
     C                     END                             - E7
     C*
     C                     END                             - E6
     C*
     C                     END                             - E5
     C*
     C                     END                             - E4
     C*
     C                     END                             - E3
     C*
     C                     END                             - E2
     C*
     C                     END                             - E1
     C*
     C                     END                             - E2
     C*
     C                     END                             - E1
     C*
      ** If CRE001 is switched ON and Overdraft Processed Ind. is 'Y'     CRE001
      ** then Output Overdraft Limit                                      CRE001
      *                                                                   CRE001
     C           CRE001    IFEQ 'Y'                          B1           CRE001
     C           ODLI      ANDEQ'Y'                          A1           CRE001
      *                                                                   CRE001
     C                     MOVE *BLANKS   ODLI                            CRE001
     C                     MOVE *BLANKS   PSTDO                           CRE001
     C                     Z-ADD*ZEROS    PPSTD                           CRE001
     C                     MOVE *BLANKS   PSTDA                           CRE001
      *                                                                   CRE001
      ** Convert Retail History Debit Date to DDMMMYY format              CRE001
     C           PVALD     IFNE WWHISD                       B2           CRE001
     C                     MOVELWWHISD    ZDAYNO                          CRE001
     C                     EXSR ZDATE2                                    CRE001
     C                     MOVE ZADATE    VALDO                           CRE001
      *                                                                   CRE001
      **  Handle Conversion Error.                                        CRE001
      *                                                                   CRE001
     C           ZERROR    IFNE 0                          - B3           CRE001
     C                     Z-ADDWWHISD    WDATE                           CRE001
     C                     Z-ADD421       DBASE                           CRE001
     C                     MOVEL'ZDAT2'   DBFILE           ***************CRE001
     C                     MOVELWDATE     DBKEY            **DB ERROR 421*CRE001
     C                     MOVEA'1'       *IN,89           ***************CRE001
     C                     EXSR DBSR                                      CRE001
     C                     ENDIF                           - E3           CRE001
      *                                                                   CRE001
      ** Set Pervious Posting Value to Current Retail History DR Date     CRE001
     C                     Z-ADDWWHISD    PVALD                           CRE001
      *                                                                   CRE001
     C                     ENDIF                           - E2           CRE001
      *                                                                   CRE001
     C                     MOVE VALDO     VALDA                           CRE001
      *                                                                   CRE001
     C**********           MOVELNAR,29    NARR                     CRE001 125176
     C                     MOVELNAR,39    NARR                            125176
      *                                                                   CRE001
     C                     Z-ADD*ZERO     WODRL  150                      CRE001
     C                     SELEC                                          CRE001
     C           DPA,I     WHEQ 0                                         CRE001
     C                     Z-ADDODRL      WODRL                           CRE001
     C           DPA,I     WHEQ 1                                         CRE001
     C           ODRL      MULT 10        WODRL                           CRE001
     C           DPA,I     WHEQ 2                                         CRE001
     C           ODRL      MULT 100       WODRL                           CRE001
     C           DPA,I     WHEQ 3                                         CRE001
     C           ODRL      MULT 1000      WODRL                           CRE001
     C                     ENDSL                                          CRE001
      *                                                                   CRE001
     C           WODRL     IFGT *ZEROS                     - B2           CRE001
     C                     Z-ADDWODRL     PSTD0                           CRE001
     C                     ELSE                            - X2           CRE001
     C                     Z-SUBWODRL     PSTD0                           CRE001
     C                     ENDIF                           - E2           CRE001
      *                                                                   CRE001
      **  Output Posting for Debit and Credit                             CRE001
      *                                                                   CRE001
     C                     EXSR OVERDC                                    CRE001
     C                     WRITEPOSTDC                                    CRE001
     C/COPY WNCPYSRC,RE3762C031
      *                                                                   CRE001
     C                     END                               E1           CRE001
      *                                                                   CRE001
     C           *IN51     DOWEQ'0'                        - B1
     C           DHISD     ANDLTCHISD
      *                                                                   160301
      * If start dates different and 2nd start date reached, start        160301
      * printing interest for both sides.                                 160301
     C           DHISD     IFEQ @HISD                                     160301
     C                     SETON                     0102                 160301
     C                     END                                            160301
      *                                                                   160301
      * Report generated adjustment if found                              160301
     C           @ADJF     IFEQ 'Y'                                       160301
     C                     EXSR #ADJ                                      160301
      *                                                                   160301
      * If different start dates and 2nd start date reached report as     160301
      * interest, otherwise report as a posting.                          160301
     C           CLDID     IFNE CLCID                                     160301
     C           DHISD     ANDEQ@HISD                                     160301
     C           CLDID     IFGT CLCID                                     160301
     C                     Z-ADD@GADJ     INTD0                           160301
     C                     Z-ADD*ZEROS    INTC0                           160301
     C                     ELSE                                           160301
     C                     Z-ADD@GADJ     INTC0                           160301
     C                     Z-ADD*ZEROS    INTD0                           160301
     C                     END                                            160301
     C                     EXSR OVERDC                                    160301
     C                     WRITEMADJDC                                    160301
     C/COPY WNCPYSRC,RE3762C074
      *                                                                   160301
     C                     ELSE                                           160301
     C                     EXSR OVERDC                                    160301
     C                     WRITEPOSTDC                                    160301
     C/COPY WNCPYSRC,RE3762C032
     C                     END                                            160301
      *                                                                   160301
     C                     END                                            160301
     C*
     C**  PROCESS POSTING AT THE SAME DATE
     C*
     C           *IN50     DOWEQ'0'                        - B2
     C           DHISD     ANDEQHISD
     C*
     C           HISD      IFGE CLCID                                     160301
     C           CHGA      ANDNE0                                         160301
     C                     MOVE 'Y'       @CHGF                           160301
     C                     END                                            160301
      *                                                                   160301
     C                     EXSR POSTSR
     C*
     C           KLIST1    READEREHPOPL                  50
     C*
     C                     END                             - E2
      *                                                                   160301
      * Report manual adjustment                                          160301
     C           DRECI     IFNE 'S'                                       160301
     C           DMADI     IFNE 0                                         160301
     C           *IN01     ANDEQ'1'                                       160301
     C           DMACI     ORNE 0                                         160301
     C           *IN02     ANDEQ'1'                                       160301
     C                     EXSR MADJSR                                    160301
     C                     END                                            160301
     C                     END                                            160301
     C*
     C**  PROCESS IN CASE THERE IS ONE RATE CHANGE
     C*
     C                     EXSR RATESR
     C*
     C**  OUTPUT SUBTOTAL LINE
     C*
     C           *IN51     IFEQ '0'                        - B2
     C           DHISD     ANDLTCHISD
     C*
     C**  CHECK INTEREST TYPE
     C*
     C********** CDICT     IFLT 3                          - B1           182452
     C********** CCICT     ANDLT3                                         182452
     C           DDICT     IFLT 3                          - B1           182452
     C           DCICT     ANDLT3                                         182452
     C*
     C**  PROCESS IN CASE OF INTEREST TYPE ARE BOTH LESS THAN 3
     C*
     C           DRECI     IFEQ 'D'                                       160301
     C           DCMVT     ANDNE*ZEROS                                    160301
     C           DRECI     OREQ 'D'                                       160301
     C           DDMVT     ANDNE*ZEROS                                    160301
     C           DRECI     OREQ 'D'                                       160301
     C           DMACI     ANDNE*ZEROS                                    160301
     C           DRECI     OREQ 'D'                                       160301
     C           DMADI     ANDNE*ZEROS                                    160301
     C           DRECI     OREQ 'D'                                       160301
     C           DCRCI     ANDNE*BLANKS                                   160301
     C           DRECI     OREQ 'D'                                       160301
     C           DDRCI     ANDNE*BLANKS                                   160301
     C           DRECI     OREQ 'D'                                       160301
     C           @ADJF     ANDEQ'Y'                                       160301
     C           DRECI     OREQ 'S'                                       160301
     C           SDRIP     ANDNE*ZEROS                                    160301
     C           DRECI     OREQ 'S'                                       160301
     C           SCRIP     ANDNE*ZEROS                                    160301
      *                                                                   160301
     C           WHISB     IFGT *ZEROS                     - B2
     C*
     C****PROCESS*WHEN*CHANGE*RATE DEBIT                                  160301
     C*
     C                     Z-ADDWDRCB     ZICALC
     C                     ELSE                                           160301
     C                     Z-ADDWCRCB     ZICALC                          160301
     C                     END                                            160301
      *                                                                   160301
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDDHISD     ZIEND
     C*
     C                     EXSR ZICD
     C*
     C                     Z-ADDZDAYN1    DAYS
     C                     Z-ADDWHISB     HISB0
     C********** *IN80     IFEQ '1'                                       125176
     C           HISB0     MULT DAYS      NUMB0
     C**********           ELSE                                           125176
     C********** *IN81     IFEQ '1'                                       125176
     C********** HISB1     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** *IN82     IFEQ '1'                                       125176
     C********** HISB2     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** HISB3     MULT DAYS      NUMB0                           125176
     C**********           END                                            125176
     C**********           END                                            125176
     C**********           END                                            125176
     C********** NUMB0     DIV  100       NUMB0     H                     125176
      *                                                                   160301
     C           DRECI     IFEQ 'S'                                       160301
     C           SDICI     IFEQ *BLANKS                                   160301
     C           SDAIC     SUB  WDAID     INTD0                           160301
     C                     END                                            160301
     C           SCICI     IFEQ *BLANKS                                   160301
     C           SCAIC     SUB  WCAID     INTC0                           160301
     C                     END                                            160301
     C                     ELSE                                           160301
     C           DDAID     SUB  WDAID     INTD0
     C           DCAID     SUB  WCAID     INTC0
     C                     END                                            160301
     C                     Z-SUBINTC0     INTC0                           160301
     C*
     C           DAYS      IFNE *ZEROS                     - B3
     C*
     C                     EXSR OVERDC
     C                     WRITESTOTDC
     C/COPY WNCPYSRC,RE3762C075
     C*
     C                     END                             - E3
      *                                                                   160301
     C                     END                                            160301
     C*
     C**********           ELSE                            - X2           160301
     C*
     C****PROCESS*WHEN*CHANGE*RATE CREDIT                                 160301
     C*
     C**********           Z-ADDWCRCB     ZICALC                          160301
     C**********           Z-ADDWWHISD    ZIBEG                           160301
     C**********           Z-ADDDHISD     ZIEND                           160301
     C*
     C**********           EXSR ZICD                                      160301
     C*
     C**********           Z-ADDZDAYN1    DAYS                            160301
     C**********           Z-ADDWHISB     HISB0                           160301
     C********** *IN80     IFEQ '1'                                       125176
     C********** HISB0     MULT DAYS      NUMB0                           160301
     C**********           ELSE                                           125176
     C********** *IN81     IFEQ '1'                                       125176
     C********** HISB1     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** *IN82     IFEQ '1'                                       125176
     C********** HISB2     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** HISB3     MULT DAYS      NUMB0                           125176
     C**********           END                                            125176
     C**********           END                                            125176
     C**********           END                                            125176
     C********** NUMB0     DIV  100       NUMB0     H                     125176
     C********** DDAID     SUB  WDAID     INTD0                           160301
     C********** DCAID     SUB  WCAID     INTC0                           160301
     C*
     C********** DAYS      IFNE *ZEROS                     - B3           160301
     C*
     C**********           EXSR OVERDC                                    160301
     C**********           WRITESTOTDC                                    160301
     C*
     C**********           END                             - E3           160301
     C*
     C**********           END                             - E2           160301
     C*
     C                     ELSE                            - X1
     C*
     C********** CDICT     IFGT 2                          - B2           182452
     C********** CCICT     ANDGT2                                         182452
     C           DDICT     IFGT 2                          - B2           182452
     C           DCICT     ANDGT2                                         182452
     C*
     C**  PROCESS IN CASE OF INTEREST TYPE ARE BOTH GREATER THAN 3
     C*
     C**  PROCESS OUTPUT CHANGING DAY
     C*
     C**********           Z-ADDWMNBL     HISB0                           182452
     C                     Z-ADDWHISB     HISB0                           182452
     C                     EXSR OVERDC
     C                     WRITEODAYDC
     C/COPY WNCPYSRC,RE3762C076
     C*
     C           DRECI     IFEQ 'M'                        - B3
      *                                                                   182452
      **  Transfer Midas date into DDMMMYY                                182452
      *                                                                   182452
     C                     Z-ADDMHISD     ZDAYNO                          182452
     C                     EXSR ZDATE2                                    182452
     C                     MOVE ZADATE    VALDA                           182452
     C*
     C           DSDAT     IFNE *ZEROS                     - B4
     C           MNBL      ANDGT*ZEROS
     C*
     C**  PROCESS DEBIT
     C*
     C                     Z-ADDWDRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDMHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C                     Z-ADDDINT      INTD0
     C********** *IN80     IFEQ '1'                                       125176
     C           MNBL0     MULT DAYS      NUMB0
     C**********           ELSE                                           125176
     C********** *IN81     IFEQ '1'                                       125176
     C********** MNBL1     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** *IN82     IFEQ '1'                                       125176
     C********** MNBL2     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** MNBL3     MULT DAYS      NUMB0                           125176
     C**********           END                                            125176
     C**********           END                                            125176
     C**********           END                                            125176
     C********** NUMB0     DIV  100       NUMB0     H                     125176
     C                     Z-ADDMNBL      HISB0                           182452
     C                     MOVE *ON       *IN25                           182452
     C                     EXSR OVERDC
     C                     WRITESTODDC
     C                     MOVE *OFF      *IN25                           182452
     C/COPY WNCPYSRC,RE3762C077
     C                     Z-ADDMHISD     WHISDD
     C                     Z-ADDMNBL      WMNBL
     C*
     C                     END                             - E4
     C*
     C           CSDAT     IFNE *ZEROS                     - B4
     C           MNBL      ANDLT*ZEROS
     C*
     C**  PROCESS CREDIT
     C*
     C                     Z-ADDWCRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDMHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C                     Z-SUBCINT      INTC0
     C********** *IN80     IFEQ '1'                                       125176
     C           MNBL0     MULT DAYS      NUMB0
     C**********           ELSE                                           125176
     C********** *IN81     IFEQ '1'                                       125176
     C********** MNBL1     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** *IN82     IFEQ '1'                                       125176
     C********** MNBL2     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** MNBL3     MULT DAYS      NUMB0                           125176
     C**********           END                                            125176
     C**********           END                                            125176
     C**********           END                                            125176
     C********** NUMB0     DIV  100       NUMB0     H                     125176
     C                     Z-ADDMNBL      HISB0                           182452
     C                     MOVE *ON       *IN25                           182452
     C                     EXSR OVERDC
     C                     WRITESTOCDC
     C                     MOVE *OFF      *IN25                           182452
     C/COPY WNCPYSRC,RE3762C078
     C                     Z-ADDMHISD     WHISDC
     C                     Z-ADDMNBL      WMNBL
     C*
     C                     END                             - E4
     C*
     C**  PROCESS UNTIL READING OTHER THAN 'M'
     C*
     C           DRECI     DOWEQ'M'                        - B4
     C           *IN51     ANDEQ'0'
     C*
     C           KLIST1    READEREHISL                   51
     C*
     C           *IN51     IFEQ '0'                        - B5
     C*
     C           DRECI     IFEQ 'M'                        - B6
     C*
     C           DSDAT     IFNE *ZEROS                     - B7
     C           MNBL      ANDGT*ZEROS
      *                                                                   182452
      **  Transfer Midas date into DDMMMYY                                182452
      *                                                                   182452
     C                     Z-ADDMHISD     ZDAYNO                          182452
     C                     EXSR ZDATE2                                    182452
     C                     MOVE ZADATE    VALDA                           182452
     C*
     C**  PROCESS DEBIT
     C*
     C                     Z-ADDWDRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDMHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C                     Z-ADDDINT      INTD0
     C********** *IN80     IFEQ '1'                                       125176
     C           MNBL0     MULT DAYS      NUMB0
     C**********           ELSE                                           125176
     C********** *IN81     IFEQ '1'                                       125176
     C********** MNBL1     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** *IN82     IFEQ '1'                                       125176
     C********** MNBL2     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** MNBL3     MULT DAYS      NUMB0                           125176
     C**********           END                                            125176
     C**********           END                                            125176
     C**********           END                                            125176
     C********** NUMB0     DIV  100       NUMB0     H                     125176
     C                     Z-ADDMNBL      HISB0                           182452
     C                     MOVE *ON       *IN25                           182452
     C                     EXSR OVERDC
     C                     WRITESTODDC
     C                     MOVE *OFF      *IN25                           182452
     C/COPY WNCPYSRC,RE3762C079
     C                     Z-ADDMHISD     WHISDD
     C                     Z-ADDMNBL      WMNBL
     C*
     C                     END                             - E7
     C*
     C           CSDAT     IFNE *ZEROS                     - B7
     C           MNBL      ANDLT*ZEROS
     C*
     C**  PROCESS CREDIT
     C*
     C                     Z-ADDWCRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDMHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C                     Z-SUBCINT      INTC0
     C********** *IN80     IFEQ '1'                                       125176
     C           MNBL0     MULT DAYS      NUMB0
     C**********           ELSE                                           125176
     C********** *IN81     IFEQ '1'                                       125176
     C********** MNBL1     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** *IN82     IFEQ '1'                                       125176
     C********** MNBL2     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** MNBL3     MULT DAYS      NUMB0                           125176
     C**********           END                                            125176
     C**********           END                                            125176
     C**********           END                                            125176
     C********** NUMB0     DIV  100       NUMB0     H                     125176
     C                     Z-ADDMNBL      HISB0                           182452
     C                     MOVE *ON       *IN25                           182452
     C                     EXSR OVERDC
     C                     WRITESTOCDC
     C                     MOVE *OFF      *IN25                           182452
     C/COPY WNCPYSRC,RE3762C080
     C                     Z-ADDMHISD     WHISDC
     C                     Z-ADDMNBL      WMNBL
     C*
     C                     END                             - E7
     C*
     C                     ELSE                            - X6
     C*
     C           DRECI     IFEQ 'S'                        - B7
     C*
     C**  PROCESS A S RECORD
     C*
     C***********SDICI     IFEQ 'Y'                        - B8          098818
     C           SDICI     IFNE *BLANKS                    - B8          098818
     C*
     C**  PROCESS IF DEBIT CAPITALISATION
     C*
     C                     Z-ADDWDRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDDHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C********** *IN80     IFEQ '1'                                       125176
     C           SMNBL0    MULT DAYS      NUMB0
     C**********           ELSE                                           125176
     C********** *IN81     IFEQ '1'                                       125176
     C********** SMNBL1    MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** *IN82     IFEQ '1'                                       125176
     C********** SMNBL2    MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** SMNBL3    MULT DAYS      NUMB0                           125176
     C**********           END                                            125176
     C**********           END                                            125176
     C**********           END                                            125176
     C********** NUMB0     DIV  100       NUMB0     H                     125176
     C*
     C           SMNBL     IFGT *ZEROS                     - B9
     C                     Z-ADDDINT      INTD0
     C                     EXSR OVERDC
     C                     WRITESTODDC
     C/COPY WNCPYSRC,RE3762C081
     C                     ELSE                            - X9
     C                     Z-SUBCINT      INTC0
     C                     EXSR OVERDC
     C                     WRITESTOCDC
     C/COPY WNCPYSRC,RE3762C082
     C                     END                             - E9
     C*
     C                     Z-ADDDHISD     WHISDD
     C*
     C                     END                             - E8
     C*
     C***********SCICI     IFEQ 'Y'                        - B8           098818
     C           SCICI     IFNE *BLANKS                                   098818
     C*
     C**  PROCESS IF CREDIT CAPITALISATION
     C*
     C                     Z-ADDWCRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDDHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C********** *IN80     IFEQ '1'                                       125176
     C           SMNBL0    MULT DAYS      NUMB0
     C**********           ELSE                                           125176
     C********** *IN81     IFEQ '1'                                       125176
     C********** SMNBL1    MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** *IN82     IFEQ '1'                                       125176
     C********** SMNBL2    MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** SMNBL3    MULT DAYS      NUMB0                           125176
     C**********           END                                            125176
     C**********           END                                            125176
     C**********           END                                            125176
     C********** NUMB0     DIV  100       NUMB0     H                     125176
     C*
     C           SMNBL     IFGT *ZEROS                     - B9
     C                     Z-ADDDINT      INTD0
     C                     EXSR OVERDC
     C                     WRITESTODDC
     C/COPY WNCPYSRC,RE3762C083
     C                     ELSE                            - X9
     C                     Z-SUBCINT      INTC0
     C                     EXSR OVERDC
     C                     WRITESTOCDC
     C/COPY WNCPYSRC,RE3762C084
     C                     END                             - E9
     C*
     C                     Z-ADDDHISD     WHISDC
     C*
     C                     END                             - E8
     C*
     C                     END                             - E7
     C*
     C                     END                             - E6
     C*
     C                     END                             - E5
     C*
     C                     END                             - E4
     C*
     C                     END                             - E3
     C*
     C                     ELSE                            - X2
     C*
     C********** CDICT     IFGT 2                          - B3           182452
     C********** CCICT     ANDLT3                                         182452
     C           DDICT     IFGT 2                          - B3           182452
     C           DCICT     ANDLT3                                         182452
     C*
     C**  PROCESS IN CASE OF INTEREST TYPE CREDIT IS LESS THAN 3
     C**  AND INTEREST TYPE DEBIT IS GREATER THAN 2
     C*
     C**  PROCESS OUTPUT CHANGING DAY
     C*
     C**********           Z-ADDWMNBL     HISB0                           182452
     C                     Z-ADDWHISB     HISB0                           182452
     C                     EXSR OVERDC
     C                     WRITEODAYDC
     C/COPY WNCPYSRC,RE3762C085
     C*
     C           DCRCI     IFEQ 'Y'                        - B4
     C*
     C**  PROCESS WHEN CHANGE RATE CREDIT
     C*
     C                     Z-ADDWCRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDDHISD     ZIEND
     C*
     C                     EXSR ZICD
     C*
     C                     Z-ADDZDAYN1    DAYS
     C                     Z-ADDWHISB     HISB0
     C********** *IN80     IFEQ '1'                                       125176
     C           HISB0     MULT DAYS      NUMB0
     C**********           ELSE                                           125176
     C********** *IN81     IFEQ '1'                                       125176
     C********** HISB1     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** *IN82     IFEQ '1'                                       125176
     C********** HISB2     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** HISB3     MULT DAYS      NUMB0                           125176
     C**********           END                                            125176
     C**********           END                                            125176
     C**********           END                                            125176
     C********** NUMB0     DIV  100       NUMB0     H                     125176
     C           DDAID     SUB  WDAID     INTD0
     C           DCAID     SUB  WCAID     INTC0
     C*
     C           DAYS      IFNE *ZEROS                     - B5
     C*
     C                     EXSR OVERDC
     C                     WRITESTOTDC
     C/COPY WNCPYSRC,RE3762C086
     C*
     C                     END                             - E5
     C*
     C                     END                             - E4
     C*
     C**  PROCESS END OF MONTH OR CHANGE RATE FOR DEBIT
     C*
     C           DRECI     IFEQ 'M'                        - B4
     C           DSDAT     ANDNE*ZEROS
      *                                                                   182452
      **  Transfer Midas date into DDMMMYY                                182452
      *                                                                   182452
     C                     Z-ADDMHISD     ZDAYNO                          182452
     C                     EXSR ZDATE2                                    182452
     C                     MOVE ZADATE    VALDA                           182452
     C*
     C                     Z-ADDWDRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDMHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C********** *IN80     IFEQ '1'                                       125176
     C           MNBL0     MULT DAYS      NUMB0
     C**********           ELSE                                           125176
     C********** *IN81     IFEQ '1'                                       125176
     C********** MNBL1     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** *IN82     IFEQ '1'                                       125176
     C********** MNBL2     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** MNBL3     MULT DAYS      NUMB0                           125176
     C**********           END                                            125176
     C**********           END                                            125176
     C**********           END                                            125176
     C********** NUMB0     DIV  100       NUMB0     H                     125176
     C*
     C                     Z-ADDMNBL      HISB0                           182452
     C                     MOVE *ON       *IN25                           182452
     C           MNBL      IFGT *ZEROS                     - B5
     C                     Z-ADDDINT      INTD0
     C                     EXSR OVERDC
     C                     WRITESTODDC
     C/COPY WNCPYSRC,RE3762C087
     C                     ELSE                            - X5
     C                     Z-SUBCINT      INTC0
     C                     EXSR OVERDC
     C                     WRITESTOCDC
     C/COPY WNCPYSRC,RE3762C088
     C                     END                             - E5
     C                     MOVE *OFF      *IN25                           182452
     C*
     C                     Z-ADDMHISD     WHISDD
     C                     Z-ADDMNBL      WMNBL
     C*
     C                     END                             - E4
     C*
     C           DRECI     DOWEQ'M'                        - B4
     C           *IN51     ANDEQ'0'
     C*
     C           KLIST1    READEREHISL                   51
     C*
     C           *IN51     IFEQ '0'                        - B5
     C*
     C           DRECI     IFEQ 'M'                        - B6
     C           DSDAT     ANDNE*ZEROS
      *                                                                   182452
      **  Transfer Midas date into DDMMMYY                                182452
      *                                                                   182452
     C                     Z-ADDMHISD     ZDAYNO                          182452
     C                     EXSR ZDATE2                                    182452
     C                     MOVE ZADATE    VALDA                           182452
     C*
     C                     Z-ADDWDRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDMHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C********** *IN80     IFEQ '1'                                       125176
     C           MNBL0     MULT DAYS      NUMB0
     C**********           ELSE                                           125176
     C********** *IN81     IFEQ '1'                                       125176
     C********** MNBL1     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** *IN82     IFEQ '1'                                       125176
     C********** MNBL2     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** MNBL3     MULT DAYS      NUMB0                           125176
     C**********           END                                            125176
     C**********           END                                            125176
     C**********           END                                            125176
     C********** NUMB0     DIV  100       NUMB0     H                     125176
     C*
     C                     Z-ADDMNBL      HISB0                           182452
     C                     MOVE *ON       *IN25                           182452
     C           MNBL      IFGT *ZEROS                     - B7
     C                     Z-ADDDINT      INTD0
     C                     EXSR OVERDC
     C                     WRITESTODDC
     C/COPY WNCPYSRC,RE3762C089
     C                     ELSE                            - X7
     C                     Z-SUBCINT      INTC0
     C                     EXSR OVERDC
     C                     WRITESTOCDC
     C/COPY WNCPYSRC,RE3762C090
     C                     END                             - E7
     C                     MOVE *OFF      *IN25                           182452
     C*
     C                     Z-ADDMHISD     WHISDD
     C                     Z-ADDMNBL      WMNBL
     C*
     C                     ELSE                            - X6
     C*
     C           DRECI     IFEQ 'S'                        - B7
     C***********SDICI     ANDEQ'Y'                                      098818
     C           SDICI     ANDNE*BLANKS                                  098818
     C*
     C                     Z-ADDWDRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDDHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C********** *IN80     IFEQ '1'                                       125176
     C           SMNBL0    MULT DAYS      NUMB0
     C**********           ELSE                                           125176
     C********** *IN81     IFEQ '1'                                       125176
     C********** SMNBL1    MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** *IN82     IFEQ '1'                                       125176
     C********** SMNBL2    MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** SMNBL3    MULT DAYS      NUMB0                           125176
     C**********           END                                            125176
     C**********           END                                            125176
     C**********           END                                            125176
     C********** NUMB0     DIV  100       NUMB0     H                     125176
     C*
     C           SMNBL     IFGT *ZEROS                     - B8
     C                     Z-ADDDINT      INTD0
     C                     EXSR OVERDC
     C                     WRITESTODDC
     C/COPY WNCPYSRC,RE3762C091
     C                     ELSE                            - X8
     C                     Z-SUBCINT      INTC0
     C                     EXSR OVERDC
     C                     WRITESTOCDC
     C/COPY WNCPYSRC,RE3762C092
     C                     END                             - E8
     C*
     C                     Z-ADDDHISD     WHISDD
     C*
     C                     END                             - E7
     C*
     C                     END                             - E6
     C*
     C                     END                             - E5
     C*
     C                     END                             - E4
     C*
     C                     ELSE                            - X3
     C*
     C**  PROCESS IN CASE OF INTEREST TYPE DEBIT IS LESS THAN 3
     C**  AND INTEREST TYPE CREDIT IS GREATER THAN 2
     C*
     C**  PROCESS OUTPUT CHANGING DAY
     C*
     C**********           Z-ADDWMNBL     HISB0                           182452
     C                     Z-ADDWHISB     HISB0                           182452
     C                     EXSR OVERDC
     C                     WRITEODAYDC
     C/COPY WNCPYSRC,RE3762C093
     C*
     C           DDRCI     IFEQ 'Y'                        - B4
     C*
     C**  DEBIT RATE CHANGE
     C*
     C                     Z-ADDWDRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDDHISD     ZIEND
     C*
     C                     EXSR ZICD
     C*
     C                     Z-ADDZDAYN1    DAYS
     C                     Z-ADDWHISB     HISB0
     C********** *IN80     IFEQ '1'                                       125176
     C           HISB0     MULT DAYS      NUMB0
     C**********           ELSE                                           125176
     C********** *IN81     IFEQ '1'                                       125176
     C********** HISB1     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** *IN82     IFEQ '1'                                       125176
     C********** HISB2     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** HISB3     MULT DAYS      NUMB0                           125176
     C**********           END                                            125176
     C**********           END                                            125176
     C**********           END                                            125176
     C********** NUMB0     DIV  100       NUMB0     H                     125176
     C*
     C           DAYS      IFNE *ZEROS                     - B5
     C*
     C                     EXSR OVERDC
     C                     WRITESTOTDC
     C/COPY WNCPYSRC,RE3762C094
     C*
     C                     END                             - E5
     C*
     C                     END                             - E4
     C*
     C**  CREDIT END OF MONTH OR CREDIT RATE CHANGE
     C*
     C           DRECI     IFEQ 'M'                        - B4
     C           CSDAT     ANDNE*ZEROS
      *                                                                   182452
      **  Transfer Midas date into DDMMMYY                                182452
      *                                                                   182452
     C                     Z-ADDMHISD     ZDAYNO                          182452
     C                     EXSR ZDATE2                                    182452
     C                     MOVE ZADATE    VALDA                           182452
     C*
     C                     Z-ADDWCRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDMHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C********** *IN80     IFEQ '1'                                       125176
     C           MNBL0     MULT DAYS      NUMB0
     C**********           ELSE                                           125176
     C********** *IN81     IFEQ '1'                                       125176
     C********** MNBL1     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** *IN82     IFEQ '1'                                       125176
     C********** MNBL2     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** MNBL3     MULT DAYS      NUMB0                           125176
     C**********           END                                            125176
     C**********           END                                            125176
     C**********           END                                            125176
     C********** NUMB0     DIV  100       NUMB0     H                     125176
     C*
     C                     Z-ADDMNBL      HISB0                           182452
     C                     MOVE *ON       *IN25                           182452
     C           MNBL      IFGT *ZEROS                     - B5
     C                     Z-ADDDINT      INTD0
     C                     EXSR OVERDC
     C                     WRITESTODDC
     C/COPY WNCPYSRC,RE3762C095
     C                     ELSE                            - X5
     C                     Z-SUBCINT      INTC0
     C                     EXSR OVERDC
     C                     WRITESTOCDC
     C/COPY WNCPYSRC,RE3762C096
     C                     END                             - E5
     C                     MOVE *OFF      *IN25                           182452
     C*
     C                     Z-ADDMHISD     WHISDC
     C                     Z-ADDMNBL      WMNBL
     C*
     C                     END                             - E4
     C*
     C           DRECI     DOWEQ'M'                        - B4
     C           *IN51     ANDEQ'0'
     C*
     C           KLIST1    READEREHISL                   51
     C*
     C           *IN51     IFEQ '0'                        - B5
     C*
     C           DRECI     IFEQ 'M'                        - B6
     C           CSDAT     ANDNE*ZEROS
      *                                                                   182452
      **  Transfer Midas date into DDMMMYY                                182452
      *                                                                   182452
     C                     Z-ADDMHISD     ZDAYNO                          182452
     C                     EXSR ZDATE2                                    182452
     C                     MOVE ZADATE    VALDA                           182452
     C*
     C                     Z-ADDWCRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDMHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C********** *IN80     IFEQ '1'                                       125176
     C           MNBL0     MULT DAYS      NUMB0
     C**********           ELSE                                           125176
     C********** *IN81     IFEQ '1'                                       125176
     C********** MNBL1     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** *IN82     IFEQ '1'                                       125176
     C********** MNBL2     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** MNBL3     MULT DAYS      NUMB0                           125176
     C**********           END                                            125176
     C**********           END                                            125176
     C**********           END                                            125176
     C********** NUMB0     DIV  100       NUMB0     H                     125176
     C*
     C                     Z-ADDMNBL      HISB0                           182452
     C                     MOVE *ON       *IN25                           182452
     C           MNBL      IFGT *ZEROS                     - B7
     C                     Z-ADDDINT      INTD0
     C                     EXSR OVERDC
     C                     WRITESTODDC
     C/COPY WNCPYSRC,RE3762C097
     C                     ELSE                            - X7
     C                     Z-SUBCINT      INTC0
     C                     EXSR OVERDC
     C                     WRITESTOCDC
     C/COPY WNCPYSRC,RE3762C098
     C                     END                             - E7
     C                     MOVE *OFF      *IN25                           182452
     C*
     C                     Z-ADDMHISD     WHISDC
     C                     Z-ADDMNBL      WMNBL
     C*
     C                     ELSE                            - X6
     C*
     C           DRECI     IFEQ 'S'                        - B7
     C***********SCICI     ANDEQ'Y'                                      098818
     C           SCICI     ANDNE*BLANKS                                  098818
     C*
     C                     Z-ADDWCRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDDHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C********** *IN80     IFEQ '1'                                       125176
     C           SMNBL0    MULT DAYS      NUMB0
     C**********           ELSE                                           125176
     C********** *IN81     IFEQ '1'                                       125176
     C********** SMNBL1    MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** *IN82     IFEQ '1'                                       125176
     C********** SMNBL2    MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** SMNBL3    MULT DAYS      NUMB0                           125176
     C**********           END                                            125176
     C**********           END                                            125176
     C**********           END                                            125176
     C********** NUMB0     DIV  100       NUMB0     H                     125176
     C*
     C           SMNBL     IFGT *ZEROS                     - B8
     C                     Z-ADDDINT      INTD0
     C                     EXSR OVERDC
     C                     WRITESTODDC
     C/COPY WNCPYSRC,RE3762C099
     C                     ELSE                            - X8
     C                     Z-SUBCINT      INTC0
     C                     EXSR OVERDC
     C                     WRITESTOCDC
     C/COPY WNCPYSRC,RE3762C100
     C                     END                             - E8
     C*
     C                     Z-ADDDHISD     WHISDC
     C*
     C                     END                             - E7
     C*
     C                     END                             - E6
     C*
     C                     END                             - E5
     C*
     C                     END                             - E4
     C*
     C                     END                             - E3
     C*
     C                     END                             - E2
     C*
     C                     END                             - E1
     C*
      ** If CRE001 is switched ON and Overdraft Processed Ind. is 'Y'     CRE001
      ** then Output Overdraft Limit                                      CRE001
      *                                                                   CRE001
     C           CRE001    IFEQ 'Y'                          B1           CRE001
     C           ODLI      ANDEQ'Y'                          A1           CRE001
      *                                                                   CRE001
     C                     MOVE *BLANKS   ODLI                            CRE001
     C                     MOVE *BLANKS   PSTDO                           CRE001
     C                     Z-ADD*ZEROS    PPSTD                           CRE001
     C                     MOVE *BLANKS   PSTDA                           CRE001
      *                                                                   CRE001
      ** Convert Retail History Debit Date to DDMMMYY format              CRE001
     C           PVALD     IFNE WWHISD                       B2           CRE001
     C                     MOVELWWHISD    ZDAYNO                          CRE001
     C                     EXSR ZDATE2                                    CRE001
     C                     MOVE ZADATE    VALDO                           CRE001
      *                                                                   CRE001
      **  Handle Conversion Error.                                        CRE001
      *                                                                   CRE001
     C           ZERROR    IFNE 0                          - B3           CRE001
     C                     Z-ADDWWHISD    WDATE                           CRE001
     C                     Z-ADD421       DBASE                           CRE001
     C                     MOVEL'ZDAT2'   DBFILE           ***************CRE001
     C                     MOVELWDATE     DBKEY            **DB ERROR 421*CRE001
     C                     MOVEA'1'       *IN,89           ***************CRE001
     C                     EXSR DBSR                                      CRE001
     C                     ENDIF                           - E3           CRE001
      *                                                                   CRE001
      ** Set Pervious Posting Value to Current Retail History DR Date     CRE001
     C                     Z-ADDWWHISD    PVALD                           CRE001
      *                                                                   CRE001
     C                     ENDIF                           - E2           CRE001
      *                                                                   CRE001
     C                     MOVE VALDO     VALDA                           CRE001
      *                                                                   CRE001
     C**********           MOVELNAR,29    NARR                     CRE001 125176
     C                     MOVELNAR,39    NARR                            125176
      *                                                                   CRE001
     C                     Z-ADD*ZERO     WODRL  150                      CRE001
     C                     SELEC                                          CRE001
     C           DPA,I     WHEQ 0                                         CRE001
     C                     Z-ADDODRL      WODRL                           CRE001
     C           DPA,I     WHEQ 1                                         CRE001
     C           ODRL      MULT 10        WODRL                           CRE001
     C           DPA,I     WHEQ 2                                         CRE001
     C           ODRL      MULT 100       WODRL                           CRE001
     C           DPA,I     WHEQ 3                                         CRE001
     C           ODRL      MULT 1000      WODRL                           CRE001
     C                     ENDSL                                          CRE001
      *                                                                   CRE001
     C           WODRL     IFGT *ZEROS                     - B2           CRE001
     C                     Z-ADDWODRL     PSTD0                           CRE001
     C                     ELSE                            - X2           CRE001
     C                     Z-SUBWODRL     PSTD0                           CRE001
     C                     ENDIF                           - E2           CRE001
      *                                                                   CRE001
      **  Output Posting for Debit and Credit                             CRE001
      *                                                                   CRE001
     C                     EXSR OVERDC                                    CRE001
     C                     WRITEPOSTDC                                    CRE001
     C/COPY WNCPYSRC,RE3762C033
      *                                                                   CRE001
     C                     END                               E1           CRE001
      *                                                                   CRE001
     C                     END                             - E2
     C*
     C                     END                             - E1
      *                                                                   CRE001
      ** If CRE001 is switched ON and Overdraft Processed Ind. is 'Y'     CRE001
      ** then Output Overdraft Limit                                      CRE001
      *                                                                   CRE001
     C           CRE001    IFEQ 'Y'                          B3           CRE001
     C           ODLI      ANDEQ'Y'                          A3           CRE001
      *                                                                   CRE001
     C                     MOVE *BLANKS   ODLI                            CRE001
     C                     MOVE *BLANKS   PSTDO                           CRE001
     C                     Z-ADD*ZEROS    PPSTD                           CRE001
     C                     MOVE *BLANKS   PSTDA                           CRE001
      *                                                                   CRE001
     C           PVALD     IFNE DHISD                      - B4           CRE001
      *                                                                   CRE001
      ** Convert History Debit Capitalisation Date to DDMMMYY Format      CRE001
     C                     MOVELDHISD     ZDAYNO                          CRE001
     C                     EXSR ZDATE2                                    CRE001
     C                     MOVE ZADATE    VALDO                           CRE001
      *                                                                   CRE001
      ** Handle Conversion Error.                                         CRE001
      *                                                                   CRE001
     C           ZERROR    IFNE 0                          - B5           CRE001
     C                     Z-ADDDHISD     WDATE                           CRE001
     C                     Z-ADD421       DBASE                           CRE001
     C                     MOVEL'ZDAT2'   DBFILE           ***************CRE001
     C                     MOVELWDATE     DBKEY            **DB ERROR 421*CRE001
     C                     MOVEA'1'       *IN,89           ***************CRE001
     C                     EXSR DBSR                                      CRE001
     C                     ENDIF                           - E5           CRE001
      *                                                                   CRE001
     C                     Z-ADDDHISD     PVALD                           CRE001
      *                                                                   CRE001
     C                     ENDIF                           - E4           CRE001
      *                                                                   CRE001
     C                     MOVE VALDO     VALDA                           CRE001
      *                                                                   CRE001
     C**********           MOVELNAR,29    NARR                     CRE001 125176
     C                     MOVELNAR,39    NARR                            125176
      *                                                                   CRE001
     C                     Z-ADD*ZERO     WODRL  150                      CRE001
     C                     SELEC                                          CRE001
     C           DPA,I     WHEQ 0                                         CRE001
     C                     Z-ADDODRL      WODRL                           CRE001
     C           DPA,I     WHEQ 1                                         CRE001
     C           ODRL      MULT 10        WODRL                           CRE001
     C           DPA,I     WHEQ 2                                         CRE001
     C           ODRL      MULT 100       WODRL                           CRE001
     C           DPA,I     WHEQ 3                                         CRE001
     C           ODRL      MULT 1000      WODRL                           CRE001
     C                     ENDSL                                          CRE001
      *                                                                   CRE001
     C           WODRL     IFGT *ZEROS                     - B4           CRE001
     C                     Z-ADDWODRL     PSTD0                           CRE001
     C                     ELSE                            - X4           CRE001
     C                     Z-SUBWODRL     PSTD0                           CRE001
     C                     ENDIF                           - E4           CRE001
      *                                                                   CRE001
      **  Output Posting for Debit and Credit                             CRE001
      *                                                                   CRE001
     C                     EXSR OVERDC                                    CRE001
     C                     WRITEPOSTDC                                    CRE001
     C/COPY WNCPYSRC,RE3762C034
      *                                                                   CRE001
     C                     ENDIF                             E3           CRE001
     C*
     C**  TRANSFER DATE MIDAS INTO DDMMMYY
     C*
     C           PVALD     IFNE CHISD                      - B1
     C                     Z-ADDCHISD     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALDO
     C*
     C                     MOVE CHISD     PVALD
     C*
     C                     END                             - E1
     C*
     C                     MOVE VALDO     VALDA
     C*
     C           WHISB     IFGT *ZEROS                     - B1
     C                     Z-ADDWDRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C           CDAIC     SUB  WDAID     INTD0
     C                     SUB  DTMADI    INTD0                           160301
     C                     Z-ADD*ZERO     INTC0
     C                     ELSE                            - X1
     C                     Z-ADDWCRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C           CCAIC     SUB  WCAID     INTC0
     C                     SUB  DTMACI    INTC0                           160301
     C                     Z-SUBINTC0     INTC0                           160301
     C                     Z-ADD*ZERO     INTD0
     C                     END                             - E1
     C*
     C                     Z-ADDCHISD     ZIEND
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C                     Z-ADDWHISB     HISB0
     C********** *IN80     IFEQ '1'                                       125176
     C           HISB0     MULT DAYS      NUMB0
     C**********           ELSE                                           125176
     C********** *IN81     IFEQ '1'                                       125176
     C********** HISB1     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** *IN82     IFEQ '1'                                       125176
     C********** HISB2     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** HISB3     MULT DAYS      NUMB0                           125176
     C**********           END                                            125176
     C**********           END                                            125176
     C**********           END                                            125176
     C********** NUMB0     DIV  100       NUMB0     H                     125176
     C                     EXSR OVERDC
     C                     WRITESTOTDC
     C/COPY WNCPYSRC,RE3762C101
     C*
     C*
     C** PREPARE C/F BALANCE
     C*
     C                     EXSR CLMSG
     C                     MOVELNAR,6     TNARR
     C*
     C                     Z-ADDCHISB     HISB0
     C*
     C**  OUTPUT BALANCE C/F
     C*
     C                     EXSR OVERDC
     C                     WRITETITLEDC
     C/COPY WNCPYSRC,RE3762C198
     C*
     C**  PREPARE TOTAL INTEREST OUTPUT
     C*
     C           CLDID     IFLE CLCID                                     160301
     C                     Z-ADDWDRCB     ZICALC
     C                     Z-ADDCLDID     ZIBEG
     C                     ELSE                                           160301
     C                     Z-ADDWCRCB     ZICALC                          160301
     C                     Z-ADDCLCID     ZIBEG                           160301
     C                     END                                            160301
     C                     Z-ADDCHISD     ZIEND
     C                     EXSR ZICD
     C*
     C                     Z-ADDZDAYN1    DAYS
     C*
     C                     EXSR CLMSG
     C                     MOVELNAR,5     XNARR
     C*
     C                     Z-ADDCDAIC     TINTD0
     C**********           Z-ADDCCAIC     TINTC0                          160301
     C                     Z-SUBCCAIC     TINTC0                          160301
     C*
     C**  Calculate base rate tax
     C*
     C                     EXSR CALBRT
      *                                                                                       CGL031
      ** Retrieval of EU witholding tax                                                       CGL031
      *                                                                                       CGL031
     C           CGL031    IFEQ 'Y'                                                           CGL031
     C                     EXSR CALEUT                                                        CGL031
     C                     ENDIF                                                              CGL031
      *                                                                                       CGL031
     C/COPY WNCPYSRC,RE3762C020
     C*
     C**  OUTPUT TOTAL INTEREST
     C*
     C                     EXSR OVERDC
     C                     WRITETOTALDC
     C/COPY WNCPYSRC,RE3762C102
      *                                                                   130468
      * Report total generated adjustments                                130468
     C           CSGADI    IFNE *ZEROS                                    130468
     C           CSGACI    ORNE *ZEROS                                    130468
     C                     EXSR CLMSG                                     130468
     C                     Z-ADDCSGADI    TINTD0                          130468
     C**********           Z-ADDCSGACI    TINTC0                   130468 160301
     C                     Z-SUBCSGACI    TINTC0                          160301
     C                     MOVELNAR,23    DNARR                           130468
     C                     EXSR OVERDC                                    130468
     C                     WRITETOTDDC                                    130468
     C/COPY WNCPYSRC,RE3762C103
     C                     END                                            130468
      *                                                                   130468
      * Report BRT if required                                            130468
     C           *IN22     IFEQ '1'                                       130468
     C                     EXSR OVERDC                                    130468
     C                     WRITETOTBRT                                    130468
     C                     END                                            130468
      *                                                                                       CGL031
      ** Reprot EUT if required                                                               CGL031
      *                                                                                       CGL031
     C           *IN21     IFEQ *ON                                                           CGL031
     C                     EXSR OVERDC                                                        CGL031
     C                     WRITEEUWTAX                                                        CGL031
      *                                                                                       CER048
      ** Print Secondary Tax Amount                                                           CER048
      *                                                                                       CER048
     C           CER048    IFEQ 'Y'                                                           CER048
      *                                                                                       CER048
     C                     EXSR OVERDC                                                        CER048
     C                     WRITESECTAX                                                        CER048
      *                                                                                       CER048
     C                     ENDIF                                                              CER048
      *                                                                                       CER048
     C                     ENDIF                                                              CGL031
      *                                                                   160301
      * Output charge report totals if required                           160301
     C           CCHGP     IFNE 0                                         160301
     C                     Z-ADD0         PSTD0                           160301
     C                     MOVELNAR,22    XNARR                           160301
     C                     EXSR OVERDC                                    160301
     C                     WRITESTOTCH                                    160301
      *                                                                   160301
      * Calculate rebate                                                  160301
     C                     EXSR REBSR                                     160301
     C           REBATE    IFNE 0                                         160301
     C                     EXSR OVERDC                                    160301
     C                     WRITESREBCH                                    160301
     C                     END                                            160301
      *                                                                   160301
     C                     MOVELNAR,21    XNARR                           160301
     C                     Z-ADDCCHGP     CHGP0                           160301
     C                     EXSR OVERDC                                    160301
     C                     WRITETOTALCH                                   160301
     C/COPY WNCPYSRC,RE3762C104
     C                     END                                            160301
     C*
     C**  PREPARE TOTAL COMMISSION OUTPUT
     C*
     C*
     C**  PREPARE FIXED COMMISSION OUTPUT
     C*
     C           FXDC      IFNE *ZERO                      - B1
     C                     EXSR CLMSG
     C**********           MOVELNAR,16    DNARR                           125176
     C                     MOVELNAR,28    DNARR                           125176
     C*
     C                     Z-ADDFXDC      TINTD0
     C                     Z-ADD*ZERO     TINTC0
     C                     EXSR OVERDC
     C                     WRITETOTDDC
     C/COPY WNCPYSRC,RE3762C105
     C                     END                             - E1
     C/COPY WNCPYSRC,RE3762C002
     C*
     C*
     C**  PREPARE COMMISSION ON DEBIT INTEREST
     C*
     C           *IN70     IFEQ '1'                        - B1
     C*
     C           CDIE      IFNE *ZERO                      - B2
     C                     EXSR CLMSG
     C                     MOVELNAR,17    DNARR
     C*
     C                     Z-ADDCDIE      TINTD0
     C                     Z-ADD*ZERO     TINTC0
     C                     EXSR OVERDC
     C                     WRITETOTDDC
     C/COPY WNCPYSRC,RE3762C106
     C                     END                             - E2
     C*
     C*
     C**  PREPARE ACCOUNT COMMISSION
     C*
     C           ACCEA     IFNE *ZERO                      - B2
     C                     EXSR CLMSG
     C                     MOVELNAR,18    DNARR
     C*
     C                     Z-ADDACCEA     TINTD0
     C                     Z-ADD*ZERO     TINTC0
     C                     EXSR OVERDC
     C                     WRITETOTDDC
     C/COPY WNCPYSRC,RE3762C107
     C                     END                             - E2
     C*
     C**  PREPARE H/O COMMISSION
     C*
     C           CHDBE     IFNE *ZERO                      - B2
     C                     EXSR CLMSG
     C                     MOVELNAR,19    DNARR
     C*
     C                     Z-ADDCHDBE     TINTD0
     C                     Z-ADD*ZERO     TINTC0
     C                     EXSR OVERDC
     C                     WRITETOTDDC
     C/COPY WNCPYSRC,RE3762C108
     C                     END                             - E2
     C*
     C**  PREPARE COMMISSION ON MINIMUM BALANCE
     C*
     C           CMBE      IFNE *ZERO                      - B2
     C                     EXSR CLMSG
     C                     MOVELNAR,20    DNARR
     C*
     C                     Z-ADDCMBE      TINTD0
     C                     Z-ADD*ZERO     TINTC0
     C                     EXSR OVERDC
     C                     WRITETOTDDC
     C/COPY WNCPYSRC,RE3762C109
     C                     END                             - E2
     C*
     C                     ELSE                            - X1
     C*
     C           CDICA     IFNE *ZERO                      - B2
     C                     EXSR CLMSG
     C                     MOVELNAR,17    DNARR
     C*
     C           CDICA     SUB  CCDIC     TINTD0
     C                     Z-ADD*ZERO     TINTC0
     C                     EXSR OVERDC
     C                     WRITETOTDDC
     C/COPY WNCPYSRC,RE3762C110
     C                     END                             - E2
     C*
     C*
     C**  PREPARE ACCOUNT COMMISSION
     C*
     C           ACCC      IFNE *ZERO                      - B2
     C                     EXSR CLMSG
     C                     MOVELNAR,18    DNARR
     C*
     C           ACCC      SUB  CACCC     TINTD0
     C                     Z-ADD*ZERO     TINTC0
     C                     EXSR OVERDC
     C                     WRITETOTDDC
     C/COPY WNCPYSRC,RE3762C111
     C                     END                             - E2
     C*
     C*
     C**  PREPARE H/O COMMISSION
     C*
     C           CHDBC     IFNE *ZERO                      - B2
     C                     EXSR CLMSG
     C                     MOVELNAR,19    DNARR
     C*
     C           CHDBC     SUB  CCHDBC    TINTD0
     C                     Z-ADD*ZERO     TINTC0
     C                     EXSR OVERDC
     C                     WRITETOTDDC
     C/COPY WNCPYSRC,RE3762C112
     C                     END                             - E2
     C*
     C**  PREPARE COMMISSION ON MINIMUM BALANCE
     C*
     C           CMBC      IFNE *ZERO                      - B2
     C                     EXSR CLMSG
     C                     MOVELNAR,20    DNARR
     C*
     C           CMBC      SUB  CCMBC     TINTD0
     C                     Z-ADD*ZERO     TINTC0
     C                     EXSR OVERDC
     C                     WRITETOTDDC
     C/COPY WNCPYSRC,RE3762C113
     C                     END                             - E2
     C*
     C**  PREPARE VAT
     C*
     C           VATAM     IFNE *ZERO                      - B2
     C                     EXSR CLMSG
     C                     MOVELNAR,24    DNARR
     C*
     C                     Z-ADDVATAM     TINTD0
     C                     Z-ADD*ZERO     TINTC0
     C                     EXSR OVERDC
     C                     WRITETOTDDC
     C/COPY WNCPYSRC,RE3762C114
     C                     END                             - E2
     C*
     C                     END                             - E1
     C*
     C**  PREPARE TOTAL CHARGES
     C*
     C*
     C**CHARGE*REPORT*IF*NECESSARY                                        160301
     C*
     C********** CCICI     IFNE *BLANK                                    160301
     C********** CCHGP     ANDNE*ZERO                                     160301
     C**********           Z-ADDCCHGP     CHGP0                           160301
     C**********           MOVELNAR,22    XNARR                           160301
     C**********           WRITETOTALCH                                   160301
     C**********           END                                            160301
     C           CCHGP     IFNE *ZERO                      - B1
     C                     EXSR CLMSG
     C                     MOVELNAR,22    DNARR
     C*
     C                     Z-ADD*ZEROS    TINTD0
     C                     Z-ADDCCHGP     TINTC0
     C**********           MOVE 'DR'      TINTCS  2                       160301
     C                     EXSR OVERDC
     C                     WRITETOTDDC
     C/COPY WNCPYSRC,RE3762C115
     C**********           MOVE '  '      TINTCS                          160301
     C                     END                             - E1
     C*
     C*
     C**  PREPARE WITHHOLDING TAX OUTPUT
     C*
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3762CPDR                                           S01408
     C*                                                                   S01408
     C           WWCINW    IFNE *ZEROS                     - B1
     C                     EXSR CLMSG
     C                     MOVEL*BLANKS   NCACP  19
     C           CACP      IFNE *BLANKS                    - B2
     C                     MOVEL' BY '    NCACP
     C                     MOVE CACP      NCACP
     C                     END                             - E2
     C                     MOVELNAR,26    DNARR
     C                     MOVE NCACP     DNARR
     C*
     C                     Z-ADD*ZEROS    TINTD0
     C                     Z-ADDWWCINW    TINTC0
     C                     EXSR OVERDC
     C                     MOVE '1'       *IN41
     C                     WRITETOTDDC
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3762CPD1                                           S01408
     C*                                                                   S01408
     C                     MOVE '0'       *IN41
     C                     END                             - E1
     C*
     C**  PREPARE TOTAL
     C*
     C                     Z-ADD*ZERO     TINTD0
     C           *IN70     IFEQ '0'                        - B2
     C                     ADD  CDICA     TINTD0
     C                     ADD  ACCC      TINTD0
     C                     ADD  CHDBC     TINTD0
     C                     ADD  CMBC      TINTD0
     C                     ADD  VATAM     TINTD0
     C                     ELSE                            - X2
     C                     ADD  CDIE      TINTD0
     C                     ADD  ACCEA     TINTD0
     C                     ADD  CHDBE     TINTD0
     C                     ADD  CMBE      TINTD0
     C                     END                             - E2
     C                     ADD  FXDC      TINTD0                          160301
      *                                                                   160301
     C           CSDCI     IFEQ 'Y'                        - B1
     C           CSDCI     OREQ 'I'
     C           CSDCI     OREQ 'A'
     C**********           ADD  FXDC      TINTD0                          160301
     C/COPY WNCPYSRC,RE3762C003
     C                     ADD  CDAIC     TINTD0
     C                     END                             - E1
     C           CSCCI     IFEQ 'Y'
     C           CSCCI     OREQ 'I'
     C           CSCCI     OREQ 'A'
     C                     SUB  CCAIC     TINTD0
     C                     ADD  WWCINW    TINTD0
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3762CCP5                                           S01408
     C*                                                                   S01408
     C                     END
      *                                                                   130468
      * Add BRT if applicable                                             130468
     C           *IN22     IFEQ '1'                                       130468
     C                     ADD  BRTOT0    TINTD0                          130468
     C                     END                                            130468
      *                                                                                       CGL031
      ** Add EUT if applicable                                                                CGL031
      *                                                                                       CGL031
     C           *IN21     IFEQ *ON                                                           CGL031
     C                     ADD  EUTAX0    TINTD0                                              CGL031
      *                                                                                       CER048
      ** Add Secondary Tax, if applicable                                                     CER048
      *                                                                                       CER048
     C           CER048    IFEQ 'Y'                                                           CER048
     C                     ADD  STAX0     TINTD0                                              CER048
     C                     ENDIF                                                              CER048
      *                                                                                       CER048
     C                     ENDIF                                                              CGL031
      *                                                                   130468
     C           CSCHGI    IFEQ 'Y'
     C           CSCHGI    OREQ 'I'
     C           CSCHGI    OREQ 'A'
     C           CSCHGI    OREQ 'L'                                       160301
     C           CSCHGI    OREQ 'O'                                       160301
     C                     ADD  CCHGP     TINTD0
     C                     END
      *                                                                   130468
     C                     ADD  CSGADI    TINTD0                          130468
     C                     SUB  CSGACI    TINTD0                          130468
      *                                                                   130468
     C                     EXSR CLMSG
     C                     MOVELNAR,21    DNARR
     C*
     C           TINTD0    IFGE *ZERO                      - B1
     C                     Z-ADD*ZEROS    TINTC0
     C                     ELSE
     C**********           Z-SUBTINTD0    TINTC0                          160301
     C                     Z-ADDTINTD0    TINTC0                          160301
     C                     Z-ADD*ZEROS    TINTD0
     C                     END                             - E1
     C                     EXSR OVERDC
     C                     WRITETOTDDC
     C/COPY WNCPYSRC,RE3762C116
     C*
     C***CAPITALISATION*TO*AN*ACCOUNT IN DIFFERENT CURRENCY AND           125176
     C***MULTIBRANCH*IS*PRESENT                                           125176
     C*
      * Report alternative a/c for DR interest if used                    125176
     C           SDACP     IFNE *BLANK                                    125176
      *                                                                   125176
      * If capitalisation to a/c in different ccy, report exchange rate   125176
     C           *IN87     IFEQ '1'                        - B1
     C**********           MOVELNAR,25    NARR                            125176
     C********** DEXRT     IFNE *ZEROS                     - B2           125176
     C           DEXRT     ANDNE*ZEROS                                    125176
     C                     Z-ADDDEXRT     RATE
     C                     MOVE '0'       *IN55                           125176
     C                     ELSE                                           125176
     C                     MOVE '1'       *IN55                           125176
     C                     END                                            125176
      *                                                                   125176
     C                     EXSR CLMSG                                     125176
     C                     MOVELNAR,32    NARR                            125176
     C                     MOVELSDACP     MIDK   15
     C                     EXSR OVERDC
     C                     WRITEALTNDC
     C/COPY WNCPYSRC,RE3762C117
     C                     END                             - E2
      *                                                                   125176
      * Report alternative a/c for CR interest if used                    125176
     C           SCACP     IFNE *BLANK                                    125176
      *                                                                   125176
      * If capitalisation to a/c in different ccy, report exchange rate   125176
     C           *IN87     IFEQ '1'                                       125176
     C********** CEXRT     IFNE *ZEROS                     - B2           125176
     C           CEXRT     ANDNE*ZEROS                                    125176
     C                     Z-ADDCEXRT     RATE
     C                     MOVE '0'       *IN55                           125176
     C                     ELSE                                           125176
     C                     MOVE '1'       *IN55                           125176
     C                     END                                            125176
      *                                                                   125176
     C                     EXSR CLMSG                                     125176
     C                     MOVELNAR,31    NARR                            125176
     C                     MOVELSCACP     MIDK
     C                     EXSR OVERDC
     C                     WRITEALTNDC
     C/COPY WNCPYSRC,RE3762C118
     C                     END                             - E2
      *                                                                   125176
      * Report alternative a/c for charges if used                        125176
     C           SCHAC     IFNE *BLANK                                    125176
      *                                                                   125176
      * If capitalisation to a/c in different ccy, report exchange rate   125176
     C           *IN87     IFEQ '1'                                       125176
     C********** CHXRT     IFNE *ZEROS                     - B2           125176
     C           CHXRT     ANDNE*ZEROS                                    125176
     C                     Z-ADDCHXRT     RATE
     C                     MOVE '0'       *IN55                           125176
     C                     ELSE                                           125176
     C                     MOVE '1'       *IN55                           125176
     C                     END                                            125176
      *                                                                   125176
     C                     EXSR CLMSG                                     125176
     C                     MOVELNAR,33    NARR                            125176
     C                     MOVELSCHAC     MIDK
     C                     EXSR OVERDC
     C                     WRITEALTNDC
     C/COPY WNCPYSRC,RE3762C119
     C                     END                             - E2
     C**********           END                             - E1           125176
     C*
     C           *IN70     IFEQ '1'                        - B1
     C                     EXSR OVERDC
     C                     WRITETOTMAN
     C                     END
     C*
     C/COPY WNCPYSRC,RE3762C007
     C                     ENDSR                           **BOTHSR ENDSR*
      *****************************************************************                       CGL031
      *                                                               *                       CGL031
      *  CALEUT - Tax Amount Retrieval                                *                       CGL031
      *                                                               *                       CGL031
      *****************************************************************                       CGL031
     C           CALEUT    BEGSR                                                              CGL031
      *                                                                                       CGL031
      ** Check if the customer is actually a Joint A/c.                                       235917
      *                                                                                       235917
     C                     MOVELCCNUM     KJANO   6                                           235917
     C           KJANO     CHAINSDJACCL1             53                                       235917
      *                                                                                       235917
     C                     MOVE 'N'       WJACC   1                                           235917
     C           *IN53     IFEQ *OFF                                                          235917
     C                     MOVE 'Y'       WJACC                                               235917
     C                     ENDIF                                                              235917
      *                                                                                       235917
      ** Retrieval of EU witholding tax                                                       CGL031
      *                                                                                       CGL031
     C                     MOVE *ON       *IN21                                               CGL031
      *                                                                                       CGL031
     C                     MOVE 'G'       MODI                                                CGL031
     C                     MOVE CCNUM     CCNUMX                                              CGL031
     C**********           MOVELCCNUM     KJOIN   60                                  235917 CSD027A
     C                     MOVELCCNUM     KJOIN   6                                          CSD027A
     C           WJACC     IFEQ 'Y'                                                           235917
     C           KLISTC    SETLLSDCSINLC             53                                       235917
     C           KLISTC    READESDCSINLC                 53                                   235917
     C                     ELSE                                                               235917
     C           KLIST7    SETLLSDCSINL7             53                                       CGL031
     C           KLIST7    READESDCSINL7                 53                                   CGL031
     C                     ENDIF                                                              235917
     C           *IN53     DOWEQ*OFF                                                          CGL031
     C           TSSTAT    IFEQ 'T'                                                           CGL031
      *                                                                                       CGL031
     C                     ADD  TSTXSR    EUTAX0                                              CGL031
      *                                                                                       CER048
      ** Accumulate Secondary Tax Amount in Original Currency                                 CER048
      *                                                                                       CER048
     C           CER048    IFEQ 'Y'                                                           CER048
     C           STAX0     ADD  TSSTDO    STAX0                                               CER048
     C                     ENDIF                                                              CER048
      *                                                                                       CER048
     C                     ENDIF                                                              CGL031
     C*                                                                                       235917
     C           WJACC     IFEQ 'Y'                                                           235917
     C           KLISTC    READESDCSINLC                 53                                   235917
     C                     ELSE                                                               235917
     C           KLIST7    READESDCSINL7                 53                                   CGL031
     C                     ENDIF                                                              235917
     C*                                                                                       235917
     C                     ENDDO                                                              CGL031
      *                                                                                       CGL031
     C                     ENDSR                                                              CGL031
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** B1EQ subroutine for begin when same date
     C**
     C**     Called by       B O T H S R
     C**
     C**     Calls           DBSR, POSTSR
     C**
     C           B1EQ      BEGSR                           **B1EQ   BEGSR*
     C*
     C           KLIST2    SETLLREHPOPH
     C*
     C           KLIST1    READEREHPOPH                  50
     C*
     C**  BACK VALUE PROCESSING
     C*
     C           *IN50     DOWEQ'0'                        - B1
     C           PSTD      ANDLECHISD
     C*
      * If last day accruals a backvalued item posted on cap. value       160301
      * date is already reflected in that capitalisation.                 160301
      * If first day accruals a backvalued item posted on cap. value      160301
      * date is not reflected in that capitalisation as the cap. value    160301
      * date is cap. date + 1.                                            160301
     C           HISD      IFLT CLDID
     C           PSTD      ANDGTCLDID                                     160301
     C           HISD      ORLT CLDID                                     160301
     C           PSTD      ANDEQCLDID                                     160301
     C           LDAC      ANDEQ'N'                                       160301
     C           SPOS      ANDNE'  GE-IC'                                 160301
     C*
      * NB. REHPOPH now includes rate changes as well (REHPOSR1)          125176
      * Report backvalued posting                                         125176
     C           RECI      IFEQ 'P'                                       125176
     C                     MOVE 'Y'       @CHGF                           160301
     C                     EXSR POSTSR
     C                     ELSE                                           125176
      *                                                                   125176
      * Report backvalued rate change                                     125176
     C           DRCR      IFEQ 1                                         125176
     C                     Z-ADDHISD      DCRCD                           125176
     C                     EXSR RATEC                                     125176
     C                     ELSE                                           125176
     C                     Z-ADDHISD      DDRCD                           125176
     C                     EXSR RATED                                     125176
     C                     END                                            125176
     C                     END                                            125176
     C*
     C                     END
     C*
     C           KLIST1    READEREHPOPH                  50
     C*
     C                     END                             - E1
      *                                                                   160301
      * If a management cap. check for generated adjustments              160301
     C           *IN70     IFEQ '1'                        - B1
     C           KLIST1    SETLLREHISSL                  20
     C*
      * Report adjustments before start date                              160301
     C           *IN20     IFEQ '1'                        - B2
     C           KLIST1    READEREADJF                   20
     C           *IN20     DOWEQ'0'                        - B3
     C           AHISD     ANDLTCLDID                                     160301
     C*
     C** PRINT INTEREST OF THE BACK VALUE DATE
     C*
     C********** PPSTD     IFNE RUND                               125176 160301
     C**********           Z-ADDRUND      ZDAYNO                   125176 160301
     C**********           EXSR ZDATE2                             125176 160301
     C**********           MOVE ZADATE    PSTDO                    125176 160301
     C**********           Z-ADDRUND      PPSTD                    125176 160301
     C**********           END                                     125176 160301
     C**********           MOVE PSTDO     PSTDA                    125176 160301
      *                                                                   125176
     C**********           MOVELNAR,23    NARR                            160301
     C**********           Z-ADDAHISB     HISB0                           125176
     C*
     C**********           Z-ADDADAIC     INTD0                           160301
     C**********           Z-ADDACAIC     INTC0                           160301
     C*
     C           ASDCI     IFEQ 'Y'                                       160301
     C           ADAIC     ANDNE*ZEROS                                    160301
     C           ASCCI     OREQ 'Y'                                       160301
     C           ACAIC     ANDNE*ZEROS                                    160301
     C                     EXSR GADJSR                                    160301
     C                     EXSR OVERDC
     C                     WRITEMADJDC
     C/COPY WNCPYSRC,RE3762C120
     C                     END                                            160301
     C*
     C           KLIST1    READEREADJF                   20
     C                     END                             - E3
     C*
     C                     ELSE                                           160301
     C                     MOVE '1'       *IN20                           160301
     C                     END                             - E2
     C                     END                             - E1
     C*
     C**  PREPARE OPENING BALANCE
     C*
     C           PVALD     IFNE CLDID                      - B1
     C                     Z-ADDCLDID     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALDO
     C*
     C                     Z-ADDCLDID     PVALD
     C*
     C                     END                             - E1
     C*
     C                     MOVE VALDO     VALDA
     C*
     C                     Z-ADDDOHISB    HISB0
     C*
     C**  OPENING BALANCE DEBIT OUPUT
     C*
     C                     EXSR CLMSG
     C                     MOVELNAR,15    TNARR
     C*
     C                     EXSR OVERDC
     C                     WRITETITLEDC
     C/COPY WNCPYSRC,RE3762C121
     C                     Z-ADDCOHISB    HISB0
     C*
     C**  OPENING BALANCE CREDIT OUTPUT
     C*
     C                     EXSR CLMSG
     C                     MOVELNAR,16    TNARR
     C*
     C                     EXSR OVERDC
     C                     WRITETITLEDC
     C/COPY WNCPYSRC,RE3762C122
     C*
     C                     MOVE *BLANKS   VALDA
     C                     MOVE *BLANKS   PSTDA
     C*
     C                     EXSR CLMSG
     C*
     C**  OPENING RATE DEBIT OUTPUT
     C*
     C*
     C**  ACCESS REHRDJ (REHPOSR1 REHPOSR2 REHPOSR3) WHICH CONTAINS
     C**  THE GOOD DATES FOR DEBIT RATE CHANGE TO
     C*
     C**********           Z-ADDWWDRCD    KDATE   50                      125176
     C********** KEODLF    CHAINREHRDJ               60                   125176
     C           KLIST2    SETLLREHRDJ                                    125176
     C           KLIST1    REDPEREHRDJ                   60               125176
     C*
     C           *IN60     IFEQ '1'                                       125176
     C           BDATE     ANDEQCLDID                                     125176
     C           KLIST2    SETLLREHRDJ                                    125176
     C           KLIST2    READEREHRDJ                   60               125176
     C                     END                                            125176
     C           *IN60     IFEQ '1'                        - B1
     C                     Z-ADD*ZEROS    DRIR
     C                     Z-ADD*ZEROS    INTP                            125176
     C                     Z-ADD*ZEROS    INST                            125176
     C                     Z-ADD*ZEROS    INRT                            125176
     C                     END                             - E1
     C*
     C                     EXSR CLMSG
     C                     MOVELNAR,3     RNARR
     C*
     C                     MOVE *BLANKS   PSTDA
     C                     MOVE *BLANKS   VALDA
     C*
     C**  OUTPUT DEBIT RATE CHANGE TO
     C*
     C*   CHANGE NARRAT. 'RATE CHANGE TO' TO 'OPENING RATE'               040447
     C                     MOVE 'Y'       OPN     1                       040447
     C                     EXSR RDRSR
     C                     MOVE ' '       OPN     1                       040447
     C*
      ** If CRE001 is switched ON                                         CRE001
      *                                                                   CRE001
     C           CRE001    IFEQ 'Y'                                       CRE001
      *                                                                   CRE001
      **    Output Overdraft Limit                                        CRE001
     C                     EXSR CLMSG                                     CRE001
     C**********           MOVELNAR,28    ONARR                    CRE001 125176
     C                     MOVELNAR,38    ONARR                           125176
     C                     MOVE ODRL      OODRL                           CRE001
     C                     EXSR OVERDC                                    CRE001
     C                     WRITEODLNDC                                    CRE001
     C/COPY WNCPYSRC,RE3762C123
      *                                                                   CRE001
      **    Output Additional Overdraft Rate                              CRE001
     C                     EXSR CLMSG                                     CRE001
     C**********           MOVELNAR,27    ONARR                    CRE001 125176
     C                     MOVELNAR,37    ONARR                           125176
     C                     MOVE AODR      OAODR                           CRE001
     C                     EXSR OVERDC                                    CRE001
     C                     WRITEAODRDC                                    CRE001
     C/COPY WNCPYSRC,RE3762C124
      *                                                                   CRE001
     C                     ENDIF                                          CRE001
     C*
     C**  OPENING RATE CREDIT OUPUT
     C*
     C*
     C**  ACCESS REHRCJ (REHPOSR1 REHPOSR2 REHPOSR3) WHICH CONTAINS
     C**  THE GOOD DATES FOR CREDIT RATE CHANGE TO
     C*
     C**********           Z-ADDWWCRCD    KDATE                           125176
     C********** KEODLF    CHAINREHRCJ               60                   125176
     C           KLIST3    SETLLREHRCJ                                    125176
     C           KLIST1    REDPEREHRCJ                   60               125176
     C*
     C           *IN60     IFEQ '1'                                       125176
     C           BDATE     ANDEQCLCID                                     125176
     C           KLIST3    SETLLREHRCJ                                    125176
     C           KLIST3    READEREHRCJ                   60               125176
     C                     END                                            125176
     C           *IN60     IFEQ '1'                        - B1
     C                     Z-ADD*ZEROS    CRIR
     C                     Z-ADD*ZEROS    INTP                            125176
     C                     Z-ADD*ZEROS    INST                            125176
     C                     Z-ADD*ZEROS    INRT                            125176
     C                     END                             - E1
     C*
     C                     EXSR CLMSG
     C                     MOVELNAR,8     RNARR
     C*
     C                     MOVE *BLANKS   PSTDA
     C                     MOVE *BLANKS   VALDA
     C*
     C**  OUTPUT CREDIT RATE CHANGE TO
     C*
     C*   CHANGE NARRAT. 'RATE CHANGE TO' TO 'OPENING RATE'               040447
     C                     MOVE 'Y'       OPN     1                       040447
     C                     EXSR RCRSR
     C                     MOVE ' '       OPN     1                       040447
     C*
     C           KLIST2    SETLLREHPOPL
     C           KLIST1    READEREHPOPL                  50
     C*
     C                     ENDSR                           **B1EQ   ENDSR*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** B1GT subroutine for begin when debit greater than credit
     C**
     C**     Called by       B O T H S R
     C**
     C**     Calls           DBSR, POSTSR, OPENCR, OPENDR
     C**
     C           B1GT      BEGSR                           **B1GT   BEGSR*
     C*
     C           KLIST3    SETLLREHPOPH
     C*
     C           KLIST1    READEREHPOPH                  50
     C*
     C           *IN50     DOWEQ'0'                        - B1
     C********** PSTD      ANDLTCHISD                                     160301
     C           PSTD      ANDLECHISD                                     160301
     C*
     C****BACK*VALUE*PROCESSING*FOR*DEBIT AND CREDIT                      160301
      * Report backvalued postings/rate changes before CR start date      160301
     C*
     C           HISD      IFLT CLCID
     C           PSTD      ANDGTCLCID                                     160301
     C           HISD      ORLT CLCID                                     160301
     C           PSTD      ANDEQCLCID                                     160301
     C           LDAC      ANDEQ'N'                                       160301
     C*
      * NB. REHPOPH now includes rate changes as well (REHPOSR1)          125176
      * Report backvalued posting                                         125176
     C           RECI      IFEQ 'P'                                       125176
     C                     MOVE 'Y'       @CHGF                           160301
     C                     EXSR POSTSR
     C                     ELSE                                           125176
      *                                                                   125176
      * Report backvalued rate change                                     125176
     C           DRCR      IFEQ 1                                         125176
     C                     Z-ADDHISD      DCRCD                           125176
     C                     EXSR RATEC                                     125176
     C                     ELSE                                           125176
     C                     Z-ADDHISD      DDRCD                           125176
     C                     EXSR RATED                                     125176
     C                     END                                            125176
     C                     END                                            125176
     C*
     C                     END
     C*
     C           KLIST1    READEREHPOPH                  50
     C*
     C                     END                             - E1
      *                                                                   160301
      * If a management cap. check for generated adjustments              160301
     C           *IN70     IFEQ '1'                        - B1
     C           KLIST1    SETLLREHISSL                  20
     C*
      * Report adjustments before CR start date                           160301
     C           *IN20     IFEQ '1'                        - B2
     C           KLIST1    READEREADJF                   20
     C           *IN20     DOWEQ'0'                        - B3
     C           AHISD     ANDLTCLCID                                     160301
     C*
     C** PRINT INTEREST OF THE BACK VALUE DATE
     C*
     C********** PPSTD     IFNE RUND                               125176 160301
     C**********           Z-ADDRUND      ZDAYNO                   125176 160301
     C**********           EXSR ZDATE2                             125176 160301
     C**********           MOVE ZADATE    PSTDO                    125176 160301
     C**********           Z-ADDRUND      PPSTD                    125176 160301
     C**********           END                                     125176 160301
     C**********           MOVE PSTDO     PSTDA                    125176 160301
      *                                                                   125176
     C**********           MOVELNAR,23    NARR                            160301
     C**********           Z-ADDAHISB     HISB0                           125176
     C*
     C**********           Z-ADDADAIC     INTD0                           160301
     C**********           Z-ADDACAIC     INTC0                           160301
     C*
     C           ASDCI     IFEQ 'Y'                                       160301
     C           ADAIC     ANDNE*ZEROS                                    160301
     C           ASCCI     OREQ 'Y'                                       160301
     C           ACAIC     ANDNE*ZEROS                                    160301
     C                     EXSR GADJSR                                    160301
     C                     EXSR OVERDC
     C                     WRITEMADJDC
     C/COPY WNCPYSRC,RE3762C125
     C                     END                                            160301
     C*
     C           KLIST1    READEREADJF                   20
     C                     END                             - E3
     C*
     C                     ELSE                                           160301
     C                     MOVE '1'       *IN20                           160301
     C                     END                             - E2
     C                     END                             - E1
     C*
     C**  OPENING BALANCE AND OPENING RATE FOR CREDIT
     C*
     C                     EXSR OPENCR
      *                                                                   160301
     C           KLIST2    SETLLREHPOPH                                   160301
     C           KLIST1    READEREHPOPH                  50               160301
     C*
     C           *IN50     DOWEQ'0'                        - B1
     C********** PSTD      ANDLTCHISD                                     160301
     C           PSTD      ANDLECHISD                                     160301
     C*
     C****BACK*VALUE*PROCESSING*FOR*DEBIT*AND POSTING FOR CREDIT          160301
      * Report backvalued entries between CR & DR start date              160301
     C*
     C           HISD      IFLT CLDID
     C           HISD      ANDGECLCID                                     160301
     C           PSTD      ANDGTCLDID                                     160301
     C           HISD      ORLT CLDID                                     160301
     C           HISD      ANDGECLCID                                     160301
     C           PSTD      ANDEQCLDID                                     160301
     C           LDAC      ANDEQ'N'                                       160301
     C*
      * Report backvalued posting                                         125176
     C           RECI      IFEQ 'P'                                       125176
     C                     EXSR POSTSR
     C                     ELSE                                           125176
      *                                                                   125176
      * Report backvalued rate change                                     125176
     C           DRCR      IFEQ 1                                         125176
     C                     Z-ADDHISD      DCRCD                           125176
     C                     EXSR RATEC                                     125176
     C                     ELSE                                           125176
     C                     Z-ADDHISD      DDRCD                           125176
     C                     EXSR RATED                                     125176
     C                     END                                            125176
     C                     END                                            125176
     C*
     C                     END
     C*
     C           KLIST1    READEREHPOPH                  50
     C*
     C                     END                             - E1
      *                                                                   160301
      * If management cap. report generated adjs. before DR start date    160301
     C           *IN70     IFEQ '1'                        - B1
     C********** KLIST1    SETLLREHISSL                  20               160301
     C*
     C********** *IN20     IFEQ '1'                        - B2           160301
     C********** KLIST1    READEREADJF                   20               160301
     C           *IN20     DOWEQ'0'                        - B3
     C           AHISD     ANDLTCLDID                                     160301
     C*
     C** PRINT INTEREST OF THE BACK VALUE DATE
     C*
     C********** PPSTD     IFNE RUND                               125176 160301
     C**********           Z-ADDRUND      ZDAYNO                   125176 160301
     C**********           EXSR ZDATE2                             125176 160301
     C**********           MOVE ZADATE    PSTDO                    125176 160301
     C**********           Z-ADDRUND      PPSTD                    125176 160301
     C**********           END                                     125176 160301
     C**********           MOVE PSTDO     PSTDA                    125176 160301
      *                                                                   125176
     C**********           MOVELNAR,23    NARR                            160301
     C**********           Z-ADDAHISB     HISB0                           125176
     C*
     C**********           Z-ADDADAIC     INTD0                           160301
     C**********           Z-ADDACAIC     INTC0                           160301
     C*
     C           ASDCI     IFEQ 'Y'                                       160301
     C           ADAIC     ANDNE*ZEROS                                    160301
     C           ASCCI     OREQ 'Y'                                       160301
     C           ACAIC     ANDNE*ZEROS                                    160301
     C                     EXSR GADJSR                                    160301
     C                     EXSR OVERDC
     C                     WRITEMADJDC
     C/COPY WNCPYSRC,RE3762C126
     C                     END                                            160301
     C*
     C           KLIST1    READEREADJF                   20
     C                     END                             - E3
     C*
     C**********           END                             - E2           160301
     C                     END                             - E1
     C*
     C**  OPENING BALANCE AND OPENING RATE FOR DEBIT
     C*
     C                     EXSR OPENDR
      *                                                                   160301
      * Suppress reporting of DR interest until DR start date reached     160301
     C                     MOVE '0'       *IN01                           160301
     C*
     C           KLIST3    SETLLREHPOPL
     C           KLIST1    READEREHPOPL                  50
     C*
     C                     ENDSR                           **B1GT   ENDSR*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** B1LT subroutine for begin when debit lower than credit
     C**
     C**     Called by       B O T H S R
     C**
     C**     Calls           DBSR, POSTSR, OPENCR, OPENDR
     C**
     C           B1LT      BEGSR                           **B1LT   BEGSR*
     C*
     C           KLIST2    SETLLREHPOPH
     C*
     C           KLIST1    READEREHPOPH                  50
     C*
     C           *IN50     DOWEQ'0'                        - B1
     C********** PSTD      ANDLTCHISD                                     160301
     C           PSTD      ANDLECHISD                                     160301
     C*
     C****BACK*VALUE*PROCESSING*FOR*DEBIT*AND*CREDIT                      160301
      * Report backvalued postings/rate changes before DR start date      160301
     C*
     C           HISD      IFLT CLDID
     C           PSTD      ANDGTCLDID                                     160301
     C           HISD      ORLT CLDID                                     160301
     C           PSTD      ANDEQCLDID                                     160301
     C           LDAC      ANDEQ'N'                                       160301
     C*
      * NB. REHPOPH now includes rate changes as well (REHPOSR1)          125176
      * Report backvalued posting                                         125176
     C           RECI      IFEQ 'P'                                       125176
      *                                                                   160301
      * Output posting to charges report if posted after last CR cap.     160301
     C           PSTD      IFGT CLCID                                     160301
     C           PSTD      OREQ CLCID                                     160301
     C           LDAC      ANDEQ'N'                                       160301
     C                     MOVE 'Y'       @CHGF                           160301
     C                     END                                            160301
      *                                                                   160301
     C                     EXSR POSTSR
     C                     ELSE                                           125176
      *                                                                   125176
      * Report backvalued rate change                                     125176
     C           DRCR      IFEQ 1                                         125176
     C                     Z-ADDHISD      DCRCD                           125176
     C                     EXSR RATEC                                     125176
     C                     ELSE                                           125176
     C                     Z-ADDHISD      DDRCD                           125176
     C                     EXSR RATED                                     125176
     C                     END                                            125176
     C                     END                                            125176
     C*
     C                     END
     C*
     C           KLIST1    READEREHPOPH                  50
     C*
     C                     END                             - E1
      *                                                                   160301
      * If a management cap. check for generated adjustments              160301
     C           *IN70     IFEQ '1'                        - B1
     C           KLIST1    SETLLREHISSL                  20
     C*
      * Report adjustments before DR start date                           160301
     C           *IN20     IFEQ '1'                        - B2
     C           KLIST1    READEREADJF                   20
     C           *IN20     DOWEQ'0'                        - B3
     C           AHISD     ANDLTCLDID                                     160301
     C*
     C** PRINT INTEREST OF THE BACK VALUE DATE
     C*
     C********** PPSTD     IFNE RUND                               125176 160301
     C**********           Z-ADDRUND      ZDAYNO                   125176 160301
     C**********           EXSR ZDATE2                             125176 160301
     C**********           MOVE ZADATE    PSTDO                    125176 160301
     C**********           Z-ADDRUND      PPSTD                    125176 160301
     C**********           END                                     125176 160301
     C**********           MOVE PSTDO     PSTDA                    125176 160301
      *                                                                   125176
     C**********           MOVELNAR,23    NARR                            160301
     C**********           Z-ADDAHISB     HISB0                           125176
     C*
     C**********           Z-ADDADAIC     INTD0                           160301
     C**********           Z-ADDACAIC     INTC0                           160301
     C*
     C           ASDCI     IFEQ 'Y'                                       160301
     C           ADAIC     ANDNE*ZEROS                                    160301
     C           ASCCI     OREQ 'Y'                                       160301
     C           ACAIC     ANDNE*ZEROS                                    160301
     C                     EXSR GADJSR                                    160301
     C                     EXSR OVERDC
     C                     WRITEMADJDC
     C/COPY WNCPYSRC,RE3762C127
     C                     END                                            160301
     C*
     C           KLIST1    READEREADJF                   20
     C                     END                             - E3
     C*
     C                     ELSE                                           160301
     C                     MOVE '1'       *IN20                           160301
     C                     END                             - E2
     C                     END                             - E1
     C*
     C**  OPENING BALANCE AND OPENING RATE FOR DEBIT
     C*
     C                     EXSR OPENDR
      *                                                                   160301
     C           KLIST3    SETLLREHPOPH                                   160301
     C           KLIST1    READEREHPOPH                  50               160301
     C*
     C           *IN50     DOWEQ'0'                        - B1
     C********** PSTD      ANDLTCHISD                                     160301
     C           PSTD      ANDLECHISD                                     160301
     C*
     C****BACK*VALUE*PROCESSING*FOR*CREDIT*AND POSTING FOR DEBIT          160301
      * Report backvalued entries between DR & CR start date              160301
     C*
     C           HISD      IFLT CLCID
     C           HISD      ANDGECLDID                                     160301
     C           PSTD      ANDGTCLCID                                     160301
     C           HISD      ORLT CLCID                                     160301
     C           HISD      ANDGECLDID                                     160301
     C           PSTD      ANDEQCLCID                                     160301
     C           LDAC      ANDEQ'N'                                       160301
     C*
      * Report backvalued posting                                         125176
     C           RECI      IFEQ 'P'                                       125176
     C                     MOVE 'Y'       @CHGF                           160301
     C                     EXSR POSTSR
     C                     ELSE                                           125176
      *                                                                   125176
      * Report backvalued rate change                                     125176
     C           DRCR      IFEQ 1                                         125176
     C                     Z-ADDHISD      DCRCD                           125176
     C                     EXSR RATEC                                     125176
     C                     ELSE                                           125176
     C                     Z-ADDHISD      DDRCD                           125176
     C                     EXSR RATED                                     125176
     C                     END                                            125176
     C                     END                                            125176
     C*
     C                     END
     C*
     C           KLIST1    READEREHPOPH                  50
     C*
     C                     END                             - E1
      *                                                                   160301
      * If management cap. report generated adjs. before CR start date    160301
     C           *IN70     IFEQ '1'                        - B1
     C********** KLIST1    SETLLREHISSL                  20               160301
     C*
     C********** *IN20     IFEQ '1'                        - B2           160301
     C********** KLIST1    READEREADJF                   20               160301
     C           *IN20     DOWEQ'0'                        - B3
     C           AHISD     ANDLTCLCID                                     160301
     C*
     C** PRINT INTEREST OF THE BACK VALUE DATE
     C*
     C********** PPSTD     IFNE RUND                               125176 160301
     C**********           Z-ADDRUND      ZDAYNO                   125176 160301
     C**********           EXSR ZDATE2                             125176 160301
     C**********           MOVE ZADATE    PSTDO                    125176 160301
     C**********           Z-ADDRUND      PPSTD                    125176 160301
     C**********           END                                     125176 160301
     C**********           MOVE PSTDO     PSTDA                    125176 160301
      *                                                                   125176
     C**********           MOVELNAR,23    NARR                            160301
     C**********           Z-ADDAHISB     HISB0                           125176
     C*
     C**********           Z-ADDADAIC     INTD0                           160301
     C**********           Z-ADDACAIC     INTC0                           160301
     C*
     C           ASDCI     IFEQ 'Y'                                       160301
     C           ADAIC     ANDNE*ZEROS                                    160301
     C           ASCCI     OREQ 'Y'                                       160301
     C           ACAIC     ANDNE*ZEROS                                    160301
     C                     EXSR GADJSR                                    160301
     C                     EXSR OVERDC
     C                     WRITEMADJDC
     C/COPY WNCPYSRC,RE3762C128
     C                     END                                            160301
     C*
     C           KLIST1    READEREADJF                   20
     C                     END                             - E3
     C*
     C**********           END                             - E2           160301
     C                     END                             - E1
     C*
     C**  OPENING BALANCE AND OPENING RATE FOR CREDIT
     C*
     C                     EXSR OPENCR
      *                                                                   160301
      * Suppress reporting of CR interest until CR start date reached     160301
     C                     MOVE '0'       *IN02                           160301
     C*
     C           KLIST2    SETLLREHPOPL
     C           KLIST1    READEREHPOPL                  50
     C*
     C                     ENDSR                           **B1LT   ENDSR*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C***
     C***   CLEAR INPUT VARIABLES OF MESSAGE
     C***
     C           CLMSG     BEGSR                           ** SR CLMSG **
     C                     MOVEL*BLANK    MSGDT0
     C                     MOVEL*BLANK    MSGDT1
     C                     MOVEL*BLANK    MSGDT2
     C                     MOVEL*BLANK    MSGDT3
     C                     MOVEL*BLANK    MSGDT4
     C                     MOVEL*BLANK    MSGDT5
     C                     MOVEL*BLANK    MSGDT6
     C                     MOVEL*BLANK    MSGDT7
     C                     MOVEL*BLANK    MSGDT8
     C                     MOVEL*BLANK    MSGDT9
     C                     MOVEL*BLANK    MNARR
     C                     ENDSR                           **CLMSG ENDSR**
     C**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** CRSR subroutine for credit output processing
     C**
     C**     Called by       DETPR
     C**
     C**     Calls           DBSR, DAYTSR, RATEC, ITYPCR, ZICD, OVERDC
     C**
     C           CRSR      BEGSR                           **CRSR BEGSR**
     C*
     C**  OUTPUT HEADER LINES
     C*
     C                     MOVE '0'       *IN65
     C           ACNO      IFNE *ZEROS
     C                     MOVE '1'       *IN65
     C                     END
     C/COPY WNCPYSRC,RE3762C012
     C                     WRITEHEADDC
     C*
     C* CHARGE REPORT IF NECESSARY
     C*
     C           CCICI     IFNE *BLANK
     C           CCHGP     ANDNE*ZERO
     C/COPY WNCPYSRC,RE3762C013
     C                     WRITEHEADCH
     C                     Z-ADDACNO      CHACNO 100
     C                     END
     C*
     C**  ACCESS REHISL WITH LAST CREDIT CAPITALISATION DATE
     C*
     C********** KLIST3    CHAINREHISL               52                   160301
     C           KLIST3    SETLLREHISL               52                   160301
     C           KLIST1    READEREHISL                   52               160301
     C*
     C           *IN52     IFEQ '1'                        - B1
     C                     Z-ADDCLCID     WDATE
     C                     Z-ADD05        DBASE
     C                     MOVE 'REHISL'  DBFILE           ***************
     C                     MOVELRKEY2     DBKEY            **DB ERROR 05**
     C                     MOVEA'1'       *IN,89           ***************
     C                     EXSR DBSR
     C                     END                             - E1
     C*
     C           *IN52     DOWEQ'0'                        - B1
     C           DRECI     ANDEQ'S'
     C***********SDICI     ANDEQ'Y'                                      098818
     C           SDICI     ANDNE*BLANKS                                  098818
     C           SCICI     ANDEQ*BLANKS
     C           DHISD     ANDLTCHISD
     C           *IN52     OREQ '0'
     C           DRECI     ANDEQ'D'
     C           DCRCI     ANDEQ*BLANKS
     C           DDMVT     ANDEQ*ZERO                                     160301
     C           DCMVT     ANDEQ*ZERO                                     160301
     C           DMACI     ANDEQ*ZERO                                     160301
     C********** DDRCI     ANDEQ'Y'                                       160301
     C           DRECI     OREQ 'M'                                       182452
     C*
     C           KLIST1    READEREHISL                   52
     C*
     C                     END                             - E1
     C*
     C**  PREPARE B/F BALANCE
     C*
     C           DRECI     IFEQ 'B'                        - B1
     C                     Z-ADD*ZEROS    HISB0
     C                     Z-ADDDHISD     BDATE                           125176
     C                     ELSE                            - X1
     C           DRECI     IFEQ 'S'                        - B2
     C                     Z-ADDSSTBL     HISB0
     C                     ELSE                            - X2
     C                     Z-ADDCLCID     WDATE
     C                     Z-ADD06        DBASE
     C                     MOVE 'REHISL'  DBFILE           ***************
     C                     MOVELRKEY2     DBKEY            **DB ERROR 06**
     C                     MOVEA'1'       *IN,89           ***************
     C                     EXSR DBSR
     C                     END                             - E2
     C                     END                             - E1
     C*
     C                     Z-ADDDHISB     COHISB
     C                     MOVE *BLANKS   VALDA
     C*
     C                     EXSR CLMSG
     C                     MOVELNAR,1     TNARR
     C*
     C**  OUTPUT B/F BALANCE
     C*
     C                     EXSR OVERDC
     C                     WRITETITLEDC
     C/COPY WNCPYSRC,RE3762C129
     C*
     C           KLIST3    SETLLREHPOPH
     C*
     C           KLIST1    READEREHPOPH                  50
     C*
     C**  BACK VALUE PROCESSING START
     C*
     C           *IN50     DOWEQ'0'                        - B1
     C********** PSTD      ANDLTCHISD                                     160301
     C           PSTD      ANDLECHISD                                     160301
     C*
     C****TRANSFER*DATE*MIDAS*INTO*DDMMMYY                                160301
     C*
      * If last day accruals a backvalued item posted on cap. value       160301
      * date is already reflected in that capitalisation.                 160301
      * If first day accruals a backvalued item posted on cap. value      160301
      * date is not reflected in that capitalisation as the cap. value    160301
      * date is cap. date + 1.                                            160301
     C           HISD      IFLT CLCID
     C           PSTD      ANDGTCLCID                                     160301
     C           HISD      ORLT CLCID                                     160301
     C           PSTD      ANDEQCLCID                                     160301
     C           LDAC      ANDEQ'N'                                       160301
     C*
      * Convert MIDAS date into DDMMMYY                                   160301
     C           PPSTD     IFNE PSTD                       - B2
     C                     Z-ADDPSTD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    PSTDO
     C*
     C                     Z-ADDPSTD      PPSTD
     C                     END                             - E2
     C*
     C                     MOVE PSTDO     PSTDA
     C*
     C**  TRANSFER DATE MIDAS INTO DDMMMYY
     C*
     C           PVALD     IFNE HISD                       - B2
     C                     Z-ADDHISD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALDO
     C*
     C                     Z-ADDHISD      PVALD
     C                     END                             - E2
     C*
     C                     MOVELPNAR      NARR
     C                     MOVE VALDO     VALDA
      *                                                                   125176
      * NB. REHPOPH now includes rate changes as well (REHPOSR1)          125176
      * Report backvalued posting                                         125176
     C           RECI      IFEQ 'P'                                       125176
     C*
     C**  CHECK IF DEBIT OR CREDIT
     C*
     C           DRCR      IFEQ 0                          - B2
     C           TURN      IFNE 'Y'
     C                     MOVE '1'       *IN33
     C                     END
     C                     Z-ADDPSTA      PSTD0
     C                     ELSE                            - X2
     C                     Z-SUBPSTA      PSTD0
     C                     END                             - E2
     C*
     C**  OUTPUT BACK VALUE
     C*
     C                     EXSR OVERDC
     C                     WRITEPOSTDC
     C/COPY WNCPYSRC,RE3762C035
     C*
     C                     MOVE '0'       *IN33
     C*
     C**********           END                                            125176
     C*
     C* CHARGE REPORT IF NECESSARY
     C*
     C           CCICI     IFNE *BLANK
     C           CHGT      ANDNE*ZERO                                     160301
     C           CHGA      ANDNE*ZERO
     C           CCHGP     ANDNE*ZERO
     C           REBI      IFEQ 'Y'
     C***********          MOVELMSG,1     CHREBI 10                       114487
     C***********          ELSE                                           114487
     C***********          MOVELMSG,2     CHREBI                          114487
     C***********          END                                            114487
     C                     Z-ADDCHGA      CHGR0                           125176
     C                     Z-ADD*ZERO     CHGN0                           114487
     C                     ADD  CHGA      TCHR0                           160301
     C                     ELSE                                           114487
     C                     Z-ADDCHGA      CHGN0                           114487
     C                     Z-ADD*ZERO     CHGR0                           114487
     C                     ADD  CHGA      TCHN0                           160301
     C                     END                                            114487
     C**********           Z-ADDCHGA      CHGR0                           125176
     C           NITMS     IFEQ *ZEROS
     C                     Z-ADD1         SNITMS
     C                     ELSE
     C                     Z-ADDNITMS     SNITMS
     C                     END
     C                     EXSR OVERDC                                    160301
     C                     WRITEPOSTCH
     C/COPY WNCPYSRC,RE3762C130
     C                     END
      *                                                                   125176
      * Report backvalued rate change                                     125176
     C                     ELSE                                           125176
     C           DRCR      IFEQ 1                                         125176
     C                     Z-ADDHISD      DCRCD                           125176
     C                     EXSR RATEC                                     125176
     C                     END                                            125176
     C                     END                                            125176
      *                                                                   125176
     C                     END                                            125176
     C*
     C           KLIST1    READEREHPOPH                  50
     C*
     C                     END                             - E1
      *                                                                   160301
      * Generated adjs. going to the a/c before start date should be      160301
      * reported for both management and 'proper' CR only cap. as they    160301
      * are reflected in the opening balance, and even if it is a real    160301
      * cap. DR adjs. are not posted at a CR only cap.                    160301
     C           KLIST1    SETLLREHISSL                  20               160301
     C           *IN20     IFEQ '1'                                       160301
     C           KLIST1    READEREHISSL                  20               160301
      *                                                                   160301
     C           *IN20     DOWEQ'0'                                       160301
     C           AHISD     ANDLTCLCID                                     160301
      *                                                                   160301
     C           ASDCI     IFEQ 'Y'                                       160301
     C           ADAIC     ANDNE*ZEROS                                    160301
     C           ASCCI     OREQ 'Y'                                       160301
     C           ACAIC     ANDNE*ZEROS                                    160301
     C                     EXSR GADJSR                                    160301
      *                                                                   160301
      * Report DR gen. adjustment as an entry                             160301
     C           INTD0     IFNE *ZEROS                                    160301
     C                     Z-ADDINTD0     PSTD0                           160301
     C                     EXSR OVERDC                                    160301
     C                     WRITEPOSTDC                                    160301
     C/COPY WNCPYSRC,RE3762C036
     C                     END                                            160301
      *                                                                   160301
      * Report CR gen. adj. (management cap.) in the CR interest column   160301
     C           INTC0     IFNE *ZEROS                                    160301
     C                     EXSR OVERDC                                    160301
     C                     WRITEMADJDC                                    160301
     C/COPY WNCPYSRC,RE3762C131
     C                     END                                            160301
      *                                                                   160301
     C                     END                                            160301
      *                                                                   160301
     C           KLIST1    READEREADJF                   20               160301
     C                     ENDDO                                          160301
      *                                                                   160301
     C                     ELSE                                           160301
     C                     MOVE '1'       *IN20                           160301
     C                     END                                            160301
     C*
     C**  BACK VALUE PROCESSING END
     C*
     C           KLIST3    SETLLREHPOPL
     C           KLIST1    READEREHPOPL                  50
     C*
     C**  PREPARE OPENING BALANCE OUTPUT
     C*
     C           DRECI     IFEQ 'B'                        - B1
     C                     Z-ADDDHISB     WHISB
     C                     ELSE                            - X1
     C           DRECI     IFEQ 'S'                        - B2
     C                     Z-ADDSSTBL     WHISB
     C                     END                             - E2
     C                     END                             - E1
     C                     Z-ADDCOHISB    HISB0
     C*
     C                     EXSR CLMSG
     C                     MOVELNAR,2     TNARR
     C*
     C**  SAVE IN CASE OF NO POSTING
     C*
     C                     Z-ADDCLCID     WHISD
     C*
     C**  TRANSFER DATE MIDAS INTO DDMMMYY
     C*
     C           CLCID     IFNE PVALD                      - B1
     C*
     C                     Z-ADDCLCID     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALDO
     C*
     C                     Z-ADDCLCID     PVALD
     C*
     C                     END                             - E1
     C*
     C                     MOVE VALDO     VALDA
     C*
     C**  OUTPUT OPENING BALANCE
     C*
     C                     EXSR OVERDC
     C                     WRITETITLEDC
     C/COPY WNCPYSRC,RE3762C132
     C*
     C**  PREPARE OPENING RATE OUTPUT
     C*
      * Access REHRCJ (REHPOSR1 REHPOSR2 REHPOSR3) for CR opening rate    125176
     C           KLIST3    SETLLREHRCJ                                    125176
     C           KLIST1    REDPEREHRCJ                   60               125176
      *                                                                   125176
     C           *IN60     IFEQ '1'                                       125176
     C           BDATE     ANDEQCLCID                                     125176
     C           KLIST3    SETLLREHRCJ                                    125176
     C           KLIST3    READEREHRCJ                   60               125176
     C                     END                                            125176
      *                                                                   125176
     C           *IN60     IFEQ '1'                                       125176
     C                     Z-ADD*ZEROS    CRIR                            125176
     C                     Z-ADD*ZEROS    INTP                            125176
     C                     Z-ADD*ZEROS    INST                            125176
     C                     Z-ADD*ZEROS    INRT                            125176
     C                     END                                            125176
      *                                                                   125176
     C                     MOVE *BLANKS   VALDA
     C                     MOVE *BLANKS   PSTDA
     C*
     C                     EXSR CLMSG
     C                     MOVELNAR,8     RNARR
     C*
     C**  OUTPUT OPENING RATE
     C*
     C**********           Z-ADDCRIR      RATE                            125176
     C**********           EXSR OVERDC                                    125176
     C**********           WRITERATEDC                                    125176
      * Change narrative 'rate change to' to 'opening rate'               125176
     C                     MOVE 'Y'       OPN                             125176
     C                     EXSR RCRSR                                     125176
     C                     MOVE ' '       OPN                             125176
      *                                                                   125176
      * If CRE001 is switched ON, then output 'Overdraft Limit'           160301
     C           CRE001    IFEQ 'Y'                                       160301
     C                     EXSR CLMSG                                     160301
     C                     MOVELNAR,38    ONARR                           160301
     C                     MOVE ODRL      OODRL                           160301
     C                     EXSR OVERDC                                    160301
     C                     WRITEODLNDC                                    160301
     C/COPY WNCPYSRC,RE3762C133
     C                     ENDIF                                          160301
      *                                                                   160301
      * Report generated adjustment on start date.                        160301
     C           *IN20     IFEQ '0'                                       160301
     C           AHISD     ANDEQCLCID                                     160301
     C           ASDCI     IFEQ 'Y'                                       160301
     C           ADAIC     ANDNE*ZEROS                                    160301
     C           ASCCI     OREQ 'Y'                                       160301
     C           ACAIC     ANDNE*ZEROS                                    160301
     C                     EXSR GADJSR                                    160301
     C                     MOVE 'Y'       @ADJF                           160301
      *                                                                   160301
      * Report DR adj. as an entry                                        160301
     C           INTD0     IFNE *ZEROS                                    160301
     C                     Z-ADDINTD0     PSTD0                           160301
     C                     EXSR OVERDC                                    160301
     C                     WRITEPOSTDC                                    160301
     C/COPY WNCPYSRC,RE3762C037
     C                     END                                            160301
      *                                                                   160301
      * Report CR adj. (management cap.) in CR interest column.           160301
     C           INTC0     IFNE *ZEROS                                    160301
     C                     EXSR OVERDC                                    160301
     C                     WRITEMADJDC                                    160301
     C/COPY WNCPYSRC,RE3762C134
     C                     END                                            160301
     C                     END                                            160301
     C                     END                                            160301
     C*
     C           DRECI     IFEQ 'S'                        - B1
     C                     Z-ADDDHISD     WHISD
     C                     Z-ADDDHISB     WHISB
     C                     Z-ADDSMNBL     WMNBL
     C**********           Z-ADDDDRCB     WDRCB                           160301
     C**********           Z-ADDDCRCB     WCRCB                           160301
     C                     Z-ADDSDRCB     WDRCB                           160301
     C                     Z-ADDSCRCB     WCRCB                           160301
     C           KLIST1    READEREHISL                   51
     C*
      * Bypass (DR) cap. recs and position recs. with no movement or      160301
      * CR rate change or CR manual adj. or balance change.               160301
     C           *IN51     DOWEQ'0'                        - B2
     C           DRECI     ANDEQ'S'
     C           DHISD     ANDLTCHISD                                     160301
     C           *IN51     OREQ '0'                                       160301
     C           DRECI     ANDEQ'D'                                       160301
     C           DCRCI     ANDEQ*BLANKS                                   160301
     C           DDMVT     ANDEQ0                                         160301
     C           DCMVT     ANDEQ0                                         160301
     C           DMACI     ANDEQ0                                         160301
     C           @ADJF     ANDEQ*BLANKS                                   160301
      *                                                                   160301
      * Check for generated adjustment after start date (must be DR).     160301
     C           *IN51     IFEQ '0'                                       160301
     C           DRECI     ANDEQ'S'                                       160301
     C           DHISD     ANDLTCHISD                                     160301
     C           SDAIC     ANDNE*ZEROS                                    160301
     C           SDCI      ANDEQ'Y'                                       160301
     C                     Z-ADDSDAIC     @GADJ                           160301
     C                     MOVE 'Y'       @ADJF                           160301
     C                     END                                            160301
      *                                                                   160301
     C           KLIST1    READEREHISL                   51
     C                     END                             - E2
     C*
     C           *IN51     IFEQ '0'                        - B2
     C           WHISD     ANDNEDHISD
     C           DHISD     ANDLTCHISD                                     160301
     C*
     C********** CCICT     IFLT 3                          - B3           182452
     C           DCICT     IFLT 3                          - B3           182452
     C                     Z-ADDWCRCB     ZICALC
     C                     Z-ADDWHISD     ZIBEG
     C                     Z-ADDDHISD     ZIEND
     C                     EXSR DAYTSR
     C                     ELSE                            - X3
     C                     EXSR ITYPCR
     C                     END                             - E3
     C*
     C                     END                             - E2
     C*
     C                     END                             - E1
     C*
     C           *IN51     DOWEQ'0'                        - B1
     C           DHISD     ANDLTCHISD
      *                                                                   160301
      * Report generated adjustment after start date if found             160301
     C           @ADJF     IFEQ 'Y'                                       160301
     C                     EXSR #ADJ                                      160301
     C           DHISD     IFGT CLCID                                     160301
     C                     EXSR OVERDC                                    160301
     C                     WRITEPOSTDC                                    160301
     C/COPY WNCPYSRC,RE3762C038
     C                     END                                            160301
     C                     END                                            160301
     C*
     C**  PROCESS POSTING AT THE SAME DATE
     C*
     C           *IN50     DOWEQ'0'                        - B2
     C           DHISD     ANDEQHISD
     C*
     C**  TRANSFER DATE MIDAS INTO DDMMMYY
     C*
     C           PPSTD     IFNE PSTD                       - B3
     C                     Z-ADDPSTD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    PSTDO
     C*
     C                     END                             - E3
     C*
     C**  TRANSFER DATE MIDAS INTO DDMMMYY
     C*
     C           PVALD     IFNE HISD                       - B3
     C                     Z-ADDHISD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALDO
     C*
     C                     END                             - E3
     C*
     C                     MOVE VALDO     VALDA
     C                     MOVE PSTDO     PSTDA
     C                     MOVELPNAR      NARR
     C*
     C**  CHECK IF DEBIT OR CREDIT
     C*
     C           DRCR      IFEQ 0                          - B3
     C           TURN      IFNE 'Y'
     C                     MOVE '1'       *IN33
     C                     END
     C                     Z-ADDPSTA      PSTD0
     C                     ELSE                            - X3
     C                     Z-SUBPSTA      PSTD0
     C                     END                             - E3
     C*
     C**  OUTPUT POSTING
     C*
     C                     EXSR OVERDC
     C                     WRITEPOSTDC
     C/COPY WNCPYSRC,RE3762C135
     C*
     C                     MOVE '0'       *IN33
     C*
     C* CHARGE REPORT IF NECESSARY
     C*
     C           CCICI     IFNE *BLANK
     C           CHGT      ANDNE*ZERO                                     160301
     C           CHGA      ANDNE*ZERO
     C           CCHGP     ANDNE*ZERO
     C           REBI      IFEQ 'Y'
     C***********          MOVELMSG,1     CHREBI                          114487
     C***********          ELSE                                           114487
     C***********          MOVELMSG,2     CHREBI                          114487
     C***********          END                                            114487
     C                     Z-ADDCHGA      CHGR0                           125176
     C                     Z-ADD*ZERO     CHGN0                           114487
     C                     ADD  CHGA      TCHR0                           160301
     C                     ELSE                                           114487
     C                     Z-ADDCHGA      CHGN0                           114487
     C                     Z-ADD*ZERO     CHGR0                           114487
     C                     ADD  CHGA      TCHN0                           160301
     C                     END                                            114487
     C**********           Z-ADDCHGA      CHGR0                           125176
     C           NITMS     IFEQ *ZEROS
     C                     Z-ADD1         SNITMS
     C                     ELSE
     C                     Z-ADDNITMS     SNITMS
     C                     END
     C                     EXSR OVERDC                                    160301
     C                     WRITEPOSTCH
     C/COPY WNCPYSRC,RE3762C136
     C                     END
     C*
     C                     Z-ADDPSTD      PPSTD
     C                     Z-ADDHISD      PVALD
     C*
     C           KLIST1    READEREHPOPL                  50
     C*
     C                     END                             - E2
      *                                                                   160301
      * Report manual adjustment                                          160301
     C           DMACI     IFNE 0                                         160301
     C                     EXSR MADJSR                                    160301
     C                     END                                            160301
     C*
     C**  CREDIT RATE CHANGE TO
     C*
     C           DCRCI     IFEQ 'Y'                        - B2
     C           DRECI     ANDNE'B'
     C           DRECI     ANDNE'M'                                       182452
     C*
     C                     EXSR RATEC
     C*
     C                     END                             - E2
     C*
     C**  SAVE REHISL  AS PREVIOUS
     C*
     C                     Z-ADDDHISD     WHISD
     C                     Z-ADDDHISB     WHISB
     C                     MOVE DDRCB     WDRCB
     C                     Z-ADDDCRCB     WCRCB
     C                     Z-ADDDCAID     WCAID
     C                     Z-ADDDDAID     WDAID
     C*
     C           KLIST1    READEREHISL                   51
     C*
      * Bypass (DR) cap. recs and position recs. with no movement or      160301
      * CR rate change or CR manual adj. or balance change.               160301
     C           *IN51     DOWEQ'0'                        - B2
     C           DRECI     ANDEQ'S'
     C***********SDICI     ANDEQ'Y'                                      098818
     C********** SDICI     ANDNE*BLANKS                            098818 160301
     C********** SCICI     ANDEQ*BLANKS                                   160301
     C           DHISD     ANDLTCHISD
     C           *IN51     OREQ '0'
     C           DRECI     ANDEQ'D'
     C           DCRCI     ANDEQ*BLANKS
     C********** DDRCI     ANDEQ'Y'                                       160301
     C           DDMVT     ANDEQ*ZEROS
     C           DCMVT     ANDEQ*ZEROS
     C           DMACI     ANDEQ*ZEROS                                    160301
     C           @ADJF     ANDEQ*BLANKS                                   160301
      *                                                                   160301
      * Check for DR generated adjustment                                 160301
     C           *IN51     IFEQ '0'                                       160301
     C           DRECI     ANDEQ'S'                                       160301
     C           DHISD     ANDLTCHISD                                     160301
     C           SDAIC     ANDNE*ZEROS                                    160301
     C           SDCI      ANDEQ'Y'                                       160301
     C                     Z-ADDSDAIC     @GADJ                           160301
     C                     MOVE 'Y'       @ADJF                           160301
     C                     END                                            160301
     C*
     C           KLIST1    READEREHISL                   51
     C*
     C                     END                             - E2
     C*
     C**  OUTPUT SUBTOTAL LINE
     C*
     C           *IN51     IFEQ '0'                        - B2
     C           DHISD     ANDLTCHISD
     C*
     C********** CCICT     IFLT 3                          - B3           182452
     C           DCICT     IFLT 3                          - B3           182452
     C                     Z-ADDWCRCB     ZICALC
     C                     Z-ADDWHISD     ZIBEG
     C                     Z-ADDDHISD     ZIEND
     C                     EXSR DAYTSR
     C                     ELSE                            - X3
     C                     EXSR ITYPCR
     C                     END                             - E3
     C*
     C********** *IN51     DOWEQ'0'                        - B3           160301
     C********** DHISD     ANDLTHISD                                      160301
     C********** CHISD     ANDLTHISD                                      160301
     C*
     C*
     C****CHECK*IF READ RECORD IS A CHANGE RATE                           160301
     C*
     C********** DCRCI     IFEQ 'Y'                        - B4           160301
     C********** DRECI     ANDNE'B'                                       160301
     C*
     C**********           EXSR RATEC                                     160301
     C*
     C****SAVE*REHISL  AS PREVIOUS                                        160301
     C*
     C**********           Z-ADDDHISD     WHISD                           160301
     C**********           Z-ADDDHISB     WHISB                           160301
     C**********           MOVE DDRCB     WDRCB                           160301
     C**********           Z-ADDDCRCB     WCRCB                           160301
     C**********           Z-ADDDCAID     WCAID                           160301
     C**********           Z-ADDDDAID     WDAID                           160301
     C*
     C********** KLIST1    READEREHISL                   51               160301
     C*
     C********** *IN51     DOWEQ'0'                        - B5           160301
     C********** DRECI     ANDEQ'S'                                       160301
     C***********SDICI     ANDEQ'Y'                                      098818
     C********** SDICI     ANDNE*BLANKS                            098818 160301
     C********** SCICI     ANDEQ*BLANKS                                   160301
     C********** DHISD     ANDLTCHISD                                     160301
     C********** *IN51     OREQ '0'                                       160301
     C********** DRECI     ANDEQ'D'                                       160301
     C********** DCRCI     ANDEQ*BLANKS                                   160301
     C********** DDRCI     ANDEQ'Y'                                       160301
     C*
     C********** KLIST1    READEREHISL                   51               160301
     C*
     C**********           END                             - E5           160301
     C*
     C********** CCICT     IFLT 3                          - B5           160301
     C**********           Z-ADDWCRCB     ZICALC                          160301
     C**********           Z-ADDWHISD     ZIBEG                           160301
     C**********           Z-ADDDHISD     ZIEND                           160301
     C**********           EXSR DAYTSR                                    160301
     C**********           ELSE                            - X5           160301
     C**********           EXSR ITYPCR                                    160301
     C**********           END                             - E5           160301
     C*
     C**********           ELSE                            - X4           160301
     C*
     C********** KLIST1    READEREHISL                   51               160301
     C*
     C********** *IN51     DOWEQ'0'                        - B5           160301
     C********** DRECI     ANDEQ'S'                                       160301
     C***********SCICI     ANDEQ'Y'                                      098818
     C********** SCICI     ANDNE*BLANKS                            098818 160301
     C********** SDICI     ANDEQ*BLANKS                                   160301
     C********** DHISD     ANDLTCHISD                                     160301
     C********** *IN51     OREQ '0'                                       160301
     C********** DRECI     ANDEQ'D'                                       160301
     C********** DDRCI     ANDEQ*BLANKS                                   160301
     C********** DCRCI     ANDEQ'Y'                                       160301
     C*
     C********** KLIST1    READEREHISL                   51               160301
     C*
     C**********           END                             - E5           160301
     C*
     C**********           END                             - E4           160301
     C*
     C**********           END                             - E3           160301
     C*
     C                     END                             - E2
     C*
     C                     END                             - E1
     C*
     C********** KLIST3    SETLLREHISL                   52               160301
     C*
     C********** *IN52     IFEQ '0'                        - B1           160301
     C**********           Z-ADDCLCID     WDATE                           160301
     C**********           Z-ADD07        DBASE                           160301
     C**********           MOVE 'REHISL'  DBFILE           ***************160301
     C**********           MOVELRKEY2     DBKEY            **DB ERROR 07**160301
     C**********           MOVEA'1'       *IN,89           ***************160301
     C**********           EXSR DBSR                                      160301
     C**********           END                             - E1           160301
     C*
     C********** KLIST1    READEREHISL                   52               160301
     C*
     C********** *IN52     DOWEQ'0'                        - B1           160301
     C********** DRECI     ANDEQ'S'                                       160301
     C***********SDICI     ANDEQ'Y'                                      098818
     C********** SDICI     ANDNE*BLANKS                            098818 160301
     C********** SCICI     ANDEQ*BLANKS                                   160301
     C********** DHISD     ANDLTCHISD                                     160301
     C********** *IN52     OREQ '0'                                       160301
     C********** DRECI     ANDEQ'D'                                       160301
     C********** DCRCI     ANDEQ*BLANKS                                   160301
     C********** DDRCI     ANDEQ'Y'                                       160301
     C*
     C********** KLIST1    READEREHISL                   52               160301
     C*
     C**********           END                             - E1           160301
     C*
     C           DCICT     IFLT 3                          - B1
     C*
     C                     Z-ADDWCRCB     ZICALC
     C                     Z-ADDWHISD     ZIBEG
     C                     Z-ADDCHISD     ZIEND
     C*
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C*
     C                     Z-ADDWHISB     HISB0
     C********** *IN80     IFEQ '1'                                       125176
     C           HISB0     MULT DAYS      NUMB0
     C**********           ELSE                                           125176
     C********** *IN81     IFEQ '1'                                       125176
     C********** HISB1     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** *IN82     IFEQ '1'                                       125176
     C********** HISB2     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** HISB3     MULT DAYS      NUMB0                           125176
     C**********           END                                            125176
     C**********           END                                            125176
     C**********           END                                            125176
     C********** NUMB0     DIV  100       NUMB0     H                     125176
     C*
     C********** WHISB     IFGT *ZEROS                     - B1           160301
     C********** CDAIC     SUB  WDAID     INTD0                           160301
     C**********           Z-ADD*ZEROS    INTC0                           160301
     C**********           ELSE                            - X1           160301
     C           CCAIC     SUB  WCAID     INTC0
     C                     SUB  DTMACI    INTC0                           160301
     C                     Z-SUBINTC0     INTC0
     C**********           Z-ADD*ZEROS    INTD0                           160301
     C**********           END                             - E1           160301
     C*
     C**  OUTPUT SUBTOTAL
     C*
     C                     EXSR OVERDC
     C                     WRITESTOTDC
     C/COPY WNCPYSRC,RE3762C137
     C*
     C                     END                             - E1
     C*
     C** PREPARE C/F BALANCE
     C*
     C                     EXSR CLMSG
     C                     MOVELNAR,6     TNARR
     C*
     C**  TRANSFER DATE MIDAS INTO DDMMMYY
     C*
     C           PVALD     IFNE CHISD                      - B1
     C                     Z-ADDCHISD     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALDO
     C*
     C                     MOVE CHISD     PVALD
     C*
     C                     END                             - E1
     C*
     C                     MOVE VALDO     VALDA
     C                     Z-ADDCHISB     HISB0
     C*
     C**  OUTPUT BALANCE C/F
     C*
     C                     EXSR OVERDC
     C                     WRITETITLEDC
     C/COPY WNCPYSRC,RE3762C138
     C*
     C**  PREPARE TOTAL INTEREST OUTPUT
     C*
     C                     Z-ADDWCRCB     ZICALC
     C                     Z-ADDCLCID     ZIBEG
     C                     Z-ADDCHISD     ZIEND
     C                     EXSR ZICD
     C*
     C                     Z-ADDZDAYN1    DAYS
     C*
     C                     EXSR CLMSG
     C                     MOVELNAR,5     XNARR
     C*
     C**********           Z-ADDCCAIC     TINTC0                          160301
     C                     Z-SUBCCAIC     TINTC0                          160301
     C*
     C**  Calculate base rate tax
     C*
     C                     EXSR CALBRT
      *                                                                                       CGL031
      ** Retrieval of EU witholding tax                                                       CGL031
      *                                                                                       CGL031
     C           CGL031    IFEQ 'Y'                                                           CGL031
     C                     EXSR CALEUT                                                        CGL031
     C                     ENDIF                                                              CGL031
      *                                                                                       CGL031
     C/COPY WNCPYSRC,RE3762C021
     C*
     C**  OUTPUT TOTAL INTEREST
     C*
     C**********           Z-SUBTINTC0    TINTC0                   130468 160301
     C**********           Z-SUBTGINT0    TGINT0                   130468 160301
     C                     EXSR OVERDC
     C                     WRITETOTALDC
     C/COPY WNCPYSRC,RE3762C139
      *                                                                   130468
      * Output total CR generated adjustments                             130468
     C           CSGACI    IFNE *ZEROS                                    130468
     C                     EXSR CLMSG                                     130468
     C                     Z-SUBCSGACI    TINTC0                          130468
     C                     MOVELNAR,23    DNARR                           130468
     C                     EXSR OVERDC                                    130468
     C                     WRITETOTDDC                                    130468
     C/COPY WNCPYSRC,RE3762C140
     C                     END                                            130468
      *                                                                   130468
      * Report BRT if required                                            130468
     C           *IN22     IFEQ '1'                                       130468
     C                     EXSR OVERDC                                    130468
     C                     WRITETOTBRT                                    130468
     C                     END                                            130468
      *                                                                                       CGL031
      ** Report EUT if required                                                               CGL031
      *                                                                                       CGL031
     C           *IN21     IFEQ *ON                                                           CGL031
     C                     EXSR OVERDC                                                        CGL031
     C                     WRITEEUWTAX                                                        CGL031
      *                                                                                       CER048
      ** Print Secondary Tax Amount                                                           CER048
      *                                                                                       CER048
     C           CER048    IFEQ 'Y'                                                           CER048
      *                                                                                       CER048
     C                     EXSR OVERDC                                                        CER048
     C                     WRITESECTAX                                                        CER048
      *                                                                                       CER048
     C                     ENDIF                                                              CER048
      *                                                                                       CER048
     C                     ENDIF                                                              CGL031
      *                                                                                       CGL031
     C*
     C* CHARGE REPORT IF NECESSARY
     C*
     C           CCICI     IFNE *BLANK
     C           CCHGP     ANDNE*ZERO
     C                     Z-ADDCCHGP     CHGP0
     C                     Z-ADD0         PSTD0                           160301
     C                     MOVELNAR,22    XNARR
     C                     EXSR OVERDC                                    160301
     C                     WRITESTOTCH                                    160301
      *                                                                   160301
      * Calculate rebate                                                  160301
     C                     EXSR REBSR                                     160301
     C           REBATE    IFNE 0                                         160301
     C                     EXSR OVERDC                                    160301
     C                     WRITESREBCH                                    160301
     C                     END                                            160301
      *                                                                   160301
     C                     MOVELNAR,21    XNARR                           160301
     C                     EXSR OVERDC                                    160301
     C                     WRITETOTALCH
     C/COPY WNCPYSRC,RE3762C141
     C                     END
     C*
     C**  PREPARE TOTAL CHARGES
     C*
     C           CCHGP     IFNE *ZERO                      - B1
     C                     EXSR CLMSG
     C                     MOVELNAR,22    DNARR
     C*
     C                     Z-ADD*ZEROS    TINTD0
     C                     Z-ADDCCHGP     TINTC0
     C                     EXSR OVERDC
     C                     WRITETOTDDC
     C/COPY WNCPYSRC,RE3762C142
     C                     END                             -E1
     C*
     C**  PREPARE WITHHOLDING TAX OUTPUT
     C*
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3762CPDR                                           S01408
     C*                                                                   S01408
     C           WWCINW    IFNE *ZEROS                     - B1
     C                     EXSR CLMSG
     C                     MOVEL*BLANKS   NCACP
     C           CACP      IFNE *BLANKS                    - B2
     C                     MOVEL' BY '    NCACP
     C                     MOVE CACP      NCACP
     C                     END                             - E2
     C                     MOVELNAR,26    DNARR
     C                     MOVE NCACP     DNARR
     C*
     C                     Z-ADD*ZEROS    TINTD0
     C                     Z-ADDWWCINW    TINTC0
     C                     EXSR OVERDC
     C                     WRITETOTDDC
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3762CPD1                                           S01408
     C*                                                                   S01408
     C                     END                             - E1
     C*
     C**  PREPARE TOTAL
     C*
     C                     Z-ADD*ZERO     TINTC0
     C           CSCCI     IFEQ 'Y'
     C           CSCCI     OREQ 'I'
     C           CSCCI     OREQ 'A'
     C*
     C                     Z-SUBCCAIC     TINTC0
     C                     ADD  WWCINW    TINTC0                          160301
     C/COPY WNCPYSRC,RE3762C022
     C                     END
      *                                                                   130468
      * Add BRT if applicable                                             130468
     C           *IN22     IFEQ '1'                                       130468
     C                     ADD  BRTOT0    TINTC0                          130468
     C                     END                                            130468
      *                                                                                       CGL031
      ** Add EUT if applicable                                                                CGL031
      *                                                                                       CGL031
     C           *IN21     IFEQ *ON                                                           CGL031
     C                     ADD  EUTAX0    TINTC0                                              CGL031
      *                                                                                       CER048
      ** Add Secondary Tax, if applicable                                                     CER048
      *                                                                                       CER048
     C           CER048    IFEQ 'Y'                                                           CER048
     C                     ADD  STAX0     TINTC0                                              CER048
     C                     ENDIF                                                              CER048
      *                                                                                       CER048
     C                     ENDIF                                                              CGL031
      *                                                                   130468
     C           CSCHGI    IFEQ 'Y'
     C           CSCHGI    OREQ 'I'
     C           CSCHGI    OREQ 'A'
     C           CSCHGI    OREQ 'L'                                       160301
     C           CSCHGI    OREQ 'O'                                       160301
     C*
     C                     ADD  CCHGP     TINTC0
     C                     END
      *                                                                   160301
     C**********           SUB  WWCINW    TINTC0                          160301
     C                     SUB  CSGACI    TINTC0                          130468
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3762CPD2                                           S01408
     C*                                                                   S01408
     C                     EXSR CLMSG
     C                     MOVELNAR,21    DNARR
     C*
     C                     EXSR OVERDC
     C                     WRITETOTDDC
     C/COPY WNCPYSRC,RE3762C143
     C*
     C****PREPARE*TOTAL CREDITED OUTPUT                                   160301
     C*
     C**********           EXSR CLMSG                                     160301
     C**********           MOVELNAR,10    DNARR                           160301
     C*
     C**********           Z-ADD*ZEROS    TINTD0                          160301
     C*
     C****OUTPUT*TOTAL CREDITED                                           160301
     C*
     C**********           EXSR OVERDC                                    160301
     C**********           WRITETOTDDC                                    160301
     C*
     C***CAPITALISATION*TO*AN ACCOUNT IN DIFFERENT CURRENCY AND           125176
     C***MULTIBRANCH*IS*PRESENT                                           125176
     C*
     C********** *IN87     IFEQ '1'                        - B1           125176
     C**********           MOVELNAR,25    NARR                            125176
     C********** DEXRT     IFNE *ZEROS                     - B2           125176
     C**********           Z-ADDDEXRT     RATE                            125176
     C**********           MOVELSDACP     MIDK                            125176
     C**********           EXSR OVERDC                                    125176
     C**********           WRITEALTNDC                                    125176
     C**********           END                             - E2           125176
      *                                                                   125176
      * Report alternative a/c for CR interest if used                    125176
     C           SCACP     IFNE *BLANK                                    125176
      *                                                                   125176
      * If capitalisation to a/c in different ccy, report exchange rate   125176
     C           *IN87     IFEQ '1'                                       125176
     C********** CEXRT     IFNE *ZEROS                     - B2           125176
     C           CEXRT     ANDNE*ZEROS                                    125176
     C                     Z-ADDCEXRT     RATE
     C                     MOVE '0'       *IN55                           125176
     C                     ELSE                                           125176
     C                     MOVE '1'       *IN55                           125176
     C                     END                                            125176
      *                                                                   125176
     C                     EXSR CLMSG                                     125176
     C                     MOVELNAR,31    NARR                            125176
     C                     MOVELSCACP     MIDK
     C                     EXSR OVERDC
     C                     WRITEALTNDC
     C/COPY WNCPYSRC,RE3762C144
     C                     END                             - E2
      *                                                                   125176
      * Report alternative a/c for charges if used                        125176
     C           SCHAC     IFNE *BLANK                                    125176
      *                                                                   125176
      * If capitalisation to a/c in different ccy, report exchange rate   125176
     C           *IN87     IFEQ '1'                                       125176
     C********** CHXRT     IFNE *ZEROS                     - B2           125176
     C           CHXRT     ANDNE*ZEROS                                    125176
     C                     Z-ADDCHXRT     RATE
     C                     MOVE '0'       *IN55                           125176
     C                     ELSE                                           125176
     C                     MOVE '1'       *IN55                           125176
     C                     END                                            125176
      *                                                                   125176
     C                     EXSR CLMSG                                     125176
     C                     MOVELNAR,33    NARR                            125176
     C                     MOVELSCHAC     MIDK
     C                     EXSR OVERDC
     C                     WRITEALTNDC
     C/COPY WNCPYSRC,RE3762C145
     C                     END                             - E2
     C**********           END                             - E1           125176
     C*
     C           *IN70     IFEQ '1'                        - B1
     C                     EXSR OVERDC
     C                     WRITETOTMAN
     C                     END
     C*
     C/COPY WNCPYSRC,RE3762C008
     C                     ENDSR                           **CRSR ENDSR**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** DAYTSR subroutine to prepare and output days total
     C**
     C**     Called by       CRSR, DRSR
     C**
     C**     Calls           ZICD
     C**
     C           DAYTSR    BEGSR                           **DAYTSR BEGSR*
     C*
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C*
     C                     Z-ADDWHISB     HISB0
     C********** *IN80     IFEQ '1'                                       125176
     C           HISB0     MULT DAYS      NUMB0
     C**********           ELSE                                           125176
     C********** *IN81     IFEQ '1'                                       125176
     C********** HISB1     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** *IN82     IFEQ '1'                                       125176
     C********** HISB2     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** HISB3     MULT DAYS      NUMB0                           125176
     C**********           END                                            125176
     C**********           END                                            125176
     C**********           END                                            125176
     C********** NUMB0     DIV  100       NUMB0     H                     125176
     C*
     C           WHISB     IFGT *ZEROS                     - B1
     C           DDAID     SUB  WDAID     INTD0
     C                     Z-ADD*ZEROS    INTC0
     C                     ELSE                            - X1
     C           DCAID     SUB  WCAID     INTC0
     C                     Z-SUBINTC0     INTC0
     C                     Z-ADD*ZEROS    INTD0
     C                     END                             - E1
      *                                                                   CRE001
      ***If*CRE001*is*switched ON, then output 'Overdraft Limit'   CRE001 160301
      *  *** moved to avoid repetition for every balance change ***       160301
      *                                                                   CRE001
     C********** CRE001    IFEQ 'Y'                                CRE001 160301
     C**********           EXSR CLMSG                              CRE001 160301
     C**********           MOVELNAR,28    ONARR                    CRE001 125176
     C**********           MOVELNAR,38    ONARR                    125176 160301
     C**********           MOVE ODRL      OODRL                    CRE001 160301
     C**********           EXSR OVERDC                             CRE001 160301
     C**********           WRITEODLNDC                             CRE001 160301
     C**********           ENDIF                                   CRE001 160301
     C*
     C**  OUTPUT SUBTOTAL
     C*
     C                     EXSR OVERDC
     C                     WRITESTOTDC
     C/COPY WNCPYSRC,RE3762C146
     C*
     C                     ENDSR                           **DAYTSR ENDSR*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** DBSR subroutine for database error handling
     C**
     C**     Called by       DETPR, DRSR, RATED, RATEC, CRSR, RDRSR,
     C**                     RCRSR, BOTHSR, B1LT, B1GT, B1EQ, POSTSR,
     C**                     OPENDR, OPENCR, ZICD, FIRST
     C**
     C**     Calls           -
     C**
     C           DBSR      BEGSR                           **DBSR BEGSR**
     C*
     C                     MOVE '1'       *INU7
     C                     MOVE '1'       *INU8
     C                     MOVE '1'       *INLR
     C                     WRITEERRAU
     C*
     C                     MOVE *BLANKS   DBFILE
     C                     MOVE *BLANKS   DBKEY
     C                     Z-ADD*ZEROS    DBASE
     C*
     C           *IN72     IFEQ '1'                        - B1
     C                     ADD  1         PAGE
     C                     WRITEHEADAU
     C                     MOVE '0'       *IN72
     C                     END
     C*
     C                     ENDSR                           **DBSR ENDSR**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** DRSR subroutine for debit output processing
     C**
     C**     Called by       D E T P R
     C**
     C**     Calls           DBSR, DAYTSR, ITYPDR, RATED, ZICD, OVERDC
     C**
     C           DRSR      BEGSR                           **DRSR BEGSR**
     C*
     C**  OUTPUT HEADER LINES
     C*
     C                     MOVE '0'       *IN65
     C           ACNO      IFNE *ZEROS
     C                     MOVE '1'       *IN65
     C                     END
     C/COPY WNCPYSRC,RE3762C014
     C                     WRITEHEADDC
     C*
     C**  ACCESS REHISL WITH LAST DEBIT CAPITALISATION DATE
     C*
     C********** KLIST2    CHAINREHISL               52                   160301
     C           KLIST2    SETLLREHISL               52                   160301
     C           KLIST1    READEREHISL                   52               160301
     C*
     C           *IN52     IFEQ '1'                        - B1
     C                     Z-ADDCLDID     WDATE
     C                     Z-ADD08        DBASE
     C                     MOVE 'REHISL'  DBFILE           ***************
     C                     MOVELRKEY2     DBKEY            **DB ERROR 08**
     C                     MOVEA'1'       *IN,89           ***************
     C                     EXSR DBSR
     C                     END                             - E1
     C*
     C           *IN52     DOWEQ'0'                        - B1
     C           DRECI     ANDEQ'S'
     C***********SCICI     ANDEQ'Y'                                      098818
     C           SCICI     ANDNE*BLANKS                                  098818
     C           SDICI     ANDEQ*BLANKS
     C           DHISD     ANDLTCHISD
     C           *IN52     OREQ '0'
     C           DRECI     ANDEQ'D'
     C           DDRCI     ANDEQ*BLANKS
     C********** DCRCI     ANDEQ'Y'                                       160301
     C           DMADI     ANDEQ*ZEROS                                    160301
     C           DDMVT     ANDEQ*ZEROS                                    160301
     C           DCMVT     ANDEQ*ZEROS                                    160301
     C           *IN52     OREQ '0'                                       182452
     C           DRECI     ANDEQ'M'                                       182452
     C*
     C           KLIST1    READEREHISL                   52
     C*
     C                     END                             - E1
     C*
     C**  PREPARE B/F BALANCE
     C*
     C           DRECI     IFEQ 'B'                        - B1
     C                     Z-ADD*ZEROS    HISB0
     C                     Z-ADDDHISD     BDATE                           125176
     C                     ELSE                            - X1
     C           DRECI     IFEQ 'S'                        - B2
     C                     Z-ADDSSTBL     HISB0
     C                     ELSE                            - X2
     C                     Z-ADDCLDID     WDATE
     C                     Z-ADD09        DBASE
     C                     MOVE 'REHISL'  DBFILE           ***************
     C                     MOVELRKEY2     DBKEY            **DB ERROR 09**
     C                     MOVEA'1'       *IN,89           ***************
     C                     EXSR DBSR
     C                     END                             - E2
     C                     END                             - E1
     C*
     C                     Z-ADDDHISB     DOHISB
     C                     MOVE *BLANKS   VALDA
     C*
     C                     EXSR CLMSG
     C                     MOVELNAR,1     TNARR
     C*
     C**  OUTPUT B/F BALANCE
     C*
     C                     EXSR OVERDC
     C                     WRITETITLEDC
     C/COPY WNCPYSRC,RE3762C147
     C*
     C           KLIST2    SETLLREHPOPH
     C*
     C           KLIST1    READEREHPOPH                  50
     C*
     C**  BACK VALUE PROCESSING START
     C*
     C           *IN50     DOWEQ'0'                        - B1
     C********** PSTD      ANDLTCHISD                                     160301
     C           PSTD      ANDLECHISD                                     160301
     C*
     C****TRANSFER*DATE*MIDAS*INTO*DDMMMYY                                160301
     C*
      * If last day accruals a backvalued item posted on cap. value       160301
      * date is already reflected in that capitalisation.                 160301
      * If first day accruals a backvalued item posted on cap. value      160301
      * date is not reflected in that capitalisation as the cap. value    160301
      * date is cap. date + 1.                                            160301
     C           HISD      IFLT CLDID
     C           PSTD      ANDGTCLDID                                     160301
     C           HISD      ORLT CLDID                                     160301
     C           PSTD      ANDEQCLDID                                     160301
     C           LDAC      ANDEQ'N'                                       160301
     C*
     C           PPSTD     IFNE PSTD                       - B2
     C                     Z-ADDPSTD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    PSTDO
     C*
     C                     Z-ADDPSTD      PPSTD
     C                     END                             - E2
     C*
     C                     MOVE PSTDO     PSTDA
     C*
     C**  TRANSFER DATE MIDAS INTO DDMMMYY
     C*
     C           PVALD     IFNE HISD                       - B2
     C                     Z-ADDHISD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALDO
     C*
     C                     Z-ADDHISD      PVALD
     C                     END                             - E2
     C*
     C                     MOVELPNAR      NARR
     C                     MOVE VALDO     VALDA
      *                                                                   125176
      * NB. REHPOPH now includes rate changes as well (REHPOSR1)          125176
      * Report backvalued posting                                         125176
     C           RECI      IFEQ 'P'                                       125176
     C*
     C**  CHECK IF DEBIT OR CREDIT
     C*
     C           DRCR      IFEQ 0                          - B2
     C           TURN      IFNE 'Y'
     C                     MOVE '1'       *IN33
     C                     END
     C                     Z-ADDPSTA      PSTD0
     C                     ELSE                            - X2
     C                     Z-SUBPSTA      PSTD0
     C                     END                             - E2
     C*
     C**  OUTPUT BACK VALUE
     C*
     C                     EXSR OVERDC
     C                     WRITEPOSTDC
     C/COPY WNCPYSRC,RE3762C039
     C*
     C                     MOVE '0'       *IN33
      *                                                                   125176
      * Report backvalued rate change                                     125176
     C                     ELSE                                           125176
     C           DRCR      IFEQ 0                                         125176
     C                     Z-ADDHISD      DDRCD                           125176
     C                     EXSR RATED                                     125176
     C                     END                                            125176
     C                     END                                            125176
     C*
     C                     END
     C*
     C           KLIST1    READEREHPOPH                  50
     C*
     C                     END                             - E1
      *                                                                   160301
      * Generated adjs. going to the a/c before start date should be      160301
      * reported for both management and 'proper' DR only cap. as they    160301
      * are reflected in the opening balance, and even if it is a real    160301
      * cap. CR adjs. are not posted at a DR only cap.                    160301
     C           KLIST1    SETLLREHISSL                  20               160301
     C           *IN20     IFEQ '1'                                       160301
     C           KLIST1    READEREHISSL                  20               160301
      *                                                                   160301
     C           *IN20     DOWEQ'0'                                       160301
     C           AHISD     ANDLTCLDID                                     160301
      *                                                                   160301
     C           ASDCI     IFEQ 'Y'                                       160301
     C           ADAIC     ANDNE*ZEROS                                    160301
     C           ASCCI     OREQ 'Y'                                       160301
     C           ACAIC     ANDNE*ZEROS                                    160301
     C                     EXSR GADJSR                                    160301
      *                                                                   160301
      * Report DR gen. adj. (management cap.) in the DR interest column   160301
     C           INTD0     IFNE *ZEROS                                    160301
     C                     EXSR OVERDC                                    160301
     C                     WRITEMADJDC                                    160301
     C/COPY WNCPYSRC,RE3762C148
     C                     END                                            160301
      *                                                                   160301
      * Report CR gen. adjustment as an entry                             160301
     C           INTC0     IFNE *ZEROS                                    160301
     C                     Z-ADDINTC0     PSTD0                           160301
     C                     EXSR OVERDC                                    160301
     C                     WRITEPOSTDC                                    160301
     C/COPY WNCPYSRC,RE3762C040
     C                     END                                            160301
      *                                                                   160301
     C                     END                                            160301
      *                                                                   160301
     C           KLIST1    READEREADJF                   20               160301
     C                     ENDDO                                          160301
      *                                                                   160301
     C                     ELSE                                           160301
     C                     MOVE '1'       *IN20                           160301
     C                     END                                            160301
     C*
     C**  BACK VALUE PROCESSING END
     C*
     C           KLIST2    SETLLREHPOPL
     C           KLIST1    READEREHPOPL                  50
     C*
     C**  PREPARE OPENING BALANCE OUTPUT
     C*
     C           DRECI     IFEQ 'B'                        - B1
     C                     Z-ADDDHISB     WHISB
     C                     ELSE                            - X1
     C           DRECI     IFEQ 'S'                        - B2
     C                     Z-ADDSSTBL     WHISB
     C                     END                             - E2
     C                     END                             - E1
     C                     Z-ADDDOHISB    HISB0
     C*
     C                     EXSR CLMSG
     C                     MOVELNAR,2     TNARR
     C*
     C**  SAVE IN CASE OF NO POSTING
     C*
     C**********           Z-ADDCLCID     WHISD                           160301
     C                     Z-ADDCLDID     WHISD                           160301
     C*
     C**  TRANSFER DATE MIDAS INTO DDMMMYY
     C*
     C           CLDID     IFNE PVALD                      - B1
     C*
     C                     Z-ADDCLDID     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALDO
     C*
     C                     Z-ADDCLDID     PVALD
     C*
     C                     END                             - E1
     C*
     C                     MOVE VALDO     VALDA
     C*
     C**  OUTPUT OPENING BALANCE
     C*
     C                     EXSR OVERDC
     C                     WRITETITLEDC
     C/COPY WNCPYSRC,RE3762C149
     C*
     C**  PREPARE OPENING RATE OUTPUT
     C*
      * Access REHRDJ (REHPOSR1 REHPOSR2 REHPOSR3) for DR opening rate    125176
     C           KLIST2    SETLLREHRDJ                                    125176
     C           KLIST1    REDPEREHRDJ                   60               125176
      *                                                                   125176
     C           *IN60     IFEQ '1'                                       125176
     C           BDATE     ANDEQCLDID                                     125176
     C           KLIST2    SETLLREHRDJ                                    125176
     C           KLIST2    READEREHRDJ                   60               125176
     C                     END                                            125176
      *                                                                   125176
     C           *IN60     IFEQ '1'                                       125176
     C                     Z-ADD*ZEROS    DRIR                            125176
     C                     Z-ADD*ZEROS    INTP                            125176
     C                     Z-ADD*ZEROS    INST                            125176
     C                     Z-ADD*ZEROS    INRT                            125176
     C                     END                                            125176
      *                                                                   125176
     C                     MOVE *BLANKS   VALDA
     C                     MOVE *BLANKS   PSTDA
     C*
     C                     EXSR CLMSG
     C                     MOVELNAR,3     RNARR
     C*
     C**  OUTPUT OPENING RATE
     C*
     C**********           Z-ADDDRIR      RATE                            125176
     C**********           EXSR OVERDC                                    125176
     C**********           WRITERATEDC                                    125176
      * Change narrative 'rate change to' to 'opening rate'               125176
     C                     MOVE 'Y'       OPN                             125176
     C                     EXSR RDRSR                                     125176
     C                     MOVE ' '       OPN                             125176
      *                                                                   160301
      * If CRE001 is switched ON, then output 'Overdraft Limit'           160301
     C           CRE001    IFEQ 'Y'                                       160301
     C                     EXSR CLMSG                                     160301
     C                     MOVELNAR,38    ONARR                           160301
     C                     MOVE ODRL      OODRL                           160301
     C                     EXSR OVERDC                                    160301
     C                     WRITEODLNDC                                    160301
     C/COPY WNCPYSRC,RE3762C150
     C                     ENDIF                                          160301
      *                                                                   160301
      * Report generated adjustment on start date.                        160301
     C           *IN20     IFEQ '0'                                       160301
     C           AHISD     ANDEQCLDID                                     160301
     C           ASDCI     IFEQ 'Y'                                       160301
     C           ADAIC     ANDNE*ZEROS                                    160301
     C           ASCCI     OREQ 'Y'                                       160301
     C           ACAIC     ANDNE*ZEROS                                    160301
     C                     EXSR GADJSR                                    160301
     C                     MOVE 'Y'       @ADJF                           160301
      *                                                                   160301
      * Report DR adj. (management cap.) in DR interest column.           160301
     C           INTD0     IFNE *ZEROS                                    160301
     C                     EXSR OVERDC                                    160301
     C                     WRITEMADJDC                                    160301
     C/COPY WNCPYSRC,RE3762C151
     C                     END                                            160301
      *                                                                   160301
      * Report CR adj. as an entry                                        160301
     C           INTC0     IFNE *ZEROS                                    160301
     C                     Z-ADDINTC0     PSTD0                           160301
     C                     EXSR OVERDC                                    160301
     C                     WRITEPOSTDC                                    160301
     C/COPY WNCPYSRC,RE3762C041
     C                     END                                            160301
     C                     END                                            160301
     C                     END                                            160301
     C*
     C           DRECI     IFEQ 'S'                        - B1
     C                     Z-ADDDHISD     WHISD
     C                     Z-ADDDHISB     WHISB
     C                     Z-ADDSMNBL     WMNBL
     C**********           Z-ADDDDRCB     WDRCB                           160301
     C**********           Z-ADDDCRCB     WCRCB                           160301
     C                     Z-ADDSDRCB     WDRCB                           160301
     C                     Z-ADDSCRCB     WCRCB                           160301
     C           KLIST1    READEREHISL                   51
     C*
      * Bypass (CR) cap. recs and position recs. with no movement or      160301
      * DR rate change or DR manual adj. or balance change.               160301
     C           *IN51     DOWEQ'0'                        - B2
     C           DRECI     ANDEQ'S'
     C           DHISD     ANDLTCHISD                                     160301
     C           *IN51     OREQ '0'                                       160301
     C           DRECI     ANDEQ'D'                                       160301
     C           DDRCI     ANDEQ*BLANKS                                   160301
     C           DDMVT     ANDEQ0                                         160301
     C           DCMVT     ANDEQ0                                         160301
     C           DMADI     ANDEQ0                                         160301
     C           @ADJF     ANDEQ*BLANKS                                   160301
      *                                                                   160301
      * Check for generated adjustment after start date (must be CR).     160301
     C           *IN51     IFEQ '0'                                       160301
     C           DRECI     ANDEQ'S'                                       160301
     C           DHISD     ANDLTCHISD                                     160301
     C           SCAIC     ANDNE*ZEROS                                    160301
     C           SCCI      ANDEQ'Y'                                       160301
     C                     Z-SUBSCAIC     @GADJ                           160301
     C                     MOVE 'Y'       @ADJF                           160301
     C                     END                                            160301
      *                                                                   160301
     C           KLIST1    READEREHISL                   51
     C                     END                             - E2
     C*
     C           *IN51     IFEQ '0'                        - B2
     C********** WHISD     ANDNEHISD                                      160301
     C           WHISD     ANDNEDHISD                                     160301
     C           DHISD     ANDLTCHISD                                     160301
     C*
     C           CDICT     IFLT 3                          - B3
     C                     Z-ADDWDRCB     ZICALC
     C                     Z-ADDWHISD     ZIBEG
     C                     Z-ADDDHISD     ZIEND
     C                     EXSR DAYTSR
     C                     ELSE                            - X3
     C                     EXSR ITYPDR
     C                     END                             - E3
     C*
     C                     END                             - E2
     C*
     C                     END                             - E1
     C*
     C           *IN51     DOWEQ'0'                        - B1
     C           DHISD     ANDLTCHISD
      *                                                                   160301
      * Report generated adjustment after start date if found             160301
     C           @ADJF     IFEQ 'Y'                                       160301
     C                     EXSR #ADJ                                      160301
     C           DHISD     IFGT CLDID                                     160301
     C                     EXSR OVERDC                                    160301
     C                     WRITEPOSTDC                                    160301
     C/COPY WNCPYSRC,RE3762C042
     C                     END                                            160301
     C                     END                                            160301
     C*
     C**  PROCESS POSTING AT THE SAME DATE
     C*
     C           *IN50     DOWEQ'0'                        - B2
     C           DHISD     ANDEQHISD
     C*
     C**  TRANSFER DATE MIDAS INTO DDMMMYY
     C*
     C           PPSTD     IFNE PSTD                       - B3
     C                     Z-ADDPSTD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    PSTDO
     C*
     C                     Z-ADDPSTD      PPSTD
     C*
     C                     END                             - E3
     C*
     C**  TRANSFER DATE MIDAS INTO DDMMMYY
     C*
     C           PVALD     IFNE HISD                       - B3
     C                     Z-ADDHISD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALDO
     C*
     C                     Z-ADDHISD      PVALD
     C*
     C                     END                             - E3
     C*
     C                     MOVE VALDO     VALDA
     C                     MOVE PSTDO     PSTDA
     C                     MOVELPNAR      NARR
     C*
     C**  CHECK IF DEBIT OR CREDIT
     C*
     C           DRCR      IFEQ 0                          - B3
     C                     Z-ADDPSTA      PSTD0
     C           TURN      IFNE 'Y'
     C                     MOVE '1'       *IN33
     C                     END
     C                     ELSE                            - X3
     C                     Z-SUBPSTA      PSTD0
     C                     END                             - E3
     C*
     C**  OUPUT POSTING
     C*
     C                     EXSR OVERDC
     C                     WRITEPOSTDC
     C/COPY WNCPYSRC,RE3762C043
     C*
     C                     MOVE '0'       *IN33
     C*
     C           KLIST1    READEREHPOPL                  50
     C*
     C                     END                             - E2
      *                                                                   160301
      * Report manual adjustment                                          160301
     C           DMADI     IFNE 0                                         160301
     C                     EXSR MADJSR                                    160301
     C                     END                                            160301
     C*
     C**  DEBIT RATE CHANGE TO
     C*
     C           DDRCI     IFEQ 'Y'                        - B2
     C           DRECI     ANDNE'B'
     C           DRECI     ANDNE'M'                                       182452
     C*
     C                     EXSR RATED
     C*
     C                     END                             - E2
     C*
     C**  SAVE REHISL  AS PREVIOUS
     C*
     C                     Z-ADDDHISD     WHISD
     C                     Z-ADDDHISB     WHISB
     C                     MOVE DDRCB     WDRCB
     C                     Z-ADDDCRCB     WCRCB
     C                     Z-ADDDCAID     WCAID
     C                     Z-ADDDDAID     WDAID
     C*
     C           KLIST1    READEREHISL                   51
     C*
      * Bypass (CR) cap. recs and position recs. with no movement or      160301
      * DR rate change or DR manual adj. or balance change.               160301
     C           *IN51     DOWEQ'0'                        - B2
     C           DRECI     ANDEQ'S'
     C***********SCICI     ANDEQ'Y'                                      098818
     C********** SCICI     ANDNE*BLANKS                            098818 160301
     C********** SDICI     ANDEQ*BLANKS                                   160301
     C           DHISD     ANDLTCHISD
     C           *IN51     OREQ '0'
     C           DRECI     ANDEQ'D'
     C           DDRCI     ANDEQ*BLANKS
     C********** DCRCI     ANDEQ'Y'                                       160301
     C           DDMVT     ANDEQ*ZEROS                                    160301
     C           DCMVT     ANDEQ*ZEROS                                    160301
     C           DMADI     ANDEQ*ZEROS                                    160301
     C           @ADJF     ANDEQ*BLANKS                                   160301
      *                                                                   160301
      * Check for CR generated adjustment                                 160301
     C           *IN51     IFEQ '0'                                       160301
     C           DRECI     ANDEQ'S'                                       160301
     C           DHISD     ANDLTCHISD                                     160301
     C           SCAIC     ANDNE*ZEROS                                    160301
     C           SCCI      ANDEQ'Y'                                       160301
     C                     Z-SUBSCAIC     @GADJ                           160301
     C                     MOVE 'Y'       @ADJF                           160301
     C                     END                                            160301
     C*
     C           KLIST1    READEREHISL                   51
     C*
     C                     END                             - E2
     C*
     C**  OUTPUT SUBTOTAL LINE
     C*
     C           *IN51     IFEQ '0'                        - B2
     C           DHISD     ANDLTCHISD
     C*
     C           CDICT     IFLT 3                          - B3
     C                     Z-ADDWDRCB     ZICALC
     C                     Z-ADDWHISD     ZIBEG
     C                     Z-ADDDHISD     ZIEND
     C                     EXSR DAYTSR
     C                     ELSE                            - X3
     C                     EXSR ITYPDR
     C                     END                             - E3
     C*
     C********** *IN51     DOWEQ'0'                        - B3           160301
     C********** DHISD     ANDLTHISD                                      160301
     C********** CHISD     ANDLTHISD                                      160301
     C*
     C****CHECK*IF READ RECORD IS A CHANGE RATE                           160301
     C*
     C********** DDRCI     IFEQ 'Y'                        - B4           160301
     C********** DRECI     ANDNE'B'                                       160301
     C*
     C**********           EXSR RATED                                     160301
     C*
     C****SAVE*REHISL  AS PREVIOUS                                        160301
     C*
     C**********           Z-ADDDHISD     WHISD                           160301
     C**********           Z-ADDDHISB     WHISB                           160301
     C**********           MOVE DDRCB     WDRCB                           160301
     C**********           Z-ADDDCRCB     WCRCB                           160301
     C**********           Z-ADDDCAID     WCAID                           160301
     C**********           Z-ADDDDAID     WDAID                           160301
     C*
     C********** KLIST1    READEREHISL                   51               160301
     C*
     C********** *IN51     DOWEQ'0'                        - B5           160301
     C********** DRECI     ANDEQ'S'                                       160301
     C***********SCICI     ANDEQ'Y'                                      098818
     C********** SCICI     ANDNE*BLANKS                            098818 160301
     C********** SDICI     ANDEQ*BLANKS                                   160301
     C********** DHISD     ANDLTCHISD                                     160301
     C********** *IN51     OREQ '0'                                       160301
     C********** DRECI     ANDEQ'D'                                       160301
     C********** DDRCI     ANDEQ*BLANKS                                   160301
     C********** DCRCI     ANDEQ'Y'                                       160301
     C*
     C********** KLIST1    READEREHISL                   51               160301
     C*
     C**********           END                             - E5           160301
     C*
     C********** CDICT     IFLT 3                          - B5           160301
     C**********           Z-ADDWDRCB     ZICALC                          160301
     C**********           Z-ADDWHISD     ZIBEG                           160301
     C**********           Z-ADDDHISD     ZIEND                           160301
     C**********           EXSR DAYTSR                                    160301
     C**********           ELSE                            - X5           160301
     C**********           EXSR ITYPDR                                    160301
     C**********           END                             - E5           160301
     C*
     C**********           ELSE                            - X4           160301
     C*
     C********** KLIST1    READEREHISL                   51               160301
     C*
     C********** *IN51     DOWEQ'0'                        - B5           160301
     C********** DRECI     ANDEQ'S'                                       160301
     C***********SCICI     ANDEQ'Y'                                      098818
     C********** SCICI     ANDNE*BLANKS                            098818 160301
     C********** SDICI     ANDEQ*BLANKS                                   160301
     C********** DHISD     ANDLTCHISD                                     160301
     C********** *IN51     OREQ '0'                                       160301
     C********** DRECI     ANDEQ'D'                                       160301
     C********** DDRCI     ANDEQ*BLANKS                                   160301
     C********** DCRCI     ANDEQ'Y'                                       160301
     C*
     C********** KLIST1    READEREHISL                   51               160301
     C*
     C**********           END                             - E5           160301
     C*
     C**********           END                             - E4           160301
     C*
     C**********           END                             - E3           160301
     C*
     C                     END                             - E2
     C*
     C                     END                             - E1
     C*
     C********** KLIST2    SETLLREHISL                   52               160301
     C*
     C********** *IN52     IFEQ '0'                        - B1           160301
     C**********           Z-ADDCLDID     WDATE                           160301
     C**********           Z-ADD10        DBASE                           160301
     C**********           MOVE 'REHISL'  DBFILE           ***************160301
     C**********           MOVELRKEY2     DBKEY            **DB ERROR 10**160301
     C**********           MOVEA'1'       *IN,89           ***************160301
     C**********           EXSR DBSR                                      160301
     C**********           END                             - E1           160301
     C*
     C********** KLIST1    READEREHISL                   52               160301
     C*
     C********** *IN52     DOWEQ'0'                        - B1           160301
     C********** DRECI     ANDEQ'S'                                       160301
     C***********SCICI     ANDEQ'Y'                                      098818
     C********** SCICI     ANDNE*BLANKS                            098818 160301
     C********** SDICI     ANDEQ*BLANKS                                   160301
     C********** DHISD     ANDLTCHISD                                     160301
     C********** *IN52     OREQ '0'                                       160301
     C********** DRECI     ANDEQ'D'                                       160301
     C********** DDRCI     ANDEQ*BLANKS                                   160301
     C********** DCRCI     ANDEQ'Y'                                       160301
     C*
     C********** KLIST1    READEREHISL                   52               160301
     C*
     C**********           END                             - E1           160301
     C*
     C           DDICT     IFLT 3                          - B1
     C*
     C                     Z-ADDWDRCB     ZICALC
     C                     Z-ADDWHISD     ZIBEG
     C                     Z-ADDCHISD     ZIEND
     C*
     C                     EXSR ZICD
     C                     Z-ADDZDAYN1    DAYS
     C*
     C                     Z-ADDWHISB     HISB0
     C********** *IN80     IFEQ '1'                                       125176
     C           HISB0     MULT DAYS      NUMB0
     C**********           ELSE                                           125176
     C********** *IN81     IFEQ '1'                                       125176
     C********** HISB1     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** *IN82     IFEQ '1'                                       125176
     C********** HISB2     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** HISB3     MULT DAYS      NUMB0                           125176
     C**********           END                                            125176
     C**********           END                                            125176
     C**********           END                                            125176
     C********** NUMB0     DIV  100       NUMB0     H                     125176
     C*
     C********** WHISB     IFGT *ZEROS                     - B1           160301
     C           CDAIC     SUB  WDAID     INTD0
     C                     SUB  DTMADI    INTD0                           160301
     C**********           Z-ADD*ZEROS    INTC0                           160301
     C**********           ELSE                            - X1           160301
     C********** CCAIC     SUB  WCAID     INTC0                           160301
     C**********           Z-SUBINTC0     INTC0                           160301
     C**********           Z-ADD*ZEROS    INTD0                           160301
     C**********           END                             - E1           160301
     C*
     C**  OUTPUT SUBTOTAL
     C*
     C                     EXSR OVERDC
     C                     WRITESTOTDC
     C/COPY WNCPYSRC,RE3762C152
     C*
     C                     END                             - E1
     C*
     C** PREPARE C/F BALANCE
     C*
     C                     EXSR CLMSG
     C                     MOVELNAR,6     TNARR
     C*
     C**  TRANSFER DATE MIDAS INTO DDMMMYY
     C*
     C           PVALD     IFNE CHISD                      - B1
     C                     Z-ADDCHISD     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALDO
     C*
     C                     MOVE CHISD     PVALD
     C*
     C                     END                             - E1
     C*
     C                     MOVE VALDO     VALDA
     C                     Z-ADDCHISB     HISB0
     C*
     C**  OUTPUT BALANCE C/F
     C*
     C                     EXSR OVERDC
     C                     WRITETITLEDC
     C/COPY WNCPYSRC,RE3762C153
     C*
     C**  PREPARE TOTAL INTEREST OUTPUT
     C*
     C                     Z-ADDWDRCB     ZICALC
     C                     Z-ADDCLDID     ZIBEG
     C                     Z-ADDCHISD     ZIEND
     C                     EXSR ZICD
     C*
     C                     Z-ADDZDAYN1    DAYS
     C*
     C                     EXSR CLMSG
     C                     MOVELNAR,5     XNARR
     C*
     C                     Z-ADDCDAIC     TINTD0
     C*
     C**  OUTPUT TOTAL INTEREST
     C*
     C                     EXSR OVERDC
     C                     WRITETOTALDC
     C/COPY WNCPYSRC,RE3762C154
      *                                                                   130468
      * Output total DR generated adjustments                             130468
     C           CSGADI    IFNE *ZEROS                                    130468
     C                     EXSR CLMSG                                     130468
     C                     Z-ADDCSGADI    TINTD0                          130468
     C                     MOVELNAR,23    DNARR                           130468
     C                     EXSR OVERDC                                    130468
     C                     WRITETOTDDC                                    130468
     C/COPY WNCPYSRC,RE3762C155
     C                     END                                            130468
     C*
     C**  PREPARE TOTAL COMMISSION OUTPUT
     C*
     C*
     C**  PREPARE FIXED COMMISSION OUTPUT
     C*
     C           FXDC      IFNE *ZERO                      - B1
     C                     EXSR CLMSG
     C**********           MOVELNAR,16    DNARR                           125176
     C                     MOVELNAR,28    DNARR                           125176
     C*
     C                     Z-ADDFXDC      TINTD0
     C                     Z-ADD*ZERO     TINTC0
     C                     EXSR OVERDC
     C                     WRITETOTDDC
     C/COPY WNCPYSRC,RE3762C156
     C                     END                             - E1
     C/COPY WNCPYSRC,RE3762C004
     C*
     C**  PREPARE COMMISSION ON DEBIT INTEREST
     C*
     C           *IN70     IFEQ '1'                        - B1
     C*
     C           CDIE      IFNE *ZERO                      - B2
     C                     EXSR CLMSG
     C                     MOVELNAR,17    DNARR
     C*
     C                     Z-ADDCDIE      TINTD0
     C                     Z-ADD*ZERO     TINTC0
     C                     EXSR OVERDC
     C                     WRITETOTDDC
     C/COPY WNCPYSRC,RE3762C157
     C                     END                             - E2
     C*
     C**  PREPARE ACCOUNT COMMISSION
     C*
     C           ACCEA     IFNE *ZERO                      - B2
     C                     EXSR CLMSG
     C                     MOVELNAR,18    DNARR
     C*
     C                     Z-ADDACCEA     TINTD0
     C                     Z-ADD*ZERO     TINTC0
     C                     EXSR OVERDC
     C                     WRITETOTDDC
     C/COPY WNCPYSRC,RE3762C158
     C                     END                             - E2
     C*
     C**  PREPARE H/O COMMISSION
     C*
     C           CHDBE     IFNE *ZERO                      - B2
     C                     EXSR CLMSG
     C                     MOVELNAR,19    DNARR
     C*
     C                     Z-ADDCHDBE     TINTD0
     C                     Z-ADD*ZERO     TINTC0
     C                     EXSR OVERDC
     C                     WRITETOTDDC
     C/COPY WNCPYSRC,RE3762C159
     C                     END                             - E2
     C*
     C**  PREPARE COMMISSION ON MINIMUM BALANCE
     C*
     C           CMBE      IFNE *ZERO                      - B2
     C                     EXSR CLMSG
     C                     MOVELNAR,20    DNARR
     C*
     C                     Z-ADDCMBE      TINTD0
     C                     Z-ADD*ZERO     TINTC0
     C                     EXSR OVERDC
     C                     WRITETOTDDC
     C/COPY WNCPYSRC,RE3762C160
     C                     END                             - E2
     C*
     C                     ELSE                            - X1
     C*
     C           CDICA     IFNE *ZERO                      - B2
     C                     EXSR CLMSG
     C                     MOVELNAR,17    DNARR
     C*
     C           CDICA     SUB  CCDIC     TINTD0
     C                     Z-ADD*ZERO     TINTC0
     C                     EXSR OVERDC
     C                     WRITETOTDDC
     C/COPY WNCPYSRC,RE3762C161
     C                     END                             - E2
     C*
     C**  PREPARE ACCOUNT COMMISSION
     C*
     C           ACCC      IFNE *ZERO                      - B2
     C                     EXSR CLMSG
     C                     MOVELNAR,18    DNARR
     C*
     C           ACCC      SUB  CACCC     TINTD0
     C                     Z-ADD*ZERO     TINTC0
     C                     EXSR OVERDC
     C                     WRITETOTDDC
     C/COPY WNCPYSRC,RE3762C162
     C                     END                             - E2
     C*
     C**  PREPARE H/O COMMISSION
     C*
     C           CHDBC     IFNE *ZERO                      - B2
     C                     EXSR CLMSG
     C                     MOVELNAR,19    DNARR
     C*
     C           CHDBC     SUB  CCHDBC    TINTD0
     C                     Z-ADD*ZERO     TINTC0
     C                     EXSR OVERDC
     C                     WRITETOTDDC
     C/COPY WNCPYSRC,RE3762C163
     C                     END                             - E2
     C*
     C**  PREPARE COMMISSION ON MINIMUM BALANCE
     C*
     C           CMBC      IFNE *ZERO                      - B2
     C                     EXSR CLMSG
     C                     MOVELNAR,20    DNARR
     C*
     C           CMBC      SUB  CCMBC     TINTD0
     C                     Z-ADD*ZERO     TINTC0
     C                     EXSR OVERDC
     C                     WRITETOTDDC
     C/COPY WNCPYSRC,RE3762C164
     C                     END                             - E2
     C*
     C**  PREPARE VAT
     C*
     C           VATAM     IFNE *ZERO                      - B2
     C                     EXSR CLMSG
     C                     MOVELNAR,24    DNARR
     C*
     C                     Z-ADDVATAM     TINTD0
     C                     Z-ADD*ZERO     TINTC0
     C                     EXSR OVERDC
     C                     WRITETOTDDC
     C/COPY WNCPYSRC,RE3762C165
     C                     END                             - E2
     C*
     C                     END                             - E1
     C*
     C**  PREPARE TOTAL
     C*
     C                     Z-ADD*ZERO     TINTD0
     C           CSDCI     IFEQ 'Y'
     C           CSDCI     OREQ 'I'
     C           CSDCI     OREQ 'A'
     C********** CDAIC     ADD  FXDC      TINTD0                          160301
     C                     ADD  CDAIC     TINTD0                          160301
     C/COPY WNCPYSRC,RE3762C005
     C                     END                                            160301
     C                     ADD  FXDC      TINTD0                          160301
     C           *IN70     IFEQ '0'                                       160301
     C                     ADD  CDICA     TINTD0
     C                     ADD  ACCC      TINTD0
     C                     ADD  CHDBC     TINTD0
     C                     ADD  CMBC      TINTD0
     C                     ADD  VATAM     TINTD0
     C                     ELSE                                           160301
     C                     ADD  CDIE      TINTD0                          160301
     C                     ADD  ACCEA     TINTD0                          160301
     C                     ADD  CHDBE     TINTD0                          160301
     C                     ADD  CMBE      TINTD0                          160301
     C                     END
     C                     ADD  CSGADI    TINTD0                          130468
      *                                                                   130468
     C                     EXSR CLMSG
     C                     MOVELNAR,21    DNARR
     C*
     C                     EXSR OVERDC
     C                     WRITETOTDDC
     C/COPY WNCPYSRC,RE3762C166
     C*
     C***CAPITALISATION*TO*AN ACCOUNT IN DIFFERENT CURRENCY AND           125176
     C***MULTIBRANCH*IS*PRESENT                                           125176
     C*
      * Report alternative a/c for DR interest if used                    125176
     C           SDACP     IFNE *BLANK                                    125176
      *                                                                   125176
      * If capitalisation to a/c in different ccy, report exchange rate   125176
     C           *IN87     IFEQ '1'                        - B1
     C**********           MOVELNAR,25    NARR                            125176
     C********** DEXRT     IFNE *ZEROS                     - B2           125176
     C           DEXRT     ANDNE*ZEROS                                    125176
     C                     Z-ADDDEXRT     RATE
     C                     MOVE '0'       *IN55                           125176
     C                     ELSE                                           125176
     C                     MOVE '1'       *IN55                           125176
     C                     END                                            125176
      *                                                                   125176
     C                     EXSR CLMSG                                     125176
     C                     MOVELNAR,32    NARR                            125176
     C                     MOVELSDACP     MIDK
     C                     EXSR OVERDC
     C                     WRITEALTNDC
     C/COPY WNCPYSRC,RE3762C167
     C                     END                             - E2
     C********** CEXRT     IFNE *ZEROS                     - B2           125176
     C**********           Z-ADDCEXRT     RATE                            125176
     C**********           MOVELSCACP     MIDK                            125176
     C**********           EXSR OVERDC                                    125176
     C**********           WRITEALTNDC                                    125176
     C**********           END                             - E2           125176
     C********** CHXRT     IFNE *ZEROS                     - B2           125176
     C**********           Z-ADDCHXRT     RATE                            125176
     C**********           MOVELSCHAC     MIDK                            125176
     C**********           EXSR OVERDC                                    125176
     C**********           WRITEALTNDC                                    125176
     C**********           END                             - E2           125176
     C**********           END                             - E1           125176
     C*
     C           *IN70     IFEQ '1'                        - B1
     C                     EXSR OVERDC
     C                     WRITETOTMAN
     C                     END
     C*
     C/COPY WNCPYSRC,RE3762C009
     C                     ENDSR                           **DRSR ENDSR**
     C*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** DETPR subroutine for detail processing
     C**
     C**     Called by       M A I N
     C**
     C**     Calls         BOTHSR, DRSR, CRSR, DBSR
     C**
     C           DETPR     BEGSR                           **DETPR BEGSR**
     C*
     C                     Z-ADDCDRCB     WDRCB
     C                     Z-ADDCCRCB     WCRCB
     C*
     C**  ACCESS ACCRACJ (ACCNTAB, REIACD, REACRD)
     C*
     C           KLIST1    CHAINACCRACJ              99
     C           *IN99     IFEQ '1'                        - B1
     C                     Z-ADD11        DBASE            ***************
     C                     MOVE 'ACCRACJ' DBFILE           **DB ERROR 11**
     C                     MOVELRKEY      DBKEY            ***************
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E1
     C*                                                                   094657
     C**  Set indicator for address print.                                094657
     C*                                                                   094657
     C                     MOVE '0'       *IN23                           094657
     C                     TESTB'2'       GLBT           23               094657
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3762CCP1                                           S01408
     C*                                                                   S01408
     C*
     C**  INITIALIZE TAXES WORK FIELDS
     C*
     C                     Z-ADD*ZEROS    WWCINW 150
     C                     MOVEL*BLANK    #JITAX  1
      *                                                                   CFT004
     C                     MOVEL*BLANKS   RIBAN                           CFT004
     C                     MOVE '0'       *IN04                           CFT004
     C           CFT004    IFEQ 'Y'                                       CFT004
     C                     MOVELCCNUM     WCNUM   6                       CFT004
     C**********           MOVELCACOD     WACOD   4                                    CFT004 CGL029
     C                     MOVELCACOD     WACOD  10                                           CGL029
     C                     MOVELCACSQ     WACSQ   2                       CFT004
     C                     CALL 'AOACCTR0'                                CFT004
     C                     PARM *BLANKS   PRTCD                           CFT004
     C                     PARM '*KEY   ' POPTN                           CFT004
     C                     PARM *BLANK    PRETL  10                       CFT004
     C                     PARM WCNUM     PCNUM   6                       CFT004
     C                     PARM CCCY      PCUCD   3                       CFT004
     C**********           PARM WACOD     PACCD   4                                    CFT004 CGL029
     C                     PARM WACOD     PACCD  10                                           CGL029
     C                     PARM WACSQ     PACSQ   2                       CFT004
     C                     PARM CBRCA     PBRCA   3                       CFT004
     C           ACCNTB    PARM ACCNTB    DSSDY                           CFT004
      *                                                                   CFT004
     C           PRTCD     IFNE *BLANKS                                   CFT004
     C                     Z-ADD28        DBASE            ************   CFT004
     C                     MOVEL'ACCNTAB' DBFILE           * DBERR 28 *   CFT004
     C                     MOVELRKEY      DBKEY            ************   CFT004
     C                     MOVE '1'       *IN89                           CFT004
     C                     EXSR DBSR                                      CFT004
     C                     ENDIF                                          CFT004
      *                                                                   CFT004
      ** Format International Bank Account Numbers                        CFT004
      *                                                                   CFT004
     C           IBAN      IFNE *BLANKS                                   CFT004
     C                     CALL 'AOIBANR3'                                CFT004
     C                     PARM *BLANKS   PRTCD   7                       CFT004
     C                     PARM IBAN      PIBAN  47                       CFT004
     C                     PARM *BLANKS   PIWITH 47                       CFT004
     C                     PARM *BLANKS   PINOBL 34                       CFT004
      *                                                                   CFT004
     C           PRTCD     IFEQ *BLANKS                                   CFT004
     C                     MOVELPIWITH    RIBAN                           CFT004
     C                     MOVE '1'       *IN04                           CFT004
     C                     ENDIF                                          CFT004
     C                     ENDIF                                          CFT004
      *                                                                   CFT004
     C                     ENDIF                                          CFT004
      *                                                                   CFT004
     C*
     C**  ACCESS RETAXJL (REARCD, ACCNTBX0)
     C*
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3762CCP2                                           S01408
     C*                                                                   S01408
     C           BGNTST    IFEQ 'Y'                        - B1
     C*
     C           CCICI     IFEQ 'Y'                        - B2
     C           CCICI     OREQ 'C'
     C           CCICI     OREQ 'D'
     C*
     C           KLIST1    CHAINRETAXJL              99
     C           *IN99     IFEQ '1'                        - B3
     C                     Z-ADD12        DBASE            ***************
     C                     MOVEL'RETAXJL' DBFILE           **DB ERROR 12**
     C                     MOVELRKEY      DBKEY            ***************
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     ELSE                            - X3
     C           #JITAX    IFEQ 'Y'                        - B4
      *                                                                                       CDL013
      ** If Tiered Withholding Tax feature is switched ON                                     CDL013
     C           CDL013    OREQ '1'                                                           CDL013
     C           #JITAX    ANDNE'0'                                                           CDL013
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3762CCP8                                           S01408
     C*                                                                   S01408
     C                     Z-ADD#JCINW    WWCINW
     C                     END                             - E4
     C*
     C                     END                             - E3
     C*
     C                     END                             - E2
     C*
     C                     END                             - E1
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3762CCP3                                           S01408
     C*                                                                   S01408
     C*
     C**  ACCESS CLINT FOR CLIENT INFORMATION (ADDRESS, NAME, ETC)
     C*
      *                                                                                       CRE083
      ** IF THE CUSTOMER NUMBER IS THE SAME AS THE PREVIOUS                                   CRE083
      ** CUSTOMER NUMBER NO NEED TO ACCESS CLINT                                              CRE083
      *                                                                                       CRE083
     C********** CCNUM     IFNE PCNUM                                                CRE083 MD038030
     C           CCNUM     IFNE XCNUM                                                       MD038030
      *                                                                                       CRE083
     C                     MOVE 'B'       RCDT
     C           KLIST4    CHAINCLINT                99
     C           *IN99     IFEQ '1'                        - B1
     C                     MOVELCCNUM     DBKEY
     C                     Z-ADD13        DBASE            ***************
     C                     MOVE 'CLINT'   DBFILE           **DB ERROR 13**
     C                     MOVELRCDT      DBKEY            ***************
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E1
      *                                                                                       CRE083
     C**********           MOVE CCNUM     PCNUM   6                                  CRE083 MD038030
     C                     MOVE CCNUM     XCNUM   6                                         MD038030
     C                     END                                                                CRE083
     C*
     C** CHECK IF CURRENCY EXIST
     C*
     C                     Z-ADD1         I
     C           CCCY      LOKUPCCYA,I                   97
     C*
     C           *IN97     IFEQ *ZERO                      - B1
     C                     Z-ADD14        DBASE            ***************
     C                     MOVE 'SDCURRPD'DBFILE           **DB ERROR 14**
     C                     MOVELCCCY      DBKEY            ***************
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E1
     C*
     C                     MOVE ACNO      WACNO
     C*
     C** CHECK NUMBER OF DECIMAL OF CURRENCY
     C*
     C                     MOVEA'0000'    *IN,80
     C*
     C           DPA,I     IFEQ 0                          - B1
     C                     MOVE '1'       *IN80
     C                     ELSE                            - X1
     C           DPA,I     IFEQ 1                          - B2
     C                     MOVE '1'       *IN81
     C                     ELSE                            - X2
     C           DPA,I     IFEQ 2                          - B3
     C                     MOVE '1'       *IN82
     C                     ELSE                            - X3
     C                     MOVE '1'       *IN83
     C                     END                             - E3
     C                     END                             - E2
     C                     END                             - E1
     C*
     C                     MOVEA'00'      *IN,01
     C*
     C**  DEFINE CAPITALISATION TO BE PROCESSED
     C*
     C           CDICI     IFNE *BLANKS                    - B1
     C                     MOVE '1'       *IN01
     C                     END                             - E1
     C*
     C           CCICI     IFNE *BLANKS                    - B1
     C                     MOVE '1'       *IN02
     C                     END                             - E1
     C*
     C           CCICI     IFNE *BLANKS                    - B1
     C           CDICI     ANDNE*BLANKS
     C                     EXSR BOTHSR
     C                     ELSE                            - X1
     C           CCICI     IFNE *BLANKS                    - B2
     C                     EXSR CRSR
     C                     END                             - E2
     C           CDICI     IFNE *BLANKS                    - B2
     C                     EXSR DRSR
     C                     END                             - E2
     C                     END                             - E1
     C*
     C                     EXSR INITPR
     C*
     C                     ENDSR                           **DETPR ENDSR**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** FIRST subroutine to execute first cycle.
     C**
     C**     Called by       S T A R T
     C**     Calls           DBSR
     C**
     C           FIRST     BEGSR                           **FIRST BEGSR**
     C*
     C** PREPARE DBPGM, DBKEY AND ERRDAT VARIABLES
     C*
     C                     MOVE 'RE3762  'DBPGM
     C                     MOVE *BLANKS   DBKEY
     C                     MOVE *BLANKS   BLK10  10
     C                     MOVE *BLANKS   DBASE
     C           *NAMVAR   DEFN RUNDAT    RUNDT
     C                     IN   RUNDT
     C           MBIN      IFEQ 'Y'
     C                     SETON                     86
     C                     END
     C**
     C**   ACCESS BANK DETAILS
     C**
     C                     CALL 'AOBANKR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C           SDBANK    PARM SDBANK    DSFDY
     C*
     C           @RTCD     IFNE *BLANK
     C                     MOVEL'SDBANKPD'DBFILE
     C                     MOVEL@OPTN     DBKEY            ***************
     C                     MOVEL@OPTN     DBOPTN  7        **DB ERROR 15**
     C                     Z-ADD15        DBASE            ***************
     C                     EXSR DBSR
     C                     GOTO ENDFST
     C                     END
     C*                                                                   104618
     C**   Access Retail Details.                                         104618
     C*                                                                   104618
     C                     CALL 'AORETLR0'                                104618
     C                     PARM *BLANKS   @RTCD   7                       104618
     C                     PARM '*FIRST ' @OPTN   7                       104618
     C           SDRETL    PARM SDRETL    DSFDY                           104618
     C           @RTCD     IFNE *BLANK                                    104618
     C           *LOCK     IN   LDA                                       104618
     C                     MOVEL'SDRETLPD'DBFILE           ***************104618
     C                     MOVEL@OPTN     DBKEY            * DB ERROR 25 *104618
     C                     MOVEL@OPTN     DBOPTN  7        ***************104618
     C                     Z-ADD025       DBASE                           104618
     C                     OUT  LDA                                       104618
     C                     EXSR DBSR                                      104618
     C                     GOTO ENDFST                                    104618
     C                     END                                            104618
     C*
     C** OUTPUT AUDIT HEADER
     C*
     C                     WRITEHEADAU
     C*
     C** INITIALISE WORK FIELDS
     C*
     C                     Z-ADD*ZEROS    PPSTD
     C                     Z-ADD*ZEROS    PVALD
     C                     Z-ADD1         PAGN
     C/COPY WNCPYSRC,RE3762C027
     C                     Z-ADD1         PAGA
     C/COPY WNCPYSRC,RE3762C028
     C                     Z-ADD1         PAGE
     C                     Z-ADD*ZEROS    DHISD
     C                     Z-ADD*ZEROS    WHISD
     C                     Z-ADD*ZEROS    DAYS
     C                     Z-ADD*ZEROS    NUMB0
     C                     Z-ADD*ZEROS    HISB0
     C                     Z-ADD*ZEROS    INTD0
     C                     Z-ADD*ZEROS    INTC0
     C                     Z-ADD*ZEROS    TINTD0
     C                     Z-ADD*ZEROS    TINTC0
     C                     Z-ADD*ZEROS    ZICALC  20
     C                     Z-ADD*ZEROS    ZDAYN1
     C***********          MOVE DLGID     OLGID
     C                     Z-ADD*ZEROS    WDAID
     C                     Z-ADD*ZEROS    WCAID
     C                     Z-ADD*ZEROS    TCHN0                           160301
     C                     Z-ADD*ZEROS    TCHR0                           160301
     C                     Z-ADD*ZEROS    RTA                             125176
      *                                                                   CRE001
      **  Initialise Balance Fields Before Outputting to Report.          CRE001
     C                     Z-ADD*ZEROS    OBAL01                          CRE001
     C**********           Z-ADD*ZEROS    OBAL02                   CRE001 125176
     C**********           Z-ADD*ZEROS    OBAL03                   CRE001 125176
      *                                                                   CRE001
      **  Initialise CHG* Fields Before Outputting to Report.             CRE001
     C                     Z-ADD*ZEROS    CHGN0                           CRE001
     C                     Z-ADD*ZEROS    CHGN1                           CRE001
     C                     Z-ADD*ZEROS    CHGN2                           CRE001
     C                     Z-ADD*ZEROS    CHGN3                           CRE001
     C*
     C**  SET UP WORK FIELD FOR OVERRIDE MESSAGE FILE
     C*
     C                     Z-ADD39        MSGLEN 155
     C*                                                                   CRE003
     C** ACCESS SDRETLPD                                                  CRE003
     C*                                                                   CRE003
     C                     CALL 'AORETLR0'                                CRE003
     C                     PARM '*MSG   ' @RTCD   7                       CRE003
     C                     PARM '*FIRST ' @OPTN   7                       CRE003
     C           SDRETL    PARM SDRETL    DSFDY                           CRE003
     C*                                                                   CRE003
     C** CHECK IF ERROR                                                   CRE003
     C*                                                                   CRE003
     C           @RTCD     IFNE *BLANK                                    CRE003
     C           *LOCK     IN   LDA                                       CRE003
     C                     Z-ADD025       DBASE            ***************CRE003
     C                     MOVE 'SDRETLPD'DBFILE           * DBERROR 025 *CRE003
     C                     MOVEL*BLANKS   DBKEY            ***************CRE003
     C                     OUT  LDA                                       CRE003
     C                     EXSR DBSR                                      CRE003
     C                     END                                            CRE003
     C**                                                                  CRE003
     C**   SET OFF W-PRINT-INDICATOR                                      CRE003
     C**                                                                  CRE003
     C                     SETOF                     69                   CRE003
     C**                                                                  CRE003
     C**   IF ACCRUAL ON CLEARED BALANCES FLAG= 'N' SET ON W-PRINT-INDICATCRE003
     C**                                                                  CRE003
     C***********BMCBAI    IFEQ 'N'                                CRE003 104618
     C           CBAI      IFEQ 'N'                                       104618
     C                     SETON                     69                   CRE003
     C                     END                                            CRE003
     C*
     C** OPEN ICD TABLE FOR RETAIL
     C*
     C                     OPEN TABTBRE
     C           1         CHAINTABTBRE              99
     C*
     C           *IN99     IFEQ '1'                        - B1
     C           RECI      ORNE 'D'
     C                     Z-ADD16        DBASE            ***************
     C                     MOVE 'TABTBRE' DBFILE           **DB ERROR 16**
     C                     MOVEL*BLANKS   DBKEY            ***************
     C                     MOVEA'0'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E1
     C*
     C** CHECK IF CHARGES FOR MULTIPLE TRANSACTION IS PRESENT
     C*
     C           CMTR      IFEQ 'Y'                        - B1
     C                     MOVE '1'       *IN88
     C                     ELSE                            - X1
     C                     MOVE '0'       *IN88
     C                     END                             - E1
     C*
     C** CHECK IF CAPITALISATION TO AN ACCOUNT IN DIFFERENT CURRENCY
     C** AND MULTIBRANCH IS PRESENT
     C*
     C           CDFC      IFEQ 'Y'                        - B1
     C                     MOVE '1'       *IN87
     C                     ELSE                            - X1
     C                     MOVE '0'       *IN87
     C                     END                             - E1
     C*
     C                     CLOSETABTBRE
     C*
     C* CHECK FOR SWISS TAXES PRESENT
     C*
     C           1         SETLLSDMMODPD
     C                     READ SDMMODPD                 99
     C           *IN99     IFEQ '1'                        - B1
     C                     Z-ADD17        DBASE            ***************
     C                     MOVEL'SDMMODPD'DBFILE           **DB ERROR 17**
     C                     MOVEL'MMOD'    DBKEY            ***************
     C                     MOVEA'0'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E1
     C*
      ** Access SAR Details File to determine if CRE001 is installed      CRE001
      *                                                                   CRE001
     C                     CALL 'AOSARDR0'                                CRE001
     C                     PARM *BLANKS   @RTCD   7                       CRE001
     C                     PARM '*VERIFY' @OPTN                           CRE001
     C                     PARM 'CRE001'  @SARD   6                       CRE001
      *                                                                   CRE001
      ** Handle Datebase Error.                                           CRE001
     C           @RTCD     IFNE *BLANK                                    CRE001
     C           @RTCD     ANDNE'*NRF   '                  ***************CRE001
     C                     MOVEL'SCSARDPD'DBFILE           **DB ERROR 26**CRE001
     C                     MOVEL@RTCD     DBKEY            ***************CRE001
     C                     Z-ADD26        DBASE                           CRE001
     C                     MOVEA'0'       *IN,89                          CRE001
     C                     EXSR DBSR                                      CRE001
     C                     GOTO ENDFST                                    CRE001
     C                     ENDIF                                          CRE001
      *                                                                   CRE001
      ** CRE001 is installed                                              CRE001
     C           @RTCD     IFEQ *BLANK                                    CRE001
     C                     MOVE 'Y'       CRE001  1                       CRE001
     C                     ELSE                                           CRE001
     C                     MOVE 'N'       CRE001                          CRE001
     C                     ENDIF                                          CRE001
      *                                                                   CRE001
     C                     EXSR MULTL
     C**
     C** Check date format
     C**
     C           DATF      COMP 'M'                      98
     C**
     C** ACCESS SAR DETAILS FILE TO DETERMINE IF BRT SAR IS INSTALLED
     C**
     C                     CALL 'AOSARDR0'
     C                     PARM '       ' @RTCD
     C                     PARM '*VERIFY' @OPTN
     C                     PARM 'S01383'  @SARD   6
     C           @RTCD     IFNE *BLANK
     C           @RTCD     ANDNE'*NRF   '                  ***************
     C                     MOVEL'SCSARDPD'DBFILE           **DB ERROR 18**
     C                     MOVEL@RTCD     DBKEY            ***************
     C                     Z-ADD18        DBASE
     C                     EXSR DBSR
     C                     GOTO ENDFST
     C                     END
     C           @RTCD     IFEQ *BLANK
     C                     MOVEL'Y'       S01383  1
     C                     END
      *                                                                                       CDL013
      ***   Check if CAR CDL013 is installed                                                  CDL013
     C                     CALL 'AOSARDR0'                                                    CDL013
     C                     PARM *BLANKS   @RTCD   7                                           CDL013
     C                     PARM '*VERIFY' @OPTN   7                                           CDL013
     C                     PARM 'CDL013'  @SARD   6                                           CDL013
      *                                                                                       CDL013
      ** If call to program fails perform standard database error                             CDL013
      ** processing                                                                           CDL013
     C           @RTCD     IFNE *BLANK                                                        CDL013
     C           @RTCD     ANDNE'*NRF   '                                                     CDL013
     C                     MOVEL'SCSARDPD'DBFILE                                              CDL013
     C                     MOVEL@RTCD     DBKEY                                               CDL013
     C                     MOVEA'1'       *IN,89                                              CDL013
     C                     Z-ADD29        DBASE                                               CDL013
     C                     EXSR DBSR                                                          CDL013
     C                     END                                                                CDL013
      *                                                                                       CDL013
      ***   CAR CDL013 is installed                                                           CDL013
     C           @RTCD     IFEQ *BLANKS                                                       CDL013
     C                     MOVE '1'       CDL013  1                                           CDL013
     C                     ENDIF                                                              CDL013
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3762CCP6                                           S01408
     C*                                                                   S01408
     C*
     C** IF BRT SAR INSTALLED
     C*
     C           S01383    IFEQ 'Y'                        B001
     C*
     C** ACCESS BRT INSTALLATION CONTROL DATA
     C*
     C                     MOVE 'D'       RECI
     C           RECI      CHAINSDBRTDD0             99
     C           *IN99     IFEQ '1'                        ***************
     C                     MOVEL'SDBRTDPD'DBFILE           **DB ERROR 19**
     C                     MOVELRECI      DBKEY            ***************
     C                     Z-ADD19        DBASE
     C                     EXSR DBSR
     C                     GOTO ENDFST
     C                     END
     C                     END                             E001
     C*
     C                     Z-ADD*ZERO     TGINT0
     C                     Z-ADD*ZERO     WKBRT   75
     C                     Z-ADD*ZERO     BRTOT0
     C                     Z-ADD*ZERO     BRTOT1 151
     C*
     C                     EXSR CCYARR
      *                                                                   CFT004
      **  Access SAR details file to see if CFT004 is installed.          CFT004
      *                                                                   CFT004
     C                     CALL 'AOSARDR0'                                CFT004
     C                     PARM *BLANKS   PRTCD   7                       CFT004
     C                     PARM '*VERIFY' POPTN   7                       CFT004
     C                     PARM 'CFT004'  PSARD   6                       CFT004
     C           SCSARD    PARM SCSARD    DSSDY                           CFT004
     C*                                                                   CFT004
     C                     MOVE 'N'       CFT004                          CFT004
     C           PRTCD     IFEQ *BLANKS                                   CFT004
     C                     MOVE 'Y'       CFT004  1                       CFT004
     C                     ENDIF                                          CFT004
      *                                                                                       CGL031
      **  Access SAR details file to see if CGL031 is installed.                              CGL031
      *                                                                                       CGL031
     C                     CALL 'AOSARDR0'                                                    CGL031
     C                     PARM *BLANKS   PRTCD                                               CGL031
     C                     PARM '*VERIFY' POPTN                                               CGL031
     C                     PARM 'CGL031'  PSARD                                               CGL031
     C           SCSARD    PARM SCSARD    DSSDY                                               CGL031
      *                                                                                       CGL031
     C                     MOVE 'N'       CGL031                                              CGL031
     C           PRTCD     IFEQ *BLANKS                                                       CGL031
     C                     MOVE 'Y'       CGL031  1                                           CGL031
     C                     ELSE                                                               CGL031
     C           PRTCD     IFNE '*NRF   '                                                     CGL031
     C*          *LOCK     IN   LDA                                                           CGL031
     C                     MOVEL'SCSARDPD'DBFILE                                              CGL031
     C                     MOVEL'CGL031 ' DBKEY                                               CGL031
     C                     Z-ADD27        DBASE                                               CGL031
     C*                    OUT  LDA                                                           CGL031
     C                     EXSR DBSR                                                          CGL031
     C                     GOTO ENDFST                                                        CGL031
     C                     ENDIF                                                              CGL031
     C                     ENDIF                                                              CGL031
     C                     Z-ADD*ZERO     EUTAX0                                              CGL031
      *                                                                                       CER016
      ** Access SAR Details File to dertermine if CER016 is installed                         CER016
      *                                                                                       CER016
     C                     CALL 'AOSARDR0'                                                    CER016
     C                     PARM *BLANKS   PRTCD                                               CER016
     C                     PARM '*VERIFY' POPTN                                               CER016
     C                     PARM 'CER016'  PSARD                                               CER016
     C           SCSARD    PARM SCSARD    DSSDY                                               CER016
      *                                                                                       CER016
      ** CER016 if installed                                                                  CER016
      *                                                                                       CER016
     C           PRTCD     IFEQ *BLANKS                                                       CER016
     C                     MOVE 'Y'       CER016  1                                           CER016
      *                                                                                       CER016
     C                     ELSE                                                               CER016
     C                     MOVE 'N'       CER016                                              CER016
     C                     ENDIF                                                              CER016
      *                                                                                       CER016
      ** Databse error                                                                        CER016
      *                                                                                       CER016
     C           PRTCD     IFNE *BLANKS                                                       CER016
     C           PRTCD     ANDNE'*NRF    '                                                    CER016
     C           *LOCK     IN   LDA                                                           CER016
     C                     MOVEL'SCSARDPD'DBFILE                                              CER016
     C                     MOVEL'CER016'  DBKEY                                               CER016
     C                     Z-ADD029       DBASE                                               CER016
     C                     OUT  LDA                                                           CER016
     C                     EXSR *PSSR                                                         CER016
      *                                                                                       CER016
     C                     ENDIF                                                              CER016
     C*
      ** Check if CER048 is enabled                                                           CER048
      *                                                                                       CER048
     C                     CALL 'AOSARDR0'                                                    CER048
     C                     PARM *BLANKS   PRTCD                                               CER048
     C                     PARM '*VERIFY' POPTN                                               CER048
     C                     PARM 'CER048'  PSARD                                               CER048
     C           SCSARD    PARM SCSARD    DSFDY                                               CER048
      *                                                                                       CER048
     C                     MOVE 'N'       CER048  1                                           CER048
      *                                                                                       CER048
     C           PRTCD     IFEQ *BLANKS                                                       CER048
      *                                                                                       CER048
     C                     MOVE 'Y'       CER048                                              CER048
     C                     ELSE                                                               CER048
     C           PRTCD     IFNE '*NRF'                                                        CER048
      *                                                                                       CER048
     C                     MOVE 'SCSARDPD'DBFILE                                              CER048
     C                     MOVE 'CER048'  DBKEY                                               CER048
     C                     MOVE 30        DBASE                                               CER048
     C                     EXSR DBSR                                                          CER048
     C                     GOTO ENDFST                                                        CER048
      *                                                                                       CER048
     C                     ENDIF                                                              CER048
      *                                                                                       CER048
     C                     ENDIF                                                              CER048
      *                                                                                       CER048
     C                     Z-ADD*ZEROS    STAX0                                               CER048
      *                                                                                       CER048
     C           ENDFST    TAG
     C*
     C                     ENDSR                           **FIRST ENDSR**
     C********************************************************************
     C/EJECT                                                              160301
      ********************************************************************160301
      **                                                                  160301
      ** GADJSR subroutine to set up adjustment details                   160301
      **                                                                  160301
     C           GADJSR    BEGSR                           ** GADJSR BEG**160301
      *                                                                   160301
     C                     Z-ADD*ZEROS    INTD0                           160301
     C                     Z-ADD*ZEROS    INTC0                           160301
      *                                                                   160301
     C           PPSTD     IFNE RUND                                      160301
     C                     Z-ADDRUND      ZDAYNO                          160301
     C                     EXSR ZDATE2                                    160301
     C                     MOVE ZADATE    PSTDO                           160301
     C                     Z-ADDRUND      PPSTD                           160301
     C                     END                                            160301
     C                     MOVE PSTDO     PSTDA                           160301
      *                                                                   160301
     C           PVALD     IFNE AHISD                                     160301
     C                     Z-ADDAHISD     ZDAYNO                          160301
     C                     EXSR ZDATE2                                    160301
     C                     MOVE ZADATE    VALDO                           160301
     C                     Z-ADDAHISD     PVALD                           160301
     C                     END                                            160301
     C                     MOVE VALDO     VALDA                           160301
      *                                                                   160301
     C                     MOVELNAR,23    NARR                            160301
      *                                                                   160301
     C           ASDCI     IFEQ 'Y'                                       160301
     C           ADAIC     ANDNE*ZEROS                                    160301
     C                     Z-ADDADAIC     INTD0                           160301
     C                     END                                            160301
      *                                                                   160301
     C           ASCCI     IFEQ 'Y'                                       160301
     C           ACAIC     ANDNE*ZEROS                                    160301
     C                     Z-SUBACAIC     INTC0                           160301
     C                     END                                            160301
      *                                                                   160301
     C                     ENDSR                           ** GADJSR END**160301
      *                                                                   160301
      ********************************************************************160301
     C/EJECT                                                              160301
      ********************************************************************160301
      **                                                                  160301
      ** #ADJ subroutine to set up generated adjustment for report        160301
      **                                                                  160301
      **     Called by     CRSR, DRSR                                     160301
      **                                                                  160301
     C           #ADJ      BEGSR                           ** #ADJ BEGSR**160301
      *                                                                   160301
     C           PPSTD     IFNE RUND                                      160301
     C                     Z-ADDRUND      ZDAYNO                          160301
     C                     EXSR ZDATE2                                    160301
     C                     MOVE ZADATE    PSTDO                           160301
     C                     Z-ADDRUND      PPSTD                           160301
     C                     END                                            160301
     C                     MOVE PSTDO     PSTDA                           160301
      *                                                                   160301
     C           PVALD     IFNE DHISD                                     160301
     C                     Z-ADDDHISD     ZDAYNO                          160301
     C                     EXSR ZDATE2                                    160301
     C                     MOVE ZADATE    VALDO                           160301
     C                     Z-ADDDHISD     PVALD                           160301
     C                     END                                            160301
     C                     MOVE VALDO     VALDA                           160301
      *                                                                   160301
     C                     MOVELNAR,23    NARR                            160301
     C                     Z-ADD@GADJ     PSTD0                           160301
     C                     MOVE *BLANK    @ADJF                           160301
      *                                                                   160301
     C                     ENDSR                                          160301
      *                                                                   160301
      ********************************************************************160301
     C/EJECT
     C********************************************************************
     C**
     C** INITPR SUBROUTINE TO INITIALIZE ALL FIELDS TO BE PRINTED
     C**
     C**     Called by       DETPR
     C**     Calls           -
     C**
     C           INITPR    BEGSR                           **INITPR BEGSR**
     C*
     C                     MOVE *BLANKS   PSTDA
     C                     MOVE *BLANKS   VALDA
     C                     MOVE *BLANKS   NARR
     C                     MOVE *BLANKS   RNARR
     C                     MOVE *BLANKS   TNARR
     C                     MOVE *BLANKS   XNARR
     C                     MOVE *BLANKS   DNARR
     C                     MOVE *BLANKS   BNARR
     C*
     C                     Z-ADD*ZEROS    PSTD0
     C                     Z-ADD*ZEROS    RATE
     C                     Z-ADD*ZEROS    DAYS
     C                     Z-ADD*ZEROS    NUMB0
     C                     Z-ADD*ZEROS    HISB0
     C                     Z-ADD*ZEROS    INTD0
     C                     Z-ADD*ZEROS    INTC0
     C                     Z-ADD*ZEROS    TINTD0
     C                     Z-ADD*ZEROS    TINTC0
     C                     Z-ADD*ZEROS    ORAT1
     C**********           Z-ADD*ZEROS    ORAT2                           125176
     C**********           Z-ADD*ZEROS    ORAT3                           125176
     C                     Z-ADD*ZEROS    OBAL01
     C**********           Z-ADD*ZEROS    OBAL02                          125176
     C**********           Z-ADD*ZEROS    OBAL03                          125176
     C                     Z-ADD*ZEROS    TGINT0
     C                     Z-ADD*ZEROS    WKBRT
     C                     Z-ADD*ZEROS    BRTOT0
     C                     Z-ADD*ZEROS    BRTOT1
     C                     Z-ADD*ZEROS    BDATE   50                      125176
     C                     Z-ADD*ZEROS    TCHN0                           160301
     C                     Z-ADD*ZEROS    TCHR0                           160301
     C                     MOVE *BLANK    @ADJF   1                       160301
     C                     Z-ADD*ZEROS    EUTAX0                                              CGL031
      *                                                                                       CER048
     C                     Z-ADD*ZEROS    STAX0                                               CER048
      *                                                                                       CER048
     C/COPY WNCPYSRC,RE3762C023
     C*
     C                     ENDSR                           **INITPR ENDSR*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** MULTL MULTILANGUAGE SUBROUTINE
     C**
     C**     Called by       FIRST, MAIN
     C**     Calls           ZA1310
     C**
     C           MULTL     BEGSR                           **MULTL BEGSR**
     C                     EXSR CLMSG
     C                     MOVEL'RES0001' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,1
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0002' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,2
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0003' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,3
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0004' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,4
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0005' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,5
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0006' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,6
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0007' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,7
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0008' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,8
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0009' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,9
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0010' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,10
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0011' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,11
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0012' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,12
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0013' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,13
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0014' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,14
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0015' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,15
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0016' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,16
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0017' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,17
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0018' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,18
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0019' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,19
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0020' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,20
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0021' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,21
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0022' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,22
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0023' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,23
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0024' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,24
     C                     MOVEL*BLANKS   MNARR
     C*
     C                     EXSR CLMSG
     C                     MOVEL'RES0025' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,25
     C                     MOVEL*BLANKS   MNARR
     C*
     C/COPY WNCPYSRC,RE3762C006
     C                     EXSR CLMSG
     C                     MOVEL'TAS0001' MSGID
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELMNARR     NAR,26
     C                     MOVEL*BLANKS   MNARR
      *                                                                   125176
     C                     EXSR CLMSG                                     125176
     C                     MOVEL'RES0033' MSGID                           125176
     C                     CALL 'ZA1310'  ZA1311                          125176
     C                     MOVELMNARR     NAR,27                          125176
     C                     MOVEL*BLANKS   MNARR                           125176
      *                                                                   125176
     C                     EXSR CLMSG                                     125176
     C                     MOVEL'RES0035' MSGID                           125176
     C                     CALL 'ZA1310'  ZA1311                          125176
     C                     MOVELMNARR     NAR,28                          125176
     C                     MOVEL*BLANKS   MNARR                           125176
      *                                                                   125176
     C                     EXSR CLMSG                                     125176
     C                     MOVEL'RES0039' MSGID                           125176
     C                     CALL 'ZA1310'  ZA1311                          125176
     C                     MOVELMNARR     NAR,29                          125176
     C                     MOVEL*BLANKS   MNARR                           125176
      *                                                                   125176
     C                     EXSR CLMSG                                     125176
     C                     MOVEL'RES0040' MSGID                           125176
     C                     CALL 'ZA1310'  ZA1311                          125176
     C                     MOVELMNARR     NAR,30                          125176
     C                     MOVEL*BLANKS   MNARR                           125176
      *                                                                   125176
     C                     EXSR CLMSG                                     125176
     C                     MOVEL'RES0041' MSGID                           125176
     C                     CALL 'ZA1310'  ZA1311                          125176
     C                     MOVELMNARR     NAR,31                          125176
     C                     MOVEL*BLANKS   MNARR                           125176
      *                                                                   125176
     C                     EXSR CLMSG                                     125176
     C                     MOVEL'RES0042' MSGID                           125176
     C                     CALL 'ZA1310'  ZA1311                          125176
     C                     MOVELMNARR     NAR,32                          125176
     C                     MOVEL*BLANKS   MNARR                           125176
      *                                                                   125176
     C                     EXSR CLMSG                                     125176
     C                     MOVEL'RES0043' MSGID                           125176
     C                     CALL 'ZA1310'  ZA1311                          125176
     C                     MOVELMNARR     NAR,33                          125176
     C                     MOVEL*BLANKS   MNARR                           125176
      *                                                                   125176
     C                     EXSR CLMSG                                     125176
     C                     MOVEL'RES0044' MSGID                           125176
     C                     CALL 'ZA1310'  ZA1311                          125176
     C                     MOVELMNARR     NAR,34                          125176
     C                     MOVEL*BLANKS   MNARR                           125176
      *                                                                   125176
     C                     EXSR CLMSG                                     125176
     C                     MOVEL'RES0045' MSGID                           125176
     C                     CALL 'ZA1310'  ZA1311                          125176
     C                     MOVELMNARR     NAR,35                          125176
     C                     MOVEL*BLANKS   MNARR                           125176
      *                                                                   125176
     C                     EXSR CLMSG                                     125176
     C                     MOVEL'RES0046' MSGID                           125176
     C                     CALL 'ZA1310'  ZA1311                          125176
     C                     MOVELMNARR     NAR,36                          125176
     C                     MOVEL*BLANKS   MNARR                           125176
     C*
      ** If CRE001 is switched ON                                         CRE001
      *                                                                   CRE001
     C           CRE001    IFEQ 'Y'                                       CRE001
      *                                                                   CRE001
     C                     EXSR CLMSG                                     CRE001
     C                     MOVEL'RES0034' MSGID                           CRE001
     C                     CALL 'ZA1310'  ZA1311                          CRE001
     C**********           MOVELMNARR     NAR,27                   CRE001 125176
     C                     MOVELMNARR     NAR,37                          125176
     C                     MOVEL*BLANKS   MNARR                           CRE001
      *                                                                   CRE001
     C                     EXSR CLMSG                                     CRE001
     C                     MOVEL'RES0033' MSGID                           CRE001
     C                     CALL 'ZA1310'  ZA1311                          CRE001
     C**********           MOVELMNARR     NAR,28                   CRE001 125176
     C                     MOVELMNARR     NAR,38                          125176
     C                     MOVEL*BLANKS   MNARR                           CRE001
      *                                                                   CRE001
     C                     EXSR CLMSG                                     CRE001
     C                     MOVEL'RES0037' MSGID                           CRE001
     C                     CALL 'ZA1310'  ZA1311                          CRE001
     C**********           MOVELMNARR     NAR,29                   CRE001 125176
     C                     MOVELMNARR     NAR,39                          125176
     C                     MOVEL*BLANKS   MNARR                           CRE001
      *                                                                   CRE001
     C                     ENDIF                                          CRE001
      *                                                                   160301
      * Retrieve 'B/F Balance for debit' narrative                        160301
     C                     EXSR CLMSG                                     160301
     C                     MOVEL'RES0051' MSGID                           160301
     C                     CALL 'ZA1310'  ZA1311                          160301
     C                     MOVELMNARR     NAR,40                          160301
     C                     MOVEL*BLANKS   MNARR                           160301
      *                                                                   160301
      * Retrieve 'B/F Balance for credit' narrative                       160301
     C                     EXSR CLMSG                                     160301
     C                     MOVEL'RES0052' MSGID                           160301
     C                     CALL 'ZA1310'  ZA1311                          160301
     C                     MOVELMNARR     NAR,41                          160301
     C                     MOVEL*BLANKS   MNARR                           160301
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3762CCP4                                           S01408
     C*                                                                   S01408
     C                     ENDSR                           **MULTL ENDSR**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** ITYPCR subroutine for interest type greater than 2
     C**
     C**     Called by       CRSR, TOTSR
     C**
     C**     Calls           ZICD
     C**
     C           ITYPCR    BEGSR                           **ITYPCR BEGSR*
      *                                                                   182452
      **  Process output changing day.                                    182452
      *                                                                   182452
     C                     Z-ADDWHISB     HISB0                           182452
     C                     EXSR OVERDC                                    182452
     C                     WRITEODAYDC                                    182452
     C*
     C**  CHECK IF END OF MONTH OR RATE CHANGE CREDIT
     C*
     C           DRECI     IFEQ 'M'                        - B1
     C           CSDAT     ANDNE*ZEROS
      *                                                                   182452
      **  Transfer Midas date into DDMMMYY                                182452
      *                                                                   182452
     C                     Z-ADDMHISD     ZDAYNO                          182452
     C                     EXSR ZDATE2                                    182452
     C                     MOVE ZADATE    VALDA                           182452
     C*
     C                     Z-ADDWHISD     ZIBEG
     C                     Z-ADDMHISD     ZIEND
     C                     Z-ADDWCRCB     ZICALC
     C*
     C                     EXSR ZICD
     C*
     C                     Z-ADDZDAYN1    DAYS
     C********** *IN80     IFEQ '1'                                       125176
     C           MNBL0     MULT DAYS      NUMB0
     C**********           ELSE                                           125176
     C********** *IN81     IFEQ '1'                                       125176
     C********** MNBL1     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** *IN82     IFEQ '1'                                       125176
     C********** MNBL2     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** MNBL3     MULT DAYS      NUMB0                           125176
     C**********           END                                            125176
     C**********           END                                            125176
     C**********           END                                            125176
     C********** NUMB0     DIV  100       NUMB0     H                     125176
     C*
     C                     Z-ADDMNBL      HISB0                           182452
     C                     MOVE *ON       *IN25                           182452
     C           MNBL      IFGT *ZEROS                     - B2
     C                     Z-ADDDINT      INTD0
     C                     EXSR OVERDC
     C                     WRITESTOTDC
     C/COPY WNCPYSRC,RE3762C168
     C                     ELSE                            - X2
     C                     Z-SUBCINT      INTC0
     C                     EXSR OVERDC
     C                     WRITESTOTDC
     C/COPY WNCPYSRC,RE3762C169
     C                     END                             - E2
     C                     MOVE *OFF      *IN25                           182452
     C*
     C                     Z-ADDMHISD     WHISD
     C                     Z-ADDMNBL      WMNBL
     C*
     C                     END                             - E1
     C*
     C           DRECI     DOWEQ'M'                        - B1
     C           *IN51     ANDEQ'0'
     C*
     C           KLIST1    READEREHISL                   51
     C*
     C           *IN51     IFNE '1'                        - B2
     C*
     C           DRECI     IFEQ 'M'                        - B3
     C           CSDAT     ANDNE*ZEROS
      *                                                                   182452
      **  Transfer Midas date into DDMMMYY                                182452
      *                                                                   182452
     C                     Z-ADDMHISD     ZDAYNO                          182452
     C                     EXSR ZDATE2                                    182452
     C                     MOVE ZADATE    VALDA                           182452
     C*
     C                     Z-ADDWHISD     ZIBEG
     C                     Z-ADDMHISD     ZIEND
     C                     Z-ADDWCRCB     ZICALC
     C*
     C                     EXSR ZICD
     C*
     C                     Z-ADDZDAYN1    DAYS
     C********** *IN80     IFEQ '1'                                       125176
     C           MNBL0     MULT DAYS      NUMB0
     C**********           ELSE                                           125176
     C********** *IN81     IFEQ '1'                                       125176
     C********** MNBL1     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** *IN82     IFEQ '1'                                       125176
     C********** MNBL2     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** MNBL3     MULT DAYS      NUMB0                           125176
     C**********           END                                            125176
     C**********           END                                            125176
     C**********           END                                            125176
     C********** NUMB0     DIV  100       NUMB0     H                     125176
     C*
     C                     Z-ADDMNBL      HISB0                           182452
     C                     MOVE *ON       *IN25                           182452
     C           MNBL      IFGT *ZEROS                     - B4
     C                     Z-ADDDINT      INTD0
     C                     EXSR OVERDC
     C                     WRITESTOTDC
     C/COPY WNCPYSRC,RE3762C170
     C                     ELSE                            - X4
     C                     Z-SUBCINT      INTC0
     C                     EXSR OVERDC
     C                     WRITESTOTDC
     C/COPY WNCPYSRC,RE3762C171
     C                     END                             - E4
     C                     MOVE *OFF      *IN25                           182452
     C*
     C                     Z-ADDMHISD     WHISD
     C                     Z-ADDMNBL      WMNBL
     C*
     C                     ELSE                            - X3
     C*
     C           DRECI     IFEQ 'S'                        - B4
     C***********SCICI     ANDEQ'Y'                                      098818
     C           SCICI     ANDNE*BLANKS                                  098818
     C*
     C                     Z-ADDWHISD     ZIBEG
     C                     Z-ADDDHISD     ZIEND
     C                     Z-ADDWCRCB     ZICALC
     C*
     C                     EXSR ZICD
     C*
     C                     Z-ADDZDAYN1    DAYS
     C********** *IN80     IFEQ '1'                                       125176
     C           SMNBL0    MULT DAYS      NUMB0
     C**********           ELSE                                           125176
     C********** *IN81     IFEQ '1'                                       125176
     C********** SMNBL1    MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** *IN82     IFEQ '1'                                       125176
     C********** SMNBL2    MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** SMNBL3    MULT DAYS      NUMB0                           125176
     C**********           END                                            125176
     C**********           END                                            125176
     C**********           END                                            125176
     C********** NUMB0     DIV  100       NUMB0     H                     125176
     C*
     C                     Z-ADDWHISB     HISB0                           182452
     C                     MOVE *ON       *IN25                           182452
     C           SMNBL     IFGT *ZEROS                     - B5
     C                     Z-ADDDINT      INTD0
     C                     ELSE                            - X5
     C                     Z-SUBCINT      INTC0
     C                     EXSR OVERDC
     C                     WRITESTOTDC
     C/COPY WNCPYSRC,RE3762C172
     C                     END                             - E5
     C                     MOVE *OFF      *IN25                           182452
     C*
     C                     Z-ADDDHISD     WHISD
     C*
     C                     END                             - E4
     C*
     C                     END                             - E3
     C*
     C                     END                             - E2
     C*
     C                     END                             - E1
     C*
     C                     ENDSR                           **ITYPCR ENDSR*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** ITYPDR subroutine for interest type greater than 2
     C**
     C**     Called by       DRSR; TOTSR
     C**
     C**     Calls           ZICD
     C**
     C           ITYPDR    BEGSR                           **ITYPDR BEGSR*
      *                                                                   182452
      **  Process output changing day.                                    182452
      *                                                                   182452
     C                     Z-ADDWHISB     HISB0                           182452
     C                     EXSR OVERDC                                    182452
     C                     WRITEODAYDC                                    182452
     C*
     C**  CHECK IF END OF MONTH OR DEBIT RATE CHANGE
     C*
     C           DRECI     IFEQ 'M'                        - B1
     C           DSDAT     ANDNE*ZEROS
      *                                                                   182452
      **  Transfer Midas date into DDMMMYY                                182452
      *                                                                   182452
     C                     Z-ADDMHISD     ZDAYNO                          182452
     C                     EXSR ZDATE2                                    182452
     C                     MOVE ZADATE    VALDA                           182452
     C*
     C                     Z-ADDWHISD     ZIBEG
     C                     Z-ADDMHISD     ZIEND
     C                     Z-ADDWDRCB     ZICALC
     C*
     C                     EXSR ZICD
     C*
     C                     Z-ADDZDAYN1    DAYS
     C********** *IN80     IFEQ '1'                                       125176
     C           MNBL0     MULT DAYS      NUMB0
     C**********           ELSE                                           125176
     C********** *IN81     IFEQ '1'                                       125176
     C********** MNBL1     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** *IN82     IFEQ '1'                                       125176
     C********** MNBL2     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** MNBL3     MULT DAYS      NUMB0                           125176
     C**********           END                                            125176
     C**********           END                                            125176
     C**********           END                                            125176
     C********** NUMB0     DIV  100       NUMB0     H                     125176
     C*
     C           MNBL      IFGT *ZEROS                     - B2
     C                     Z-ADDDINT      INTD0
     C                     ELSE                            - X2
     C                     Z-SUBCINT      INTC0
     C                     ENDIF                                          182452
     C                     Z-ADDMNBL      HISB0                           182452
     C                     MOVE *ON       *IN25                           182452
     C                     EXSR OVERDC
     C                     WRITESTOTDC
     C                     MOVE *OFF      *IN25                           182452
     C/COPY WNCPYSRC,RE3762C173
     C**********           END                             - E2           182452
     C*
     C                     Z-ADDMHISD     WHISD
     C                     Z-ADDMNBL      WMNBL
     C*
     C                     END                             - E1
     C*
     C           DRECI     DOWEQ'M'                        - B1
     C           *IN51     ANDEQ'0'
     C*
     C           KLIST1    READEREHISL                   51
     C*
     C           *IN51     IFNE '1'                        - B2
     C*
     C           DRECI     IFEQ 'M'                        - B3
     C           DSDAT     ANDNE*ZEROS
      *                                                                   182452
      **  Transfer Midas date into DDMMMYY                                182452
      *                                                                   182452
     C                     Z-ADDMHISD     ZDAYNO                          182452
     C                     EXSR ZDATE2                                    182452
     C                     MOVE ZADATE    VALDA                           182452
     C*
     C                     Z-ADDWHISD     ZIBEG
     C                     Z-ADDMHISD     ZIEND
     C                     Z-ADDWDRCB     ZICALC
     C*
     C                     EXSR ZICD
     C*
     C                     Z-ADDZDAYN1    DAYS
     C********** *IN80     IFEQ '1'                                       125176
     C           MNBL0     MULT DAYS      NUMB0
     C**********           ELSE                                           125176
     C********** *IN81     IFEQ '1'                                       125176
     C********** MNBL1     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** *IN82     IFEQ '1'                                       125176
     C********** MNBL2     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** MNBL3     MULT DAYS      NUMB0                           125176
     C**********           END                                            125176
     C**********           END                                            125176
     C**********           END                                            125176
     C********** NUMB0     DIV  100       NUMB0     H                     125176
     C*
     C                     Z-ADDMNBL      HISB0                           182452
     C                     MOVE *ON       *IN25                           182452
     C           MNBL      IFGT *ZEROS                     - B4
     C                     Z-ADDDINT      INTD0
     C                     EXSR OVERDC
     C                     WRITESTOTDC
     C/COPY WNCPYSRC,RE3762C174
     C                     ELSE                            - X4
     C                     Z-SUBCINT      INTC0
     C                     EXSR OVERDC
     C                     WRITESTOTDC
     C/COPY WNCPYSRC,RE3762C175
     C                     END                             - E4
     C                     MOVE *OFF      *IN25                           182452
     C*
     C                     Z-ADDMHISD     WHISD
     C                     Z-ADDMNBL      WMNBL
     C*
     C                     ELSE                            - X3
     C*
     C           DRECI     IFEQ 'S'                        - B4
     C***********SDICI     ANDEQ'Y'                                      098818
     C           SDICI     ANDNE*BLANKS                                  098818
     C*
     C                     Z-ADDWHISD     ZIBEG
     C                     Z-ADDDHISD     ZIEND
     C                     Z-ADDWDRCB     ZICALC
     C*
     C                     EXSR ZICD
     C*
     C                     Z-ADDZDAYN1    DAYS
     C********** *IN80     IFEQ '1'                                       125176
     C           SMNBL0    MULT DAYS      NUMB0
     C**********           ELSE                                           125176
     C********** *IN81     IFEQ '1'                                       125176
     C********** SMNBL1    MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** *IN82     IFEQ '1'                                       125176
     C********** SMNBL2    MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** SMNBL3    MULT DAYS      NUMB0                           125176
     C**********           END                                            125176
     C**********           END                                            125176
     C**********           END                                            125176
     C********** NUMB0     DIV  100       NUMB0     H                     125176
     C*
     C                     Z-ADDWHISB     HISB0                           182452
     C                     MOVE *ON       *IN25                           182452
     C           SMNBL     IFGT *ZEROS                     - B5
     C                     Z-ADDDINT      INTD0
     C                     EXSR OVERDC
     C                     WRITESTOTDC
     C/COPY WNCPYSRC,RE3762C176
     C                     ELSE                                           182452
     C                     Z-SUBCINT      INTC0
     C                     EXSR OVERDC
     C                     WRITESTOTDC
     C/COPY WNCPYSRC,RE3762C177
     C                     END                             - E5
     C                     MOVE *OFF      *IN25                           182452
     C*
     C                     Z-ADDDHISD     WHISD
     C*
     C                     END                             - E4
     C*
     C                     END                             - E3
     C*
     C                     END                             - E2
     C*
     C                     END                             - E1
     C*
     C                     ENDSR                           **ITYPDR ENDSR*
     C********************************************************************
     C/EJECT                                                              160301
     C********************************************************************160301
     C**                                                                  160301
     C** MADJSR  subroutine to report manual adjustments                  160301
     C**                                                                  160301
     C**     Called by       BOTHSR, CRSR, DRSR                           160301
     C**                                                                  160301
     C           MADJSR    BEGSR                           **MADJSR BEG** 160301
      *                                                                   160301
     C                     MOVE *BLANKS   PSTDA                           160301
     C                     MOVELNAR,29    NARR                            160301
     C                     Z-ADDDMADI     INTD0                           160301
     C                     Z-SUBDMACI     INTC0                           160301
     C                     EXSR OVERDC                                    160301
     C                     WRITEMADJDC                                    160301
     C/COPY WNCPYSRC,RE3762C178
      *                                                                   160301
     C                     ENDSR                           **MADJSR ENDSR*160301
     C********************************************************************160301
     C/EJECT
     C********************************************************************
     C**
     C** MAIN subroutine to execute main processing.
     C**
     C**     Called by       S T A R T
     C**
     C**     Calls           DETPR
     C**
     C           MAIN      BEGSR                           **MAIN BEGSR**
     C*
     C           *INLR     IFEQ '1'
     C                     GOTO END
     C                     END
     C*
     C** ACCESS RECAPM SEQUENTIALY
     C*
     C                     READ RECAPML                  LR
     C*
     C**  Call ZSFILE for initial OPEN
     C*
     C           *INLR     IFNE '1'
     C**********           SETON                     85                   125176
     C                     OPEN RE3764DC
     C                     Z-ADDSFNUM     ZSNUM
     C                     OUT  LDA
     C                     CALL 'ZSFILE'
     C                     PARM           SEQ
     C                     PARM CBRCA     SENTY
     C                     PARM           SFILE
     C                     PARM           ZSNUM   60
     C                     PARM           ZSERR   1
     C           *LOCK     IN   LDA
     C*
     C           ZSERR     IFEQ 'Y'
     C** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM
     C** DBASE, DBFILE AND DBKEY SET WITHIN ZSFILE
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     RETRN
     C                     END
     C*
     C                     OPEN RE3765CH
     C                     Z-ADDSFNUM1    ZSNUM1
     C                     OUT  LDA
     C                     CALL 'ZSFILE'
     C                     PARM           SEQ
     C                     PARM CBRCA     SENTY
     C                     PARM           SFILE1
     C                     PARM           ZSNUM1  60
     C                     PARM           ZSERR   1
     C           *LOCK     IN   LDA
     C*
     C           ZSERR     IFEQ 'Y'
     C** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM
     C** DBASE, DBFILE AND DBKEY SET WITHIN ZSFILE
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     RETRN
     C                     END
     C/COPY WNCPYSRC,RE3762C179
     C*
     C                     END
     C**
     C*
     C**  SAVE KEY TO CHECK BREAK
     C*
     C                     MOVE RKEY      OKEY
     C*
     C**  EXECUTE UNTIL EOF RECAPM
     C*
     C           *INLR     DOWEQ'0'                        - B1
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3762CCP7                                           S01408
     C*                                                                   S01408
     C*
     C**  TEST FOR MULTIBRANCH OUTPUT
     C*
     C           OBRCA     IFNE CBRCA
     C                     CLOSERE3764DC
     C                     CLOSERE3765CH
     C**********           SETON                     85                   125176
     C                     OPEN RE3764DC
     C                     Z-ADDSFNUM     ZSNUM
     C                     OUT  LDA
     C                     CALL 'ZSFILE'
     C                     PARM           SEQ
     C                     PARM CBRCA     SENTY
     C                     PARM           SFILE
     C                     PARM           ZSNUM   60
     C                     PARM           ZSERR   1
     C           *LOCK     IN   LDA
     C*
     C           ZSERR     IFEQ 'Y'
     C** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM
     C** DBASE, DBFILE AND DBKEY SET WITHIN ZSFILE
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     RETRN
     C                     END
     C*
     C                     OPEN RE3765CH
     C                     Z-ADDSFNUM1    ZSNUM1
     C                     OUT  LDA
     C                     CALL 'ZSFILE'
     C                     PARM           SEQ
     C                     PARM CBRCA     SENTY
     C                     PARM           SFILE1
     C                     PARM           ZSNUM1  60
     C                     PARM           ZSERR   1
     C           *LOCK     IN   LDA
     C*
     C           ZSERR     IFEQ 'Y'
     C** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM
     C** DBASE, DBFILE AND DBKEY SET WITHIN ZSFILE
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     RETRN
     C                     END
     C/COPY WNCPYSRC,RE3762C180
     C**
     C*    ACCESS BRANCH DETAILS
     C**
     C** GET BRANCH NAME, ONLY WHEN MBIN = 'Y'
     C**
     C           MBIN      IFEQ 'Y'
     C*
     C**********           CALL 'AOBRCHR0'                                                    CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM CBRCA     @DSNB   3
     C**********           PARM           SDBRCH                                              CGL029
     C                     PARM           DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS
     C                     MOVEL@DSNB     DBKEY
     C                     MOVEL'SDBRCHPD'DBFILE           ***************
     C                     Z-ADD20        DBASE            **DB ERROR 20**
     C                     EXSR DBSR                       ***************
     C                     EXSR *PSSR
     C                     END
     C*
     C                     END
     C*
     C***U8******          GOTO END                                       105294
     C                     END
     C*
     C                     EXSR PRNO
     C           PRYES     IFEQ 'Y'                        - B2
     C*
     C**  CHECK IF IT IS THE SAME ACCOUNT
     C*
     C           RKEY      IFNE OKEY                       - B3
     C                     Z-ADD1         PAGN
     C                     Z-ADD1         PAGA
     C/COPY WNCPYSRC,RE3762C181
     C                     MOVE RKEY      OKEY
     C*****************************************************************
     C** Multilanguage processing is currently not in use.
     C** Codings are asterisked but retained for future incorp.
     C*
     C** PROCESS FOR MULTILANGUAGE
     C*
     C***********LGID      IFEQ *BLANKS                    - B4
     C***********LGID      OREQ '00'
     C***********          MOVE DLGID     LGID
     C***********          END                             - E4
     C***********
     C***********LGID      IFNE OLGID                      - B4
     C*
     C*
     C**  DEFINE MESSAGE FILE
     C*
     C                     MOVE CMD,1     CMD1
     C***********          MOVELOLGID     FILT1
     C***********          MOVELLGID      FILT2
     C***********          CALL 'QCMDEXC'
     C***********          PARM           CMD1
     C***********          PARM           MSGLEN
     C*
     C***********          MOVE LGID      OLGID
     C***********          EXSR MULTL
     C*
     C***********          END                             - E4
     C*****************************************************************
     C*
     C                     END                             - E3
     C*
     C/COPY WNCPYSRC,RE3762C025
     C                     EXSR DETPR
     C***********          SETOF                     U7U8                 105294
     C*
     C** NUMBER OF PROCESSED RECORDS
     C*
     C                     ADD  1         NBRREC
     C/COPY WNCPYSRC,RE3762C026
     C*
     C                     END                             - E2
     C*
     C* RESET OVERFLOW INDICATOR AT CHANGE OF ACCOUNT
     C*
     C                     MOVEA'00'      *IN,73
     C                     MOVE '0'       *IN51
     C                     Z-ADD*ZEROS    WDAID
     C                     Z-ADD*ZEROS    WCAID
     C                     READ RECAPML                  LR
     C                     END                             - E1
     C*
     C           END       TAG
     C                     ENDSR                           **MAIN ENDSR**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** PRNO   subroutine TO DECIDE IF RECORD TO PRINT OR NO
     C**
     C**
     C**     Called by       START
     C**
     C**     Calls           -
     C**
     C           PRNO      BEGSR                           **PRNO   BEGSR*
     C*
     C                     MOVE 'N'       PRYES
     C                     MOVE '0'       *IN70
     C*
     C*  FOR MANAGEMENT OR DEMAND PRINT
     C*
     C           CDICI     IFEQ 'M'                        - B1
     C           CCICI     OREQ 'M'
     C           CDICI     OREQ 'D'
     C           CCICI     OREQ 'D'
     C                     MOVE 'Y'       PRYES   1
     C                     END                             - E1
     C           CDICI     IFEQ 'M'                        - B1
     C           CCICI     OREQ 'M'
     C                     MOVE '1'       *IN70
     C/COPY WNCPYSRC,RE3762C015
     C                     END                             - E1
     C*
     C*  ACCESS RECOM FOR COMMISSION DETAILS
     C*
     C           KLIST0    CHAINRECOM                99
     C           *IN99     IFEQ '1'                        *****************
     C                     Z-ADD21        DBASE            ** DB ERROR 21 **
     C                     MOVE 'RECOM  ' DBFILE           *****************
     C                     MOVELRKEY      DBKEY
     C                     EXSR DBSR
     C                     END
     C           CDICI     IFEQ 'C'
     C           CDICI     OREQ ' '
     C                     Z-ADD*ZERO     FXDC
     C                     END
     C           CDICA     SUB  CCDIC     CDICA
     C           ACCC      SUB  CACCC     ACCC
     C           CHDBC     SUB  CCHDBC    CHDBC
     C           CMBC      SUB  CCMBC     CMBC
     C*
     C*  IF CAPITALISATION OCCURS AT LEAST ONE AMOUNT MUST BE DIFFERENT
     C*  OF ZERO TO BE PRINTED.
     C*
     C           CDICI     IFNE ' '                        - B1
     C           CDAIC     IFNE *ZERO                      - B2
     C           CPMADI    ORNE *ZERO
     C           CTMADI    ORNE *ZERO
     C           CDMINT    ORNE *ZERO
     C           CSGADI    ORNE *ZERO
     C           FXDC      ORNE *ZERO
     C           ACCC      ORNE *ZERO
     C           CHDBC     ORNE *ZERO
     C           CMBC      ORNE *ZERO
     C           CDICA     ORNE *ZERO
     C                     MOVE 'Y'       PRYES   1
     C                     END                             - E2
     C                     END                             - E1
     C*
     C           CCICI     IFNE ' '                        - B1
     C           CCAIC     IFNE *ZERO
     C           CPMACI    ORNE *ZERO
     C           CTMACI    ORNE *ZERO
     C           CCMINT    ORNE *ZERO
     C           CSGACI    ORNE *ZERO
     C           CCHGP     ORNE *ZERO
     C                     MOVE 'Y'       PRYES   1
     C                     END                             - E2
     C                     END                             - E1
     C*
     C** ALWAYS PRINTED
     C*
     C                     MOVE 'Y'       PRYES   1
     C                     ENDSR                           **NOPR   ENDSR*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** OPENCR subroutine for credit output - opening balance and
     C**                                       opening rate
     C**
     C**     Called by       B1LT, B1GT
     C**
     C**     Calls           DBSR
     C**
     C           OPENCR    BEGSR                           **OPENCR BEGSR*
     C*
     C**********           Z-ADDW2STBL    HISB0                           125176
     C                     Z-ADDCOHISB    HISB0                           125176
     C*
     C                     EXSR CLMSG
     C**********           MOVELNAR,15    TNARR                           125176
     C                     MOVELNAR,16    TNARR                           125176
     C*
     C           PVALD     IFNE CLCID                      - B1
     C                     Z-ADDCLCID     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALDO
     C*
     C                     Z-ADDCLCID     PVALD
     C*
     C                     END                             - E1
     C*
     C                     MOVE VALDO     VALDA
     C*
     C**  OUTPUT OPENING BALANCE
     C*
     C                     EXSR OVERDC
     C                     WRITETITLEDC
     C/COPY WNCPYSRC,RE3762C182
     C*
     C                     MOVE *BLANKS   VALDA
     C                     MOVE *BLANKS   PSTDA
     C*
     C                     EXSR CLMSG
     C                     MOVELNAR,8     RNARR
     C**********           Z-ADDCRIR      RATE                            125176
     C*
      * Access REHRCJ (REHPOSR1 REHPOSR2 REHPOSR3) for CR opening rate    125176
     C           KLIST3    SETLLREHRCJ                                    125176
     C           KLIST1    REDPEREHRCJ                   60               125176
      *                                                                   125176
     C           *IN60     IFEQ '1'                                       125176
     C           BDATE     ANDEQCLCID                                     125176
     C           KLIST3    SETLLREHRCJ                                    125176
     C           KLIST3    READEREHRCJ                   60               125176
     C                     END                                            125176
      *                                                                   125176
     C           *IN60     IFEQ '1'                                       125176
     C                     Z-ADD*ZEROS    CRIR                            125176
     C                     Z-ADD*ZEROS    INTP                            125176
     C                     Z-ADD*ZEROS    INST                            125176
     C                     Z-ADD*ZEROS    INRT                            125176
     C                     END                                            125176
     C*
     C**  OUTPUT OPENING RATE
     C*
     C**********           EXSR OVERDC                                    125176
     C**********           WRITERATEDC                                    125176
      *                                                                   125176
      * Change narrative 'rate change to' to 'opening rate'               125176
     C                     MOVE 'Y'       OPN                             125176
     C                     EXSR RCRSR                                     125176
     C                     MOVE ' '       OPN                             125176
     C*
      ***If*CRE001*is*switched*ON,*then*output*'Overdraft Limit'** CRE001 180892
      **********                                                   CRE001 180892
     C********** CRE001    IFEQ 'Y'                                CRE001 180892
     C**********           EXSR CLMSG                              CRE001 180892
     C**********           MOVELNAR,28    ONARR                    CRE001 125176
     C**********           MOVELNAR,38    ONARR                    125176 180892
     C**********           MOVE ODRL      OODRL                    CRE001 180892
     C**********           EXSR OVERDC                             CRE001 180892
     C**********           WRITEODLNDC                             CRE001 180892
     C**********           ENDIF                                   CRE001 180892
      **********                                                   CRE001 180892
     C                     ENDSR                           **OPENCR ENDSR*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** OPENDR subroutine for debit output - opening balance and
     C**                                      opening rate
     C**
     C**     Called by       B1LT, B1GT
     C**
     C**     Calls           DBSR
     C**
     C           OPENDR    BEGSR                           **OPENDR BEGSR*
     C*
     C**********           Z-ADDW1STBL    HISB0                           125176
     C                     Z-ADDDOHISB    HISB0                           125176
     C*
     C                     EXSR CLMSG
     C**********           MOVELNAR,16    TNARR                           125176
     C                     MOVELNAR,15    TNARR                           125176
     C*
     C           PVALD     IFNE CLDID                      - B1
     C                     Z-ADDCLDID     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALDO
     C*
     C                     Z-ADDCLDID     PVALD
     C*
     C                     END                             - E1
     C*
     C                     MOVE VALDO     VALDA
     C*
     C**  OUTPUT OPENING BALANCE
     C*
     C                     EXSR OVERDC
     C                     WRITETITLEDC
     C/COPY WNCPYSRC,RE3762C183
     C*
     C                     MOVE *BLANKS   VALDA
     C                     MOVE *BLANKS   PSTDA
     C*
     C                     EXSR CLMSG
     C                     MOVELNAR,3     RNARR
     C**********           Z-ADDDRIR      RATE                            125176
     C*
      * Access REHRDJ (REHPOSR1 REHPOSR2 REHPOSR3) for DR opening rate    125176
     C           KLIST2    SETLLREHRDJ                                    125176
     C           KLIST1    REDPEREHRDJ                   60               125176
      *                                                                   125176
     C           *IN60     IFEQ '1'                                       125176
     C           BDATE     ANDEQCLDID                                     125176
     C           KLIST2    SETLLREHRDJ                                    125176
     C           KLIST2    READEREHRDJ                   60               125176
     C                     END                                            125176
      *                                                                   125176
     C           *IN60     IFEQ '1'                                       125176
     C                     Z-ADD*ZEROS    DRIR                            125176
     C                     Z-ADD*ZEROS    INTP                            125176
     C                     Z-ADD*ZEROS    INST                            125176
     C                     Z-ADD*ZEROS    INRT                            125176
     C                     END                                            125176
     C*
     C**  OUTPUT OPENING RATE
     C*
     C***********          EXSR OVERDC                                    125176
     C***********          WRITERATEDC                                    125176
      *                                                                   125176
      * Change narrative 'rate change to' to 'opening rate'               125176
     C                     MOVE 'Y'       OPN     1                       125176
     C                     EXSR RDRSR                                     125176
     C                     MOVE ' '       OPN     1                       125176
     C*
      ** If CRE001 is switched ON, then output 'Overdraft Limit'          180892
      *                                                                   180892
     C           CRE001    IFEQ 'Y'                                       180892
     C                     EXSR CLMSG                                     180892
     C                     MOVELNAR,38    ONARR                           180892
     C                     MOVE ODRL      OODRL                           180892
     C                     EXSR OVERDC                                    180892
     C                     WRITEODLNDC                                    180892
     C                     ENDIF                                          180892
      *                                                                   180892
     C                     ENDSR                           **OPENDR ENDSR*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** OVERDC subroutine for processing overflow on RE3764DC
     C**
     C**     Called by       CRSR, DRSR, POSTSR
     C**
     C**     Calls           -
     C**
     C           OVERDC    BEGSR                           **OVERDC BEGSR*
     C/COPY WNCPYSRC,RE3762C016
     C*
     C**  CHECK IF OVERFLOW ON RE3764DR
     C*
     C           *IN73     IFEQ '1'                        - B1
     C                     ADD  1         PAGA
     C                     MOVE WACNO     ACNO
     C                     MOVE '0'       *IN65
     C           ACNO      IFNE *ZEROS
     C                     MOVE '1'       *IN65
     C                     END
     C                     WRITEHEADDC
     C                     MOVE '0'       *IN73
     C                     END                             - E1
     C*
     C* CHARGE REPORT IF NECESSARY
     C*
     C           *IN74     IFEQ '1'                        - B1
     C           CCICI     IFNE *BLANK
     C           CCHGP     ANDNE*ZERO
     C                     Z-ADDCHACNO    ACNO
     C                     ADD  1         PAGN
     C                     WRITEHEADCH
     C                     MOVE '0'       *IN74
     C                     END
     C                     END                             - E1
     C*
     C                     ENDSR                           **OVERDC ENDSR*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** POSTSR subroutine for posting output
     C**
     C**     Called by       BOTHSR, B1EQ, B1LT, B1GT
     C**
     C**     Calls           DBSR, OVERDC
     C**
     C           POSTSR    BEGSR                           **POSTSR BEGSR*
     C*
     C           PPSTD     IFNE PSTD                       - B1
     C                     Z-ADDPSTD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    PSTDO
     C*
     C                     Z-ADDPSTD      PPSTD
     C*
     C                     END                             - E1
     C*
     C                     MOVE PSTDO     PSTDA
     C*
     C           PVALD     IFNE HISD                       - B1
     C                     Z-ADDHISD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALDO
     C*
     C                     Z-ADDHISD      PVALD
     C*
     C                     END                             - E1
     C*
     C                     MOVE VALDO     VALDA
     C*
     C                     MOVELPNAR      NARR
     C*
     C           DRCR      IFEQ 0                          - B1
     C                     Z-ADDPSTA      PSTD0
     C                     ELSE                            - X1
     C                     Z-SUBPSTA      PSTD0
     C                     END                             - E1
     C*
     C**  OUTPUT POSTING FOR DEBIT AND CREDIT
     C*
     C                     EXSR OVERDC
     C                     WRITEPOSTDC
     C/COPY WNCPYSRC,RE3762C044
     C*
     C* CHARGE REPORT IF NECESSARY
     C*
     C           CCICI     IFNE *BLANK
     C           CHGA      ANDNE*ZERO
     C           CCHGP     ANDNE*ZERO
     C           @CHGF     ANDEQ'Y'                                       160301
     C           REBI      IFEQ 'Y'
     C***********          MOVELMSG,1     CHREBI                          114487
     C***********          ELSE                                           114487
     C***********          MOVELMSG,2     CHREBI                          114487
     C***********          END                                            114487
     C                     Z-ADDCHGA      CHGR0                           125176
     C                     Z-ADD*ZERO     CHGN0                           114487
     C                     ADD  CHGA      TCHR0                           160301
     C                     ELSE                                           114487
     C                     Z-ADDCHGA      CHGN0                           114487
     C                     Z-ADD*ZERO     CHGR0                           114487
     C                     ADD  CHGA      TCHN0                           160301
     C                     END                                            114487
     C**********           Z-ADDCHGA      CHGR0                           125176
     C           NITMS     IFEQ *ZEROS
     C                     Z-ADD1         SNITMS
     C                     ELSE
     C                     Z-ADDNITMS     SNITMS
     C                     END
     C                     EXSR OVERDC                                    160301
     C                     WRITEPOSTCH
     C/COPY WNCPYSRC,RE3762C184
     C                     END
      *                                                                   160301
     C                     MOVE *BLANK    @CHGF   1                       160301
     C*
     C                     ENDSR                           **POSTSR ENDSR*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** RATEC subroutine to prepare and output credit rate change
     C**
     C**     Called by       CRSR, RATESR
     C**
     C**     Calls           DBSR, RCRSR
     C**
     C           RATEC     BEGSR                           **RATEC BEGSR**
     C*
     C**  ACCESS REHRCJ (REHPOSR1 REHPOSR2 REHPOSR3) WHICH CONTAINS
     C**  THE GOOD DATES FOR CREDIT RATE CHANGE TO
     C*
     C********** KLIST6    CHAINREHRCJ               60                   125176
     C           KLIST6    SETLLREHRCJ                   60               125176
     C           KLIST6    READEREHRCJ                   60               125176
     C*
     C           *IN60     IFEQ '1'                        - B1
     C                     Z-ADDDCRCD     WDATE
     C                     Z-ADD22        DBASE
     C                     MOVE 'REHRCJ'  DBFILE           ***************
     C                     MOVELRKEY2     DBKEY            **DB ERROR 22**
     C                     MOVEA'1'       *IN,89           ***************
     C                     EXSR DBSR
     C                     END                             - E1
     C*
     C**  TRANSFER DATE MIDAS INTO DDMMMYY
     C*
     C           PVALD     IFNE RVALD                      - B1
     C                     Z-ADDRVALD     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALDO
     C*
     C                     Z-ADDRVALD     PVALD
     C*
     C                     END                             - E1
     C*
     C**  TRANSFER DATE MIDAS INTO DDMMMYY
     C*
     C           PPSTD     IFNE RPSTD                      - B1
     C                     Z-ADDRPSTD     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    PSTDO
     C*
     C                     Z-ADDRPSTD     PPSTD
     C*
     C                     END                             - E1
     C*
     C**  PREPARE DEBIT RATE CHANGE TO OUTPUT
     C*
     C                     MOVE PSTDO     PSTDA
     C                     MOVE VALDO     VALDA
     C*
     C                     EXSR CLMSG
     C                     MOVELNAR,9     RNARR
     C*
     C**  OUTPUT DEBIT RATE CHANGE TO
     C*
     C                     EXSR RCRSR
     C*
      ***If*CRE001*is*switched*ON,*Output*Additional*Overdraft*RateCRE001 180892
      **********                                                   CRE001 180892
     C********** CRE001    IFEQ 'Y'                                CRE001 180892
     C**********           EXSR CLMSG                              CRE001 180892
     C**********           MOVELNAR,27    ONARR                    CRE001 125176
     C**********           MOVELNAR,37    ONARR                    125176 180892
     C**********           MOVE AODR      OAODR                    CRE001 180892
     C**********           EXSR OVERDC                             CRE001 180892
     C**********           WRITEAODRDC                             CRE001 180892
     C**********           ENDIF                                   CRE001 180892
      **********                                                   CRE001 180892
     C                     ENDSR                           **RATEC ENDSR**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** RATED subroutine to prepare and output debit rate change
     C**
     C**     Called by       DRSR, RATESR
     C**
     C**     Calls           DBSR, RDRSR
     C**
     C           RATED     BEGSR                           **RATED BEGSR**
     C*
     C**  ACCESS REHRDJ (REHPOSR1 REHPOSR2 REHPOSR3) WHICH CONTAINS
     C**  THE GOOD DATES FOR DEBIT RATE CHANGE TO
     C*
     C********** KLIST5    CHAINREHRDJ               60                   125176
     C           KLIST5    SETLLREHRDJ                   60               125176
     C           KLIST5    READEREHRDJ                   60               125176
     C*
     C           *IN60     IFEQ '1'                        - B1
     C                     Z-ADDDDRCD     WDATE
     C                     Z-ADD23        DBASE
     C                     MOVE 'REHRDJ'  DBFILE           ***************
     C                     MOVELRKEY2     DBKEY            **DB ERROR 23**
     C                     MOVEA'1'       *IN,89           ***************
     C                     EXSR DBSR
     C                     END                             - E1
     C*
     C**  TRANSFER DATE MIDAS INTO DDMMMYY
     C*
     C           PVALD     IFNE RVALD                      - B1
     C                     Z-ADDRVALD     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALDO
     C*
     C                     Z-ADDRVALD     PVALD
     C*
     C                     END                             - E1
     C*
     C**  TRANSFER DATE MIDAS INTO DDMMMYY
     C*
     C           PPSTD     IFNE RPSTD                      - B1
     C                     Z-ADDRPSTD     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    PSTDO
     C*
     C                     Z-ADDRPSTD     PPSTD
     C*
     C                     END                             - E1
     C*
     C**  PREPARE DEBIT RATE CHANGE TO OUTPUT
     C*
     C                     MOVE PSTDO     PSTDA
     C                     MOVE VALDO     VALDA
     C*
     C                     EXSR CLMSG
     C                     MOVELNAR,4     RNARR
     C*
     C**  OUTPUT DEBIT RATE CHANGE TO
     C*
     C                     EXSR RDRSR
     C*
      ** If CRE001 is switched ON, Output Additional Overdraft Rate       180892
      *                                                                   180892
     C           CRE001    IFEQ 'Y'                                       180892
     C                     EXSR CLMSG                                     180892
     C                     MOVELNAR,37    ONARR                           180892
     C                     MOVE AODR      OAODR                           180892
     C                     EXSR OVERDC                                    180892
     C                     WRITEAODRDC                                    180892
     C                     ENDIF                                          180892
      *                                                                   180892
     C                     ENDSR                           **RATED ENDSR**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** RATESR subroutine for debit and credit rate change
     C**
     C**     Called by       B O T H S R
     C**
     C**     Calls           RATEC,RATED
     C**
     C           RATESR    BEGSR                           **RATESR BEGSR*
     C*
     C                     Z-ADDDHISD     WWHISD
     C*
     C           DDRCI     IFEQ 'Y'                        - B1
     C           DRECI     ANDNE'B'
     C           DRECI     ANDNE'S'                                       160301
     C           CLDID     ANDLEDDRCD                                     160301
     C           DRECI     ANDNE'M'                                       182452
     C*
     C**  DEBIT RATE CHANGE
     C*
     C                     EXSR RATED
     C*
     C                     Z-ADDDHISD     WHISDD
     C*
     C                     END                             - E1
     C*
     C           DCRCI     IFEQ 'Y'                        - B1
     C           DRECI     ANDNE'B'
     C           DRECI     ANDNE'S'                                       160301
     C           CLCID     ANDLEDCRCD                                     160301
     C           DRECI     ANDNE'M'                                       182452
     C*
     C**  CREDIT RATE CHANGE
     C*
     C                     EXSR RATEC
     C*
     C                     Z-ADDDHISD     WHISDC
     C*
     C                     END                             - E1
     C*
     C           DDRCI     IFEQ *BLANKS                    - B1
     C           DCRCI     ANDEQ*BLANKS
     C*
     C********** CDICT     IFLT 3                          - B2           182452
     C           DDICT     IFLT 3                          - B2           182452
     C                     Z-ADDDHISD     WHISDD
     C                     END                             - E2
     C*
     C********** CCICT     IFLT 3                          - B2           182452
     C           DCICT     IFLT 3                          - B5           182452
     C                     Z-ADDDHISD     WHISDC
     C                     END                             - E2
     C*
     C                     END                             - E1
     C*
     C**  SAVE REHISL  AS PREVIOUS
     C*
     C                     Z-ADDDMNBL     WMNBL
     C                     Z-ADDDHISB     WHISB
      *                                                                   160301
     C           DRECI     IFEQ 'S'                                       160301
     C                     Z-ADDSDRCB     WDRCB                           160301
     C                     Z-ADDSCRCB     WCRCB                           160301
     C           SDICI     IFNE *BLANKS                                   160301
     C                     Z-ADD0         WDAID                           160301
     C                     ELSE                                           160301
     C                     Z-ADDSDAIC     WDAID                           160301
     C                     END                                            160301
     C           SCICI     IFNE *BLANKS                                   160301
     C                     Z-ADD0         WCAID                           160301
     C                     ELSE                                           160301
     C                     Z-ADDSCAIC     WCAID                           160301
     C                     END                                            160301
      *                                                                   160301
     C                     ELSE                                           160301
     C                     MOVE DDRCB     WDRCB
     C                     Z-ADDDCRCB     WCRCB
     C                     Z-ADDDDAID     WDAID
     C                     Z-ADDDCAID     WCAID
     C                     END                                            160301
     C*
     C           KLIST1    READEREHISL                   51
      *                                                                   160301
      * Bypass interim capitalisation records                             160301
     C           *IN51     DOWEQ'0'                                       160301
     C           DRECI     ANDEQ'S'                                       160301
     C           DHISD     ANDLTCHISD                                     160301
      *                                                                   160301
      * If management cap. check for generated adj. after start date.     160301
     C           *IN70     IFEQ '1'                                       160301
     C           *IN51     ANDEQ'0'                                       160301
     C           DRECI     ANDEQ'S'                                       160301
     C           DHISD     ANDLTCHISD                                     160301
     C           SDAIC     IFNE *ZEROS                                    160301
     C           SDICI     ANDNE*BLANK                                    160301
     C           SDCI      ANDEQ'Y'                                       160301
     C                     Z-ADDSDAIC     @GADJ                           160301
     C                     MOVE 'Y'       @ADJF                           160301
     C                     END                                            160301
     C           SCAIC     IFNE *ZEROS                                    160301
     C           SCICI     ANDNE*BLANK                                    160301
     C           SCCI      ANDEQ'Y'                                       160301
     C                     Z-SUBSCAIC     @GADJ                           160301
     C                     MOVE 'Y'       @ADJF                           160301
     C                     END                                            160301
     C                     END                                            160301
      *                                                                   160301
     C           KLIST1    READEREHISL                   51               160301
     C                     ENDDO                                          160301
     C*
     C                     ENDSR                           **RATESR ENDSR*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** RCRSR subroutine for credit rate output processing
     C**
     C**     Called by     RATEC
     C**
     C**     Calls         DBSR
     C**
     C           RCRSR     BEGSR                           **RCRSR BEGSR**
     C*
     C**********           EXSR OVERDC                                    125176
     C*
     C********** DCICT     IFEQ *ZEROS                     - B1           125176
     C/COPY WNCPYSRC,RE3762C017
     C           INTP      IFEQ *ZEROS                     - B1           125176
     C*
     C**********           Z-ADDCRIR      RATE                            125176
     C                     Z-ADDINRT      RATE                            125176
     C*
     C**  OUTPUT RATE CHANGE
     C*
     C                     EXSR OVERDC
     C                     WRITERATEDC
     C/COPY WNCPYSRC,RE3762C185
     C*
     C                     ELSE                            - X1
     C*
     C                     EXSR CLMSG
     C           OPN       IFEQ 'Y'                                       040447
     C                     MOVELNAR,8     RNARR                           040447
     C                     ELSE                                           040447
     C                     MOVELNAR,12    RNARR
     C                     END                                            040447
      *                                                                   125176
      * Print 'tiered' or 'threshold'                                     125176
     C                     MOVEA'00'      *IN,84                          125176
     C           INTP      IFEQ 01                                        125176
     C           INTP      OREQ 03                                        125176
     C                     MOVE '1'       *IN84                           125176
     C                     ELSE                                           125176
     C                     MOVE '1'       *IN85                           125176
     C                     END                                            125176
     C*
     C                     EXSR OVERDC
     C                     WRITERAT1DC
     C/COPY WNCPYSRC,RE3762C186
     C*
     C           INTH      IFGT *ZEROS                     - B2
     C                     Z-SUBINTH      HISB0
     C*
     C**********           EXSR CLMSG                                     125176
     C**********           MOVELNAR,13    BNARR                           125176
     C*
     C                     ELSE                            - X2
     C                     Z-ADDINTH      HISB0
     C                     END                             - E2           125176
     C*
     C                     EXSR CLMSG
     C                     MOVELNAR,14    BNARR
     C*
     C**********           END                             - E2           125176
     C*
     C                     EXSR OVERDC
     C                     WRITERAT2DC
     C/COPY WNCPYSRC,RE3762C187
      *                                                                   125176
      * Output first tier/threshold                                       125176
     C                     Z-ADDRTA,1     ORAT1                           125176
     C                     Z-ADDBLA,1     OBAL01                          125176
     C*
     C**********           Z-ADDRAT21     ORAT1                           125176
     C**********           Z-ADDBAL21     OBAL01                          125176
     C********** RAT22     IFNE *ZEROS                     - B2           125176
     C********** BAL22     ORNE *ZEROS                                    125176
     C**********           Z-ADDRAT22     ORAT2                           125176
     C**********           Z-ADDBAL22     OBAL02                          125176
     C********** RAT23     IFNE *ZEROS                     - B3           125176
     C********** BAL23     ORNE *ZEROS                                    125176
     C**********           Z-ADDRAT23     ORAT3                           125176
     C**********           Z-ADDBAL23     OBAL03                          125176
     C**********           ELSE                            - X3           125176
     C**********           MOVE '1'       *IN85                           125176
     C**********           Z-ADD*ZEROS    ORAT3                           125176
     C**********           Z-ADD*ZEROS    OBAL03                          125176
     C**********           END                             - E3           125176
     C**********           ELSE                            - X2           125176
     C**********           MOVE '1'       *IN85                           125176
     C**********           MOVE '1'       *IN84                           125176
     C**********           Z-ADD*ZEROS    ORAT2                           125176
     C**********           Z-ADD*ZEROS    OBAL02                          125176
     C**********           END                             - E2           125176
     C*
     C                     EXSR OVERDC
     C                     WRITERAT3DC
     C/COPY WNCPYSRC,RE3762C188
     C**********           EXSR OVERDC                                    125176
     C**********           WRITERAT4DC                                    125176
     C**********           MOVE '0'       *IN84                           125176
     C**********           MOVE '0'       *IN85                           125176
     C*
     C********** RAT24     IFNE *ZEROS                     - B2           125176
     C********** BAL24     ORNE *ZEROS                                    125176
     C********** RATC24    IFNE *BLANKS                    - B2           125176
     C********** BALC24    ORNE *BLANKS                                   125176
     C**********           Z-ADDRAT24     ORAT1                           125176
     C**********           Z-ADDBAL24     OBAL01                          125176
     C********** RAT25     IFNE *ZEROS                     - B3           125176
     C********** BAL25     ORNE *ZEROS                                    125176
     C********** RATC25    IFNE *BLANKS                    - B3           125176
     C********** BALC25    ORNE *BLANKS                                   125176
     C**********           Z-ADDRAT25     ORAT2                           125176
     C**********           Z-ADDBAL25     OBAL02                          125176
     C********** RAT26     IFNE *ZEROS                     - B4           125176
     C********** BAL26     ORNE *ZEROS                                    125176
     C**********           Z-ADDRAT26     ORAT3                           125176
     C**********           Z-ADDBAL26     OBAL03                          125176
     C**********           ELSE                            - X4           125176
     C**********           MOVE '1'       *IN85                           125176
     C**********           Z-ADD*ZEROS    ORAT3                           125176
     C**********           Z-ADD*ZEROS    OBAL03                          125176
     C**********           END                             - E4           125176
     C**********           END                                            125176
     C**********           ELSE                            - X3           125176
     C**********           MOVE '1'       *IN84                           125176
     C**********           MOVE '1'       *IN85                           125176
     C**********           Z-ADD*ZEROS    ORAT2                           125176
     C**********           Z-ADD*ZEROS    OBAL02                          125176
     C**********           END                             - E3           125176
     C*
     C**********           EXSR OVERDC                                    125176
     C**********           WRITERAT3DC                                    125176
     C**********           EXSR OVERDC                                    125176
     C**********           WRITERAT4DC                                    125176
     C**********           MOVE '0'       *IN84                           125176
     C**********           MOVE '0'       *IN85                           125176
     C*
     C********** RAT31     IFNE *ZEROS                     - B3           125176
     C********** BAL31     ORNE *ZEROS                                    125176
     C********** RATC31    IFNE *BLANKS                    - B3           125176
     C********** BALC31    ORNE *BLANKS                                   125176
     C**********           Z-ADDRAT31     ORAT1                           125176
     C**********           Z-ADDBAL31     OBAL01                          125176
     C********** RAT32     IFNE *ZEROS                     - B4           125176
     C********** BAL32     ORNE *ZEROS                                    125176
     C********** RATC32    IFNE *BLANKS                    - B4           125176
     C********** BALC32    ORNE *BLANKS                                   125176
     C**********           Z-ADDRAT32     ORAT2                           125176
     C**********           Z-ADDBAL32     OBAL02                          125176
     C********** RAT33     IFNE *ZEROS                     - B5           125176
     C********** BAL33     ORNE *ZEROS                                    125176
     C**********           Z-ADDRAT33     ORAT3                           125176
     C**********           Z-ADDBAL33     OBAL03                          125176
     C**********           ELSE                            - X5           125176
     C**********           MOVE '1'       *IN85                           125176
     C**********           Z-ADD*ZEROS    ORAT3                           125176
     C**********           Z-ADD*ZEROS    OBAL03                          125176
     C**********           END                             - E5           125176
     C**********           END                                            125176
     C**********           ELSE                            - X4           125176
     C**********           MOVE '1'       *IN84                           125176
     C**********           MOVE '1'       *IN85                           125176
     C**********           Z-ADD*ZEROS    ORAT2                           125176
     C**********           Z-ADD*ZEROS    OBAL02                          125176
     C**********           END                             - E4           125176
     C*
     C**********           EXSR OVERDC                                    125176
     C**********           WRITERAT3DC                                    125176
     C**********           EXSR OVERDC                                    125176
     C**********           WRITERAT4DC                                    125176
     C**********           MOVE '0'       *IN84                           125176
     C**********           MOVE '0'       *IN85                           125176
     C*
     C********** RAT34     IFNE *ZEROS                     - B4           125176
     C********** BAL34     ORNE *ZEROS                                    125176
     C********** RATC34    IFNE *BLANKS                    - B4           125176
     C********** BALC34    ORNE *BLANKS                                   125176
     C**********           Z-ADDRAT34     ORAT1                           125176
     C**********           Z-ADDBAL34     OBAL01                          125176
     C********** RAT35     IFNE *ZEROS                     - B5           125176
     C********** BAL35     ORNE *ZEROS                                    125176
     C********** RATC35    IFNE *BLANKS                    - B5           125176
     C********** BALC35    ORNE *BLANKS                                   125176
     C**********           Z-ADDRAT35     ORAT2                           125176
     C**********           Z-ADDBAL35     OBAL02                          125176
     C********** RAT36     IFNE *ZEROS                     - B6           125176
     C********** BAL36     ORNE *ZEROS                                    125176
     C**********           Z-ADDRAT36     ORAT3                           125176
     C**********           Z-ADDBAL36     OBAL03                          125176
     C**********           ELSE                            - X6           125176
     C**********           MOVE '1'       *IN85                           125176
     C**********           Z-ADD*ZEROS    ORAT3                           125176
     C**********           Z-ADD*ZEROS    OBAL03                          125176
     C**********           END                             - E6           125176
     C**********           END                                            125176
     C**********           ELSE                            - X5           125176
     C**********           MOVE '1'       *IN84                           125176
     C**********           MOVE '1'       *IN85                           125176
     C**********           Z-ADD*ZEROS    ORAT2                           125176
     C**********           Z-ADD*ZEROS    OBAL02                          125176
     C**********           END                             - E5           125176
     C*
      * Output rest of rates & balances until zero/blanks found           125176
     C                     Z-ADD1         @R      20                      125176
     C           @R        DOUEQ12                                        125176
     C                     ADD  1         @R                              125176
     C                     MOVE *BLANKS   ORATC                           125176
     C                     MOVE *BLANKS   OBALC                           125176
     C                     Z-ADDRTA,@R    ORAT1                           125176
     C                     Z-ADDBLA,@R    OBAL01                          125176
     C           ORAT1     IFNE *ZEROS                                    125176
     C           ORATC     ANDNE*BLANKS                                   125176
     C           OBAL01    ORNE *ZEROS                                    125176
     C           OBALC     ANDNE*BLANKS                                   125176
     C                     EXSR OVERDC
     C                     WRITERAT3DC
     C/COPY WNCPYSRC,RE3762C189
     C**********           EXSR OVERDC                                    125176
     C**********           WRITERAT4DC                                    125176
     C**********           MOVE '0'       *IN84                           125176
     C**********           MOVE '0'       *IN85                           125176
     C*
     C                     ELSE                                           125176
     C                     Z-ADD12        @R                              125176
     C                     END
     C*
     C                     END                             - E4
     C*
     C**********           END                                            125176
     C*
     C**********           END                             - E3           125176
     C*
     C**********           END                                            125176
     C*
     C**********           END                             - E2           125176
     C*
     C                     END                             - E1
     C*
     C                     ENDSR                           **RCRSR ENDSR**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** RDRSR subroutine for debit rate output processing
     C**
     C**     Called by     RATED
     C**
     C**     Calls         DBSR
     C**
     C           RDRSR     BEGSR                           **RDRSR BEGSR**
     C*
     C**********           EXSR OVERDC                                    125176
     C*
     C********** DDICT     IFEQ *ZEROS                     - B1           125176
     C/COPY WNCPYSRC,RE3762C018
     C           INTP      IFEQ *ZEROS                     - B1           125176
     C*
     C**********           Z-ADDDRIR      RATE                            125176
     C                     Z-ADDINRT      RATE                            125176
     C*
     C**  OUTPUT RATE CHANGE
     C*
     C                     EXSR OVERDC
     C                     WRITERATEDC
     C/COPY WNCPYSRC,RE3762C190
     C*
     C                     ELSE                            - X1
     C*
     C                     EXSR CLMSG
     C           OPN       IFEQ 'Y'                                       040447
     C                     MOVELNAR,3     RNARR                           040447
     C                     ELSE                                           040447
     C                     MOVELNAR,11    RNARR
     C                     END                                            040447
      *                                                                   125176
      * Print 'tiered' or 'threshold'                                     125176
     C                     MOVEA'00'      *IN,84                          125176
     C           INTP      IFEQ 01                                        125176
     C           INTP      OREQ 03                                        125176
     C                     MOVE '1'       *IN84                           125176
     C                     ELSE                                           125176
     C                     MOVE '1'       *IN85                           125176
     C                     END                                            125176
     C*
     C                     EXSR OVERDC
     C                     WRITERAT1DC
     C/COPY WNCPYSRC,RE3762C191
     C*
     C********** INTH      IFGT *ZEROS                     - B2           125176
     C**********           Z-SUBINTH      HISB0                           125176
     C*
     C**********           EXSR CLMSG                                     125176
     C**********           MOVELNAR,13    BNARR                           125176
     C*
     C**********           ELSE                            - X2           125176
     C                     Z-ADDINTH      HISB0
     C*
     C                     EXSR CLMSG
     C                     MOVELNAR,14    BNARR
     C*
     C**********           END                             - E2           125176
     C*
     C                     EXSR OVERDC
     C                     WRITERAT2DC
     C/COPY WNCPYSRC,RE3762C192
     C*
     C**********           Z-ADDRAT21     ORAT1                           125176
     C**********           Z-ADDBAL21     OBAL01                          125176
      *                                                                   125176
      * Output first tier/threshold                                       125176
     C                     Z-ADDRTA,1     ORAT1                           125176
     C                     Z-ADDBLA,1     OBAL01                          125176
     C*
     C********** RAT22     IFNE *ZEROS                     - B2           125176
     C********** BAL22     ORNE *ZEROS                                    125176
     C**********           Z-ADDRAT22     ORAT2                           125176
     C**********           Z-ADDBAL22     OBAL02                          125176
     C********** RAT23     IFNE *ZEROS                     - B3           125176
     C********** BAL23     ORNE *ZEROS                                    125176
     C**********           Z-ADDRAT23     ORAT3                           125176
     C**********           Z-ADDBAL23     OBAL03                          125176
     C**********           ELSE                            - X3           125176
     C**********           MOVE '1'       *IN85                           125176
     C**********           Z-ADD*ZEROS    ORAT3                           125176
     C**********           Z-ADD*ZEROS    OBAL03                          125176
     C**********           END                             - E3           125176
     C**********           ELSE                            - X2           125176
     C**********           MOVE '1'       *IN84                           125176
     C**********           MOVE '1'       *IN85                           125176
     C**********           Z-ADD*ZEROS    ORAT2                           125176
     C**********           Z-ADD*ZEROS    OBAL02                          125176
     C**********           END                             - E2           125176
     C*
     C                     EXSR OVERDC
     C                     WRITERAT3DC
     C/COPY WNCPYSRC,RE3762C193
     C**********           EXSR OVERDC                                    125176
     C**********           WRITERAT4DC                                    125176
     C**********           MOVE '0'       *IN84                           125176
     C**********           MOVE '0'       *IN85                           125176
     C*
     C********** RAT24     IFNE *ZEROS                     - B2           125176
     C********** BAL24     ORNE *ZEROS                                    125176
     C********** RATC24    IFNE *BLANKS                    - B2           125176
     C********** BALC24    ORNE *BLANKS                                   125176
     C**********           Z-ADDRAT24     ORAT1                           125176
     C**********           Z-ADDBAL24     OBAL01                          125176
     C********** RAT25     IFNE *ZEROS                     - B3           125176
     C********** BAL25     ORNE *ZEROS                                    125176
     C********** RATC25    IFNE *BLANKS                    - B3           125176
     C********** BALC25    ORNE *BLANKS                                   125176
     C**********           Z-ADDRAT25     ORAT2                           125176
     C**********           Z-ADDBAL25     OBAL02                          125176
     C********** RAT26     IFNE *ZEROS                     - B4           125176
     C********** BAL26     ORNE *ZEROS                                    125176
     C**********           Z-ADDRAT26     ORAT3                           125176
     C**********           Z-ADDBAL26     OBAL03                          125176
     C**********           ELSE                            - X4           125176
     C**********           MOVE '1'       *IN85                           125176
     C**********           Z-ADD*ZEROS    ORAT3                           125176
     C**********           Z-ADD*ZEROS    OBAL03                          125176
     C**********           END                             - E4           125176
     C**********           END                                            125176
     C**********           ELSE                            - X3           125176
     C**********           MOVE '1'       *IN84                           125176
     C**********           MOVE '1'       *IN85                           125176
     C**********           Z-ADD*ZEROS    ORAT2                           125176
     C**********           Z-ADD*ZEROS    OBAL02                          125176
     C**********           END                             - E3           125176
     C*
     C**********           EXSR OVERDC                                    125176
     C**********           WRITERAT3DC                                    125176
     C**********           EXSR OVERDC                                    125176
     C**********           WRITERAT4DC                                    125176
     C**********           MOVE '0'       *IN84                           125176
     C**********           MOVE '0'       *IN85                           125176
     C*
     C********** RAT31     IFNE *ZEROS                     - B3           125176
     C********** BAL31     ORNE *ZEROS                                    125176
     C********** RATC31    IFNE *BLANKS                    - B3           125176
     C********** BALC31    ORNE *BLANKS                                   125176
     C**********           Z-ADDRAT31     ORAT1                           125176
     C**********           Z-ADDBAL31     OBAL01                          125176
     C********** RAT32     IFNE *ZEROS                     - B4           125176
     C********** BAL32     ORNE *ZEROS                                    125176
     C********** RATC32    IFNE *BLANKS                    - B4           125176
     C********** BALC32    ORNE *BLANKS                                   125176
     C**********           Z-ADDRAT32     ORAT2                           125176
     C**********           Z-ADDBAL32     OBAL02                          125176
     C********** RAT33     IFNE *ZEROS                     - B5           125176
     C********** BAL33     ORNE *ZEROS                                    125176
     C**********           Z-ADDRAT33     ORAT3                           125176
     C**********           Z-ADDBAL33     OBAL03                          125176
     C**********           ELSE                            - X5           125176
     C**********           MOVE '1'       *IN85                           125176
     C**********           Z-ADD*ZEROS    ORAT3                           125176
     C**********           Z-ADD*ZEROS    OBAL03                          125176
     C**********           END                             - E5           125176
     C**********           END                                            125176
     C**********           ELSE                            - X4           125176
     C**********           MOVE '1'       *IN84                           125176
     C**********           MOVE '1'       *IN85                           125176
     C**********           Z-ADD*ZEROS    ORAT2                           125176
     C**********           Z-ADD*ZEROS    OBAL02                          125176
     C**********           END                             - E4           125176
     C*
     C**********           EXSR OVERDC                                    125176
     C**********           WRITERAT3DC                                    125176
     C**********           EXSR OVERDC                                    125176
     C**********           WRITERAT4DC                                    125176
     C**********           MOVE '0'       *IN84                           125176
     C**********           MOVE '0'       *IN85                           125176
     C*
     C********** RAT34     IFNE *ZEROS                     - B4           125176
     C********** BAL34     ORNE *ZEROS                                    125176
     C********** RATC34    IFNE *BLANKS                    - B4           125176
     C********** BALC34    ORNE *BLANKS                                   125176
     C**********           Z-ADDRAT34     ORAT1                           125176
     C**********           Z-ADDBAL34     OBAL01                          125176
     C********** RAT35     IFNE *ZEROS                     - B5           125176
     C********** BAL35     ORNE *ZEROS                                    125176
     C********** RATC35    IFNE *BLANKS                    - B5           125176
     C********** BALC35    ORNE *BLANKS                                   125176
     C**********           Z-ADDRAT35     ORAT2                           125176
     C**********           Z-ADDBAL35     OBAL02                          125176
     C********** RAT36     IFNE *ZEROS                     - B6           125176
     C********** BAL36     ORNE *ZEROS                                    125176
     C**********           Z-ADDRAT36     ORAT3                           125176
     C**********           Z-ADDBAL36     OBAL03                          125176
     C**********           ELSE                            - X6           125176
     C**********           MOVE '1'       *IN85                           125176
     C**********           Z-ADD*ZEROS    ORAT3                           125176
     C**********           Z-ADD*ZEROS    OBAL03                          125176
     C**********           END                             - E6           125176
     C**********           END                                            125176
     C**********           ELSE                            - X5           125176
     C**********           MOVE '1'       *IN84                           125176
     C**********           MOVE '1'       *IN85                           125176
     C**********           Z-ADD*ZEROS    ORAT2                           125176
     C**********           Z-ADD*ZEROS    OBAL02                          125176
     C**********           END                             - E5           125176
     C*
      * Output rest of rates & balances until zero/blanks found           125176
     C                     Z-ADD1         @R                              125176
     C           @R        DOUEQ12                                        125176
     C                     ADD  1         @R                              125176
     C                     MOVE *BLANKS   ORATC                           125176
     C                     MOVE *BLANKS   OBALC                           125176
     C                     Z-ADDRTA,@R    ORAT1                           125176
     C                     Z-ADDBLA,@R    OBAL01                          125176
     C           ORAT1     IFNE *ZEROS                                    125176
     C           ORATC     ANDNE*BLANKS                                   125176
     C           OBAL01    ORNE *ZEROS                                    125176
     C           OBALC     ANDNE*BLANKS                                   125176
     C                     EXSR OVERDC
     C                     WRITERAT3DC
     C/COPY WNCPYSRC,RE3762C194
     C**********           EXSR OVERDC                                    125176
     C**********           WRITERAT4DC                                    125176
     C**********           MOVE '0'       *IN84                           125176
     C**********           MOVE '0'       *IN85                           125176
     C*
     C                     ELSE                                           125176
     C                     Z-ADD12        @R                              125176
     C                     END
     C*
     C                     END                             - E4
     C*
     C**********           END                                            125176
     C*
     C**********           END                             - E3           125176
     C*
     C**********           END                                            125176
     C*
     C**********           END                             - E2           125176
     C*
     C                     END                             - E1
     C*
     C                     ENDSR                           **RDRSR ENDSR**
     C********************************************************************
     C/EJECT                                                              160301
      ********************************************************************160301
      **                                                                  160301
      ** REBSR subroutine for rebate calculation                          160301
      **                                                                  160301
      **     Called by       BOTHSR, CRSR                                 160301
      **                                                                  160301
      **     Calls           DBSR                                         160301
      **                                                                  160301
     C           REBSR     BEGSR                           **REBSR  BEGSR 160301
      *                                                                   160301
      * If closure capitalisation, no rebate or minimum/maximum charge.   160301
     C                     Z-ADD*ZERO     REBATE                          160301
     C                     MOVE *BLANK    MINMAX                          160301
      *                                                                   160301
     C           CCICI     IFNE 'C'                                       160301
      *                                                                   160301
     C           *LIKE     DEFN HISB      REBATE                          160301
     C                     MOVE CCCY      WCCCY                           160301
     C                     MOVE *BLANK    BLANK1                          160301
     C                     MOVE 'D'       ENDK                            160301
      *                                                                   160301
      * Access RECRG file                                                 160301
     C           CHKEY     CHAINRECRG                99                   160301
      *                                                                   160301
      * Error in RECRG                                                    160301
     C           *IN99     IFEQ '1'                        - B1           160301
     C                     Z-ADD28        DBASE            ************** 160301
     C                     MOVE 'RECRG'   DBFILE           **DB ERROR 28* 160301
     C                     MOVELCHKEY     DBKEY            ************** 160301
     C                     MOVEA'1'       *IN,89                          160301
     C                     EXSR DBSR                                      160301
     C                     END                             - E1           160301
      *                                                                   160301
     C           CMNBCP    IFLE EXBL                       - B1           160301
     C           PERM      ANDGT*ZEROS                                    160301
      *                                                                   160301
      * Calculate rebate on charges                                       160301
     C           CMNBCP    ADD  EXBL      REBATE                          160301
     C           REBATE    DIV  PERM      REBATE                          160301
     C           REBATE    MULT REB       REBATE                          160301
     C                     END                             - E1           160301
      *                                                                   160301
     C           CCHGP     IFEQ MINC                       - E1           160301
     C           CCHGP     ANDNE*ZERO                      - E1           160301
     C                     MOVE 'MINIMUM' MINMAX  7                       160301
     C                     END                             - E1           160301
     C           CCHGP     IFEQ MAXC                       - E1           160301
     C           CCHGP     ANDNE*ZERO                      - E1           160301
     C                     MOVE 'MAXIMUM' MINMAX  7                       160301
     C                     END                             - E1           160301
      *                                                                   160301
     C                     MOVELNAR,36    XNARR                           160301
     C                     Z-ADDCMNBCP    PSTD0                           160301
     C                     Z-ADDREBATE    TCHR0                           160301
      *                                                                   160301
     C                     ENDIF                                          160301
      *                                                                   160301
     C                     ENDSR                           **REBSR  ENDSR 160301
      ********************************************************************160301
     C/EJECT
     C********************************************************************
     C**
     C** TOTAL subroutine for total processing
     C**
     C**     Called by       S T A R T
     C**
     C**     Calls           -
     C**
     C           TOTAL     BEGSR                           **TOTAL BEGSR**
     C**
     C** SET UP FOR CONTROL REPORT
     C**
     C                     Z-ADDSFNUMU    ZSNUMU
     C                     OUT  LDA
     C                     CALL 'ZSFILE'
     C                     PARM           SEQ     5
     C                     PARM *BLANK    SENTY   3
     C                     PARM           SFILEU
     C                     PARM           ZSNUMU  60
     C                     PARM           ZSERR   1
     C           *LOCK     IN   LDA
     C*
     C           ZSERR     IFEQ 'Y'
     C** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM
     C** DBASE, DBFILE AND DBKEY SET WITHIN ZSFILE
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END
     C*
     C                     WRITETOTALS
     C*
     C/COPY WNCPYSRC,RE3762C195
     C                     ENDSR                           **TOTAL ENDSR**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** TOTSR subroutine for days total output for credit and debit
     C**
     C**     Called by       B O T H S R
     C**
     C**     Calls           ZICD, ITYPDR, ITYPCR
     C**
     C           TOTSR     BEGSR                           **TOTSR  BEGSR*
     C*
     C********** CDICT     IFLT 3                          - B1           182452
     C           DDICT     IFLT 3                          - B1           182452
     C*
     C           DDRCI     IFEQ 'Y'                        - B2
     C*
     C                     Z-ADDWDRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDDHISD     ZIEND
     C*
     C                     EXSR ZICD
     C*
     C                     Z-ADDZDAYN1    DAYS
     C                     Z-ADDWHISB     HISB0
     C********** *IN80     IFEQ '1'                                       125176
     C           HISB0     MULT DAYS      NUMB0
     C**********           ELSE                                           125176
     C********** *IN81     IFEQ '1'                                       125176
     C********** HISB1     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** *IN82     IFEQ '1'                                       125176
     C********** HISB2     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** HISB3     MULT DAYS      NUMB0                           125176
     C**********           END                                            125176
     C**********           END                                            125176
     C**********           END                                            125176
     C********** NUMB0     DIV  100       NUMB0     H                     125176
     C*
     C                     EXSR OVERDC
     C                     WRITESTOTDC
     C/COPY WNCPYSRC,RE3762C196
     C*
     C                     END                             - E2
     C*
     C                     ELSE                            - X1
     C*
     C                     EXSR ITYPDR
     C*
     C                     END                             - E1
     C*
     C           DCRCI     IFEQ 'Y'                        - B1
     C*
     C           CCICT     IFLT 3                          - B2
     C*
     C                     Z-ADDWCRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C                     Z-ADDDHISD     ZIEND
     C*
     C                     EXSR ZICD
     C*
     C                     Z-ADDZDAYN1    DAYS
     C                     Z-ADDWHISB     HISB0
     C********** *IN80     IFEQ '1'                                       125176
     C           HISB0     MULT DAYS      NUMB0
     C**********           ELSE                                           125176
     C********** *IN81     IFEQ '1'                                       125176
     C********** HISB1     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** *IN82     IFEQ '1'                                       125176
     C********** HISB2     MULT DAYS      NUMB0                           125176
     C**********           ELSE                                           125176
     C********** HISB3     MULT DAYS      NUMB0                           125176
     C**********           END                                            125176
     C**********           END                                            125176
     C**********           END                                            125176
     C********** NUMB0     DIV  100       NUMB0     H                     125176
     C*
     C                     EXSR OVERDC
     C                     WRITESTOTDC
     C/COPY WNCPYSRC,RE3762C197
     C*
     C                     ELSE                            - X2
     C*
     C                     EXSR ITYPCR
     C*
     C                     END                             - E2
     C*
     C                     END                             - E1
     C*
     C                     ENDSR                           **TOTSR  ENDSR*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** CALBRT subroutine to calculate base rates tax
     C**
     C**     Called by       BOTHSR, CRSR
     C**
     C**     Calls           none
     C**
     C           CALBRT    BEGSR                           **CALBRT BEGSR*
     C*
     C** If BRT SAR installed
     C*
     C           S01383    IFEQ 'Y'                        B001
      *                                                                   130468
     C                     MOVE '0'       *IN22                           130468
      *                                                                                       CRE083
      ** IF CFT004 IS ON NO NEED TO ACCESS CLINT                                              CRE083
      *                                                                                       CRE083
     C           CFT004    IFNE 'Y'                                                           CRE083
     C*
     C** Access ACCNT to check if BRT liable
     C*
     C           KACCNT    CHAINACCNT                99
     C*
     C** Chain failure
     C*
     C           *IN99     IFEQ '1'                        B002***********
     C                     MOVEL'ACCNT'   DBFILE           **DB ERROR 24**
     C                     MOVELRKEY      DBKEY            ***************
     C                     Z-ADD24        DBASE
     C                     EXSR DBSR
     C                     END                             E002
     C**********           END                             E001           130468
     C                     END                                                                CRE083
      *                                                                   130468
      * Include CR interest adjustments when calculating BRT              130468
     C                     Z-ADDTINTC0    TGINT0                          130468
     C**********           ADD  CSGACI    TINTC0                   130468 160301
     C                     SUB  CSGACI    TINTC0                          160301
     C*
     C** If BRT liable
     C*
     C           BRTCA     IFEQ 'L'                        B001
     C           BRTCA     OREQ 'P'
     C*
     C**    and credit interest to be paid
     C*
     C********** TINTC0    IFGT 0                          B002           160301
     C           TINTC0    IFLT 0                          B002           160301
     C*
     C** Process record with BRT applied
     C*
     C                     SETON                     22
     C*
     C** Apply new or old rate?
     C*
     C***********HISD      IFGE DEFF                       B003           104618
     C***********          Z-ADDBRTR      BRT1    75                      104618
     C***********          ELSE                            X003           104618
     C***********          Z-ADDPBRTR     BRT1    75                      104618
     C***********          END                             E003           104618
     C*                                                                   104618
     C* IF DATE IS BEFORE 'DEFF' ON SDBRTDPD - USE PREV BRT RATE          104618
     C* OTHERWISE - USE CURRENT BRT RATE.                                 104618
     C*                                                                   104618
     C           CCICI     IFEQ 'D'                                       104618
     C           CCICI     OREQ 'M'                                       104618
     C                     MOVE '1'       *IN30                           104618
     C                     ELSE                                           104618
     C                     MOVE '0'       *IN30                           104618
     C                     END                                            104618
     C*                                                                   104618
     C           LDAC      IFEQ 'Y'                                       104618
     C*                                                                   104618
     C           *IN30     IFEQ '1'                                       104618
     C           RUND      IFLE DEFF                                      104618
     C                     Z-ADDPBRTR     BRT1    75                      104618
     C                     ELSE                                           104618
     C                     Z-ADDBRTR      BRT1                            104618
     C                     END                                            104618
     C                     END                                            104618
     C*                                                                   104618
     C           CCICI     IFEQ 'C'                                       104618
     C           RUND      IFLT DEFF                                      104618
     C                     Z-ADDPBRTR     BRT1                            104618
     C                     ELSE                                           104618
     C                     Z-ADDBRTR      BRT1                            104618
     C                     END                                            104618
     C                     END                                            104618
     C*                                                                   104618
     C           *IN30     IFEQ '0'                                       104618
     C           CCICI     ANDNE'C'                                       104618
     C           NCID      IFLE DEFF                                      104618
     C                     Z-ADDPBRTR     BRT1                            104618
     C                     ELSE                                           104618
     C                     Z-ADDBRTR      BRT1                            104618
     C                     END                                            104618
     C                     END                                            104618
     C*                                                                   104618
     C                     ELSE                                           104618
     C*                                                                   104618
     C           *IN30     IFEQ '1'                                       104618
     C           CCICI     OREQ 'C'                                       104618
     C           RUND      IFLT DEFF                                      104618
     C                     Z-ADDPBRTR     BRT1                            104618
     C                     ELSE                                           104618
     C                     Z-ADDBRTR      BRT1                            104618
     C                     END                                            104618
     C                     END                                            104618
     C*                                                                   104618
     C           *IN30     IFEQ '0'                                       104618
     C           CCICI     ANDNE'C'                                       104618
     C           NCID      IFLT DEFF                                      104618
     C                     Z-ADDPBRTR     BRT1                            104618
     C                     ELSE                                           104618
     C                     Z-ADDBRTR      BRT1                            104618
     C                     END                                            104618
     C                     END                                            104618
     C*                                                                   104618
     C                     END                                            104618
     C*
     C           BRTCA     IFEQ 'L'
     C                     Z-ADDBRT1      WKBRT   75
     C                     ELSE
     C           BRT1      MULT 0.5       WKBRT
     C                     END
     C*
     C           TINTC0    MULT WKBRT     BRTOT0
     C********** BRTOT0    DIV  100       BRTOT0                          130468
     C           BRTOT0    DIV  100       BRTOT0    H                     130468
      *                                                                   160301
      * If CR interest is negative, BRT amount must be positive.          160301
     C                     Z-SUBBRTOT0    BRTOT0                          160301
     C*
     C**********           Z-ADDTINTC0    TGINT0                          130468
     C**********           SUB  BRTOT0    TINTC0                          130468
     C                     END                             E002
     C*
     C                     END                             E001
      *                                                                   130468
     C                     Z-ADDTGINT0    TINTC0                          130468
     C                     END                                            130468
     C*
     C********** TINTC0    COMP 0                    4948                 160301
     C           TINTC0    COMP 0                    4849                 160301
     C                     ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C**   SR. TO SET UP AN ARRAY OF CURRENCIES AND AN ARRAY OF
     C**   DECIMAL PLACES FOR THOSE CURRENCIES.
     C**
     C           CCYARR    BEGSR                           *** CCYARR  ***
     C**
     C**   SET OFF ERROR INDICATOR
     C                     SETOF                     99
     C**
     C**   SET ARRAY INDEX TO ZERO.
     C                     Z-ADD0         X       30
     C**
     C**   SET UP KEY FOR CURRENCY TABLE.
     C                     MOVE *BLANKS   W@CKEY  3
     C**
     C**   SET LOWER LIMIT AND READ CURRENCY TABLE HEADER.
     C           W@CKEY    SETLLSDCURRL0
     C**
     C**   LOOP TO READ CURRENCY DETAIL RECORDS.
     C           XLOOP     TAG                             ** XLOOP TAG **
     C                     READ SDCURRL0                 99
     C**
     C**   END IF ALL CURRENCY RECORDS PROCESSED
     C   99                GOTO XEND
     C**
     C**   INCREMENT ARRAY INDEX.
     C           X         ADD  1         X
     C**
     C**   MOVE DATA INTO ARRAYS.
     C                     MOVE A6CYCD    CCYA,X
     C                     MOVE A6NBDP    DPA,X
     C**
     C**   CHECK FOR FULL ARRAY.96 ON IF FULL.
     C           X         COMP 200                      96
     C**
     C**   GO TO READ NEXT RECORD.
     C  N96                GOTO XLOOP
     C**
     C           XEND      TAG                             ** XEND TAG  **
     C                     ENDSR
     C**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** ZICD subroutine to find number of days to calculate interest
     C**      according to calculation basis
     C**
     C**     Called by       BOTHSR, CRSR, DAYTSR, DRSR, ITYPCR,
     C**                     ITYPDR, TOTSR
     C**
     C**     Calls           DBSR
     C**
     C           ZICD      BEGSR                           **ZICD BEGSR**
     C*
     C* TO DETERMINE NUMBER OF DAYS INTEREST TO BE CALCULATED
     C*
     C           ZIEND     SUB  ZIBEG     ZDAYN1
     C*
     C* CHECK FOR INTEREST CALCULATION BASIS
     C*
     C           ZICALC    IFEQ 3                          - B1
     C           ZICALC    OREQ 0                                                             CER016
     C/COPY WNCPYSRC,RE3762C019
     C           ZIEND     IFGT ZIBEG                      - B2
     C*
     C** CALCULATING DATE FROM DAY NUMBER (BEGINNING DATE)
     C*
     C                     Z-ADDZIBEG     ZDAYNO
     C                     EXSR ZDATE2
     C*
     C                     Z-ADDZDATE     SRES
     C*
     C** CALCULATING DATE FROM DAY NUMBER (FINISHING DATE)
     C*
     C                     Z-ADDZIEND     ZDAYNO
     C                     EXSR ZDATE2
     C*
     C                     Z-ADDZDATE     FRES
     C*
     C** IN ORDER FOR THE FINISH YEAR TO BE LESS THAN THE START YEAR IF ZIEND
     C** IS GREATER THAN ZIBEG, THEN THE DATE ZIEND MUST BE IN A DIFFERENT
     C** CENTURY TO ZIBEG. IF SO ADD 100 YEARS TO IT.
     C*
     C*
     C           ZIFY      IFLT ZISY                       - B3
     C           ZIFY      ADD  100       ZIFY2   30
     C                     ELSE                            - X3
     C                     Z-ADDZIFY      ZIFY2
     C                     END                             - E3
     C*
     C                     Z-ADDZISY      ZISY2   30
     C*
     C** DETERMINE WHETHER START YEAR IS A LEAP YEAR AND IF START MONTH
     C** IS FEBRUARY  THEN CONSIDER LAST DAY OF FEBRUARY AS DATE 30ND. OF THE
     C*  MONTH
     C*
     C           ZICALC    IFEQ 3                                                             CER016
     C           ZICALC    OREQ 0                                                             CER016
     C           CER016    ANDEQ'N'                                                           CER016
      *                                                                                       CER016
     C           ZISM      IFEQ 2                          - B3
     C           ZISY2     ADD  1900      ZLYCHK  40
     C           ZLYCHK    DIV  4         ZLYCHK
     C                     MVR            ZLYREM  20
     C           ZLYREM    IFEQ 0                          - B4
     C           ZISD      IFEQ 29                         - B5
     C                     Z-ADD30        ZISD
     C                     END                             - E5
     C                     ELSE                            - X4
     C           ZISD      IFEQ 28                         - B5
     C                     Z-ADD30        ZISD
     C                     END                             - E5
     C                     END                             - E4
     C                     END                             - E3
      *                                                                                       CER016
     C                     ENDIF                                                              CER016
     C*
     C           30        SUB  ZISD      ZID1
     C*
     C           ZID1      IFLT 0                          - B3
     C                     Z-ADD*ZEROS    ZID1
     C                     END                             - E3
     C*
     C           ZISM      IFEQ 12                         - B3
     C                     Z-ADD*ZEROS    ZISM
     C                     ADD  1         ZISY
     C                     ADD  1         ZISY2
     C                     END                             - E3
     C*
     C** DETERMINE WHETHER END YEAR IS A LEAP YEAR AND IF END MONTH IS FEBRUARY
     C*
     C           ZICALC    IFEQ 3                                                             CER016
     C           ZICALC    OREQ 0                                                             CER016
     C           CER016    ANDEQ'N'                                                           CER016
      *                                                                                       CER016
     C           ZIFM      IFEQ 2                          - B3
     C           ZIFY2     ADD  1900      ZLYCHK  40
     C           ZLYCHK    DIV  4         ZLYCHK
     C                     MVR            ZLYREM  20
     C           ZLYREM    IFEQ 0                          - B4
     C           ZIFD      IFEQ 29                         - B5
     C                     Z-ADD30        ZIFD
     C                     END                             - E5
     C                     ELSE                            - X4
     C           ZIFD      IFEQ 28                         - B5
     C                     Z-ADD30        ZIFD
     C                     END                             - E5
     C                     END                             - E4
     C                     END                             - E3
      *                                                                                       CER016
     C                     ENDIF                                                              CER016
     C*
     C           ZIFD      IFEQ 31                         - B3
     C                     ADD  30        ZID1
     C                     ELSE                            - X3
     C                     ADD  ZIFD      ZID1
     C                     END                             - E3
     C*
     C                     SUB  1         ZIFM
     C*
     C           ZISY      IFEQ ZIFY                       - B3
     C           ZIFM      SUB  ZISM      ZINOM   30
     C                     ELSE                            - X3
     C           12        SUB  ZISM      ZIM1
     C                     Z-ADD1         ZISM
     C*
     C** USE ENLARGE FIELDS THAT CAN HANDLE 1999 ONWARDS
     C*
     C                     ADD  1         ZISY2
     C           ZIFY2     SUB  ZISY2     ZIY1
     C           ZIY1      MULT 12        ZIM2    30
     C           ZIM2      ADD  ZIFM      ZIM2
     C           ZIM2      ADD  ZIM1      ZINOM
     C*
     C                     END                             - E3
     C*
     C           ZINOM     MULT 30        ZID2
     C           ZID2      ADD  ZID1      ZDAYN1
     C*
     C                     END                             - E2
     C*
     C                     END                             - E1
     C*
     C           ZICALC    IFEQ 4                          - B1
     C           ZICALC    OREQ 5
     C*
     C** ONE DAY IS SUBTRACTED FROM ZDAYN1 FOR EACH OCCURANCE OF 29 FEB IN THE
     C** THE INTEREST CALCULATION PERIOD INCLUSIVE OF ZIBEG AND ZIEND
     C*
     C** FIND NO OF FOUR YEAR PERIODS BETWEEN DATES
     C*
     C           ZDAYN1    DIV  1461      ZIMAN
     C                     MVR            ZIREM
     C*
     C** FIND NEXT 29 FEB DAY NO. ON OR AFTER ZIBEG.
     C*
     C           ZIBEG     SUB  60        ZIBW1
     C           ZIBW1     DIV  1461      ZIDW1
     C                     MVR            ZIDREM
     C*
     C           ZIDREM    IFEQ 0                          - B2
     C                     Z-ADDZIBEG     ZIDW2
     C                     END                             - E2
     C*
     C** ROUND UP RESULT
     C*
     C           ZIDW1     ADD  1         ZIDW2
     C*
     C** CALCULATE NEXT 29 FEB.
     C*
     C           ZIDW2     MULT 1461      ZIDW2
     C           ZIDW2     ADD  60        ZIDW2
     C*
     C** IF THIS NEXT 29 FEB. DAYNO - ZIBEG IS GREATER OR EQUAL TO ZIREM THEN
     C** ADD 1 TO ZIMAN.
     C*
     C           ZIDW2     SUB  ZIBEG     ZILPCP
     C*
     C           ZIREM     IFGE ZILPCP                     - B2
     C                     ADD  1         ZIMAN
     C                     END                             - E2
     C*
     C** SUBTRACT ZIMAN FROM ZDAYN1 TO GIVE VALUE OF ZDAYN1 REQUIRED FOR THIS
     C** INTEREST CALCULATION
     C*
     C           ZDAYN1    SUB  ZIMAN     ZDAYN1
     C*
     C                     END                             - E1
     C*
     C                     ENDSR                           **ZICD ENDSR**
     C********************************************************************
     C*
     C* *PSSR  --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS
     C*
     C* CALLED FROM: AFTER ABNORNAL OPERATION OCCURS
     C*
     C* CALLS: NOTHING
     C*
     C********************************************************************
     C*
     C           *PSSR     BEGSR                           ** *PSSR **
     C*
     C           @RUN      IFEQ *BLANKS
     C                     MOVE 'Y'       @RUN    1
     C                     DUMP
     C                     END
     C                     SETON                     U7U8LR               105294
     C*
     C                     ENDSR                           ** *PSSR **
     C*****************************************************************
     C/COPY ZSRSRC,ZDATE2Z2
     C*                                                                   114487
     C/COPY WNCPYSRC,RE3762C024
     C** MSG array physically deleted for SC 114487                       114487
     C*                                                                   114487
**   CMD - COMMAND TO OVERIDE MESSAGE FILE
OVRMSGF MSGF(  REPTMSGF) TOMSGF(GBREPTMSGF)
**  CPY@
(c) Finastra International Limited 2001
     X/COPY WNCPYSRC,RE3762X001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
