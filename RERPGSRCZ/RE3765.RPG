000100200529     H        1
000200200529      *****************************************************************
000300200529/*S*D****RPGBASE*******************************************************                       CSD053
000400200529/*STD *  RPGBNOCVT                                                    *                       CSD053
000500200529/*EXS *  RPGCVTOPT1                                                   *                       CSD053
000600200529/*EXI *  TEXT('Midas RE Interest statement print ICD 5')              *
000700200529     F*****************************************************************
000800200529     F*                                                               *
000900200529     F*  Midas - Retail Module
001000200529     F*                                                               *
001100200529     F*  RE3765  - INTEREST STATEMENT PRINT ICD 5                     *
001200200529     F*                                                               *
001300200529      *  (c) Finastra International Limited 2001                      *
001400200529     F*                                                               *
001500200604     F*  Last Amend No. 253776             Date 22May20               *
001600200529      *  Prev Amend No. CER050             Date 16Jun19               *
001700200529      *                 MD046248           Date 27Oct17               *
001800200529      *                 MD037149           Date 11May16               *
001900200529      *                 CGL165             Date 17Feb15               *
002000200529      *                 CRE075             Date 06Dec10               *
002100200529      *                 CER059             Date 19Jul10               *
002200200529      *                 BUG23123           Date 09Mar09               *
002300200529      *                 CER048             Date 19May08               *
002400200529      *                 CER016             Date 19May08               *
002500200529      *                 CER047             Date 19May08               *
002600200529      *                 CER043             Date 19May08               *
002700200529      * Bank Fusion Midas 1.4 Base -----------------------------------*
002800200529      * Midas Plus 1.4 Base 04 ---------------------------------------*
002900200529      *                 CRE026             Date 24May06               *
003000200529      * Midas Plus 1.3 ----------- Base ------------------------------*
003100200529      *                 CSD053             Date 01Jun06               *
003200200529      *                 CSD031             Date 10Apr06               *
003300200529      *                 CSD027A            Date 11May06               *
003400200529      *                 CSD027             Date 09Dec05               *
003500200529      *                 235917             Date 08Sep05               *
003600200529      *                 CGL035             Date 05Jul04               *
003700200529      *                 CGL031             Date 05Jul04               *
003800200529      *                 CSW037A            Date 02May05               *
003900200529      *                 CSD025             Date 11Jan05               *
004000200529      *                 CSW037             Date 15Dec04               *
004100200529      *                 CSW036             Date 15Dec04               *
004200200529      *                 CLE025             Date 20Oct03               *
004300200529      *                 CGL029             Date 01Sep03               *
004400200529      * Midas Release 4.01.02 ----------------------------------------*
004500200529      *                 182037             Date 22Apr02               *
004600200529      * Midas Release 4.01 -------------------------------------------*
004700200529      *                 194059             Date 06Aug01               *
004800200529      * Midas Release 4 --------------- Base -------------------------*
004900200529      *                 CDE002             Date 21Dec99               *
005000200529      * Midas DBA 3.05 -----------------------------------------------*
005100200529      *                 180892             Date 14Nov00               *
005200200529      * Midas DBA 3.03 -----------------------------------------------*
005300200529      * Midas DBA 3.02 -----------------------------------------------*
005400200529      *                 CFT004             Date 27Jul99               *
005500200529      * Midas DBA 3.01 -----------------------------------------------*
005600200529      *                 CGL007             Date 26Mar99               *
005700200529      * Midas DBA 3.00 ---------------- Base -------------------------*
005800200529      *                 130468             Date 30Apr99               *
005900200529      *                 104618             Date 19May98               *
006000200529     F*                 CRE001             Date 18Feb97               *
006100200529     F*                 098818             Date 15Apr96               *
006200200529     F*                 094431             Date 16Oct95               *
006300200529     F*                 087284             DATE 04MAY95               *
006400200529     F*                 084174             DATE 02MAR95               *
006500200529     F*                 S01413 *CREATE     DATE 13APR93               *
006600200529     F*                                                               *
006700200529     F*****************************************************************
006800200529     F*                                                               *
006900200529      *  253776 - Check the address reference if alternate address is *
007000200529      *           to be printed.                                      *
007100200529      *         - Initialize the report output fields properly.       *
007200200529      *         - Issue DUMP and RETRN in DBSR error handling SR      *
007300200529      *         - Database error should not be issued if RAT21 and    *
007400200529      *           BAL21 are both 0.                                   *
007500200529      *  CER050 - Annualised Percentage Rate                          *
007600200529      *  MD046248 - Finastra Rebranding                               *
007700200529      *  MD037149 - ORF Queries not running (Recompile)               *
007800200529      *  CGL165 - Dual Withholding Tax (Recompile)                    *
007900200529      *  CRE075 - Effective Date for Retail Accounts (Recompile)      *
008000200529      *  CER059 - German Feature Upgrade to Delhi                     *
008100200529      *  BUG23123 - Report: Does not show Retail Account Number       *
008200200529      *                     Date is not Midas Standard Date           *
008300200529      *                     Period should be actual int. calc. period *
008400200529      *                     Secondary Tax amount is not printed       *
008500200529      *                     Added field TSSLID                        *
008600200529      *                     (Recompile)                               *
008700200529      *  CER048 - German Features - Taxes                             *
008800200529      *  CER016 - German Interest Calculation: Upgrade of FGE059      *
008900200529      *           to Midas Plus                                       *
009000200529      *  CER047 - German Features LF037-00 Reporting §24c KWG         *
009100200529      *           (Recompile)                                         *
009200200529      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
009300200529      *           (Recompile)                                         *
009400200529      *  CRE026 - Consumer Banking                                    *
009500200529      *  CSD053 - Correspondence Manager Multilanguage Upgrade.       *
009600200529      *         - Recompile only due to changes in RE3765DC,         *
009700200529      *           RE3765HC and RE3765CH.                             *
009800200529      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
009900200529      *  CSD027A - Conversion Of Customer Number to Alpha             *
010000200529      *  CSD027 - Conversion Of Customer Number to Alpha              *
010100200529      *  235917 - No EU tax printed for joint accounts                *
010200200529      *  CGL035 - EUSD Upgrade to MidasPlus                           *
010300200529      *  CGL031 - Taxation of Savings Income                          *
010400200529      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
010500200529      *  CSD025 - Customer De-Activation                              *
010600200529      *  CSW037 - Additional Field Data on MT300/MT320                *
010700200529      *  CSW036 - Dual SWIFT BIC held on Client Details               *
010800200529      *  CLE025 - Credit Lines (Recompile)                            *
010900200529      *  CGL029 - Increase Account Code to 10 digits                  *
011000200529      *  182037 - For capitalisations due for both credit and debit   *
011100200529      *           side: the Fixed Commission must be included in the  *
011200200529      *           computation of the total interest even if there is  *
011300200529      *           no interest to capitalise on the debit side.        *
011400200529      *  194059 - Rename TRAT in files REHRDJ and REHRCJ.             *
011500200529      *  CDE002  -  Revenue Analysis - Recompiled due to changes in   *
011600200529      *             PF/RECCYD.                                        *
011700200529      *  180892 - Incorrect coding of CRE001 for overdraft printing.  *
011800200529      *           Re-apply CRE001 correctly for overdraft printing.   *
011900200529      *  CFT004 - Straight Through Processing Phase 2                 *
012000200529      *           International Bank Account Numbers (IBAN)           *
012100200529      *  CGL007 - Account Postings Enquiry.  Recompile.               *
012200200529     F*  130468 - BRT not deducted from CR interest adjustments.      *
012300200529     F*           Also report total adjustments (CSGADI/CSGACI).      *
012400200529     F*  104618 - Choose correct BRT rate in same way as RE3664.      *
012500200529     F*  CRE001 - Overdraft Interest Calculations:                    *
012600200529     F*         - Include O/D Line and O/D Interest Rate Changes to   *
012700200529     F*           Debit Capitalisation Report.                        *
012800200529     F*  098818 - Allow for interest capital indicator on REHISPS     *
012900200529     F*           to retain its original values of 'C' 'D' 'Y' &      *
013000200529     F*           ' ' to be used by input cycle enquiries.            *
013100200529     F*  094431 - Recompiled over changed REHISSL and REHPOPH.        *
013200200529     F*  087284 - Use AOCUSTR0 to retrieve address reference B        *
013300200529     F*  084174 - Use AOALTNR0 to retrieve alternative addresses      *
013400200529     F*  S01413 - Retail 3 Incorporation                              *
013500200529     F*                                                               *
013600200529     F*****************************************************************
013700200529     FRECAPML IF  E           K        DISK
013800200529     FCLINT   IF  E           K        DISK
013900200529     F            CLINTCCF                          KIGNORE               084174
014000200529     FSDCSINL7IF  E           K        DISK                                                   CGL031
014100200529      ** Midas SD Customer Income - Customer Number Retrieve Index                            235917
014200200529     FSDCSINLCIF  E           K        DISK                                                   235917
014300200529     F            SDCSIND0                          KRENAMESDCSINDC                           235917
014400200529      ** Midas SD Customer Income - Joint A/c Number Retrieve Index                           235917
014500200529     FSDJACCL1IF  E           K        DISK                                                   235917
014600200529      ** Midas SD Joint A/c Member Details - Retrieve Index                                   235917
014700200529     FREHISL  IF  E           K        DISK
014800200529     FREHISSL IF  E           K        DISK
014900200529     F            REHISPSF                          KRENAMEREADJF
015000200529     FRECOM   IF  E           K        DISK
015100200529     FREHPOPL IF  E           K        DISK
015200200529     F            REHPOSPF                          KRENAMEREHPOPLF
015300200529     FREHPOPH IF  E           K        DISK
015400200529     F            REHPOSPF                          KRENAMEREHPOPHF
015500200529     FACCRACJ IF  E           K        DISK
015600200529     FREHRDJ  IF  E           K        DISK
015700200529     FREHRCJ  IF  E           K        DISK
015800200529     FACCNT   IF  E           K        DISK
015900200529     FSDBRTDL1IF  E           K        DISK
016000200529     FRECCY   IF  E           K        DISK
016100200529     F            RECCYAF                           KIGNORE
016200200529     F            RECCYZF                           KIGNORE
016300200529     FCLEAR   IF  E           K        DISK
016400200529     F            APOSTHHF                          KIGNORE
016500200529     F            APOSTZZF                          KIGNORE
016600200529     FTABTBRE IF  E                    DISK                           UC
016700200529     FSDCURRL0IF  E           K        DISK
016800200529     FTABLEV4 IF  E                    DISK
016900200529     FACCNTBY0IF  E           K        DISK                                                   CER050
017000200529     FREAPRHI0IF  E           K        DISK                                                   CER050
017100200529     FREAPRHI1IF  E           K        DISK                                                   CER050
017200200529     F            REAPRHD0                          KRENAMEREAPRHD1                           CER050
017300200529     F/COPY WNCPYSRC,RE3765F001
017400200529     FRE3765HCO   E             74     PRINTER      KINFDS SPOOL      UC
017500200529     FRE3765DCO   E             73     PRINTER      KINFDS SPOOL1     UC
017600200529     FRE3765AUO   E             72     PRINTER      KINFDS SPOOLU
017700200529     F/COPY WNCPYSRC,RE3765F002
017800200529     F/EJECT
017900200529     F*****************************************************************
018000200529     F*                                                               *
018100200529     F*  F U N C T I O N   O F   I N D I C A T O R S                  *
018200200529     F*                                                               *
018300200529     F*  01  DEBIT CAPITALISATION                                     *
018400200529     F*  02  CREDIT CAPITALISATION                                    *
018500200529     F*  20  IN CASE OF BACK VALUE PROCESSING ACCESS REHISSL          *
018600200529     F*  22  OUTPUT BRT DETAILS TO REPORT                             *
018700200529     F*  30  CAPITALISATION IS ON DEMAND OR FOR MANAGEMENT STMT.      *   104618
018800200529     F*  33  IF EXEMPT OF TURNOVER COMMISSION                         *
018900200529     F*  41  TO PRINT SIGN FOR WITHHOLDING TAX                        *
019000200529     F*  48  TOTAL CREDITED                                           *
019100200529     F*  49  TOTAL DEBITED                                            *
019200200529     F*  50  USE WITH REHPOPL & REHPOPH                               *
019300200529     F*  51  USE WITH REHISL                                          *
019400200529     F*  52  USE WITH REHISL                                          *
019500200529     F*  53  USE WITH CLEARL1                                         *
019600200529     F*  54  TURNOVER COMMISSION ON FOR THIS ACCOUNT                  *
019700200529     F*  60  USE WITH REHRDJ AND REHRCJ                               *
019800200529     F*  70  MANAGEMENT STATEMENT PRINT                               *
019900200529     F*  72  OVERFLOW INDICATORE ON PRINTER FOR AUDIT                 *
020000200529     F*  73  OVERFLOW INDICATORE ON PRINTER FOR DEBIT AND CREDIT      *
020100200529     F*  74  OVERFLOW INDICATORE ON PRINTER FOR CHARGES               *
020200200529     F*  80  NUMBER OF DECIMAL POSITION WITH CURRENCY = 0             *
020300200529     F*  81  NUMBER OF DECIMAL POSITION WITH CURRENCY = 1             *
020400200529     F*  82  NUMBER OF DECIMAL POSITION WITH CURRENCY = 2             *
020500200529     F*  83  NUMBER OF DECIMAL POSITION WITH CURRENCY = 3             *
020600200529     F*  85  MULTIBRANCHING OUTPUT INDICATOR                          *
020700200529     F*  86  MULTIBRANCHING INDICATOR MBIN = 'Y'                      *
020800200529     F*  89  USE TO PRINT END OF AUDIT WHEN DB ERROR                  *
020900200529     F*  96  CURRENCIES ARRAY IS FULL                                 *
021000200529     F*  97  USE IF CURRENCY EXIST                                    *
021100200529     F*  98  DATF = M                                                 *
021200200529     F*  99  USE WITH ACCRACJ AND CLINT FILES                         *
021300200529     F*                                                               *
021400200529     F*  U7  DATABASE ERROR                                           *
021500200529     F*  U8  DATABASE ERROR                                           *
021600200529     F*  LR  END OF PROGRAM                                           *
021700200529     F*                                                               *
021800200529     F*  DB ERROR NUMBER MAXIMUM 52 (INCLUDE)                         *
021900200529     F*                                                               *
022000200529     F*****************************************************************
022100200529     F*                                                               *
022200200529     F*  S U B R O U T I N E   I N D E X                              *
022300200529     F*                                                               *
022400200529     F*  BOTHSR - Credit and Debit processing                         *
022500200529     F*  B1EQ   - When debit and credit begin at the same date        *
022600200529     F*  B1GT   - When debit begin before credit                      *
022700200529     F*  B1LT   - When credit begin before debit                      *
022800200529     F*  CALBRT - Calculate base rate tax                             *
022900200529     F*  CALEUT - Calculate EU withholding tax                        *                       CGL031
023000200529     F*  CLMSG  - Clear message                                       *
023100200529     F*  CRSR   - Credit only processing                              *
023200200529     F*  DAYTSR - Prepare and output days total                       *
023300200529     F*  DBSR   - Database error handling                             *
023400200529     F*  DRSR   - Debit only processing                               *
023500200529     F*  DETPR  - Detail processing                                   *
023600200529     F*  FIRST  - First cycle                                         *
023700200529     F*  ITYPCR - Interest type greater than 2                        *
023800200529     F*  ITYPDR - Interest type greater than 2                        *
023900200529     F*  MAIN   - Main processing                                     *
024000200529     F*  OPENCR - Credit opening bal and credit opening rate ouput    *
024100200529     F*  OPENDR - Debit opening bal and debit opening rate output     *
024200200529     F*  OVERDC - Subroutine for processing overflow on RE3764DC      *
024300200529     F*  POSTSR - Posting output                                      *
024400200529     F*  RATEC  - Prepare and output credit rate change               *
024500200529     F*  RATED  - Prepare and output debit rate change                *
024600200529     F*  RATESR - Rate change processing                              *
024700200529     F*  RCRSR  - Credit rate change output                           *
024800200529     F*  RDRSR  - Debit rate change output                            *
024900200529     F*  TOTAL  - Total processing                                    *
025000200529     F*  TOTSR  - Days total output for crdeit and debit              *
025100200529     F*  ZICD   - Find number of days to calculate interest according *
025200200529     F*           to calculation basis                                *
025300200529     F*  *PSSR  - Error subroutine for certain access object errors   *
025400200529     F*                                                               *
025500200529     F*****************************************************************
025600200529     F/EJECT
025700200529     E                    CCYA      200  3
025800200529     E                    DPA       200  1 0
025900200529     E                    CMD     1   1 39
026000200529     E                    CPY@    1   1 80
026100200529     E/COPY WNCPYSRC,RE3765E001
026200200529     E********************NAR        34 39                                CRE001
026300200529     E                    NAR        37 39                                CRE001
026400200529     E/COPY WNCPYSRC,RE3765E002
026500200529     E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
026600200529     E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
026700200529     E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
026800200529     E                    CURR      150  3               CURRENCY
026900200529     E                    AMAX      150 13 0             ACCOUNT MAXIMUM
027000200529     E                    AMIN      150 13 0             ACCOUNT MINIMUM
027100200529     E                    ARET      150 10 8             COMMISSION RATE
027200200529     E**
027300200529     E*    STORE THE EIGHT GROUP EACH CUSTOMER IS ASSOCIATED
027400200529     E*
027500200529     E                    CGRP        9  1               CUSTOMER GROUP
027600200529     E                    AGRP        9  1               ACCOUNT COMMISS.
027700200529     ICLINTCBF
027800200529     I*
027900200529     I** RENAME CLINTCBF FORMAT FIELDS - CLINT FILE
028000200529     I*
028100200529     I              CUGRP                           CCGRP
028200200529     I/COPY WNCPYSRC,RE3765I001
028300200529     IREADJF
028400200529     I*
028500200529     I** RENAME READJF FORMAT FIELDS - REHISSL FILE
028600200529     I*
028700200529     I              RECI                            ARECI
028800200529     I              BRCA                            ABRCA
028900200529     I              CNUM                            ACNUM
029000200529     I              CCY                             ACCY
029100200529     I              ACOD                            AACOD
029200200529     I              ACSQ                            AACSQ
029300200529     I              HISD                            AHISD
029400200529     I              HISB                            AHISB
029500200529     I              MNBL                            AMNBL
029600200529     I              PCHGAR                          ACHGAR
029700200529     I              TCHGAR                          ATHGAR
029800200529     I              PCHGAN                          ACHGAN
029900200529     I              TCHGAN                          ATHGAN
030000200529     I              DICT                            ADICT
030100200529     I              DRCB                            ADRCB
030200200529     I              DRCD                            ADRCD
030300200529     I              DAIC                            ADAIC
030400200529     I              PMADI                           APMADI
030500200529     I              TMADI                           ATMADI
030600200529     I              PDID                            APDID
030700200529     I              DMINT                           ADMINT
030800200529     I              DRIP                            ADRIP
030900200529     I              DRIS                            ADRIS
031000200529     I              CICT                            ACICT
031100200529     I              CRCB                            ACRCB
031200200529     I              CRCD                            ACRCD
031300200529     I              CAIC                            ACAIC
031400200529     I              PMACI                           APMACI
031500200529     I              TMACI                           ATMACI
031600200529     I              PCID                            APCID
031700200529     I              CMINT                           ACMINT
031800200529     I              CRIP                            ACRIP
031900200529     I              CRIS                            ACRIS
032000200529     I              STBL                            ASTBL
032100200529     I              CHGP                            ACHGP
032200200529     IREHISPSF
032300200529     I*
032400200529     I** RENAME REHISPSF FORMAT FIELDS - REHISL  FILE
032500200529     I*
032600200529     I              RECI                            DRECI
032700200529     I              BRCA                            SBRCA
032800200529     I              CNUM                            SCNUM
032900200529     I              CCY                             SCCY
033000200529     I              ACOD                            SACOD
033100200529     I              ACSQ                            SACSQ
033200200529     I              HISD                            DHISD
033300200529     I              HISB                            DHISB
033400200529     I              MNBL                            SMNBL
033500200529     I              PCHGAR                          SCHGAR
033600200529     I              TCHGAR                          STHGAR
033700200529     I              PCHGAN                          SCHGAN
033800200529     I              TCHGAN                          STHGAN
033900200529     I              DICT                            DDICT
034000200529     I              DRCB                            SDRCB
034100200529     I              DRCD                            SDRCD
034200200529     I              DAIC                            SDAIC
034300200529     I              PMADI                           SPMADI
034400200529     I              TMADI                           STMADI
034500200529     I              PDID                            SPDID
034600200529     I              DMINT                           SDMINT
034700200529     I              DRIP                            SDRIP
034800200529     I              DRIS                            SDRIS
034900200529     I              CICT                            DCICT
035000200529     I              CRCB                            SCRCB
035100200529     I              CRCD                            SCRCD
035200200529     I              CAIC                            SCAIC
035300200529     I              PMACI                           SPMACI
035400200529     I              TMACI                           STMACI
035500200529     I              PCID                            SPCID
035600200529     I              CMINT                           SCMINT
035700200529     I              CRIP                            SCRIP
035800200529     I              CRIS                            SCRIS
035900200529     I              STBL                            SSTBL
036000200529     I              CHGP                            SCHGP
036100200529     IREHISPPF
036200200529     I*
036300200529     I** RENAME REHISPPF FORMAT FIELDS - REHISL  FILE
036400200529     I*
036500200529     I              RECI                            DRECI
036600200529     I              BRCA                            DBRCA
036700200529     I              CNUM                            DCNUM
036800200529     I              CCY                             DCCY
036900200529     I              ACOD                            DACOD
037000200529     I              ACSQ                            DACSQ
037100200529     I              HISD                            DHISD
037200200529     I              HISB                            DHISB
037300200529     I              MNBL                            DMNBL
037400200529     I              CHGAR                           DCHGAR
037500200529     I              TCHGAR                          DTHGAR
037600200529     I              CHGAN                           DCHGAN
037700200529     I              TCHGAN                          DTHGAN
037800200529     I              DMVT                            DDMVT
037900200529     I              DICT                            DDICT
038000200529     I              DRCB                            DDRCB
038100200529     I              DRCD                            DDRCD
038200200529     I              DAID                            DDAID
038300200529     I              MADI                            DMADI
038400200529     I              TMADI                           DTMADI
038500200529     I              PDID                            DPDID
038600200529     I              DMINT                           DDMINT
038700200529     I              CMVT                            DCMVT
038800200529     I              CICT                            DCICT
038900200529     I              CRCB                            DCRCB
039000200529     I              CRCD                            DCRCD
039100200529     I              CAID                            DCAID
039200200529     I              MACI                            DMACI
039300200529     I              TMACI                           DTMACI
039400200529     I              PCID                            DPCID
039500200529     I              CMINT                           DCMINT
039600200529     I              DICI                            DDICI
039700200529     I              CICI                            DCICI
039800200529     I              DRCI                            DDRCI
039900200529     I              CRCI                            DCRCI
040000200529     I              VDTC                            DVDTC
040100200529     I              ADTY                            DADTY
040200200529     I              ALTI                            DALTI
040300200529     I              MNBCP                           DMNBCP
040400200529     IREHISPMF
040500200529     I*
040600200529     I** RENAME REHISPMF FORMAT FIELDS - REHISL  FILE
040700200529     I*
040800200529     I              RECI                            DRECI
040900200529     I              HISD                            MHISD
041000200529     I*
041100200529     IREHRDJF
041200200529     I*
041300200529     I** RENAME REHRDJF  FORMAT FIELDS - REHRDJ FILE
041400200529     I*
041500200529     I              RECI                            RRECI
041600200529     I              PSTD                            RPSTD
041700200529     I              VALD                            RVALD
041800200529     I              HISD                            RHISD
041900200529     I              PNAR                            RPNAR
042000200529     I              DRCR                            RDRCR
042100200529     I              TRAT                            RTRAT                                     194059
042200200529     I*
042300200529     IREHRCJF
042400200529     I*
042500200529     I** RENAME REHRCJF  FORMAT FIELDS - REHRCJ FILE
042600200529     I*
042700200529     I              RECI                            RRECI
042800200529     I              PSTD                            RPSTD
042900200529     I              VALD                            RVALD
043000200529     I              HISD                            RHISD
043100200529     I              PNAR                            RPNAR
043200200529     I              DRCR                            RDRCR
043300200529     I              TRAT                            RTRAT                                     194059
043400200529     I*
043500200529     IACCRACJF
043600200529     I*
043700200529     I** RENAME ACCRACJF FORMAT FIELDS - ACCRACJ FILE
043800200529     I*
043900200529     I              TEGLIS                          CTGLIS
044000200529     I*
044100200529     I* BRT ICD
044200200529     ISDBRTDD0
044300200529     I              ACOD                            ACODXX
044400200529     I*
044500200529     ICPYR@#      DS
044600200529     I*
044700200529     I** DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
044800200529     I*
044900200529     I                                        1  80 CPY@
045000200529     I*
045100200529     ISDBANK    E DSSDBANKPD
045200200529     I              BJURPT                          TITL
045300200529     I              BJDNWD                          DNWD
045400200529     I**  EXTERNAL DS FOR BANK DETAILS
045500200529     I**
045600200529     I*
045700200529     ISDRETL    E DSSDRETLPD                                              104618
045800200529     I              BMLDAI                          LDAC                  104618
045900200529     I              BMCBAI                          CBAI                  104618
046000200529     I              BMNDFV                          NDFV                  104618
046100200529     I              BMNDBI                          NDBI                  104618
046200200529     I              BMRCPI                          RCPT                  104618
046300200529     I              BMRANR                          RACN                  104618
046400200529     I**  Retail Details                                                  104618
046500200529     I*                                                                   104618
046600200529     I** DATA STRUCTURE FOR BEGINNING DATE
046700200529     I*
046800200529     I            DS
046900200529     I                                        1   60SRES
047000200529     I                                        1   20ZISD
047100200529     I                                        3   40ZISM
047200200529     I                                        5   60ZISY
047300200529     I*
047400200529     I** DATA STRUCTURE FOR FINISHING DATE
047500200529     I*
047600200529     I            DS
047700200529     I                                        1   60FRES
047800200529     I                                        1   20ZIFD
047900200529     I                                        3   40ZIFM
048000200529     I                                        5   60ZIFY
048100200529     I*
048200200529     I** DATA STRUCTURE FOR CURRENCY DECIMAL
048300200529     I*
048400200529     I            DS
048500200529     I                                        1  150HISB0
048600200529     I                                        1  151HISB1
048700200529     I                                        1  152HISB2
048800200529     I                                        1  153HISB3
048900200529     I*
049000200529     I            DS
049100200529     I                                        1  150TCHR0
049200200529     I                                        1  151TCHR1
049300200529     I                                        1  152TCHR2
049400200529     I                                        1  153TCHR3
049500200529     I*
049600200529     I            DS
049700200529     I                                        1  150TCHN0
049800200529     I                                        1  151TCHN1
049900200529     I                                        1  152TCHN2
050000200529     I                                        1  153TCHN3
050100200529     I*
050200200529     I            DS
050300200529     I                                        1  150CHGP0
050400200529     I                                        1  151CHGP1
050500200529     I                                        1  152CHGP2
050600200529     I                                        1  153CHGP3
050700200529     I*
050800200529     I            DS
050900200529     I                                        1  150CHGR0
051000200529     I                                        1  151CHGR1
051100200529     I                                        1  152CHGR2
051200200529     I                                        1  153CHGR3
051300200529     I*
051400200529     I            DS
051500200529     I                                        1  150CHGN0
051600200529     I                                        1  151CHGN1
051700200529     I                                        1  152CHGN2
051800200529     I                                        1  153CHGN3
051900200529     I*
052000200529     I            DS
052100200529     I                                        1  120TINT0
052200200529     I                                        1  121TINT1
052300200529     I                                        1  122TINT2
052400200529     I                                        1  123TINT3
052500200529     I*
052600200529     I            DS
052700200529     I                                        1  150TGINT0
052800200529     I                                        1  151TGINT1
052900200529     I                                        1  152TGINT2
053000200529     I                                        1  153TGINT3
053100200529     I*
053200200529     I            DS
053300200529     I                                        1  150BRTOT0
053400200529     I                                        1  151BRTOT1
053500200529     I                                        1  152BRTOT2
053600200529     I                                        1  153BRTOT3
053700200529     I*
053800200529     I            DS                                                                          CGL031
053900200529     I                                        1  150EUTAX0                                    CGL031
054000200529     I                                        1  151EUTAX1                                    CGL031
054100200529     I                                        1  152EUTAX2                                    CGL031
054200200529     I                                        1  153EUTAX3                                    CGL031
054300200529      *                                                                                       CGL031
054400200529     I            DS                                                                          CER048
054500200529     I                                        1  150STAX0                                     CER048
054600200529     I                                        1  151STAX1                                     CER048
054700200529     I                                        1  152STAX2                                     CER048
054800200529     I                                        1  153STAX3                                     CER048
054900200529      *                                                                                       CER048
055000200529     I            DS
055100200529     I                                        1  150PSTD0
055200200529     I                                        1  151PSTD1
055300200529     I                                        1  152PSTD2
055400200529     I                                        1  153PSTD3
055500200529     I*
055600200529     I            DS
055700200529     I                                        1  120INT0
055800200529     I                                        1  121INT1
055900200529     I                                        1  122INT2
056000200529     I                                        1  123INT3
056100200529     I*
056200200529     I            DS
056300200529     I                                        1  150OBAL01
056400200529     I                                        1  151OBAL11
056500200529     I                                        1  152OBAL21
056600200529     I                                        1  153OBAL31
056700200529     I*
056800200529     I            DS
056900200529     I                                        1  150OBAL02
057000200529     I                                        1  151OBAL12
057100200529     I                                        1  152OBAL22
057200200529     I                                        1  153OBAL32
057300200529     I*
057400200529     I            DS
057500200529     I                                        1  150OBAL03
057600200529     I                                        1  151OBAL13
057700200529     I                                        1  152OBAL23
057800200529     I                                        1  153OBAL33
057900200529     I*
058000200529     I** DATA STRUCTURE FOR RATE SPREAD
058100200529     I*
058200200529     I            DS
058300200529     I                                        1  36 RAT2
058400200529     I                                    P   1   67RAT21
058500200529     I                                    P   7  127RAT22
058600200529     I                                    P  13  187RAT23
058700200529     I                                    P  19  247RAT24
058800200529     I                                    P  25  307RAT25
058900200529     I                                    P  31  367RAT26
059000200529     I                                        1   6 RATC21
059100200529     I                                        7  12 RATC22
059200200529     I                                       13  18 RATC23
059300200529     I                                       19  24 RATC24
059400200529     I                                       25  30 RATC25
059500200529     I                                       31  36 RATC26
059600200529     I*
059700200529     I            DS
059800200529     I                                        1  36 RAT3
059900200529     I                                    P   1   67RAT31
060000200529     I                                    P   7  127RAT32
060100200529     I                                    P  13  187RAT33
060200200529     I                                    P  19  247RAT34
060300200529     I                                    P  25  307RAT35
060400200529     I                                    P  31  367RAT36
060500200529     I                                        1   6 RATC31
060600200529     I                                        7  12 RATC32
060700200529     I                                       13  18 RATC33
060800200529     I                                       19  24 RATC34
060900200529     I                                       25  30 RATC35
061000200529     I                                       31  36 RATC36
061100200529     I*
061200200529     I** DATA STRUCTURE FOR BALANCE
061300200529     I*
061400200529     I            DS
061500200529     I                                        1  48 BAL2
061600200529     I                                    P   1   80BAL21
061700200529     I                                    P   9  160BAL22
061800200529     I                                    P  17  240BAL23
061900200529     I                                    P  25  320BAL24
062000200529     I                                    P  33  400BAL25
062100200529     I                                    P  41  480BAL26
062200200529     I                                        1   8 BALC21
062300200529     I                                        9  16 BALC22
062400200529     I                                       17  24 BALC23
062500200529     I                                       25  32 BALC24
062600200529     I                                       33  40 BALC25
062700200529     I                                       41  48 BALC26
062800200529     I*
062900200529     I            DS
063000200529     I                                        1  48 BAL3
063100200529     I                                    P   1   80BAL31
063200200529     I                                    P   9  160BAL32
063300200529     I                                    P  17  240BAL33
063400200529     I                                    P  25  320BAL34
063500200529     I                                    P  33  400BAL35
063600200529     I                                    P  41  480BAL36
063700200529     I                                        1   8 BALC31
063800200529     I                                        9  16 BALC32
063900200529     I                                       17  24 BALC33
064000200529     I                                       25  32 BALC34
064100200529     I                                       33  40 BALC35
064200200529     I                                       41  48 BALC36
064300200529     I*
064400200529     I** DATA STRUCTURE FOR DATE FORMAT DD/MM/YY
064500200529     I*
064600200529     I            DS
064700200529     I                                        1   60RESULT
064800200529     I                                        1   20ZDAY
064900200529     I                                        3   40ZMTH
065000200529     I                                        5   60ZYEAR
065100200529     I*
065200200529     I**  DATA STRUCTURE FOR CHANGE OF ACCOUNT
065300200529     I*
065400200529     IOKEYD       DS
065500200529     I**********                              1  18 OKEY                                      CGL029
065600200529     I                                        1  24 OKEY                                      CGL029
065700200529     I                                        1   3 OBRCA
065800200529     I**********                              4   90OCNUM                                     CSD027
065900200529     I                                        4   9 OCNUM                                     CSD027
066000200529     I                                       10  12 OCCY
066100200529     I**********                             13  160OACOD                                     CGL029
066200200529     I**********                             17  180OACSQ                                     CGL029
066300200529     I**********                          P  19  210OLDID                                     CGL029
066400200529     I                                       13  220OACOD                                     CGL029
066500200529     I                                       23  240OACSQ                                     CGL029
066600200529     I                                    P  25  270OLDID                                     CGL029
066700200529     I*
066800200529     I**   NAME OF MESSAGE FILE
066900200529     I*
067000200529     I            DS
067100200529     I                                        1  39 CMD1
067200200529     I                                       16  17 FILT1
067300200529     I                                       33  34 FILT2
067400200529     I*
067500200529     I**  DATA STRUCTURE FOR REFERENCE ADDRESS
067600200529     I*
067700200529     I                                        1   8 ADREF1
067800200529     I                                        1   1 WRCDT
067900200529     I*
068000200529     I**  DATA STRUCTURE FOR TABLEV4
068100200529     I*
068200200529     IKEY         DS
068300200529     I                                        1   20RECT
068400200529     I                                        3  12 ZZ010
068500200529     I*
068600200529     I**  DATA STRUCTURE IN CASE OF DATA BASE ERROR
068700200529     I*
068800200529     IRKEY2       DS
068900200529     I                                        1  18 RKEY
069000200529     I                                        1   3 CBRCA
069100200529     I**********                              4   90CCNUM                                     CSD027
069200200529     I                                        4   9 CCNUM                                     CSD027
069300200529     I                                       10  12 CCCY
069400200529     I**********                             13  160CACOD                                     CGL029
069500200529     I**********                             17  180CACSQ                                     CGL029
069600200529     I**********                             19  230WDATE                                     CGL029
069700200529     I                                       13  220CACOD                                     CGL029
069800200529     I                                       23  240CACSQ                                     CGL029
069900200529     I                                       25  290WDATE                                     CGL029
070000200529     I                                        1   3 CBRCA2
070100200529     I**********                              4  18 AKEY                                      CGL029
070200200529     I                                        4  24 AKEY                                      CGL029
070300200529     I*
070400200529     I** LOCAL DATA AREA FOR DATABASE ERROR DETAILS
070500200529     I*
070600200529     ILDA        UDS                            256
070700200529     I                                      134 141 DBFILE
070800200529     I                                      142 170 DBKEY
070900200529     I                                      171 180 DBPGM
071000200529     I                                      181 1830DBASE
071100200529     I********************************************************************
071200200529     I**
071300200529     I**   FILE INFORMATION DATA STRUCTURE - P1
071400200529     I**
071500200529     ISPOOL       DS
071600200529     I                                       83  92 SFILE
071700200529     I                                    B 123 1240SFNUM
071800200529     I**
071900200529     ISPOOL1      DS
072000200529     I                                       83  92 SFILE1
072100200529     I                                    B 123 1240SFNUM1
072200200529     I**
072300200529     I**   FILE INFORMATION DATA STRUCTURE - AU
072400200529     I**
072500200529     ISPOOLU      DS
072600200529     I                                       83  92 SFILEU
072700200529     I                                    B 123 1240SFNUMU
072800200529     I**
072900200529     I** DATA AREA RUNDAT
073000200529     I**
073100200529     IRUNDT       DS
073200200529     I                                        1   7 RUNA
073300200529     I                                    P   8  100RUND
073400200529     I                                       11  11 SSF
073500200529     I                                       12  12 DATF
073600200529     I                                       13  13 MBIN
073700200529     I/COPY WNCPYSRC,RE3765I003
073800200529     ISDBRCH    E DSSDBRCHPD
073900200529     I**
074000200529     I              A8BRNM                          BRNM
074100200529     I*
074200200529     ISDCUST    E DSSDCUSTPD
074300200529     I** Customer Details
074400200529     I              BBCGRP                          CUCGRP
074500200529     I              QQDFAC                          QQDFA1                                    CGL029
074600200529     I*
074700200529     ISCSARD    E DSSCSARDPD                                              CFT004
074800200529      ** MIDAS Switchable Features Accessed Via Access Program            CFT004
074900200529      *                                                                   CFT004
075000200529     IACCNTB    E DSACCNTAB                                               CFT004
075100200529      ** MIDAS Account Master Details Accessed Via Access Program         CFT004
075200200529      *                                                                   CFT004
075300200529     I              ADREF1                          ADREFX                CFT004
075400200529     I              LCD                             LCDX                  CFT004
075500200529     IDSFDY     E DSDSFDY
075600200529     I* First DS for access programs, short data structure
075700200529     I*
075800200529     I/COPY WNCPYSRC,RE3765I002
075900200529     IDSSDY     E DSDSSDY
076000200529     I* Second DS for access programs, long data structure
076100200529     I*                                                                   084174
076200200529     I*___________________________________________________________________084174
076300200529     I* 084174                                                            084174
076400200529     I*                                                                   084174
076500200529     I***P#CORR    E DSCGCORRPD                                     084174087284
076600200529     I*                                                                   087284
076700200529     I* Data structure for returned values from AOALTNR0 --               087284
076800200529     I*  alternative names and addresses                                  087284
076900200529     I*                                                                   087284
077000200529     IP#ALTN    E DSSDALTNPD                                              087284
077100200529     I*                                                                   087284
077200200529     I* Data structure for returned values from AOALTNR0 --               087284
077300200529     I*  alternative names and addresses                                  087284
077400200529     I*                                                                   087284
077500200529     I* 084174                                                            084174
077600200529     I*~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~084174
077700200529      ** Constants definition                                                                 CER050
077800200529     I              'APR Debit Rate '     C         APRDRT                                    CER050
077900200529     I              'APR Credit Rate'     C         APRCRT                                    CER050
078000200529     I*
078100200529     C*===================================================================
078200200529     C                     MOVEACPY@      BIS@   80
078300200529     C           *NAMVAR   DEFN           LDA
078400200529     C*
078500200529     C** KEY LISTS
078600200529     C*
078700200529     C*
078800200529     C** KEY FIELD TO ACCESS TO FILE
078900200529     C*
079000200529     C**  KLIST TO ACCESS RECOM
079100200529     C*
079200200529     C           KLIST0    KLIST
079300200529     C                     KFLD           CBRCA
079400200529     C                     KFLD           CCNUM
079500200529     C                     KFLD           CCCY
079600200529     C                     KFLD           CACOD
079700200529     C                     KFLD           CACSQ
079800200529     C*
079900200529     C**  KLIST TO ACCESS REHISL, REHPOPL, REHPOPH, REHISSL & ACCRACJ
080000200529     C*
080100200529     C           KLIST1    KLIST
080200200529     C                     KFLD           CBRCA
080300200529     C                     KFLD           CCNUM
080400200529     C                     KFLD           CCCY
080500200529     C                     KFLD           CACOD
080600200529     C                     KFLD           CACSQ
080700200529     C*
080800200529     C**  KLIST TO ACCESS REHISL, REHPOPH & REHPOPL
080900200529     C*
081000200529     C           KLIST2    KLIST
081100200529     C                     KFLD           CBRCA
081200200529     C                     KFLD           CCNUM
081300200529     C                     KFLD           CCCY
081400200529     C                     KFLD           CACOD
081500200529     C                     KFLD           CACSQ
081600200529     C                     KFLD           CLDID
081700200529     C*
081800200529     C**  KLIST TO ACCESS REHISL, REHPOPH & REHPOPL
081900200529     C*
082000200529     C           KLIST3    KLIST
082100200529     C                     KFLD           CBRCA
082200200529     C                     KFLD           CCNUM
082300200529     C                     KFLD           CCCY
082400200529     C                     KFLD           CACOD
082500200529     C                     KFLD           CACSQ
082600200529     C                     KFLD           CLCID
082700200529     C*
082800200529     C**  KLIST TO ACCESS CLINT
082900200529     C*
083000200529     C           KLIST4    KLIST
083100200529     C                     KFLD           CCNUM
083200200529     C                     KFLD           RCDT
083300200529     C*
083400200529     C**  KLIST TO ACCESS REHRDJ
083500200529     C*
083600200529     C           KLIST5    KLIST
083700200529     C                     KFLD           CBRCA
083800200529     C                     KFLD           CCNUM
083900200529     C                     KFLD           CCCY
084000200529     C                     KFLD           CACOD
084100200529     C                     KFLD           CACSQ
084200200529     C                     KFLD           DDRCD
084300200529     C*
084400200529     C**  KLIST TO ACCESS REHRCJ
084500200529     C*
084600200529     C           KLIST6    KLIST
084700200529     C                     KFLD           CBRCA
084800200529     C                     KFLD           CCNUM
084900200529     C                     KFLD           CCCY
085000200529     C                     KFLD           CACOD
085100200529     C                     KFLD           CACSQ
085200200529     C                     KFLD           DCRCD
085300200529     C*
085400200529      **  KLIST TO ACCESS SDCSINL7                                                            CGL031
085500200529      *                                                                                       CGL031
085600200529     C           KLIST7    KLIST                                                              CGL031
085700200529     C                     KFLD           RUND                                                CGL031
085800200529     C                     KFLD           MODI    1                                           CGL031
085900200529     C                     KFLD           P#NUM   6                                           CGL031
086000200529     C                     KFLD           CCCY                                                CGL031
086100200529     C                     KFLD           CACOD                                               CGL031
086200200529     C                     KFLD           CACSQ                                               CGL031
086300200529     C                     KFLD           CBRCA                                               CGL031
086400200529     C*                                                                                       CGL031
086500200529      ** Key fields to access LF/SDCSINLC.                                                    235917
086600200529      *                                                                                       235917
086700200529     C           KLISTC    KLIST                                                              235917
086800200529     C                     KFLD           RUND                                                235917
086900200529     C                     KFLD           MODI                                                235917
087000200529     C                     KFLD           KJOIN                                               235917
087100200529     C                     KFLD           CCCY                                                235917
087200200529     C                     KFLD           CACOD                                               235917
087300200529     C                     KFLD           CACSQ                                               235917
087400200529     C                     KFLD           CBRCA                                               235917
087500200529     C*                                                                                       235917
087600200529     C**  KLIST TO ACCESS CLEAR
087700200529     C*
087800200529     C           KCLEAR    KLIST
087900200529     C                     KFLD           CBRCA
088000200529     C                     KFLD           CCNUM
088100200529     C                     KFLD           CCCY
088200200529     C                     KFLD           CACOD
088300200529     C                     KFLD           CACSQ
088400200529     C*
088500200529     C**  KLIST TO ACCESS ACCNT
088600200529     C*
088700200529     C           KACCNT    KLIST
088800200529     C                     KFLD           CCNUM
088900200529     C                     KFLD           CCCY
089000200529     C                     KFLD           CACOD
089100200529     C                     KFLD           CACSQ
089200200529     C                     KFLD           CBRCA
089300200529     C*
089400200529     C**  KLIST TO ACCESS REEODLF
089500200529     C*
089600200529     C           KEODLF    KLIST
089700200529     C                     KFLD           CBRCA
089800200529     C                     KFLD           CCNUM
089900200529     C                     KFLD           CCCY
090000200529     C                     KFLD           CACOD
090100200529     C                     KFLD           CACSQ
090200200529     C                     KFLD           KDATE
090300200529     C*
090400200529     C**  KLIST TO ACCESS REHPOPH
090500200529     C*
090600200529     C           KREHP     KLIST
090700200529     C                     KFLD           CBRCA
090800200529     C                     KFLD           CCNUM
090900200529     C                     KFLD           CCCY
091000200529     C                     KFLD           CACOD
091100200529     C                     KFLD           CACSQ
091200200529     C                     KFLD           KDATE
091300200529     C                     KFLD           KDATE2
091400200529     C*
091500200529     C** PARAMTER SEND BY THE CL: IT IS THE LANGUAGE CODE DEFAULT
091600200529     C*
091700200529     C           *ENTRY    PLIST
091800200529     C                     PARM           DLGID
091900200529     C*
092000200529     C** SET UP PARAMETER TO FORM OUTPUT LINE
092100200529     C*
092200200529     C           ZA1311    PLIST
092300200529     C                     PARM           MSGID   7
092400200529     C                     PARM           MSGDT0 40
092500200529     C                     PARM           MSGDT1 40
092600200529     C                     PARM           MSGDT2 40
092700200529     C                     PARM           MSGDT3 40
092800200529     C                     PARM           MSGDT4 40
092900200529     C                     PARM           MSGDT5 40
093000200529     C                     PARM           MSGDT6 40
093100200529     C                     PARM           MSGDT7 40
093200200529     C                     PARM           MSGDT8 40
093300200529     C                     PARM           MSGDT9 40
093400200529     C                     PARM           MNARR 200
093500200529     C*
093600200529     C** WORK FIELDS DEFINITION
093700200529     C*
093800200529     C           *LIKE     DEFN LGID      OLGID
093900200529     C           *LIKE     DEFN DDAID     WDAID
094000200529     C           *LIKE     DEFN DCAID     WCAID
094100200529     C           *LIKE     DEFN LGID      DLGID
094200200529     C           *LIKE     DEFN DBKEY     ERRDAT
094300200529     C********** *LIKE     DEFN CNUM      I     - 3                                           CSD027
094400200529     C                     Z-ADD*ZEROS    I       30                                          CSD027
094500200529     C           *LIKE     DEFN RUND      PPSTD
094600200529     C********** *LIKE     DEFN CNUM      PSTDO                                               CSD027
094700200529     C                     Z-ADD*ZEROS    PSTDO   60                                          CSD027
094800200529     C           *LIKE     DEFN RUND      PVALD
094900200529     C********** *LIKE     DEFN CNUM      VALDO                                               CSD027
095000200529     C                     Z-ADD*ZEROS    VALDO   60                                          CSD027
095100200529     C           *LIKE     DEFN ACNO      WACNO
095200200529     C           *LIKE     DEFN DCRCB     WCRCB
095300200529     C           *LIKE     DEFN DDRCB     WDRCB
095400200529     C           *LIKE     DEFN DHISB     WHISB
095500200529     C           *LIKE     DEFN DHISD     WHISD
095600200529     C           *LIKE     DEFN DHISD     WWHISD
095700200529     C           *LIKE     DEFN DHISD     WHISDC
095800200529     C           *LIKE     DEFN DHISD     WHISDD
095900200529     C           *LIKE     DEFN MNBL      WMNBL
096000200529     C           *LIKE     DEFN DHISB     W1STBL
096100200529     C           *LIKE     DEFN DHISB     W2STBL
096200200529     C           *LIKE     DEFN DHISB     DOHISB
096300200529     C           *LIKE     DEFN DHISB     COHISB
096400200529     C********** *LIKE     DEFN CNUM      ZERROR- 5                                           CSD027
096500200529     C                     Z-ADD*ZEROS    ZERROR  10                                          CSD027
096600200529     C           *LIKE     DEFN RUND      ZIBEG
096700200529     C           *LIKE     DEFN RUND      ZIBW1
096800200529     C           *LIKE     DEFN RUND      ZIDREM
096900200529     C           *LIKE     DEFN CICT      ZIDW1
097000200529     C           *LIKE     DEFN RUND      ZIDW2
097100200529     C           *LIKE     DEFN RUND      ZID1
097200200529     C           *LIKE     DEFN RUND      ZID2
097300200529     C           *LIKE     DEFN RUND      ZIEND
097400200529     C           *LIKE     DEFN RUND      ZILPCP
097500200529     C           *LIKE     DEFN CICT      ZIMAN
097600200529     C           *LIKE     DEFN CICT      ZIM1
097700200529     C           *LIKE     DEFN RUND      ZIREM
097800200529     C           *LIKE     DEFN CICT      ZIY1
097900200529     C*
098000200529     C/COPY WNCPYSRC,RE3765C001
098100200529     C*===================================================================
098200200529     C*
098300200529     C/EJECT
098400200529     C*===================================================================
098500200529     C** P R O G R A M     S T A R T
098600200529     C*===================================================================
098700200529     C*
098800200529     C** FIRST CYCLE PROCESSING
098900200529     C*
099000200529     C                     EXSR FIRST
099100200529     C*
099200200529     C** MAIN PROCESSING
099300200529     C*
099400200529     C                     EXSR MAIN
099500200529     C*
099600200529     C** TOTAL PROCESSING
099700200529     C*
099800200529     C                     EXSR TOTAL
099900200529     C*
100000200529     C*===================================================================
100100200529     C** P R O G R A M     E N D
100200200529     C*===================================================================
100300200529     C/EJECT
100400200529     C********************************************************************
100500200529     C**
100600200529     C** BOTHSR subroutine for debit and credit output processing
100700200529     C**
100800200529     C**     Called by       D E T P R
100900200529     C**
101000200529     C**     Calls           DBSR, B1EQ, B1LT, B1GT, POSTSR, RATESR
101100200529     C**                     TOTSR, ZICD
101200200529     C**
101300200529     C           BOTHSR    BEGSR                           **BOTHSR BEGSR*
101400200529     C*
101500200529     C           KLIST2    CHAINREHISL               52
101600200529     C*
101700200529     C           *IN52     IFEQ '1'                        - B1
101800200529     C                     Z-ADDCLDID     WDATE
101900200529     C                     Z-ADD1         DBASE
102000200529     C                     MOVE 'REHISL'  DBFILE           ***************
102100200529     C                     MOVELRKEY2     DBKEY            **DB ERROR 01**
102200200529     C                     MOVEA'1'       *IN,89           ***************
102300200529     C                     EXSR DBSR
102400200529     C                     END                             - E1
102500200529     C*
102600200529     C           DRECI     IFEQ 'B'                        - B1
102700200529     C                     Z-ADD*ZEROS    W1STBL
102800200529     C                     Z-ADDDDRCD     WWDRCD  50
102900200529     C                     Z-ADDDCRCD     WWCRCD  50
103000200529     C                     ELSE                            - X1
103100200529     C           DRECI     IFEQ 'S'                        - B2
103200200529     C                     Z-ADDSSTBL     W1STBL
103300200529     C                     Z-ADDSDRCD     WWDRCD
103400200529     C                     Z-ADDSCRCD     WWCRCD
103500200529     C                     ELSE                            - X2
103600200529     C                     Z-ADDCLDID     WDATE
103700200529     C                     Z-ADD2         DBASE
103800200529     C                     MOVE 'REHISL'  DBFILE           ***************
103900200529     C                     MOVELRKEY2     DBKEY            **DB ERROR 02**
104000200529     C                     MOVEA'1'       *IN,89           ***************
104100200529     C                     EXSR DBSR
104200200529     C                     END                             - E2
104300200529     C                     END                             - E1
104400200529     C                     Z-ADDDHISB     DOHISB
104500200529     C                     Z-ADDCLDID     WHISDD
104600200529     C*
104700200529     C           KLIST3    CHAINREHISL               52
104800200529     C*
104900200529     C           *IN52     IFEQ '1'                        - B1
105000200529     C                     Z-ADDCLCID     WDATE
105100200529     C                     Z-ADD3         DBASE
105200200529     C                     MOVE 'REHISL'  DBFILE           ***************
105300200529     C                     MOVELRKEY2     DBKEY            **DB ERROR 03**
105400200529     C                     MOVEA'1'       *IN,89           ***************
105500200529     C                     EXSR DBSR
105600200529     C                     END                             - E1
105700200529     C*
105800200529     C           DRECI     IFEQ 'B'                        - B1
105900200529     C                     Z-ADD*ZEROS    W2STBL
106000200529     C                     ELSE                            - X1
106100200529     C           DRECI     IFEQ 'S'                        - B2
106200200529     C                     Z-ADDSSTBL     W2STBL
106300200529     C                     ELSE                            - X2
106400200529     C                     Z-ADDCLCID     WDATE
106500200529     C                     Z-ADD4         DBASE
106600200529     C                     MOVE 'REHISL'  DBFILE           ***************
106700200529     C                     MOVELRKEY2     DBKEY            **DB ERROR 04**
106800200529     C                     MOVEA'1'       *IN,89           ***************
106900200529     C                     EXSR DBSR
107000200529     C                     END                             - E2
107100200529     C                     END                             - E1
107200200529     C                     Z-ADDDHISB     COHISB
107300200529     C                     Z-ADDCLCID     WHISDC
107400200529     C*
107500200529     C           CLDID     IFLT CLCID                      - B1
107600200529     C           KLIST2    CHAINREHISL               52
107700200529     C                     END                             - E1
107800200529     C*
107900200529     C                     MOVE '0'       *IN65
108000200529     C           ACNO      IFNE *ZEROS
108100200529     C                     MOVE '1'       *IN65
108200200529     C                     END
108300200529     C/COPY WNCPYSRC,RE3765C010
108400200529     C                     WRITEHEADDC
108500200529     C*
108600200529     C* CHARGE REPORT IF NECESSARY
108700200529     C*
108800200529     C           CCICI     IFNE *BLANK                     - B1
108900200529     C           CCHGP     ANDNE*ZERO
109000200529     C/COPY WNCPYSRC,RE3765C011
109100200529     C                     WRITEHEADCH
109200200529     C                     END                             - E1
109300200529     C*
109400200529     C                     MOVE *BLANKS   VALDA
109500200529     C*
109600200529     C                     EXSR CLMSG
109700200529     C                     MOVELNAR,1     TNARR
109800200529     C*
109900200529     C           CLDID     IFLT CLCID                      - B1
110000200529     C                     Z-SUBW1STBL    HISB0
110100200529     C                     ELSE                            - X1
110200200529     C                     Z-SUBW2STBL    HISB0
110300200529     C                     END                             - E1
110400200529     C                     Z-ADDDHISB     WHISB
110500200529     C*
110600200529     C**  B/F BALANCE OUTPUT
110700200529     C*
110800200529     C                     WRITETITLEDC
110900200529     C*
111000200529     C**  PROCESS BACK VALUE AND OPENING
111100200529     C*
111200200529     C           CLDID     CASEQCLCID     B1EQ
111300200529     C           CLDID     CASLTCLCID     B1LT
111400200529     C           CLDID     CASGTCLCID     B1GT
111500200529     C                     CAS            DBSR
111600200529     C                     END
111700200529     C*
111800200529     C           DRECI     IFEQ 'S'                        - B1
111900200529     C                     Z-ADDDHISD     WWHISD
112000200529     C                     Z-ADDDHISB     WHISB
112100200529     C                     Z-ADDSMNBL     WMNBL
112200200529     C                     Z-ADDDDRCB     WDRCB
112300200529     C                     Z-ADDDCRCB     WCRCB
112400200529     C           KLIST1    READEREHISL                   51
112500200529     C*
112600200529     C           *IN51     IFEQ '0'                        - B2
112700200529     C           WWHISD    ANDNEDHISD
112800200529     C           DRECI     ANDNE'S'
112900200529     C*
113000200529     C           CDICT     IFLT 3                          - B3
113100200529     C           CCICT     ANDLT3
113200200529     C*
113300200529     C**  PROCESS IN CASE OF INTEREST TYPE ARE BOTH LESS THAN 3
113400200529     C*
113500200529     C           WHISB     IFGT *ZEROS                     - B4
113600200529     C*
113700200529     C**  PROCESS WHEN CHANGE RATE DEBIT
113800200529     C*
113900200529     C                     Z-ADDWDRCB     ZICALC
114000200529     C                     Z-ADDWWHISD    ZIBEG
114100200529     C                     Z-ADDDHISD     ZIEND
114200200529     C*
114300200529     C                     EXSR ZICD
114400200529     C*
114500200529     C                     Z-ADDZDAYN1    DAYS
114600200529     C                     Z-SUBDOHISB    HISB0
114700200529     C*
114800200529     C           *IN80     IFEQ '1'                        - B5
114900200529     C           HISB0     MULT DAYS      NUMB0
115000200529     C                     ELSE                            - X5
115100200529     C           *IN81     IFEQ '1'                        - B6
115200200529     C           HISB1     MULT DAYS      NUMB0
115300200529     C                     ELSE                            - X6
115400200529     C           *IN82     IFEQ '1'                        - B7
115500200529     C           HISB2     MULT DAYS      NUMB0
115600200529     C                     ELSE                            - X7
115700200529     C           HISB3     MULT DAYS      NUMB0
115800200529     C                     END                             - E7
115900200529     C                     END                             - E6
116000200529     C                     END                             - E5
116100200529     C*
116200200529     C           DCAID     SUB  DDAID     INT0
116300200529     C*
116400200529     C           DAYS      IFNE *ZEROS                     - B5
116500200529     C*
116600200529     C           NUMB0     IFLT *ZEROS
116700200529     C                     ADD  NUMB0     WWTND
116800200529     C                     ELSE
116900200529     C                     ADD  NUMB0     WWTNC
117000200529     C                     END
117100200529     C                     EXSR OVERDC
117200200529     C                     WRITESTOTDC
117300200529     C*
117400200529     C* CHARGE REPORT IF NECESSARY
117500200529     C*
117600200529     C           CCICI     IFNE *BLANK                     - B6
117700200529     C           DTHGAR    IFNE *ZERO                      - B7
117800200529     C           DTHGAN    ORNE *ZERO
117900200529     C                     Z-SUBDTHGAR    CHGR0
118000200529     C                     Z-SUBDTHGAN    CHGN0
118100200529     C                     WRITEPOSTCH
118200200529     C                     END                             - E7
118300200529     C                     END                             - E6
118400200529     C*
118500200529     C                     END                             - E5
118600200529     C*
118700200529     C                     ELSE                            - X4
118800200529     C*
118900200529     C**  PROCESS WHEN CHANGE RATE CREDIT
119000200529     C*
119100200529     C                     Z-ADDWCRCB     ZICALC
119200200529     C                     Z-ADDWWHISD    ZIBEG
119300200529     C                     Z-ADDDHISD     ZIEND
119400200529     C*
119500200529     C                     EXSR ZICD
119600200529     C*
119700200529     C                     Z-ADDZDAYN1    DAYS
119800200529     C                     Z-SUBCOHISB    HISB0
119900200529     C*
120000200529     C           *IN80     IFEQ '1'                        - B5
120100200529     C           HISB0     MULT DAYS      NUMB0
120200200529     C                     ELSE                            - X5
120300200529     C           *IN81     IFEQ '1'                        - B6
120400200529     C           HISB1     MULT DAYS      NUMB0
120500200529     C                     ELSE                            - X6
120600200529     C           *IN82     IFEQ '1'                        - B7
120700200529     C           HISB2     MULT DAYS      NUMB0
120800200529     C                     ELSE                            - X7
120900200529     C           HISB3     MULT DAYS      NUMB0
121000200529     C                     END                             - E7
121100200529     C                     END                             - E6
121200200529     C                     END                             - E5
121300200529     C*
121400200529     C           DCAID     SUB  DDAID     INT0
121500200529     C*
121600200529     C           DAYS      IFNE *ZEROS                     - B5
121700200529     C*
121800200529     C           NUMB0     IFLT *ZEROS
121900200529     C                     ADD  NUMB0     WWTND
122000200529     C                     ELSE
122100200529     C                     ADD  NUMB0     WWTNC
122200200529     C                     END
122300200529     C                     EXSR OVERDC
122400200529     C                     WRITESTOTDC
122500200529     C*
122600200529     C* CHARGE REPORT IF NECESSARY
122700200529     C*
122800200529     C           CCICI     IFNE *BLANK                     - B6
122900200529     C           DTHGAR    IFNE *ZERO                      - B7
123000200529     C           DTHGAN    ORNE *ZERO
123100200529     C                     Z-SUBDTHGAR    CHGR0
123200200529     C                     Z-SUBDTHGAN    CHGN0
123300200529     C                     WRITEPOSTCH
123400200529     C                     END                             - E7
123500200529     C                     END                             - E6
123600200529     C*
123700200529     C                     END                             - E5
123800200529     C*
123900200529     C                     END                             - E4
124000200529     C*
124100200529     C                     ELSE                            - X3
124200200529     C*
124300200529     C           CDICT     IFGT 2                          - B4
124400200529     C           CCICT     ANDGT2
124500200529     C*
124600200529     C**  PROCESS IN CASE OF INTEREST TYPE ARE BOTH GREATER THAN 3
124700200529     C*
124800200529     C**  PROCESS OUTPUT CHANGING DAY
124900200529     C*
125000200529     C                     Z-SUBWMNBL     HISB0
125100200529     C                     EXSR OVERDC
125200200529     C                     WRITEODAYDC
125300200529     C*
125400200529     C           DRECI     IFEQ 'M'                        - B5
125500200529     C*
125600200529     C           DSDAT     IFNE *ZEROS                     - B6
125700200529     C           MNBL      ANDGT*ZEROS
125800200529     C*
125900200529     C**  PROCESS DEBIT
126000200529     C*
126100200529     C                     Z-ADDWDRCB     ZICALC
126200200529     C                     Z-ADDWWHISD    ZIBEG
126300200529     C                     Z-ADDMHISD     ZIEND
126400200529     C                     EXSR ZICD
126500200529     C                     Z-ADDZDAYN1    DAYS
126600200529     C                     Z-SUBDINT      INT0
126700200529     C*
126800200529     C           MNBL      MULT DAYS      NUMB0
126900200529     C*
127000200529     C           *IN80     IFEQ '1'                        - B7
127100200529     C*
127200200529     C                     ELSE                            - X7
127300200529     C           *IN81     IFEQ '1'                        - B8
127400200529     C           NUMB0     DIV  10        NUMB0
127500200529     C                     ELSE                            - X8
127600200529     C           *IN82     IFEQ '1'                        - B9
127700200529     C           NUMB0     DIV  100       NUMB0
127800200529     C                     ELSE                            - X9
127900200529     C           NUMB0     DIV  1000      NUMB0
128000200529     C                     END                             - E9
128100200529     C                     END                             - E8
128200200529     C                     END                             - E7
128300200529     C                     Z-SUBNUMB0     NUMB0
128400200529     C           NUMB0     IFLT *ZEROS
128500200529     C                     ADD  NUMB0     WWTND
128600200529     C                     ELSE
128700200529     C                     ADD  NUMB0     WWTNC
128800200529     C                     END
128900200529     C                     EXSR OVERDC
129000200529     C                     WRITESTODDC
129100200529     C                     Z-ADDMHISD     WHISDD
129200200529     C                     Z-ADDMNBL      WMNBL
129300200529     C*
129400200529     C                     END                             - E6
129500200529     C*
129600200529     C           CSDAT     IFNE *ZEROS                     - B6
129700200529     C           MNBL      ANDLT*ZEROS
129800200529     C*
129900200529     C**  PROCESS CREDIT
130000200529     C*
130100200529     C                     Z-ADDWCRCB     ZICALC
130200200529     C                     Z-ADDWWHISD    ZIBEG
130300200529     C                     Z-ADDMHISD     ZIEND
130400200529     C                     EXSR ZICD
130500200529     C                     Z-ADDZDAYN1    DAYS
130600200529     C                     Z-ADDCINT      INT0
130700200529     C           MNBL      MULT DAYS      NUMB0
130800200529     C*
130900200529     C           *IN80     IFEQ '1'                        - B7
131000200529     C*
131100200529     C                     ELSE                            - X7
131200200529     C           *IN81     IFEQ '1'                        - B8
131300200529     C           NUMB0     DIV  10        NUMB0
131400200529     C                     ELSE                            - X8
131500200529     C           *IN82     IFEQ '1'                        - B9
131600200529     C           NUMB0     DIV  100       NUMB0
131700200529     C                     ELSE                            - X9
131800200529     C           NUMB0     DIV  1000      NUMB0
131900200529     C                     END                             - E9
132000200529     C                     END                             - E8
132100200529     C                     END                             - E7
132200200529     C                     Z-SUBNUMB0     NUMB0
132300200529     C           NUMB0     IFLT *ZEROS
132400200529     C                     ADD  NUMB0     WWTND
132500200529     C                     ELSE
132600200529     C                     ADD  NUMB0     WWTNC
132700200529     C                     END
132800200529     C                     EXSR OVERDC
132900200529     C                     WRITESTODDC
133000200529     C                     Z-ADDMHISD     WHISDC
133100200529     C                     Z-ADDMNBL      WMNBL
133200200529     C*
133300200529     C                     END                             - E6
133400200529     C*
133500200529     C**  PROCESS UNTIL READING OTHER THAN 'M'
133600200529     C*
133700200529     C           DRECI     DOWEQ'M'                        - B6
133800200529     C           *IN51     ANDEQ'0'
133900200529     C*
134000200529     C           KLIST1    READEREHISL                   51
134100200529     C*
134200200529     C           *IN51     IFEQ '0'                        - B7
134300200529     C*
134400200529     C           DRECI     IFEQ 'M'                        - B8
134500200529     C*
134600200529     C           DSDAT     IFNE *ZEROS                     - B9
134700200529     C           MNBL      ANDGT*ZEROS
134800200529     C*
134900200529     C**  PROCESS DEBIT
135000200529     C*
135100200529     C                     Z-ADDWDRCB     ZICALC
135200200529     C                     Z-ADDWWHISD    ZIBEG
135300200529     C                     Z-ADDMHISD     ZIEND
135400200529     C                     EXSR ZICD
135500200529     C                     Z-ADDZDAYN1    DAYS
135600200529     C                     Z-SUBDINT      INT0
135700200529     C           MNBL      MULT DAYS      NUMB0
135800200529     C*
135900200529     C           *IN80     IFEQ '1'                        - B10
136000200529     C*
136100200529     C                     ELSE                            - X10
136200200529     C           *IN81     IFEQ '1'                        - B11
136300200529     C           NUMB0     DIV  10        NUMB0
136400200529     C                     ELSE                            - X11
136500200529     C           *IN82     IFEQ '1'                        - B12
136600200529     C           NUMB0     DIV  100       NUMB0
136700200529     C                     ELSE                            - X12
136800200529     C           NUMB0     DIV  1000      NUMB0
136900200529     C                     END                             - E12
137000200529     C                     END                             - E11
137100200529     C                     END                             - E10
137200200529     C                     Z-SUBNUMB0     NUMB0
137300200529     C           NUMB0     IFLT *ZEROS
137400200529     C                     ADD  NUMB0     WWTND
137500200529     C                     ELSE
137600200529     C                     ADD  NUMB0     WWTNC
137700200529     C                     END
137800200529     C                     EXSR OVERDC
137900200529     C                     WRITESTODDC
138000200529     C                     Z-ADDMHISD     WHISDD
138100200529     C                     Z-ADDMNBL      WMNBL
138200200529     C*
138300200529     C                     END                             - E9
138400200529     C*
138500200529     C           CSDAT     IFNE *ZEROS                     - B9
138600200529     C           MNBL      ANDLT*ZEROS
138700200529     C*
138800200529     C**  PROCESS CREDIT
138900200529     C*
139000200529     C                     Z-ADDWCRCB     ZICALC
139100200529     C                     Z-ADDWWHISD    ZIBEG
139200200529     C                     Z-ADDMHISD     ZIEND
139300200529     C                     EXSR ZICD
139400200529     C                     Z-ADDZDAYN1    DAYS
139500200529     C                     Z-ADDCINT      INT0
139600200529     C           MNBL      MULT DAYS      NUMB0
139700200529     C*
139800200529     C           *IN80     IFEQ '1'                        - B10
139900200529     C*
140000200529     C                     ELSE                            - X10
140100200529     C           *IN81     IFEQ '1'                        - B11
140200200529     C           NUMB0     DIV  10        NUMB0
140300200529     C                     ELSE                            - X11
140400200529     C           *IN82     IFEQ '1'                        - B12
140500200529     C           NUMB0     DIV  100       NUMB0
140600200529     C                     ELSE                            - X12
140700200529     C           NUMB0     DIV  1000      NUMB0
140800200529     C                     END                             - E12
140900200529     C                     END                             - E11
141000200529     C                     END                             - E10
141100200529     C                     Z-SUBNUMB0     NUMB0
141200200529     C           NUMB0     IFLT *ZEROS
141300200529     C                     ADD  NUMB0     WWTND
141400200529     C                     ELSE
141500200529     C                     ADD  NUMB0     WWTNC
141600200529     C                     END
141700200529     C                     EXSR OVERDC
141800200529     C                     WRITESTODDC
141900200529     C                     Z-ADDMHISD     WHISDC
142000200529     C                     Z-ADDMNBL      WMNBL
142100200529     C*
142200200529     C                     END                             - E9
142300200529     C*
142400200529     C                     ELSE                            - X8
142500200529     C*
142600200529     C           DRECI     IFEQ 'S'                        - B9
142700200529     C*
142800200529     C**  PROCESS A S RECORD
142900200529     C*
143000200529     C***********SDICI     IFEQ 'Y'                        - B10         098818
143100200529     C           SDICI     IFNE *BLANKS                    - B10         098818
143200200529     C*
143300200529     C**  PROCESS IF DEBIT CAPITALISATION
143400200529     C*
143500200529     C                     Z-ADDWDRCB     ZICALC
143600200529     C                     Z-ADDWWHISD    ZIBEG
143700200529     C                     Z-ADDDHISD     ZIEND
143800200529     C                     EXSR ZICD
143900200529     C                     Z-ADDZDAYN1    DAYS
144000200529     C           SMNBL     MULT DAYS      NUMB0
144100200529     C*
144200200529     C           *IN80     IFEQ '1'                        - B11
144300200529     C*
144400200529     C                     ELSE                            - X11
144500200529     C           *IN81     IFEQ '1'                        - B12
144600200529     C           NUMB0     DIV  10        NUMB0
144700200529     C                     ELSE                            - X12
144800200529     C           *IN82     IFEQ '1'                        - B13
144900200529     C           NUMB0     DIV  100       NUMB0
145000200529     C                     ELSE                            - X13
145100200529     C           NUMB0     DIV  1000      NUMB0
145200200529     C                     END                             - E13
145300200529     C                     END                             - E12
145400200529     C                     END                             - E11
145500200529     C                     Z-SUBNUMB0     NUMB0
145600200529     C*
145700200529     C           SMNBL     IFGT *ZEROS                     - B11
145800200529     C                     Z-SUBDINT      INT0
145900200529     C                     ELSE                            - X11
146000200529     C                     Z-ADDCINT      INT0
146100200529     C                     END                             - E11
146200200529     C           NUMB0     IFLT *ZEROS
146300200529     C                     ADD  NUMB0     WWTND
146400200529     C                     ELSE
146500200529     C                     ADD  NUMB0     WWTNC
146600200529     C                     END
146700200529     C                     EXSR OVERDC
146800200529     C                     WRITESTODDC
146900200529     C*
147000200529     C                     Z-ADDDHISD     WHISDD
147100200529     C*
147200200529     C                     END                             - E10
147300200529     C*
147400200529     C***********SCICI     IFEQ 'Y'                        - B10         098818
147500200529     C           SCICI     IFNE *BLANKS                    - B10         098818
147600200529     C*
147700200529     C**  PROCESS IF CREDIT CAPITALISATION
147800200529     C*
147900200529     C                     Z-ADDWCRCB     ZICALC
148000200529     C                     Z-ADDWWHISD    ZIBEG
148100200529     C                     Z-ADDDHISD     ZIEND
148200200529     C                     EXSR ZICD
148300200529     C                     Z-ADDZDAYN1    DAYS
148400200529     C           SMNBL     MULT DAYS      NUMB0
148500200529     C*
148600200529     C           *IN80     IFEQ '1'                        - B11
148700200529     C*
148800200529     C                     ELSE                            - X11
148900200529     C           *IN81     IFEQ '1'                        - B12
149000200529     C           NUMB0     DIV  10        NUMB0
149100200529     C                     ELSE                            - X12
149200200529     C           *IN82     IFEQ '1'                        - B13
149300200529     C           NUMB0     DIV  100       NUMB0
149400200529     C                     ELSE                            - X13
149500200529     C           NUMB0     DIV  1000      NUMB0
149600200529     C                     END                             - E13
149700200529     C                     END                             - E12
149800200529     C                     END                             - E11
149900200529     C                     Z-SUBNUMB0     NUMB0
150000200529     C*
150100200529     C           SMNBL     IFGT *ZEROS                     - B11
150200200529     C                     Z-SUBDINT      INT0
150300200529     C                     ELSE                            - X11
150400200529     C                     Z-ADDCINT      INT0
150500200529     C                     END                             - E11
150600200529     C           NUMB0     IFLT *ZEROS
150700200529     C                     ADD  NUMB0     WWTND
150800200529     C                     ELSE
150900200529     C                     ADD  NUMB0     WWTNC
151000200529     C                     END
151100200529     C                     EXSR OVERDC
151200200529     C                     WRITESTODDC
151300200529     C*
151400200529     C                     Z-ADDDHISD     WHISDC
151500200529     C*
151600200529     C                     END                             - E10
151700200529     C*
151800200529     C                     END                             - E9
151900200529     C*
152000200529     C                     END                             - E8
152100200529     C*
152200200529     C                     END                             - E7
152300200529     C*
152400200529     C                     END                             - E6
152500200529     C*
152600200529     C                     END                             - E5
152700200529     C*
152800200529     C                     ELSE                            - X4
152900200529     C*
153000200529     C           CDICT     IFGT 2                          - B5
153100200529     C           CCICT     ANDLT3
153200200529     C*
153300200529     C**  PROCESS IN CASE OF INTEREST TYPE CREDIT IS LESS THAN 3
153400200529     C**  AND INTEREST TYPE DEBIT IS GREATER THAN 2
153500200529     C*
153600200529     C**  PROCESS OUTPUT CHANGING DAY
153700200529     C*
153800200529     C                     Z-SUBWMNBL     HISB0
153900200529     C                     EXSR OVERDC
154000200529     C                     WRITEODAYDC
154100200529     C*
154200200529     C           DCRCI     IFEQ 'Y'                        - B6
154300200529     C*
154400200529     C**  PROCESS WHEN CHANGE RATE CREDIT
154500200529     C*
154600200529     C                     Z-ADDWCRCB     ZICALC
154700200529     C                     Z-ADDWWHISD    ZIBEG
154800200529     C                     Z-ADDDHISD     ZIEND
154900200529     C*
155000200529     C                     EXSR ZICD
155100200529     C*
155200200529     C                     Z-ADDZDAYN1    DAYS
155300200529     C                     Z-SUBWHISB     HISB0
155400200529     C*
155500200529     C           *IN80     IFEQ '1'                        - B7
155600200529     C           HISB0     MULT DAYS      NUMB0
155700200529     C                     ELSE                            - X7
155800200529     C           *IN81     IFEQ '1'                        - B8
155900200529     C           HISB1     MULT DAYS      NUMB0
156000200529     C                     ELSE                            - X8
156100200529     C           *IN82     IFEQ '1'                        - B9
156200200529     C           HISB2     MULT DAYS      NUMB0
156300200529     C                     ELSE                            - X9
156400200529     C           HISB3     MULT DAYS      NUMB0
156500200529     C                     END                             - E9
156600200529     C                     END                             - E8
156700200529     C                     END                             - E7
156800200529     C           DDAID     SUB  WDAID     INT0
156900200529     C           INT0      SUB  WCAID     INT0
157000200529     C           INT0      ADD  DCAID     INT0
157100200529     C                     Z-SUBINT0      INT0
157200200529     C*
157300200529     C           DAYS      IFNE *ZEROS                     - B7
157400200529     C*
157500200529     C           NUMB0     IFLT *ZEROS
157600200529     C                     ADD  NUMB0     WWTND
157700200529     C                     ELSE
157800200529     C                     ADD  NUMB0     WWTNC
157900200529     C                     END
158000200529     C                     EXSR OVERDC
158100200529     C                     WRITESTOTDC
158200200529     C*
158300200529     C* CHARGE REPORT IF NECESSARY
158400200529     C*
158500200529     C           CCICI     IFNE *BLANK                     - B8
158600200529     C           DTHGAR    IFNE *ZERO                      - B9
158700200529     C           DTHGAN    ORNE *ZERO
158800200529     C                     Z-SUBDTHGAR    CHGR0
158900200529     C                     Z-SUBDTHGAN    CHGN0
159000200529     C                     WRITEPOSTCH
159100200529     C                     END                             - E9
159200200529     C                     END                             - E8
159300200529     C*
159400200529     C                     END                             - E7
159500200529     C*
159600200529     C                     END                             - E6
159700200529     C*
159800200529     C**  PROCESS END OF MONTH OR CHANGE RATE FOR DEBIT
159900200529     C*
160000200529     C           DRECI     IFEQ 'M'                        - B6
160100200529     C           DSDAT     ANDNE*ZEROS
160200200529     C*
160300200529     C                     Z-ADDWDRCB     ZICALC
160400200529     C                     Z-ADDWWHISD    ZIBEG
160500200529     C                     Z-ADDMHISD     ZIEND
160600200529     C                     EXSR ZICD
160700200529     C                     Z-ADDZDAYN1    DAYS
160800200529     C           MNBL      MULT DAYS      NUMB0
160900200529     C*
161000200529     C           *IN80     IFEQ '1'                        - B7
161100200529     C*
161200200529     C                     ELSE                            - X7
161300200529     C           *IN81     IFEQ '1'                        - B8
161400200529     C           NUMB0     DIV  10        NUMB0
161500200529     C                     ELSE                            - X8
161600200529     C           *IN82     IFEQ '1'                        - B9
161700200529     C           NUMB0     DIV  100       NUMB0
161800200529     C                     ELSE                            - X9
161900200529     C           NUMB0     DIV  1000      NUMB0
162000200529     C                     END                             - E9
162100200529     C                     END                             - E8
162200200529     C                     END                             - E7
162300200529     C                     Z-SUBNUMB0     NUMB0
162400200529     C*
162500200529     C           MNBL      IFGT *ZEROS                     - B7
162600200529     C                     Z-SUBDINT      INT0
162700200529     C                     ELSE                            - X7
162800200529     C                     Z-ADDCINT      INT0
162900200529     C                     END                             - E7
163000200529     C           NUMB0     IFLT *ZEROS
163100200529     C                     ADD  NUMB0     WWTND
163200200529     C                     ELSE
163300200529     C                     ADD  NUMB0     WWTNC
163400200529     C                     END
163500200529     C                     EXSR OVERDC
163600200529     C                     WRITESTODDC
163700200529     C*
163800200529     C                     Z-ADDMHISD     WHISDD
163900200529     C                     Z-ADDMNBL      WMNBL
164000200529     C*
164100200529     C                     END                             - E6
164200200529     C*
164300200529     C           DRECI     DOWEQ'M'                        - B6
164400200529     C           *IN51     ANDEQ'0'
164500200529     C*
164600200529     C           KLIST1    READEREHISL                   51
164700200529     C*
164800200529     C           *IN51     IFEQ '0'                        - B7
164900200529     C*
165000200529     C           DRECI     IFEQ 'M'                        - B8
165100200529     C           DSDAT     ANDNE*ZEROS
165200200529     C*
165300200529     C                     Z-ADDWDRCB     ZICALC
165400200529     C                     Z-ADDWWHISD    ZIBEG
165500200529     C                     Z-ADDMHISD     ZIEND
165600200529     C                     EXSR ZICD
165700200529     C                     Z-ADDZDAYN1    DAYS
165800200529     C           MNBL      MULT DAYS      NUMB0
165900200529     C*
166000200529     C           *IN80     IFEQ '1'                        - B9
166100200529     C*
166200200529     C                     ELSE                            - X9
166300200529     C           *IN81     IFEQ '1'                        - B10
166400200529     C           NUMB0     DIV  10        NUMB0
166500200529     C                     ELSE                            - X10
166600200529     C           *IN82     IFEQ '1'                        - B11
166700200529     C           NUMB0     DIV  100       NUMB0
166800200529     C                     ELSE                            - X11
166900200529     C           NUMB0     DIV  1000      NUMB0
167000200529     C                     END                             - E11
167100200529     C                     END                             - E10
167200200529     C                     END                             - E9
167300200529     C                     Z-SUBNUMB0     NUMB0
167400200529     C*
167500200529     C           MNBL      IFGT *ZEROS                     - B9
167600200529     C                     Z-SUBDINT      INT0
167700200529     C                     ELSE                            - X9
167800200529     C                     Z-ADDCINT      INT0
167900200529     C                     END                             - E9
168000200529     C           NUMB0     IFLT *ZEROS
168100200529     C                     ADD  NUMB0     WWTND
168200200529     C                     ELSE
168300200529     C                     ADD  NUMB0     WWTNC
168400200529     C                     END
168500200529     C                     EXSR OVERDC
168600200529     C                     WRITESTODDC
168700200529     C*
168800200529     C                     Z-ADDMHISD     WHISDD
168900200529     C                     Z-ADDMNBL      WMNBL
169000200529     C*
169100200529     C                     ELSE                            - X8
169200200529     C*
169300200529     C           DRECI     IFEQ 'S'                        - B9
169400200529     C***********SDICI     ANDEQ'Y'                                      098818
169500200529     C           SDICI     ANDNE*BLANKS                                  098818
169600200529     C*
169700200529     C                     Z-ADDWDRCB     ZICALC
169800200529     C                     Z-ADDWWHISD    ZIBEG
169900200529     C                     Z-ADDDHISD     ZIEND
170000200529     C                     EXSR ZICD
170100200529     C                     Z-ADDZDAYN1    DAYS
170200200529     C           SMNBL     MULT DAYS      NUMB0
170300200529     C*
170400200529     C           *IN80     IFEQ '1'                        - B10
170500200529     C*
170600200529     C                     ELSE                            - X10
170700200529     C           *IN81     IFEQ '1'                        - B11
170800200529     C           NUMB0     DIV  10        NUMB0
170900200529     C                     ELSE                            - X11
171000200529     C           *IN82     IFEQ '1'                        - B12
171100200529     C           NUMB0     DIV  100       NUMB0
171200200529     C                     ELSE                            - X12
171300200529     C           NUMB0     DIV  1000      NUMB0
171400200529     C                     END                             - E12
171500200529     C                     END                             - E11
171600200529     C                     END                             - E10
171700200529     C                     Z-SUBNUMB0     NUMB0
171800200529     C*
171900200529     C           SMNBL     IFGT *ZEROS                     - B10
172000200529     C                     Z-SUBDINT      INT0
172100200529     C                     ELSE                            - X10
172200200529     C                     Z-ADDCINT      INT0
172300200529     C                     END                             - E10
172400200529     C           NUMB0     IFLT *ZEROS
172500200529     C                     ADD  NUMB0     WWTND
172600200529     C                     ELSE
172700200529     C                     ADD  NUMB0     WWTNC
172800200529     C                     END
172900200529     C                     EXSR OVERDC
173000200529     C                     WRITESTODDC
173100200529     C*
173200200529     C                     Z-ADDDHISD     WHISDD
173300200529     C*
173400200529     C                     END                             - E9
173500200529     C*
173600200529     C                     END                             - E8
173700200529     C*
173800200529     C                     END                             - E7
173900200529     C*
174000200529     C                     END                             - E6
174100200529     C*
174200200529     C                     ELSE                            - X5
174300200529     C*
174400200529     C**  PROCESS IN CASE OF INTEREST TYPE DEBIT IS LESS THAN 3
174500200529     C**  AND INTEREST TYPE CREDIT IS GREATER THAN 2
174600200529     C*
174700200529     C**  PROCESS OUTPUT CHANGING DAY
174800200529     C*
174900200529     C                     Z-SUBWMNBL     HISB0
175000200529     C                     EXSR OVERDC
175100200529     C                     WRITEODAYDC
175200200529     C*
175300200529     C           DDRCI     IFEQ 'Y'                        - B6
175400200529     C*
175500200529     C**  DEBIT RATE CHANGE
175600200529     C*
175700200529     C                     Z-ADDWDRCB     ZICALC
175800200529     C                     Z-ADDWWHISD    ZIBEG
175900200529     C                     Z-ADDDHISD     ZIEND
176000200529     C*
176100200529     C                     EXSR ZICD
176200200529     C*
176300200529     C                     Z-ADDZDAYN1    DAYS
176400200529     C                     Z-SUBWHISB     HISB0
176500200529     C*
176600200529     C           *IN80     IFEQ '1'                        - B7
176700200529     C           HISB0     MULT DAYS      NUMB0
176800200529     C                     ELSE                            - X7
176900200529     C           *IN81     IFEQ '1'                        - B8
177000200529     C           HISB1     MULT DAYS      NUMB0
177100200529     C                     ELSE                            - X8
177200200529     C           *IN82     IFEQ '1'                        - B9
177300200529     C           HISB2     MULT DAYS      NUMB0
177400200529     C                     ELSE                            - X9
177500200529     C           HISB3     MULT DAYS      NUMB0
177600200529     C                     END                             - E9
177700200529     C                     END                             - E8
177800200529     C                     END                             - E7
177900200529     C*
178000200529     C           DAYS      IFNE *ZEROS                     - B7
178100200529     C*
178200200529     C           NUMB0     IFLT *ZEROS
178300200529     C                     ADD  NUMB0     WWTND
178400200529     C                     ELSE
178500200529     C                     ADD  NUMB0     WWTNC
178600200529     C                     END
178700200529     C                     EXSR OVERDC
178800200529     C                     WRITESTOTDC
178900200529     C*
179000200529     C* CHARGE REPORT IF NECESSARY
179100200529     C*
179200200529     C           CCICI     IFNE *BLANK                     - B8
179300200529     C           DTHGAR    IFNE *ZERO                      - B9
179400200529     C           DTHGAN    ORNE *ZERO
179500200529     C                     Z-SUBDTHGAR    CHGR0
179600200529     C                     Z-SUBDTHGAN    CHGN0
179700200529     C                     WRITEPOSTCH
179800200529     C                     END                             - E9
179900200529     C                     END                             - E8
180000200529     C*
180100200529     C                     END                             - E7
180200200529     C*
180300200529     C                     END                             - E6
180400200529     C*
180500200529     C**  CREDIT END OF MONTH OR CREDIT RATE CHANGE
180600200529     C*
180700200529     C           DRECI     IFEQ 'M'                        - B6
180800200529     C           CSDAT     ANDNE*ZEROS
180900200529     C*
181000200529     C                     Z-ADDWCRCB     ZICALC
181100200529     C                     Z-ADDWWHISD    ZIBEG
181200200529     C                     Z-ADDMHISD     ZIEND
181300200529     C                     EXSR ZICD
181400200529     C                     Z-ADDZDAYN1    DAYS
181500200529     C           MNBL      MULT DAYS      NUMB0
181600200529     C*
181700200529     C           *IN80     IFEQ '1'                        - B7
181800200529     C*
181900200529     C                     ELSE                            - X7
182000200529     C           *IN81     IFEQ '1'                        - B8
182100200529     C           NUMB0     DIV  10        NUMB0
182200200529     C                     ELSE                            - X8
182300200529     C           *IN82     IFEQ '1'                        - B9
182400200529     C           NUMB0     DIV  100       NUMB0
182500200529     C                     ELSE                            - X9
182600200529     C           NUMB0     DIV  1000      NUMB0
182700200529     C                     END                             - E9
182800200529     C                     END                             - E8
182900200529     C                     END                             - E7
183000200529     C                     Z-SUBNUMB0     NUMB0
183100200529     C*
183200200529     C           MNBL      IFGT *ZEROS                     - B7
183300200529     C                     Z-SUBDINT      INT0
183400200529     C                     ELSE                            - X7
183500200529     C                     Z-ADDCINT      INT0
183600200529     C                     END                             - E7
183700200529     C           NUMB0     IFLT *ZEROS
183800200529     C                     ADD  NUMB0     WWTND
183900200529     C                     ELSE
184000200529     C                     ADD  NUMB0     WWTNC
184100200529     C                     END
184200200529     C                     EXSR OVERDC
184300200529     C                     WRITESTODDC
184400200529     C*
184500200529     C                     Z-ADDMHISD     WHISDC
184600200529     C                     Z-ADDMNBL      WMNBL
184700200529     C*
184800200529     C                     END                             - E6
184900200529     C*
185000200529     C           DRECI     DOWEQ'M'                        - B6
185100200529     C           *IN51     ANDEQ'0'
185200200529     C*
185300200529     C           KLIST1    READEREHISL                   51
185400200529     C*
185500200529     C           *IN51     IFEQ '0'                        - B7
185600200529     C*
185700200529     C           DRECI     IFEQ 'M'                        - B8
185800200529     C           CSDAT     ANDNE*ZEROS
185900200529     C*
186000200529     C                     Z-ADDWCRCB     ZICALC
186100200529     C                     Z-ADDWWHISD    ZIBEG
186200200529     C                     Z-ADDMHISD     ZIEND
186300200529     C                     EXSR ZICD
186400200529     C                     Z-ADDZDAYN1    DAYS
186500200529     C           MNBL      MULT DAYS      NUMB0
186600200529     C*
186700200529     C           *IN80     IFEQ '1'                        - B9
186800200529     C*
186900200529     C                     ELSE                            - X9
187000200529     C           *IN81     IFEQ '1'                        - B10
187100200529     C           NUMB0     DIV  10        NUMB0
187200200529     C                     ELSE                            - X10
187300200529     C           *IN82     IFEQ '1'                        - B11
187400200529     C           NUMB0     DIV  100       NUMB0
187500200529     C                     ELSE                            - X11
187600200529     C           NUMB0     DIV  1000      NUMB0
187700200529     C                     END                             - E11
187800200529     C                     END                             - E10
187900200529     C                     END                             - E9
188000200529     C                     Z-SUBNUMB0     NUMB0
188100200529     C*
188200200529     C           MNBL      IFGT *ZEROS                     - B9
188300200529     C                     Z-SUBDINT      INT0
188400200529     C                     ELSE                            - X9
188500200529     C                     Z-ADDCINT      INT0
188600200529     C                     END                             - E9
188700200529     C           NUMB0     IFLT *ZEROS
188800200529     C                     ADD  NUMB0     WWTND
188900200529     C                     ELSE
189000200529     C                     ADD  NUMB0     WWTNC
189100200529     C                     END
189200200529     C                     EXSR OVERDC
189300200529     C                     WRITESTODDC
189400200529     C*
189500200529     C                     Z-ADDMHISD     WHISDC
189600200529     C                     Z-ADDMNBL      WMNBL
189700200529     C*
189800200529     C                     ELSE                            - X8
189900200529     C*
190000200529     C           DRECI     IFEQ 'S'                        - B9
190100200529     C***********SCICI     ANDEQ'Y'                                      098818
190200200529     C           SCICI     ANDNE*BLANKS                                  098818
190300200529     C*
190400200529     C                     Z-ADDWCRCB     ZICALC
190500200529     C                     Z-ADDWWHISD    ZIBEG
190600200529     C                     Z-ADDDHISD     ZIEND
190700200529     C                     EXSR ZICD
190800200529     C                     Z-ADDZDAYN1    DAYS
190900200529     C           SMNBL     MULT DAYS      NUMB0
191000200529     C*
191100200529     C           *IN80     IFEQ '1'                        - B10
191200200529     C*
191300200529     C                     ELSE                            - X10
191400200529     C           *IN81     IFEQ '1'                        - B11
191500200529     C           NUMB0     DIV  10        NUMB0
191600200529     C                     ELSE                            - X11
191700200529     C           *IN82     IFEQ '1'                        - B12
191800200529     C           NUMB0     DIV  100       NUMB0
191900200529     C                     ELSE                            - X12
192000200529     C           NUMB0     DIV  1000      NUMB0
192100200529     C                     END                             - E12
192200200529     C                     END                             - E11
192300200529     C                     END                             - E10
192400200529     C                     Z-SUBNUMB0     NUMB0
192500200529     C*
192600200529     C           SMNBL     IFGT *ZEROS                     - B10
192700200529     C                     Z-SUBDINT      INT0
192800200529     C                     ELSE                            - X10
192900200529     C                     Z-ADDCINT      INT0
193000200529     C                     END                             - E10
193100200529     C           NUMB0     IFLT *ZEROS
193200200529     C                     ADD  NUMB0     WWTND
193300200529     C                     ELSE
193400200529     C                     ADD  NUMB0     WWTNC
193500200529     C                     END
193600200529     C                     EXSR OVERDC
193700200529     C                     WRITESTODDC
193800200529     C*
193900200529     C                     Z-ADDDHISD     WHISDC
194000200529     C*
194100200529     C                     END                             - E9
194200200529     C*
194300200529     C                     END                             - E8
194400200529     C*
194500200529     C                     END                             - E7
194600200529     C*
194700200529     C                     END                             - E6
194800200529     C*
194900200529     C                     END                             - E5
195000200529     C*
195100200529     C                     END                             - E4
195200200529     C*
195300200529     C                     END                             - E3
195400200529     C*
195500200529     C                     END                             - E2
195600200529     C*
195700200529     C                     END                             - E1
195800200529     C*
195900200529      ** If CRE001 is switched ON and Overdraft Processed Ind. is 'Y'     CRE001
196000200529      ** then Output Overdraft Limit                                      CRE001
196100200529      *                                                                   CRE001
196200200529     C           CRE001    IFEQ 'Y'                          B1           CRE001
196300200529     C           ODLI      ANDEQ'Y'                          A1           CRE001
196400200529      *                                                                   CRE001
196500200529     C                     MOVE *BLANKS   ODLI                            CRE001
196600200529     C                     MOVE *BLANKS   PSTDO                           CRE001
196700200529     C                     Z-ADD*ZEROS    PPSTD                           CRE001
196800200529     C                     MOVE *BLANKS   PSTDA                           CRE001
196900200529      *                                                                   CRE001
197000200529      ** Convert Retail History Debit Date to DDMMMYY format              CRE001
197100200529     C           PVALD     IFNE WWHISD                       B2           CRE001
197200200529     C                     MOVELWWHISD    ZDAYNO                          CRE001
197300200529     C                     EXSR ZDATE2                                    CRE001
197400200529     C                     MOVE ZADATE    VALDO                           CRE001
197500200529      *                                                                   CRE001
197600200529      **  Handle Conversion Error.                                        CRE001
197700200529      *                                                                   CRE001
197800200529     C           ZERROR    IFNE 0                          - B3           CRE001
197900200529     C                     Z-ADDWWHISD    WDATE                           CRE001
198000200529     C                     Z-ADD421       DBASE                           CRE001
198100200529     C                     MOVEL'ZDAT2'   DBFILE           ***************CRE001
198200200529     C                     MOVELWDATE     DBKEY            **DB ERROR 421*CRE001
198300200529     C                     MOVEA'1'       *IN,89           ***************CRE001
198400200529     C                     EXSR DBSR                                      CRE001
198500200529     C                     ENDIF                           - E3           CRE001
198600200529      *                                                                   CRE001
198700200529      ** Set Pervious Posting Value to Current Retail History DR Date     CRE001
198800200529     C                     Z-ADDWWHISD    PVALD                           CRE001
198900200529      *                                                                   CRE001
199000200529     C                     ENDIF                           - E2           CRE001
199100200529      *                                                                   CRE001
199200200529     C                     MOVE VALDO     VALDA                           CRE001
199300200529      *                                                                   CRE001
199400200529     C                     MOVELNAR,37    NARR                            CRE001
199500200529      *                                                                   CRE001
199600200529     C                     Z-ADD*ZERO     WODRL  150                      CRE001
199700200529     C                     SELEC                                          CRE001
199800200529     C           DPA,I     WHEQ 0                                         CRE001
199900200529     C                     Z-ADDODRL      WODRL                           CRE001
200000200529     C           DPA,I     WHEQ 1                                         CRE001
200100200529     C           ODRL      MULT 10        WODRL                           CRE001
200200200529     C           DPA,I     WHEQ 2                                         CRE001
200300200529     C           ODRL      MULT 100       WODRL                           CRE001
200400200529     C           DPA,I     WHEQ 3                                         CRE001
200500200529     C           ODRL      MULT 1000      WODRL                           CRE001
200600200529     C                     ENDSL                                          CRE001
200700200529      *                                                                   CRE001
200800200529     C           WODRL     IFGT *ZEROS                     - B2           CRE001
200900200529     C                     Z-ADDWODRL     PSTD0                           CRE001
201000200529     C                     ELSE                            - X2           CRE001
201100200529     C                     Z-SUBWODRL     PSTD0                           CRE001
201200200529     C                     ENDIF                           - E2           CRE001
201300200529      *                                                                   CRE001
201400200529      **  Output Posting for Debit and Credit                             CRE001
201500200529      *                                                                   CRE001
201600200529     C                     EXSR OVERDC                                    CRE001
201700200529     C                     WRITEPOSTDC                                    CRE001
201800200529      *                                                                   CRE001
201900200529     C                     ENDIF                             E1           CRE001
202000200529      *                                                                   CRE001
202100200529     C           *IN51     DOWEQ'0'                        - B1
202200200529     C           DHISD     ANDLTCHISD
202300200529     C*
202400200529     C**  PROCESS POSTING AT THE SAME DATE
202500200529     C*
202600200529     C           *IN50     DOWEQ'0'                        - B2
202700200529     C           DHISD     ANDEQHISD
202800200529     C*
202900200529     C                     EXSR POSTSR
203000200529     C*
203100200529     C           KLIST1    READEREHPOPL                  50
203200200529     C*
203300200529     C                     END                             - E2
203400200529     C*
203500200529     C**  PROCESS IN CASE THERE IS ONE RATE CHANGE
203600200529     C*
203700200529     C                     EXSR RATESR
203800200529     C*
203900200529     C**  OUTPUT SUBTOTAL LINE
204000200529     C*
204100200529     C           *IN51     IFEQ '0'                        - B2
204200200529     C           DHISD     ANDLTCHISD
204300200529     C*
204400200529     C**  CHECK INTEREST TYPE
204500200529     C*
204600200529     C           CDICT     IFLT 3                          - B3
204700200529     C           CCICT     ANDLT3
204800200529     C*
204900200529     C**  PROCESS IN CASE OF INTEREST TYPE ARE BOTH LESS THAN 3
205000200529     C*
205100200529     C           WHISB     IFGT *ZEROS                     - B4
205200200529     C*
205300200529     C**  PROCESS WHEN CHANGE RATE DEBIT
205400200529     C*
205500200529     C                     Z-ADDWDRCB     ZICALC
205600200529     C                     Z-ADDWWHISD    ZIBEG
205700200529     C                     Z-ADDDHISD     ZIEND
205800200529     C*
205900200529     C                     EXSR ZICD
206000200529     C*
206100200529     C                     Z-ADDZDAYN1    DAYS
206200200529     C                     Z-SUBWHISB     HISB0
206300200529     C*
206400200529     C           *IN80     IFEQ '1'                        - B5
206500200529     C           HISB0     MULT DAYS      NUMB0
206600200529     C                     ELSE                            - X5
206700200529     C           *IN81     IFEQ '1'                        - B6
206800200529     C           HISB1     MULT DAYS      NUMB0
206900200529     C                     ELSE                            - X6
207000200529     C           *IN82     IFEQ '1'                        - B7
207100200529     C           HISB2     MULT DAYS      NUMB0
207200200529     C                     ELSE                            - X7
207300200529     C           HISB3     MULT DAYS      NUMB0
207400200529     C                     END                             - E7
207500200529     C                     END                             - E6
207600200529     C                     END                             - E5
207700200529     C*
207800200529     C           DDAID     SUB  WDAID     INT0
207900200529     C           INT0      SUB  DCAID     INT0
208000200529     C           INT0      ADD  WCAID     INT0
208100200529     C                     Z-SUBINT0      INT0
208200200529     C*
208300200529     C           DAYS      IFNE *ZEROS                     - B5
208400200529     C*
208500200529     C           NUMB0     IFLT *ZEROS
208600200529     C                     ADD  NUMB0     WWTND
208700200529     C                     ELSE
208800200529     C                     ADD  NUMB0     WWTNC
208900200529     C                     END
209000200529     C                     EXSR OVERDC
209100200529     C                     WRITESTOTDC
209200200529     C*
209300200529     C* CHARGE REPORT IF NECESSARY
209400200529     C*
209500200529     C           CCICI     IFNE *BLANK                     - B6
209600200529     C           DTHGAR    IFNE *ZERO                      - B7
209700200529     C           DTHGAN    ORNE *ZERO
209800200529     C                     Z-SUBDTHGAR    CHGR0
209900200529     C                     Z-SUBDTHGAN    CHGN0
210000200529     C                     WRITEPOSTCH
210100200529     C                     END                             - E7
210200200529     C                     END                             - E6
210300200529     C*
210400200529     C                     END                             - E5
210500200529     C*
210600200529     C                     ELSE                            - X4
210700200529     C*
210800200529     C**  PROCESS WHEN CHANGE RATE CREDIT
210900200529     C*
211000200529     C                     Z-ADDWCRCB     ZICALC
211100200529     C                     Z-ADDWWHISD    ZIBEG
211200200529     C                     Z-ADDDHISD     ZIEND
211300200529     C*
211400200529     C                     EXSR ZICD
211500200529     C*
211600200529     C                     Z-ADDZDAYN1    DAYS
211700200529     C                     Z-SUBWHISB     HISB0
211800200529     C*
211900200529     C           *IN80     IFEQ '1'                        - B5
212000200529     C           HISB0     MULT DAYS      NUMB0
212100200529     C                     ELSE                            - X5
212200200529     C           *IN81     IFEQ '1'                        - B6
212300200529     C           HISB1     MULT DAYS      NUMB0
212400200529     C                     ELSE                            - X6
212500200529     C           *IN82     IFEQ '1'                        - B7
212600200529     C           HISB2     MULT DAYS      NUMB0
212700200529     C                     ELSE                            - X7
212800200529     C           HISB3     MULT DAYS      NUMB0
212900200529     C                     END                             - E7
213000200529     C                     END                             - E6
213100200529     C                     END                             - E5
213200200529     C*
213300200529     C           DDAID     SUB  WDAID     INT0
213400200529     C           INT0      SUB  DCAID     INT0
213500200529     C           INT0      ADD  WCAID     INT0
213600200529     C                     Z-SUBINT0      INT0
213700200529     C*
213800200529     C           DAYS      IFNE *ZEROS                     - B5
213900200529     C*
214000200529     C           NUMB0     IFLT *ZEROS
214100200529     C                     ADD  NUMB0     WWTND
214200200529     C                     ELSE
214300200529     C                     ADD  NUMB0     WWTNC
214400200529     C                     END
214500200529     C                     EXSR OVERDC
214600200529     C                     WRITESTOTDC
214700200529     C*
214800200529     C* CHARGE REPORT IF NECESSARY
214900200529     C*
215000200529     C           CCICI     IFNE *BLANK                     - B6
215100200529     C           DTHGAR    IFNE *ZERO                      - B7
215200200529     C           DTHGAN    ORNE *ZERO
215300200529     C                     Z-SUBDTHGAR    CHGR0
215400200529     C                     Z-SUBDTHGAN    CHGN0
215500200529     C                     WRITEPOSTCH
215600200529     C                     END                             - E7
215700200529     C                     END                             - E6
215800200529     C*
215900200529     C                     END                             - E5
216000200529     C*
216100200529     C                     END                             - E4
216200200529     C*
216300200529     C                     ELSE                            - X3
216400200529     C*
216500200529     C           CDICT     IFGT 2                          - B4
216600200529     C           CCICT     ANDGT2
216700200529     C*
216800200529     C**  PROCESS IN CASE OF INTEREST TYPE ARE BOTH GREATER THAN 3
216900200529     C*
217000200529     C**  PROCESS OUTPUT CHANGING DAY
217100200529     C*
217200200529     C                     Z-SUBWMNBL     HISB0
217300200529     C                     EXSR OVERDC
217400200529     C                     WRITEODAYDC
217500200529     C*
217600200529     C           DRECI     IFEQ 'M'                        - B5
217700200529     C*
217800200529     C           DSDAT     IFNE *ZEROS                     - B6
217900200529     C           MNBL      ANDGT*ZEROS
218000200529     C*
218100200529     C**  PROCESS DEBIT
218200200529     C*
218300200529     C                     Z-ADDWDRCB     ZICALC
218400200529     C                     Z-ADDWWHISD    ZIBEG
218500200529     C                     Z-ADDMHISD     ZIEND
218600200529     C                     EXSR ZICD
218700200529     C                     Z-ADDZDAYN1    DAYS
218800200529     C                     Z-SUBDINT      INT0
218900200529     C*
219000200529     C           MNBL      MULT DAYS      NUMB0
219100200529     C*
219200200529     C           *IN80     IFEQ '1'                        - B7
219300200529     C*
219400200529     C                     ELSE                            - X7
219500200529     C           *IN81     IFEQ '1'                        - B8
219600200529     C           NUMB0     DIV  10        NUMB0
219700200529     C                     ELSE                            - X8
219800200529     C           *IN82     IFEQ '1'                        - B9
219900200529     C           NUMB0     DIV  100       NUMB0
220000200529     C                     ELSE                            - X9
220100200529     C           NUMB0     DIV  1000      NUMB0
220200200529     C                     END                             - E9
220300200529     C                     END                             - E8
220400200529     C                     END                             - E7
220500200529     C                     Z-SUBNUMB0     NUMB0
220600200529     C           NUMB0     IFLT *ZEROS
220700200529     C                     ADD  NUMB0     WWTND
220800200529     C                     ELSE
220900200529     C                     ADD  NUMB0     WWTNC
221000200529     C                     END
221100200529     C                     EXSR OVERDC
221200200529     C                     WRITESTODDC
221300200529     C                     Z-ADDMHISD     WHISDD
221400200529     C                     Z-ADDMNBL      WMNBL
221500200529     C*
221600200529     C                     END                             - E6
221700200529     C*
221800200529     C           CSDAT     IFNE *ZEROS                     - B6
221900200529     C           MNBL      ANDLT*ZEROS
222000200529     C*
222100200529     C**  PROCESS CREDIT
222200200529     C*
222300200529     C                     Z-ADDWCRCB     ZICALC
222400200529     C                     Z-ADDWWHISD    ZIBEG
222500200529     C                     Z-ADDMHISD     ZIEND
222600200529     C                     EXSR ZICD
222700200529     C                     Z-ADDZDAYN1    DAYS
222800200529     C                     Z-ADDCINT      INT0
222900200529     C           MNBL      MULT DAYS      NUMB0
223000200529     C*
223100200529     C           *IN80     IFEQ '1'                        - B7
223200200529     C*
223300200529     C                     ELSE                            - X7
223400200529     C           *IN81     IFEQ '1'                        - B8
223500200529     C           NUMB0     DIV  10        NUMB0
223600200529     C                     ELSE                            - X8
223700200529     C           *IN82     IFEQ '1'                        - B9
223800200529     C           NUMB0     DIV  100       NUMB0
223900200529     C                     ELSE                            - X9
224000200529     C           NUMB0     DIV  1000      NUMB0
224100200529     C                     END                             - E9
224200200529     C                     END                             - E8
224300200529     C                     END                             - E7
224400200529     C                     Z-SUBNUMB0     NUMB0
224500200529     C           NUMB0     IFLT *ZEROS
224600200529     C                     ADD  NUMB0     WWTND
224700200529     C                     ELSE
224800200529     C                     ADD  NUMB0     WWTNC
224900200529     C                     END
225000200529     C                     EXSR OVERDC
225100200529     C                     WRITESTODDC
225200200529     C                     Z-ADDMHISD     WHISDC
225300200529     C                     Z-ADDMNBL      WMNBL
225400200529     C*
225500200529     C                     END                             - E6
225600200529     C*
225700200529     C**  PROCESS UNTIL READING OTHER THAN 'M'
225800200529     C*
225900200529     C           DRECI     DOWEQ'M'                        - B6
226000200529     C           *IN51     ANDEQ'0'
226100200529     C*
226200200529     C           KLIST1    READEREHISL                   51
226300200529     C*
226400200529     C           *IN51     IFEQ '0'                        - B7
226500200529     C*
226600200529     C           DRECI     IFEQ 'M'                        - B8
226700200529     C*
226800200529     C           DSDAT     IFNE *ZEROS                     - B9
226900200529     C           MNBL      ANDGT*ZEROS
227000200529     C*
227100200529     C**  PROCESS DEBIT
227200200529     C*
227300200529     C                     Z-ADDWDRCB     ZICALC
227400200529     C                     Z-ADDWWHISD    ZIBEG
227500200529     C                     Z-ADDMHISD     ZIEND
227600200529     C                     EXSR ZICD
227700200529     C                     Z-ADDZDAYN1    DAYS
227800200529     C                     Z-SUBDINT      INT0
227900200529     C           MNBL      MULT DAYS      NUMB0
228000200529     C*
228100200529     C           *IN80     IFEQ '1'                        - B10
228200200529     C*
228300200529     C                     ELSE                            - X10
228400200529     C           *IN81     IFEQ '1'                        - B11
228500200529     C           NUMB0     DIV  10        NUMB0
228600200529     C                     ELSE                            - X11
228700200529     C           *IN82     IFEQ '1'                        - B12
228800200529     C           NUMB0     DIV  100       NUMB0
228900200529     C                     ELSE                            - X12
229000200529     C           NUMB0     DIV  1000      NUMB0
229100200529     C                     END                             - E12
229200200529     C                     END                             - E11
229300200529     C                     END                             - E10
229400200529     C                     Z-SUBNUMB0     NUMB0
229500200529     C           NUMB0     IFLT *ZEROS
229600200529     C                     ADD  NUMB0     WWTND
229700200529     C                     ELSE
229800200529     C                     ADD  NUMB0     WWTNC
229900200529     C                     END
230000200529     C                     EXSR OVERDC
230100200529     C                     WRITESTODDC
230200200529     C                     Z-ADDMHISD     WHISDD
230300200529     C                     Z-ADDMNBL      WMNBL
230400200529     C*
230500200529     C                     END                             - E9
230600200529     C*
230700200529     C           CSDAT     IFNE *ZEROS                     - B9
230800200529     C           MNBL      ANDLT*ZEROS
230900200529     C*
231000200529     C**  PROCESS CREDIT
231100200529     C*
231200200529     C                     Z-ADDWCRCB     ZICALC
231300200529     C                     Z-ADDWWHISD    ZIBEG
231400200529     C                     Z-ADDMHISD     ZIEND
231500200529     C                     EXSR ZICD
231600200529     C                     Z-ADDZDAYN1    DAYS
231700200529     C                     Z-ADDCINT      INT0
231800200529     C           MNBL      MULT DAYS      NUMB0
231900200529     C*
232000200529     C           *IN80     IFEQ '1'                        - B10
232100200529     C*
232200200529     C                     ELSE                            - X10
232300200529     C           *IN81     IFEQ '1'                        - B11
232400200529     C           NUMB0     DIV  10        NUMB0
232500200529     C                     ELSE                            - X11
232600200529     C           *IN82     IFEQ '1'                        - B12
232700200529     C           NUMB0     DIV  100       NUMB0
232800200529     C                     ELSE                            - X12
232900200529     C           NUMB0     DIV  1000      NUMB0
233000200529     C                     END                             - E12
233100200529     C                     END                             - E11
233200200529     C                     END                             - E10
233300200529     C                     Z-SUBNUMB0     NUMB0
233400200529     C           NUMB0     IFLT *ZEROS
233500200529     C                     ADD  NUMB0     WWTND
233600200529     C                     ELSE
233700200529     C                     ADD  NUMB0     WWTNC
233800200529     C                     END
233900200529     C                     EXSR OVERDC
234000200529     C                     WRITESTODDC
234100200529     C                     Z-ADDMHISD     WHISDC
234200200529     C                     Z-ADDMNBL      WMNBL
234300200529     C*
234400200529     C                     END                             - E9
234500200529     C*
234600200529     C                     ELSE                            - X8
234700200529     C*
234800200529     C           DRECI     IFEQ 'S'                        - B9
234900200529     C*
235000200529     C**  PROCESS A S RECORD
235100200529     C*
235200200529     C***********SDICI     IFEQ 'Y'                        - B10         098818
235300200529     C           SDICI     IFNE *BLANKS                    - B10         098818
235400200529     C*
235500200529     C**  PROCESS IF DEBIT CAPITALISATION
235600200529     C*
235700200529     C                     Z-ADDWDRCB     ZICALC
235800200529     C                     Z-ADDWWHISD    ZIBEG
235900200529     C                     Z-ADDDHISD     ZIEND
236000200529     C                     EXSR ZICD
236100200529     C                     Z-ADDZDAYN1    DAYS
236200200529     C           SMNBL     MULT DAYS      NUMB0
236300200529     C*
236400200529     C           *IN80     IFEQ '1'                        - B11
236500200529     C*
236600200529     C                     ELSE                            - X11
236700200529     C           *IN81     IFEQ '1'                        - B12
236800200529     C           NUMB0     DIV  10        NUMB0
236900200529     C                     ELSE                            - X12
237000200529     C           *IN82     IFEQ '1'                        - B13
237100200529     C           NUMB0     DIV  100       NUMB0
237200200529     C                     ELSE                            - X13
237300200529     C           NUMB0     DIV  1000      NUMB0
237400200529     C                     END                             - E13
237500200529     C                     END                             - E12
237600200529     C                     END                             - E11
237700200529     C                     Z-SUBNUMB0     NUMB0
237800200529     C*
237900200529     C           SMNBL     IFGT *ZEROS                     - B11
238000200529     C                     Z-SUBDINT      INT0
238100200529     C                     ELSE                            - X11
238200200529     C                     Z-ADDCINT      INT0
238300200529     C                     END                             - E11
238400200529     C           NUMB0     IFLT *ZEROS
238500200529     C                     ADD  NUMB0     WWTND
238600200529     C                     ELSE
238700200529     C                     ADD  NUMB0     WWTNC
238800200529     C                     END
238900200529     C                     EXSR OVERDC
239000200529     C                     WRITESTODDC
239100200529     C*
239200200529     C                     Z-ADDDHISD     WHISDD
239300200529     C*
239400200529     C                     END                             - E10
239500200529     C*
239600200529     C***********SCICI     IFEQ 'Y'                        - B10         098818
239700200529     C           SCICI     IFNE *BLANKS                    - B10         098818
239800200529     C*
239900200529     C**  PROCESS IF CREDIT CAPITALISATION
240000200529     C*
240100200529     C                     Z-ADDWCRCB     ZICALC
240200200529     C                     Z-ADDWWHISD    ZIBEG
240300200529     C                     Z-ADDDHISD     ZIEND
240400200529     C                     EXSR ZICD
240500200529     C                     Z-ADDZDAYN1    DAYS
240600200529     C           SMNBL     MULT DAYS      NUMB0
240700200529     C*
240800200529     C           *IN80     IFEQ '1'                        - B11
240900200529     C*
241000200529     C                     ELSE                            - X11
241100200529     C           *IN81     IFEQ '1'                        - B12
241200200529     C           NUMB0     DIV  10        NUMB0
241300200529     C                     ELSE                            - X12
241400200529     C           *IN82     IFEQ '1'                        - B13
241500200529     C           NUMB0     DIV  100       NUMB0
241600200529     C                     ELSE                            - X13
241700200529     C           NUMB0     DIV  1000      NUMB0
241800200529     C                     END                             - E13
241900200529     C                     END                             - E12
242000200529     C                     END                             - E11
242100200529     C                     Z-SUBNUMB0     NUMB0
242200200529     C*
242300200529     C           SMNBL     IFGT *ZEROS                     - B11
242400200529     C                     Z-SUBDINT      INT0
242500200529     C                     ELSE                            - X11
242600200529     C                     Z-ADDCINT      INT0
242700200529     C                     END                             - E11
242800200529     C           NUMB0     IFLT *ZEROS
242900200529     C                     ADD  NUMB0     WWTND
243000200529     C                     ELSE
243100200529     C                     ADD  NUMB0     WWTNC
243200200529     C                     END
243300200529     C                     EXSR OVERDC
243400200529     C                     WRITESTODDC
243500200529     C*
243600200529     C                     Z-ADDDHISD     WHISDC
243700200529     C*
243800200529     C                     END                             - E10
243900200529     C*
244000200529     C                     END                             - E9
244100200529     C*
244200200529     C                     END                             - E8
244300200529     C*
244400200529     C                     END                             - E7
244500200529     C*
244600200529     C                     END                             - E6
244700200529     C*
244800200529     C                     END                             - E5
244900200529     C*
245000200529     C                     ELSE                            - X4
245100200529     C*
245200200529     C           CDICT     IFGT 2                          - B5
245300200529     C           CCICT     ANDLT3
245400200529     C*
245500200529     C**  PROCESS IN CASE OF INTEREST TYPE CREDIT IS LESS THAN 3
245600200529     C**  AND INTEREST TYPE DEBIT IS GREATER THAN 2
245700200529     C*
245800200529     C**  PROCESS OUTPUT CHANGING DAY
245900200529     C*
246000200529     C                     Z-SUBWMNBL     HISB0
246100200529     C                     EXSR OVERDC
246200200529     C                     WRITEODAYDC
246300200529     C*
246400200529     C           DCRCI     IFEQ 'Y'                        - B6
246500200529     C*
246600200529     C**  PROCESS WHEN CHANGE RATE CREDIT
246700200529     C*
246800200529     C                     Z-ADDWCRCB     ZICALC
246900200529     C                     Z-ADDWWHISD    ZIBEG
247000200529     C                     Z-ADDDHISD     ZIEND
247100200529     C*
247200200529     C                     EXSR ZICD
247300200529     C*
247400200529     C                     Z-ADDZDAYN1    DAYS
247500200529     C                     Z-SUBWHISB     HISB0
247600200529     C*
247700200529     C           *IN80     IFEQ '1'                        - B7
247800200529     C           HISB0     MULT DAYS      NUMB0
247900200529     C                     ELSE                            - X7
248000200529     C           *IN81     IFEQ '1'                        - B8
248100200529     C           HISB1     MULT DAYS      NUMB0
248200200529     C                     ELSE                            - X8
248300200529     C           *IN82     IFEQ '1'                        - B9
248400200529     C           HISB2     MULT DAYS      NUMB0
248500200529     C                     ELSE                            - X9
248600200529     C           HISB3     MULT DAYS      NUMB0
248700200529     C                     END                             - E9
248800200529     C                     END                             - E8
248900200529     C                     END                             - E7
249000200529     C                     Z-SUBNUMB0     NUMB0
249100200529     C           DDAID     SUB  WDAID     INT0
249200200529     C           INT0      SUB  WCAID     INT0
249300200529     C           INT0      ADD  DCAID     INT0
249400200529     C                     Z-SUBINT0      INT0
249500200529     C*
249600200529     C           DAYS      IFNE *ZEROS                     - B7
249700200529     C*
249800200529     C           NUMB0     IFLT *ZEROS
249900200529     C                     ADD  NUMB0     WWTND
250000200529     C                     ELSE
250100200529     C                     ADD  NUMB0     WWTNC
250200200529     C                     END
250300200529     C                     EXSR OVERDC
250400200529     C                     WRITESTOTDC
250500200529     C*
250600200529     C* CHARGE REPORT IF NECESSARY
250700200529     C*
250800200529     C           CCICI     IFNE *BLANK                     - B8
250900200529     C           DTHGAR    IFNE *ZERO                      - B9
251000200529     C           DTHGAN    ORNE *ZERO
251100200529     C                     Z-SUBDTHGAR    CHGR0
251200200529     C                     Z-SUBDTHGAN    CHGN0
251300200529     C                     WRITEPOSTCH
251400200529     C                     END                             - E9
251500200529     C                     END                             - E8
251600200529     C*
251700200529     C                     END                             - E7
251800200529     C*
251900200529     C                     END                             - E6
252000200529     C*
252100200529     C**  PROCESS END OF MONTH OR CHANGE RATE FOR DEBIT
252200200529     C*
252300200529     C           DRECI     IFEQ 'M'                        - B6
252400200529     C           DSDAT     ANDNE*ZEROS
252500200529     C*
252600200529     C                     Z-ADDWDRCB     ZICALC
252700200529     C                     Z-ADDWWHISD    ZIBEG
252800200529     C                     Z-ADDMHISD     ZIEND
252900200529     C                     EXSR ZICD
253000200529     C                     Z-ADDZDAYN1    DAYS
253100200529     C           MNBL      MULT DAYS      NUMB0
253200200529     C*
253300200529     C           *IN80     IFEQ '1'                        - B7
253400200529     C*
253500200529     C                     ELSE                            - X7
253600200529     C           *IN81     IFEQ '1'                        - B8
253700200529     C           NUMB0     DIV  10        NUMB0
253800200529     C                     ELSE                            - X8
253900200529     C           *IN82     IFEQ '1'                        - B9
254000200529     C           NUMB0     DIV  100       NUMB0
254100200529     C                     ELSE                            - X9
254200200529     C           NUMB0     DIV  1000      NUMB0
254300200529     C                     END                             - E9
254400200529     C                     END                             - E8
254500200529     C                     END                             - E7
254600200529     C                     Z-SUBNUMB0     NUMB0
254700200529     C*
254800200529     C           MNBL      IFGT *ZEROS                     - B7
254900200529     C                     Z-SUBDINT      INT0
255000200529     C                     ELSE                            - X7
255100200529     C                     Z-ADDCINT      INT0
255200200529     C                     END                             - E7
255300200529     C           NUMB0     IFLT *ZEROS
255400200529     C                     ADD  NUMB0     WWTND
255500200529     C                     ELSE
255600200529     C                     ADD  NUMB0     WWTNC
255700200529     C                     END
255800200529     C                     EXSR OVERDC
255900200529     C                     WRITESTODDC
256000200529     C*
256100200529     C                     Z-ADDMHISD     WHISDD
256200200529     C                     Z-ADDMNBL      WMNBL
256300200529     C*
256400200529     C                     END                             - E6
256500200529     C*
256600200529     C           DRECI     DOWEQ'M'                        - B6
256700200529     C           *IN51     ANDEQ'0'
256800200529     C*
256900200529     C           KLIST1    READEREHISL                   51
257000200529     C*
257100200529     C           *IN51     IFEQ '0'                        - B7
257200200529     C*
257300200529     C           DRECI     IFEQ 'M'                        - B8
257400200529     C           DSDAT     ANDNE*ZEROS
257500200529     C*
257600200529     C                     Z-ADDWDRCB     ZICALC
257700200529     C                     Z-ADDWWHISD    ZIBEG
257800200529     C                     Z-ADDMHISD     ZIEND
257900200529     C                     EXSR ZICD
258000200529     C                     Z-ADDZDAYN1    DAYS
258100200529     C           MNBL      MULT DAYS      NUMB0
258200200529     C*
258300200529     C           *IN80     IFEQ '1'                        - B9
258400200529     C*
258500200529     C                     ELSE                            - X9
258600200529     C           *IN81     IFEQ '1'                        - B10
258700200529     C           NUMB0     DIV  10        NUMB0
258800200529     C                     ELSE                            - X10
258900200529     C           *IN82     IFEQ '1'                        - B11
259000200529     C           NUMB0     DIV  100       NUMB0
259100200529     C                     ELSE                            - X11
259200200529     C           NUMB0     DIV  1000      NUMB0
259300200529     C                     END                             - E11
259400200529     C                     END                             - E10
259500200529     C                     END                             - E9
259600200529     C                     Z-SUBNUMB0     NUMB0
259700200529     C*
259800200529     C           MNBL      IFGT *ZEROS                     - B9
259900200529     C                     Z-SUBDINT      INT0
260000200529     C                     ELSE                            - X9
260100200529     C                     Z-ADDCINT      INT0
260200200529     C                     END                             - E9
260300200529     C           NUMB0     IFLT *ZEROS
260400200529     C                     ADD  NUMB0     WWTND
260500200529     C                     ELSE
260600200529     C                     ADD  NUMB0     WWTNC
260700200529     C                     END
260800200529     C                     EXSR OVERDC
260900200529     C                     WRITESTODDC
261000200529     C*
261100200529     C                     Z-ADDMHISD     WHISDD
261200200529     C                     Z-ADDMNBL      WMNBL
261300200529     C*
261400200529     C                     ELSE                            - X8
261500200529     C*
261600200529     C           DRECI     IFEQ 'S'                        - B9
261700200529     C***********SDICI     ANDEQ'Y'                                      098818
261800200529     C           SDICI     ANDNE*BLANKS                                  098818
261900200529     C*
262000200529     C                     Z-ADDWDRCB     ZICALC
262100200529     C                     Z-ADDWWHISD    ZIBEG
262200200529     C                     Z-ADDDHISD     ZIEND
262300200529     C                     EXSR ZICD
262400200529     C                     Z-ADDZDAYN1    DAYS
262500200529     C           SMNBL     MULT DAYS      NUMB0
262600200529     C*
262700200529     C           *IN80     IFEQ '1'                        - B10
262800200529     C*
262900200529     C                     ELSE                            - X10
263000200529     C           *IN81     IFEQ '1'                        - B11
263100200529     C           NUMB0     DIV  10        NUMB0
263200200529     C                     ELSE                            - X11
263300200529     C           *IN82     IFEQ '1'                        - B12
263400200529     C           NUMB0     DIV  100       NUMB0
263500200529     C                     ELSE                            - X12
263600200529     C           NUMB0     DIV  1000      NUMB0
263700200529     C                     END                             - E12
263800200529     C                     END                             - E11
263900200529     C                     END                             - E10
264000200529     C                     Z-SUBNUMB0     NUMB0
264100200529     C*
264200200529     C           SMNBL     IFGT *ZEROS                     - B10
264300200529     C                     Z-SUBDINT      INT0
264400200529     C                     ELSE                            - X10
264500200529     C                     Z-ADDCINT      INT0
264600200529     C                     END                             - E10
264700200529     C           NUMB0     IFLT *ZEROS
264800200529     C                     ADD  NUMB0     WWTND
264900200529     C                     ELSE
265000200529     C                     ADD  NUMB0     WWTNC
265100200529     C                     END
265200200529     C                     EXSR OVERDC
265300200529     C                     WRITESTODDC
265400200529     C*
265500200529     C                     Z-ADDDHISD     WHISDD
265600200529     C*
265700200529     C                     END                             - E9
265800200529     C*
265900200529     C                     END                             - E8
266000200529     C*
266100200529     C                     END                             - E7
266200200529     C*
266300200529     C                     END                             - E6
266400200529     C*
266500200529     C                     ELSE                            - X5
266600200529     C*
266700200529     C**  PROCESS IN CASE OF INTEREST TYPE DEBIT IS LESS THAN 3
266800200529     C**  AND INTEREST TYPE CREDIT IS GREATER THAN 2
266900200529     C*
267000200529     C**  PROCESS OUTPUT CHANGING DAY
267100200529     C*
267200200529     C                     Z-SUBWMNBL     HISB0
267300200529     C                     EXSR OVERDC
267400200529     C                     WRITEODAYDC
267500200529     C*
267600200529     C           DDRCI     IFEQ 'Y'                        - B6
267700200529     C*
267800200529     C**  DEBIT RATE CHANGE
267900200529     C*
268000200529     C                     Z-ADDWDRCB     ZICALC
268100200529     C                     Z-ADDWWHISD    ZIBEG
268200200529     C                     Z-ADDDHISD     ZIEND
268300200529     C*
268400200529     C                     EXSR ZICD
268500200529     C*
268600200529     C                     Z-ADDZDAYN1    DAYS
268700200529     C                     Z-SUBWHISB     HISB0
268800200529     C*
268900200529     C           *IN80     IFEQ '1'                        - B7
269000200529     C           HISB0     MULT DAYS      NUMB0
269100200529     C                     ELSE                            - X7
269200200529     C           *IN81     IFEQ '1'                        - B8
269300200529     C           HISB1     MULT DAYS      NUMB0
269400200529     C                     ELSE                            - X8
269500200529     C           *IN82     IFEQ '1'                        - B9
269600200529     C           HISB2     MULT DAYS      NUMB0
269700200529     C                     ELSE                            - X9
269800200529     C           HISB3     MULT DAYS      NUMB0
269900200529     C                     END                             - E9
270000200529     C                     END                             - E8
270100200529     C                     END                             - E7
270200200529     C*
270300200529     C           DAYS      IFNE *ZEROS                     - B7
270400200529     C*
270500200529     C           NUMB0     IFLT *ZEROS
270600200529     C                     ADD  NUMB0     WWTND
270700200529     C                     ELSE
270800200529     C                     ADD  NUMB0     WWTNC
270900200529     C                     END
271000200529     C                     EXSR OVERDC
271100200529     C                     WRITESTOTDC
271200200529     C*
271300200529     C* CHARGE REPORT IF NECESSARY
271400200529     C*
271500200529     C           CCICI     IFNE *BLANK                     - B8
271600200529     C           DTHGAR    IFNE *ZERO                      - B9
271700200529     C           DTHGAN    ORNE *ZERO
271800200529     C                     Z-SUBDTHGAR    CHGR0
271900200529     C                     Z-SUBDTHGAN    CHGN0
272000200529     C                     WRITEPOSTCH
272100200529     C                     END                             - E9
272200200529     C                     END                             - E8
272300200529     C*
272400200529     C                     END                             - E7
272500200529     C*
272600200529     C                     END                             - E6
272700200529     C*
272800200529     C**  CREDIT END OF MONTH OR CREDIT RATE CHANGE
272900200529     C*
273000200529     C           DRECI     IFEQ 'M'                        - B6
273100200529     C           CSDAT     ANDNE*ZEROS
273200200529     C*
273300200529     C                     Z-ADDWCRCB     ZICALC
273400200529     C                     Z-ADDWWHISD    ZIBEG
273500200529     C                     Z-ADDMHISD     ZIEND
273600200529     C                     EXSR ZICD
273700200529     C                     Z-ADDZDAYN1    DAYS
273800200529     C           MNBL      MULT DAYS      NUMB0
273900200529     C*
274000200529     C           *IN80     IFEQ '1'                        - B7
274100200529     C*
274200200529     C                     ELSE                            - X7
274300200529     C           *IN81     IFEQ '1'                        - B8
274400200529     C           NUMB0     DIV  10        NUMB0
274500200529     C                     ELSE                            - X8
274600200529     C           *IN82     IFEQ '1'                        - B9
274700200529     C           NUMB0     DIV  100       NUMB0
274800200529     C                     ELSE                            - X9
274900200529     C           NUMB0     DIV  1000      NUMB0
275000200529     C                     END                             - E9
275100200529     C                     END                             - E8
275200200529     C                     END                             - E7
275300200529     C                     Z-SUBNUMB0     NUMB0
275400200529     C*
275500200529     C           MNBL      IFGT *ZEROS                     - B7
275600200529     C                     Z-SUBDINT      INT0
275700200529     C                     ELSE                            - X7
275800200529     C                     Z-ADDCINT      INT0
275900200529     C                     END                             - E7
276000200529     C           NUMB0     IFLT *ZEROS
276100200529     C                     ADD  NUMB0     WWTND
276200200529     C                     ELSE
276300200529     C                     ADD  NUMB0     WWTNC
276400200529     C                     END
276500200529     C                     EXSR OVERDC
276600200529     C                     WRITESTODDC
276700200529     C*
276800200529     C                     Z-ADDMHISD     WHISDC
276900200529     C                     Z-ADDMNBL      WMNBL
277000200529     C*
277100200529     C                     END                             - E6
277200200529     C*
277300200529     C           DRECI     DOWEQ'M'                        - B6
277400200529     C           *IN51     ANDEQ'0'
277500200529     C*
277600200529     C           KLIST1    READEREHISL                   51
277700200529     C*
277800200529     C           *IN51     IFEQ '0'                        - B7
277900200529     C*
278000200529     C           DRECI     IFEQ 'M'                        - B8
278100200529     C           CSDAT     ANDNE*ZEROS
278200200529     C*
278300200529     C                     Z-ADDWCRCB     ZICALC
278400200529     C                     Z-ADDWWHISD    ZIBEG
278500200529     C                     Z-ADDMHISD     ZIEND
278600200529     C                     EXSR ZICD
278700200529     C                     Z-ADDZDAYN1    DAYS
278800200529     C           MNBL      MULT DAYS      NUMB0
278900200529     C*
279000200529     C           *IN80     IFEQ '1'                        - B9
279100200529     C*
279200200529     C                     ELSE                            - X9
279300200529     C           *IN81     IFEQ '1'                        - B10
279400200529     C           NUMB0     DIV  10        NUMB0
279500200529     C                     ELSE                            - X10
279600200529     C           *IN82     IFEQ '1'                        - B11
279700200529     C           NUMB0     DIV  100       NUMB0
279800200529     C                     ELSE                            - X11
279900200529     C           NUMB0     DIV  1000      NUMB0
280000200529     C                     END                             - E11
280100200529     C                     END                             - E10
280200200529     C                     END                             - E9
280300200529     C                     Z-SUBNUMB0     NUMB0
280400200529     C*
280500200529     C           MNBL      IFGT *ZEROS                     - B9
280600200529     C                     Z-SUBDINT      INT0
280700200529     C                     ELSE                            - X9
280800200529     C                     Z-ADDCINT      INT0
280900200529     C                     END                             - E9
281000200529     C           NUMB0     IFLT *ZEROS
281100200529     C                     ADD  NUMB0     WWTND
281200200529     C                     ELSE
281300200529     C                     ADD  NUMB0     WWTNC
281400200529     C                     END
281500200529     C                     EXSR OVERDC
281600200529     C                     WRITESTODDC
281700200529     C*
281800200529     C                     Z-ADDMHISD     WHISDC
281900200529     C                     Z-ADDMNBL      WMNBL
282000200529     C*
282100200529     C                     ELSE                            - X8
282200200529     C*
282300200529     C           DRECI     IFEQ 'S'                        - B9
282400200529     C***********SCICI     ANDEQ'Y'                                      098818
282500200529     C           SCICI     ANDNE*BLANKS                                  098818
282600200529     C*
282700200529     C                     Z-ADDWCRCB     ZICALC
282800200529     C                     Z-ADDWWHISD    ZIBEG
282900200529     C                     Z-ADDDHISD     ZIEND
283000200529     C                     EXSR ZICD
283100200529     C                     Z-ADDZDAYN1    DAYS
283200200529     C           SMNBL     MULT DAYS      NUMB0
283300200529     C*
283400200529     C           *IN80     IFEQ '1'                        - B10
283500200529     C*
283600200529     C                     ELSE                            - X10
283700200529     C           *IN81     IFEQ '1'                        - B11
283800200529     C           NUMB0     DIV  10        NUMB0
283900200529     C                     ELSE                            - X11
284000200529     C           *IN82     IFEQ '1'                        - B12
284100200529     C           NUMB0     DIV  100       NUMB0
284200200529     C                     ELSE                            - X12
284300200529     C           NUMB0     DIV  1000      NUMB0
284400200529     C                     END                             - E12
284500200529     C                     END                             - E11
284600200529     C                     END                             - E10
284700200529     C                     Z-SUBNUMB0     NUMB0
284800200529     C*
284900200529     C           SMNBL     IFGT *ZEROS                     - B10
285000200529     C                     Z-SUBDINT      INT0
285100200529     C                     ELSE                            - X10
285200200529     C                     Z-ADDCINT      INT0
285300200529     C                     END                             - E10
285400200529     C           NUMB0     IFLT *ZEROS
285500200529     C                     ADD  NUMB0     WWTND
285600200529     C                     ELSE
285700200529     C                     ADD  NUMB0     WWTNC
285800200529     C                     END
285900200529     C                     EXSR OVERDC
286000200529     C                     WRITESTODDC
286100200529     C*
286200200529     C                     Z-ADDDHISD     WHISDC
286300200529     C*
286400200529     C                     END                             - E9
286500200529     C*
286600200529     C                     END                             - E8
286700200529     C*
286800200529     C                     END                             - E7
286900200529     C*
287000200529     C                     END                             - E6
287100200529     C*
287200200529     C                     END                             - E5
287300200529     C*
287400200529     C                     END                             - E4
287500200529     C*
287600200529     C                     END                             - E3
287700200529     C*
287800200529     C                     END                             - E2
287900200529     C*
288000200529     C                     END                             - E1
288100200529      *                                                                   CRE001
288200200529      ** If CRE001 is switched ON and Overdraft Processed Ind. is 'Y'     CRE001
288300200529      ** then Output Overdraft Limit                                      CRE001
288400200529      *                                                                   CRE001
288500200529     C           CRE001    IFEQ 'Y'                          B3           CRE001
288600200529     C           ODLI      ANDEQ'Y'                          A3           CRE001
288700200529      *                                                                   CRE001
288800200529     C                     MOVE *BLANKS   ODLI                            CRE001
288900200529     C                     MOVE *BLANKS   PSTDO                           CRE001
289000200529     C                     Z-ADD*ZEROS    PPSTD                           CRE001
289100200529     C                     MOVE *BLANKS   PSTDA                           CRE001
289200200529      *                                                                   CRE001
289300200529     C           PVALD     IFNE DHISD                      - B4           CRE001
289400200529      *                                                                   CRE001
289500200529      ** Convert History Debit Capitalisation Date to DDMMMYY Format      CRE001
289600200529     C                     MOVELDHISD     ZDAYNO                          CRE001
289700200529     C                     EXSR ZDATE2                                    CRE001
289800200529     C                     MOVE ZADATE    VALDO                           CRE001
289900200529      *                                                                   CRE001
290000200529      ** Handle Conversion Error.                                         CRE001
290100200529      *                                                                   CRE001
290200200529     C           ZERROR    IFNE 0                          - B5           CRE001
290300200529     C                     Z-ADDDHISD     WDATE                           CRE001
290400200529     C                     Z-ADD421       DBASE                           CRE001
290500200529     C                     MOVEL'ZDAT2'   DBFILE           ***************CRE001
290600200529     C                     MOVELWDATE     DBKEY            **DB ERROR 421*CRE001
290700200529     C                     MOVEA'1'       *IN,89           ***************CRE001
290800200529     C                     EXSR DBSR                                      CRE001
290900200529     C                     ENDIF                           - E5           CRE001
291000200529      *                                                                   CRE001
291100200529     C                     Z-ADDDHISD     PVALD                           CRE001
291200200529      *                                                                   CRE001
291300200529     C                     ENDIF                           - E4           CRE001
291400200529      *                                                                   CRE001
291500200529     C                     MOVE VALDO     VALDA                           CRE001
291600200529      *                                                                   CRE001
291700200529     C                     MOVELNAR,37    NARR                            CRE001
291800200529      *                                                                   CRE001
291900200529     C                     Z-ADD*ZERO     WODRL  150                      CRE001
292000200529     C                     SELEC                                          CRE001
292100200529     C           DPA,I     WHEQ 0                                         CRE001
292200200529     C                     Z-ADDODRL      WODRL                           CRE001
292300200529     C           DPA,I     WHEQ 1                                         CRE001
292400200529     C           ODRL      MULT 10        WODRL                           CRE001
292500200529     C           DPA,I     WHEQ 2                                         CRE001
292600200529     C           ODRL      MULT 100       WODRL                           CRE001
292700200529     C           DPA,I     WHEQ 3                                         CRE001
292800200529     C           ODRL      MULT 1000      WODRL                           CRE001
292900200529     C                     ENDSL                                          CRE001
293000200529      *                                                                   CRE001
293100200529     C           WODRL     IFGT *ZEROS                     - B4           CRE001
293200200529     C                     Z-ADDWODRL     PSTD0                           CRE001
293300200529     C                     ELSE                            - X4           CRE001
293400200529     C                     Z-SUBWODRL     PSTD0                           CRE001
293500200529     C                     ENDIF                           - E4           CRE001
293600200529      *                                                                   CRE001
293700200529      **  Output Posting for Debit and Credit                             CRE001
293800200529      *                                                                   CRE001
293900200529     C                     EXSR OVERDC                                    CRE001
294000200529     C                     WRITEPOSTDC                                    CRE001
294100200529      *                                                                   CRE001
294200200529     C                     ENDIF                             E3           CRE001
294300200529     C*
294400200529     C**  TRANSFER DATE MIDAS INTO DDMMMYY
294500200529     C*
294600200529     C           PVALD     IFNE CHISD                      - B1
294700200529     C                     Z-ADDCHISD     ZDAYNO
294800200529     C                     EXSR ZDATE2
294900200529     C                     MOVE ZDATE     VALDO
295000200529     C                     MOVE CHISD     PVALD
295100200529     C                     END                             - E1
295200200529     C*
295300200529     C                     MOVE VALDO     VALDA
295400200529     C*
295500200529     C           WHISB     IFGT *ZEROS                     - B1
295600200529     C                     Z-ADDWDRCB     ZICALC
295700200529     C                     Z-ADDWWHISD    ZIBEG
295800200529     C           WDAID     SUB  CDAIC     INT0
295900200529     C                     ELSE                            - X1
296000200529     C                     Z-ADDWCRCB     ZICALC
296100200529     C                     Z-ADDWWHISD    ZIBEG
296200200529     C           CCAIC     SUB  WCAID     INT0
296300200529     C                     END                             - E1
296400200529     C*
296500200529     C                     Z-ADDCHISD     ZIEND
296600200529     C                     EXSR ZICD
296700200529     C                     Z-ADDZDAYN1    DAYS
296800200529     C                     Z-SUBWHISB     HISB0
296900200529     C*
297000200529     C           *IN80     IFEQ '1'                        - B1
297100200529     C           HISB0     MULT DAYS      NUMB0
297200200529     C                     ELSE                            - X1
297300200529     C           *IN81     IFEQ '1'                        - B2
297400200529     C           HISB1     MULT DAYS      NUMB0
297500200529     C                     ELSE                            - X2
297600200529     C           *IN82     IFEQ '1'                        - B3
297700200529     C           HISB2     MULT DAYS      NUMB0
297800200529     C                     ELSE                            - X3
297900200529     C           HISB3     MULT DAYS      NUMB0
298000200529     C                     END                             - E3
298100200529     C                     END                             - E2
298200200529     C                     END                             - E1
298300200529     C*
298400200529     C           NUMB0     IFLT *ZEROS
298500200529     C                     ADD  NUMB0     WWTND
298600200529     C                     ELSE
298700200529     C                     ADD  NUMB0     WWTNC
298800200529     C                     END
298900200529     C                     EXSR OVERDC
299000200529     C                     WRITESTOTDC
299100200529     C*
299200200529     C** PRINT TOTAL NUMBER
299300200529     C*
299400200529     C                     MOVE *BLANKS   BLAN    1
299500200529     C                     EXSR OVERDC
299600200529     C                     WRITETOTNB
299700200529     C*
299800200529     C                     MOVELNAR,25    NARRD
299900200529     C                     Z-ADDWWTND     TNUMD
300000200529     C                     EXSR OVERDC
300100200529     C                     WRITETOTND
300200200529     C*
300300200529     C                     EXSR OVERDC
300400200529     C                     WRITETOTNB
300500200529     C*
300600200529     C                     MOVELNAR,26    NARRC
300700200529     C                     Z-ADDWWTNC     TNUMC
300800200529     C                     EXSR OVERDC
300900200529     C                     WRITETOTNC
301000200529     C*
301100200529     C                     MOVE *BLANKS   BLAN
301200200529     C                     EXSR OVERDC
301300200529     C                     WRITETOTNB
301400200529     C*
301500200529     C** PREPARE C/F BALANCE
301600200529     C*
301700200529     C                     EXSR CLMSG
301800200529     C                     MOVELNAR,6     TNARR
301900200529     C*
302000200529     C                     Z-SUBCHISB     HISB0
302100200529     C                     Z-SUBCHISB     WWHISB 150
302200200529     C*
302300200529     C**  OUTPUT BALANCE C/F
302400200529     C*
302500200529     C                     EXSR OVERDC
302600200529     C                     WRITETITLEDC
302700200529     C*
302800200529     C**  PREPARE TOTAL INTEREST OUTPUT
302900200529     C*
303000200529     C                     Z-ADDWDRCB     ZICALC
303100200529     C                     Z-ADDCLDID     ZIBEG
303200200529     C                     Z-ADDCHISD     ZIEND
303300200529     C                     EXSR ZICD
303400200529     C*
303500200529     C                     Z-ADDZDAYN1    DAYS
303600200529     C*
303700200529     C                     EXSR CLMSG
303800200529     C                     MOVELNAR,5     XNARR
303900200529     C*
304000200529     C           CCAIC     SUB  CDAIC     TINT0
304100200529     C*
304200200529     C**  Calculate base rate tax
304300200529     C***   Calling subroutine is BOTHSR
304400200529     C*
304500200529     C**********           MOVE 'B'       CALLSR  1                       130468
304600200529     C                     EXSR CALBRT
304700200529     C/COPY WNCPYSRC,RE3765C027
304800200529     C*
304900200529     C           CGL031    IFEQ 'Y'                                                           CGL031
305000200529     C                     EXSR CALEUT                                                        CGL031
305100200529     C                     ENDIF                                                              CGL031
305200200529      *                                                                                       CGL031
305300200529     C**  OUTPUT TOTAL INTEREST
305400200529     C*
305500200529     C                     EXSR OVERDC
305600200529     C                     WRITETOTALDC
305700200529      *                                                                   130468
305800200529      * Report total generated adjustments                                130468
305900200529     C           CSGADI    IFNE *ZEROS                                    130468
306000200529     C                     EXSR CLMSG                                     130468
306100200529     C                     Z-SUBCSGADI    TINT0                           130468
306200200529     C                     MOVELNAR,23    DNARR                           130468
306300200529     C                     EXSR OVERDC                                    130468
306400200529     C                     WRITETOTDDC                                    130468
306500200529     C                     END                                            130468
306600200529     C           CSGACI    IFNE *ZERO                                     130468
306700200529     C                     EXSR CLMSG                                     130468
306800200529     C                     Z-ADDCSGACI    TINT0                           130468
306900200529     C                     MOVELNAR,23    DNARR                           130468
307000200529     C                     EXSR OVERDC                                    130468
307100200529     C                     WRITETOTDDC                                    130468
307200200529     C                     END                                            130468
307300200529      *                                                                   130468
307400200529      * Report BRT if required                                            130468
307500200529     C           *IN22     IFEQ '1'                                       130468
307600200529     C                     EXSR OVERDC                                    130468
307700200529     C                     WRITETOTBRT                                    130468
307800200529     C                     END                                            130468
307900200529      *                                                                                       CGL031
308000200529     C           CGL031    IFEQ 'Y'                                                           CGL031
308100200529     C                     EXSR OVERDC                                                        CGL031
308200200529     C                     WRITEEUWTAX                                                        CGL031
308300200529      *                                                                                       CER048
308400200529      ** Print Secondary Tax Amount                                                           CER048
308500200529      *                                                                                       CER048
308600200529     C           CER048    IFEQ 'Y'                                                           CER048
308700200529      *                                                                                       CER048
308800200529     C                     EXSR OVERDC                                                        CER048
308900200529     C                     WRITESECTAX                                                        CER048
309000200529      *                                                                                       CER048
309100200529     C                     ENDIF                                                              CER048
309200200529      *                                                                                       CER048
309300200529     C                     ENDIF                                                              CGL031
309400200529     C*
309500200529     C**  PREPARE TOTAL COMMISSION OUTPUT
309600200529     C*
309700200529     C*
309800200529     C**  PREPARE FIXED COMMISSION OUTPUT
309900200529     C*
310000200529     C           FXDC      IFNE *ZERO                      - B1
310100200529     C                     EXSR CLMSG
310200200529     C                     MOVELNAR,16    DNARR
310300200529     C*
310400200529     C                     Z-SUBFXDC      TINT0
310500200529     C                     EXSR OVERDC
310600200529     C                     WRITETOTDDC
310700200529     C                     END                             - E1
310800200529     C/COPY WNCPYSRC,RE3765C002
310900200529     C*
311000200529     C**  PREPARE COMMISSION ON DEBIT INTEREST
311100200529     C*
311200200529     C           *IN70     IFEQ '1'                        - B1
311300200529     C*
311400200529     C           CDIE      IFNE *ZERO                      - B2
311500200529     C                     EXSR CLMSG
311600200529     C                     MOVELNAR,17    DNARR
311700200529     C*
311800200529     C                     Z-SUBCDIE      TINT0
311900200529     C                     EXSR OVERDC
312000200529     C                     WRITETOTDDC
312100200529     C                     END                             - E2
312200200529     C*
312300200529     C**  PREPARE ACCOUNT COMMISSION
312400200529     C*
312500200529     C           ACCEA     IFNE *ZERO                      - B2
312600200529     C                     EXSR CLMSG
312700200529     C                     MOVELNAR,18    DNARR
312800200529     C*
312900200529     C                     Z-SUBACCEA     TINT0
313000200529     C                     EXSR OVERDC
313100200529     C                     WRITETOTDDC
313200200529     C                     END                             - E2
313300200529     C*
313400200529     C**  PREPARE H/O COMMISSION
313500200529     C*
313600200529     C           CHDBE     IFNE *ZERO                      - B2
313700200529     C                     EXSR CLMSG
313800200529     C                     MOVELNAR,19    DNARR
313900200529     C*
314000200529     C                     Z-SUBCHDBE     TINT0
314100200529     C                     EXSR OVERDC
314200200529     C                     WRITETOTDDC
314300200529     C                     END                             - E2
314400200529     C*
314500200529     C**  PREPARE COMMISSION ON MINIMUM BALANCE
314600200529     C*
314700200529     C           CMBE      IFNE *ZERO                      - B2
314800200529     C                     EXSR CLMSG
314900200529     C                     MOVELNAR,20    DNARR
315000200529     C*
315100200529     C                     Z-SUBCMBE      TINT0
315200200529     C                     EXSR OVERDC
315300200529     C                     WRITETOTDDC
315400200529     C                     END                             - E2
315500200529     C*
315600200529     C                     ELSE                            - X1
315700200529     C*
315800200529     C           CDICA     IFNE *ZERO                      - B2
315900200529     C                     EXSR CLMSG
316000200529     C                     MOVELNAR,17    DNARR
316100200529     C*
316200200529     C           CCDIC     SUB  CDICA     TINT0
316300200529     C                     EXSR OVERDC
316400200529     C                     WRITETOTDDC
316500200529     C                     END                             - E2
316600200529     C*
316700200529     C**  PREPARE ACCOUNT COMMISSION
316800200529     C*
316900200529     C           *IN54     IFEQ '1'                        - B2
317000200529     C*
317100200529     C* PREPARE PREVIOUS PERIOD COMMISSIONS TOTAL NOT POSTED.
317200200529     C*
317300200529     C           GVDPC     IFNE *ZERO
317400200529     C*
317500200529     C                     EXSR CLMSG
317600200529     C                     MOVELNAR,33    DNARR
317700200529     C           GVDPC     SUB  TOTPST    TINT0
317800200529     C           TINT0     IFNE *ZERO
317900200529     C                     EXSR OVERDC
318000200529     C                     WRITETOTDDC
318100200529     C                     END
318200200529     C*
318300200529     C* PREPARE ADJUSTMENT TO COMMISSIONS
318400200529     C*
318500200529     C                     EXSR CLMSG
318600200529     C           GVDPC     MULT ACCRA     CALC   180
318700200529     C           CALC      DIV  100       CALC
318800200529     C                     MOVELNAR,34    DNARR
318900200529     C           CALC      SUB  ACCC      TINT0
319000200529     C           TINT0     IFNE *ZERO
319100200529     C                     EXSR OVERDC
319200200529     C                     WRITETOTDDC
319300200529     C                     END
319400200529     C*
319500200529     C                     EXSR CLMSG
319600200529     C                     MOVELNAR,28    DNARR
319700200529     C                     Z-ADDTOTPST    TINT0
319800200529     C           TINT0     IFNE *ZERO
319900200529     C                     EXSR OVERDC
320000200529     C                     WRITETOTDDC
320100200529     C                     END
320200200529     C*
320300200529     C                     EXSR CLMSG
320400200529     C                     MOVELNAR,29    DNARR
320500200529     C                     Z-ADDTOTNPS    TINT0
320600200529     C           TINT0     IFNE *ZERO
320700200529     C                     EXSR OVERDC
320800200529     C                     WRITETOTDDC
320900200529     C                     END
321000200529     C*
321100200529     C                     EXSR CLMSG
321200200529     C                     MOVELNAR,30    QNARR
321300200529     C                     Z-ADDACCRA     RATET
321400200529     C                     EXSR OVERDC
321500200529     C                     WRITETURRAT
321600200529     C*
321700200529     C                     EXSR CLMSG
321800200529     C                     MOVELNAR,18    DNARR
321900200529     C*
322000200529     C** CACCC IS SET TO ZERO IN PREVIOUS PROGRAM  RE3116
322100200529     C                     Z-ADDACCC      TINT0
322200200529     C           TINT0     IFNE *ZERO
322300200529     C                     EXSR OVERDC
322400200529     C                     WRITETOTDDC
322500200529     C                     END
322600200529     C                     END                             - E2
322700200529     C*
322800200529     C                     END                             - E2
322900200529     C*
323000200529     C**  PREPARE H/O COMMISSION
323100200529     C*
323200200529     C           CHDBC     IFNE *ZERO                      - B2
323300200529     C                     EXSR CLMSG
323400200529     C                     MOVELNAR,19    DNARR
323500200529     C*
323600200529     C           CCHDBC    SUB  CHDBC     TINT0
323700200529     C                     EXSR OVERDC
323800200529     C                     WRITETOTDDC
323900200529     C                     END                             - E2
324000200529     C*
324100200529     C**  PREPARE COMMISSION ON MINIMUM BALANCE
324200200529     C*
324300200529     C           CMBC      IFNE *ZERO                      - B2
324400200529     C                     EXSR CLMSG
324500200529     C                     MOVELNAR,20    DNARR
324600200529     C*
324700200529     C           CCMBC     SUB  CMBC      TINT0
324800200529     C                     EXSR OVERDC
324900200529     C                     WRITETOTDDC
325000200529     C                     END                             - E2
325100200529     C*
325200200529     C**  PREPARE VAT
325300200529     C*
325400200529     C           VATAM     IFNE *ZERO                      - B2
325500200529     C                     EXSR CLMSG
325600200529     C                     MOVELNAR,24    DNARR
325700200529     C*
325800200529     C                     Z-SUBVATAM     TINT0
325900200529     C           WWHISB    SUB  VATAM     WWHISB
326000200529     C                     EXSR OVERDC
326100200529     C                     WRITETOTDDC
326200200529     C                     END                             - E2
326300200529     C*
326400200529     C                     END                             - E1
326500200529     C*
326600200529     C**  PREPARE TOTAL CHARGES
326700200529     C*
326800200529     C           CCHGP     IFNE *ZERO                      - B1
326900200529     C                     EXSR CLMSG
327000200529     C                     MOVELNAR,22    DNARR
327100200529     C*
327200200529     C                     Z-SUBCCHGP     TINT0
327300200529     C                     EXSR OVERDC
327400200529     C                     WRITETOTDDC
327500200529     C                     END                             - E1
327600200529     C**  PREPARE CTGLIS
327700200529     C*
327800200529     C           CTGLIS    IFLT 0
327900200529     C                     Z-SUBCTGLIS    TINT0
328000200529     C                     EXSR CLMSG
328100200529     C                     MOVELNAR,27    DNARR
328200200529     C*
328300200529     C                     EXSR OVERDC
328400200529     C                     WRITETOTDDC
328500200529     C                     END
328600200529     C*
328700200529     C**  PREPARE TOTAL
328800200529     C*
328900200529     C                     Z-ADD*ZERO     TINT0
329000200529     C           *IN70     IFEQ '0'                        - B1
329100200529     C                     ADD  CDICA     TINT0
329200200529     C           *IN54     IFEQ '1'                        - B2
329300200529     C                     ADD  ACCC      TINT0
329400200529     C                     END                             - E2
329500200529     C                     ADD  CHDBC     TINT0
329600200529     C                     ADD  CMBC      TINT0
329700200529     C                     ADD  VATAM     TINT0
329800200529     C                     ELSE                            - X1
329900200529     C                     ADD  CDIE      TINT0
330000200529     C                     ADD  ACCEA     TINT0
330100200529     C                     ADD  CHDBE     TINT0
330200200529     C                     ADD  CMBE      TINT0
330300200529     C                     END                             - E1
330400200529     C           CSDCI     IFEQ 'Y'                        - B1
330500200529     C           CSDCI     OREQ 'I'
330600200529     C           CSDCI     OREQ 'A'
330700200529     C**********           ADD  FXDC      TINT0                           182037
330800200529     C/COPY WNCPYSRC,RE3765C003
330900200529     C                     ADD  CDAIC     TINT0
331000200529     C                     END                             - E1
331100200529      *                                                                   182037
331200200529      ** If there is interest to capitalise, add the Fixed Commission     182037
331300200529      ** to the total interest to capitalise.                             182037
331400200529      *                                                                   182037
331500200529     C                     ADD  FXDC      TINT0                           182037
331600200529      *                                                                   182037
331700200529     C           CSCCI     IFEQ 'Y'                        - B1
331800200529     C           CSCCI     OREQ 'I'
331900200529     C           CSCCI     OREQ 'A'
332000200529     C                     SUB  CCAIC     TINT0
332100200529     C/COPY WNCPYSRC,RE3765C028
332200200529     C                     END                             - E1
332300200529      *                                                                   130468
332400200529      * Add BRT if applicable                                             130468
332500200529     C           *IN22     IFEQ '1'                                       130468
332600200529     C                     ADD  BRTOT0    TINT0                           130468
332700200529     C                     END                                            130468
332800200529      *                                                                   130468
332900200529     C           CGL031    IFEQ 'Y'                                                           CGL031
333000200529     C                     ADD  EUTAX0    TINT0                                               CGL031
333100200529      *                                                                                       CER048
333200200529      ** Add Secondary Tax, if applicable                                                     CER048
333300200529      *                                                                                       CER048
333400200529     C           CER048    IFEQ 'Y'                                                           CER048
333500200529     C                     ADD  STAX0     TINT0                                               CER048
333600200529     C                     ENDIF                                                              CER048
333700200529      *                                                                                       CER048
333800200529     C                     END                                                                CGL031
333900200529      *                                                                                       CGL031
334000200529     C           CSCHGI    IFEQ 'Y'                        - B1
334100200529     C           CSCHGI    OREQ 'I'
334200200529     C           CSCHGI    OREQ 'A'
334300200529     C                     ADD  CCHGP     TINT0
334400200529     C                     END                             - E1
334500200529      *                                                                   130468
334600200529     C                     ADD  CSGADI    TINT0                           130468
334700200529     C                     SUB  CSGACI    TINT0                           130468
334800200529      *                                                                   130468
334900200529     C*
335000200529     C           CTGLIS    IFLT 0
335100200529     C* (TINT0 = INT + COM  SIGNE +) CTGLIS SIGNE - VIENT EN MOINS
335200200529     C* DES INTERETS
335300200529     C                     ADD  CTGLIS    TINT0
335400200529     C*
335500200529     C                     END
335600200529     C*
335700200529     C                     Z-SUBTINT0     TINT0
335800200529     C                     EXSR CLMSG
335900200529     C                     MOVELNAR,21    DNARR
336000200529     C*
336100200529     C                     EXSR OVERDC
336200200529     C                     WRITETOTDDC
336300200529     C*
336400200529     C** WRITE THE FUTURE POSTINGS FOR CLEARED BALANCE
336500200529     C*
336600200529     C                     Z-ADDCHISD     KDATE   50
336700200529     C                     Z-ADDCHISD     KDATE2  50
336800200529     C*
336900200529     C           KREHP     SETLLREHPOPH
337000200529     C           KREHP     READEREHPOPH                  58
337100200529     C*
337200200529     C** WRITE TITLE OF FUTURE VALUE
337300200529     C*
337400200529     C           *IN58     IFEQ '0'                        - B1
337500200529     C                     EXSR CLMSG
337600200529     C                     MOVELNAR,32    RNARR
337700200529     C                     EXSR OVERDC
337800200529     C                     WRITEFUTVAL
337900200529     C                     MOVE '1'       *IN59
338000200529     C                     END                             - E1
338100200529     C*
338200200529     C           *IN58     DOWEQ'0'                        - B1
338300200529     C*
338400200529     C           PPSTD     IFNE PSTD                       - B2
338500200529     C                     Z-ADDPSTD      ZDAYNO
338600200529     C                     EXSR ZDATE2
338700200529     C                     MOVE ZDATE     PSTDO
338800200529     C                     Z-ADDPSTD      PPSTD
338900200529     C                     END                             - E2
339000200529     C*
339100200529     C                     MOVE PSTDO     PSTDA
339200200529     C*
339300200529     C           PVALD     IFNE HISD                       - B2
339400200529     C                     Z-ADDHISD      ZDAYNO
339500200529     C                     EXSR ZDATE2
339600200529     C                     MOVE ZDATE     VALDO
339700200529     C                     Z-ADDHISD      PVALD
339800200529     C                     END                             - E2
339900200529     C*
340000200529     C                     MOVE VALDO     VALDA
340100200529     C*
340200200529     C                     MOVELPNAR      NARR
340300200529     C*
340400200529     C           DRCR      IFEQ 0                          - B2
340500200529     C                     Z-SUBPSTA      PSTD0
340600200529     C           WWHISB    SUB  PSTA      WWHISB
340700200529     C                     ELSE                            - X2
340800200529     C                     Z-ADDPSTA      PSTD0
340900200529     C           WWHISB    ADD  PSTA      WWHISB
341000200529     C                     END                             - E2
341100200529     C*
341200200529     C**  OUTPUT POSTING FOR DEBIT AND CREDIT
341300200529     C*
341400200529     C                     EXSR OVERDC
341500200529     C                     WRITEPOSTDC
341600200529     C*
341700200529     C           KREHP     READEREHPOPH                  58
341800200529     C*
341900200529     C                     END                             - E1
342000200529     C*
342100200529     C           KCLEAR    SETLLAPOSTPDF
342200200529     C           KCLEAR    READEAPOSTPDF                 53
342300200529     C*
342400200529     C** WRITE TITLE OF FUTURE VALUE
342500200529     C*
342600200529     C           *IN53     IFEQ '0'                        - B1
342700200529     C           *IN59     ANDEQ'0'
342800200529     C                     EXSR CLMSG
342900200529     C                     MOVELNAR,32    RNARR
343000200529     C                     EXSR OVERDC
343100200529     C                     WRITEFUTVAL
343200200529     C                     END                             - E1
343300200529     C*
343400200529     C           *IN53     DOWEQ'0'                        - B1
343500200529     C*
343600200529     C           VALD      IFGE DNWD                       - B2
343700200529     C*
343800200529     C           PPSTD     IFNE PSTD                       - B3
343900200529     C                     Z-ADDPSTD      ZDAYNO
344000200529     C                     EXSR ZDATE2
344100200529     C                     MOVE ZDATE     PSTDO
344200200529     C                     Z-ADDPSTD      PPSTD
344300200529     C                     END                             - E3
344400200529     C*
344500200529     C                     MOVE PSTDO     PSTDA
344600200529     C*
344700200529     C           PVALD     IFNE VALD                       - B3
344800200529     C                     Z-ADDVALD      ZDAYNO
344900200529     C                     EXSR ZDATE2
345000200529     C                     MOVE ZDATE     VALDO
345100200529     C                     Z-ADDVALD      PVALD
345200200529     C                     END                             - E3
345300200529     C*
345400200529     C                     MOVE VALDO     VALDA
345500200529     C*
345600200529     C                     MOVELPNAR      NARR
345700200529     C*
345800200529     C           DRCR      IFEQ 0                          - B3
345900200529     C                     Z-SUBPSTA      PSTD0
346000200529     C           WWHISB    SUB  PSTA      WWHISB
346100200529     C                     ELSE                            - X3
346200200529     C                     Z-ADDPSTA      PSTD0
346300200529     C           WWHISB    ADD  PSTA      WWHISB
346400200529     C                     END                             - E3
346500200529     C*
346600200529     C**  OUTPUT POSTING FOR DEBIT AND CREDIT
346700200529     C*
346800200529     C                     EXSR OVERDC
346900200529     C                     WRITEPOSTDC
347000200529     C*
347100200529     C                     END                             - E2
347200200529     C*
347300200529     C           KCLEAR    READEAPOSTPDF                 53
347400200529     C*
347500200529     C                     END                             - E1
347600200529     C*
347700200529     C                     MOVE '0'       *IN59
347800200529     C                     MOVE '0'       *IN58
347900200529     C*
348000200529     C                     EXSR CLMSG
348100200529     C                     MOVELNAR,31    TNARR
348200200529     C*
348300200529     C                     Z-ADDWWHISB    HISB0
348400200529     C                     MOVE *BLANKS   VALDA
348500200529     C*
348600200529     C                     EXSR OVERDC
348700200529     C                     WRITETITLEDC
348800200529     C*
348900200529     C           *IN70     IFEQ '1'                        - B1
349000200529     C                     EXSR OVERDC
349100200529     C                     WRITETOTMAN
349200200529     C                     END                             - E1
349300200529     C*
349400200529     C/COPY WNCPYSRC,RE3765C007
349500200529     C           CER050    IFEQ 'Y'                                                           CER050
349600200529      *                                                                                       CER050
349700200529     C           *IN70     IFEQ '0'                        B001                               CER050
349800200529      *                                                                                       CER050
349900200529     C                     MOVEA'00'      *IN,61                                              CER050
350000200529     C                     MOVE *BLANKS   TANAR  30                                           CER050
350100200529      *                                                                                       CER050
350200200529     C           KACCNT    CHAINACCNTBY0             99                                       CER050
350300200529     C           *IN99     IFEQ '0'                                                           CER050
350400200529      *                                                                                       CER050
350500200529      * Run this process only if APR is set to 'Y'                                            CER050
350600200529      *                                                                                       CER050
350700200529     C           ATAPRC    IFEQ 'Y'                                                           CER050
350800200529     C                     EXSR SRAPRD                                                        CER050
350900200529     C                     EXSR SRAPRC                                                        CER050
351000200529     C                     ENDIF                                                              CER050
351100200529     C                     ENDIF                                                              CER050
351200200529      *                                                                                       CER050
351300200529     C                     ENDIF                                                              CER050
351400200529      *                                                                                       CER050
351500200529     C                     ENDIF                                                              CER050
351600200529      *                                                                                       CER050
351700200529     C                     ENDSR                           **BOTHSR ENDSR*
351800200529     C********************************************************************
351900200529     C/EJECT
352000200529     C********************************************************************
352100200529     C**
352200200529     C** B1EQ subroutine for begin when same date
352300200529     C**
352400200529     C**     Called by       B O T H S R
352500200529     C**
352600200529     C**     Calls           DBSR, POSTSR
352700200529     C**
352800200529     C           B1EQ      BEGSR                           **B1EQ   BEGSR*
352900200529     C*
353000200529     C           KLIST2    SETLLREHPOPH
353100200529     C*
353200200529     C           KLIST1    READEREHPOPH                  50
353300200529     C*
353400200529     C**  BACK VALUE PROCESSING
353500200529     C*
353600200529     C           *IN50     DOWEQ'0'                        - B1
353700200529     C           PSTD      ANDGECLDID
353800200529     C*
353900200529     C           HISD      IFLT CLDID                      _ B2
354000200529     C           PSTD      ANDGTCLDID
354100200529     C*
354200200529     C                     EXSR POSTSR
354300200529     C*
354400200529     C                     END                             - E2
354500200529     C*
354600200529     C           KLIST1    READEREHPOPH                  50
354700200529     C*
354800200529     C                     END                             - E1
354900200529     C           *IN70     IFEQ '1'                        - B1
355000200529     C           KLIST1    SETLLREHISSL                  20
355100200529     C*
355200200529     C           *IN20     IFEQ '1'                        - B2
355300200529     C           KLIST1    READEREADJF                   20
355400200529     C           *IN20     DOWEQ'0'                        - B3
355500200529     C*
355600200529     C** PRINT INTEREST OF THE BACK VALUE DATE
355700200529     C*
355800200529     C                     MOVELNAR,23    NARR
355900200529     C                     Z-SUBAHISB     HISB0
356000200529     C*
356100200529     C           ACAIC     SUB  ADAIC     INT0
356200200529     C*
356300200529     C                     EXSR OVERDC
356400200529     C                     WRITEMADJDC
356500200529     C*
356600200529     C           KLIST1    READEREADJF                   20
356700200529     C                     END                             - E3
356800200529     C*
356900200529     C                     END                             - E2
357000200529     C                     END                             - E1
357100200529     C*
357200200529     C**  PREPARE OPENING BALANCE
357300200529     C*
357400200529     C           PVALD     IFNE CLDID                      - B1
357500200529     C                     Z-ADDCLDID     ZDAYNO
357600200529     C                     EXSR ZDATE2
357700200529     C                     MOVE ZDATE     VALDO
357800200529     C                     Z-ADDCLDID     PVALD
357900200529     C                     END                             - E1
358000200529     C*
358100200529     C                     MOVE VALDO     VALDA
358200200529     C*
358300200529     C                     Z-SUBDOHISB    HISB0
358400200529     C*
358500200529     C**  OPENING BALANCE DEBIT OUPUT
358600200529     C*
358700200529     C                     EXSR CLMSG
358800200529     C                     MOVELNAR,15    TNARR
358900200529     C*
359000200529     C                     EXSR OVERDC
359100200529     C                     WRITETITLEDC
359200200529     C                     Z-SUBCOHISB    HISB0
359300200529     C*
359400200529     C**  OPENING BALANCE CREDIT OUTPUT
359500200529     C*
359600200529     C                     EXSR CLMSG
359700200529     C                     MOVELNAR,16    TNARR
359800200529     C*
359900200529     C                     EXSR OVERDC
360000200529     C                     WRITETITLEDC
360100200529     C*
360200200529     C                     MOVE *BLANKS   VALDA
360300200529     C                     MOVE *BLANKS   PSTDA
360400200529     C*
360500200529     C                     EXSR CLMSG
360600200529     C**                   MOVELNAR,3     RNARR
360700200529     C*
360800200529     C**  ACCESS REHRDJ (REHPOSR1 REHPOSR2 REHPOSR3) WHICH CONTAINS
360900200529     C**  THE GOOD DATES FOR DEBIT RATE CHANGE TO
361000200529     C*
361100200529     C                     Z-ADDWWDRCD    KDATE
361200200529     C           KEODLF    CHAINREHRDJ               60
361300200529     C*
361400200529     C           *IN60     IFEQ '1'                        - B1
361500200529     C                     Z-ADD*ZEROS    DRIR
361600200529     C                     END                             - E1
361700200529     C*
361800200529     C                     EXSR CLMSG
361900200529     C                     MOVELNAR,3     RNARR
362000200529     C*
362100200529     C                     MOVE *BLANKS   PSTDA
362200200529     C                     MOVE *BLANKS   VALDA
362300200529     C*
362400200529     C**  OUTPUT DEBIT RATE CHANGE TO
362500200529     C*
362600200529     C                     EXSR RDRSR
362700200529      *                                                                   CRE001
362800200529      ** If CRE001 is switched ON                                         CRE001
362900200529      *                                                                   CRE001
363000200529     C           CRE001    IFEQ 'Y'                                       CRE001
363100200529      *                                                                   CRE001
363200200529      **    Output Overdraft Limit                                        CRE001
363300200529     C                     EXSR CLMSG                                     CRE001
363400200529     C                     MOVELNAR,36    ONARR                           CRE001
363500200529     C                     MOVE ODRL      OODRL                           CRE001
363600200529     C                     EXSR OVERDC                                    CRE001
363700200529     C                     WRITEODLNDC                                    CRE001
363800200529      *                                                                   CRE001
363900200529      **    Output Additional Overdraft Rate                              CRE001
364000200529     C                     EXSR CLMSG                                     CRE001
364100200529     C                     MOVELNAR,35    ONARR                           CRE001
364200200529     C                     MOVE AODR      OAODR                           CRE001
364300200529     C                     EXSR OVERDC                                    CRE001
364400200529     C                     WRITEAODRDC                                    CRE001
364500200529      *                                                                   CRE001
364600200529     C                     ENDIF                                          CRE001
364700200529     C*
364800200529     C**  ACCESS REHRCJ (REHPOSR1 REHPOSR2 REHPOSR3) WHICH CONTAINS
364900200529     C**  THE GOOD DATES FOR CREDIT RATE CHANGE TO
365000200529     C*
365100200529     C                     Z-ADDWWCRCD    KDATE
365200200529     C           KEODLF    CHAINREHRCJ               60
365300200529     C*
365400200529     C           *IN60     IFEQ '1'                        - B1
365500200529     C                     Z-ADD*ZEROS    CRIR
365600200529     C                     END                             - E1
365700200529     C*
365800200529     C                     EXSR CLMSG
365900200529     C                     MOVELNAR,8     RNARR
366000200529     C*
366100200529     C                     MOVE *BLANKS   PSTDA
366200200529     C                     MOVE *BLANKS   VALDA
366300200529     C*
366400200529     C**  OUTPUT DEBIT RATE CHANGE TO
366500200529     C*
366600200529     C                     EXSR RCRSR
366700200529     C*
366800200529     C           KLIST2    SETLLREHPOPL
366900200529     C           KLIST1    READEREHPOPL                  50
367000200529     C*
367100200529     C                     ENDSR                           **B1EQ   ENDSR*
367200200529     C********************************************************************
367300200529     C/EJECT
367400200529     C********************************************************************
367500200529     C**
367600200529     C** B1GT subroutine for begin when debit greater than credit
367700200529     C**
367800200529     C**     Called by       B O T H S R
367900200529     C**
368000200529     C**     Calls           DBSR, POSTSR, OPENCR, OPENDR
368100200529     C**
368200200529     C           B1GT      BEGSR                           **B1GT   BEGSR*
368300200529     C*
368400200529     C           KLIST3    SETLLREHPOPH
368500200529     C*
368600200529     C           KLIST1    READEREHPOPH                  50
368700200529     C*
368800200529     C           *IN50     DOWEQ'0'                        - B1
368900200529     C           PSTD      ANDLTCHISD
369000200529     C*
369100200529     C           HISD      IFLT CLCID                      - B2
369200200529     C*
369300200529     C**  BACK VALUE PROCESSING FOR DEBIT AND CREDIT
369400200529     C*
369500200529     C                     EXSR POSTSR
369600200529     C*
369700200529     C                     END                             - E2
369800200529     C*
369900200529     C           KLIST1    READEREHPOPH                  50
370000200529     C*
370100200529     C                     END                             - E1
370200200529     C           *IN70     IFEQ '1'                        - B1
370300200529     C           KLIST1    SETLLREHISSL                  20
370400200529     C*
370500200529     C           *IN20     IFEQ '1'                        - B2
370600200529     C           KLIST1    READEREADJF                   20
370700200529     C           *IN20     DOWEQ'0'                        - B3
370800200529     C*
370900200529     C** PRINT INTEREST OF THE BACK VALUE DATE
371000200529     C*
371100200529     C                     MOVELNAR,23    NARR
371200200529     C                     Z-SUBAHISB     HISB0
371300200529     C*
371400200529     C           ACAIC     SUB  ADAIC     INT0
371500200529     C*
371600200529     C                     EXSR OVERDC
371700200529     C                     WRITEMADJDC
371800200529     C*
371900200529     C           KLIST1    READEREADJF                   20
372000200529     C                     END                             - E3
372100200529     C*
372200200529     C                     END                             - E2
372300200529     C                     END                             - E1
372400200529     C*
372500200529     C**  OPENING BALANCE AND OPENING RATE FOR CREDIT
372600200529     C*
372700200529     C                     EXSR OPENCR
372800200529     C*
372900200529     C           *IN50     DOWEQ'0'                        - B1
373000200529     C           PSTD      ANDLTCHISD
373100200529     C*
373200200529     C           HISD      IFLT CLDID                      - B2
373300200529     C*
373400200529     C**  BACK VALUE PROCESSING FOR DEBIT AND POSTING FOR CREDIT
373500200529     C*
373600200529     C                     EXSR POSTSR
373700200529     C*
373800200529     C                     END                             - E2
373900200529     C*
374000200529     C           KLIST1    READEREHPOPH                  50
374100200529     C*
374200200529     C                     END                             - E1
374300200529     C           *IN70     IFEQ '1'                        - B1
374400200529     C           KLIST1    SETLLREHISSL                  20
374500200529     C*
374600200529     C           *IN20     IFEQ '1'                        - B2
374700200529     C           KLIST1    READEREADJF                   20
374800200529     C           *IN20     DOWEQ'0'                        - B3
374900200529     C*
375000200529     C** PRINT INTEREST OF THE BACK VALUE DATE (INTEREST ADJUSTEMENT)
375100200529     C*
375200200529     C                     MOVELNAR,23    NARR
375300200529     C                     Z-SUBAHISB     HISB0
375400200529     C*
375500200529     C           ACAIC     SUB  ADAIC     INT0
375600200529     C*
375700200529     C                     EXSR OVERDC
375800200529     C                     WRITEMADJDC
375900200529     C*
376000200529     C           KLIST1    READEREADJF                   20
376100200529     C                     END                             - E3
376200200529     C*
376300200529     C                     END                             - E2
376400200529     C                     END                             - E1
376500200529     C*
376600200529     C**  OPENING BALANCE AND OPENING RATE FOR DEBIT
376700200529     C*
376800200529     C                     EXSR OPENDR
376900200529     C*
377000200529     C           KLIST3    SETLLREHPOPL
377100200529     C           KLIST1    READEREHPOPL                  50
377200200529     C*
377300200529     C                     ENDSR                           **B1GT   ENDSR*
377400200529     C********************************************************************
377500200529     C/EJECT
377600200529     C********************************************************************
377700200529     C**
377800200529     C** B1LT subroutine for begin when debit lower than credit
377900200529     C**
378000200529     C**     Called by       B O T H S R
378100200529     C**
378200200529     C**     Calls           DBSR, POSTSR, OPENCR, OPENDR
378300200529     C**
378400200529     C           B1LT      BEGSR                           **B1LT   BEGSR*
378500200529     C*
378600200529     C           KLIST2    SETLLREHPOPH
378700200529     C*
378800200529     C           KLIST1    READEREHPOPH                  50
378900200529     C*
379000200529     C           *IN50     DOWEQ'0'                        - B1
379100200529     C           PSTD      ANDLTCHISD
379200200529     C*
379300200529     C**  BACK VALUE PROCESSING FOR DEBIT AND CREDIT
379400200529     C*
379500200529     C           HISD      IFLT CLDID                      - B2
379600200529     C*
379700200529     C                     EXSR POSTSR
379800200529     C*
379900200529     C                     END                             - E2
380000200529     C*
380100200529     C           KLIST1    READEREHPOPH                  50
380200200529     C*
380300200529     C                     END                             - E1
380400200529     C           *IN70     IFEQ '1'                        - B1
380500200529     C           KLIST1    SETLLREHISSL                  20
380600200529     C*
380700200529     C           *IN20     IFEQ '1'                        - B2
380800200529     C           KLIST1    READEREADJF                   20
380900200529     C           *IN20     DOWEQ'0'                        - B3
381000200529     C*
381100200529     C** PRINT INTEREST OF THE BACK VALUE DATE
381200200529     C*
381300200529     C                     MOVELNAR,23    NARR
381400200529     C                     Z-SUBAHISB     HISB0
381500200529     C*
381600200529     C           ACAIC     SUB  ADAIC     INT0
381700200529     C*
381800200529     C                     EXSR OVERDC
381900200529     C                     WRITEMADJDC
382000200529     C*
382100200529     C           KLIST1    READEREADJF                   20
382200200529     C                     END                             - E3
382300200529     C*
382400200529     C                     END                             - E2
382500200529     C                     END                             - E1
382600200529     C*
382700200529     C**  OPENING BALANCE AND OPENING RATE FOR DEBIT
382800200529     C*
382900200529     C                     EXSR OPENDR
383000200529     C*
383100200529     C           *IN50     DOWEQ'0'                        - B1
383200200529     C           PSTD      ANDLTCHISD
383300200529     C*
383400200529     C**  BACK VALUE PROCESSING FOR CREDIT AND POSTING FOR DEBIT
383500200529     C*
383600200529     C           HISD      IFLT CLCID                      - B2
383700200529     C*
383800200529     C                     EXSR POSTSR
383900200529     C*
384000200529     C                     END                             - E2
384100200529     C*
384200200529     C           KLIST1    READEREHPOPH                  50
384300200529     C*
384400200529     C                     END                             - E1
384500200529     C           *IN70     IFEQ '1'                        - B1
384600200529     C           KLIST1    SETLLREHISSL                  20
384700200529     C*
384800200529     C           *IN20     IFEQ '1'                        - B2
384900200529     C           KLIST1    READEREADJF                   20
385000200529     C           *IN20     DOWEQ'0'                        - B3
385100200529     C*
385200200529     C** PRINT INTEREST OF THE BACK VALUE DATE
385300200529     C*
385400200529     C                     MOVELNAR,23    NARR
385500200529     C                     Z-SUBAHISB     HISB0
385600200529     C*
385700200529     C           ACAIC     SUB  ADAIC     INT0
385800200529     C*
385900200529     C                     EXSR OVERDC
386000200529     C                     WRITEMADJDC
386100200529     C*
386200200529     C           KLIST1    READEREADJF                   20
386300200529     C                     END                             - E3
386400200529     C*
386500200529     C                     END                             - E2
386600200529     C                     END                             - E1
386700200529     C*
386800200529     C**  OPENING BALANCE AND OPENING RATE FOR CREDIT
386900200529     C*
387000200529     C                     EXSR OPENCR
387100200529     C*
387200200529     C           KLIST2    SETLLREHPOPL
387300200529     C           KLIST1    READEREHPOPL                  50
387400200529     C*
387500200529     C                     ENDSR                           **B1LT   ENDSR*
387600200529     C********************************************************************
387700200529     C/EJECT
387800200529     C********************************************************************
387900200529     C***
388000200529     C***   CLEAR INPUT VARIABLES OF MESSAGE
388100200529     C***
388200200529     C           CLMSG     BEGSR                           ** SR CLMSG **
388300200529     C                     MOVEL*BLANK    MSGDT0
388400200529     C                     MOVEL*BLANK    MSGDT1
388500200529     C                     MOVEL*BLANK    MSGDT2
388600200529     C                     MOVEL*BLANK    MSGDT3
388700200529     C                     MOVEL*BLANK    MSGDT4
388800200529     C                     MOVEL*BLANK    MSGDT5
388900200529     C                     MOVEL*BLANK    MSGDT6
389000200529     C                     MOVEL*BLANK    MSGDT7
389100200529     C                     MOVEL*BLANK    MSGDT8
389200200529     C                     MOVEL*BLANK    MSGDT9
389300200529     C                     MOVEL*BLANK    MNARR
389400200529     C                     ENDSR                           **CLMSG ENDSR**
389500200529     C**
389600200529     C********************************************************************
389700200529     C/EJECT
389800200529     C********************************************************************
389900200529     C**
390000200529     C** CRSR subroutine for credit output processing
390100200529     C**
390200200529     C**     Called by       DETPR
390300200529     C**
390400200529     C**     Calls           DBSR, DAYTSR, RATEC, ITYPCR, ZICD, OVERDC
390500200529     C**
390600200529     C           CRSR      BEGSR                           **CRSR BEGSR**
390700200529     C*
390800200529     C**  OUTPUT HEADER LINES
390900200529     C*
391000200529     C                     MOVE '0'       *IN65
391100200529     C           ACNO      IFNE *ZEROS
391200200529     C                     MOVE '1'       *IN65
391300200529     C                     END
391400200529     C/COPY WNCPYSRC,RE3765C012
391500200529     C                     WRITEHEADDC
391600200529     C*
391700200529     C* CHARGE REPORT IF NECESSARY
391800200529     C*
391900200529     C           CCICI     IFNE *BLANK                     - B1
392000200529     C           CCHGP     ANDNE*ZERO
392100200529     C/COPY WNCPYSRC,RE3765C013
392200200529     C                     WRITEHEADCH
392300200529     C                     END                             - E1
392400200529     C*
392500200529     C**  ACCESS REHISL WITH LAST CREDIT CAPITALISATION DATE
392600200529     C*
392700200529     C           KLIST3    CHAINREHISL               52
392800200529     C*
392900200529     C           *IN52     IFEQ '1'                        - B1
393000200529     C                     Z-ADDCLCID     WDATE
393100200529     C                     Z-ADD5         DBASE
393200200529     C                     MOVE 'REHISL'  DBFILE           ***************
393300200529     C                     MOVELRKEY2     DBKEY            **DB ERROR 05**
393400200529     C                     MOVEA'1'       *IN,89           ***************
393500200529     C                     EXSR DBSR
393600200529     C                     END                             - E1
393700200529     C*
393800200529     C           *IN52     DOWEQ'0'                        - B1
393900200529     C           DRECI     ANDEQ'S'
394000200529     C***********SDICI     ANDEQ'Y'                                      098818
394100200529     C           SDICI     ANDNE*BLANKS                                  098818
394200200529     C           SCICI     ANDEQ*BLANKS
394300200529     C           DHISD     ANDLTCHISD
394400200529     C           *IN52     OREQ '0'
394500200529     C           DRECI     ANDEQ'D'
394600200529     C           DCRCI     ANDEQ*BLANKS
394700200529     C           DDRCI     ANDEQ'Y'
394800200529     C*
394900200529     C           KLIST1    READEREHISL                   52
395000200529     C*
395100200529     C                     END                             - E1
395200200529     C*
395300200529     C**  PREPARE B/F BALANCE
395400200529     C*
395500200529     C           DRECI     IFEQ 'B'                        - B1
395600200529     C                     Z-SUBDHISB     HISB0
395700200529     C                     Z-ADDDHISB     COHISB
395800200529     C                     ELSE                            - X1
395900200529     C           DRECI     IFEQ 'S'                        - B2
396000200529     C                     Z-ADD*ZEROS    HISB0
396100200529     C                     Z-ADDDHISB     COHISB
396200200529     C                     ELSE                            - X2
396300200529     C                     Z-ADDCLCID     WDATE
396400200529     C                     Z-ADD6         DBASE
396500200529     C                     MOVE 'REHISL'  DBFILE           ***************
396600200529     C                     MOVELRKEY2     DBKEY            **DB ERROR 06**
396700200529     C                     MOVEA'1'       *IN,89           ***************
396800200529     C                     EXSR DBSR
396900200529     C                     END                             - E2
397000200529     C                     END                             - E1
397100200529     C*
397200200529     C                     MOVE *BLANKS   VALDA
397300200529     C*
397400200529     C                     EXSR CLMSG
397500200529     C                     MOVELNAR,1     TNARR
397600200529     C*
397700200529     C**  OUTPUT B/F BALANCE
397800200529     C*
397900200529     C                     EXSR OVERDC
398000200529     C                     WRITETITLEDC
398100200529     C*
398200200529     C           KLIST3    SETLLREHPOPH
398300200529     C*
398400200529     C           KLIST1    READEREHPOPH                  50
398500200529     C*
398600200529     C**  BACK VALUE PROCESSING START
398700200529     C*
398800200529     C           *IN50     DOWEQ'0'                        - B1
398900200529     C           PSTD      ANDGTCLCID
399000200529     C*
399100200529     C           HISD      IFLT CLCID                      - B2
399200200529     C           PSTD      ANDGTCLCID
399300200529     C*
399400200529     C**  TRANSFER DATE MIDAS INTO DDMMMYY
399500200529     C*
399600200529     C           PPSTD     IFNE PSTD                       - B3
399700200529     C                     Z-ADDPSTD      ZDAYNO
399800200529     C                     EXSR ZDATE2
399900200529     C                     MOVE ZDATE     PSTDO
400000200529     C                     Z-ADDPSTD      PPSTD
400100200529     C                     END                             - E3
400200200529     C*
400300200529     C                     MOVE PSTDO     PSTDA
400400200529     C*
400500200529     C**  TRANSFER DATE MIDAS INTO DDMMMYY
400600200529     C*
400700200529     C           PVALD     IFNE HISD                       - B3
400800200529     C                     Z-ADDHISD      ZDAYNO
400900200529     C                     EXSR ZDATE2
401000200529     C                     MOVE ZDATE     VALDO
401100200529     C                     Z-ADDHISD      PVALD
401200200529     C                     END                             - E3
401300200529     C*
401400200529     C                     MOVELPNAR      NARR
401500200529     C                     MOVE VALDO     VALDA
401600200529     C*
401700200529     C**  CHECK IF DEBIT OR CREDIT
401800200529     C*
401900200529     C           DRCR      IFEQ 0                          - B3
402000200529     C                     Z-SUBPSTA      PSTD0
402100200529     C*
402200200529     C** CHECK IF TURNOVER OR NOT
402300200529     C*
402400200529     C           TURN      IFNE 'Y'                        - B4
402500200529     C                     MOVE '1'       *IN33
402600200529     C                     ADD  PSTA      TOTNPS
402700200529     C                     ELSE                            - X4
402800200529     C                     ADD  PSTA      TOTPST
402900200529     C                     END                             - E4
403000200529     C                     ELSE                            - X3
403100200529     C                     Z-ADDPSTA      PSTD0
403200200529     C                     END                             - E3
403300200529     C*
403400200529     C**  OUTPUT BACK VALUE
403500200529     C*
403600200529     C                     EXSR OVERDC
403700200529     C                     WRITEPOSTDC
403800200529     C*
403900200529     C                     MOVE '0'       *IN33
404000200529     C*
404100200529     C* CHARGE REPORT IF NECESSARY
404200200529     C*
404300200529     C           CCICI     IFNE *BLANK                     - B3
404400200529     C           CHGA      ANDNE*ZERO
404500200529     C           REBI      IFEQ 'Y'                        - B4
404600200529     C                     Z-SUBCHGA      CHGR0
404700200529     C                     Z-SUB*ZERO     CHGN0
404800200529     C                     ELSE                            - X4
404900200529     C                     Z-SUBCHGA      CHGN0
405000200529     C                     Z-SUB*ZERO     CHGR0
405100200529     C                     END                             - E4
405200200529     C                     WRITEPOSTCH
405300200529     C/COPY WNCPYSRC,RE3765C020
405400200529     C                     END                             - E3
405500200529     C*
405600200529     C                     END                             - E2
405700200529     C*
405800200529     C           KLIST1    READEREHPOPH                  50
405900200529     C*
406000200529     C                     END                             - E1
406100200529     C*
406200200529     C                     MOVE '0'       *IN50
406300200529     C*
406400200529     C           KLIST3    SETLLREHPOPL                  50
406500200529     C           KLIST1    READEREHPOPL                  50
406600200529     C*
406700200529     C**  BACK VALUE PROCESSING END
406800200529     C*
406900200529     C**  PREPARE OPENING BALANCE OUTPUT
407000200529     C*
407100200529     C           DRECI     IFEQ 'B'                        - B1
407200200529     C                     Z-ADDDHISB     WHISB
407300200529     C                     ELSE                            - X1
407400200529     C           DRECI     IFEQ 'S'                        - B2
407500200529     C                     Z-ADDSSTBL     WHISB
407600200529     C                     END                             - E2
407700200529     C                     END                             - E1
407800200529     C                     Z-SUBCOHISB    HISB0
407900200529     C*
408000200529     C                     EXSR CLMSG
408100200529     C                     MOVELNAR,2     TNARR
408200200529     C*
408300200529     C**  SAVE IN CASE OF NO POSTING
408400200529     C*
408500200529     C                     Z-ADDCLCID     WHISD
408600200529     C*
408700200529     C**  TRANSFER DATE MIDAS INTO DDMMMYY
408800200529     C*
408900200529     C           CLCID     IFNE PVALD                      - B1
409000200529     C*
409100200529     C                     Z-ADDCLCID     ZDAYNO
409200200529     C                     EXSR ZDATE2
409300200529     C                     MOVE ZDATE     VALDO
409400200529     C                     Z-ADDCLCID     PVALD
409500200529     C*
409600200529     C                     END                             - E1
409700200529     C*
409800200529     C                     MOVE VALDO     VALDA
409900200529     C*
410000200529     C**  OUTPUT OPENING BALANCE
410100200529     C*
410200200529     C                     EXSR OVERDC
410300200529     C                     WRITETITLEDC
410400200529     C*
410500200529     C**  PREPARE OPENING RATE OUTPUT
410600200529     C*
410700200529     C                     MOVE *BLANKS   VALDA
410800200529     C                     MOVE *BLANKS   PSTDA
410900200529     C*
411000200529     C                     EXSR CLMSG
411100200529     C                     MOVELNAR,8     RNARR
411200200529     C*
411300200529     C**  OUTPUT OPENING RATE
411400200529     C*
411500200529     C                     Z-ADDCRIR      RATE
411600200529     C                     EXSR OVERDC
411700200529     C                     WRITERATEDC
411800200529     C*
411900200529     C           DRECI     IFEQ 'S'                        - B1
412000200529     C                     Z-ADDDHISD     WHISD
412100200529     C                     Z-ADDDHISB     WHISB
412200200529     C                     Z-ADDSMNBL     WMNBL
412300200529     C                     Z-ADDDDRCB     WDRCB
412400200529     C                     Z-ADDDCRCB     WCRCB
412500200529     C           KLIST1    READEREHISL                   51
412600200529     C*
412700200529     C           *IN51     IFEQ '0'                        - B2
412800200529     C           WHISD     ANDNEDHISD
412900200529     C*
413000200529     C           CCICT     IFLT 3                          - B3
413100200529     C                     Z-ADDWCRCB     ZICALC
413200200529     C                     Z-ADDWHISD     ZIBEG
413300200529     C                     Z-ADDDHISD     ZIEND
413400200529     C                     EXSR DAYTSR
413500200529     C                     ELSE                            - X3
413600200529     C                     EXSR ITYPCR
413700200529     C                     END                             - E3
413800200529     C*
413900200529     C                     END                             - E2
414000200529     C*
414100200529     C                     END                             - E1
414200200529     C*
414300200529     C           *IN51     DOWEQ'0'                        - B1
414400200529     C           DHISD     ANDLTCHISD
414500200529     C*
414600200529     C**  PROCESS POSTING AT THE SAME DATE
414700200529     C*
414800200529     C           *IN50     DOWEQ'0'                        - B2
414900200529     C           DHISD     ANDEQHISD
415000200529     C*
415100200529     C**  TRANSFER DATE MIDAS INTO DDMMMYY
415200200529     C*
415300200529     C           PPSTD     IFNE PSTD                       - B3
415400200529     C                     Z-ADDPSTD      ZDAYNO
415500200529     C                     EXSR ZDATE2
415600200529     C                     MOVE ZDATE     PSTDO
415700200529     C                     END                             - E3
415800200529     C*
415900200529     C**  TRANSFER DATE MIDAS INTO DDMMMYY
416000200529     C*
416100200529     C           PVALD     IFNE HISD                       - B3
416200200529     C                     Z-ADDHISD      ZDAYNO
416300200529     C                     EXSR ZDATE2
416400200529     C                     MOVE ZDATE     VALDO
416500200529     C                     END                             - E3
416600200529     C*
416700200529     C                     MOVE VALDO     VALDA
416800200529     C                     MOVE PSTDO     PSTDA
416900200529     C                     MOVELPNAR      NARR
417000200529     C*
417100200529     C**  CHECK IF DEBIT OR CREDIT
417200200529     C*
417300200529     C           DRCR      IFEQ 0                          - B3
417400200529     C                     Z-SUBPSTA      PSTD0
417500200529     C*
417600200529     C** CHECK IF TURNOVER OR NOT
417700200529     C*
417800200529     C           TURN      IFNE 'Y'                        - B4
417900200529     C                     MOVE '1'       *IN33
418000200529     C                     ADD  PSTA      TOTNPS
418100200529     C                     ELSE                            - X4
418200200529     C                     ADD  PSTA      TOTPST
418300200529     C                     END                             - E4
418400200529     C                     ELSE                            - X3
418500200529     C                     Z-ADDPSTA      PSTD0
418600200529     C                     END                             - E3
418700200529     C*
418800200529     C**  OUTPUT POSTING
418900200529     C*
419000200529     C                     EXSR OVERDC
419100200529     C                     WRITEPOSTDC
419200200529     C*
419300200529     C                     MOVE '0'       *IN33
419400200529     C*
419500200529     C* CHARGE REPORT IF NECESSARY
419600200529     C*
419700200529     C           CCICI     IFNE *BLANK                     - B3
419800200529     C           CHGA      ANDNE*ZERO
419900200529     C           REBI      IFEQ 'Y'                        - B4
420000200529     C                     Z-SUBCHGA      CHGR0
420100200529     C                     Z-ADD*ZERO     CHGN0
420200200529     C                     ELSE                            - X4
420300200529     C                     Z-SUBCHGA      CHGN0
420400200529     C                     Z-ADD*ZERO     CHGR0
420500200529     C                     END                             - E4
420600200529     C                     WRITEPOSTCH
420700200529     C/COPY WNCPYSRC,RE3765C021
420800200529     C                     END                             - E3
420900200529     C*
421000200529     C                     Z-ADDPSTD      PPSTD
421100200529     C                     Z-ADDHISD      PVALD
421200200529     C*
421300200529     C           KLIST1    READEREHPOPL                  50
421400200529     C*
421500200529     C                     END                             - E2
421600200529     C*
421700200529     C**  CREDIT RATE CHANGE TO
421800200529     C*
421900200529     C           DCRCI     IFEQ 'Y'                        - B2
422000200529     C           DRECI     ANDNE'B'
422100200529     C*
422200200529     C                     EXSR RATEC
422300200529     C*
422400200529     C                     END                             - E2
422500200529     C*
422600200529     C**  SAVE REHISL  AS PREVIOUS
422700200529     C*
422800200529     C                     Z-ADDDHISD     WHISD
422900200529     C                     Z-ADDDHISB     WHISB
423000200529     C                     MOVE DDRCB     WDRCB
423100200529     C                     Z-ADDDCRCB     WCRCB
423200200529     C                     Z-ADDDCAID     WCAID
423300200529     C                     Z-ADDDDAID     WDAID
423400200529     C*
423500200529     C           KLIST1    READEREHISL                   51
423600200529     C*
423700200529     C           *IN51     DOWEQ'0'                        - B2
423800200529     C           DRECI     ANDEQ'S'
423900200529     C***********SDICI     ANDEQ'Y'                                      098818
424000200529     C           SDICI     ANDNE*BLANKS                                  098818
424100200529     C           SCICI     ANDEQ*BLANKS
424200200529     C           DHISD     ANDLTCHISD
424300200529     C           *IN51     OREQ '0'
424400200529     C           DRECI     ANDEQ'D'
424500200529     C           DCRCI     ANDEQ*BLANKS
424600200529     C           DDRCI     ANDEQ'Y'
424700200529     C           DDMVT     ANDEQ*ZEROS
424800200529     C           DCMVT     ANDEQ*ZEROS
424900200529     C*
425000200529     C           KLIST1    READEREHISL                   51
425100200529     C*
425200200529     C                     END                             - E2
425300200529     C*
425400200529     C**  OUTPUT SUBTOTAL LINE
425500200529     C*
425600200529     C           *IN51     IFEQ '0'                        - B2
425700200529     C           DHISD     ANDLTCHISD
425800200529     C*
425900200529     C           CCICT     IFLT 3                          - B3
426000200529     C                     Z-ADDWCRCB     ZICALC
426100200529     C                     Z-ADDWHISD     ZIBEG
426200200529     C                     Z-ADDDHISD     ZIEND
426300200529     C                     EXSR DAYTSR
426400200529     C                     ELSE                            - X3
426500200529     C                     EXSR ITYPCR
426600200529     C                     END                             - E3
426700200529     C*
426800200529     C           *IN51     DOWEQ'0'                        - B3
426900200529     C           DHISD     ANDLTHISD
427000200529     C           CHISD     ANDLTHISD
427100200529     C*
427200200529     C**  CHECK IF READ RECORD IS A CHANGE RATE
427300200529     C*
427400200529     C           DCRCI     IFEQ 'Y'                        - B4
427500200529     C           DRECI     ANDNE'B'
427600200529     C*
427700200529     C                     EXSR RATEC
427800200529     C*
427900200529     C*
428000200529     C**  SAVE REHISL  AS PREVIOUS
428100200529     C*
428200200529     C                     Z-ADDDHISD     WHISD
428300200529     C                     Z-ADDDHISB     WHISB
428400200529     C                     MOVE DDRCB     WDRCB
428500200529     C                     Z-ADDDCRCB     WCRCB
428600200529     C                     Z-ADDDCAID     WCAID
428700200529     C                     Z-ADDDDAID     WDAID
428800200529     C*
428900200529     C           KLIST1    READEREHISL                   51
429000200529     C*
429100200529     C           *IN51     DOWEQ'0'                        - B5
429200200529     C           DRECI     ANDEQ'S'
429300200529     C***********SDICI     ANDEQ'Y'                                      098818
429400200529     C           SDICI     ANDNE*BLANKS                                  098818
429500200529     C           SCICI     ANDEQ*BLANKS
429600200529     C           DHISD     ANDLTCHISD
429700200529     C           *IN51     OREQ '0'
429800200529     C           DRECI     ANDEQ'D'
429900200529     C           DCRCI     ANDEQ*BLANKS
430000200529     C           DDRCI     ANDEQ'Y'
430100200529     C*
430200200529     C           KLIST1    READEREHISL                   51
430300200529     C*
430400200529     C                     END                             - E5
430500200529     C*
430600200529     C           CCICT     IFLT 3                          - B5
430700200529     C                     Z-ADDWCRCB     ZICALC
430800200529     C                     Z-ADDWHISD     ZIBEG
430900200529     C                     Z-ADDDHISD     ZIEND
431000200529     C                     EXSR DAYTSR
431100200529     C                     ELSE                            - X5
431200200529     C                     EXSR ITYPCR
431300200529     C                     END                             - E5
431400200529     C*
431500200529     C                     ELSE                            - X4
431600200529     C*
431700200529     C           KLIST1    READEREHISL                   51
431800200529     C*
431900200529     C           *IN51     DOWEQ'0'                        - B5
432000200529     C           DRECI     ANDEQ'S'
432100200529     C***********SCICI     ANDEQ'Y'                                      098818
432200200529     C           SCICI     ANDNE*BLANKS                                  098818
432300200529     C           SDICI     ANDEQ*BLANKS
432400200529     C           DHISD     ANDLTCHISD
432500200529     C           *IN51     OREQ '0'
432600200529     C           DRECI     ANDEQ'D'
432700200529     C           DDRCI     ANDEQ*BLANKS
432800200529     C           DCRCI     ANDEQ'Y'
432900200529     C*
433000200529     C           KLIST1    READEREHISL                   51
433100200529     C*
433200200529     C                     END                             - E5
433300200529     C*
433400200529     C                     END                             - E4
433500200529     C*
433600200529     C                     END                             - E3
433700200529     C*
433800200529     C                     END                             - E2
433900200529     C*
434000200529     C                     END                             - E1
434100200529     C*
434200200529     C           KLIST3    SETLLREHISL                   52
434300200529     C*
434400200529     C           *IN52     IFEQ '0'                        - B1
434500200529     C                     Z-ADDCLCID     WDATE
434600200529     C                     Z-ADD7         DBASE
434700200529     C                     MOVE 'REHISL'  DBFILE           ***************
434800200529     C                     MOVELRKEY2     DBKEY            **DB ERROR 07**
434900200529     C                     MOVEA'1'       *IN,89           ***************
435000200529     C                     EXSR DBSR
435100200529     C                     END                             - E1
435200200529     C*
435300200529     C           KLIST1    READEREHISL                   52
435400200529     C*
435500200529     C           *IN52     DOWEQ'0'                        - B1
435600200529     C           DRECI     ANDEQ'S'
435700200529     C***********SDICI     ANDEQ'Y'                                      098818
435800200529     C           SDICI     ANDNE*BLANKS                                  098818
435900200529     C           SCICI     ANDEQ*BLANKS
436000200529     C           DHISD     ANDLTCHISD
436100200529     C           *IN52     OREQ '0'
436200200529     C           DRECI     ANDEQ'D'
436300200529     C           DCRCI     ANDEQ*BLANKS
436400200529     C           DDRCI     ANDEQ'Y'
436500200529     C*
436600200529     C           KLIST1    READEREHISL                   52
436700200529     C*
436800200529     C                     END                             - E1
436900200529     C*
437000200529     C           DCICT     IFLT 3                          - B1
437100200529     C*
437200200529     C                     Z-ADDWCRCB     ZICALC
437300200529     C                     Z-ADDWHISD     ZIBEG
437400200529     C                     Z-ADDCHISD     ZIEND
437500200529     C*
437600200529     C                     EXSR ZICD
437700200529     C                     Z-ADDZDAYN1    DAYS
437800200529     C*
437900200529     C                     Z-SUBWHISB     HISB0
438000200529     C           HISB0     MULT DAYS      NUMB0
438100200529     C*
438200200529     C           WHISB     IFGT *ZEROS                     - B2
438300200529     C           CDAIC     SUB  WDAID     INT0
438400200529     C                     Z-SUBINT0      INT0
438500200529     C                     ELSE                            - X2
438600200529     C           CCAIC     SUB  WCAID     INT0
438700200529     C                     END                             - E2
438800200529     C*
438900200529     C**  OUTPUT SUBTOTAL
439000200529     C*
439100200529     C           NUMB0     IFLT *ZEROS
439200200529     C                     ADD  NUMB0     WWTND
439300200529     C                     ELSE
439400200529     C                     ADD  NUMB0     WWTNC
439500200529     C                     END
439600200529     C                     EXSR OVERDC
439700200529     C                     WRITESTOTDC
439800200529     C*
439900200529     C* CHARGE REPORT IF NECESSARY
440000200529     C*
440100200529     C           CCICI     IFNE *BLANK                     - B2
440200200529     C           DTHGAR    IFNE *ZERO                      - B3
440300200529     C           DTHGAN    ORNE *ZERO
440400200529     C                     Z-SUBDTHGAR    CHGR0
440500200529     C                     Z-SUBDTHGAN    CHGN0
440600200529     C                     WRITEPOSTCH
440700200529     C                     END                             - E3
440800200529     C                     END                             - E2
440900200529     C*
441000200529     C                     END                             - E1
441100200529     C*
441200200529     C** PRINT TOTAL NUMBER
441300200529     C*
441400200529     C                     MOVELNAR,25    NARRD
441500200529     C                     Z-ADDWWTND     TNUMD
441600200529     C*
441700200529     C                     MOVELNAR,26    NARRC
441800200529     C                     Z-ADDWWTNC     TNUMC
441900200529     C                     EXSR OVERDC
442000200529     C                     WRITETOTND
442100200529     C*
442200200529     C** PREPARE C/F BALANCE
442300200529     C*
442400200529     C                     EXSR CLMSG
442500200529     C                     MOVELNAR,6     TNARR
442600200529     C*
442700200529     C**  TRANSFER DATE MIDAS INTO DDMMMYY
442800200529     C*
442900200529     C           PVALD     IFNE CHISD                      - B1
443000200529     C                     Z-ADDCHISD     ZDAYNO
443100200529     C                     EXSR ZDATE2
443200200529     C                     MOVE ZDATE     VALDO
443300200529     C                     MOVE CHISD     PVALD
443400200529     C                     END                             - E1
443500200529     C*
443600200529     C                     MOVE VALDO     VALDA
443700200529     C                     Z-SUBCHISB     HISB0
443800200529     C*
443900200529     C**  OUTPUT BALANCE C/F
444000200529     C*
444100200529     C                     EXSR OVERDC
444200200529     C                     WRITETITLEDC
444300200529     C*
444400200529     C**  PREPARE TOTAL INTEREST OUTPUT
444500200529     C*
444600200529     C                     Z-ADDWCRCB     ZICALC
444700200529     C                     Z-ADDCLCID     ZIBEG
444800200529     C                     Z-ADDCHISD     ZIEND
444900200529     C                     EXSR ZICD
445000200529     C*
445100200529     C                     Z-ADDZDAYN1    DAYS
445200200529     C*
445300200529     C                     EXSR CLMSG
445400200529     C                     MOVELNAR,5     XNARR
445500200529     C*
445600200529     C                     Z-SUBCCAIC     TINT0
445700200529     C*
445800200529     C**  Calculate base rate tax
445900200529     C***   Calling subroutine is CRSR
446000200529     C*
446100200529     C**********           MOVE 'C'       CALLSR                          130468
446200200529     C                     EXSR CALBRT
446300200529     C/COPY WNCPYSRC,RE3765C029
446400200529     C*
446500200529     C           CGL031    IFEQ 'Y'                                                           CGL031
446600200529     C                     EXSR CALEUT                                                        CGL031
446700200529     C                     ENDIF                                                              CGL031
446800200529      *                                                                                       CGL031
446900200529     C**  OUTPUT TOTAL INTEREST
447000200529     C*
447100200529     C                     EXSR OVERDC
447200200529     C                     WRITETOTALDC
447300200529      *                                                                   130468
447400200529      * Output total CR generated adjustments                             130468
447500200529     C           CSGACI    IFNE *ZEROS                                    130468
447600200529     C                     EXSR CLMSG                                     130468
447700200529     C                     Z-SUBCSGACI    TINT0                           130468
447800200529     C                     MOVELNAR,23    DNARR                           130468
447900200529     C                     EXSR OVERDC                                    130468
448000200529     C                     WRITETOTDDC                                    130468
448100200529     C                     END                                            130468
448200200529      *                                                                   130468
448300200529      * Report BRT if required                                            130468
448400200529     C           *IN22     IFEQ '1'                                       130468
448500200529     C                     EXSR OVERDC                                    130468
448600200529     C                     WRITETOTBRT                                    130468
448700200529     C                     END                                            130468
448800200529      *                                                                                       CGL031
448900200529     C           CGL031    IFEQ 'Y'                                                           CGL031
449000200529     C                     EXSR OVERDC                                                        CGL031
449100200529     C                     WRITEEUWTAX                                                        CGL031
449200200529      *                                                                                       CER048
449300200529      ** Print Secondary Tax Amount                                                           CER048
449400200529      *                                                                                       CER048
449500200529     C           CER048    IFEQ 'Y'                                                           CER048
449600200529      *                                                                                       CER048
449700200529     C                     EXSR OVERDC                                                        CER048
449800200529     C                     WRITESECTAX                                                        CER048
449900200529      *                                                                                       CER048
450000200529     C                     ENDIF                                                              CER048
450100200529      *                                                                                       CER048
450200200529     C                     END                                                                CGL031
450300200529     C*
450400200529     C* CHARGE REPORT IF NECESSARY
450500200529     C*
450600200529     C           CCICI     IFNE *BLANK                     - B1
450700200529     C           CCHGP     ANDNE*ZERO
450800200529     C                     Z-SUBCCHGP     CHGP0
450900200529     C                     WRITETOTALCH
451000200529     C                     END                             - E1
451100200529     C*
451200200529     C**  PREPARE TOTAL CHARGES
451300200529     C*
451400200529     C           CCHGP     IFNE *ZERO                      - B1
451500200529     C                     EXSR CLMSG
451600200529     C                     MOVELNAR,22    DNARR
451700200529     C*
451800200529     C                     Z-SUBCCHGP     TINT0
451900200529     C                     EXSR OVERDC
452000200529     C                     WRITETOTDDC
452100200529     C                     END                             - E1
452200200529     C*
452300200529     C**  PREPARE TOTAL
452400200529     C*
452500200529     C                     Z-ADD*ZERO     TINT0
452600200529     C           CSCCI     IFEQ 'Y'                        - B1
452700200529     C           CSCCI     OREQ 'I'
452800200529     C           CSCCI     OREQ 'A'
452900200529     C*
453000200529     C                     Z-SUBCCAIC     TINT0
453100200529     C/COPY WNCPYSRC,RE3765C030
453200200529     C                     END                             - E1
453300200529      *                                                                   130468
453400200529      * Add BRT if applicable                                             130468
453500200529     C           *IN22     IFEQ '1'                                       130468
453600200529     C                     ADD  BRTOT0    TINT0                           130468
453700200529     C                     END                                            130468
453800200529      *                                                                   130468
453900200529     C           CGL031    IFEQ 'Y'                                                           CGL031
454000200529     C                     ADD  EUTAX0    TINT0                                               CGL031
454100200529      *                                                                                       CER048
454200200529      ** Add Secondary Tax, if applicable                                                     CER048
454300200529      *                                                                                       CER048
454400200529     C           CER048    IFEQ 'Y'                                                           CER048
454500200529     C                     ADD  STAX0     TINT0                                               CER048
454600200529     C                     ENDIF                                                              CER048
454700200529      *                                                                                       CER048
454800200529     C                     ENDIF                                                              CGL031
454900200529      *                                                                                       CGL031
455000200529     C           CSCHGI    IFEQ 'Y'                        - B1
455100200529     C           CSCHGI    OREQ 'I'
455200200529     C           CSCHGI    OREQ 'A'
455300200529     C*
455400200529     C                     ADD  CCHGP     TINT0
455500200529     C                     END                             - E1
455600200529     C                     SUB  CSGACI    TINT0                           130468
455700200529      *                                                                   130468
455800200529     C                     EXSR CLMSG
455900200529     C                     MOVELNAR,21    DNARR
456000200529     C                     Z-SUBTINT0     TINT0
456100200529     C*
456200200529     C                     EXSR OVERDC
456300200529     C                     WRITETOTDDC
456400200529     C*
456500200529     C**  PREPARE TOTAL CREDITED OUTPUT
456600200529     C*
456700200529     C                     EXSR CLMSG
456800200529     C                     MOVELNAR,10    DNARR
456900200529     C*
457000200529     C**  OUTPUT TOTAL CREDITED
457100200529     C*
457200200529     C                     EXSR OVERDC
457300200529     C                     WRITETOTDDC
457400200529     C*
457500200529     C           *IN70     IFEQ '1'                        - B1
457600200529     C                     EXSR OVERDC
457700200529     C                     WRITETOTMAN
457800200529     C                     END                             - E1
457900200529     C*
458000200529     C/COPY WNCPYSRC,RE3765C008
458100200529      *                                                                                       CER050
458200200529     C           CER050    IFEQ 'Y'                                                           CER050
458300200529      *                                                                                       CER050
458400200529      * Only print APR if not management statement                                            CER050
458500200529      *                                                                                       CER050
458600200529     C           *IN70     IFEQ '0'                        B001                               CER050
458700200529      *                                                                                       CER050
458800200529     C                     MOVEA'00'      *IN,61                                              CER050
458900200529     C                     MOVE *BLANKS   TANAR  30                                           CER050
459000200529      *                                                                                       CER050
459100200529     C           KACCNT    CHAINACCNTBY0             99                                       CER050
459200200529     C           *IN99     IFEQ '0'                                                           CER050
459300200529      *                                                                                       CER050
459400200529      * Run this process only if APR is set to 'Y'                                            CER050
459500200529      *                                                                                       CER050
459600200529     C           ATAPRC    IFEQ 'Y'                                                           CER050
459700200529     C                     EXSR SRAPRC                                                        CER050
459800200529     C                     ENDIF                                                              CER050
459900200529     C                     ENDIF                                                              CER050
460000200529      *                                                                                       CER050
460100200529     C                     ENDIF                                                              CER050
460200200529      *                                                                                       CER050
460300200529     C                     ENDIF                                                              CER050
460400200529      *                                                                                       CER050
460500200529     C                     ENDSR                           **CRSR ENDSR**
460600200529     C********************************************************************
460700200529     C/EJECT
460800200529     C********************************************************************
460900200529     C**
461000200529     C** DAYTSR subroutine to prepare and output days total
461100200529     C**
461200200529     C**     Called by       CRSR, DRSR
461300200529     C**
461400200529     C**     Calls           ZICD
461500200529     C**
461600200529     C           DAYTSR    BEGSR                           **DAYTSR BEGSR*
461700200529     C*
461800200529     C                     EXSR ZICD
461900200529     C                     Z-ADDZDAYN1    DAYS
462000200529     C*
462100200529     C                     Z-SUBWHISB     HISB0
462200200529     C*
462300200529     C           *IN80     IFEQ '1'                        - B1
462400200529     C           HISB0     MULT DAYS      NUMB0
462500200529     C                     ELSE                            - X1
462600200529     C           *IN81     IFEQ '1'                        - B2
462700200529     C           HISB1     MULT DAYS      NUMB0
462800200529     C                     ELSE                            - X2
462900200529     C           *IN82     IFEQ '1'                        - B3
463000200529     C           HISB2     MULT DAYS      NUMB0
463100200529     C                     ELSE                            - X3
463200200529     C           HISB3     MULT DAYS      NUMB0
463300200529     C                     END                             - E3
463400200529     C                     END                             - E2
463500200529     C                     END                             - E1
463600200529     C*
463700200529     C           WHISB     IFGT *ZEROS                     - B1
463800200529     C           DDAID     SUB  WDAID     INT0
463900200529     C                     Z-SUBINT0      INT0
464000200529     C                     ELSE                            - X1
464100200529     C           DCAID     SUB  WCAID     INT0
464200200529     C                     END                             - E1
464300200529      *                                                                   CRE001
464400200529      ** If CRE001 is switched ON, then output 'Overdraft Limit'          CRE001
464500200529      *                                                                   CRE001
464600200529     C           CRE001    IFEQ 'Y'                                       CRE001
464700200529     C                     EXSR CLMSG                                     CRE001
464800200529     C                     MOVELNAR,36    ONARR                           CRE001
464900200529     C                     MOVE ODRL      OODRL                           CRE001
465000200529     C                     EXSR OVERDC                                    CRE001
465100200529     C                     WRITEODLNDC                                    CRE001
465200200529     C                     ENDIF                                          CRE001
465300200529     C*
465400200529     C**  OUTPUT SUBTOTAL
465500200529     C*
465600200529     C           NUMB0     IFLT *ZEROS
465700200529     C                     ADD  NUMB0     WWTND
465800200529     C                     ELSE
465900200529     C                     ADD  NUMB0     WWTNC
466000200529     C                     END
466100200529     C                     EXSR OVERDC
466200200529     C                     WRITESTOTDC
466300200529     C*
466400200529     C* CHARGE REPORT IF NECESSARY
466500200529     C*
466600200529     C           CCICI     IFNE *BLANK                     - B1
466700200529     C           DTHGAR    IFNE *ZERO                      - B2
466800200529     C           DTHGAN    ORNE *ZERO
466900200529     C                     Z-SUBDTHGAR    CHGR0
467000200529     C                     Z-SUBDTHGAN    CHGN0
467100200529     C                     WRITEPOSTCH
467200200529     C                     END                             - E2
467300200529     C                     END                             - E1
467400200529     C*
467500200529     C                     ENDSR                           **DAYTSR ENDSR*
467600200529     C********************************************************************
467700200529     C/EJECT
467800200529     C********************************************************************
467900200529     C**
468000200529     C** DBSR subroutine for database error handling
468100200529     C**
468200200529     C**     Called by       DETPR, DRSR, RATED, RATEC, CRSR, RDRSR,
468300200529     C**                     RCRSR, BOTHSR, B1LT, B1GT, B1EQ, POSTSR,
468400200529     C**                     OPENDR, OPENCR, ZICD, FIRST
468500200529     C**
468600200529     C**     Calls           -
468700200529     C**
468800200529     C           DBSR      BEGSR                           **DBSR BEGSR**
468900200529     C*
469000200529     C                     MOVE '1'       *INU7
469100200529     C                     MOVE '1'       *INU8
469200200529     C                     MOVE '1'       *INLR
469300200529     C                     WRITEERRAU
469400200529     C                     DUMP                                                               253776
469500200529     C                     RETRN                                                              253776
469600200529     C*
469700200529     C                     MOVE *BLANKS   DBFILE
469800200529     C                     MOVE *BLANKS   DBKEY
469900200529     C                     Z-ADD*ZEROS    DBASE
470000200529     C*
470100200529     C           *IN72     IFEQ '1'                        - B1
470200200529     C                     ADD  1         PAGU
470300200529     C                     WRITEHEADAU
470400200529     C                     MOVE '0'       *IN72
470500200529     C                     END                             - E1
470600200529     C*
470700200529     C                     ENDSR                           **DBSR ENDSR**
470800200529     C/COPY WNCPYSRC,RE3765C022
470900200529     C********************************************************************
471000200529     C/EJECT
471100200529     C********************************************************************
471200200529     C**
471300200529     C** DRSR subroutine for debit output processing
471400200529     C**
471500200529     C**     Called by       D E T P R
471600200529     C**
471700200529     C**     Calls           DBSR, DAYTSR, ITYPDR, RATED, ZICD, OVERDC
471800200529     C**
471900200529     C           DRSR      BEGSR                           **DRSR BEGSR**
472000200529     C*
472100200529     C**  OUTPUT HEADER LINES
472200200529     C*
472300200529     C                     MOVE '0'       *IN65
472400200529     C           ACNO      IFNE *ZEROS
472500200529     C                     MOVE '1'       *IN65
472600200529     C                     END
472700200529     C/COPY WNCPYSRC,RE3765C014
472800200529     C                     WRITEHEADDC
472900200529     C*
473000200529     C**  ACCESS REHISL WITH LAST DEBIT CAPITALISATION DATE
473100200529     C*
473200200529     C           KLIST2    CHAINREHISL               52
473300200529     C*
473400200529     C           *IN52     IFEQ '1'                        - B1
473500200529     C                     Z-ADDCLDID     WDATE
473600200529     C                     Z-ADD8         DBASE
473700200529     C                     MOVE 'REHISL'  DBFILE           ***************
473800200529     C                     MOVELRKEY2     DBKEY            **DB ERROR 08**
473900200529     C                     MOVEA'1'       *IN,89           ***************
474000200529     C                     EXSR DBSR
474100200529     C                     END                             - E1
474200200529     C*
474300200529     C           *IN52     DOWEQ'0'                        - B1
474400200529     C           DRECI     ANDEQ'S'
474500200529     C***********SCICI     ANDEQ'Y'                                      098818
474600200529     C           SCICI     ANDNE*BLANKS                                  098818
474700200529     C           SDICI     ANDEQ*BLANKS
474800200529     C           DHISD     ANDLTCHISD
474900200529     C           *IN52     OREQ '0'
475000200529     C           DRECI     ANDEQ'D'
475100200529     C           DDRCI     ANDEQ*BLANKS
475200200529     C           DCRCI     ANDEQ'Y'
475300200529     C*
475400200529     C           KLIST1    READEREHISL                   52
475500200529     C*
475600200529     C                     END                             - E1
475700200529     C*
475800200529     C**  PREPARE B/F BALANCE
475900200529     C*
476000200529     C           DRECI     IFEQ 'B'                        - B1
476100200529     C                     Z-SUBDHISB     HISB0
476200200529     C                     ELSE                            - X1
476300200529     C           DRECI     IFEQ 'S'                        - B2
476400200529     C                     Z-SUBSSTBL     HISB0
476500200529     C                     ELSE                            - X2
476600200529     C                     Z-ADDCLDID     WDATE
476700200529     C                     Z-ADD9         DBASE
476800200529     C                     MOVE 'REHISL'  DBFILE           ***************
476900200529     C                     MOVELRKEY2     DBKEY            **DB ERROR 09**
477000200529     C                     MOVEA'1'       *IN,89           ***************
477100200529     C                     EXSR DBSR
477200200529     C                     END                             - E2
477300200529     C                     END                             - E1
477400200529     C                     Z-ADDDHISB     DOHISB
477500200529     C*
477600200529     C                     MOVE *BLANKS   VALDA
477700200529     C*
477800200529     C                     EXSR CLMSG
477900200529     C                     MOVELNAR,1     TNARR
478000200529     C*
478100200529     C**  OUTPUT B/F BALANCE
478200200529     C*
478300200529     C                     EXSR OVERDC
478400200529     C                     WRITETITLEDC
478500200529     C*
478600200529     C           KLIST2    SETLLREHPOPH
478700200529     C*
478800200529     C           KLIST1    READEREHPOPH                  50
478900200529     C*
479000200529     C**  BACK VALUE PROCESSING START
479100200529     C*
479200200529     C           *IN50     DOWEQ'0'                        - B1
479300200529     C           PSTD      ANDGTCLDID
479400200529     C*
479500200529     C           HISD      IFLT CLDID                      - B2
479600200529     C           PSTD      ANDGTCLDID
479700200529     C*
479800200529     C**  TRANSFER DATE MIDAS INTO DDMMMYY
479900200529     C*
480000200529     C           PPSTD     IFNE PSTD                       - B3
480100200529     C                     Z-ADDPSTD      ZDAYNO
480200200529     C                     EXSR ZDATE2
480300200529     C                     MOVE ZDATE     PSTDO
480400200529     C                     Z-ADDPSTD      PPSTD
480500200529     C                     END                             - E3
480600200529     C*
480700200529     C                     MOVE PSTDO     PSTDA
480800200529     C*
480900200529     C**  TRANSFER DATE MIDAS INTO DDMMMYY
481000200529     C*
481100200529     C           PVALD     IFNE HISD                       - B3
481200200529     C                     Z-ADDHISD      ZDAYNO
481300200529     C                     EXSR ZDATE2
481400200529     C                     MOVE ZDATE     VALDO
481500200529     C                     Z-ADDHISD      PVALD
481600200529     C                     END                             - E3
481700200529     C*
481800200529     C                     MOVELPNAR      NARR
481900200529     C                     MOVE VALDO     VALDA
482000200529     C*
482100200529     C**  CHECK IF DEBIT OR CREDIT
482200200529     C*
482300200529     C           DRCR      IFEQ 0                          - B3
482400200529     C                     Z-SUBPSTA      PSTD0
482500200529     C*
482600200529     C** CHECK IF TURNOVER OR NOT
482700200529     C*
482800200529     C           TURN      IFNE 'Y'                        - B4
482900200529     C                     MOVE '1'       *IN33
483000200529     C                     ADD  PSTA      TOTNPS
483100200529     C                     ELSE                            - X4
483200200529     C                     ADD  PSTA      TOTPST
483300200529     C                     END                             - E4
483400200529     C                     ELSE                            - X3
483500200529     C                     Z-ADDPSTA      PSTD0
483600200529     C                     END                             - E3
483700200529     C*
483800200529     C**  OUTPUT BACK VALUE
483900200529     C*
484000200529     C                     EXSR OVERDC
484100200529     C                     WRITEPOSTDC
484200200529     C*
484300200529     C                     MOVE '0'       *IN33
484400200529     C*
484500200529     C                     END                             - E2
484600200529     C*
484700200529     C           KLIST1    READEREHPOPH                  50
484800200529     C*
484900200529     C                     END                             - E1
485000200529     C*
485100200529     C                     MOVE '0'       *IN50
485200200529     C*
485300200529     C           KLIST2    SETLLREHPOPL                  50
485400200529     C           KLIST1    READEREHPOPL                  50
485500200529     C*
485600200529     C**  BACK VALUE PROCESSING END
485700200529     C*
485800200529     C**  PREPARE OPENING BALANCE OUTPUT
485900200529     C*
486000200529     C           DRECI     IFEQ 'B'                        - B1
486100200529     C                     Z-ADDDHISB     WHISB
486200200529     C                     ELSE                            - X1
486300200529     C           DRECI     IFEQ 'S'                        - B2
486400200529     C                     Z-ADDSSTBL     WHISB
486500200529     C                     END                             - E2
486600200529     C                     END                             - E1
486700200529     C                     Z-SUBDOHISB    HISB0
486800200529     C*
486900200529     C                     EXSR CLMSG
487000200529     C                     MOVELNAR,2     TNARR
487100200529     C*
487200200529     C**  SAVE IN CASE OF NO POSTING
487300200529     C*
487400200529     C                     Z-ADDCLDID     WHISD
487500200529     C*
487600200529     C**  TRANSFER DATE MIDAS INTO DDMMMYY
487700200529     C*
487800200529     C           CLDID     IFNE PVALD                      - B1
487900200529     C*
488000200529     C                     Z-ADDCLDID     ZDAYNO
488100200529     C                     EXSR ZDATE2
488200200529     C                     MOVE ZDATE     VALDO
488300200529     C                     Z-ADDCLDID     PVALD
488400200529     C                     END                             - E1
488500200529     C*
488600200529     C                     MOVE VALDO     VALDA
488700200529     C*
488800200529     C**  OUTPUT OPENING BALANCE
488900200529     C*
489000200529     C                     EXSR OVERDC
489100200529     C                     WRITETITLEDC
489200200529     C*
489300200529     C**  PREPARE OPENING RATE OUTPUT
489400200529     C*
489500200529     C                     MOVE *BLANKS   VALDA
489600200529     C                     MOVE *BLANKS   PSTDA
489700200529     C*
489800200529     C                     EXSR CLMSG
489900200529     C                     MOVELNAR,3     RNARR
490000200529     C*
490100200529     C**  OUTPUT OPENING RATE
490200200529     C*
490300200529     C                     Z-ADDDRIR      RATE
490400200529     C                     EXSR OVERDC
490500200529     C                     WRITERATEDC
490600200529     C*
490700200529     C           DRECI     IFEQ 'S'                        - B1
490800200529     C                     Z-ADDDHISD     WHISD
490900200529     C                     Z-ADDDHISB     WHISB
491000200529     C                     Z-ADDSMNBL     WMNBL
491100200529     C                     Z-ADDDDRCB     WDRCB
491200200529     C                     Z-ADDDCRCB     WCRCB
491300200529     C           KLIST1    READEREHISL                   51
491400200529     C*
491500200529     C           *IN51     IFEQ '0'                        - B2
491600200529     C           WHISD     ANDNEHISD
491700200529     C*
491800200529     C           CDICT     IFLT 3                          - B3
491900200529     C                     Z-ADDWDRCB     ZICALC
492000200529     C                     Z-ADDWHISD     ZIBEG
492100200529     C                     Z-ADDDHISD     ZIEND
492200200529     C                     EXSR DAYTSR
492300200529     C                     ELSE                            - X3
492400200529     C                     EXSR ITYPDR
492500200529     C                     END                             - E3
492600200529     C*
492700200529     C                     END                             - E2
492800200529     C*
492900200529     C                     END                             - E1
493000200529     C*
493100200529     C           *IN51     DOWEQ'0'                        - B1
493200200529     C           DHISD     ANDLTCHISD
493300200529     C*
493400200529     C**  PROCESS POSTING AT THE SAME DATE
493500200529     C*
493600200529     C           *IN50     DOWEQ'0'                        - B2
493700200529     C           DHISD     ANDEQHISD
493800200529     C*
493900200529     C**  TRANSFER DATE MIDAS INTO DDMMMYY
494000200529     C*
494100200529     C           PPSTD     IFNE PSTD                       - B3
494200200529     C                     Z-ADDPSTD      ZDAYNO
494300200529     C                     EXSR ZDATE2
494400200529     C                     MOVE ZDATE     PSTDO
494500200529     C                     Z-ADDPSTD      PPSTD
494600200529     C                     END                             - E3
494700200529     C*
494800200529     C**  TRANSFER DATE MIDAS INTO DDMMMYY
494900200529     C*
495000200529     C           PVALD     IFNE HISD                       - B3
495100200529     C                     Z-ADDHISD      ZDAYNO
495200200529     C                     EXSR ZDATE2
495300200529     C                     MOVE ZDATE     VALDO
495400200529     C                     Z-ADDHISD      PVALD
495500200529     C                     END                             - E3
495600200529     C*
495700200529     C                     MOVE VALDO     VALDA
495800200529     C                     MOVE PSTDO     PSTDA
495900200529     C                     MOVELPNAR      NARR
496000200529     C*
496100200529     C**  CHECK IF DEBIT OR CREDIT
496200200529     C*
496300200529     C           DRCR      IFEQ 0                          - B3
496400200529     C                     Z-SUBPSTA      PSTD0
496500200529     C*
496600200529     C** CHECK IF TURNOVER OR NOT
496700200529     C*
496800200529     C           TURN      IFNE 'Y'                        - B4
496900200529     C                     MOVE '1'       *IN33
497000200529     C                     ADD  PSTA      TOTNPS
497100200529     C                     ELSE                            - X4
497200200529     C                     ADD  PSTA      TOTPST
497300200529     C                     END                             - E4
497400200529     C                     ELSE                            - X3
497500200529     C                     Z-ADDPSTA      PSTD0
497600200529     C                     END                             - E3
497700200529     C*
497800200529     C**  OUPUT POSTING
497900200529     C*
498000200529     C                     EXSR OVERDC
498100200529     C                     WRITEPOSTDC
498200200529     C*
498300200529     C                     MOVE '0'       *IN33
498400200529     C*
498500200529     C           KLIST1    READEREHPOPL                  50
498600200529     C*
498700200529     C                     END                             - E2
498800200529     C*
498900200529     C**  DEBIT RATE CHANGE TO
499000200529     C*
499100200529     C           DDRCI     IFEQ 'Y'                        - B2
499200200529     C           DRECI     ANDNE'B'
499300200529     C*
499400200529     C                     EXSR RATED
499500200529     C*
499600200529     C                     END                             - E2
499700200529     C*
499800200529     C**  SAVE REHISL  AS PREVIOUS
499900200529     C*
500000200529     C                     Z-ADDDHISD     WHISD
500100200529     C                     Z-ADDDHISB     WHISB
500200200529     C                     MOVE DDRCB     WDRCB
500300200529     C                     Z-ADDDCRCB     WCRCB
500400200529     C                     Z-ADDDCAID     WCAID
500500200529     C                     Z-ADDDDAID     WDAID
500600200529     C*
500700200529     C           KLIST1    READEREHISL                   51
500800200529     C*
500900200529     C           *IN51     DOWEQ'0'                        - B2
501000200529     C           DRECI     ANDEQ'S'
501100200529     C***********SCICI     ANDEQ'Y'                                      098818
501200200529     C           SCICI     ANDNE*BLANKS                                  098818
501300200529     C           SDICI     ANDEQ*BLANKS
501400200529     C           DHISD     ANDLTCHISD
501500200529     C           *IN51     OREQ '0'
501600200529     C           DRECI     ANDEQ'D'
501700200529     C           DDRCI     ANDEQ*BLANKS
501800200529     C           DCRCI     ANDEQ'Y'
501900200529     C*
502000200529     C           KLIST1    READEREHISL                   51
502100200529     C*
502200200529     C                     END                             - E2
502300200529     C*
502400200529     C**  OUTPUT SUBTOTAL LINE
502500200529     C*
502600200529     C           *IN51     IFEQ '0'                        - B2
502700200529     C           DHISD     ANDLTCHISD
502800200529     C*
502900200529     C           CDICT     IFLT 3                          - B3
503000200529     C                     Z-ADDWDRCB     ZICALC
503100200529     C                     Z-ADDWHISD     ZIBEG
503200200529     C                     Z-ADDDHISD     ZIEND
503300200529     C                     EXSR DAYTSR
503400200529     C                     ELSE                            - X3
503500200529     C                     EXSR ITYPDR
503600200529     C                     END                             - E3
503700200529     C*
503800200529     C           *IN51     DOWEQ'0'                        - B3
503900200529     C           DHISD     ANDLTHISD
504000200529     C           CHISD     ANDLTHISD
504100200529     C*
504200200529     C**  CHECK IF READ RECORD IS A CHANGE RATE
504300200529     C*
504400200529     C           DDRCI     IFEQ 'Y'                        - B4
504500200529     C           DRECI     ANDNE'B'
504600200529     C*
504700200529     C                     EXSR RATED
504800200529     C*
504900200529     C**  SAVE REHISL  AS PREVIOUS
505000200529     C*
505100200529     C                     Z-ADDDHISD     WHISD
505200200529     C                     Z-ADDDHISB     WHISB
505300200529     C                     MOVE DDRCB     WDRCB
505400200529     C                     Z-ADDDCRCB     WCRCB
505500200529     C                     Z-ADDDCAID     WCAID
505600200529     C                     Z-ADDDDAID     WDAID
505700200529     C*
505800200529     C           KLIST1    READEREHISL                   51
505900200529     C*
506000200529     C           *IN51     DOWEQ'0'                        - B5
506100200529     C           DRECI     ANDEQ'S'
506200200529     C***********SCICI     ANDEQ'Y'                                      098818
506300200529     C           SCICI     ANDNE*BLANKS                                  098818
506400200529     C           SDICI     ANDEQ*BLANKS
506500200529     C           DHISD     ANDLTCHISD
506600200529     C           *IN51     OREQ '0'
506700200529     C           DRECI     ANDEQ'D'
506800200529     C           DDRCI     ANDEQ*BLANKS
506900200529     C           DCRCI     ANDEQ'Y'
507000200529     C*
507100200529     C           KLIST1    READEREHISL                   51
507200200529     C*
507300200529     C                     END                             - E5
507400200529     C*
507500200529     C           CDICT     IFLT 3                          - B5
507600200529     C                     Z-ADDWDRCB     ZICALC
507700200529     C                     Z-ADDWHISD     ZIBEG
507800200529     C                     Z-ADDDHISD     ZIEND
507900200529     C                     EXSR DAYTSR
508000200529     C                     ELSE                            - X5
508100200529     C                     EXSR ITYPDR
508200200529     C                     END                             - E5
508300200529     C*
508400200529     C                     ELSE                            - X4
508500200529     C*
508600200529     C           KLIST1    READEREHISL                   51
508700200529     C*
508800200529     C           *IN51     DOWEQ'0'                        - B5
508900200529     C           DRECI     ANDEQ'S'
509000200529     C***********SCICI     ANDEQ'Y'                                      098818
509100200529     C           SCICI     ANDNE*BLANKS                                  098818
509200200529     C           SDICI     ANDEQ*BLANKS
509300200529     C           DHISD     ANDLTCHISD
509400200529     C           *IN51     OREQ '0'
509500200529     C           DRECI     ANDEQ'D'
509600200529     C           DDRCI     ANDEQ*BLANKS
509700200529     C           DCRCI     ANDEQ'Y'
509800200529     C*
509900200529     C           KLIST1    READEREHISL                   51
510000200529     C*
510100200529     C                     END                             - E5
510200200529     C*
510300200529     C                     END                             - E4
510400200529     C*
510500200529     C                     END                             - E3
510600200529     C*
510700200529     C                     END                             - E2
510800200529     C*
510900200529     C                     END                             - E1
511000200529     C*
511100200529     C           KLIST2    SETLLREHISL                   52
511200200529     C*
511300200529     C           *IN52     IFEQ '0'                        - B1
511400200529     C                     Z-ADDCLDID     WDATE
511500200529     C                     Z-ADD10        DBASE
511600200529     C                     MOVE 'REHISL'  DBFILE           ***************
511700200529     C                     MOVELRKEY2     DBKEY            **DB ERROR 10**
511800200529     C                     MOVEA'1'       *IN,89           ***************
511900200529     C                     EXSR DBSR
512000200529     C                     END                             - E1
512100200529     C*
512200200529     C           KLIST1    READEREHISL                   52
512300200529     C*
512400200529     C           *IN52     DOWEQ'0'                        - B1
512500200529     C           DRECI     ANDEQ'S'
512600200529     C***********SCICI     ANDEQ'Y'                                      098818
512700200529     C           SCICI     ANDNE*BLANKS                                  098818
512800200529     C           SDICI     ANDEQ*BLANKS
512900200529     C           DHISD     ANDLTCHISD
513000200529     C           *IN52     OREQ '0'
513100200529     C           DRECI     ANDEQ'D'
513200200529     C           DDRCI     ANDEQ*BLANKS
513300200529     C           DCRCI     ANDEQ'Y'
513400200529     C*
513500200529     C           KLIST1    READEREHISL                   52
513600200529     C*
513700200529     C                     END                             - E1
513800200529     C*
513900200529     C           DDICT     IFLT 3                          - B1
514000200529     C*
514100200529     C                     Z-ADDWDRCB     ZICALC
514200200529     C                     Z-ADDWHISD     ZIBEG
514300200529     C                     Z-ADDCHISD     ZIEND
514400200529     C*
514500200529     C                     EXSR ZICD
514600200529     C                     Z-ADDZDAYN1    DAYS
514700200529     C*
514800200529     C                     Z-SUBWHISB     HISB0
514900200529     C*
515000200529     C           *IN80     IFEQ '1'                        - B2
515100200529     C           HISB0     MULT DAYS      NUMB0
515200200529     C                     ELSE                            - X2
515300200529     C           *IN81     IFEQ '1'                        - B3
515400200529     C           HISB1     MULT DAYS      NUMB0
515500200529     C                     ELSE                            - X3
515600200529     C           *IN82     IFEQ '1'                        - B4
515700200529     C           HISB2     MULT DAYS      NUMB0
515800200529     C                     ELSE                            - X4
515900200529     C           HISB3     MULT DAYS      NUMB0
516000200529     C                     END                             - E4
516100200529     C                     END                             - E3
516200200529     C                     END                             - E2
516300200529     C*
516400200529     C           WHISB     IFGT *ZEROS                     - B2
516500200529     C           CDAIC     SUB  WDAID     INT0
516600200529     C                     Z-SUBINT0      INT0
516700200529     C                     ELSE                            - X2
516800200529     C           CCAIC     SUB  WCAID     INT0
516900200529     C                     END                             - E2
517000200529     C*
517100200529     C**  OUTPUT SUBTOTAL
517200200529     C*
517300200529     C           NUMB0     IFLT *ZEROS
517400200529     C                     ADD  NUMB0     WWTND
517500200529     C                     ELSE
517600200529     C                     ADD  NUMB0     WWTNC
517700200529     C                     END
517800200529     C                     EXSR OVERDC
517900200529     C                     WRITESTOTDC
518000200529     C*
518100200529     C* CHARGE REPORT IF NECESSARY
518200200529     C*
518300200529     C           CCICI     IFNE *BLANK                     - B2
518400200529     C           DTHGAR    IFNE *ZERO                      - B3
518500200529     C           DTHGAN    ORNE *ZERO
518600200529     C                     Z-SUBDTHGAR    CHGR0
518700200529     C                     Z-SUBDTHGAN    CHGN0
518800200529     C                     WRITEPOSTCH
518900200529     C                     END                             - E3
519000200529     C                     END                             - E2
519100200529     C*
519200200529     C                     END                             - E1
519300200529     C*
519400200529     C** PREPARE C/F BALANCE
519500200529     C*
519600200529     C                     EXSR CLMSG
519700200529     C                     MOVELNAR,6     TNARR
519800200529     C*
519900200529     C**  TRANSFER DATE MIDAS INTO DDMMMYY
520000200529     C*
520100200529     C           PVALD     IFNE CHISD                      - B1
520200200529     C                     Z-ADDCHISD     ZDAYNO
520300200529     C                     EXSR ZDATE2
520400200529     C                     MOVE ZDATE     VALDO
520500200529     C                     MOVE CHISD     PVALD
520600200529     C                     END                             - E1
520700200529     C*
520800200529     C                     MOVE VALDO     VALDA
520900200529     C                     Z-SUBCHISB     HISB0
521000200529     C*
521100200529     C**  OUTPUT BALANCE C/F
521200200529     C*
521300200529     C                     EXSR OVERDC
521400200529     C                     WRITETITLEDC
521500200529     C*
521600200529     C**  PREPARE TOTAL INTEREST OUTPUT
521700200529     C*
521800200529     C                     Z-ADDWDRCB     ZICALC
521900200529     C                     Z-ADDCLDID     ZIBEG
522000200529     C                     Z-ADDCHISD     ZIEND
522100200529     C                     EXSR ZICD
522200200529     C*
522300200529     C                     Z-ADDZDAYN1    DAYS
522400200529     C*
522500200529     C                     EXSR CLMSG
522600200529     C                     MOVELNAR,5     XNARR
522700200529     C*
522800200529     C                     Z-SUBCDAIC     TINT0
522900200529     C*
523000200529     C**  OUTPUT TOTAL INTEREST
523100200529     C*
523200200529     C                     EXSR OVERDC
523300200529     C                     WRITETOTALDC
523400200529      *                                                                   130468
523500200529      * Output total DR generated adjustments                             130468
523600200529     C           CSGADI    IFNE *ZEROS                                    130468
523700200529     C                     EXSR CLMSG                                     130468
523800200529     C                     Z-SUBCSGADI    TINT0                           130468
523900200529     C                     MOVELNAR,23    DNARR                           130468
524000200529     C                     EXSR OVERDC                                    130468
524100200529     C                     WRITETOTDDC                                    130468
524200200529     C                     END                                            130468
524300200529     C*
524400200529     C**  PREPARE TOTAL COMMISSION OUTPUT
524500200529     C*
524600200529     C*
524700200529     C**  PREPARE FIXED COMMISSION OUTPUT
524800200529     C*
524900200529     C           FXDC      IFNE *ZERO                      - B1
525000200529     C                     EXSR CLMSG
525100200529     C                     MOVELNAR,16    DNARR
525200200529     C*
525300200529     C                     Z-SUBFXDC      TINT0
525400200529     C                     EXSR OVERDC
525500200529     C                     WRITETOTDDC
525600200529     C                     END                             - E1
525700200529     C/COPY WNCPYSRC,RE3765C004
525800200529     C*
525900200529     C**  PREPARE COMMISSION ON DEBIT INTEREST
526000200529     C*
526100200529     C           *IN70     IFEQ '1'                        - B1
526200200529     C*
526300200529     C           CDIE      IFNE *ZERO                      - B2
526400200529     C                     EXSR CLMSG
526500200529     C                     MOVELNAR,17    DNARR
526600200529     C*
526700200529     C                     Z-SUBCDIE      TINT0
526800200529     C                     EXSR OVERDC
526900200529     C                     WRITETOTDDC
527000200529     C                     END                             - E2
527100200529     C*
527200200529     C**  PREPARE ACCOUNT COMMISSION
527300200529     C*
527400200529     C           ACCEA     IFNE *ZERO                      - B2
527500200529     C                     EXSR CLMSG
527600200529     C                     MOVELNAR,18    DNARR
527700200529     C*
527800200529     C                     Z-SUBACCEA     TINT0
527900200529     C                     EXSR OVERDC
528000200529     C                     WRITETOTDDC
528100200529     C                     END                             - E2
528200200529     C*
528300200529     C**  PREPARE H/O COMMISSION
528400200529     C*
528500200529     C           CHDBE     IFNE *ZERO                      - B2
528600200529     C                     EXSR CLMSG
528700200529     C                     MOVELNAR,19    DNARR
528800200529     C*
528900200529     C                     Z-SUBCHDBE     TINT0
529000200529     C                     EXSR OVERDC
529100200529     C                     WRITETOTDDC
529200200529     C                     END                             - E2
529300200529     C*
529400200529     C**  PREPARE COMMISSION ON MINIMUM BALANCE
529500200529     C*
529600200529     C           CMBE      IFNE *ZERO                      - B2
529700200529     C                     EXSR CLMSG
529800200529     C                     MOVELNAR,20    DNARR
529900200529     C*
530000200529     C                     Z-SUBCMBE      TINT0
530100200529     C                     EXSR OVERDC
530200200529     C                     WRITETOTDDC
530300200529     C                     END                             - E2
530400200529     C*
530500200529     C                     ELSE                            - X1
530600200529     C*
530700200529     C           CDICA     IFNE *ZERO                      - B2
530800200529     C                     EXSR CLMSG
530900200529     C                     MOVELNAR,17    DNARR
531000200529     C*
531100200529     C           CDICA     SUB  CCDIC     TINT0
531200200529     C                     EXSR OVERDC
531300200529     C                     WRITETOTDDC
531400200529     C                     END                             - E2
531500200529     C*
531600200529     C**  PREPARE ACCOUNT COMMISSION
531700200529     C*
531800200529     C* PREPARE PREVIOUS PERIOD COMMISSIONS TOTAL NOT POSTED.
531900200529     C*
532000200529     C           GVDPC     IFNE *ZERO
532100200529     C*
532200200529     C                     EXSR CLMSG
532300200529     C                     MOVELNAR,33    DNARR
532400200529     C           GVDPC     SUB  TOTPST    TINT0
532500200529     C           TINT0     IFNE *ZERO
532600200529     C                     EXSR OVERDC
532700200529     C                     WRITETOTDDC
532800200529     C                     END
532900200529     C*
533000200529     C* PREPARE AJUSTEMENT TO COMMISSIONS
533100200529     C*
533200200529     C                     EXSR CLMSG
533300200529     C           GVDPC     MULT ACCRA     CALC   180
533400200529     C           CALC      DIV  100       CALC
533500200529     C                     MOVELNAR,34    DNARR
533600200529     C           CALC      SUB  ACCC      TINT0
533700200529     C           TINT0     IFNE *ZERO
533800200529     C                     EXSR OVERDC
533900200529     C                     WRITETOTDDC
534000200529     C                     END
534100200529     C*
534200200529     C**         ACCC      IFNE *ZERO                      - B2
534300200529     C*
534400200529     C                     EXSR CLMSG
534500200529     C                     MOVELNAR,28    DNARR
534600200529     C                     Z-ADDTOTPST    TINT0
534700200529     C           TINT0     IFNE *ZERO
534800200529     C                     EXSR OVERDC
534900200529     C                     WRITETOTDDC
535000200529     C                     END
535100200529     C*
535200200529     C                     EXSR CLMSG
535300200529     C                     MOVELNAR,29    DNARR
535400200529     C                     Z-ADDTOTNPS    TINT0
535500200529     C           TINT0     IFNE *ZERO
535600200529     C                     EXSR OVERDC
535700200529     C                     WRITETOTDDC
535800200529     C                     END
535900200529     C*
536000200529     C                     EXSR CLMSG
536100200529     C                     MOVELNAR,30    QNARR
536200200529     C                     Z-ADDACCRA     RATET
536300200529     C                     EXSR OVERDC
536400200529     C                     WRITETURRAT
536500200529     C*
536600200529     C                     EXSR CLMSG
536700200529     C                     MOVELNAR,18    DNARR
536800200529     C*
536900200529     C** CACCC IS SET TO ZERO IN PREVIOUS PROGRAM  RE3116
537000200529     C                     Z-ADDACCC      TINT0
537100200529     C           TINT0     IFNE *ZERO
537200200529     C                     EXSR OVERDC
537300200529     C                     WRITETOTDDC
537400200529     C                     END
537500200529     C                     END                             - E2
537600200529     C*
537700200529     C**  PREPARE H/O COMMISSION
537800200529     C*
537900200529     C           CHDBC     IFNE *ZERO                      - B2
538000200529     C                     EXSR CLMSG
538100200529     C                     MOVELNAR,19    DNARR
538200200529     C*
538300200529     C           CHDBC     SUB  CCHDBC    TINT0
538400200529     C                     EXSR OVERDC
538500200529     C                     WRITETOTDDC
538600200529     C                     END                             - E2
538700200529     C*
538800200529     C**  PREPARE COMMISSION ON MINIMUM BALANCE
538900200529     C*
539000200529     C           CMBC      IFNE *ZERO                      - B2
539100200529     C                     EXSR CLMSG
539200200529     C                     MOVELNAR,20    DNARR
539300200529     C*
539400200529     C           CMBC      SUB  CCMBC     TINT0
539500200529     C                     EXSR OVERDC
539600200529     C                     WRITETOTDDC
539700200529     C                     END                             - E2
539800200529     C*
539900200529     C**  PREPARE VAT
540000200529     C*
540100200529     C           VATAM     IFNE *ZERO                      - B1
540200200529     C                     EXSR CLMSG
540300200529     C                     MOVELNAR,24    DNARR
540400200529     C*
540500200529     C                     Z-ADDVATAM     TINT0
540600200529     C                     EXSR OVERDC
540700200529     C                     WRITETOTDDC
540800200529     C                     END                             - E1
540900200529     C*
541000200529     C                     END                             - E1
541100200529     C*
541200200529     C**  PREPARE TOTAL
541300200529     C*
541400200529     C                     Z-ADD*ZERO     TINT0
541500200529     C           CSDCI     IFEQ 'Y'                        - B1
541600200529     C           CSDCI     OREQ 'I'
541700200529     C           CSDCI     OREQ 'A'
541800200529     C           CDAIC     ADD  FXDC      TINT0
541900200529     C/COPY WNCPYSRC,RE3765C005
542000200529     C                     ADD  CDICA     TINT0
542100200529     C                     ADD  ACCC      TINT0
542200200529     C                     ADD  CHDBC     TINT0
542300200529     C                     ADD  CMBC      TINT0
542400200529     C                     ADD  VATAM     TINT0
542500200529     C                     END                             - E1
542600200529     C                     ADD  CSGADI    TINT0                           130468
542700200529      *                                                                   130468
542800200529     C                     Z-SUBTINT0     TINT0
542900200529     C                     EXSR CLMSG
543000200529     C                     MOVELNAR,21    DNARR
543100200529     C*
543200200529     C                     EXSR OVERDC
543300200529     C                     WRITETOTDDC
543400200529     C*
543500200529     C           *IN70     IFEQ '1'                        - B1
543600200529     C                     EXSR OVERDC
543700200529     C                     WRITETOTMAN
543800200529     C                     END                             - E1
543900200529     C*
544000200529     C/COPY WNCPYSRC,RE3765C009
544100200529     C           CER050    IFEQ 'Y'                                                           CER050
544200200529      *                                                                                       CER050
544300200529      * Only print APR if not management statement                                            CER050
544400200529      *                                                                                       CER050
544500200529     C           *IN70     IFEQ '0'                        B001                               CER050
544600200529      *                                                                                       CER050
544700200529     C                     MOVE *OFF      *IN61                                               CER050
544800200529     C                     MOVE *BLANKS   TANAR  30                                           CER050
544900200529      *                                                                                       CER050
545000200529     C           KACCNT    CHAINACCNTBY0             99                                       CER050
545100200529     C           *IN99     IFEQ '0'                                                           CER050
545200200529      *                                                                                       CER050
545300200529     C* Run this process only if Do not print APR is set                                      CER050
545400200529      *                                                                                       CER050
545500200529     C           ATAPRC    IFEQ 'Y'                                                           CER050
545600200529     C                     EXSR SRAPRD                                                        CER050
545700200529     C                     ENDIF                                                              CER050
545800200529      *                                                                                       CER050
545900200529     C                     ENDIF                                                              CER050
546000200529     C                     ENDIF                                                              CER050
546100200529     C                     ENDIF                                                              CER050
546200200529      *                                                                                       CER050
546300200529     C                     ENDSR                           **DRSR ENDSR**
546400200529     C*
546500200529     C********************************************************************
546600200529     C/EJECT
546700200529     C********************************************************************
546800200529     C**
546900200529     C** DETPR subroutine for detail processing
547000200529     C**
547100200529     C**     Called by       M A I N
547200200529     C**
547300200529     C**     Calls         BOTHSR, DRSR, CRSR, DBSR
547400200529     C**
547500200529     C           DETPR     BEGSR                           **DETPR BEGSR**
547600200529     C*
547700200529     C**  ACCESS ACCRACJ (ACCNTAB, REIACD, REACRD)
547800200529     C*
547900200529     C           KLIST1    CHAINACCRACJ              99
548000200529     C           *IN99     IFEQ '1'                        - B1
548100200529     C                     Z-ADD11        DBASE            ***************
548200200529     C                     MOVE 'ACCRACJ' DBFILE           **DB ERROR 11**
548300200529     C                     MOVELRKEY      DBKEY            ***************
548400200529     C                     MOVEA'1'       *IN,89
548500200529     C                     EXSR DBSR
548600200529     C                     END                             - E1
548700200529     C*
548800200529     C*********** ACCESS CLINT FOR CLIENT INFORMATION (ADDRESS, NAME, ETC)084174
548900200529     C***********                                                         084174
549000200529     C***********          MOVE WRCDT     RCDT                            084174
549100200529     C********** KLIST4    CHAINCLINT                99                   084174
549200200529     C********** *IN99     IFEQ '1'                        - B1           084174
549300200529     C***********          MOVELCCNUM     DBKEY                           084174
549400200529     C***********          Z-ADD12        DBASE            ***************084174
549500200529     C***********          MOVE 'CLINT'   DBFILE           **DB ERROR 12**084174
549600200529     C***********          MOVELRCDT      DBKEY            ***************084174
549700200529     C***********          MOVEA'1'       *IN,89                          084174
549800200529     C***********          EXSR DBSR                                      084174
549900200529     C***********          END                             - E1           084174
550000200529     C*                                                                   084174
550100200529     C* Retrieve correspondent details from CGCORRPD via AOALTNR0:        084174
550200200529     C*                                                                   084174
550300200529     C                     MOVELCCNUM     P#CUST                          084174
550400200529     C**********           MOVELRCDT      P#ADCD                                       084174 253776
550500200529     C                     MOVELWRCDT     P#ADCD                                              253776
550600200529     C                     MOVEL*BLANKS   P#CUS1                          087284
550700200529     C                     MOVELCCNUM     P#CUS1                          087284
550800200529      *                                                                   CFT004
550900200529     C                     MOVEL*BLANKS   RIBAN                           CFT004
551000200529     C                     MOVE '0'       *IN04                           CFT004
551100200529     C           CFT004    IFEQ 'Y'                                       CFT004
551200200529     C                     MOVELCCNUM     WCNUM   6                       CFT004
551300200529     C**********           MOVELCACOD     WACOD   4                                    CFT004 CGL029
551400200529     C                     MOVELCACOD     WACOD  10                                           CGL029
551500200529     C                     MOVELCACSQ     WACSQ   2                       CFT004
551600200529     C                     CALL 'AOACCTR0'                                CFT004
551700200529     C                     PARM *BLANKS   PRTCD                           CFT004
551800200529     C                     PARM '*KEY   ' POPTN                           CFT004
551900200529     C                     PARM *BLANK    PRETL  10                       CFT004
552000200529     C                     PARM WCNUM     PCNUM   6                       CFT004
552100200529     C                     PARM CCCY      PCUCD   3                       CFT004
552200200529     C**********           PARM WACOD     PACCD   4                                    CFT004 CGL029
552300200529     C                     PARM WACOD     PACCD  10                                           CGL029
552400200529     C                     PARM WACSQ     PACSQ   2                       CFT004
552500200529     C                     PARM CBRCA     PBRCA   3                       CFT004
552600200529     C           ACCNTB    PARM ACCNTB    DSSDY                           CFT004
552700200529      *                                                                   CFT004
552800200529     C           PRTCD     IFNE *BLANKS                                   CFT004
552900200529     C                     Z-ADD30        DBASE            ************   CFT004
553000200529     C                     MOVEL'ACCNTAB' DBFILE           * DBERR 30 *   CFT004
553100200529     C                     MOVELRKEY      DBKEY            ************   CFT004
553200200529     C                     MOVE '1'       *IN89                           CFT004
553300200529     C                     EXSR DBSR                                      CFT004
553400200529     C                     ENDIF                                          CFT004
553500200529      *                                                                   CFT004
553600200529      ** Format International Bank Account Numbers                        CFT004
553700200529      *                                                                   CFT004
553800200529     C           IBAN      IFNE *BLANKS                                   CFT004
553900200529     C                     CALL 'AOIBANR3'                                CFT004
554000200529     C                     PARM *BLANKS   PRTCD   7                       CFT004
554100200529     C                     PARM IBAN      PIBAN  47                       CFT004
554200200529     C                     PARM *BLANKS   PIWITH 47                       CFT004
554300200529     C                     PARM *BLANKS   PINOBL 34                       CFT004
554400200529      *                                                                   CFT004
554500200529     C           PRTCD     IFEQ *BLANKS                                   CFT004
554600200529     C                     MOVELPIWITH    RIBAN                           CFT004
554700200529     C                     MOVE '1'       *IN04                           CFT004
554800200529     C                     ENDIF                                          CFT004
554900200529     C                     ENDIF                                          CFT004
555000200529      *                                                                   CFT004
555100200529     C                     ENDIF                                          CFT004
555200200529      *                                                                   CFT004
555300200529      *                                                                   087284
555400200529      * If address reference is B use AOCUSTRO else AOALTNR0              087284
555500200529      *                                                                   087284
555600200529     C********** RCDT      IFEQ 'B'                                                    087284 253776
555700200529     C           WRCDT     IFEQ 'B'                                                           253776
555800200529     C                     CALL 'AOCUSTR0'             9090               087284
555900200529     C                     PARM *BLANKS   P#RTCD  7                       087284
556000200529     C                     PARM '*KEY   ' P#OPTN  7                       087284
556100200529     C                     PARM           P#CUS1 10                       087284
556200200529     C                     PARM *BLANKS   P#KYST  7                       087284
556300200529     C           SDCUST    PARM *BLANKS   DSSDY                           087284
556400200529      *                                                                   087284
556500200529     C           *IN90     IFEQ '1'                                       087284
556600200529     C                     MOVEL'AOCUSTR0'DBFILE           ***************087284
556700200529     C                     MOVELCCNUM     DBKEY            * DB ERROR 22 *087284
556800200529     C                     Z-ADD22        DBASE            ***************087284
556900200529     C                     MOVEA'1'       *IN,89                          087284
557000200529     C                     EXSR DBSR                                      087284
557100200529     C                     END                                            087284
557200200529     C                     ELSE                                           087284
557300200529     C*                                                                   084174
557400200529     C                     CALL 'AOALTNR0'                                084174
557500200529     C                     PARM *BLANKS   P#RTCD  7        B:Return code  084174
557600200529     C                     PARM '*KEY   ' P#OPTN  7        I:Option       084174
557700200529     C                     PARM           P#CUST  6        I:Customer no. 084174
557800200529     C                     PARM           P#ADCD  1        I:Address code 084174
557900200529     C***********P#CORR    PARM P#CORR    DSFDY            O:Format 084174087284
558000200529     C           P#ALTN    PARM P#ALTN    DSFDY            O:Format       087284
558100200529     C*                                                                   084174
558200200529     C                     ENDIF                                          087284
558300200529      *                                                                   087284
558400200529     C           P#RTCD    IFNE *BLANKS                                   084174
558500200529     C                     MOVELCCNUM     DBKEY                           084174
558600200529     C                     Z-ADD12        DBASE            ***************084174
558700200529     C                     MOVE 'CLINT'   DBFILE           **DB ERROR 12**084174
558800200529     C                     MOVELRCDT      DBKEY            ***************084174
558900200529     C                     MOVEA'1'       *IN,89                          084174
559000200529     C                     EXSR DBSR                                      084174
559100200529     C                     ELSE                                           084174
559200200529     C***********          MOVELCDADD1    CNA1   35                 084174087284
559300200529     C***********          MOVELCDADD2    CNA2   35                 084174087284
559400200529     C***********          MOVELCDADD3    CNA3   35                 084174087284
559500200529     C***********          MOVELCDADD4    CNA4   35                 084174087284
559600200529      *                                                                   087284
559700200529      * Move in address fields                                            087284
559800200529      *                                                                   087284
559900200529     C********** RCDT      IFEQ 'B'                                                    087284 253776
560000200529     C           WRCDT     IFEQ 'B'                                                           253776
560100200529     C                     MOVELBBCNA1    CNA1                            087284
560200200529     C                     MOVELBBCNA2    CNA2                            087284
560300200529     C                     MOVELBBCNA3    CNA3                            087284
560400200529     C                     MOVELBBCNA4    CNA4                            087284
560500200529     C                     ELSE                                           087284
560600200529     C                     MOVELBCCNA1    CNA1   35                       087284
560700200529     C                     MOVELBCCNA2    CNA2   35                       087284
560800200529     C                     MOVELBCCNA3    CNA3   35                       087284
560900200529     C                     MOVELBCCNA4    CNA4   35                       087284
561000200529     C                     ENDIF                                          087284
561100200529     C                     ENDIF                                          084174
561200200529     C**********           END                                            084174
561300200529     C*
561400200529     C                     MOVE WRCDT     RCDT                                                253776
561500200529     C           KLIST4    CHAINCLINT                05                                       253776
561600200529     C           *IN05     IFEQ '1'                                                           253776
561700200529     C                     MOVE 'A'       RCDT
561800200529     C           KLIST4    CHAINCLINT                99
561900200529     C           *IN99     IFEQ '1'                        - B1
562000200529     C                     MOVELCCNUM     DBKEY
562100200529     C                     Z-ADD13        DBASE            ***************
562200200529     C                     MOVE 'CLINT'   DBFILE           **DB ERROR 13**
562300200529     C                     MOVELRCDT      DBKEY            ***************
562400200529     C                     MOVEA'1'       *IN,89
562500200529     C                     EXSR DBSR
562600200529     C                     END                             - E1
562700200529     C                     ENDIF                                                              253776
562800200529     C*
562900200529     C                     MOVELCCNUM     AXCNUM  6
563000200529     C*
563100200529     C                     CALL 'AOCUSTR0'
563200200529     C                     PARM *BLANKS   @RTCD
563300200529     C                     PARM '*KEY   ' @OPTN
563400200529     C                     PARM           AXCNUM
563500200529     C                     PARM *BLANKS   @KYST   7
563600200529     C           SDCUST    PARM SDCUST    DSSDY
563700200529     C*
563800200529     C           @RTCD     IFNE *BLANKS                    - B1
563900200529     C                     MOVELAXCNUM    DBKEY
564000200529     C                     Z-ADD14        DBASE            ***************
564100200529     C                     MOVE 'SDCUSTPD'DBFILE           **DB ERROR 14**
564200200529     C                     MOVEA'1'       *IN,89           ***************
564300200529     C                     EXSR DBSR
564400200529     C                     END                             - E1
564500200529     C*
564600200529     C** CHECK CUSTOMER GROUP ONLY IF ONE COMMISSION IS ON
564700200529     C*
564800200529     C           *IN67     IFEQ '1'
564900200529     C*
565000200529     C* IF THE CUSTOMER GROUP IS SUBJECT TO COMMISSION
565100200529     C*
565200200529     C                     Z-ADD1         Y
565300200529     C           CUCGRP    LOKUPCGRP,Y                   57
565400200529     C           *IN57     IFEQ '0'                        - B1
565500200529     C                     MOVE 'TABLEV4' DBFILE
565600200529     C                     MOVELCUCGRP    DBKEY            ***************
565700200529     C                     Z-ADD15        DBASE            **DB ERROR 15**
565800200529     C                     MOVE '1'       *IN89            ***************
565900200529     C                     EXSR DBSR
566000200529     C                     END                             - E1
566100200529     C*
566200200529     C           AGRP,Y    IFEQ 'Y'                        - B1
566300200529     C                     MOVE '1'       *IN54
566400200529     C                     ELSE                            - X1
566500200529     C                     MOVE '0'       *IN54
566600200529     C                     END                             - E1
566700200529     C*
566800200529     C                     END
566900200529     C*
567000200529     C**  ACCESS ACCNTAB
567100200529     C*
567200200529     C           KACCNT    CHAINACCNT                99
567300200529     C           *IN99     IFEQ '1'                        - B1
567400200529     C                     Z-ADD16        DBASE            ***************
567500200529     C                     MOVE 'ACCNT'   DBFILE           **DB ERROR 16**
567600200529     C                     MOVELRKEY      DBKEY            ***************
567700200529     C                     MOVEA'1'       *IN,89
567800200529     C                     EXSR DBSR
567900200529     C                     END                             - E1
568000200529     C*
568100200529     C           *IN54     IFEQ '1'                        - B1
568200200529     C           CEXB      IFEQ 'E'                        - B2
568300200529     C                     MOVE '0'       *IN54
568400200529     C                     ELSE                            - X1
568500200529     C                     MOVE '1'       *IN54
568600200529     C                     END                             - E2
568700200529     C                     END                             - E1
568800200529     C*
568900200529     C** CHECK IF CURRENCY EXIST
569000200529     C*
569100200529     C                     Z-ADD1         I
569200200529     C           CCCY      LOKUPCCYA,I                   97
569300200529     C*
569400200529     C           *IN97     IFEQ *ZERO                      - B1
569500200529     C                     Z-ADD17        DBASE            ***************
569600200529     C                     MOVE 'SDCURRPD'DBFILE           **DB ERROR 17**
569700200529     C                     MOVELCCCY      DBKEY            ***************
569800200529     C                     MOVEA'1'       *IN,89
569900200529     C                     EXSR DBSR
570000200529     C                     END                             - E1
570100200529     C*
570200200529     C                     MOVE ACNO      WACNO
570300200529     C*
570400200529     C** CHECK NUMBER OF DECIMAL OF CURRENCY
570500200529     C*
570600200529     C                     MOVEA'0000'    *IN,80
570700200529     C*
570800200529     C           DPA,I     IFEQ 0                          - B1
570900200529     C                     MOVE '1'       *IN80
571000200529     C                     ELSE                            - X1
571100200529     C           DPA,I     IFEQ 1                          - B2
571200200529     C                     MOVE '1'       *IN81
571300200529     C                     ELSE                            - X2
571400200529     C           DPA,I     IFEQ 2                          - B3
571500200529     C                     MOVE '1'       *IN82
571600200529     C                     ELSE                            - X3
571700200529     C                     MOVE '1'       *IN83
571800200529     C                     END                             - E3
571900200529     C                     END                             - E2
572000200529     C                     END                             - E1
572100200529     C*
572200200529     C                     MOVEA'00'      *IN,01
572300200529     C*
572400200529     C**  DEFINE CAPITALISATION TO BE PROCESSED
572500200529     C*
572600200529     C           CDICI     IFNE *BLANKS                    - B1
572700200529     C                     MOVE '1'       *IN01
572800200529     C                     END                             - E1
572900200529     C*
573000200529     C           CCICI     IFNE *BLANKS                    - B1
573100200529     C                     MOVE '1'       *IN02
573200200529     C                     END                             - E1
573300200529     C*
573400200529     C           CCICI     IFNE *BLANKS                    - B1
573500200529     C           CDICI     ANDNE*BLANKS
573600200529     C                     EXSR BOTHSR
573700200529     C                     ELSE                            - X1
573800200529     C           CCICI     IFNE *BLANKS                    - B2
573900200529     C                     EXSR CRSR
574000200529     C                     END                             - E2
574100200529     C           CDICI     IFNE *BLANKS                    - B2
574200200529     C                     EXSR DRSR
574300200529     C                     END                             - E2
574400200529     C                     END                             - E1
574500200529     C*
574600200529     C**********           EXSR INITPR                                                        253776
574700200529     C*
574800200529     C                     ENDSR                           **DETPR ENDSR**
574900200529     C********************************************************************
575000200529     C/EJECT
575100200529     C********************************************************************
575200200529     C**
575300200529     C** FIRST subroutine to execute first cycle.
575400200529     C**
575500200529     C**     Called by       S T A R T
575600200529     C**     Calls           DBSR
575700200529     C**
575800200529     C           FIRST     BEGSR                           **FIRST BEGSR**
575900200529     C*
576000200529     C** PREPARE DBPGM, DBKEY AND ERRDAT VARIABLES
576100200529     C*
576200200529     C                     MOVE 'RE3765  'DBPGM
576300200529     C                     MOVE *BLANKS   DBKEY
576400200529     C                     MOVE *BLANKS   DBASE
576500200529     C           *NAMVAR   DEFN RUNDAT    RUNDT
576600200529     C                     IN   RUNDT
576700200529     C           MBIN      IFEQ 'Y'
576800200529     C                     SETON                     86
576900200529     C                     END
577000200529     C*
577100200529     C           DATF      IFEQ 'M'                        - B1
577200200529     C                     MOVE '1'       *IN98
577300200529     C                     END                             - E1
577400200529     C**
577500200529     C**   ACCESS BANK DETAILS
577600200529     C**
577700200529     C                     CALL 'AOBANKR0'
577800200529     C                     PARM '*MSG   ' @RTCD   7
577900200529     C                     PARM '*FIRST ' @OPTN   7
578000200529     C           SDBANK    PARM SDBANK    DSFDY
578100200529     C*
578200200529     C           @RTCD     IFNE *BLANK
578300200529     C                     MOVEL'SDBANKPD'DBFILE
578400200529     C                     MOVEL@OPTN     DBKEY            ***************
578500200529     C                     MOVEL@OPTN     DBOPTN  7        **DB ERROR 18**
578600200529     C                     Z-ADD18        DBASE            ***************
578700200529     C                     EXSR DBSR
578800200529     C                     GOTO ENDFST
578900200529     C                     END
579000200529     C*                                                                   104618
579100200529     C**   Access Retail Details.                                         104618
579200200529     C*                                                                   104618
579300200529     C                     CALL 'AORETLR0'                                104618
579400200529     C                     PARM *BLANKS   @RTCD   7                       104618
579500200529     C                     PARM '*FIRST ' @OPTN   7                       104618
579600200529     C           SDRETL    PARM SDRETL    DSFDY                           104618
579700200529     C           @RTCD     IFNE *BLANK                                    104618
579800200529     C           *LOCK     IN   LDA                                       104618
579900200529     C                     MOVEL'SDRETLPD'DBFILE           ***************104618
580000200529     C                     MOVEL@OPTN     DBKEY            * DB ERROR 29 *104618
580100200529     C                     MOVEL@OPTN     DBOPTN  7        ***************104618
580200200529     C                     Z-ADD029       DBASE                           104618
580300200529     C                     OUT  LDA                                       104618
580400200529     C                     EXSR DBSR                                      104618
580500200529     C                     GOTO ENDFST                                    104618
580600200529     C                     END                                            104618
580700200529     C*
580800200529     C* STORE ALL RETAIL ICD BY CURRENCY RECORDS
580900200529     C*
581000200529     C                     Z-ADD1         X       30
581100200529     C*
581200200529     C                     READ RECCYDF                  55
581300200529     C*
581400200529     C           *IN55     DOWEQ'0'                        READ UNTIL EOF
581500200529     C           RECI      IFEQ 'D'
581600200529     C                     MOVE KEY       CUR     4
581700200529     C                     MOVELCUR       CURR,X
581800200529     C                     MOVE ACMX      AMAX,X
581900200529     C                     MOVE ACMN      AMIN,X
582000200529     C                     Z-ADDACRT      ARET,X
582100200529     C                     ADD  1         X
582200200529     C                     END
582300200529     C                     READ RECCYDF                  55
582400200529     C                     END
582500200529     C*
582600200529     C* STORE THE EIGHT GROUPS RECORDS FROM THE RETAIL TABLE
582700200529     C*
582800200529     C                     Z-ADD1         Y       10
582900200529     C*
583000200529     C                     MOVEL'81      'CTKEY  12
583100200529     C                     MOVE '    '    CTKEY
583200200529     C           1         SETLLTABLEV4
583300200529     C*
583400200529     C                     READ TABLEV4                  56
583500200529     C                     MOVELCTKEY     CT      2
583600200529     C*
583700200529     C           *IN56     DOUEQ'1'                        READ UNTIL EOF
583800200529     C           RECI      IFEQ 'D'
583900200529     C           CT        IFEQ '81'
584000200529     C                     MOVE KEY       CGRP,Y
584100200529     C                     MOVE ACMI      AGRP,Y
584200200529     C                     ADD  1         Y
584300200529     C                     END
584400200529     C                     READ TABLEV4                  56
584500200529     C                     MOVELCTKEY     CT      2
584600200529     C                     END
584700200529     C                     END
584800200529     C*
584900200529     C** OUTPUT AUDIT HEADER
585000200529     C*
585100200529     C                     WRITEHEADAU
585200200529     C*
585300200529     C** INITIALISE WORK FIELDS
585400200529     C*
585500200529     C                     Z-ADD*ZEROS    PPSTD
585600200529     C                     Z-ADD*ZEROS    PVALD
585700200529     C                     Z-ADD1         PAGH
585800200529     C                     Z-ADD1         PAGF
585900200529     C                     Z-ADD1         PAGU
586000200529     C                     Z-ADD*ZEROS    DHISD
586100200529     C                     Z-ADD*ZEROS    WHISD
586200200529     C                     Z-ADD*ZEROS    DAYS
586300200529     C                     Z-ADD*ZEROS    NUMB0
586400200529     C                     Z-ADD*ZEROS    HISB0
586500200529     C                     Z-ADD*ZEROS    INT0
586600200529     C                     Z-ADD*ZEROS    TINT0
586700200529     C                     Z-ADD*ZEROS    ZICALC  20
586800200529     C                     Z-ADD*ZEROS    ZDAYN1
586900200529     C                     Z-ADD*ZEROS    WDAID
587000200529     C                     Z-ADD*ZEROS    WCAID
587100200529     C                     Z-ADD*ZEROS    WWTND
587200200529     C                     Z-ADD*ZEROS    WWTNC
587300200529     C*
587400200529     C                     Z-ADD*ZEROS    TOTPST
587500200529     C                     Z-ADD*ZEROS    TOTNPS
587600200529     C*
587700200529     C**  SET UP WORK FIELD FOR OVERRIDE MESSAGE FILE
587800200529     C*
587900200529     C                     Z-ADD39        MSGLEN 155
588000200529     C*
588100200529     C** OPEN ICD TABLE FOR RETAIL
588200200529     C*
588300200529     C                     OPEN TABTBRE
588400200529     C           1         CHAINTABTBRE              99
588500200529     C*
588600200529     C           *IN99     IFEQ '1'                        - B1
588700200529     C           RECI      ORNE 'D'
588800200529     C                     Z-ADD19        DBASE            ***************
588900200529     C                     MOVE 'TABTBRE' DBFILE           **DB ERROR 19**
589000200529     C                     MOVEL*BLANKS   DBKEY            ***************
589100200529     C                     MOVEA'0'       *IN,89
589200200529     C                     EXSR DBSR
589300200529     C                     END                             - E1
589400200529     C*
589500200529     C** COMMISSION ON DEBIT TURNOVER
589600200529     C*
589700200529     C           CDTO      IFEQ 'Y'                        - B1
589800200529     C                     MOVE '1'       *IN67
589900200529     C                     END                             - E1
590000200529     C*
590100200529     C** COMMISSION ON HIGHEST OVERDRAFT
590200200529     C*
590300200529     C           CMDR      IFEQ 'Y'                        - B1
590400200529     C           MDPF      ANDEQ'Y'                        - B1
590500200529     C                     MOVE '1'       *IN67
590600200529     C                     END                             - E1
590700200529     C*
590800200529     C** FIXED ACCOUNT CHARGE
590900200529     C*
591000200529     C           FXAC      IFEQ 'Y'                        - B1
591100200529     C                     MOVE '1'       *IN67
591200200529     C                     END                             - E1
591300200529     C*
591400200529     C** CHARGE ON NUMBER OF DAILY STATEMENTS
591500200529     C*
591600200529     C           CNDS      IFEQ 'Y'                        - B1
591700200529     C                     MOVE '1'       *IN67
591800200529     C                     END                             - E1
591900200529     C*
592000200529     C** COMMISSION ON DEBIT INTEREST
592100200529     C*
592200200529     C           CDRI      IFEQ 'Y'                        - B1
592300200529     C                     MOVE '1'       *IN67
592400200529     C                     END                             - E1
592500200529     C*
592600200529     C** COMMISSION ON MINIMUM AVERAGE BALANCE
592700200529     C*
592800200529     C           CMBL      IFEQ 'Y'                        - B1
592900200529     C                     MOVE '1'       *IN67
593000200529     C                     END                             - E1
593100200529     C*
593200200529     C** CHARGE ON INACTIVE ACCOUNT
593300200529     C*
593400200529     C           CINA      IFEQ 'Y'                        - B1
593500200529     C                     MOVE '1'       *IN67
593600200529     C                     END                             - E1
593700200529     C*
593800200529     C** VAT PROCESSING
593900200529     C*
594000200529     C           VATP      IFEQ 'Y'                        - B1
594100200529     C                     MOVE '1'       *IN67
594200200529     C                     END                             - E1
594300200529      *                                                                   CRE001
594400200529      ** Access SAR Details File to determine if CRE001 is installed      CRE001
594500200529      *                                                                   CRE001
594600200529     C                     CALL 'AOSARDR0'                                CRE001
594700200529     C                     PARM *BLANKS   @RTCD   7                       CRE001
594800200529     C                     PARM '*VERIFY' @OPTN                           CRE001
594900200529     C                     PARM 'CRE001'  @SARD   6                       CRE001
595000200529      *                                                                   CRE001
595100200529      ** Handle Datebase Error.                                           CRE001
595200200529     C           @RTCD     IFNE *BLANK                                    CRE001
595300200529     C           @RTCD     ANDNE'*NRF   '                  ***************CRE001
595400200529     C                     MOVEL'SCSARDPD'DBFILE           **DB ERROR 25**CRE001
595500200529     C                     MOVEL@RTCD     DBKEY            ***************CRE001
595600200529     C                     Z-ADD25        DBASE                           CRE001
595700200529     C                     EXSR DBSR                                      CRE001
595800200529     C                     GOTO ENDFST                                    CRE001
595900200529     C                     ENDIF                                          CRE001
596000200529     C/COPY WNCPYSRC,RE3765C016
596100200529      *                                                                   CRE001
596200200529      ** CRE001 is installed                                              CRE001
596300200529     C           @RTCD     IFEQ *BLANK                                    CRE001
596400200529     C                     MOVE 'Y'       CRE001  1                       CRE001
596500200529     C                     ELSE                                           CRE001
596600200529     C                     MOVE 'N'       CRE001                          CRE001
596700200529     C                     ENDIF                                          CRE001
596800200529     C/COPY WNCPYSRC,RE3765C018
596900200529      *                                                                   CRE001
597000200529      ** Access SAR Details File to determine if CGL031 is installed                          CGL031
597100200529      *                                                                                       CGL031
597200200529     C                     CALL 'AOSARDR0'                                                    CGL031
597300200529     C                     PARM *BLANKS   PRTCD   7                                           CGL031
597400200529     C                     PARM '*VERIFY' POPTN   7                                           CGL031
597500200529     C                     PARM 'CGL031'  DSFDY                                               CGL031
597600200529      *                                                                                       CGL031
597700200529      ** Handle Datebase Error.                                                               CGL031
597800200529      *                                                                                       CGL031
597900200529     C           PRTCD     IFNE *BLANK                                                        CGL031
598000200529     C           PRTCD     ANDNE'*NRF   '                                                     CGL031
598100200529     C                     MOVEL'SCSARDPD'DBFILE                                              CGL031
598200200529     C                     MOVEL'CGL031'  DBKEY                                               CGL031
598300200529     C                     MOVE 31        DBASE                                               CGL031
598400200529     C                     EXSR DBSR                                                          CGL031
598500200529     C                     GOTO ENDFST                                                        CGL031
598600200529     C                     ENDIF                                                              CGL031
598700200529      *                                                                                       CGL031
598800200529      ** CGL031 is installed                                                                  CGL031
598900200529      *                                                                                       CGL031
599000200529     C           PRTCD     IFEQ *BLANK                                                        CGL031
599100200529     C                     MOVE 'Y'       CGL031  1                                           CGL031
599200200529     C                     ELSE                                                               CGL031
599300200529     C                     MOVE 'N'       CGL031                                              CGL031
599400200529     C                     ENDIF                                                              CGL031
599500200529      *                                                                                       CGL031
599600200529     C                     EXSR MULTL
599700200529     C**
599800200529     C** ACCESS SAR DETAILS FILE TO DETERMINE IF BRT SAR IS INSTALLED
599900200529     C**
600000200529     C                     CALL 'AOSARDR0'
600100200529     C                     PARM '       ' @RTCD
600200200529     C                     PARM '*VERIFY' @OPTN
600300200529     C                     PARM 'S01383'  @SARD   6
600400200529     C           @RTCD     IFNE *BLANK
600500200529     C           @RTCD     ANDNE'*NRF   '                  ***************
600600200529     C                     MOVEL'SCSARDPD'DBFILE           * DB ERROR 20 *
600700200529     C                     MOVEL@RTCD     DBKEY            ***************
600800200529     C                     Z-ADD20        DBASE
600900200529     C                     EXSR DBSR
601000200529     C                     GOTO ENDFST
601100200529     C                     END
601200200529     C           @RTCD     IFEQ *BLANK
601300200529     C                     MOVEL'Y'       S01383  1
601400200529     C                     END
601500200529     C*
601600200529     C** IF BRT SAR INSTALLED
601700200529     C*
601800200529     C           S01383    IFEQ 'Y'                        B001
601900200529     C*
602000200529     C** ACCESS BRT INSTALLATION CONTROL DATA
602100200529     C*
602200200529     C                     MOVE 'D'       RECI
602300200529     C           RECI      CHAINSDBRTDD0             99
602400200529     C           *IN99     IFEQ '1'                        ***************
602500200529     C                     MOVEL'SDBRTDPD'DBFILE           * DB ERROR 21 *
602600200529     C                     MOVELRECI      DBKEY            ***************
602700200529     C                     Z-ADD21        DBASE
602800200529     C                     EXSR DBSR
602900200529     C                     GOTO ENDFST
603000200529     C                     END
603100200529     C                     END                             E001
603200200529     C*
603300200529     C/COPY WNCPYSRC,RE3765C019
603400200529     C                     Z-ADDTGINT0    TGINT0
603500200529     C                     Z-ADDWKBRT     WKBRT   75
603600200529     C                     Z-ADDBRTOT0    BRTOT0
603700200529     C                     Z-ADDBRTOT1    BRTOT1 151
603800200529     C/COPY WNCPYSRC,RE3765C031
603900200529     C*
604000200529     C                     EXSR CCYARR
604100200529      *                                                                   CFT004
604200200529      **  Access SAR details file to see if CFT004 is installed.          CFT004
604300200529      *                                                                   CFT004
604400200529     C                     CALL 'AOSARDR0'                                CFT004
604500200529     C                     PARM *BLANKS   PRTCD   7                       CFT004
604600200529     C                     PARM '*VERIFY' POPTN   7                       CFT004
604700200529     C                     PARM 'CFT004'  PSARD   6                       CFT004
604800200529     C           SCSARD    PARM SCSARD    DSSDY                           CFT004
604900200529     C*                                                                   CFT004
605000200529     C                     MOVE 'N'       CFT004                          CFT004
605100200529     C           PRTCD     IFEQ *BLANKS                                   CFT004
605200200529     C                     MOVE 'Y'       CFT004  1                       CFT004
605300200529     C                     ENDIF                                          CFT004
605400200529     C*
605500200529      ** Check if CER048 is enabled                                                           CER048
605600200529      *                                                                                       CER048
605700200529     C                     CALL 'AOSARDR0'                                                    CER048
605800200529     C                     PARM *BLANKS   PRTCD                                               CER048
605900200529     C                     PARM '*VERIFY' POPTN                                               CER048
606000200529     C                     PARM 'CER048'  PSARD                                               CER048
606100200529     C           SCSARD    PARM SCSARD    DSFDY                                               CER048
606200200529      *                                                                                       CER048
606300200529     C                     MOVE 'N'       CER048  1                                           CER048
606400200529      *                                                                                       CER048
606500200529     C           PRTCD     IFEQ *BLANKS                                                       CER048
606600200529      *                                                                                       CER048
606700200529     C                     MOVE 'Y'       CER048                                              CER048
606800200529     C                     ELSE                                                               CER048
606900200529     C           PRTCD     IFNE '*NRF'                                                        CER048
607000200529      *                                                                                       CER048
607100200529     C                     MOVE 'SCSARDPD'DBFILE                                              CER048
607200200529     C                     MOVE 'CER048'  DBKEY                                               CER048
607300200529     C                     MOVE 32        DBASE                                               CER048
607400200529     C                     EXSR DBSR                                                          CER048
607500200529     C                     GOTO ENDFST                                                        CER048
607600200529      *                                                                                       CER048
607700200529     C                     ENDIF                                                              CER048
607800200529      *                                                                                       CER048
607900200529     C                     ENDIF                                                              CER048
608000200529      *                                                                                       CER048
608100200529     C           ENDFST    TAG
608200200529     C*
608300200529      *                                                                                       CER016
608400200529      ** Access SAR Details File to determine if CER016 is installed                          CER016
608500200529      *                                                                                       CER016
608600200529     C                     CALL 'AOSARDR0'                                                    CER016
608700200529     C                     PARM *BLANKS   PRTCD                                               CER016
608800200529     C                     PARM '*VERIFY' POPTN                                               CER016
608900200529     C                     PARM 'CER016'  PSARD                                               CER016
609000200529     C           SCSARD    PARM SCSARD    DSSDY                                               CER016
609100200529      *                                                                                       CER016
609200200529      ** CER016 is installed                                                                  CER016
609300200529      *                                                                                       CER016
609400200529     C           PRTCD     IFEQ *BLANKS                                                       CER016
609500200529     C                     MOVE 'Y'       CER016  1                                           CER016
609600200529      *                                                                                       CER016
609700200529     C                     ELSE                                                               CER016
609800200529     C                     MOVE 'N'       CER016                                              CER016
609900200529     C                     ENDIF                                                              CER016
610000200529      *                                                                                       CER016
610100200529      ** Database error                                                                       CER016
610200200529      *                                                                                       CER016
610300200529     C           PRTCD     IFNE *BLANKS                                                       CER016
610400200529     C           PRTCD     ANDNE'*NRF   '                                                     CER016
610500200529      *                                                                                       CER016
610600200529     C           *LOCK     IN   LDA                                                           CER016
610700200529     C                     MOVEL'SCSARDPD'DBFILE                                              CER016
610800200529     C                     MOVEL'CER016'  DBKEY                                               CER016
610900200529     C                     Z-ADD032       DBASE                                               CER016
611000200529     C                     OUT  LDA                                                           CER016
611100200529     C                     EXSR *PSSR                                                         CER016
611200200529      *                                                                                       CER016
611300200529     C                     ENDIF                                                              CER016
611400200529      *                                                                                       CER016
611500200529      ** Check if CER050 is installed                                                         CER050
611600200529      *                                                                                       CER050
611700200529     C                     CALL 'AOSARDR0'                                                    CER050
611800200529     C                     PARM *BLANKS   @RTCD   7                                           CER050
611900200529     C                     PARM '*VERIFY' @OPTN                                               CER050
612000200529     C                     PARM 'CER050'  @SARD   6                                           CER050
612100200529      *                                                                                       CER050
612200200529     C           @RTCD     IFEQ *BLANK                                                        CER050
612300200529     C                     MOVE 'Y'       CER050  1                                           CER050
612400200529     C                     ELSE                                                               CER050
612500200529     C                     MOVE 'N'       CER050                                              CER050
612600200529     C                     ENDIF                                                              CER050
612700200529      *                                                                                       CER050
612800200529     C                     ENDSR                           **FIRST ENDSR**
612900200529     C********************************************************************
613000200529     C/EJECT
613100200529     C********************************************************************
613200200529     C**
613300200529     C** INITPR SUBROUTINE TO INITIALIZE ALL FIELDS TO BE PRINTED
613400200529     C**
613500200529     C**     Called by       DETPR
613600200529     C**     Calls           -
613700200529     C**
613800200529     C           INITPR    BEGSR                           **INITPR BEGSR**
613900200529     C*
614000200529     C                     MOVE *BLANKS   PSTDA
614100200529     C                     MOVE *BLANKS   VALDA
614200200529     C                     MOVE *BLANKS   NARR
614300200529     C                     MOVE *BLANKS   RNARR
614400200529     C                     MOVE *BLANKS   TNARR
614500200529     C                     MOVE *BLANKS   XNARR
614600200529     C                     MOVE *BLANKS   DNARR
614700200529     C                     MOVE *BLANKS   BNARR
614800200529     C                     MOVE *BLANKS   ONARR                                               253776
614900200529     C                     MOVE *BLANKS   QNARR                                               253776
615000200529     C                     MOVE *BLANKS   NARRD                                               253776
615100200529     C*
615200200529     C                     Z-ADD*ZEROS    PSTD0
615300200529     C                     Z-ADD*ZEROS    CHGR0                                               253776
615400200529     C                     Z-ADD*ZEROS    CHGN0                                               253776
615500200529     C                     Z-ADD*ZEROS    TCHR0                                               253776
615600200529     C                     Z-ADD*ZEROS    TCHN0                                               253776
615700200529     C                     Z-ADD*ZEROS    CHGP0                                               253776
615800200529     C                     Z-ADD*ZEROS    SNITMS                                              253776
615900200529     C                     Z-ADD*ZEROS    TNUMD                                               253776
616000200529     C                     Z-ADD*ZEROS    TNUMC                                               253776
616100200529     C                     Z-ADD*ZEROS    OODRL                                               253776
616200200529     C                     Z-ADD*ZEROS    OAODR                                               253776
616300200529     C                     Z-ADD*ZEROS    RATET                                               253776
616400200529     C                     Z-ADD*ZEROS    RATE
616500200529     C                     Z-ADD*ZEROS    DAYS
616600200529     C                     Z-ADD*ZEROS    NUMB0
616700200529     C                     Z-ADD*ZEROS    HISB0
616800200529     C                     Z-ADD*ZEROS    INT0
616900200529     C                     Z-ADD*ZEROS    TINT0
617000200529     C                     Z-ADD*ZEROS    ORAT1
617100200529     C                     Z-ADD*ZEROS    ORAT2
617200200529     C                     Z-ADD*ZEROS    ORAT3
617300200529     C                     Z-ADD*ZEROS    OBAL01
617400200529     C                     Z-ADD*ZEROS    OBAL02
617500200529     C                     Z-ADD*ZEROS    OBAL03
617600200529     C                     Z-ADD*ZEROS    WWTND  150
617700200529     C                     Z-ADD*ZEROS    WWTNC  150
617800200529     C                     Z-ADD*ZEROS    DDAID
617900200529     C                     Z-ADD*ZEROS    DCAID
618000200529     C*
618100200529     C                     Z-ADD*ZEROS    TOTPST 120
618200200529     C                     Z-ADD*ZEROS    TOTNPS 120
618300200529     C                     Z-ADD*ZEROS    TGINT0
618400200529     C                     Z-ADD*ZEROS    WKBRT
618500200529     C                     Z-ADD*ZEROS    BRTOT0
618600200529     C                     Z-ADD*ZEROS    BRTOT1
618700200529     C                     Z-ADD*ZEROS    EUTAX0                                              CGL031
618800200529     C                     Z-ADD*ZEROS    STAX0                                               CER048
618900200529     C/COPY WNCPYSRC,RE3765C032
619000200529     C*
619100200529     C                     ENDSR                           **INITPR ENDSR*
619200200529     C********************************************************************
619300200529     C/EJECT
619400200529     C********************************************************************
619500200529     C**
619600200529     C** MULTL MULTILANGUAGE SUBROUTINE
619700200529     C**
619800200529     C**     Called by       FIRST, MAIN
619900200529     C**     Calls           ZA1310
620000200529     C**
620100200529     C           MULTL     BEGSR                           **MULTL BEGSR**
620200200529     C                     EXSR CLMSG
620300200529     C                     MOVEL'RES0001' MSGID
620400200529     C                     CALL 'ZA1310'  ZA1311
620500200529     C                     MOVELMNARR     NAR,1
620600200529     C                     MOVEL*BLANKS   MNARR
620700200529     C*
620800200529     C                     EXSR CLMSG
620900200529     C                     MOVEL'RES0002' MSGID
621000200529     C                     CALL 'ZA1310'  ZA1311
621100200529     C                     MOVELMNARR     NAR,2
621200200529     C                     MOVEL*BLANKS   MNARR
621300200529     C*
621400200529     C                     EXSR CLMSG
621500200529     C                     MOVEL'RES0003' MSGID
621600200529     C                     CALL 'ZA1310'  ZA1311
621700200529     C                     MOVELMNARR     NAR,3
621800200529     C                     MOVEL*BLANKS   MNARR
621900200529     C*
622000200529     C                     EXSR CLMSG
622100200529     C                     MOVEL'RES0004' MSGID
622200200529     C                     CALL 'ZA1310'  ZA1311
622300200529     C                     MOVELMNARR     NAR,4
622400200529     C                     MOVEL*BLANKS   MNARR
622500200529     C*
622600200529     C                     EXSR CLMSG
622700200529     C                     MOVEL'RES0005' MSGID
622800200529     C                     CALL 'ZA1310'  ZA1311
622900200529     C                     MOVELMNARR     NAR,5
623000200529     C                     MOVEL*BLANKS   MNARR
623100200529     C*
623200200529     C                     EXSR CLMSG
623300200529     C                     MOVEL'RES0006' MSGID
623400200529     C                     CALL 'ZA1310'  ZA1311
623500200529     C                     MOVELMNARR     NAR,6
623600200529     C                     MOVEL*BLANKS   MNARR
623700200529     C*
623800200529     C                     EXSR CLMSG
623900200529     C                     MOVEL'RES0007' MSGID
624000200529     C                     CALL 'ZA1310'  ZA1311
624100200529     C                     MOVELMNARR     NAR,7
624200200529     C                     MOVEL*BLANKS   MNARR
624300200529     C*
624400200529     C                     EXSR CLMSG
624500200529     C                     MOVEL'RES0008' MSGID
624600200529     C                     CALL 'ZA1310'  ZA1311
624700200529     C                     MOVELMNARR     NAR,8
624800200529     C                     MOVEL*BLANKS   MNARR
624900200529     C*
625000200529     C                     EXSR CLMSG
625100200529     C                     MOVEL'RES0009' MSGID
625200200529     C                     CALL 'ZA1310'  ZA1311
625300200529     C                     MOVELMNARR     NAR,9
625400200529     C                     MOVEL*BLANKS   MNARR
625500200529     C*
625600200529     C                     EXSR CLMSG
625700200529     C                     MOVEL'RES0010' MSGID
625800200529     C                     CALL 'ZA1310'  ZA1311
625900200529     C                     MOVELMNARR     NAR,10
626000200529     C                     MOVEL*BLANKS   MNARR
626100200529     C*
626200200529     C                     EXSR CLMSG
626300200529     C                     MOVEL'RES0011' MSGID
626400200529     C                     CALL 'ZA1310'  ZA1311
626500200529     C                     MOVELMNARR     NAR,11
626600200529     C                     MOVEL*BLANKS   MNARR
626700200529     C*
626800200529     C                     EXSR CLMSG
626900200529     C                     MOVEL'RES0012' MSGID
627000200529     C                     CALL 'ZA1310'  ZA1311
627100200529     C                     MOVELMNARR     NAR,12
627200200529     C                     MOVEL*BLANKS   MNARR
627300200529     C*
627400200529     C                     EXSR CLMSG
627500200529     C                     MOVEL'RES0013' MSGID
627600200529     C                     CALL 'ZA1310'  ZA1311
627700200529     C                     MOVELMNARR     NAR,13
627800200529     C                     MOVEL*BLANKS   MNARR
627900200529     C*
628000200529     C                     EXSR CLMSG
628100200529     C                     MOVEL'RES0014' MSGID
628200200529     C                     CALL 'ZA1310'  ZA1311
628300200529     C                     MOVELMNARR     NAR,14
628400200529     C                     MOVEL*BLANKS   MNARR
628500200529     C*
628600200529     C                     EXSR CLMSG
628700200529     C                     MOVEL'RES0015' MSGID
628800200529     C                     CALL 'ZA1310'  ZA1311
628900200529     C                     MOVELMNARR     NAR,15
629000200529     C                     MOVEL*BLANKS   MNARR
629100200529     C*
629200200529     C                     EXSR CLMSG
629300200529     C                     MOVEL'RES0016' MSGID
629400200529     C                     CALL 'ZA1310'  ZA1311
629500200529     C                     MOVELMNARR     NAR,16
629600200529     C                     MOVEL*BLANKS   MNARR
629700200529     C*
629800200529     C                     EXSR CLMSG
629900200529     C                     MOVEL'RES0017' MSGID
630000200529     C                     CALL 'ZA1310'  ZA1311
630100200529     C                     MOVELMNARR     NAR,17
630200200529     C                     MOVEL*BLANKS   MNARR
630300200529     C*
630400200529     C                     EXSR CLMSG
630500200529     C                     MOVEL'RES0018' MSGID
630600200529     C                     CALL 'ZA1310'  ZA1311
630700200529     C                     MOVELMNARR     NAR,18
630800200529     C                     MOVEL*BLANKS   MNARR
630900200529     C*
631000200529     C                     EXSR CLMSG
631100200529     C                     MOVEL'RES0019' MSGID
631200200529     C                     CALL 'ZA1310'  ZA1311
631300200529     C                     MOVELMNARR     NAR,19
631400200529     C                     MOVEL*BLANKS   MNARR
631500200529     C*
631600200529     C                     EXSR CLMSG
631700200529     C                     MOVEL'RES0020' MSGID
631800200529     C                     CALL 'ZA1310'  ZA1311
631900200529     C                     MOVELMNARR     NAR,20
632000200529     C                     MOVEL*BLANKS   MNARR
632100200529     C*
632200200529     C                     EXSR CLMSG
632300200529     C                     MOVEL'RES0021' MSGID
632400200529     C                     CALL 'ZA1310'  ZA1311
632500200529     C                     MOVELMNARR     NAR,21
632600200529     C                     MOVEL*BLANKS   MNARR
632700200529     C*
632800200529     C                     EXSR CLMSG
632900200529     C                     MOVEL'RES0022' MSGID
633000200529     C                     CALL 'ZA1310'  ZA1311
633100200529     C                     MOVELMNARR     NAR,22
633200200529     C                     MOVEL*BLANKS   MNARR
633300200529     C*
633400200529     C                     EXSR CLMSG
633500200529     C                     MOVEL'RES0023' MSGID
633600200529     C                     CALL 'ZA1310'  ZA1311
633700200529     C                     MOVELMNARR     NAR,23
633800200529     C                     MOVEL*BLANKS   MNARR
633900200529     C*
634000200529     C                     EXSR CLMSG
634100200529     C                     MOVEL'RES0024' MSGID
634200200529     C                     CALL 'ZA1310'  ZA1311
634300200529     C                     MOVELMNARR     NAR,24
634400200529     C                     MOVEL*BLANKS   MNARR
634500200529     C*
634600200529     C                     EXSR CLMSG
634700200529     C                     MOVEL'RES0025' MSGID
634800200529     C                     CALL 'ZA1310'  ZA1311
634900200529     C                     MOVELMNARR     NAR,25
635000200529     C                     MOVEL*BLANKS   MNARR
635100200529     C*
635200200529     C                     EXSR CLMSG
635300200529     C                     MOVEL'RES0026' MSGID
635400200529     C                     CALL 'ZA1310'  ZA1311
635500200529     C                     MOVELMNARR     NAR,26
635600200529     C                     MOVEL*BLANKS   MNARR
635700200529     C*
635800200529     C                     EXSR CLMSG
635900200529     C                     MOVEL'RES0027' MSGID
636000200529     C                     CALL 'ZA1310'  ZA1311
636100200529     C                     MOVELMNARR     NAR,27
636200200529     C                     MOVEL*BLANKS   MNARR
636300200529     C*
636400200529     C                     EXSR CLMSG
636500200529     C                     MOVEL'RES0028' MSGID
636600200529     C                     CALL 'ZA1310'  ZA1311
636700200529     C                     MOVELMNARR     NAR,28
636800200529     C                     MOVEL*BLANKS   MNARR
636900200529     C*
637000200529     C                     EXSR CLMSG
637100200529     C                     MOVEL'RES0029' MSGID
637200200529     C                     CALL 'ZA1310'  ZA1311
637300200529     C                     MOVELMNARR     NAR,29
637400200529     C                     MOVEL*BLANKS   MNARR
637500200529     C*
637600200529     C                     EXSR CLMSG
637700200529     C                     MOVEL'RES0030' MSGID
637800200529     C                     CALL 'ZA1310'  ZA1311
637900200529     C                     MOVELMNARR     NAR,30
638000200529     C                     MOVEL*BLANKS   MNARR
638100200529     C*
638200200529     C                     EXSR CLMSG
638300200529     C                     MOVEL'RES0031' MSGID
638400200529     C                     CALL 'ZA1310'  ZA1311
638500200529     C                     MOVELMNARR     NAR,31
638600200529     C                     MOVEL*BLANKS   MNARR
638700200529     C*
638800200529     C                     EXSR CLMSG
638900200529     C                     MOVEL'RES0032' MSGID
639000200529     C                     CALL 'ZA1310'  ZA1311
639100200529     C                     MOVELMNARR     NAR,32
639200200529     C                     MOVEL*BLANKS   MNARR
639300200529     C*
639400200529     C* ADDITIONAL NARRATIVE FOR TURNOVER COMMISSION
639500200529     C*
639600200529     C                     EXSR CLMSG
639700200529     C                     MOVEL'RES0033' MSGID
639800200529     C                     CALL 'ZA1310'  ZA1311
639900200529     C                     MOVELMNARR     NAR,33
640000200529     C                     MOVEL*BLANKS   MNARR
640100200529     C*
640200200529     C                     EXSR CLMSG
640300200529     C                     MOVEL'RES0034' MSGID
640400200529     C                     CALL 'ZA1310'  ZA1311
640500200529     C                     MOVELMNARR     NAR,34
640600200529     C                     MOVEL*BLANKS   MNARR
640700200529      *                                                                   CRE001
640800200529      ** If CRE001 is switched ON                                         CRE001
640900200529      *                                                                   CRE001
641000200529     C           CRE001    IFEQ 'Y'                                       CRE001
641100200529      *                                                                   CRE001
641200200529     C                     EXSR CLMSG                                     CRE001
641300200529     C                     MOVEL'RES0034' MSGID                           CRE001
641400200529     C                     CALL 'ZA1310'  ZA1311                          CRE001
641500200529     C                     MOVELMNARR     NAR,35                          CRE001
641600200529     C                     MOVEL*BLANKS   MNARR                           CRE001
641700200529      *                                                                   CRE001
641800200529     C                     EXSR CLMSG                                     CRE001
641900200529     C                     MOVEL'RES0033' MSGID                           CRE001
642000200529     C                     CALL 'ZA1310'  ZA1311                          CRE001
642100200529     C                     MOVELMNARR     NAR,36                          CRE001
642200200529     C                     MOVEL*BLANKS   MNARR                           CRE001
642300200529      *                                                                   CRE001
642400200529     C                     EXSR CLMSG                                     CRE001
642500200529     C                     MOVEL'RES0037' MSGID                           CRE001
642600200529     C                     CALL 'ZA1310'  ZA1311                          CRE001
642700200529     C                     MOVELMNARR     NAR,37                          CRE001
642800200529     C                     MOVEL*BLANKS   MNARR                           CRE001
642900200529      *                                                                   CRE001
643000200529     C                     ENDIF                                          CRE001
643100200529     C/COPY WNCPYSRC,RE3765C006
643200200529     C*
643300200529     C                     ENDSR                           **MULTL ENDSR**
643400200529     C********************************************************************
643500200529     C/EJECT
643600200529     C********************************************************************
643700200529     C**
643800200529     C** ITYPCR subroutine for interest type greater than 2
643900200529     C**
644000200529     C**     Called by       CRSR, TOTSR
644100200529     C**
644200200529     C**     Calls           ZICD
644300200529     C**
644400200529     C           ITYPCR    BEGSR                           **ITYPCR BEGSR*
644500200529     C*
644600200529     C**  CHECK IF END OF MONTH OR RATE CHANGE CREDIT
644700200529     C*
644800200529     C           DRECI     IFEQ 'M'                        - B1
644900200529     C           CSDAT     ANDNE*ZEROS
645000200529     C*
645100200529     C                     Z-ADDWHISD     ZIBEG
645200200529     C                     Z-ADDMHISD     ZIEND
645300200529     C                     Z-ADDWCRCB     ZICALC
645400200529     C*
645500200529     C                     EXSR ZICD
645600200529     C*
645700200529     C                     Z-ADDZDAYN1    DAYS
645800200529     C           MNBL      MULT DAYS      NUMB0
645900200529     C*
646000200529     C           *IN80     IFEQ '1'                        - B2
646100200529     C*
646200200529     C                     ELSE                            - X2
646300200529     C           *IN81     IFEQ '1'                        - B3
646400200529     C           NUMB0     DIV  10        NUMB0
646500200529     C                     ELSE                            - X3
646600200529     C           *IN82     IFEQ '1'                        - B4
646700200529     C           NUMB0     DIV  100       NUMB0
646800200529     C                     ELSE                            - X4
646900200529     C           NUMB0     DIV  1000      NUMB0
647000200529     C                     END                             - E4
647100200529     C                     END                             - E3
647200200529     C                     END                             - E2
647300200529     C                     Z-SUBNUMB0     NUMB0
647400200529     C*
647500200529     C           MNBL      IFGT *ZEROS                     - B2
647600200529     C                     Z-SUBDINT      INT0
647700200529     C           NUMB0     IFLT *ZEROS
647800200529     C                     ADD  NUMB0     WWTND
647900200529     C                     ELSE
648000200529     C                     ADD  NUMB0     WWTNC
648100200529     C                     END
648200200529     C                     EXSR OVERDC
648300200529     C                     WRITESTOTDC
648400200529     C*
648500200529     C* CHARGE REPORT IF NECESSARY
648600200529     C*
648700200529     C           CCICI     IFNE *BLANK                     - B3
648800200529     C           DTHGAR    IFNE *ZERO                      - B4
648900200529     C           DTHGAN    ORNE *ZERO
649000200529     C                     Z-SUBDTHGAR    CHGR0
649100200529     C                     Z-SUBDTHGAN    CHGN0
649200200529     C                     WRITEPOSTCH
649300200529     C                     END                             - E4
649400200529     C                     END                             - E3
649500200529     C                     ELSE                            - X2
649600200529     C                     Z-ADDCINT      INT0
649700200529     C           NUMB0     IFLT *ZEROS
649800200529     C                     ADD  NUMB0     WWTND
649900200529     C                     ELSE
650000200529     C                     ADD  NUMB0     WWTNC
650100200529     C                     END
650200200529     C                     EXSR OVERDC
650300200529     C                     WRITESTOTDC
650400200529     C*
650500200529     C* CHARGE REPORT IF NECESSARY
650600200529     C*
650700200529     C           CCICI     IFNE *BLANK                     - B3
650800200529     C           DTHGAR    IFNE *ZERO                      - B4
650900200529     C           DTHGAN    ORNE *ZERO
651000200529     C                     Z-SUBDTHGAR    CHGR0
651100200529     C                     Z-SUBDTHGAN    CHGN0
651200200529     C                     WRITEPOSTCH
651300200529     C                     END                             - E4
651400200529     C                     END                             - E3
651500200529     C                     END                             - E2
651600200529     C*
651700200529     C                     Z-ADDMHISD     WHISD
651800200529     C                     Z-ADDMNBL      WMNBL
651900200529     C*
652000200529     C                     END                             - E1
652100200529     C*
652200200529     C           DRECI     DOWEQ'M'                        - B1
652300200529     C           *IN51     ANDEQ'0'
652400200529     C*
652500200529     C           KLIST1    READEREHISL                   51
652600200529     C*
652700200529     C           *IN51     IFNE '1'                        - B2
652800200529     C*
652900200529     C           DRECI     IFEQ 'M'                        - B3
653000200529     C           CSDAT     ANDNE*ZEROS
653100200529     C*
653200200529     C                     Z-ADDWHISD     ZIBEG
653300200529     C                     Z-ADDMHISD     ZIEND
653400200529     C                     Z-ADDWCRCB     ZICALC
653500200529     C*
653600200529     C                     EXSR ZICD
653700200529     C*
653800200529     C                     Z-ADDZDAYN1    DAYS
653900200529     C           MNBL      MULT DAYS      NUMB0
654000200529     C*
654100200529     C           *IN80     IFEQ '1'                        - B4
654200200529     C*
654300200529     C                     ELSE                            - X4
654400200529     C           *IN81     IFEQ '1'                        - B5
654500200529     C           NUMB0     DIV  10        NUMB0
654600200529     C                     ELSE                            - X5
654700200529     C           *IN82     IFEQ '1'                        - B6
654800200529     C           NUMB0     DIV  100       NUMB0
654900200529     C                     ELSE                            - X6
655000200529     C           NUMB0     DIV  1000      NUMB0
655100200529     C                     END                             - E6
655200200529     C                     END                             - E5
655300200529     C                     END                             - E4
655400200529     C                     Z-SUBNUMB0     NUMB0
655500200529     C*
655600200529     C           MNBL      IFGT *ZEROS                     - B4
655700200529     C                     Z-SUBDINT      INT0
655800200529     C           NUMB0     IFLT *ZEROS
655900200529     C                     ADD  NUMB0     WWTND
656000200529     C                     ELSE
656100200529     C                     ADD  NUMB0     WWTNC
656200200529     C                     END
656300200529     C                     EXSR OVERDC
656400200529     C                     WRITESTOTDC
656500200529     C*
656600200529     C* CHARGE REPORT IF NECESSARY
656700200529     C*
656800200529     C           CCICI     IFNE *BLANK                     - B5
656900200529     C           DTHGAR    IFNE *ZERO                      - B6
657000200529     C           DTHGAN    ORNE *ZERO
657100200529     C                     Z-SUBDTHGAR    CHGR0
657200200529     C                     Z-SUBDTHGAN    CHGN0
657300200529     C                     WRITEPOSTCH
657400200529     C                     END                             - E6
657500200529     C                     END                             - E5
657600200529     C                     ELSE                            - X4
657700200529     C                     Z-ADDCINT      INT0
657800200529     C           NUMB0     IFLT *ZEROS
657900200529     C                     ADD  NUMB0     WWTND
658000200529     C                     ELSE
658100200529     C                     ADD  NUMB0     WWTNC
658200200529     C                     END
658300200529     C                     EXSR OVERDC
658400200529     C                     WRITESTOTDC
658500200529     C*
658600200529     C* CHARGE REPORT IF NECESSARY
658700200529     C*
658800200529     C           CCICI     IFNE *BLANK                     - B5
658900200529     C           DTHGAR    IFNE *ZERO                      - B6
659000200529     C           DTHGAN    ORNE *ZERO
659100200529     C                     Z-SUBDTHGAR    CHGR0
659200200529     C                     Z-SUBDTHGAN    CHGN0
659300200529     C                     WRITEPOSTCH
659400200529     C                     END                             - E6
659500200529     C                     END                             - E5
659600200529     C                     END                             - E4
659700200529     C*
659800200529     C                     Z-ADDMHISD     WHISD
659900200529     C                     Z-ADDMNBL      WMNBL
660000200529     C*
660100200529     C                     ELSE                            - X3
660200200529     C*
660300200529     C           DRECI     IFEQ 'S'                        - B4
660400200529     C***********SCICI     ANDEQ'Y'                                      098818
660500200529     C           SCICI     ANDNE*BLANKS                                  098818
660600200529     C*
660700200529     C                     Z-ADDWHISD     ZIBEG
660800200529     C                     Z-ADDDHISD     ZIEND
660900200529     C                     Z-ADDWCRCB     ZICALC
661000200529     C*
661100200529     C                     EXSR ZICD
661200200529     C*
661300200529     C                     Z-ADDZDAYN1    DAYS
661400200529     C           SMNBL     MULT DAYS      NUMB0
661500200529     C*
661600200529     C           *IN80     IFEQ '1'                        - B5
661700200529     C*
661800200529     C                     ELSE                            - X5
661900200529     C           *IN81     IFEQ '1'                        - B6
662000200529     C           NUMB0     DIV  10        NUMB0
662100200529     C                     ELSE                            - X6
662200200529     C           *IN82     IFEQ '1'                        - B7
662300200529     C           NUMB0     DIV  100       NUMB0
662400200529     C                     ELSE                            - X7
662500200529     C           NUMB0     DIV  1000      NUMB0
662600200529     C                     END                             - E7
662700200529     C                     END                             - E6
662800200529     C                     END                             - E5
662900200529     C                     Z-SUBNUMB0     NUMB0
663000200529     C*
663100200529     C           SMNBL     IFGT *ZEROS                     - B5
663200200529     C                     Z-SUBDINT      INT0
663300200529     C                     ELSE                            - X5
663400200529     C                     Z-ADDCINT      INT0
663500200529     C           NUMB0     IFLT *ZEROS
663600200529     C                     ADD  NUMB0     WWTND
663700200529     C                     ELSE
663800200529     C                     ADD  NUMB0     WWTNC
663900200529     C                     END
664000200529     C                     EXSR OVERDC
664100200529     C                     WRITESTOTDC
664200200529     C*
664300200529     C* CHARGE REPORT IF NECESSARY
664400200529     C*
664500200529     C           CCICI     IFNE *BLANK                     - B6
664600200529     C           DTHGAR    IFNE *ZERO                      - B7
664700200529     C           DTHGAN    ORNE *ZERO
664800200529     C                     Z-SUBDTHGAR    CHGR0
664900200529     C                     Z-SUBDTHGAN    CHGN0
665000200529     C                     WRITEPOSTCH
665100200529     C                     END                             - E7
665200200529     C                     END                             - E6
665300200529     C                     END                             - E5
665400200529     C*
665500200529     C                     Z-ADDDHISD     WHISD
665600200529     C*
665700200529     C                     END                             - E4
665800200529     C*
665900200529     C                     END                             - E3
666000200529     C*
666100200529     C                     END                             - E2
666200200529     C*
666300200529     C                     END                             - E1
666400200529     C*
666500200529     C                     ENDSR                           **ITYPCR ENDSR*
666600200529     C********************************************************************
666700200529     C/EJECT
666800200529     C********************************************************************
666900200529     C**
667000200529     C** ITYPDR subroutine for interest type greater than 2
667100200529     C**
667200200529     C**     Called by       DRSR; TOTSR
667300200529     C**
667400200529     C**     Calls           ZICD
667500200529     C**
667600200529     C           ITYPDR    BEGSR                           **ITYPDR BEGSR*
667700200529     C*
667800200529     C**  CHECK IF END OF MONTH OR DEBIT RATE CHANGE
667900200529     C*
668000200529     C           DRECI     IFEQ 'M'                        - B1
668100200529     C           DSDAT     ANDNE*ZEROS
668200200529     C*
668300200529     C                     Z-ADDWHISD     ZIBEG
668400200529     C                     Z-ADDMHISD     ZIEND
668500200529     C                     Z-ADDWDRCB     ZICALC
668600200529     C*
668700200529     C                     EXSR ZICD
668800200529     C*
668900200529     C                     Z-ADDZDAYN1    DAYS
669000200529     C           MNBL      MULT DAYS      NUMB0
669100200529     C*
669200200529     C           *IN80     IFEQ '1'                        - B2
669300200529     C*
669400200529     C                     ELSE                            - X2
669500200529     C           *IN81     IFEQ '1'                        - B3
669600200529     C           NUMB0     DIV  10        NUMB0
669700200529     C                     ELSE                            - X3
669800200529     C           *IN82     IFEQ '1'                        - B4
669900200529     C           NUMB0     DIV  100       NUMB0
670000200529     C                     ELSE                            - X4
670100200529     C           NUMB0     DIV  1000      NUMB0
670200200529     C                     END                             - E4
670300200529     C                     END                             - E3
670400200529     C                     END                             - E2
670500200529     C                     Z-SUBNUMB0     NUMB0
670600200529     C*
670700200529     C           MNBL      IFGT *ZEROS                     - B2
670800200529     C                     Z-SUBDINT      INT0
670900200529     C                     ELSE                            - X2
671000200529     C                     Z-ADDCINT      INT0
671100200529     C           NUMB0     IFLT *ZEROS
671200200529     C                     ADD  NUMB0     WWTND
671300200529     C                     ELSE
671400200529     C                     ADD  NUMB0     WWTNC
671500200529     C                     END
671600200529     C                     EXSR OVERDC
671700200529     C                     WRITESTOTDC
671800200529     C*
671900200529     C* CHARGE REPORT IF NECESSARY
672000200529     C*
672100200529     C           CCICI     IFNE *BLANK                     - B3
672200200529     C           DTHGAR    IFNE *ZERO                      - B4
672300200529     C           DTHGAN    ORNE *ZERO
672400200529     C                     Z-SUBDTHGAR    CHGR0
672500200529     C                     Z-SUBDTHGAN    CHGN0
672600200529     C                     WRITEPOSTCH
672700200529     C                     END                             - E4
672800200529     C                     END                             - E3
672900200529     C                     END                             - E2
673000200529     C*
673100200529     C                     Z-ADDMHISD     WHISD
673200200529     C                     Z-ADDMNBL      WMNBL
673300200529     C*
673400200529     C                     END                             - E1
673500200529     C*
673600200529     C           DRECI     DOWEQ'M'                        - B1
673700200529     C           *IN51     ANDEQ'0'
673800200529     C*
673900200529     C           KLIST1    READEREHISL                   51
674000200529     C*
674100200529     C           *IN51     IFNE '1'                        - B2
674200200529     C*
674300200529     C           DRECI     IFEQ 'M'                        - B3
674400200529     C           DSDAT     ANDNE*ZEROS
674500200529     C*
674600200529     C                     Z-ADDWHISD     ZIBEG
674700200529     C                     Z-ADDMHISD     ZIEND
674800200529     C                     Z-ADDWDRCB     ZICALC
674900200529     C*
675000200529     C                     EXSR ZICD
675100200529     C*
675200200529     C                     Z-ADDZDAYN1    DAYS
675300200529     C           MNBL      MULT DAYS      NUMB0
675400200529     C*
675500200529     C           *IN80     IFEQ '1'                        - B4
675600200529     C*
675700200529     C                     ELSE                            - X4
675800200529     C           *IN81     IFEQ '1'                        - B5
675900200529     C           NUMB0     DIV  10        NUMB0
676000200529     C                     ELSE                            - X5
676100200529     C           *IN82     IFEQ '1'                        - B6
676200200529     C           NUMB0     DIV  100       NUMB0
676300200529     C                     ELSE                            - X6
676400200529     C           NUMB0     DIV  1000      NUMB0
676500200529     C                     END                             - E6
676600200529     C                     END                             - E5
676700200529     C                     END                             - E4
676800200529     C                     Z-SUBNUMB0     NUMB0
676900200529     C*
677000200529     C           MNBL      IFGT *ZEROS                     - B4
677100200529     C                     Z-SUBDINT      INT0
677200200529     C           NUMB0     IFLT *ZEROS
677300200529     C                     ADD  NUMB0     WWTND
677400200529     C                     ELSE
677500200529     C                     ADD  NUMB0     WWTNC
677600200529     C                     END
677700200529     C                     EXSR OVERDC
677800200529     C                     WRITESTOTDC
677900200529     C*
678000200529     C* CHARGE REPORT IF NECESSARY
678100200529     C*
678200200529     C           CCICI     IFNE *BLANK                     - B5
678300200529     C           DTHGAR    IFNE *ZERO                      - B6
678400200529     C           DTHGAN    ORNE *ZERO
678500200529     C                     Z-SUBDTHGAR    CHGR0
678600200529     C                     Z-SUBDTHGAN    CHGN0
678700200529     C                     WRITEPOSTCH
678800200529     C                     END                             - E6
678900200529     C                     END                             - E5
679000200529     C                     ELSE                            - X4
679100200529     C                     Z-ADDCINT      INT0
679200200529     C           NUMB0     IFLT *ZEROS
679300200529     C                     ADD  NUMB0     WWTND
679400200529     C                     ELSE
679500200529     C                     ADD  NUMB0     WWTNC
679600200529     C                     END
679700200529     C                     EXSR OVERDC
679800200529     C                     WRITESTOTDC
679900200529     C*
680000200529     C* CHARGE REPORT IF NECESSARY
680100200529     C*
680200200529     C           CCICI     IFNE *BLANK                     - B5
680300200529     C           DTHGAR    IFNE *ZERO                      - B6
680400200529     C           DTHGAN    ORNE *ZERO
680500200529     C                     Z-SUBDTHGAR    CHGR0
680600200529     C                     Z-SUBDTHGAN    CHGN0
680700200529     C                     WRITEPOSTCH
680800200529     C                     END                             - E6
680900200529     C                     END                             - E5
681000200529     C                     END                             - E4
681100200529     C*
681200200529     C                     Z-ADDMHISD     WHISD
681300200529     C                     Z-ADDMNBL      WMNBL
681400200529     C*
681500200529     C                     ELSE                            - X3
681600200529     C*
681700200529     C           DRECI     IFEQ 'S'                        - B4
681800200529     C***********SDICI     ANDEQ'Y'                                      098818
681900200529     C           SDICI     ANDNE*BLANKS                                  098818
682000200529     C*
682100200529     C                     Z-ADDWHISD     ZIBEG
682200200529     C                     Z-ADDDHISD     ZIEND
682300200529     C                     Z-ADDWDRCB     ZICALC
682400200529     C*
682500200529     C                     EXSR ZICD
682600200529     C*
682700200529     C                     Z-ADDZDAYN1    DAYS
682800200529     C           SMNBL     MULT DAYS      NUMB0
682900200529     C*
683000200529     C           *IN80     IFEQ '1'                        - B5
683100200529     C*
683200200529     C                     ELSE                            - X5
683300200529     C           *IN81     IFEQ '1'                        - B6
683400200529     C           NUMB0     DIV  10        NUMB0
683500200529     C                     ELSE                            - X6
683600200529     C           *IN82     IFEQ '1'                        - B7
683700200529     C           NUMB0     DIV  100       NUMB0
683800200529     C                     ELSE                            - X7
683900200529     C           NUMB0     DIV  1000      NUMB0
684000200529     C                     END                             - E7
684100200529     C                     END                             - E6
684200200529     C                     END                             - E5
684300200529     C                     Z-SUBNUMB0     NUMB0
684400200529     C*
684500200529     C           SMNBL     IFGT *ZEROS                     - B5
684600200529     C                     Z-SUBDINT      INT0
684700200529     C           NUMB0     IFLT *ZEROS
684800200529     C                     ADD  NUMB0     WWTND
684900200529     C                     ELSE
685000200529     C                     ADD  NUMB0     WWTNC
685100200529     C                     END
685200200529     C                     EXSR OVERDC
685300200529     C                     WRITESTOTDC
685400200529     C*
685500200529     C* CHARGE REPORT IF NECESSARY
685600200529     C*
685700200529     C           CCICI     IFNE *BLANK                     - B6
685800200529     C           DTHGAR    IFNE *ZERO                      - B7
685900200529     C           DTHGAN    ORNE *ZERO
686000200529     C                     Z-SUBDTHGAR    CHGR0
686100200529     C                     Z-SUBDTHGAN    CHGN0
686200200529     C                     WRITEPOSTCH
686300200529     C                     END                             - E7
686400200529     C                     END                             - E6
686500200529     C                     ELSE                            - X5
686600200529     C                     Z-ADDCINT      INT0
686700200529     C           NUMB0     IFLT *ZEROS
686800200529     C                     ADD  NUMB0     WWTND
686900200529     C                     ELSE
687000200529     C                     ADD  NUMB0     WWTNC
687100200529     C                     END
687200200529     C                     EXSR OVERDC
687300200529     C                     WRITESTOTDC
687400200529     C*
687500200529     C* CHARGE REPORT IF NECESSARY
687600200529     C*
687700200529     C           CCICI     IFNE *BLANK                     - B6
687800200529     C           DTHGAR    IFNE *ZERO                      - B7
687900200529     C           DTHGAN    ORNE *ZERO
688000200529     C                     Z-SUBDTHGAR    CHGR0
688100200529     C                     Z-SUBDTHGAN    CHGN0
688200200529     C                     WRITEPOSTCH
688300200529     C                     END                             - E7
688400200529     C                     END                             - E6
688500200529     C                     END                             - E5
688600200529     C*
688700200529     C                     Z-ADDDHISD     WHISD
688800200529     C*
688900200529     C                     END                             - E4
689000200529     C*
689100200529     C                     END                             - E3
689200200529     C*
689300200529     C                     END                             - E2
689400200529     C*
689500200529     C                     END                             - E1
689600200529     C*
689700200529     C                     ENDSR                           **ITYPDR ENDSR*
689800200529     C********************************************************************
689900200529     C/EJECT
690000200529     C********************************************************************
690100200529     C**
690200200529     C** MAIN subroutine to execute main processing.
690300200529     C**
690400200529     C**     Called by       S T A R T
690500200529     C**
690600200529     C**     Calls           DETPR
690700200529     C**
690800200529     C           MAIN      BEGSR                           **MAIN BEGSR**
690900200529     C*
691000200529     C           *INLR     IFEQ '1'
691100200529     C                     GOTO END
691200200529     C                     END
691300200529     C*
691400200529     C** ACCESS RECAPM SEQUENTIALY
691500200529     C*
691600200529     C                     READ RECAPML                  LR
691700200529     C*
691800200529     C**  Call ZSFILE for initial OPEN
691900200529     C*
692000200529     C           *INLR     IFNE '1'
692100200529     C                     SETON                     85
692200200529     C                     OPEN RE3765HC
692300200529     C                     Z-ADDSFNUM     ZSNUM
692400200529     C                     OUT  LDA
692500200529     C                     CALL 'ZSFILE'
692600200529     C                     PARM           SEQ
692700200529     C                     PARM CBRCA     SENTY
692800200529     C                     PARM           SFILE
692900200529     C                     PARM           ZSNUM   60
693000200529     C                     PARM           ZSERR   1
693100200529     C           *LOCK     IN   LDA
693200200529     C*
693300200529     C           ZSERR     IFEQ 'Y'
693400200529     C** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM
693500200529     C** DBASE, DBFILE AND DBKEY SET WITHIN ZSFILE
693600200529     C                     MOVEA'1'       *IN,89
693700200529     C                     EXSR DBSR
693800200529     C                     RETRN
693900200529     C                     END
694000200529     C*
694100200529     C                     OPEN RE3765DC
694200200529     C                     Z-ADDSFNUM1    ZSNUM1
694300200529     C                     OUT  LDA
694400200529     C                     CALL 'ZSFILE'
694500200529     C                     PARM           SEQ
694600200529     C                     PARM CBRCA     SENTY
694700200529     C                     PARM           SFILE1
694800200529     C                     PARM           ZSNUM1  60
694900200529     C                     PARM           ZSERR   1
695000200529     C           *LOCK     IN   LDA
695100200529     C*
695200200529     C           ZSERR     IFEQ 'Y'
695300200529     C** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM
695400200529     C** DBASE, DBFILE AND DBKEY SET WITHIN ZSFILE
695500200529     C                     MOVEA'1'       *IN,89
695600200529     C                     EXSR DBSR
695700200529     C                     RETRN
695800200529     C                     END
695900200529     C*
696000200529     C                     END
696100200529     C**
696200200529     C*
696300200529     C**  SAVE KEY TO CHECK BREAK
696400200529     C*
696500200529     C                     MOVE RKEY      OKEY
696600200529     C*
696700200529     C**  EXECUTE UNTIL EOF RECAPM
696800200529     C*
696900200529     C           *INLR     DOWEQ'0'                        - B1
697000200529     C/COPY WNCPYSRC,RE3765C023
697100200529     C*
697200200529     C**  TEST FOR MULTIBRANCH OUTPUT
697300200529     C*
697400200529     C           OBRCA     IFNE CBRCA
697500200529     C                     CLOSERE3765DC
697600200529     C                     CLOSERE3765HC
697700200529     C                     SETON                     85
697800200529     C                     OPEN RE3765DC
697900200529     C                     Z-ADDSFNUM     ZSNUM
698000200529     C                     OUT  LDA
698100200529     C                     CALL 'ZSFILE'
698200200529     C                     PARM           SEQ
698300200529     C                     PARM CBRCA     SENTY
698400200529     C                     PARM           SFILE
698500200529     C                     PARM           ZSNUM   60
698600200529     C                     PARM           ZSERR   1
698700200529     C           *LOCK     IN   LDA
698800200529     C*
698900200529     C           ZSERR     IFEQ 'Y'
699000200529     C** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM
699100200529     C** DBASE, DBFILE AND DBKEY SET WITHIN ZSFILE
699200200529     C                     MOVEA'1'       *IN,89
699300200529     C                     EXSR DBSR
699400200529     C                     RETRN
699500200529     C                     END
699600200529     C*
699700200529     C                     OPEN RE3765HC
699800200529     C                     Z-ADDSFNUM1    ZSNUM1
699900200529     C                     OUT  LDA
700000200529     C                     CALL 'ZSFILE'
700100200529     C                     PARM           SEQ
700200200529     C                     PARM CBRCA     SENTY
700300200529     C                     PARM           SFILE1
700400200529     C                     PARM           ZSNUM1  60
700500200529     C                     PARM           ZSERR   1
700600200529     C           *LOCK     IN   LDA
700700200529     C*
700800200529     C           ZSERR     IFEQ 'Y'
700900200529     C** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM
701000200529     C** DBASE, DBFILE AND DBKEY SET WITHIN ZSFILE
701100200529     C                     MOVEA'1'       *IN,89
701200200529     C                     EXSR DBSR
701300200529     C                     RETRN
701400200529     C                     END
701500200529     C**
701600200529     C*    ACCESS BRANCH DETAILS
701700200529     C**
701800200529     C** GET BRANCH NAME, ONLY WHEN MBIN = 'Y'
701900200529     C**
702000200529     C           MBIN      IFEQ 'Y'
702100200529     C*
702200200529     C**********           CALL 'AOBRCHR0'                                                    CGL029
702300200529     C                     CALL 'AOBRCHR1'                                                    CGL029
702400200529     C                     PARM '*MSG   ' @RTCD   7
702500200529     C                     PARM '*KEY   ' @OPTN   7
702600200529     C                     PARM CBRCA     @DSNB   3
702700200529     C**********           PARM           SDBRCH                                              CGL029
702800200529     C                     PARM           DSSDY                                               CGL035
702900200529     C           @RTCD     IFNE *BLANKS
703000200529     C                     MOVEL@DSNB     DBKEY
703100200529     C                     MOVEL'SDBRCHPD'DBFILE           ***************
703200200529     C                     Z-ADD22        DBASE            **DB ERROR 22**
703300200529     C                     EXSR DBSR                       ***************
703400200529     C                     EXSR *PSSR
703500200529     C                     END
703600200529     C*
703700200529     C                     END
703800200529     C*
703900200529     C   U8                GOTO END
704000200529     C                     END
704100200529     C*
704200200529     C                     EXSR PRNO
704300200529     C           PRYES     IFEQ 'Y'                        - B2
704400200529     C*
704500200529     C**  CHECK IF IT IS THE SAME ACCOUNT
704600200529     C*
704700200529     C           RKEY      IFNE OKEY                       - B3
704800200529     C                     Z-ADD1         PAGH
704900200529     C                     Z-ADD1         PAGF
705000200529     C                     MOVE RKEY      OKEY
705100200529     C*****************************************************************
705200200529     C** Multilanguage processing is currently not in use.
705300200529     C** Codings are asterisked but retained for future use.
705400200529     C*
705500200529     C** PROCESS FOR MULTILANGUAGE
705600200529     C*
705700200529     C***********LGID      IFEQ *BLANKS                    - B4
705800200529     C***********LGID      OREQ '00'
705900200529     C***********LGID      OREQ *LOVAL
706000200529     C***********          MOVE DLGID     LGID             - E4
706100200529     C***********          END                             - E4
706200200529     C*                                                    - B4
706300200529     C***********LGID      IFNE OLGID                      - B4
706400200529     C*
706500200529     C*
706600200529     C**  DEFINE MESSAGE FILE
706700200529     C*
706800200529     C                     MOVE CMD,1     CMD1
706900200529     C***********          MOVELOLGID     FILT1
707000200529     C***********          MOVELLGID      FILT2
707100200529     C***********          CALL 'QCMDEXC' CMD1
707200200529     C***********          PARM           MSGLEN
707300200529     C*
707400200529     C***********          MOVE LGID      OLGID
707500200529     C***********          EXSR MULTL
707600200529     C*
707700200529     C***********          END                             - E4
707800200529     C*****************************************************************
707900200529     C*
708000200529     C                     END                             - E3
708100200529     C*
708200200529     C/COPY WNCPYSRC,RE3765C034
708300200529     C                     EXSR INITPR                                                        253776
708400200529     C                     EXSR DETPR
708500200529     C                     SETOF                     U7U8
708600200529     C*
708700200529     C** NUMBER OF PROCESSED RECORDS
708800200529     C*
708900200529     C                     ADD  1         NBRREC
709000200529     C/COPY WNCPYSRC,RE3765C035
709100200529     C*
709200200529     C                     END                             - E2
709300200529     C*
709400200529     C* RESET OVERFLOW INDICATOR AT CHANGE OF ACCOUNT
709500200529     C*
709600200529     C                     MOVEA'00'      *IN,73
709700200529     C                     MOVE '0'       *IN51
709800200529     C                     Z-ADD*ZEROS    WDAID
709900200529     C                     Z-ADD*ZEROS    WCAID
710000200529     C                     READ RECAPML                  LR
710100200529     C                     END                             - E1
710200200529     C*
710300200529     C           END       TAG
710400200529     C                     ENDSR                           **MAIN ENDSR**
710500200529     C********************************************************************
710600200529     C/EJECT
710700200529     C********************************************************************
710800200529     C**
710900200529     C** PRNO   subroutine TO DECIDE IF RECORD TO PRINT OR NO
711000200529     C**
711100200529     C**
711200200529     C**     Called by       START
711300200529     C**
711400200529     C**     Calls           -
711500200529     C**
711600200529     C           PRNO      BEGSR                           **PRNO   BEGSR*
711700200529     C*
711800200529     C                     MOVE 'N'       PRYES
711900200529     C                     MOVE '0'       *IN70
712000200529     C*
712100200529     C*  FOR MANAGEMENT OR DEMAND PRINT
712200200529     C*
712300200529     C           CDICI     IFEQ 'M'                        - B1
712400200529     C           CCICI     OREQ 'M'
712500200529     C           CDICI     OREQ 'D'
712600200529     C           CCICI     OREQ 'D'
712700200529     C                     MOVE 'Y'       PRYES   1
712800200529     C                     END                             - E1
712900200529     C           CDICI     IFEQ 'M'                        - B1
713000200529     C           CCICI     OREQ 'M'
713100200529     C                     MOVE '1'       *IN70
713200200529     C/COPY WNCPYSRC,RE3765C015
713300200529     C                     END                             - E1
713400200529     C*
713500200529     C** ACCESS RECOM ONLY IF ONE COMMISSION IS ON
713600200529     C*
713700200529     C           *IN67     IFEQ '1'
713800200529     C*
713900200529     C*  ACCESS RECOM FOR COMMISSION DETAILS
714000200529     C*
714100200529     C           KLIST0    CHAINRECOM                99
714200200529     C           *IN99     IFEQ '1'                        - B1***********
714300200529     C                     Z-ADD23        DBASE            **DB ERROR 23**
714400200529     C                     MOVE 'RECOM  ' DBFILE           ***************
714500200529     C                     MOVELRKEY      DBKEY
714600200529     C                     EXSR DBSR
714700200529     C                     END                             - E1
714800200529     C           CDICI     IFEQ 'C'                        - B1
714900200529     C           CDICI     OREQ ' '
715000200529     C                     Z-ADD*ZERO     FXDC
715100200529     C                     END                             - E1
715200200529     C           CDICA     SUB  CCDIC     CDICA
715300200529     C           ACCC      SUB  CACCC     ACCC
715400200529     C           CHDBC     SUB  CCHDBC    CHDBC
715500200529     C           CMBC      SUB  CCMBC     CMBC
715600200529     C*
715700200529     C                     END
715800200529     C*
715900200529     C*  IF CAPITALISATION OCCURS AT LEAST ONE AMOUNT MUST BE DIFFERENT
716000200529     C*  OF ZERO TO BE PRINTED.
716100200529     C*
716200200529     C           CDICI     IFNE ' '                        - B1
716300200529     C           CDAIC     IFNE *ZERO                      - B2
716400200529     C           CPMADI    ORNE *ZERO
716500200529     C           CTMADI    ORNE *ZERO
716600200529     C           CDMINT    ORNE *ZERO
716700200529     C           CSGADI    ORNE *ZERO
716800200529     C           FXDC      ORNE *ZERO
716900200529     C           ACCC      ORNE *ZERO
717000200529     C           CHDBC     ORNE *ZERO
717100200529     C           CMBC      ORNE *ZERO
717200200529     C           CDICA     ORNE *ZERO
717300200529     C                     MOVE 'Y'       PRYES   1
717400200529     C                     END                             - E2
717500200529     C                     END                             - E1
717600200529     C*
717700200529     C           CCICI     IFNE ' '                        - B1
717800200529     C           CCAIC     IFNE *ZERO                      - B2
717900200529     C           CPMACI    ORNE *ZERO
718000200529     C           CTMACI    ORNE *ZERO
718100200529     C           CCMINT    ORNE *ZERO
718200200529     C           CSGACI    ORNE *ZERO
718300200529     C           CCHGP     ORNE *ZERO
718400200529     C                     MOVE 'Y'       PRYES   1
718500200529     C                     END                             - E2
718600200529     C                     END                             - E1
718700200529     C*
718800200529     C** ALWAYS PRINTED
718900200529     C*
719000200529     C                     MOVE 'Y'       PRYES   1
719100200529     C                     ENDSR                           **NOPR   ENDSR*
719200200529     C********************************************************************
719300200529     C/EJECT
719400200529     C********************************************************************
719500200529     C**
719600200529     C** OPENCR subroutine for credit output - opening balance and
719700200529     C**                                       opening rate
719800200529     C**
719900200529     C**     Called by       B1LT, B1GT
720000200529     C**
720100200529     C**     Calls           DBSR
720200200529     C**
720300200529     C           OPENCR    BEGSR                           **OPENCR BEGSR*
720400200529     C*
720500200529     C                     Z-SUBW2STBL    HISB0
720600200529     C*
720700200529     C                     EXSR CLMSG
720800200529     C                     MOVELNAR,15    TNARR
720900200529     C*
721000200529     C           PVALD     IFNE CLCID                      - B1
721100200529     C                     Z-ADDCLCID     ZDAYNO
721200200529     C                     EXSR ZDATE2
721300200529     C                     MOVE ZDATE     VALDO
721400200529     C                     Z-ADDCLCID     PVALD
721500200529     C                     END                             - E1
721600200529     C*
721700200529     C                     MOVE VALDO     VALDA
721800200529     C*
721900200529     C**  OUTPUT OPENING BALANCE
722000200529     C*
722100200529     C                     EXSR OVERDC
722200200529     C                     WRITETITLEDC
722300200529     C*
722400200529     C                     MOVE *BLANKS   VALDA
722500200529     C                     MOVE *BLANKS   PSTDA
722600200529     C*
722700200529     C                     EXSR CLMSG
722800200529     C                     MOVELNAR,8     RNARR
722900200529     C*
723000200529     C                     Z-ADDCRIR      RATE
723100200529     C*
723200200529     C**  OUTPUT OPENING RATE
723300200529     C*
723400200529     C                     EXSR OVERDC
723500200529     C                     WRITERATEDC
723600200529     C*
723700200529      ***If*CRE001*is*switched*ON,*then*output*'Overdraft Limit'** CRE001 180892
723800200529      **********                                                   CRE001 180892
723900200529     C********** CRE001    IFEQ 'Y'                                CRE001 180892
724000200529     C**********           EXSR CLMSG                              CRE001 180892
724100200529     C**********           MOVELNAR,36    ONARR                    CRE001 180892
724200200529     C**********           MOVE ODRL      OODRL                    CRE001 180892
724300200529     C**********           EXSR OVERDC                             CRE001 180892
724400200529     C**********           WRITEODLNDC                             CRE001 180892
724500200529     C**********           ENDIF                                   CRE001 180892
724600200529      **********                                                   CRE001 180892
724700200529     C                     ENDSR                           **OPENCR ENDSR*
724800200529     C********************************************************************
724900200529     C/EJECT
725000200529     C********************************************************************
725100200529     C**
725200200529     C** OPENDR subroutine for debit output - opening balance and
725300200529     C**                                      opening rate
725400200529     C**
725500200529     C**     Called by       B1LT, B1GT
725600200529     C**
725700200529     C**     Calls           DBSR
725800200529     C**
725900200529     C           OPENDR    BEGSR                           **OPENDR BEGSR*
726000200529     C*
726100200529     C                     Z-SUBW1STBL    HISB0
726200200529     C*
726300200529     C                     EXSR CLMSG
726400200529     C                     MOVELNAR,16    TNARR
726500200529     C*
726600200529     C           PVALD     IFNE CLDID                      - B1
726700200529     C                     Z-ADDCLDID     ZDAYNO
726800200529     C                     EXSR ZDATE2
726900200529     C                     MOVE ZDATE     VALDO
727000200529     C                     Z-ADDCLDID     PVALD
727100200529     C                     END                             - E1
727200200529     C*
727300200529     C                     MOVE VALDO     VALDA
727400200529     C*
727500200529     C**  OUTPUT OPENING BALANCE
727600200529     C*
727700200529     C                     EXSR OVERDC
727800200529     C                     WRITETITLEDC
727900200529     C*
728000200529     C                     MOVE *BLANKS   VALDA
728100200529     C                     MOVE *BLANKS   PSTDA
728200200529     C*
728300200529     C                     EXSR CLMSG
728400200529     C                     MOVELNAR,3     RNARR
728500200529     C*
728600200529     C                     Z-ADDDRIR      RATE
728700200529     C*
728800200529     C**  OUTPUT OPENING RATE
728900200529     C*
729000200529     C                     EXSR OVERDC
729100200529     C                     WRITERATEDC
729200200529     C*
729300200529      ** If CRE001 is switched ON, then output 'Overdraft Limit'          180892
729400200529      *                                                                   180892
729500200529     C           CRE001    IFEQ 'Y'                                       180892
729600200529     C                     EXSR CLMSG                                     180892
729700200529     C                     MOVELNAR,28    ONARR                           180892
729800200529     C                     MOVE ODRL      OODRL                           180892
729900200529     C                     EXSR OVERDC                                    180892
730000200529     C                     WRITEODLNDC                                    180892
730100200529     C                     ENDIF                                          180892
730200200529      *                                                                   180892
730300200529     C                     ENDSR                           **OPENDR ENDSR*
730400200529     C********************************************************************
730500200529     C/EJECT
730600200529     C********************************************************************
730700200529     C**
730800200529     C** OVERDC subroutine for processing overflow on RE3764DC
730900200529     C**
731000200529     C**     Called by       CRSR, DRSR, POSTSR
731100200529     C**
731200200529     C**     Calls           -
731300200529     C**
731400200529     C           OVERDC    BEGSR                           **OVERDC BEGSR*
731500200529     C/COPY WNCPYSRC,RE3765C017
731600200529     C*
731700200529     C**  CHECK IF OVERFLOW ON RE3764DC
731800200529     C*
731900200529     C           *IN73     IFEQ '1'                        - B1
732000200529     C                     ADD  1         PAGF
732100200529     C                     MOVE WACNO     ACNO
732200200529     C                     MOVE '0'       *IN65
732300200529     C           ACNO      IFNE *ZEROS
732400200529     C                     MOVE '1'       *IN65
732500200529     C                     END
732600200529     C                     WRITEHEADDC
732700200529     C                     MOVE '0'       *IN73
732800200529     C                     END                             - E1
732900200529     C*
733000200529     C* CHARGE REPORT IF NECESSARY
733100200529     C*
733200200529     C           *IN74     IFEQ '1'                        - B1
733300200529     C           CCICI     IFNE *BLANK                     - B2
733400200529     C           CCHGP     ANDNE*ZERO
733500200529     C                     ADD  1         PAGH
733600200529     C                     WRITEHEADCH
733700200529     C                     MOVE '0'       *IN74
733800200529     C                     END                             - E2
733900200529     C                     END                             - E1
734000200529     C*
734100200529     C                     ENDSR                           **OVERDC ENDSR*
734200200529     C********************************************************************
734300200529     C/EJECT
734400200529     C********************************************************************
734500200529     C**
734600200529     C** POSTSR subroutine for posting output
734700200529     C**
734800200529     C**     Called by       BOTHSR, B1EQ, B1LT, B1GT
734900200529     C**
735000200529     C**     Calls           DBSR, OVERDC
735100200529     C**
735200200529     C           POSTSR    BEGSR                           **POSTSR BEGSR*
735300200529     C*
735400200529     C           PPSTD     IFNE PSTD                       - B1
735500200529     C                     Z-ADDPSTD      ZDAYNO
735600200529     C                     EXSR ZDATE2
735700200529     C                     MOVE ZDATE     PSTDO
735800200529     C                     Z-ADDPSTD      PPSTD
735900200529     C                     END                             - E1
736000200529     C*
736100200529     C                     MOVE PSTDO     PSTDA
736200200529     C*
736300200529     C           PVALD     IFNE HISD                       - B1
736400200529     C                     Z-ADDHISD      ZDAYNO
736500200529     C                     EXSR ZDATE2
736600200529     C                     MOVE ZDATE     VALDO
736700200529     C                     Z-ADDHISD      PVALD
736800200529     C                     END                             - E1
736900200529     C*
737000200529     C                     MOVE VALDO     VALDA
737100200529     C*
737200200529     C                     MOVELPNAR      NARR
737300200529     C*
737400200529     C           DRCR      IFEQ 0                          - B1
737500200529     C                     Z-SUBPSTA      PSTD0
737600200529     C*
737700200529     C** CHECK IF TURNOVER OR NOT
737800200529     C*
737900200529     C           TURN      IFNE 'Y'                        - B2
738000200529     C                     MOVE '1'       *IN33
738100200529     C                     ADD  PSTA      TOTNPS
738200200529     C                     ELSE                            - X2
738300200529     C                     ADD  PSTA      TOTPST
738400200529     C                     END                             - E2
738500200529     C                     ELSE                            - X1
738600200529     C                     Z-ADDPSTA      PSTD0
738700200529     C                     END                             - E1
738800200529     C*
738900200529     C**  OUTPUT POSTING FOR DEBIT AND CREDIT
739000200529     C*
739100200529     C                     EXSR OVERDC
739200200529     C                     WRITEPOSTDC
739300200529     C*
739400200529     C                     MOVE '0'       *IN33
739500200529     C*
739600200529     C* CHARGE REPORT IF NECESSARY
739700200529     C*
739800200529     C           CCICI     IFNE *BLANK                     - B1
739900200529     C           CHGA      ANDNE*ZERO
740000200529     C           REBI      IFEQ 'Y'                        - B2
740100200529     C                     Z-SUBCHGA      CHGR0
740200200529     C                     Z-SUB*ZERO     CHGN0
740300200529     C                     ELSE                            - X2
740400200529     C                     Z-SUBCHGA      CHGN0
740500200529     C                     Z-SUB*ZERO     CHGR0
740600200529     C                     END                             - E2
740700200529     C                     WRITEPOSTCH
740800200529     C                     END                             - E1
740900200529     C*
741000200529     C                     ENDSR                           **POSTSR ENDSR*
741100200529     C********************************************************************
741200200529     C/EJECT
741300200529     C********************************************************************
741400200529     C**
741500200529     C** RATEC subroutine to prepare and output credit rate change
741600200529     C**
741700200529     C**     Called by       CRSR, RATESR
741800200529     C**
741900200529     C**     Calls           DBSR, RCRSR
742000200529     C**
742100200529     C           RATEC     BEGSR                           **RATEC BEGSR**
742200200529     C*
742300200529     C**  ACCESS REHRCJ (REHPOSR1 REHPOSR2 REHPOSR3) WHICH CONTAINS
742400200529     C**  THE GOOD DATES FOR CREDIT RATE CHANGE TO
742500200529     C*
742600200529     C           KLIST6    CHAINREHRCJ               60
742700200529     C*
742800200529     C           *IN60     IFEQ '1'                        - B1
742900200529     C                     Z-ADDDCRCD     WDATE
743000200529     C                     Z-ADD24        DBASE
743100200529     C                     MOVE 'REHRCJ'  DBFILE           ***************
743200200529     C                     MOVELRKEY2     DBKEY            **DB ERROR 24**
743300200529     C                     MOVEA'1'       *IN,89           ***************
743400200529     C                     EXSR DBSR
743500200529     C                     END                             - E1
743600200529     C*
743700200529     C**  TRANSFER DATE MIDAS INTO DDMMMYY
743800200529     C*
743900200529     C           PVALD     IFNE RVALD                      - B1
744000200529     C                     Z-ADDRVALD     ZDAYNO
744100200529     C                     EXSR ZDATE2
744200200529     C                     MOVE ZDATE     VALDO
744300200529     C                     Z-ADDRVALD     PVALD
744400200529     C                     END                             - E1
744500200529     C*
744600200529     C**  TRANSFER DATE MIDAS INTO DDMMMYY
744700200529     C*
744800200529     C           PPSTD     IFNE RPSTD                      - B1
744900200529     C                     Z-ADDRPSTD     ZDAYNO
745000200529     C                     EXSR ZDATE2
745100200529     C                     MOVE ZDATE     PSTDO
745200200529     C                     Z-ADDRPSTD     PPSTD
745300200529     C                     END                             - E1
745400200529     C*
745500200529     C**  PREPARE DEBIT RATE CHANGE TO OUTPUT
745600200529     C*
745700200529     C                     MOVE PSTDO     PSTDA
745800200529     C                     MOVE VALDO     VALDA
745900200529     C*
746000200529     C                     EXSR CLMSG
746100200529     C                     MOVELNAR,9     RNARR
746200200529     C*
746300200529     C**  OUTPUT DEBIT RATE CHANGE TO
746400200529     C*
746500200529     C                     EXSR RCRSR
746600200529     C*
746700200529     C                     ENDSR                           **RATEC ENDSR**
746800200529     C********************************************************************
746900200529     C/EJECT
747000200529     C********************************************************************
747100200529     C**
747200200529     C** RATED subroutine to prepare and output debit rate change
747300200529     C**
747400200529     C**     Called by       DRSR, RATESR
747500200529     C**
747600200529     C**     Calls           DBSR, RDRSR
747700200529     C**
747800200529     C           RATED     BEGSR                           **RATED BEGSR**
747900200529     C*
748000200529     C**  ACCESS REHRDJ (REHPOSR1 REHPOSR2 REHPOSR3) WHICH CONTAINS
748100200529     C**  THE GOOD DATES FOR DEBIT RATE CHANGE TO
748200200529     C*
748300200529     C           KLIST5    CHAINREHRDJ               60
748400200529     C*
748500200529     C           *IN60     IFEQ '1'                        - B1
748600200529     C                     Z-ADDDDRCD     WDATE
748700200529     C                     Z-ADD25        DBASE
748800200529     C                     MOVE 'REHRDJ'  DBFILE           ***************
748900200529     C                     MOVELRKEY2     DBKEY            **DB ERROR 25**
749000200529     C                     MOVEA'1'       *IN,89           ***************
749100200529     C                     EXSR DBSR
749200200529     C                     END                             - E1
749300200529     C*
749400200529     C**  TRANSFER DATE MIDAS INTO DDMMMYY
749500200529     C*
749600200529     C           PVALD     IFNE RVALD                      - B1
749700200529     C                     Z-ADDRVALD     ZDAYNO
749800200529     C                     EXSR ZDATE2
749900200529     C                     MOVE ZDATE     VALDO
750000200529     C                     Z-ADDRVALD     PVALD
750100200529     C                     END                             - E1
750200200529     C*
750300200529     C**  TRANSFER DATE MIDAS INTO DDMMMYY
750400200529     C*
750500200529     C           PPSTD     IFNE RPSTD                      - B1
750600200529     C                     Z-ADDRPSTD     ZDAYNO
750700200529     C                     EXSR ZDATE2
750800200529     C                     MOVE ZDATE     PSTDO
750900200529     C                     Z-ADDRPSTD     PPSTD
751000200529     C                     END                             - E1
751100200529     C*
751200200529     C**  PREPARE DEBIT RATE CHANGE TO OUTPUT
751300200529     C*
751400200529     C                     MOVE PSTDO     PSTDA
751500200529     C                     MOVE VALDO     VALDA
751600200529     C*
751700200529     C                     EXSR CLMSG
751800200529     C                     MOVELNAR,4     RNARR
751900200529     C*
752000200529     C**  OUTPUT DEBIT RATE CHANGE TO
752100200529     C*
752200200529     C                     EXSR RDRSR
752300200529     C*
752400200529      ** If CRE001 is switched ON, Output Additional Overdraft Rate       CRE001
752500200529      *                                                                   CRE001
752600200529     C           CRE001    IFEQ 'Y'                                       CRE001
752700200529     C                     EXSR CLMSG                                     CRE001
752800200529     C**********           MOVELNAR,35    ONARR                    CRE001 180892
752900200529     C                     MOVELNAR,37    ONARR                           180892
753000200529     C                     MOVE AODR      OAODR                           CRE001
753100200529     C                     EXSR OVERDC                                    CRE001
753200200529     C                     WRITEAODRDC                                    CRE001
753300200529     C                     ENDIF                                          CRE001
753400200529      *                                                                   CRE001
753500200529     C                     ENDSR                           **RATED ENDSR**
753600200529     C********************************************************************
753700200529     C/EJECT
753800200529     C********************************************************************
753900200529     C**
754000200529     C** RATESR subroutine for debit and credit rate change
754100200529     C**
754200200529     C**     Called by       B O T H S R
754300200529     C**
754400200529     C**     Calls           RATEC,RATED
754500200529     C**
754600200529     C           RATESR    BEGSR                           **RATESR BEGSR*
754700200529     C*
754800200529     C                     Z-ADDDHISD     WWHISD
754900200529     C*
755000200529     C           DDRCI     IFEQ 'Y'                        - B1
755100200529     C           DRECI     ANDNE'B'
755200200529     C*
755300200529     C**  DEBIT RATE CHANGE
755400200529     C*
755500200529     C                     EXSR RATED
755600200529     C*
755700200529     C                     Z-ADDDHISD     WHISDD
755800200529     C*
755900200529     C                     END                             - E1
756000200529     C*
756100200529     C           DCRCI     IFEQ 'Y'                        - B1
756200200529     C           DRECI     ANDNE'B'
756300200529     C*
756400200529     C**  CREDIT RATE CHANGE
756500200529     C*
756600200529     C                     EXSR RATEC
756700200529     C*
756800200529     C                     Z-ADDDHISD     WHISDC
756900200529     C*
757000200529     C                     END                             - E1
757100200529     C*
757200200529     C           DDRCI     IFEQ *BLANKS                    - B1
757300200529     C           DCRCI     ANDEQ*BLANKS
757400200529     C*
757500200529     C           CDICT     IFLT 3                          - B2
757600200529     C                     Z-ADDDHISD     WHISDD
757700200529     C                     END                             - E2
757800200529     C*
757900200529     C           CCICT     IFLT 3                          - B2
758000200529     C                     Z-ADDDHISD     WHISDC
758100200529     C                     END                             - E2
758200200529     C*
758300200529     C                     END                             - E1
758400200529     C*
758500200529     C**  SAVE REHISL  AS PREVIOUS
758600200529     C*
758700200529     C                     Z-ADDDMNBL     WMNBL
758800200529     C                     Z-ADDDHISB     WHISB
758900200529     C                     MOVE DDRCB     WDRCB
759000200529     C                     Z-ADDDCRCB     WCRCB
759100200529     C                     Z-ADDDDAID     WDAID
759200200529     C                     Z-ADDDCAID     WCAID
759300200529     C*
759400200529     C*
759500200529     C           KLIST1    READEREHISL                   51
759600200529     C*
759700200529     C                     ENDSR                           **RATESR ENDSR*
759800200529     C********************************************************************
759900200529     C/EJECT
760000200529     C********************************************************************
760100200529     C**
760200200529     C** RCRSR subroutine for credit rate output processing
760300200529     C**
760400200529     C**     Called by     RATEC
760500200529     C**
760600200529     C**     Calls         DBSR
760700200529     C**
760800200529     C           RCRSR     BEGSR                           **RCRSR BEGSR**
760900200529     C*
761000200529     C/COPY WNCPYSRC,RE3765C024
761100200529     C                     EXSR OVERDC
761200200529     C*
761300200529     C           DCICT     IFEQ *ZEROS                     - B1
761400200529     C*
761500200529     C                     Z-ADDCRIR      RATE
761600200529     C*
761700200529     C**  OUTPUT RATE CHANGE
761800200529     C*
761900200529     C                     EXSR OVERDC
762000200529     C                     WRITERATEDC
762100200529     C*
762200200529     C                     ELSE                            - X1
762300200529     C*
762400200529     C                     EXSR CLMSG
762500200529     C                     MOVELNAR,12    RNARR
762600200529     C*
762700200529     C                     EXSR OVERDC
762800200529     C                     WRITERAT1DC
762900200529     C*
763000200529     C           INTH      IFGT *ZEROS                     - B2
763100200529     C                     Z-SUBINTH      HISB0
763200200529     C*
763300200529     C                     EXSR CLMSG
763400200529     C                     MOVELNAR,13    BNARR
763500200529     C*
763600200529     C                     ELSE                            - X2
763700200529     C                     Z-ADDINTH      HISB0
763800200529     C*
763900200529     C                     EXSR CLMSG
764000200529     C                     MOVELNAR,14    BNARR
764100200529     C*
764200200529     C                     END                             - E2
764300200529     C*
764400200529     C                     EXSR OVERDC
764500200529     C                     WRITERAT2DC
764600200529     C*
764700200529     C********** RAT21     IFNE *ZEROS                     - B2                               253776
764800200529     C********** BAL21     ORNE *ZEROS                                                        253776
764900200529     C                     Z-ADDRAT21     ORAT1
765000200529     C                     Z-ADDBAL21     OBAL01
765100200529     C**********           ELSE                            - X2                               253776
765200200529     C**********           Z-ADDCHISD     WDATE                                               253776
765300200529     C**********           Z-ADD26        DBASE            ***************                    253776
765400200529     C**********           MOVE 'RATE '   DBFILE           **DB ERROR 26**                    253776
765500200529     C**********           MOVELWDATE     DBKEY            ***************                    253776
765600200529     C**********           MOVEA'1'       *IN,89                                              253776
765700200529     C**********           EXSR DBSR                                                          253776
765800200529     C**********           END                             - E2                               253776
765900200529     C*
766000200529     C           RAT22     IFNE *ZEROS                     - B2
766100200529     C           BAL22     ORNE *ZEROS
766200200529     C                     Z-ADDRAT22     ORAT2
766300200529     C                     Z-ADDBAL22     OBAL02
766400200529     C           RAT23     IFNE *ZEROS                     - B3
766500200529     C           BAL23     ORNE *ZEROS
766600200529     C                     Z-ADDRAT23     ORAT3
766700200529     C                     Z-ADDBAL23     OBAL03
766800200529     C                     ELSE                            - X3
766900200529     C                     MOVE '1'       *IN85
767000200529     C                     Z-ADD*ZEROS    ORAT3
767100200529     C                     Z-ADD*ZEROS    OBAL03
767200200529     C                     END                             - E3
767300200529     C                     ELSE                            - X2
767400200529     C                     MOVE '1'       *IN85
767500200529     C                     MOVE '1'       *IN84
767600200529     C                     Z-ADD*ZEROS    ORAT2
767700200529     C                     Z-ADD*ZEROS    OBAL02
767800200529     C                     END                             - E2
767900200529     C*
768000200529     C                     EXSR OVERDC
768100200529     C                     WRITERAT3DC
768200200529     C                     EXSR OVERDC
768300200529     C                     WRITERAT4DC
768400200529     C                     MOVE '0'       *IN84
768500200529     C                     MOVE '0'       *IN85
768600200529     C*
768700200529     C           RAT24     IFNE *ZEROS                     - B2
768800200529     C           BAL24     ORNE *ZEROS
768900200529     C           RATC24    IFNE *BLANKS
769000200529     C           BALC24    ORNE *BLANKS
769100200529     C                     Z-ADDRAT24     ORAT1
769200200529     C                     Z-ADDBAL24     OBAL01
769300200529     C           RAT25     IFNE *ZEROS                     - B3
769400200529     C           BAL25     ORNE *ZEROS
769500200529     C           RATC25    IFNE *BLANKS
769600200529     C           BALC25    ORNE *BLANKS
769700200529     C                     Z-ADDRAT25     ORAT2
769800200529     C                     Z-ADDBAL25     OBAL02
769900200529     C           RAT26     IFNE *ZEROS                     - B4
770000200529     C           BAL26     ORNE *ZEROS
770100200529     C                     Z-ADDRAT26     ORAT3
770200200529     C                     Z-ADDBAL26     OBAL03
770300200529     C                     ELSE                            - X4
770400200529     C                     MOVE '1'       *IN85
770500200529     C                     Z-ADD*ZEROS    ORAT3
770600200529     C                     Z-ADD*ZEROS    OBAL03
770700200529     C                     END
770800200529     C                     END                             - E4
770900200529     C                     ELSE                            - X3
771000200529     C                     MOVE '1'       *IN84
771100200529     C                     MOVE '1'       *IN85
771200200529     C                     Z-ADD*ZEROS    ORAT2
771300200529     C                     Z-ADD*ZEROS    OBAL02
771400200529     C                     END                             - E3
771500200529     C*
771600200529     C                     EXSR OVERDC
771700200529     C                     WRITERAT3DC
771800200529     C                     EXSR OVERDC
771900200529     C                     WRITERAT4DC
772000200529     C                     MOVE '0'       *IN84
772100200529     C                     MOVE '0'       *IN85
772200200529     C*
772300200529     C           RAT31     IFNE *ZEROS                     - B3
772400200529     C           BAL31     ORNE *ZEROS
772500200529     C           RATC31    IFNE *BLANKS
772600200529     C           BALC31    ORNE *BLANKS
772700200529     C                     Z-ADDRAT31     ORAT1
772800200529     C                     Z-ADDBAL31     OBAL01
772900200529     C           RAT32     IFNE *ZEROS                     - B4
773000200529     C           BAL32     ORNE *ZEROS
773100200529     C           RATC32    IFNE *BLANKS
773200200529     C           BALC32    ORNE *BLANKS
773300200529     C                     Z-ADDRAT32     ORAT2
773400200529     C                     Z-ADDBAL32     OBAL02
773500200529     C           RAT33     IFNE *ZEROS                     - B5
773600200529     C           BAL33     ORNE *ZEROS
773700200529     C                     Z-ADDRAT33     ORAT3
773800200529     C                     Z-ADDBAL33     OBAL03
773900200529     C                     ELSE                            - X5
774000200529     C                     MOVE '1'       *IN85
774100200529     C                     Z-ADD*ZEROS    ORAT3
774200200529     C                     Z-ADD*ZEROS    OBAL03
774300200529     C                     END                             - E5
774400200529     C                     END
774500200529     C                     ELSE                            - X4
774600200529     C                     MOVE '1'       *IN84
774700200529     C                     MOVE '1'       *IN85
774800200529     C                     Z-ADD*ZEROS    ORAT2
774900200529     C                     Z-ADD*ZEROS    OBAL02
775000200529     C                     END                             - E4
775100200529     C*
775200200529     C                     EXSR OVERDC
775300200529     C                     WRITERAT3DC
775400200529     C                     EXSR OVERDC
775500200529     C                     WRITERAT4DC
775600200529     C                     MOVE '0'       *IN84
775700200529     C                     MOVE '0'       *IN85
775800200529     C*
775900200529     C           RAT34     IFNE *ZEROS                     - B4
776000200529     C           BAL34     ORNE *ZEROS
776100200529     C           RATC34    IFNE *BLANKS
776200200529     C           BALC34    ORNE *BLANKS
776300200529     C                     Z-ADDRAT34     ORAT1
776400200529     C                     Z-ADDBAL34     OBAL01
776500200529     C           RAT35     IFNE *ZEROS                     - B5
776600200529     C           BAL35     ORNE *ZEROS
776700200529     C           RATC35    IFNE *BLANKS
776800200529     C           BALC35    ORNE *BLANKS
776900200529     C                     Z-ADDRAT35     ORAT2
777000200529     C                     Z-ADDBAL35     OBAL02
777100200529     C           RAT36     IFNE *ZEROS                     - B6
777200200529     C           BAL36     ORNE *ZEROS
777300200529     C                     Z-ADDRAT36     ORAT3
777400200529     C                     Z-ADDBAL36     OBAL03
777500200529     C                     ELSE                            - X6
777600200529     C                     MOVE '1'       *IN85
777700200529     C                     Z-ADD*ZEROS    ORAT3
777800200529     C                     Z-ADD*ZEROS    OBAL03
777900200529     C                     END                             - E6
778000200529     C                     END
778100200529     C                     ELSE                            - X5
778200200529     C                     MOVE '1'       *IN84
778300200529     C                     MOVE '1'       *IN85
778400200529     C                     Z-ADD*ZEROS    ORAT2
778500200529     C                     Z-ADD*ZEROS    OBAL02
778600200529     C                     END                             - E5
778700200529     C*
778800200529     C                     EXSR OVERDC
778900200529     C                     WRITERAT3DC
779000200529     C                     EXSR OVERDC
779100200529     C                     WRITERAT4DC
779200200529     C                     MOVE '0'       *IN84
779300200529     C                     MOVE '0'       *IN85
779400200529     C*
779500200529     C                     END
779600200529     C*
779700200529     C                     END                             - E4
779800200529     C*
779900200529     C                     END
780000200529     C*
780100200529     C                     END                             - E3
780200200529     C*
780300200529     C                     END
780400200529     C*
780500200529     C                     END                             - E2
780600200529     C*
780700200529     C                     END                             - E1
780800200529     C*
780900200529     C                     ENDSR                           **RCRSR ENDSR**
781000200529     C********************************************************************
781100200529     C/EJECT
781200200529     C********************************************************************
781300200529     C**
781400200529     C** RDRSR subroutine for debit rate output processing
781500200529     C**
781600200529     C**     Called by     RATED
781700200529     C**
781800200529     C**     Calls         DBSR
781900200529     C**
782000200529     C           RDRSR     BEGSR                           **RDRSR BEGSR**
782100200529     C*
782200200529     C/COPY WNCPYSRC,RE3765C025
782300200529     C                     EXSR OVERDC
782400200529     C*
782500200529     C           DDICT     IFEQ *ZEROS                     - B1
782600200529     C*
782700200529     C                     Z-ADDDRIR      RATE
782800200529     C*
782900200529     C**  OUTPUT RATE CHANGE
783000200529     C*
783100200529     C                     EXSR OVERDC
783200200529     C                     WRITERATEDC
783300200529     C*
783400200529     C                     ELSE                            - X1
783500200529     C*
783600200529     C                     EXSR CLMSG
783700200529     C                     MOVELNAR,11    RNARR
783800200529     C*
783900200529     C                     EXSR OVERDC
784000200529     C                     WRITERAT1DC
784100200529     C*
784200200529     C           INTH      IFGT *ZEROS                     - B2
784300200529     C                     Z-SUBINTH      HISB0
784400200529     C*
784500200529     C                     EXSR CLMSG
784600200529     C                     MOVELNAR,13    BNARR
784700200529     C*
784800200529     C                     ELSE                            - X2
784900200529     C                     Z-ADDINTH      HISB0
785000200529     C*
785100200529     C                     EXSR CLMSG
785200200529     C                     MOVELNAR,14    BNARR
785300200529     C*
785400200529     C                     END                             - E2
785500200529     C*
785600200529     C                     EXSR OVERDC
785700200529     C                     WRITERAT2DC
785800200529     C*
785900200529     C********** RAT21     IFNE *ZEROS                     - B2                               253776
786000200529     C********** BAL21     ORNE *ZEROS                                                        253776
786100200529     C                     Z-ADDRAT21     ORAT1
786200200529     C                     Z-ADDBAL21     OBAL01
786300200529     C**********           ELSE                            - X2                               253776
786400200529     C**********           Z-ADDCHISD     WDATE                                               253776
786500200529     C**********           Z-ADD27        DBASE            ***************                    253776
786600200529     C**********           MOVE 'RATE '   DBFILE           **DB ERROR 27**                    253776
786700200529     C**********           MOVELWDATE     DBKEY            ***************                    253776
786800200529     C**********           MOVEA'1'       *IN,89                                              253776
786900200529     C**********           EXSR DBSR                                                          253776
787000200529     C**********           END                             - E2                               253776
787100200529     C*
787200200529     C           RAT22     IFNE *ZEROS                     - B2
787300200529     C           BAL22     ORNE *ZEROS
787400200529     C                     Z-ADDRAT22     ORAT2
787500200529     C                     Z-ADDBAL22     OBAL02
787600200529     C           RAT23     IFNE *ZEROS                     - B3
787700200529     C           BAL23     ORNE *ZEROS
787800200529     C                     Z-ADDRAT23     ORAT3
787900200529     C                     Z-ADDBAL23     OBAL03
788000200529     C                     ELSE                            - X3
788100200529     C                     MOVE '1'       *IN85
788200200529     C                     Z-ADD*ZEROS    ORAT3
788300200529     C                     Z-ADD*ZEROS    OBAL03
788400200529     C                     END                             - E3
788500200529     C                     ELSE                            - X2
788600200529     C                     MOVE '1'       *IN84
788700200529     C                     MOVE '1'       *IN85
788800200529     C                     Z-ADD*ZEROS    ORAT2
788900200529     C                     Z-ADD*ZEROS    OBAL02
789000200529     C                     END                             - E2
789100200529     C*
789200200529     C                     EXSR OVERDC
789300200529     C                     WRITERAT3DC
789400200529     C                     EXSR OVERDC
789500200529     C                     WRITERAT4DC
789600200529     C                     MOVE '0'       *IN84
789700200529     C                     MOVE '0'       *IN85
789800200529     C*
789900200529     C           RAT24     IFNE *ZEROS                     - B2
790000200529     C           BAL24     ORNE *ZEROS
790100200529     C           RATC24    IFNE *BLANKS
790200200529     C           BALC24    ORNE *BLANKS
790300200529     C                     Z-ADDRAT24     ORAT1
790400200529     C                     Z-ADDBAL24     OBAL01
790500200529     C           RAT25     IFNE *ZEROS                     - B3
790600200529     C           BAL25     ORNE *ZEROS
790700200529     C           RATC25    IFNE *BLANKS
790800200529     C           BALC25    ORNE *BLANKS
790900200529     C                     Z-ADDRAT25     ORAT2
791000200529     C                     Z-ADDBAL25     OBAL02
791100200529     C           RAT26     IFNE *ZEROS                     - B4
791200200529     C           BAL26     ORNE *ZEROS
791300200529     C                     Z-ADDRAT26     ORAT3
791400200529     C                     Z-ADDBAL26     OBAL03
791500200529     C                     ELSE                            - X4
791600200529     C                     MOVE '1'       *IN85
791700200529     C                     Z-ADD*ZEROS    ORAT3
791800200529     C                     Z-ADD*ZEROS    OBAL03
791900200529     C                     END                             - E4
792000200529     C                     END
792100200529     C                     ELSE                            - X3
792200200529     C                     MOVE '1'       *IN84
792300200529     C                     MOVE '1'       *IN85
792400200529     C                     Z-ADD*ZEROS    ORAT2
792500200529     C                     Z-ADD*ZEROS    OBAL02
792600200529     C                     END                             - E3
792700200529     C*
792800200529     C                     EXSR OVERDC
792900200529     C                     WRITERAT3DC
793000200529     C                     EXSR OVERDC
793100200529     C                     WRITERAT4DC
793200200529     C                     MOVE '0'       *IN84
793300200529     C                     MOVE '0'       *IN85
793400200529     C*
793500200529     C           RAT31     IFNE *ZEROS                     - B3
793600200529     C           BAL31     ORNE *ZEROS
793700200529     C           RATC31    IFNE *BLANKS
793800200529     C           BALC31    ORNE *BLANKS
793900200529     C                     Z-ADDRAT31     ORAT1
794000200529     C                     Z-ADDBAL31     OBAL01
794100200529     C           RAT32     IFNE *ZEROS                     - B4
794200200529     C           BAL32     ORNE *ZEROS
794300200529     C           RATC32    IFNE *BLANKS
794400200529     C           BALC32    ORNE *BLANKS
794500200529     C                     Z-ADDRAT32     ORAT2
794600200529     C                     Z-ADDBAL32     OBAL02
794700200529     C           RAT33     IFNE *ZEROS                     - B5
794800200529     C           BAL33     ORNE *ZEROS
794900200529     C                     Z-ADDRAT33     ORAT3
795000200529     C                     Z-ADDBAL33     OBAL03
795100200529     C                     ELSE                            - X5
795200200529     C                     MOVE '1'       *IN85
795300200529     C                     Z-ADD*ZEROS    ORAT3
795400200529     C                     Z-ADD*ZEROS    OBAL03
795500200529     C                     END                             - E5
795600200529     C                     END
795700200529     C                     ELSE                            - X4
795800200529     C                     MOVE '1'       *IN84
795900200529     C                     MOVE '1'       *IN85
796000200529     C                     Z-ADD*ZEROS    ORAT2
796100200529     C                     Z-ADD*ZEROS    OBAL02
796200200529     C                     END                             - E4
796300200529     C*
796400200529     C                     EXSR OVERDC
796500200529     C                     WRITERAT3DC
796600200529     C                     EXSR OVERDC
796700200529     C                     WRITERAT4DC
796800200529     C                     MOVE '0'       *IN84
796900200529     C                     MOVE '0'       *IN85
797000200529     C*
797100200529     C           RAT34     IFNE *ZEROS                     - B4
797200200529     C           BAL34     ORNE *ZEROS
797300200529     C           RATC34    IFNE *BLANKS
797400200529     C           BALC34    ORNE *BLANKS
797500200529     C                     Z-ADDRAT34     ORAT1
797600200529     C                     Z-ADDBAL34     OBAL01
797700200529     C           RAT35     IFNE *ZEROS                     - B5
797800200529     C           BAL35     ORNE *ZEROS
797900200529     C           RATC35    IFNE *BLANKS
798000200529     C           BALC35    ORNE *BLANKS
798100200529     C                     Z-ADDRAT35     ORAT2
798200200529     C                     Z-ADDBAL35     OBAL02
798300200529     C           RAT36     IFNE *ZEROS                     - B6
798400200529     C           BAL36     ORNE *ZEROS
798500200529     C                     Z-ADDRAT36     ORAT3
798600200529     C                     Z-ADDBAL36     OBAL03
798700200529     C                     ELSE                            - X6
798800200529     C                     MOVE '1'       *IN85
798900200529     C                     Z-ADD*ZEROS    ORAT3
799000200529     C                     Z-ADD*ZEROS    OBAL03
799100200529     C                     END                             - E6
799200200529     C                     END
799300200529     C                     ELSE                            - X5
799400200529     C                     MOVE '1'       *IN84
799500200529     C                     MOVE '1'       *IN85
799600200529     C                     Z-ADD*ZEROS    ORAT2
799700200529     C                     Z-ADD*ZEROS    OBAL02
799800200529     C                     END                             - E5
799900200529     C*
800000200529     C                     EXSR OVERDC
800100200529     C                     WRITERAT3DC
800200200529     C                     EXSR OVERDC
800300200529     C                     WRITERAT4DC
800400200529     C                     MOVE '0'       *IN84
800500200529     C                     MOVE '0'       *IN85
800600200529     C*
800700200529     C                     END
800800200529     C*
800900200529     C                     END                             - E4
801000200529     C*
801100200529     C                     END
801200200529     C*
801300200529     C                     END                             - E3
801400200529     C*
801500200529     C                     END
801600200529     C*
801700200529     C                     END                             - E2
801800200529     C*
801900200529     C                     END                             - E1
802000200529     C*
802100200529     C                     ENDSR                           **RDRSR ENDSR**
802200200529     C********************************************************************
802300200529     C/EJECT
802400200529     C********************************************************************
802500200529     C**
802600200529     C** TOTAL subroutine for total processing
802700200529     C**
802800200529     C**     Called by       S T A R T
802900200529     C**
803000200529     C**     Calls           -
803100200529     C**
803200200529     C           TOTAL     BEGSR                           **TOTAL BEGSR**
803300200529     C**
803400200529     C** SET UP FOR CONTROL REPORT
803500200529     C**
803600200529     C                     Z-ADDSFNUMU    ZSNUMU
803700200529     C                     OUT  LDA
803800200529     C                     CALL 'ZSFILE'
803900200529     C                     PARM           SEQ     5
804000200529     C                     PARM *BLANK    SENTY   3
804100200529     C                     PARM           SFILEU
804200200529     C                     PARM           ZSNUMU  60
804300200529     C                     PARM           ZSERR   1
804400200529     C           *LOCK     IN   LDA
804500200529     C*
804600200529     C           ZSERR     IFEQ 'Y'
804700200529     C** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM
804800200529     C** DBASE, DBFILE AND DBKEY SET WITHIN ZSFILE
804900200529     C                     MOVEA'1'       *IN,89
805000200529     C                     EXSR DBSR
805100200529     C                     END
805200200529     C*
805300200529     C                     WRITETOTALS
805400200529     C*
805500200529     C                     ENDSR                           **TOTAL ENDSR**
805600200529     C********************************************************************
805700200529     C/EJECT
805800200529     C********************************************************************
805900200529     C**
806000200529     C** TOTSR subroutine for days total output for credit and debit
806100200529     C**
806200200529     C**     Called by       B O T H S R
806300200529     C**
806400200529     C**     Calls           ZICD, ITYPDR, ITYPCR
806500200529     C**
806600200529     C           TOTSR     BEGSR                           **TOTSR  BEGSR*
806700200529     C*
806800200529     C           CDICT     IFLT 3                          - B1
806900200529     C*
807000200529     C           DDRCI     IFEQ 'Y'                        - B2
807100200529     C*
807200200529     C                     Z-ADDWDRCB     ZICALC
807300200529     C                     Z-ADDWWHISD    ZIBEG
807400200529     C                     Z-ADDDHISD     ZIEND
807500200529     C*
807600200529     C                     EXSR ZICD
807700200529     C*
807800200529     C                     Z-ADDZDAYN1    DAYS
807900200529     C                     Z-SUBWHISB     HISB0
808000200529     C*
808100200529     C           *IN80     IFEQ '1'                        - B3
808200200529     C           HISB0     MULT DAYS      NUMB0
808300200529     C                     ELSE                            - X3
808400200529     C           *IN81     IFEQ '1'                        - B4
808500200529     C           HISB1     MULT DAYS      NUMB0
808600200529     C                     ELSE                            - X4
808700200529     C           *IN82     IFEQ '1'                        - B5
808800200529     C           HISB2     MULT DAYS      NUMB0
808900200529     C                     ELSE                            - X5
809000200529     C           HISB3     MULT DAYS      NUMB0
809100200529     C                     END                             - E5
809200200529     C                     END                             - E4
809300200529     C                     END                             - E3
809400200529     C*
809500200529     C           NUMB0     IFLT *ZEROS
809600200529     C                     ADD  NUMB0     WWTND
809700200529     C                     ELSE
809800200529     C                     ADD  NUMB0     WWTNC
809900200529     C                     END
810000200529     C                     EXSR OVERDC
810100200529     C                     WRITESTOTDC
810200200529     C*
810300200529     C* CHARGE REPORT IF NECESSARY
810400200529     C*
810500200529     C           CCICI     IFNE *BLANK                     - B3
810600200529     C           DTHGAR    IFNE *ZERO                      - B4
810700200529     C           DTHGAN    ORNE *ZERO
810800200529     C                     Z-SUBDTHGAR    CHGR0
810900200529     C                     Z-SUBDTHGAN    CHGN0
811000200529     C                     WRITEPOSTCH
811100200529     C                     END                             - E4
811200200529     C                     END                             - E3
811300200529     C*
811400200529     C                     END                             - E2
811500200529     C*
811600200529     C                     ELSE                            - X1
811700200529     C*
811800200529     C                     EXSR ITYPDR
811900200529     C*
812000200529     C                     END                             - E1
812100200529     C*
812200200529     C           DCRCI     IFEQ 'Y'                        - B1
812300200529     C*
812400200529     C           CCICT     IFLT 3                          - B2
812500200529     C*
812600200529     C                     Z-ADDWCRCB     ZICALC
812700200529     C                     Z-ADDWWHISD    ZIBEG
812800200529     C                     Z-ADDDHISD     ZIEND
812900200529     C*
813000200529     C                     EXSR ZICD
813100200529     C*
813200200529     C                     Z-ADDZDAYN1    DAYS
813300200529     C                     Z-SUBWHISB     HISB0
813400200529     C*
813500200529     C           *IN80     IFEQ '1'                        - B3
813600200529     C           HISB0     MULT DAYS      NUMB0
813700200529     C                     ELSE                            - X3
813800200529     C           *IN81     IFEQ '1'                        - B4
813900200529     C           HISB1     MULT DAYS      NUMB0
814000200529     C                     ELSE                            - X4
814100200529     C           *IN82     IFEQ '1'                        - B5
814200200529     C           HISB2     MULT DAYS      NUMB0
814300200529     C                     ELSE                            - X5
814400200529     C           HISB3     MULT DAYS      NUMB0
814500200529     C                     END                             - E5
814600200529     C                     END                             - E4
814700200529     C                     END                             - E3
814800200529     C*
814900200529     C           NUMB0     IFLT *ZEROS
815000200529     C                     ADD  NUMB0     WWTND
815100200529     C                     ELSE
815200200529     C                     ADD  NUMB0     WWTNC
815300200529     C                     END
815400200529     C                     EXSR OVERDC
815500200529     C                     WRITESTOTDC
815600200529     C*
815700200529     C* CHARGE REPORT IF NECESSARY
815800200529     C*
815900200529     C           CCICI     IFNE *BLANK                     - B3
816000200529     C           DTHGAR    IFNE *ZERO                      - B4
816100200529     C           DTHGAN    ORNE *ZERO
816200200529     C                     Z-SUBDTHGAR    CHGR0
816300200529     C                     Z-SUBDTHGAN    CHGN0
816400200529     C                     WRITEPOSTCH
816500200529     C                     END                             - E4
816600200529     C                     END                             - E3
816700200529     C*
816800200529     C                     ELSE                            - X2
816900200529     C*
817000200529     C                     EXSR ITYPCR
817100200529     C*
817200200529     C                     END                             - E2
817300200529     C*
817400200529     C                     END                             - E1
817500200529     C*
817600200529     C                     ENDSR                           **TOTSR  ENDSR*
817700200529     C********************************************************************
817800200529     C/EJECT
817900200529     C********************************************************************
818000200529     C**
818100200529     C** CALBRT subroutine to calculate base rates tax
818200200529     C**
818300200529     C**     Called by       BOTHSR, CRSR
818400200529     C**
818500200529     C**     Calls           none
818600200529     C**
818700200529     C           CALBRT    BEGSR                           **CALBRT BEGSR*
818800200529     C*
818900200529     C** If BRT SAR installed
819000200529     C*
819100200529     C           S01383    IFEQ 'Y'                        B001
819200200529      *                                                                   130468
819300200529     C                     MOVE '0'       *IN22                           130468
819400200529     C*
819500200529     C** Access ACCNT to check if BRT liable
819600200529     C*
819700200529     C           KACCNT    CHAINACCNT                99
819800200529     C*
819900200529     C** Chain failure
820000200529     C*
820100200529     C           *IN99     IFEQ '1'                        B002***********
820200200529     C                     MOVEL'ACCNT'   DBFILE           **DB ERROR 28**
820300200529     C                     MOVELRKEY      DBKEY            ***************
820400200529     C                     Z-ADD28        DBASE
820500200529     C                     EXSR DBSR
820600200529     C                     END                             E002
820700200529     C**********           END                             E001           130468
820800200529      *                                                                   130468
820900200529      * Include CR interest adjustments when calculating BRT              130468
821000200529     C                     Z-ADDTINT0     TGINT0                          130468
821100200529     C           CCAIC     ADD  CSGACI    TINT0                           130468
821200200529     C*
821300200529     C** If BRT liable
821400200529     C*
821500200529     C           BRTCA     IFEQ 'L'                        B001
821600200529     C           BRTCA     OREQ 'P'
821700200529     C*
821800200529     C**    and credit interest to be paid
821900200529     C*
822000200529     C********** CALLSR    IFEQ 'B'                                       130468
822100200529     C********** CCAIC     ANDGT0                                         130468
822200200529     C********** CALLSR    ORNE 'B'                                       130468
822300200529     C********** TINT0     ANDLT0                                         130468
822400200529     C           TINT0     IFGT *ZERO                                     130468
822500200529     C*
822600200529     C** Process record with BRT applied
822700200529     C*
822800200529     C                     SETON                     22
822900200529     C*
823000200529     C** Apply new or old rate?
823100200529     C*
823200200529     C***********HISD      IFGE DEFF                       B003           104618
823300200529     C***********          Z-ADDBRTR      BRT1    75                      104618
823400200529     C***********          ELSE                            X003           104618
823500200529     C***********          Z-ADDPBRTR     BRT1    75                      104618
823600200529     C***********          END                             E003           104618
823700200529     C*                                                                   104618
823800200529     C* IF DATE IS BEFORE 'DEFF' ON SDBRTDPD - USE PREV BRT RATE          104618
823900200529     C* OTHERWISE - USE CURRENT BRT RATE.                                 104618
824000200529     C*                                                                   104618
824100200529     C           CCICI     IFEQ 'D'                                       104618
824200200529     C           CCICI     OREQ 'M'                                       104618
824300200529     C                     MOVE '1'       *IN30                           104618
824400200529     C                     ELSE                                           104618
824500200529     C                     MOVE '0'       *IN30                           104618
824600200529     C                     END                                            104618
824700200529     C*                                                                   104618
824800200529     C           LDAC      IFEQ 'Y'                                       104618
824900200529     C*                                                                   104618
825000200529     C           *IN30     IFEQ '1'                                       104618
825100200529     C           RUND      IFLE DEFF                                      104618
825200200529     C                     Z-ADDPBRTR     BRT1    75                      104618
825300200529     C                     ELSE                                           104618
825400200529     C                     Z-ADDBRTR      BRT1                            104618
825500200529     C                     END                                            104618
825600200529     C                     END                                            104618
825700200529     C*                                                                   104618
825800200529     C           CCICI     IFEQ 'C'                                       104618
825900200529     C           RUND      IFLT DEFF                                      104618
826000200529     C                     Z-ADDPBRTR     BRT1                            104618
826100200529     C                     ELSE                                           104618
826200200529     C                     Z-ADDBRTR      BRT1                            104618
826300200529     C                     END                                            104618
826400200529     C                     END                                            104618
826500200529     C*                                                                   104618
826600200529     C           *IN30     IFEQ '0'                                       104618
826700200529     C           CCICI     ANDNE'C'                                       104618
826800200529     C           NCID      IFLE DEFF                                      104618
826900200529     C                     Z-ADDPBRTR     BRT1                            104618
827000200529     C                     ELSE                                           104618
827100200529     C                     Z-ADDBRTR      BRT1                            104618
827200200529     C                     END                                            104618
827300200529     C                     END                                            104618
827400200529     C*                                                                   104618
827500200529     C                     ELSE                                           104618
827600200529     C*                                                                   104618
827700200529     C           *IN30     IFEQ '1'                                       104618
827800200529     C           CCICI     OREQ 'C'                                       104618
827900200529     C           RUND      IFLT DEFF                                      104618
828000200529     C                     Z-ADDPBRTR     BRT1                            104618
828100200529     C                     ELSE                                           104618
828200200529     C                     Z-ADDBRTR      BRT1                            104618
828300200529     C                     END                                            104618
828400200529     C                     END                                            104618
828500200529     C*                                                                   104618
828600200529     C           *IN30     IFEQ '0'                                       104618
828700200529     C           CCICI     ANDNE'C'                                       104618
828800200529     C           NCID      IFLT DEFF                                      104618
828900200529     C                     Z-ADDPBRTR     BRT1                            104618
829000200529     C                     ELSE                                           104618
829100200529     C                     Z-ADDBRTR      BRT1                            104618
829200200529     C                     END                                            104618
829300200529     C                     END                                            104618
829400200529     C*                                                                   104618
829500200529     C                     END                                            104618
829600200529     C*
829700200529     C           BRTCA     IFEQ 'L'
829800200529     C                     Z-ADDBRT1      WKBRT   75
829900200529     C                     ELSE
830000200529     C           BRT1      MULT 0.5       WKBRT
830100200529     C                     END
830200200529     C*
830300200529     C****Calculate*BRT total against accrued credit interest if          130468
830400200529     C******called*from SR/BRTOT, otherwise calculate against             130468
830500200529     C******total*interest                                                130468
830600200529     C*
830700200529     C********** CALLSR    IFEQ 'B'                                       130468
830800200529     C********** CCAIC     MULT WKBRT     BRTOT0                          130468
830900200529     C**********           ELSE                                           130468
831000200529     C           TINT0     MULT WKBRT     BRTOT0
831100200529     C**********           END                                            130468
831200200529     C*
831300200529     C           BRTOT0    DIV  100       BRTOT0    H
831400200529     C*
831500200529     C**********           Z-ADDTINT0     TGINT0                          130468
831600200529     C**********           SUB  BRTOT0    TINT0                           130468
831700200529     C                     END                             E002
831800200529     C*
831900200529     C                     END                             E001
832000200529      *                                                                   130468
832100200529     C                     Z-ADDTGINT0    TINT0                           130468
832200200529     C                     END                                            130468
832300200529     C*
832400200529     C           TINT0     COMP 0                    4948
832500200529     C                     ENDSR
832600200529      *****************************************************************                       CGL031
832700200529      /EJECT                                                                                  CGL031
832800200529      *****************************************************************                       CGL031
832900200529      *                                                               *                       CGL031
833000200529      *  CALEUT - Subroutine to calculate the EU Withholding Tax      *                       CGL031
833100200529      *                                                               *                       CGL031
833200200529      *****************************************************************                       CGL031
833300200529     C           CALEUT    BEGSR                                                              CGL031
833400200529      *                                                                                       CGL031
833500200529      ** Check if the customer is actually a Joint A/c.                                       235917
833600200529      *                                                                                       235917
833700200529     C                     MOVELCCNUM     KJANO   6                                           235917
833800200529     C           KJANO     CHAINSDJACCL1             74                                       235917
833900200529      *                                                                                       235917
834000200529     C                     MOVE 'N'       WJACC   1                                           235917
834100200529     C           *IN53     IFEQ *OFF                                                          235917
834200200529     C                     MOVE 'Y'       WJACC                                               235917
834300200529     C                     ENDIF                                                              235917
834400200529      *                                                                                       235917
834500200529     C                     MOVE *ON       *IN21                                               CGL031
834600200529     C                     Z-ADD0         EUTAX0                                              CGL031
834700200529     C                     Z-ADD*ZEROS    STAX0                                               CER048
834800200529      *                                                                                       CGL031
834900200529     C                     MOVE 'G'       MODI                                                CGL031
835000200529     C                     MOVELCCNUM     P#NUM                                               CGL031
835100200529     C***********          MOVELCCNUM     KJOIN   60                                  235917 CSD027A
835200200529     C                     MOVELCCNUM     KJOIN   6                                          CSD027A
835300200529     C           WJACC     IFEQ 'Y'                                                           235917
835400200529     C           KLISTC    SETLLSDCSINLC                                                      235917
835500200529     C           KLISTC    READESDCSINLC                 53                                   235917
835600200529     C                     ELSE                                                               235917
835700200529     C           KLIST7    SETLLSDCSINL7                                                      CGL031
835800200529     C           KLIST7    READESDCSINL7                 53                                   CGL031
835900200529     C                     ENDIF                                                              235917
836000200529     C           *IN53     DOWEQ*OFF                                                          CGL031
836100200529     C           TSSTAT    IFEQ 'T'                                                           CGL031
836200200529      *                                                                                       CER048
836300200529      ** Accumulate Secondary Tax Amount in Original Currency                                 CER048
836400200529      *                                                                                       CER048
836500200529     C           CER048    IFEQ 'Y'                                                           CER048
836600200529     C           STAX0     ADD  TSSTDO    STAX0                                               CER048
836700200529     C                     ENDIF                                                              CER048
836800200529      *                                                                                       CER048
836900200529     C                     ADD  TSTXSR    EUTAX0                                              CGL031
837000200529     C                     ENDIF                                                              CGL031
837100200529     C*                                                                                       235917
837200200529     C           WJACC     IFEQ 'Y'                                                           235917
837300200529     C           KLISTC    READESDCSINLC                 53                                   235917
837400200529     C                     ELSE                                                               235917
837500200529     C           KLIST7    READESDCSINL7                 53                                   CGL031
837600200529     C                     ENDIF                                                              235917
837700200529     C*                                                                                       235917
837800200529     C                     ENDDO                                                              CGL031
837900200529      *                                                                                       CGL031
838000200529     C                     ENDSR                                                              CGL031
838100200529     C********************************************************************
838200200529     C**
838300200529     C**   SR. TO SET UP AN ARRAY OF CURRENCIES AND AN ARRAY OF
838400200529     C**   DECIMAL PLACES FOR THOSE CURRENCIES.
838500200529     C**
838600200529     C           CCYARR    BEGSR                           *** CCYARR  ***
838700200529     C**
838800200529     C**   SET OFF ERROR INDICATOR
838900200529     C                     SETOF                     99
839000200529     C**
839100200529     C**   SET ARRAY INDEX TO ZERO.
839200200529     C                     Z-ADD0         X       30
839300200529     C**
839400200529     C**   SET UP KEY FOR CURRENCY TABLE.
839500200529     C                     MOVE *BLANKS   W@CKEY  3
839600200529     C**
839700200529     C**   SET LOWER LIMIT AND READ CURRENCY TABLE HEADER.
839800200529     C           W@CKEY    SETLLSDCURRL0
839900200529     C**
840000200529     C**   LOOP TO READ CURRENCY DETAIL RECORDS.
840100200529     C           XLOOP     TAG                             ** XLOOP TAG **
840200200529     C                     READ SDCURRL0                 99
840300200529     C**
840400200529     C**   END IF ALL CURRENCY RECORDS PROCESSED
840500200529     C   99                GOTO XEND
840600200529     C**
840700200529     C**   INCREMENT ARRAY INDEX.
840800200529     C           X         ADD  1         X
840900200529     C**
841000200529     C**   MOVE DATA INTO ARRAYS.
841100200529     C                     MOVE A6CYCD    CCYA,X
841200200529     C                     MOVE A6NBDP    DPA,X
841300200529     C**
841400200529     C**   CHECK FOR FULL ARRAY.96 ON IF FULL.
841500200529     C           X         COMP 200                      96
841600200529     C**
841700200529     C**   GO TO READ NEXT RECORD.
841800200529     C  N96                GOTO XLOOP
841900200529     C**
842000200529     C           XEND      TAG                             ** XEND TAG  **
842100200529     C                     ENDSR
842200200529     C**
842300200529     C********************************************************************
842400200529     C/EJECT
842500200529     C********************************************************************
842600200529     C**
842700200529     C** ZICD subroutine to find number of days to calculate interest
842800200529     C**      according to calculation basis
842900200529     C**
843000200529     C**     Called by       BOTHSR, CRSR, DAYTSR, DRSR, ITYPCR,
843100200529     C**                     ITYPDR, TOTSR
843200200529     C**
843300200529     C**     Calls           DBSR
843400200529     C**
843500200529     C           ZICD      BEGSR                           **ZICD BEGSR**
843600200529     C*
843700200529     C* TO DETERMINE NUMBER OF DAYS INTEREST TO BE CALCULATED
843800200529     C*
843900200529     C           ZIEND     SUB  ZIBEG     ZDAYN1
844000200529     C*
844100200529     C* CHECK FOR INTEREST CALCULATION BASIS
844200200529     C*
844300200529     C           ZICALC    IFEQ 3                          - B1
844400200529     C           ZICALC    OREQ 0                                                             CER016
844500200529     C/COPY WNCPYSRC,RE3765C026
844600200529     C           ZIEND     IFGT ZIBEG                      - B2
844700200529     C*
844800200529     C** CALCULATING DATE FROM DAY NUMBER (BEGINNING DATE)
844900200529     C*
845000200529     C                     Z-ADDZIBEG     ZDAYNO
845100200529     C                     EXSR ZDATE2
845200200529     C*
845300200529     C                     Z-ADDZDATE     SRES
845400200529     C*
845500200529     C** CALCULATING DATE FROM DAY NUMBER (FINISHING DATE)
845600200529     C*
845700200529     C                     Z-ADDZIEND     ZDAYNO
845800200529     C                     EXSR ZDATE2
845900200529     C*
846000200529     C                     Z-ADDZDATE     FRES
846100200529     C*
846200200529     C** IN ORDER FOR THE FINISH YEAR TO BE LESS THAN THE START YEAR IF ZIEND
846300200529     C** IS GREATER THAN ZIBEG, THEN THE DATE ZIEND MUST BE IN A DIFFERENT
846400200529     C** CENTURY TO ZIBEG. IF SO ADD 100 YEARS TO IT.
846500200529     C*
846600200529     C           ZIFY      IFLT ZISY                       - B3
846700200529     C           ZIFY      ADD  100       ZIFY2   30
846800200529     C                     ELSE                            - X3
846900200529     C                     Z-ADDZIFY      ZIFY2
847000200529     C                     END                             - E3
847100200529     C*
847200200529     C                     Z-ADDZISY      ZISY2   30
847300200529     C*
847400200529     C** DETERMINE WHETHER START YEAR IS A LEAP YEAR AND IF START MONTH
847500200529     C** IS FEBRUARY  THEN CONSIDER LAST DAY OF FEBRUARY AS DATE 30ND. OF THE
847600200529     C*  MONTH
847700200529     C*
847800200529     C           ZICALC    IFEQ 3                                                             CER016
847900200529     C           ZICALC    OREQ 0                                                             CER016
848000200529     C           CER016    ANDEQ'N'                                                           CER016
848100200529      *                                                                                       CER016
848200200529     C           ZISM      IFEQ 2                          - B3
848300200529     C           ZISY2     ADD  1900      ZLYCHK  40
848400200529     C           ZLYCHK    DIV  4         ZLYCHK
848500200529     C                     MVR            ZLYREM  20
848600200529     C           ZLYREM    IFEQ 0                          - B4
848700200529     C           ZISD      IFEQ 29                         - B5
848800200529     C                     Z-ADD30        ZISD
848900200529     C                     END                             - E5
849000200529     C                     ELSE                            - X4
849100200529     C           ZISD      IFEQ 28                         - B5
849200200529     C                     Z-ADD30        ZISD
849300200529     C                     END                             - E5
849400200529     C                     END                             - E4
849500200529     C                     END                             - E3
849600200529      *                                                                                       CER016
849700200529     C                     ENDIF                                                              CER016
849800200529     C*
849900200529     C           30        SUB  ZISD      ZID1
850000200529     C*
850100200529     C           ZID1      IFLT 0                          - B3
850200200529     C                     Z-ADD*ZEROS    ZID1
850300200529     C                     END                             - E3
850400200529     C*
850500200529     C           ZISM      IFEQ 12                         - B3
850600200529     C                     Z-ADD*ZEROS    ZISM
850700200529     C                     ADD  1         ZISY
850800200529     C                     ADD  1         ZISY2
850900200529     C                     END                             - E3
851000200529     C*
851100200529     C** DETERMINE WHETHER END YEAR IS A LEAP YEAR AND IF END MONTH IS FEBRUARY
851200200529     C*
851300200529     C           ZICALC    IFEQ 3                                                             CER016
851400200529     C           ZICALC    OREQ 0                                                             CER016
851500200529     C           CER016    ANDEQ'N'                                                           CER016
851600200529      *                                                                                       CER016
851700200529     C           ZIFM      IFEQ 2                          - B3
851800200529     C           ZIFY2     ADD  1900      ZLYCHK  40
851900200529     C           ZLYCHK    DIV  4         ZLYCHK
852000200529     C                     MVR            ZLYREM  20
852100200529     C           ZLYREM    IFEQ 0                          - B4
852200200529     C           ZIFD      IFEQ 29                         - B5
852300200529     C                     Z-ADD30        ZIFD
852400200529     C                     END                             - E5
852500200529     C                     ELSE                            - X4
852600200529     C           ZIFD      IFEQ 28                         - B5
852700200529     C                     Z-ADD30        ZIFD
852800200529     C                     END                             - E5
852900200529     C                     END                             - E4
853000200529     C                     END                             - E3
853100200529      *                                                                                       CER016
853200200529     C                     ENDIF                                                              CER016
853300200529     C*
853400200529     C           ZIFD      IFEQ 31                         - B3
853500200529     C                     ADD  30        ZID1
853600200529     C                     ELSE                            - X3
853700200529     C                     ADD  ZIFD      ZID1
853800200529     C                     END                             - E3
853900200529     C*
854000200529     C                     SUB  1         ZIFM
854100200529     C*
854200200529     C           ZISY      IFEQ ZIFY                       - B3
854300200529     C           ZIFM      SUB  ZISM      ZINOM   30
854400200529     C                     ELSE                            - X3
854500200529     C           12        SUB  ZISM      ZIM1
854600200529     C                     Z-ADD1         ZISM
854700200529     C*
854800200529     C** USE ENLARGE FIELDS THAT CAN HANDLE 1999 ONWARDS
854900200529     C*
855000200529     C                     ADD  1         ZISY2
855100200529     C           ZIFY2     SUB  ZISY2     ZIY1
855200200529     C           ZIY1      MULT 12        ZIM2    30
855300200529     C           ZIM2      ADD  ZIFM      ZIM2
855400200529     C           ZIM2      ADD  ZIM1      ZINOM
855500200529     C*
855600200529     C                     END                             - E3
855700200529     C*
855800200529     C           ZINOM     MULT 30        ZID2
855900200529     C           ZID2      ADD  ZID1      ZDAYN1
856000200529     C*
856100200529     C                     END                             - E2
856200200529     C*
856300200529     C                     END                             - E1
856400200529     C*
856500200529     C           ZICALC    IFEQ 4                          - B1
856600200529     C           ZICALC    OREQ 5
856700200529     C*
856800200529     C** ONE DAY IS SUBTRACTED FROM ZDAYN1 FOR EACH OCCURANCE OF 29 FEB IN THE
856900200529     C** THE INTEREST CALCULATION PERIOD INCLUSIVE OF ZIBEG AND ZIEND
857000200529     C*
857100200529     C** FIND NO OF FOUR YEAR PERIODS BETWEEN DATES
857200200529     C*
857300200529     C           ZDAYN1    DIV  1461      ZIMAN
857400200529     C                     MVR            ZIREM
857500200529     C*
857600200529     C** FIND NEXT 29 FEB DAY NO. ON OR AFTER ZIBEG.
857700200529     C*
857800200529     C           ZIBEG     SUB  60        ZIBW1
857900200529     C           ZIBW1     DIV  1461      ZIDW1
858000200529     C                     MVR            ZIDREM
858100200529     C*
858200200529     C           ZIDREM    IFEQ 0                          - B2
858300200529     C                     Z-ADDZIBEG     ZIDW2
858400200529     C                     END                             - E2
858500200529     C*
858600200529     C** ROUND UP RESULT
858700200529     C*
858800200529     C           ZIDW1     ADD  1         ZIDW2
858900200529     C*
859000200529     C** CALCULATE NEXT 29 FEB.
859100200529     C*
859200200529     C           ZIDW2     MULT 1461      ZIDW2
859300200529     C           ZIDW2     ADD  60        ZIDW2
859400200529     C*
859500200529     C** IF THIS NEXT 29 FEB. DAYNO - ZIBEG IS GREATER OR EQUAL TO ZIREM THEN
859600200529     C** ADD 1 TO ZIMAN.
859700200529     C*
859800200529     C           ZIDW2     SUB  ZIBEG     ZILPCP
859900200529     C*
860000200529     C           ZIREM     IFGE ZILPCP                     - B2
860100200529     C                     ADD  1         ZIMAN
860200200529     C                     END                             - E2
860300200529     C*
860400200529     C** SUBTRACT ZIMAN FROM ZDAYN1 TO GIVE VALUE OF ZDAYN1 REQUIRED FOR THIS
860500200529     C** INTEREST CALCULATION
860600200529     C*
860700200529     C           ZDAYN1    SUB  ZIMAN     ZDAYN1
860800200529     C*
860900200529     C                     END                             - E1
861000200529     C*
861100200529     C                     ENDSR                           **ZICD ENDSR**
861200200529     C********************************************************************
861300200529     C*
861400200529     C* *PSSR  --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS
861500200529     C*
861600200529     C* CALLED FROM: AFTER ABNORNAL OPERATION OCCURS
861700200529     C*
861800200529     C* CALLS: NOTHING
861900200529     C*
862000200529     C********************************************************************
862100200529     C*
862200200529     C           *PSSR     BEGSR                           ** *PSSR **
862300200529     C*
862400200529     C           @RUN      IFEQ *BLANKS
862500200529     C                     MOVE 'Y'       @RUN    1
862600200529     C                     DUMP
862700200529     C                     END
862800200529     C*
862900200529     C                     ENDSR                           ** *PSSR **
863000200529     C********************************************************************
863100200529     C**
863200200529     C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
863300200529     C**
863400200529     C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
863500200529     C**
863600200529     C           ZDATE2    BEGSR                           *** ZDATE2 ***
863700200529     C**
863800200529     C**   CLEAR LEAP YEAR WORK FIELD.
863900200529     C                     MOVE 'N'       ZLEAP   1
864000200529     C**
864100200529     C**   CLEAR DATE FIELDS.
864200200529     C                     Z-ADD0         ZDATE   60
864300200529     C                     MOVEL'       ' ZADATE  7
864400200529     C**
864500200529     C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
864600200529     C                     Z-ADDZDAYNO    ZDAYNO  50
864700200529     C**
864800200529     C**   DETERMINE YEAR NUMBER.
864900200529     C**
865000200529     C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
865100200529     C           ZDAYNO    SUB  1         ZDAYN1  50
865200200529     C           ZDAYN1    IFLT 0
865300200529     C                     GOTO ZDEND2
865400200529     C                     END
865500200529     C**
865600200529     C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
865700200529     C           ZDAYN1    DIV  1461      ZLYR    20
865800200529     C                     MVR            ZDAYN1           SAVE REMAINING
865900200529     C**                                                   DAYS
866000200529     C**   CALCULATE NUMBER OF REMAINING YEARS.
866100200529     C                     Z-ADD1         ZWRK2   20
866200200529     C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
866300200529     C           ZDAYN1    IFGE ZYDY,ZWRK2
866400200529     C           ZWRK2     ADD  1         ZWRK2
866500200529     C                     GOTO ZDTAG1
866600200529     C                     END
866700200529     C*
866800200529     C           ZWRK2     SUB  1         ZWRK2
866900200529     C**
867000200529     C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
867100200529     C           ZWRK2     IFNE 0
867200200529     C           ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
867300200529     C                     END
867400200529     C**
867500200529     C**   CALCULATE ACTUAL YEAR NUMBER.
867600200529     C           ZLYR      MULT 4         ZWRK3   30
867700200529     C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
867800200529     C                     Z-ADDZWRK3     ZYEAR   20
867900200529     C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
868000200529     C**
868100200529     C**   DETERMINE MONTH NUMBER.
868200200529     C**
868300200529     C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
868400200529     C           ZWRK2     IFEQ 0
868500200529     C           ZDAYN1    IFEQ 59
868600200529     C                     MOVE 'Y'       ZLEAP
868700200529     C                     END
868800200529     C           ZDAYN1    IFGE 59
868900200529     C           ZDAYN1    SUB  1         ZDAYN1
869000200529     C                     END
869100200529     C                     END
869200200529     C**
869300200529     C**   CALCULATE MONTH NUMBER.
869400200529     C                     Z-ADD2         ZWRK2
869500200529     C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
869600200529     C           ZDAYN1    IFGE ZMDY,ZWRK2
869700200529     C           ZWRK2     ADD  1         ZWRK2
869800200529     C                     GOTO ZDTAG2
869900200529     C                     END
870000200529     C*
870100200529     C           ZWRK2     SUB  1         ZWRK2
870200200529     C**
870300200529     C                     Z-ADDZWRK2     ZMTH    20       MONTH
870400200529     C**
870500200529     C**   DETERMINE DAY OF MONTH.
870600200529     C**
870700200529     C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
870800200529     C           ZDAYN1    ADD  1         ZDAYN1
870900200529     C**
871000200529     C**   CALCULATE DAY OF MONTH.
871100200529     C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
871200200529     C**
871300200529     C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
871400200529     C           ZLEAP     IFEQ 'Y'
871500200529     C           ZDAY      ADD  1         ZDAY
871600200529     C                     END
871700200529     C**
871800200529     C**   FORMAT DATE, DDMMYY OR MMDDYY.
871900200529     C  N98                MOVELZDAY      ZWRK4   40
872000200529     C   98                MOVE ZDAY      ZWRK4
872100200529     C  N98                MOVE ZMTH      ZWRK4
872200200529     C   98                MOVELZMTH      ZWRK4
872300200529     C                     MOVELZWRK4     ZDATE
872400200529     C                     MOVE ZYEAR     ZDATE
872500200529     C**
872600200529     C**   FORMAT ALPHA DATE, DDMMMYY.
872700200529     C                     MOVELZDAY      ZWRK5   5
872800200529     C           ZDAY      IFLT 10
872900200529     C                     MOVEL' '       ZWRK5
873000200529     C                     END
873100200529     C                     MOVE ZMNM,ZMTH ZWRK5
873200200529     C                     MOVELZWRK5     ZADATE
873300200529     C                     MOVE ZYEAR     ZADATE
873400200529     C**
873500200529     C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
873600200529     C**
873700200529      ******************************************************************                      CER050
873800200529      * SRAPRC - Credit Output Processing                                                     CER050
873900200529      ******************************************************************                      CER050
874000200529      *                                                                                       CER050
874100200529     C           SRAPRC    BEGSR                                                              CER050
874200200529      *                                                                                       CER050
874300200529     C           ACNO      CHAINREAPRHI1             62                                       CER050
874400200529     C                     MOVELAPRCRT    TANAR                                               CER050
874500200529     C           *IN62     IFEQ *OFF                                                          CER050
874600200529     C                     WRITEAPRDC                                                         CER050
874700200529     C                     ENDIF                                                              CER050
874800200529      *                                                                                       CER050
874900200529     C                     ENDSR                                                              CER050
875000200529      ******************************************************************                      CER050
875100200529      * SRAPRD - Debit Output Processing                                                      CER050
875200200529      ******************************************************************                      CER050
875300200529      *                                                                                       CER050
875400200529     C           SRAPRD    BEGSR                                                              CER050
875500200529      *                                                                                       CER050
875600200529     C           ACNO      CHAINREAPRHI0             61                                       CER050
875700200529     C                     MOVELAPRDRT    TANAR                                               CER050
875800200529     C           *IN61     IFEQ *OFF                                                          CER050
875900200529     C                     WRITEAPRDC                                                         CER050
876000200529     C                     ENDIF                                                              CER050
876100200529      *                                                                                       CER050
876200200529     C                     ENDSR                                                              CER050
876300200529      ******************************************************************                      CER050
876400200529     C/COPY WNCPYSRC,RE3765C033
876500200529     C**
876600200529     C********************************************************************
876700200529**   CMD - COMMAND TO OVERIDE MESSAGE FILE
876800200529OVRMSGF MSGF(  REPTMSGF) TOMSGF(GBREPTMSGF)
876900200529**  CPY@
877000200529(c) Finastra International Limited 2001
877100200529**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
8772002005290366073110961461
877300200529**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
877400200529000031059090120151181212243273304334365
877500200529**   ZMNM - MONTHS SHORT NAMES
877600200529JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
