     H        1
     F*****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas RE Cash Mgt Check First 3 char = CMS')
      *****************************************************************
      *                                                               *
      *  Midas - Retail Module                                        *
      *                                                               *
      *  RECMCMS  - RE Cash Management First 3 Chars = CMS            *
      *                                                               *
      *  Function:  This user check program will check if the         *
      *             given field has its first 3 characters equal to   *
      *             CMS                                               *
      *                                                               *
      *  Called By: ME1501  -  Auto-Gen Criteria Analysis             *
      *                                                               *
      *  (c) Finastra International Limited 2002                      *
      *                                                               *
      *  Last Amend No. AR936178           Date 17Apr12               *
      *  Prev Amend No. AR928996A          Date 03May12               *
      *                 AR928996           Date 27Mar12               *
      *                 MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 BUG24998           Date 17Jul09               *
      *                 CSW209             Date 01Apr09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CRE008  *CREATE    Date 15Apr02               *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  AR936178 - Processing fails because DS definition is wrong.  *
      *             Update DS WUFDDT to reflect 10 digit ACCOD        *
      *             (Child: AR936179)                                 *
      *  AR928996A- Data truncation error. Amended PDATA and PDAT2    *
      *             data structure field to have the correct length.  *
      *             (Child: AR928997A)                                *
      *  AR928996 - Data lost due to rate field :36: being truncated. *
      *             (Child: AR928997)                                 *
      *  MD046248 - Finastra Rebranding                               *
      *  BUG24998 - Bank operation code is missing (Recompile)        *
      *  CSW209 - SWIFT 2009 Changes                                  *
      *  CRE008 - Cash Management                                     *
      *                                                               *
      *****************************************************************
      /EJECT
     E                    CPY@    1   1 80
      ** Array containing Copyright statement
      *
     E/COPY MECPYSRC,SRERRE
     I/COPY MECPYSRC,SME1100P
     I            DS
      *
      *  Split the detail fields into field tag name and contents
      *
     I                                        1 256 WUFDDT
     I                                        1   5 WUMTAG
     I                                        6   6 WUFDIN
     I                                        6 256 WUTGCK
     I                                        7 256 WUTGVL
     I                                        7  24 WUACCO
     I                                        7  120WUCNUM
     I                                        7  12 WUCNUA
     I                                       13  15 WUCURR
     I                                       16  250WUACCD                                  AR936178
     I                                       16  25 WUACCA                                  AR936178
     I                                       26  270WUACSQ                                  AR936178
     I                                       26  27 WUACSA                                  AR936178
     I                                       28  30 WUBRCA                                  AR936178
     I                                       31 256 WUORIG                                  AR936178
     I                                       31  33 @CODE                                   AR936178
      *                                                                                     AR936178
     I**********                             16  190WUACCD                                  AR936178
     I**********                             16  19 WUACCA                                  AR936178
     I**********                             20  210WUACSQ                                  AR936178
     I**********                             20  21 WUACSA                                  AR936178
     I**********                             22  24 WUBRCA                                  AR936178
     I**********                             25 256 WUORIG                                  AR936178
      **********                                                                            AR936178
     I**********                             25  27 @CODE                                   AR936178
      *
     I            DS
     I                                        1   5 WMTAG
     I                                        1   1 BLANK
      *
      *****************************************************************
      *
      ** Define entry parameters
     C           *ENTRY    PLIST
      ** Return Code Parameter
     C                     PARM           RTNCDE  7
      ** Incoming Message Header
     C                     PARM           PHEAD
      ** Incoming Message Data
     C                     PARM           PDATA
     C                     PARM           PDAT2                                               CSW209
      ** Subset of FT message data relating for a specific message tag
     C                     PARM           SBSMSG251
      ** Pattern which can be applied to the function
     C                     PARM           PATTRN 32
      ** Operator (GE, LE, GT, LT)
     C                     PARM           POPER   2
      ** Message tag
     C                     PARM           PMTAG   5
      ** Logging require
     C                     PARM           PREPT   1
      ** Program for messages
     C                     PARM           PCPGM  10
      ** Return Field
     C                     PARM           RETFLD256
      *
     C                     MOVEACPY@      CPY2@  80
      *
      * Begin Processing
      *
     C                     MOVE *BLANK    Q       50
     C                     MOVE PCPGM     ##PGM  10
     C                     MOVEL'F'       RTNCDE    P
     C                     MOVELSBSMSG    WUTGCK
     C                     MOVE *BLANK    RETFLD
      *
      * Check first 3 charcters = CMS
     C           @CODE     IFEQ 'CMS'
     C           POPER     ANDEQ'EQ'
     C                     MOVEL'T'       RTNCDE    P
     C                     ENDIF
      *
      *  Log, if test failed.
     C           PREPT     IFEQ 'Y'
     C           RTNCDE    ANDNE'T      '
     C                     MOVE PMTAG     WMTAG
     C           BLANK     IFEQ *BLANK
     C           PMTAG     CAT  POPER:1   MEMSDT    P
     C                     ELSE
     C           PMTAG     CAT  POPER:1   MEMSDT    P
     C                     ENDIF
     C                     MOVELPCPGM     MEPGMQ
     C                     MOVEL'RE75400' MEMSID
     C                     MOVEL'REUSRMSG'MEMSGF           Msg file
     C                     EXSR MESNMS
     C                     ENDIF
      *
     C                     RETRN
     C/COPY MECPYSRC,SMESNMSC
      *****************************************************************
      /EJECT
      *****************************************************************
**  CPY@
(c) Finastra International Limited 2002
