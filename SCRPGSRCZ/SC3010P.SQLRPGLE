     H DATEDIT(*YMD)
      *****************************************************************
/**** *  RPGBASE                                                      *                     MD055681
/*STD *  RPGSQLBND                                                    *                     MD055681
/*EXI *  TEXT('Midas SC Switchable features report - all')
     H/TITLE Midas SC Switchable features report - all
     F* CRTRPGPGM
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by  : SYNON/2  Version:  1080
     H* Function type : Print file
      *
     H* Company       : Close of Business SYNON model
     H*  System  : Midas COB
     H* User name     : HAUT
     H* Date          : 09/07/93  Time  : 19:40:28
      *  (c) Finastra International Limited 2001                      *
      *
      *================================================================
     F* Maintenance   :
      *================================================================
     F********************************************************************
     F*  P R O G R A M     C R E A T I O N     P A R A M E T E R S    *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     F********************************************************************
     F*                                                                  *
      *  Last Amend No. MD056561           Date 31Aug20               *
      *  Prev Amend No. MD055681           Date 31Jul20               *
      *                 MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSF002             Date 11Sep03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 S01430             Date 07Jul93               *
      *                 S01407             Date 20Jan93               *
     F*                                                                  *
     F********************************************************************
     F*                                                                  *
      *  MD056561 - Deliverable Data Split for SFMENUPD and GPMTXTPD  *
      *  MD055681 - Deliverable Data Split for SAR                    *
      *  MD046248 - Finastra Rebranding                               *
      *  CSF002 - Global Processing SPF changes                       *
     F*     S01430 - SWITCHABILITY ENHANCEMENTS PHASE 2                  *
     F*              INCLUSION OF SWITCHABLE FEATURE INITIALISATION      *
     F*              PROGRAMS                                            *
     F*     S01407 - SWITCHABILITY ENHANCEMENTS                          *
     F*                                                                  *
     F********************************************************************
     F*SCSARDL1* IF   E           K DISK                                                    MD055681
      * RTV : Midas SC Switchable features description
      *
     FSCSARCL1  IF   E           K DISK
      * RTV : Midas SC Switchable f - COB components
      *
     FSCSAROL3  IF   E           K DISK
      * RSQ : Midas SC Switchable f - object name (PF)
      *
     F*SCSARIL1IF**E*          K        DISK                                                  CSF002
     FSCSARIL4  IF   E           K DISK
      * RTV : Midas SC Switchable f - menu items
      *
     FSCSARRL1  IF   E           K DISK
      * RTV : Midas SC Switchable f - report name
      *
     FSCSARML1  IF   E           K DISK
      * RTV : Midas SC Switchable f - report components
      *
     FSCSAROL4  IF   E           K DISK
      * RSQ : Midas SC Switchable f - object name (PRFT)
      *
     FSCSARPL1  IF   E           K DISK
      * RTV : Midas SC Switchable f - initialisation pgm
      *
     F*GPMTXTL0* IF   E           K DISK                                                    MD056561
      ** Global menu item by Unique Code                                                      CSF002
      *                                                                                       CSF002
     FSC3010P1  O    E             PRINTER OFLIND(*IN97)
     F                                     INFDS(INFDS$)
      * PRT: Midas SC Switchable features report - all
      *
     D* Description     : Copyright notice for inclusion in all programs
     D*
     D********************************************************************
      *
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      6  0
     D  ##JYY                  1      2  0
     D  ##JMM                  3      4  0
     D  ##JDD                  5      6  0
     D  ##JTM                  7     12  0
     D  ##JHH                  7      8  0
     D  ##JNN                  9     10  0
     D  ##JSS                 11     12  0
     D A@CPY           DS
     D* Copyright array
     D  CPY@                   1     80
     D                                     DIM(1) CTDATA PERRCD(1)              Copyright     array
     D RUNDAT          DS
     D  MRDT                   1      7
     D  RDNB                   8     10P 0
     D  SUC                   11     11
     D  DFF                   12     12
     D  MBIN                  13     13
     D P@BANK        E DS                  EXTNAME(SDBANKPD)
      * @BTREE4 - BANK RECORD FORMAT DATA STRUCTURE
      *
     D P@FMT         E DS                  EXTNAME(DSFDY)
     D* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE
     D*
      *
     D INFDS$        E DS                  EXTNAME(Y2I$DSP)
      * Printer file information data structure
      *
     D P@CMPN        E DS                  EXTNAME(CBCMPNPD)
     D SCSARD        E DS                  EXTNAME(SCSRDJW0)                                MD055681
     D                                     PREFIX(AB)                                       MD055681
     D GPMTXT        E DS                  EXTNAME(GPMTXJW0)                                MD056561
     I*
     I* Description     : Copyright notice for inclusion in all programs
     I*
      * Renamed input format fields
     I@SAROL4
      *  Midas - SC Switchable f - object name (PRFT)                 *
     I              AFSARN                      WASARN
     I              AFOBNM                      WAOBNM
     I              AFOBTP                      WAOBTP
     I              AFOBAT                      WAOBAT
     I              AFAVAL                      WAAVAL
     I              AFOBTX                      WAOBTX
     I              AFLCD                       WALCD
     I              AFTYLC                      WATYLC
     I
      *
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN             7
      *****************************************************************
      * Initialise
     C                   EXSR      ZZINIT
      *
      * Print  Switchable F - All: Mainline
     C                   EXSR      A0MAIN
      * Print headers then End of report format
     C                   EXSR      Q0PRNT
     C                   WRITE     $WENDRPT
      * Exit program
     C                   EXSR      ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR   A0MAIN        BEGSR
      *================================================================
      * Print  Switchable F - All: Mainline
      *================================================================
      * Establish starting position
     C******LOVAL        SETLL     @SARDL1                                      *           MD055681
     C/EXEC SQL                                                                             MD055681
     C+ declare ACursor insensitive scroll cursor for                                       MD055681
     C+ select * from SCSRDJW0                                                              MD055681
     C+ order by SARN                                                                       MD055681
     C/END-EXEC                                                                             MD055681
                                                                                            MD055681
     C/EXEC SQL                                                                             MD055681
     C+ open ACursor                                                                        MD055681
     C/END-EXEC                                                                             MD055681
                                                                                            MD055681
      * Read first record with user selection
     C                   EXSR      A3READ
     C     W0EOFA        IFNE      '0'                                          IF
     C                   ELSE
      * Request all headings
     C                   MOVEL     'Y'           W0AL1P            1            First page
      * Set column headings flag
     C                   MOVE      'Y'           W0ACDT
      * Print report body
     C     W0EOFA        DOWEQ     '0'                                          DOW
      * Prepare heading formats for printing
     C                   EXSR      A1PHDR
      * Print report detail line
     C                   EXSR      A2PDTL
      * Read next record with user selection
     C                   EXSR      A3READ
      * Print totals
     C                   EXSR      A4PTOT
     C                   END                                                    WOD
     C                   END                                                    FI
      *================================================================
     CSR   A0EXIT        ENDSR
      /EJECT
     CSR   A1PHDR        BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C     W0AL1P        IFEQ      'Y'
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0AP1P            1
     C                   END
      *
      *================================================================
     CSR   A1EXIT        ENDSR
      /EJECT
     CSR   A2PDTL        BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                   MOVEL     ABSARN        $BSARN                         Switchable Feat
     C                   MOVEL     ABSARD        $BSARD                         Description
     C                   Z-ADD     ABLCD         $BLCD                          Last change dat
     C                   MOVEL     *BLANK        $BACDT                         Alpha Change Da
     C                   MOVEL     ABTYLC        $BTYLC                         Type of the Las
     C                   MOVEL     *BLANK        $BALCH                         Alpha of Last C
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0APDT            1
      * Call print routine
     C                   EXSR      Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : Printo Switchable F - COB
     C                   EXSR      UASUBR                                       Embedded PRTOBJ
      * Embedded PRTOBJ : Printo Switchable F - PF
     C                   EXSR      UBSUBR                                       Embedded PRTOBJ
      * Embedded PRTOBJ : Printo Switchable F - Men
     C                   EXSR      UCSUBR                                       Embedded PRTOBJ
      * Embedded PRTOBJ : Printo Switchable F - Rep
     C                   EXSR      UDSUBR                                       Embedded PRTOBJ
      * Embedded PRTOBJ : Printo Switchable F - Rep
     C                   EXSR      UESUBR                                       Embedded PRTOBJ
      * Embedded PRTOBJ : Printo Switchable F -PRTF
     C                   EXSR      UFSUBR                                       Embedded PRTOBJ
      * Embedded PRTOBJ : Printo Switchable F - Ini
     C                   EXSR      UGSUBR                                       Embedded PRTOBJ
      *
      *================================================================
     CSR   A2EXIT        ENDSR
      /EJECT
     CSR   A3READ        BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
      * Read next record
     C     W0RSL         DOUEQ     'Y'                                          DOU
     C     W0EOFA        OREQ      '1'
     C**********         READ      @SARDL1                                90    *           MD055681
     C/EXEC SQL                                                                             MD055681
     C+ fetch next from ACursor into :SCSARD                                                MD055681
     C/END-EXEC                                                                             MD055681
                                                                                            MD055681
      * Transfer error indicator to EOF flag
     C**********         MOVEL     *IN90         W0EOFA            1                        MD055681
     C                   MOVEL     '0'           W0EOFA            1                        MD055681
     C                   IF        SQLCODE = 100                                            MD055681
     C                   MOVEL     '1'           W0EOFA                                     MD055681
     C                   ENDIF                                                              MD055681
      * Quit if no record read
     C     W0EOFA        IFNE      '1'                                          IF
      * Select record unless user action states otherwise
     C                   MOVEL     'Y'           W0RSL             1
     C                   END                                                    FI
     C                   END                                                    UOD
      *
      * Reset key level breaks
     C     W0EOFA        IFEQ      '1'
      * End of file - Signal all level breaks
     C                   ELSE
      * Next record - Detect level breaks
     C                   END
      *================================================================
     CSR   A3EXIT        ENDSR
      /EJECT
     CSR   A4PTOT        BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C     W0EOFA        IFEQ      '1'
     C                   END
      *
      *================================================================
     CSR   A4EXIT        ENDSR
      /EJECT
     CSR   B0MAIN        BEGSR
      *================================================================
      * Printo Switchable F - COB: Mainline
      *================================================================
      * Declare restrictor key work fields
     C     *LIKE         DEFINE    ACSARN        WQKB01                         Switchable Feat
      * Define keylist
     C     KRSB          KLIST
     C                   KFLD                    WQKB01                         Switchable Feat
      * Move fields to key list
     C                   MOVEL     $BSARN        WQKB01                         Switchable Feat
      * Establish starting position
     C     KRSB          SETLL     @SARCL1                                      *
      * Read first record with user selection
     C                   EXSR      B3READ
     C     W0EOFB        IFNE      '0'                                          IF
     C                   ELSE
      * Request all headings
     C                   MOVEL     'Y'           W0BL1P            1            First page
     C                   MOVEL     'Y'           W0BL00            1            Switchable Feat
     C                   MOVEL     'Y'           W0BL01            1            Component Name
      * Set column headings flag
     C                   MOVE      'Y'           W0BCDT
      * Print report body
     C     W0EOFB        DOWEQ     '0'                                          DOW
      * Prepare heading formats for printing
     C                   EXSR      B1PHDR
      * Print report detail line
     C                   EXSR      B2PDTL
      * Read next record with user selection
     C                   EXSR      B3READ
      * Print totals
     C                   EXSR      B4PTOT
     C                   END                                                    WOD
     C                   END                                                    FI
      *================================================================
     CSR   B0EXIT        ENDSR
      /EJECT
     CSR   B1PHDR        BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C     W0BL1P        IFEQ      'Y'
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0BP1P            1
     C                   END
      *
     C     W0BL00        IFEQ      'Y'
      * Load key header format
     C                   MOVEL     ACSARN        $CSARN                         Switchable Feat
      * Load related totals format
     C                   MOVEL     ACSARN        $ESARN                         Switchable Feat
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0BP00            1
     C                   END
      *
     C     W0BL01        IFEQ      'Y'
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0BP01            1
     C                   END
      *
      *================================================================
     CSR   B1EXIT        ENDSR
      /EJECT
     CSR   B2PDTL        BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                   MOVEL     ACSARN        $DSARN                         Switchable Feat
     C                   MOVEL     ACCOTT        $DCOTT                         Component Name
     C                   MOVEL     ACCSEQ        $DCSEQ                         Component Seque
     C                   MOVEL     *BLANK        $DTXTC                         Description of
     C                   MOVEL     ACAVAL        $DAVAL                         Avail if featur
     C                   Z-ADD     ACLCD         $DLCD                          Last change dat
     C                   MOVEL     *BLANK        $DACDT                         Alpha Change Da
     C                   MOVEL     *BLANK        $DALCH                         Alpha of Last C
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0BPDT            1
      * Call print routine
     C                   EXSR      Q0PRNT
      *
      *================================================================
     CSR   B2EXIT        ENDSR
      /EJECT
     CSR   B3READ        BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C     *LIKE         DEFINE    ACSARN        WZB001                         Switchable Feat
     C                   MOVEL     ACSARN        WZB001
     C     *LIKE         DEFINE    ACCOTT        WZB002                         Component Name
     C                   MOVEL     ACCOTT        WZB002
      * Read next record
     C     W0RSL         DOUEQ     'Y'                                          DOU
     C     W0EOFB        OREQ      '1'
     C     KRSB          READE     @SARCL1                                90    *
      * Transfer error indicator to EOF flag
     C                   MOVEL     *IN90         W0EOFB            1
      * Quit if no record read
     C     W0EOFB        IFNE      '1'                                          IF
      * Select record unless user action states otherwise
     C                   MOVEL     'Y'           W0RSL             1
     C                   END                                                    FI
     C                   END                                                    UOD
      *
      * Reset key level breaks
     C                   MOVEL     *BLANK        W0BL00            1            Switchable Feat
     C                   MOVEL     *BLANK        W0BL01            1            Component Name
     C     W0EOFB        IFEQ      '1'
      * End of file - Signal all level breaks
     C                   MOVEL     'Y'           W0BL00            1            Switchable Feat
     C                   MOVEL     'Y'           W0BL01            1            Component Name
     C                   ELSE
      * Next record - Detect level breaks
     C     ACSARN        IFNE      WZB001                                       Switchable Feat
      * Set on level break indicator
     C                   MOVEL     'Y'           W0BL00
     C                   END
     C     ACCOTT        IFNE      WZB002                                       Component Name
     C     W0BL00        OREQ      'Y'
      * Set on level break indicator
     C                   MOVEL     'Y'           W0BL01
     C                   END
     C                   END
      *================================================================
     CSR   B3EXIT        ENDSR
      /EJECT
     CSR   B4PTOT        BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C     W0BL01        IFEQ      'Y'
      * Signal header format is no longer ready
     C                   MOVEL     *BLANK        W0BP01
     C                   END
      *
     C     W0BL00        IFEQ      'Y'
      * If there is not enough space on the
      * physical page for this format:
     C     @$PGL         SUB       @$CLN         @$WRK
     C     @$WRK         IFLE      2
      * Signal new page required
     C                   MOVE      'Y'           W0NEWP
      * Start new page
     C                   EXSR      Q0PRNT
     C                   END
      * Print format
     C                   WRITE     $EKEYTTL
      * Signal header format is no longer ready
     C                   MOVEL     *BLANK        W0BP00
     C                   END
      *
     C     W0EOFB        IFEQ      '1'
      * USER: Process after print of final totals format
      * Close files in access program
     C                   MOVEL     *BLANK        WURTCD                         Access Obj Retu
     C                   MOVEL     *BLANK        WUOPTN                         Access Obj Acce
     C                   MOVEL     '*FREE'       WUOPTN                         Access Obj Acce
      * Get COB component SC3010P - Standard functions  *
     C*
     C** Move Synon work fields into parameters
     C*
     C                   CALL      'AOCMPNR0'
     C                   PARM                    WURTCD                         B:Return code
     C                   PARM                    WUOPTN                         I:Option
     C                   PARM                    WUCOTT                         Compnt name
     C                   PARM                    WUCSEQ                         Compnt seq no
     C     P@CMPN        PARM      P@CMPN        P@FMT                          O:Format
     C*
     C** If record found, copy component description to screen field
     C*
     C     WUOPTN        IFNE      '*FREE'
     C                   MOVEL     *BLANKS       $DTXTC
     C     WURTCD        IFEQ      *BLANKS
     C                   MOVEL     DHCTXT        $DTXTC
     C                   END
     C                   END
     C                   END
      *
      *================================================================
     CSR   B4EXIT        ENDSR
      /EJECT
     CSR   C0MAIN        BEGSR
      *================================================================
      * Printo Switchable F - PF: Mainline
      *================================================================
      * Declare restrictor key work fields
     C     *LIKE         DEFINE    AFSARN        WQKC01                         Switchable Feat
      * Define keylist
     C     KRSC          KLIST
     C                   KFLD                    WQKC01                         Switchable Feat
      * Move fields to key list
     C                   MOVEL     $BSARN        WQKC01                         Switchable Feat
      * Establish starting position
     C     KRSC          SETLL     @SAROL3                                      *
      * Read first record with user selection
     C                   EXSR      C3READ
     C     W0EOFC        IFNE      '0'                                          IF
     C                   ELSE
      * Request all headings
     C                   MOVEL     'Y'           W0CL1P            1            First page
     C                   MOVEL     'Y'           W0CL00            1            Switchable Feat
     C                   MOVEL     'Y'           W0CL01            1            Object Name
      * Set column headings flag
     C                   MOVE      'Y'           W0CCDT
      * Print report body
     C     W0EOFC        DOWEQ     '0'                                          DOW
      * Prepare heading formats for printing
     C                   EXSR      C1PHDR
      * Print report detail line
     C                   EXSR      C2PDTL
      * Read next record with user selection
     C                   EXSR      C3READ
      * Print totals
     C                   EXSR      C4PTOT
     C                   END                                                    WOD
     C                   END                                                    FI
      *================================================================
     CSR   C0EXIT        ENDSR
      /EJECT
     CSR   C1PHDR        BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C     W0CL1P        IFEQ      'Y'
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0CP1P            1
     C                   END
      *
     C     W0CL00        IFEQ      'Y'
      * Load key header format
     C                   MOVEL     AFSARN        $FSARN                         Switchable Feat
      * Load related totals format
     C                   MOVEL     AFSARN        $HSARN                         Switchable Feat
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0CP00            1
     C                   END
      *
     C     W0CL01        IFEQ      'Y'
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0CP01            1
     C                   END
      *
      *================================================================
     CSR   C1EXIT        ENDSR
      /EJECT
     CSR   C2PDTL        BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                   MOVEL     AFSARN        $GSARN                         Switchable Feat
     C                   MOVEL     AFOBNM        $GOBNM                         Object Name
     C                   MOVEL     AFOBTP        $GOBTP                         Object Type
     C                   MOVEL     AFOBAT        $GOBAT                         Object Attribut
     C                   MOVEL     AFOBTX        $GOBTX                         Object Descript
     C                   MOVEL     AFAVAL        $GAVAL                         Avail if featur
     C                   Z-ADD     AFLCD         $GLCD                          Last change dat
     C                   MOVEL     *BLANK        $GACDT                         Alpha Change Da
     C                   MOVEL     AFTYLC        $GTYLC                         Type of the Las
     C                   MOVEL     *BLANK        $GALCH                         Alpha of Last C
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0CPDT            1
      * Call print routine
     C                   EXSR      Q0PRNT
      *
      *================================================================
     CSR   C2EXIT        ENDSR
      /EJECT
     CSR   C3READ        BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C     *LIKE         DEFINE    AFSARN        WZC001                         Switchable Feat
     C                   MOVEL     AFSARN        WZC001
     C     *LIKE         DEFINE    AFOBNM        WZC002                         Object Name
     C                   MOVEL     AFOBNM        WZC002
      * Read next record
     C     W0RSL         DOUEQ     'Y'                                          DOU
     C     W0EOFC        OREQ      '1'
     C     KRSC          READE     @SAROL3                                90    *
      * Transfer error indicator to EOF flag
     C                   MOVEL     *IN90         W0EOFC            1
      * Quit if no record read
     C     W0EOFC        IFNE      '1'                                          IF
      * Select record unless user action states otherwise
     C                   MOVEL     'Y'           W0RSL             1
     C                   END                                                    FI
     C                   END                                                    UOD
      *
      * Reset key level breaks
     C                   MOVEL     *BLANK        W0CL00            1            Switchable Feat
     C                   MOVEL     *BLANK        W0CL01            1            Object Name
     C     W0EOFC        IFEQ      '1'
      * End of file - Signal all level breaks
     C                   MOVEL     'Y'           W0CL00            1            Switchable Feat
     C                   MOVEL     'Y'           W0CL01            1            Object Name
     C                   ELSE
      * Next record - Detect level breaks
     C     AFSARN        IFNE      WZC001                                       Switchable Feat
      * Set on level break indicator
     C                   MOVEL     'Y'           W0CL00
     C                   END
     C     AFOBNM        IFNE      WZC002                                       Object Name
     C     W0CL00        OREQ      'Y'
      * Set on level break indicator
     C                   MOVEL     'Y'           W0CL01
     C                   END
     C                   END
      *================================================================
     CSR   C3EXIT        ENDSR
      /EJECT
     CSR   C4PTOT        BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C     W0CL01        IFEQ      'Y'
      * Signal header format is no longer ready
     C                   MOVEL     *BLANK        W0CP01
     C                   END
      *
     C     W0CL00        IFEQ      'Y'
      * If there is not enough space on the
      * physical page for this format:
     C     @$PGL         SUB       @$CLN         @$WRK
     C     @$WRK         IFLE      2
      * Signal new page required
     C                   MOVE      'Y'           W0NEWP
      * Start new page
     C                   EXSR      Q0PRNT
     C                   END
      * Print format
     C                   WRITE     $HKEYTTL
      * Signal header format is no longer ready
     C                   MOVEL     *BLANK        W0CP00
     C                   END
      *
     C     W0EOFC        IFEQ      '1'
     C                   END
      *
      *================================================================
     CSR   C4EXIT        ENDSR
      /EJECT
     CSR   D0MAIN        BEGSR
      *================================================================
      * Printo Switchable F - Men: Mainline
      *================================================================
      * Declare restrictor key work fields
     C     *LIKE         DEFINE    ADSARN        WQKD01                         Switchable Feat
      * Define keylist
     C     KRSD          KLIST
     C                   KFLD                    WQKD01                         Switchable Feat
      * Move fields to key list
     C                   MOVEL     $BSARN        WQKD01                         Switchable Feat
      * Establish starting position
     C********** KRSD      SETLL@SARIL1                    *                                  CSF002
     C     KRSD          SETLL     SCSARID0
      * Read first record with user selection
     C                   EXSR      D3READ
     C     W0EOFD        IFNE      '0'                                          IF
     C                   ELSE
      * Request all headings
     C                   MOVEL     'Y'           W0DL1P            1            First page
     C                   MOVEL     'Y'           W0DL00            1            Switchable Feat
     C**********           MOVEL'Y'       W0DL01  1        Menu Group Code                    CSF002
      * Set column headings flag
     C                   MOVE      'Y'           W0DCDT
      * Print report body
     C     W0EOFD        DOWEQ     '0'                                          DOW
      * Prepare heading formats for printing
     C                   EXSR      D1PHDR
      * Print report detail line
     C                   EXSR      D2PDTL
      * Read next record with user selection
     C                   EXSR      D3READ
      * Print totals
     C                   EXSR      D4PTOT
     C                   END                                                    WOD
     C                   END                                                    FI
      *================================================================
     CSR   D0EXIT        ENDSR
      /EJECT
     CSR   D1PHDR        BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C     W0DL1P        IFEQ      'Y'
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0DP1P            1
     C                   END
      *
     C     W0DL00        IFEQ      'Y'
      * Load key header format
     C                   MOVEL     ADSARN        $ISARN                         Switchable Feat
      * Load related totals format
     C                   MOVEL     ADSARN        $KSARN                         Switchable Feat
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0DP00            1
     C                   END
      *
     C********** W0DL01    IFEQ 'Y'                                                           CSF002
      **Signal*that*format*is*now*ready*to*print**********************                        CSF002
     C**********           MOVE 'Y'       W0DP01  1                                           CSF002
     C**********           END                                                                CSF002
      *
      *================================================================
     CSR   D1EXIT        ENDSR
      /EJECT
     CSR   D2PDTL        BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                   MOVEL     ADSARN        $JSARN                         Switchable Feat
     C**********           MOVELADMGRP    $JMGRP           Menu Group Code                    CSF002
     C**********           MOVELADICDE    $JICDE           Menu Item Short                    CSF002
     C                   MOVEL     MISNAM        $JSNAM
     C                   MOVEL     ADRECI        $JRECI                         Record id
     C                   MOVEL     ADINAR        $JINAR                         Menu Item Narra
     C                   MOVEL     ADAVAL        $JAVAL                         Avail if featur
     C                   Z-ADD     ADLCD         $JLCD                          Last change dat
     C                   MOVEL     *BLANK        $JACDT                         Alpha Change Da
     C                   MOVEL     ADTYLC        $JTYLC                         Type of the Las
     C                   MOVEL     *BLANK        $JALCH                         Alpha of Last C
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0DPDT            1
      * Call print routine
     C                   EXSR      Q0PRNT
      *
      *================================================================
     CSR   D2EXIT        ENDSR
      /EJECT
     CSR   D3READ        BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C     *LIKE         DEFINE    ADSARN        WZD001                         Switchable Feat
     C                   MOVEL     ADSARN        WZD001
     C********** *LIKE     DEFN ADMGRP    WZD002           Menu Group Code                    CSF002
     C**********           MOVELADMGRP    WZD002                                              CSF002
      * Read next record
     C     W0RSL         DOUEQ     'Y'                                          DOU
     C     W0EOFD        OREQ      '1'
     C********** KRSD      READE@SARIL1                  90*                                  CSF002
     C     KRSD          READE     SCSARID0                               90
     C*****ADINDX        CHAIN     GPMTXTL0                           11                    MD056561
     C/EXEC SQL                                                                             MD056561
     C+ SELECT *                                                                            MD056561
     C+ into :GPMTXT                                                                        MD056561
     C+ from GPMTXJW0                                                                       MD056561
     C+ where MIINDX = :ADINDX                                                              MD056561
     C/END-EXEC                                                                             MD056561
     C                   Setoff                                       11                    MD056561
     C                   If        SQLCODE = 100                                            MD056561
     C                   Seton                                        11                    MD056561
     C                   Endif                                                              MD056561
      * Transfer error indicator to EOF flag
     C                   MOVEL     *IN90         W0EOFD            1
      * Quit if no record read
     C     W0EOFD        IFNE      '1'                                          IF
      * Select record unless user action states otherwise
     C                   MOVEL     'Y'           W0RSL             1
      * USER: Record selection processing
      * CASE: DB1.Record id is Live
     C     ADRECI        IFEQ      'D'                                          *IF
     C                   MOVEL     'Y'           W0RSL                          *Record selecte
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'N'           W0RSL                          *Record selecte
     C                   END                                                    *FI
     C                   END                                                    FI
     C                   END                                                    UOD
      *
      * Reset key level breaks
     C                   MOVEL     *BLANK        W0DL00            1            Switchable Feat
     C**********           MOVEL*BLANK    W0DL01  1        Menu Group Code                    CSF002
     C     W0EOFD        IFEQ      '1'
      * End of file - Signal all level breaks
     C                   MOVEL     'Y'           W0DL00            1            Switchable Feat
     C**********           MOVEL'Y'       W0DL01  1        Menu Group Code                    CSF002
     C                   ELSE
      * Next record - Detect level breaks
     C     ADSARN        IFNE      WZD001                                       Switchable Feat
      * Set on level break indicator
     C                   MOVEL     'Y'           W0DL00
     C                   END
     C********** ADMGRP    IFNE WZD002                     Menu Group Code                    CSF002
     C********** W0DL00    OREQ 'Y'                                                           CSF002
      **Set*on*level*break*indicator**********************************                        CSF002
     C**********           MOVEL'Y'       W0DL01                                              CSF002
     C**********           END                                                                CSF002
     C                   END
      *================================================================
     CSR   D3EXIT        ENDSR
      /EJECT
     CSR   D4PTOT        BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      **Print*level*break*totals*as*required**************************                        CSF002
     C********** W0DL01    IFEQ 'Y'                                                           CSF002
      **Signal*header*format*is*no*longer*ready***********************                        CSF002
     C**********           MOVEL*BLANK    W0DP01                                              CSF002
     C**********           END                                                                CSF002
      *
     C     W0DL00        IFEQ      'Y'
      * If there is not enough space on the
      * physical page for this format:
     C     @$PGL         SUB       @$CLN         @$WRK
     C     @$WRK         IFLE      2
      * Signal new page required
     C                   MOVE      'Y'           W0NEWP
      * Start new page
     C                   EXSR      Q0PRNT
     C                   END
      * Print format
     C                   WRITE     $KKEYTTL
      * Signal header format is no longer ready
     C                   MOVEL     *BLANK        W0DP00
     C                   END
      *
     C     W0EOFD        IFEQ      '1'
     C                   END
      *
      *================================================================
     CSR   D4EXIT        ENDSR
      /EJECT
     CSR   E0MAIN        BEGSR
      *================================================================
      * Printo Switchable F - Rep: Mainline
      *================================================================
      * Declare restrictor key work fields
     C     *LIKE         DEFINE    AHSARN        WQKE01                         Switchable Feat
      * Define keylist
     C     KRSE          KLIST
     C                   KFLD                    WQKE01                         Switchable Feat
      * Move fields to key list
     C                   MOVEL     $BSARN        WQKE01                         Switchable Feat
      * Establish starting position
     C     KRSE          SETLL     @SARRL1                                      *
      * Read first record with user selection
     C                   EXSR      E3READ
     C     W0EOFE        IFNE      '0'                                          IF
     C                   ELSE
      * Request all headings
     C                   MOVEL     'Y'           W0EL1P            1            First page
     C                   MOVEL     'Y'           W0EL00            1            Switchable Feat
      * Set column headings flag
     C                   MOVE      'Y'           W0ECDT
      * Print report body
     C     W0EOFE        DOWEQ     '0'                                          DOW
      * Prepare heading formats for printing
     C                   EXSR      E1PHDR
      * Print report detail line
     C                   EXSR      E2PDTL
      * Read next record with user selection
     C                   EXSR      E3READ
      * Print totals
     C                   EXSR      E4PTOT
     C                   END                                                    WOD
     C                   END                                                    FI
      *================================================================
     CSR   E0EXIT        ENDSR
      /EJECT
     CSR   E1PHDR        BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C     W0EL1P        IFEQ      'Y'
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0EP1P            1
     C                   END
      *
     C     W0EL00        IFEQ      'Y'
      * Load key header format
     C                   MOVEL     AHSARN        $LSARN                         Switchable Feat
      * Load related totals format
     C                   MOVEL     AHSARN        $NSARN                         Switchable Feat
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0EP00            1
     C                   END
      *
      *================================================================
     CSR   E1EXIT        ENDSR
      /EJECT
     CSR   E2PDTL        BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                   MOVEL     AHSARN        $MSARN                         Switchable Feat
     C                   MOVEL     AHRNAM        $MRNAM                         Report Name
     C                   MOVEL     AHRDSC        $MRDSC                         Report Descript
     C                   MOVEL     AHAVAL        $MAVAL                         Avail if featur
     C                   Z-ADD     AHLCD         $MLCD                          Last change dat
     C                   MOVEL     *BLANK        $MACDT                         Alpha Change Da
     C                   MOVEL     AHTYLC        $MTYLC                         Type of the Las
     C                   MOVEL     *BLANK        $MALCH                         Alpha of Last C
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0EPDT            1
      * Call print routine
     C                   EXSR      Q0PRNT
      *
      *================================================================
     CSR   E2EXIT        ENDSR
      /EJECT
     CSR   E3READ        BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C     *LIKE         DEFINE    AHSARN        WZE001                         Switchable Feat
     C                   MOVEL     AHSARN        WZE001
      * Read next record
     C     W0RSL         DOUEQ     'Y'                                          DOU
     C     W0EOFE        OREQ      '1'
     C     KRSE          READE     @SARRL1                                90    *
      * Transfer error indicator to EOF flag
     C                   MOVEL     *IN90         W0EOFE            1
      * Quit if no record read
     C     W0EOFE        IFNE      '1'                                          IF
      * Select record unless user action states otherwise
     C                   MOVEL     'Y'           W0RSL             1
     C                   END                                                    FI
     C                   END                                                    UOD
      *
      * Reset key level breaks
     C                   MOVEL     *BLANK        W0EL00            1            Switchable Feat
     C     W0EOFE        IFEQ      '1'
      * End of file - Signal all level breaks
     C                   MOVEL     'Y'           W0EL00            1            Switchable Feat
     C                   ELSE
      * Next record - Detect level breaks
     C     AHSARN        IFNE      WZE001                                       Switchable Feat
      * Set on level break indicator
     C                   MOVEL     'Y'           W0EL00
     C                   END
     C                   END
      *================================================================
     CSR   E3EXIT        ENDSR
      /EJECT
     CSR   E4PTOT        BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C     W0EL00        IFEQ      'Y'
      * If there is not enough space on the
      * physical page for this format:
     C     @$PGL         SUB       @$CLN         @$WRK
     C     @$WRK         IFLE      2
      * Signal new page required
     C                   MOVE      'Y'           W0NEWP
      * Start new page
     C                   EXSR      Q0PRNT
     C                   END
      * Print format
     C                   WRITE     $NKEYTTL
      * Signal header format is no longer ready
     C                   MOVEL     *BLANK        W0EP00
     C                   END
      *
     C     W0EOFE        IFEQ      '1'
     C                   END
      *
      *================================================================
     CSR   E4EXIT        ENDSR
      /EJECT
     CSR   F0MAIN        BEGSR
      *================================================================
      * Printo Switchable F - Rep: Mainline
      *================================================================
      * Declare restrictor key work fields
     C     *LIKE         DEFINE    AESARN        WQKF01                         Switchable Feat
      * Define keylist
     C     KRSF          KLIST
     C                   KFLD                    WQKF01                         Switchable Feat
      * Move fields to key list
     C                   MOVEL     $BSARN        WQKF01                         Switchable Feat
      * Establish starting position
     C     KRSF          SETLL     @SARML1                                      *
      * Read first record with user selection
     C                   EXSR      F3READ
     C     W0EOFF        IFNE      '0'                                          IF
     C                   ELSE
      * Request all headings
     C                   MOVEL     'Y'           W0FL1P            1            First page
     C                   MOVEL     'Y'           W0FL00            1            Switchable Feat
     C                   MOVEL     'Y'           W0FL01            1            Report Name
     C                   MOVEL     'Y'           W0FL02            1            Component Name
      * Set column headings flag
     C                   MOVE      'Y'           W0FCDT
      * Print report body
     C     W0EOFF        DOWEQ     '0'                                          DOW
      * Prepare heading formats for printing
     C                   EXSR      F1PHDR
      * Print report detail line
     C                   EXSR      F2PDTL
      * Read next record with user selection
     C                   EXSR      F3READ
      * Print totals
     C                   EXSR      F4PTOT
     C                   END                                                    WOD
     C                   END                                                    FI
      *================================================================
     CSR   F0EXIT        ENDSR
      /EJECT
     CSR   F1PHDR        BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C     W0FL1P        IFEQ      'Y'
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0FP1P            1
     C                   END
      *
     C     W0FL00        IFEQ      'Y'
      * Load key header format
     C                   MOVEL     AESARN        $OSARN                         Switchable Feat
      * Load related totals format
     C                   MOVEL     AESARN        $QSARN                         Switchable Feat
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0FP00            1
     C                   END
      *
     C     W0FL01        IFEQ      'Y'
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0FP01            1
     C                   END
      *
     C     W0FL02        IFEQ      'Y'
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0FP02            1
     C                   END
      *
      *================================================================
     CSR   F1EXIT        ENDSR
      /EJECT
     CSR   F2PDTL        BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                   MOVEL     AESARN        $PSARN                         Switchable Feat
     C                   MOVEL     AERNAM        $PRNAM                         Report Name
     C                   MOVEL     AECOTT        $PCOTT                         Component Name
     C                   MOVEL     AECSEQ        $PCSEQ                         Component Seque
     C                   MOVEL     AEAVAL        $PAVAL                         Avail if featur
     C                   Z-ADD     AELCD         $PLCD                          Last change dat
     C                   MOVEL     *BLANK        $PACDT                         Alpha Change Da
     C                   MOVEL     AETYLC        $PTYLC                         Type of the Las
     C                   MOVEL     *BLANK        $PALCH                         Alpha of Last C
     C                   MOVEL     *BLANK        $PTXTC                         Description of
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0FPDT            1
      * Call print routine
     C                   EXSR      Q0PRNT
      *
      *================================================================
     CSR   F2EXIT        ENDSR
      /EJECT
     CSR   F3READ        BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C     *LIKE         DEFINE    AESARN        WZF001                         Switchable Feat
     C                   MOVEL     AESARN        WZF001
     C     *LIKE         DEFINE    AERNAM        WZF002                         Report Name
     C                   MOVEL     AERNAM        WZF002
     C     *LIKE         DEFINE    AECOTT        WZF003                         Component Name
     C                   MOVEL     AECOTT        WZF003
      * Read next record
     C     W0RSL         DOUEQ     'Y'                                          DOU
     C     W0EOFF        OREQ      '1'
     C     KRSF          READE     @SARML1                                90    *
      * Transfer error indicator to EOF flag
     C                   MOVEL     *IN90         W0EOFF            1
      * Quit if no record read
     C     W0EOFF        IFNE      '1'                                          IF
      * Select record unless user action states otherwise
     C                   MOVEL     'Y'           W0RSL             1
     C                   END                                                    FI
     C                   END                                                    UOD
      *
      * Reset key level breaks
     C                   MOVEL     *BLANK        W0FL00            1            Switchable Feat
     C                   MOVEL     *BLANK        W0FL01            1            Report Name
     C                   MOVEL     *BLANK        W0FL02            1            Component Name
     C     W0EOFF        IFEQ      '1'
      * End of file - Signal all level breaks
     C                   MOVEL     'Y'           W0FL00            1            Switchable Feat
     C                   MOVEL     'Y'           W0FL01            1            Report Name
     C                   MOVEL     'Y'           W0FL02            1            Component Name
     C                   ELSE
      * Next record - Detect level breaks
     C     AESARN        IFNE      WZF001                                       Switchable Feat
      * Set on level break indicator
     C                   MOVEL     'Y'           W0FL00
     C                   END
     C     AERNAM        IFNE      WZF002                                       Report Name
     C     W0FL00        OREQ      'Y'
      * Set on level break indicator
     C                   MOVEL     'Y'           W0FL01
     C                   END
     C     AECOTT        IFNE      WZF003                                       Component Name
     C     W0FL01        OREQ      'Y'
      * Set on level break indicator
     C                   MOVEL     'Y'           W0FL02
     C                   END
     C                   END
      *================================================================
     CSR   F3EXIT        ENDSR
      /EJECT
     CSR   F4PTOT        BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C     W0FL02        IFEQ      'Y'
      * Signal header format is no longer ready
     C                   MOVEL     *BLANK        W0FP02
     C                   END
      *
     C     W0FL01        IFEQ      'Y'
      * Signal header format is no longer ready
     C                   MOVEL     *BLANK        W0FP01
     C                   END
      *
     C     W0FL00        IFEQ      'Y'
      * If there is not enough space on the
      * physical page for this format:
     C     @$PGL         SUB       @$CLN         @$WRK
     C     @$WRK         IFLE      2
      * Signal new page required
     C                   MOVE      'Y'           W0NEWP
      * Start new page
     C                   EXSR      Q0PRNT
     C                   END
      * Print format
     C                   WRITE     $QKEYTTL
      * Signal header format is no longer ready
     C                   MOVEL     *BLANK        W0FP00
     C                   END
      *
     C     W0EOFF        IFEQ      '1'
      * USER: Process after print of final totals format
      * Close files in access program
     C                   MOVEL     *BLANK        WURTCD                         Access Obj Retu
     C                   MOVEL     *BLANK        WUOPTN                         Access Obj Acce
     C                   MOVEL     '*FREE'       WUOPTN                         Access Obj Acce
      * Get Rept COB comp SC3010P - Standard functions  *
     C*
     C** Move Synon work fields into parameters
     C*
     C                   CALL      'AOCMPNR0'
     C                   PARM                    WURTCD                         B:Return code
     C                   PARM                    WUOPTN                         I:Option
     C                   PARM                    WUCOTT                         Compnt name
     C                   PARM                    WUCSEQ                         Compnt seq no
     C     P@CMPN        PARM      P@CMPN        P@FMT                          O:Format
     C*
     C** If record found, copy component description to screen field
     C*
     C     WUOPTN        IFNE      '*FREE'
     C                   MOVEL     *BLANKS       $PTXTC
     C     WURTCD        IFEQ      *BLANKS
     C                   MOVEL     DHCTXT        $PTXTC
     C                   END
     C                   END
     C                   END
      *
      *================================================================
     CSR   F4EXIT        ENDSR
      /EJECT
     CSR   G0MAIN        BEGSR
      *================================================================
      * Printo Switchable F -PRTF: Mainline
      *================================================================
      * Declare restrictor key work fields
     C     *LIKE         DEFINE    WASARN        WQKG01                         Switchable Feat
      * Define keylist
     C     KRSG          KLIST
     C                   KFLD                    WQKG01                         Switchable Feat
      * Move fields to key list
     C                   MOVEL     $BSARN        WQKG01                         Switchable Feat
      * Establish starting position
     C     KRSG          SETLL     @SAROL4                                      *
      * Read first record with user selection
     C                   EXSR      G3READ
     C     W0EOFG        IFNE      '0'                                          IF
     C                   ELSE
      * Request all headings
     C                   MOVEL     'Y'           W0GL1P            1            First page
     C                   MOVEL     'Y'           W0GL00            1            Switchable Feat
     C                   MOVEL     'Y'           W0GL01            1            Object Name
      * Set column headings flag
     C                   MOVE      'Y'           W0GCDT
      * Print report body
     C     W0EOFG        DOWEQ     '0'                                          DOW
      * Prepare heading formats for printing
     C                   EXSR      G1PHDR
      * Print report detail line
     C                   EXSR      G2PDTL
      * Read next record with user selection
     C                   EXSR      G3READ
      * Print totals
     C                   EXSR      G4PTOT
     C                   END                                                    WOD
     C                   END                                                    FI
      *================================================================
     CSR   G0EXIT        ENDSR
      /EJECT
     CSR   G1PHDR        BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C     W0GL1P        IFEQ      'Y'
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0GP1P            1
     C                   END
      *
     C     W0GL00        IFEQ      'Y'
      * Load key header format
     C                   MOVEL     WASARN        $RSARN                         Switchable Feat
      * Load related totals format
     C                   MOVEL     WASARN        $TSARN                         Switchable Feat
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0GP00            1
     C                   END
      *
     C     W0GL01        IFEQ      'Y'
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0GP01            1
     C                   END
      *
      *================================================================
     CSR   G1EXIT        ENDSR
      /EJECT
     CSR   G2PDTL        BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                   MOVEL     WASARN        $SSARN                         Switchable Feat
     C                   MOVEL     WAOBNM        $SOBNM                         Object Name
     C                   MOVEL     WAOBTP        $SOBTP                         Object Type
     C                   MOVEL     WAOBAT        $SOBAT                         Object Attribut
     C                   MOVEL     WAOBTX        $SOBTX                         Object Descript
     C                   MOVEL     WAAVAL        $SAVAL                         Avail if featur
     C                   Z-ADD     WALCD         $SLCD                          Last change dat
     C                   MOVEL     *BLANK        $SACDT                         Alpha Change Da
     C                   MOVEL     WATYLC        $STYLC                         Type of the Las
     C                   MOVEL     *BLANK        $SALCH                         Alpha of Last C
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0GPDT            1
      * Call print routine
     C                   EXSR      Q0PRNT
      *
      *================================================================
     CSR   G2EXIT        ENDSR
      /EJECT
     CSR   G3READ        BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C     *LIKE         DEFINE    WASARN        WZG001                         Switchable Feat
     C                   MOVEL     WASARN        WZG001
     C     *LIKE         DEFINE    WAOBNM        WZG002                         Object Name
     C                   MOVEL     WAOBNM        WZG002
      * Read next record
     C     W0RSL         DOUEQ     'Y'                                          DOU
     C     W0EOFG        OREQ      '1'
     C     KRSG          READE     @SAROL4                                90    *
      * Transfer error indicator to EOF flag
     C                   MOVEL     *IN90         W0EOFG            1
      * Quit if no record read
     C     W0EOFG        IFNE      '1'                                          IF
      * Select record unless user action states otherwise
     C                   MOVEL     'Y'           W0RSL             1
     C                   END                                                    FI
     C                   END                                                    UOD
      *
      * Reset key level breaks
     C                   MOVEL     *BLANK        W0GL00            1            Switchable Feat
     C                   MOVEL     *BLANK        W0GL01            1            Object Name
     C     W0EOFG        IFEQ      '1'
      * End of file - Signal all level breaks
     C                   MOVEL     'Y'           W0GL00            1            Switchable Feat
     C                   MOVEL     'Y'           W0GL01            1            Object Name
     C                   ELSE
      * Next record - Detect level breaks
     C     WASARN        IFNE      WZG001                                       Switchable Feat
      * Set on level break indicator
     C                   MOVEL     'Y'           W0GL00
     C                   END
     C     WAOBNM        IFNE      WZG002                                       Object Name
     C     W0GL00        OREQ      'Y'
      * Set on level break indicator
     C                   MOVEL     'Y'           W0GL01
     C                   END
     C                   END
      *================================================================
     CSR   G3EXIT        ENDSR
      /EJECT
     CSR   G4PTOT        BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C     W0GL01        IFEQ      'Y'
      * Signal header format is no longer ready
     C                   MOVEL     *BLANK        W0GP01
     C                   END
      *
     C     W0GL00        IFEQ      'Y'
      * If there is not enough space on the
      * physical page for this format:
     C     @$PGL         SUB       @$CLN         @$WRK
     C     @$WRK         IFLE      2
      * Signal new page required
     C                   MOVE      'Y'           W0NEWP
      * Start new page
     C                   EXSR      Q0PRNT
     C                   END
      * Print format
     C                   WRITE     $TKEYTTL
      * Signal header format is no longer ready
     C                   MOVEL     *BLANK        W0GP00
     C                   END
      *
     C     W0EOFG        IFEQ      '1'
     C                   END
      *
      *================================================================
     CSR   G4EXIT        ENDSR
      /EJECT
     CSR   H0MAIN        BEGSR
      *================================================================
      * Printo Switchable F - Ini: Mainline
      *================================================================
      * Declare restrictor key work fields
     C     *LIKE         DEFINE    AKSARN        WQKH01                         Switchable Feat
      * Define keylist
     C     KRSH          KLIST
     C                   KFLD                    WQKH01                         Switchable Feat
      * Move fields to key list
     C                   MOVEL     $BSARN        WQKH01                         Switchable Feat
      * Establish starting position
     C     KRSH          SETLL     @SARPL1                                      *
      * Read first record with user selection
     C                   EXSR      H3READ
     C     W0EOFH        IFNE      '0'                                          IF
     C                   ELSE
      * Request all headings
     C                   MOVEL     'Y'           W0HL1P            1            First page
     C                   MOVEL     'Y'           W0HL00            1            Switchable Feat
      * Set column headings flag
     C                   MOVE      'Y'           W0HCDT
      * Print report body
     C     W0EOFH        DOWEQ     '0'                                          DOW
      * Prepare heading formats for printing
     C                   EXSR      H1PHDR
      * Print report detail line
     C                   EXSR      H2PDTL
      * Read next record with user selection
     C                   EXSR      H3READ
      * Print totals
     C                   EXSR      H4PTOT
     C                   END                                                    WOD
     C                   END                                                    FI
      *================================================================
     CSR   H0EXIT        ENDSR
      /EJECT
     CSR   H1PHDR        BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C     W0HL1P        IFEQ      'Y'
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0HP1P            1
     C                   END
      *
     C     W0HL00        IFEQ      'Y'
      * Load key header format
     C                   MOVEL     AKSARN        $USARN                         Switchable Feat
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0HP00            1
     C                   END
      *
      *================================================================
     CSR   H1EXIT        ENDSR
      /EJECT
     CSR   H2PDTL        BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                   MOVEL     AKSARN        $VSARN                         Switchable Feat
     C                   MOVEL     AKPNAM        $VPNAM                         Program Name
     C                   MOVEL     AKPDSC        $VPDSC                         Program Descrip
     C                   MOVEL     AKPRVC        $VPRVC                         Program Previou
     C                   MOVEL     AKTYL1        $VTYL1                         Type of Last Ch
     C                   Z-ADD     AKLCD         $VLCD                          Last change dat
     C                   MOVEL     *BLANK        $VACDT                         Alpha Change Da
     C                   MOVEL     *BLANK        $VALCH                         Alpha of Last C
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0HPDT            1
      * Call print routine
     C                   EXSR      Q0PRNT
      *
      *================================================================
     CSR   H2EXIT        ENDSR
      /EJECT
     CSR   H3READ        BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C     *LIKE         DEFINE    AKSARN        WZH001                         Switchable Feat
     C                   MOVEL     AKSARN        WZH001
      * Read next record
     C     W0RSL         DOUEQ     'Y'                                          DOU
     C     W0EOFH        OREQ      '1'
     C     KRSH          READE     @SARPL1                                90    *
      * Transfer error indicator to EOF flag
     C                   MOVEL     *IN90         W0EOFH            1
      * Quit if no record read
     C     W0EOFH        IFNE      '1'                                          IF
      * Select record unless user action states otherwise
     C                   MOVEL     'Y'           W0RSL             1
     C                   END                                                    FI
     C                   END                                                    UOD
      *
      * Reset key level breaks
     C                   MOVEL     *BLANK        W0HL00            1            Switchable Feat
     C     W0EOFH        IFEQ      '1'
      * End of file - Signal all level breaks
     C                   MOVEL     'Y'           W0HL00            1            Switchable Feat
     C                   ELSE
      * Next record - Detect level breaks
     C     AKSARN        IFNE      WZH001                                       Switchable Feat
      * Set on level break indicator
     C                   MOVEL     'Y'           W0HL00
     C                   END
     C                   END
      *================================================================
     CSR   H3EXIT        ENDSR
      /EJECT
     CSR   H4PTOT        BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C     W0HL00        IFEQ      'Y'
      * Signal header format is no longer ready
     C                   MOVEL     *BLANK        W0HP00
     C                   END
      *
     C     W0EOFH        IFEQ      '1'
     C                   END
      *
      *================================================================
     CSR   H4EXIT        ENDSR
      /EJECT
     CSR   Q0PRNT        BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                   EXSR      Q1FSEL
      * Calculate length of formats selected for printing
     C                   EXSR      Q2PLEN
      * Add column heading length to print length
     C                   ADD       W0COLN        W0FSUM
     C     W0NEWP        IFNE      'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C     W0FSUM        IFGT      W0OFL
     C                   MOVE      'Y'           W0NEWP
     C                   ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                   ADD       W0DTLN        W0FSUM
     C     W0FSUM        IFGT      W0PGL
     C                   MOVE      'Y'           W0NEWP
     C                   END
     C                   END
     C                   END
      * Print Standard report header of Print  Switchable F - All
      * If it is ready to print, then do so,
     C     W0NEWP        IFEQ      'Y'                                          IF
     C                   EXSR      Q3PTNP
     C                   END                                                    FI
      *
      * Print First Page Format of Print  Switchable F - All
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C     W0AP1P        IFEQ      'Y'                                          IF
     C     W0NEWP        OREQ      'Y'
     C     W0AP1P        ANDEQ     'P'
      * Reset format print flag
     C                   MOVE      *BLANK        W0AP1P
      * Clear first page flag.
     C                   MOVE      *BLANK        W0AL1P
     C                   END                                                    FI
      * Print Detail line. of Print  Switchable F - All
      * If new page then set column headings active
     C     W0NEWP        IFEQ      'Y'
     C                   MOVE      'Y'           W0ACDT            1
     C                   END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C     W0APDT        IFEQ      'Y'                                          IF
     C     W0NEWP        OREQ      'Y'
     C     W0APDT        ANDEQ     'P'
     C                   MOVEL     'Y'           W0PFM
      * USER: On print of detail format
      * Convert Day No to Date - Rundate  *
     C                   CALL      'ZDATE2'                             90      Convert Day No
     C                   PARM      ABLCD         WQ0001            5 0          Work Midas Day
     C                   PARM      WUE3ST        WQ0002            1            date format fla
     C     WUWCDT        PARM      *ZERO         WQ0003            6 0          Work Converted
     C     WUWADT        PARM      *BLANK        WQ0004            7            Work Converted
      *
     C     *IN90         IFEQ      '1'
      * Call to program ended in error
     C                   MOVEL     'Y2U0021'     W0RTN             7
     C                   END
      *
     C                   MOVEL     WUWADT        $BACDT                         Alpha Change Da
      * CUR.Alpha of Last Change Type = Condition name of CUR.Type of the Last C
     C                   CALL      'CBRVCNR'                            90      *
     C                   PARM                    W0RTN             7
     C                   PARM      1100307       Y2LSNO            7 0          List number
     C                   PARM      $BTYLC        W0INVL           20            Type of the Las
     C                   PARM      ' '           W0VLMP            1            Value mapped
     C     $BALCH        PARM                    W0CNNM           25            Alpha of Last C
      *
     C     W0PFM         IFEQ      'Y'
      * Print column headings if required
     C     W0ACDT        IFEQ      'Y'
     C                   WRITE     $BCOLHDG
      * Clear column headings control flag
     C                   MOVE      *BLANK        W0ACDT
     C                   END                                                    FI
      * Print format
     C                   WRITE     $BDTLRCD
     C                   END                                                    FI
      *
      * Reset format print flag
     C                   MOVE      *BLANK        W0APDT
     C                   END                                                    FI
      * Print First Page Format of Printo Switchable F - COB
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C     W0BP1P        IFEQ      'Y'                                          IF
     C     W0NEWP        OREQ      'Y'
     C     W0BP1P        ANDEQ     'P'
      * Reset format print flag
     C                   MOVE      *BLANK        W0BP1P
      * Clear first page flag.
     C                   MOVE      *BLANK        W0BL1P
     C                   END                                                    FI
      * Print Switchable Feature Number of Printo Switchable F - COB
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C     W0BP00        IFEQ      'Y'                                          IF
     C     W0NEWP        OREQ      'Y'
     C     W0BP00        ANDEQ     'P'
      * Print format
     C                   WRITE     $CKEYHDR
      * Set column headings flag
     C                   MOVE      'Y'           W0BCDT
      *
      * Reset format print flag
     C                   MOVE      *BLANK        W0BP00
     C                   END                                                    FI
      * Print Component Name of Printo Switchable F - COB
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C     W0BP01        IFEQ      'Y'                                          IF
     C     W0NEWP        OREQ      'Y'
     C     W0BP01        ANDEQ     'P'
      * Reset format print flag
     C                   MOVE      *BLANK        W0BP01
     C                   END                                                    FI
      * Print Detail line. of Printo Switchable F - COB
      * If new page then set column headings active
     C     W0NEWP        IFEQ      'Y'
     C                   MOVE      'Y'           W0BCDT            1
     C                   END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C     W0BPDT        IFEQ      'Y'                                          IF
     C     W0NEWP        OREQ      'Y'
     C     W0BPDT        ANDEQ     'P'
     C                   MOVEL     'Y'           W0PFM
      * USER: On print of detail format
      * Convert Day No to Date - Rundate  *
     C                   CALL      'ZDATE2'                             90      Convert Day No
     C                   PARM      ACLCD         WQ0005            5 0          Work Midas Day
     C                   PARM      WUE3ST        WQ0006            1            date format fla
     C     WUWCDT        PARM      *ZERO         WQ0007            6 0          Work Converted
     C     WUWADT        PARM      *BLANK        WQ0008            7            Work Converted
      *
     C     *IN90         IFEQ      '1'
      * Call to program ended in error
     C                   MOVEL     'Y2U0021'     W0RTN             7
     C                   END
      *
     C                   MOVEL     WUWADT        $DACDT                         Alpha Change Da
      * CUR.Alpha of Last Change Type = Condition name of DB1.Type of the Last C
     C                   CALL      'CBRVCNR'                            90      *
     C                   PARM                    W0RTN             7
     C                   PARM      1100307       Y2LSNO            7 0          List number
     C                   PARM      ACTYLC        W0INVL           20            Type of the Las
     C                   PARM      ' '           W0VLMP            1            Value mapped
     C     $DALCH        PARM                    W0CNNM           25            Alpha of Last C
      *
      * Retrieve COB component description
     C                   MOVEL     *BLANK        WURTCD                         Access Obj Retu
     C                   MOVEL     *BLANK        WUOPTN                         Access Obj Acce
     C                   MOVEL     '*KEY'        WUOPTN                         Access Obj Acce
     C                   MOVEL     ACCOTT        WUCOTT                         Component Name
     C                   MOVEL     ACCSEQ        WUCSEQ                         Component Seque
      * Get COB component SC3010P - Standard functions  *
      *
     C*
     C** Move Synon work fields into parameters
     C*
     C                   CALL      'AOCMPNR0'
     C                   PARM                    WURTCD                         B:Return code
     C                   PARM                    WUOPTN                         I:Option
     C                   PARM                    WUCOTT                         Compnt name
     C                   PARM                    WUCSEQ                         Compnt seq no
     C     P@CMPN        PARM      P@CMPN        P@FMT                          O:Format
     C*
     C** If record found, copy component description to screen field
     C*
     C     WUOPTN        IFNE      '*FREE'
     C                   MOVEL     *BLANKS       $DTXTC
     C     WURTCD        IFEQ      *BLANKS
     C                   MOVEL     DHCTXT        $DTXTC
     C                   END
     C                   END
     C     W0PFM         IFEQ      'Y'
      * Convert fields to external form
      * Print column headings if required
     C     W0BCDT        IFEQ      'Y'
     C                   WRITE     $DCOLHDG
      * Clear column headings control flag
     C                   MOVE      *BLANK        W0BCDT
     C                   END                                                    FI
      * Print format
     C                   WRITE     $DDTLRCD
     C                   END                                                    FI
      *
      * Reset format print flag
     C                   MOVE      *BLANK        W0BPDT
     C                   END                                                    FI
      * Print First Page Format of Printo Switchable F - PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C     W0CP1P        IFEQ      'Y'                                          IF
     C     W0NEWP        OREQ      'Y'
     C     W0CP1P        ANDEQ     'P'
      * Reset format print flag
     C                   MOVE      *BLANK        W0CP1P
      * Clear first page flag.
     C                   MOVE      *BLANK        W0CL1P
     C                   END                                                    FI
      * Print Switchable Feature Number of Printo Switchable F - PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C     W0CP00        IFEQ      'Y'                                          IF
     C     W0NEWP        OREQ      'Y'
     C     W0CP00        ANDEQ     'P'
      * Print format
     C                   WRITE     $FKEYHDR
      * Set column headings flag
     C                   MOVE      'Y'           W0CCDT
      *
      * Reset format print flag
     C                   MOVE      *BLANK        W0CP00
     C                   END                                                    FI
      * Print Object Name of Printo Switchable F - PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C     W0CP01        IFEQ      'Y'                                          IF
     C     W0NEWP        OREQ      'Y'
     C     W0CP01        ANDEQ     'P'
      * Reset format print flag
     C                   MOVE      *BLANK        W0CP01
     C                   END                                                    FI
      * Print Detail line. of Printo Switchable F - PF
      * If new page then set column headings active
     C     W0NEWP        IFEQ      'Y'
     C                   MOVE      'Y'           W0CCDT            1
     C                   END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C     W0CPDT        IFEQ      'Y'                                          IF
     C     W0NEWP        OREQ      'Y'
     C     W0CPDT        ANDEQ     'P'
     C                   MOVEL     'Y'           W0PFM
      * USER: On print of detail format
      * Convert Day No to Date - Rundate  *
     C                   CALL      'ZDATE2'                             90      Convert Day No
     C                   PARM      AFLCD         WQ0009            5 0          Work Midas Day
     C                   PARM      WUE3ST        WQ0010            1            date format fla
     C     WUWCDT        PARM      *ZERO         WQ0011            6 0          Work Converted
     C     WUWADT        PARM      *BLANK        WQ0012            7            Work Converted
      *
     C     *IN90         IFEQ      '1'
      * Call to program ended in error
     C                   MOVEL     'Y2U0021'     W0RTN             7
     C                   END
      *
     C                   MOVEL     WUWADT        $GACDT                         Alpha Change Da
      * CUR.Alpha of Last Change Type = Condition name of DB1.Type of the Last C
     C                   CALL      'CBRVCNR'                            90      *
     C                   PARM                    W0RTN             7
     C                   PARM      1100307       Y2LSNO            7 0          List number
     C                   PARM      AFTYLC        W0INVL           20            Type of the Las
     C                   PARM      ' '           W0VLMP            1            Value mapped
     C     $GALCH        PARM                    W0CNNM           25            Alpha of Last C
      *
     C     W0PFM         IFEQ      'Y'
      * Print column headings if required
     C     W0CCDT        IFEQ      'Y'
     C                   WRITE     $GCOLHDG
      * Clear column headings control flag
     C                   MOVE      *BLANK        W0CCDT
     C                   END                                                    FI
      * Print format
     C                   WRITE     $GDTLRCD
     C                   END                                                    FI
      *
      * Reset format print flag
     C                   MOVE      *BLANK        W0CPDT
     C                   END                                                    FI
      * Print First Page Format of Printo Switchable F - Men
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C     W0DP1P        IFEQ      'Y'                                          IF
     C     W0NEWP        OREQ      'Y'
     C     W0DP1P        ANDEQ     'P'
      * Reset format print flag
     C                   MOVE      *BLANK        W0DP1P
      * Clear first page flag.
     C                   MOVE      *BLANK        W0DL1P
     C                   END                                                    FI
      * Print Switchable Feature Number of Printo Switchable F - Men
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C     W0DP00        IFEQ      'Y'                                          IF
     C     W0NEWP        OREQ      'Y'
     C     W0DP00        ANDEQ     'P'
      * Print format
     C                   WRITE     $IKEYHDR
      * Set column headings flag
     C                   MOVE      'Y'           W0DCDT
      *
      * Reset format print flag
     C                   MOVE      *BLANK        W0DP00
     C                   END                                                    FI
      **Print*Menu*Group*Code*of*Printo*Switchable*F*-*Men************                        CSF002
      **If*it*is*ready*to*print,*then*do*so,**************************                        CSF002
      **or*if*new*page*&*print*on*new*page*selected*&*****************                        CSF002
      **active*then*set*print*format*flag*****************************                        CSF002
     C********** W0DP01    IFEQ 'Y'                        IF                                 CSF002
     C********** W0NEWP    OREQ 'Y'                                                           CSF002
     C********** W0DP01    ANDEQ'P'                                                           CSF002
      **Reset*format*print*flag***************************************                        CSF002
     C**********           MOVE *BLANK    W0DP01                                              CSF002
     C**********           END                             FI                                 CSF002
      * Print Detail line. of Printo Switchable F - Men
      * If new page then set column headings active
     C     W0NEWP        IFEQ      'Y'
     C                   MOVE      'Y'           W0DCDT            1
     C                   END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C     W0DPDT        IFEQ      'Y'                                          IF
     C     W0NEWP        OREQ      'Y'
     C     W0DPDT        ANDEQ     'P'
     C                   MOVEL     'Y'           W0PFM
      * USER: On print of detail format
      * Convert Day No to Date - Rundate  *
     C                   CALL      'ZDATE2'                             90      Convert Day No
     C                   PARM      ADLCD         WQ0013            5 0          Work Midas Day
     C                   PARM      WUE3ST        WQ0014            1            date format fla
     C     WUWCDT        PARM      *ZERO         WQ0015            6 0          Work Converted
     C     WUWADT        PARM      *BLANK        WQ0016            7            Work Converted
      *
     C     *IN90         IFEQ      '1'
      * Call to program ended in error
     C                   MOVEL     'Y2U0021'     W0RTN             7
     C                   END
      *
     C                   MOVEL     WUWADT        $JACDT                         Alpha Change Da
      * CUR.Alpha of Last Change Type = Condition name of DB1.Type of the Last C
     C                   CALL      'CBRVCNR'                            90      *
     C                   PARM                    W0RTN             7
     C                   PARM      1100307       Y2LSNO            7 0          List number
     C                   PARM      ADTYLC        W0INVL           20            Type of the Las
     C                   PARM      ' '           W0VLMP            1            Value mapped
     C     $JALCH        PARM                    W0CNNM           25            Alpha of Last C
      *
     C     W0PFM         IFEQ      'Y'
      * Convert fields to external form
      * Print column headings if required
     C     W0DCDT        IFEQ      'Y'
     C                   WRITE     $JCOLHDG
      * Clear column headings control flag
     C                   MOVE      *BLANK        W0DCDT
     C                   END                                                    FI
      * Print format
     C                   WRITE     $JDTLRCD
     C                   END                                                    FI
      *
      * Reset format print flag
     C                   MOVE      *BLANK        W0DPDT
     C                   END                                                    FI
      * Print First Page Format of Printo Switchable F - Rep
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C     W0EP1P        IFEQ      'Y'                                          IF
     C     W0NEWP        OREQ      'Y'
     C     W0EP1P        ANDEQ     'P'
      * Reset format print flag
     C                   MOVE      *BLANK        W0EP1P
      * Clear first page flag.
     C                   MOVE      *BLANK        W0EL1P
     C                   END                                                    FI
      * Print Switchable Feature Number of Printo Switchable F - Rep
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C     W0EP00        IFEQ      'Y'                                          IF
     C     W0NEWP        OREQ      'Y'
     C     W0EP00        ANDEQ     'P'
      * Print format
     C                   WRITE     $LKEYHDR
      * Set column headings flag
     C                   MOVE      'Y'           W0ECDT
      *
      * Reset format print flag
     C                   MOVE      *BLANK        W0EP00
     C                   END                                                    FI
      * Print Detail line. of Printo Switchable F - Rep
      * If new page then set column headings active
     C     W0NEWP        IFEQ      'Y'
     C                   MOVE      'Y'           W0ECDT            1
     C                   END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C     W0EPDT        IFEQ      'Y'                                          IF
     C     W0NEWP        OREQ      'Y'
     C     W0EPDT        ANDEQ     'P'
     C                   MOVEL     'Y'           W0PFM
      * USER: On print of detail format
      * Convert Day No to Date - Rundate  *
     C                   CALL      'ZDATE2'                             90      Convert Day No
     C                   PARM      AHLCD         WQ0017            5 0          Work Midas Day
     C                   PARM      WUE3ST        WQ0018            1            date format fla
     C     WUWCDT        PARM      *ZERO         WQ0019            6 0          Work Converted
     C     WUWADT        PARM      *BLANK        WQ0020            7            Work Converted
      *
     C     *IN90         IFEQ      '1'
      * Call to program ended in error
     C                   MOVEL     'Y2U0021'     W0RTN             7
     C                   END
      *
     C                   MOVEL     WUWADT        $MACDT                         Alpha Change Da
      * CUR.Alpha of Last Change Type = Condition name of DB1.Type of the Last C
     C                   CALL      'CBRVCNR'                            90      *
     C                   PARM                    W0RTN             7
     C                   PARM      1100307       Y2LSNO            7 0          List number
     C                   PARM      AHTYLC        W0INVL           20            Type of the Las
     C                   PARM      ' '           W0VLMP            1            Value mapped
     C     $MALCH        PARM                    W0CNNM           25            Alpha of Last C
      *
     C     W0PFM         IFEQ      'Y'
      * Convert fields to external form
      * Print column headings if required
     C     W0ECDT        IFEQ      'Y'
     C                   WRITE     $MCOLHDG
      * Clear column headings control flag
     C                   MOVE      *BLANK        W0ECDT
     C                   END                                                    FI
      * Print format
     C                   WRITE     $MDTLRCD
     C                   END                                                    FI
      *
      * Reset format print flag
     C                   MOVE      *BLANK        W0EPDT
     C                   END                                                    FI
      * Print First Page Format of Printo Switchable F - Rep
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C     W0FP1P        IFEQ      'Y'                                          IF
     C     W0NEWP        OREQ      'Y'
     C     W0FP1P        ANDEQ     'P'
      * Reset format print flag
     C                   MOVE      *BLANK        W0FP1P
      * Clear first page flag.
     C                   MOVE      *BLANK        W0FL1P
     C                   END                                                    FI
      * Print Switchable Feature Number of Printo Switchable F - Rep
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C     W0FP00        IFEQ      'Y'                                          IF
     C     W0NEWP        OREQ      'Y'
     C     W0FP00        ANDEQ     'P'
      * Print format
     C                   WRITE     $OKEYHDR
      * Set column headings flag
     C                   MOVE      'Y'           W0FCDT
      *
      * Reset format print flag
     C                   MOVE      *BLANK        W0FP00
     C                   END                                                    FI
      * Print Report Name of Printo Switchable F - Rep
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C     W0FP01        IFEQ      'Y'                                          IF
     C     W0NEWP        OREQ      'Y'
     C     W0FP01        ANDEQ     'P'
      * Reset format print flag
     C                   MOVE      *BLANK        W0FP01
     C                   END                                                    FI
      * Print Component Name of Printo Switchable F - Rep
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C     W0FP02        IFEQ      'Y'                                          IF
     C     W0NEWP        OREQ      'Y'
     C     W0FP02        ANDEQ     'P'
      * Reset format print flag
     C                   MOVE      *BLANK        W0FP02
     C                   END                                                    FI
      * Print Detail line. of Printo Switchable F - Rep
      * If new page then set column headings active
     C     W0NEWP        IFEQ      'Y'
     C                   MOVE      'Y'           W0FCDT            1
     C                   END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C     W0FPDT        IFEQ      'Y'                                          IF
     C     W0NEWP        OREQ      'Y'
     C     W0FPDT        ANDEQ     'P'
     C                   MOVEL     'Y'           W0PFM
      * USER: On print of detail format
      * Convert Day No to Date - Rundate  *
     C                   CALL      'ZDATE2'                             90      Convert Day No
     C                   PARM      AELCD         WQ0021            5 0          Work Midas Day
     C                   PARM      WUE3ST        WQ0022            1            date format fla
     C     WUWCDT        PARM      *ZERO         WQ0023            6 0          Work Converted
     C     WUWADT        PARM      *BLANK        WQ0024            7            Work Converted
      *
     C     *IN90         IFEQ      '1'
      * Call to program ended in error
     C                   MOVEL     'Y2U0021'     W0RTN             7
     C                   END
      *
     C                   MOVEL     WUWADT        $PACDT                         Alpha Change Da
      * CUR.Alpha of Last Change Type = Condition name of DB1.Type of the Last C
     C                   CALL      'CBRVCNR'                            90      *
     C                   PARM                    W0RTN             7
     C                   PARM      1100307       Y2LSNO            7 0          List number
     C                   PARM      AETYLC        W0INVL           20            Type of the Las
     C                   PARM      ' '           W0VLMP            1            Value mapped
     C     $PALCH        PARM                    W0CNNM           25            Alpha of Last C
      *
      * Retrieve Report (if COB) component description
     C                   MOVEL     *BLANK        WURTCD                         Access Obj Retu
     C                   MOVEL     *BLANK        WUOPTN                         Access Obj Acce
     C                   MOVEL     '*KEY'        WUOPTN                         Access Obj Acce
     C                   MOVEL     AECOTT        WUCOTT                         Component Name
     C                   MOVEL     AECSEQ        WUCSEQ                         Component Seque
      * Get Rept COB comp SC3010P - Standard functions  *
     C*
     C** Move Synon work fields into parameters
     C*
     C                   CALL      'AOCMPNR0'
     C                   PARM                    WURTCD                         B:Return code
     C                   PARM                    WUOPTN                         I:Option
     C                   PARM                    WUCOTT                         Compnt name
     C                   PARM                    WUCSEQ                         Compnt seq no
     C     P@CMPN        PARM      P@CMPN        P@FMT                          O:Format
     C*
     C** If record found, copy component description to screen field
     C*
     C     WUOPTN        IFNE      '*FREE'
     C                   MOVEL     *BLANKS       $PTXTC
     C     WURTCD        IFEQ      *BLANKS
     C                   MOVEL     DHCTXT        $PTXTC
     C                   END
     C                   END
     C     W0PFM         IFEQ      'Y'
      * Convert fields to external form
      * Print column headings if required
     C     W0FCDT        IFEQ      'Y'
     C                   WRITE     $PCOLHDG
      * Clear column headings control flag
     C                   MOVE      *BLANK        W0FCDT
     C                   END                                                    FI
      * Print format
     C                   WRITE     $PDTLRCD
     C                   END                                                    FI
      *
      * Reset format print flag
     C                   MOVE      *BLANK        W0FPDT
     C                   END                                                    FI
      * Print First Page Format of Printo Switchable F -PRTF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C     W0GP1P        IFEQ      'Y'                                          IF
     C     W0NEWP        OREQ      'Y'
     C     W0GP1P        ANDEQ     'P'
      * Reset format print flag
     C                   MOVE      *BLANK        W0GP1P
      * Clear first page flag.
     C                   MOVE      *BLANK        W0GL1P
     C                   END                                                    FI
      * Print Switchable Feature Number of Printo Switchable F -PRTF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C     W0GP00        IFEQ      'Y'                                          IF
     C     W0NEWP        OREQ      'Y'
     C     W0GP00        ANDEQ     'P'
      * Print format
     C                   WRITE     $RKEYHDR
      * Set column headings flag
     C                   MOVE      'Y'           W0GCDT
      *
      * Reset format print flag
     C                   MOVE      *BLANK        W0GP00
     C                   END                                                    FI
      * Print Object Name of Printo Switchable F -PRTF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C     W0GP01        IFEQ      'Y'                                          IF
     C     W0NEWP        OREQ      'Y'
     C     W0GP01        ANDEQ     'P'
      * Reset format print flag
     C                   MOVE      *BLANK        W0GP01
     C                   END                                                    FI
      * Print Detail line. of Printo Switchable F -PRTF
      * If new page then set column headings active
     C     W0NEWP        IFEQ      'Y'
     C                   MOVE      'Y'           W0GCDT            1
     C                   END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C     W0GPDT        IFEQ      'Y'                                          IF
     C     W0NEWP        OREQ      'Y'
     C     W0GPDT        ANDEQ     'P'
     C                   MOVEL     'Y'           W0PFM
      * USER: On print of detail format
      * Convert Day No to Date - Rundate  *
     C                   CALL      'ZDATE2'                             90      Convert Day No
     C                   PARM      WALCD         WQ0025            5 0          Work Midas Day
     C                   PARM      WUE3ST        WQ0026            1            date format fla
     C     WUWCDT        PARM      *ZERO         WQ0027            6 0          Work Converted
     C     WUWADT        PARM      *BLANK        WQ0028            7            Work Converted
      *
     C     *IN90         IFEQ      '1'
      * Call to program ended in error
     C                   MOVEL     'Y2U0021'     W0RTN             7
     C                   END
      *
     C                   MOVEL     WUWADT        $SACDT                         Alpha Change Da
      * CUR.Alpha of Last Change Type = Condition name of DB1.Type of the Last C
     C                   CALL      'CBRVCNR'                            90      *
     C                   PARM                    W0RTN             7
     C                   PARM      1100307       Y2LSNO            7 0          List number
     C                   PARM      WATYLC        W0INVL           20            Type of the Las
     C                   PARM      ' '           W0VLMP            1            Value mapped
     C     $SALCH        PARM                    W0CNNM           25            Alpha of Last C
      *
     C     W0PFM         IFEQ      'Y'
      * Convert fields to external form
      * Print column headings if required
     C     W0GCDT        IFEQ      'Y'
     C                   WRITE     $SCOLHDG
      * Clear column headings control flag
     C                   MOVE      *BLANK        W0GCDT
     C                   END                                                    FI
      * Print format
     C                   WRITE     $SDTLRCD
     C                   END                                                    FI
      *
      * Reset format print flag
     C                   MOVE      *BLANK        W0GPDT
     C                   END                                                    FI
      * Print First Page Format of Printo Switchable F - Ini
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C     W0HP1P        IFEQ      'Y'                                          IF
     C     W0NEWP        OREQ      'Y'
     C     W0HP1P        ANDEQ     'P'
      * Reset format print flag
     C                   MOVE      *BLANK        W0HP1P
      * Clear first page flag.
     C                   MOVE      *BLANK        W0HL1P
     C                   END                                                    FI
      * Print Switchable Feature Number of Printo Switchable F - Ini
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C     W0HP00        IFEQ      'Y'                                          IF
     C     W0NEWP        OREQ      'Y'
     C     W0HP00        ANDEQ     'P'
      * Print format
     C                   WRITE     $UKEYHDR
      * Set column headings flag
     C                   MOVE      'Y'           W0HCDT
      *
      * Reset format print flag
     C                   MOVE      *BLANK        W0HP00
     C                   END                                                    FI
      * Print Detail line. of Printo Switchable F - Ini
      * If new page then set column headings active
     C     W0NEWP        IFEQ      'Y'
     C                   MOVE      'Y'           W0HCDT            1
     C                   END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C     W0HPDT        IFEQ      'Y'                                          IF
     C     W0NEWP        OREQ      'Y'
     C     W0HPDT        ANDEQ     'P'
     C                   MOVEL     'Y'           W0PFM
      * USER: On print of detail format
      * Convert Day No to Date - Rundate  *
     C                   CALL      'ZDATE2'                             90      Convert Day No
     C                   PARM      AKLCD         WQ0029            5 0          Work Midas Day
     C                   PARM      WUE3ST        WQ0030            1            date format fla
     C     WUWCDT        PARM      *ZERO         WQ0031            6 0          Work Converted
     C     WUWADT        PARM      *BLANK        WQ0032            7            Work Converted
      *
     C     *IN90         IFEQ      '1'
      * Call to program ended in error
     C                   MOVEL     'Y2U0021'     W0RTN             7
     C                   END
      *
     C                   MOVEL     WUWADT        $VACDT                         Alpha Change Da
      * CUR.Alpha of Last Change Type = Condition name of DB1.Type of Last Chang
     C                   CALL      'CBRVCNR'                            90      *
     C                   PARM                    W0RTN             7
     C                   PARM      1100307       Y2LSNO            7 0          List number
     C                   PARM      AKTYL1        W0INVL           20            Type of Last Ch
     C                   PARM      ' '           W0VLMP            1            Value mapped
     C     $VALCH        PARM                    W0CNNM           25            Alpha of Last C
      *
     C     W0PFM         IFEQ      'Y'
      * Convert fields to external form
      * Print column headings if required
     C     W0HCDT        IFEQ      'Y'
     C                   WRITE     $VCOLHDG
      * Clear column headings control flag
     C                   MOVE      *BLANK        W0HCDT
     C                   END                                                    FI
      * Print format
     C                   WRITE     $VDTLRCD
     C                   END                                                    FI
      *
      * Reset format print flag
     C                   MOVE      *BLANK        W0HPDT
     C                   END                                                    FI
      * Clear new page flag
     C                   MOVE      *BLANK        W0NEWP
      *================================================================
     CSR   Q0EXIT        ENDSR
      /EJECT
     CSR   Q1FSEL        BEGSR
      *================================================================
      * Format select
      *================================================================
     C                   MOVEL     *BLANK        W0SKP             1
      * Cascade skip to new page requests upwards
     C     W0APDT        IFEQ      'Y'
     C                   MOVEL     'Y'           W0SKP
     C                   END
      * Request new page if required
     C     W0SKP         IFEQ      'Y'                                          IF
     C                   MOVE      'Y'           W0NEWP
     C                   END                                                    FI
      *================================================================
     CSR   Q1EXIT        ENDSR
      /EJECT
     CSR   Q2PLEN        BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C                   Z-ADD     @$CLN         W0FSUM            3 0
     C                   Z-ADD     *ZERO         W0DTLN            3 0
     C                   Z-ADD     *ZERO         W0COLN            3 0
      * * First Page Format of Print  Switchable F - All
     C     W0AP1P        IFEQ      'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Detail line. of Print  Switchable F - All
     C     W0APDT        IFEQ      'Y'
     C                   Z-ADD     3             W0DTLN
     C     W0ACDT        IFEQ      'Y'
     C                   Z-ADD     0             W0COLN
     C                   END                                                    FI
     C                   END                                                    FI
      *
      * * First Page Format of Printo Switchable F - COB
     C     W0BP1P        IFEQ      'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Switchable Feature Number of Printo Switchable F - COB
     C     W0BP00        IFEQ      'Y'
     C                   ADD       3             W0FSUM
     C                   END                                                    FI
      *
      * * Component Name of Printo Switchable F - COB
     C     W0BP01        IFEQ      'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Detail line. of Printo Switchable F - COB
     C     W0BPDT        IFEQ      'Y'
     C                   Z-ADD     1             W0DTLN
     C     W0BCDT        IFEQ      'Y'
     C                   Z-ADD     4             W0COLN
     C                   END                                                    FI
     C                   END                                                    FI
      *
      * * First Page Format of Printo Switchable F - PF
     C     W0CP1P        IFEQ      'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Switchable Feature Number of Printo Switchable F - PF
     C     W0CP00        IFEQ      'Y'
     C                   ADD       3             W0FSUM
     C                   END                                                    FI
      *
      * * Object Name of Printo Switchable F - PF
     C     W0CP01        IFEQ      'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Detail line. of Printo Switchable F - PF
     C     W0CPDT        IFEQ      'Y'
     C                   Z-ADD     1             W0DTLN
     C     W0CCDT        IFEQ      'Y'
     C                   Z-ADD     4             W0COLN
     C                   END                                                    FI
     C                   END                                                    FI
      *
      * * First Page Format of Printo Switchable F - Men
     C     W0DP1P        IFEQ      'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Switchable Feature Number of Printo Switchable F - Men
     C     W0DP00        IFEQ      'Y'
     C                   ADD       3             W0FSUM
     C                   END                                                    FI
      *
      ****Menu*Group*Code*of*Printo*Switchable*F*-*Men*****************                       CSF002
     C********** W0DP01    IFEQ 'Y'                                                           CSF002
     C**********           ADD  0         W0FSUM                                              CSF002
     C**********           END                             FI                                 CSF002
      *
      * * Detail line. of Printo Switchable F - Men
     C     W0DPDT        IFEQ      'Y'
     C                   Z-ADD     1             W0DTLN
     C     W0DCDT        IFEQ      'Y'
     C                   Z-ADD     4             W0COLN
     C                   END                                                    FI
     C                   END                                                    FI
      *
      * * First Page Format of Printo Switchable F - Rep
     C     W0EP1P        IFEQ      'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Switchable Feature Number of Printo Switchable F - Rep
     C     W0EP00        IFEQ      'Y'
     C                   ADD       3             W0FSUM
     C                   END                                                    FI
      *
      * * Detail line. of Printo Switchable F - Rep
     C     W0EPDT        IFEQ      'Y'
     C                   Z-ADD     1             W0DTLN
     C     W0ECDT        IFEQ      'Y'
     C                   Z-ADD     4             W0COLN
     C                   END                                                    FI
     C                   END                                                    FI
      *
      * * First Page Format of Printo Switchable F - Rep
     C     W0FP1P        IFEQ      'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Switchable Feature Number of Printo Switchable F - Rep
     C     W0FP00        IFEQ      'Y'
     C                   ADD       3             W0FSUM
     C                   END                                                    FI
      *
      * * Report Name of Printo Switchable F - Rep
     C     W0FP01        IFEQ      'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Component Name of Printo Switchable F - Rep
     C     W0FP02        IFEQ      'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Detail line. of Printo Switchable F - Rep
     C     W0FPDT        IFEQ      'Y'
     C                   Z-ADD     3             W0DTLN
     C     W0FCDT        IFEQ      'Y'
     C                   Z-ADD     4             W0COLN
     C                   END                                                    FI
     C                   END                                                    FI
      *
      * * First Page Format of Printo Switchable F -PRTF
     C     W0GP1P        IFEQ      'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Switchable Feature Number of Printo Switchable F -PRTF
     C     W0GP00        IFEQ      'Y'
     C                   ADD       3             W0FSUM
     C                   END                                                    FI
      *
      * * Object Name of Printo Switchable F -PRTF
     C     W0GP01        IFEQ      'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Detail line. of Printo Switchable F -PRTF
     C     W0GPDT        IFEQ      'Y'
     C                   Z-ADD     1             W0DTLN
     C     W0GCDT        IFEQ      'Y'
     C                   Z-ADD     4             W0COLN
     C                   END                                                    FI
     C                   END                                                    FI
      *
      * * First Page Format of Printo Switchable F - Ini
     C     W0HP1P        IFEQ      'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Switchable Feature Number of Printo Switchable F - Ini
     C     W0HP00        IFEQ      'Y'
     C                   ADD       3             W0FSUM
     C                   END                                                    FI
      *
      * * Detail line. of Printo Switchable F - Ini
     C     W0HPDT        IFEQ      'Y'
     C                   Z-ADD     1             W0DTLN
     C     W0HCDT        IFEQ      'Y'
     C                   Z-ADD     4             W0COLN
     C                   END                                                    FI
     C                   END                                                    FI
      *
      *================================================================
     CSR   Q2EXIT        ENDSR
      /EJECT
     CSR   Q3PTNP        BEGSR
      *================================================================
      * Format select
      *================================================================
     C                   WRITE     $APAGHDR
      * Clear page overflow indicator
     C                   SETOFF                                       97        *
      *================================================================
     CSR   Q3EXIT        ENDSR
      /EJECT
     CSR   UASUBR        BEGSR
      *================================================================
      * Embedded PRTOBJ : Printo Switchable F - COB
      *================================================================
      * Printo Switchable F - COB: Mainline
     C                   EXSR      B0MAIN
      *================================================================
     CSR   UAEXIT        ENDSR
      /EJECT
     CSR   UBSUBR        BEGSR
      *================================================================
      * Embedded PRTOBJ : Printo Switchable F - PF
      *================================================================
      * Printo Switchable F - PF: Mainline
     C                   EXSR      C0MAIN
      *================================================================
     CSR   UBEXIT        ENDSR
      /EJECT
     CSR   UCSUBR        BEGSR
      *================================================================
      * Embedded PRTOBJ : Printo Switchable F - Men
      *================================================================
      * Printo Switchable F - Men: Mainline
     C                   EXSR      D0MAIN
      *================================================================
     CSR   UCEXIT        ENDSR
      /EJECT
     CSR   UDSUBR        BEGSR
      *================================================================
      * Embedded PRTOBJ : Printo Switchable F - Rep
      *================================================================
      * Printo Switchable F - Rep: Mainline
     C                   EXSR      E0MAIN
      *================================================================
     CSR   UDEXIT        ENDSR
      /EJECT
     CSR   UESUBR        BEGSR
      *================================================================
      * Embedded PRTOBJ : Printo Switchable F - Rep
      *================================================================
      * Printo Switchable F - Rep: Mainline
     C                   EXSR      F0MAIN
      *================================================================
     CSR   UEEXIT        ENDSR
      /EJECT
     CSR   UFSUBR        BEGSR
      *================================================================
      * Embedded PRTOBJ : Printo Switchable F -PRTF
      *================================================================
      * Printo Switchable F -PRTF: Mainline
     C                   EXSR      G0MAIN
      *================================================================
     CSR   UFEXIT        ENDSR
      /EJECT
     CSR   UGSUBR        BEGSR
      *================================================================
      * Embedded PRTOBJ : Printo Switchable F - Ini
      *================================================================
      * //Start of S01430 - Inclusion of Initialisation programs
      * Printo Switchable F - Ini: Mainline
     C                   EXSR      H0MAIN
      * //End of S01430 - Inclusion of Initialisation programs
      *================================================================
     CSR   UGEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                   MOVEL     *BLANK        P0RTN
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
     C/EXEC SQL                                                                             MD055681
     C+ close ACursor                                                                       MD055681
     C/END-EXEC                                                                             MD055681
      * Terminate program
     C                   SETON                                        LR
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   MOVE      *BLANK        P0RTN
     C                   MOVE      *BLANK        W0RTN             7
     C                   MOVEL     *BLANK        W0RSL             1
     C                   MOVEL     *BLANK        W0RSF             1
      * Setup job date/time
      *
     C                   Z-ADD     UDATE         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME             6 0
      * Define work field midas rundate
     C                   MOVEL     *BLANK        WUAANA            7
      * Define work field run day number
     C                   Z-ADD     *ZERO         WUAKTX            5 0
      * Define work field Set Up Complete
     C                   MOVEL     *BLANK        WUAUST            1
      * Define work field date format flag
     C                   MOVEL     *BLANK        WUE3ST            1
      * Define work field Multi-branching Indicator
     C                   MOVEL     *BLANK        WUF1ST            1
      * Define work field Work Converted Date (6.0)
     C                   Z-ADD     *ZERO         WUWCDT            6 0
      * Define work field Work Converted Date (7A)
     C                   MOVEL     *BLANK        WUWADT            7
      * Define work field Access Obj Return Code
     C                   MOVEL     *BLANK        WURTCD            7
      * Define work field Access Obj Access Option
     C                   MOVEL     *BLANK        WUOPTN            7
      * Define work field Component Name
     C                   MOVEL     *BLANK        WUCOTT           10
      * Define work field Component Sequence Number
     C                   MOVEL     *BLANK        WUCSEQ            5
      * Define work field Access Obj Rec Fmt (200)
     C                   MOVEL     *BLANK        WUFMT           200
     C                   MOVEL     ##PGM         $APGM
     C                   MOVEL     *BLANK        W0PFM             1
     C                   Z-ADD     *ZERO         @$WRK             4 0
     C                   Z-ADD     *ZERO         @$HDL             4 0
      * Adjust page length and overflow as necessary
     C     @$PGL         SUB       2             W0PGL             4 0
     C     @$OFL         IFGE      W0PGL
     C     W0PGL         SUB       2             W0OFL             4 0
     C                   ELSE
     C                   Z-ADD     @$OFL         W0OFL
     C                   END
      * Clear overflow indicator
     C                   SETOFF                                       97
      * Request new page
     C                   MOVEL     'Y'           W0NEWP            1
      * USER: Initialise program
      * Standard RPG Creation Par - Standard functions  *
      * Copyright Statement - Standard functions  *
      * SC3010P   Last Amend Box - Switchable Features  *
      * Get Rundate for PRTF - Rundate  *
     C     *DTAARA       DEFINE                  RUNDAT
     C                   IN        RUNDAT
     C                   MOVE      MRDT          $AAANA
      * Get Bank Title for PRTF - Standard functions  *
      *****************************************************************
      *
      *   Declare Bank Details Data Structure
      *   And Extract User Report Title from Bank details
      *
      *****************************************************************
      *
     C                   CALL      'AOBANKR0'
     C                   PARM                    P@RTCD            7            B:Return code
     C                   PARM      '*FIRST'      P@OPTN            7            I:Option
     C     P@BANK        PARM      P@BANK        P@FMT                          O:Format
      *
     C                   MOVEL     BJURPT        $AURPT
      *================================================================
     CSR   ZZEXIT        ENDSR
**CTDATA CPY@
(c) Finastra International Limited 2001
