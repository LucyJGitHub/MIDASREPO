0001 H        1                                                           SD1050
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas SC Determine day name')
0002 F********************************************************************SD1050
     F*  Midas - System Control
0004 F*                                                                  *SD1050
0005 F*    SD1050 - DETERMINE DAY NAME                                   *SD1050
0006 F*                                                                  *SD1050
      *  (c) Finastra International Limited 2001                      *
0008 F*                                                                  *SD1050
      *  Last Amend No. MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *  Prev Amend No. S01194             Date 02Feb90               *
     F*                                                                  *
     F********************************************************************
     F*                                                               *
      *  MD046248 - Finastra Rebranding                               *
     F*     S01194 - NEW STANDING DATA FILES                          *
0010 F*                                                                  *SD1050
0011 F********************************************************************SD1050
0012 F*                                                                   SD1050
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
/****F*: OVRDBF TABLE TABSDM                                        : *   S01194
     F*                                                               *
     F*****************************************************************
0013 F*****TABLE   IP  F      96 12AI     2 DISK                    SD1050S01194
0014 F*                                                                   SD1050
0015 F* ID F  C  H  L    FUNCTION OF INDICATORS                           SD1050
0016 F**01**********  INSTALLATION CONTROL DATA RECORD 1.           SD1050S01194
     F**02**********  CATCHALL                                            S01194
0017 F********30****  INSTALATION CONTROL DATA RECORD 1 FOUND       SD1050S01194
0018 F*       40      NAME OF DAY IS FOUND IN ARRAY.                      SD1050
0019 F*          U8   DATABASE IN ERROR,REQUIRED RECORD NOT FOUND.        SD1050
0020 F*                                                                   SD1050
0021 E                    TABNO   7   7  1 0 TABDAY  3   DAY NOS. & NAMES SD1050
0022 E*                                                                   SD1050
     E                    CPY@    1   1 80
0022 E*                                                                   S01194
0023 I*****TABLE*FILE*-*INSTALLATION*CONTROL*DATA*RECORD*1.               S01194
0024 I**                                                                  S01194
0025 I***TABLE   NS  01   1 CD   2 C0   3 C1                              S01194
0026 I***    AND      12 C1  13 C0                                        S01194
0027 I***                                     1   1 RECI                  S01194
0028 I***                                     2   30RECT                  S01194
0029 I***                                    12  130RCDE                  S01194
0030 I***                                    14  66 TITL                  S01194
0031 I***                                    67  67 DATF                  S01194
0032 I***                                    68  700DFBR                  S01194
0033 I***                                    74  74 MODI1                 S01194
0034 I***                                    75  75 MODI2                 S01194
0035 I***                                    76  76 MODI3                 S01194
0036 I***                                 P  77  790RUND                  S01194
0037 I***                                    80  86 RUNA                  S01194
0038 I***                                    87  870SFLG                  S01194
0039 I***                                 P  90  920LCD                   S01194
0040 I***                                    93  93 CHTP                  S01194
0041 I***                                 P  94  960TNLU                  S01194
0042 I***                                     1  96 LOT                   S01194
0043 I**                                                                  SD1050
0044 I**   CATCHALL FOR DELETED RECORDS.                                  SD1050
0045 I***     NS  02                                                      S01194
0046 I**                                                                  SD1050
0047 I**                                                                  SD1050
0048 I*                                                                   SD1050
0049 I*    LOCAL DATA AREA TO CONTAIN SHORT NAME OF DAY                   SD1050
0050 ILDA        UDS                            256                       SD1050
0051 I                                      213 215 DAYNAM                SD1050
0052 I**                                                                  SD1050
0053 I**                                                                  SD1050
     ISDBANK    E DSSDBANKPD                                              S01194
     I** EXTERNAL DATA STRUCTURE FOR ACCESS PROGRAM FORMAT                S01194
     I*                                                                   S01194
     IDSFDY     E DSDSFDY                                                 S01194
     I** FIRST DATA STRUCTURE FOR ACCESS PROGRAM, SHORT DATA STRUCTURE    S01194
     I*                                                                   S01194
     C                     MOVEACPY@      BIS@   80
     C*
     C*    USE ACCESS PROGRAM TO OBTAIN RECORD FROM SDBANKPD              S01194
     C*                                                                   S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' P@RTCD  7                       S01194
     C                     PARM '*FIRST ' P@OPTN  7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C*                                                                   S01194
     C** DATABASE ERROR HANDLING IF BLANK RETURN                          S01194
     C** CODE NOT FROM RECEIVED FROM ACCESS PROGRAM                       S01194
     C*                                                                   S01194
     C           P@RTCD    IFNE *BLANK                                    S01194
     C                     SETON                     LRU8                 S01194
     C                     RETRN                                          S01194
     C*                                                                   S01194
     C** ELSE  SETON LR FOR REMAINING PROCESSING                          S01194
     C*                                                                   S01194
     C                     ELSE                                           S01194
     C                     SETON                     LR                   S01194
     C                     END                                            S01194
     C*                                                                   S01194
0054 C**SET*INDICATORS*FOR*INSTALLATION*CONTROL*DATA*RECORD*1*FOUND.      S01194
0055 C***01                SETON                     LR30                 S01194
0056 C*                                                                   SD1050
0057 C*****IF*I.C.D.R.*NOT*FOUND,*DATABASE*ERROR***                       S01194
0058 C***LRN30                SETON                     U8                S01194
0059 C***LR U8                GOTO END                                    S01194
0060 C*                                                                   SD1050
0061 C**   TO FIND WEEKDAY NO. AND SHORTNAME OF DAY.                      SD1050
0062 C***LR      RUND      DIV  7         DUMP    50                      S01194
0062 CLR         BJRDNB    DIV  7         DUMP    50                      S01194
0063 CLR                   MVR            DAYNO   10                      SD1050
0064 CLR         DAYNO     LOKUPTABNO     TABDAY         40               SD1050
0065 C**                                                                  SD1050
0066 C**   MOVE DAY SHORTNAME TO LOCAL DATA AREA                          SD1050
0067 CLR    40             MOVE TABDAY    DAYNAM                          SD1050
0068 C**                                                                  SD1050
0069 CLR         END       TAG                             ** END TAG **  SD1050
0070 C**                                                                  SD1050
0071 C**                                                                  SD1050
**   TABNO/TABDAY - DAY NUMBERS & SHORTNAMES
0FRI1SAT2SUN3MON4TUE5WED6THU
** CPY@   OBJECT COPYRIGHT
(c) Finastra International Limited 2001
