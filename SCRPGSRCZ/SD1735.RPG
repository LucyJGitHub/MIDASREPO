0001 H
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas SC Setup MMOD module indicators')
0002 F********************************************************************
0004 F*                                                                  *
     F*  Midas - System Control Module
0004 F*                                                                  *
0005 F*    SD1735 - SETUP D/MMOD MODULE INDICATORS (NOT UNDER            *
0006 F*             COMMITMENT CONTROL)                                  *
0006 F*                                                                  *
     F*     (c) Finastra International Limited 2001                      *
0008 F*                                                                  *
      *  Last Amend No. MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*    PREV AMEND NO. E29436            DATE 11OCT91                 *
     F*                   E21395            DATE 09AUG90                 *
     F*                   E22666            DATE 12JUL90                 *
     F*                   S01194            DATE 21FEB90                 *
     F*                   S01156            DATE 22/04/88                *
     F*                   E12816            DATE 26/04/88                *
0010 F*                                                                  *
0010 F********************************************************************
0010 F*                                                                  *
     F*    MD046248 - Finastra Rebranding                                *
     F*    E29436  -  MOVE TO SCRPGSRC FROM RR.                          *
     F*    E21395  -  MMODF IS NOT MOVED INTO DBASE CORRECTLY DURING     *
     F*               DBASE ERROR 1 PROCESSING.                          *
     F*    E22666  -  ALL MMOD POSITIONS AFTER 58 WERE SET TO N AFTER    *
     F*               RUNNING THIS PGM & ANY NEW MODULE NEEDED TO BE     *
     F*               ADDED TO DATA STRUCTURE MMOD. NOW, ANY CHANGE TO   *
     F*               MMODF ONLY REQUIRES RE-COMPILATION OF THIS PGM.    *
     F*    S01194  -  NEW STANDING DATA                                  *
0010 F*    S01156  -  TESTKEY INTERFACE                                  *
0010 F*    E12816  -  CHIPS FIELDS CORRECTED                             *
0010 F*    S01147  -  PROGRAM RE-WRITTEN FOR R22                         *
0010 F*                                                                  *
0011 F********************************************************************
0012 F*
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0013 FMMODF   IF  E                    DISK
     F                                              KRECNO RCD
0014 F* ID F  C  H  L    FUNCTION OF INDICATORS
0015 F* 05            OFF FOR FIRST CYCLE
0040 F*       80      INSTALLATION CONTROL DATA FOUND
0041 F*       U7 U8   DATABASE ERROR
0042 E                    MODS      256  1               MODULE INDICATORS
     E                    CPY@    1   1 80
0067 I*
0068 I****MMOD*DATA*STRUCTURE*CONTAINING*MODULES*INDICATORS***            E22666
0069 I*MMOD******UDS****************************256                       E22666
0070 I****************************************1 256 MODS                  E22666
     I****************************************1   1 SDGL                  E22666
     I****************************************2   2 DLFL                  E22666
     I****************************************3   3 RTFL                  E22666
     I****************************************4   4 CLFL                  E22666
     I****************************************5   5 STFL                  E22666
     I****************************************6   6 BCFL                  E22666
     I****************************************7   7 EMFL                  E22666
     I****************************************8   8 FMFL                  E22666
     I****************************************9   9 SRFL                  E22666
     I***************************************10  10 LEFL                  E22666
     I***************************************11  11 FDFL                  E22666
     I***************************************12  12 CMFL                  E22666
     I***************************************13  13 FXFL                  E22666
     I***************************************14  14 MMFL                  E22666
     I***************************************15  15 CNFL                  E22666
     I***************************************16  16 RETF                  E22666
     I***************************************18  18 MSWF                  E22666
     I***************************************19  19 ABFL                  E22666
     I***************************************20  20 CAFL                  E22666
     I***************************************21  21 SEFL                  E22666
     I***************************************22  22 RCFL                  E22666
     I***************************************23  23 IAFL                  E22666
     I***************************************25  25 SWDE                  E22666
     I***************************************26  26 SWSM                  E22666
     I***************************************27  27 SWCO                  E22666
     I***************************************28  28 SWLN                  E22666
     I***************************************29  29 SWLC                  E22666
     I***************************************30  30 SWTR                  E22666
     I***************************************31  31 SWMO                  E22666
     I***************************************32  32 SWCN                  E22666
     I***************************************33  33 TLDE                  E22666
     I***************************************34  34 TLSM                  E22666
     I***************************************35  35 TLCO                  E22666
     I***************************************36  36 TLLN                  E22666
     I***************************************37  37 TLLC                  E22666
     I***************************************38  38 TLTR                  E22666
     I***************************************39  39 TLTX                  E22666
     I***************************************40  40 TLAR                  E22666
     I***************                        41  41 CHDE                  E12816
     I***************                        42  42 CHCO                  E12816
     I***************                        43  43 CHLN                  E12816
     I***************                        44  44 CHSM                  E12816
     I***************                        45  45 CHLC                  E12816
     I***************                        46  46 CHTR                  E12816
     I***************                        47  47 CHTX                  E12816
     I***************                        48  48 CHAT                  E12816
     I***************************************41  41 MCDL            E12816E22666
     I***************************************43  43 MCLE            E12816E22666
     I***************************************44  44 MCOB            E12816E22666
     I***************************************45  45 CH              E12816E22666
     I***************************************48  48 FDRT            E12816E22666
     I***************************************49  49 GRFL                  E22666
     I***************************************50  50 FFFL                  E22666
     I***************************************51  51 MTFL                  E22666
     I***************************************52  52 MTCO                  E22666
     I***************************************53  53 MTDE                  E22666
     I***************************************54  54 MTGE                  E22666
     I***************************************55  55 MTLN                  E22666
     I***************************************56  56 NMFL                  E22666
     I***************************************57  57 FTFL                  E22666
     I***************************************58  58 TKFL            S01156E22666
     I*                                                                   E22666
     IMMOD      E DSMMODF                                                 E22666
     I*   MMOD Data structure containing Modules indicators               E22666
     I                                        1 256 MODS                  E22666
     I*                                                                   E22666
     I**   STANDARD LOCAL DATA AREA FIELDS
     ILDA        UDS                            256
     I**************                        134 138 DBFILE                S01194
     I**************                        139 167 DBKEY                 S01194
     I**************                        168 175 DBPGM                 S01194
     I**************                        176 1770DBASE                 S01194
     I                                      134 141 DBFILE                S01194
     I                                      142 170 DBKEY                 S01194
     I                                      171 180 DBPGM                 S01194
     I                                      181 1830DBASE                 S01194
     C                     MOVEACPY@      BIS@   80
     C*     INITIALISE LDA
     C   05                GOTO NOTFC
     C           *NAMVAR   DEFN           MMOD                            E22666
     C           *LOCK     IN   MMOD                                      E22666
     C  N05                MOVE 'N'       MODS
     C  N05                SETON                     05
     C*
     C           NOTFC     TAG                             ** NOTFC TAG **
     C*
     C           *NAMVAR   DEFN           LDA
     C           *LOCK     IN   LDA
     C                     MOVE *BLANKS   DBFILE
     C                     MOVE *BLANKS   DBKEY
     C                     MOVE *BLANKS   DBPGM
     C                     MOVE *BLANKS   DBASE
     C                     OUT  LDA
0080 C***  READ MMODF
     C                     Z-ADD1         RCD     10
     C           RCD       SETLLMMODFF
     C                     READ MMODFF                   80
0080 C*
     C   80      *LOCK     IN   LDA
     C   80                SETON                     U7U8
     C***80****************MOVE 'MMODF '  DBFILE           ***************E21395
     C   80                MOVEL'MMODF'   DBFILE           ***************E21395
     C   80                Z-ADD01        DBASE            *  DBASE 01****
     C   80                MOVE 'SD1735  'DBPGM            ************
     C   80                OUT  LDA
     C*
     C                     OUT  MMOD                                      E22666
0080 C*
0081 C                     SETON                     LR
0082 C*
0131 C           END       TAG                             ** END TAG **
**  CPY@
(c) Finastra International Limited 2001
