/*********************************************************************/
/*STD    CLPBASEBND                                                  */
/*EXI    TEXT('Midas SD Submit ARR Calculator Scheduler')            */
/*********************************************************************/
/*                                                                   */
/*       Midas - Standing Data Module                                */
/*                                                                   */
/*       SDC000115 - Submit ARR Calculator Scheduler                 */
/*                                                                   */
/*       (c) Finastra International Limited 2020                     */
/*                                                                   */
/*       Last Amend No. CSD103  *CREATE    Date 10Aug20              */
/*                                                                   */
/*********************************************************************/
/*                                                                   */
/*       CSD103 - LIBOR Deregulation - Common Layer/Standing Data    */
/*                                                                   */
/*********************************************************************/
             PGM

             DCL        VAR(&PREFIX) TYPE(*CHAR) LEN(2)
             DCL        VAR(&JOBDLIB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&JOBNAME) TYPE(*CHAR) LEN(10)

             COPYRIGHT  TEXT('(c) Finastra International Limited +
                          2020')

/** Global monitor message */

             MONMSG     MSGID(CPF0000 MCH0000 RPG0000) EXEC(GOTO +
                          CMDLBL(ABNOR))

             SNDPGMMSG  MSG('SDC000115 - Submit ARR Calculator +
                          Scheduler') TOMSGQ(MRUNQ)

/** Retrieve zone system prefix */

             RTVDTAARA  DTAARA(SDSTAT (6 2)) RTNVAR(&PREFIX)

/** Clear status file */

             CLRPFM     FILE(SDCSTSTD)

/** Submit the ARR Calculator Batch Job Scheduler */

             CHGVAR     VAR(&JOBDLIB) VALUE(&PREFIX *TCAT 'XLIB')
             CHGVAR     VAR(&JOBNAME) VALUE('ARRSCHD_' *TCAT &PREFIX)
             SBMJOB     CMD(CALL PGM(SDC000113)) JOB(&JOBNAME) +
                          JOBD(&JOBDLIB/MBATCH) JOBQ(INTERFACE) +
                          OUTQ(*JOBD) USER(*JOBD)

             GOTO       CMDLBL(END)

/** Abnormal termination */
ABNOR:
             CHGJOB     SWS(XXXXXX11)
             SNDPGMMSG  MSGID(CPF9898) MSGF(QCPFMSG) MSGDTA('Program +
                          SDC000115 ended abnormally - see job log') +
                          TOMSGQ(MOPERQ MRUNQ)
             MONMSG     MSGID(CPF0000 MCH0000)

END:
             ENDPGM
