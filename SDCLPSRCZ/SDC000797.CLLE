/*********************************************************************/
/*STD    CLPBASEBND                                                  */
/*EXI    TEXT('Midas Limit Utilisation Prompt - check year')         */
/*********************************************************************/
/*                                                                   */
/*       Midas - Standing Data Module                                */
/*                                                                   */
/*       SDC000797 - SD Limit Utilisation - Check the year history   */
/*                   file for prompt                                 */
/*                                                                   */
/*       (c) Misys International Banking Systems Ltd. 2008           */
/*                                                                   */
/*       Last Amend No. CER059             Date 19Jul10              */
/*       Prev Amend No. BUG24574           Date 07Jul09              */
/*                      CER048  *CREATE    Date 19May08              */
/*                                                                   */
/*********************************************************************/
/*                                                                   */
/*       CER059 - German Feature Upgrade to Delhi                    */
/*       BUG24574 - Withholding Tax - R4 vs M+                       */
/*       CER048 - German Features - Taxes                            */
/*                                                                   */
/*********************************************************************/
/** Start Program  */
             PGM        PARM(&TESTY &FOUND)
 
/** Declare variable  */
             DCL        VAR(&CPYFLD) TYPE(*CHAR) LEN(64) VALUE('(c) +
                        Misys International Banking Systems Ltd. +
                        2008')
 
             DCL        VAR(&TESTY) TYPE(*CHAR) LEN(2)
             DCL        VAR(&FOUND) TYPE(*CHAR) LEN(1)
 
             DCL        VAR(&MBRNAME) TYPE(*CHAR) LEN(10)                               /*BUG24574*/
/**********  DCL        VAR(&FILE1) TYPE(*CHAR) LEN(08) +
                          VALUE('SDINPHL1')                          */                 /*BUG24574*/
/**********  DCL        VAR(&FILE) TYPE(*CHAR) LEN(10)               */                 /*BUG24574*/
 
/** If option is 'O' like open */
             IF         COND(&TESTY *NE '  ') THEN(DO)
 
/***Find*the*file's*name***/                                                            /*BUG24574*/
/**********  CHGVAR     VAR(&FILE) VALUE(&FILE1 *CAT &TESTY)         */                 /*BUG24574*/
 
/***Check*the*year*history*file*exists***/                                              /*BUG24574*/
/**********  CHKOBJ     OBJ(*LIBL/&FILE) OBJTYPE(*FILE)              */                 /*BUG24574*/
/**********  MONMSG     MSGID(CPF9801) EXEC(DO)                      */                 /*BUG24574*/
                                                                                        /*BUG24574*/
/** Check if member exists */                                                           /*BUG24574*/
             CHGVAR     VAR(&MBRNAME) VALUE('SDINPHPD' *CAT &TESTY)                     /*BUG24574*/
             CHKOBJ     OBJ(SDINPHPD) OBJTYPE(*FILE) MBR(&MBRNAME)                      /*BUG24574*/
             MONMSG     MSGID(CPF9815) EXEC(DO)                                         /*BUG24574*/
             CHGVAR     VAR(&FOUND) VALUE('N')
             ENDDO
 
             ENDDO
 
             CHGVAR   VAR(&CPYFLD) VALUE('(c) +
                       Misys International Banking Systems Ltd.')
 ENDPGM:     ENDPGM
