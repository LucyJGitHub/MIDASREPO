/*********************************************************************/
/*STD    CLPBASEBND                                                  */
/*EXI    TEXT('Midas SD Stamp Tax Extract Message Information')      */
/*********************************************************************/
/*                                                                   */
/*       Midas - Standing Data                                       */
/*                                                                   */
/*       SDC008190 - Stamp Tax Extract Message Information           */
/*                                                                   */
/*       (C) Copyright Misys International Banking Systems Ltd 2010  */
/*                                                                   */
/*       Last Amend No. CER049  *CREATE    Date 06Dec10              */
/*                                                                   */
/*********************************************************************/
/*                                                                   */
/*       CER049 - Stamp Tax                                          */
/*                                                                   */
/*********************************************************************/
             PGM        PARM(&MSGID &MSGF &MSGDTA &TXT1 &TXT2)
 
             DCL        VAR(&CPYFLD) TYPE(*CHAR) LEN(64) VALUE('(c) +
                          Copyright Misys International Banking +
                          Systems Ltd. 2010')
 
/** Declare variables */
 
             DCL        VAR(&MSGID) TYPE(*CHAR) LEN(7)
             DCL        VAR(&MSGF) TYPE(*CHAR) LEN(10)
             DCL        VAR(&MSGDTA) TYPE(*CHAR) LEN(132)
             DCL        VAR(&TXT1) TYPE(*CHAR) LEN(132)
             DCL        VAR(&TXT2) TYPE(*CHAR) LEN(512)
 
/** Global Monitor Message */
 
             MONMSG     MSGID(CPF0000 RPG0000 MCH0000) +
                           EXEC(GOTO ABNORMAL)
 
/** Set switches & remove messages */
 
             RMVMSG     PGMQ(*SAME) CLEAR(*ALL)
             CHGJOB     SWS(XXXXX000)
 
/** Send message to program */
 
             RTVMSG     MSGID(&MSGID) MSGF(&MSGF) MSGDTA(&MSGDTA) +
                          MSG(&TXT1) SECLVL(&TXT2)
             MONMSG     MSGID(CPF2407 CPF2419 CPF0001) EXEC(DO)
 
/** Message not found */
 
             RTVMSG     MSGID(CGD1018) MSGF(CGUSRMSG) MSGDTA(&MSGID +
                          *CAT &MSGF) MSG(&TXT1) SECLVL(&TXT2)
             ENDDO
 
             GOTO       CMDLBL(ENDCLPGM)
 
/** Abnormal termination processing                       */
 
ABNORMAL:
             CHGJOB     SWS(XXXXXX11)
             MONMSG     MSGID(CPF0000 RPG0000 MCH0000)
             RCLRSC     LVL(*CALLER)
             MONMSG     MSGID(CPF0000 RPG0000 MCH0000)
             DMPCLPGM
             MONMSG     MSGID(CPF0000 RPG0000 MCH0000)
 
             SNDPGMMSG  MSG('Program SDC008190 ended abnormally') +
                          TOMSGQ(MOPERQ MRUNQ)
             MONMSG     MSGID(CPF0000 RPG0000 MCH0000)
             SNDPGMMSG  MSGID(CPF9898) MSGF(QCPFMSG) MSGDTA('Program +
                          SDC008190 ended abnormally') MSGTYPE(*ESCAPE)
             MONMSG     MSGID(CPF0000 RPG0000 MCH0000)
 
 ENDCLPGM:
             CHGVAR     VAR(&CPYFLD) VALUE('Copyright Misys International +
                          Banking Systems Ltd.')
             MONMSG     MSGID(CPF0000 RPG0000 MCH0000)
 
             ENDPGM
