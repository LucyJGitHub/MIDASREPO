/*********************************************************************/
/*STD    CLPBASEMOD                                                  */
/*EXI *  TEXT('Midas SD Init. program for Change Control 236137.')   */
/*********************************************************************/
/*                                                                   */
/*       Midas    - Standing Data Module                             */
/*                                                                   */
/*       SDCCTTXINI - Initialis. Program for Change Control 236137   */
/*                                                                   */
/*       (c) Misys International Banking Systems Ltd. 2005           */
/*                                                                   */
/* Bank Fusion Midas 1.4 Base ---------------------------------------*/
/* Midas Plus 1.4 Base 04 -------------------------------------------*/
/* Midas Plus 1.4 Base ----------------------------------------------*/
/* Midas Plus 1.3 ---------------- Base -----------------------------*/
/*       Last Amend No. 236137  *CREATE    Date 20Sep05              */
/*                                                                   */
/*********************************************************************/
/*                                                                   */
/*       236137 - Change Control 1 for CGL031 & CGL032 - Part 4      */
/*                Changes to Premium and Discount Accrual Processing.*/
/*                to set up SDCTTXPD new field default values.       */
/*                                                                   */
/*********************************************************************/
             PGM        PARM(&RTCD &PMODE)
 
             COPYRIGHT TEXT('(c) Misys International Banking Systems Ltd. +
                          2005')
 
             DCL        VAR(&RTCD) TYPE(*CHAR) LEN(7)
             DCL        VAR(&PMODE) TYPE(*CHAR) LEN(1)
             DCL        VAR(&PRE)  TYPE(*CHAR) LEN(2)
             DCL        VAR(&TOLIB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&SDSTAT) TYPE(*CHAR) LEN(256)
 
             MONMSG     MSGID(CPF0000 MCH0000 RPG0000) EXEC(GOTO +
                          CMDLBL(ABNOR))
 
/** Mode 1 - First call or Mode 2 - Second call */
 
             IF         COND((&PMODE *EQ '1') *OR (&PMODE  *EQ '2')) THEN(DO)
 
/** Get system prefix. */
 
                RTVDTAARA  DTAARA(SDSTAT) RTNVAR(&SDSTAT)
 
                CHGVAR     VAR(&PRE) VALUE(%SST(&SDSTAT 6 2))
                CHGVAR     VAR(&TOLIB) VALUE(&PRE *TCAT 'DPLIB')
 
/** Create temporary file to hold SDCTTXPD records. */
 
                CPYF       FROMFILE(SDCTTXPD) TOFILE(&TOLIB/SDCTTXPDX) +
                             MBROPT(*REPLACE) CRTFILE(*YES) +
                             FMTOPT(*NONE)
                MONMSG     (CPF2817) CMPDTA(CPF2869)
 
                CALL       PGM(SDCTTXINIT)
 
                IF         COND(%SWITCH(XXXXXX00)) THEN(GOTO CMDLBL(END))
 
                ELSE       CMD(DO)
 
                   CPYF       FROMFILE(SDCTTXPDX) TOFILE(SDCTTXPD) +
                                MBROPT(*REPLACE) FMTOPT(*NONE)
                   MONMSG     (CPF2817) CMPDTA(CPF2869)
 
                   CHGVAR     VAR(&RTCD) VALUE('*ERROR*')
                   CHGJOB     SWS(00000000)
 
                ENDDO
 
/** End of Mode 1/Mode 2 */
 
             ENDDO
 
/** Mode 3 - Deletion */
 
             IF         COND(&PMODE *EQ '3') THEN(DO)
             ENDDO
 
             GOTO       CMDLBL(END)
 
 ABNOR:
             SNDPGMMSG  MSG('Program SDCCTTXINI ended abnormally') TOPGMQ(*EXT)
             MONMSG     MSGID(CPF0000 MCH0000)
 
 END:
             IF         COND((&PMODE *EQ '1') *OR (&PMODE  *EQ '2')) THEN(DO)
                DLTF       FILE(SDCTTXPDX)
                MONMSG     MSGID(CPF0000 MCH0000)
             ENDDO
 
             ENDPGM
