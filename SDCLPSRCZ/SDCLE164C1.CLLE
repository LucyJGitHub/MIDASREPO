/*********************************************************************/
/*STD    CLPBASEBND                                                  */
/*********************************************************************/
/*                                                                   */
/*       Midas - Customer Lending Module                             */
/*                                                                   */
/*       SDCLE164C1 - Initialize new fields (Take-on Only)           */
/*                                                                   */
/*       (c) Misys International Banking Systems Ltd. 2014           */
/*                                                                   */
/*       Last Amend No. MD031687  *CREATE    Date 18Dec14            */
/*                                                                   */
/*********************************************************************/
/*                                                                   */
/*       MD031687 - Initialize data for SDRPKYTD                     */
/*                  Repayment Priority Key                           */
/*                                                                   */
/*********************************************************************/
             PGM        PARM(&RTCDE &PMODE)


             DCL        VAR(&PMODE) TYPE(*CHAR) LEN(1)
             DCL        VAR(&RTCDE) TYPE(*CHAR) LEN(7)
             DCL        VAR(&CPYFLD) TYPE(*CHAR) LEN(64) VALUE('(c) +
                          Misys International Banking Systems Ltd. +
                          2014')

/* Global monitor message */

             MONMSG     MSGID(CPF0000 MCH0000 RPG0000) EXEC(GOTO +
                          CMDLBL(ABNOR))

             CHGJOB     SWS(XXXXXX00)


/* Mode 1 - First call */

             IF         COND(&PMODE *EQ '1') THEN(DO)

             SNDPGMMSG  MSG('CLE164 SDRPKYTD Initialisation') +
                          TOMSGQ(MRUNQ)

             CALL       PGM(SDCLE16401)
             MONMSG     MSGID(CPF0000) EXEC(GOTO ABNOR)

             IF         COND(%SWITCH(XXXXXX1X)) THEN(GOTO ABNOR)


             GOTO       CMDLBL(END)
             ENDDO

/* Mode 2 - Initialisation is re-run. */

             IF         COND(&PMODE *EQ '2') THEN(DO)

             SNDPGMMSG  MSG('CLE164 SDRPKYTD Initialisation') +
                          TOMSGQ(MRUNQ)

             CALL       PGM(SDCLE16401)
             MONMSG     MSGID(CPF0000) EXEC(GOTO ABNOR)

             IF         COND(%SWITCH(XXXXXX1X)) THEN(GOTO ABNOR)


             GOTO       CMDLBL(END)
             ENDDO


/* Mode 3 - Deletion */

             IF         COND(&PMODE *EQ '3') THEN(DO)

             SNDPGMMSG  MSG('CLE164 SDRPKYTD Deletion') +
                          TOMSGQ(MRUNQ)

             CALL       PGM(SDCLE16403)
             MONMSG     MSGID(CPF0000) EXEC(GOTO ABNOR)

             IF         COND(%SWITCH(XXXXXX1X)) THEN(GOTO ABNOR)


             GOTO       CMDLBL(END)
             ENDDO

             GOTO       CMDLBL(END)


ABNOR:

             CHGVAR     VAR(&RTCDE) VALUE('*ERROR')

 /* Send the error message */

             SNDPGMMSG  MSG('Program SDCLE164C1 ended abnormally') +
                          TOMSGQ(MOPERQ)

END:
             CHGVAR     VAR(&CPYFLD) VALUE('(c) +
                          Misys International Banking Systems Ltd.')


             ENDPGM

