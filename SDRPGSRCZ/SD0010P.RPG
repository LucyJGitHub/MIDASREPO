000100200529     H*********** Y                                                       CDL006
000200200529     H        1   Y                                                       CDL006
000300200529      *****************************************************************
000400200529/*OVR *  OVRDBF FILE(GPCSTXL1) TOFILE(GPCUSTXL1)                      *                       CGP001
000500200529/*STD *  RPGBASE                                                      *
000600200529/*EXI *  TEXT('Midas SD Customers report')                            *
000700200529     F*****************************************************************
000800200529     F*                                                               *
000900200529     F*  Midas - Standing Data Module
001000200529     F*                                                               *
001100200529     F*  SD0010P - CLIENT REPORT                                      *
001200200529     F*                                                               *
001300200529      *  (c) Finastra International Limited 2001                      *
001400200529      *                                                               *
001401200618      *  Last Amend No. 248936B            Date 22MAY20               *
001500200618      *  PREV Amend No. 248936A            Date 22May20               *
001600200618      *                 CER050             Date 16Jun19               *
001700200529      *                 MD050212           Date 02Apr18               *
001800200529      *                 CGL177             Date 11Jan16               *
001900200529      *                 MD046248           Date 05Feb18               *
002000200529      *                 MD049187           Date 04Jan18               *
002100200529      *                 CER073C            Date 09Oct17               *
002200200529      *                 CER073A            Date 05Sep17               *
002300200529      *                 CER073             Date 10Jul17               *
002400200529      *                 CSW216             Date 14Mar16               *
002500200529      *                 CER071             Date 01Aug16               *
002600200529      *                 LLN022A            Date 03Jun15               *
002700200529      *                 LLN022             Date 03Jun15               *
002800200529      *                 CER070             Date 19Aug14               *
002900200529      *                 CSW214             Date 25Nov14               *
003000200529      *                 MD025682           Date 19Aug14               *
003100200529      *                 CGL132             Date 01May13               *
003200200529      *                 CSW213             Date 03Jun13               *
003300200529      *                 CLE134             Date 01Aug12               *
003400200529      *                 AR787620           Date 10Jun11               *
003500200529      *                 AR740375           Date 02Apr11               *
003600200529      *                 CER059             Date 19Jul10               *
003700200529      *                 262205             Date 20Nov09               *
003800200529      *                 262064             Date 30Oct09               *
003900200529      *                 CER045             Date 20Jul09               *
004000200529      *                 BUG23640           Date 15May09               *
004100200529      *                 BUG24052           Date 20May09               *
004200200529      *                 CER054             Date 07Apr09               *
004300200529      *                 CER034A            Date 19May08               *
004400200529      * Bank Fusion Midas 1.4 Base -----------------------------------*
004500200529      * Midas Plus 1.4 Base 04 ---------------------------------------*
004600200529      *                 BUG14933           Date 02Oct07               *
004700200529      *                 CSW207             Date 09Jul07               *
004800200529      * Midas Plus 1.4 Base ------------------------------------------*
004900200529      *                 CSD079             Date 05Feb07               *
005000200529      * Midas Plus 1.3 ----------- Base ------------------------------*
005100200529      *                 240753             Date 06Jun06               *
005200200529      *                 CSD027A            Date 11May06               *
005300200529      *                 CSD027             Date 09Dec05               *
005400200529      *                 CER001             Date 25Apr05               *
005500200529      *                 CSD029             Date 22Aug05               *
005600200529      *                 236137             Date 21Sep05               *
005700200529      *                 235201             Date 02Aug05               *
005800200529      *                 232543             Date 01Apr05               *
005900200529      *                 CGL032             Date 05Jul04               *
006000200529      *                 CSD025A            Date 27Apr05               *
006100200529      *                 CSW037A            Date 02May05               *
006200200529      *                 BUG6198            Date 04Apr05               *
006300200529      *                 CSD025             Date 11Jan05               *
006400200529      *                 CSW037             Date 15Dec04               *
006500200529      *                 CSW036             Date 15Dec04               *
006600200529      *                 CFX001             Date 20Oct03               *
006700200529      *                 CLE025             Date 20Oct03               *
006800200529      *                 CGP001             Date 10Mar04               *
006900200529      *                 CGL018             Date 30Sep02               *
007000200529      * Midas Release 4.01 -------------------------------------------*
007100200529      *                 CSW024             Date 31Aug01               *
007200200529      * Midas Release 4 --------------- Base -------------------------*
007300200529      * Midas DBA 3.05 -----------------------------------------------*
007400200529      *                 CRE007             Date 01Mar01               *
007500200529      * Midas DBA 3.04 -----------------------------------------------*
007600200529      *                 CSD007             Date 28Aug00               *
007700200529      *                 CDL008             Date 02May00               *
007800200529      * Midas DBA 3.03 -----------------------------------------------*
007900200529      *                 151482             Date 12Jan99               *
008000200529      * Midas DBA 3.02 -----------------------------------------------*
008100200529      *                 168603             Date 07Jan00               *
008200200529      * Midas DBA 3.01 -----------------------------------------------*
008300200529      *                 CDL006             Date 26Apr99               *
008400200529      * Midas DBA 3.00 ---------------- Base -------------------------*
008500200529      *                 113339             Date 22Jul99               *
008600200529      *                 CEU014             Date 28Apr98               *
008700200529     F*                 099441             DATE 19AUG97               *
008800200529     F*                 CDL002             DATE 17MAR97               *
008900200529     F*                 S01408             DATE 17SEP96               *
009000200529     F*                 S01408             DATE 02SEP96               *
009100200529     F*                 S01408             DATE 29MAY96               *
009200200529     F*                 S01408             DATE 09FEB96               *
009300200529     F*                 S01408             DATE 06FEB96               *
009400200529     F*                 095938             DATE 17JAN96               *
009500200529     F*                 S01408             DATE 13DEC95               *
009600200529     F*                 S01408             DATE 07SEP95               *
009700200529     F*                 076824             DATE 07OCT94               *
009800200529     F*                 S01413             DATE 13APR93               *
009900200529     F*                 065369             DATE 07FEB94               *
010000200529     F*                 S01421             DATE 12JUL93               *
010100200529     F*                 S01383             DATE 12JUN92               *
010200200529     F*                 S01310             DATE 31MAY91               *
010300200529     F*                 LN1104             DATE 15FEB91               *
010400200529     F*                 S01267             DATE 17JAN91               *
010500200529     F*                 BHF950             DATE 14DEC90               *
010600200529     F*                 BHF399             DATE 15AUG90               *
010700200529     F*                 S01212             DATE 08AUG90               *
010800200529     F*                 BHF331             DATE 06AUG90               *
010900200529     F*                 LN0562             DATE 26JUL90               *
011000200529     F*                 LN0502             DATE 25JUL90               *
011100200529     F*                 LN0536             DATE 18JUL90               *
011200200529     F*                 LN0168             DATE 26JUN90               *
011300200529     F*                                                               *
011400200529     F*---------------------------------------------------------------*
011500200529     F*                                                               *
011501200618      *  248936B - Print Additional Info to match enquiry screen.     *
011502200618      *            Check if CGL031 is switched on.                    *
011503200618      *            Patterned after 251925.                            *
011600200529      *  248936A - Additional Details for Customer not printed.       *
011700200529      *           Applied fix 249980.                                 *
011800200529      *  249980 - Additional Customer Details not printed on SD0010PM.*
011900200529      *           Recompiled due to changes in SD0010PM.              *
012000200529      *  248936 - Fields introduced by CER001 should only be printed  *
012100200529      *           when switchable feature ULX004 is switched on.      *
012200200529      *  CER050 - Annualised Percentage Rate                          *
012300200529      *  MD050212 - Replication processing for SDCUSTXC (Recompile)   *
012400200529      *  CGL177 - CRS Reporting Phase 2                               *
012500200529      *  MD046248 - Finastra Rebranding                               *
012600200529      *  MD049187 - AnaCredit fields were introduced to printer file  *
012700200529      *             on record format with dependency                  *
012800200529      *  CER073C - CER073 Change Control 3 (Recompile)                *
012900200529      *  CER073A - CER073 Change Control 1                            *
013000200529      *  CER073 - AnaCredit Reporting                                 *
013100200529      *  CSW216 - SWIFT Changes 2016 (Recompile)                      *
013200200529      *  CER071 - BAIS - Legal Form field                             *
013300200529      *  LLN022A - BOE Upgrade to MidasPlus - incorporate code from   *
013400200529      *            /COPY members and add switchability.               *
013500200529      *  LLN022 - BOE Upgrade to MidasPlus.                           *
013600200529      *           Recompiled over changes in /COPY                    *
013700200529      *  CER070 - BuBa Reporting / BAIS V.1.16.0                      *
013800200529      *  CSW214 - SWIFT Changes 2014 (Recompile)                      *
013900200529      *  MD025682 - Correct SDCUSTPD trailer failure in COB.          *
014000200529      *  CGL132 - FATCA Phase 1 - Customers' Identification and       *
014100200529      *           Classification - Master                             *
014200200529      *  CSW213 - SWIFT Changes 2013                                  *
014300200529      *  CLE134 - Past Due Call Loan Processing (Recompile)           *
014400200529      *  AR740375 - State code value in report SD0010PM does not      *
014500200529      *             match the value in CUSD (Child: AR740376)         *
014600200529      *  CER059 - German Feature Upgrade to Delhi                     *
014700200529      *  262205 - Report SD0010PM contains a lot of useless pages.    *
014800200529      *           Do not print header when "Client Report request is  *
014900200529      *           Audit and Last Change Date is not equal to Rundate".*
015000200529      *  262064 - Overwriting of Market Centre and Investment Company *
015100200529      *           Identification. Add SPACEB(1) after Market Centre.  *
015200200529      *           Recompiled due to changes in SD0010PM printer file. *
015300200529      *  CER045 - German Features - Reporting Bundesbank              *
015400200529      *  BUG23640 - Labels were amended for clarity   (Recompile)     *
015500200529      *  BUG24052 - Religious Affiliation Narrative is incorrect for  *
015600200529      *             'NONE' code.                                      *
015700200529      *  CER054 - German Features - Church Tax                        *
015800200529      *  CER034A - LF046 German Features - New Fields and Enquiries   *
015900200529      *  BUG14933 - Error in checking switchable feature CSW207       *
016000200529      *  CSD079 - Enhanced Customer Maintenance API (Recompile)       *
016100200529      *  CSW207 - SWIFT 2007 Changes                                  *
016200200529      *  240753 - Recompiled due to changes in SD0010PM               *
016300200529      *  CSD027A - Conversion Of Customer Number to Alpha             *
016400200529      *  CSD027 - Conversion Of Customer Number to Alpha              *
016500200529      *  CER001 - LUX Upgrade to MidasPlus                            *
016600200529      *  CSD029 - Customer Details Additional Fields                  *
016700200529      *  236137 - Change Control for CGL031                           *
016800200529      *  235201 - Show only customers whose record was changed.       *
016900200529      *  232543 - Fix to CGL032                                       *
017000200529      *  CGL032 - Automatic Exchange of Information                   *
017100200529      *  CSD025A- Inactive status                                     *
017200200529      *  CSW037A- Additional Field extended to 40 chars               *
017300200529      *  BUG6198- Cannot save new Details for CUSD (Recompile)        *
017400200529      *  CSD025 - Customer De-Activation                              *
017500200529      *  CSW037 - Additional Field Data on MT300/MT320                *
017600200529      *  CSW036 - Dual SWIFT BIC held on Client Details               *
017700200529      *  CFX001 - FX Margin Trading                                   *
017800200529      *  CLE025 - Credit Lines                                        *
017900200529      *  CGP001 - Global Processing.                                  *
018000200529      *  CGL018 - Risk Weighted Assets                                *
018100200529      *  CSW024 - S.W.I.F.T. MT3xx Field 82/83/87.                    *
018200200529      *  CRE007 - Base Rate Tax 2001.                                 *
018300200529      *  CSD007 - Customer Closing: new Closure Status fields         *
018400200529      *  CDL008 - Continuous Linked Settlement                        *
018500200529      *  151482 - Use correct CHips ABA field BBABA2                  *
018600200529      *  168603 - For E5BRT1 should treat '000000' as *blanks.        *
018700200529      *  CDL006 - Dealing Fiduciary.                                  *
018800200529     F*  113339 - Date of birth could be before 01-01-72, thus add    *
018900200529     F*           field to retrieve full date.                        *
019000200529     F*  CEU014 - EMU User Defined Correspondence Changes:            *
019100200529     F*           addition of 'Designated In Currency' field.         *
019200200529     F*  099441 - Addition of 'SWIFT Financial Institution' flag.     *
019300200529     F*  CDL002 - FX Netting                                          *
019400200529     F*  S01408 - Hook SD0010PC25 added.                              *
019500200529     F*  S01408 - Hook SD0010PC24 added.                              *
019600200529     F*         - Hook SD0010PIP1 added.                              *
019700200529     F*  S01408 - Hook SD0010PC23 added.                              *
019800200529     F*           Hook SD0010PC22 added.                              *
019900200529     F*  S01408 - Hook SD0010PFP2 added.                              *
020000200529     F*           Hook SD0010PFP3 added.                              *
020100200529     F*           Hook SD0010PFP4 added.                              *
020200200529     F*           Hook SD0010PCP9 added.                              *
020300200529     F*           Hook SD0010PC10 added.                              *
020400200529     F*           Hook SD0010PC11 added.                              *
020500200529     F*           Hook SD0010PC12 added.                              *
020600200529     F*           Hook SD0010PC13 added.                              *
020700200529     F*           Hook SD0010PC14 added.                              *
020800200529     F*           Hook SD0010PC15 added.                              *
020900200529     F*           Hook SD0010PC16 added.                              *
021000200529     F*           Hook SD0010PC17 added.                              *
021100200529     F*           Hook SD0010PC18 added.                              *
021200200529     F*           Hook SD0010PC19 added.                              *
021300200529     F*           Hook SD0010PC20 added.                              *
021400200529     F*           Hook SD0010PC21 added.                              *
021500200529     F*  S01408 - Hook SD0010PCP7 added.                              *
021600200529     F*           Hook SD0010PCP8 added.                              *
021700200529     F*           Hook SD0010PFP1 added.                              *
021800200529     F*  095938 - Do not print additional details if cust. not changed*
021900200529     F*           today                                               *
022000200529     F*  S01408 - Hook SD0010PCP6 added.                              *
022100200529     F*  S01408 - Hook SD0010PCP1 added.                              *
022200200529     F*           Hook SD0010PCP2 added.                              *
022300200529     F*           Hook SD0010PCP3 added.                              *
022400200529     F*           Hook SD0010PCP4 added.                              *
022500200529     F*           Hook SD0010PCP5 added.                              *
022600200529     F*  076824 - IF THERE ONLY ADDITIONAL CUSTOMER DETAILS TO REPORT *
022700200529     F*           IN AUDIT MODE, DETAILS ARE PRECEDED BY A HEADED     *
022800200529     F*           PAGE WITH NO DETAILS.                               *
022900200529     F*           DO NOT PRINT 'NO DETAILS TO REPORT' AFTER PRINTING  *
023000200529     F*           ADDITIONAL DETAILS ONLY.                            *
023100200529     F*  S01413 - Retail 3 development.                               *
023200200529     F*  065369 - Recompiled for new fields (title) on printout.      *
023300200529     F*  S01421 - BLI STEP 1 DEVELOPMENT-                             *
023400200529     F*           Switchable features S01424 and S01425 are checked   *
023500200529     F*           for.If S01424 is present a new field is added to    *
023600200529     F*           Client Details Listing (XRCEAD) with text:'Customer *
023700200529     F*           Eligible for Automatic Deletion'.If S01425 is       *
023800200529     F*           present, then a new format is printed (ADCUDT)-     *
023900200529     F*           additional Customer Details.Details will be printed *
024000200529     F*           if a record is found.                               *
024100200529     F*  S01383 - Basic Rate Tax Incorporation. Print A/c Holder data.*
024200200529     F*  S01310 - SWIFT Rationalisation.                              *
024300200529     F*  LN1104 - Recompiled owing to change to SDCUSTPD.             *
024400200529     F*  S01267 - Customer Risk Weighting Code added.                 *
024500200529     F*  BHF950 - ENSURE THAT THE CALCULATED NO OF RECORDS IS ONLY    *
024600200529     F*           BASED ON THE LIVE CLIENTS ON THE FILE.              *
024700200529     F*  BHF399 - PASS SD0010AU TO SDC540P INSTEAD OF PROGRAM NAME.   *
024800200529     F*  S01212 - /COPY PROCESSING ADDED.                             *
024900200529     F*  BHF331 - REPORT LAYOUT REDESIGNED.                           *
025000200529     F*  LN0562 - ZEROS ARE NOW SUPPRESSED ON THE REPORT AND THE      *
025100200529     F*           DATES ARE DISPLAYED AS 7 CHARACTER ALPHANUMERICS.   *
025200200529     F*  LN0502 - RECOMPILE PROGRAM DUE TO CHANGE IN PRINTER FILE.    *
025300200529     F*  LN0536 - SET UP TITLE CORRECTLY.                             *
025400200529     F*  LN0168 - SET SCAN LIMIT TO 99999.                            *
025500200529     F*                                                               *
025600200529     F*****************************************************************
025700200529     F/COPY WNCPYSRC,SD0010PFPG
025800200529      *                                                                                      LLN022A
025900200529     FBYCUSTY0IF  E           K        DISK                                                  LLN022A
026000200529      *                                                                                      LLN022A
026100200529      ** Bank of England Customer details - retrieval                                        LLN022A
026200200529      *                                                                                      LLN022A
026300200529     FSDCUX2L0IF  E           K        DISK                                                   CER001
026400200529      * RTV: Customer Details Ext.  file for European Reporting - Luxemb.                     CER001
026500200529     FSDCUSTL1IF  E           K        DISK
026600200529     F*
026700200529      * RTV: Customer Details (SWIFT)                                                         CSW207
026800200529     FSDCSSWL1IF  E           K        DISK                                                   CSW207
026900200529     F*                                                                                       CSW207
027000200529      * RTV: Customer Details (Ext - C)                                                       CGL132
027100200529     FSDCUSXL1IF  E           K        DISK                                                   CGL132
027200200529      *                                                                                       CGL132
027300200529      * RTV: Midas SD CRS Customer Country Details                                            CGL177
027400200529     FSDCRSDL2IF  E           K        DISK                                                   CGL177
027500200529     FSDCRSDL0IF  E           K        DISK                                                   CGL177
027600200529     F            SDCRSDD0                          KRENAMESDCRSDD1                           CGL177
027700200529      *                                                                                       CGL177
027800200529     F/COPY WNCPYSRC,SD0010PFP2
027900200529     F*
028000200529      * RTV: Client Details            Retrieval index
028100200529      *
028200200529     FSDCBRTL1IF  E           K        DISK                               S01383
028300200529     FSDFCTLL1IF  E           K        DISK
028400200529      * RTV: Standing Data Controls    Retrieval index
028500200529      *
028600200529     F/COPY WNCPYSRC,SDH00577
028700200529     FSDBANKL1IF  E           K        DISK
028800200529      * RTV: Bank Details              Retrieval index
028900200529      *                                                                   S01421
029000200529     F/COPY WNCPYSRC,SD0010PF01
029100200529     FSDACUSL1IF  E           K        DISK                               S01421
029200200529      * Additional Cust Details        Retrieval index                    S01421
029300200529      *
029400200529     FSDANACI1IF  E           K        DISK                                                   CER073
029500200529      * AnaCredit Reporting            Retrieval index                                        CER073
029600200529      *
029700200529     F*
029800200529     F/COPY WNCPYSRC,SD0010PFP1
029900200529     F*
030000200529     FSDFCTLL0UF  E           K        DISK
030100200529      * UPD: Standing Data Controls    Update index
030200200529      *
030300200529     FSDCRWAL0IF  E           K        DISK                               CGL018
030400200529      * RTW: Customer Risk Weigted Assets Code/Set                        CGL018
030500200529      *                                                                   CGL018
030600200529     F*
030700200529     F/COPY WNCPYSRC,SD0010PFP3
030800200529     F*
030900200529     FSD0010PMO   E             97     PRINTER
031000200529     F                                              KINFDS INFDS$
031100200529      *                                                                                       CGL032
031200200529     FSDACTXL1IF  E           K        DISK                                                   CGL032
031300200529      ** RTV: Customer Details          Retrieval index                                       CGL032
031400200529     F*
031500200529     F/COPY WNCPYSRC,SD0010PFP4
031600200529     F*
031700200529      * PRT: Midas SD Client report
031800200529      *
031900200529     FGPCSTXL1IF  E           K        DISK                           UC                      CGP001
032000200529     F                                              KINFSR *PSSR                              CGP001
032100200529     F            GPCUSTXD0                         KRENAMEGPCSTXD0                           CGP001
032200200529      ** Midas GP Global Customers X-Reference                                                CGP001
032300200529      *                                                                                       CGP001
032400200529     E* Description     : Copyright notice for inclusion in all programs
032500200529     E*
032600200529     E********************************************************************
032700200529     E                    CPY@    1   1 80               Copyright     array
032800200529     E                    UAR        53  1
032900200529     E                    ULN        53  1
033000200529     E                    UARRAY  1   2 26
033100200529      *
033200200529      ** SAVE INDICATOR *IN 99
033300200529      *
033400200529     E/COPY WNCPYSRC,SD0010PEPG
033500200529     E                    BLC         5132                                                    CER001
033600200529      * IBLC 2002 Extended informations array                                                 CER001
033700200529     E********************@CN     1  14 25               Long constants.  CSD007
033800200529     E*****               @CN     1  17 25               Long constants.  CSD007CSD025A
033900200529     E                    @CN     1  18 25               Long constants.  CSD025A
034000200529     E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY 113339
034100200529     E                    TABM   12  12  3   TABD    2                                        262205
034200200529     E                    XRWA       90  5               Work Array       CGL018
034300200529     E                    OVRC    1   1 80                                                    CGP001
034400200529      ** Override Command Array                                                               CGP001
034500200529      *                                                                                       CGP001
034600200529     I*
034700200529     I* Description     : Copyright notice for inclusion in all programs
034800200529     I*
034900200529     I*00/Copy Member SD0010P   Initialise Program I-Spec
035000200529     I/COPY WNCPYSRC,SD0010PIPG
035100200529      *                                                                                      LLN022A
035200200529     I            DS                                                                         LLN022A
035300200529      *                                                                                      LLN022A
035400200529      ** BOE fields                                                                          LLN022A
035500200529      *                                                                                      LLN022A
035600200529     I                                        1 131 UFLD1                                    LLN022A
035700200529     I I            'SIO Ind:'                1   8 SIO                                      LLN022A
035800200529     I                                       10  10 ULSIOF                                   LLN022A
035900200529     I I            'H/A Ind:'               15  22 HAIN                                     LLN022A
036000200529     I                                       24  24 ULHAIN                                   LLN022A
036100200529     I I            'Ult Par:'               29  36 ULTP                                     LLN022A
036200200529     I                                       38  43 ULULPA                                   LLN022A
036300200529     I I            'Eg.Flag:'               48  55 EGFL                                     LLN022A
036400200529     I                                       57  57 ULEGFL                                   LLN022A
036500200529     I I            'BoE Inst. Code:'        61  75 LINC                                     LLN022A
036600200529     I                                       77  78 ULLINC                                   LLN022A
036700200529     I I            'BoE Ind. Code:'         81  94 LICD                                     LLN022A
036800200529     I                                       96  98 ULLICD                                   LLN022A
036900200529     I I            'Connected '            105 114 CNTP1                                    LLN022A
037000200529     I I            'Counterparty:'         115 127 CNTP2                                    LLN022A
037100200529     I                                      129 129 LCNTP                                    LLN022A
037200200529      *                                                                                      LLN022A
037300200529     IIBFROM      DS                                                                          CER001
037400200529      * Extended informations from IBLC 2002                                                  CER001
037500200529     I                                        1 132 IBFRO1                                    CER001
037600200529     I                                      133 264 IBFRO2                                    CER001
037700200529     I                                      265 396 IBFRO3                                    CER001
037800200529     I                                      397 528 IBFRO4                                    CER001
037900200529     I                                      529 660 IBFRO5                                    CER001
038000200529      /EJECT
038100200529      * Data structures:-
038200200529     IPGMDS     ESDSY2PGDSP
038300200529      * Program data structure.
038400200529     I/COPY WNCPYSRC,SD0010PI01
038500200529     IJBDTTM      DS
038600200529      * Job date/time.
038700200529     I                                        1   60##JDT
038800200529     I                                        1   20##JYY
038900200529     I                                        3   40##JMM
039000200529     I                                        5   60##JDD
039100200529     I                                        7  120##JTM
039200200529     I                                        7   80##JHH
039300200529     I                                        9  100##JNN
039400200529     I                                       11  120##JSS
039500200529     IINFDS$    E DSY2I$DSP
039600200529      * Printer file information data structure.
039700200529      *
039800200529     IRUNDAT      DS
039900200529     I                                        1   7 MRDT
040000200529     I                                        1   20MRDD                                      262205
040100200529     I                                        3   5 MRMM                                      262205
040200200529     I                                        6   70MRYY                                      262205
040300200529     I                                    P   8  100RDNB
040400200529     I                                       11  11 SUC
040500200529     I                                       12  12 DFF
040600200529     I                                       13  13 MBIN
040700200529      *                                                                                       262205
040800200529     IRNDATE      DS                                                                          262205
040900200529     I                                        1   60RNDT                                      262205
041000200529     I                                        1   20RNDY                                      262205
041100200529     I                                        3   40RNMN                                      262205
041200200529     I                                        5   60RNYY                                      262205
041300200529      *                                                                                       262205
041400200529     IA@CPY       DS
041500200529     I* Copyright array
041600200529     I                                        1  80 CPY@
041700200529      /EJECT
041800200529      * Parameter declarations.
041900200529     I/COPY WNCPYSRC,SD0010PI02
042000200529     IP1PARM      DS
042100200529      * I:    Audit/Request Status Ind
042200200529     I                                        1   1 P1ARSI
042300200529     IP2PARM      DS
042400200529      * I:    RCF sequence number
042500200529     I                                        1   5 P2RSQN
042600200529     IP3PARM      DS
042700200529      * I:    Level
042800200529     I                                        1   1 P3LEVL
042900200529     IP4PARM      DS
043000200529      * I:    Entity
043100200529     I                                        1   3 P4ENTY
043200200529     I            DS
043300200529     I                                        1 132 ZAMSDA
043400200529      * Message data for 'Database Error (ICD)'
043500200529      * Filename
043600200529     I                                        1  10 ZA0001
043700200529      *                                                                   S10408
043800200529     I/COPY WNCPYSRC,SD0010PIP1                                           S10408
043900200529      *                                                                   S10408
044000200529     ILDA       EUDSLDA                         256                       CDL006
044100200529      ** Local data area for database error details                       CDL006
044200200529      *                                                                   CDL006
044300200529     I                                      134 183 DBLOT                 CDL006
044400200529     I*                                                                   S01413
044500200529     ISCSARD    E DSSCSARDPD                                              CDL002
044600200529     I** MIDAS Switchable Features Accessed Via Access Program            CDL002
044700200529     I*                                                                   CDL002
044800200529     I** Data structure for SDMMOD access object                          S01413
044900200529     ISDMMOD    E DSSDMMODPD                                              S01413
045000200529      *                                                                                       CGL032
045100200529      ** External data structure for Bank details                                             CGL032
045200200529     ISDBANK    E DSSDBANKPD                                                                  CGL032
045300200529      *                                                                                       CGL032
045400200529      ** External data structure for Country Details                                          CGL032
045500200529     ISDCTRY    E DSSDCTRYPD                                                                  CGL032
045600200529      *                                                                                       CER054
045700200529      ** External data structure for Federal State Codes                                      CER054
045800200529     ISDSTCD    E DSSDGESTPD                                                                  CER054
045900200529      *                                                                                       CER054
046000200529      ** External data structure for Religious Affiliation Codes                              CER054
046100200529     ISDRLAF    E DSSDRLAFPD                                                                  CER054
046200200529     I*                                                                   S01413
046300200529     I** Short Data Structure for Access Objects                          S01413
046400200529     IDSFDY     E DSDSFDY                                                 S01413
046500200529     I            DS                                                      113339
046600200529     I                                        1   6 E5BRT1                113339
046700200529     I                                        1   2 WWBDAY                113339
046800200529     I                                        3   40WWBMNT                113339
046900200529     I                                        5   6 WWBYR                 113339
047000200529     I            DS                                                      113339
047100200529     I                                        1   2 WWBDY1                113339
047200200529     I                                        3   5 WWBMT1                113339
047300200529     I                                        6   7 WWBYR1                113339
047400200529     I                                        1   7 WWBRT1                113339
047500200529      * Datastructure to output RWA details                               CGL018
047600200529      *                                                                   CGL018
047700200529     IRWSECO      DS                          1   5                       CGL018
047800200529     I                                        1   2 #RCODE                CGL018
047900200529     I I            ' '                       3   3 #BLANK                CGL018
048000200529     I                                        4   4 #RSET                 CGL018
048100200529     I I            ','                       5   5 #COMMA                CGL018
048200200529      *                                                                   CGL018
048201200618     IWWBRTH      DS                                                                         248936B
048202200618      * Birth Date in DDMMMCCYY format                                                       248936B
048203200618     I                                        1   5 WWBRDM                                   248936B
048204200618     I                                        6   7 WWBRCC                                   248936B
048205200618     I                                        8   9 WWBRYY                                   248936B
048206200618     I*                                                                                      248936B
048207200618     IWWISDT      DS                                                                         248936B
048208200618      * Issue Date in DDMMMCCYY format                                                       248936B
048209200618     I                                        1   5 WWISDM                                   248936B
048210200618     I                                        6   7 WWISCC                                   248936B
048211200618     I                                        8   9 WWISYY                                   248936B
048212200618     I*                                                                                      248936B
048300200529     I              'AddCustDtlFl01'      C         @VAL01                                    CSD029
048400200529     I              'AddCustDtlFl02'      C         @VAL02                                    CSD029
048500200529     I              'AddCustDtlFl03'      C         @VAL03                                    CSD029
048600200529     I              'AddCustDtlFl04'      C         @VAL04                                    CSD029
048700200529     I              'AddCustDtlFl05'      C         @VAL05                                    CSD029
048800200529     I              'AddCustDtlFl06'      C         @VAL06                                    CSD029
048900200529     I              'AddCustDtlFl07'      C         @VAL07                                    CSD029
049000200529     I              'AddCustDtlFl08'      C         @VAL08                                    CSD029
049100200529     I              'AddCustDtlFl09'      C         @VAL09                                    CSD029
049200200529     I              'AddCustDtlFl10'      C         @VAL10                                    CSD029
049300200529     I/COPY WNCPYSRC,SDH00087
049400200529      *                                                                   CDL006
049500200529     IDSSDY     E DSDSSDY                                                 CDL006
049600200529      ** Second DS for access programs, long data structure               CDL006
049700200529      *                                                                   CDL006
049800200529      /EJECT
049900200529      *****************************************************************
050000200529     C           *ENTRY    PLIST                           Entry parameter
050100200529     C/COPY WNCPYSRC,SD0010PC37
050200200529     C                     PARM           P0RTN   7        Return code
050300200529     C/COPY WNCPYSRC,SD0010PC38
050400200529     C           P1ARSI    PARM           WP0001  1        Audit/Request S
050500200529     C           P2RSQN    PARM           WP0002  5        RCF sequence nu
050600200529     C           P3LEVL    PARM           WP0003  1        Level
050700200529     C           P4ENTY    PARM           WP0004  3        Entity
050800200529      *****************************************************************
050900200529      * Initialise
051000200529     C                     EXSR ZZINIT
051100200529      *                                                                                       CSW207
051200200529     C                     MOVE '0'       *IN88                                               CSW207
051300200529     C           CSW207    IFEQ 'Y'                                                           CSW207
051400200529     C           BGN4ST    OREQ 'Y'                                                           CSW207
051500200529     C                     MOVE '1'       *IN88                                               CSW207
051600200529     C                     ENDIF                                                              CSW207
051700200529      *                                                                                       CSW207
051800200529     C*                                                                   S01408
051900200529     C/COPY WNCPYSRC,SD0010PCP8                                           S01408
052000200529     C*                                                                   S01408
052100200529      *
052200200529      * Clear overflow indicator.
052300200529     C                     SETOF                     97
052400200529     C*
052500200529     C/COPY WNCPYSRC,SD0010PC19
052600200529     C*
052700200529      * Establish starting position.
052800200529     C           *LOVAL    SETLL@BBREBF                    *
052900200529     C*
053000200529     C/COPY WNCPYSRC,SD0010PCP9
053100200529     C*
053200200529      * Read first record with user selection.
053300200529     C                     EXSR GARDRC
053400200529     C*
053500200529     C/COPY WNCPYSRC,SD0010PC10
053600200529     C*
053700200529      * Print null report headings.
053800200529     C           W0EOF     IFEQ '1'
053900200529     C                     WRITEZZPAGHDR
054000200529      * USER: Null report processing
054100200529      *CASE:     WRK.S01212 is Fix installed
054200200529     C           WUMFTS    IFEQ @CN,01                     *IF
054300200529      * 00/Copy Member SD0010PNRP - Client Details  *
054400200529     C*00/Copy Member SD0010P   Null Report Processing
054500200529     C/COPY WNCPYSRC,SD0010PNRP
054600200529     C                     END                             *FI
054700200529     C                     WRITEZZENDRPT
054800200529     C*                                                                   S01421
054900200529     C                     ELSE
055000200529      * Request all headings.
055100200529     C                     MOVEL'Y'       L0      1        Page headings
055200200529      * Initialise final totals.
055300200529     C                     MOVEL*BLANK    ZTCON            *CON (Screen co
055400200529     C                     Z-ADD*ZERO     ZTNCRC           No of Calculate
055500200529      *                                                                                       262205
055600200529     C                     Z-ADD*ZERO     RNDT                                                262205
055700200529      *                                                                                       262205
055800200529     C           MRMM      LOKUPTABM      TABD           19                                   262205
055900200529     C                     MOVE TABD      RNMN                                                262205
056000200529     C                     Z-ADDMRDD      RNDY                                                262205
056100200529     C                     Z-ADDMRYY      RNYY                                                262205
056200200529      *                                                                                       262205
056300200529      * Print report body.
056400200529     C           W0EOF     DOWEQ'0'
056500200529      *                                                                                       262205
056600200529     C                     Z-ADD*ZERO     #NLCD                                               262205
056700200529      *                                                                                       262205
056800200529      *                                                                                       262205
056900200529     C                     CALL 'ZDATE2'                                                      262205
057000200529     C                     PARM           BBLCD                                               262205
057100200529     C                     PARM           BJDFIN                                              262205
057200200529     C                     PARM           #NLCD   60                                          262205
057300200529     C                     PARM           ZADATE                                              262205
057400200529      *                                                                                       262205
057500200529     C           WP0001    IFNE 'A'                                                           262205
057600200529     C           WP0001    OREQ 'A'                                                           262205
057700200529     C           #NLCD     ANDEQRNDT                                                          262205
057800200529      * Print headings.
057900200529     C                     EXSR BAPRHD
058000200529     C                     ENDIF                                                              262205
058100200529      * Print report detail line.
058200200529     C                     EXSR CAPRDT
058300200529     C*                                                                   S01421
058400200529     C* Sub Routine to write Additional Customer Details if feature       S01421
058500200529     C* S10425 is installed.                                              S01421
058600200529     C*                                                                   S01421
058700200529     C           *IN23     IFEQ *ON                                       S01421
058800200529     C           W0PFM     ANDEQ'Y'                                       095938
058900200529     C           CDL006    OREQ 'Y'                                       CDL006
059000200529     C           W0PFM     ANDEQ'Y'                                                           235201
059100200529     C                     EXSR ACDTSR                                    S01421
059200200529     C                     END                                            S01421
059300200529     C*                                                                   S01421
059400200529     C           CGL032    IFEQ 'Y'                                                           CGL032
059500200529     C           W0PFM     ANDEQ'Y'                                                           235201
059600200529     C                     EXSR SRETAX                                                        CGL032
059700200529     C                     ENDIF                                                              CGL032
059800200529      *                                                                                       CGL032
059900200529     C           CER073    IFEQ 'Y'                                                         MD049187
060000200529     C                     EXSR SRANAC                                                      MD049187
060100200529      *                                                                                     MD049187
060200200529      ** CHECK FOR OVErFlOW, PRINT HEADER IF SO.                                            MD049187
060300200529      *                                                                                     MD049187
060400200529     C           W0OFL     SUB  @$CLN     @$WRK                                             MD049187
060500200529     C           @$WRK     IFLE @$HDL                                                       MD049187
060600200529     C                     WRITEZZPAGHDR                                                    MD049187
060700200529     C                     ENDIF                                                            MD049187
060800200529     C                     WRITEZZANADTL                                                    MD049187
060900200529     C                     ENDIF                                                            MD049187
061000200529     C/COPY WNCPYSRC,SD0010PC34
061100200529      * Hold current values.
061200200529      * Read next record with user selection.
061300200529     C                     EXSR GARDRC
061400200529      * Determine level changes.
061500200529     C                     EXSR DALVCH
061600200529      * Print totals.
061700200529     C/COPY WNCPYSRC,SDH00088
061800200529     C                     EXSR EAPRTT
061900200529     C/COPY WNCPYSRC,SDH00089
062000200529      * Process necessary heading requests
062100200529     C                     EXSR FASGHD
062200200529     C*
062300200529     C/COPY WNCPYSRC,SD0010PC11
062400200529     C*
062500200529     C                     END
062600200529     C*
062700200529     C/COPY WNCPYSRC,SD0010PC12
062800200529     C*
062900200529     C                     WRITEZZENDRPT
063000200529     C                     END
063100200529      * Exit program.
063200200529     C                     MOVEL*BLANK    P0RTN
063300200529     C                     EXSR ZYEXPG
063400200529     C*
063500200529     C/COPY WNCPYSRC,SD0010PC13
063600200529     C*
063700200529      *****************************************************************
063800200529      /EJECT
063900200529     CSR         BAPRHD    BEGSR
064000200529      *================================================================
064100200529      * Print report Headers.
064200200529      *================================================================
064300200529     C           L0        IFEQ 'Y'
064400200529     C                     WRITEZZPAGHDR
064500200529     C                     END
064600200529      *
064700200529      *================================================================
064800200529     CSR         BAEXIT    ENDSR
064900200529      /EJECT                                                                                  CGL032
065000200529     CSR         SRETAX    BEGSR                                                              CGL032
065100200529      *================================================================                       CGL032
065200200529      * Print additional information of customer                                              CGL032
065300200529      *================================================================                       CGL032
065400200529      *                                                                                       CGL032
065500200529      ** Check if there are more additional information for the customer.                     CGL032
065600200529      *                                                                                       CGL032
065700200529     C           XRCUST    CHAINSDACUSL1             02                                       CGL032
065800200529      *                                                                                       CGL032
065900200529     C           *IN02     IFEQ *OFF                                                          CGL032
066000200529     C                     MOVE E5TINO    R2TINO                                              CGL032
066100200529     C                     MOVE E5IDTP    R2IDTP                                              CGL032
066200200529     C                     MOVE E5ISCT    R2ISCT                                              CGL032
066300200529     C                     MOVE E5BTHC    R2BTHC                                              CGL032
066400200529     C                     MOVE E5BTHT    R2BTHT                                              CGL032
066500200529     C                     MOVE E5JATP    R2JATP                                              CGL032
066600200529      *                                                                                       CGL032
066700200529      ** Alternative TINs                                                                     CGL132
066800200529     C                     MOVE E5TIN2    R2TIN2                                              CGL132
066900200529     C                     MOVE E5TNC2    R2TNC2                                              CGL132
067000200529     C                     MOVE E5TIN3    R2TIN3                                              CGL132
067100200529     C                     MOVE E5TNC3    R2TNC3                                              CGL132
067200200529     C                     MOVE E5TIN4    R2TIN4                                              CGL132
067300200529     C                     MOVE E5TNC4    R2TNC4                                              CGL132
067400200529     C                     MOVE E5TIN5    R2TIN5                                              CGL132
067500200529     C                     MOVE E5TNC5    R2TNC5                                              CGL132
067600200529      *                                                                                       CGL132
067700200529     C           CGL157    IFEQ 'N'                                                           CGL177
067800200529      *                                                                                       CGL177
067900200529     C                     MOVELBBCOLC    R2TNC1                                              CGL177
068000200529      *                                                                                       CGL177
068100200529      ** Additional TINs                                                                      CGL177
068200200529     C                     MOVE E5TIN6    R2TIN6                                              CGL177
068300200529     C                     MOVE E5TNC6    R2TNC6                                              CGL177
068400200529     C                     MOVE E5TIN7    R2TIN7                                              CGL177
068500200529     C                     MOVE E5TNC7    R2TNC7                                              CGL177
068600200529     C                     MOVE E5TIN8    R2TIN8                                              CGL177
068700200529     C                     MOVE E5TNC8    R2TNC8                                              CGL177
068800200529     C                     MOVE E5TIN9    R2TIN9                                              CGL177
068900200529     C                     MOVE E5TNC9    R2TNC9                                              CGL177
069000200529     C                     MOVE E5TIN0    R2TIN0                                              CGL177
069100200529     C                     MOVE E5TNC0    R2TNC0                                              CGL177
069200200529      *                                                                                       CGL177
069300200529     C                     ENDIF                                                              CGL177
069400200529      *                                                                                       CGL177
069500200529      ** Mailing Country and Phone No. Country                                                CGL177
069600200529     C                     MOVE E5CTR1    R2CTR1                                              CGL177
069700200529     C                     MOVE E5CTR2    R2CTR2                                              CGL177
069800200529     C                     MOVE E5CTR3    R2CTR3                                              CGL177
069900200529     C                     MOVE E5CTR4    R2CTR4                                              CGL157
070000200529     C                     MOVE E5CTR5    R2CTR5                                              CGL177
070100200529     C                     MOVE E5PHN1    R2PHN1                                              CGL177
070200200529     C                     MOVE E5PHN2    R2PHN2                                              CGL177
070300200529     C                     MOVE E5PHN3    R2PHN3                                              CGL177
070400200529     C                     MOVE E5PHN4    R2PHN4                                              CGL177
070500200529     C                     MOVE E5PHN5    R2PHN5                                              CGL177
070600200529      *                                                                                       CGL177
070700200529     C           CGL157    IFEQ 'Y'                                                           CGL177
070800200529      *                                                                                       CGL157
070900200529      ** Additional TINs when CRS is ON, initialize fields                                    CGL177
071000200529      *                                                                                       CGL177
071100200529     C                     Z-ADD*ZERO     CRSCTR  50                                          CGL177
071200200529      *                                                                                       CGL177
071300200529     C                     MOVE *BLANKS   R2TINO                                              CGL177
071400200529     C                     MOVE *BLANKS   R2TNC1                                              CGL177
071500200529     C                     MOVE *BLANKS   R2TIN2                                              CGL177
071600200529     C                     MOVE *BLANKS   R2TNC2                                              CGL177
071700200529     C                     MOVE *BLANKS   R2TIN3                                              CGL177
071800200529     C                     MOVE *BLANKS   R2TNC3                                              CGL177
071900200529     C                     MOVE *BLANKS   R2TIN4                                              CGL177
072000200529     C                     MOVE *BLANKS   R2TNC4                                              CGL177
072100200529     C                     MOVE *BLANKS   R2TIN5                                              CGL177
072200200529     C                     MOVE *BLANKS   R2TNC5                                              CGL177
072300200529     C                     MOVE *BLANKS   R2TIN6                                              CGL177
072400200529     C                     MOVE *BLANKS   R2TNC6                                              CGL177
072500200529     C                     MOVE *BLANKS   R2TIN7                                              CGL177
072600200529     C                     MOVE *BLANKS   R2TNC7                                              CGL177
072700200529     C                     MOVE *BLANKS   R2TIN8                                              CGL177
072800200529     C                     MOVE *BLANKS   R2TNC8                                              CGL177
072900200529     C                     MOVE *BLANKS   R2TIN9                                              CGL177
073000200529     C                     MOVE *BLANKS   R2TNC9                                              CGL177
073100200529     C                     MOVE *BLANKS   R2TIN0                                              CGL177
073200200529     C                     MOVE *BLANKS   R2TNC0                                              CGL177
073300200529      *                                                                                       CGL177
073400200529     C                     MOVE *BLANKS   KDCUST  6                                           CGL177
073500200529     C                     MOVE *BLANKS   KDCTRY  2                                           CGL177
073600200529     C                     MOVE BBCUST    KDCUST                                              CGL177
073700200529     C                     MOVE BBCOLC    KDCTRY                                              CGL177
073800200529     C           KCRSD     KLIST                                                              CGL177
073900200529     C                     KFLD           KDCUST                                              CGL177
074000200529     C                     KFLD           KDCTRY                                              CGL177
074100200529      *                                                                                       CGL177
074200200529     C           KCRSD     CHAINSDCRSDD1             02                                       CGL177
074300200529     C           *IN02     IFEQ *OFF                                                          CGL177
074400200529     C                     MOVE CDTINN    R2TINO                                              CGL177
074500200529     C                     MOVE CDCTRY    R2TNC1                                              CGL177
074600200529     C                     ENDIF                                                              CGL177
074700200529      *                                                                                       CGL177
074800200529      ** Read through CRS Customer Country Detail File - Detail                               CGL177
074900200529      *                                                                                       CGL177
075000200529     C           XRCUST    SETLLSDCRSDD0                                                      CGL177
075100200529     C           XRCUST    READESDCRSDD0                 03                                   CGL177
075200200529      *                                                                                       CGL177
075300200529     C           *IN03     DOWEQ*OFF                                                          CGL177
075400200529     C           CRSCTR    ANDLE9                                                             CGL177
075500200529     C           XRCUST    ANDEQCDCUST                                                        CGL177
075600200529      *                                                                                       CGL177
075700200529     C           BBCOLC    IFNE CDCTRY                                                        CGL177
075800200529     C                     ADD  1         CRSCTR                                              CGL177
075900200529      *                                                                                       CGL177
076000200529     C           CRSCTR    IFEQ 1                                                             CGL177
076100200529     C                     MOVE CDTINN    R2TIN2                                              CGL177
076200200529     C                     MOVE CDCTRY    R2TNC2                                              CGL177
076300200529     C                     ENDIF                                                              CGL177
076400200529     C           CRSCTR    IFEQ 2                                                             CGL177
076500200529     C                     MOVE CDTINN    R2TIN3                                              CGL177
076600200529     C                     MOVE CDCTRY    R2TNC3                                              CGL177
076700200529     C                     ENDIF                                                              CGL177
076800200529     C           CRSCTR    IFEQ 3                                                             CGL177
076900200529     C                     MOVE CDTINN    R2TIN4                                              CGL177
077000200529     C                     MOVE CDCTRY    R2TNC4                                              CGL177
077100200529     C                     ENDIF                                                              CGL177
077200200529     C           CRSCTR    IFEQ 4                                                             CGL177
077300200529     C                     MOVE CDTINN    R2TIN5                                              CGL177
077400200529     C                     MOVE CDCTRY    R2TNC5                                              CGL177
077500200529     C                     ENDIF                                                              CGL177
077600200529     C           CRSCTR    IFEQ 5                                                             CGL177
077700200529     C                     MOVE CDTINN    R2TIN6                                              CGL177
077800200529     C                     MOVE CDCTRY    R2TNC6                                              CGL177
077900200529     C                     ENDIF                                                              CGL177
078000200529     C           CRSCTR    IFEQ 6                                                             CGL177
078100200529     C                     MOVE CDTINN    R2TIN7                                              CGL177
078200200529     C                     MOVE CDCTRY    R2TNC7                                              CGL177
078300200529     C                     ENDIF                                                              CGL177
078400200529     C           CRSCTR    IFEQ 7                                                             CGL177
078500200529     C                     MOVE CDTINN    R2TIN8                                              CGL177
078600200529     C                     MOVE CDCTRY    R2TNC8                                              CGL177
078700200529     C                     ENDIF                                                              CGL177
078800200529     C           CRSCTR    IFEQ 8                                                             CGL177
078900200529     C                     MOVE CDTINN    R2TIN9                                              CGL177
079000200529     C                     MOVE CDCTRY    R2TNC9                                              CGL177
079100200529     C                     ENDIF                                                              CGL177
079200200529     C           CRSCTR    IFEQ 9                                                             CGL177
079300200529     C                     MOVE CDTINN    R2TIN0                                              CGL177
079400200529     C                     MOVE CDCTRY    R2TNC0                                              CGL177
079500200529     C                     ENDIF                                                              CGL177
079600200529      *                                                                                       CGL177
079700200529     C                     ENDIF                                                              CGL177
079800200529      *                                                                                       CGL177
079900200529     C           XRCUST    READESDCRSDD0                 03                                   CGL177
080000200529     C                     ENDDO                                                              CGL177
080100200529     C                     ENDIF                                                              CGL177
080200200529      *                                                                                       CGL177
080300200529     C**********           Z-ADDE5ISDT    ZDAYNO                                       CGL032 232543
080400200529     C           2         SUBSTE5ISDT:7  WDD     2                                           232543
080500200529     C           2         SUBSTE5ISDT:5  WMM     2                                           232543
080600200529     C           2         SUBSTE5ISDT:3  WYY     2                                           232543
080700200529     C           WDD       CAT  WMM       WDM     4                                           232543
080800200529     C           WDM       CAT  WYY       WDMY    6                                           232543
080900200529     C                     MOVE WDMY      DATEIN                                              232543
081000200529      *                                                                                       232543
081100200529     C                     CALL 'ZDATE1'                                                      232543
081200200529     C                     PARM           ZERR    7                                           232543
081300200529     C                     PARM           DATEIN  60                                          232543
081400200529     C                     PARM           BJDFIN                                              232543
081500200529     C                     PARM           ZDAYNO                                              232543
081600200529      *                                                                                       232543
081700200529     C           ZERR      IFNE *BLANKS                                                       232543
081800200529     C                     MOVE *BLANKS   R2ISDT                                              232543
081900200529     C                     ELSE                                                               232543
082000200529     C                     CALL 'ZDATE2'                                                      CGL032
082100200529     C                     PARM           ZDAYNO  50                                          CGL032
082200200529     C                     PARM           BJDFIN                                              CGL032
082300200529     C                     PARM           ZDATE   60                                          CGL032
082400200529     C                     PARM           ZADATE  7                                           CGL032
082500200529      *                                                                                       CGL032
082501200618     C**********           MOVE ZADATE    R2ISDT                                      CGL032 248936B
082502200618     C                     MOVE *BLANKS   R2ISDT                                             248936B
082503200618     C                     MOVELZADATE    WWISDT                                             248936B
082504200618     C                     MOVELWWISCC    WWISYY                                             248936B
082505200618     C           2         SUBSTE5ISDT:1  WWISCC                                             248936B
082506200618     C                     MOVE *BLANKS   R2ISDT                                             248936B
082507200618     C                     MOVELWWISDT    R2ISDT                                             248936B
082700200529     C                     ENDIF                                                              232543
082800200529      *                                                                                       232543
082900200529     C           CER047    IFEQ 'Y'                                                          CER034A
083000200529     C           CER048    OREQ 'Y'                                                          CER034A
083100200529      *                                                                                      CER034A
083200200529      ** Title                                                                               CER034A
083300200529      *                                                                                      CER034A
083400200529     C                     MOVE E5TITL    R2TITL                                             CER034A
083500200529      *                                                                                      CER034A
083600200529      ** Maiden Name                                                                         CER034A
083700200529      *                                                                                      CER034A
083800200529     C                     MOVE E5MDNM    R2MDNM                                             CER034A
083900200529      *                                                                                      CER034A
084000200529      ** Identification Document/Id                                                          CER034A
084100200529      *                                                                                      CER034A
084200200529     C                     MOVE E5DCID    R2DCID                                             CER034A
084300200529      *                                                                                      CER034A
084400200529      ** Identification Document/Id Issued Place                                             CER034A
084500200529      *                                                                                      CER034A
084600200529     C                     MOVE E5DIPL    R2DIPL                                             CER034A
084700200529      *                                                                                      CER034A
084800200529     C                     ENDIF                                                             CER034A
084900200529      *                                                                                      CER034A
085000200529     C           CER047    IFEQ 'Y'                                                          CER034A
085100200529      *                                                                                      CER034A
085200200529     C                     CALL 'ZDATE2'                                                     CER034A
085300200529     C                     PARM           ZDAYNO  50                                         CER034A
085400200529     C                     PARM           BJDFIN                                             CER034A
085500200529     C                     PARM           ZDATE   60                                         CER034A
085600200529     C                     PARM           ZADATE  7                                          CER034A
085700200529      *                                                                                      CER034A
085800200529      ** Expiry Date                                                                         CER034A
085900200529      *                                                                                      CER034A
086000200529     C           E5EXDT    IFEQ *ZEROS                                                       CER034A
086100200529     C                     MOVE *BLANKS   R2EXDT                                             CER034A
086200200529      *                                                                                      CER034A
086300200529     C                     ELSE                                                              CER034A
086400200529     C                     MOVE E5EXDT    ZDAYNO                                             CER034A
086500200529      *                                                                                      CER034A
086600200529     C                     CALL 'ZDATE2'                                                     CER034A
086700200529     C                     PARM           ZDAYNO  50                                         CER034A
086800200529     C                     PARM           BJDFIN                                             CER034A
086900200529     C                     PARM           ZDATE   60                                         CER034A
087000200529     C                     PARM           ZADATE  7                                          CER034A
087100200529      *                                                                                      CER034A
087200200529     C                     MOVE ZADATE    R2EXDT                                             CER034A
087300200529      *                                                                                      CER034A
087400200529     C                     ENDIF                                                             CER034A
087500200529      *                                                                                      CER034A
087600200529      ** Subject to 24C Flag                                                                 CER034A
087700200529      *                                                                                      CER034A
087800200529     C                     MOVE E5S24C    R2S24C                                             CER034A
087900200529      *                                                                                      CER034A
088000200529      ** Remarks                                                                             CER034A
088100200529      *                                                                                      CER034A
088200200529     C                     MOVE E5REM1    R2REM1                                             CER034A
088300200529     C                     MOVE E5REM2    R2REM2                                             CER034A
088400200529     C                     MOVE E5REM3    R2REM3                                             CER034A
088500200529      *                                                                                      CER034A
088600200529     C                     ENDIF                                                             CER034A
088700200529      *                                                                                       CER054
088800200529     C           CER054    IFEQ 'Y'                                                           CER054
088900200529      *                                                                                       CER054
089000200529      ** State Code                                                                           CER054
089100200529      *                                                                                       CER054
089200200529     C                     MOVEL*BLANKS   R2STCD                                            AR740375
089300200529     C                     MOVEL*BLANKS   R2STNM                                            AR740375
089400200529     C           E5STCD    IFNE *BLANKS                                                       CER054
089500200529      *                                                                                       CER054
089600200529     C                     CALL 'AOSTCDR0'                                                    CER054
089700200529     C                     PARM *BLANKS   PRTCD                                               CER054
089800200529     C                     PARM '*KEY    'POPTN                                               CER054
089900200529     C                     PARM E5STCD    PKEY    2                                           CER054
090000200529     C           SDSTCD    PARM SDSTCD    DSFDY                                               CER054
090100200529      *                                                                                       CER054
090200200529      ** DB Error Management.                                                                 CER054
090300200529      *                                                                                       CER054
090400200529     C           PRTCD     IFNE *BLANK                                                        CER054
090500200529      *                                                                                       CER054
090600200529     C           *LOCK     IN   LDA                                                           CER054
090700200529     C                     Z-ADD006       DBASE                                               CER054
090800200529     C                     MOVEL'SDSTCDPD'DBFILE                                              CER054
090900200529     C                     MOVELPOPTN     DBKEY                                               CER054
091000200529     C                     OUT  LDA                                                           CER054
091100200529     C                     EXSR *PSSR                                                         CER054
091200200529     C                     ELSE                                                               CER054
091300200529     C                     MOVE GESTCD    R2STCD                                              CER054
091400200529     C                     MOVE GESTNM    R2STNM                                              CER054
091500200529     C                     ENDIF                                                              CER054
091600200529      *                                                                                       CER054
091700200529     C                     ENDIF                                                              CER054
091800200529      *                                                                                       CER054
091900200529      ** Religious Affiliation Code                                                           CER054
092000200529      *                                                                                       CER054
092100200529     C********** E5RLAF    IFEQ 'NONE'                                               CER054 BUG24052
092200200529     C**********           MOVE E5RLAF    R2RLAF                                     CER054 BUG24052
092300200529     C**********           ENDIF                                                     CER054 BUG24052
092400200529      *                                                                                       CER054
092500200529     C                     MOVEL*BLANKS   R2RLAF                                            AR740375
092600200529     C                     MOVEL*BLANKS   R2NARR                                            AR740375
092700200529     C           E5RLAF    IFNE *BLANKS                                                       CER054
092800200529     C********** E5RLAF    ANDNE'NONE'                                               CER054 BUG24052
092900200529      *                                                                                       CER054
093000200529     C                     CALL 'AORLAFR0'                                                    CER054
093100200529     C                     PARM *BLANKS   PRTCD                                               CER054
093200200529     C                     PARM '*KEY    'POPTN                                               CER054
093300200529     C                     PARM E5RLAF    PKEY2   4                                           CER054
093400200529     C           SDRLAF    PARM SDRLAF    DSFDY                                               CER054
093500200529      *                                                                                       CER054
093600200529      ** DB Error Management.                                                                 CER054
093700200529      *                                                                                       CER054
093800200529     C           PRTCD     IFNE *BLANK                                                        CER054
093900200529     C           *LOCK     IN   LDA                                                           CER054
094000200529     C                     Z-ADD010       DBASE                                               CER054
094100200529     C                     MOVEL'SDRLAFPD'DBFILE                                              CER054
094200200529     C                     MOVELPOPTN     DBKEY                                               CER054
094300200529     C                     OUT  LDA                                                           CER054
094400200529     C                     EXSR *PSSR                                                         CER054
094500200529     C                     ELSE                                                               CER054
094600200529     C                     MOVE AFRLAF    R2RLAF                                              CER054
094700200529     C                     MOVE AFNARR    R2NARR                                              CER054
094800200529     C                     ENDIF                                                              CER054
094900200529      *                                                                                       CER054
095000200529     C                     ENDIF                                                              CER054
095100200529      *                                                                                       CER054
095200200529     C                     ENDIF                                                              CER054
095300200529      *                                                                                      CER034A
095400200529     C           CER048    IFEQ 'Y'                                                          CER034A
095500200529      *                                                                                      CER034A
095600200529      ** Spouse Reference                                                                    CER034A
095700200529      *                                                                                      CER034A
095800200529     C                     MOVE E5SHRF    R2SHRF                                             CER034A
095900200529      *                                                                                      CER034A
096000200529      ** Partner/Associate Indicator                                                         CER034A
096100200529      *                                                                                      CER034A
096200200529     C                     MOVE E5PIND    R2PIND                                             CER034A
096300200529      *                                                                                      CER034A
096400200529      ** Exemption Threshold                                                                 CER034A
096500200529      *                                                                                      CER034A
096600200529     C                     MOVE E5EXTH    R2EXTH                                             CER034A
096700200529      *                                                                                      CER034A
096800200529      ** Exemption Threshold Approval Date                                                   CER034A
096900200529      *                                                                                      CER034A
097000200529     C           E5EADT    IFEQ *ZEROS                                                       CER034A
097100200529     C                     MOVE *BLANKS   R2EADT                                             CER034A
097200200529      *                                                                                      CER034A
097300200529     C                     ELSE                                                              CER034A
097400200529     C                     MOVE E5EADT    ZDAYNO                                             CER034A
097500200529      *                                                                                      CER034A
097600200529     C                     CALL 'ZDATE2'                                                     CER034A
097700200529     C                     PARM           ZDAYNO  50                                         CER034A
097800200529     C                     PARM           BJDFIN                                             CER034A
097900200529     C                     PARM           ZDATE   60                                         CER034A
098000200529     C                     PARM           ZADATE  7                                          CER034A
098100200529      *                                                                                      CER034A
098200200529     C                     MOVE ZADATE    R2EADT                                             CER034A
098300200529      *                                                                                      CER034A
098400200529     C                     ENDIF                                                             CER034A
098500200529      *                                                                                      CER034A
098600200529      ** Exemption Threshold Value Date                                                      CER034A
098700200529      *                                                                                      CER034A
098800200529     C           E5EVDT    IFEQ *ZEROS                                                       CER034A
098900200529     C                     MOVE *BLANKS   R2EVDT                                             CER034A
099000200529      *                                                                                      CER034A
099100200529     C                     ELSE                                                              CER034A
099200200529     C                     MOVE E5EVDT    ZDAYNO                                             CER034A
099300200529      *                                                                                      CER034A
099400200529     C                     CALL 'ZDATE2'                                                     CER034A
099500200529     C                     PARM           ZDAYNO  50                                         CER034A
099600200529     C                     PARM           BJDFIN                                             CER034A
099700200529     C                     PARM           ZDATE   60                                         CER034A
099800200529     C                     PARM           ZADATE  7                                          CER034A
099900200529      *                                                                                      CER034A
100000200529     C                     MOVE ZADATE    R2EVDT                                             CER034A
100100200529      *                                                                                      CER034A
100200200529     C                     ENDIF                                                             CER034A
100300200529      *                                                                                      CER034A
100400200529      ** Exemption Threshold Expiry Date                                                     CER034A
100500200529      *                                                                                      CER034A
100600200529     C           E5ETXT    IFEQ *ZEROS                                                       CER034A
100700200529     C                     MOVE *BLANKS   R2ETXT                                             CER034A
100800200529      *                                                                                      CER034A
100900200529     C                     ELSE                                                              CER034A
101000200529     C                     MOVE E5ETXT    ZDAYNO                                             CER034A
101100200529      *                                                                                      CER034A
101200200529     C                     CALL 'ZDATE2'                                                     CER034A
101300200529     C                     PARM           ZDAYNO  50                                         CER034A
101400200529     C                     PARM           BJDFIN                                             CER034A
101500200529     C                     PARM           ZDATE   60                                         CER034A
101600200529     C                     PARM           ZADATE  7                                          CER034A
101700200529      *                                                                                      CER034A
101800200529     C                     MOVE ZADATE    R2ETXT                                             CER034A
101900200529      *                                                                                      CER034A
102000200529     C                     ENDIF                                                             CER034A
102100200529      *                                                                                      CER034A
102200200529      ** Characteristic of Demand/Claim                                                      CER034A
102300200529      *                                                                                      CER034A
102400200529     C                     MOVE E5CDCL    R2CDCL                                             CER034A
102500200529      *                                                                                      CER034A
102600200529     C                     ENDIF                                                             CER034A
102700200529      *                                                                                      CER034A
102800200529     C           CER034    IFEQ 'Y'                                                          CER034A
102900200529      *                                                                                      CER034A
103000200529      ** FX Customer                                                                         CER034A
103100200529      *                                                                                      CER034A
103200200529     C                     MOVE E5FXCU    R2FXCU                                             CER034A
103300200529      *                                                                                      CER034A
103400200529      ** Securities Customer                                                                 CER034A
103500200529      *                                                                                      CER034A
103600200529     C                     MOVE E5SECU    R2SECU                                             CER034A
103700200529      *                                                                                      CER034A
103800200529      ** Staff Member                                                                        CER034A
103900200529      *                                                                                      CER034A
104000200529     C                     MOVE E5SMBR    R2SMBR                                             CER034A
104100200529      *                                                                                      CER034A
104200200529     C                     ENDIF                                                             CER034A
104300200529      *                                                                                      CER034A
104400200529     C           CER038    IFEQ 'Y'                                                          CER034A
104500200529      *                                                                                      CER034A
104600200529      ** Language ID                                                                         CER034A
104700200529      *                                                                                      CER034A
104800200529     C                     MOVE E5LNID    R2LNID                                             CER034A
104900200529      *                                                                                      CER034A
105000200529      ** Correspondent Type                                                                  CER034A
105100200529      *                                                                                      CER034A
105200200529     C                     MOVE E5CTYP    R2CTYP                                             CER034A
105300200529      *                                                                                      CER034A
105400200529     C                     ENDIF                                                             CER034A
105500200529      *                                                                                      CER034A
105600200529     C           CER041    IFEQ 'Y'                                                          CER034A
105700200529      *                                                                                      CER034A
105800200529      ** Zero Confirmation Flag                                                              CER034A
105900200529      *                                                                                      CER034A
106000200529     C                     MOVE E5ZCFG    R2ZCFG                                             CER034A
106100200529      *                                                                                      CER034A
106200200529     C                     ENDIF                                                             CER034A
106300200529      *                                                                                      CER034A
106400200529     C           CER045    IFEQ 'Y'                                                           CER045
106500200529      *                                                                                       CER045
106600200529      ** Borrower Sector Classification Code                                                  CER045
106700200529      ** Economic Activity Code                                                               CER045
106800200529      ** Borrower Sector Classification/BISTA                                                 CER045
106900200529      ** Additional Borrowers Statistics Key                                                  CER045
107000200529      ** Customer Required for Bundesbank Reporting                                           CER045
107100200529      ** Risk Classification Code                                                             CER070
107200200529      ** Legal Form                                                                           CER071
107300200529      *                                                                                       CER045
107400200529     C                     MOVE E5BSCC    R2BSCC                                              CER045
107500200529     C                     MOVE E5ECAC    R2ECAC                                              CER045
107600200529     C                     MOVE E5BIST    R2BIST                                              CER045
107700200529     C                     MOVE E5ABSK    R2ABSK                                              CER045
107800200529     C                     MOVE E5BEXT    R2BEXT                                              CER045
107900200529     C                     MOVE E5RIGR    R2RIGR                                              CER070
108000200529     C                     MOVE E5RECH    R2RECH                                              CER071
108100200529      *                                                                                       CER045
108200200529     C                     ENDIF                                                              CER045
108300200529      *                                                                                       CER045
108400200529     C           @$OFL     SUB  @$CLN     WREM    20                                         CER034A
108500200529     C********** WREM      IFGE 28                                                    CER034A CER071
108600200529     C           WREM      IFGE 29                                                            CER071
108700200529     C                     WRITEREUTX1                                                        CGL032
108800200529     C                     ELSE                                                              CER034A
108900200529     C                     WRITEZZPAGHDR                                                     CER034A
109000200529     C                     WRITEREUTX1                                                       CER034A
109100200529     C                     END                                                               CER034A
109200200529      *                                                                                       CGL032
109300200529      ** If the Joint Account Type is 'I' or 'Y', print additional info.                      CGL032
109400200529      *                                                                                       CGL032
109500200529     C           E5JATP    IFEQ 'I'                                                           CGL032
109600200529     C           E5JATP    OREQ 'Y'                                                           CGL032
109700200529      *                                                                                       CGL032
109800200529      ** Establish starting position.                                                         CGL032
109900200529      *                                                                                       CGL032
110000200529     C           *LOVAL    SETLLSDACTXD0                                                      CGL032
110100200529     C                     READ SDACTXD0                 01                                   CGL032
110200200529      *                                                                                       CGL032
110300200529     C           *IN01     DOWEQ*OFF                                                          CGL032
110400200529     C           XRCUST    IFEQ AXCUST                                                        CGL032
110500200529     C                     MOVE AXCTTX    R3CTTX                                              CGL032
110600200529     C                     MOVE AXETXS    R3ETXS                                              CGL032
110700200529     C                     MOVE AXCERF    R3CERF                                              CGL032
110800200529      *                                                                                       CGL032
110900200529     C                     Z-ADDAXCEEX    ZDAYNO                                              CGL032
111000200529     C                     CALL 'ZDATE2'                                                      CGL032
111100200529     C                     PARM           ZDAYNO  50                                          CGL032
111200200529     C                     PARM           BJDFIN                                              CGL032
111300200529     C                     PARM           ZDATE   60                                          CGL032
111400200529     C                     PARM           ZADATE  7                                           CGL032
111500200529      *                                                                                       CGL032
111600200529     C                     MOVE ZADATE    R3CEEX                                              CGL032
111700200529      *                                                                                       CGL032
111800200529     C                     CALL 'AOCTRYR0'                                                    CGL032
111900200529     C                     PARM *BLANKS   PRTCD                                               CGL032
112000200529     C                     PARM '*KEY    'POPTN                                               CGL032
112100200529     C                     PARM AXCTTX    PKEY    2                                           CGL032
112200200529     C           SDCTRY    PARM SDCTRY    DSFDY                                               CGL032
112300200529      *                                                                                       CGL032
112400200529      ** DB Error Management.                                                                 CGL032
112500200529      *                                                                                       CGL032
112600200529     C           PRTCD     IFNE *BLANK                                                        CGL032
112700200529     C           *LOCK     IN   LDA                                                           CGL032
112800200529     C                     Z-ADD007       DBASE            ************                       CGL032
112900200529     C                     MOVEL'SDCTRYPD'DBFILE           * DBERR  07*                       CGL032
113000200529     C                     MOVELPOPTN     DBKEY            ************                       CGL032
113100200529     C                     OUT  LDA                                                           CGL032
113200200529     C                     EXSR *PSSR                                                         CGL032
113300200529     C                     ENDIF                                                              CGL032
113400200529      *                                                                                       CGL032
113500200529     C                     MOVE A4CNNM    R3CNNM                                              CGL032
113600200529     C                     MOVE AXCSTS    R3CSTS                                              236137
113700200529      *                                                                                       CGL032
113800200529      ** Check for overflow, print header if so.                                              CGL032
113900200529      *                                                                                       CGL032
114000200529     C           W0OFL     SUB  @$CLN     @$WRK                                               CGL032
114100200529     C           @$WRK     IFLE @$HDL                                                         CGL032
114200200529     C                     WRITEZZPAGHDR                                                      CGL032
114300200529     C                     ENDIF                                                              CGL032
114400200529      *                                                                                       CGL032
114500200529     C                     WRITEREUTX2                                                        CGL032
114600200529     C                     ENDIF                                                              CGL032
114700200529      *                                                                                       CGL032
114800200529     C                     READ SDACTXD0                 01                                   CGL032
114900200529     C                     ENDDO                                                              CGL032
115000200529      *                                                                                       CGL032
115100200529     C                     ENDIF                                                              CGL032
115200200529      *                                                                                       CGL032
115300200529     C                     ENDIF                                                              CGL032
115400200529      *================================================================                       CGL032
115500200529     CSR                   ENDSR                                                              CGL032
115600200529      /EJECT
115700200529     CSR         CAPRDT    BEGSR
115800200529      *================================================================
115900200529      * Print report detail line.
116000200529      *================================================================
116100200529      * Load detail line.
116200200529      *                                                                   S01383
116300200529      ***  Remove fields that serve no purpose (and dummy definitions     S01383
116400200529      ***  in the print file). But, must define ones that are used.       S01383
116500200529      *                                                                   S01383
116600200529     C***********          Z-ADDBBLCD     XRLCD            Last Change DatS01383
116700200529     C***********          Z-ADD*ZERO     XRCLCD           CD Laste changeS01383
116800200529     C***********          MOVELBBTYLC    XRTYLC           Type of Last ChS01383
116900200529     C***********          MOVELBBDRCS    XRDRCS           DRS Customer ShS01383
117000200529     C***********          MOVELBBLCCD    XRLCCD           Location Code  S01383
117100200529     C***********          Z-ADD*ZERO     XRCDFC           CD date of firsS01383
117200200529     C***********          Z-ADDBBSSDT    XRSSDT           Suspended Date S01383
117300200529     C***********          Z-ADDBBLRLD    XRLRLD           Last Retail LetS01383
117400200529     C***********          Z-ADDBBLALD    XRLALD           Last Audit LettS01383
117500200529     C***********          Z-ADDBBLDHD    XRLDHD           Last Dels HistoS01383
117600200529     C***********          Z-ADDBBDTDL    XRDTDL           Date Deleted   S01383
117700200529     C***********          MOVELBBSTFG    XRSTFG           SWIFT or Telex S01383
117800200529     C***********          MOVELBBLETI    XRLETI           LE Past/Int TelS01383
117900200529     C***********          MOVELBBCMTI    XRCMTI           Customer ModuleS01383
118000200529     C***********          MOVELBBGSFM    XRGSFM           Generate SWIFT S01383
118100200529     C***********          Z-ADDBBDOIC    XRDOIC           Date of InitialS01383
118200200529      *                                                                   S01383
118300200529     C/COPY WNCPYSRC,SD0010PC28
118400200529      *                                                                                       CSW207
118500200529      ** Get Customer Details Swift Extension                                                 CSW207
118600200529      *                                                                                       CSW207
118700200529     C           CSW207    IFEQ 'Y'                                                           CSW207
118800200529     C           BGN4ST    OREQ 'Y'                                                           CSW207
118900200529     C           BBCUST    CHAINSDCSSWL1             02                                       CSW207
119000200529     C           *IN02     IFEQ *OFF                                                          CSW207
119100200529     C                     MOVELCSCICI    XRCICI           Investor Capacity                  CSW207
119200200529     C                     MOVELCSCPCI    XRCPCI           Party Capacity                     CSW207
119300200529     C                     ENDIF                                                              CSW207
119400200529     C                     ENDIF                                                              CSW207
119500200529     C                     MOVELCSIBEI    XRIBEI           IBEI Code                          CSW207
119600200529      *                                                                                       CSW207
119700200529     C           BBCUST    CHAINSDCUSXL1             02                                       CGL132
119800200529     C           *IN02     IFEQ *OFF                                                          CGL132
119900200529     C                     MOVELXCACCZ    XRACCZ           Alt Ctry of Citi                   CGL132
120000200529     C           XCCRDT    IFEQ 0                                                             CGL132
120100200529     C                     MOVE *BLANK    XRCRDT           Creation Date                      CGL132
120200200529     C                     ELSE                                                               CGL132
120300200529     C                     MOVE XCCRDT    XRCRDT           Creation Date                      CGL132
120400200529     C                     ENDIF                                                              CGL132
120500200529     C                     ENDIF                                                              CGL132
120600200529     C                     MOVE XCLCUS    XRLCUS           Username                           CGL132
120700200529     C                     MOVE XCDRMT    XRDRMT           Dormant Indicat                    CGL132
120800200529      *                                                                                       CGL132
120900200529     C                     Z-ADDBBLCD     XRLCD   50                      S01383
121000200529     C                     Z-ADD*ZERO     XRCLCD  60                      S01383
121100200529     C                     MOVELBBTYLC    XRTYLC  1                       S01383
121200200529      *                                                                   S01383
121300200529     C                     MOVELBBCUST    XRCUST           Customer Number
121400200529     C                     MOVELBBCNA1    XRCNA1           Cust. Name & Ad
121500200529     C                     MOVELBBCRNM    XRCRNM           Customer Report
121600200529     C                     MOVELBBPAIN    XRPAIN           Parent Indicato
121700200529     C                     MOVEL*BLANK    XRACDT           alpha change da
121800200529     C                     MOVEL*BLANK    XRALCH           alpha of last c
121900200529     C                     MOVELBBCSSN    XRCSSN           Customer Shortn
122000200529     C                     MOVELBBCNA2    XRCNA2           Cust. Name & Ad
122100200529     C                     MOVELBBCRTN    XRCRTN           Customer Report
122200200529     C                     MOVELBBPCNB    XRPCNB           Parent Customer
122300200529     C                     MOVELBBCNA3    XRCNA3           Cust. Name & Ad
122400200529     C                     MOVELBBBRCD    XRBRCD           Branch code
122500200529     C                     MOVEL*BLANK    XRCSTA           Customer Status
122600200529     C                     MOVELBBCNA4    XRCNA4           Cust. Name & Ad
122700200529     C                     Z-ADDBBDTDL    XRDTDL  50       Date Deleted                     MD025682
122800200529     C           CSW207    IFEQ 'Y'                                                           CSW207
122900200529     C           BGN4ST    OREQ 'Y'                                                           CSW207
123000200529     C                     MOVELCSCICI    XRCICI           Investor Capacity                  CSW207
123100200529     C                     MOVELCSCPCI    XRCPCI           Party Capacity                     CSW207
123200200529     C                     ENDIF                                                              CSW207
123300200529     C                     MOVELCSIBEI    XRIBEI           IBEI Code                          CSW207
123400200529     C                     MOVELBBBSIN    XRBSIN           Branch/Subsidia
123500200529     C                     MOVELBBBNBI    XRBNBI           Bank/non-bank I
123600200529     C                     MOVELBBCTNB    XRCTNB           Customer Teleph
123700200529     C                     MOVELBBCNCZ    XRCNCZ           Country of Citi
123800200529     C                     MOVELBBLICD    XRLICD           Local Industry
123900200529     C                     MOVELBBCOLC    XRCOLC           Country of Loca
124000200529     C/COPY WNCPYSRC,SD0010PC08
124100200529     C                     MOVELBBLINC    XRLINC           Local Instituti
124200200529     C/COPY WNCPYSRC,SD0010PC09
124300200529     C                     MOVELBBTXA1    XRTXA1           MIDAS Telex Sho
124400200529     C                     MOVELBBACOC    XRACOC           Account Officer
124500200529     C                     MOVELBBCSTY    XRCSTY           Customer Type
124600200529     C                     MOVELBBTXA2    XRTXA2           Telex Address 2
124700200529     C                     MOVELBBRWCD    XRRWCD           Risk Weighting
124800200529     C                     MOVELBBSWFI    XRSWFI           SWIFT Fin Inst 099441
124900200529     C                     MOVELBBTAIN    XRTAIN           Taxable Indicat
125000200529     C                     MOVELBBTXA3    XRTXA3           Telex Address 3
125100200529     C                     MOVELBBTXA4    XRTXA4           Telex Address 4
125200200529     C                     MOVELBBTXA5    XRTXA5           Telex Address 5
125300200529     C                     MOVEL*BLANK    XRRFCD           Report First Co
125400200529     C                     MOVELBBREID    XRREID           Reuter Id.
125500200529     C                     MOVELBBCSID    XRCSID           Customer Swift
125600200529     C                     MOVEL*BLANK    XRRSUD           Report Suspende
125700200529     C/COPY WNCPYSRC,SD0010PC26
125800200529     C                     MOVELBBCASC    XRCASC           Customer Alpha
125900200529     C/COPY WNCPYSRC,SD0010PC27
126000200529     C                     MOVELBBSTAD    XRSTAD           STTX Address
126100200529     C                     MOVEL*BLANK    XRRDTD           Report Date Del
126200200529     C                     Z-ADDBBCHSC    XRCHSC           Chaps sort code
126300200529     C                     MOVEL*BLANK    XRRRLD           Report Retail L
126400200529     C                     MOVELBBBFIC    XRBFIC           BOJ Fin. Inst.
126500200529      *                                                                                       CSW213
126600200529     C           CSW213    IFEQ 'Y'                                                           CSW213
126700200529     C                     MOVELCSLEIC    XRLEIC                                              CSW213
126800200529     C                     MOVELCSCLSY    XRCLSY                                              CSW213
126900200529     C                     MOVELCSCLID    XRCLID                                              CSW213
127000200529     C                     ENDIF                                                              CSW213
127100200529      *                                                                                       CSW213
127200200529     C           CFT050    IFEQ 'Y'                                                           CSW213
127300200529     C                     MOVELCSBDRK    XRBDRK                                              CSW213
127400200529     C                     ENDIF                                                              CSW213
127500200529      *                                                                                       CSW213
127600200529     C**********           Z-ADDBBCABA    XRCABA           Chips ABA      151482
127700200529     C                     Z-ADDBBABA2    XRCABA           Chips ABA      151482
127800200529     C                     MOVEL*BLANK    XRRALD           Report Audit Le
127900200529     C                     Z-ADDBBFWCD    XRFWCD           Fedwire Code
128000200529     C                     Z-ADDBBCHID    XRCHID           Chips Id
128100200529     C                     MOVEL*BLANK    XRRDHD           Report Dels His
128200200529     C                     MOVELBBBLCD    XRBLCD           Bankleitzahl Co
128300200529     C                     MOVELBBNG01    XRNG01           Message Type No
128400200529     C                     MOVELBBNG02    XRNG02           Message Type No
128500200529     C                     MOVELBBNG03    XRNG03           Message Type No
128600200529     C                     MOVELBBNG04    XRNG04           Message Type No
128700200529     C                     MOVELBBNG05    XRNG05           Message Type No
128800200529     C                     MOVELBBNG06    XRNG06           Message Type No
128900200529     C                     MOVELBBNG07    XRNG07           Message Type No
129000200529     C                     MOVELBBNG08    XRNG08           Message Type No
129100200529     C                     MOVELBBNG09    XRNG09           Message Type No
129200200529     C                     MOVELBBNG10    XRNG10           Message Type No
129300200529     C                     MOVELBBNG11    XRNG11           Message Type No
129400200529     C                     MOVELBBNG12    XRNG12           Message Type No
129500200529     C                     MOVELBBNG13    XRNG13           Message Type No
129600200529     C                     MOVELBBNG14    XRNG14           Message Type No
129700200529     C                     MOVELBBNG15    XRNG15           Message Type No
129800200529     C                     MOVELBBDS01    XRDS01           Default Status
129900200529     C                     MOVELBBDS02    XRDS02           Default Status
130000200529     C                     MOVELBBDS03    XRDS03           Default Status
130100200529     C                     MOVELBBDS04    XRDS04           Default Status
130200200529     C                     MOVELBBDS05    XRDS05           Default Status
130300200529     C                     MOVELBBDS06    XRDS06           Default Status
130400200529     C                     MOVELBBDS07    XRDS07           Default Status
130500200529     C                     MOVELBBDS08    XRDS08           Default Status
130600200529     C                     MOVELBBDS09    XRDS09           Default Status
130700200529     C                     MOVELBBDS10    XRDS10           Default Status
130800200529     C                     MOVELBBDS11    XRDS11           Default Status
130900200529     C                     MOVELBBDS12    XRDS12           Default Status
131000200529     C                     MOVELBBDS13    XRDS13           Default Status
131100200529     C                     MOVELBBDS14    XRDS14           Default Status
131200200529     C                     MOVELBBDS15    XRDS15           Default Status
131300200529     C                     MOVELBBDNW1    XRDNW1           Default Network
131400200529     C                     MOVELBBDNW2    XRDNW2           Default Network
131500200529     C                     MOVELBBDNW3    XRDNW3           Default Network
131600200529     C                     MOVELBBDNW4    XRDNW4           Default Network
131700200529     C                     MOVELBBDNW5    XRDNW5           Default Network
131800200529     C                     MOVELBBDNW6    XRDNW6           Default Network
131900200529     C                     MOVELBBDNW7    XRDNW7           Default Network
132000200529     C                     MOVELBBDNW8    XRDNW8           Default Network
132100200529     C                     MOVELBBDNW9    XRDNW9           Default Network
132200200529     C                     MOVEL*BLANK    XRWNFF           Window Function
132300200529     C                     MOVELBBDINC    XRDINC           Designtd In CcyCEU014
132400200529      *                                                                                       CGP001
132500200529      ** Move the Global Processing fields to screen                                          CGP001
132600200529      ** if CGP001 is enabled.                                                                CGP001
132700200529      *                                                                                       CGP001
132800200529     C           CGP001    IFEQ 'Y'                                                           CGP001
132900200529     C                     EXSR SRGPCU                                                        CGP001
133000200529     C                     ENDIF                                                              CGP001
133100200529      *                                                                                       CGP001
133200200529      *                                                                                       CSD025
133300200529      ** Move De-Activated flag in position                                                   CSD025
133400200529      ** if CSD025 is enabled.                                                                CSD025
133500200529      *                                                                                       CSD025
133600200529     C           CSD025    IFEQ 'Y'                                                           CSD025
133700200529      *                                                                                       CSD025
133800200529     C                     MOVE BBDEAC    XRDEAC                                              CSD025
133900200529     C                     MOVE *BLANKS   XRDEDT                                              CSD025
134000200529      *                                                                                       CSD025
134100200529     C           BBDEDT    IFNE 0                                                             CSD025
134200200529      * Check File Date - Rundate  *                                                          CSD025
134300200529     C                     CALL 'ZDATE2'               90  Check File Date                    CSD025
134400200529     C                     PARM BBDEDT    WQ0001  50       Work Midas Date                    CSD025
134500200529     C                     PARM WUDFF     WQ0002  1        Date format fla                    CSD025
134600200529     C                     PARM *ZERO     WQ0003  60       Work Converted                     CSD025
134700200529     C                     PARM *BLANK    WQ0004  7        Work Alpha Date                    CSD025
134800200529      *                                                                                       CSD025
134900200529     C                     MOVE WQ0003    XRDEDT                                              CSD025
135000200529      *                                                                                       CSD025
135100200529     C           *IN90     IFEQ '1'                                                           CSD025
135200200529      * Call to program ended in error.                                                       CSD025
135300200529     C                     MOVEL'Y2U0021' W0RTN   7                                           CSD025
135400200529     C                     ENDIF                                                              CSD025
135500200529     C                     ENDIF                                                              CSD025
135600200529      *                                                                                       CSD025
135700200529     C                     ENDIF                                                              CSD025
135800200529      *                                                                                       CSD025
135900200529      ** Move Fund Account Number into position                           CSW037A
136000200529      ** if CSW037 is enabled.                                            CSW037A
136100200529      *                                                                   CSW037A
136200200529     C           CSW037    IFEQ 'Y'                                       CSW037A
136300200529     C                     MOVE BBFNAC    XRFNAC                          CSW037A
136400200529     C                     ENDIF                                          CSW037A
136500200529      *                                                                   CSW037A
136600200529     C           CSW024    IFEQ 'Y'                                                           CSW024
136700200529     C                     MOVELBBCORP    XRCORP                                              CSW024
136800200529     C                     MOVELBBCBEI    XRCBEI                                              CSW024
136900200529     C                     MOVELBBFUND    XRFUND                                              CSW024
137000200529     C                     MOVELBBRI01    XRRI01                                              CSW024
137100200529     C                     MOVELBBRI02    XRRI02                                              CSW024
137200200529     C                     MOVELBBRI03    XRRI03                                              CSW024
137300200529     C                     MOVELBBRI04    XRRI04                                              CSW024
137400200529     C                     MOVELBBRI05    XRRI05                                              CSW024
137500200529     C                     ENDIF                                                              CSW024
137600200529     C/COPY WNCPYSRC,SDH00578
137700200529      *                                                                                       CLE025
137800200529     C           CLE025    IFEQ 'Y'                                                           CLE025
137900200529     C           CFX001    OREQ 'Y'                                                           CFX001
138000200529     C                     MOVE BBFCMF    XRFCMF                                              CLE025
138100200529     C                     MOVE BBINOF    XRINOF                                              CLE025
138200200529     C                     MOVE BBMSTF    XRMSTF                                              CLE025
138300200529     C                     MOVE BBIOPC    XRIOPC                                              CLE025
138400200529     C                     ENDIF                                                              CLE025
138500200529     C*                                                                   S01408
138600200529     C/COPY WNCPYSRC,SD0010PC24                                           S01408
138700200529     C*                                                                   S01408
138800200529     C                     MOVEL*BLANK    XRWNF1           Window Function
138900200529     C                     MOVEL*BLANK    XRWNF2           Window Function
139000200529     C                     MOVEL'Y'       W0PFM
139100200529     C*                                                                   S01408
139200200529     C/COPY WNCPYSRC,SD0010PCP1                                           S01408
139300200529     C*                                                                   S01408
139400200529     C*                                                                   S01408
139500200529     C           ULX004    IFEQ 'Y'                                                           CER001
139600200529      *                                                                                       CER001
139700200529      ** EUROPEAN REPORTING DETAILS                                                           CER001
139800200529      *                                                                                       CER001
139900200529     C                     MOVE BBCUST    WWCUST  6                                           CER001
140000200529     C           WWCUST    CHAINSDCUX2L0             95                                       CER001
140100200529     C           *IN95     IFEQ '0'                                                           CER001
140200200529     C                     Z-ADDVFCONS    XRCONS                                              CER001
140300200529     C                     Z-ADDVFECOS    XRECOS                                              CER001
140400200529     C                     Z-ADDVFNCOS    XRNCOS                                              CER001
140500200529     C                     Z-ADDVFINRF    XRINRF                                              CER001
140600200529     C**********           Z-ADDVFCGRP    XRCGRP                                      CER001 CSD027A
140700200529     C                     MOVE VFCGRP    XRCGRP                                             CSD027A
140800200529     C                     Z-ADDVFPAPS    XRPAPS                                              CER001
140900200529     C                     MOVE VFPERF    XRPERF                                              CER001
141000200529     C                     MOVE VFSMRS    XRSMRS                                              CER001
141100200529     C                     ENDIF                                                              CER001
141200200529      *                                                                                       CER001
141300200529      **  If feature UlX012 is installed                                                      CER001
141400200529      *                                                                                       CER001
141500200529     C           ULX012    IFEQ 'Y'                                                           CER001
141600200529     C                     MOVE VFAUTG    XRAUTG                                              CER001
141700200529     C                     MOVE VFPROG    XRPROG                                              CER001
141800200529     C                     MOVE VFASSP    XRASSP                                              CER001
141900200529     C                     ENDIF                                                              CER001
142000200529      *                                                                                       CER001
142100200529      ** If feature UlX008 is installed                                                       CER001
142200200529      *                                                                                       CER001
142300200529     C           ULX008    IFEQ 'Y'                                                           CER001
142400200529     C                     MOVE VFICCD    XRICCD                                              CER001
142500200529     C                     MOVE VFMCID    XRMCID                                              CER001
142600200529     C                     ENDIF                                                              CER001
142700200529      *                                                                                       CER001
142800200529      ** If feature UlX048 is installed                                                       CER001
142900200529      *                                                                                       CER001
143000200529     C           ULX048    IFEQ 'Y'                                                           CER001
143100200529     C                     MOVE VFMCID    XRMCID                                              CER001
143200200529     C                     ENDIF                                                              CER001
143300200529     C                     ELSE                                                               CER001
143400200529     C                     Z-ADD0         XRCONS                                              CER001
143500200529     C                     Z-ADD0         XRECOS                                              CER001
143600200529     C                     Z-ADD0         XRNCOS                                              CER001
143700200529     C                     Z-ADD0         XRINRF                                              CER001
143800200529     C**********           Z-ADD0         XRCGRP                                      CER001 CSD027A
143900200529     C                     MOVE *BLANKS   XRCGRP                                             CSD027A
144000200529     C                     Z-ADD0         XRPAPS                                              CER001
144100200529     C                     MOVE ' '       XRPERF                                              CER001
144200200529     C                     MOVE ' '       XRSMRS                                              CER001
144300200529      *                                                                                       CER001
144400200529      **  If feature UlX012 is installed                                                      CER001
144500200529      *                                                                                       CER001
144600200529     C           ULX012    IFEQ 'Y'                                                           CER001
144700200529     C                     MOVE ' '       XRAUTG                                              CER001
144800200529     C                     MOVE ' '       XRPROG                                              CER001
144900200529     C                     MOVE ' '       XRASSP                                              CER001
145000200529     C                     ENDIF                                                              CER001
145100200529      *                                                                                       CER001
145200200529      ** If both features ULX012 and ULX012 are installed                                     CER001
145300200529      *                                                                                       CER001
145400200529     C           ULX012    IFEQ 'Y'                                                           CER001
145500200529     C                     MOVE *BLANKS   XRPLGT                                              CER001
145600200529     C                     ENDIF                                                              CER001
145700200529      *                                                                                       CER001
145800200529      **  If feature UlX008 is installed                                                      CER001
145900200529      *                                                                                       CER001
146000200529     C           ULX008    IFEQ 'Y'                                                           CER001
146100200529     C                     MOVE ' '       XRICCD                                              CER001
146200200529     C                     MOVE ' '       XRMCID                                              CER001
146300200529     C                     ENDIF                                                              CER001
146400200529      *                                                                                       CER001
146500200529      **  If feature UlX048 is installed                                                      CER001
146600200529      *                                                                                       CER001
146700200529     C           ULX048    IFEQ 'Y'                                                           CER001
146800200529     C                     MOVE ' '       XRMCID                                              CER001
146900200529     C                     ENDIF                                                              CER001
147000200529     C                     ENDIF                                                              CER001
147100200529     C/COPY WNCPYSRC,SD0010PCP2                                           S01408
147200200529     C*                                                                   S01408
147300200529      *                                                                                       CER001
147400200529      ** ULX043 Treatment                                                                     CER001
147500200529      *                                                                                       CER001
147600200529     C           ULX043    IFEQ 'Y'                                                           CER001
147700200529     C                     CALL 'IL0450'                                                      CER001
147800200529     C                     PARM BBCUST    PCNUM   6                                           CER001
147900200529     C                     PARM *BLANKS   IBFROM                                              CER001
148000200529     C                     PARM *BLANK    ILFLAG  1                                           CER001
148100200529      *                                                                                       CER001
148200200529     C           ILFLAG    IFEQ '0'                                                           CER001
148300200529     C                     MOVEAIBFROM    BLC                                                 CER001
148400200529     C                     ENDIF                                                              CER001
148500200529      *                                                                                       CER001
148600200529     C                     ENDIF                                                              CER001
148700200529      *                                                                   S01383
148800200529      ***  If BRT SAR is installed, determine the sets of Holder data     S01383
148900200529      ***  that will be printed. (Controlled by Indicators 11 - 15).      S01383
149000200529      *                                                                   S01383
149100200529     C           S01383    IFEQ 'Y'                                       S01383
149200200529     C                     MOVEA'00000'   *IN,11                          S01383
149300200529      *                                                                   S01383
149400200529      ***  If A/c Holder Type is 'J', sets 1 and 2 will be printed.       S01383
149500200529      *                                                                   S01383
149600200529     C           ACHLRT    IFEQ 'J'                                       S01383
149700200529     C                     SETON                     1112                 S01383
149800200529     C                     END                                            S01383
149900200529      *                                                                   S01383
150000200529      **If*A/c*Holder*Type*is*'I',*at*least*set*1*will*be*printed* S01383 CRE007
150100200529      ** If A/c Holder Type is 'I' or 'R', at least set 1 will be printed CRE007
150200200529      *                                                                   S01383
150300200529     C           ACHLRT    IFEQ 'I'                                       S01383
150400200529     C           ACHLRT    OREQ 'R'                                       CRE007
150500200529     C                     SETON                     11                   S01383
150600200529      *                                                                   S01383
150700200529      ***  Then, for sets 2 to 5, each set will be printed if its BRT     S01383
150800200529      ***  Liable Flag is 'Y', 'X' or 'N', but if a set has a blank BRT   S01383
150900200529      ***  Liable Flag, then all subsequent sets for this customer are    S01383
151000200529      ***  blank.                                                         S01383
151100200529      *                                                                   S01383
151200200529     C           H2BRTL    IFEQ 'Y'                                       S01383
151300200529     C           H2BRTL    OREQ 'X'                                       S01383
151400200529     C           H2BRTL    OREQ 'N'                                       S01383
151500200529     C                     SETON                     12                   S01383
151600200529      *                                                                   S01383
151700200529     C           H3BRTL    IFEQ 'Y'                                       S01383
151800200529     C           H3BRTL    OREQ 'X'                                       S01383
151900200529     C           H3BRTL    OREQ 'N'                                       S01383
152000200529     C                     SETON                     13                   S01383
152100200529      *                                                                   S01383
152200200529     C           H4BRTL    IFEQ 'Y'                                       S01383
152300200529     C           H4BRTL    OREQ 'X'                                       S01383
152400200529     C           H4BRTL    OREQ 'N'                                       S01383
152500200529     C                     SETON                     14                   S01383
152600200529      *                                                                   S01383
152700200529     C           H5BRTL    IFEQ 'Y'                                       S01383
152800200529     C           H5BRTL    OREQ 'X'                                       S01383
152900200529     C           H5BRTL    OREQ 'N'                                       S01383
153000200529     C                     SETON                     15                   S01383
153100200529     C                     END                                            S01383
153200200529      *                                                                   S01383
153300200529     C                     END                                            S01383
153400200529     C                     END                                            S01383
153500200529     C                     END                                            S01383
153600200529      *                                                                   S01383
153700200529      ***  END of ACHLRT = 'I'.                                           S01383
153800200529     C                     END                                            S01383
153900200529      ***  END of BRT SAR installed (S01383 = 'Y').                       S01383
154000200529     C                     END                                            S01383
154100200529     C*                                                                   S01421
154200200529     C*                                                                   S01421
154300200529     C           *IN22     IFEQ '1'                                       S01421
154400200529     C                     MOVE BBCDEL    XRCEAD  1                       S01421
154500200529     C                     END                                            S01421
154600200529     C*                                                                   S01421
154700200529     C*                                                                   S01408
154800200529     C/COPY WNCPYSRC,SD0010PC22                                           S01408
154900200529     C*                                                                   S01408
155000200529      *                                                                   S01383
155100200529      * USER: Process detail record
155200200529      * Check File Date - Rundate  *
155300200529     C                     CALL 'ZDATE2'               90  Check File Date
155400200529     C                     PARM BBLCD     WQ0001  50       Work Midas Date
155500200529     C                     PARM WUDFF     WQ0002  1        Date format fla
155600200529     C           XRCLCD    PARM *ZERO     WQ0003  60       Work Converted
155700200529     C           WUWADT    PARM *BLANK    WQ0004  7        Work Alpha Date
155800200529      *
155900200529     C           *IN90     IFEQ '1'
156000200529      * Call to program ended in error.
156100200529     C                     MOVEL'Y2U0021' W0RTN   7
156200200529     C                     END
156300200529      *
156400200529      * Start of Fix LN0562
156500200529      * Change the processing so that the alpha date is displayed
156600200529      * instead of the DDMMYY style format
156700200529      * Check File Date - Rundate  *
156800200529     C                     CALL 'ZDATE2'               90  Check File Date
156900200529     C                     PARM BBDOIC    WQ0005  50       Work Midas Date
157000200529     C                     PARM WUDFF     WQ0006  1        Date format fla
157100200529     C           WUWCDT    PARM *ZERO     WQ0007  60       Work Converted
157200200529     C           WUWADT    PARM *BLANK    WQ0008  7        Work Alpha Date
157300200529      *
157400200529     C           *IN90     IFEQ '1'
157500200529      * Call to program ended in error.
157600200529     C                     MOVEL'Y2U0021' W0RTN   7
157700200529     C                     END
157800200529      *
157900200529     C                     MOVELWUWADT    XRRFCD           Report First Co
158000200529      * Check File Date - Rundate  *
158100200529     C                     CALL 'ZDATE2'               90  Check File Date
158200200529     C                     PARM BBSSDT    WQ0009  50       Work Midas Date
158300200529     C                     PARM WUDFF     WQ0010  1        Date format fla
158400200529     C           WUWCDT    PARM *ZERO     WQ0011  60       Work Converted
158500200529     C           WUWADT    PARM *BLANK    WQ0012  7        Work Alpha Date
158600200529      *
158700200529     C           *IN90     IFEQ '1'
158800200529      * Call to program ended in error.
158900200529     C                     MOVEL'Y2U0021' W0RTN   7
159000200529     C                     END
159100200529      *
159200200529     C                     MOVELWUWADT    XRRSUD           Report Suspende
159300200529      * Check File Date - Rundate  *
159400200529     C                     CALL 'ZDATE2'               90  Check File Date
159500200529     C                     PARM BBLDHD    WQ0013  50       Work Midas Date
159600200529     C                     PARM WUDFF     WQ0014  1        Date format fla
159700200529     C           WUWCDT    PARM *ZERO     WQ0015  60       Work Converted
159800200529     C           WUWADT    PARM *BLANK    WQ0016  7        Work Alpha Date
159900200529      *
160000200529     C           *IN90     IFEQ '1'
160100200529      * Call to program ended in error.
160200200529     C                     MOVEL'Y2U0021' W0RTN   7
160300200529     C                     END
160400200529      *
160500200529     C                     MOVELWUWADT    XRRDHD           Report Dels His
160600200529      * Check File Date - Rundate  *
160700200529     C                     CALL 'ZDATE2'               90  Check File Date
160800200529     C                     PARM BBLRLD    WQ0017  50       Work Midas Date
160900200529     C                     PARM WUDFF     WQ0018  1        Date format fla
161000200529     C           WUWCDT    PARM *ZERO     WQ0019  60       Work Converted
161100200529     C           WUWADT    PARM *BLANK    WQ0020  7        Work Alpha Date
161200200529      *
161300200529     C           *IN90     IFEQ '1'
161400200529      * Call to program ended in error.
161500200529     C                     MOVEL'Y2U0021' W0RTN   7
161600200529     C                     END
161700200529      *
161800200529     C                     MOVELWUWADT    XRRRLD           Report Retail L
161900200529      * Check File Date - Rundate  *
162000200529     C                     CALL 'ZDATE2'               90  Check File Date
162100200529     C                     PARM BBDTDL    WQ0021  50       Work Midas Date
162200200529     C                     PARM WUDFF     WQ0022  1        Date format fla
162300200529     C           WUWCDT    PARM *ZERO     WQ0023  60       Work Converted
162400200529     C           WUWADT    PARM *BLANK    WQ0024  7        Work Alpha Date
162500200529      *
162600200529     C           *IN90     IFEQ '1'
162700200529      * Call to program ended in error.
162800200529     C                     MOVEL'Y2U0021' W0RTN   7
162900200529     C                     END
163000200529      *
163100200529     C                     MOVELWUWADT    XRRDTD           Report Date Del
163200200529      * Check File Date - Convert to Screen Format *                                          CGL132
163300200529     C                     CALL 'ZDATE2'               90  Check File Date                    CGL132
163400200529     C                     PARM XCCRDT    WQ0021  50       Work Midas Date                    CGL132
163500200529     C                     PARM WUDFF     WQ0022  1        Date format fla                    CGL132
163600200529     C           WUWCDT    PARM *ZERO     WQ0023  60       Work Converted                     CGL132
163700200529     C           WUWADT    PARM *BLANK    WQ0024  7        Work Alpha Date                    CGL132
163800200529      *                                                                                       CGL132
163900200529     C           *IN90     IFEQ '1'                                                           CGL132
164000200529      * Call to program ended in error.                                                       CGL132
164100200529     C                     MOVEL'Y2U0021' W0RTN   7                                           CGL132
164200200529     C                     END                                                                CGL132
164300200529      *                                                                                       CGL132
164400200529     C                     MOVELWUWADT    XRCRDT           Creation Date                      CGL132
164500200529      * Check File Date - Rundate  *
164600200529     C                     CALL 'ZDATE2'               90  Check File Date
164700200529     C                     PARM BBLALD    WQ0025  50       Work Midas Date
164800200529     C                     PARM WUDFF     WQ0026  1        Date format fla
164900200529     C           WUWCDT    PARM *ZERO     WQ0027  60       Work Converted
165000200529     C           WUWADT    PARM *BLANK    WQ0028  7        Work Alpha Date
165100200529      *
165200200529     C           *IN90     IFEQ '1'
165300200529      * Call to program ended in error.
165400200529     C                     MOVEL'Y2U0021' W0RTN   7
165500200529     C                     END
165600200529      *
165700200529     C                     MOVELWUWADT    XRRALD           Report Audit Le
165800200529      *                                                                   CDL008
165900200529      ** If CDL008 is on, print CLS Settlement and Effective Date         CDL008
166000200529      *                                                                   CDL008
166100200529     C           CDL008    IFEQ 'Y'                                       CDL008
166200200529     C                     MOVELBBCLSS    XRCLSS                          CDL008
166300200529      *                                                                   CDL008
166400200529     C           BBEFDT    IFEQ *ZERO                                     CDL008
166500200529     C                     MOVE *BLANKS   WUWADT                          CDL008
166600200529     C                     ELSE                                           CDL008
166700200529     C                     CALL 'ZDATE2'               90                 CDL008
166800200529     C                     PARM BBEFDT    WQ0042  50                      CDL008
166900200529     C                     PARM WUDFF     WQ0043  1                       CDL008
167000200529     C           WUWCDT    PARM *ZERO     WQ0044  60                      CDL008
167100200529     C           WUWADT    PARM *BLANK    WQ0045  7                       CDL008
167200200529     C           *IN90     IFEQ *ON                                       CDL008
167300200529     C                     MOVEL'Y2U0021' W0RTN                           CDL008
167400200529     C                     ENDIF                                          CDL008
167500200529     C                     ENDIF                                          CDL008
167600200529      *                                                                   CDL008
167700200529     C                     MOVE WUWADT    XREFDT                          CDL008
167800200529     C                     ENDIF                                          CDL008
167900200529      *                                                                   CDL008
168000200529      * End of Fix LN0562
168100200529     C                     MOVELP1ARSI    WUARSI           Audit/Request S
168200200529      * Process Detail Rec PRTFIL
168300200529      * Start of Fix BHF950
168400200529      * This change to the standard object was required because the
168500200529      * clients file has logically deleted records and these were
168600200529      * initially being counted as records on the file - thus if there
168700200529      * were any deleted clients on the system the file controls would
168800200529      * be out of balance. This fix will not affect any other report
168900200529      * programs since there will be no records with a last change type
169000200529      * of 'D'.
169100200529      *CASE:     PAR.Type of Last Change is Not Delete
169200200529     C********** XRTYLC    IFEQ @CN,02                     *IF                              MD025682
169300200529     C********** XRTYLC    OREQ @CN,03                                                      MD025682
169400200529     C           XRDTDL    IFEQ 0                          *IF                              MD025682
169500200529     C                     ADD  1         WUWKNB           work number
169600200529     C                     END                             *FI
169700200529      * End of Fix BHF950
169800200529     C/COPY WNCPYSRC,SD0010PC01
169900200529      *CASE:     PAR.Audit/Request Status Ind is Audit Mode
170000200529     C           WUARSI    IFEQ @CN,02                     *IF
170100200529      *CASE:     PAR.Last Change Date NE WRK.run day number
170200200529     C           XRLCD     IFNE WURDNB                     *IF
170300200529     C                     MOVEL@CN,04    W0PFM            *Print format
170400200529     C                     END                             *FI
170500200529     C                     END                             *FI
170600200529      *CASE:     PGM.*Print format is Print format
170700200529     C           W0PFM     IFEQ @CN,01                     *IF
170800200529     C                     ADD  1         ZTNCRC           No of Calculate
170900200529      *CASE:     PAR.No of Calculated Recs is Equal 1
171000200529     C           ZTNCRC    IFEQ 1                          *IF
171100200529      * Change Print Control to Y - Standing Data Controls  *
171200200529     C*
171300200529     C* Set Print Control To Y To Enable Column Headers To Be
171400200529     C*             Printed On First Record..
171500200529     C*
171600200529     C                     MOVEL'Y'       BAPR    1
171700200529     C                     END                             *FI
171800200529     C                     END                             *FI
171900200529      * Check File Date - Rundate  *
172000200529     C                     CALL 'ZDATE2'               90  Check File Date
172100200529     C                     PARM XRLCD     WQ0029  50       Work Midas Date
172200200529     C                     PARM WUDFF     WQ0030  1        Date format fla
172300200529     C           WUWCDT    PARM *ZERO     WQ0031  60       Work Converted
172400200529     C           XRACDT    PARM *BLANK    WQ0032  7        Work Alpha Date
172500200529      *
172600200529     C           *IN90     IFEQ '1'
172700200529      * Call to program ended in error.
172800200529     C                     MOVEL'Y2U0021' W0RTN   7
172900200529     C                     END
173000200529      *
173100200529      * PAR.alpha of last change = Condition name of PAR.Type of Last Change
173200200529     C                     CALL 'Y2RVCNR'              90  *
173300200529     C                     PARM           W0RTN   7        Return code
173400200529     C                     PARM 1100584   Y2LSNO  70       List number
173500200529     C                     PARM XRTYLC    W0INVL 20        Type of Last Ch
173600200529     C                     PARM ' '       W0VLMP  1        Value mapped?
173700200529     C           XRALCH    PARM           W0CNNM 25        alpha of last c
173800200529      *
173900200529      * Start of Fix BHF331
174000200529      *CASE:     CUR.Type of Last Change is Delete
174100200529     C           XRTYLC    IFEQ @CN,05                     *IF
174200200529     C                     MOVEL@CN,06    XRCSTA           Customer Status
174300200529     C                     ELSE
174400200529      *CASE:     *OTHERWISE
174500200529     C                     MOVEL*BLANK    XRCSTA           Customer Status
174600200529     C                     END                             *FI
174700200529      * End of Fix BHF331
174800200529      *                                                                   CSD007
174900200529      ** If CSD007 is installed, display Type of last change, status      CSD007
175000200529      ** and change date for Closed or Released Customers                 CSD007
175100200529      *                                                                   CSD007
175200200529     C                     MOVE *OFF      *IN71                           CSD007
175300200529     C                     MOVEL*BLANKS   XRCLDT                          CSD007
175400200529      *                                                                   CSD007
175500200529     C           CSD007    IFEQ 'Y'                                       CSD007
175600200529     C           BBDEAC    IFEQ 'Y'                                       CSD025A
175700200529     C           CSD025    ANDEQ'Y'                                       CSD025A
175800200529     C                     MOVEL@CN,18    XRALCH                          CSD025A
175900200529     C                     ENDIF                                          CSD025A
176000200529     C           BBCLDT    IFGT *ZERO                                     CSD007
176100200529     C                     MOVE *ON       *IN71                           CSD007
176200200529     C                     CALL 'ZDATE2'               90                 CSD007
176300200529     C                     PARM BBCLDT    WQ0042  50                      CSD007
176400200529     C                     PARM WUDFF     WQ0043  1                       CSD007
176500200529     C           WUWCDT    PARM *ZERO     WQ0044  60                      CSD007
176600200529     C           XRCLDT    PARM *BLANKS   WQ0045  7                       CSD007
176700200529     C           *IN90     IFEQ *ON                                       CSD007
176800200529     C                     MOVEL'Y2U0021' W0RTN                           CSD007
176900200529     C                     ENDIF                                          CSD007
177000200529     C           BBCLST    IFEQ *BLANK                                    CSD007
177100200529     C                     MOVEL@CN,15    XRALCH                          CSD007
177200200529     C                     ENDIF                                          CSD007
177300200529     C                     ENDIF                                          CSD007
177400200529      *                                                                   CSD007
177500200529     C           BBCLST    IFEQ 'Y'                                       CSD007
177600200529     C           BBDTDL    ANDEQ*ZERO                                     CSD007
177700200529     C                     MOVEL@CN,16    XRALCH                          CSD007
177800200529     C                     MOVEL@CN,17    XRCSTA                          CSD007
177900200529     C                     ENDIF                                          CSD007
178000200529     C                     ENDIF                                          CSD007
178100200529      *                                                                   CSD007
178200200529      *CASE:     WRK.S01212 is Fix installed
178300200529     C           WUMFTS    IFEQ @CN,01                     *IF
178400200529      * 00/Copy Member SD0010PPDR - Client Details  *
178500200529     C/COPY WNCPYSRC,SD0010PPDR
178600200529      *                                                                                      LLN022A
178700200529      ** If BOE Yellow book module is on                                                     LLN022A
178800200529      *                                                                                      LLN022A
178900200529     C           LLN007    IFEQ 'Y'                                                          LLN022A
179000200529      *                                                                                      LLN022A
179100200529     C           BBCUST    CHAINBYCUSTY0             92                                      LLN022A
179200200529      *                                                                                      LLN022A
179300200529      ** Record is found                                                                     LLN022A
179400200529      *                                                                                      LLN022A
179500200529     C           *IN92     IFEQ *OFF                                                         LLN022A
179600200529      *                                                                                      LLN022A
179700200529      ** Move Data Structure Fields to 1st Printline                                         LLN022A
179800200529      *                                                                                      LLN022A
179900200529     C                     MOVE LSIOF     ULSIOF           SIO Ind                           LLN022A
180000200529     C                     MOVE LHASI     ULHAIN           H/A Ind                           LLN022A
180100200529     C                     MOVE LUPAR     ULULPA           Ult Parent                        LLN022A
180200200529     C                     MOVE LELGF     ULEGFL           Elig Flag                         LLN022A
180300200529     C                     MOVE LLINC     ULLINC                                             LLN022A
180400200529     C                     MOVE LLICD     ULLICD                                             LLN022A
180500200529     C                     MOVE UFLD1     XRWNFF                                             LLN022A
180600200529      *                                                                                      LLN022A
180700200529      ** Otherwise move blanks to data-structure fields                                      LLN022A
180800200529      *                                                                                      LLN022A
180900200529     C                     ELSE                                                              LLN022A
181000200529     C                     MOVE *BLANK    ULULPA           Ult. Parent                       LLN022A
181100200529     C                     MOVE *BLANK    ULEGFL           Elig. Flag                        LLN022A
181200200529     C                     MOVE *BLANK    ULLINC                                             LLN022A
181300200529     C                     MOVE *BLANK    ULLICD                                             LLN022A
181400200529      *                                                                                      LLN022A
181500200529     C                     ENDIF                                                             LLN022A
181600200529     C                     ENDIF                                                             LLN022A
181700200529      *                                                                                      LLN022A
181800200529     C                     END                             *FI
181900200529     C           W0PFM     IFEQ 'Y'
182000200529      * Convert fields to external form.
182100200529     C                     MOVEL'0'       *IN79
182200200529     C           XRWNFF    IFEQ *BLANK                     *IF
182300200529     C                     MOVEL'1'       *IN79
182400200529     C                     END                             *FI
182500200529     C                     MOVEL'0'       *IN78
182600200529     C           XRWNF1    IFEQ *BLANK                     *IF
182700200529     C                     MOVEL'1'       *IN78
182800200529     C                     END                             *FI
182900200529     C                     MOVEL'0'       *IN77
183000200529     C           XRWNF2    IFEQ *BLANK                     *IF
183100200529     C                     MOVEL'1'       *IN77
183200200529     C                     END                             *FI
183300200529      *                                                                   CGL018
183400200529      * Output RWA details for each customer                              CGL018
183500200529      *                                                                   CGL018
183600200529     C           CGL018    IFEQ 'Y'                                       CGL018
183700200529     C                     EXSR RWADTL                                    CGL018
183800200529     C                     ENDIF                                          CGL018
183900200529      **********                                                                     CER073 MD049187
184000200529      ***Output*AnaCredit Reporting                                                  CER073 MD049187
184100200529      **********                                                                     CER073 MD049187
184200200529     C********** CER073    IFEQ 'Y'                                                  CER073 MD049187
184300200529     C**********           EXSR SRANAC                                               CER073 MD049187
184400200529     C**********           ENDIF                                                     CER073 MD049187
184500200529     C/COPY WNCPYSRC,SD0010PC06
184600200529      * Print detail line.
184700200529     C                     WRITEZZDTLRCD
184800200529     C*                                                                   S01408
184900200529     C/COPY WNCPYSRC,SD0010PCP3                                           S01408
185000200529     C*                                                                   S01408
185100200529     C           ULX043    IFEQ 'Y'                                                           CER001
185200200529     C           ILFLAG    ANDEQ'0'                                                           CER001
185300200529     C                     MOVE *BLANKS   RRFROM                                              CER001
185400200529     C                     WRITEZZIBLC02                                                      CER001
185500200529      *                                                                                       CER001
185600200529     C                     DO   5         BL      10                                          CER001
185700200529     C           BLC,BL    IFNE *BLANKS                                                       CER001
185800200529     C                     MOVELBLC,BL    RRFROM                                              CER001
185900200529      *                                                                                       CER001
186000200529      ** If there is not enough space on the                                                  CER001
186100200529      ** physical page for this format:-                                                      CER001
186200200529      *                                                                                       CER001
186300200529     C           @$PGL     SUB  @$CLN     @$WRK                                               CER001
186400200529     C           @$WRK     IFLE 1                                                             CER001
186500200529      *                                                                                       CER001
186600200529      ** Signal artificial overflow.                                                          CER001
186700200529      *                                                                                       CER001
186800200529     C                     SETON                     97                                       CER001
186900200529      *                                                                                       CER001
187000200529      ** Print page headers.                                                                  CER001
187100200529      *                                                                                       CER001
187200200529     C                     EXSR FASGHD                                                        CER001
187300200529     C                     EXSR BAPRHD                                                        CER001
187400200529      *                                                                                       CER001
187500200529     C                     ENDIF                                                              CER001
187600200529      *                                                                                       CER001
187700200529     C                     WRITEZZIBLC02                                                      CER001
187800200529     C                     ENDIF                                                              CER001
187900200529     C                     ENDDO                                                              CER001
188000200529     C                     ENDIF                                                              CER001
188100200529      *                                                                                       CER001
188200200529     C                     END
188300200529      *================================================================
188400200529     CSR         CAEXIT    ENDSR
188500200529      *****************************************************************                       CGP001
188600200529      /EJECT                                                                                  CGP001
188700200529      *****************************************************************                       CGP001
188800200529      *                                                               *                       CGP001
188900200529      *  SRGPCU - Gets the Global Customer X-Reference details        *                       CGP001
189000200529      *                                                               *                       CGP001
189100200529      *****************************************************************                       CGP001
189200200529     C           SRGPCU    BEGSR                                                              CGP001
189300200529      *                                                                                       CGP001
189400200529     C                     MOVE BBBRCD    KBRCD                                               CGP001
189500200529     C                     MOVE BBCUST    KCUST                                               CGP001
189600200529      *                                                                                       CGP001
189700200529     C           KGPXR     CHAINGPCSTXL1            N46                                       CGP001
189800200529      *                                                                                       CGP001
189900200529     C           *IN46     IFEQ *OFF                                                          CGP001
190000200529     C                     MOVE CUGCUS    XRGCID                                              CGP001
190100200529     C                     ELSE                                                               CGP001
190200200529     C                     MOVE *BLANKS   XRGCID                                              CGP001
190300200529     C                     ENDIF                                                              CGP001
190400200529      *                                                                                       CGP001
190500200529     C                     ENDSR                                                              CGP001
190600200529      *****************************************************************                       CGP001
190700200529      /EJECT                                                                                  CGP001
190800200529      *****************************************************************                       CGP001
190900200529      *                                                               *                       CGP001
191000200529      *  SRGPOF - Opens the Global Processing Cross-Reference Files.  *                       CGP001
191100200529      *                                                               *                       CGP001
191200200529      *****************************************************************                       CGP001
191300200529     C           SRGPOF    BEGSR                                                              CGP001
191400200529      *                                                                                       CGP001
191500200529     C                     Z-ADD80        PLEN   155                                          CGP001
191600200529      *                                                                                       CGP001
191700200529     C                     MOVE OVRC,1    PCMD   80                                           CGP001
191800200529      *                                                                                       CGP001
191900200529     C                     CALL 'QCMDEXC'                                                     CGP001
192000200529     C                     PARM           PCMD                                                CGP001
192100200529     C                     PARM           PLEN                                                CGP001
192200200529      *                                                                                       CGP001
192300200529     C                     OPEN GPCSTXL1                                                      CGP001
192400200529      *                                                                                       CGP001
192500200529     C                     ENDSR                                                              CGP001
192600200529      *****************************************************************                       CGP001
192700200529      /EJECT                                                              S01421
192800200529     CSR         ACDTSR    BEGSR                                          S01421
192900200529      *================================================================   S01421
193000200529      *                                                                   CDL006
193100200529      ** If Switchable Feature CDL006 is Switched on move File fields     CDL006
193200200529      ** to their respective printer file fields.                         CDL006
193300200529      *                                                                   CDL006
193400200529     C           CDL006    IFEQ 'Y'                                       CDL006
193500200529     C                     MOVELBBCOMG    R1COMG                          CDL006
193600200529     C                     MOVELBBCHRG    R1CHRG                          CDL006
193700200529     C                     MOVELBBAGNT    R1AGNT                          CDL006
193800200529     C                     MOVELBBAGNP    R1AGNP                          CDL006
193900200529     C                     MOVELBBDFAC    R1DFAC                          CDL006
194000200529     C                     MOVELBBDFAS    R1DFAS                          CDL006
194100200529     C                     MOVELBBTRAS    R1TRAS                          CDL006
194200200529     C                     MOVELBBNAR1    R1NAR1                          CDL006
194300200529     C                     MOVELBBNAR2    R1NAR2                          CDL006
194400200529     C                     MOVELBBNAR3    R1NAR3                          CDL006
194500200529     C                     MOVELBBNAR4    R1NAR4                          CDL006
194600200529      *                                                                   CDL006
194700200529      ** Inhibit printing of DL Fiduciary details if Additional           CDL006
194800200529      ** Customer Details not printed.                                    CDL006
194900200529      *                                                                   CDL006
195000200529     C           *IN23     IFEQ *OFF                                      CDL006
195100200529     C                     MOVE '0'       *IN17                           CDL006
195200200529     C                     ELSE                                           CDL006
195300200529     C                     MOVE '1'       *IN17                           CDL006
195400200529     C                     ENDIF                                          CDL006
195500200529      *                                                                   CDL006
195600200529     C                     ENDIF                                          CDL006
195700200529      *                                                                   S01421
195800200529      * The following Sub Routine will search for the customer number     S01421
195900200529      * and if found will write a new page header and Additional          S01421
196000200529      * Customer Details.                                                 S01421
196100200529      *                                                                   S01421
196200200529     C           XRCUST    CHAINSDACUSL1             24                   S01421
196300200529     C           *IN24     IFEQ '0'                                       S01421
196400200529     C                     MOVE E5CUST    ADCNA   6                       S01421
196500200529     C/COPY WNCPYSRC,SD0010PC29
196600200529     C                     MOVE E5ALTN    A5ALTN 12                       S01421
196700200529     C/COPY WNCPYSRC,SD0010PC30
196800200529     C                     MOVE E5IDNO    A5IDNO 15                       S01421
196900200529     C                     MOVE E5FXNB    A5FXNB 12                       S01421
197000200529     C                     MOVE E5TXNB    A5TXNB 12                       S01421
197100200529     C                     MOVE E5PRVO    A5PRVO  1                       S01421
197200200529     C                     MOVE E5MDTL    A5MDTL  5                       S01421
197201200618     C**********           MOVE E5CNA1    A5CNA1 35                                   S01421 248936B
197202200618     C                     MOVE E5CNA1    A5CNA1 70                                          248936B
197400200529     C           CSW207    IFEQ 'Y'                                                           CSW207
197500200529     C                     MOVE E5ISCD    A5ISCD 35                                           CSW207
197600200529     C                     ENDIF                                                              CSW207
197700200529     C/COPY WNCPYSRC,SD0010PC31
197701200618     C**********           MOVE E5CNA2    A5CNA2 35                                   S01421 248936B
197702200618     C                     MOVE E5CNA2    A5CNA2 70                                          248936B
197900200529     C                     MOVE E5CNA3    A5CNA3 35                       S01421
198000200529     C                     MOVE E5CNA4    A5CNA4 35                       S01421
198100200529     C                     MOVE E5CWL1    A5CWL1 20                       S01421
198200200529     C                     MOVE E5CWL2    A5CWL2 20                       S01421
198300200529     C/COPY WNCPYSRC,SD0010PC32
198400200529     C                     MOVE E5CWL3    A5CWL3 20                       S01421
198500200529     C                     MOVE E5CWL4    A5CWL4 20                       S01421
198600200529     C                     MOVE E5CWL5    A5CWL5 20                       S01421
198700200529      *                                                                   S01421
198800200529      * Change the processing so that the alpha date is displayed         S01421
198900200529      * instead of the DDMMYY style format                                S01421
199000200529      * Check File Date - Date of last visit *                            S01421
199100200529      *                                                                   S01421
199200200529     C                     CALL 'ZDATE2'               90  Check File DateS01421
199300200529     C                     PARM E5DOLV    WQ00A1  50       Work Midas DateS01421
199400200529     C                     PARM WUDFF     WQ00A2  1        Date format flaS01421
199500200529     C           WUWCDT    PARM *ZERO     WQ00A3  60       Work Converted S01421
199600200529     C           WUWADT    PARM *BLANK    WQ00A4  7        Work Alpha DateS01421
199700200529      *                                                                   S01421
199800200529     C           *IN90     IFEQ '1'                                       S01421
199900200529      * Call to program ended in error.                                   S01421
200000200529     C                     MOVEL'Y2U0021' W0RTN   7                       S01421
200100200529     C                     END                                            S01421
200200200529     C                     MOVELWUWADT    A5DOLV  7                       S01421
200300200529      *                                                                   S01421
200400200529     C           E5BRTH    IFNE 0                                         113339
200500200529     C                     CALL 'ZDATE2'               90  Check File DateS01421
200600200529     C                     PARM E5BRTH    WQ00A5  50       Work Midas DateS01421
200700200529     C                     PARM WUDFF     WQ00A6  1        Date format flaS01421
200800200529     C           WUWCDT    PARM *ZERO     WQ00A7  60       Work Converted S01421
200900200529     C           WUWADT    PARM *BLANK    WQ00A8  7        Work Alpha DateS01421
201000200529      *                                                                   S01421
201100200529     C           *IN90     IFEQ '1'                                       S01421
201200200529      * Call to program ended in error.                                   S01421
201300200529     C                     MOVEL'Y2U0021' W0RTN   7                       S01421
201400200529     C                     END                                            S01421
201500200529     C                     ELSE                                           113339
201600200529     C           E5BRT1    IFNE *BLANKS                                   113339
201700200529     C           E5BRT1    ANDNE'000000'                                  168603
201800200529      * If format is MMDDYY swap month and day fields for DS E5BRT1       113339
201900200529     C           WUDFF     IFEQ 'M'                                       113339
202000200529     C                     MOVE WWBDAY    WKBMNT  2                       113339
202100200529     C                     MOVELWWBMNT    WWBDAY                          113339
202200200529     C                     MOVE WKBMNT    WWBMNT                          113339
202300200529     C                     ENDIF                                          113339
202400200529     C                     Z-ADDWWBMNT    Z       20                      113339
202500200529     C                     MOVEAZMNM,Z    WWBMT1                          113339
202600200529     C                     MOVELWWBDAY    WWBDY1                          113339
202700200529     C                     MOVELWWBYR     WWBYR1                          113339
202800200529     C                     MOVELWWBRT1    WUWADT                          113339
202900200529     C                     END                                            113339
203000200529     C                     END                                            113339
203100200529     C******************** MOVELWUWADT    A5BRTH  7                 S01421113339
203200200529     C                     MOVELWUWADT    A5BRTH    P                     113339
203201200618      *                                                                                      248936B
203202200618      ** Print City and Zip Code if CGL032 is ON                                             248936B
203203200618      *                                                                                      248936B
203204200618     C           CGL032    IFEQ 'Y'                                                          248936B
203205200618     C                     MOVE E5CITY    A5CITY 35                                          248936B
203206200618     C                     MOVE E5ZIPC    A5ZIPC 10                                          248936B
203207200618     C                     SETON                     93                                      248936B
203208200618     C                     ELSE                                                              248936B
203209200618     C                     SETOF                     93                                      248936B
203210200618     C                     ENDIF                                                             248936B
203211200618      *                                                                                      248936B
203212200618      * If CGL031 is ON:                                                                     248936B
203213200618      * Synchronize screen field names with report field names.                              248936B
203214200618      * Format Birth Date to print in DDMMMCCYY.                                             248936B
203215200618      *                                                                                      248936B
203216200618     C           CGL031    IFEQ 'Y'                                                          248936B
203217200618     C                     SETON                     92                                      248936B
203218200618     C           A5BRTH    IFNE *BLANKS                                                      248936B
203219200618     C           E5BRT2    ANDNE*BLANKS                                                      248936B
203220200618     C                     MOVE *BLANKS   WWBRTH                                             248936B
203221200618     C                     MOVELA5BRTH    WWBRTH                                             248936B
203222200618     C                     MOVELWWBRCC    WWBRYY                                             248936B
203223200618     C                     MOVELE5BRT2    WWBRCC                                             248936B
203224200618     C                     MOVELWWBRTH    A5BRTH                                             248936B
203225200618     C                     ENDIF                                                             248936B
203226200618     C                     ELSE                                                              248936B
203227200618     C                     SETOF                     92                                      248936B
203228200618     C                     ENDIF                                                             248936B
203300200529     C*
203400200529     C/COPY WNCPYSRC,SD0010PCP7
203500200529     C*
203600200529      *                                                                   S01421
203700200529     C           W0PFM     IFEQ 'Y'                                       076824
203800200529     C                     WRITEZZPAGHDR                                  S01421
203900200529     C                     ELSE                                           076824
204000200529     C                     ADD  1         ZTNCRC                          076824
204100200529     C                     END                                            076824
204200200529      *                                                                                       CSD029
204300200529     C           CSD029    IFEQ 'Y'                                                           CSD029
204400200529     C                     EXSR SRFMTF                                                        CSD029
204500200529     C                     ELSE                                                               CSD029
204600200529     C                     MOVE *ON       *IN31                                               CSD029
204700200529     C                     MOVE *ON       *IN32                                               CSD029
204800200529     C                     MOVE *ON       *IN33                                               CSD029
204900200529     C                     MOVE *ON       *IN34                                               CSD029
205000200529     C                     MOVE *ON       *IN35                                               CSD029
205100200529     C                     MOVE *ON       *IN36                                               CSD029
205200200529     C                     MOVE *ON       *IN37                                               CSD029
205300200529     C                     MOVE *ON       *IN38                                               CSD029
205400200529     C                     MOVE *ON       *IN39                                               CSD029
205500200529     C                     MOVE *ON       *IN40                                               CSD029
205600200529     C                     ENDIF                                                              CSD029
205700200529     C                     WRITEADCUDT                                    S01421
205800200529     C*                                                                   S01421
205900200529     C                     END                                            S01421
206000200529     C*                                                                   S01421
206100200529     C*================================================================   S01421
206200200529     CSR         ACEXIT    ENDSR
206300200529      /EJECT
206400200529     CSR         DALVCH    BEGSR
206500200529      *================================================================
206600200529      * Detect level changes.
206700200529      *================================================================
206800200529      * Clear all level breaks.
206900200529     C                     MOVEL*BLANK    L0               Page headings
207000200529      * Clear heading length to print.
207100200529     C                     Z-ADD*ZERO     @$HDL
207200200529      *
207300200529      * End of file - Signal all level breaks.
207400200529     C           W0EOF     IFEQ '1'
207500200529     C                     ELSE
207600200529     C                     END
207700200529      *================================================================
207800200529     CSR         DAEXIT    ENDSR
207900200529      /EJECT
208000200529     CSR         EAPRTT    BEGSR
208100200529      *================================================================
208200200529      * Print report Totals.
208300200529      *================================================================
208400200529      * Print level break totals as required
208500200529      * End of file - Print final totals.
208600200529     C           W0EOF     IFEQ '1'
208700200529     C*
208800200529     C/COPY WNCPYSRC,SD0010PC14
208900200529     C*
209000200529     C                     MOVEL'Y'       W0PFM
209100200529      * USER: Process End of Report
209200200529      *CASE:     CUR.No of Calculated Recs is Compare to Zero
209300200529     C           ZTNCRC    IFEQ *ZERO                      *IF
209400200529     C                     MOVEL@CN,07    WUALZR           Alpha Zero
209500200529     C                     END                             *FI
209600200529      *CASE:     PAR.Audit/Request Status Ind is Audit Mode
209700200529     C           P1ARSI    IFEQ @CN,02                     *IF
209800200529      * Audit/On-Req RTV on FCTL - Standing Data Controls  *
209900200529     C                     EXSR SARVGN
210000200529     C*
210100200529     C/COPY WNCPYSRC,SD0010PC15
210200200529     C*
210300200529      *CASE:     WRK.work number NE WRK.No of Records on file
210400200529     C           WUWKNB    IFNE WUNORF                     *IF
210500200529     C                     MOVEL@CN,04    WUWFLG           work flag
210600200529     C                     END                             *FI
210700200529      * Start of Fix BHF399
210800200529      * Audit printfile override - Standing Data Controls  *
210900200529     C                     CALL 'SDC540P'              90  Audit printfile
211000200529     C                     PARM @CN,10    WQ0033 10        *PROGRAM
211100200529     C                     PARM WUWFLG    WQ0034  1        work flag
211200200529     C                     PARM WUNORI    WQ0035  50       No of Records I
211300200529     C                     PARM WUNORA    WQ0036  50       No of Records A
211400200529     C                     PARM WUNORD    WQ0037  50       No of records D
211500200529     C                     PARM WUWKNB    WQ0038  50       work number
211600200529     C                     PARM WUNORF    WQ0039  50       No of Records o
211700200529     C                     PARM WUAURT    WQ0040 53        Audit/Request T
211800200529     C                     PARM WUBJNA    WQ0041 53        Underline
211900200529      *
212000200529     C           *IN90     IFEQ '1'
212100200529      * Call to program ended in error.
212200200529     C                     MOVEL'Y2U0021' W0RTN   7
212300200529     C                     END
212400200529      *
212500200529      * End of Fix BHF399
212600200529      *CASE:     PGM.*Return code is *Record does not exist
212700200529     C           W0RTN     IFEQ @CN,09                     *IF
212800200529      * Database Error U7 U8 - Standing Data Controls  *
212900200529     C*
213000200529     C** DATABASE ERROR, SET ON SWITHES U7 AND U8
213100200529     C*
213200200529     C                     SETON                     U7U8
213300200529     C*
213400200529     C                     ELSE
213500200529      *CASE:     WRK.work flag is Incorrect
213600200529     C           WUWFLG    IFEQ @CN,04                     *IF
213700200529      * File Control Error U8 - Standing Data Controls  *
213800200529     C*
213900200529     C** FILE CONTROLS OUT OF BALANCE SETON U8
214000200529     C*
214100200529     C                     SETON                         U8
214200200529     C*
214300200529     C                     ELSE
214400200529      *CASE:     *OTHERWISE
214500200529      * Change Standing Data Cont - Standing Data Controls  *
214600200529     C                     EXSR SBCHRC
214700200529     C                     END                             *FI
214800200529     C                     END                             *FI
214900200529     C                     END                             *FI
215000200529      *CASE:     WRK.S01212 is Fix installed
215100200529     C           WUMFTS    IFEQ @CN,01                     *IF
215200200529      * 00/Copy Member SD0010PPER - Client Details  *
215300200529     C/COPY WNCPYSRC,SD0010PPER
215400200529     C                     END                             *FI
215500200529     C           W0PFM     IFEQ 'Y'
215600200529      * If there is not enough space on the
215700200529      * physical page for this format:-
215800200529     C           @$PGL     SUB  @$CLN     @$WRK
215900200529     C           @$WRK     IFLE 3
216000200529      * Signal artificial overflow.
216100200529     C                     SETON                     97
216200200529      * Print page headers.
216300200529     C                     WRITEZZPAGHDR
216400200529     C                     END
216500200529     C                     MOVEL'0'       *IN76
216600200529     C           WUALZR    IFEQ @CN,07                     *IF
216700200529     C                     MOVEL'1'       *IN76
216800200529     C                     END                             *FI
216900200529      * Print format.
217000200529     C                     WRITEZZFINTTL
217100200529     C                     END
217200200529     C                     END
217300200529      *
217400200529      *================================================================
217500200529     CSR         EAEXIT    ENDSR
217600200529      /EJECT
217700200529     CSR         FASGHD    BEGSR
217800200529      *================================================================
217900200529      * Signal required header formats.
218000200529      *================================================================
218100200529      * Cascade skip to new page requests upwards.
218200200529      *
218300200529     C           *IN97     IFNE '1'
218400200529     C           L0        ANDNE'Y'
218500200529      * Signal overflow if requested headings would cause
218600200529      * detail format to start past the overflow line.
218700200529     C           W0OFL     SUB  @$CLN     @$WRK
218800200529     C           @$WRK     IFLE @$HDL
218900200529     C                     SETON                     97
219000200529     C                     ELSE
219100200529     C*                                                                   S01408
219200200529     C/COPY WNCPYSRC,SD0010PCP4                                           S01408
219300200529     C*                                                                   S01408
219400200529      * Signal overflow if requested headings would cause
219500200529      * detail format to be printed past end of page
219600200529     C           ULX004    IFNE 'Y'                                                           CER001
219700200529     C                     ADD  36        @$HDL                                               CER001
219800200529     C                     ELSE                                                               CER001
219900200529     C                     ADD  36        @$HDL
220000200529     C*                                                                   S01408
220100200529     C/COPY WNCPYSRC,SD0010PCP5                                           S01408
220200200529     C*                                                                   S01408
220300200529      *                                                                                       CER001
220400200529      ** Signal overflow if requested headings would cause                                    CER001
220500200529      ** detail format to be printed past end of page                                         CER001
220600200529      *                                                                                       CER001
220700200529     C                     ADD  44        @$HDL                                               CER001
220800200529     C                     ENDIF                                                              CER001
220900200529     C           W0PGL     SUB  @$CLN     @$WRK
221000200529     C           @$WRK     IFLE @$HDL
221100200529     C                     SETON                     97
221200200529     C                     END
221300200529     C                     END
221400200529     C                     END
221500200529      * Overflow detected.
221600200529     C           *IN97     IFEQ '1'
221700200529      * Request page headings.
221800200529     C                     MOVEL'Y'       L0
221900200529      * Request all formats which print on overflow.
222000200529     C                     SETOF                     97
222100200529     C                     END
222200200529      *================================================================
222300200529     CSR         FAEXIT    ENDSR
222400200529      /EJECT
222500200529     CSR         GARDRC    BEGSR
222600200529      *================================================================
222700200529      * Read next record with user selection.
222800200529      *================================================================
222900200529     C           W0RSL     DOUEQ'Y'
223000200529     C*
223100200529     C/COPY WNCPYSRC,SD0010PC21
223200200529     C*
223300200529     C                     READ @BBREBF                  90*
223400200529     C*
223500200529     C/COPY WNCPYSRC,SD0010PC20
223600200529     C*
223700200529     C                     MOVEL*IN90     W0EOF   1
223800200529      * Quit if no record read.
223900200529     C           W0EOF     CABEQ'1'       GAEXIT
224000200529     C*
224100200529     C/COPY WNCPYSRC,SD0010PC16
224200200529     C*
224300200529      * Select record unless user action states otherwise.
224400200529     C                     MOVEL'Y'       W0RSL   1
224500200529      * USER: Record selection processing
224600200529     C*                                                                   S01408
224700200529     C/COPY WNCPYSRC,SD0010PC23                                           S01408
224800200529     C*                                                                   S01408
224900200529      *CASE:     WRK.S01212 is Fix installed
225000200529     C           WUMFTS    IFEQ @CN,01                     *IF
225100200529      * 00/Copy Member SD0010PRSP - Client Details  *
225200200529     C*00/Copy Member SD0010P   Record Selection Proc.
225300200529     C/COPY WNCPYSRC,SD0010PRSP
225400200529     C                     END                             *FI
225500200529      *                                                                   S01408
225600200529     C/COPY WNCPYSRC,SD0010PC25                                           S01408
225700200529      *                                                                   S01408
225800200529      *                                                                   S01383
225900200529      ***  If BRT SAR installed, access SDCBRTL1 for Holder details.      S01383
226000200529      *                                                                   S01383
226100200529     C           S01383    IFEQ 'Y'                                       S01383
226200200529      *                                                                   S01383
226300200529     C**********           MOVE BBCUST    KCLBRT  60                                   S01383 CSD027
226400200529     C                     MOVE BBCUST    KCLBRT  6                                           CSD027
226500200529     C/COPY WNCPYSRC,SDH00090
226600200529     C           KCLBRT    CHAINSDCBRTL1             89                   S01383
226700200529     C           *IN89     IFEQ '1'                                       S01383
226800200529     C                     SETON                     U7U8                 S01383
226900200529     C                     MOVEL'Y2U0005' W0RTN                           S01383
227000200529     C                     MOVEL'SDCBRTPD'ZA0001                          S01383
227100200529     C                     MOVEL'USR0377' ZAMSID                          S01383
227200200529     C                     EXSR ZASNMS                                    S01383
227300200529     C                     EXSR ZYEXPG                                    S01383
227400200529     C                     END                                            S01383
227500200529     C/COPY WNCPYSRC,SDH00091
227600200529      *                                                                   S01383
227700200529     C                     END                                            S01383
227800200529     C/COPY WNCPYSRC,SD0010PC04
227900200529      *                                                                   S01383
228000200529     C                     END
228100200529      *================================================================
228200200529     CSR         GAEXIT    ENDSR
228300200529      /EJECT
228400200529     CSR         SARVGN    BEGSR
228500200529      *================================================================
228600200529      * Audit/On-Req RTV on FCTL - Standing Data Controls  *
228700200529      *================================================================
228800200529     C                     MOVEL*BLANK    W0RTN   7
228900200529      * Define Keylist.
229000200529     C           KRSSA     KLIST
229100200529     C                     KFLD           AHFLNM           Filename
229200200529      * Move fields to key list.
229300200529     C                     MOVEL@CN,08    AHFLNM           Filename
229400200529     C           KRSSA     CHAIN@AHREAV              90    *
229500200529     C           *IN90     IFEQ '1'
229600200529      * DBF Record not found.
229700200529     C                     MOVEL'USR0020' W0RTN   7
229800200529      * USER: Processing if DBF record not found
229900200529     C                     MOVEL@CN,09    W0RTN            *Return code
230000200529     C                     GOTO SAEXIT
230100200529     C                     END
230200200529      *
230300200529     C           *IN90     IFEQ '0'
230400200529      * USER: Process DBF record
230500200529      * PAR = DB1 By name
230600200529     C                     Z-ADDAHNORC    WUNORF           No. of Records
230700200529     C                     Z-ADDAHNOIN    WUNORI           No. of Inserts
230800200529     C                     Z-ADDAHNOAM    WUNORA           No. of Amends
230900200529     C                     Z-ADDAHNODL    WUNORD           No. of Deletes
231000200529     C                     END
231100200529      *================================================================
231200200529     CSR         SAEXIT    ENDSR
231300200529      /EJECT
231400200529     CSR         SBCHRC    BEGSR
231500200529      *================================================================
231600200529      * Change Standing Data Cont - Standing Data Controls  *
231700200529      *================================================================
231800200529     C                     MOVEL*BLANK    W0RTN   7
231900200529      * Move key fields to @AHREAU
232000200529     C                     MOVEL@CN,08    AHFLNM           Filename
232100200529      *
232200200529     C           KLCHSB    KLIST
232300200529     C                     KFLD           AHFLNM           Filename
232400200529     C           KLCHSB    CHAIN@AHREAU              9091  *
232500200529      *
232600200529     C           *IN90     IFEQ '1'
232700200529      * Record not found.
232800200529     C                     MOVEL'Y2U0009' W0RTN   7
232900200529      * Send message '*Record no longer on file'
233000200529     C                     MOVEL'Y2U0009' ZAMSID           Message id.
233100200529     C                     MOVEL'Y2USRMSG'ZAMSGF           Message file.
233200200529     C                     EXSR ZASNMS                     Send message
233300200529     C                     GOTO SBEXIT
233400200529     C                     END
233500200529      *
233600200529     C           *IN91     IFEQ '1'
233700200529      * Record locked.
233800200529     C                     MOVEL'Y2U0004' W0RTN   7
233900200529     C                     GOTO SBEXIT
234000200529     C                     END
234100200529      *
234200200529      * USER: Processing after DBF read
234300200529     C                     ADD  AHNORC    WUNORC           No. of Records
234400200529     C                     ADD  AHNOIN    WUNOIN           No. of Inserts
234500200529     C                     ADD  AHNOAM    WUNOAM           No. of Amends
234600200529     C                     ADD  AHNODL    WUNODL           No. of Deletes
234700200529      * Move Non-key fields to @AHREAU
234800200529     C                     Z-ADDWUNORC    AHNORC           No. of Records
234900200529     C                     Z-ADD*ZERO     AHNOIN           No. of Inserts
235000200529     C                     Z-ADD*ZERO     AHNOAM           No. of Amends
235100200529     C                     Z-ADD*ZERO     AHNODL           No. of Deletes
235200200529      *
235300200529     C                     UPDAT@AHREAU                91  *
235400200529     C           *IN91     IFEQ '1'
235500200529      * Change error detected.
235600200529     C                     MOVEL'Y2U0004' W0RTN   7
235700200529     C                     ELSE
235800200529      * DBF Change successful.
235900200529     C                     END
236000200529      *================================================================
236100200529     CSR         SBEXIT    ENDSR
236200200529      /EJECT
236300200529     CSR         SCRVGN    BEGSR
236400200529      *================================================================
236500200529      * Get Bank Title - Bank Details  *
236600200529      *================================================================
236700200529     C                     MOVEL*BLANK    W0RTN   7
236800200529      * Define Keylist.
236900200529     C           KRSSC     KLIST
237000200529     C                     KFLD           BJBANK           Bank
237100200529      * Move fields to key list.
237200200529     C                     MOVEL@CN,11    BJBANK           Bank
237300200529     C           KRSSC     CHAIN@BJREEF              90    *
237400200529     C           *IN90     IFEQ '1'
237500200529      * DBF Record not found.
237600200529     C                     MOVEL'USR0197' W0RTN   7
237700200529      * USER: Processing if DBF record not found
237800200529     C                     MOVEL@CN,09    W0RTN            *Return code
237900200529      * Setup message data for message.
238000200529     C                     MOVEL@CN,12    ZA0001           Filename
238100200529      * Send message 'Database Error (ICD)'
238200200529     C                     MOVEL'USR0377' ZAMSID           Message id.
238300200529     C                     EXSR ZASNMS                     Send message
238400200529     C                     SETON                     99    *
238500200529      *
238600200529     C                     GOTO SCEXIT                     *QUIT
238700200529     C                     GOTO SCEXIT
238800200529     C                     END
238900200529      *
239000200529     C           *IN90     IFEQ '0'
239100200529      * USER: Process DBF record
239200200529      * PAR = DB1 By name
239300200529     C                     MOVELBJURPT    WUURPT           User Report Tit
239400200529     C                     END
239500200529      *================================================================
239600200529     CSR         SCEXIT    ENDSR
239700200529      /EJECT
239800200529     CSR         ZASNMS    BEGSR
239900200529      *================================================================
240000200529      * Send message to program's message queue.
240100200529      *================================================================
240200200529     C           ZAPGM     IFEQ *BLANK
240300200529     C                     MOVEL##PGM     ZAPGM
240400200529     C                     END
240500200529      * If no message file specified use default.
240600200529     C           ZAMSGF    IFEQ *BLANK
240700200529     C                     MOVELZADFMF    ZAMSGF
240800200529     C                     END
240900200529     C                     CALL 'Y2SNMGC'
241000200529     C                     PARM           ZAPGM  10        Program queue
241100200529     C                     PARM           ZAPGRL  5        Rel queue
241200200529     C                     PARM           ZAMSID  7        Message Id.
241300200529     C                     PARM           ZAMSGF 10        Message file.
241400200529     C                     PARM           ZAMSDA132        Message data.
241500200529     C                     PARM           ZAMSTP  7        Message type.
241600200529      * Clear all fields for default mechanism next time.
241700200529     C                     MOVEL*BLANK    ZAPGM            Program queue
241800200529     C                     MOVEL*BLANK    ZAPGRL           Rel queue
241900200529     C                     MOVEL*BLANK    ZAMSID           Message Id.
242000200529     C                     MOVEL*BLANK    ZAMSGF           Message file.
242100200529     C                     MOVEL*BLANK    ZAMSDA           Message data.
242200200529     C                     MOVEL*BLANK    ZAMSTP           Message type.
242300200529      *================================================================
242400200529     CSR         ZAEXIT    ENDSR
242500200529      /EJECT
242600200529     CSR         ZXEXPG    BEGSR
242700200529      *================================================================
242800200529      * Exit program
242900200529      *================================================================
243000200529     C                     MOVEL*BLANK    P0RTN
243100200529     C                     EXSR ZYEXPG
243200200529      *================================================================
243300200529     CSR         ZXEXIT    ENDSR
243400200529      /EJECT
243500200529     CSR         ZYEXPG    BEGSR
243600200529      *================================================================
243700200529      * Exit program: Direct.
243800200529      *================================================================
243900200529      *                                                                                       CGP001
244000200529     C           CGP001    IFEQ 'Y'                                                           CGP001
244100200529     C                     CLOSEGPCSTXL1                                                      CGP001
244200200529     C                     ENDIF                                                              CGP001
244300200529      * Terminate program.
244400200529     C                     SETON                     LR
244500200529      *
244600200529      * Exit program.
244700200529     C                     RETRN
244800200529      *
244900200529      *================================================================
245000200529     CSR         ZYEXIT    ENDSR
245100200529      /EJECT
245200200529     C/COPY WNCPYSRC,SD0010PC35
245300200529     CSR         ZZINIT    BEGSR
245400200529      *================================================================
245500200529      * Initialisation.
245600200529      *================================================================
245700200529      *                                                                                       CGP001
245800200529      ** Global Processing X-Reference Key Defn                                               CGP001
245900200529      *                                                                                       CGP001
246000200529     C           *LIKE     DEFN BBCUST    KCUST                                               CGP001
246100200529     C           *LIKE     DEFN BBBRCD    KBRCD                                               CGP001
246200200529      *                                                                                       CGP001
246300200529      ** Global Processing X-Reference Key List                                               CGP001
246400200529      *                                                                                       CGP001
246500200529     C           KGPXR     KLIST                                                              CGP001
246600200529     C                     KFLD           KBRCD                                               CGP001
246700200529     C                     KFLD           KCUST                                               CGP001
246800200529      *                                                                                       CGP001
246900200529     C*
247000200529     C/COPY WNCPYSRC,SD0010PC17
247100200529     C*
247200200529     C                     MOVE *BLANK    P0RTN
247300200529     C                     MOVE *BLANK    W0RTN   7
247400200529      * Setup job date/time.
247500200529     C                     Z-ADDUDATE     ##JDT            Job date.
247600200529     C                     TIME           ##JTM            Job time.
247700200529     C                     TIME           ##TME   60       Screen time.
247800200529      * Define work field S01212
247900200529     C                     MOVEL*BLANK    WUMFTS  1
248000200529      * Define work field Date format flag
248100200529     C                     MOVEL*BLANK    WUDFF   1
248200200529      * Define work field Work Alpha Date
248300200529     C                     MOVEL*BLANK    WUWADT  7
248400200529      * Define work field Work Converted Date
248500200529     C                     Z-ADD*ZERO     WUWCDT  60
248600200529      * Define work field Audit/Request Status Ind
248700200529     C                     MOVEL*BLANK    WUARSI  1
248800200529      * Define work field work number
248900200529     C                     Z-ADD*ZERO     WUWKNB  50
249000200529      * Define work field Run day number
249100200529     C                     Z-ADD*ZERO     WURDNB  50
249200200529      * Define work field Alpha Zero
249300200529     C                     MOVEL*BLANK    WUALZR  1
249400200529      * Define work field No of Records on file
249500200529     C                     Z-ADD*ZERO     WUNORF  50
249600200529      * Define work field No of Records Inserted
249700200529     C                     Z-ADD*ZERO     WUNORI  50
249800200529      * Define work field No of Records Amended
249900200529     C                     Z-ADD*ZERO     WUNORA  50
250000200529      * Define work field No of records Deleted
250100200529     C                     Z-ADD*ZERO     WUNORD  50
250200200529      * Define work field work flag
250300200529     C                     MOVEL*BLANK    WUWFLG  1
250400200529      * Define work field Audit/Request Title
250500200529     C                     MOVEL*BLANK    WUAURT 53
250600200529      * Define work field Underline
250700200529     C                     MOVEL*BLANK    WUBJNA 53
250800200529      * Define work field No. of Records
250900200529     C                     Z-ADD*ZERO     WUNORC  50
251000200529      * Define work field No. of Inserts
251100200529     C                     Z-ADD*ZERO     WUNOIN  50
251200200529      * Define work field No. of Amends
251300200529     C                     Z-ADD*ZERO     WUNOAM  50
251400200529      * Define work field No. of Deletes
251500200529     C                     Z-ADD*ZERO     WUNODL  50
251600200529      * Define work field Midas Run Date
251700200529     C                     MOVEL*BLANK    WUMRDT  7
251800200529      * Define work field Set Up Complete
251900200529     C                     MOVEL*BLANK    WUSUC   1
252000200529      * Define work field Multi-branching Indicator
252100200529     C                     MOVEL*BLANK    WUMBIN  1
252200200529      * Define work field User Report Title
252300200529     C                     MOVEL*BLANK    WUURPT 53
252400200529      * Obtain default message file.
252500200529     C           *NAMVAR   DEFN Y2MGFLA   ZADFMF 10
252600200529     C                     IN   ZADFMF
252700200529      * Define work field Spool file name
252800200529     C                     MOVEL*BLANK    WUSFNM 10
252900200529      * Define work field Spool file number
253000200529     C                     Z-ADD*ZERO     WUSFNB  60
253100200529      * Define work field ZSFILE error
253200200529     C/COPY WNCPYSRC,SD0010PC02
253300200529     C                     MOVEL*BLANK    WUZSER  1
253400200529     C                     MOVEL*BLANK    W0PFM   1
253500200529     C                     Z-ADD*ZERO     @$WRK   40
253600200529     C                     Z-ADD*ZERO     @$HDL   40
253700200529      * Adjust page length and overflow as necessary.
253800200529     C           @$PGL     SUB  2         W0PGL   40
253900200529     C           @$OFL     IFGE W0PGL
254000200529     C           W0PGL     SUB  2         W0OFL   40
254100200529     C                     ELSE
254200200529     C                     Z-ADD@$OFL     W0OFL
254300200529     C                     END
254400200529      *                                                                   CDL006
254500200529      ** Dataarea LDA                                                     CDL006
254600200529      *                                                                   CDL006
254700200529     C           *NAMVAR   DEFN           LDA                             CDL006
254800200529      * USER: Initialise program
254900200529      * Standard RPG Creation PAR - Standard Functions  *
255000200529      * Last Amend Box SD0010P - Client Details  *
255100200529      * Get Rundate - Rundate  *
255200200529     C           *NAMVAR   DEFN           RUNDAT
255300200529     C                     IN   RUNDAT
255400200529     C                     MOVE MRDT      ##MRDT           RUN DATE
255500200529     C                     MOVE MRDT      WUMRDT
255600200529     C                     MOVE RDNB      WURDNB           RUNDAY NO.
255700200529     C                     MOVE SUC       WUSUC            SET UP COMPLT
255800200529     C                     MOVE DFF       WUDFF            DTE FMT FLAG
255900200529     C                     MOVE MBIN      WUMBIN           MULTI BR. IND
256000200529      *                                                                   CDL006
256100200529      ** Prepare LDA                                                      CDL006
256200200529      *                                                                   CDL006
256300200529     C           *LOCK     IN   LDA                                       CDL006
256400200529     C                     MOVEL*BLANK    DBLOT                           CDL006
256500200529     C                     MOVEL'SD0010P' DBPGM                           CDL006
256600200529     C                     OUT  LDA                                       CDL006
256700200529     C*                                                                   S01413
256800200529     C** Access Modules File and check if Retail 3 is installed.          S01413
256900200529     C                     CALL 'AOMMODR0'                                S01413
257000200529     C                     PARM '*DBERR ' @RTCD   7                       S01413
257100200529     C                     PARM '*FIRST ' @OPTN   7                       S01413
257200200529     C           SDMMOD    PARM SDMMOD    DSFDY                           S01413
257300200529     C*                                                                   S01413
257400200529     C           BGNXST    IFEQ 'Y'                                       S01413
257500200529     C                     SETON                     50                   S01413
257600200529     C                     END                                            S01413
257700200529     C/COPY WNCPYSRC,SD0010PC03
257800200529     C*                                                                   S01413
257900200529      * Copyright Statement - Standard Functions  * copyright
258000200529      * Get Title
258100200529      * Get Bank Title - Bank Details  *
258200200529     C                     EXSR SCRVGN
258300200529     C*                                                                   S01408
258400200529     C/COPY WNCPYSRC,SD0010PCP6                                           S01408
258500200529     C*                                                                   S01408
258600200529      *                                                                                       CER001
258700200529      ** Determine if feature ULX012 (Guarantees and Collateral                               CER001
258800200529      ** Management enhancements) is installed                                                CER001
258900200529      *                                                                                       CER001
259000200529     C                     MOVE 'N'       ULX012  1                                           CER001
259100200529     C                     CALL 'AOSARDR0'                                                    CER001
259200200529     C                     PARM '       ' @RTCD   7                                           CER001
259300200529     C                     PARM '*VERIFY' @OPTN   7                                           CER001
259400200529     C                     PARM 'ULX012'  @SARD   6                                           CER001
259500200529     C           SCSARD    PARM SCSARD    DSSDY                                               CER001
259600200529      *                                                                                       CER001
259700200529     C           @RTCD     IFNE *BLANKS                                                       CER001
259800200529     C           @RTCD     ANDNE'*NRF   '                                                     CER001
259900200529     C           *LOCK     IN   LDA                                                           CER001
260000200529     C                     Z-ADD5         DBASE                                               CER001
260100200529     C                     MOVEL'SCSARDPD'DBFILE                                              CER001
260200200529     C                     MOVEL'ULX012'  DBKEY                                               CER001
260300200529     C                     OUT  LDA                                                           CER001
260400200529     C                     EXSR *PSSR                                                         CER001
260500200529     C                     ENDIF                                                              CER001
260600200529      *                                                                                       CER001
260700200529      ** If feature ULX012 is installed.                                                      CER001
260800200529      *                                                                                       CER001
260900200529     C           @RTCD     IFEQ *BLANKS                                                       CER001
261000200529     C                     MOVE 'Y'       ULX012                                              CER001
261100200529     C                     MOVE *ON       *IN60                                               CER001
261200200529     C                     MOVE *ON       *IN62                                               CER001
261300200529      *                                                                                       CER001
261400200529     C                     ENDIF                                                              CER001
261500200529      *                                                                                       CER001
261600200529      ** Determine if feature ULX008 is installed                                             CER001
261700200529      *                                                                                       CER001
261800200529     C                     MOVE 'N'       ULX008  1                                           CER001
261900200529     C                     CALL 'AOSARDR0'                                                    CER001
262000200529     C                     PARM '       ' @RTCD   7                                           CER001
262100200529     C                     PARM '*VERIFY' @OPTN   7                                           CER001
262200200529     C                     PARM 'ULX008'  @SARD   6                                           CER001
262300200529     C           SCSARD    PARM SCSARD    DSSDY                                               CER001
262400200529      *                                                                                       CER001
262500200529     C           @RTCD     IFNE *BLANKS                                                       CER001
262600200529     C           @RTCD     ANDNE'*NRF   '                                                     CER001
262700200529     C           *LOCK     IN   LDA                                                           CER001
262800200529     C                     Z-ADD5         DBASE                                               CER001
262900200529     C                     MOVEL'SCSARDPD'DBFILE                                              CER001
263000200529     C                     MOVEL'ULX008'  DBKEY                                               CER001
263100200529     C                     OUT  LDA                                                           CER001
263200200529     C                     EXSR *PSSR                                                         CER001
263300200529     C                     ENDIF                                                              CER001
263400200529      *                                                                                       CER001
263500200529      ** If feature ULX008 is installed.                                                      CER001
263600200529      *                                                                                       CER001
263700200529     C           @RTCD     IFEQ *BLANKS                                                       CER001
263800200529     C                     MOVE 'Y'       ULX008                                              CER001
263900200529     C                     MOVE *ON       *IN61                                               CER001
264000200529      *                                                                                       CER001
264100200529     C                     ENDIF                                                              CER001
264200200529      *                                                                                       CER001
264300200529      ** Determine if feature ULX048 is installed                                             CER001
264400200529      *                                                                                       CER001
264500200529     C                     MOVE 'N'       ULX048  1                                           CER001
264600200529     C                     MOVE *OFF      *IN63                                               CER001
264700200529     C                     CALL 'AOSARDR0'                                                    CER001
264800200529     C                     PARM *BLANKS   @RTCD   7                                           CER001
264900200529     C                     PARM '*VERIFY' @OPTN   7                                           CER001
265000200529     C                     PARM 'ULX048'  @SARD   6                                           CER001
265100200529     C           SCSARD    PARM SCSARD    DSSDY                                               CER001
265200200529      *                                                                                       CER001
265300200529     C           @RTCD     IFNE *BLANKS                                                       CER001
265400200529     C           @RTCD     ANDNE'*NRF   '                                                     CER001
265500200529     C           *LOCK     IN   LDA                                                           CER001
265600200529     C                     Z-ADD5         DBASE                                               CER001
265700200529     C                     MOVEL'SCSARDPD'DBFILE                                              CER001
265800200529     C                     MOVEL'ULX048'  DBKEY                                               CER001
265900200529     C                     OUT  LDA                                                           CER001
266000200529     C                     EXSR *PSSR                                                         CER001
266100200529     C                     ENDIF                                                              CER001
266200200529      *                                                                                       CER001
266300200529      ** If feature ULX048 is installed.                                                      CER001
266400200529      *                                                                                       CER001
266500200529     C           @RTCD     IFEQ *BLANKS                                                       CER001
266600200529     C                     MOVE 'Y'       ULX048                                              CER001
266700200529     C                     MOVE *ON       *IN63                                               CER001
266800200529     C                     ENDIF                                                              CER001
266900200529      *                                                                                       CER001
267000200529      ** Access Bank Details                                                                  CGL032
267100200529      *                                                                                       CGL032
267200200529     C                     CALL 'AOBANKR0'                                                    CGL032
267300200529     C                     PARM '*DBERR ' PRTCD   7                                           CGL032
267400200529     C                     PARM '*FIRST ' POPTN   7                                           CGL032
267500200529     C           SDBANK    PARM SDBANK    DSFDY                                               CGL032
267600200529      *                                                                                       CGL032
267700200529      ** DB Error Management                                                                  CGL032
267800200529      *                                                                                       CGL032
267900200529     C           PRTCD     IFNE *BLANK                                                        CGL032
268000200529     C           *LOCK     IN   LDA                                                           CGL032
268100200529     C                     Z-ADD003       DBASE            ************                       CGL032
268200200529     C                     MOVEL'SDBANKPD'DBFILE           * DBERR  03*                       CGL032
268300200529     C                     MOVELPOPTN     DBKEY            ************                       CGL032
268400200529     C                     OUT  LDA                                                           CGL032
268500200529     C                     EXSR *PSSR                                                         CGL032
268600200529     C                     ENDIF                                                              CGL032
268700200529     C*                                                                   CDL002
268800200529     C**  Access Switchable features file (FX Netting)                    CDL002
268900200529     C*                                                                   CDL002
269000200529     C                     CALL 'AOSARDR0'                                CDL002
269100200529     C                     PARM '       ' @RTCD                           CDL002
269200200529     C                     PARM '*VERIFY' @OPTN                           CDL002
269300200529     C                     PARM 'CDL002'  @SARD                           CDL002
269400200529     C           SCSARD    PARM SCSARD    DSFDY                           CDL002
269500200529      *                                                                   CDL002
269600200529     C           @RTCD     IFEQ *BLANK                                    CDL002
269700200529     C                     MOVE 'Y'       CDL002  1                       CDL002
269800200529     C                     MOVE *ON       *IN87                           CDL002
269900200529     C                     END                                            CDL002
270000200529      *                                                                   S01383
270100200529      ***  Access SAR details file to see if BRT SAR is installed.        S01383
270200200529      *                                                                   S01383
270300200529     C                     CALL 'AOSARDR0'                                S01383
270400200529     C                     PARM '       ' @RTCD   7                       S01383
270500200529     C                     PARM '*VERIFY' @OPTN   7                       S01383
270600200529     C                     PARM 'S01383'  @SARD   6                       S01383
270700200529      *                                                                   S01383
270800200529     C           @RTCD     IFEQ *BLANK                                    S01383
270900200529     C                     MOVE 'Y'       S01383  1                       S01383
271000200529     C                     SETON                     86                   S01383
271100200529     C                     END                                            S01383
271200200529      *                                                                   CRE007
271300200529      ** Access SAR details file to see if Base Rate Tax 2001 is ON.      CRE007
271400200529      *                                                                   CRE007
271500200529     C                     CALL 'AOSARDR0'                                CRE007
271600200529     C                     PARM '       ' @RTCD                           CRE007
271700200529     C                     PARM '*VERIFY' @OPTN                           CRE007
271800200529     C                     PARM 'CRE007'  @SARD                           CRE007
271900200529      *                                                                   CRE007
272000200529      ** If Base Rate Tax 2001 is switched ON output field                CRE007
272100200529      ** PSTR - Post 5/4/01 R105.                                         CRE007
272200200529      *                                                                   CRE007
272300200529     C           @RTCD     IFEQ *BLANKS                                   CRE007
272400200529     C                     MOVE *ON       *IN80                           CRE007
272500200529     C                     ENDIF                                          CRE007
272600200529     C*                                                                   S01383
272700200529     C/COPY WNCPYSRC,SD0010PC05
272800200529     C*
272900200529      *                                                                                       CER001
273000200529      ** Check Whether ULX043 is Present or not (Lux Returns)                                 CER001
273100200529      *                                                                                       CER001
273200200529     C                     MOVE 'N'       ULX043  1                                           CER001
273300200529     C           BGNWST    IFEQ 'Y'                                                           CER001
273400200529      *                                                                                       CER001
273500200529     C                     CALL 'AOSARDR0'                                                    CER001
273600200529     C                     PARM *BLANKS   @RTCD                                               CER001
273700200529     C                     PARM '*VERIFY' @OPTN                                               CER001
273800200529     C                     PARM 'ULX043'  @SARD                                               CER001
273900200529     C           SCSARD    PARM SCSARD    DSSDY                                               CER001
274000200529      *                                                                                       CER001
274100200529     C           @RTCD     IFNE *BLANKS                                                       CER001
274200200529     C           @RTCD     ANDNE'*NRF   '                                                     CER001
274300200529     C           *LOCK     IN   LDA                                                           CER001
274400200529     C                     Z-ADD5         DBASE                                               CER001
274500200529     C                     MOVEL'SCSARDPD'DBFILE                                              CER001
274600200529     C                     MOVEL'ULX043'  DBKEY                                               CER001
274700200529     C                     OUT  LDA                                                           CER001
274800200529     C                     EXSR *PSSR                                                         CER001
274900200529     C                     ENDIF                                                              CER001
275000200529      *                                                                                       CER001
275100200529     C           @RTCD     IFEQ *BLANK                                                        CER001
275200200529     C                     MOVE 'Y'       ULX043                                              CER001
275300200529     C                     ENDIF                                                              CER001
275400200529     C                     ENDIF                                                              CER001
275500200529      *                                                                                       CER001
275600200529     C* Access Switchable features file to see if Automatic Customer      S01421
275700200529     C* Deletion is installed.                                            S01421
275800200529     C*                                                                   S01421
275900200529     C                     CALL 'AOSARDR0'                                S01421
276000200529     C                     PARM '       ' RTCD1   7                       S01421
276100200529     C                     PARM '*VERIFY' RTCD2   7                       S01421
276200200529     C                     PARM 'S01424'  RTCD3   6                       S01421
276300200529     C*                                                                   S01421
276400200529     C           RTCD1     IFEQ *BLANK                                    S01421
276500200529     C                     MOVE *ON       *IN22                           S01421
276600200529     C                     END                                            S01421
276700200529     C*                                                                   S01421
276800200529     C* Access Switchable features file to see if Additional Customer     S01421
276900200529     C* Details is installed.                                             S01421
277000200529     C*                                                                   S01421
277100200529     C                     CALL 'AOSARDR0'                                S01421
277200200529     C                     PARM '       ' RTCDA   7                       S01421
277300200529     C                     PARM '*VERIFY' RTCDB   7                       S01421
277400200529     C                     PARM 'S01425'  RTCDC   6                       S01421
277500200529     C*                                                                   S01421
277600200529     C           RTCDA     IFEQ *BLANK                                    S01421
277700200529     C                     MOVE *ON       *IN23                           S01421
277800200529     C                     END                                            S01421
277900200529     C*
278000200529     C* Access Switchable features file to see if EMU User Defined        CEU014
278100200529     C* Correspondence is installed.                                      CEU014
278200200529     C*                                                                   CEU014
278300200529     C                     CALL 'AOSARDR0'                                CEU014
278400200529     C                     PARM '       ' RTCD1                           CEU014
278500200529     C                     PARM '*VERIFY' RTCD2                           CEU014
278600200529     C                     PARM 'CEU014'  RTCD3                           CEU014
278700200529     C*                                                                   CEU014
278800200529     C* 'Designated In Currency' is only printed if UDC module is on.     CEU014
278900200529     C*                                                                   CEU014
279000200529     C           RTCD1     IFEQ *BLANK                                    CEU014
279100200529     C           BGN1ST    ANDEQ'Y'                                       CEU014
279200200529     C                     MOVE *ON       *IN70                           CEU014
279300200529     C                     ENDIF                                          CEU014
279400200529      *                                                                   CDL006
279500200529      ** Access Switchable features file, Check if feature CDL006         CDL006
279600200529      ** is Switched on.                                                  CDL006
279700200529      *                                                                   CDL006
279800200529     C                     CALL 'AOSARDR0'                                CDL006
279900200529     C                     PARM *BLANKS   PRTCD   7                       CDL006
280000200529     C                     PARM '*VERIFY' POPTN   7                       CDL006
280100200529     C                     PARM 'CDL006'  PSARD   6                       CDL006
280200200529     C           SCSARD    PARM SCSARD    DSSDY                           CDL006
280300200529      *                                                                   CDL006
280400200529     C           PRTCD     IFNE *BLANK                                    CDL006
280500200529     C           PRTCD     ANDNE'*NRF '                                   CDL006
280600200529     C           *LOCK     IN   LDA                                       CDL006
280700200529     C                     Z-ADD001       DBASE            ***************CDL006
280800200529     C                     MOVEL'SCSARDPD'DBFILE           **DB ERROR 001*CDL006
280900200529     C                     MOVELPSARD     DBKEY            ***************CDL006
281000200529     C                     OUT  LDA                                       CDL006
281100200529     C                     EXSR *PSSR                                     CDL006
281200200529     C                     ENDIF                                          CDL006
281300200529      *                                                                   CDL006
281400200529      ** Exhibit printing of DL Fiduciary details if feature is           CDL006
281500200529      ** switched on.                                                     CDL006
281600200529      *                                                                   CDL006
281700200529     C           PRTCD     IFEQ *BLANK                                    CDL006
281800200529     C                     MOVE 'Y'       CDL006  1                       CDL006
281900200529     C                     MOVE '1'       *IN17                           CDL006
282000200529     C                     ENDIF                                          CDL006
282100200529      *                                                                   CDL008
282200200529      ** Access Switchable features file to check if CDL008 is on.        CDL008
282300200529      *                                                                   CDL008
282400200529     C                     CALL 'AOSARDR0'                                CDL008
282500200529     C                     PARM *BLANKS   PRTCD                           CDL008
282600200529     C                     PARM '*VERIFY' POPTN                           CDL008
282700200529     C                     PARM 'CDL008'  PSARD                           CDL008
282800200529     C           SCSARD    PARM SCSARD    DSSDY                           CDL008
282900200529      *                                                                   CDL008
283000200529     C           PRTCD     IFNE *BLANK                                    CDL008
283100200529     C           PRTCD     ANDNE'*NRF '                                   CDL008
283200200529     C           *LOCK     IN   LDA                                       CDL008
283300200529     C                     Z-ADD002       DBASE            ************** CDL008
283400200529     C                     MOVEL'SCSARDPD'DBFILE           * DB ERR 002 * CDL008
283500200529     C                     MOVEL'CDL008'  DBKEY            ************** CDL008
283600200529     C                     OUT  LDA                                       CDL008
283700200529     C                     EXSR *PSSR                                     CDL008
283800200529     C                     ENDIF                                          CDL008
283900200529      *                                                                   CDL008
284000200529     C           PRTCD     IFEQ *BLANK                                    CDL008
284100200529     C                     MOVE 'Y'       CDL008  1                       CDL008
284200200529     C                     MOVE *ON       *IN75                           CDL008
284300200529     C                     ELSE                                           CDL008
284400200529     C                     MOVE 'N'       CDL008                          CDL008
284500200529     C                     MOVE *OFF      *IN75                           CDL008
284600200529     C                     ENDIF                                          CDL008
284700200529      *                                                                   CSD007
284800200529      ** Access switchable features file to check if CSD007 is on         CSD007
284900200529      *                                                                   CSD007
285000200529     C                     CALL 'AOSARDR0'                                CSD007
285100200529     C                     PARM *BLANKS   PRTCD                           CSD007
285200200529     C                     PARM '*VERIFY' POPTN                           CSD007
285300200529     C                     PARM 'CSD007'  PSARD                           CSD007
285400200529     C           SCSARD    PARM SCSARD    DSSDY                           CSD007
285500200529      *                                                                   CSD007
285600200529     C           PRTCD     IFNE *BLANKS                                   CSD007
285700200529     C           PRTCD     ANDNE'*NRF   '                                 CSD007
285800200529     C           *LOCK     IN   LDA                                       CSD007
285900200529     C                     Z-ADD002       DBASE            ************** CSD007
286000200529     C                     MOVEL'SCSARDPD'DBFILE           * DBERROR 02 * CSD007
286100200529     C                     MOVELPSARD     DBKEY            ************** CSD007
286200200529     C                     OUT  LDA                                       CSD007
286300200529     C                     EXSR *PSSR                                     CSD007
286400200529     C                     ENDIF                                          CSD007
286500200529      *                                                                   CSD007
286600200529     C           PRTCD     IFEQ *BLANKS                                   CSD007
286700200529     C                     MOVE 'Y'       CSD007  1                       CSD007
286800200529     C                     ELSE                                           CSD007
286900200529     C                     MOVE 'N'       CSD007                          CSD007
287000200529     C                     ENDIF                                          CSD007
287100200529     C/COPY WNCPYSRC,SDH00579
287200200529      *                                                                                       CSW024
287300200529      ** Access Switchable features file, Check if feature CSW024                             CSW024
287400200529      ** is Switched on.                                                                      CSW024
287500200529      *                                                                                       CSW024
287600200529     C                     MOVE 'N'       CSW024  1                                           CSW024
287700200529     C                     CALL 'AOSARDR0'                                                    CSW024
287800200529     C                     PARM *BLANKS   PRTCD                                               CSW024
287900200529     C                     PARM '*VERIFY' POPTN                                               CSW024
288000200529     C                     PARM 'CSW024'  PSARD                                               CSW024
288100200529     C           SCSARD    PARM SCSARD    DSSDY                                               CSW024
288200200529      *                                                                                       CSW024
288300200529     C           PRTCD     IFNE *BLANK                                                        CSW024
288400200529     C           PRTCD     ANDNE'*NRF   '                                                     CSW024
288500200529     C           *LOCK     IN   LDA                                                           CSW024
288600200529     C                     Z-ADD003       DBASE                                               CSW024
288700200529     C                     MOVEL'SCSARDPD'DBFILE                                              CSW024
288800200529     C                     MOVELPSARD     DBKEY                                               CSW024
288900200529     C                     OUT  LDA                                                           CSW024
289000200529     C                     EXSR *PSSR                                                         CSW024
289100200529     C                     ELSE                                                               CSW024
289200200529     C           PRTCD     IFEQ *BLANK                                                        CSW024
289300200529     C                     MOVE 'Y'       CSW024                                              CSW024
289400200529     C                     MOVE *ON       *IN18                                               CSW024
289500200529     C                     ENDIF                                                              CSW024
289600200529     C                     ENDIF                                                              CSW024
289700200529      *                                                                                       CGP001
289800200529      ** Check if CGP001 is enabled.                                                          CGP001
289900200529      *                                                                                       CGP001
290000200529     C                     CALL 'AOSARDR0'                                                    CGP001
290100200529     C                     PARM *BLANKS   PRTCD   7                                           CGP001
290200200529     C                     PARM '*VERIFY' POPTN   7                                           CGP001
290300200529     C                     PARM 'CGP001'  PSARD   6                                           CGP001
290400200529     C           SCSARD    PARM *BLANKS   DSFDY                                               CGP001
290500200529      *                                                                                       CGP001
290600200529     C                     MOVE 'N'       CGP001  1                                           CGP001
290700200529     C                     MOVE *OFF      *IN68                                               CGP001
290800200529     C           PRTCD     IFEQ *BLANKS                                                       CGP001
290900200529     C                     MOVE 'Y'       CGP001                                              CGP001
291000200529     C                     MOVE *ON       *IN68                                               CGP001
291100200529      *                                                                                       CGP001
291200200529      ** Open the Global Processing Files.                                                    CGP001
291300200529      *                                                                                       CGP001
291400200529     C                     EXSR SRGPOF                                                        CGP001
291500200529      *                                                                                       CGP001
291600200529     C                     ELSE                                                               CGP001
291700200529      *                                                                                       CGP001
291800200529     C           PRTCD     IFNE '*NRF'                                                        CGP001
291900200529     C                     MOVEL'SCSARDPD'DBFILE                                              CGP001
292000200529     C                     MOVEL'CGP001'  DBKEY                                               CGP001
292100200529     C                     MOVEL'908'     DBASE                                               CGP001
292200200529     C                     MOVE *ON       *INU7                                               CGP001
292300200529     C                     MOVE *ON       *INU8                                               CGP001
292400200529     C                     MOVE *ON       *INLR                                               CGP001
292500200529     C                     EXSR *PSSR                                                         CGP001
292600200529     C                     ENDIF                                                              CGP001
292700200529      *                                                                                       CGP001
292800200529     C                     ENDIF                                                              CGP001
292900200529      *                                                                   CGL018
293000200529      ***  Determine if switchable feature CGL018 is activated            CGL018
293100200529      *                                                                   CGL018
293200200529     C                     CALL 'AOSARDR0'                                CGL018
293300200529     C                     PARM *BLANKS   PRTCD   7                       CGL018
293400200529     C                     PARM '*VERIFY' POPTN   7                       CGL018
293500200529     C                     PARM 'CGL018'  PSARD   6                       CGL018
293600200529     C           SCSARD    PARM SCSARD    DSFDY                           CGL018
293700200529      *                                                                   CGL018
293800200529     C           PRTCD     IFEQ *BLANK                                    CGL018
293900200529     C                     MOVE 'Y'       CGL018  1                       CGL018
294000200529     C                     SETON                     81                   CGL018
294100200529     C                     ELSE                                           CGL018
294200200529     C                     MOVE 'N'       CGL018                          CGL018
294300200529     C                     SETOF                     81                   CGL018
294400200529     C                     ENDIF                                          CGL018
294500200529      *                                                                                       CLE025
294600200529      ** Check if enhancement CLE025 (Multi-Option Facilities) is switched on                 CLE025
294700200529      *                                                                                       CLE025
294800200529     C                     CALL 'AOSARDR0'                                                    CLE025
294900200529     C                     PARM *BLANKS   PRTCD                                               CLE025
295000200529     C                     PARM '*VERIFY' POPTN                                               CLE025
295100200529     C                     PARM 'CLE025'  PSARD                                               CLE025
295200200529     C           SCSARD    PARM SCSARD    DSSDY                                               CLE025
295300200529      *                                                                                       CLE025
295400200529     C           PRTCD     IFNE *BLANKS                                                       CLE025
295500200529     C           PRTCD     ANDNE'*NRF   '                                                     CLE025
295600200529     C           *LOCK     IN   LDA                                                           CLE025
295700200529     C                     Z-ADD4         DBASE                                               CLE025
295800200529     C                     MOVEL'SCSARDPD'DBFILE                                              CLE025
295900200529     C                     MOVEL'CLE025'  DBKEY                                               CLE025
296000200529     C                     OUT  LDA                                                           CLE025
296100200529     C                     EXSR *PSSR                                                         CLE025
296200200529     C                     ENDIF                                                              CLE025
296300200529      *                                                                                       CLE025
296400200529     C           PRTCD     IFEQ *BLANKS                                                       CLE025
296500200529     C                     MOVE *ON       *IN25                                               CLE025
296600200529     C                     MOVE 'Y'       CLE025  1                                           CLE025
296700200529     C                     ELSE                                                               CLE025
296800200529     C                     MOVE 'N'       CLE025  1                                           CLE025
296900200529     C                     ENDIF                                                              CLE025
297000200529      *                                                                                       CFX001
297100200529      ** Check if enhancement CFX001 is installed                                             CFX001
297200200529      *                                                                                       CFX001
297300200529     C                     CALL 'AOSARDR0'                                                    CFX001
297400200529     C                     PARM *BLANKS   PRTCD                                               CFX001
297500200529     C                     PARM '*VERIFY' POPTN                                               CFX001
297600200529     C                     PARM 'CFX001'  PSARD                                               CFX001
297700200529     C           SCSARD    PARM SCSARD    DSSDY                                               CFX001
297800200529      *                                                                                       CFX001
297900200529     C           PRTCD     IFNE *BLANKS                                                       CFX001
298000200529     C           PRTCD     ANDNE'*NRF   '                                                     CFX001
298100200529     C           *LOCK     IN   LDA                                                           CFX001
298200200529     C                     Z-ADD5         DBASE                                               CFX001
298300200529     C                     MOVEL'SCSARDPD'DBFILE                                              CFX001
298400200529     C                     MOVEL'CFX001'  DBKEY                                               CFX001
298500200529     C                     OUT  LDA                                                           CFX001
298600200529     C                     EXSR *PSSR                                                         CFX001
298700200529     C                     ENDIF                                                              CFX001
298800200529      *                                                                                       CFX001
298900200529     C           PRTCD     IFEQ *BLANKS                                                       CFX001
299000200529     C                     MOVE 'Y'       CFX001  1                                           CFX001
299100200529     C                     MOVE *ON       *IN25                                               CFX001
299200200529     C                     ELSE                                                               CFX001
299300200529     C                     MOVE 'N'       CFX001  1                                           CFX001
299400200529     C                     ENDIF                                                              CFX001
299500200529      *                                                                                       CFX001
299600200529      *                                                                                       CSD025
299700200529      ** Check if enhancement CSD025 is installed                                             CSD025
299800200529      *                                                                                       CSD025
299900200529     C                     CALL 'AOSARDR0'                                                    CSD025
300000200529     C                     PARM *BLANKS   PRTCD                                               CSD025
300100200529     C                     PARM '*VERIFY' POPTN                                               CSD025
300200200529     C                     PARM 'CSD025'  PSARD                                               CSD025
300300200529     C           SCSARD    PARM SCSARD    DSSDY                                               CSD025
300400200529      *                                                                                       CSD025
300500200529     C           PRTCD     IFNE *BLANKS                                                       CSD025
300600200529     C           PRTCD     ANDNE'*NRF   '                                                     CSD025
300700200529     C           *LOCK     IN   LDA                                                           CSD025
300800200529     C                     Z-ADD5         DBASE                                               CSD025
300900200529     C                     MOVEL'SCSARDPD'DBFILE                                              CSD025
301000200529     C                     MOVEL'CSD025'  DBKEY                                               CSD025
301100200529     C                     OUT  LDA                                                           CSD025
301200200529     C                     EXSR *PSSR                                                         CSD025
301300200529     C                     ENDIF                                                              CSD025
301400200529      *                                                                                       CSD025
301500200529     C           PRTCD     IFEQ *BLANKS                                                       CSD025
301600200529     C                     MOVE 'Y'       CSD025  1                                           CSD025
301700200529     C                     MOVE *ON       *IN72                                               CSD025
301800200529     C                     ELSE                                                               CSD025
301900200529     C                     MOVE 'N'       CSD025  1                                           CSD025
302000200529     C                     MOVE *OFF      *IN72                                               CSD025
302100200529     C                     ENDIF                                                              CSD025
302200200529      *                                                                                       CSD025
302300200529      ** Check if enhancement ULX004 is installed                                             CER001
302400200529      *                                                                                       CER001
302500200529     C                     CALL 'AOSARDR0'                                                    CER001
302600200529     C                     PARM *BLANKS   PRTCD                                               CER001
302700200529     C                     PARM '*VERIFY' POPTN                                               CER001
302800200529     C                     PARM 'ULX004'  PSARD                                               CER001
302900200529     C           SCSARD    PARM SCSARD    DSSDY                                               CER001
303000200529      *                                                                                       CER001
303100200529     C           PRTCD     IFNE *BLANKS                                                       CER001
303200200529     C           PRTCD     ANDNE'*NRF   '                                                     CER001
303300200529     C           *LOCK     IN   LDA                                                           CER001
303400200529     C                     Z-ADD5         DBASE                                               CER001
303500200529     C                     MOVEL'SCSARDPD'DBFILE                                              CER001
303600200529     C                     MOVEL'ULX004'  DBKEY                                               CER001
303700200529     C                     OUT  LDA                                                           CER001
303800200529     C                     EXSR *PSSR                                                         CER001
303900200529     C                     ENDIF                                                              CER001
304000200529      *                                                                                       CER001
304100200529     C           PRTCD     IFEQ *BLANKS                                                       CER001
304200200529     C                     MOVE 'Y'       ULX004  1                                           CER001
304300200529     C                     MOVE *ON       *IN20                                               248936
304400200529     C                     ELSE                                                               CER001
304500200529     C                     MOVE 'N'       ULX004  1                                           CER001
304600200529     C                     ENDIF                                                              CER001
304700200529      *                                                                                       CSD025
304800200529      ** Check if enhancement CSW037A is installed                        CSW037A
304900200529      *                                                                   CSW037A
305000200529     C                     CALL 'AOSARDR0'                                CSW037A
305100200529     C                     PARM *BLANKS   PRTCD                           CSW037A
305200200529     C                     PARM '*VERIFY' POPTN                           CSW037A
305300200529     C                     PARM 'CSW037'  PSARD                           CSW037A
305400200529     C           SCSARD    PARM SCSARD    DSSDY                           CSW037A
305500200529      *                                                                   CSW037A
305600200529     C           PRTCD     IFNE *BLANKS                                   CSW037A
305700200529     C           PRTCD     ANDNE'*NRF   '                                 CSW037A
305800200529     C           *LOCK     IN   LDA                                       CSW037A
305900200529     C                     Z-ADD5         DBASE                           CSW037A
306000200529     C                     MOVEL'SCSARDPD'DBFILE                          CSW037A
306100200529     C                     MOVEL'CSW037'  DBKEY                           CSW037A
306200200529     C                     OUT  LDA                                       CSW037A
306300200529     C                     EXSR *PSSR                                     CSW037A
306400200529     C                     ENDIF                                          CSW037A
306500200529      *                                                                   CSW037A
306600200529     C           PRTCD     IFEQ *BLANKS                                   CSW037A
306700200529     C                     MOVE 'Y'       CSW037  1                       CSW037A
306800200529     C                     MOVE *ON       *IN73                           CSW037A
306900200529     C                     ELSE                                           CSW037A
307000200529     C                     MOVE 'N'       CSW037                          CSW037A
307100200529     C                     MOVE *OFF      *IN73                           CSW037A
307200200529     C                     ENDIF                                          CSW037A
307300200529      *                                                                   CSW037A
307400200529      ** Access switchable features file to check if CSD029 is on                             CSD029
307500200529      *                                                                                       CSD029
307600200529     C                     CALL 'AOSARDR0'                                                    CSD029
307700200529     C                     PARM *BLANKS   PRTCD                                               CSD029
307800200529     C                     PARM '*VERIFY' POPTN                                               CSD029
307900200529     C                     PARM 'CSD029'  PSARD                                               CSD029
308000200529     C           SCSARD    PARM SCSARD    DSSDY                                               CSD029
308100200529      *                                                                                       CSD029
308200200529     C           PRTCD     IFEQ *BLANKS                                                       CSD029
308300200529     C                     MOVE 'Y'       CSD029  1                                           CSD029
308400200529     C                     ELSE                                                               CSD029
308500200529     C                     MOVE 'N'       CSD029                                              CSD029
308600200529     C                     ENDIF                                                              CSD029
308700200529      ** Access Switchable features file to see if Automatic Exchange                         CGL032
308800200529      ** of Information CGL032 is installed.                                                  CGL032
308900200529      *                                                                                       CGL032
309000200529     C                     CALL 'AOSARDR0'                                                    CGL032
309100200529     C                     PARM '       ' PRTCD                                               CGL032
309200200529     C                     PARM '*VERIFY' POPTN                                               CGL032
309300200529     C                     PARM 'CGL032'  PSARD                                               CGL032
309400200529     C           SCSARD    PARM SCSARD    DSSDY                                               CGL032
309500200529      *                                                                                       CGL032
309600200529      ** DB Error Management.                                                                 CGL032
309700200529      *                                                                                       CGL032
309800200529     C           PRTCD     IFNE *BLANKS                                                       CGL032
309900200529     C           PRTCD     ANDNE'*NRF   '                                                     CGL032
310000200529     C           *LOCK     IN   LDA                                                           CGL032
310100200529     C                     Z-ADD007       DBASE            **************                     CGL032
310200200529     C                     MOVEL'SCSARDPD'DBFILE           * DBERROR 06 *                     CGL032
310300200529     C                     MOVELPSARD     DBKEY            **************                     CGL032
310400200529     C                     OUT  LDA                                                           CGL032
310500200529     C                     EXSR *PSSR                                                         CGL032
310600200529     C                     ENDIF                                                              CGL032
310700200529      *                                                                                       CGL032
310800200529     C           PRTCD     IFEQ *BLANKS                                                       CGL032
310900200529     C                     MOVE 'Y'       CGL032  1                                           CGL032
311000200529     C                     ELSE                                                               CGL032
311100200529     C                     MOVE 'N'       CGL032                                              CGL032
311200200529     C                     ENDIF                                                              CGL032
311300200529      *                                                                                       CGL032
311301200618      ** Check CGL031 feature                                                                248936B
311302200618      *                                                                                      248936B
311303200618     C                     CALL 'AOSARDR0'                                                   248936B
311304200618     C                     PARM '       ' PRTCD                                              248936B
311305200618     C                     PARM '*VERIFY' POPTN                                              248936B
311306200618     C                     PARM 'CGL031'  PSARD                                              248936B
311307200618     C           SCSARD    PARM SCSARD    DSSDY                                              248936B
311308200618      *                                                                                      248936B
311309200618      ** DB Error Management.                                                                248936B
311310200618      *                                                                                      248936B
311311200618     C                     MOVEL'N'       CGL031  1                                          248936B
311312200618     C           PRTCD     IFNE *BLANKS                                                      248936B
311313200618     C           PRTCD     IFNE '*NRF   '                                                    248936B
311314200618     C           *LOCK     IN   LDA                                                          248936B
311315200618     C                     Z-ADD008       DBASE            **************                    248936B
311316200618     C                     MOVEL'SCSARDPD'DBFILE           * DBERROR 08 *                    248936B
311317200618     C                     MOVELPSARD     DBKEY            **************                    248936B
311318200618     C                     OUT  LDA                                                          248936B
311319200618     C                     EXSR *PSSR                                                        248936B
311320200618     C                     ENDIF                                                             248936B
311321200618     C                     ELSE                                                              248936B
311322200618     C                     MOVEL'Y'       CGL031                                             248936B
311323200618     C                     MOVE '1'       *IN92                                              248936B
311324200618     C                     ENDIF                                                             248936B
311325200618      *                                                                                      248936B
311400200529      ** Check CSW207 feature                                                                 CSW207
311500200529     C                     CALL 'SWIF2007'                                                    CSW207
311600200529     C                     PARM '       ' PRTCD                                               CSW207
311700200529     C********** PRTCD     IFEQ 'CSW207'                                             CSW207 BUG14933
311800200529     C           PRTCD     IFEQ 'CSW2007'                                                   BUG14933
311900200529     C                     MOVEL'Y'       CSW207  1                                           CSW207
312000200529     C                     ELSE                                                               CSW207
312100200529     C                     MOVEL'N'       CSW207                                              CSW207
312200200529     C                     ENDIF                                                              CSW207
312300200529      ** Check CGL031 feature                                                                 CSW207
312400200529     C                     CALL 'AOSARDR0'                                                    CSW207
312500200529     C                     PARM '       ' PRTCD                                               CSW207
312600200529     C                     PARM '*VERIFY' POPTN                                               CSW207
312700200529     C                     PARM 'CGL031'  PSARD                                               CSW207
312800200529     C           SCSARD    PARM SCSARD    DSSDY                                               CSW207
312900200529      *                                                                                       CSW207
313000200529      ** DB Error Management.                                                                 CSW207
313100200529      *                                                                                       CSW207
313200200529     C                     MOVEL'N'       CGL031  1                                           CSW207
313300200529     C           PRTCD     IFNE *BLANKS                                                       CSW207
313400200529     C           PRTCD     ANDNE'*NRF   '                                                     CSW207
313500200529     C           *LOCK     IN   LDA                                                           CSW207
313600200529     C                     Z-ADD008       DBASE            **************                     CSW207
313700200529     C                     MOVEL'SCSARDPD'DBFILE           * DBERROR 08 *                     CSW207
313800200529     C                     MOVELPSARD     DBKEY            **************                     CSW207
313900200529     C                     OUT  LDA                                                           CSW207
314000200529     C                     EXSR *PSSR                                                         CSW207
314100200529     C                     ELSE                                                               CSW207
314200200529     C                     MOVEL'Y'       CGL031                                              CSW207
314300200529     C                     ENDIF                                                              CSW207
314400200529      *                                                                                       CSW207
314500200529     C           CSW207    IFEQ 'Y'                                                           CSW207
314600200529     C                     SETON                     35                                       CSW207
314700200529     C                     ELSE                                                               CSW207
314800200529     C                     SETOF                     35                                       CSW207
314900200529     C                     ENDIF                                                              CSW207
315000200529      *                                                                                       CSW207
315100200529     C           CGL031    IFEQ 'Y'                                                           CSW207
315200200529     C           CGL032    ANDEQ'Y'                                                           CSW207
315300200529     C                     SETON                     36                                       CSW207
315400200529     C                     ELSE                                                               CSW207
315500200529     C                     SETOF                     36                                       CSW207
315600200529     C                     ENDIF                                                              CSW207
315700200529      *                                                                                      CER034A
315800200529      ** Access switchable features file to check if CER034 is on                            CER034A
315900200529      *                                                                                      CER034A
316000200529     C                     CALL 'AOSARDR0'                                                   CER034A
316100200529     C                     PARM *BLANKS   PRTCD                                              CER034A
316200200529     C                     PARM '*VERIFY' POPTN                                              CER034A
316300200529     C                     PARM 'CER034'  PSARD                                              CER034A
316400200529     C           SCSARD    PARM SCSARD    DSSDY                                              CER034A
316500200529      *                                                                                      CER034A
316600200529     C           PRTCD     IFEQ *BLANKS                                                      CER034A
316700200529     C                     MOVE 'Y'       CER034  1                                          CER034A
316800200529     C                     ELSE                                                              CER034A
316900200529     C                     MOVE 'N'       CER034                                             CER034A
317000200529     C                     ENDIF                                                             CER034A
317100200529      *                                                                                      CER034A
317200200529      ** Access switchable features file to check if CER038 is on                            CER034A
317300200529      *                                                                                      CER034A
317400200529     C                     CALL 'AOSARDR0'                                                   CER034A
317500200529     C                     PARM *BLANKS   PRTCD                                              CER034A
317600200529     C                     PARM '*VERIFY' POPTN                                              CER034A
317700200529     C                     PARM 'CER038'  PSARD                                              CER034A
317800200529     C           SCSARD    PARM SCSARD    DSSDY                                              CER034A
317900200529      *                                                                                      CER034A
318000200529     C           PRTCD     IFEQ *BLANKS                                                      CER034A
318100200529     C                     MOVE 'Y'       CER038  1                                          CER034A
318200200529     C                     ELSE                                                              CER034A
318300200529     C                     MOVE 'N'       CER038                                             CER034A
318400200529     C                     ENDIF                                                             CER034A
318500200529      *                                                                                      CER034A
318600200529      ** Access switchable features file to check if CER041 is on                            CER034A
318700200529      *                                                                                      CER034A
318800200529     C                     CALL 'AOSARDR0'                                                   CER034A
318900200529     C                     PARM *BLANKS   PRTCD                                              CER034A
319000200529     C                     PARM '*VERIFY' POPTN                                              CER034A
319100200529     C                     PARM 'CER041'  PSARD                                              CER034A
319200200529     C           SCSARD    PARM SCSARD    DSSDY                                              CER034A
319300200529      *                                                                                      CER034A
319400200529     C           PRTCD     IFEQ *BLANKS                                                      CER034A
319500200529     C                     MOVE 'Y'       CER041  1                                          CER034A
319600200529     C                     ELSE                                                              CER034A
319700200529     C                     MOVE 'N'       CER041                                             CER034A
319800200529     C                     ENDIF                                                             CER034A
319900200529      *                                                                                      CER034A
320000200529      ** Access switchable features file to check if CER047 is on                            CER034A
320100200529      *                                                                                      CER034A
320200200529     C                     CALL 'AOSARDR0'                                                   CER034A
320300200529     C                     PARM *BLANKS   PRTCD                                              CER034A
320400200529     C                     PARM '*VERIFY' POPTN                                              CER034A
320500200529     C                     PARM 'CER047'  PSARD                                              CER034A
320600200529     C           SCSARD    PARM SCSARD    DSSDY                                              CER034A
320700200529      *                                                                                      CER034A
320800200529     C           PRTCD     IFEQ *BLANKS                                                      CER034A
320900200529     C                     MOVE 'Y'       CER047  1                                          CER034A
321000200529     C                     ELSE                                                              CER034A
321100200529     C                     MOVE 'N'       CER047                                             CER034A
321200200529     C                     ENDIF                                                             CER034A
321300200529      *                                                                                      CER034A
321400200529      ** Access switchable features file to check if CER048 is on                            CER034A
321500200529      *                                                                                      CER034A
321600200529     C                     CALL 'AOSARDR0'                                                   CER034A
321700200529     C                     PARM *BLANKS   PRTCD                                              CER034A
321800200529     C                     PARM '*VERIFY' POPTN                                              CER034A
321900200529     C                     PARM 'CER048'  PSARD                                              CER034A
322000200529     C           SCSARD    PARM SCSARD    DSSDY                                              CER034A
322100200529      *                                                                                      CER034A
322200200529     C           PRTCD     IFEQ *BLANKS                                                      CER034A
322300200529     C                     MOVE 'Y'       CER048  1                                          CER034A
322400200529     C                     ELSE                                                              CER034A
322500200529     C                     MOVE 'N'       CER048                                             CER034A
322600200529     C                     ENDIF                                                             CER034A
322700200529      *                                                                                       CER054
322800200529      ** Access switchable features file to check if CER054 is on                             CER054
322900200529      *                                                                                       CER054
323000200529     C                     CALL 'AOSARDR0'                                                    CER054
323100200529     C                     PARM *BLANKS   PRTCD                                               CER054
323200200529     C                     PARM '*VERIFY' POPTN                                               CER054
323300200529     C                     PARM 'CER054'  PSARD                                               CER054
323400200529     C           SCSARD    PARM SCSARD    DSSDY                                               CER054
323500200529      *                                                                                       CER054
323600200529     C           PRTCD     IFEQ *BLANKS                                                       CER054
323700200529     C                     MOVE 'Y'       CER054  1                                           CER054
323800200529     C                     ELSE                                                               CER054
323900200529      *                                                                                       CER054
324000200529      ** DB Error Management.                                                                 CER054
324100200529      *                                                                                       CER054
324200200529     C                     MOVEL'N'       CER054                                              CER054
324300200529     C           PRTCD     IFNE *BLANKS                                                       CER054
324400200529     C           PRTCD     ANDNE'*NRF   '                                                     CER054
324500200529     C           *LOCK     IN   LDA                                                           CER054
324600200529     C                     Z-ADD009       DBASE                                               CER054
324700200529     C                     MOVEL'SCSARDPD'DBFILE                                              CER054
324800200529     C                     MOVELPSARD     DBKEY                                               CER054
324900200529     C                     OUT  LDA                                                           CER054
325000200529     C                     EXSR *PSSR                                                         CER054
325100200529     C                     ENDIF                                                              CER054
325200200529      *                                                                                       CER054
325300200529     C                     ENDIF                                                              CER054
325400200529      *                                                                                      CER034A
325500200529      ** Access switchable features file to check if CER045 is on                             CER045
325600200529      *                                                                                       CER045
325700200529     C                     CALL 'AOSARDR0'                                                    CER045
325800200529     C                     PARM *BLANKS   PRTCD                                               CER045
325900200529     C                     PARM '*VERIFY' POPTN                                               CER045
326000200529     C                     PARM 'CER045'  PSARD                                               CER045
326100200529     C           SCSARD    PARM SCSARD    DSSDY                                               CER045
326200200529      *                                                                                       CER045
326300200529     C           PRTCD     IFEQ *BLANKS                                                       CER045
326400200529     C                     MOVE 'Y'       CER045  1                                           CER045
326500200529     C                     ELSE                                                               CER045
326600200529     C                     MOVE 'N'       CER045                                              CER045
326700200529     C                     ENDIF                                                              CER045
326800200529      *                                                                                       CER045
326900200529      ** Set Display Indicators                                                              CER034A
327000200529      *                                                                                      CER034A
327100200529     C           CER034    IFEQ 'Y'                                                          CER034A
327200200529     C                     MOVE *ON       *IN51                                              CER034A
327300200529     C                     ELSE                                                              CER034A
327400200529     C                     MOVE *OFF      *IN51                                              CER034A
327500200529     C                     ENDIF                                                             CER034A
327600200529      *                                                                                      CER034A
327700200529     C           CER038    IFEQ 'Y'                                                          CER034A
327800200529     C                     MOVE *ON       *IN52                                              CER034A
327900200529     C                     ELSE                                                              CER034A
328000200529     C                     MOVE *OFF      *IN52                                              CER034A
328100200529     C                     ENDIF                                                             CER034A
328200200529      *                                                                                      CER034A
328300200529     C           CER041    IFEQ 'Y'                                                          CER034A
328400200529     C                     MOVE *ON       *IN53                                              CER034A
328500200529     C                     ELSE                                                              CER034A
328600200529     C                     MOVE *OFF      *IN53                                              CER034A
328700200529     C                     ENDIF                                                             CER034A
328800200529      *                                                                                      CER034A
328900200529     C           CER047    IFEQ 'Y'                                                          CER034A
329000200529     C                     MOVE *ON       *IN56                                              CER034A
329100200529     C                     ELSE                                                              CER034A
329200200529     C                     MOVE *OFF      *IN56                                              CER034A
329300200529     C                     ENDIF                                                             CER034A
329400200529      *                                                                                      CER034A
329500200529     C           CER048    IFEQ 'Y'                                                          CER034A
329600200529     C                     MOVE *ON       *IN57                                              CER034A
329700200529     C                     ELSE                                                              CER034A
329800200529     C                     MOVE *OFF      *IN57                                              CER034A
329900200529     C                     ENDIF                                                             CER034A
330000200529      *                                                                                       CER054
330100200529     C           CER054    IFEQ 'Y'                                                           CER054
330200200529     C                     MOVE *ON       *IN58                                               CER054
330300200529     C                     ELSE                                                               CER054
330400200529     C                     MOVE *OFF      *IN58                                               CER054
330500200529     C                     ENDIF                                                              CER054
330600200529      *                                                                                       CER045
330700200529     C           CER045    IFEQ 'Y'                                                           CER045
330800200529     C                     MOVE *ON       *IN59                                               CER045
330900200529     C                     ELSE                                                               CER045
331000200529     C                     MOVE *OFF      *IN59                                               CER045
331100200529     C                     ENDIF                                                              CER045
331200200529      *                                                                                      CER034A
331300200529      ** Check if SWIFT Changes 2013 (CSW213) is installed                                    CSW213
331400200529      *                                                                                       CSW213
331500200529     C                     MOVE 'N'       CSW213  1                                           CSW213
331600200529     C                     MOVE *OFF      *IN37                                               CSW213
331700200529      *                                                                                       CSW213
331800200529     C                     CALL 'SWIF2013'                                                    CSW213
331900200529     C                     PARM *BLANKS   PRTCD                                               CSW213
332000200529      *                                                                                       CSW213
332100200529     C           PRTCD     IFEQ 'CSW2013'                                                     CSW213
332200200529     C                     MOVE 'Y'       CSW213                                              CSW213
332300200529     C                     MOVE *ON       *IN37                                               CSW213
332400200529     C                     ENDIF                                                              CSW213
332500200529      *                                                                                       CSW213
332600200529      ** Check if feature CFT050 is installed                                                 CSW213
332700200529      *                                                                                       CSW213
332800200529     C                     MOVE 'N'       CFT050  1                                           CSW213
332900200529     C                     MOVE *OFF      *IN38                                               CSW213
333000200529      *                                                                                       CSW213
333100200529     C                     CALL 'AOSARDR0'                                                    CSW213
333200200529     C                     PARM *BLANKS   PRTCD                                               CSW213
333300200529     C                     PARM '*VERIFY' POPTN                                               CSW213
333400200529     C                     PARM 'CFT050'  PSARD                                               CSW213
333500200529     C           SCSARD    PARM SCSARD    DSSDY                                               CSW213
333600200529      *                                                                                       CSW213
333700200529     C           PRTCD     IFEQ *BLANKS                                                       CSW213
333800200529     C                     MOVE 'Y'       CFT050                                              CSW213
333900200529     C                     MOVE *ON       *IN38                                               CSW213
334000200529     C                     ENDIF                                                              CSW213
334100200529      *                                                                                       CGL177
334200200529      ** Access Switchable features file to see if CRS Reporting is installed.                CGL177
334300200529      *                                                                                       CGL177
334400200529     C                     CALL 'AOSARDR0'                                                    CGL177
334500200529     C                     PARM '       ' PRTCD                                               CGL177
334600200529     C                     PARM '*VERIFY' POPTN                                               CGL177
334700200529     C                     PARM 'CGL157'  PSARD                                               CGL177
334800200529     C           SCSARD    PARM SCSARD    DSSDY                                               CGL177
334900200529      *                                                                                       CGL177
335000200529      ** DB Error Management.                                                                 CGL177
335100200529      *                                                                                       CGL177
335200200529     C           PRTCD     IFNE *BLANKS                                                       CGL177
335300200529     C           PRTCD     ANDNE'*NRF   '                                                     CGL177
335400200529     C           *LOCK     IN   LDA                                                           CGL177
335500200529     C                     Z-ADD009       DBASE            **************                     CGL177
335600200529     C                     MOVEL'SCSARDPD'DBFILE           * DBERROR 09 *                     CGL177
335700200529     C                     MOVELPSARD     DBKEY            **************                     CGL177
335800200529     C                     OUT  LDA                                                           CGL177
335900200529     C                     EXSR *PSSR                                                         CGL177
336000200529     C                     ENDIF                                                              CGL177
336100200529      *                                                                                       CGL177
336200200529     C           PRTCD     IFEQ *BLANKS                                                       CGL177
336300200529     C                     MOVE 'Y'       CGL157  1                                           CGL177
336400200529     C***                  MOVE '1'       *IN20                                               CGL177
336500200529     C                     ELSE                                                               CGL177
336600200529     C                     MOVE 'N'       CGL157                                              CGL177
336700200529     C***                  MOVE '0'       *IN20                                               CGL177
336800200529     C                     ENDIF                                                              CGL177
336900200529      *                                                                                       CER073
337000200529      ** Access switchable features file to check if CER073 is on                             CER073
337100200529      *                                                                                       CER073
337200200529     C                     CALL 'AOSARDR0'                                                    CER073
337300200529     C                     PARM *BLANKS   PRTCD                                               CER073
337400200529     C                     PARM '*VERIFY' POPTN                                               CER073
337500200529     C                     PARM 'CER073'  PSARD                                               CER073
337600200529     C           SCSARD    PARM SCSARD    DSSDY                                               CER073
337700200529      *                                                                                       CER073
337800200529     C           PRTCD     IFEQ *BLANKS                                                       CER073
337900200529     C                     MOVE 'Y'       CER073  1                                           CER073
338000200529     C                     ELSE                                                               CER073
338100200529     C                     MOVE 'N'       CER073                                              CER073
338200200529     C                     ENDIF                                                              CER073
338300200529      *                                                                                       CER073
338400200529     C           CER073    IFEQ 'Y'                                                           CER073
338500200529     C                     MOVE '1'       *IN64                                               CER073
338600200529     C                     ELSE                                                               CER073
338700200529     C                     MOVE '0'       *IN64                                               CER073
338800200529     C                     ENDIF                                                              CER073
338900200529      *                                                                                       CSW213
339000200529      ** Access switchable features file to check if CER050 is on                             CER050
339100200529      *                                                                                       CER050
339200200529     C                     CALL 'AOSARDR0'                                                    CER050
339300200529     C                     PARM *BLANKS   PRTCD                                               CER050
339400200529     C                     PARM '*VERIFY' POPTN                                               CER050
339500200529     C                     PARM 'CER050'  PSARD                                               CER050
339600200529     C           SCSARD    PARM SCSARD    DSSDY                                               CER050
339700200529      *                                                                                       CER050
339800200529     C           PRTCD     IFEQ *BLANKS                                                       CER050
339900200529     C                     MOVE 'Y'       CER050  1                                           CER050
340000200529     C                     MOVE *ON       *IN20                                               CER050
340100200529     C                     ELSE                                                               CER050
340200200529     C                     MOVE 'N'       CER050                                              CER050
340300200529     C                     MOVE *OFF      *IN20                                               CER050
340400200529     C                     ENDIF                                                              CER050
340500200529      *                                                                                       CER050
340600200529     C/COPY WNCPYSRC,SD0010PC33
340700200529     C*                                                                   CEU014
340800200529      * Move title to header - *Standard header/footer  *
340900200529     C* 7.10.89 Missing Source - Inserted During Incorporation            S01216
341000200529     C* Move User Report Title into Header Field in DDS for PRTF          S01216
341100200529     C*                                                                   S01216
341200200529     C*********************MOVE #IURPT    ##AGNA                   S01216 S01229
341300200529     C                     MOVE WUURPT    ##URPT                   S01216 S01229
341400200529      * Get Narrative Title - Narrative Codes  *
341500200529     C           *IN99     IFEQ '1'
341600200529     C                     MOVE 1         UIND    10
341700200529     C                     SETOF                         99
341800200529     C                     ELSE
341900200529     C                     MOVE 0         UIND
342000200529     C                     END
342100200529      *
342200200529      ** CALCULATE END OF TEXT POINT
342300200529     C                     Z-ADD1         U       20
342400200529     C*********************MOVEA#IBINA    UAR,U
342500200529     C                     MOVEA@CN,13    UAR,U
342600200529     C/COPY WNCPYSRC,SD0010PC36
342700200529     C*
342800200529     C           *IN99     DOWEQ'0'
342900200529     C           ' '       LOKUPUAR,U                    99
343000200529     C                     ADD  1         U
343100200529     C           UAR,U     COMP ' '                      99
343200200529     C                     END
343300200529      *
343400200529     C**
343500200529     C*
343600200529     C*          P1LSST    IFEQ 'A'                                       S01216
343700200529     C***********P1NEST    IFEQ 'A'                                S01216 S01117
343800200529     C           P1ARSI    IFEQ 'A'                                       S01117
343900200529     C*********************MOVELUARRAY,1  UTEMP  26                       LN0536
344000200529     C                     MOVELUARRAY,1  UTEMP  53                       LN0536
344100200529     C                     MOVEAUTEMP     UAR,U
344200200529     C                     ADD  26        U
344300200529     C                     ELSE
344400200529      *
344500200529     C                     MOVELUARRAY,2  UTEMP                           LN0536
344600200529     C*********************MOVEAUARRAY,2  UAR,U            * IF A THIRD   LN0536
344700200529     C                     MOVEAUTEMP     UAR,U            * IF A THIRD   LN0536
344800200529     C                     ADD  7         U                OPTION TO ARRAY
344900200529     C                     END                             IS ADDED A
345000200529      *                                                    TEMP STORAGE
345100200529      *                                                    * IS REQUIRED.
345200200529      **  STORE  TEXT IN USTORE FIELD
345300200529      *
345400200529     C                     MOVEAUAR       USTORE 53
345500200529     C                     MOVE *BLANKS   UAR
345600200529      *
345700200529      *
345800200529      *
345900200529     C           53        SUB  U         UB      20
346000200529     C           UB        DIV  2         UB
346100200529     C                     MVR            UR      10
346200200529     C           UB        ADD  U         U
346300200529     C           U         SUB  1         U
346400200529      *
346500200529      *
346600200529      **  INSERT UNDERLINE TO ARRAY
346700200529      **
346800200529     C                     MOVEA*ALL'-'   ULN,UB
346900200529     C                     MOVEA*BLANKS   ULN,U
347000200529      *
347100200529      *
347200200529     C           UB        IFGT 0
347300200529     C                     MOVEAUSTORE    UAR,UB
347400200529     C                     ELSE
347500200529     C                     MOVEAUSTORE    UAR
347600200529     C                     END
347700200529      *
347800200529      **  MOVE ARRAY VALUE  TO SCREEN TEXT FIELD
347900200529      *
348000200529     C*                    MOVEAUAR       ##EYTX                          S01216
348100200529     C*********************MOVEAUAR       ##E8TX 53                 S01216S01117
348200200529     C                     MOVEAUAR       ##AURT 53                 S01216S01117
348300200529     C*
348400200529     C/COPY WNCPYSRC,SD0010PC18
348500200529     C*
348600200529     C*                    MOVEAUAR       WUEYTX
348700200529     C*********************MOVEAUAR       WUE8TX                          S01117
348800200529     C                     MOVEAUAR       WUAURT                          S01117
348900200529     C*                    MOVEAULN       ##BJNA                          S01216
349000200529     C                     MOVEAULN       ##BJNA 53                       S01216
349100200529     C                     MOVEAULN       WUBJNA
349200200529      *
349300200529      *
349400200529      ** RESET INDICATOR *IN 99
349500200529      *
349600200529     C           UIND      IFEQ 1
349700200529     C                     SETON                         99
349800200529     C                     ELSE
349900200529     C                     SETOF                         99
350000200529     C                     END
350100200529      *
350200200529      * ZSFILE - log spool file - Standard Functions  *
350300200529     C*
350400200529     C* Set up spool file number - Standard Functions  *
350500200529     C                     Z-ADD@$FNB     WUSFNB
350600200529     C                     MOVE *BLANKS   UUSRSQ  5                       LN0721
350700200529     C*
350800200529     C* ZSFILE - write report rqs - Standard Functions  *
350900200529     C                     CALL 'ZSFILE'               90  ZSFILE - write
351000200529     C*********************PARM #IRSQN    UURSQN  5        RCF sequence nuLN0721
351100200529     C           UUSRSQ    PARM P2RSQN    UURSQN  5        RCF sequence nuLN0721
351200200529     C                     PARM P4ENTY    UUENTY  3        Entity
351300200529     C                     PARM @$FVN     UUSFNM 10        Spool file name
351400200529     C                     PARM WUSFNB    UUSFNB  60       Spool file numb
351500200529     C           WUZSER    PARM *BLANK    UUZSER  1        ZSFILE error
351600200529     C*
351700200529     C           *IN90     IFEQ '1'
351800200529     C* Call to program ended in error.
351900200529     C                     MOVEL'Y2U0021' W0RTN   7
352000200529     C                     END
352100200529     C*
352200200529     C* CASE: WRK.ZSFILE is error occurred
352300200529     C*
352400200529     C*          #OZSER    IFEQ 'Y'
352500200529     C*                    MOVEL'Y2U0004' P0RTN
352600200529     C*                    EXSR ZYEXPG
352700200529     C*                    END
352800200529      *CASE:     WRK.ZSFILE error is Error Occured
352900200529     C           WUZSER    IFEQ @CN,01                     *IF
353000200529     C                     MOVEL@CN,14    P0RTN            *Return code
353100200529     C                     EXSR ZYEXPG
353200200529     C                     END                             *FI
353300200529     C                     MOVEL@CN,01    WUMFTS           S01212
353400200529      *CASE:     WRK.S01212 is Fix installed
353500200529     C           WUMFTS    IFEQ @CN,01                     *IF
353600200529      * 00/Copy Member SD0010PIPG - Client Details  *
353700200529     C/COPY WNCPYSRC,SD0010PCPG
353800200529      *                                                                                      LLN022A
353900200529      ** Define work field Yellow book feature ind                                           LLN022A
354000200529      *                                                                                      LLN022A
354100200529     C                     MOVEL*BLANK    LLN007  1                                          LLN022A
354200200529      *                                                                                      LLN022A
354300200529      ** Check to see if Yellow book changes (LLN007) is switched on.                        LLN022A
354400200529      *                                                                                      LLN022A
354500200529     C                     CALL 'AOSARDR0'                                                   LLN022A
354600200529     C                     PARM *BLANK    PRTCD                                              LLN022A
354700200529     C                     PARM '*VERIFY' POPTN                                              LLN022A
354800200529     C                     PARM 'LLN007'  PSARD                                              LLN022A
354900200529      *                                                                                      LLN022A
355000200529     C           PRTCD     IFEQ *BLANKS                                                      LLN022A
355100200529     C                     MOVE 'Y'       LLN007                                             LLN022A
355200200529     C                     ENDIF                                                             LLN022A
355300200529      *                                                                                      LLN022A
355400200529     C                     END                             *FI
355500200529      *================================================================
355600200529     CSR         ZZEXIT    ENDSR
355700200529      /EJECT                                                              CDL006
355800200529     C/COPY WNCPYSRC,SD0010PC07
355900200529      *****************************************************************   CDL006
356000200529      *                                                               *   CDL006
356100200529      * *PSSR    - TO PROCESS DATA BASE ERRORS                        *   CDL006
356200200529      *                                                               *   CDL006
356300200529      *****************************************************************   CDL006
356400200529      *                                                                   CDL006
356500200529     C           *PSSR     BEGSR                                          CDL006
356600200529     C           WRUN      IFEQ *BLANK                                    CDL006
356700200529     C                     MOVE 'Y'       WRUN    1                       CDL006
356800200529     C                     DUMP                                           CDL006
356900200529     C                     END                                            CDL006
357000200529      *                                                                   CDL006
357100200529     C                     MOVE '1'       *INU7                           CDL006
357200200529     C                     MOVE '1'       *INU8                           CDL006
357300200529     C                     MOVE '1'       *INLR                           CDL006
357400200529     C                     RETRN                                          CDL006
357500200529     C                     ENDSR                                          CDL006
357600200529      *****************************************************************   CDL006
357700200529      * RWA       : Output RWA information from SDCRWAPD                * CGL018
357800200529      * ---                                                             * CGL018
357900200529      * Called By : CAPRDT                                              * CGL018
358000200529      * Calls     : None                                                * CGL018
358100200529      ******************************************************************* CGL018
358200200529     C           RWADTL    BEGSR                                          CGL018
358300200529      *                                                                   CGL018
358400200529     C           XRCUST    SETLLSDCRWAD0                                  CGL018
358500200529     C           XRCUST    READESDCRWAD0                 82               CGL018
358600200529     C                     MOVE *BLANKS   XRWA                            CGL018
358700200529     C                     MOVEL*BLANKS   XRWASE                          CGL018
358800200529     C                     MOVEL*BLANKS   RWASEC                          CGL018
358900200529     C                     MOVEL*BLANKS   #CONTI                          CGL018
359000200529     C                     Z-ADD0         U       20                      CGL018
359100200529     C           *IN82     DOWEQ'0'                                       CGL018
359200200529      *                                                                   CGL018
359300200529      * Only live records                                                 CGL018
359400200529      *                                                                   CGL018
359500200529     C           RWRECI    IFNE '*'                                       CGL018
359600200529     C                     ADD  1         U                               CGL018
359700200529     C                     MOVE RWCODE    #RCODE                          CGL018
359800200529     C                     MOVE RWSETN    #RSET                           CGL018
359900200529      *                                                                   CGL018
360000200529     C           U         IFGT 18                                        CGL018
360100200529     C           #CONTI    ANDNE'C'                                       CGL018
360200200529     C                     Z-ADD1         U                               CGL018
360300200529     C                     MOVEL'C'       #CONTI  1                       CGL018
360400200529     C                     MOVEL*BLANKS   XRWASE                          CGL018
360500200529     C                     MOVEAXRWA      XRWASE                          CGL018
360600200529     C                     MOVE *BLANKS   XRWA                            CGL018
360700200529     C                     ENDIF                                          CGL018
360800200529      *                                                                   CGL018
360900200529     C                     MOVEARWSECO    XRWA,U                          CGL018
361000200529     C                     ENDIF                                          CGL018
361100200529      *                                                                   CGL018
361200200529     C           BBCUST    READESDCRWAD0                 82               CGL018
361300200529     C                     ENDDO                                          CGL018
361400200529      *                                                                   CGL018
361500200529      *                                                                   CGL018
361600200529     C           U         IFEQ 0                                         CGL018
361700200529     C                     MOVEL'None'    XRWASE                          CGL018
361800200529     C                     ELSE                                           CGL018
361900200529      *                                                                   CGL018
362000200529      * Last one must be without comma, so clear and output again         CGL018
362100200529      *                                                                   CGL018
362200200529     C                     MOVEL*BLANKS   #COMMA                          CGL018
362300200529     C                     MOVEARWSECO    XRWA,U                          CGL018
362400200529      *                                                                   CGL018
362500200529     C           #CONTI    IFEQ 'C'                                       CGL018
362600200529     C                     MOVEAXRWA      RWASEC                          CGL018
362700200529     C                     ELSE                                           CGL018
362800200529     C                     MOVEAXRWA      XRWASE                          CGL018
362900200529     C                     ENDIF                                          CGL018
363000200529      *                                                                   CGL018
363100200529     C                     MOVEL','       #COMMA                          CGL018
363200200529     C                     ENDIF                                          CGL018
363300200529      *                                                                   CGL018
363400200529     C                     ENDSR                                          CGL018
363500200529      ******************************************************************* CGL018
363600200529      *****************************************************************                       CER073
363700200529      * SRANAC    : Output AnaCredit Reporting from SDANACQD            *                     CER073
363800200529      * ---                                                             *                     CER073
363900200529      * Called By : CAPRDT                                              *                     CER073
364000200529      * Calls     : None                                                *                     CER073
364100200529      *******************************************************************                     CER073
364200200529     C           SRANAC    BEGSR                                                              CER073
364300200529      *                                                                                       CER073
364400200529     C                     MOVE *BLANKS   R2HOID                                              CER073
364500200529     C                     MOVE *BLANKS   R2UPID                                              CER073
364600200529     C                     MOVE *BLANKS   R2SOLP                                              CER073
364700200529     C                     MOVE *BLANKS   R2DTLP                                              CER073
364800200529     C                     MOVE *BLANKS   R2ENTS                                              CER073
364900200529     C                     MOVE *BLANKS   R2DTES                                              CER073
365000200529     C                     MOVE *BLANKS   R2NOEM                                              CER073
365100200529     C                     MOVE *BLANKS   R2BALS                                              CER073
365200200529     C                     MOVE *BLANKS   R2ANTU                                              CER073
365300200529     C                     MOVE *BLANKS   R2ASTD                                              CER073
365400200529     C                     MOVE *BLANKS   R2FNAM                                              CER073
365500200529     C                     MOVE *BLANKS   R2LNAM                                              CER073
365600200529     C                     MOVE *BLANKS   R2STRT                                              CER073
365700200529     C                     MOVE *BLANKS   R2NUMB                                              CER073
365800200529     C                     MOVE *BLANKS   R2TOWN                                              CER073
365900200529     C                     MOVE *BLANKS   R2POST                                              CER073
366000200529     C                     MOVE *BLANKS   R2REGN                                              CER073
366100200529     C                     MOVE *BLANKS   R2CTRY                                              CER073
366200200529     C                     MOVE *BLANKS   R2LEGF                                             CER073A
366300200529      *                                                                                       CER073
366400200529     C           KANAC     KLIST                                                              CER073
366500200529     C                     KFLD           BBBRCD                                              CER073
366600200529     C                     KFLD           BBCUST                                              CER073
366700200529     C           KANAC     CHAINSDANACI1             09                                       CER073
366800200529      *                                                                                       CER073
366900200529     C           *IN09     IFEQ *OFF                                                          CER073
367000200529      *                                                                                       CER073
367100200529      ** AnaCredit Reporting                                                                  CER073
367200200529      *                                                                                       CER073
367300200529     C                     MOVE ACHOID    R2HOID                                              CER073
367400200529     C                     MOVE ACUPID    R2UPID                                              CER073
367500200529     C                     MOVE ACSOLP    R2SOLP                                              CER073
367600200529     C                     MOVE ACENTS    R2ENTS                                              CER073
367700200529     C                     MOVE ACNOEM    R2NOEM                                              CER073
367800200529     C                     MOVE ACBALS    R2BALS                                              CER073
367900200529     C                     MOVE ACANTU    R2ANTU                                              CER073
368000200529     C                     MOVE ACASTD    R2ASTD                                              CER073
368100200529     C                     MOVE ACFNAM    R2FNAM                                              CER073
368200200529     C                     MOVE ACLNAM    R2LNAM                                              CER073
368300200529     C                     MOVE ACSTRT    R2STRT                                              CER073
368400200529     C                     MOVE ACNUMB    R2NUMB                                              CER073
368500200529     C                     MOVE ACTOWN    R2TOWN                                              CER073
368600200529     C                     MOVE ACPOST    R2POST                                              CER073
368700200529     C                     MOVE ACREGN    R2REGN                                              CER073
368800200529     C                     MOVE ACCTRY    R2CTRY                                              CER073
368900200529     C                     MOVE ACLEGF    R2LEGF                                             CER073A
369000200529      *                                                                                       CER073
369100200529      ** Convert Date of initiation of legal proceedings to DDMMMYY                           CER073
369200200529      *                                                                                       CER073
369300200529     C           ACDTLP    IFEQ 0                                                             CER073
369400200529     C                     MOVE *BLANK    R2DTLP                                              CER073
369500200529     C                     ELSE                                                               CER073
369600200529     C                     MOVE ACDTLP    ZDAYNO                                              CER073
369700200529      *                                                                                       CER073
369800200529     C                     CALL 'ZDATE2'                                                      CER073
369900200529     C                     PARM           ZDAYNO                                              CER073
370000200529     C                     PARM           BJDFIN                                              CER073
370100200529     C                     PARM           ZDATE                                               CER073
370200200529     C                     PARM           ZADATE                                              CER073
370300200529      *                                                                                       CER073
370400200529     C                     MOVE ZADATE    R2DTLP                                              CER073
370500200529     C                     ENDIF                                                              CER073
370600200529      *                                                                                       CER073
370700200529      ** Convert Date of Enterprise Size to DDMMMYY                                           CER073
370800200529      *                                                                                       CER073
370900200529     C           ACDTES    IFEQ 0                                                             CER073
371000200529     C                     MOVE *BLANKS   R2DTES                                              CER073
371100200529     C                     ELSE                                                               CER073
371200200529     C                     MOVE ACDTES    ZDAYNO                                              CER073
371300200529     C                     CALL 'ZDATE2'                                                      CER073
371400200529     C                     PARM           ZDAYNO                                              CER073
371500200529     C                     PARM           BJDFIN                                              CER073
371600200529     C                     PARM           ZDATE                                               CER073
371700200529     C                     PARM           ZADATE                                              CER073
371800200529      *                                                                                       CER073
371900200529     C                     MOVE ZADATE    R2DTES                                              CER073
372000200529     C                     ENDIF                                                              CER073
372100200529     C                     ENDIF                                                              CER073
372200200529     C                     ENDSR                                                              CER073
372300200529      /EJECT                                                                                  CSD029
372400200529     *******************************************************************                      CSD029
372500200529      *                                                                *                      CSD029
372600200529      *  SRFMTF - Suboutine to format fields                            *                     CSD029
372700200529      *                                                                 *                     CSD029
372800200529      *******************************************************************                     CSD029
372900200529     C           SRFMTF    BEGSR                                                              CSD029
373000200529      *                                                                                       CSD029
373100200529     C                     CALL 'AOSVALR0'                                                    CSD029
373200200529     C                     PARM           PRTCD                                               CSD029
373300200529     C                     PARM @VAL01    PVALK1 20                                           CSD029
373400200529     C                     PARM           PVAL1 200                                           CSD029
373500200529     C                     PARM @VAL02    PVALK2 20                                           CSD029
373600200529     C                     PARM           PVAL2 200                                           CSD029
373700200529     C                     PARM @VAL03    PVALK3 20                                           CSD029
373800200529     C                     PARM           PVAL3 200                                           CSD029
373900200529     C                     PARM @VAL04    PVALK4 20                                           CSD029
374000200529     C                     PARM           PVAL4 200                                           CSD029
374100200529     C                     PARM @VAL05    PVALK5 20                                           CSD029
374200200529     C                     PARM           PVAL5 200                                           CSD029
374300200529     C                     PARM @VAL06    PVALK6 20                                           CSD029
374400200529     C                     PARM           PVAL6 200                                           CSD029
374500200529     C                     PARM @VAL07    PVALK7 20                                           CSD029
374600200529     C                     PARM           PVAL7 200                                           CSD029
374700200529     C                     PARM @VAL08    PVALK8 20                                           CSD029
374800200529     C                     PARM           PVAL8 200                                           CSD029
374900200529     C                     PARM @VAL09    PVALK9 20                                           CSD029
375000200529     C                     PARM           PVAL9 200                                           CSD029
375100200529     C                     PARM @VAL10    PVALK0 20                                           CSD029
375200200529     C                     PARM           PVAL10200                                           CSD029
375300200529      *                                                                                       CSD029
375400200529     C           PRTCD     IFEQ *BLANKS                                                       CSD029
375500200529      *                                                                                       CSD029
375600200529     C                     MOVE *OFF      *IN31                                               CSD029
375700200529     C                     MOVE *OFF      *IN32                                               CSD029
375800200529     C                     MOVE *OFF      *IN33                                               CSD029
375900200529     C                     MOVE *OFF      *IN34                                               CSD029
376000200529     C                     MOVE *OFF      *IN35                                               CSD029
376100200529     C                     MOVE *OFF      *IN36                                               CSD029
376200200529     C                     MOVE *OFF      *IN37                                               CSD029
376300200529     C                     MOVE *OFF      *IN38                                               CSD029
376400200529     C                     MOVE *OFF      *IN39                                               CSD029
376500200529     C                     MOVE *OFF      *IN40                                               CSD029
376600200529      *                                                                                       CSD029
376700200529     C                     SELEC                                                              CSD029
376800200529     C           PVAL1     WHEQ *BLANKS                                                       CSD029
376900200529     C                     MOVE *ON       *IN31                                               CSD029
377000200529     C           PVAL2     WHEQ *BLANKS                                                       CSD029
377100200529     C                     MOVE *ON       *IN32                                               CSD029
377200200529     C           PVAL3     WHEQ *BLANKS                                                       CSD029
377300200529     C                     MOVE *ON       *IN33                                               CSD029
377400200529     C           PVAL4     WHEQ *BLANKS                                                       CSD029
377500200529     C                     MOVE *ON       *IN34                                               CSD029
377600200529     C           PVAL5     WHEQ *BLANKS                                                       CSD029
377700200529     C                     MOVE *ON       *IN35                                               CSD029
377800200529     C           PVAL6     WHEQ *BLANKS                                                       CSD029
377900200529     C                     MOVE *ON       *IN36                                               CSD029
378000200529     C           PVAL7     WHEQ *BLANKS                                                       CSD029
378100200529     C                     MOVE *ON       *IN37                                               CSD029
378200200529     C           PVAL8     WHEQ *BLANKS                                                       CSD029
378300200529     C                     MOVE *ON       *IN38                                               CSD029
378400200529     C           PVAL9     WHEQ *BLANKS                                                       CSD029
378500200529     C                     MOVE *ON       *IN39                                               CSD029
378600200529     C           PVAL10    WHEQ *BLANKS                                                       CSD029
378700200529     C                     MOVE *ON       *IN40                                               CSD029
378800200529     C                     ENDSL                                                              CSD029
378900200529      *                                                                                       CSD029
379000200529     C           25        SUBSTPVAL1:1   A5FLT1                                              CSD029
379100200529     C                     MOVELE5FL01    A5FL01                                              CSD029
379200200529     C           25        SUBSTPVAL2:1   A5FLT2                                              CSD029
379300200529     C                     MOVELE5FL02    A5FL02                                              CSD029
379400200529     C           25        SUBSTPVAL3:1   A5FLT3                                              CSD029
379500200529     C                     MOVELE5FL03    A5FL03                                              CSD029
379600200529     C           25        SUBSTPVAL4:1   A5FLT4                                              CSD029
379700200529     C                     MOVELE5FL04    A5FL04                                              CSD029
379800200529     C           25        SUBSTPVAL5:1   A5FLT5                                              CSD029
379900200529     C                     MOVELE5FL05    A5FL05                                              CSD029
380000200529     C           25        SUBSTPVAL6:1   A5FLT6                                              CSD029
380100200529     C                     MOVELE5FL06    A5FL06                                              CSD029
380200200529     C           25        SUBSTPVAL7:1   A5FLT7                                              CSD029
380300200529     C                     MOVELE5FL07    A5FL07                                              CSD029
380400200529     C           25        SUBSTPVAL8:1   A5FLT8                                              CSD029
380500200529     C                     MOVELE5FL08    A5FL08                                              CSD029
380600200529     C           25        SUBSTPVAL9:1   A5FLT9                                              CSD029
380700200529     C                     MOVELE5FL09    A5FL09                                              CSD029
380800200529     C           25        SUBSTPVAL10:1  A5FLT0                                              CSD029
380900200529     C                     MOVELE5FL10    A5FL00                                              CSD029
381000200529      *                                                                                       CSD029
381100200529     C                     ENDIF                                                              CSD029
381200200529      *                                                                                       CSD029
381300200529     C                     ENDSR                                                              CSD029
381400200529      *                                                                                       CSD029
381500200529      *****************************************************************   CDL006
381600200529     O/COPY WNCPYSRC,SD0010POPG
381700200529** CPY@     : Copyright notice for inclusion in all programs
381800200529(c) Finastra International Limited 2001
381900200529**   ARRAY ENTRIES FOR REPORT TITLE
382000200529MAINTENANCE - AUDIT REPORT
382100200529LISTING
382200200529** @CN Long constants used in program.
382300200529Y
382400200529A
382500200529I
382600200529N
382700200529D
382800200529***DELETED***
3829002005290
383000200529SDCUSTPD
383100200529Y2U0005
383200200529SD0010AU
383300200529BANK
383400200529SDBANKPD
383500200529CLIENT DETAILS
383600200529Y2U0004
383700200529Release                                                                   CSD007
383800200529Close                                                                     CSD007
383900200529***CLOSED***                                                              CSD007
384000200529INACTIVE                                                                  CSD025A
384100200529**   ZMNM - MONTHS SHORT NAMES
384200200529JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
384300200529**   TABM / TABD - EQUIVALENT OF MONTHS                                                       262205
384400200529JAN01FEB02MAR03APR04MAY05JUN06JUL07AUG08SEP09OCT10NOV11DEC12                                  262205
384500200529** OVRC                                                                                       CGP001
384600200529OVRDBF FILE(GPCSTXL1) TOFILE(GPCUSTXL1)                                                       CGP001
