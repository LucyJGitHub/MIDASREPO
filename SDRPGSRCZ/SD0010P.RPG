     H*********** Y                                                       CDL006
     H        1   Y                                                       CDL006
      *****************************************************************
/*OVR *  OVRDBF FILE(GPCSTXL1) TOFILE(GPCUSTXL1)                      *                       CGP001
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas SD Customers report')                            *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Standing Data Module
     F*                                                               *
     F*  SD0010P - CLIENT REPORT                                      *
     F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
      *                                                               *
      *  Last Amend No. CER071             Date 01Aug16               *
      *  Prev Amend No. LLN022A            Date 03Jun15               *
      *                 LLN022             Date 03Jun15               *
      *                 CER070             Date 19Aug14               *
      *                 CSW214             Date 25Nov14               *
      *                 MD025682           Date 19Aug14               *
      *                 CGL132             Date 01May13               *
      *                 CSW213             Date 03Jun13               *
      *                 CLE134             Date 01Aug12               *
      *                 AR787620           Date 10Jun11               *
      *                 AR740375           Date 02Apr11               *
      *                 CER059             Date 19Jul10               *
      *                 262205             Date 20Nov09               *
      *                 262064             Date 30Oct09               *
      *                 CER045             Date 20Jul09               *
      *                 BUG23640           Date 15May09               *
      *                 BUG24052           Date 20May09               *
      *                 CER054             Date 07Apr09               *
      *                 CER034A            Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 BUG14933           Date 02Oct07               *
      *                 CSW207             Date 09Jul07               *
      * Midas Plus 1.4 Base ------------------------------------------*
      *                 CSD079             Date 05Feb07               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 240753             Date 06Jun06               *
      *                 CSD027A            Date 11May06               *
      *                 CSD027             Date 09Dec05               *
      *                 CER001             Date 25Apr05               *
      *                 CSD029             Date 22Aug05               *
      *                 236137             Date 21Sep05               *
      *                 235201             Date 02Aug05               *
      *                 232543             Date 01Apr05               *
      *                 CGL032             Date 05Jul04               *
      *                 CSD025A            Date 27Apr05               *
      *                 CSW037A            Date 02May05               *
      *                 BUG6198            Date 04Apr05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CFX001             Date 20Oct03               *
      *                 CLE025             Date 20Oct03               *
      *                 CGP001             Date 10Mar04               *
      *                 CGL018             Date 30Sep02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CSW024             Date 31Aug01               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CRE007             Date 01Mar01               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 CSD007             Date 28Aug00               *
      *                 CDL008             Date 02May00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 151482             Date 12Jan99               *
      * Midas DBA 3.02 -----------------------------------------------*
      *                 168603             Date 07Jan00               *
      * Midas DBA 3.01 -----------------------------------------------*
      *                 CDL006             Date 26Apr99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 113339             Date 22Jul99               *
      *                 CEU014             Date 28Apr98               *
     F*                 099441             DATE 19AUG97               *
     F*                 CDL002             DATE 17MAR97               *
     F*                 S01408             DATE 17SEP96               *
     F*                 S01408             DATE 02SEP96               *
     F*                 S01408             DATE 29MAY96               *
     F*                 S01408             DATE 09FEB96               *
     F*                 S01408             DATE 06FEB96               *
     F*                 095938             DATE 17JAN96               *
     F*                 S01408             DATE 13DEC95               *
     F*                 S01408             DATE 07SEP95               *
     F*                 076824             DATE 07OCT94               *
     F*                 S01413             DATE 13APR93               *
     F*                 065369             DATE 07FEB94               *
     F*                 S01421             DATE 12JUL93               *
     F*                 S01383             DATE 12JUN92               *
     F*                 S01310             DATE 31MAY91               *
     F*                 LN1104             DATE 15FEB91               *
     F*                 S01267             DATE 17JAN91               *
     F*                 BHF950             DATE 14DEC90               *
     F*                 BHF399             DATE 15AUG90               *
     F*                 S01212             DATE 08AUG90               *
     F*                 BHF331             DATE 06AUG90               *
     F*                 LN0562             DATE 26JUL90               *
     F*                 LN0502             DATE 25JUL90               *
     F*                 LN0536             DATE 18JUL90               *
     F*                 LN0168             DATE 26JUN90               *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  CER071 - BAIS - Legal Form field                             *
      *  LLN022A - BOE Upgrade to MidasPlus - incorporate code from   *
      *            /COPY members and add switchability.               *
      *  LLN022 - BOE Upgrade to MidasPlus.                           *
      *           Recompiled over changes in /COPY                    *
      *  CER070 - BuBa Reporting / BAIS V.1.16.0                      *
      *  CSW214 - SWIFT Changes 2014 (Recompile)                      *
      *  MD025682 - Correct SDCUSTPD trailer failure in COB.          *
      *  CGL132 - FATCA Phase 1 - Customers' Identification and       *
      *           Classification - Master                             *
      *  CSW213 - SWIFT Changes 2013                                  *
      *  CLE134 - Past Due Call Loan Processing (Recompile)           *
      *  AR740375 - State code value in report SD0010PM does not      *
      *             match the value in CUSD (Child: AR740376)         *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  262205 - Report SD0010PM contains a lot of useless pages.    *
      *           Do not print header when "Client Report request is  *
      *           Audit and Last Change Date is not equal to Rundate".*
      *  262064 - Overwriting of Market Centre and Investment Company *
      *           Identification. Add SPACEB(1) after Market Centre.  *
      *           Recompiled due to changes in SD0010PM printer file. *
      *  CER045 - German Features - Reporting Bundesbank              *
      *  BUG23640 - Labels were amended for clarity   (Recompile)     *
      *  BUG24052 - Religious Affiliation Narrative is incorrect for  *
      *             'NONE' code.                                      *
      *  CER054 - German Features - Church Tax                        *
      *  CER034A - LF046 German Features - New Fields and Enquiries   *
      *  BUG14933 - Error in checking switchable feature CSW207       *
      *  CSD079 - Enhanced Customer Maintenance API (Recompile)       *
      *  CSW207 - SWIFT 2007 Changes                                  *
      *  240753 - Recompiled due to changes in SD0010PM               *
      *  CSD027A - Conversion Of Customer Number to Alpha             *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CER001 - LUX Upgrade to MidasPlus                            *
      *  CSD029 - Customer Details Additional Fields                  *
      *  236137 - Change Control for CGL031                           *
      *  235201 - Show only customers whose record was changed.       *
      *  232543 - Fix to CGL032                                       *
      *  CGL032 - Automatic Exchange of Information                   *
      *  CSD025A- Inactive status                                     *
      *  CSW037A- Additional Field extended to 40 chars               *
      *  BUG6198- Cannot save new Details for CUSD (Recompile)        *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CFX001 - FX Margin Trading                                   *
      *  CLE025 - Credit Lines                                        *
      *  CGP001 - Global Processing.                                  *
      *  CGL018 - Risk Weighted Assets                                *
      *  CSW024 - S.W.I.F.T. MT3xx Field 82/83/87.                    *
      *  CRE007 - Base Rate Tax 2001.                                 *
      *  CSD007 - Customer Closing: new Closure Status fields         *
      *  CDL008 - Continuous Linked Settlement                        *
      *  151482 - Use correct CHips ABA field BBABA2                  *
      *  168603 - For E5BRT1 should treat '000000' as *blanks.        *
      *  CDL006 - Dealing Fiduciary.                                  *
     F*  113339 - Date of birth could be before 01-01-72, thus add    *
     F*           field to retrieve full date.                        *
     F*  CEU014 - EMU User Defined Correspondence Changes:            *
     F*           addition of 'Designated In Currency' field.         *
     F*  099441 - Addition of 'SWIFT Financial Institution' flag.     *
     F*  CDL002 - FX Netting                                          *
     F*  S01408 - Hook SD0010PC25 added.                              *
     F*  S01408 - Hook SD0010PC24 added.                              *
     F*         - Hook SD0010PIP1 added.                              *
     F*  S01408 - Hook SD0010PC23 added.                              *
     F*           Hook SD0010PC22 added.                              *
     F*  S01408 - Hook SD0010PFP2 added.                              *
     F*           Hook SD0010PFP3 added.                              *
     F*           Hook SD0010PFP4 added.                              *
     F*           Hook SD0010PCP9 added.                              *
     F*           Hook SD0010PC10 added.                              *
     F*           Hook SD0010PC11 added.                              *
     F*           Hook SD0010PC12 added.                              *
     F*           Hook SD0010PC13 added.                              *
     F*           Hook SD0010PC14 added.                              *
     F*           Hook SD0010PC15 added.                              *
     F*           Hook SD0010PC16 added.                              *
     F*           Hook SD0010PC17 added.                              *
     F*           Hook SD0010PC18 added.                              *
     F*           Hook SD0010PC19 added.                              *
     F*           Hook SD0010PC20 added.                              *
     F*           Hook SD0010PC21 added.                              *
     F*  S01408 - Hook SD0010PCP7 added.                              *
     F*           Hook SD0010PCP8 added.                              *
     F*           Hook SD0010PFP1 added.                              *
     F*  095938 - Do not print additional details if cust. not changed*
     F*           today                                               *
     F*  S01408 - Hook SD0010PCP6 added.                              *
     F*  S01408 - Hook SD0010PCP1 added.                              *
     F*           Hook SD0010PCP2 added.                              *
     F*           Hook SD0010PCP3 added.                              *
     F*           Hook SD0010PCP4 added.                              *
     F*           Hook SD0010PCP5 added.                              *
     F*  076824 - IF THERE ONLY ADDITIONAL CUSTOMER DETAILS TO REPORT *
     F*           IN AUDIT MODE, DETAILS ARE PRECEDED BY A HEADED     *
     F*           PAGE WITH NO DETAILS.                               *
     F*           DO NOT PRINT 'NO DETAILS TO REPORT' AFTER PRINTING  *
     F*           ADDITIONAL DETAILS ONLY.                            *
     F*  S01413 - Retail 3 development.                               *
     F*  065369 - Recompiled for new fields (title) on printout.      *
     F*  S01421 - BLI STEP 1 DEVELOPMENT-                             *
     F*           Switchable features S01424 and S01425 are checked   *
     F*           for.If S01424 is present a new field is added to    *
     F*           Client Details Listing (XRCEAD) with text:'Customer *
     F*           Eligible for Automatic Deletion'.If S01425 is       *
     F*           present, then a new format is printed (ADCUDT)-     *
     F*           additional Customer Details.Details will be printed *
     F*           if a record is found.                               *
     F*  S01383 - Basic Rate Tax Incorporation. Print A/c Holder data.*
     F*  S01310 - SWIFT Rationalisation.                              *
     F*  LN1104 - Recompiled owing to change to SDCUSTPD.             *
     F*  S01267 - Customer Risk Weighting Code added.                 *
     F*  BHF950 - ENSURE THAT THE CALCULATED NO OF RECORDS IS ONLY    *
     F*           BASED ON THE LIVE CLIENTS ON THE FILE.              *
     F*  BHF399 - PASS SD0010AU TO SDC540P INSTEAD OF PROGRAM NAME.   *
     F*  S01212 - /COPY PROCESSING ADDED.                             *
     F*  BHF331 - REPORT LAYOUT REDESIGNED.                           *
     F*  LN0562 - ZEROS ARE NOW SUPPRESSED ON THE REPORT AND THE      *
     F*           DATES ARE DISPLAYED AS 7 CHARACTER ALPHANUMERICS.   *
     F*  LN0502 - RECOMPILE PROGRAM DUE TO CHANGE IN PRINTER FILE.    *
     F*  LN0536 - SET UP TITLE CORRECTLY.                             *
     F*  LN0168 - SET SCAN LIMIT TO 99999.                            *
     F*                                                               *
     F*****************************************************************
     F/COPY WNCPYSRC,SD0010PFPG
      *                                                                                      LLN022A
     FBYCUSTY0IF  E           K        DISK                                                  LLN022A
      *                                                                                      LLN022A
      ** Bank of England Customer details - retrieval                                        LLN022A
      *                                                                                      LLN022A
     FSDCUX2L0IF  E           K        DISK                                                   CER001
      * RTV: Customer Details Ext.  file for European Reporting - Luxemb.                     CER001
     FSDCUSTL1IF  E           K        DISK
     F*
      * RTV: Customer Details (SWIFT)                                                         CSW207
     FSDCSSWL1IF  E           K        DISK                                                   CSW207
     F*                                                                                       CSW207
      * RTV: Customer Details (Ext - C)                                                       CGL132
     FSDCUSXL1IF  E           K        DISK                                                   CGL132
      *                                                                                       CGL132
     F/COPY WNCPYSRC,SD0010PFP2
     F*
      * RTV: Client Details            Retrieval index
      *
     FSDCBRTL1IF  E           K        DISK                               S01383
     FSDFCTLL1IF  E           K        DISK
      * RTV: Standing Data Controls    Retrieval index
      *
     F/COPY WNCPYSRC,SDH00577
     FSDBANKL1IF  E           K        DISK
      * RTV: Bank Details              Retrieval index
      *                                                                   S01421
     F/COPY WNCPYSRC,SD0010PF01
     FSDACUSL1IF  E           K        DISK                               S01421
      * Additional Cust Details        Retrieval index                    S01421
      *
     F*
     F/COPY WNCPYSRC,SD0010PFP1
     F*
     FSDFCTLL0UF  E           K        DISK
      * UPD: Standing Data Controls    Update index
      *
     FSDCRWAL0IF  E           K        DISK                               CGL018
      * RTW: Customer Risk Weigted Assets Code/Set                        CGL018
      *                                                                   CGL018
     F*
     F/COPY WNCPYSRC,SD0010PFP3
     F*
     FSD0010PMO   E             97     PRINTER
     F                                              KINFDS INFDS$
      *                                                                                       CGL032
     FSDACTXL1IF  E           K        DISK                                                   CGL032
      ** RTV: Customer Details          Retrieval index                                       CGL032
     F*
     F/COPY WNCPYSRC,SD0010PFP4
     F*
      * PRT: Midas SD Client report
      *
     FGPCSTXL1IF  E           K        DISK                           UC                      CGP001
     F                                              KINFSR *PSSR                              CGP001
     F            GPCUSTXD0                         KRENAMEGPCSTXD0                           CGP001
      ** Midas GP Global Customers X-Reference                                                CGP001
      *                                                                                       CGP001
     E* Description     : Copyright notice for inclusion in all programs
     E*
     E********************************************************************
     E                    CPY@    1   1 80               Copyright     array
     E                    UAR        53  1
     E                    ULN        53  1
     E                    UARRAY  1   2 26
      *
      ** SAVE INDICATOR *IN 99
      *
     E/COPY WNCPYSRC,SD0010PEPG
     E                    BLC         5132                                                    CER001
      * IBLC 2002 Extended informations array                                                 CER001
     E********************@CN     1  14 25               Long constants.  CSD007
     E*****               @CN     1  17 25               Long constants.  CSD007CSD025A
     E                    @CN     1  18 25               Long constants.  CSD025A
     E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY 113339
     E                    TABM   12  12  3   TABD    2                                        262205
     E                    XRWA       90  5               Work Array       CGL018
     E                    OVRC    1   1 80                                                    CGP001
      ** Override Command Array                                                               CGP001
      *                                                                                       CGP001
     I*
     I* Description     : Copyright notice for inclusion in all programs
     I*
     I*00/Copy Member SD0010P   Initialise Program I-Spec
     I/COPY WNCPYSRC,SD0010PIPG
      *                                                                                      LLN022A
     I            DS                                                                         LLN022A
      *                                                                                      LLN022A
      ** BOE fields                                                                          LLN022A
      *                                                                                      LLN022A
     I                                        1 131 UFLD1                                    LLN022A
     I I            'SIO Ind:'                1   8 SIO                                      LLN022A
     I                                       10  10 ULSIOF                                   LLN022A
     I I            'H/A Ind:'               15  22 HAIN                                     LLN022A
     I                                       24  24 ULHAIN                                   LLN022A
     I I            'Ult Par:'               29  36 ULTP                                     LLN022A
     I                                       38  43 ULULPA                                   LLN022A
     I I            'Eg.Flag:'               48  55 EGFL                                     LLN022A
     I                                       57  57 ULEGFL                                   LLN022A
     I I            'BoE Inst. Code:'        61  75 LINC                                     LLN022A
     I                                       77  78 ULLINC                                   LLN022A
     I I            'BoE Ind. Code:'         81  94 LICD                                     LLN022A
     I                                       96  98 ULLICD                                   LLN022A
     I I            'Connected '            105 114 CNTP1                                    LLN022A
     I I            'Counterparty:'         115 127 CNTP2                                    LLN022A
     I                                      129 129 LCNTP                                    LLN022A
      *                                                                                      LLN022A
     IIBFROM      DS                                                                          CER001
      * Extended informations from IBLC 2002                                                  CER001
     I                                        1 132 IBFRO1                                    CER001
     I                                      133 264 IBFRO2                                    CER001
     I                                      265 396 IBFRO3                                    CER001
     I                                      397 528 IBFRO4                                    CER001
     I                                      529 660 IBFRO5                                    CER001
      /EJECT
      * Data structures:-
     IPGMDS     ESDSY2PGDSP
      * Program data structure.
     I/COPY WNCPYSRC,SD0010PI01
     IJBDTTM      DS
      * Job date/time.
     I                                        1   60##JDT
     I                                        1   20##JYY
     I                                        3   40##JMM
     I                                        5   60##JDD
     I                                        7  120##JTM
     I                                        7   80##JHH
     I                                        9  100##JNN
     I                                       11  120##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure.
      *
     IRUNDAT      DS
     I                                        1   7 MRDT
     I                                        1   20MRDD                                      262205
     I                                        3   5 MRMM                                      262205
     I                                        6   70MRYY                                      262205
     I                                    P   8  100RDNB
     I                                       11  11 SUC
     I                                       12  12 DFF
     I                                       13  13 MBIN
      *                                                                                       262205
     IRNDATE      DS                                                                          262205
     I                                        1   60RNDT                                      262205
     I                                        1   20RNDY                                      262205
     I                                        3   40RNMN                                      262205
     I                                        5   60RNYY                                      262205
      *                                                                                       262205
     IA@CPY       DS
     I* Copyright array
     I                                        1  80 CPY@
      /EJECT
      * Parameter declarations.
     I/COPY WNCPYSRC,SD0010PI02
     IP1PARM      DS
      * I:    Audit/Request Status Ind
     I                                        1   1 P1ARSI
     IP2PARM      DS
      * I:    RCF sequence number
     I                                        1   5 P2RSQN
     IP3PARM      DS
      * I:    Level
     I                                        1   1 P3LEVL
     IP4PARM      DS
      * I:    Entity
     I                                        1   3 P4ENTY
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Database Error (ICD)'
      * Filename
     I                                        1  10 ZA0001
      *                                                                   S10408
     I/COPY WNCPYSRC,SD0010PIP1                                           S10408
      *                                                                   S10408
     ILDA       EUDSLDA                         256                       CDL006
      ** Local data area for database error details                       CDL006
      *                                                                   CDL006
     I                                      134 183 DBLOT                 CDL006
     I*                                                                   S01413
     ISCSARD    E DSSCSARDPD                                              CDL002
     I** MIDAS Switchable Features Accessed Via Access Program            CDL002
     I*                                                                   CDL002
     I** Data structure for SDMMOD access object                          S01413
     ISDMMOD    E DSSDMMODPD                                              S01413
      *                                                                                       CGL032
      ** External data structure for Bank details                                             CGL032
     ISDBANK    E DSSDBANKPD                                                                  CGL032
      *                                                                                       CGL032
      ** External data structure for Country Details                                          CGL032
     ISDCTRY    E DSSDCTRYPD                                                                  CGL032
      *                                                                                       CER054
      ** External data structure for Federal State Codes                                      CER054
     ISDSTCD    E DSSDGESTPD                                                                  CER054
      *                                                                                       CER054
      ** External data structure for Religious Affiliation Codes                              CER054
     ISDRLAF    E DSSDRLAFPD                                                                  CER054
     I*                                                                   S01413
     I** Short Data Structure for Access Objects                          S01413
     IDSFDY     E DSDSFDY                                                 S01413
     I            DS                                                      113339
     I                                        1   6 E5BRT1                113339
     I                                        1   2 WWBDAY                113339
     I                                        3   40WWBMNT                113339
     I                                        5   6 WWBYR                 113339
     I            DS                                                      113339
     I                                        1   2 WWBDY1                113339
     I                                        3   5 WWBMT1                113339
     I                                        6   7 WWBYR1                113339
     I                                        1   7 WWBRT1                113339
      * Datastructure to output RWA details                               CGL018
      *                                                                   CGL018
     IRWSECO      DS                          1   5                       CGL018
     I                                        1   2 #RCODE                CGL018
     I I            ' '                       3   3 #BLANK                CGL018
     I                                        4   4 #RSET                 CGL018
     I I            ','                       5   5 #COMMA                CGL018
      *                                                                   CGL018
     I              'AddCustDtlFl01'      C         @VAL01                                    CSD029
     I              'AddCustDtlFl02'      C         @VAL02                                    CSD029
     I              'AddCustDtlFl03'      C         @VAL03                                    CSD029
     I              'AddCustDtlFl04'      C         @VAL04                                    CSD029
     I              'AddCustDtlFl05'      C         @VAL05                                    CSD029
     I              'AddCustDtlFl06'      C         @VAL06                                    CSD029
     I              'AddCustDtlFl07'      C         @VAL07                                    CSD029
     I              'AddCustDtlFl08'      C         @VAL08                                    CSD029
     I              'AddCustDtlFl09'      C         @VAL09                                    CSD029
     I              'AddCustDtlFl10'      C         @VAL10                                    CSD029
     I/COPY WNCPYSRC,SDH00087
      *                                                                   CDL006
     IDSSDY     E DSDSSDY                                                 CDL006
      ** Second DS for access programs, long data structure               CDL006
      *                                                                   CDL006
      /EJECT
      *****************************************************************
     C           *ENTRY    PLIST                           Entry parameter
     C/COPY WNCPYSRC,SD0010PC37
     C                     PARM           P0RTN   7        Return code
     C/COPY WNCPYSRC,SD0010PC38
     C           P1ARSI    PARM           WP0001  1        Audit/Request S
     C           P2RSQN    PARM           WP0002  5        RCF sequence nu
     C           P3LEVL    PARM           WP0003  1        Level
     C           P4ENTY    PARM           WP0004  3        Entity
      *****************************************************************
      * Initialise
     C                     EXSR ZZINIT
      *                                                                                       CSW207
     C                     MOVE '0'       *IN88                                               CSW207
     C           CSW207    IFEQ 'Y'                                                           CSW207
     C           BGN4ST    OREQ 'Y'                                                           CSW207
     C                     MOVE '1'       *IN88                                               CSW207
     C                     ENDIF                                                              CSW207
      *                                                                                       CSW207
     C*                                                                   S01408
     C/COPY WNCPYSRC,SD0010PCP8                                           S01408
     C*                                                                   S01408
      *
      * Clear overflow indicator.
     C                     SETOF                     97
     C*
     C/COPY WNCPYSRC,SD0010PC19
     C*
      * Establish starting position.
     C           *LOVAL    SETLL@BBREBF                    *
     C*
     C/COPY WNCPYSRC,SD0010PCP9
     C*
      * Read first record with user selection.
     C                     EXSR GARDRC
     C*
     C/COPY WNCPYSRC,SD0010PC10
     C*
      * Print null report headings.
     C           W0EOF     IFEQ '1'
     C                     WRITEZZPAGHDR
      * USER: Null report processing
      *CASE:     WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ @CN,01                     *IF
      * 00/Copy Member SD0010PNRP - Client Details  *
     C*00/Copy Member SD0010P   Null Report Processing
     C/COPY WNCPYSRC,SD0010PNRP
     C                     END                             *FI
     C                     WRITEZZENDRPT
     C*                                                                   S01421
     C                     ELSE
      * Request all headings.
     C                     MOVEL'Y'       L0      1        Page headings
      * Initialise final totals.
     C                     MOVEL*BLANK    ZTCON            *CON (Screen co
     C                     Z-ADD*ZERO     ZTNCRC           No of Calculate
      *                                                                                       262205
     C                     Z-ADD*ZERO     RNDT                                                262205
      *                                                                                       262205
     C           MRMM      LOKUPTABM      TABD           19                                   262205
     C                     MOVE TABD      RNMN                                                262205
     C                     Z-ADDMRDD      RNDY                                                262205
     C                     Z-ADDMRYY      RNYY                                                262205
      *                                                                                       262205
      * Print report body.
     C           W0EOF     DOWEQ'0'
      *                                                                                       262205
     C                     Z-ADD*ZERO     #NLCD                                               262205
      *                                                                                       262205
      *                                                                                       262205
     C                     CALL 'ZDATE2'                                                      262205
     C                     PARM           BBLCD                                               262205
     C                     PARM           BJDFIN                                              262205
     C                     PARM           #NLCD   60                                          262205
     C                     PARM           ZADATE                                              262205
      *                                                                                       262205
     C           WP0001    IFNE 'A'                                                           262205
     C           WP0001    OREQ 'A'                                                           262205
     C           #NLCD     ANDEQRNDT                                                          262205
      * Print headings.
     C                     EXSR BAPRHD
     C                     ENDIF                                                              262205
      * Print report detail line.
     C                     EXSR CAPRDT
     C*                                                                   S01421
     C* Sub Routine to write Additional Customer Details if feature       S01421
     C* S10425 is installed.                                              S01421
     C*                                                                   S01421
     C           *IN23     IFEQ *ON                                       S01421
     C           W0PFM     ANDEQ'Y'                                       095938
     C           CDL006    OREQ 'Y'                                       CDL006
     C           W0PFM     ANDEQ'Y'                                                           235201
     C                     EXSR ACDTSR                                    S01421
     C                     END                                            S01421
     C*                                                                   S01421
     C           CGL032    IFEQ 'Y'                                                           CGL032
     C           W0PFM     ANDEQ'Y'                                                           235201
     C                     EXSR SRETAX                                                        CGL032
     C                     ENDIF                                                              CGL032
      *                                                                                       CGL032
     C/COPY WNCPYSRC,SD0010PC34
      * Hold current values.
      * Read next record with user selection.
     C                     EXSR GARDRC
      * Determine level changes.
     C                     EXSR DALVCH
      * Print totals.
     C/COPY WNCPYSRC,SDH00088
     C                     EXSR EAPRTT
     C/COPY WNCPYSRC,SDH00089
      * Process necessary heading requests
     C                     EXSR FASGHD
     C*
     C/COPY WNCPYSRC,SD0010PC11
     C*
     C                     END
     C*
     C/COPY WNCPYSRC,SD0010PC12
     C*
     C                     WRITEZZENDRPT
     C                     END
      * Exit program.
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
     C*
     C/COPY WNCPYSRC,SD0010PC13
     C*
      *****************************************************************
      /EJECT
     CSR         BAPRHD    BEGSR
      *================================================================
      * Print report Headers.
      *================================================================
     C           L0        IFEQ 'Y'
     C                     WRITEZZPAGHDR
     C                     END
      *
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT                                                                                  CGL032
     CSR         SRETAX    BEGSR                                                              CGL032
      *================================================================                       CGL032
      * Print additional information of customer                                              CGL032
      *================================================================                       CGL032
      *                                                                                       CGL032
      ** Check if there are more additional information for the customer.                     CGL032
      *                                                                                       CGL032
     C           XRCUST    CHAINSDACUSL1             02                                       CGL032
      *                                                                                       CGL032
     C           *IN02     IFEQ *OFF                                                          CGL032
     C                     MOVE E5TINO    R2TINO                                              CGL032
     C                     MOVE E5IDTP    R2IDTP                                              CGL032
     C                     MOVE E5ISCT    R2ISCT                                              CGL032
     C                     MOVE E5BTHC    R2BTHC                                              CGL032
     C                     MOVE E5BTHT    R2BTHT                                              CGL032
     C                     MOVE E5JATP    R2JATP                                              CGL032
      *                                                                                       CGL032
      ** Alternative TINs                                                                     CGL132
     C                     MOVE E5TIN2    R2TIN2                                              CGL132
     C                     MOVE E5TNC2    R2TNC2                                              CGL132
     C                     MOVE E5TIN3    R2TIN3                                              CGL132
     C                     MOVE E5TNC3    R2TNC3                                              CGL132
     C                     MOVE E5TIN4    R2TIN4                                              CGL132
     C                     MOVE E5TNC4    R2TNC4                                              CGL132
     C                     MOVE E5TIN5    R2TIN5                                              CGL132
     C                     MOVE E5TNC5    R2TNC5                                              CGL132
      *                                                                                       CGL132
     C**********           Z-ADDE5ISDT    ZDAYNO                                       CGL032 232543
     C           2         SUBSTE5ISDT:7  WDD     2                                           232543
     C           2         SUBSTE5ISDT:5  WMM     2                                           232543
     C           2         SUBSTE5ISDT:3  WYY     2                                           232543
     C           WDD       CAT  WMM       WDM     4                                           232543
     C           WDM       CAT  WYY       WDMY    6                                           232543
     C                     MOVE WDMY      DATEIN                                              232543
      *                                                                                       232543
     C                     CALL 'ZDATE1'                                                      232543
     C                     PARM           ZERR    7                                           232543
     C                     PARM           DATEIN  60                                          232543
     C                     PARM           BJDFIN                                              232543
     C                     PARM           ZDAYNO                                              232543
      *                                                                                       232543
     C           ZERR      IFNE *BLANKS                                                       232543
     C                     MOVE *BLANKS   R2ISDT                                              232543
     C                     ELSE                                                               232543
     C                     CALL 'ZDATE2'                                                      CGL032
     C                     PARM           ZDAYNO  50                                          CGL032
     C                     PARM           BJDFIN                                              CGL032
     C                     PARM           ZDATE   60                                          CGL032
     C                     PARM           ZADATE  7                                           CGL032
      *                                                                                       CGL032
     C                     MOVE ZADATE    R2ISDT                                              CGL032
     C                     ENDIF                                                              232543
      *                                                                                       232543
     C           CER047    IFEQ 'Y'                                                          CER034A
     C           CER048    OREQ 'Y'                                                          CER034A
      *                                                                                      CER034A
      ** Title                                                                               CER034A
      *                                                                                      CER034A
     C                     MOVE E5TITL    R2TITL                                             CER034A
      *                                                                                      CER034A
      ** Maiden Name                                                                         CER034A
      *                                                                                      CER034A
     C                     MOVE E5MDNM    R2MDNM                                             CER034A
      *                                                                                      CER034A
      ** Identification Document/Id                                                          CER034A
      *                                                                                      CER034A
     C                     MOVE E5DCID    R2DCID                                             CER034A
      *                                                                                      CER034A
      ** Identification Document/Id Issued Place                                             CER034A
      *                                                                                      CER034A
     C                     MOVE E5DIPL    R2DIPL                                             CER034A
      *                                                                                      CER034A
     C                     ENDIF                                                             CER034A
      *                                                                                      CER034A
     C           CER047    IFEQ 'Y'                                                          CER034A
      *                                                                                      CER034A
     C                     CALL 'ZDATE2'                                                     CER034A
     C                     PARM           ZDAYNO  50                                         CER034A
     C                     PARM           BJDFIN                                             CER034A
     C                     PARM           ZDATE   60                                         CER034A
     C                     PARM           ZADATE  7                                          CER034A
      *                                                                                      CER034A
      ** Expiry Date                                                                         CER034A
      *                                                                                      CER034A
     C           E5EXDT    IFEQ *ZEROS                                                       CER034A
     C                     MOVE *BLANKS   R2EXDT                                             CER034A
      *                                                                                      CER034A
     C                     ELSE                                                              CER034A
     C                     MOVE E5EXDT    ZDAYNO                                             CER034A
      *                                                                                      CER034A
     C                     CALL 'ZDATE2'                                                     CER034A
     C                     PARM           ZDAYNO  50                                         CER034A
     C                     PARM           BJDFIN                                             CER034A
     C                     PARM           ZDATE   60                                         CER034A
     C                     PARM           ZADATE  7                                          CER034A
      *                                                                                      CER034A
     C                     MOVE ZADATE    R2EXDT                                             CER034A
      *                                                                                      CER034A
     C                     ENDIF                                                             CER034A
      *                                                                                      CER034A
      ** Subject to 24C Flag                                                                 CER034A
      *                                                                                      CER034A
     C                     MOVE E5S24C    R2S24C                                             CER034A
      *                                                                                      CER034A
      ** Remarks                                                                             CER034A
      *                                                                                      CER034A
     C                     MOVE E5REM1    R2REM1                                             CER034A
     C                     MOVE E5REM2    R2REM2                                             CER034A
     C                     MOVE E5REM3    R2REM3                                             CER034A
      *                                                                                      CER034A
     C                     ENDIF                                                             CER034A
      *                                                                                       CER054
     C           CER054    IFEQ 'Y'                                                           CER054
      *                                                                                       CER054
      ** State Code                                                                           CER054
      *                                                                                       CER054
     C                     MOVEL*BLANKS   R2STCD                                            AR740375
     C                     MOVEL*BLANKS   R2STNM                                            AR740375
     C           E5STCD    IFNE *BLANKS                                                       CER054
      *                                                                                       CER054
     C                     CALL 'AOSTCDR0'                                                    CER054
     C                     PARM *BLANKS   PRTCD                                               CER054
     C                     PARM '*KEY    'POPTN                                               CER054
     C                     PARM E5STCD    PKEY    2                                           CER054
     C           SDSTCD    PARM SDSTCD    DSFDY                                               CER054
      *                                                                                       CER054
      ** DB Error Management.                                                                 CER054
      *                                                                                       CER054
     C           PRTCD     IFNE *BLANK                                                        CER054
      *                                                                                       CER054
     C           *LOCK     IN   LDA                                                           CER054
     C                     Z-ADD006       DBASE                                               CER054
     C                     MOVEL'SDSTCDPD'DBFILE                                              CER054
     C                     MOVELPOPTN     DBKEY                                               CER054
     C                     OUT  LDA                                                           CER054
     C                     EXSR *PSSR                                                         CER054
     C                     ELSE                                                               CER054
     C                     MOVE GESTCD    R2STCD                                              CER054
     C                     MOVE GESTNM    R2STNM                                              CER054
     C                     ENDIF                                                              CER054
      *                                                                                       CER054
     C                     ENDIF                                                              CER054
      *                                                                                       CER054
      ** Religious Affiliation Code                                                           CER054
      *                                                                                       CER054
     C********** E5RLAF    IFEQ 'NONE'                                               CER054 BUG24052
     C**********           MOVE E5RLAF    R2RLAF                                     CER054 BUG24052
     C**********           ENDIF                                                     CER054 BUG24052
      *                                                                                       CER054
     C                     MOVEL*BLANKS   R2RLAF                                            AR740375
     C                     MOVEL*BLANKS   R2NARR                                            AR740375
     C           E5RLAF    IFNE *BLANKS                                                       CER054
     C********** E5RLAF    ANDNE'NONE'                                               CER054 BUG24052
      *                                                                                       CER054
     C                     CALL 'AORLAFR0'                                                    CER054
     C                     PARM *BLANKS   PRTCD                                               CER054
     C                     PARM '*KEY    'POPTN                                               CER054
     C                     PARM E5RLAF    PKEY2   4                                           CER054
     C           SDRLAF    PARM SDRLAF    DSFDY                                               CER054
      *                                                                                       CER054
      ** DB Error Management.                                                                 CER054
      *                                                                                       CER054
     C           PRTCD     IFNE *BLANK                                                        CER054
     C           *LOCK     IN   LDA                                                           CER054
     C                     Z-ADD010       DBASE                                               CER054
     C                     MOVEL'SDRLAFPD'DBFILE                                              CER054
     C                     MOVELPOPTN     DBKEY                                               CER054
     C                     OUT  LDA                                                           CER054
     C                     EXSR *PSSR                                                         CER054
     C                     ELSE                                                               CER054
     C                     MOVE AFRLAF    R2RLAF                                              CER054
     C                     MOVE AFNARR    R2NARR                                              CER054
     C                     ENDIF                                                              CER054
      *                                                                                       CER054
     C                     ENDIF                                                              CER054
      *                                                                                       CER054
     C                     ENDIF                                                              CER054
      *                                                                                      CER034A
     C           CER048    IFEQ 'Y'                                                          CER034A
      *                                                                                      CER034A
      ** Spouse Reference                                                                    CER034A
      *                                                                                      CER034A
     C                     MOVE E5SHRF    R2SHRF                                             CER034A
      *                                                                                      CER034A
      ** Partner/Associate Indicator                                                         CER034A
      *                                                                                      CER034A
     C                     MOVE E5PIND    R2PIND                                             CER034A
      *                                                                                      CER034A
      ** Exemption Threshold                                                                 CER034A
      *                                                                                      CER034A
     C                     MOVE E5EXTH    R2EXTH                                             CER034A
      *                                                                                      CER034A
      ** Exemption Threshold Approval Date                                                   CER034A
      *                                                                                      CER034A
     C           E5EADT    IFEQ *ZEROS                                                       CER034A
     C                     MOVE *BLANKS   R2EADT                                             CER034A
      *                                                                                      CER034A
     C                     ELSE                                                              CER034A
     C                     MOVE E5EADT    ZDAYNO                                             CER034A
      *                                                                                      CER034A
     C                     CALL 'ZDATE2'                                                     CER034A
     C                     PARM           ZDAYNO  50                                         CER034A
     C                     PARM           BJDFIN                                             CER034A
     C                     PARM           ZDATE   60                                         CER034A
     C                     PARM           ZADATE  7                                          CER034A
      *                                                                                      CER034A
     C                     MOVE ZADATE    R2EADT                                             CER034A
      *                                                                                      CER034A
     C                     ENDIF                                                             CER034A
      *                                                                                      CER034A
      ** Exemption Threshold Value Date                                                      CER034A
      *                                                                                      CER034A
     C           E5EVDT    IFEQ *ZEROS                                                       CER034A
     C                     MOVE *BLANKS   R2EVDT                                             CER034A
      *                                                                                      CER034A
     C                     ELSE                                                              CER034A
     C                     MOVE E5EVDT    ZDAYNO                                             CER034A
      *                                                                                      CER034A
     C                     CALL 'ZDATE2'                                                     CER034A
     C                     PARM           ZDAYNO  50                                         CER034A
     C                     PARM           BJDFIN                                             CER034A
     C                     PARM           ZDATE   60                                         CER034A
     C                     PARM           ZADATE  7                                          CER034A
      *                                                                                      CER034A
     C                     MOVE ZADATE    R2EVDT                                             CER034A
      *                                                                                      CER034A
     C                     ENDIF                                                             CER034A
      *                                                                                      CER034A
      ** Exemption Threshold Expiry Date                                                     CER034A
      *                                                                                      CER034A
     C           E5ETXT    IFEQ *ZEROS                                                       CER034A
     C                     MOVE *BLANKS   R2ETXT                                             CER034A
      *                                                                                      CER034A
     C                     ELSE                                                              CER034A
     C                     MOVE E5ETXT    ZDAYNO                                             CER034A
      *                                                                                      CER034A
     C                     CALL 'ZDATE2'                                                     CER034A
     C                     PARM           ZDAYNO  50                                         CER034A
     C                     PARM           BJDFIN                                             CER034A
     C                     PARM           ZDATE   60                                         CER034A
     C                     PARM           ZADATE  7                                          CER034A
      *                                                                                      CER034A
     C                     MOVE ZADATE    R2ETXT                                             CER034A
      *                                                                                      CER034A
     C                     ENDIF                                                             CER034A
      *                                                                                      CER034A
      ** Characteristic of Demand/Claim                                                      CER034A
      *                                                                                      CER034A
     C                     MOVE E5CDCL    R2CDCL                                             CER034A
      *                                                                                      CER034A
     C                     ENDIF                                                             CER034A
      *                                                                                      CER034A
     C           CER034    IFEQ 'Y'                                                          CER034A
      *                                                                                      CER034A
      ** FX Customer                                                                         CER034A
      *                                                                                      CER034A
     C                     MOVE E5FXCU    R2FXCU                                             CER034A
      *                                                                                      CER034A
      ** Securities Customer                                                                 CER034A
      *                                                                                      CER034A
     C                     MOVE E5SECU    R2SECU                                             CER034A
      *                                                                                      CER034A
      ** Staff Member                                                                        CER034A
      *                                                                                      CER034A
     C                     MOVE E5SMBR    R2SMBR                                             CER034A
      *                                                                                      CER034A
     C                     ENDIF                                                             CER034A
      *                                                                                      CER034A
     C           CER038    IFEQ 'Y'                                                          CER034A
      *                                                                                      CER034A
      ** Language ID                                                                         CER034A
      *                                                                                      CER034A
     C                     MOVE E5LNID    R2LNID                                             CER034A
      *                                                                                      CER034A
      ** Correspondent Type                                                                  CER034A
      *                                                                                      CER034A
     C                     MOVE E5CTYP    R2CTYP                                             CER034A
      *                                                                                      CER034A
     C                     ENDIF                                                             CER034A
      *                                                                                      CER034A
     C           CER041    IFEQ 'Y'                                                          CER034A
      *                                                                                      CER034A
      ** Zero Confirmation Flag                                                              CER034A
      *                                                                                      CER034A
     C                     MOVE E5ZCFG    R2ZCFG                                             CER034A
      *                                                                                      CER034A
     C                     ENDIF                                                             CER034A
      *                                                                                      CER034A
     C           CER045    IFEQ 'Y'                                                           CER045
      *                                                                                       CER045
      ** Borrower Sector Classification Code                                                  CER045
      ** Economic Activity Code                                                               CER045
      ** Borrower Sector Classification/BISTA                                                 CER045
      ** Additional Borrowers Statistics Key                                                  CER045
      ** Customer Required for Bundesbank Reporting                                           CER045
      ** Risk Classification Code                                                             CER070
      ** Legal Form                                                                           CER071
      *                                                                                       CER045
     C                     MOVE E5BSCC    R2BSCC                                              CER045
     C                     MOVE E5ECAC    R2ECAC                                              CER045
     C                     MOVE E5BIST    R2BIST                                              CER045
     C                     MOVE E5ABSK    R2ABSK                                              CER045
     C                     MOVE E5BEXT    R2BEXT                                              CER045
     C                     MOVE E5RIGR    R2RIGR                                              CER070
     C                     MOVE E5RECH    R2RECH                                              CER071
      *                                                                                       CER045
     C                     ENDIF                                                              CER045
      *                                                                                       CER045
     C           @$OFL     SUB  @$CLN     WREM    20                                         CER034A
     C********** WREM      IFGE 28                                                    CER034A CER071
     C           WREM      IFGE 29                                                            CER071
     C                     WRITEREUTX1                                                        CGL032
     C                     ELSE                                                              CER034A
     C                     WRITEZZPAGHDR                                                     CER034A
     C                     WRITEREUTX1                                                       CER034A
     C                     END                                                               CER034A
      *                                                                                       CGL032
      ** If the Joint Account Type is 'I' or 'Y', print additional info.                      CGL032
      *                                                                                       CGL032
     C           E5JATP    IFEQ 'I'                                                           CGL032
     C           E5JATP    OREQ 'Y'                                                           CGL032
      *                                                                                       CGL032
      ** Establish starting position.                                                         CGL032
      *                                                                                       CGL032
     C           *LOVAL    SETLLSDACTXD0                                                      CGL032
     C                     READ SDACTXD0                 01                                   CGL032
      *                                                                                       CGL032
     C           *IN01     DOWEQ*OFF                                                          CGL032
     C           XRCUST    IFEQ AXCUST                                                        CGL032
     C                     MOVE AXCTTX    R3CTTX                                              CGL032
     C                     MOVE AXETXS    R3ETXS                                              CGL032
     C                     MOVE AXCERF    R3CERF                                              CGL032
      *                                                                                       CGL032
     C                     Z-ADDAXCEEX    ZDAYNO                                              CGL032
     C                     CALL 'ZDATE2'                                                      CGL032
     C                     PARM           ZDAYNO  50                                          CGL032
     C                     PARM           BJDFIN                                              CGL032
     C                     PARM           ZDATE   60                                          CGL032
     C                     PARM           ZADATE  7                                           CGL032
      *                                                                                       CGL032
     C                     MOVE ZADATE    R3CEEX                                              CGL032
      *                                                                                       CGL032
     C                     CALL 'AOCTRYR0'                                                    CGL032
     C                     PARM *BLANKS   PRTCD                                               CGL032
     C                     PARM '*KEY    'POPTN                                               CGL032
     C                     PARM AXCTTX    PKEY    2                                           CGL032
     C           SDCTRY    PARM SDCTRY    DSFDY                                               CGL032
      *                                                                                       CGL032
      ** DB Error Management.                                                                 CGL032
      *                                                                                       CGL032
     C           PRTCD     IFNE *BLANK                                                        CGL032
     C           *LOCK     IN   LDA                                                           CGL032
     C                     Z-ADD007       DBASE            ************                       CGL032
     C                     MOVEL'SDCTRYPD'DBFILE           * DBERR  07*                       CGL032
     C                     MOVELPOPTN     DBKEY            ************                       CGL032
     C                     OUT  LDA                                                           CGL032
     C                     EXSR *PSSR                                                         CGL032
     C                     ENDIF                                                              CGL032
      *                                                                                       CGL032
     C                     MOVE A4CNNM    R3CNNM                                              CGL032
     C                     MOVE AXCSTS    R3CSTS                                              236137
      *                                                                                       CGL032
      ** Check for overflow, print header if so.                                              CGL032
      *                                                                                       CGL032
     C           W0OFL     SUB  @$CLN     @$WRK                                               CGL032
     C           @$WRK     IFLE @$HDL                                                         CGL032
     C                     WRITEZZPAGHDR                                                      CGL032
     C                     ENDIF                                                              CGL032
      *                                                                                       CGL032
     C                     WRITEREUTX2                                                        CGL032
     C                     ENDIF                                                              CGL032
      *                                                                                       CGL032
     C                     READ SDACTXD0                 01                                   CGL032
     C                     ENDDO                                                              CGL032
      *                                                                                       CGL032
     C                     ENDIF                                                              CGL032
      *                                                                                       CGL032
     C                     ENDIF                                                              CGL032
      *================================================================                       CGL032
     CSR                   ENDSR                                                              CGL032
      /EJECT
     CSR         CAPRDT    BEGSR
      *================================================================
      * Print report detail line.
      *================================================================
      * Load detail line.
      *                                                                   S01383
      ***  Remove fields that serve no purpose (and dummy definitions     S01383
      ***  in the print file). But, must define ones that are used.       S01383
      *                                                                   S01383
     C***********          Z-ADDBBLCD     XRLCD            Last Change DatS01383
     C***********          Z-ADD*ZERO     XRCLCD           CD Laste changeS01383
     C***********          MOVELBBTYLC    XRTYLC           Type of Last ChS01383
     C***********          MOVELBBDRCS    XRDRCS           DRS Customer ShS01383
     C***********          MOVELBBLCCD    XRLCCD           Location Code  S01383
     C***********          Z-ADD*ZERO     XRCDFC           CD date of firsS01383
     C***********          Z-ADDBBSSDT    XRSSDT           Suspended Date S01383
     C***********          Z-ADDBBLRLD    XRLRLD           Last Retail LetS01383
     C***********          Z-ADDBBLALD    XRLALD           Last Audit LettS01383
     C***********          Z-ADDBBLDHD    XRLDHD           Last Dels HistoS01383
     C***********          Z-ADDBBDTDL    XRDTDL           Date Deleted   S01383
     C***********          MOVELBBSTFG    XRSTFG           SWIFT or Telex S01383
     C***********          MOVELBBLETI    XRLETI           LE Past/Int TelS01383
     C***********          MOVELBBCMTI    XRCMTI           Customer ModuleS01383
     C***********          MOVELBBGSFM    XRGSFM           Generate SWIFT S01383
     C***********          Z-ADDBBDOIC    XRDOIC           Date of InitialS01383
      *                                                                   S01383
     C/COPY WNCPYSRC,SD0010PC28
      *                                                                                       CSW207
      ** Get Customer Details Swift Extension                                                 CSW207
      *                                                                                       CSW207
     C           CSW207    IFEQ 'Y'                                                           CSW207
     C           BGN4ST    OREQ 'Y'                                                           CSW207
     C           BBCUST    CHAINSDCSSWL1             02                                       CSW207
     C           *IN02     IFEQ *OFF                                                          CSW207
     C                     MOVELCSCICI    XRCICI           Investor Capacity                  CSW207
     C                     MOVELCSCPCI    XRCPCI           Party Capacity                     CSW207
     C                     ENDIF                                                              CSW207
     C                     ENDIF                                                              CSW207
     C                     MOVELCSIBEI    XRIBEI           IBEI Code                          CSW207
      *                                                                                       CSW207
     C           BBCUST    CHAINSDCUSXL1             02                                       CGL132
     C           *IN02     IFEQ *OFF                                                          CGL132
     C                     MOVELXCACCZ    XRACCZ           Alt Ctry of Citi                   CGL132
     C           XCCRDT    IFEQ 0                                                             CGL132
     C                     MOVE *BLANK    XRCRDT           Creation Date                      CGL132
     C                     ELSE                                                               CGL132
     C                     MOVE XCCRDT    XRCRDT           Creation Date                      CGL132
     C                     ENDIF                                                              CGL132
     C                     ENDIF                                                              CGL132
     C                     MOVE XCLCUS    XRLCUS           Username                           CGL132
     C                     MOVE XCDRMT    XRDRMT           Dormant Indicat                    CGL132
      *                                                                                       CGL132
     C                     Z-ADDBBLCD     XRLCD   50                      S01383
     C                     Z-ADD*ZERO     XRCLCD  60                      S01383
     C                     MOVELBBTYLC    XRTYLC  1                       S01383
      *                                                                   S01383
     C                     MOVELBBCUST    XRCUST           Customer Number
     C                     MOVELBBCNA1    XRCNA1           Cust. Name & Ad
     C                     MOVELBBCRNM    XRCRNM           Customer Report
     C                     MOVELBBPAIN    XRPAIN           Parent Indicato
     C                     MOVEL*BLANK    XRACDT           alpha change da
     C                     MOVEL*BLANK    XRALCH           alpha of last c
     C                     MOVELBBCSSN    XRCSSN           Customer Shortn
     C                     MOVELBBCNA2    XRCNA2           Cust. Name & Ad
     C                     MOVELBBCRTN    XRCRTN           Customer Report
     C                     MOVELBBPCNB    XRPCNB           Parent Customer
     C                     MOVELBBCNA3    XRCNA3           Cust. Name & Ad
     C                     MOVELBBBRCD    XRBRCD           Branch code
     C                     MOVEL*BLANK    XRCSTA           Customer Status
     C                     MOVELBBCNA4    XRCNA4           Cust. Name & Ad
     C                     Z-ADDBBDTDL    XRDTDL  50       Date Deleted                     MD025682
     C           CSW207    IFEQ 'Y'                                                           CSW207
     C           BGN4ST    OREQ 'Y'                                                           CSW207
     C                     MOVELCSCICI    XRCICI           Investor Capacity                  CSW207
     C                     MOVELCSCPCI    XRCPCI           Party Capacity                     CSW207
     C                     ENDIF                                                              CSW207
     C                     MOVELCSIBEI    XRIBEI           IBEI Code                          CSW207
     C                     MOVELBBBSIN    XRBSIN           Branch/Subsidia
     C                     MOVELBBBNBI    XRBNBI           Bank/non-bank I
     C                     MOVELBBCTNB    XRCTNB           Customer Teleph
     C                     MOVELBBCNCZ    XRCNCZ           Country of Citi
     C                     MOVELBBLICD    XRLICD           Local Industry
     C                     MOVELBBCOLC    XRCOLC           Country of Loca
     C/COPY WNCPYSRC,SD0010PC08
     C                     MOVELBBLINC    XRLINC           Local Instituti
     C/COPY WNCPYSRC,SD0010PC09
     C                     MOVELBBTXA1    XRTXA1           MIDAS Telex Sho
     C                     MOVELBBACOC    XRACOC           Account Officer
     C                     MOVELBBCSTY    XRCSTY           Customer Type
     C                     MOVELBBTXA2    XRTXA2           Telex Address 2
     C                     MOVELBBRWCD    XRRWCD           Risk Weighting
     C                     MOVELBBSWFI    XRSWFI           SWIFT Fin Inst 099441
     C                     MOVELBBTAIN    XRTAIN           Taxable Indicat
     C                     MOVELBBTXA3    XRTXA3           Telex Address 3
     C                     MOVELBBTXA4    XRTXA4           Telex Address 4
     C                     MOVELBBTXA5    XRTXA5           Telex Address 5
     C                     MOVEL*BLANK    XRRFCD           Report First Co
     C                     MOVELBBREID    XRREID           Reuter Id.
     C                     MOVELBBCSID    XRCSID           Customer Swift
     C                     MOVEL*BLANK    XRRSUD           Report Suspende
     C/COPY WNCPYSRC,SD0010PC26
     C                     MOVELBBCASC    XRCASC           Customer Alpha
     C/COPY WNCPYSRC,SD0010PC27
     C                     MOVELBBSTAD    XRSTAD           STTX Address
     C                     MOVEL*BLANK    XRRDTD           Report Date Del
     C                     Z-ADDBBCHSC    XRCHSC           Chaps sort code
     C                     MOVEL*BLANK    XRRRLD           Report Retail L
     C                     MOVELBBBFIC    XRBFIC           BOJ Fin. Inst.
      *                                                                                       CSW213
     C           CSW213    IFEQ 'Y'                                                           CSW213
     C                     MOVELCSLEIC    XRLEIC                                              CSW213
     C                     MOVELCSCLSY    XRCLSY                                              CSW213
     C                     MOVELCSCLID    XRCLID                                              CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C           CFT050    IFEQ 'Y'                                                           CSW213
     C                     MOVELCSBDRK    XRBDRK                                              CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C**********           Z-ADDBBCABA    XRCABA           Chips ABA      151482
     C                     Z-ADDBBABA2    XRCABA           Chips ABA      151482
     C                     MOVEL*BLANK    XRRALD           Report Audit Le
     C                     Z-ADDBBFWCD    XRFWCD           Fedwire Code
     C                     Z-ADDBBCHID    XRCHID           Chips Id
     C                     MOVEL*BLANK    XRRDHD           Report Dels His
     C                     MOVELBBBLCD    XRBLCD           Bankleitzahl Co
     C                     MOVELBBNG01    XRNG01           Message Type No
     C                     MOVELBBNG02    XRNG02           Message Type No
     C                     MOVELBBNG03    XRNG03           Message Type No
     C                     MOVELBBNG04    XRNG04           Message Type No
     C                     MOVELBBNG05    XRNG05           Message Type No
     C                     MOVELBBNG06    XRNG06           Message Type No
     C                     MOVELBBNG07    XRNG07           Message Type No
     C                     MOVELBBNG08    XRNG08           Message Type No
     C                     MOVELBBNG09    XRNG09           Message Type No
     C                     MOVELBBNG10    XRNG10           Message Type No
     C                     MOVELBBNG11    XRNG11           Message Type No
     C                     MOVELBBNG12    XRNG12           Message Type No
     C                     MOVELBBNG13    XRNG13           Message Type No
     C                     MOVELBBNG14    XRNG14           Message Type No
     C                     MOVELBBNG15    XRNG15           Message Type No
     C                     MOVELBBDS01    XRDS01           Default Status
     C                     MOVELBBDS02    XRDS02           Default Status
     C                     MOVELBBDS03    XRDS03           Default Status
     C                     MOVELBBDS04    XRDS04           Default Status
     C                     MOVELBBDS05    XRDS05           Default Status
     C                     MOVELBBDS06    XRDS06           Default Status
     C                     MOVELBBDS07    XRDS07           Default Status
     C                     MOVELBBDS08    XRDS08           Default Status
     C                     MOVELBBDS09    XRDS09           Default Status
     C                     MOVELBBDS10    XRDS10           Default Status
     C                     MOVELBBDS11    XRDS11           Default Status
     C                     MOVELBBDS12    XRDS12           Default Status
     C                     MOVELBBDS13    XRDS13           Default Status
     C                     MOVELBBDS14    XRDS14           Default Status
     C                     MOVELBBDS15    XRDS15           Default Status
     C                     MOVELBBDNW1    XRDNW1           Default Network
     C                     MOVELBBDNW2    XRDNW2           Default Network
     C                     MOVELBBDNW3    XRDNW3           Default Network
     C                     MOVELBBDNW4    XRDNW4           Default Network
     C                     MOVELBBDNW5    XRDNW5           Default Network
     C                     MOVELBBDNW6    XRDNW6           Default Network
     C                     MOVELBBDNW7    XRDNW7           Default Network
     C                     MOVELBBDNW8    XRDNW8           Default Network
     C                     MOVELBBDNW9    XRDNW9           Default Network
     C                     MOVEL*BLANK    XRWNFF           Window Function
     C                     MOVELBBDINC    XRDINC           Designtd In CcyCEU014
      *                                                                                       CGP001
      ** Move the Global Processing fields to screen                                          CGP001
      ** if CGP001 is enabled.                                                                CGP001
      *                                                                                       CGP001
     C           CGP001    IFEQ 'Y'                                                           CGP001
     C                     EXSR SRGPCU                                                        CGP001
     C                     ENDIF                                                              CGP001
      *                                                                                       CGP001
      *                                                                                       CSD025
      ** Move De-Activated flag in position                                                   CSD025
      ** if CSD025 is enabled.                                                                CSD025
      *                                                                                       CSD025
     C           CSD025    IFEQ 'Y'                                                           CSD025
      *                                                                                       CSD025
     C                     MOVE BBDEAC    XRDEAC                                              CSD025
     C                     MOVE *BLANKS   XRDEDT                                              CSD025
      *                                                                                       CSD025
     C           BBDEDT    IFNE 0                                                             CSD025
      * Check File Date - Rundate  *                                                          CSD025
     C                     CALL 'ZDATE2'               90  Check File Date                    CSD025
     C                     PARM BBDEDT    WQ0001  50       Work Midas Date                    CSD025
     C                     PARM WUDFF     WQ0002  1        Date format fla                    CSD025
     C                     PARM *ZERO     WQ0003  60       Work Converted                     CSD025
     C                     PARM *BLANK    WQ0004  7        Work Alpha Date                    CSD025
      *                                                                                       CSD025
     C                     MOVE WQ0003    XRDEDT                                              CSD025
      *                                                                                       CSD025
     C           *IN90     IFEQ '1'                                                           CSD025
      * Call to program ended in error.                                                       CSD025
     C                     MOVEL'Y2U0021' W0RTN   7                                           CSD025
     C                     ENDIF                                                              CSD025
     C                     ENDIF                                                              CSD025
      *                                                                                       CSD025
     C                     ENDIF                                                              CSD025
      *                                                                                       CSD025
      ** Move Fund Account Number into position                           CSW037A
      ** if CSW037 is enabled.                                            CSW037A
      *                                                                   CSW037A
     C           CSW037    IFEQ 'Y'                                       CSW037A
     C                     MOVE BBFNAC    XRFNAC                          CSW037A
     C                     ENDIF                                          CSW037A
      *                                                                   CSW037A
     C           CSW024    IFEQ 'Y'                                                           CSW024
     C                     MOVELBBCORP    XRCORP                                              CSW024
     C                     MOVELBBCBEI    XRCBEI                                              CSW024
     C                     MOVELBBFUND    XRFUND                                              CSW024
     C                     MOVELBBRI01    XRRI01                                              CSW024
     C                     MOVELBBRI02    XRRI02                                              CSW024
     C                     MOVELBBRI03    XRRI03                                              CSW024
     C                     MOVELBBRI04    XRRI04                                              CSW024
     C                     MOVELBBRI05    XRRI05                                              CSW024
     C                     ENDIF                                                              CSW024
     C/COPY WNCPYSRC,SDH00578
      *                                                                                       CLE025
     C           CLE025    IFEQ 'Y'                                                           CLE025
     C           CFX001    OREQ 'Y'                                                           CFX001
     C                     MOVE BBFCMF    XRFCMF                                              CLE025
     C                     MOVE BBINOF    XRINOF                                              CLE025
     C                     MOVE BBMSTF    XRMSTF                                              CLE025
     C                     MOVE BBIOPC    XRIOPC                                              CLE025
     C                     ENDIF                                                              CLE025
     C*                                                                   S01408
     C/COPY WNCPYSRC,SD0010PC24                                           S01408
     C*                                                                   S01408
     C                     MOVEL*BLANK    XRWNF1           Window Function
     C                     MOVEL*BLANK    XRWNF2           Window Function
     C                     MOVEL'Y'       W0PFM
     C*                                                                   S01408
     C/COPY WNCPYSRC,SD0010PCP1                                           S01408
     C*                                                                   S01408
     C*                                                                   S01408
     C           ULX004    IFEQ 'Y'                                                           CER001
      *                                                                                       CER001
      ** EUROPEAN REPORTING DETAILS                                                           CER001
      *                                                                                       CER001
     C                     MOVE BBCUST    WWCUST  6                                           CER001
     C           WWCUST    CHAINSDCUX2L0             95                                       CER001
     C           *IN95     IFEQ '0'                                                           CER001
     C                     Z-ADDVFCONS    XRCONS                                              CER001
     C                     Z-ADDVFECOS    XRECOS                                              CER001
     C                     Z-ADDVFNCOS    XRNCOS                                              CER001
     C                     Z-ADDVFINRF    XRINRF                                              CER001
     C**********           Z-ADDVFCGRP    XRCGRP                                      CER001 CSD027A
     C                     MOVE VFCGRP    XRCGRP                                             CSD027A
     C                     Z-ADDVFPAPS    XRPAPS                                              CER001
     C                     MOVE VFPERF    XRPERF                                              CER001
     C                     MOVE VFSMRS    XRSMRS                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
      **  If feature UlX012 is installed                                                      CER001
      *                                                                                       CER001
     C           ULX012    IFEQ 'Y'                                                           CER001
     C                     MOVE VFAUTG    XRAUTG                                              CER001
     C                     MOVE VFPROG    XRPROG                                              CER001
     C                     MOVE VFASSP    XRASSP                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
      ** If feature UlX008 is installed                                                       CER001
      *                                                                                       CER001
     C           ULX008    IFEQ 'Y'                                                           CER001
     C                     MOVE VFICCD    XRICCD                                              CER001
     C                     MOVE VFMCID    XRMCID                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
      ** If feature UlX048 is installed                                                       CER001
      *                                                                                       CER001
     C           ULX048    IFEQ 'Y'                                                           CER001
     C                     MOVE VFMCID    XRMCID                                              CER001
     C                     ENDIF                                                              CER001
     C                     ELSE                                                               CER001
     C                     Z-ADD0         XRCONS                                              CER001
     C                     Z-ADD0         XRECOS                                              CER001
     C                     Z-ADD0         XRNCOS                                              CER001
     C                     Z-ADD0         XRINRF                                              CER001
     C**********           Z-ADD0         XRCGRP                                      CER001 CSD027A
     C                     MOVE *BLANKS   XRCGRP                                             CSD027A
     C                     Z-ADD0         XRPAPS                                              CER001
     C                     MOVE ' '       XRPERF                                              CER001
     C                     MOVE ' '       XRSMRS                                              CER001
      *                                                                                       CER001
      **  If feature UlX012 is installed                                                      CER001
      *                                                                                       CER001
     C           ULX012    IFEQ 'Y'                                                           CER001
     C                     MOVE ' '       XRAUTG                                              CER001
     C                     MOVE ' '       XRPROG                                              CER001
     C                     MOVE ' '       XRASSP                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
      ** If both features ULX012 and ULX012 are installed                                     CER001
      *                                                                                       CER001
     C           ULX012    IFEQ 'Y'                                                           CER001
     C                     MOVE *BLANKS   XRPLGT                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
      **  If feature UlX008 is installed                                                      CER001
      *                                                                                       CER001
     C           ULX008    IFEQ 'Y'                                                           CER001
     C                     MOVE ' '       XRICCD                                              CER001
     C                     MOVE ' '       XRMCID                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
      **  If feature UlX048 is installed                                                      CER001
      *                                                                                       CER001
     C           ULX048    IFEQ 'Y'                                                           CER001
     C                     MOVE ' '       XRMCID                                              CER001
     C                     ENDIF                                                              CER001
     C                     ENDIF                                                              CER001
     C/COPY WNCPYSRC,SD0010PCP2                                           S01408
     C*                                                                   S01408
      *                                                                                       CER001
      ** ULX043 Treatment                                                                     CER001
      *                                                                                       CER001
     C           ULX043    IFEQ 'Y'                                                           CER001
     C                     CALL 'IL0450'                                                      CER001
     C                     PARM BBCUST    PCNUM   6                                           CER001
     C                     PARM *BLANKS   IBFROM                                              CER001
     C                     PARM *BLANK    ILFLAG  1                                           CER001
      *                                                                                       CER001
     C           ILFLAG    IFEQ '0'                                                           CER001
     C                     MOVEAIBFROM    BLC                                                 CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C                     ENDIF                                                              CER001
      *                                                                   S01383
      ***  If BRT SAR is installed, determine the sets of Holder data     S01383
      ***  that will be printed. (Controlled by Indicators 11 - 15).      S01383
      *                                                                   S01383
     C           S01383    IFEQ 'Y'                                       S01383
     C                     MOVEA'00000'   *IN,11                          S01383
      *                                                                   S01383
      ***  If A/c Holder Type is 'J', sets 1 and 2 will be printed.       S01383
      *                                                                   S01383
     C           ACHLRT    IFEQ 'J'                                       S01383
     C                     SETON                     1112                 S01383
     C                     END                                            S01383
      *                                                                   S01383
      **If*A/c*Holder*Type*is*'I',*at*least*set*1*will*be*printed* S01383 CRE007
      ** If A/c Holder Type is 'I' or 'R', at least set 1 will be printed CRE007
      *                                                                   S01383
     C           ACHLRT    IFEQ 'I'                                       S01383
     C           ACHLRT    OREQ 'R'                                       CRE007
     C                     SETON                     11                   S01383
      *                                                                   S01383
      ***  Then, for sets 2 to 5, each set will be printed if its BRT     S01383
      ***  Liable Flag is 'Y', 'X' or 'N', but if a set has a blank BRT   S01383
      ***  Liable Flag, then all subsequent sets for this customer are    S01383
      ***  blank.                                                         S01383
      *                                                                   S01383
     C           H2BRTL    IFEQ 'Y'                                       S01383
     C           H2BRTL    OREQ 'X'                                       S01383
     C           H2BRTL    OREQ 'N'                                       S01383
     C                     SETON                     12                   S01383
      *                                                                   S01383
     C           H3BRTL    IFEQ 'Y'                                       S01383
     C           H3BRTL    OREQ 'X'                                       S01383
     C           H3BRTL    OREQ 'N'                                       S01383
     C                     SETON                     13                   S01383
      *                                                                   S01383
     C           H4BRTL    IFEQ 'Y'                                       S01383
     C           H4BRTL    OREQ 'X'                                       S01383
     C           H4BRTL    OREQ 'N'                                       S01383
     C                     SETON                     14                   S01383
      *                                                                   S01383
     C           H5BRTL    IFEQ 'Y'                                       S01383
     C           H5BRTL    OREQ 'X'                                       S01383
     C           H5BRTL    OREQ 'N'                                       S01383
     C                     SETON                     15                   S01383
     C                     END                                            S01383
      *                                                                   S01383
     C                     END                                            S01383
     C                     END                                            S01383
     C                     END                                            S01383
      *                                                                   S01383
      ***  END of ACHLRT = 'I'.                                           S01383
     C                     END                                            S01383
      ***  END of BRT SAR installed (S01383 = 'Y').                       S01383
     C                     END                                            S01383
     C*                                                                   S01421
     C*                                                                   S01421
     C           *IN22     IFEQ '1'                                       S01421
     C                     MOVE BBCDEL    XRCEAD  1                       S01421
     C                     END                                            S01421
     C*                                                                   S01421
     C*                                                                   S01408
     C/COPY WNCPYSRC,SD0010PC22                                           S01408
     C*                                                                   S01408
      *                                                                   S01383
      * USER: Process detail record
      * Check File Date - Rundate  *
     C                     CALL 'ZDATE2'               90  Check File Date
     C                     PARM BBLCD     WQ0001  50       Work Midas Date
     C                     PARM WUDFF     WQ0002  1        Date format fla
     C           XRCLCD    PARM *ZERO     WQ0003  60       Work Converted
     C           WUWADT    PARM *BLANK    WQ0004  7        Work Alpha Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Start of Fix LN0562
      * Change the processing so that the alpha date is displayed
      * instead of the DDMMYY style format
      * Check File Date - Rundate  *
     C                     CALL 'ZDATE2'               90  Check File Date
     C                     PARM BBDOIC    WQ0005  50       Work Midas Date
     C                     PARM WUDFF     WQ0006  1        Date format fla
     C           WUWCDT    PARM *ZERO     WQ0007  60       Work Converted
     C           WUWADT    PARM *BLANK    WQ0008  7        Work Alpha Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
     C                     MOVELWUWADT    XRRFCD           Report First Co
      * Check File Date - Rundate  *
     C                     CALL 'ZDATE2'               90  Check File Date
     C                     PARM BBSSDT    WQ0009  50       Work Midas Date
     C                     PARM WUDFF     WQ0010  1        Date format fla
     C           WUWCDT    PARM *ZERO     WQ0011  60       Work Converted
     C           WUWADT    PARM *BLANK    WQ0012  7        Work Alpha Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
     C                     MOVELWUWADT    XRRSUD           Report Suspende
      * Check File Date - Rundate  *
     C                     CALL 'ZDATE2'               90  Check File Date
     C                     PARM BBLDHD    WQ0013  50       Work Midas Date
     C                     PARM WUDFF     WQ0014  1        Date format fla
     C           WUWCDT    PARM *ZERO     WQ0015  60       Work Converted
     C           WUWADT    PARM *BLANK    WQ0016  7        Work Alpha Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
     C                     MOVELWUWADT    XRRDHD           Report Dels His
      * Check File Date - Rundate  *
     C                     CALL 'ZDATE2'               90  Check File Date
     C                     PARM BBLRLD    WQ0017  50       Work Midas Date
     C                     PARM WUDFF     WQ0018  1        Date format fla
     C           WUWCDT    PARM *ZERO     WQ0019  60       Work Converted
     C           WUWADT    PARM *BLANK    WQ0020  7        Work Alpha Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
     C                     MOVELWUWADT    XRRRLD           Report Retail L
      * Check File Date - Rundate  *
     C                     CALL 'ZDATE2'               90  Check File Date
     C                     PARM BBDTDL    WQ0021  50       Work Midas Date
     C                     PARM WUDFF     WQ0022  1        Date format fla
     C           WUWCDT    PARM *ZERO     WQ0023  60       Work Converted
     C           WUWADT    PARM *BLANK    WQ0024  7        Work Alpha Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
     C                     MOVELWUWADT    XRRDTD           Report Date Del
      * Check File Date - Convert to Screen Format *                                          CGL132
     C                     CALL 'ZDATE2'               90  Check File Date                    CGL132
     C                     PARM XCCRDT    WQ0021  50       Work Midas Date                    CGL132
     C                     PARM WUDFF     WQ0022  1        Date format fla                    CGL132
     C           WUWCDT    PARM *ZERO     WQ0023  60       Work Converted                     CGL132
     C           WUWADT    PARM *BLANK    WQ0024  7        Work Alpha Date                    CGL132
      *                                                                                       CGL132
     C           *IN90     IFEQ '1'                                                           CGL132
      * Call to program ended in error.                                                       CGL132
     C                     MOVEL'Y2U0021' W0RTN   7                                           CGL132
     C                     END                                                                CGL132
      *                                                                                       CGL132
     C                     MOVELWUWADT    XRCRDT           Creation Date                      CGL132
      * Check File Date - Rundate  *
     C                     CALL 'ZDATE2'               90  Check File Date
     C                     PARM BBLALD    WQ0025  50       Work Midas Date
     C                     PARM WUDFF     WQ0026  1        Date format fla
     C           WUWCDT    PARM *ZERO     WQ0027  60       Work Converted
     C           WUWADT    PARM *BLANK    WQ0028  7        Work Alpha Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
     C                     MOVELWUWADT    XRRALD           Report Audit Le
      *                                                                   CDL008
      ** If CDL008 is on, print CLS Settlement and Effective Date         CDL008
      *                                                                   CDL008
     C           CDL008    IFEQ 'Y'                                       CDL008
     C                     MOVELBBCLSS    XRCLSS                          CDL008
      *                                                                   CDL008
     C           BBEFDT    IFEQ *ZERO                                     CDL008
     C                     MOVE *BLANKS   WUWADT                          CDL008
     C                     ELSE                                           CDL008
     C                     CALL 'ZDATE2'               90                 CDL008
     C                     PARM BBEFDT    WQ0042  50                      CDL008
     C                     PARM WUDFF     WQ0043  1                       CDL008
     C           WUWCDT    PARM *ZERO     WQ0044  60                      CDL008
     C           WUWADT    PARM *BLANK    WQ0045  7                       CDL008
     C           *IN90     IFEQ *ON                                       CDL008
     C                     MOVEL'Y2U0021' W0RTN                           CDL008
     C                     ENDIF                                          CDL008
     C                     ENDIF                                          CDL008
      *                                                                   CDL008
     C                     MOVE WUWADT    XREFDT                          CDL008
     C                     ENDIF                                          CDL008
      *                                                                   CDL008
      * End of Fix LN0562
     C                     MOVELP1ARSI    WUARSI           Audit/Request S
      * Process Detail Rec PRTFIL
      * Start of Fix BHF950
      * This change to the standard object was required because the
      * clients file has logically deleted records and these were
      * initially being counted as records on the file - thus if there
      * were any deleted clients on the system the file controls would
      * be out of balance. This fix will not affect any other report
      * programs since there will be no records with a last change type
      * of 'D'.
      *CASE:     PAR.Type of Last Change is Not Delete
     C********** XRTYLC    IFEQ @CN,02                     *IF                              MD025682
     C********** XRTYLC    OREQ @CN,03                                                      MD025682
     C           XRDTDL    IFEQ 0                          *IF                              MD025682
     C                     ADD  1         WUWKNB           work number
     C                     END                             *FI
      * End of Fix BHF950
     C/COPY WNCPYSRC,SD0010PC01
      *CASE:     PAR.Audit/Request Status Ind is Audit Mode
     C           WUARSI    IFEQ @CN,02                     *IF
      *CASE:     PAR.Last Change Date NE WRK.run day number
     C           XRLCD     IFNE WURDNB                     *IF
     C                     MOVEL@CN,04    W0PFM            *Print format
     C                     END                             *FI
     C                     END                             *FI
      *CASE:     PGM.*Print format is Print format
     C           W0PFM     IFEQ @CN,01                     *IF
     C                     ADD  1         ZTNCRC           No of Calculate
      *CASE:     PAR.No of Calculated Recs is Equal 1
     C           ZTNCRC    IFEQ 1                          *IF
      * Change Print Control to Y - Standing Data Controls  *
     C*
     C* Set Print Control To Y To Enable Column Headers To Be
     C*             Printed On First Record..
     C*
     C                     MOVEL'Y'       BAPR    1
     C                     END                             *FI
     C                     END                             *FI
      * Check File Date - Rundate  *
     C                     CALL 'ZDATE2'               90  Check File Date
     C                     PARM XRLCD     WQ0029  50       Work Midas Date
     C                     PARM WUDFF     WQ0030  1        Date format fla
     C           WUWCDT    PARM *ZERO     WQ0031  60       Work Converted
     C           XRACDT    PARM *BLANK    WQ0032  7        Work Alpha Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * PAR.alpha of last change = Condition name of PAR.Type of Last Change
     C                     CALL 'Y2RVCNR'              90  *
     C                     PARM           W0RTN   7        Return code
     C                     PARM 1100584   Y2LSNO  70       List number
     C                     PARM XRTYLC    W0INVL 20        Type of Last Ch
     C                     PARM ' '       W0VLMP  1        Value mapped?
     C           XRALCH    PARM           W0CNNM 25        alpha of last c
      *
      * Start of Fix BHF331
      *CASE:     CUR.Type of Last Change is Delete
     C           XRTYLC    IFEQ @CN,05                     *IF
     C                     MOVEL@CN,06    XRCSTA           Customer Status
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL*BLANK    XRCSTA           Customer Status
     C                     END                             *FI
      * End of Fix BHF331
      *                                                                   CSD007
      ** If CSD007 is installed, display Type of last change, status      CSD007
      ** and change date for Closed or Released Customers                 CSD007
      *                                                                   CSD007
     C                     MOVE *OFF      *IN71                           CSD007
     C                     MOVEL*BLANKS   XRCLDT                          CSD007
      *                                                                   CSD007
     C           CSD007    IFEQ 'Y'                                       CSD007
     C           BBDEAC    IFEQ 'Y'                                       CSD025A
     C           CSD025    ANDEQ'Y'                                       CSD025A
     C                     MOVEL@CN,18    XRALCH                          CSD025A
     C                     ENDIF                                          CSD025A
     C           BBCLDT    IFGT *ZERO                                     CSD007
     C                     MOVE *ON       *IN71                           CSD007
     C                     CALL 'ZDATE2'               90                 CSD007
     C                     PARM BBCLDT    WQ0042  50                      CSD007
     C                     PARM WUDFF     WQ0043  1                       CSD007
     C           WUWCDT    PARM *ZERO     WQ0044  60                      CSD007
     C           XRCLDT    PARM *BLANKS   WQ0045  7                       CSD007
     C           *IN90     IFEQ *ON                                       CSD007
     C                     MOVEL'Y2U0021' W0RTN                           CSD007
     C                     ENDIF                                          CSD007
     C           BBCLST    IFEQ *BLANK                                    CSD007
     C                     MOVEL@CN,15    XRALCH                          CSD007
     C                     ENDIF                                          CSD007
     C                     ENDIF                                          CSD007
      *                                                                   CSD007
     C           BBCLST    IFEQ 'Y'                                       CSD007
     C           BBDTDL    ANDEQ*ZERO                                     CSD007
     C                     MOVEL@CN,16    XRALCH                          CSD007
     C                     MOVEL@CN,17    XRCSTA                          CSD007
     C                     ENDIF                                          CSD007
     C                     ENDIF                                          CSD007
      *                                                                   CSD007
      *CASE:     WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ @CN,01                     *IF
      * 00/Copy Member SD0010PPDR - Client Details  *
     C/COPY WNCPYSRC,SD0010PPDR
      *                                                                                      LLN022A
      ** If BOE Yellow book module is on                                                     LLN022A
      *                                                                                      LLN022A
     C           LLN007    IFEQ 'Y'                                                          LLN022A
      *                                                                                      LLN022A
     C           BBCUST    CHAINBYCUSTY0             92                                      LLN022A
      *                                                                                      LLN022A
      ** Record is found                                                                     LLN022A
      *                                                                                      LLN022A
     C           *IN92     IFEQ *OFF                                                         LLN022A
      *                                                                                      LLN022A
      ** Move Data Structure Fields to 1st Printline                                         LLN022A
      *                                                                                      LLN022A
     C                     MOVE LSIOF     ULSIOF           SIO Ind                           LLN022A
     C                     MOVE LHASI     ULHAIN           H/A Ind                           LLN022A
     C                     MOVE LUPAR     ULULPA           Ult Parent                        LLN022A
     C                     MOVE LELGF     ULEGFL           Elig Flag                         LLN022A
     C                     MOVE LLINC     ULLINC                                             LLN022A
     C                     MOVE LLICD     ULLICD                                             LLN022A
     C                     MOVE UFLD1     XRWNFF                                             LLN022A
      *                                                                                      LLN022A
      ** Otherwise move blanks to data-structure fields                                      LLN022A
      *                                                                                      LLN022A
     C                     ELSE                                                              LLN022A
     C                     MOVE *BLANK    ULULPA           Ult. Parent                       LLN022A
     C                     MOVE *BLANK    ULEGFL           Elig. Flag                        LLN022A
     C                     MOVE *BLANK    ULLINC                                             LLN022A
     C                     MOVE *BLANK    ULLICD                                             LLN022A
      *                                                                                      LLN022A
     C                     ENDIF                                                             LLN022A
     C                     ENDIF                                                             LLN022A
      *                                                                                      LLN022A
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form.
     C                     MOVEL'0'       *IN79
     C           XRWNFF    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           XRWNF1    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           XRWNF2    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
      *                                                                   CGL018
      * Output RWA details for each customer                              CGL018
      *                                                                   CGL018
     C           CGL018    IFEQ 'Y'                                       CGL018
     C                     EXSR RWADTL                                    CGL018
     C                     ENDIF                                          CGL018
     C/COPY WNCPYSRC,SD0010PC06
      * Print detail line.
     C                     WRITEZZDTLRCD
     C*                                                                   S01408
     C/COPY WNCPYSRC,SD0010PCP3                                           S01408
     C*                                                                   S01408
     C           ULX043    IFEQ 'Y'                                                           CER001
     C           ILFLAG    ANDEQ'0'                                                           CER001
     C                     MOVE *BLANKS   RRFROM                                              CER001
     C                     WRITEZZIBLC02                                                      CER001
      *                                                                                       CER001
     C                     DO   5         BL      10                                          CER001
     C           BLC,BL    IFNE *BLANKS                                                       CER001
     C                     MOVELBLC,BL    RRFROM                                              CER001
      *                                                                                       CER001
      ** If there is not enough space on the                                                  CER001
      ** physical page for this format:-                                                      CER001
      *                                                                                       CER001
     C           @$PGL     SUB  @$CLN     @$WRK                                               CER001
     C           @$WRK     IFLE 1                                                             CER001
      *                                                                                       CER001
      ** Signal artificial overflow.                                                          CER001
      *                                                                                       CER001
     C                     SETON                     97                                       CER001
      *                                                                                       CER001
      ** Print page headers.                                                                  CER001
      *                                                                                       CER001
     C                     EXSR FASGHD                                                        CER001
     C                     EXSR BAPRHD                                                        CER001
      *                                                                                       CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C                     WRITEZZIBLC02                                                      CER001
     C                     ENDIF                                                              CER001
     C                     ENDDO                                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      *****************************************************************                       CGP001
      /EJECT                                                                                  CGP001
      *****************************************************************                       CGP001
      *                                                               *                       CGP001
      *  SRGPCU - Gets the Global Customer X-Reference details        *                       CGP001
      *                                                               *                       CGP001
      *****************************************************************                       CGP001
     C           SRGPCU    BEGSR                                                              CGP001
      *                                                                                       CGP001
     C                     MOVE BBBRCD    KBRCD                                               CGP001
     C                     MOVE BBCUST    KCUST                                               CGP001
      *                                                                                       CGP001
     C           KGPXR     CHAINGPCSTXL1            N46                                       CGP001
      *                                                                                       CGP001
     C           *IN46     IFEQ *OFF                                                          CGP001
     C                     MOVE CUGCUS    XRGCID                                              CGP001
     C                     ELSE                                                               CGP001
     C                     MOVE *BLANKS   XRGCID                                              CGP001
     C                     ENDIF                                                              CGP001
      *                                                                                       CGP001
     C                     ENDSR                                                              CGP001
      *****************************************************************                       CGP001
      /EJECT                                                                                  CGP001
      *****************************************************************                       CGP001
      *                                                               *                       CGP001
      *  SRGPOF - Opens the Global Processing Cross-Reference Files.  *                       CGP001
      *                                                               *                       CGP001
      *****************************************************************                       CGP001
     C           SRGPOF    BEGSR                                                              CGP001
      *                                                                                       CGP001
     C                     Z-ADD80        PLEN   155                                          CGP001
      *                                                                                       CGP001
     C                     MOVE OVRC,1    PCMD   80                                           CGP001
      *                                                                                       CGP001
     C                     CALL 'QCMDEXC'                                                     CGP001
     C                     PARM           PCMD                                                CGP001
     C                     PARM           PLEN                                                CGP001
      *                                                                                       CGP001
     C                     OPEN GPCSTXL1                                                      CGP001
      *                                                                                       CGP001
     C                     ENDSR                                                              CGP001
      *****************************************************************                       CGP001
      /EJECT                                                              S01421
     CSR         ACDTSR    BEGSR                                          S01421
      *================================================================   S01421
      *                                                                   CDL006
      ** If Switchable Feature CDL006 is Switched on move File fields     CDL006
      ** to their respective printer file fields.                         CDL006
      *                                                                   CDL006
     C           CDL006    IFEQ 'Y'                                       CDL006
     C                     MOVELBBCOMG    R1COMG                          CDL006
     C                     MOVELBBCHRG    R1CHRG                          CDL006
     C                     MOVELBBAGNT    R1AGNT                          CDL006
     C                     MOVELBBAGNP    R1AGNP                          CDL006
     C                     MOVELBBDFAC    R1DFAC                          CDL006
     C                     MOVELBBDFAS    R1DFAS                          CDL006
     C                     MOVELBBTRAS    R1TRAS                          CDL006
     C                     MOVELBBNAR1    R1NAR1                          CDL006
     C                     MOVELBBNAR2    R1NAR2                          CDL006
     C                     MOVELBBNAR3    R1NAR3                          CDL006
     C                     MOVELBBNAR4    R1NAR4                          CDL006
      *                                                                   CDL006
      ** Inhibit printing of DL Fiduciary details if Additional           CDL006
      ** Customer Details not printed.                                    CDL006
      *                                                                   CDL006
     C           *IN23     IFEQ *OFF                                      CDL006
     C                     MOVE '0'       *IN17                           CDL006
     C                     ELSE                                           CDL006
     C                     MOVE '1'       *IN17                           CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C                     ENDIF                                          CDL006
      *                                                                   S01421
      * The following Sub Routine will search for the customer number     S01421
      * and if found will write a new page header and Additional          S01421
      * Customer Details.                                                 S01421
      *                                                                   S01421
     C           XRCUST    CHAINSDACUSL1             24                   S01421
     C           *IN24     IFEQ '0'                                       S01421
     C                     MOVE E5CUST    ADCNA   6                       S01421
     C/COPY WNCPYSRC,SD0010PC29
     C                     MOVE E5ALTN    A5ALTN 12                       S01421
     C/COPY WNCPYSRC,SD0010PC30
     C                     MOVE E5IDNO    A5IDNO 15                       S01421
     C                     MOVE E5FXNB    A5FXNB 12                       S01421
     C                     MOVE E5TXNB    A5TXNB 12                       S01421
     C                     MOVE E5PRVO    A5PRVO  1                       S01421
     C                     MOVE E5MDTL    A5MDTL  5                       S01421
     C                     MOVE E5CNA1    A5CNA1 35                       S01421
     C           CSW207    IFEQ 'Y'                                                           CSW207
     C                     MOVE E5ISCD    A5ISCD 35                                           CSW207
     C                     ENDIF                                                              CSW207
     C/COPY WNCPYSRC,SD0010PC31
     C                     MOVE E5CNA2    A5CNA2 35                       S01421
     C                     MOVE E5CNA3    A5CNA3 35                       S01421
     C                     MOVE E5CNA4    A5CNA4 35                       S01421
     C                     MOVE E5CWL1    A5CWL1 20                       S01421
     C                     MOVE E5CWL2    A5CWL2 20                       S01421
     C/COPY WNCPYSRC,SD0010PC32
     C                     MOVE E5CWL3    A5CWL3 20                       S01421
     C                     MOVE E5CWL4    A5CWL4 20                       S01421
     C                     MOVE E5CWL5    A5CWL5 20                       S01421
      *                                                                   S01421
      * Change the processing so that the alpha date is displayed         S01421
      * instead of the DDMMYY style format                                S01421
      * Check File Date - Date of last visit *                            S01421
      *                                                                   S01421
     C                     CALL 'ZDATE2'               90  Check File DateS01421
     C                     PARM E5DOLV    WQ00A1  50       Work Midas DateS01421
     C                     PARM WUDFF     WQ00A2  1        Date format flaS01421
     C           WUWCDT    PARM *ZERO     WQ00A3  60       Work Converted S01421
     C           WUWADT    PARM *BLANK    WQ00A4  7        Work Alpha DateS01421
      *                                                                   S01421
     C           *IN90     IFEQ '1'                                       S01421
      * Call to program ended in error.                                   S01421
     C                     MOVEL'Y2U0021' W0RTN   7                       S01421
     C                     END                                            S01421
     C                     MOVELWUWADT    A5DOLV  7                       S01421
      *                                                                   S01421
     C           E5BRTH    IFNE 0                                         113339
     C                     CALL 'ZDATE2'               90  Check File DateS01421
     C                     PARM E5BRTH    WQ00A5  50       Work Midas DateS01421
     C                     PARM WUDFF     WQ00A6  1        Date format flaS01421
     C           WUWCDT    PARM *ZERO     WQ00A7  60       Work Converted S01421
     C           WUWADT    PARM *BLANK    WQ00A8  7        Work Alpha DateS01421
      *                                                                   S01421
     C           *IN90     IFEQ '1'                                       S01421
      * Call to program ended in error.                                   S01421
     C                     MOVEL'Y2U0021' W0RTN   7                       S01421
     C                     END                                            S01421
     C                     ELSE                                           113339
     C           E5BRT1    IFNE *BLANKS                                   113339
     C           E5BRT1    ANDNE'000000'                                  168603
      * If format is MMDDYY swap month and day fields for DS E5BRT1       113339
     C           WUDFF     IFEQ 'M'                                       113339
     C                     MOVE WWBDAY    WKBMNT  2                       113339
     C                     MOVELWWBMNT    WWBDAY                          113339
     C                     MOVE WKBMNT    WWBMNT                          113339
     C                     ENDIF                                          113339
     C                     Z-ADDWWBMNT    Z       20                      113339
     C                     MOVEAZMNM,Z    WWBMT1                          113339
     C                     MOVELWWBDAY    WWBDY1                          113339
     C                     MOVELWWBYR     WWBYR1                          113339
     C                     MOVELWWBRT1    WUWADT                          113339
     C                     END                                            113339
     C                     END                                            113339
     C******************** MOVELWUWADT    A5BRTH  7                 S01421113339
     C                     MOVELWUWADT    A5BRTH    P                     113339
     C*
     C/COPY WNCPYSRC,SD0010PCP7
     C*
      *                                                                   S01421
     C           W0PFM     IFEQ 'Y'                                       076824
     C                     WRITEZZPAGHDR                                  S01421
     C                     ELSE                                           076824
     C                     ADD  1         ZTNCRC                          076824
     C                     END                                            076824
      *                                                                                       CSD029
     C           CSD029    IFEQ 'Y'                                                           CSD029
     C                     EXSR SRFMTF                                                        CSD029
     C                     ELSE                                                               CSD029
     C                     MOVE *ON       *IN31                                               CSD029
     C                     MOVE *ON       *IN32                                               CSD029
     C                     MOVE *ON       *IN33                                               CSD029
     C                     MOVE *ON       *IN34                                               CSD029
     C                     MOVE *ON       *IN35                                               CSD029
     C                     MOVE *ON       *IN36                                               CSD029
     C                     MOVE *ON       *IN37                                               CSD029
     C                     MOVE *ON       *IN38                                               CSD029
     C                     MOVE *ON       *IN39                                               CSD029
     C                     MOVE *ON       *IN40                                               CSD029
     C                     ENDIF                                                              CSD029
     C                     WRITEADCUDT                                    S01421
     C*                                                                   S01421
     C                     END                                            S01421
     C*                                                                   S01421
     C*================================================================   S01421
     CSR         ACEXIT    ENDSR
      /EJECT
     CSR         DALVCH    BEGSR
      *================================================================
      * Detect level changes.
      *================================================================
      * Clear all level breaks.
     C                     MOVEL*BLANK    L0               Page headings
      * Clear heading length to print.
     C                     Z-ADD*ZERO     @$HDL
      *
      * End of file - Signal all level breaks.
     C           W0EOF     IFEQ '1'
     C                     ELSE
     C                     END
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         EAPRTT    BEGSR
      *================================================================
      * Print report Totals.
      *================================================================
      * Print level break totals as required
      * End of file - Print final totals.
     C           W0EOF     IFEQ '1'
     C*
     C/COPY WNCPYSRC,SD0010PC14
     C*
     C                     MOVEL'Y'       W0PFM
      * USER: Process End of Report
      *CASE:     CUR.No of Calculated Recs is Compare to Zero
     C           ZTNCRC    IFEQ *ZERO                      *IF
     C                     MOVEL@CN,07    WUALZR           Alpha Zero
     C                     END                             *FI
      *CASE:     PAR.Audit/Request Status Ind is Audit Mode
     C           P1ARSI    IFEQ @CN,02                     *IF
      * Audit/On-Req RTV on FCTL - Standing Data Controls  *
     C                     EXSR SARVGN
     C*
     C/COPY WNCPYSRC,SD0010PC15
     C*
      *CASE:     WRK.work number NE WRK.No of Records on file
     C           WUWKNB    IFNE WUNORF                     *IF
     C                     MOVEL@CN,04    WUWFLG           work flag
     C                     END                             *FI
      * Start of Fix BHF399
      * Audit printfile override - Standing Data Controls  *
     C                     CALL 'SDC540P'              90  Audit printfile
     C                     PARM @CN,10    WQ0033 10        *PROGRAM
     C                     PARM WUWFLG    WQ0034  1        work flag
     C                     PARM WUNORI    WQ0035  50       No of Records I
     C                     PARM WUNORA    WQ0036  50       No of Records A
     C                     PARM WUNORD    WQ0037  50       No of records D
     C                     PARM WUWKNB    WQ0038  50       work number
     C                     PARM WUNORF    WQ0039  50       No of Records o
     C                     PARM WUAURT    WQ0040 53        Audit/Request T
     C                     PARM WUBJNA    WQ0041 53        Underline
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * End of Fix BHF399
      *CASE:     PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,09                     *IF
      * Database Error U7 U8 - Standing Data Controls  *
     C*
     C** DATABASE ERROR, SET ON SWITHES U7 AND U8
     C*
     C                     SETON                     U7U8
     C*
     C                     ELSE
      *CASE:     WRK.work flag is Incorrect
     C           WUWFLG    IFEQ @CN,04                     *IF
      * File Control Error U8 - Standing Data Controls  *
     C*
     C** FILE CONTROLS OUT OF BALANCE SETON U8
     C*
     C                     SETON                         U8
     C*
     C                     ELSE
      *CASE:     *OTHERWISE
      * Change Standing Data Cont - Standing Data Controls  *
     C                     EXSR SBCHRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *CASE:     WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ @CN,01                     *IF
      * 00/Copy Member SD0010PPER - Client Details  *
     C/COPY WNCPYSRC,SD0010PPER
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:-
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 3
      * Signal artificial overflow.
     C                     SETON                     97
      * Print page headers.
     C                     WRITEZZPAGHDR
     C                     END
     C                     MOVEL'0'       *IN76
     C           WUALZR    IFEQ @CN,07                     *IF
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
      * Print format.
     C                     WRITEZZFINTTL
     C                     END
     C                     END
      *
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         FASGHD    BEGSR
      *================================================================
      * Signal required header formats.
      *================================================================
      * Cascade skip to new page requests upwards.
      *
     C           *IN97     IFNE '1'
     C           L0        ANDNE'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line.
     C           W0OFL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE @$HDL
     C                     SETON                     97
     C                     ELSE
     C*                                                                   S01408
     C/COPY WNCPYSRC,SD0010PCP4                                           S01408
     C*                                                                   S01408
      * Signal overflow if requested headings would cause
      * detail format to be printed past end of page
     C           ULX004    IFNE 'Y'                                                           CER001
     C                     ADD  36        @$HDL                                               CER001
     C                     ELSE                                                               CER001
     C                     ADD  36        @$HDL
     C*                                                                   S01408
     C/COPY WNCPYSRC,SD0010PCP5                                           S01408
     C*                                                                   S01408
      *                                                                                       CER001
      ** Signal overflow if requested headings would cause                                    CER001
      ** detail format to be printed past end of page                                         CER001
      *                                                                                       CER001
     C                     ADD  44        @$HDL                                               CER001
     C                     ENDIF                                                              CER001
     C           W0PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE @$HDL
     C                     SETON                     97
     C                     END
     C                     END
     C                     END
      * Overflow detected.
     C           *IN97     IFEQ '1'
      * Request page headings.
     C                     MOVEL'Y'       L0
      * Request all formats which print on overflow.
     C                     SETOF                     97
     C                     END
      *================================================================
     CSR         FAEXIT    ENDSR
      /EJECT
     CSR         GARDRC    BEGSR
      *================================================================
      * Read next record with user selection.
      *================================================================
     C           W0RSL     DOUEQ'Y'
     C*
     C/COPY WNCPYSRC,SD0010PC21
     C*
     C                     READ @BBREBF                  90*
     C*
     C/COPY WNCPYSRC,SD0010PC20
     C*
     C                     MOVEL*IN90     W0EOF   1
      * Quit if no record read.
     C           W0EOF     CABEQ'1'       GAEXIT
     C*
     C/COPY WNCPYSRC,SD0010PC16
     C*
      * Select record unless user action states otherwise.
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
     C*                                                                   S01408
     C/COPY WNCPYSRC,SD0010PC23                                           S01408
     C*                                                                   S01408
      *CASE:     WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ @CN,01                     *IF
      * 00/Copy Member SD0010PRSP - Client Details  *
     C*00/Copy Member SD0010P   Record Selection Proc.
     C/COPY WNCPYSRC,SD0010PRSP
     C                     END                             *FI
      *                                                                   S01408
     C/COPY WNCPYSRC,SD0010PC25                                           S01408
      *                                                                   S01408
      *                                                                   S01383
      ***  If BRT SAR installed, access SDCBRTL1 for Holder details.      S01383
      *                                                                   S01383
     C           S01383    IFEQ 'Y'                                       S01383
      *                                                                   S01383
     C**********           MOVE BBCUST    KCLBRT  60                                   S01383 CSD027
     C                     MOVE BBCUST    KCLBRT  6                                           CSD027
     C/COPY WNCPYSRC,SDH00090
     C           KCLBRT    CHAINSDCBRTL1             89                   S01383
     C           *IN89     IFEQ '1'                                       S01383
     C                     SETON                     U7U8                 S01383
     C                     MOVEL'Y2U0005' W0RTN                           S01383
     C                     MOVEL'SDCBRTPD'ZA0001                          S01383
     C                     MOVEL'USR0377' ZAMSID                          S01383
     C                     EXSR ZASNMS                                    S01383
     C                     EXSR ZYEXPG                                    S01383
     C                     END                                            S01383
     C/COPY WNCPYSRC,SDH00091
      *                                                                   S01383
     C                     END                                            S01383
     C/COPY WNCPYSRC,SD0010PC04
      *                                                                   S01383
     C                     END
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Audit/On-Req RTV on FCTL - Standing Data Controls  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define Keylist.
     C           KRSSA     KLIST
     C                     KFLD           AHFLNM           Filename
      * Move fields to key list.
     C                     MOVEL@CN,08    AHFLNM           Filename
     C           KRSSA     CHAIN@AHREAV              90    *
     C           *IN90     IFEQ '1'
      * DBF Record not found.
     C                     MOVEL'USR0020' W0RTN   7
      * USER: Processing if DBF record not found
     C                     MOVEL@CN,09    W0RTN            *Return code
     C                     GOTO SAEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process DBF record
      * PAR = DB1 By name
     C                     Z-ADDAHNORC    WUNORF           No. of Records
     C                     Z-ADDAHNOIN    WUNORI           No. of Inserts
     C                     Z-ADDAHNOAM    WUNORA           No. of Amends
     C                     Z-ADDAHNODL    WUNORD           No. of Deletes
     C                     END
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBCHRC    BEGSR
      *================================================================
      * Change Standing Data Cont - Standing Data Controls  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @AHREAU
     C                     MOVEL@CN,08    AHFLNM           Filename
      *
     C           KLCHSB    KLIST
     C                     KFLD           AHFLNM           Filename
     C           KLCHSB    CHAIN@AHREAU              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found.
     C                     MOVEL'Y2U0009' W0RTN   7
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID           Message id.
     C                     MOVEL'Y2USRMSG'ZAMSGF           Message file.
     C                     EXSR ZASNMS                     Send message
     C                     GOTO SBEXIT
     C                     END
      *
     C           *IN91     IFEQ '1'
      * Record locked.
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     GOTO SBEXIT
     C                     END
      *
      * USER: Processing after DBF read
     C                     ADD  AHNORC    WUNORC           No. of Records
     C                     ADD  AHNOIN    WUNOIN           No. of Inserts
     C                     ADD  AHNOAM    WUNOAM           No. of Amends
     C                     ADD  AHNODL    WUNODL           No. of Deletes
      * Move Non-key fields to @AHREAU
     C                     Z-ADDWUNORC    AHNORC           No. of Records
     C                     Z-ADD*ZERO     AHNOIN           No. of Inserts
     C                     Z-ADD*ZERO     AHNOAM           No. of Amends
     C                     Z-ADD*ZERO     AHNODL           No. of Deletes
      *
     C                     UPDAT@AHREAU                91  *
     C           *IN91     IFEQ '1'
      * Change error detected.
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * DBF Change successful.
     C                     END
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Get Bank Title - Bank Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define Keylist.
     C           KRSSC     KLIST
     C                     KFLD           BJBANK           Bank
      * Move fields to key list.
     C                     MOVEL@CN,11    BJBANK           Bank
     C           KRSSC     CHAIN@BJREEF              90    *
     C           *IN90     IFEQ '1'
      * DBF Record not found.
     C                     MOVEL'USR0197' W0RTN   7
      * USER: Processing if DBF record not found
     C                     MOVEL@CN,09    W0RTN            *Return code
      * Setup message data for message.
     C                     MOVEL@CN,12    ZA0001           Filename
      * Send message 'Database Error (ICD)'
     C                     MOVEL'USR0377' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     99    *
      *
     C                     GOTO SCEXIT                     *QUIT
     C                     GOTO SCEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process DBF record
      * PAR = DB1 By name
     C                     MOVELBJURPT    WUURPT           User Report Tit
     C                     END
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue.
      *================================================================
     C           ZAPGM     IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGM
     C                     END
      * If no message file specified use default.
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGM  10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message Id.
     C                     PARM           ZAMSGF 10        Message file.
     C                     PARM           ZAMSDA132        Message data.
     C                     PARM           ZAMSTP  7        Message type.
      * Clear all fields for default mechanism next time.
     C                     MOVEL*BLANK    ZAPGM            Program queue
     C                     MOVEL*BLANK    ZAPGRL           Rel queue
     C                     MOVEL*BLANK    ZAMSID           Message Id.
     C                     MOVEL*BLANK    ZAMSGF           Message file.
     C                     MOVEL*BLANK    ZAMSDA           Message data.
     C                     MOVEL*BLANK    ZAMSTP           Message type.
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct.
      *================================================================
      *                                                                                       CGP001
     C           CGP001    IFEQ 'Y'                                                           CGP001
     C                     CLOSEGPCSTXL1                                                      CGP001
     C                     ENDIF                                                              CGP001
      * Terminate program.
     C                     SETON                     LR
      *
      * Exit program.
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     C/COPY WNCPYSRC,SD0010PC35
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation.
      *================================================================
      *                                                                                       CGP001
      ** Global Processing X-Reference Key Defn                                               CGP001
      *                                                                                       CGP001
     C           *LIKE     DEFN BBCUST    KCUST                                               CGP001
     C           *LIKE     DEFN BBBRCD    KBRCD                                               CGP001
      *                                                                                       CGP001
      ** Global Processing X-Reference Key List                                               CGP001
      *                                                                                       CGP001
     C           KGPXR     KLIST                                                              CGP001
     C                     KFLD           KBRCD                                               CGP001
     C                     KFLD           KCUST                                               CGP001
      *                                                                                       CGP001
     C*
     C/COPY WNCPYSRC,SD0010PC17
     C*
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
      * Setup job date/time.
     C                     Z-ADDUDATE     ##JDT            Job date.
     C                     TIME           ##JTM            Job time.
     C                     TIME           ##TME   60       Screen time.
      * Define work field S01212
     C                     MOVEL*BLANK    WUMFTS  1
      * Define work field Date format flag
     C                     MOVEL*BLANK    WUDFF   1
      * Define work field Work Alpha Date
     C                     MOVEL*BLANK    WUWADT  7
      * Define work field Work Converted Date
     C                     Z-ADD*ZERO     WUWCDT  60
      * Define work field Audit/Request Status Ind
     C                     MOVEL*BLANK    WUARSI  1
      * Define work field work number
     C                     Z-ADD*ZERO     WUWKNB  50
      * Define work field Run day number
     C                     Z-ADD*ZERO     WURDNB  50
      * Define work field Alpha Zero
     C                     MOVEL*BLANK    WUALZR  1
      * Define work field No of Records on file
     C                     Z-ADD*ZERO     WUNORF  50
      * Define work field No of Records Inserted
     C                     Z-ADD*ZERO     WUNORI  50
      * Define work field No of Records Amended
     C                     Z-ADD*ZERO     WUNORA  50
      * Define work field No of records Deleted
     C                     Z-ADD*ZERO     WUNORD  50
      * Define work field work flag
     C                     MOVEL*BLANK    WUWFLG  1
      * Define work field Audit/Request Title
     C                     MOVEL*BLANK    WUAURT 53
      * Define work field Underline
     C                     MOVEL*BLANK    WUBJNA 53
      * Define work field No. of Records
     C                     Z-ADD*ZERO     WUNORC  50
      * Define work field No. of Inserts
     C                     Z-ADD*ZERO     WUNOIN  50
      * Define work field No. of Amends
     C                     Z-ADD*ZERO     WUNOAM  50
      * Define work field No. of Deletes
     C                     Z-ADD*ZERO     WUNODL  50
      * Define work field Midas Run Date
     C                     MOVEL*BLANK    WUMRDT  7
      * Define work field Set Up Complete
     C                     MOVEL*BLANK    WUSUC   1
      * Define work field Multi-branching Indicator
     C                     MOVEL*BLANK    WUMBIN  1
      * Define work field User Report Title
     C                     MOVEL*BLANK    WUURPT 53
      * Obtain default message file.
     C           *NAMVAR   DEFN Y2MGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Spool file name
     C                     MOVEL*BLANK    WUSFNM 10
      * Define work field Spool file number
     C                     Z-ADD*ZERO     WUSFNB  60
      * Define work field ZSFILE error
     C/COPY WNCPYSRC,SD0010PC02
     C                     MOVEL*BLANK    WUZSER  1
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
      * Adjust page length and overflow as necessary.
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      *                                                                   CDL006
      ** Dataarea LDA                                                     CDL006
      *                                                                   CDL006
     C           *NAMVAR   DEFN           LDA                             CDL006
      * USER: Initialise program
      * Standard RPG Creation PAR - Standard Functions  *
      * Last Amend Box SD0010P - Client Details  *
      * Get Rundate - Rundate  *
     C           *NAMVAR   DEFN           RUNDAT
     C                     IN   RUNDAT
     C                     MOVE MRDT      ##MRDT           RUN DATE
     C                     MOVE MRDT      WUMRDT
     C                     MOVE RDNB      WURDNB           RUNDAY NO.
     C                     MOVE SUC       WUSUC            SET UP COMPLT
     C                     MOVE DFF       WUDFF            DTE FMT FLAG
     C                     MOVE MBIN      WUMBIN           MULTI BR. IND
      *                                                                   CDL006
      ** Prepare LDA                                                      CDL006
      *                                                                   CDL006
     C           *LOCK     IN   LDA                                       CDL006
     C                     MOVEL*BLANK    DBLOT                           CDL006
     C                     MOVEL'SD0010P' DBPGM                           CDL006
     C                     OUT  LDA                                       CDL006
     C*                                                                   S01413
     C** Access Modules File and check if Retail 3 is installed.          S01413
     C                     CALL 'AOMMODR0'                                S01413
     C                     PARM '*DBERR ' @RTCD   7                       S01413
     C                     PARM '*FIRST ' @OPTN   7                       S01413
     C           SDMMOD    PARM SDMMOD    DSFDY                           S01413
     C*                                                                   S01413
     C           BGNXST    IFEQ 'Y'                                       S01413
     C                     SETON                     50                   S01413
     C                     END                                            S01413
     C/COPY WNCPYSRC,SD0010PC03
     C*                                                                   S01413
      * Copyright Statement - Standard Functions  * copyright
      * Get Title
      * Get Bank Title - Bank Details  *
     C                     EXSR SCRVGN
     C*                                                                   S01408
     C/COPY WNCPYSRC,SD0010PCP6                                           S01408
     C*                                                                   S01408
      *                                                                                       CER001
      ** Determine if feature ULX012 (Guarantees and Collateral                               CER001
      ** Management enhancements) is installed                                                CER001
      *                                                                                       CER001
     C                     MOVE 'N'       ULX012  1                                           CER001
     C                     CALL 'AOSARDR0'                                                    CER001
     C                     PARM '       ' @RTCD   7                                           CER001
     C                     PARM '*VERIFY' @OPTN   7                                           CER001
     C                     PARM 'ULX012'  @SARD   6                                           CER001
     C           SCSARD    PARM SCSARD    DSSDY                                               CER001
      *                                                                                       CER001
     C           @RTCD     IFNE *BLANKS                                                       CER001
     C           @RTCD     ANDNE'*NRF   '                                                     CER001
     C           *LOCK     IN   LDA                                                           CER001
     C                     Z-ADD5         DBASE                                               CER001
     C                     MOVEL'SCSARDPD'DBFILE                                              CER001
     C                     MOVEL'ULX012'  DBKEY                                               CER001
     C                     OUT  LDA                                                           CER001
     C                     EXSR *PSSR                                                         CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
      ** If feature ULX012 is installed.                                                      CER001
      *                                                                                       CER001
     C           @RTCD     IFEQ *BLANKS                                                       CER001
     C                     MOVE 'Y'       ULX012                                              CER001
     C                     MOVE *ON       *IN60                                               CER001
     C                     MOVE *ON       *IN62                                               CER001
      *                                                                                       CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
      ** Determine if feature ULX008 is installed                                             CER001
      *                                                                                       CER001
     C                     MOVE 'N'       ULX008  1                                           CER001
     C                     CALL 'AOSARDR0'                                                    CER001
     C                     PARM '       ' @RTCD   7                                           CER001
     C                     PARM '*VERIFY' @OPTN   7                                           CER001
     C                     PARM 'ULX008'  @SARD   6                                           CER001
     C           SCSARD    PARM SCSARD    DSSDY                                               CER001
      *                                                                                       CER001
     C           @RTCD     IFNE *BLANKS                                                       CER001
     C           @RTCD     ANDNE'*NRF   '                                                     CER001
     C           *LOCK     IN   LDA                                                           CER001
     C                     Z-ADD5         DBASE                                               CER001
     C                     MOVEL'SCSARDPD'DBFILE                                              CER001
     C                     MOVEL'ULX008'  DBKEY                                               CER001
     C                     OUT  LDA                                                           CER001
     C                     EXSR *PSSR                                                         CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
      ** If feature ULX008 is installed.                                                      CER001
      *                                                                                       CER001
     C           @RTCD     IFEQ *BLANKS                                                       CER001
     C                     MOVE 'Y'       ULX008                                              CER001
     C                     MOVE *ON       *IN61                                               CER001
      *                                                                                       CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
      ** Determine if feature ULX048 is installed                                             CER001
      *                                                                                       CER001
     C                     MOVE 'N'       ULX048  1                                           CER001
     C                     MOVE *OFF      *IN63                                               CER001
     C                     CALL 'AOSARDR0'                                                    CER001
     C                     PARM *BLANKS   @RTCD   7                                           CER001
     C                     PARM '*VERIFY' @OPTN   7                                           CER001
     C                     PARM 'ULX048'  @SARD   6                                           CER001
     C           SCSARD    PARM SCSARD    DSSDY                                               CER001
      *                                                                                       CER001
     C           @RTCD     IFNE *BLANKS                                                       CER001
     C           @RTCD     ANDNE'*NRF   '                                                     CER001
     C           *LOCK     IN   LDA                                                           CER001
     C                     Z-ADD5         DBASE                                               CER001
     C                     MOVEL'SCSARDPD'DBFILE                                              CER001
     C                     MOVEL'ULX048'  DBKEY                                               CER001
     C                     OUT  LDA                                                           CER001
     C                     EXSR *PSSR                                                         CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
      ** If feature ULX048 is installed.                                                      CER001
      *                                                                                       CER001
     C           @RTCD     IFEQ *BLANKS                                                       CER001
     C                     MOVE 'Y'       ULX048                                              CER001
     C                     MOVE *ON       *IN63                                               CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
      ** Access Bank Details                                                                  CGL032
      *                                                                                       CGL032
     C                     CALL 'AOBANKR0'                                                    CGL032
     C                     PARM '*DBERR ' PRTCD   7                                           CGL032
     C                     PARM '*FIRST ' POPTN   7                                           CGL032
     C           SDBANK    PARM SDBANK    DSFDY                                               CGL032
      *                                                                                       CGL032
      ** DB Error Management                                                                  CGL032
      *                                                                                       CGL032
     C           PRTCD     IFNE *BLANK                                                        CGL032
     C           *LOCK     IN   LDA                                                           CGL032
     C                     Z-ADD003       DBASE            ************                       CGL032
     C                     MOVEL'SDBANKPD'DBFILE           * DBERR  03*                       CGL032
     C                     MOVELPOPTN     DBKEY            ************                       CGL032
     C                     OUT  LDA                                                           CGL032
     C                     EXSR *PSSR                                                         CGL032
     C                     ENDIF                                                              CGL032
     C*                                                                   CDL002
     C**  Access Switchable features file (FX Netting)                    CDL002
     C*                                                                   CDL002
     C                     CALL 'AOSARDR0'                                CDL002
     C                     PARM '       ' @RTCD                           CDL002
     C                     PARM '*VERIFY' @OPTN                           CDL002
     C                     PARM 'CDL002'  @SARD                           CDL002
     C           SCSARD    PARM SCSARD    DSFDY                           CDL002
      *                                                                   CDL002
     C           @RTCD     IFEQ *BLANK                                    CDL002
     C                     MOVE 'Y'       CDL002  1                       CDL002
     C                     MOVE *ON       *IN87                           CDL002
     C                     END                                            CDL002
      *                                                                   S01383
      ***  Access SAR details file to see if BRT SAR is installed.        S01383
      *                                                                   S01383
     C                     CALL 'AOSARDR0'                                S01383
     C                     PARM '       ' @RTCD   7                       S01383
     C                     PARM '*VERIFY' @OPTN   7                       S01383
     C                     PARM 'S01383'  @SARD   6                       S01383
      *                                                                   S01383
     C           @RTCD     IFEQ *BLANK                                    S01383
     C                     MOVE 'Y'       S01383  1                       S01383
     C                     SETON                     86                   S01383
     C                     END                                            S01383
      *                                                                   CRE007
      ** Access SAR details file to see if Base Rate Tax 2001 is ON.      CRE007
      *                                                                   CRE007
     C                     CALL 'AOSARDR0'                                CRE007
     C                     PARM '       ' @RTCD                           CRE007
     C                     PARM '*VERIFY' @OPTN                           CRE007
     C                     PARM 'CRE007'  @SARD                           CRE007
      *                                                                   CRE007
      ** If Base Rate Tax 2001 is switched ON output field                CRE007
      ** PSTR - Post 5/4/01 R105.                                         CRE007
      *                                                                   CRE007
     C           @RTCD     IFEQ *BLANKS                                   CRE007
     C                     MOVE *ON       *IN80                           CRE007
     C                     ENDIF                                          CRE007
     C*                                                                   S01383
     C/COPY WNCPYSRC,SD0010PC05
     C*
      *                                                                                       CER001
      ** Check Whether ULX043 is Present or not (Lux Returns)                                 CER001
      *                                                                                       CER001
     C                     MOVE 'N'       ULX043  1                                           CER001
     C           BGNWST    IFEQ 'Y'                                                           CER001
      *                                                                                       CER001
     C                     CALL 'AOSARDR0'                                                    CER001
     C                     PARM *BLANKS   @RTCD                                               CER001
     C                     PARM '*VERIFY' @OPTN                                               CER001
     C                     PARM 'ULX043'  @SARD                                               CER001
     C           SCSARD    PARM SCSARD    DSSDY                                               CER001
      *                                                                                       CER001
     C           @RTCD     IFNE *BLANKS                                                       CER001
     C           @RTCD     ANDNE'*NRF   '                                                     CER001
     C           *LOCK     IN   LDA                                                           CER001
     C                     Z-ADD5         DBASE                                               CER001
     C                     MOVEL'SCSARDPD'DBFILE                                              CER001
     C                     MOVEL'ULX043'  DBKEY                                               CER001
     C                     OUT  LDA                                                           CER001
     C                     EXSR *PSSR                                                         CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C           @RTCD     IFEQ *BLANK                                                        CER001
     C                     MOVE 'Y'       ULX043                                              CER001
     C                     ENDIF                                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C* Access Switchable features file to see if Automatic Customer      S01421
     C* Deletion is installed.                                            S01421
     C*                                                                   S01421
     C                     CALL 'AOSARDR0'                                S01421
     C                     PARM '       ' RTCD1   7                       S01421
     C                     PARM '*VERIFY' RTCD2   7                       S01421
     C                     PARM 'S01424'  RTCD3   6                       S01421
     C*                                                                   S01421
     C           RTCD1     IFEQ *BLANK                                    S01421
     C                     MOVE *ON       *IN22                           S01421
     C                     END                                            S01421
     C*                                                                   S01421
     C* Access Switchable features file to see if Additional Customer     S01421
     C* Details is installed.                                             S01421
     C*                                                                   S01421
     C                     CALL 'AOSARDR0'                                S01421
     C                     PARM '       ' RTCDA   7                       S01421
     C                     PARM '*VERIFY' RTCDB   7                       S01421
     C                     PARM 'S01425'  RTCDC   6                       S01421
     C*                                                                   S01421
     C           RTCDA     IFEQ *BLANK                                    S01421
     C                     MOVE *ON       *IN23                           S01421
     C                     END                                            S01421
     C*
     C* Access Switchable features file to see if EMU User Defined        CEU014
     C* Correspondence is installed.                                      CEU014
     C*                                                                   CEU014
     C                     CALL 'AOSARDR0'                                CEU014
     C                     PARM '       ' RTCD1                           CEU014
     C                     PARM '*VERIFY' RTCD2                           CEU014
     C                     PARM 'CEU014'  RTCD3                           CEU014
     C*                                                                   CEU014
     C* 'Designated In Currency' is only printed if UDC module is on.     CEU014
     C*                                                                   CEU014
     C           RTCD1     IFEQ *BLANK                                    CEU014
     C           BGN1ST    ANDEQ'Y'                                       CEU014
     C                     MOVE *ON       *IN70                           CEU014
     C                     ENDIF                                          CEU014
      *                                                                   CDL006
      ** Access Switchable features file, Check if feature CDL006         CDL006
      ** is Switched on.                                                  CDL006
      *                                                                   CDL006
     C                     CALL 'AOSARDR0'                                CDL006
     C                     PARM *BLANKS   PRTCD   7                       CDL006
     C                     PARM '*VERIFY' POPTN   7                       CDL006
     C                     PARM 'CDL006'  PSARD   6                       CDL006
     C           SCSARD    PARM SCSARD    DSSDY                           CDL006
      *                                                                   CDL006
     C           PRTCD     IFNE *BLANK                                    CDL006
     C           PRTCD     ANDNE'*NRF '                                   CDL006
     C           *LOCK     IN   LDA                                       CDL006
     C                     Z-ADD001       DBASE            ***************CDL006
     C                     MOVEL'SCSARDPD'DBFILE           **DB ERROR 001*CDL006
     C                     MOVELPSARD     DBKEY            ***************CDL006
     C                     OUT  LDA                                       CDL006
     C                     EXSR *PSSR                                     CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
      ** Exhibit printing of DL Fiduciary details if feature is           CDL006
      ** switched on.                                                     CDL006
      *                                                                   CDL006
     C           PRTCD     IFEQ *BLANK                                    CDL006
     C                     MOVE 'Y'       CDL006  1                       CDL006
     C                     MOVE '1'       *IN17                           CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL008
      ** Access Switchable features file to check if CDL008 is on.        CDL008
      *                                                                   CDL008
     C                     CALL 'AOSARDR0'                                CDL008
     C                     PARM *BLANKS   PRTCD                           CDL008
     C                     PARM '*VERIFY' POPTN                           CDL008
     C                     PARM 'CDL008'  PSARD                           CDL008
     C           SCSARD    PARM SCSARD    DSSDY                           CDL008
      *                                                                   CDL008
     C           PRTCD     IFNE *BLANK                                    CDL008
     C           PRTCD     ANDNE'*NRF '                                   CDL008
     C           *LOCK     IN   LDA                                       CDL008
     C                     Z-ADD002       DBASE            ************** CDL008
     C                     MOVEL'SCSARDPD'DBFILE           * DB ERR 002 * CDL008
     C                     MOVEL'CDL008'  DBKEY            ************** CDL008
     C                     OUT  LDA                                       CDL008
     C                     EXSR *PSSR                                     CDL008
     C                     ENDIF                                          CDL008
      *                                                                   CDL008
     C           PRTCD     IFEQ *BLANK                                    CDL008
     C                     MOVE 'Y'       CDL008  1                       CDL008
     C                     MOVE *ON       *IN75                           CDL008
     C                     ELSE                                           CDL008
     C                     MOVE 'N'       CDL008                          CDL008
     C                     MOVE *OFF      *IN75                           CDL008
     C                     ENDIF                                          CDL008
      *                                                                   CSD007
      ** Access switchable features file to check if CSD007 is on         CSD007
      *                                                                   CSD007
     C                     CALL 'AOSARDR0'                                CSD007
     C                     PARM *BLANKS   PRTCD                           CSD007
     C                     PARM '*VERIFY' POPTN                           CSD007
     C                     PARM 'CSD007'  PSARD                           CSD007
     C           SCSARD    PARM SCSARD    DSSDY                           CSD007
      *                                                                   CSD007
     C           PRTCD     IFNE *BLANKS                                   CSD007
     C           PRTCD     ANDNE'*NRF   '                                 CSD007
     C           *LOCK     IN   LDA                                       CSD007
     C                     Z-ADD002       DBASE            ************** CSD007
     C                     MOVEL'SCSARDPD'DBFILE           * DBERROR 02 * CSD007
     C                     MOVELPSARD     DBKEY            ************** CSD007
     C                     OUT  LDA                                       CSD007
     C                     EXSR *PSSR                                     CSD007
     C                     ENDIF                                          CSD007
      *                                                                   CSD007
     C           PRTCD     IFEQ *BLANKS                                   CSD007
     C                     MOVE 'Y'       CSD007  1                       CSD007
     C                     ELSE                                           CSD007
     C                     MOVE 'N'       CSD007                          CSD007
     C                     ENDIF                                          CSD007
     C/COPY WNCPYSRC,SDH00579
      *                                                                                       CSW024
      ** Access Switchable features file, Check if feature CSW024                             CSW024
      ** is Switched on.                                                                      CSW024
      *                                                                                       CSW024
     C                     MOVE 'N'       CSW024  1                                           CSW024
     C                     CALL 'AOSARDR0'                                                    CSW024
     C                     PARM *BLANKS   PRTCD                                               CSW024
     C                     PARM '*VERIFY' POPTN                                               CSW024
     C                     PARM 'CSW024'  PSARD                                               CSW024
     C           SCSARD    PARM SCSARD    DSSDY                                               CSW024
      *                                                                                       CSW024
     C           PRTCD     IFNE *BLANK                                                        CSW024
     C           PRTCD     ANDNE'*NRF   '                                                     CSW024
     C           *LOCK     IN   LDA                                                           CSW024
     C                     Z-ADD003       DBASE                                               CSW024
     C                     MOVEL'SCSARDPD'DBFILE                                              CSW024
     C                     MOVELPSARD     DBKEY                                               CSW024
     C                     OUT  LDA                                                           CSW024
     C                     EXSR *PSSR                                                         CSW024
     C                     ELSE                                                               CSW024
     C           PRTCD     IFEQ *BLANK                                                        CSW024
     C                     MOVE 'Y'       CSW024                                              CSW024
     C                     MOVE *ON       *IN18                                               CSW024
     C                     ENDIF                                                              CSW024
     C                     ENDIF                                                              CSW024
      *                                                                                       CGP001
      ** Check if CGP001 is enabled.                                                          CGP001
      *                                                                                       CGP001
     C                     CALL 'AOSARDR0'                                                    CGP001
     C                     PARM *BLANKS   PRTCD   7                                           CGP001
     C                     PARM '*VERIFY' POPTN   7                                           CGP001
     C                     PARM 'CGP001'  PSARD   6                                           CGP001
     C           SCSARD    PARM *BLANKS   DSFDY                                               CGP001
      *                                                                                       CGP001
     C                     MOVE 'N'       CGP001  1                                           CGP001
     C                     MOVE *OFF      *IN68                                               CGP001
     C           PRTCD     IFEQ *BLANKS                                                       CGP001
     C                     MOVE 'Y'       CGP001                                              CGP001
     C                     MOVE *ON       *IN68                                               CGP001
      *                                                                                       CGP001
      ** Open the Global Processing Files.                                                    CGP001
      *                                                                                       CGP001
     C                     EXSR SRGPOF                                                        CGP001
      *                                                                                       CGP001
     C                     ELSE                                                               CGP001
      *                                                                                       CGP001
     C           PRTCD     IFNE '*NRF'                                                        CGP001
     C                     MOVEL'SCSARDPD'DBFILE                                              CGP001
     C                     MOVEL'CGP001'  DBKEY                                               CGP001
     C                     MOVEL'908'     DBASE                                               CGP001
     C                     MOVE *ON       *INU7                                               CGP001
     C                     MOVE *ON       *INU8                                               CGP001
     C                     MOVE *ON       *INLR                                               CGP001
     C                     EXSR *PSSR                                                         CGP001
     C                     ENDIF                                                              CGP001
      *                                                                                       CGP001
     C                     ENDIF                                                              CGP001
      *                                                                   CGL018
      ***  Determine if switchable feature CGL018 is activated            CGL018
      *                                                                   CGL018
     C                     CALL 'AOSARDR0'                                CGL018
     C                     PARM *BLANKS   PRTCD   7                       CGL018
     C                     PARM '*VERIFY' POPTN   7                       CGL018
     C                     PARM 'CGL018'  PSARD   6                       CGL018
     C           SCSARD    PARM SCSARD    DSFDY                           CGL018
      *                                                                   CGL018
     C           PRTCD     IFEQ *BLANK                                    CGL018
     C                     MOVE 'Y'       CGL018  1                       CGL018
     C                     SETON                     81                   CGL018
     C                     ELSE                                           CGL018
     C                     MOVE 'N'       CGL018                          CGL018
     C                     SETOF                     81                   CGL018
     C                     ENDIF                                          CGL018
      *                                                                                       CLE025
      ** Check if enhancement CLE025 (Multi-Option Facilities) is switched on                 CLE025
      *                                                                                       CLE025
     C                     CALL 'AOSARDR0'                                                    CLE025
     C                     PARM *BLANKS   PRTCD                                               CLE025
     C                     PARM '*VERIFY' POPTN                                               CLE025
     C                     PARM 'CLE025'  PSARD                                               CLE025
     C           SCSARD    PARM SCSARD    DSSDY                                               CLE025
      *                                                                                       CLE025
     C           PRTCD     IFNE *BLANKS                                                       CLE025
     C           PRTCD     ANDNE'*NRF   '                                                     CLE025
     C           *LOCK     IN   LDA                                                           CLE025
     C                     Z-ADD4         DBASE                                               CLE025
     C                     MOVEL'SCSARDPD'DBFILE                                              CLE025
     C                     MOVEL'CLE025'  DBKEY                                               CLE025
     C                     OUT  LDA                                                           CLE025
     C                     EXSR *PSSR                                                         CLE025
     C                     ENDIF                                                              CLE025
      *                                                                                       CLE025
     C           PRTCD     IFEQ *BLANKS                                                       CLE025
     C                     MOVE *ON       *IN25                                               CLE025
     C                     MOVE 'Y'       CLE025  1                                           CLE025
     C                     ELSE                                                               CLE025
     C                     MOVE 'N'       CLE025  1                                           CLE025
     C                     ENDIF                                                              CLE025
      *                                                                                       CFX001
      ** Check if enhancement CFX001 is installed                                             CFX001
      *                                                                                       CFX001
     C                     CALL 'AOSARDR0'                                                    CFX001
     C                     PARM *BLANKS   PRTCD                                               CFX001
     C                     PARM '*VERIFY' POPTN                                               CFX001
     C                     PARM 'CFX001'  PSARD                                               CFX001
     C           SCSARD    PARM SCSARD    DSSDY                                               CFX001
      *                                                                                       CFX001
     C           PRTCD     IFNE *BLANKS                                                       CFX001
     C           PRTCD     ANDNE'*NRF   '                                                     CFX001
     C           *LOCK     IN   LDA                                                           CFX001
     C                     Z-ADD5         DBASE                                               CFX001
     C                     MOVEL'SCSARDPD'DBFILE                                              CFX001
     C                     MOVEL'CFX001'  DBKEY                                               CFX001
     C                     OUT  LDA                                                           CFX001
     C                     EXSR *PSSR                                                         CFX001
     C                     ENDIF                                                              CFX001
      *                                                                                       CFX001
     C           PRTCD     IFEQ *BLANKS                                                       CFX001
     C                     MOVE 'Y'       CFX001  1                                           CFX001
     C                     MOVE *ON       *IN25                                               CFX001
     C                     ELSE                                                               CFX001
     C                     MOVE 'N'       CFX001  1                                           CFX001
     C                     ENDIF                                                              CFX001
      *                                                                                       CFX001
      *                                                                                       CSD025
      ** Check if enhancement CSD025 is installed                                             CSD025
      *                                                                                       CSD025
     C                     CALL 'AOSARDR0'                                                    CSD025
     C                     PARM *BLANKS   PRTCD                                               CSD025
     C                     PARM '*VERIFY' POPTN                                               CSD025
     C                     PARM 'CSD025'  PSARD                                               CSD025
     C           SCSARD    PARM SCSARD    DSSDY                                               CSD025
      *                                                                                       CSD025
     C           PRTCD     IFNE *BLANKS                                                       CSD025
     C           PRTCD     ANDNE'*NRF   '                                                     CSD025
     C           *LOCK     IN   LDA                                                           CSD025
     C                     Z-ADD5         DBASE                                               CSD025
     C                     MOVEL'SCSARDPD'DBFILE                                              CSD025
     C                     MOVEL'CSD025'  DBKEY                                               CSD025
     C                     OUT  LDA                                                           CSD025
     C                     EXSR *PSSR                                                         CSD025
     C                     ENDIF                                                              CSD025
      *                                                                                       CSD025
     C           PRTCD     IFEQ *BLANKS                                                       CSD025
     C                     MOVE 'Y'       CSD025  1                                           CSD025
     C                     MOVE *ON       *IN72                                               CSD025
     C                     ELSE                                                               CSD025
     C                     MOVE 'N'       CSD025  1                                           CSD025
     C                     MOVE *OFF      *IN72                                               CSD025
     C                     ENDIF                                                              CSD025
      *                                                                                       CSD025
      ** Check if enhancement ULX004 is installed                                             CER001
      *                                                                                       CER001
     C                     CALL 'AOSARDR0'                                                    CER001
     C                     PARM *BLANKS   PRTCD                                               CER001
     C                     PARM '*VERIFY' POPTN                                               CER001
     C                     PARM 'ULX004'  PSARD                                               CER001
     C           SCSARD    PARM SCSARD    DSSDY                                               CER001
      *                                                                                       CER001
     C           PRTCD     IFNE *BLANKS                                                       CER001
     C           PRTCD     ANDNE'*NRF   '                                                     CER001
     C           *LOCK     IN   LDA                                                           CER001
     C                     Z-ADD5         DBASE                                               CER001
     C                     MOVEL'SCSARDPD'DBFILE                                              CER001
     C                     MOVEL'ULX004'  DBKEY                                               CER001
     C                     OUT  LDA                                                           CER001
     C                     EXSR *PSSR                                                         CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C           PRTCD     IFEQ *BLANKS                                                       CER001
     C                     MOVE 'Y'       ULX004  1                                           CER001
     C                     ELSE                                                               CER001
     C                     MOVE 'N'       ULX004  1                                           CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CSD025
      ** Check if enhancement CSW037A is installed                        CSW037A
      *                                                                   CSW037A
     C                     CALL 'AOSARDR0'                                CSW037A
     C                     PARM *BLANKS   PRTCD                           CSW037A
     C                     PARM '*VERIFY' POPTN                           CSW037A
     C                     PARM 'CSW037'  PSARD                           CSW037A
     C           SCSARD    PARM SCSARD    DSSDY                           CSW037A
      *                                                                   CSW037A
     C           PRTCD     IFNE *BLANKS                                   CSW037A
     C           PRTCD     ANDNE'*NRF   '                                 CSW037A
     C           *LOCK     IN   LDA                                       CSW037A
     C                     Z-ADD5         DBASE                           CSW037A
     C                     MOVEL'SCSARDPD'DBFILE                          CSW037A
     C                     MOVEL'CSW037'  DBKEY                           CSW037A
     C                     OUT  LDA                                       CSW037A
     C                     EXSR *PSSR                                     CSW037A
     C                     ENDIF                                          CSW037A
      *                                                                   CSW037A
     C           PRTCD     IFEQ *BLANKS                                   CSW037A
     C                     MOVE 'Y'       CSW037  1                       CSW037A
     C                     MOVE *ON       *IN73                           CSW037A
     C                     ELSE                                           CSW037A
     C                     MOVE 'N'       CSW037                          CSW037A
     C                     MOVE *OFF      *IN73                           CSW037A
     C                     ENDIF                                          CSW037A
      *                                                                   CSW037A
      ** Access switchable features file to check if CSD029 is on                             CSD029
      *                                                                                       CSD029
     C                     CALL 'AOSARDR0'                                                    CSD029
     C                     PARM *BLANKS   PRTCD                                               CSD029
     C                     PARM '*VERIFY' POPTN                                               CSD029
     C                     PARM 'CSD029'  PSARD                                               CSD029
     C           SCSARD    PARM SCSARD    DSSDY                                               CSD029
      *                                                                                       CSD029
     C           PRTCD     IFEQ *BLANKS                                                       CSD029
     C                     MOVE 'Y'       CSD029  1                                           CSD029
     C                     ELSE                                                               CSD029
     C                     MOVE 'N'       CSD029                                              CSD029
     C                     ENDIF                                                              CSD029
      ** Access Switchable features file to see if Automatic Exchange                         CGL032
      ** of Information CGL032 is installed.                                                  CGL032
      *                                                                                       CGL032
     C                     CALL 'AOSARDR0'                                                    CGL032
     C                     PARM '       ' PRTCD                                               CGL032
     C                     PARM '*VERIFY' POPTN                                               CGL032
     C                     PARM 'CGL032'  PSARD                                               CGL032
     C           SCSARD    PARM SCSARD    DSSDY                                               CGL032
      *                                                                                       CGL032
      ** DB Error Management.                                                                 CGL032
      *                                                                                       CGL032
     C           PRTCD     IFNE *BLANKS                                                       CGL032
     C           PRTCD     ANDNE'*NRF   '                                                     CGL032
     C           *LOCK     IN   LDA                                                           CGL032
     C                     Z-ADD007       DBASE            **************                     CGL032
     C                     MOVEL'SCSARDPD'DBFILE           * DBERROR 06 *                     CGL032
     C                     MOVELPSARD     DBKEY            **************                     CGL032
     C                     OUT  LDA                                                           CGL032
     C                     EXSR *PSSR                                                         CGL032
     C                     ENDIF                                                              CGL032
      *                                                                                       CGL032
     C           PRTCD     IFEQ *BLANKS                                                       CGL032
     C                     MOVE 'Y'       CGL032  1                                           CGL032
     C                     ELSE                                                               CGL032
     C                     MOVE 'N'       CGL032                                              CGL032
     C                     ENDIF                                                              CGL032
      *                                                                                       CGL032
      ** Check CSW207 feature                                                                 CSW207
     C                     CALL 'SWIF2007'                                                    CSW207
     C                     PARM '       ' PRTCD                                               CSW207
     C********** PRTCD     IFEQ 'CSW207'                                             CSW207 BUG14933
     C           PRTCD     IFEQ 'CSW2007'                                                   BUG14933
     C                     MOVEL'Y'       CSW207  1                                           CSW207
     C                     ELSE                                                               CSW207
     C                     MOVEL'N'       CSW207                                              CSW207
     C                     ENDIF                                                              CSW207
      ** Check CGL031 feature                                                                 CSW207
     C                     CALL 'AOSARDR0'                                                    CSW207
     C                     PARM '       ' PRTCD                                               CSW207
     C                     PARM '*VERIFY' POPTN                                               CSW207
     C                     PARM 'CGL031'  PSARD                                               CSW207
     C           SCSARD    PARM SCSARD    DSSDY                                               CSW207
      *                                                                                       CSW207
      ** DB Error Management.                                                                 CSW207
      *                                                                                       CSW207
     C                     MOVEL'N'       CGL031  1                                           CSW207
     C           PRTCD     IFNE *BLANKS                                                       CSW207
     C           PRTCD     ANDNE'*NRF   '                                                     CSW207
     C           *LOCK     IN   LDA                                                           CSW207
     C                     Z-ADD008       DBASE            **************                     CSW207
     C                     MOVEL'SCSARDPD'DBFILE           * DBERROR 08 *                     CSW207
     C                     MOVELPSARD     DBKEY            **************                     CSW207
     C                     OUT  LDA                                                           CSW207
     C                     EXSR *PSSR                                                         CSW207
     C                     ELSE                                                               CSW207
     C                     MOVEL'Y'       CGL031                                              CSW207
     C                     ENDIF                                                              CSW207
      *                                                                                       CSW207
     C           CSW207    IFEQ 'Y'                                                           CSW207
     C                     SETON                     35                                       CSW207
     C                     ELSE                                                               CSW207
     C                     SETOF                     35                                       CSW207
     C                     ENDIF                                                              CSW207
      *                                                                                       CSW207
     C           CGL031    IFEQ 'Y'                                                           CSW207
     C           CGL032    ANDEQ'Y'                                                           CSW207
     C                     SETON                     36                                       CSW207
     C                     ELSE                                                               CSW207
     C                     SETOF                     36                                       CSW207
     C                     ENDIF                                                              CSW207
      *                                                                                      CER034A
      ** Access switchable features file to check if CER034 is on                            CER034A
      *                                                                                      CER034A
     C                     CALL 'AOSARDR0'                                                   CER034A
     C                     PARM *BLANKS   PRTCD                                              CER034A
     C                     PARM '*VERIFY' POPTN                                              CER034A
     C                     PARM 'CER034'  PSARD                                              CER034A
     C           SCSARD    PARM SCSARD    DSSDY                                              CER034A
      *                                                                                      CER034A
     C           PRTCD     IFEQ *BLANKS                                                      CER034A
     C                     MOVE 'Y'       CER034  1                                          CER034A
     C                     ELSE                                                              CER034A
     C                     MOVE 'N'       CER034                                             CER034A
     C                     ENDIF                                                             CER034A
      *                                                                                      CER034A
      ** Access switchable features file to check if CER038 is on                            CER034A
      *                                                                                      CER034A
     C                     CALL 'AOSARDR0'                                                   CER034A
     C                     PARM *BLANKS   PRTCD                                              CER034A
     C                     PARM '*VERIFY' POPTN                                              CER034A
     C                     PARM 'CER038'  PSARD                                              CER034A
     C           SCSARD    PARM SCSARD    DSSDY                                              CER034A
      *                                                                                      CER034A
     C           PRTCD     IFEQ *BLANKS                                                      CER034A
     C                     MOVE 'Y'       CER038  1                                          CER034A
     C                     ELSE                                                              CER034A
     C                     MOVE 'N'       CER038                                             CER034A
     C                     ENDIF                                                             CER034A
      *                                                                                      CER034A
      ** Access switchable features file to check if CER041 is on                            CER034A
      *                                                                                      CER034A
     C                     CALL 'AOSARDR0'                                                   CER034A
     C                     PARM *BLANKS   PRTCD                                              CER034A
     C                     PARM '*VERIFY' POPTN                                              CER034A
     C                     PARM 'CER041'  PSARD                                              CER034A
     C           SCSARD    PARM SCSARD    DSSDY                                              CER034A
      *                                                                                      CER034A
     C           PRTCD     IFEQ *BLANKS                                                      CER034A
     C                     MOVE 'Y'       CER041  1                                          CER034A
     C                     ELSE                                                              CER034A
     C                     MOVE 'N'       CER041                                             CER034A
     C                     ENDIF                                                             CER034A
      *                                                                                      CER034A
      ** Access switchable features file to check if CER047 is on                            CER034A
      *                                                                                      CER034A
     C                     CALL 'AOSARDR0'                                                   CER034A
     C                     PARM *BLANKS   PRTCD                                              CER034A
     C                     PARM '*VERIFY' POPTN                                              CER034A
     C                     PARM 'CER047'  PSARD                                              CER034A
     C           SCSARD    PARM SCSARD    DSSDY                                              CER034A
      *                                                                                      CER034A
     C           PRTCD     IFEQ *BLANKS                                                      CER034A
     C                     MOVE 'Y'       CER047  1                                          CER034A
     C                     ELSE                                                              CER034A
     C                     MOVE 'N'       CER047                                             CER034A
     C                     ENDIF                                                             CER034A
      *                                                                                      CER034A
      ** Access switchable features file to check if CER048 is on                            CER034A
      *                                                                                      CER034A
     C                     CALL 'AOSARDR0'                                                   CER034A
     C                     PARM *BLANKS   PRTCD                                              CER034A
     C                     PARM '*VERIFY' POPTN                                              CER034A
     C                     PARM 'CER048'  PSARD                                              CER034A
     C           SCSARD    PARM SCSARD    DSSDY                                              CER034A
      *                                                                                      CER034A
     C           PRTCD     IFEQ *BLANKS                                                      CER034A
     C                     MOVE 'Y'       CER048  1                                          CER034A
     C                     ELSE                                                              CER034A
     C                     MOVE 'N'       CER048                                             CER034A
     C                     ENDIF                                                             CER034A
      *                                                                                       CER054
      ** Access switchable features file to check if CER054 is on                             CER054
      *                                                                                       CER054
     C                     CALL 'AOSARDR0'                                                    CER054
     C                     PARM *BLANKS   PRTCD                                               CER054
     C                     PARM '*VERIFY' POPTN                                               CER054
     C                     PARM 'CER054'  PSARD                                               CER054
     C           SCSARD    PARM SCSARD    DSSDY                                               CER054
      *                                                                                       CER054
     C           PRTCD     IFEQ *BLANKS                                                       CER054
     C                     MOVE 'Y'       CER054  1                                           CER054
     C                     ELSE                                                               CER054
      *                                                                                       CER054
      ** DB Error Management.                                                                 CER054
      *                                                                                       CER054
     C                     MOVEL'N'       CER054                                              CER054
     C           PRTCD     IFNE *BLANKS                                                       CER054
     C           PRTCD     ANDNE'*NRF   '                                                     CER054
     C           *LOCK     IN   LDA                                                           CER054
     C                     Z-ADD009       DBASE                                               CER054
     C                     MOVEL'SCSARDPD'DBFILE                                              CER054
     C                     MOVELPSARD     DBKEY                                               CER054
     C                     OUT  LDA                                                           CER054
     C                     EXSR *PSSR                                                         CER054
     C                     ENDIF                                                              CER054
      *                                                                                       CER054
     C                     ENDIF                                                              CER054
      *                                                                                      CER034A
      ** Access switchable features file to check if CER045 is on                             CER045
      *                                                                                       CER045
     C                     CALL 'AOSARDR0'                                                    CER045
     C                     PARM *BLANKS   PRTCD                                               CER045
     C                     PARM '*VERIFY' POPTN                                               CER045
     C                     PARM 'CER045'  PSARD                                               CER045
     C           SCSARD    PARM SCSARD    DSSDY                                               CER045
      *                                                                                       CER045
     C           PRTCD     IFEQ *BLANKS                                                       CER045
     C                     MOVE 'Y'       CER045  1                                           CER045
     C                     ELSE                                                               CER045
     C                     MOVE 'N'       CER045                                              CER045
     C                     ENDIF                                                              CER045
      *                                                                                       CER045
      ** Set Display Indicators                                                              CER034A
      *                                                                                      CER034A
     C           CER034    IFEQ 'Y'                                                          CER034A
     C                     MOVE *ON       *IN51                                              CER034A
     C                     ELSE                                                              CER034A
     C                     MOVE *OFF      *IN51                                              CER034A
     C                     ENDIF                                                             CER034A
      *                                                                                      CER034A
     C           CER038    IFEQ 'Y'                                                          CER034A
     C                     MOVE *ON       *IN52                                              CER034A
     C                     ELSE                                                              CER034A
     C                     MOVE *OFF      *IN52                                              CER034A
     C                     ENDIF                                                             CER034A
      *                                                                                      CER034A
     C           CER041    IFEQ 'Y'                                                          CER034A
     C                     MOVE *ON       *IN53                                              CER034A
     C                     ELSE                                                              CER034A
     C                     MOVE *OFF      *IN53                                              CER034A
     C                     ENDIF                                                             CER034A
      *                                                                                      CER034A
     C           CER047    IFEQ 'Y'                                                          CER034A
     C                     MOVE *ON       *IN56                                              CER034A
     C                     ELSE                                                              CER034A
     C                     MOVE *OFF      *IN56                                              CER034A
     C                     ENDIF                                                             CER034A
      *                                                                                      CER034A
     C           CER048    IFEQ 'Y'                                                          CER034A
     C                     MOVE *ON       *IN57                                              CER034A
     C                     ELSE                                                              CER034A
     C                     MOVE *OFF      *IN57                                              CER034A
     C                     ENDIF                                                             CER034A
      *                                                                                       CER054
     C           CER054    IFEQ 'Y'                                                           CER054
     C                     MOVE *ON       *IN58                                               CER054
     C                     ELSE                                                               CER054
     C                     MOVE *OFF      *IN58                                               CER054
     C                     ENDIF                                                              CER054
      *                                                                                       CER045
     C           CER045    IFEQ 'Y'                                                           CER045
     C                     MOVE *ON       *IN59                                               CER045
     C                     ELSE                                                               CER045
     C                     MOVE *OFF      *IN59                                               CER045
     C                     ENDIF                                                              CER045
      *                                                                                      CER034A
      ** Check if SWIFT Changes 2013 (CSW213) is installed                                    CSW213
      *                                                                                       CSW213
     C                     MOVE 'N'       CSW213  1                                           CSW213
     C                     MOVE *OFF      *IN37                                               CSW213
      *                                                                                       CSW213
     C                     CALL 'SWIF2013'                                                    CSW213
     C                     PARM *BLANKS   PRTCD                                               CSW213
      *                                                                                       CSW213
     C           PRTCD     IFEQ 'CSW2013'                                                     CSW213
     C                     MOVE 'Y'       CSW213                                              CSW213
     C                     MOVE *ON       *IN37                                               CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
      ** Check if feature CFT050 is installed                                                 CSW213
      *                                                                                       CSW213
     C                     MOVE 'N'       CFT050  1                                           CSW213
     C                     MOVE *OFF      *IN38                                               CSW213
      *                                                                                       CSW213
     C                     CALL 'AOSARDR0'                                                    CSW213
     C                     PARM *BLANKS   PRTCD                                               CSW213
     C                     PARM '*VERIFY' POPTN                                               CSW213
     C                     PARM 'CFT050'  PSARD                                               CSW213
     C           SCSARD    PARM SCSARD    DSSDY                                               CSW213
      *                                                                                       CSW213
     C           PRTCD     IFEQ *BLANKS                                                       CSW213
     C                     MOVE 'Y'       CFT050                                              CSW213
     C                     MOVE *ON       *IN38                                               CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C/COPY WNCPYSRC,SD0010PC33
     C*                                                                   CEU014
      * Move title to header - *Standard header/footer  *
     C* 7.10.89 Missing Source - Inserted During Incorporation            S01216
     C* Move User Report Title into Header Field in DDS for PRTF          S01216
     C*                                                                   S01216
     C*********************MOVE #IURPT    ##AGNA                   S01216 S01229
     C                     MOVE WUURPT    ##URPT                   S01216 S01229
      * Get Narrative Title - Narrative Codes  *
     C           *IN99     IFEQ '1'
     C                     MOVE 1         UIND    10
     C                     SETOF                         99
     C                     ELSE
     C                     MOVE 0         UIND
     C                     END
      *
      ** CALCULATE END OF TEXT POINT
     C                     Z-ADD1         U       20
     C*********************MOVEA#IBINA    UAR,U
     C                     MOVEA@CN,13    UAR,U
     C/COPY WNCPYSRC,SD0010PC36
     C*
     C           *IN99     DOWEQ'0'
     C           ' '       LOKUPUAR,U                    99
     C                     ADD  1         U
     C           UAR,U     COMP ' '                      99
     C                     END
      *
     C**
     C*
     C*          P1LSST    IFEQ 'A'                                       S01216
     C***********P1NEST    IFEQ 'A'                                S01216 S01117
     C           P1ARSI    IFEQ 'A'                                       S01117
     C*********************MOVELUARRAY,1  UTEMP  26                       LN0536
     C                     MOVELUARRAY,1  UTEMP  53                       LN0536
     C                     MOVEAUTEMP     UAR,U
     C                     ADD  26        U
     C                     ELSE
      *
     C                     MOVELUARRAY,2  UTEMP                           LN0536
     C*********************MOVEAUARRAY,2  UAR,U            * IF A THIRD   LN0536
     C                     MOVEAUTEMP     UAR,U            * IF A THIRD   LN0536
     C                     ADD  7         U                OPTION TO ARRAY
     C                     END                             IS ADDED A
      *                                                    TEMP STORAGE
      *                                                    * IS REQUIRED.
      **  STORE  TEXT IN USTORE FIELD
      *
     C                     MOVEAUAR       USTORE 53
     C                     MOVE *BLANKS   UAR
      *
      *
      *
     C           53        SUB  U         UB      20
     C           UB        DIV  2         UB
     C                     MVR            UR      10
     C           UB        ADD  U         U
     C           U         SUB  1         U
      *
      *
      **  INSERT UNDERLINE TO ARRAY
      **
     C                     MOVEA*ALL'-'   ULN,UB
     C                     MOVEA*BLANKS   ULN,U
      *
      *
     C           UB        IFGT 0
     C                     MOVEAUSTORE    UAR,UB
     C                     ELSE
     C                     MOVEAUSTORE    UAR
     C                     END
      *
      **  MOVE ARRAY VALUE  TO SCREEN TEXT FIELD
      *
     C*                    MOVEAUAR       ##EYTX                          S01216
     C*********************MOVEAUAR       ##E8TX 53                 S01216S01117
     C                     MOVEAUAR       ##AURT 53                 S01216S01117
     C*
     C/COPY WNCPYSRC,SD0010PC18
     C*
     C*                    MOVEAUAR       WUEYTX
     C*********************MOVEAUAR       WUE8TX                          S01117
     C                     MOVEAUAR       WUAURT                          S01117
     C*                    MOVEAULN       ##BJNA                          S01216
     C                     MOVEAULN       ##BJNA 53                       S01216
     C                     MOVEAULN       WUBJNA
      *
      *
      ** RESET INDICATOR *IN 99
      *
     C           UIND      IFEQ 1
     C                     SETON                         99
     C                     ELSE
     C                     SETOF                         99
     C                     END
      *
      * ZSFILE - log spool file - Standard Functions  *
     C*
     C* Set up spool file number - Standard Functions  *
     C                     Z-ADD@$FNB     WUSFNB
     C                     MOVE *BLANKS   UUSRSQ  5                       LN0721
     C*
     C* ZSFILE - write report rqs - Standard Functions  *
     C                     CALL 'ZSFILE'               90  ZSFILE - write
     C*********************PARM #IRSQN    UURSQN  5        RCF sequence nuLN0721
     C           UUSRSQ    PARM P2RSQN    UURSQN  5        RCF sequence nuLN0721
     C                     PARM P4ENTY    UUENTY  3        Entity
     C                     PARM @$FVN     UUSFNM 10        Spool file name
     C                     PARM WUSFNB    UUSFNB  60       Spool file numb
     C           WUZSER    PARM *BLANK    UUZSER  1        ZSFILE error
     C*
     C           *IN90     IFEQ '1'
     C* Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
     C*
     C* CASE: WRK.ZSFILE is error occurred
     C*
     C*          #OZSER    IFEQ 'Y'
     C*                    MOVEL'Y2U0004' P0RTN
     C*                    EXSR ZYEXPG
     C*                    END
      *CASE:     WRK.ZSFILE error is Error Occured
     C           WUZSER    IFEQ @CN,01                     *IF
     C                     MOVEL@CN,14    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     MOVEL@CN,01    WUMFTS           S01212
      *CASE:     WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ @CN,01                     *IF
      * 00/Copy Member SD0010PIPG - Client Details  *
     C/COPY WNCPYSRC,SD0010PCPG
      *                                                                                      LLN022A
      ** Define work field Yellow book feature ind                                           LLN022A
      *                                                                                      LLN022A
     C                     MOVEL*BLANK    LLN007  1                                          LLN022A
      *                                                                                      LLN022A
      ** Check to see if Yellow book changes (LLN007) is switched on.                        LLN022A
      *                                                                                      LLN022A
     C                     CALL 'AOSARDR0'                                                   LLN022A
     C                     PARM *BLANK    PRTCD                                              LLN022A
     C                     PARM '*VERIFY' POPTN                                              LLN022A
     C                     PARM 'LLN007'  PSARD                                              LLN022A
      *                                                                                      LLN022A
     C           PRTCD     IFEQ *BLANKS                                                      LLN022A
     C                     MOVE 'Y'       LLN007                                             LLN022A
     C                     ENDIF                                                             LLN022A
      *                                                                                      LLN022A
     C                     END                             *FI
      *================================================================
     CSR         ZZEXIT    ENDSR
      /EJECT                                                              CDL006
     C/COPY WNCPYSRC,SD0010PC07
      *****************************************************************   CDL006
      *                                                               *   CDL006
      * *PSSR    - TO PROCESS DATA BASE ERRORS                        *   CDL006
      *                                                               *   CDL006
      *****************************************************************   CDL006
      *                                                                   CDL006
     C           *PSSR     BEGSR                                          CDL006
     C           WRUN      IFEQ *BLANK                                    CDL006
     C                     MOVE 'Y'       WRUN    1                       CDL006
     C                     DUMP                                           CDL006
     C                     END                                            CDL006
      *                                                                   CDL006
     C                     MOVE '1'       *INU7                           CDL006
     C                     MOVE '1'       *INU8                           CDL006
     C                     MOVE '1'       *INLR                           CDL006
     C                     RETRN                                          CDL006
     C                     ENDSR                                          CDL006
      *****************************************************************   CDL006
      * RWA       : Output RWA information from SDCRWAPD                * CGL018
      * ---                                                             * CGL018
      * Called By : CAPRDT                                              * CGL018
      * Calls     : None                                                * CGL018
      ******************************************************************* CGL018
     C           RWADTL    BEGSR                                          CGL018
      *                                                                   CGL018
     C           XRCUST    SETLLSDCRWAD0                                  CGL018
     C           XRCUST    READESDCRWAD0                 82               CGL018
     C                     MOVE *BLANKS   XRWA                            CGL018
     C                     MOVEL*BLANKS   XRWASE                          CGL018
     C                     MOVEL*BLANKS   RWASEC                          CGL018
     C                     MOVEL*BLANKS   #CONTI                          CGL018
     C                     Z-ADD0         U       20                      CGL018
     C           *IN82     DOWEQ'0'                                       CGL018
      *                                                                   CGL018
      * Only live records                                                 CGL018
      *                                                                   CGL018
     C           RWRECI    IFNE '*'                                       CGL018
     C                     ADD  1         U                               CGL018
     C                     MOVE RWCODE    #RCODE                          CGL018
     C                     MOVE RWSETN    #RSET                           CGL018
      *                                                                   CGL018
     C           U         IFGT 18                                        CGL018
     C           #CONTI    ANDNE'C'                                       CGL018
     C                     Z-ADD1         U                               CGL018
     C                     MOVEL'C'       #CONTI  1                       CGL018
     C                     MOVEL*BLANKS   XRWASE                          CGL018
     C                     MOVEAXRWA      XRWASE                          CGL018
     C                     MOVE *BLANKS   XRWA                            CGL018
     C                     ENDIF                                          CGL018
      *                                                                   CGL018
     C                     MOVEARWSECO    XRWA,U                          CGL018
     C                     ENDIF                                          CGL018
      *                                                                   CGL018
     C           BBCUST    READESDCRWAD0                 82               CGL018
     C                     ENDDO                                          CGL018
      *                                                                   CGL018
      *                                                                   CGL018
     C           U         IFEQ 0                                         CGL018
     C                     MOVEL'None'    XRWASE                          CGL018
     C                     ELSE                                           CGL018
      *                                                                   CGL018
      * Last one must be without comma, so clear and output again         CGL018
      *                                                                   CGL018
     C                     MOVEL*BLANKS   #COMMA                          CGL018
     C                     MOVEARWSECO    XRWA,U                          CGL018
      *                                                                   CGL018
     C           #CONTI    IFEQ 'C'                                       CGL018
     C                     MOVEAXRWA      RWASEC                          CGL018
     C                     ELSE                                           CGL018
     C                     MOVEAXRWA      XRWASE                          CGL018
     C                     ENDIF                                          CGL018
      *                                                                   CGL018
     C                     MOVEL','       #COMMA                          CGL018
     C                     ENDIF                                          CGL018
      *                                                                   CGL018
     C                     ENDSR                                          CGL018
      ******************************************************************* CGL018
      /EJECT                                                                                  CSD029
     *******************************************************************                      CSD029
      *                                                                *                      CSD029
      *  SRFMTF - Suboutine to format fields                            *                     CSD029
      *                                                                 *                     CSD029
      *******************************************************************                     CSD029
     C           SRFMTF    BEGSR                                                              CSD029
      *                                                                                       CSD029
     C                     CALL 'AOSVALR0'                                                    CSD029
     C                     PARM           PRTCD                                               CSD029
     C                     PARM @VAL01    PVALK1 20                                           CSD029
     C                     PARM           PVAL1 200                                           CSD029
     C                     PARM @VAL02    PVALK2 20                                           CSD029
     C                     PARM           PVAL2 200                                           CSD029
     C                     PARM @VAL03    PVALK3 20                                           CSD029
     C                     PARM           PVAL3 200                                           CSD029
     C                     PARM @VAL04    PVALK4 20                                           CSD029
     C                     PARM           PVAL4 200                                           CSD029
     C                     PARM @VAL05    PVALK5 20                                           CSD029
     C                     PARM           PVAL5 200                                           CSD029
     C                     PARM @VAL06    PVALK6 20                                           CSD029
     C                     PARM           PVAL6 200                                           CSD029
     C                     PARM @VAL07    PVALK7 20                                           CSD029
     C                     PARM           PVAL7 200                                           CSD029
     C                     PARM @VAL08    PVALK8 20                                           CSD029
     C                     PARM           PVAL8 200                                           CSD029
     C                     PARM @VAL09    PVALK9 20                                           CSD029
     C                     PARM           PVAL9 200                                           CSD029
     C                     PARM @VAL10    PVALK0 20                                           CSD029
     C                     PARM           PVAL10200                                           CSD029
      *                                                                                       CSD029
     C           PRTCD     IFEQ *BLANKS                                                       CSD029
      *                                                                                       CSD029
     C                     MOVE *OFF      *IN31                                               CSD029
     C                     MOVE *OFF      *IN32                                               CSD029
     C                     MOVE *OFF      *IN33                                               CSD029
     C                     MOVE *OFF      *IN34                                               CSD029
     C                     MOVE *OFF      *IN35                                               CSD029
     C                     MOVE *OFF      *IN36                                               CSD029
     C                     MOVE *OFF      *IN37                                               CSD029
     C                     MOVE *OFF      *IN38                                               CSD029
     C                     MOVE *OFF      *IN39                                               CSD029
     C                     MOVE *OFF      *IN40                                               CSD029
      *                                                                                       CSD029
     C                     SELEC                                                              CSD029
     C           PVAL1     WHEQ *BLANKS                                                       CSD029
     C                     MOVE *ON       *IN31                                               CSD029
     C           PVAL2     WHEQ *BLANKS                                                       CSD029
     C                     MOVE *ON       *IN32                                               CSD029
     C           PVAL3     WHEQ *BLANKS                                                       CSD029
     C                     MOVE *ON       *IN33                                               CSD029
     C           PVAL4     WHEQ *BLANKS                                                       CSD029
     C                     MOVE *ON       *IN34                                               CSD029
     C           PVAL5     WHEQ *BLANKS                                                       CSD029
     C                     MOVE *ON       *IN35                                               CSD029
     C           PVAL6     WHEQ *BLANKS                                                       CSD029
     C                     MOVE *ON       *IN36                                               CSD029
     C           PVAL7     WHEQ *BLANKS                                                       CSD029
     C                     MOVE *ON       *IN37                                               CSD029
     C           PVAL8     WHEQ *BLANKS                                                       CSD029
     C                     MOVE *ON       *IN38                                               CSD029
     C           PVAL9     WHEQ *BLANKS                                                       CSD029
     C                     MOVE *ON       *IN39                                               CSD029
     C           PVAL10    WHEQ *BLANKS                                                       CSD029
     C                     MOVE *ON       *IN40                                               CSD029
     C                     ENDSL                                                              CSD029
      *                                                                                       CSD029
     C           25        SUBSTPVAL1:1   A5FLT1                                              CSD029
     C                     MOVELE5FL01    A5FL01                                              CSD029
     C           25        SUBSTPVAL2:1   A5FLT2                                              CSD029
     C                     MOVELE5FL02    A5FL02                                              CSD029
     C           25        SUBSTPVAL3:1   A5FLT3                                              CSD029
     C                     MOVELE5FL03    A5FL03                                              CSD029
     C           25        SUBSTPVAL4:1   A5FLT4                                              CSD029
     C                     MOVELE5FL04    A5FL04                                              CSD029
     C           25        SUBSTPVAL5:1   A5FLT5                                              CSD029
     C                     MOVELE5FL05    A5FL05                                              CSD029
     C           25        SUBSTPVAL6:1   A5FLT6                                              CSD029
     C                     MOVELE5FL06    A5FL06                                              CSD029
     C           25        SUBSTPVAL7:1   A5FLT7                                              CSD029
     C                     MOVELE5FL07    A5FL07                                              CSD029
     C           25        SUBSTPVAL8:1   A5FLT8                                              CSD029
     C                     MOVELE5FL08    A5FL08                                              CSD029
     C           25        SUBSTPVAL9:1   A5FLT9                                              CSD029
     C                     MOVELE5FL09    A5FL09                                              CSD029
     C           25        SUBSTPVAL10:1  A5FLT0                                              CSD029
     C                     MOVELE5FL10    A5FL00                                              CSD029
      *                                                                                       CSD029
     C                     ENDIF                                                              CSD029
      *                                                                                       CSD029
     C                     ENDSR                                                              CSD029
      *                                                                                       CSD029
      *****************************************************************   CDL006
     O/COPY WNCPYSRC,SD0010POPG
** CPY@     : Copyright notice for inclusion in all programs
(c) Misys International Banking Systems Ltd. 2001
**   ARRAY ENTRIES FOR REPORT TITLE
MAINTENANCE - AUDIT REPORT
LISTING
** @CN Long constants used in program.
Y
A
I
N
D
***DELETED***
0
SDCUSTPD
Y2U0005
SD0010AU
BANK
SDBANKPD
CLIENT DETAILS
Y2U0004
Release                                                                   CSD007
Close                                                                     CSD007
***CLOSED***                                                              CSD007
INACTIVE                                                                  CSD025A
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**   TABM / TABD - EQUIVALENT OF MONTHS                                                       262205
JAN01FEB02MAR03APR04MAY05JUN06JUL07AUG08SEP09OCT10NOV11DEC12                                  262205
** OVRC                                                                                       CGP001
OVRDBF FILE(GPCSTXL1) TOFILE(GPCUSTXL1)                                                       CGP001
