     H        1   Y
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas SD Customer deletion checks')                    *
      *****************************************************************
      *                                                               *
      *  Midas - Standing Data Module                                 *
      *                                                               *
      *  SD0011X - Customer Deletion Pre-checks (Synon Files).        *
      *                                                               *
      *  Function:  This program checks Synon files for references    *
      *             to a customer requiring deletion.                 *
      *                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
      *                                                               *
      *  Last Amend No. MD042652           Date 06Feb17               *
      *  Prev Amend No. CER071             Date 01Aug16               *
      *                 MD037870           Date 25May16               *
      *                 CER070             Date 25Nov14               *
      *                 MD030956           Date 09Oct14               *
      *                 CSD095             Date 08Apr14               *
      *                 CLE134             Date 01Aug12               *
      *                 CER059             Date 19Jul10               *
      *                 CER045             Date 20Jul09               *
      *                 BUG23518           Date 30Mar09               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 248591             Date 27Jun07               *
      *                 246639             Date 05Jun07               *
      * Midas Plus 1.4 Base ------------------------------------------*
      *                 206427             Date 24Nov06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD079             Date 05Feb07               *
      *                 BUG12259           Date 20Oct06               *
      *                 CSD027             Date 09Dec05               *
      *                 BUG8616            Date 31May06               *
      *                 BUG10244           Date 03Feb06               *
      *                 CRN001             Date 07Nov05               *
      *                 BUG7195            Date 08Jun05               *
      *                 CSW037A            Date 02May05               *
      *                 BUG6198            Date 04Apr05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CGL029             Date 01Sep03               *
      *                 CGL013             Date 22Aug03               *
      * Midas Release 4.01 -------------------------------------------*
      *                 198304             Date 18Feb02               *
      *                 CSW024             Date 31Aug01               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 CSD008             Date 05Feb01               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 CSE023             Date 12Jul00               *
      *                 CSD007             Date 28Aug00               *
      *                 CDL008             Date 02May00               *
      * Midas DBA 3.03 -----------------------------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 126664             Date 13Nov97               *
      *                 CSD003             Date 27Oct97               *
      *                 CTI001             DATE 08AUG97               *
      *                 CSD001             DATE 21AUG96               *
      *                 CCF001             DATE 11APR95               *
      *                 S01522             Date 13OCT94
      *                 077335             DATE 12OCT94               *
      *                 S01486             DATE 05JUL94               *
      *                 S01467             DATE 05JUL94               *
      *                 063444             DATE 17FEB94               *
      *                 066562             DATE 09FEB94               *
      *                 S01459             DATE 18JAN94               *
      *                 S01449             DATE 25AUG93               *
      *                 S01437             DATE 25AUG93               *
      *                 S01413             DATE 25JUN93               *
      *                 S01421 (S01424)    DATE 22JUN93               *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  MD042652 - FFC0800 FAILED IN COB.Dont allow deletion when    *
      *             customer is in POSTNCD                            *
      *  CER071 - BAIS - Legal Form field (Recompile)                 *
      *  MD037870 - Unable to delete customer                         *
      *  CER070 - BuBa Reporting / BAIS V.1.16.0 (Recompile)          *
      *  MD030956 - Additional changes to BFM-TI enhancement          *
      *  CSD095 - Allow Deal Sub-Type and Branch for MM and FX SSIs   *
      *           (Recompile)                                         *
      *  CLE134 - Past Due Call Loan Processing (Recompile)           *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER045 - German Features - Reporting Bundesbank (Recompile)  *
      *  BUG23518 - Produce Annual Tax Deducted Statement upon        *
      *             Customer Closure                                  *
      *  248591 - Looping in component SDC541P in SD0011X.  Apply fix *
      *           246835.                                             *
      *  246835  - Unable to delete Customer. Bank specific reason    *
      *            number 1. Member SDEXSTLB empty. Annotated as      *
      *            BUG12259.                                          *
      *  246639 - A new parameter was introduced due to changes in    *
      *           SD0010U.                                            *
      *  206427 - Unable to delete a parent customer due to Last      *
      *           Change Type equals to "C". Allow deletion when Last *
      *           Change Type value of children is "D" or "C".        *
      *           Applied fix 194713                                  *
      *  CSD079 - Enhanced Customer Maintenance API                   *
      *  BUG12259 - Unable to delete a record in acceptance screen    *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  BUG8616 - SD0012P is too slow                                *
      *  BUG10244- Customer Detail Extension should only be accessed  *
      *            in input cyle.                                     *
      *  CRN001  - FRS Regulatory Reporting Interface                 *
      *  BUG7195 - SDC541P component failed                           *
      *            OPEN was issued to opened file                     *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  BUG6198- Cannot save new Details for CUSD (Recompile)        *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CGL029 - Increase Account Code to 10 digits (Recompile)      *
      *  CGL013 - MT94x Messages Generation (recompile).              *
      *  198304 - Amend so that customer deletion is not allowed if   *
      *           customer is a syndication agent of a branch.        *
      *  CSW024 - S.W.I.F.T. MT3xx Field 82/83/87. (Recompiled)       *
      *  CSD008 - Customer Service Fees Enhancement                   *
      *  CSE023 - Treaty Withholding Tax                              *
      *           - Addition of SDWTCSPD to the list of files to      *
      *             be checked.                                       *
      *  CSD007 - Customer Closing:                                   *
      *           Added Action Code parameter when calling SD0010U.   *
      *  CDL008 - Continuous Linked Settlement                        *
      *           (Recompiled over changed SDCUSTPD)                  *
      *  126664 - Addition of new fields to SDTICSPD (recompile only) *
      *  CSD003 - Synon Closedown Project (SD):                       *
      *           - Program removed from SD model.                    *
      *  CTI001 - Midas-Trade Innovation Interface:                   *
      *           - Addition of SDTICSPD to the list of files to      *
      *             be checked.                                       *
      *  CSD001 - Related Customer Numbers: check for records on      *
      *           SDCCRDPD, SDPATTPD, SDJUSRPD & SDRELCPD before      *
      *           allowing deletion of customer.                      *
      *  CCF001 - Recompiled over changed SDCUSTPD.                   *
      *  S01522 - Moved checking references to the customer in        *
      *           non-SYNON files 'program SD0010U' to immediately    *
      *           after checking the F8 files.                        *
      *  077335 - COB auto customer deletion needs to be made faster: *
      *           - Add a new input parameter to indicate whether     *
      *             the program should end as soon as a customer ref  *
      *             has been found.                                   *
      *           - Add a new input parameter to the SD0010U call.    *
      *           - If the new parameter is 'Y' then end the program  *
      *             as soon as a REJECT situation occurs.             *
      *           - Only seton LR if the new parameter is 'Y' or 'L'. *
      *           - Only check files for modules or features that     *
      *             are present in the system.                        *
      *  S01486 - Private Banking Development:                        *
      *           - Customer may not be deleted if they are defined   *
      *             as a Portfolio Management customer.               *
      *           - Customer may not be deleted if they are defined   *
      *             as a Portfolio Lending customer.                  *
      *  S01467 - Midas-Leo Interface Development:                    *
      *           - Customer may not be deleted if they are defined   *
      *             as a Leo customer.                                *
      *  063444 - Large customer deletion amendments:                 *
      *           - Change processing to display all reasons that     *
      *             a customer may not be deleted, not just the       *
      *             first reason as at present.                       *
      *           - Add new deletion checks for files SDCLLMPD.       *
      *           - Add five new input parameters to return the       *
      *             failure strings to the calling program.           *
      *           - Add two new parameters to return the failure      *
      *             strings from SD0010U.                             *
      *           - Add new data structures to break down the new     *
      *             input parameters.                                 *
      *           - Move the F8 function checks to be the first in    *
      *             the list and group the remaining checks by functn.*
      *           - Change the return codes to F8 for a customer ref  *
      *             on the F8 function files and REJECT for all other *
      *             cases. If the customer may be deleted, then the   *
      *             return code should be DELETE.                     *
      *  066562 - Field BVAPS renamed to BVAPST on SDSTRDPD.          *
      *           Regenerate and recompile program.                   *
      *  S01459 - Addition of headerbox and PSSR processing.          *
      *  S01449 - Recompile over changed SDCUSTPD.                    *
      *  S01437 - Recompile over changed SDCUSTPD.                    *
      *  S01413 - Retail 3 incorporation:- Retail Customer Group      *
      *           added to SDCUSTPD. Recompile only.                  *
      *  S01421 - BLI Development Phase 1.                            *
      *         - Includes changes for:                               *
      *           S01424 - Created to allow both the Customer         *
      *                    Details Maintenance and COB Customer       *
      *                    Deletion processing to use the same        *
      *                    pre-checks.                                *
      *                                                               *
      *****************************************************************
     FSDMMODL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0001
     F                                              KINFSR *PSSR
      * RTV : Midas SD Midas module flags retrieval
      *
     FSDACUSL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0002
     F                                              KINFSR *PSSR
      * RTV : Midas SD Additional customer details retrieval
      *
     FSDCFCDL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0003
     F                                              KINFSR *PSSR
      * RTV : Midas SD Customer fees detail retrieval
      *
     FSDCMRKL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0004
     F                                              KINFSR *PSSR
      * RTV : Midas SD Customer marketing groups retrieval
      *
     FSDFOCSL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0005
     F                                              KINFSR *PSSR
      * RTV : Midas SD Futures and Options client retrieval
      *
     FSDSECSL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0006
     F                                              KINFSR *PSSR
      * RTV : Midas SD Securities clients retrieval
      *
     FSDPLCSL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0007
     F                                              KINFSR *PSSR
      * RTV : Midas SD Portfolio management cust details ret
      *
     FSDLBCSL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0008
     F                                              KINFSR *PSSR
      * RTV : Midas SD Portfolio lending customer details retr
      *
     FSDTICSL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0009
     F                                              KINFSR *PSSR
      * RTV : Midas SD Trade innovovation customer dtl retrieval
      *
     FSDWTCSL1IF  E           K        DISK                           UC  CSE023
     F                                              KINFDS ID0021         CSE023
     F                                              KINFSR *PSSR          CSE023
      * RTV : Midas SD Withholding Tax customer details retrieval.        CSE023
      *                                                                   CSE023
     FSDBANKL2IF  E           K        DISK                           UC
     F                                              KINFDS ID0010
     F                                              KINFSR *PSSR
      * RSQ : Midas SD Bank details by customer number
      *
     FSDBRCHL5IF  E           K        DISK                           UC
     F                                              KINFDS ID0011
     F                                              KINFSR *PSSR
      * RSQ : Midas SD Branch codes by customer number
      *
     FSDBRCHL9IF  E           K        DISK                           UC                      198304
     F            SDBRCHD0                          KRENAMESDBRCH9                            198304
     F                                              KINFSR *PSSR                              198304
      * RSQ : Midas SD Branch codes by customer number                                        198304
      *                                                                                       198304
     FSDCLLML1IF  E           K        DISK                           UC
     F                                              KINFDS ID0012
     F                                              KINFSR *PSSR
      * RTV : Midas SD Customer limits retrieval
      *
     FSDCLEOL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0013
     F                                              KINFSR *PSSR
      * RTV : Midas SD Midas-Leo customer interface retrieval
      *
     FSDCUSTL4IF  E           K        DISK                           UC
     F                                              KINFDS ID0014
     F                                              KINFSR *PSSR
      * RSQ : Midas SD Customer details by parent
      *
     FSDDEALL2IF  E           K        DISK                           UC
     F                                              KINFDS ID0015
     F                                              KINFSR *PSSR
      * RSQ : Midas SD Dealing ICD data by customer number
      *
     FSDSTRDL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0016
     F                                              KINFSR *PSSR
      * RTV : Midas SD Securities trading ICD retrieval
      *
     FSDCCRDL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0017
     F                                              KINFSR *PSSR
      * RTV : Customer Credit Card Dtls Retrieval index
      *
     FSDPATTL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0018
     F                                              KINFSR *PSSR
      * RTV : Power of Attorney Details Retrieval index
      *
     FSDJUSRL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0019
     F                                              KINFSR *PSSR
      * RTV : Joint Account Holder Dtls Retrieval index
      *
     FSDRELCL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0020
     F                                              KINFSR *PSSR
      * RTV : Midas SD Related Cust Number Dtls  Retrieval index
      *                                                                                      BUG8616
     FSDEXSTLBIF  E           K        DISK                           UC                     BUG8616
     F                                              KINFSR *PSSR                             BUG8616
      * RSQ : Midas SD Extended settlements by customer                                      BUG8616
      *                                                                                      BUG8616
     FPOSTND  IF  E           K        DISK                           UC                    MD042652
     F                                              KINFSR *PSSR                            MD042652
      ** RTV:  FF Cust/broker positions                                                     MD042652
      *
      *
     F/COPY WNCPYSRC,SD0011XF01
     E* Description     : Copyright notice for inclusion in all programs
     E*
     E********************************************************************
     E                    CPY@    1   1 80               Copyright array
     I*
     I* Description     : Copyright notice for inclusion in all programs
     I*
     E                    QCMD1   1   1 80                                                   BUG8616
     E                    QCMD2   1   1 80                                                   BUG8616
     E                    QCMD3   1   1 80                                                   BUG8616
     E                    QCMD4   1   1 80                                                   BUG8616
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IA@CPY       DS
     I* Copyright array
     I                                        1  80 CPY@
     ISTRNG1      DS                            200                       063444
     I                                        1 200 WUCDS1                063444
     I                                        1   1 WUD001                063444
     I                                        2   2 WUD002                063444
     I                                        3   3 WUD003                063444
     I                                        4   4 WUD004                063444
     I                                        5   5 WUD005                063444
     I                                        6   6 WUD006                063444
     I                                        7   7 WUD007                063444
     I                                        8   8 WUD008                063444
     I                                        9   9 WUD009                063444
     I                                       10  10 WUD010                063444
     I                                       11  11 WUD011                063444
     I                                       12  12 WUD012                063444
     I                                       13  13 WUD013                063444
     I                                       14  14 WUD014                063444
     I                                       15  15 WUD015                063444
     I                                       16  16 WUD016                063444
     I                                       17  17 WUD017                063444
     I                                       18  18 WUD018                063444
     I                                       19  19 WUD019                063444
     I                                       20  20 WUD020                063444
     I                                       21  21 WUD021                063444
     I                                       22  22 WUD022                063444
     I                                       23  23 WUD023                063444
     I                                       24  24 WUD024                063444
     I                                       25  25 WUD025                063444
     I                                       26  26 WUD026                063444
     I                                       27  27 WUD027                063444
     I                                       28  28 WUD028                063444
     I                                       29  29 WUD029                063444
     I                                       30  30 WUD030                063444
     I                                       31  31 WUD031                063444
     I                                       32  32 WUD032                063444
     I                                       33  33 WUD033                063444
     I                                       34  34 WUD034                063444
     I                                       35  35 WUD035                063444
     I                                       36  36 WUD036                063444
     I                                       37  37 WUD037                063444
     I                                       38  38 WUD038                063444
     I                                       39  39 WUD039                063444
     I                                       40  40 WUD040                063444
     I                                       41  41 WUD041                063444
     I                                       42  42 WUD042                063444
     I                                       43  43 WUD043                063444
     I                                       44  44 WUD044                063444
     I                                       45  45 WUD045                063444
     I                                       46  46 WUD046                063444
     I                                       47  47 WUD047                063444
     I                                       48  48 WUD048                063444
     I                                       49  49 WUD049                063444
     I                                       50  50 WUD050                063444
     I*                                                                   063444
     ISTRNG2      DS                            200                       063444
     I                                        1 200 WUCDS2                063444
     I                                        1   1 WUD201                063444
     I                                        2   2 WUD202                063444
     I                                        3   3 WUD203                063444
     I                                        4   4 WUD204                063444
     I                                        5   5 WUD205                063444
     I                                        6   6 WUD206                063444
     I                                        7   7 WUD207                063444
     I                                        8   8 WUD208                063444
     I                                        9   9 WUD209                063444
     I                                       10  10 WUD210                063444
     I                                       11  11 WUD211                063444
     I                                       12  12 WUD212                063444
     I                                       13  13 WUD213                063444
     I                                       14  14 WUD214                063444
     I                                       15  15 WUD215                063444
     I                                       16  16 WUD216                063444
     I                                       17  17 WUD217                063444
     I                                       18  18 WUD218                063444
     I                                       19  19 WUD219                063444
     I                                       20  20 WUD220                063444
     I                                       21  21 WUD221                063444
     I                                       22  22 WUD222                063444
     I                                       23  23 WUD223                063444
     I                                       24  24 WUD224                063444
     I                                       25  25 WUD225                063444
     I                                       26  26 WUD226                063444
     I                                       27  27 WUD227                063444
     I                                       28  28 WUD228                063444
     I                                       29  29 WUD229                063444
     I                                       30  30 WUD230                063444
     I                                       31  31 WUD231                063444
     I                                       32  32 WUD232                063444
     I                                       33  33 WUD233                063444
     I                                       34  34 WUD234                063444
     I                                       35  35 WUD235                063444
     I                                       36  36 WUD236                063444
     I                                       37  37 WUD237                063444
     I                                       38  38 WUD238                063444
     I                                       39  39 WUD239                063444
     I                                       30  40 WUD240                063444
     I                                       41  41 WUD241                063444
     I                                       42  42 WUD242                063444
     I                                       43  43 WUD243                063444
     I                                       44  44 WUD244                063444
     I                                       45  45 WUD245                063444
     I                                       46  46 WUD246                063444
     I                                       47  47 WUD247                063444
     I                                       48  48 WUD248                063444
     I                                       49  49 WUD249                063444
     I                                       50  50 WUD250                063444
     I*                                                                   063444
     ISTRNG3      DS                            200                       063444
     I                                        1 200 WUCDS3                063444
     I                                        1   1 WUD401                063444
     I                                        2   2 WUD402                063444
     I                                        3   3 WUD403                063444
     I                                        4   4 WUD404                063444
     I                                        5   5 WUD405                063444
     I                                        6   6 WUD406                063444
     I                                        7   7 WUD407                063444
     I                                        8   8 WUD408                063444
     I                                        9   9 WUD409                063444
     I                                       10  10 WUD410                063444
     I/COPY WNCPYSRC,SD0011XI01
     I*                                                                   063444
     ISTRNG4      DS                            200                       063444
     I                                        1 200 WUCDS4                063444
     I                                        1   1 WUD601                063444
     I                                        2   2 WUD602                063444
     I                                        3   3 WUD603                063444
     I                                        4   4 WUD604                063444
     I                                        5   5 WUD605                063444
     I                                        6   6 WUD606                063444
     I                                        7   7 WUD607                063444
     I                                        8   8 WUD608                063444
     I                                        9   9 WUD609                063444
     I                                       10  10 WUD610                063444
     I*                                                                   063444
     ISTRNG5      DS                            200                       063444
     I                                        1 200 WUCDS5                063444
     I                                        1   1 WUD801                063444
     I                                        2   2 WUD802                063444
     I                                        3   3 WUD803                063444
     I                                        4   4 WUD804                063444
     I                                        5   5 WUD805                063444
     I                                        6   6 WUD806                063444
     I                                        7   7 WUD807                063444
     I                                        8   8 WUD808                063444
     I                                        9   9 WUD809                063444
     I                                       10  10 WUD810                063444
     I*                                                                   063444
      * Outward parameters
     IPARC        DS                           1338
      * RCD : Midas SD Extended settlements retrieval
      * O : MAP Customer Number
     I                                        4   9 PACUST
      * O : MAP Receipt - Our Nostro
     I**********                             54  65 PARONO                                    CGL029
     I                                       54  65 QQRONO                                    CGL029
      * O : MAP Rcpt - Ordering Bank No.
     I                                       66  71 PAROBN
      * O : MAP Rcpt - Ordering Customer
     I                                       72  77 PAROCS
      * O : MAP Rcpt - Intermed Bank No.
     I                                       78  85 PARIBN
      * O : MAP Pay - Our Nostro
     I**********                            123 134 PAPONO                                    CGL029
     I                                      123 134 QQPONO                                    CGL029
      * O : MAP Pay - Ordering Bank Numb.
     I                                      135 140 PAPOBN
      * O : MAP Pay - Ordering Customer
     I                                      141 146 PAPOCS
      * O : MAP Pay - Intermed Bank No.
     I                                      147 154 PAPIBN
      * O : MAP Receiver Correspondent No
     I                                      190 197 PARCNO
      * O : MAP Receiver Number
     I                                      233 240 PARCNB
      * O : MAP A/c With Bank No.
     I                                      241 248 PAACBN
      * O : MAP Beneficiary Number
     I                                      284 291 PABYNB
     I                                      292 319 PARONO                                    CGL029
     I                                      320 337 PAPONO                                    CGL029
      *
     IID0001      DS                            528
      * File information data structure
      *
     IID0002      DS                            528
      * File information data structure
      *
     IID0003      DS                            528
      * File information data structure
      *
     IID0004      DS                            528
      * File information data structure
      *
     IID0005      DS                            528
      * File information data structure
      *
     IID0006      DS                            528
      * File information data structure
      *
     IID0007      DS                            528
      * File information data structure
      *
     IID0008      DS                            528
      * File information data structure
      *
     IID0009      DS                            528
      * File information data structure
      *
     IID0010      DS                            528
      * File information data structure
      *
     IID0011      DS                            528
      * File information data structure
      *
     IID0012      DS                            528
      * File information data structure
      *
     IID0013      DS                            528
      * File information data structure
      *
     IID0014      DS                            528
      * File information data structure
      *
     IID0015      DS                            528
      * File information data structure
      *
     IID0016      DS                            528
      * File information data structure
      *
     IID0017      DS                            528
      * File information data structure
      *
     IID0018      DS                            528
      * File information data structure
      *
     IID0019      DS                            528
      * File information data structure
      *
     IID0020      DS                            528
      * File information data structure
      *
     IID0021      DS                            528                       CSE023
      * File information data structure.                                  CSE023
      *                                                                   CSE023
     I/COPY WNCPYSRC,SD0011XI02
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I :  Customer Number
     I                                        1   6 P1CUST
     IP2PARM      DS
      * B :  Customer Delete Status
     I                                        1   7 P2DELS
     IP3PARM      DS
      * B :  Customer Deln String 1
     I                                        1 200 P3CDS1
     IP4PARM      DS
      * B :  Customer Deln String 2
     I                                        1 200 P4CDS2
     IP5PARM      DS
      * B :  Customer Deln String 3
     I                                        1 200 P5CDS3
     IP6PARM      DS
      * B :  Customer Deln String 4
     I                                        1 200 P6CDS4
     IP7PARM      DS
      * B :  Customer Deln String 5
     I                                        1 200 P7CDS5
     IP8PARM      DS
      * I :  Quit program on REJECT
     I                                        1   1 P8QPGM
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Database Error (ICD)'
      * Filename
     I                                        1  10 ZA0001
      * Message data for 'Database Error (ICD)'
      * Filename
     I                                        1  10 ZA0002
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1CUST    PARM           WP0001  6        Customer Number
     C           P2DELS    PARM P2DELS    WP0002  7        Customer Delete
     C           P3CDS1    PARM P3CDS1    WP0003200        Customer Deln S
     C           P4CDS2    PARM P4CDS2    WP0004200        Customer Deln S
     C           P5CDS3    PARM P5CDS3    WP0005200        Customer Deln S
     C           P6CDS4    PARM P6CDS4    WP0006200        Customer Deln S
     C           P7CDS5    PARM P7CDS5    WP0007200        Customer Deln S
     C           P8QPGM    PARM           WP0008  1        Quit program on
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Cust Deletion Pre-checks
      * Initialisation.
      * Start of change S01459.
      * SD0011X Precompiler - Client Details  *
      * Remove Last Amend Box and Creation Parameters functions.
      * End of change S01459.
      * Copyright Statement 1993 - Standard Functions  *
      * Start of change 077335.
      * If the 'Quit' parameter is 'L' - Seton LR.
      * CASE: PAR.Quit program on REJECT is Seton LR only
     C           P8QPGM    IFEQ 'L'                        *IF
      * Check for delete - Client Details  *
     C                     CALL 'SD0010U'              90  Check for delet
     C                     PARM P1CUST    WQ0001  6        Customer Number
     C           W0RTN     PARM W0RTN     WQ0002  7        *Return code
     C           P3CDS1    PARM *BLANK    WQ0035200        Customer Deln S                    246639
     C           P4CDS2    PARM *BLANK    WQ0003200        Customer Deln S
     C           P5CDS3    PARM *BLANK    WQ0004200        Customer Deln S
     C                     PARM P8QPGM    WQ0005  1        Quit program on
     C                     PARM 'D'       WQ0033  1        Action Code                        CSD007
     C/COPY WNCPYSRC,SD0011XC10
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0010U' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * SETON LR - Standard Functions  *
     C                     SETON                     LR
     C                     GOTO AAEXIT                     *QUIT
     C                     END                             *FI
      * First call processing.
      * CASE: WRK.Called Previously is Not called previously
     C           WUCPRV    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       WUCPRV           Called Previous
      * Determine which modules are present in the system.
      * Get all Midas Modules - MIDAS Modules  *
     C                     EXSR SARVGN
      * Determine which switchable features are present in the system.
      * S01423 - Customer Service Fees.
     C                     MOVEL*BLANK    WUAPRC           Access Pgm Retu
     C                     MOVEL'S01423'  WUSARN           SAR number fiel
      * SAR switched on check - Standard Functions  *
     C                     CALL 'AOSARDR0'             90  SAR switched on
     C           WUAPRC    PARM WUAPRC    WQ0006  7        Access Pgm Retu
     C                     PARM '*VERIFY' WQ0007  7        Option for ACCO
     C           WUSARN    PARM WUSARN    WQ0008  6        SAR number fiel
     C                     PARM WUFDY     WQ0009 76        Access obj dumm
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'AOSARDR0'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Check return code.
      * CASE: WRK.Access Pgm Return Code is *Normal
     C           WUAPRC    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       WUSARW           SAR S01423
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUSARW           SAR S01423
     C                     END                             *FI
      * S01425 - Additional Customer Details.
     C                     MOVEL*BLANK    WUAPRC           Access Pgm Retu
     C                     MOVEL'S01425'  WUSARN           SAR number fiel
      * SAR switched on check - Standard Functions  *
     C                     CALL 'AOSARDR0'             90  SAR switched on
     C           WUAPRC    PARM WUAPRC    WQ0010  7        Access Pgm Retu
     C                     PARM '*VERIFY' WQ0011  7        Option for ACCO
     C           WUSARN    PARM WUSARN    WQ0012  6        SAR number fiel
     C                     PARM WUFDY     WQ0013 76        Access obj dumm
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'AOSARDR0'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Check return code.
      * CASE: WRK.Access Pgm Return Code is *Normal
     C           WUAPRC    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       WUWSAR           SAR S01425
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUWSAR           SAR S01425
     C                     END                             *FI
      * S01464 - Safe Custody Fees.
     C                     MOVEL*BLANK    WUAPRC           Access Pgm Retu
     C                     MOVEL'S01464'  WUSARN           SAR number fiel
      * SAR switched on check - Standard Functions  *
     C                     CALL 'AOSARDR0'             90  SAR switched on
     C           WUAPRC    PARM WUAPRC    WQ0014  7        Access Pgm Retu
     C                     PARM '*VERIFY' WQ0015  7        Option for ACCO
     C           WUSARN    PARM WUSARN    WQ0016  6        SAR number fiel
     C                     PARM WUFDY     WQ0017 76        Access obj dumm
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'AOSARDR0'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Check return code.
      * CASE: WRK.Access Pgm Return Code is *Normal
     C           WUAPRC    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       WURTST           SAR S01464
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WURTST           SAR S01464
     C                     END                             *FI
      * S01467 - Midas-Leo Interface.
     C                     MOVEL*BLANK    WUAPRC           Access Pgm Retu
     C                     MOVEL'S01467'  WUSARN           SAR number fiel
      * SAR switched on check - Standard Functions  *
     C                     CALL 'AOSARDR0'             90  SAR switched on
     C           WUAPRC    PARM WUAPRC    WQ0018  7        Access Pgm Retu
     C                     PARM '*VERIFY' WQ0019  7        Option for ACCO
     C           WUSARN    PARM WUSARN    WQ0020  6        SAR number fiel
     C                     PARM WUFDY     WQ0021 76        Access obj dumm
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'AOSARDR0'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Check return code.
      * CASE: WRK.Access Pgm Return Code is *Normal
     C           WUAPRC    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       WUSSAR           SAR S01467
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUSSAR           SAR S01467
     C                     END                             *FI
      *                                                                   CSE023
      ** CSE023 - Treaty Withholding Tax                                  CSE023
      *                                                                   CSE023
     C                     MOVEL*BLANK    WUAPRC                          CSE023
     C                     MOVEL'CSE023'  WUSARN                          CSE023
      *                                                                   CSE023
      ** SAR switched on check - Standard Functions  *                    CSE023
      *                                                                   CSE023
     C                     CALL 'AOSARDR0'             90                 CSE023
     C           WUAPRC    PARM WUAPRC    PRTCD   7                       CSE023
     C                     PARM '*VERIFY' POPTN   7                       CSE023
     C           WUSARN    PARM WUSARN    PSARD   6                       CSE023
     C                     PARM WUFDY     PDSFD  76                       CSE023
      *                                                                   CSE023
     C           *IN90     IFEQ '1'                                       CSE023
      *                                                                   CSE023
      ** Call to program ended in error.                                  CSE023
      *                                                                   CSE023
     C                     MOVEL'Y2U0032' W0RTN                           CSE023
     C                     MOVEL*BLANKS   W0CLPG                          CSE023
     C                     MOVEL'AOSARDR0'W0CLPG                          CSE023
      *                                                                   CSE023
      ** Send message '*Error occured on CALL...'                         CSE023
      *                                                                   CSE023
     C                     MOVEL'Y2U0032' ZAMSID                          CSE023
     C                     MOVEL'Y2USRMSG'ZAMSGF                          CSE023
     C                     MOVELW0CLPG    ZAMSDA                          CSE023
     C                     EXSR ZASNMS                                    CSE023
     C                     ENDIF                                          CSE023
      *                                                                   CSE023
      ** Check return code.                                               CSE023
      *                                                                   CSE023
     C           WUAPRC    IFEQ *BLANK                                    CSE023
     C                     MOVEL'Y'       CSE023                          CSE023
     C                     ELSE                                           CSE023
     C                     MOVEL'N'       CSE023                          CSE023
     C                     ENDIF                                          CSE023
      *                                                                   CSE023
     C/COPY WNCPYSRC,SD0011XC04
      * CSD001 - Related Customer Details
     C                     MOVEL*BLANK    WUAPRC           Access Pgm Retu
     C                     MOVEL'CSD001'  WUSARN           SAR number fiel
      * SAR switched on check - Standard Functions  *
     C                     CALL 'AOSARDR0'             90  SAR switched on
     C           WUAPRC    PARM WUAPRC    WQ0022  7        Access Pgm Retu
     C                     PARM '*VERIFY' WQ0023  7        Option for ACCO
     C           WUSARN    PARM WUSARN    WQ0024  6        SAR number fiel
     C                     PARM WUFDY     WQ0025 76        Access obj dumm
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'AOSARDR0'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Check return code.
      * CASE: WRK.Access Pgm Return Code is *Normal
     C           WUAPRC    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       WUCSD1           CSD001
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUCSD1           CSD001
     C                     END                             *FI
      *                                                                                       198304
      ** Check if Syndicated Lending is installed                                             198304
      *                                                                                       198304
     C                     CALL 'AOSARDR0'             90                                     198304
     C                     PARM *BLANKS   WQ0022                                              198304
     C                     PARM '*VERIFY' WQ0023                                              198304
     C                     PARM 'CLE004'  WQ0024                                              198304
     C                     PARM WUFDY     WQ0025                                              198304
      *                                                                                       198304
      ** Call to program ended in error                                                       198304
      *                                                                                       198304
     C           *IN90     IFEQ '1'                                                           198304
     C                     MOVEL'Y2U0032' W0RTN                                               198304
     C                     MOVEL*BLANKS   W0CLPG                                              198304
     C                     MOVEL'AOSARDR0'W0CLPG                                              198304
     C                     MOVEL'Y2U0032' ZAMSID                                              198304
     C                     MOVEL'Y2USRMSG'ZAMSGF                                              198304
     C                     MOVELW0CLPG    ZAMSDA                                              198304
     C                     EXSR ZASNMS                                                        198304
     C                     ENDIF                                                              198304
      *                                                                                       198304
     C           WQ0022    IFEQ *BLANKS                                                       198304
     C                     MOVE 'Y'       CLE004  1                                           198304
     C**********           OPEN SDBRCHL9                                              198304 BUG7195
     C                     ELSE                                                               198304
     C                     MOVE 'N'       CLE004                                              198304
     C                     ENDIF                                                              198304
      *                                                                                       198304
     C                     END                             *FI
      * End of change 077335.
     C/COPY WNCPYSRC,SD0011XC01
      *                                                                   CSD008
      ** Determine if CSD008 (Customer Service Fees Enhancement) is       CSD008
      ** installed.                                                       CSD008
      *                                                                   CSD008
     C                     CALL 'AOSARDR0'             90                 CSD008
     C                     PARM *BLANK    WQ0006                          CSD008
     C                     PARM '*VERIFY' WQ0007                          CSD008
     C                     PARM 'CSD008'  WQ0008                          CSD008
     C                     PARM WUFDY     WQ0009                          CSD008
      *                                                                   CSD008
      ** Error calling access program                                     CSD008
      *                                                                   CSD008
     C           *IN90     IFEQ *ON                                       CSD008
     C                     MOVEL'Y2U0032' W0RTN                           CSD008
     C                     MOVEL*BLANKS   W0CLPG                          CSD008
     C                     MOVEL'AOSARDR0'W0CLPG                          CSD008
     C                     MOVEL'Y2U0032' ZAMSID                          CSD008
     C                     MOVEL'Y2USRMSG'ZAMSGF                          CSD008
     C                     MOVELW0CLPG    ZAMSDA                          CSD008
     C                     EXSR ZASNMS                                    CSD008
     C                     ENDIF                                          CSD008
      *                                                                   CSD008
     C           WQ0006    IFEQ *BLANK                                    CSD008
     C                     MOVEL'Y'       CSD008  1                       CSD008
     C                     ELSE                                           CSD008
     C                     MOVEL'N'       CSD008                          CSD008
     C                     ENDIF                                          CSD008
      *                                                                   CSD008
      *                                                                   CSD008
      ** CSD079 - Enhanced Customer Maint                                                     CSD079
      *                                                                                       CSD079
     C                     MOVEL*BLANK    WUAPRC                                              CSD079
     C                     MOVEL'CSD079'  WUSARN                                              CSD079
      *                                                                                       CSD079
      ** SAR switched on check - Standard Functions                                           CSD079
      *                                                                                       CSD079
     C                     CALL 'AOSARDR0'             90                                     CSD079
     C           WUAPRC    PARM WUAPRC    WQ0006                                              CSD079
     C                     PARM '*VERIFY' WQ0007                                              CSD079
     C           WUSARN    PARM WUSARN    WQ0008                                              CSD079
     C                     PARM WUFDY     WQ0009                                              CSD079
      *                                                                                       CSD079
     C           *IN90     IFEQ *ON                                                           CSD079
      *                                                                                       CSD079
      ** Call to program ended in error                                                       CSD079
      *                                                                                       CSD079
     C                     MOVEL'Y2U0032' W0RTN                                               CSD079
     C                     MOVEL*BLANKS   W0CLPG 10                                           CSD079
     C                     MOVEL'AOSARDR0'W0CLPG                                              CSD079
      *                                                                                       CSD079
      ** Send message '*Error occured on CALL...'                                             CSD079
      *                                                                                       CSD079
     C                     MOVEL'Y2U0032' ZAMSID                                              CSD079
     C                     MOVEL'Y2USRMSG'ZAMSGF                                              CSD079
     C                     MOVELW0CLPG    ZAMSDA                                              CSD079
     C                     EXSR ZASNMS                                                        CSD079
     C                     ENDIF                                                              CSD079
      *                                                                                       CSD079
      ** Check return code.                                                                   CSD079
      ** CASE: WRK.Access Pgm Return Code is *Normal                                          CSD079
      *                                                                                       CSD079
     C           WUAPRC    IFEQ *BLANK                                                        CSD079
     C                     MOVEL'Y'       CSD079  1                                           CSD079
     C                     ELSE                                                               CSD079
      *                                                                                       CSD079
      ** CASE: *OTHERWISE                                                                     CSD079
      *                                                                                       CSD079
     C                     MOVEL'N'       CSD079                                              CSD079
     C                     ENDIF                                                              CSD079
      *                                                                                       CSD079
      ** Check if CTI006 Trade Finance to BF Midas Interface is                             MD030956
      ** enabled                                                                            MD030956
      *                                                                                     MD030956
     C                     CALL 'AOSARDR0'             90                                   MD030956
     C                     PARM *BLANK    WQ0006                                            MD030956
     C                     PARM '*VERIFY' WQ0007                                            MD030956
     C                     PARM 'CTI006'  WQ0008                                            MD030956
     C                     PARM WUFDY     WQ0009                                            MD030956
      *                                                                                     MD030956
      ** Error calling access program                                                       MD030956
      *                                                                                     MD030956
     C           *IN90     IFEQ *ON                                                         MD030956
     C                     MOVEL'Y2U0032' W0RTN                                             MD030956
     C                     MOVEL*BLANKS   W0CLPG                                            MD030956
     C                     MOVEL'AOSARDR0'W0CLPG                                            MD030956
     C                     MOVEL'Y2U0032' ZAMSID                                            MD030956
     C                     MOVEL'Y2USRMSG'ZAMSGF                                            MD030956
     C                     MOVELW0CLPG    ZAMSDA                                            MD030956
     C                     EXSR ZASNMS                                                      MD030956
     C                     ENDIF                                                            MD030956
      *                                                                                     MD030956
     C           WQ0006    IFEQ *BLANK                                                      MD030956
     C                     MOVEL'Y'       CTI006  1                                         MD030956
     C                     ELSE                                                             MD030956
     C                     MOVEL'N'       CTI006                                            MD030956
     C                     ENDIF                                                            MD030956
      *                                                                                     MD030956
      * Initialise the return codes.
     C                     MOVEL'Y'       WUDELI           Cust Delete Ins
      * Start of change 063444.
      * Define deletion pre-check return strings.
      * Customer Deln Flags DS - Client Details  *
      * Initialise the input parameters to blanks.
     C                     MOVEL*BLANK    P2DELS           Customer Delete
     C                     MOVEL*BLANK    P3CDS1           Customer Deln S
     C                     MOVEL*BLANK    P4CDS2           Customer Deln S
     C                     MOVEL*BLANK    P5CDS3           Customer Deln S
     C                     MOVEL*BLANK    P6CDS4           Customer Deln S
     C                     MOVEL*BLANK    P7CDS5           Customer Deln S
      * Move deletion string parameters into work fields.
     C                     MOVELP3CDS1    WUCDS1           Customer Deln S
     C                     MOVELP4CDS2    WUCDS2           Customer Deln S
     C                     MOVELP5CDS3    WUCDS3           Customer Deln S
     C                     MOVELP6CDS4    WUCDS4           Customer Deln S
     C                     MOVELP7CDS5    WUCDS5           Customer Deln S
      * End of change 063444.
      * Start of change 063444.
      * Check the data held on the Further Customer Details screen (the F
      * processing from the Customer Details Maintenance screen. These MU
      * be checked FIRST.
      * If the Additional Customer Details feature is present.
      * CASE: WRK.SAR S01425 is Present
     C           CSD079    IFEQ 'N'                                                           CSD079
     C           WUWSAR    IFEQ 'Y'                        *IF
      * SDACUSPD - Additional Customer Details file checks.
      * Retrieve Add Cust Details - Additional Customer Dtls  *
     C                     EXSR SBRVGN
      * Check that the customer does not have additional details.
      * CASE: PGM.*Return code is Customer on Add Cust Dtls
     C           W0RTN     IFEQ 'SDACUS'                   *IF
     C                     MOVEL*BLANK    P2DELS           Customer Delete
     C                     MOVEL'F8'      P2DELS           Customer Delete
     C                     MOVEL'F'       WUD001           Customer Deln F
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF                                                              CSD079
      * If the Customer Service Fees feature is present.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : WRK.SAR S01423 is Present
      *   |- c2    : WRK.SAR S01464 is Present
      *   '-
     C           CSD079    IFEQ 'N'                                                           CSD079
     C           WUSARW    IFEQ 'Y'                        *IF
     C           WURTST    OREQ 'Y'                        *OR
      * SDCFCDPD - Customer Fees file checks.
      * Retrieve Customer Fees - Customer Fees Detail  *
     C                     EXSR SCRVGN
      * Check that the customer does not have customer fees defined.
      * CASE: PGM.*Return code is Customer on Cust Fees
     C           W0RTN     IFEQ 'SDCFCD'                   *IF
     C                     MOVEL*BLANK    P2DELS           Customer Delete
     C                     MOVEL'F8'      P2DELS           Customer Delete
     C                     MOVEL'F'       WUD004           Customer Deln F
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF                                                              CSD079
      *                                                                                       CRN001
      * Regulatory Reporting Interface checks.                                                CRN001
      *                                                                                     BUG10244
      ** If WP0008 is 'Y' program is accessed by COB                                        BUG10244
      ** If WP0008 is 'N' program is accesd by input cycle program                          BUG10244
      *                                                                                     BUG10244
     C           WP0008    IFEQ 'N'                                                         BUG10244
     C                     EXSR SVRVGN                                                        CRN001
     C                     ENDIF                                                            BUG10244
      *                                                                                       CRN001
     C           CSD079    IFEQ 'N'                                                           CSD079
      * SDCMRKPD - Customer Market Details file checks.
      * Retrieve Client Marketing - Customer Marketing Groups  *
     C                     EXSR SDRVGN
      * Check that the customer does not have marketing info defined.
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ 'Y2U0003'                  *IF
     C                     MOVEL*BLANK    P2DELS           Customer Delete
     C                     MOVEL'F8'      P2DELS           Customer Delete
     C                     MOVEL'F'       WUD005           Customer Deln F
     C                     END                             *FI
     C                     ENDIF                                                              CSD079
      * SDFOCSPD - Futures and Options Clients file checks.
      * If Futures and Options is present in the system.
     C           CSD079    IFEQ 'N'                                                           CSD079
      * CASE: WRK.Futures & Options is Yes
     C           WUFUOP    IFEQ 'Y'                        *IF
      * SDFOCSPD - Futures and Options Clients file checks.
      * Retrieve by customer - Futures & Options Clients  *
     C                     EXSR SERVGN
      * Check that the customer is not a F & O Customer.
      * CASE: PGM.*Return code is customer on FO file
     C           W0RTN     IFEQ 'FOCS'                     *IF
     C                     MOVEL*BLANK    P2DELS           Customer Delete
     C                     MOVEL'F8'      P2DELS           Customer Delete
     C                     MOVEL'F'       WUD021           Customer Deln F
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF                                                              CSD079
      * SDSECSPD - Securities Clients file checks.
      * If Securities Trading is present in the system.
     C           CSD079    IFEQ 'N'                                                           CSD079
      * CASE: WRK.Securities is Yes
     C           WUSECS    IFEQ 'Y'                        *IF
      * SDSECSPD - Securities Clients file checks.
      * Retrieve by customer - Securities Clients  *
     C                     EXSR SFRVGN
      * Check that the customer is not a securities customer.
      * CASE: PGM.*Return code is customer on ST file
     C           W0RTN     IFEQ 'SECS'                     *IF
     C                     MOVEL*BLANK    P2DELS           Customer Delete
     C                     MOVEL'F8'      P2DELS           Customer Delete
     C                     MOVEL'F'       WUD022           Customer Deln F
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF                                                              CSD079
      * End of change 063444.
      * Start of change S01486.
      * If Portfolio Management is present in the system.
     C           CSD079    IFEQ 'N'                                                           CSD079
      * CASE: WRK.Portfolio Management is Yes
     C           WUPFMG    IFEQ 'Y'                        *IF
      * SDPLCSPD - Portfolio Management Customer Details file checks.
      * Check for Non Deleted PM - Portfolio Manag Cust Dtls  *
     C                     EXSR SGRVGN
      * Check to see if the customer is a Portfolio Management customer.
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ 'Y2U0003'                  *IF
     C                     MOVEL*BLANK    P2DELS           Customer Delete
     C                     MOVEL'F8'      P2DELS           Customer Delete
     C                     MOVEL'F'       WUD034           Customer Deln F
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF                                                              CSD079
      * If Portfolio Lending is present in the system.
      * CASE: WRK.Portfolio Lending is Yes
     C           WULMCR    IFEQ 'Y'                        *IF
      * SDLBCSPD - Portfolio Lending Customer Details file checks.
      * Does Portfilio/L exist? - Portfolio Lend Cust Dtls  *
     C                     EXSR SHRVGN
      * Check to see if the customer is a Portfolio Lending customer.
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ 'Y2U0003'                  *IF
     C                     MOVEL*BLANK    P2DELS           Customer Delete
     C                     MOVEL'F8'      P2DELS           Customer Delete
     C                     MOVEL'F'       WUD035           Customer Deln F
     C                     END                             *FI
     C                     END                             *FI
      *                                                                   CSE023
      ** CASE: Treaty Withholding Tax is installed.                       CSE023
      *                                                                   CSE023
     C           CSD079    IFEQ 'N'                                                           CSD079
     C           CSE023    IFEQ 'Y'                                       CSE023
      *                                                                   CSE023
      ** SDWTCSPD - Withholding Tax Customer Details file checks.         CSE023
      *                                                                   CSE023
     C                     EXSR SURVGN                                    CSE023
      *                                                                   CSE023
      ** Check to see if the customer has tax details present.            CSE023
      ** CASE: PGM.*Return code is *Record already exists                 CSE023
      *                                                                   CSE023
     C           W0RTN     IFEQ 'Y2U0003'                                 CSE023
     C                     MOVEL*BLANK    P2DELS                          CSE023
     C                     MOVEL'F8'      P2DELS                          CSE023
     C                     MOVEL'F'       WUD042                          CSE023
     C                     ENDIF                                          CSE023
      *                                                                   CSE023
     C                     ENDIF                                          CSE023
      *                                                                   CSE023
     C                     ENDIF                                                              CSD079
      * End of change S01486.
     C/COPY WNCPYSRC,SD0011XC09
      * Start of change CTI001.
      * If the Midas Trade Innovation Interface is present in the system.
     C           CSD079    IFEQ 'N'                                                           CSD079
      * CASE: WRK.Midas-Trade Innovation If is Yes
     C           WUN3ST    IFEQ 'Y'                        *IF
     C           CTI006    OREQ 'Y'                                                         MD030956
      * SDTICSPD - TI Customer Details file checks.
      * Check for TI customer ref - Trade Innov Cust Details  *
     C                     EXSR SIRVGN
      * Check to see if the customer is a TI customer.
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ 'Y2U0003'                  *IF
     C                     MOVEL*BLANK    P2DELS           Customer Delete
     C                     MOVEL'F8'      P2DELS           Customer Delete
     C                     MOVEL'F'       WUD041           Customer Deln F
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF                                                              CSD079
      * End of change CTI001.
     C/COPY WNCPYSRC,SD0011XC02
      *                                                                   CSD008
      ** Check if fees still active when CSD008 is installed.             CSD008
      *                                                                   CSD008
     C           CSD008    IFEQ 'Y'                                       CSD008
      *                                                                   CSD008
      ** Check if all fees are not process for this customer              CSD008
      *                                                                   CSD008
     C                     CALL 'SD1911'                                  CSD008
     C                     PARM *BLANKS   PRTCD   7                       CSD008
     C                     PARM P1CUST    PCNUM   6                       CSD008
     C                     PARM *BLANKS   PPTFR   4                       CSD008
     C                     PARM *BLANKS   PFETP   2                       CSD008
      *                                                                   CSD008
      ** Fees Still active in GLFEACPD and/or GLOTSTPD                    CSD008
      *                                                                   CSD008
     C           PRTCD     IFNE *BLANK                                    CSD008
     C                     MOVEL*BLANK    W0RTN                           CSD008
     C                     MOVEL'*ACTIVE' W0RTN                           CSD008
     C                     MOVEL*BLANK    P0RTN                           CSD008
     C                     MOVEL'REJECT'  P0RTN                           CSD008
     C                     MOVEL'F8'      P2DELS    P                     CSD008
     C                     MOVEL'F'       WUD004                          CSD008
     C                     MOVELWUCDS1    P3CDS1                          CSD008
     C                     MOVELWUCDS2    P4CDS2                          CSD008
     C                     MOVELWUCDS3    P5CDS3                          CSD008
     C                     MOVELWUCDS4    P6CDS4                          CSD008
     C                     MOVELWUCDS5    P7CDS5                          CSD008
     C                     EXSR ZYEXPG                                    CSD008
     C                     ENDIF                                          CSD008
     C                     ENDIF                                          CSD008
      * Start of S01522
      * Check references in non-SYNON files by calling SD0010U.
      * Check for delete - Client Details  *
     C                     CALL 'SD0010U'              90  Check for delet
     C                     PARM P1CUST    WQ0026  6        Customer Number
     C           P2DELS    PARM P2DELS    WQ0027  7        *Return code
     C           P3CDS1    PARM *BLANK    WQ0036200        Customer Deln S                    246639
     C           WUCDS2    PARM *BLANK    WQ0028200        Customer Deln S
     C           WUCDS3    PARM *BLANK    WQ0029200        Customer Deln S
     C                     PARM P8QPGM    WQ0030  1        Quit program on
     C                     PARM 'D'       WQ0034  1        Action Code                        CSD007
     C/COPY WNCPYSRC,SD0011XC11
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0010U' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           P2DELS    IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * End of S01522
      * /COPY for Bank's own pre-check processing.
      * The /COPY should update field WUDELI with a 'N' if the customer
      * is NOT to be deleted. Otherwise WUDELI should be left as 'Y'.
      * Also fields WUD801 to WUD810 should be set to 'F'. Each field
      * will send a different message.
      * 00/Copy member SD0011XVDR - Client Details  *
     C*
     C/COPY WNCPYSRC,SD0011XVDR
     C*
      * Check to see if the Bank's own checks have been satisfied.
      * Check return code after Bank specific checks.
      * CASE: WRK.Cust Delete Instruction is Delete
     C           WUDELI    IFEQ 'Y'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Start of change 063444.
     C                     MOVEL*BLANK    P2DELS           Customer Delete
     C                     MOVEL'REJECT'  P2DELS           Customer Delete
      * If the customer specific checks are rejecting the delete request
      * but no failure position has been flagged - assume that the first
      * failure position should be set.
      * If the failure flag has not been set.
      * CASE: WRK.Customer Deln String 5 is Blanks
     C           WUCDS5    IFEQ *BLANK                     *IF
     C                     MOVEL'F'       WUD801           Customer Deln F
     C                     END                             *FI
      * End of change 063444.
     C                     END                             *FI
      * Check SYNON files.
      * SDBANKPD - Bank ICD file checks.
      * retrieve by customer - Bank Details  *
     C                     EXSR SJRVGN
      * Check that the customer is not on the Bank ICD.
      * CASE: PGM.*Return code is customer on bank
     C           W0RTN     IFEQ 'BANK'                     *IF
      * Start of change 063444.
     C                     MOVEL*BLANK    P2DELS           Customer Delete
     C                     MOVEL'REJECT'  P2DELS           Customer Delete
     C                     MOVEL'F'       WUD002           Customer Deln F
      * End of change 063444.
      * Start of change 077335
      * Quit the program if the quit parameter is 'Y'.
      * CASE: PAR.Quit program on REJECT is Quit on REJECT
     C           P8QPGM    IFEQ 'Y'                        *IF
     C                     MOVELWUCDS1    P3CDS1                                            MD037870
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * End of change 077335
     C                     END                             *FI
      * SDBRCHPD - Branch Codes file checks.
      * Retrieve by customer - Branch Codes  *
     C                     EXSR SKRVGN
      * Check that the customer is not a branch internal customer.
      * CASE: PGM.*Return code is Customer on branch codes
     C           W0RTN     IFEQ 'BRANCH'                   *IF
      * Start of change 063444.
     C                     MOVEL*BLANK    P2DELS           Customer Delete
     C                     MOVEL'REJECT'  P2DELS           Customer Delete
     C                     MOVEL'F'       WUD003           Customer Deln F
      * End of change 063444.
      * Start of change 077335
      * Quit the program if the quit parameter is 'Y'.
      * CASE: PAR.Quit program on REJECT is Quit on REJECT
     C           P8QPGM    IFEQ 'Y'                        *IF
     C                     MOVELWUCDS1    P3CDS1                                            MD037870
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * End of change 077335
     C                     END                             *FI
      *                                                                                       198304
      ** CASE: Customer is syndication agent of a branch                                      198304
      *                                                                                       198304
     C           CLE004    IFEQ 'Y'                                                           198304
      *                                                                                       198304
     C                     EXSR SRBRC2                                                        198304
     C           W0RTN     IFEQ 'BRANCH'                                                      198304
     C                     MOVEL*BLANK    P2DELS                                              198304
     C                     MOVEL'REJECT'  P2DELS                                              198304
     C                     MOVEL'F'       WUD043                                              198304
      *                                                                                       198304
      ** Quit the program if the quit parameter is 'Y'.                                       198304
      ** CASE: PAR.Quit program on REJECT is Quit on REJECT                                   198304
      *                                                                                       198304
     C           P8QPGM    IFEQ 'Y'                                                           198304
     C                     MOVELWUCDS1    P3CDS1                                            MD037870
     C                     MOVEL*BLANK    P0RTN                                               198304
     C                     EXSR ZYEXPG                                                        198304
     C                     ENDIF                                                              198304
     C                     ENDIF                                                              198304
      *                                                                                       198304
     C                     ENDIF                                                              198304
      *                                                                                       198304
      * Start of change 063444.
      * SDCLLMPD - Client Limits file check.
      * Check for Client Limit - Client Limits  *
     C                     EXSR SLRVGN
      * Check that the customer does not have a limit defined.
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ 'Y2U0003'                  *IF
     C                     MOVEL*BLANK    P2DELS           Customer Delete
     C                     MOVEL'REJECT'  P2DELS           Customer Delete
     C                     MOVEL'F'       WUD027           Customer Deln F
      * Start of change 077335
      * Quit the program if the quit parameter is 'Y'.
      * CASE: PAR.Quit program on REJECT is Quit on REJECT
     C           P8QPGM    IFEQ 'Y'                        *IF
     C                     MOVELWUCDS1    P3CDS1                                            MD037870
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * End of change 077335
     C                     END                             *FI
      * End of change 063444.
      * Start of change S01467.
      * If the Midas-Leo Interface feature is present.
      * CASE: WRK.SAR S01467 is Present
     C           WUSSAR    IFEQ 'Y'                        *IF
      * SDCLEOPD - Leo Customer Details file checks.
      * Check existence of Cust. - Customer LEO Details  *
     C                     EXSR SMRVGN
      * Check to see if the customer is a Leo customer.
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ 'Y2U0003'                  *IF
     C                     MOVEL*BLANK    P2DELS           Customer Delete
     C                     MOVEL'REJECT'  P2DELS           Customer Delete
     C                     MOVEL'F'       WUD036           Customer Deln F
      * Start of change 077335
      * Quit the program if the quit parameter is 'Y'.
      * CASE: PAR.Quit program on REJECT is Quit on REJECT
     C           P8QPGM    IFEQ 'Y'                        *IF
     C                     MOVELWUCDS1    P3CDS1                                            MD037870
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * End of change 077335
     C                     END                             *FI
     C                     END                             *FI
      * End of change S01467.
     C/COPY WNCPYSRC,SD0011XC05
      * SDCUSTPD - Client Details file checks.
      * Retrieve number of parent - Client Details  *
     C                     EXSR SNRVGN
      * Check to see if the customer is a parent.
      * CASE: PGM.*Return code is customer a parent
     C           W0RTN     IFEQ 'PARENT'                   *IF
      * Start of change 063444.
     C                     MOVEL*BLANK    P2DELS           Customer Delete
     C                     MOVEL'REJECT'  P2DELS           Customer Delete
     C                     MOVEL'F'       WUD006           Customer Deln F
      * End of change 063444.
      * Start of change 077335
      * Quit the program if the quit parameter is 'Y'.
      * CASE: PAR.Quit program on REJECT is Quit on REJECT
     C           P8QPGM    IFEQ 'Y'                        *IF
     C                     MOVELWUCDS1    P3CDS1                                            MD037870
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * End of change 077335
     C                     END                             *FI
      * SDDEALPD - Dealing ICD file checks.
      * retrieve by customer - Dealing Data  *
     C                     EXSR SORVGN
      * Check that the customer is not on the Dealing ICD.
      * CASE: PGM.*Return code is customer on dealing
     C           W0RTN     IFEQ 'DEALING'                  *IF
      * Start of change 063444.
     C                     MOVEL*BLANK    P2DELS           Customer Delete
     C                     MOVEL'REJECT'  P2DELS           Customer Delete
     C                     MOVEL'F'       WUD007           Customer Deln F
      * End of change 063444.
      * Start of change 077335
      * Quit the program if the quit parameter is 'Y'.
      * CASE: PAR.Quit program on REJECT is Quit on REJECT
     C           P8QPGM    IFEQ 'Y'                        *IF
     C                     MOVELWUCDS1    P3CDS1                                            MD037870
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * End of change 077335
     C                     END                             *FI
      ** POSTNC                                                                             MD042652
     C                     EXSR SEPOSN                                                      MD042652
     C           W0RTN     IFEQ 'USS0568'                                                   MD042652
     C                     MOVEL*BLANK    P2DELS           CUSTOMER DELETE                  MD042652
     C                     MOVEL'REJECT'  P2DELS           Customer Delete                  MD042652
     C                     MOVEL'F'       WUD045           Customer Deln F                  MD042652
      ** Quit the program if the quit parameter is 'Y'.                                     MD042652
      ** CASE: PAR.Quit program on REJECT is Quit on REJECT                                 MD042652
     C           P8QPGM    IFEQ 'Y'                        *IF                              MD042652
     C                     MOVELWUCDS1    P3CDS1                                            MD042652
     C                     MOVEL*BLANK    P0RTN            *Return code                     MD042652
     C                     EXSR ZYEXPG                                                      MD042652
     C                     END                             *FI                              MD042652
     C                     ENDIF                                                            MD042652
      * SDEXSTPD - Extended Settlements file checks.
      * Check for Customer Del. - Extended Settlements  *
     C           P1CUST    CHAINSDEXSTLB             91                                      BUG8616
     C           *IN91     IFEQ *OFF                                                         BUG8616
     C                     MOVELP1CUST    WUCUST                                             BUG8616
     C                     ENDIF                                                             BUG8616
     C**********           CLEARPARC                                                         BUG8616
     C**********           CALL 'SDC0400'              90  Check for Custo                   BUG8616
     C**********           PARM P1CUST    WQ0031  6        Customer Number                   BUG8616
     C********** W0RTN     PARM W0RTN     WQ0032  7        *Return code                      BUG8616
     C**********           PARM           PARC             RCD: Extended S                   BUG8616
      **********                                                                             BUG8616
     C********** *IN90     IFEQ '1'                                                          BUG8616
      **Call*to*program*ended*in*error**********                                             BUG8616
     C**********           MOVEL'Y2U0032' W0RTN                                              BUG8616
     C**********           MOVEL*BLANKS   W0CLPG 10                                          BUG8616
     C**********           MOVEL'SDC0400' W0CLPG                                             BUG8616
      **Send*message*'*Error*occured*on*CALL...'                                             BUG8616
     C**********           MOVEL'Y2U0032' ZAMSID                                             BUG8616
     C**********           MOVEL'Y2USRMSG'ZAMSGF                                             BUG8616
     C**********           MOVELW0CLPG    ZAMSDA           Message data                      BUG8616
     C**********           EXSR ZASNMS                                                       BUG8616
     C**********           END                                                               BUG8616
      **********                                                                             BUG8616
     C**********           MOVELPACUST    WUCUST           Customer Number                   BUG8616
     C**********           MOVELPARONO    WURONO           Receipt - Our N                   BUG8616
     C**********           MOVELPAROBN    WUROBN           Rcpt - Ordering                   BUG8616
     C**********           MOVELPAROCS    WUROCS           Rcpt - Ordering                   BUG8616
     C**********           MOVELPARIBN    WURIBN           Rcpt - Intermed                   BUG8616
     C**********           MOVELPAPONO    WUPONO           Pay - Our Nostr                   BUG8616
     C**********           MOVELPAPOBN    WUPOBN           Pay - Ordering                    BUG8616
     C**********           MOVELPAPOCS    WUPOCS           Pay - Ordering                    BUG8616
     C**********           MOVELPAPIBN    WUPIBN           Pay - Intermed                    BUG8616
     C**********           MOVELPARCNO    WURCNO           Receiver Corres                   BUG8616
     C**********           MOVELPARCNB    WURCNB           Receiver Number                   BUG8616
     C**********           MOVELPAACBN    WUACBN           A/c With Bank N                   BUG8616
     C**********           MOVELPABYNB    WUBYNB           Beneficiary Num                   BUG8616
      **********                                                                             BUG8616
      **Error*detected?*********                                                             BUG8616
     C********** W0RTN     IFNE *BLANK                                                       BUG8616
     C**********           SETON                     99    *                                 BUG8616
     C**********           END                                                               BUG8616
      * Check that the customer does not have any extended setts defined.
      * CASE: WRK.Customer Number EQ PAR.Customer Number
     C           WUCUST    IFEQ P1CUST                     *IF
      * Start of change 063444.
     C                     MOVEL*BLANK    P2DELS           Customer Delete
     C                     MOVEL'REJECT'  P2DELS           Customer Delete
     C                     MOVEL'F'       WUD008           Customer Deln F
      * End of change 063444.
      * Start of change 077335
      * Quit the program if the quit parameter is 'Y'.
      * CASE: PAR.Quit program on REJECT is Quit on REJECT
     C           P8QPGM    IFEQ 'Y'                        *IF
     C                     MOVELWUCDS1    P3CDS1                                            MD037870
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * End of change 077335
     C                     END                             *FI
      * Check that the customer is not a receipt ordering customer.
      * CASE: WRK.Rcpt - Ordering Customer EQ PAR.Customer Number
     C           WUROCS    IFEQ P1CUST                     *IF
      * Start of change 063444.
     C                     MOVEL*BLANK    P2DELS           Customer Delete
     C                     MOVEL'REJECT'  P2DELS           Customer Delete
     C                     MOVEL'F'       WUD009           Customer Deln F
      * End of change 063444.
      * Start of change 077335
      * Quit the program if the quit parameter is 'Y'.
      * CASE: PAR.Quit program on REJECT is Quit on REJECT
     C           P8QPGM    IFEQ 'Y'                        *IF
     C                     MOVELWUCDS1    P3CDS1                                            MD037870
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * End of change 077335
     C                     END                             *FI
      * Check that the customer is not a receipt ordering bank.
      * CASE: WRK.Rcpt - Ordering Bank No. EQ PAR.Customer Number
     C           WUROBN    IFEQ P1CUST                     *IF
      * Start of change 063444.
     C                     MOVEL*BLANK    P2DELS           Customer Delete
     C                     MOVEL'REJECT'  P2DELS           Customer Delete
     C                     MOVEL'F'       WUD010           Customer Deln F
      * End of change 063444.
      * Start of change 077335
      * Quit the program if the quit parameter is 'Y'.
      * CASE: PAR.Quit program on REJECT is Quit on REJECT
     C           P8QPGM    IFEQ 'Y'                        *IF
     C                     MOVELWUCDS1    P3CDS1                                            MD037870
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * End of change 077335
     C                     END                             *FI
      * Check that the customer is not a receipt intermediary bank.
      * CASE: WRK.Rcpt - Intermed Bank No. EQ PAR.Customer Number
     C           WURIBN    IFEQ P1CUST                     *IF
      * Start of change 063444.
     C                     MOVEL*BLANK    P2DELS           Customer Delete
     C                     MOVEL'REJECT'  P2DELS           Customer Delete
     C                     MOVEL'F'       WUD011           Customer Deln F
      * End of change 063444.
      * Start of change 077335
      * Quit the program if the quit parameter is 'Y'.
      * CASE: PAR.Quit program on REJECT is Quit on REJECT
     C           P8QPGM    IFEQ 'Y'                        *IF
     C                     MOVELWUCDS1    P3CDS1                                            MD037870
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * End of change 077335
     C                     END                             *FI
      * Check that the customer is not a pay ordering customer.
      * CASE: WRK.Pay - Ordering Customer EQ PAR.Customer Number
     C           WUPOCS    IFEQ P1CUST                     *IF
      * Start of change 063444.
     C                     MOVEL*BLANK    P2DELS           Customer Delete
     C                     MOVEL'REJECT'  P2DELS           Customer Delete
     C                     MOVEL'F'       WUD012           Customer Deln F
      * End of change 063444.
      * Start of change 077335
      * Quit the program if the quit parameter is 'Y'.
      * CASE: PAR.Quit program on REJECT is Quit on REJECT
     C           P8QPGM    IFEQ 'Y'                        *IF
     C                     MOVELWUCDS1    P3CDS1                                            MD037870
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * End of change 077335
     C                     END                             *FI
      * Check that the customer is not a pay ordering bank.
      * CASE: WRK.Pay - Ordering Bank Numb. EQ PAR.Customer Number
     C           WUPOBN    IFEQ P1CUST                     *IF
      * Start of change 063444.
     C                     MOVEL*BLANK    P2DELS           Customer Delete
     C                     MOVEL'REJECT'  P2DELS           Customer Delete
     C                     MOVEL'F'       WUD013           Customer Deln F
      * End of change 063444.
      * Start of change 077335
      * Quit the program if the quit parameter is 'Y'.
      * CASE: PAR.Quit program on REJECT is Quit on REJECT
     C           P8QPGM    IFEQ 'Y'                        *IF
     C                     MOVELWUCDS1    P3CDS1                                            MD037870
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * End of change 077335
     C                     END                             *FI
      * Check that the customer is not a pay intermediary bank.
      * CASE: WRK.Pay - Intermed Bank No. EQ PAR.Customer Number
     C           WUPIBN    IFEQ P1CUST                     *IF
      * Start of change 063444.
     C                     MOVEL*BLANK    P2DELS           Customer Delete
     C                     MOVEL'REJECT'  P2DELS           Customer Delete
     C                     MOVEL'F'       WUD014           Customer Deln F
      * End of change 063444.
      * Start of change 077335
      * Quit the program if the quit parameter is 'Y'.
      * CASE: PAR.Quit program on REJECT is Quit on REJECT
     C           P8QPGM    IFEQ 'Y'                        *IF
     C                     MOVELWUCDS1    P3CDS1                                            MD037870
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * End of change 077335
     C                     END                             *FI
      * Check that the customer is not a receiver correspondant.
      * CASE: WRK.Receiver Correspondent No EQ PAR.Customer Number
     C           WURCNO    IFEQ P1CUST                     *IF
      * Start of change 063444.
     C                     MOVEL*BLANK    P2DELS           Customer Delete
     C                     MOVEL'REJECT'  P2DELS           Customer Delete
     C                     MOVEL'F'       WUD015           Customer Deln F
      * End of change 063444.
      * Start of change 077335
      * Quit the program if the quit parameter is 'Y'.
      * CASE: PAR.Quit program on REJECT is Quit on REJECT
     C           P8QPGM    IFEQ 'Y'                        *IF
     C                     MOVELWUCDS1    P3CDS1                                            MD037870
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * End of change 077335
     C                     END                             *FI
      * Check that the customer is not a receiver number.
      * CASE: WRK.Receiver Number EQ PAR.Customer Number
     C           WURCNB    IFEQ P1CUST                     *IF
      * Start of change 063444.
     C                     MOVEL*BLANK    P2DELS           Customer Delete
     C                     MOVEL'REJECT'  P2DELS           Customer Delete
     C                     MOVEL'F'       WUD016           Customer Deln F
      * End of change 063444.
      * Start of change 077335
      * Quit the program if the quit parameter is 'Y'.
      * CASE: PAR.Quit program on REJECT is Quit on REJECT
     C           P8QPGM    IFEQ 'Y'                        *IF
     C                     MOVELWUCDS1    P3CDS1                                            MD037870
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * End of change 077335
     C                     END                             *FI
      * Check that the customer is not an account with bank.
      * CASE: WRK.A/c With Bank No. EQ PAR.Customer Number
     C           WUACBN    IFEQ P1CUST                     *IF
      * Start of change 063444.
     C                     MOVEL*BLANK    P2DELS           Customer Delete
     C                     MOVEL'REJECT'  P2DELS           Customer Delete
     C                     MOVEL'F'       WUD017           Customer Deln F
      * End of change 063444.
      * Start of change 077335
      * Quit the program if the quit parameter is 'Y'.
      * CASE: PAR.Quit program on REJECT is Quit on REJECT
     C           P8QPGM    IFEQ 'Y'                        *IF
     C                     MOVELWUCDS1    P3CDS1                                            MD037870
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * End of change 077335
     C                     END                             *FI
      * Check that the customer is not a beneficiary number.
      * CASE: WRK.Beneficiary Number EQ PAR.Customer Number
     C           WUBYNB    IFEQ P1CUST                     *IF
      * Start of change 063444.
     C                     MOVEL*BLANK    P2DELS           Customer Delete
     C                     MOVEL'REJECT'  P2DELS           Customer Delete
     C                     MOVEL'F'       WUD018           Customer Deln F
      * End of change 063444.
      * Start of change 077335
      * Quit the program if the quit parameter is 'Y'.
      * CASE: PAR.Quit program on REJECT is Quit on REJECT
     C           P8QPGM    IFEQ 'Y'                        *IF
     C                     MOVELWUCDS1    P3CDS1                                            MD037870
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * End of change 077335
     C                     END                             *FI
      * Check that the customer is not a nostro for receipt.
      * CASE: WRK.Receipt - Our Nostro EQ PAR.Customer Number
     C           WURONO    IFEQ P1CUST                     *IF
      * Start of change 063444.
     C                     MOVEL*BLANK    P2DELS           Customer Delete
     C                     MOVEL'REJECT'  P2DELS           Customer Delete
     C                     MOVEL'F'       WUD019           Customer Deln F
      * End of change 063444.
      * Start of change 077335
      * Quit the program if the quit parameter is 'Y'.
      * CASE: PAR.Quit program on REJECT is Quit on REJECT
     C           P8QPGM    IFEQ 'Y'                        *IF
     C                     MOVELWUCDS1    P3CDS1                                            MD037870
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * End of change 077335
     C                     END                             *FI
      * Check that the customer is not a nostro for payment.
      * CASE: WRK.Pay - Our Nostro EQ PAR.Customer Number
     C           WUPONO    IFEQ P1CUST                     *IF
      * Start of change 063444.
     C                     MOVEL*BLANK    P2DELS           Customer Delete
     C                     MOVEL'REJECT'  P2DELS           Customer Delete
     C                     MOVEL'F'       WUD020           Customer Deln F
      * End of change 063444.
      * Start of change 077335
      * Quit the program if the quit parameter is 'Y'.
      * CASE: PAR.Quit program on REJECT is Quit on REJECT
     C           P8QPGM    IFEQ 'Y'                        *IF
     C                     MOVELWUCDS1    P3CDS1                                            MD037870
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * End of change 077335
     C                     END                             *FI
      * SDSTRDPD - Securities Trading ICD file checks.
      * If Securities Trading is present in the system.
      * CASE: WRK.Securities is Yes
     C           WUSECS    IFEQ 'Y'                        *IF
      * SDSTRDPD - Securities Trading ICD file checks.
      * Retrieve depots - Securities Trading Data  *
     C                     EXSR SPRVGN
      * Check Depot 1 - Euroclear.
      * CASE: WRK.Depot 1 (EUROCLEAR) EQ PAR.Customer Number
     C           WUDR1     IFEQ P1CUST                     *IF
      * Start of change 063444.
     C                     MOVEL*BLANK    P2DELS           Customer Delete
     C                     MOVEL'REJECT'  P2DELS           Customer Delete
     C                     MOVEL'F'       WUD023           Customer Deln F
      * End of change 063444.
      * Start of change 077335
      * Quit the program if the quit parameter is 'Y'.
      * CASE: PAR.Quit program on REJECT is Quit on REJECT
     C           P8QPGM    IFEQ 'Y'                        *IF
     C                     MOVELWUCDS1    P3CDS1                                            MD037870
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * End of change 077335
     C                     END                             *FI
      * Check Depot 2 - Cedel.
      * CASE: WRK.Depot Reference 2 - Cedel EQ PAR.Customer Number
     C           WUDR2     IFEQ P1CUST                     *IF
      * Start of change 063444.
     C                     MOVEL*BLANK    P2DELS           Customer Delete
     C                     MOVEL'REJECT'  P2DELS           Customer Delete
     C                     MOVEL'F'       WUD024           Customer Deln F
      * End of change 063444.
      * Start of change 077335
      * Quit the program if the quit parameter is 'Y'.
      * CASE: PAR.Quit program on REJECT is Quit on REJECT
     C           P8QPGM    IFEQ 'Y'                        *IF
     C                     MOVELWUCDS1    P3CDS1                                            MD037870
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * End of change 077335
     C                     END                             *FI
      * Check Depot 3 - Kasserverein.
      * CASE: WRK.Depot Ref 3, Kassenverein EQ PAR.Customer Number
     C           WUDR3     IFEQ P1CUST                     *IF
      * Start of change 063444.
     C                     MOVEL*BLANK    P2DELS           Customer Delete
     C                     MOVEL'REJECT'  P2DELS           Customer Delete
     C                     MOVEL'F'       WUD025           Customer Deln F
      * End of change 063444.
      * Start of change 077335
      * Quit the program if the quit parameter is 'Y'.
      * CASE: PAR.Quit program on REJECT is Quit on REJECT
     C           P8QPGM    IFEQ 'Y'                        *IF
     C                     MOVELWUCDS1    P3CDS1                                            MD037870
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * End of change 077335
     C                     END                             *FI
      * Check Depot 4.
      * CASE: WRK.Depot Reference 4 Custome EQ PAR.Customer Number
     C           WUDR4     IFEQ P1CUST                     *IF
      * Start of change 063444.
     C                     MOVEL*BLANK    P2DELS           Customer Delete
     C                     MOVEL'REJECT'  P2DELS           Customer Delete
     C                     MOVEL'F'       WUD026           Customer Deln F
      * End of change 063444.
      * Start of change 077335
      * Quit the program if the quit parameter is 'Y'.
      * CASE: PAR.Quit program on REJECT is Quit on REJECT
     C           P8QPGM    IFEQ 'Y'                        *IF
     C                     MOVELWUCDS1    P3CDS1                                            MD037870
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * End of change 077335
     C                     END                             *FI
      * Check Depot 5.
      * CASE: WRK.Depot Reference 5 Custome EQ PAR.Customer Number
     C           WUDR5     IFEQ P1CUST                     *IF
      * Start of change 063444.
     C                     MOVEL*BLANK    P2DELS           Customer Delete
     C                     MOVEL'REJECT'  P2DELS           Customer Delete
     C                     MOVEL'F'       WUD028           Customer Deln F
      * End of change 063444.
      * Start of change 077335
      * Quit the program if the quit parameter is 'Y'.
      * CASE: PAR.Quit program on REJECT is Quit on REJECT
     C           P8QPGM    IFEQ 'Y'                        *IF
     C                     MOVELWUCDS1    P3CDS1                                            MD037870
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * End of change 077335
     C                     END                             *FI
      * Check Depot 6.
      * CASE: WRK.Depot Reference 6 Custome EQ PAR.Customer Number
     C           WUDR6     IFEQ P1CUST                     *IF
      * Start of change 063444.
     C                     MOVEL*BLANK    P2DELS           Customer Delete
     C                     MOVEL'REJECT'  P2DELS           Customer Delete
     C                     MOVEL'F'       WUD029           Customer Deln F
      * End of change 063444.
      * Start of change 077335
      * Quit the program if the quit parameter is 'Y'.
      * CASE: PAR.Quit program on REJECT is Quit on REJECT
     C           P8QPGM    IFEQ 'Y'                        *IF
     C                     MOVELWUCDS1    P3CDS1                                            MD037870
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * End of change 077335
     C                     END                             *FI
      * Check Depot 7.
      * CASE: WRK.Depot Reference 7 Custome EQ PAR.Customer Number
     C           WUDR7     IFEQ P1CUST                     *IF
      * Start of change 063444.
     C                     MOVEL*BLANK    P2DELS           Customer Delete
     C                     MOVEL'REJECT'  P2DELS           Customer Delete
     C                     MOVEL'F'       WUD030           Customer Deln F
      * End of change 063444.
      * Start of change 077335
      * Quit the program if the quit parameter is 'Y'.
      * CASE: PAR.Quit program on REJECT is Quit on REJECT
     C           P8QPGM    IFEQ 'Y'                        *IF
     C                     MOVELWUCDS1    P3CDS1                                            MD037870
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * End of change 077335
     C                     END                             *FI
      * Check Depot 8.
      * CASE: WRK.Depot Reference 8 Custome EQ PAR.Customer Number
     C           WUDR8     IFEQ P1CUST                     *IF
      * Start of change 063444.
     C                     MOVEL*BLANK    P2DELS           Customer Delete
     C                     MOVEL'REJECT'  P2DELS           Customer Delete
     C                     MOVEL'F'       WUD031           Customer Deln F
      * End of change 063444.
      * Start of change 077335
      * Quit the program if the quit parameter is 'Y'.
      * CASE: PAR.Quit program on REJECT is Quit on REJECT
     C           P8QPGM    IFEQ 'Y'                        *IF
     C                     MOVELWUCDS1    P3CDS1                                            MD037870
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * End of change 077335
     C                     END                             *FI
      * Check Depot 9.
      * CASE: WRK.Depot Reference 9 Custome EQ PAR.Customer Number
     C           WUDR9     IFEQ P1CUST                     *IF
      * Start of change 063444.
     C                     MOVEL*BLANK    P2DELS           Customer Delete
     C                     MOVEL'REJECT'  P2DELS           Customer Delete
     C                     MOVEL'F'       WUD032           Customer Deln F
      * End of change 063444.
      * Start of change 077335
      * Quit the program if the quit parameter is 'Y'.
      * CASE: PAR.Quit program on REJECT is Quit on REJECT
     C           P8QPGM    IFEQ 'Y'                        *IF
     C                     MOVELWUCDS1    P3CDS1                                            MD037870
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * End of change 077335
     C                     END                             *FI
      * Check Depot 10.
      * CASE: WRK.Depot Reference 10 Custom EQ PAR.Customer Number
     C           WUDR10    IFEQ P1CUST                     *IF
      * Start of change 063444.
     C                     MOVEL*BLANK    P2DELS           Customer Delete
     C                     MOVEL'REJECT'  P2DELS           Customer Delete
     C                     MOVEL'F'       WUD033           Customer Deln F
      * End of change 063444.
      * Start of change 077335
      * Quit the program if the quit parameter is 'Y'.
      * CASE: PAR.Quit program on REJECT is Quit on REJECT
     C           P8QPGM    IFEQ 'Y'                        *IF
     C                     MOVELWUCDS1    P3CDS1                                            MD037870
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * End of change 077335
     C                     END                             *FI
     C                     END                             *FI
      * Start CSD001
      * If Related Customer Details feature is switched on
      * CASE: WRK.CSD001 is Present
     C           WUCSD1    IFEQ 'Y'                        *IF
      * SDCCRDPD
      * Find Cust Crdt Card Dtls - Customer Credit Card Dtls  *
     C                     EXSR SQRVGN
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ 'Y2U0003'                  *IF
     C                     MOVEL'F'       WUD037           Customer Deln F
     C                     END                             *FI
      * SDPATTPD
      * Find Power of Attny Dtls - Power of Attorney Details  *
     C                     EXSR SRRVGN
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ 'Y2U0003'                  *IF
     C                     MOVEL'F'       WUD038           Customer Deln F
     C                     END                             *FI
      * SDJUSRPD
      * Find Joint A/c Holder Dtl - Joint Account Holder Dtls  *
     C                     EXSR SSRVGN
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ 'Y2U0003'                  *IF
     C                     MOVEL'F'       WUD039           Customer Deln F
     C                     END                             *FI
      * SDRELCPD
      * Find Related Cust Numb - Related Cust Number Dtls  *
     C                     EXSR STRVGN
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ 'Y2U0003'                  *IF
     C                     MOVEL'F'       WUD040           Customer Deln F
     C                     END                             *FI
     C                     END                             *FI
      * End CSD001
     C/COPY WNCPYSRC,SD0011XC03
      * 063444 - Remove check to see if the SYNON file checks
      *          have been satisfied.
      * Start of change S01522.
      * Move checking references in non-SYNON files by calling SD0010U
      * to immediately after checking the F8 files.
      * End of change S01522.
      * Start of change 063444.
      * Remove check to see if the non-SYNON file checks
      * have been satisfied.
      * Move all F8 function processing to the beginning
      * of the pre-deletion checks.
      * Move deletion string parameters back into parameter fields.
     C                     MOVELWUCDS1    P3CDS1           Customer Deln S
     C                     MOVELWUCDS2    P4CDS2           Customer Deln S
     C                     MOVELWUCDS3    P5CDS3           Customer Deln S
     C                     MOVELWUCDS4    P6CDS4           Customer Deln S
     C                     MOVELWUCDS5    P7CDS5           Customer Deln S
      * End of change 063444.
      * Start of change 077335.
      * SETON LR if this is interactive processing.
      * CASE: PAR.Quit program on REJECT is Do not quit on REJECT
     C           P8QPGM    IFEQ 'N'                        *IF
      * SETON LR - Standard Functions  *
     C                     SETON                     LR
     C                     END                             *FI
      * End of change 077335.
     C                     GOTO AAEXIT                     *QUIT
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Get all Midas Modules - MIDAS Modules  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           BGMODS           Modules
      * Move fields to key list
     C                     MOVE *BLANK    BGMODS           Modules
     C                     MOVEL'MMOD'    BGMODS           Modules
     C           KRSSA     CHAIN@BGREC8              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0096' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * Setup message data for message
     C                     MOVEL'SDMMODPD'ZA0001           Filename
      * Send message 'Database Error (ICD)'
     C                     MOVEL'USR0377' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO SAEXIT                     *QUIT
     C                     GOTO SAEXIT
     C                     END
      *
      * USER: Exit processing
      * PAR = DB1 By name
     C                     MOVELBGMTMI    WUMTMI           Midas/Telex Mod
     C                     MOVELBGSWFT    WUSWFT           SWIFT Funds Tra
     C                     MOVELBGSWST    WUSWST           SWIFT Securitie
     C                     MOVELBGSWCL    WUSWCL           SWIFT Customer
     C                     MOVELBGSWSL    WUSWSL           SWIFT Synd Loan
     C                     MOVELBGSWSM    WUSWSM           SWIFT Statement
     C                     MOVELBGSWDL    WUSWDL           SWIFT Dealing
     C                     MOVELBGSDGL    WUSDGL           Standing data/G
     C                     MOVELBGDLFX    WUDLFX           Dealing: FX
     C                     MOVELBGSYLN    WUSYLN           Syndicated Loan
     C                     MOVELBGEXMG    WUEXMG           Exposure Manage
     C                     MOVELBGFNMO    WUFNMO           Financial Model
     C                     MOVELBGSTRT    WUSTRT           Statutory Retur
     C                     MOVELBGCSLN    WUCSLN           Customer Lendin
     C                     MOVELBGRTBN    WURTBN           Retail Banking
     C                     MOVELBGMSDL    WUMSDL           Midas/Swift dir
     C                     MOVELBGSECS    WUSECS           Securities
     C                     MOVELBGAURC    WUAURC           Auto-reconcilia
     C                     MOVELBGBDLI    WUBDLI           Bond Dealers In
     C                     MOVELBGDRSD    WUDRSD           DRS Standing Da
     C                     MOVELBGDRCM    WUDRCM           DRS Control mod
     C                     MOVELBGDRFE    WUDRFE           DRS Foreign Exc
     C                     MOVELBGDRMM    WUDRMM           DRS Money Marke
     C                     MOVELBGDRAR    WUDRAR           DRS Arbitrage
     C                     MOVELBGFDTR    WUFDTR           Funds Transfer
     C                     MOVELBGDRCA    WUDRCA           DRS Common Appl
     C                     MOVELBGFUOP    WUFUOP           Futures & Optio
     C                     MOVELBGMTSL    WUMTSL           Midas/Telex Syn
     C                     MOVELBGMTDL    WUMTDL           Midas/Telex Dea
     C                     MOVELBGMTGL    WUMTGL           Midas/Telex Gen
     C                     MOVELBGMTCL    WUMTCL           Midas/Telex Cus
     C                     MOVELBGNWMI    WUNWMI           Message Managem
     C                     MOVELBGFIIN    WUFIIN           FRA/IRS Indicat
     C                     MOVELBGDLMM    WUDLMM           Dealing: MM
     C                     MOVELBGINCN    WUINCN           Internal Contra
     C                     MOVELBGTRMG    WUTRMG           Treasury Manage
     C                     MOVELBGRKMG    WURKMG           Interest Risk M
     C                     MOVELBGTSKY    WUTSKY           Testkey
     C                     MOVELBGMIDQ    WUMIDQ           Midas/Q
     C                     MOVELBGMFIC    WUMFIC           Microfiche
     C                     MOVELBGIOAC    WUIOAC           Interest on acc
     C                     MOVELBGWDPR    WUWDPR           Window processi
     C                     MOVELBGSARP    WUSARP           SAR's processin
     C                     MOVELBGFRIN    WUFRIN           French return i
     C                     MOVELBGLRIN    WULRIN           Lux return indi
     C                     MOVELBGDRIN    WUDRIN           Dutch return in
     C                     MOVELBGGRIN    WUGRIN           German return i
     C                     MOVELBGBRIN    WUBRIN           Belgian return
     C                     MOVELBGIRIN    WUIRIN           Italian return
     C                     MOVELBGSWEI    WUSWEI           Swift External
     C                     MOVELBGPFMG    WUPFMG           Portfolio Manag
     C                     MOVELBGCRMG    WUCRMG           Credit Manageme
     C                     MOVELBGHORP    WUHORP           Head Office Rep
     C                     MOVELBGAVBL    WUAVBL           Average Balance
     C                     MOVELBGMARG    WUMARG           Margins
     C                     MOVELBGCFMT    WUCFMT           Confirmation Ma
     C                     MOVELBGMIMX    WUMIMX           Mimix
     C                     MOVELBGRCFI    WURCFI           Report Control
     C                     MOVELBGAMIN    WUAMIN           Amps Int
     C                     MOVELBGSWRT    WUSWRT           Swiss Returns
     C                     MOVELBGFLND    WUFLND           Fiduciary Loans
     C                     MOVELBGLMCR    WULMCR           Portfolio Lendi
     C                     MOVELBGCNTX    WUCNTX           Cantonal Tax
     C                     MOVELBGSTDU    WUSTDU           Stamp Duty
     C                     MOVELBGUDRS    WUUDRS           Use DRS Shortna
     C                     MOVELBGCHDL    WUCHDL           Chips Dealing
     C                     MOVELBGCHLN    WUCHLN           Chips Lending
     C                     MOVELBGCHOB    WUCHOB           Chips Opening B
     C                     MOVELBGCHIP    WUCHIP           CHIPS
     C                     MOVELBGCHDI    WUCHDI           Chips Direct Li
     C                     MOVELBGOPDK    WUOPDK           Optical Disk
     C                     MOVELBGMBIN    WUMBIN           Multi-branching
     C                     MOVELBGNNST    WUNNST           Leo Data Nucleu
     C                     MOVELBGNOST    WUNOST           Leo Letters of
     C                     MOVELBGNPST    WUNPST           Leo Collections
     C                     MOVELBGNQST    WUNQST           Leo Bills/Finan
     C                     MOVELBGNRST    WUNRST           Leo Bankers Acc
     C                     MOVELBGNSST    WUNSST           Leo Reimburseme
     C                     MOVELBGNTST    WUNTST           Taxes
     C                     MOVELBGNUST    WUNUST           History & Audit
     C                     MOVELBGNVST    WUNVST           Management Acco
     C                     MOVELBGNWST    WUNWST           IBLC Returns
     C                     MOVELBGNXST    WUNXST           Retail 3
     C                     MOVELBGNYST    WUNYST           Interest on Acc
     C                     MOVELBGNZST    WUNZST           Midas Export Da
     C                     MOVELBGN0ST    WUN0ST           Analytical Acco
     C                     MOVELBGN1ST    WUN1ST           User Defined Co
     C                     MOVELBGN2ST    WUN2ST           Midas-Plato Int
     C                     MOVELBGN3ST    WUN3ST           Midas-Trade Inn
     C                     MOVELBGN4ST    WUN4ST           Reserved for La
     C                     MOVELBGN5ST    WUN5ST           Reserved for La
     C                     MOVELBGN6ST    WUN6ST           Reserved for La
     C                     MOVELBGN7ST    WUN7ST           Reserved for La
     C                     MOVELBGN8ST    WUN8ST           Reserved for La
     C                     MOVELBGN9ST    WUN9ST           Reserved for La
     C                     MOVELBGOAST    WUOAST           Reserved for La
     C                     MOVELBGOBST    WUOBST           Reserved for La
     C                     MOVELBGOCST    WUOCST           Reserved for La
     C                     MOVELBGODST    WUODST           Reserved for La
     C                     MOVELBGOEST    WUOEST           Reserved for La
     C                     MOVELBGOFST    WUOFST           Reserved for La
     C                     MOVELBGOGST    WUOGST           Reserved for La
     C                     MOVELBGOHST    WUOHST           Reserved for La
     C                     MOVELBGOIST    WUOIST           Reserved for La
     C                     MOVELBGOJST    WUOJST           Reserved for La
     C                     MOVELBGOKST    WUOKST           Reserved for La
     C                     MOVELBGOLST    WUOLST           Reserved for La
     C                     MOVELBGOMST    WUOMST           Reserved for La
     C                     MOVELBGONST    WUONST           Reserved for La
     C                     MOVELBGOOST    WUOOST           Reserved for La
     C                     MOVELBGOPST    WUOPST           Reserved for La
     C                     MOVELBGOQST    WUOQST           Reserved for La
     C                     MOVELBGORST    WUORST           Reserved for La
     C                     MOVELBGOSST    WUOSST           Reserved for La
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Retrieve Add Cust Details - Additional Customer Dtls  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           E5CUST           Customer Number
      * Move fields to key list
     C                     MOVELP1CUST    E5CUST           Customer Number
     C           KRSSB     CHAIN@ACUSL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1914' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           E5TYLC    IFNE 'C'                                                         BUG23518
     C           E5TYLC    ANDNE'D'                                                         BUG23518
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'SDACUS'  W0RTN            *Return code
     C                     ENDIF                                                            BUG23518
      *                                                                                     BUG23518
     C                     END
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Retrieve Customer Fees - Customer Fees Detail  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           E6CUST           Customer Number
      * Move fields to key list
     C                     MOVELP1CUST    E6CUST           Customer Number
     C           KRSSC     CHAIN@CFCDL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1918' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'SDCFCD'  W0RTN            *Return code
     C                     END
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Retrieve Client Marketing - Customer Marketing Groups  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           D7CUST           Customer Number
      * Move fields to key list
     C                     MOVELP1CUST    D7CUST           Customer Number
     C           KRSSD     CHAIN@D7REJB              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1478' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     END
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT                                                                                  CRN001
     C           SVRVGN    BEGSR                                                              CRN001
      *================================================================                       CRN001
      * Check for presence of Regulatory Reporting details.           *                       CRN001
      *================================================================                       CRN001
      *                                                                                       CRN001
     C                     CALL 'AOSARDR0'                                                    CRN001
     C                     PARM           PRTCD                                               CRN001
     C                     PARM '*VERIFY' POPTN                                               CRN001
     C                     PARM 'CRN001'  PSARD                                               CRN001
      *                                                                                       CRN001
     C                     SELEC                                                              CRN001
     C           PRTCD     WHEQ *BLANK                                                        CRN001
     C                     MOVE 'Y'       CRN001  1                                           CRN001
     C           PRTCD     WHEQ '*NRF'                                                        CRN001
     C                     MOVEL'N'       CRN001                                              CRN001
     C                     OTHER                                                              CRN001
     C                     EXSR *PSSR                                                         CRN001
     C                     ENDSL                                                              CRN001
      *                                                                                       CRN001
     C           CRN001    IFEQ 'Y'                                                           CRN001
     C                     CALL 'SD000040'                                                    CRN001
     C                     PARM *BLANKS   RTNMSG  7                                           CRN001
     C                     PARM P1CUST    PCUST   6                                           CRN001
     C                     PARM 'V'       ACTION  1                                           CRN001
      *                                                                                       CRN001
     C           RTNMSG    IFEQ 'USR4050'                                                     CRN001
     C                     MOVEL*BLANK    P2DELS                                              CRN001
     C                     MOVEL'F8'      P2DELS                                              CRN001
     C                     MOVEL'F'       WUD044                                              CRN001
     C                     ENDIF                                                              CRN001
     C                     ENDIF                                                              CRN001
      *                                                                                       CRN001
     C                     ENDSR                                                              CRN001
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Retrieve by customer - Futures & Options Clients  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           BHCUST           Customer Number
      * Move fields to key list
     C                     MOVELP1CUST    BHCUST           Customer Number
     C           KRSSE     CHAIN@BHRED1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0174' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SEEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'FOCS'    W0RTN            *Return code
     C                     END
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT                                                                                MD042652
     CSR         SEPOSN    BEGSR                                                            MD042652
      *================================================================                     MD042652
      ** Retrieve by customer - FF Cust/broker positions  *                                 MD042652
      *================================================================                     MD042652
     C                     MOVEL*BLANK    W0RTN   7                                         MD042652
     C           P1CUST    CHAINPOSTNCDF             90    *                                MD042652
     C           *IN90     IFEQ '0'                                                         MD042652
      ** Data record found                                                                  MD042652
     C                     MOVEL'USS0568' W0RTN   7                                         MD042652
     C                     ENDIF                                                            MD042652
      *================================================================                     MD042652
     CSR         SVEXIT    ENDSR                                                            MD042652
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Retrieve by customer - Securities Clients  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           BFCUST           Customer Number
      * Move fields to key list
     C                     MOVELP1CUST    BFCUST           Customer Number
     C           KRSSF     CHAIN@BFREDQ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0094' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SFEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'SECS'    W0RTN            *Return code
     C                     END
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Check for Non Deleted PM - Portfolio Manag Cust Dtls  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           QBCUST           Customer Number
      * Move fields to key list
     C                     MOVELP1CUST    QBCUST           Customer Number
     C           KRSSG     CHAIN@PLCSL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2322' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Check whether it is a live record.
      * CASE: DB1.Type of Last Change is Delete
     C           QBTYLC    IFEQ 'D'                        *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Does Portfilio/L exist? - Portfolio Lend Cust Dtls  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           CUCUST           Customer Number
      * Move fields to key list
     C                     MOVELP1CUST    CUCUST           Customer Number
     C           KRSSH     CHAIN@LBCSL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2320' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SHEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     END
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     C           SURVGN    BEGSR                                          CSE023
      *                                                                   CSE023
      ** Does withholding tax details exist for customer?                 CSE023
      *                                                                   CSE023
     C                     MOVEL*BLANK    W0RTN                           CSE023
      *                                                                   CSE023
      ** Define keylist                                                   CSE023
      *                                                                   CSE023
     C           KWTAX     KLIST                                          CSE023
     C                     KFLD           WTCUST  6                       CSE023
      *                                                                   CSE023
      ** Move fields to key list                                          CSE023
      *                                                                   CSE023
     C                     MOVELP1CUST    WTCUST                          CSE023
     C           KWTAX     CHAINSDWTCSL1             90                   CSE023
      *                                                                   CSE023
     C           *IN90     IFEQ '1'                                       CSE023
      *                                                                   CSE023
      ** Reference record not found.                                      CSE023
      *                                                                   CSE023
     C                     MOVEL'USR8915' W0RTN                           CSE023
      *                                                                   CSE023
      ** Processing if Data record not found.                             CSE023
      *                                                                   CSE023
     C                     MOVEL'Y2U0005' W0RTN                           CSE023
     C                     GOTO SUEXIT                                    CSE023
     C                     ENDIF                                          CSE023
      *                                                                   CSE023
     C           *IN90     IFEQ '0'                                       CSE023
      *                                                                   CSE023
      ** Reference record existing.                                       CSE023
      *                                                                   CSE023
     C                     MOVEL'Y2U0003' W0RTN                           CSE023
     C                     ENDIF                                          CSE023
      *                                                                   CSE023
     C           SUEXIT    ENDSR                                          CSE023
      /EJECT                                                              CSE023
     CSR         SIRVGN    BEGSR
      *================================================================
      * Check for TI customer ref - Trade Innov Cust Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           TCCUST           Customer Number
      * Move fields to key list
     C                     MOVELP1CUST    TCCUST           Customer Number
     C           KRSSI     CHAIN@TICSL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3506' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SIEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     END
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * retrieve by customer - Bank Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BJCUST    WQSJ01           Customer Number
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Customer Number
      * Move fields to key list
     C                     MOVELP1CUST    WQSJ01           Customer Number
     C           KRSSJ     SETLL@BANKFO                    *
     C           KRSSJ     READE@BANKFO                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0197' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SJEXIT
     C                     END
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'BANK'    W0RTN            *Return code
     C           KRSSJ     READE@BANKFO                  90*
     C                     END
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Retrieve by customer - Branch Codes  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN A8BICN    WQSK01           Branch Internal
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           Branch Internal
      * Move fields to key list
     C                     MOVELP1CUST    WQSK01           Branch Internal
     C           KRSSK     SETLL@BRCHFM                    *
     C           KRSSK     READE@BRCHFM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0075' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SKEXIT
     C                     END
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'BRANCH'  W0RTN            *Return code
     C           KRSSK     READE@BRCHFM                  90*
     C                     END
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT                                                                                  198304
      *****************************************************************                       198304
      *                                                               *                       198304
      *  Validation if customer is used as a syndication agent.       *                       198304
      *                                                               *                       198304
      *****************************************************************                       198304
     C           SRBRC2    BEGSR                                                              198304
      *                                                                                       198304
     C           *LIKE     DEFN A8SYCU    KSYCU                                               198304
     C                     MOVEL*BLANK    W0RTN                                               198304
      *                                                                                       198304
     C                     MOVELP1CUST    KSYCU                                               198304
     C           KSYCU     SETLLSDBRCHL9                 90                                   198304
      *                                                                                       198304
      ** If on, customer is used as a syndication agent                                       198304
      *                                                                                       198304
     C           *IN90     IFEQ '1'                                                           198304
     C                     MOVEL'BRANCH'  W0RTN                                               198304
     C                     ENDIF                                                              198304
      *                                                                                       198304
     C                     ENDSR                                                              198304
      *****************************************************************                       198304
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Check for Client Limit - Client Limits  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DZCUST    WQSL01           Customer Number
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Customer Number
      * Move fields to key list
     C                     MOVELP1CUST    WQSL01           Customer Number
     C           KRSSL     SETLL@DZREHT                    *
     C           KRSSL     READE@DZREHT                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0665' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SLEXIT
     C                     END
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C           KRSSL     READE@DZREHT                  90*
     C                     END
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Check existence of Cust. - Customer LEO Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           FGCUST           Customer Number
      * Move fields to key list
     C                     MOVELP1CUST    FGCUST           Customer Number
     C           KRSSM     CHAIN@CLEOL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2335' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SMEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     END
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Retrieve number of parent - Client Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BBPCNB    WQSN01           Parent Customer
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Parent Customer
      * Move fields to key list
     C                     MOVELP1CUST    WQSN01           Parent Customer
     C           KRSSN     SETLL@CUSTFR                    *
     C           KRSSN     READE@CUSTFR                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0081' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SNEXIT
     C                     END
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Start of Fix E22138
      * If any of the children are still live then set the return code an
      * exit from the READE loop
      * CASE: DB1.Type of Last Change is Delete
     C           BBTYLC    IFEQ 'D'                        *IF
     C           BBTYLC    OREQ 'C'                                                           206427
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'PARENT'  W0RTN            *Return code
     C                     GOTO SNEXIT                     *QUIT
     C                     END                             *FI
      * End of Fix E22138
     C           KRSSN     READE@CUSTFR                  90*
     C                     END
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * retrieve by customer - Dealing Data  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BNCUST    WQSO01           Customer Number
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Customer Number
      * Move fields to key list
     C                     MOVELP1CUST    WQSO01           Customer Number
     C           KRSSO     SETLL@DEALFP                    *
     C           KRSSO     READE@DEALFP                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0205' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SOEXIT
     C                     END
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'DEALING' W0RTN            *Return code
     C           KRSSO     READE@DEALFP                  90*
     C                     END
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Retrieve depots - Securities Trading Data  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           BVSCTR           Securities Trad
      * Move fields to key list
     C                     MOVE *BLANK    BVSCTR           Securities Trad
     C                     MOVEL'STRD'    BVSCTR           Securities Trad
     C           KRSSP     CHAIN@BVREFF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0239' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * Setup message data for message
     C                     MOVEL'SDSTRDPD'ZA0002           Filename
      * Send message 'Database Error (ICD)'
     C                     MOVEL'USR0377' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO SPEXIT                     *QUIT
     C                     GOTO SPEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBVDR1     WUDR1            Depot 1 (EUROCL
     C                     MOVELBVDR3     WUDR3            Depot Ref 3, Ka
     C                     MOVELBVDR10    WUDR10           Depot Reference
     C                     MOVELBVDR2     WUDR2            Depot Reference
     C                     MOVELBVDR4     WUDR4            Depot Reference
     C                     MOVELBVDR5     WUDR5            Depot Reference
     C                     MOVELBVDR6     WUDR6            Depot Reference
     C                     MOVELBVDR7     WUDR7            Depot Reference
     C                     MOVELBVDR8     WUDR8            Depot Reference
     C                     MOVELBVDR9     WUDR9            Depot Reference
     C                     END
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Find Cust Crdt Card Dtls - Customer Credit Card Dtls  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN F1CUST    WQSQ01           Customer Number
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           Customer Number
      * Move fields to key list
     C                     MOVELP1CUST    WQSQ01           Customer Number
     C           KRSSQ     SETLL@CCRDL1                    *
     C           KRSSQ     READE@CCRDL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2934' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SQEXIT
     C                     END
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C           KRSSQ     READE@CCRDL1                  90*
     C                     END
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Find Power of Attny Dtls - Power of Attorney Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN F2CUST    WQSR01           Customer Number
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           Customer Number
      * Move fields to key list
     C                     MOVELP1CUST    WQSR01           Customer Number
     C           KRSSR     SETLL@PATTL1                    *
     C           KRSSR     READE@PATTL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2936' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SREXIT
     C                     END
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C           KRSSR     READE@PATTL1                  90*
     C                     END
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Find Joint A/c Holder Dtl - Joint Account Holder Dtls  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN F3CUST    WQSS01           Customer Number
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS01           Customer Number
      * Move fields to key list
     C                     MOVELP1CUST    WQSS01           Customer Number
     C           KRSSS     SETLL@JUSRL1                    *
     C           KRSSS     READE@JUSRL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2938' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SSEXIT
     C                     END
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C           KRSSS     READE@JUSRL1                  90*
     C                     END
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Find Related Cust Numb - Related Cust Number Dtls  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           F4CUST           Customer Number
      * Move fields to key list
     C                     MOVELP1CUST    F4CUST           Customer Number
     C           KRSST     CHAIN@RELCL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2940' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO STEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     END
      *================================================================
     CSR         STEXIT    ENDSR
     C/COPY WNCPYSRC,SD0011XC08
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Initialise indicators for re-entry
     C                     MOVE '0'       *IN
      * Setup job date/time
      *
     C                     Z-ADDUDATE     ##JDT
      * Set century digit (If YY prior to 1940 treat as 20YY)
     C           ##JYY     IFLT 40
     C                     Z-ADD1         ##JCC
     C                     ELSE
     C                     Z-ADD0         ##JCC
     C                     END
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Called Previously
     C                     MOVEL*BLANK    WUCPRV  1
      * Define work field Midas/Telex Module Ind.
     C                     MOVEL*BLANK    WUMTMI  1
      * Define work field SWIFT Funds Transfer
     C                     MOVEL*BLANK    WUSWFT  1
      * Define work field SWIFT Securities Trading
     C                     MOVEL*BLANK    WUSWST  1
      * Define work field SWIFT Customer Lending
     C                     MOVEL*BLANK    WUSWCL  1
      * Define work field SWIFT Synd Loans (REDUN)
     C                     MOVEL*BLANK    WUSWSL  1
      * Define work field SWIFT Statements
     C                     MOVEL*BLANK    WUSWSM  1
      * Define work field SWIFT Dealing
     C                     MOVEL*BLANK    WUSWDL  1
      * Define work field Standing data/Gen.Ledger
     C                     MOVEL*BLANK    WUSDGL  1
      * Define work field Dealing: FX
     C                     MOVEL*BLANK    WUDLFX  1
      * Define work field Syndicated Loans (REDUN)
     C                     MOVEL*BLANK    WUSYLN  1
      * Define work field Exposure Management
     C                     MOVEL*BLANK    WUEXMG  1
      * Define work field Financial Modeller
     C                     MOVEL*BLANK    WUFNMO  1
      * Define work field Statutory Returns
     C                     MOVEL*BLANK    WUSTRT  1
      * Define work field Customer Lending
     C                     MOVEL*BLANK    WUCSLN  1
      * Define work field Retail Banking
     C                     MOVEL*BLANK    WURTBN  1
      * Define work field Midas/Swift direct link
     C                     MOVEL*BLANK    WUMSDL  1
      * Define work field Securities
     C                     MOVEL*BLANK    WUSECS  1
      * Define work field Auto-reconciliations
     C                     MOVEL*BLANK    WUAURC  1
      * Define work field Bond Dealers Interface
     C                     MOVEL*BLANK    WUBDLI  1
      * Define work field DRS Standing Data
     C                     MOVEL*BLANK    WUDRSD  1
      * Define work field DRS Control module
     C                     MOVEL*BLANK    WUDRCM  1
      * Define work field DRS Foreign Exchange
     C                     MOVEL*BLANK    WUDRFE  1
      * Define work field DRS Money Market
     C                     MOVEL*BLANK    WUDRMM  1
      * Define work field DRS Arbitrage
     C                     MOVEL*BLANK    WUDRAR  1
      * Define work field Funds Transfer
     C                     MOVEL*BLANK    WUFDTR  1
      * Define work field DRS Common Applications
     C                     MOVEL*BLANK    WUDRCA  1
      * Define work field Futures & Options
     C                     MOVEL*BLANK    WUFUOP  1
      * Define work field Midas/Telex Synd. Loans
     C                     MOVEL*BLANK    WUMTSL  1
      * Define work field Midas/Telex Dealing
     C                     MOVEL*BLANK    WUMTDL  1
      * Define work field Midas/Telex Gen. Ledger
     C                     MOVEL*BLANK    WUMTGL  1
      * Define work field Midas/Telex Cust. Lending
     C                     MOVEL*BLANK    WUMTCL  1
      * Define work field Message Management
     C                     MOVEL*BLANK    WUNWMI  1
      * Define work field FRA/IRS Indicator
     C                     MOVEL*BLANK    WUFIIN  1
      * Define work field Dealing: MM
     C                     MOVEL*BLANK    WUDLMM  1
      * Define work field Internal Contracts
     C                     MOVEL*BLANK    WUINCN  1
      * Define work field Treasury Management
     C                     MOVEL*BLANK    WUTRMG  1
      * Define work field Interest Risk Management
     C                     MOVEL*BLANK    WURKMG  1
      * Define work field Testkey
     C                     MOVEL*BLANK    WUTSKY  1
      * Define work field Midas/Q
     C                     MOVEL*BLANK    WUMIDQ  1
      * Define work field Microfiche
     C                     MOVEL*BLANK    WUMFIC  1
      * Define work field Interest on accounts
     C                     MOVEL*BLANK    WUIOAC  1
      * Define work field Window processing requir.
     C                     MOVEL*BLANK    WUWDPR  1
      * Define work field SAR's processing required
     C                     MOVEL*BLANK    WUSARP  1
      * Define work field French return indicator
     C                     MOVEL*BLANK    WUFRIN  1
      * Define work field Lux return indicator
     C                     MOVEL*BLANK    WULRIN  1
      * Define work field Dutch return indicator
     C                     MOVEL*BLANK    WUDRIN  1
      * Define work field German return indicator
     C                     MOVEL*BLANK    WUGRIN  1
      * Define work field Belgian return indicator
     C                     MOVEL*BLANK    WUBRIN  1
      * Define work field Italian return indicator
     C                     MOVEL*BLANK    WUIRIN  1
      * Define work field Swift External Interface
     C                     MOVEL*BLANK    WUSWEI  1
      * Define work field Portfolio Management
     C                     MOVEL*BLANK    WUPFMG  1
      * Define work field Credit Management.
     C                     MOVEL*BLANK    WUCRMG  1
      * Define work field Head Office Reporting
     C                     MOVEL*BLANK    WUHORP  1
      * Define work field Average Balances
     C                     MOVEL*BLANK    WUAVBL  1
      * Define work field Margins
     C                     MOVEL*BLANK    WUMARG  1
      * Define work field Confirmation Matching
     C                     MOVEL*BLANK    WUCFMT  1
      * Define work field Mimix
     C                     MOVEL*BLANK    WUMIMX  1
      * Define work field Report Control Facility
     C                     MOVEL*BLANK    WURCFI  1
      * Define work field Amps Int
     C                     MOVEL*BLANK    WUAMIN  1
      * Define work field Swiss Returns
     C                     MOVEL*BLANK    WUSWRT  1
      * Define work field Fiduciary Loans & Deposit
     C                     MOVEL*BLANK    WUFLND  1
      * Define work field Portfolio Lending
     C                     MOVEL*BLANK    WULMCR  1
      * Define work field Cantonal Tax
     C                     MOVEL*BLANK    WUCNTX  1
      * Define work field Stamp Duty
     C                     MOVEL*BLANK    WUSTDU  1
      * Define work field Use DRS Shortnames
     C                     MOVEL*BLANK    WUUDRS  1
      * Define work field Chips Dealing
     C                     MOVEL*BLANK    WUCHDL  1
      * Define work field Chips Lending
     C                     MOVEL*BLANK    WUCHLN  1
      * Define work field Chips Opening Balance
     C                     MOVEL*BLANK    WUCHOB  1
      * Define work field CHIPS
     C                     MOVEL*BLANK    WUCHIP  1
      * Define work field Chips Direct Link
     C                     MOVEL*BLANK    WUCHDI  1
      * Define work field Optical Disk
     C                     MOVEL*BLANK    WUOPDK  1
      * Define work field Multi-branching Indicator
     C                     MOVEL*BLANK    WUMBIN  1
      * Define work field Leo Data Nucleus
     C                     MOVEL*BLANK    WUNNST  1
      * Define work field Leo Letters of Credit
     C                     MOVEL*BLANK    WUNOST  1
      * Define work field Leo Collections
     C                     MOVEL*BLANK    WUNPST  1
      * Define work field Leo Bills/Financing
     C                     MOVEL*BLANK    WUNQST  1
      * Define work field Leo Bankers Acceptances
     C                     MOVEL*BLANK    WUNRST  1
      * Define work field Leo Reimbursements
     C                     MOVEL*BLANK    WUNSST  1
      * Define work field Taxes
     C                     MOVEL*BLANK    WUNTST  1
      * Define work field History & Audit Facility
     C                     MOVEL*BLANK    WUNUST  1
      * Define work field Management Accounts
     C                     MOVEL*BLANK    WUNVST  1
      * Define work field IBLC Returns
     C                     MOVEL*BLANK    WUNWST  1
      * Define work field Retail 3
     C                     MOVEL*BLANK    WUNXST  1
      * Define work field Interest on Accounts 3
     C                     MOVEL*BLANK    WUNYST  1
      * Define work field Midas Export Data Module
     C                     MOVEL*BLANK    WUNZST  1
      * Define work field Analytical Accounting
     C                     MOVEL*BLANK    WUN0ST  1
      * Define work field User Defined Correspondnc
     C                     MOVEL*BLANK    WUN1ST  1
      * Define work field Midas-Plato Interface
     C                     MOVEL*BLANK    WUN2ST  1
      * Define work field Midas-Trade Innovation If
     C                     MOVEL*BLANK    WUN3ST  1
      * Define work field Reserved for Later Use 41
     C                     MOVEL*BLANK    WUN4ST  1
      * Define work field Reserved for Later Use 42
     C                     MOVEL*BLANK    WUN5ST  1
      * Define work field Reserved for Later Use 43
     C                     MOVEL*BLANK    WUN6ST  1
      * Define work field Reserved for Later Use 44
     C                     MOVEL*BLANK    WUN7ST  1
      * Define work field Reserved for Later Use 45
     C                     MOVEL*BLANK    WUN8ST  1
      * Define work field Reserved for Later Use 46
     C                     MOVEL*BLANK    WUN9ST  1
      * Define work field Reserved for Later Use 47
     C                     MOVEL*BLANK    WUOAST  1
      * Define work field Reserved for Later Use 48
     C                     MOVEL*BLANK    WUOBST  1
      * Define work field Reserved for Later Use 49
     C                     MOVEL*BLANK    WUOCST  1
      * Define work field Reserved for Later Use 50
     C                     MOVEL*BLANK    WUODST  1
      * Define work field Reserved for Later Use 51
     C                     MOVEL*BLANK    WUOEST  1
      * Define work field Reserved for Later Use 52
     C                     MOVEL*BLANK    WUOFST  1
      * Define work field Reserved for Later Use 53
     C                     MOVEL*BLANK    WUOGST  1
      * Define work field Reserved for Later Use 54
     C                     MOVEL*BLANK    WUOHST  1
      * Define work field Reserved for Later Use 55
     C                     MOVEL*BLANK    WUOIST  1
      * Define work field Reserved for Later Use 56
     C                     MOVEL*BLANK    WUOJST  1
      * Define work field Reserved for Later Use 57
     C                     MOVEL*BLANK    WUOKST  1
      * Define work field Reserved for Later Use 58
     C                     MOVEL*BLANK    WUOLST  1
      * Define work field Reserved for Later Use 59
     C                     MOVEL*BLANK    WUOMST  1
      * Define work field Reserved for Later Use 60
     C                     MOVEL*BLANK    WUONST  1
      * Define work field Reserved for Later Use 61
     C                     MOVEL*BLANK    WUOOST  1
      * Define work field Reserved for Later Use 62
     C                     MOVEL*BLANK    WUOPST  1
      * Define work field Reserved for Later Use 63
     C                     MOVEL*BLANK    WUOQST  1
      * Define work field Reserved for Later Use 64
     C                     MOVEL*BLANK    WUORST  1
      * Define work field Reserved for Later Use 65
     C                     MOVEL*BLANK    WUOSST  1
      * Obtain default message file
     C           *NAMVAR   DEFN Y2MGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Access Pgm Return Code
     C                     MOVEL*BLANK    WUAPRC  7
      * Define work field SAR number field
     C                     MOVEL*BLANK    WUSARN  6
      * Define work field Access obj dummy DS (76)
     C                     MOVEL*BLANK    WUFDY  76
      * Define work field SAR S01423
     C                     MOVEL*BLANK    WUSARW  1
      * Define work field SAR S01425
     C                     MOVEL*BLANK    WUWSAR  1
      * Define work field SAR S01464
     C                     MOVEL*BLANK    WURTST  1
      * Define work field SAR S01467
     C                     MOVEL*BLANK    WUSSAR  1
      *                                                                   CSE023
      ** Define work field SAR CSE023                                     CSE023
      *                                                                   CSE023
     C                     MOVEL*BLANK    CSE023  1                       CSE023
      * Define work field CSD001
     C                     MOVEL*BLANK    WUCSD1  1
      * Define work field Cust Delete Instruction
     C                     MOVEL*BLANK    WUDELI  1
      * Define work field Customer Deln String 1
     C                     MOVEL*BLANK    WUCDS1200
      * Define work field Customer Deln String 2
     C                     MOVEL*BLANK    WUCDS2200
      * Define work field Customer Deln String 3
     C                     MOVEL*BLANK    WUCDS3200
      * Define work field Customer Deln String 4
     C                     MOVEL*BLANK    WUCDS4200
      * Define work field Customer Deln String 5
     C                     MOVEL*BLANK    WUCDS5200
      * Define work field Customer Deln Flag 001
     C                     MOVEL*BLANK    WUD001  1
      * Define work field Customer Deln Flag 004
     C                     MOVEL*BLANK    WUD004  1
      * Define work field Customer Deln Flag 005
     C                     MOVEL*BLANK    WUD005  1
      * Define work field Customer Deln Flag 021
     C                     MOVEL*BLANK    WUD021  1
      * Define work field Customer Deln Flag 022
     C                     MOVEL*BLANK    WUD022  1
      * Define work field Customer Deln Flag 034
     C                     MOVEL*BLANK    WUD034  1
      * Define work field Customer Deln Flag 035
     C                     MOVEL*BLANK    WUD035  1
      * Define work field Customer Deln Flag 041
     C                     MOVEL*BLANK    WUD041  1
      *                                                                   CSE023
      ** Define work field Customer Deln Flag 042                         CSE023
      *                                                                   CSE023
     C                     MOVEL*BLANK    WUD042  1                       CSE023
      * Define work field Customer Deln Flag 801
     C                     MOVEL*BLANK    WUD801  1
      * Define work field Customer Deln Flag 002
     C                     MOVEL*BLANK    WUD002  1
      * Define work field Customer Deln Flag 003
     C                     MOVEL*BLANK    WUD003  1
      * Define work field Customer Deln Flag 027
     C                     MOVEL*BLANK    WUD027  1
      * Define work field Customer Deln Flag 036
     C                     MOVEL*BLANK    WUD036  1
      * Define work field Customer Deln Flag 006
     C                     MOVEL*BLANK    WUD006  1
      * Define work field Customer Deln Flag 007
     C                     MOVEL*BLANK    WUD007  1
      *                                                                                       198304
      ** Define work field Customer Deln Flag 043                                             198304
      *                                                                                       198304
     C                     MOVEL*BLANK    WUD043                                              198304
      * Define work field Customer Number
     C                     MOVEL*BLANK    WUCUST  6
      * Define work field Receipt - Our Nostro
     C**********           MOVEL*BLANK    WURONO 12                                           CGL029
     C                     MOVEL*BLANK    WURONO 18                                           CGL029
      * Define work field Rcpt - Ordering Bank No.
     C                     MOVEL*BLANK    WUROBN  6
      * Define work field Rcpt - Ordering Customer
     C                     MOVEL*BLANK    WUROCS  6
      * Define work field Rcpt - Intermed Bank No.
     C                     MOVEL*BLANK    WURIBN  8
      * Define work field Pay - Our Nostro
     C**********           MOVEL*BLANK    WUPONO 12                                           CGL029
     C                     MOVEL*BLANK    WUPONO 18                                           CGL029
      * Define work field Pay - Ordering Bank Numb.
     C                     MOVEL*BLANK    WUPOBN  6
      * Define work field Pay - Ordering Customer
     C                     MOVEL*BLANK    WUPOCS  6
      * Define work field Pay - Intermed Bank No.
     C                     MOVEL*BLANK    WUPIBN  8
      * Define work field Receiver Correspondent No
     C                     MOVEL*BLANK    WURCNO  8
      * Define work field Receiver Number
     C                     MOVEL*BLANK    WURCNB  8
      * Define work field A/c With Bank No.
     C                     MOVEL*BLANK    WUACBN  8
      * Define work field Beneficiary Number
     C                     MOVEL*BLANK    WUBYNB  8
      * Define work field Customer Deln Flag 008
     C                     MOVEL*BLANK    WUD008  1
      * Define work field Customer Deln Flag 009
     C                     MOVEL*BLANK    WUD009  1
      * Define work field Customer Deln Flag 010
     C                     MOVEL*BLANK    WUD010  1
      * Define work field Customer Deln Flag 011
     C                     MOVEL*BLANK    WUD011  1
      * Define work field Customer Deln Flag 012
     C                     MOVEL*BLANK    WUD012  1
      * Define work field Customer Deln Flag 013
     C                     MOVEL*BLANK    WUD013  1
      * Define work field Customer Deln Flag 014
     C                     MOVEL*BLANK    WUD014  1
      * Define work field Customer Deln Flag 015
     C                     MOVEL*BLANK    WUD015  1
      * Define work field Customer Deln Flag 016
     C                     MOVEL*BLANK    WUD016  1
      * Define work field Customer Deln Flag 017
     C                     MOVEL*BLANK    WUD017  1
      * Define work field Customer Deln Flag 018
     C                     MOVEL*BLANK    WUD018  1
      * Define work field Customer Deln Flag 019
     C                     MOVEL*BLANK    WUD019  1
      * Define work field Customer Deln Flag 020
     C                     MOVEL*BLANK    WUD020  1
      * Define work field Depot 1 (EUROCLEAR)
     C                     MOVEL*BLANK    WUDR1   6
      * Define work field Depot Ref 3, Kassenverein
     C                     MOVEL*BLANK    WUDR3   6
      * Define work field Depot Reference 10 Custom
     C                     MOVEL*BLANK    WUDR10  6
      * Define work field Depot Reference 2 - Cedel
     C                     MOVEL*BLANK    WUDR2   6
      * Define work field Depot Reference 4 Custome
     C                     MOVEL*BLANK    WUDR4   6
      * Define work field Depot Reference 5 Custome
     C                     MOVEL*BLANK    WUDR5   6
      * Define work field Depot Reference 6 Custome
     C                     MOVEL*BLANK    WUDR6   6
      * Define work field Depot Reference 7 Custome
     C                     MOVEL*BLANK    WUDR7   6
      * Define work field Depot Reference 8 Custome
     C                     MOVEL*BLANK    WUDR8   6
      * Define work field Depot Reference 9 Custome
     C                     MOVEL*BLANK    WUDR9   6
      * Define work field Customer Deln Flag 023
     C                     MOVEL*BLANK    WUD023  1
      * Define work field Customer Deln Flag 024
     C                     MOVEL*BLANK    WUD024  1
      * Define work field Customer Deln Flag 025
     C                     MOVEL*BLANK    WUD025  1
      * Define work field Customer Deln Flag 026
     C                     MOVEL*BLANK    WUD026  1
      * Define work field Customer Deln Flag 028
     C                     MOVEL*BLANK    WUD028  1
      * Define work field Customer Deln Flag 029
     C                     MOVEL*BLANK    WUD029  1
      * Define work field Customer Deln Flag 030
     C                     MOVEL*BLANK    WUD030  1
      * Define work field Customer Deln Flag 031
     C                     MOVEL*BLANK    WUD031  1
      * Define work field Customer Deln Flag 032
     C                     MOVEL*BLANK    WUD032  1
      * Define work field Customer Deln Flag 033
     C                     MOVEL*BLANK    WUD033  1
      * Define work field Customer Deln Flag 037
     C                     MOVEL*BLANK    WUD037  1
      * Define work field Customer Deln Flag 038
     C                     MOVEL*BLANK    WUD038  1
      * Define work field Customer Deln Flag 039
     C                     MOVEL*BLANK    WUD039  1
      * Define work field Customer Deln Flag 040
     C                     MOVEL*BLANK    WUD040  1
     C/COPY WNCPYSRC,SD0011XC06
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Open files first time only
     C           W0OPN     IFEQ *BLANK
      *                                                                                      BUG8616
      * Create Extended Settlement Extract file                                              BUG8616
     C                     EXSR EXTSET                                                       BUG8616
     C                     OPEN SDMMODL1
     C                     OPEN SDACUSL1
     C                     OPEN SDCFCDL1
     C                     OPEN SDCMRKL1
     C                     OPEN SDFOCSL1
     C                     OPEN SDSECSL1
     C                     OPEN SDPLCSL1
     C                     OPEN SDLBCSL1
     C                     OPEN SDTICSL1
     C                     OPEN SDWTCSL1                                  CSE023
     C                     OPEN SDBANKL2
     C                     OPEN SDBRCHL5
     C                     OPEN SDCLLML1
     C                     OPEN SDCLEOL1
     C                     OPEN SDCUSTL4
     C                     OPEN SDDEALL2
     C                     OPEN SDSTRDL1
     C                     OPEN SDCCRDL1
     C                     OPEN SDPATTL1
     C                     OPEN SDJUSRL1
     C                     OPEN SDRELCL1
     C                     OPEN SDBRCHL9                                                     BUG7195
     C                     OPEN SDEXSTLB                                                     BUG8616
     C                     OPEN POSTND                                                      MD042652
     C/COPY WNCPYSRC,SD0011XC07
      * Signal that files are now open
     C                     MOVE 'Y'       W0OPN   1
     C                     END
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
      /EJECT
     CSR         *PSSR     BEGSR
      *****************************************************************
      *                                                               *
      * *PSSR  - Program exception error routine                      *
      *          Called automatically if a program error occurs,      *
      *          or directly by the program code using EXSR.          *
      *          This subroutine DUMPs the program just once.         *
      *                                                               *
      *****************************************************************
      *
      * Core function specific processing.
      *
     C/COPY WNCPYSRC,SD0011XPSC
      *
      * Start of PSSR user point.
      *
     C/COPY WNCPYSRC,SD0011XPS1
      *
      * Standard Midas PSSR processing.
      *
     C/COPY SDCPYSRC,SDPSSRBCH
      *
      * End of PSSR user point.
      *
     C/COPY WNCPYSRC,SD0011XPS2
      *
      *================================================================
     CSR                   ENDSR
      *================================================================
      /EJECT                                                                                 BUG8616
     C           EXTSET    BEGSR                                                             BUG8616
      *                                                                                      BUG8616
      * Create extract file, then copy from two logicals                                     BUG8616
      * (all formats) SDEXSTLB & SDEXSTLC to populate                                        BUG8616
     C                     MOVEAQCMD1     CMDSTR                                             BUG8616
     C                     EXSR QCMDSR                                                       BUG8616
     C                     CLEARCMDSTR                                                       BUG8616
     C                     MOVEAQCMD2     CMDSTR                                             BUG8616
     C                     EXSR QCMDSR                                                       BUG8616
     C                     CLEARCMDSTR                                                       BUG8616
     C                     MOVEAQCMD3     CMDSTR                                             BUG8616
     C                     EXSR QCMDSR                                                       BUG8616
     C                     CLEARCMDSTR                                                       BUG8616
      *                                                                                      BUG8616
      * Override to extract file                                                             BUG8616
     C                     MOVEAQCMD4     CMDSTR                                             BUG8616
     C                     EXSR QCMDSR                                                       BUG8616
     C                     ENDSR                                                             BUG8616
      *                                                                                      BUG8616
     C           QCMDSR    BEGSR                                                             BUG8616
     C**********           CALL 'QCMDEXC'                                           BUG8616 BUG12259
     C                     CALL 'QCMDEXC'              80                                   BUG12259
     C                     PARM           CMDSTR 80                                          BUG8616
     C                     PARM 80        CMDLEN 155                                         BUG8616
     C                     ENDSR                                                             BUG8616
      *================================================================                      BUG8616
      /EJECT                                                                                 BUG8616
** CPY@     : Copyright notice for inclusion in all programs
(c) Misys International Banking Systems Ltd. 2001
** QCMD1                                                                                     BUG8616
CPYF SDEXSTLB QTEMP/SDEXSTEXT CRTFILE(*YES) MBROPT(*REPLACE) RCDFMT(@EXSTLBA)
** QCMD2                                                                                     BUG8616
CPYF SDEXSTLB QTEMP/SDEXSTEXT MBROPT(*REPLACE) RCDFMT(*ALL) FMTOPT(*NOCHK)
** QCMD3                                                                                     BUG8616
CPYF SDEXSTLC QTEMP/SDEXSTEXT MBROPT(*REPLACE) RCDFMT(*ALL) FMTOPT(*NOCHK)
** QCMD4                                                                                     BUG8616
OVRDBF SDEXSTLB QTEMP/SDEXSTEXT
