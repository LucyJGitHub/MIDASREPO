     H        1   Y
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas SD Further customer details shell pgm')          *
      *****************************************************************
      *                                                               *
      *  Midas - Standing Data Module                             *
      *                                                               *
      *  SD0012X - Non-Core Customer Details.                         *
      *                                                               *
      *  Function:  This program allows an customer to define         *
      *             their own client details.                         *
      *                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
      *                                                               *
      *  Note: Core amendments to this program must be applied        *
      *        via the core synon model.                              *
      *                                                               *
      *  Last Amend No. CLE134             Date 01Aug12               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Prev Amend No. CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CSW024             Date 31Aug01               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.04 -----------------------------------------------*
      *                 CDL008             Date 02May00               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CCF001             Date 11Apr95               *
      *                 S01497             Date 06Jun94               *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  CLE134 - Past Due Call Loan Processing (Recompile)           *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CSW024 - S.W.I.F.T. MT3xx Field 82/83/87. (Recompiled)       *
      *  CDL008 - Continuous Linked Settlement                        *
      *           (Recompiled over changed SDCUSTPD)                  *
      *  CCF001 - Recompiled over changed SDCUSTPD.                   *
      *  S01497 - Program introduced to core.                         *
      *                                                               *
      *****************************************************************
     E* Description     : Copyright notice for inclusion in all programs
     E*
     E********************************************************************
     E                    CPY@    1   1 80               Copyright     array
     I*
     I* Description     : Copyright notice for inclusion in all programs
     I*
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IA@CPY       DS
     I* Copyright array
     I                                        1  80 CPY@
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I : RST Customer Number
     I                                        1   6 P1CUST
     IP2PARM      DS
      * I :  Action Code
     I                                        1   1 P2ANCD
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1CUST    PARM           WP0001  6        Customer Number
     C           P2ANCD    PARM           WP0002  1        Action Code
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Further client details
      * SD0012X Precompiler - Client Details  *
      * Copyright processing.
      * Copyright Statement 1994 - Standard Functions  *
      * If the program has been called in enquiry mode.
      * CASE: PAR.Action Code is Enquire
     C           P2ANCD    IFEQ 'E'                        *IF
      * The non-core enquiry processing should be placed in this /COPY.
      * The /COPY should contain a call to a non-core program which will
      * perform the enquiry processing.
      * Non-Core Cust Dtls Enq - Client Details  *
     C*
     C/COPY SDCPYSRC,SD0012XENQ
     C*
     C                     END                             *FI
      * If the program has been called in insert mode.
      * CASE: PAR.Action Code is Insert
     C           P2ANCD    IFEQ 'I'                        *IF
      * The non-core insert processing should be placed in this /COPY.
      * The /COPY should contain a call to a non-core program which will
      * perform the insert processing.
      * Non-Core Cust Dtls Insert - Client Details  *
     C*
     C/COPY SDCPYSRC,SD0012XINS
     C*
     C                     END                             *FI
      * If the program has been called in amend mode.
      * CASE: PAR.Action Code is Amend
     C           P2ANCD    IFEQ 'A'                        *IF
      * The non-core amend processing should be placed in this /COPY.
      * The /COPY should contain a call to a non-core program which will
      * perform the amend processing.
      * Non-Core Cust Dtls Amend - Client Details  *
     C*
     C/COPY SDCPYSRC,SD0012XAMD
     C*
     C                     END                             *FI
      * If the program has been called in delete mode.
      * CASE: PAR.Action Code is Delete
     C           P2ANCD    IFEQ 'D'                        *IF
      * The non-core delete processing should be placed in this /COPY.
      * The /COPY should contain a call to a non-core program which will
      * perform the delete processing.
      * Non-Core Cust Dtls Delete - Client Details  *
     C*
     C/COPY SDCPYSRC,SD0012XDEL
     C*
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Setup job date/time
      *
     C                     Z-ADDUDATE     ##JDT
      * Set century digit (If YY prior to 1940 treat as 20YY)
     C           ##JYY     IFLT 40
     C                     Z-ADD1         ##JCC
     C                     ELSE
     C                     Z-ADD0         ##JCC
     C                     END
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
      /EJECT
     CSR         *PSSR     BEGSR
      *****************************************************************
      *                                                               *
      * *PSSR  - Program exception error routine                      *
      *          Called automatically if a program error occurs,      *
      *          or directly by the program code using EXSR.          *
      *          This subroutine DUMPs the program just once.         *
      *                                                               *
      *****************************************************************
      *
      * Start of PSSR user point.
      *
     C/COPY WNCPYSRC,SD0012XPS1
      *
      * Standard Midas PSSR processing.
      *
     C/COPY SDCPYSRC,SDPSSRINT
      *
      * End of PSSR user point.
      *
     C/COPY WNCPYSRC,SD0012XPS2
      *
      *================================================================
     CSR                   ENDSR
      *================================================================
** CPY@     : Copyright notice for inclusion in all programs
(c) Misys International Banking Systems Ltd. 2001
