     H        1   Y
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas SD Further customer details')                    *
      *****************************************************************
      *                                                               *
      *  Midas - Standing Data Module                                 *
      *                                                               *
      *  SD0014V - Prompt for Customer Details Related Files.         *
      *                                                               *
      *  Function:  This program allows customer details related      *
      *             functions to be edited.                           *
      *                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
      *                                                               *
      *  Last Amend No. CER071             Date 01Aug16               *
      *  Prev Amend No. CER070             Date 25Nov14               *
      *                 MD030956           Date 09Oct14               *
      *                 CSD093             Date 01Apr13               *
      *                 CLE134             Date 01Aug12               *
      *                 CER059             Date 19Jul10               *
      *                 BUG26917A          Date 27Jan10               *
      *                 BUG26917           Date 20Jan10               *
      *                 CER045             Date 20Jul09               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 BUG14672           Date 23Aug07               *
      * Midas Plus 1.4 Base ------------------------------------------*
      *                 238374             Date 02Nov06               *
      *                 237624             Date 02Nov06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD027A            Date 11May06               *
      *                 CSD027             Date 09Dec05               *
      *                 BUG9233            Date 28Feb06               *
      *                 BUG10603           Date 14Feb06               *
      *                 BUG10154           Date 27Jan06               *
      *                 CER001             Date 25Apr05               *
      *                 CRN001             Date 04Nov05               *
      *                 232543             Date 01Apr05               *
      *                 CGL032             Date 05Jul04               *
      *                 CSD028             Date 22Aug05               *
      *                 BUG6706            Date 20Apr05               *
      *                 CSW037A            Date 02May05               *
      *                 BUG6198            Date 04Apr05               *
      *                 BUG5139            Date 10Mar05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 BUG4454            Date 08Oct04               *
      *                 BUG3362            Date 28Jul04               *
      *                 227847  (BUG3304)  Date 17Jun04               *
      *                 BUG2664            Date 21May04               *
      *                 225662  (BUG759)   Date 11Mar04               *
      *                 CGL013             Date 29Mar02               *
      *                 215916             Date 09Jul03               *
      *                 CGL018             Date 18Sep02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 196149             Date 16Aug00               *
      *                 183032             Date 16Aug00               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 CSD008             Date 05Feb01               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 CSE023             Date 12Jul00               *
      *                 CRT004             Date 04May00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 CAP039             Date 09May00               *
      * Midas DBA 3.02 -----------------------------------------------*
      *                 153812             Date 13Oct99               *
      * Midas DBA 3.01 -----------------------------------------------*
      *                 CDL006             Date 26Apr99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 145461             Date 15Feb99               *
      *                 140709             Date 09Aug98               *
      *                 132720             Date 27Mar98               *
      *                 S01408             Date 23MAR98               *
      *                 126676             Date 26NOV97               *
      *                 126664             Date 13NOV97               *
      *                 CSD003             Date 27OCT97               *
      *                 CTI001             DATE 05AUG97               *
      *                 CDL002             DATE 16JAN97               *
      *                 S01408             DATE 23AUG96               *
      *                 S01408             DATE 02AUG96               *
      *                 088433             DATE 01AUG96               *
      *                 CPM004             DATE 19MAR96               *
      *                 CCF001             DATE 11APR95               *
      *                 S01522             DATE 12OCT94               *
      *                 076220             DATE 21SEP94               *
      *                 S01497             DATE 12JUL94               *
      *                 S01486             DATE 30JUN94               *
      *                 S01467             DATE 02JUN94               *
      *                 S01464             DATE 04MAY94               *
      *                 S01437             DATE 20JAN94               *
      *                 S01459             DATE 20JAN94               *
      *                 S01421 (S01423)    DATE 08JUL93               *
      *                        (S01425)                               *
      *                 S01413             DATE 21JUN93               *
      *                 LN1104             DATE 15FEB91               *
      *                 S01267             DATE 17JAN91               *
      *                 S01117             DATE 02FEB90               *
      *                 E19042             DATE 10FEB90               *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  CER071 - BAIS - Legal Form field (Recompile)                 *
      *  CER070 - BuBa Reporting / BAIS V.1.16.0 (Recompile)          *
      *  MD030956 - Additional changes to BFM-TI enhancement          *
      *  CSD093 - Document Management                                 *
      *  CLE134 - Past Due Call Loan Processing (Recompile)           *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  BUG26917A - Reverse fix for bug26917                         *
      *  BUG26917 - COB error when customer is declared as taxable    *
      *           w/ German features installed and no additional      *
      *           customers information is set up                     *
      *  CER045 - German Features - Reporting Bundesbank (Recompile)  *
      *  BUG14672 - Some fields in Additional Customer Details are    *
      *             not saved                                         *
      *  238374  - BBTICS should be changed from 'Y' to 'N' if user   *
      *            press F3 or F12 from TI Details Maintenance        *
      *            (SD0371R). This is to avoid having customer flagged*
      *            as TI but do not have corresponding details in     *
      *            SDTICSPD                                           *
      *  237624  - Unable to amend customer with no TI record         *
      *  CSD027A - Conversion Of Customer Number to Alpha             *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  BUG9233 - Added to allow F3 on the regulatory reporting      *
      *            details. Error handling when fail to call SD000040.*
      *  BUG10603 - Change Control for KYC                            *
      *  BUG10154 - Conflict with CRN001 and CSD028: both use in48    *
      *             and in83. Amend so that CRN001 uses 49 and 84.    *
      *  CER001 - LUX Upgrade to MidasPlus                            *
      *  CRN001  - FRS Regulatory Reporting Interface                 *
      *  232543 - Fix to CGL032 (Recompile)                           *
      *  CGL032 - Automatic Exchange of Information                   *
      *  CSD028 - KYC (Standing Data Authorisations)                  *
      *  BUG6706 - Trade Innovation Cust details field does not       *
      *            default                                            *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  BUG6198- Cannot save new Details for CUSD (Recompile)        *
      *  BUG5139 - Unable to process additional customer during       *
      *            insert                                             *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  BUG4454 - Database error when inserting a customer with      *
      *            additional customer details                        *
      *  BUG3362 - Added processing for TI details, related to CSD012.*
      *  227847 - CSD012 caused problem with FX netting input         *
      *  BUG2664 - Amend program such that BBTICS is not reset during *
      *            amendment of TI client.  Apply part of fix 219329. *
      *  225662 - Disable FX netting input for insert                 *
      *  CGL013 - MT94x Messages Generation (Recompile over new layout*
      *                                      of SDNWRKPD)             *
      *  215916 - RWA:  In Enquiry mode do not allow add or delete.   *
      *  CGL018 - Risk Weighted Assets                                *
      *  196149 - If customer is a parent, customer cannot be TI.     *
      *  183032 - In amend and insert mode, institution code is       *
      *           mandatory if TI cust details is setup.              *
      *  CSD008 - Customer Service Fees Enhancement                   *
      *  CSE023 - Treaty Withholding Tax                              *
      *  CRT004 - Cashier Midas TCP/IP interface.                              *
      *  CAP039 - Conversion of SD inputs into modular structure to   *
      *           use as APIs.                                        *
      *  153812 - When inserting customer details, background file    *
      *           does not get updated.                               *
      *  CDL006 - Dealing Fiduciary                                   *
      *  145461 - Further validation for Institution Code.            *
      *  140709 - TI customers no longer need a blank in postition 7  *
      *           of the customer shortname field.                    *
      *  132720 - Wrong message id used (part of TI I/face)           *
      *  S01408 - Move core hook SD0014VC13 to correct position and   *
      *           substitute SD0014VCC1 in old position.              *
      *         - Move core hook SD0014VC14 to correct position and   *
      *           substitute SD0014VCC2 in old position.              *
      *  126676 - Institution Code must be mandatory for TI Customers.*
      *  126664 - Addition of new fields to SDTICSPD (recompile only) *
      *  CSD003 - Synon Closedown Project (SD):                       *
      *           - Program removed from SD model.                    *
      *  CTI001 - Midas-Trade Innovation Interface:                   *
      *           - Addition of TI selection field.                   *
      *  CDL002 - FX Netting: New option added, conditioned on        *
      *           switchable feature being on.                        *
      *  S01408 - Addition of core hooks:                             *
      *           - SD0014VC10                                        *
      *           - SD0014VC11                                        *
      *           - SD0014VC12                                        *
      *  S01408 - Addition of core hooks:                             *
      *           - SD0014VCP1                                        *
      *           - SD0014VCP2                                        *
      *           - SD0014VCP3                                        *
      *           - SD0014VCP4                                        *
      *           - SD0014VCP5                                        *
      *           - SD0014VCP6                                        *
      *           - SD0014VCP7                                        *
      *           - SD0014VCP8                                        *
      *           - SD0014VCP9                                        *
      *  088433 - At present, in insert mode the system will not      *
      *           allow the Customer Market Groups option to be       *
      *           reselected. Remove the check for an existing        *
      *           record in the Customer Market Groups file as        *
      *           SD1421R will select the correct program mode itself.*
      *  CPM004 - Bank Portfolios.                                    *
      *           Portfolio Management option is conditioned on       *
      *           either 1. PM is installed & Portfolios Supported    *
      *           (PM ICD) = 'C'; or 2. PM is installed & Customer is *
      *           Branch Internal Customer.                           *
      *  CCF001 - Recompiled over changed SDCUSTPD.                   *
      *  S01522 - Addition of 'User Defined Correspondence' option.   *
      *           Validate 'Securities and Futures and options'       *
      *           in the action diagram (removed the validation       *
      *           from the display file).                             *
      *  076220 - Merge the enquiry processing from SD0013V into      *
      *           this program and make SD0013V redundant.            *
      *  S01497 - Addition of non-core customer details option.       *
      *  S01486 - Private Banking:                                    *
      *           Addition of 'Portfolio Management' and 'Portfolio   *
      *           Lending'.                                           *
      *  S01467 - Midas-LEO Integration:                              *
      *           Addition of LEO details.                            *
      *           Separate the validation for Securities trading Data *
      *           and Futures & Options.                              *
      *  S01464 - The 'Customer Fees' option is available if either   *
      *           'Customer Service Fees' S01423 and / or             *
      *           'Safe Custody Fees' S01464 is present.              *
      *  S01437 - Recompile over changes to SDCUSTPD for the Midas    *
      *           Export module.                                      *
      *  S01459 - Addition of headerbox and PSSR processing.          *
      *  S01421 - BLI Development Phase 1.                            *
      *         - Includes changes for:                               *
      *           S01423 - Customer Service Fees switchable           *
      *                    feature. Field added to the screen.        *
      *           S01425 - Additional Customer Details switchable     *
      *                    feature. Field added to the screen.        *
      *  S01413 - Retail 3 incorporation. Customer Cheques and Safes  *
      *           available.                                          *
      *  LN1104 - Recompiled owing to change to SDCUSTPD.             *
      *  S01267 - MIS changes. Marketing Information available.       *
      *  E19042 - Prompt Fields should default to 'N', not to blank.  *
      *  S01117 - Release 10 Changes.                                 *
      *  S01212 - /Copy and Window Processing                         *
      *                                                               *
      *****************************************************************
     F*00/Copy member SD0014V   Initialise Program I-spec
     F/COPY WNCPYSRC,SD0014VFPG
     FSDICEXL1IF  E           K        DISK         KINFSR *PSSR      UC                      CER001
      ** Invalid Customers Details extra data file                                            CER001
      *                                                                                       CER001
     FSD0014V#CF  E                    WORKSTN                        UC
     F                                              KINFDS INFDS#
     F                                              KINFSR *PSSR
      * DSP: Midas SD Further customer details
      *
     FSDCMRKL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0001
     F                                              KINFSR *PSSR
      * RTV : Midas SD Customer marketing groups retrieval
      *
     FSDACUSL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0002
     F                                              KINFSR *PSSR
      * RTV : Midas SD Additional customer details retrieval
      *
     FSDCFCDL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0003
     F                                              KINFSR *PSSR
      * RTV : Midas SD Customer fees detail retrieval
      *
     FSDSECSL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0004
     F                                              KINFSR *PSSR
      * RTV : Midas SD Securities clients retrieval
      *
     FSDFOCSL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0005
     F                                              KINFSR *PSSR
      * RTV : Midas SD Futures and Options client retrieval
      *
     FSDPLCSL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0006
     F                                              KINFSR *PSSR
      * RTV : Midas SD Portfolio management cust details ret
      *
     FSDLBCSL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0007
     F                                              KINFSR *PSSR
      * RTV : Midas SD Portfolio lending customer details retr
      *
     FSDCLEOL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0008
     F                                              KINFSR *PSSR
      * RTV : Midas SD Midas-Leo customer interface retrieval
      *
     FSDTICSL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0009
     F                                              KINFSR *PSSR
      * RTV : Midas SD Trade innovovation customer dtl retrieval
      *
     FSDCUSTL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0010
     F                                              KINFSR *PSSR
      * RTV : Midas SD Customer details retrieval
      *
     FSDLOCNL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0011
     F                                              KINFSR *PSSR
      * RTV : Location Codes            Retrieval index
      *
     FSDACOFL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0012
     F                                              KINFSR *PSSR
      * RTV : Midas SD Account officers retrieval
      *
     FSDCTRYL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0013
     F                                              KINFSR *PSSR
      * RTV : Country Codes             Retrieval index
      *
     FSDBRCHL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0014
     F                                              KINFSR *PSSR
      * RTV : Midas SD Branch codes retrieval
      *
     FSDINSTL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0015
     F                                              KINFSR *PSSR
      * RTV : Local Institutions        Retrieval index
      *
     FSDINDSL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0016
     F                                              KINFSR *PSSR
      * RTV : Local Industry Codes      Retrieval index
      *
     FSDCRWCL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0017
     F                                              KINFSR *PSSR
      * RTV : Customer Risk Weight Code Retrieval index
      *
     FSDMTPYL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0018
     F                                              KINFSR *PSSR
      * RTV : Midas SD Message type descriptions retrieval
      *
     FSDNWRKL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0019
     F                                              KINFSR *PSSR
      * RTV : Message Network Details   Retrieval index
      *
     FSDMMODL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0020
     F                                              KINFSR *PSSR
      * RTV : Midas SD Midas module flags retrieval
      *
     FSDPORTL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0021
     F                                              KINFSR *PSSR
      * RTV : Midas SD Portfolio management ICD retrieval
      *
     FSDBRCHL5IF  E           K        DISK                           UC
     F                                              KINFDS ID0022
     F                                              KINFSR *PSSR
      * RSQ : Midas SD Branch codes by customer number
      *
     F***SDKYCIL0IF  E           K        DISK                                       CSD028 BUG10603
     FSDKYCIL1IF  E           K        DISK                                                 BUG10603
      ** KYC Investigation Items                                                              CSD028
      *                                                                                       CSD028
     E* Description     : Copyright notice for inclusion in all programs
     E*
     E********************************************************************
     E                    CPY@    1   1 80               Copyright array
     E/COPY WNCPYSRC,SD0014VEPG
     I*
     I* Description     : Copyright notice for inclusion in all programs
     I*
     I/COPY WNCPYSRC,SD0014VIPG
     I@BRCHFM
      * Midas SD Branch codes by customer number
      * Renamed input format fields
     I              A8BRCD                          WABRCD
     I              A8CMCD                          WACMCD
     I              A8LCCD                          WALCCD
     I              A8DFAC                          WADFAC
     I              A8DTAC                          WADTAC
     I              A8BICN                          WABICN
     I              A8LCD                           WALCD
     I              A8TYLC                          WATYLC
     I              A8BRNM                          WABRNM
     I              A8GBCD                          WAGBCD
     I              A8BRSN                          WABRSN
     I              A8RECI                          WARECI
     I              A8BTID                          WABTID
     I              A8STCD                          WASTCD
     I              A8RDFC                          WARDFC
     I              A8OGID                          WAOGID
     I              A8PCSS                          WAPCSS
     I              A8BTWN                          WABTWN
     I              A8SUOP                          WASUOP
     I              A8SUCL                          WASUCL
     I              A8SUOV                          WASUOV
     I              A8MOOP                          WAMOOP
     I              A8MOCL                          WAMOCL
     I              A8MOOV                          WAMOOV
     I              A8TUOP                          WATUOP
     I              A8TUCL                          WATUCL
     I              A8TUOV                          WATUOV
     I              A8WEOP                          WAWEOP
     I              A8WECL                          WAWECL
     I              A8WEOV                          WAWEOV
     I              A8THOP                          WATHOP
     I              A8THCL                          WATHCL
     I              A8THOV                          WATHOV
     I              A8FYOP                          WAFYOP
     I              A8FYCL                          WAFYCL
     I              A8FYOV                          WAFYOV
     I              A8SAOP                          WASAOP
     I              A8SACL                          WASACL
     I              A8SAOV                          WASAOV
     I              A8BRST                          WABRST
     I              A8SYCU                          WASYCU
     I              A8MQSM                          WAMQSM
     I              A8MQRT                          WAMQRT
     I              A8MQBU                          WAMQBU
     I              A8MQDF                          WAMQDF
     I              A8TIBR                          WATIBR
     I              A8TIDS                          WATIDS
     I              A8BRA1                          WABRA1
     I              A8BRA2                          WABRA2
     I              A8BRA3                          WABRA3
     I              A8BRA4                          WABRA4
     I              A8BRA5                          WABRA5
     I              A8BRNB                          WABRNB
     I              A8LLIS                          WALLIS                CRT004
     I              A8TCPP                          WATCPP                CRT004
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
      * Outward parameters
     IPARC        DS                              6
      * KEY : Midas SD Customer marketing groups retrieval
      * I : MAP Customer Number
     I                                        1   6 PACUST
      *
      * Outward parameters
     IPBRC        DS                              6
      * KEY : Midas SD Additional customer details retrieval
      * I : RST Customer Number
     I                                        1   6 PBCUST
      *
      * Outward parameters
     IPCRC        DS                              6
      * KEY : Midas SD Customer fees detail retrieval
      * I : RST Customer Number
     I                                        1   6 PCCUST
      *
      * Outward parameters
     IPDRC        DS                              6
      * KEY : Midas SD Customer details retrieval
      * I : RST Customer Number
     I                                        1   6 PDCUST
      *
      * Outward parameters
     IPERC        DS                              6
      * KEY : Midas SD Customer details retrieval
      * I : RST Customer Number
     I                                        1   6 PECUST
      *
      * Outward parameters
     IPFRC        DS                              6
      * KEY : Midas SD Securities clients retrieval
      * I : MAP Customer Number
     I                                        1   6 PFCUST
      *
      * Outward parameters
     IPGRC        DS                              6
      * KEY : Midas SD Futures and Options client retrieval
      * I : MAP Customer Number
     I                                        1   6 PGCUST
      *
      * Outward parameters
     IPHRC        DS                              6
      * KEY : Midas SD Portfolio management cust details ret
      * I : RST Customer Number
     I                                        1   6 PHCUST
      *
      * Outward parameters
     IPIRC        DS                              6
      * KEY : Midas SD Portfolio lending customer details retr
      * I : RST Customer Number
     I                                        1   6 PICUST
      *
      * Outward parameters
     IPJRC        DS                              6
      * KEY : Midas SD Customer marketing groups retrieval
      * I : MAP Customer Number
     I                                        1   6 PJCUST
      *
      * Outward parameters
     I***PKRC        DS                              6                                       BUG4454
     IPKRC        DS                             43                                          BUG4454
      * KEY : Midas SD Additional customer details retrieval
      * I : MAP Customer Number
     I                                        1   6 PKCUST
     I                                        7  26 PKCRNM                                   BUG4454
     I                                       27  36 PKCRTN                                   BUG4454
     I                                       37  39 PKBRCD                                   BUG4454
     I                                       40  40 PKCRPC                                   BUG4454
     I                                       41  43 PKLICD                                   BUG4454
      *
     I            DS                                                                          CSD028
     I                                        1   6 WCCUS#                                    CSD028
     I**********                              1   60WNCUS#                            CSD028 CSD027A
     I                                        1   6 WNCUS#                                   CSD027A
      * Outward parameters
     IPLRC        DS                              6
      * KEY : Midas SD Customer fees detail retrieval
      * I : MAP Customer Number
     I                                        1   6 PLCUST
      *
      * Outward parameters
     IPMRC        DS                              6
      * KEY : Midas SD Customer details retrieval
      * I : RST Customer Number
     I                                        1   6 PMCUST
      *
      * Outward parameters
     IPNRC        DS                              6
      * KEY : Midas SD Customer details retrieval
      * I : RST Customer Number
     I                                        1   6 PNCUST
      *
      * Outward parameters
     IPORC        DS                              6
      * KEY : Midas SD Customer details retrieval
      * I : MAP Customer Number
     I                                        1   6 POCUST
      *
      * Outward parameters
     IPPRC        DS                              6
      * KEY : Midas SD Securities clients retrieval
      * I : MAP Customer Number
     I                                        1   6 PPCUST
      *
      * Outward parameters
     IPQRC        DS                              6
      * KEY : Midas SD Futures and Options client retrieval
      * I : MAP Customer Number
     I                                        1   6 PQCUST
      *
      * Outward parameters
     IPRRC        DS                              6
      * KEY : Midas SD Portfolio management cust details ret
      * I : MAP Customer Number
     I                                        1   6 PRCUST
      *
      * Outward parameters
     IPSRC        DS                              6
      * KEY : Midas SD Portfolio lending customer details retr
      * I : MAP Customer Number
     I                                        1   6 PSCUST
      *                                                                   CAP039
      * Outward parameters                                                CAP039
     IWQMODN      DS                             10                       CAP039
      * I : MODULE NAME                                                   CAP039
     I                                        1   6 WQMOD1                CAP039
     I                                        7  10 WQMOD2                CAP039
      *
     IA@CPY       DS
     I* Copyright array
     I                                        1  80 CPY@
     IRUNDAT      DS
     I                                        1   7 MRDT
     I                                    P   8  100RDNB
     I                                       11  11 SUC
     I                                       12  12 DFF
     I                                       13  13 MBIN
     IYRSW0A      DS                           9999
     IYRSW0B      DS                           9999
     IYRSW0C      DS                           9999
     IYRSW0D      DS                           9999
     IID0001      DS                            528
      * File information data structure
      *
     IID0002      DS                            528
      * File information data structure
      *
     IID0003      DS                            528
      * File information data structure
      *
     IID0004      DS                            528
      * File information data structure
      *
     IID0005      DS                            528
      * File information data structure
      *
     IID0006      DS                            528
      * File information data structure
      *
     IID0007      DS                            528
      * File information data structure
      *
     IID0008      DS                            528
      * File information data structure
      *
     IID0009      DS                            528
      * File information data structure
      *
     IID0010      DS                            528
      * File information data structure
      *
     IID0011      DS                            528
      * File information data structure
      *
     IID0012      DS                            528
      * File information data structure
      *
     IID0013      DS                            528
      * File information data structure
      *
     IID0014      DS                            528
      * File information data structure
      *
     IID0015      DS                            528
      * File information data structure
      *
     IID0016      DS                            528
      * File information data structure
      *
     IID0017      DS                            528
      * File information data structure
      *
     IID0018      DS                            528
      * File information data structure
      *
     IID0019      DS                            528
      * File information data structure
      *
     IID0020      DS                            528
      * File information data structure
      *
     IID0021      DS                            528
      * File information data structure
      *
     IID0022      DS                            528
      * File information data structure
      *
      /EJECT
      * Parameter declarations
     I***P1PARM      DS                            565                                       BUG3362
     I***P1PARM      DS                            701                               BUG3362 BUG4454
     I***P1PARM      DS                            708                              BUG4454 BUG26917
     I***P1PARM*     DS                            709                            BUG26917 BUG26917A
     IP1PARM      DS                            708                                        BUG26917A
      * RCD: Midas SD Customer details retrieval
      * B : MAP Customer Number
     I                                        1   6 P1CUST
      * I : MAP Customer Shortname
     I                                        7  16 P1CSSN
      * I : MAP Customer Report Town
     I                                      157 166 P1CRTN
      * I : MAP Customer Report Name
     I                                      168 187 P1CRNM
      * I : MAP Local Institution Code                                    126676
     I                                      228 229 P1LINC                126676
     I/COPY WNCPYSRC,SD0014VI01
      * I : MAP Extended Customer SE Details                                                  CER001
     I                                      230 230 P1SEDT                                    CER001
      * I : MAP Extended Customer PL Details                                                  CER001
     I                                      231 231 P1PLDT                                    CER001
      * I : MAP Extended Customer FF Details                                                  CER001
     I                                      232 232 P1FFDT                                    CER001
      * I : MAP Extended Front Office ID                                                      CER001
     I                                      233 252 P1FRNT                                    CER001
      * B : MAP TI Customer Flag
     I                                      564 564 P1TICS
     I                                      565 700 P4CTID                                   BUG3362
      ** Corporate Customer                                                                  BUG4454
     I                                      702 702 P1CRPC                                   BUG4454
      ** Branch Code                                                                         BUG4454
     I                                      703 705 P1BRCD                                   BUG4454
      ** Local Industry Code                                                                 BUG4454
     I                                      706 708 P1LICD                                   BUG4454
      **********                                                                  BUG26917 BUG26917A
     I**********                            709 709 PDTAIN                        BUG26917 BUG26917A
     IP2PARM      DS
      * I :  Action Code
     I                                        1   1 P2ANCD
     IP3PARM      DS
      * I :  Parent Indicator
     I                                        1   1 P3PAIN
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Customer Group not found'
      * Choose Customer Marketing
     I                                        1   1 ZA0001
      * Message data for 'No further details exist'
      * Further Customer Details
     I                                        1   1 ZA0002
      * Message data for 'No additional details'
      * Additional Cust Func Fld
     I                                        1   1 ZA0003
      * Message data for 'No fee details'
      * Customer Fees Func Fld
     I                                        1   1 ZA0004
      * Message data for 'Not a ST customer'
      * Choose Securities Trading
     I                                        1   1 ZA0005
      * Message data for 'Not a FO customer'
      * Choose Futures & Options
     I                                        1   1 ZA0006
      * Message data for 'No PM details exist'
      * Portfolio Management Scr
     I                                        1   1 ZA0007
      * Message data for 'PM record has been deletd'
      * Portfolio Management Scr
     I                                        1   1 ZA0008
      * Message data for 'No PL details exist'
      * Portfolio Lending Scr
     I                                        1   1 ZA0009
      * Message data for 'No LEO Details'
      * LEO Function field
     I                                        1   1 ZA0010
      * Message data for 'TI Customer does not exis'
      * Call TI Customer Function
     I                                        1   1 ZA0011
      * Message data for 'Customer Group not found'
      * Choose Customer Marketing
     I                                        1   1 ZA0012
      * Message data for 'No further details exist'
      * Further Customer Details
     I                                        1   1 ZA0013
      * Message data for 'No additional details'
      * Additional Cust Func Fld
     I                                        1   1 ZA0014
      * Message data for 'No fee details'
      * Customer Fees Func Fld
     I                                        1   1 ZA0015
      * Message data for 'Not a ST customer'
      * Choose Securities Trading
     I                                        1   1 ZA0016
      * Message data for 'Not a FO customer'
      * Choose Futures & Options
     I                                        1   1 ZA0017
      * Message data for 'PM Rcd deleted'
      * Portfolio Management Scr
     I                                        1   1 ZA0018
      * Message data for 'No PM details exist'
      * Portfolio Management Scr
     I                                        1   1 ZA0019
      * Message data for 'PM record has been deltd'
      * Portfolio Management Scr
     I                                        1   1 ZA0020
      * Message data for 'No PL details exist'
      * Portfolio Lending Scr
     I                                        1   1 ZA0021
      * Message data for 'Leo not in Input Cycle'
      * LEO Function field
     I                                        1   1 ZA0022
      * Message data for 'Error Accessing LPHAS'
      * LEO Function field
     I                                        1   1 ZA0023
      * Message data for 'No LEO Details'
      * LEO Function field
     I                                        1   1 ZA0024
      * Message data for 'Leo not in Input Cycle'
      * LEO Function field
     I                                        1   1 ZA0025
      * Message data for 'Error Accessing LPHAS'
      * LEO Function field
     I                                        1   1 ZA0026
      * Message data for 'TI Customer Deleted'
      * Call TI Customer Function
     I                                        1   1 ZA0027
      * Message data for 'TI Customer does not exis'
      * Call TI Customer Function
     I                                        1   1 ZA0028
      * Message data for 'TI Customer Deleted'
      * Call TI Customer Function
     I                                        1   1 ZA0029
      * Message data for 'Inval value - must be Y/N'
      * Originating Branch Used
     I                                        1   1 ZA0030
      * Message data for 'Inval value - must be Y/N'
      * Originating Branch Used
     I                                        1   1 ZA0031
      * Message data for 'Inval value - must be Y/N'
      * Originating Branch Used
     I                                        1   1 ZA0032
      * Message data for 'Inval value - must be Y/N'
      * Originating Branch Used
     I                                        1   1 ZA0033
      * Message data for 'Inval value - must be Y/N'
      * Originating Branch Used
     I                                        1   1 ZA0034
      * Message data for 'Inval value - must be Y/N'
      * Originating Branch Used
     I                                        1   1 ZA0035
      * Message data for 'FX Netting Input fld  INV'
      * FX Netting Dtls Func fld
     I                                        1   1 ZA0036
      * Message data for 'Inval value - must be Y/N'
      * Originating Branch Used
     I                                        1   1 ZA0037
      * Message data for 'Inval value - must be Y/N'
      * Originating Branch Used
     I                                        1   1 ZA0038
      * Message data for 'Inval value - must be Y/N'
      * Originating Branch Used
     I                                        1   1 ZA0039
      * Message data for 'Inval value - must be Y/N'
      * Originating Branch Used
     I                                        1   1 ZA0040
      * Message data for 'Inval value - must be Y/N'
      * Originating Branch Used
     I                                        1   1 ZA0041
      * Message data for 'Inval value - must be Y/N'
      * Originating Branch Used
     I                                        1   1 ZA0042
      * Message data for 'Inval value - must be Y/N'
      * Originating Branch Used
     I                                        1   1 ZA0043
      * Message data for 'Inval value - must be YND'
      * Originating Branch Used
     I                                        1   1 ZA0044
      * Message data for 'Inval value - must be YND'
      * Originating Branch Used
     I                                        1   1 ZA0045
      * Message data for 'Inval value - must be YND'
      * Originating Branch Used
     I                                        1   1 ZA0046
      * Message data for 'Inval value - must be YND'
      * Originating Branch Used
     I                                        1   1 ZA0047
      * Message data for 'Inval value - must be YND'
      * Originating Branch Used
     I                                        1   1 ZA0048
      * Message data for 'Inval value - must be YND'
      * Originating Branch Used
     I                                        1   1 ZA0049
      * Message data for 'FX Netting Input fld  INV'
      * FX Netting Dtls Func fld
     I                                        1   1 ZA0050
      * Message data for 'Inval value - must be YND'
      * Originating Branch Used
     I                                        1   1 ZA0051
      * Message data for 'Inval value - must be YND'
      * Originating Branch Used
     I                                        1   1 ZA0052
      * Message data for 'Inval value - must be YND'
      * Originating Branch Used
     I                                        1   1 ZA0053
      * Message data for 'Inval value - must be YND'
      * Originating Branch Used
     I                                        1   1 ZA0054
      * Message data for 'Inval value - must be YND'
      * Originating Branch Used
     I                                        1   1 ZA0055
      * Message data for 'Inval value - must be YND'
      * Originating Branch Used
     I                                        1   1 ZA0056
      **Message*data*for*'TI*Cust*not*valid'***************************   140709
      **TI*Customer*Flag                                                  140709
     I**************                          1   1 ZA0057                140709
      * Message data for 'Inval value - must be YND'
      * Originating Branch Used
     I                                        1   1 ZA0058
      * Message data for 'LEO record already exists'
      * LEO Function field
     I                                        1   1 ZA0059
      * Message data for 'Additional Customer Dt EX'
      * Additional Cust Func Fld
     I                                        1   1 ZA0060
      * Message data for 'Customer Fees Detail   EX'
      * Customer Fees Func Fld
     I                                        1   1 ZA0061
      * Message data for 'PM details already exist'
      * Portfolio Management Scr
     I                                        1   1 ZA0062
      * Message data for 'PL details already exist'
      * Portfolio Lending Scr
     I                                        1   1 ZA0063
      * Message data for 'LEO record already exists'
      * LEO Function field
     I                                        1   1 ZA0064
      * Message data for 'TI Customer does not exis'
      * Call TI Customer Function
     I                                        1   1 ZA0065
      * Message data for 'Customer Group not found'
      * Choose Customer Marketing
     I                                        1   1 ZA0066
      * Message data for 'No additional details'
      * Additional Cust Func Fld
     I                                        1   1 ZA0067
      * Message data for 'No fee details'
      * Customer Fees Func Fld
     I                                        1   1 ZA0068
      * Message data for 'Not a ST customer'
      * Choose Securities Trading
     I                                        1   1 ZA0069
      * Message data for 'Not a FO customer'
      * Choose Futures & Options
     I                                        1   1 ZA0070
      * Message data for 'No PM details exist'
      * Portfolio Management Scr
     I                                        1   1 ZA0071
      * Message data for 'No PL details exist'
      * Portfolio Lending Scr
     I                                        1   1 ZA0072
      * Message data for 'Customer does not exist'
      * LEO Function field
     I                                        1   1 ZA0073
      * Message data for 'TI Customer does not exis'
      * Call TI Customer Function
     I                                        1   1 ZA0074
      * Message data for 'Database Error (ICD)'
      * Filename
     I                                        1  10 ZA0075
      * Message data for 'Institution Code mandatory for TI Customers'    126676
      * Call TI Customer Function                                         126676
     I                                        1   1 ZA0076                126676
      ** Message data for 'Customer is a parent, cann'                                        196149
      ** Call TI customer function                                                            196149
     I                                        1   1 ZA0077                                    196149
     ILDA         DS                            256                       CDL006
      ** Local data area for database error details                       CDL006
      *                                                                   CDL006
     I                                      134 183 DBLOT                 CDL006
     I                                      134 141 DBFILE                CDL006
     I                                      142 170 DBKEY                 CDL006
     I                                      171 180 DBPGM                 CDL006
     I                                      181 1830DBASE                 CDL006
     IDSSDY     E DSDSSDY                                                 CDL006
      ** Second DS for access programs, Long Date Structure               CDL006
      *                                                                   CDL006
     ISCSARD    E DSSCSARDPD                                              CDL006
      **  External data structures for Switchable Features Details        CDL006
      *                                                                   CDL006
      **********                                                                  BUG26917 BUG26917A
      **External*DS*to*check*Additional*Customer*Details*                         BUG26917 BUG26917A
     I***DSLDY**   E DSDSLDY                                                      BUG26917 BUG26917A
     I***SDACUS*   E DSSDACUSPD                                                   BUG26917 BUG26917A
      **********                                                                  BUG26917 BUG26917A
      ** Define Constants                                                                     CGL032
      *                                                                                       CGL032
     I              'SDACUDSIN'           C         SDACUD                                    CGL032
     I              'SDDCMTSIN'           C         SDDCMT                                    CSD093
     IDSFDY     E DSDSFDY                                                                   MD030956
      ** First DS for Access Programs, Short Data Structure                                 MD030956
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C                     PARM           P1PARM           RCD: Client Det
     C           P2ANCD    PARM           WP0001  1        Action Code
     C           P3PAIN    PARM           WP0002  1        Parent Indicato
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Conduct screen conversation
     C                     DO   *HIVAL
      * Start new transaction
     C                     MOVEL'Y'       W0TRN   1
      * Process current transaction
     C           W0TRN     DOWEQ'Y'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
      **********                                                                  BUG26917 BUG26917A
     C********** CER048    IFEQ 'Y'                                               BUG26917 BUG26917A
      **********                                                                  BUG26917 BUG26917A
     C**********           EXSR SRACUS                                            BUG26917 BUG26917A
     C**********           MOVE 'Y'       ACUSOK  1                               BUG26917 BUG26917A
     C********** ACUSRC    IFEQ 'N'                                               BUG26917 BUG26917A
     C********** *IN03     IFEQ *ON                                               BUG26917 BUG26917A
     C********** *IN12     OREQ *ON                                               BUG26917 BUG26917A
     C********** P2ANCD    IFNE 'E'                                               BUG26917 BUG26917A
     C**********           MOVE 'N'       ACUSOK                                  BUG26917 BUG26917A
     C**********           MOVE 'Y'       #DACFF                                  BUG26917 BUG26917A
     C**********           MOVEL'USR4824' ZAMSID                                  BUG26917 BUG26917A
     C**********           EXSR ZASNMS                                            BUG26917 BUG26917A
     C**********           ENDIF                                                  BUG26917 BUG26917A
     C**********           ENDIF                                                  BUG26917 BUG26917A
     C**********           ENDIF                                                  BUG26917 BUG26917A
      **********                                                                  BUG26917 BUG26917A
     C********** ACUSOK    IFEQ 'Y'                                               BUG26917 BUG26917A
      **********                                                                  BUG26917 BUG26917A
     C**********           SELEC                                                  BUG26917 BUG26917A
     C********** *IN03     WHEQ *ON                                               BUG26917 BUG26917A
     C**********           EXSR ZXEXPG                                            BUG26917 BUG26917A
     C********** *IN05     WHEQ *ON                                               BUG26917 BUG26917A
     C**********           EXSR MALDSC                                            BUG26917 BUG26917A
     C**********           OTHER                                                  BUG26917 BUG26917A
     C********** PDTAIN    IFEQ 'Y'                                               BUG26917 BUG26917A
     C********** #DACFF    ANDEQ'N'                                               BUG26917 BUG26917A
     C********** ACUSRC    ANDEQ'N'                                               BUG26917 BUG26917A
     C********** P2ANCD    ANDNE'E'                                               BUG26917 BUG26917A
     C**********           MOVE 'Y'       #DACFF                                  BUG26917 BUG26917A
     C**********           MOVEL'USR4824' ZAMSID                                  BUG26917 BUG26917A
     C**********           EXSR ZASNMS                                            BUG26917 BUG26917A
     C**********           ELSE                                                   BUG26917 BUG26917A
     C**********           EXSR DAPRSC                                            BUG26917 BUG26917A
     C**********           ENDIF                                                  BUG26917 BUG26917A
     C**********           ENDSL                                                  BUG26917 BUG26917A
      **********                                                                  BUG26917 BUG26917A
     C**********           ENDIF                                                  BUG26917 BUG26917A
      **********                                                                  BUG26917 BUG26917A
     C**********           ELSE                                                   BUG26917 BUG26917A
      **********                                                                  BUG26917 BUG26917A
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   05                CAS            MALDSC
      * Process screen input
     C                     CAS            DAPRSC
     C                     END
     C/COPY WNCPYSRC,SD0014VC30
      *
     C**********           ENDIF                                                  BUG26917 BUG26917A
      **********                                                                  BUG26917 BUG26917A
     C                     END
      *
     C                     END
      *****************************************************************
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE HELP25    *IN25
      * Enable PUTOVR
     C                     SETON                     86
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C/COPY WNCPYSRC,SD0014VC31
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDDTL1
     C/COPY WNCPYSRC,SD0014VC32
      * Test cursor
     C                     EXSR Y8TST
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C/COPY WNCPYSRC,SD0014VC33
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
     C/COPY WNCPYSRC,SD0014VC34
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPRSC    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * USER: Process command keys
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy member SD0014VPCK - Client Details  *
     C*00/Copy member SD0014V   Process Command Keys
     C/COPY WNCPYSRC,SD0014VPCK
     C                     END                             *FI
      * Start of Fix S01267
      * CASE: DTL.*CMD key is CF12
     C           *IN12     IFEQ '1'                        *IF
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * End of Fix S01267
      * Validate screen input
     C                     EXSR DBVLSC
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * USER: User defined action
      * Start of change S01467.
     C                     MOVEL'N'       WUF8OS           F8 Option Selec
      * End of change S01467.
      * Start of change 076220
      * Enquiry mode
      * CASE: PAR.Action Code is Enquire
     C           P2ANCD    IFEQ 'E'                        *IF
      * Customer marketing.
      * CASE: DTL.Choose Customer Marketing is Yes
     C           #DCHCM    IFEQ 'Y'                        *IF
      * Retrieve Client Marketing - Customer Marketing Groups  *
     C                     EXSR SARVGN
      * Check return code.
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
      * Setup message data for message
     C                     MOVEL#DCHCM    ZA0001           Choose Customer
      * Send message 'Customer Group not found'
     C                     MOVEL'USR1558' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Display Cust Marketing - Customer Marketing Groups  *
     C                     CLEARPARC
     C                     MOVEL#1CUST    PACUST           Customer Number
      *
     C                     CALL 'SD1421E'              90  Display Cust Ma
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Customer M
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD1421E' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
     C                     MOVEL'USR0790' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: PGM.*Return code is *Previous Screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #DCHCM           Choose Customer
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *                                                                                       CRN001
      * Regulatory Reporting detail                                                           CRN001
     C           #DRGRP    IFEQ 'Y'                                                           CRN001
     C                     EXSR TXRVGN                                                        CRN001
     C                     ENDIF                                                              CRN001
      *                                                                                       CRN001
      * Further Customer Details
      * CASE: DTL.Further Customer Details is Yes
     C           #DFCUS    IFEQ 'Y'                        *IF
      * Further client details - Client Details  *
     C                     CALL 'SD0012X'              90  Further client
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1CUST    WQ0001  6        Customer Number
     C                     PARM 'E'       WQ0002  1        Action Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0012X' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check return code.
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
     C                     MOVEL'USR0790' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: PGM.*Return code is *Previous Screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: PGM.*Return code is Access Obj:No Rec Found
     C           W0RTN     IFEQ '*NRF'                     *IF
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
      * Setup message data for message
     C                     MOVEL#DFCUS    ZA0002           Further Custome
      * Send message 'No further details exist'
     C                     MOVEL'USR2363' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #DFCUS           Further Custome
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Additional customer details
      * CASE: DTL.Additional Cust Func Fld is Yes
     C           #DACFF    IFEQ 'Y'                        *IF
      * Check existance of Cust - Additional Customer Dtls  *
     C                     EXSR SBRVGN
      * Check return code.
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
      * Setup message data for message
     C                     MOVEL#DACFF    ZA0003           Additional Cust
      * Send message 'No additional details'
     C                     MOVEL'USR1965' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Display Add Customer Dtls - Additional Customer Dtls  *
     C                     CLEARPBRC
     C                     MOVEL#1CUST    PBCUST           Customer Number
      *
      ** If CGL032 is ON, call SDACUDSIN else call the old program                            CGL032
      *                                                                                       CGL032
     C                     MOVEL*BLANK    W0RTN                                               CGL032
     C           CGL032    IFEQ 'Y'                                                           CGL032
     C           CSW207    OREQ 'Y'                                                         BUG14672
     C                     CALL SDACUD                 90                                     CGL032
     C                     PARM           PBRC                                                CGL032
     C                     PARM 'E'       WACTN   1                                           CGL032
     C                     ELSE                                                               CGL032
     C                     CALL 'SD0041E'              90  Display Add Cus
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Additional
     C                     ENDIF                                                              CGL032
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0041E' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check return code.
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
     C                     MOVEL'USR0790' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: PGM.*Return code is *Previous Screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #DACFF           Additional Cust
      **********                                                                  BUG26917 BUG26917A
     C********** CER048    IFEQ 'Y'                                               BUG26917 BUG26917A
     C********** PDTAIN    ANDEQ'Y'                                               BUG26917 BUG26917A
     C********** P2ANCD    ANDNE'E'                                               BUG26917 BUG26917A
     C**********           MOVE 'Y'       #DACFF                                  BUG26917 BUG26917A
     C**********           ENDIF                                                  BUG26917 BUG26917A
      **********                                                                  BUG26917 BUG26917A
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Customer Fees
      * CASE: DTL.Customer Fees Func Fld is Yes
     C           #DCFFF    IFEQ 'Y'                        *IF
      * Check cusromer fees exist - Customer Fees Detail  *
     C                     EXSR SCRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
      * Setup message data for message
     C                     MOVEL#DCFFF    ZA0004           Customer Fees F
      * Send message 'No fee details'
     C                     MOVEL'USR1998' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9934  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Display Customer Fees - Customer Fees Detail  *
     C                     CLEARPCRC
     C                     MOVEL#1CUST    PCCUST           Customer Number
      *
     C                     CALL 'SD0361E'              90  Display Custome
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             KEY: Customer F
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0361E' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
     C                     MOVEL'USR0790' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: PGM.*Return code is *Previous Screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #DCFFF           Customer Fees F
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Cheques and cards.
      * CASE: DTL.Choose Cheques and Cards is Yes
     C           #DCHCH    IFEQ 'Y'                        *IF
      * Display Cheques and Cards - Client Details  *
     C                     CLEARPDRC
     C                     MOVEL#1CUST    PDCUST           Customer Number
      *
     C                     CALL 'SD0241E'              90  Display Cheques
     C           W0RTN     PARM W0RTN     WQ0003  7        *Return code
     C                     PARM           PDRC             KEY: Client Det
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0241E' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
     C                     MOVEL'USR0790' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: PGM.*Return code is *Previous Screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #DCHCH           Choose Cheques
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Customer Safes.
      * CASE: DTL.Choose Customer Safes is Yes
     C           #DCHSA    IFEQ 'Y'                        *IF
      * Display Customer Safes - Client Details  *
     C                     CLEARPERC
     C                     MOVEL#1CUST    PECUST           Customer Number
      *
     C                     CALL 'SD0291E'              90  Display Custome
     C           W0RTN     PARM W0RTN     WQ0004  7        *Return code
     C                     PARM           PERC             KEY: Client Det
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0291E' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
     C                     MOVEL'USR0790' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: PGM.*Return code is *Previous Screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #DCHSA           Choose Customer
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Start CDL002
      * FX Netting.
      * CASE: DTL.FX Netting Dtls Func fld is Yes
     C           #DFXND    IFEQ 'Y'                        *IF
      * FX Netting Enquiry - Client Details  *
     C                     CALL 'SD0015E'              90  FX Netting Enqu
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1CUST    WQ0005  6        Customer Number
     C                     PARM P2ANCD    WQ0006  1        Action Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0015E' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
     C                     MOVEL'USR0790' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: PGM.*Return code is *Previous Screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #DFXND           FX Netting Dtls
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * End CDL002
      *                                                                   CDL006
      ** If Fiduciary Details field is 'Y'                                CDL006
      *                                                                   CDL006
     C           SFIDET    IFEQ 'Y'                                       CDL006
      *                                                                   CDL006
     C                     CALL 'SD1510'               90                 CDL006
     C                     PARM *BLANK    W0RTN                           CDL006
     C                     PARM #1CUST    WQ0005                          CDL006
     C                     PARM P2ANCD    WQ0006                          CDL006
      *                                                                   CDL006
     C           *IN90     IFEQ '1'                                       CDL006
      *                                                                   CDL006
      ** Call to program ended in error                                   CDL006
      *                                                                   CDL006
     C                     MOVEL'Y2U0032' W0RTN                           CDL006
     C                     MOVEL*BLANKS   W0CLPG                          CDL006
     C                     MOVEL'SD1510'  W0CLPG                          CDL006
      *                                                                   CDL006
      ** Send message '*Error occurred on CALL...'                        CDL006
      *                                                                   CDL006
     C                     MOVEL'Y2U0032' ZAMSID                          CDL006
     C                     MOVEL'Y2USRMSG'ZAMSGF                          CDL006
     C                     MOVELW0CLPG    ZAMSDA                          CDL006
     C                     EXSR ZASNMS                                    CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
      ** If an error was detected                                         CDL006
      *                                                                   CDL006
     C           W0RTN     IFNE *BLANK                                    CDL006
     C                     MOVE '1'       *IN99                           CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
      ** If F3 was pressed                                                CDL006
      *                                                                   CDL006
     C           W0RTN     IFEQ 'Y2U9999'                                 CDL006
     C                     MOVEL'USR0790' P0RTN                           CDL006
     C                     EXSR ZYEXPG                                    CDL006
     C                     ELSE                                           CDL006
      *                                                                   CDL006
      ** If F12 was pressed                                               CDL006
      *                                                                   CDL006
     C           W0RTN     IFEQ 'USR0790'                                 CDL006
     C                     MOVEL'Y'       W0DCF                           CDL006
     C                     GOTO DAEXIT                                    CDL006
     C                     ELSE                                           CDL006
      *                                                                   CDL006
     C                     MOVEL'N'       SFIDET                          CDL006
     C                     MOVEL'Y'       WUF8OS                          CDL006
     C                     ENDIF                                          CDL006
     C                     ENDIF                                          CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CGL018
      ** If Risk Weighted Assets code is 'Y'                              CGL018
      *                                                                   CGL018
     C           SWRWAC    IFEQ 'Y'                                       CGL018
      *                                                                   CGL018
     C                     CALL 'SD001242'             90                 CGL018
     C                     PARM *BLANK    W0RTN                           CGL018
     C                     PARM #1CUST    WQ0005                          CGL018
     C                     PARM P2ANCD    WQ0006                          215916
     C                     PARM           P1CSSN                                             BUG5139
     C                     PARM           P1CRNM                                             BUG5139
     C                     PARM           P1CRTN                                             BUG5139
      *                                                                   CGL018
     C           *IN90     IFEQ '1'                                       CGL018
      *                                                                   CGL018
      ** Call to program ended in error.                                  CGL018
      *                                                                   CGL018
     C                     MOVEL'Y2U0032' W0RTN                           CGL018
     C                     MOVEL*BLANKS   W0CLPG                          CGL018
     C                     MOVEL'SD001242'W0CLPG                          CGL018
      *                                                                   CGL018
      ** Send message '*Error occurred on CALL...'.                       CGL018
      *                                                                   CGL018
     C                     MOVEL'Y2U0032' ZAMSID                          CGL018
     C                     MOVEL'Y2USRMSG'ZAMSGF                          CGL018
     C                     MOVELW0CLPG    ZAMSDA                          CGL018
     C                     EXSR ZASNMS                                    CGL018
     C                     ENDIF                                          CGL018
      *                                                                   CGL018
      ** If an error was detected                                         CGL018
      *                                                                   CGL018
     C           W0RTN     IFNE *BLANK                                    CGL018
     C                     MOVE '1'       *IN99                           CGL018
     C                     ENDIF                                          CGL018
      *                                                                   CGL018
     C                     SELEC                                          CGL018
      *                                                                   CGL018
      ** If F3 was pressed                                                CGL018
      *                                                                   CGL018
     C           W0RTN     WHEQ 'Y2U9999'                                 CGL018
     C                     MOVEL'USR0790' P0RTN                           CGL018
     C                     EXSR ZYEXPG                                    CGL018
      *                                                                   CGL018
      ** If F12 was pressed                                               CGL018
      *                                                                   CGL018
     C           W0RTN     WHEQ 'USR0790'                                 CGL018
     C                     MOVEL'Y'       W0DCF                           CGL018
     C                     GOTO DAEXIT                                    CGL018
      *                                                                   CGL018
     C                     ENDSL                                          CGL018
      *                                                                   CGL018
     C                     MOVEL'N'       SWRWAC                          CGL018
     C                     MOVEL'Y'       WUF8OS                          CGL018
      *                                                                   CGL018
     C                     ENDIF                                          CGL018
      *                                                                   CGL018
      *                                                                   CSE023
      ** If Withholding tax field is 'Y'.                                 CSE023
      *                                                                   CSE023
     C           SWITAX    IFEQ 'Y'                                       CSE023
      *                                                                   CSE023
     C                     CALL 'SD0372R'              90                 CSE023
     C                     PARM *BLANK    W0RTN                           CSE023
     C                     PARM #1CUST    WQ0005                          CSE023
     C                     PARM P2ANCD    WQ0006                          CSE023
      *                                                                   CSE023
     C           *IN90     IFEQ '1'                                       CSE023
      *                                                                   CSE023
      ** Call to program ended in error.                                  CSE023
      *                                                                   CSE023
     C                     MOVEL'Y2U0032' W0RTN                           CSE023
     C                     MOVEL*BLANKS   W0CLPG                          CSE023
     C                     MOVEL'SD0372R' W0CLPG                          CSE023
      *                                                                   CSE023
      ** Send message '*Error occurred on CALL...'.                       CSE023
      *                                                                   CSE023
     C                     MOVEL'Y2U0032' ZAMSID                          CSE023
     C                     MOVEL'Y2USRMSG'ZAMSGF                          CSE023
     C                     MOVELW0CLPG    ZAMSDA                          CSE023
     C                     EXSR ZASNMS                                    CSE023
     C                     ENDIF                                          CSE023
      *                                                                   CSE023
      ** If an error was detected                                         CSE023
      *                                                                   CSE023
     C           W0RTN     IFNE *BLANK                                    CSE023
     C                     MOVE '1'       *IN99                           CSE023
     C                     ENDIF                                          CSE023
      *                                                                   CSE023
     C                     SELEC                                          CSE023
      *                                                                   CSE023
      ** Customer not classified as safe custody or discretionary.        CSE023
      *                                                                   CSE023
     C           W0RTN     WHEQ '*CSNERR'                                 CSE023
     C                     MOVEL'USR7500' ZAMSID                          CSE023
     C                     MOVEL'SDUSRMSG'ZAMSGF                          CSE023
     C                     MOVELW0CLPG    ZAMSDA                          CSE023
     C                     EXSR ZASNMS                                    CSE023
     C                     MOVE '1'       *IN46                           CSE023
      *                                                                   CSE023
      ** No withholding tax record exist.                                 CSE023
      *                                                                   CSE023
     C           W0RTN     WHEQ '*NRF   '                                 CSE023
     C                     MOVEL'USR7501' ZAMSID                          CSE023
     C                     MOVEL'SDUSRMSG'ZAMSGF                          CSE023
     C                     MOVELW0CLPG    ZAMSDA                          CSE023
     C                     EXSR ZASNMS                                    CSE023
     C                     MOVE '1'       *IN46                           CSE023
      *                                                                   CSE023
      ** If F3 was pressed                                                CSE023
      *                                                                   CSE023
     C           W0RTN     WHEQ 'Y2U9999'                                 CSE023
     C                     MOVEL'USR0790' P0RTN                           CSE023
     C                     EXSR ZYEXPG                                    CSE023
      *                                                                   CSE023
      ** If F12 was pressed                                               CSE023
      *                                                                   CSE023
     C           W0RTN     WHEQ 'USR0790'                                 CSE023
     C                     MOVEL'Y'       W0DCF                           CSE023
     C                     GOTO DAEXIT                                    CSE023
      *                                                                   CSE023
     C                     ENDSL                                          CSE023
      *                                                                   CSE023
     C                     MOVEL'N'       SWITAX                          CSE023
     C                     MOVEL'Y'       WUF8OS                          CSE023
      *                                                                   CSE023
     C                     ENDIF                                          CSE023
      *                                                                   CSE023
      ** If Document Management field is 'Y'.                                                 CSD093
      *                                                                                       CSD093
     C           #DDCMT    IFEQ 'Y'                                                           CSD093
     C                     CALL SDDCMT                 90                                     CSD093
     C                     PARM *BLANK    W0RTN                                               CSD093
     C                     PARM P2ANCD    PINMOD  1                                           CSD093
     C                     PARM P1CUST    PINCUS 10                                           CSD093
     C                     PARM 'C'       PINTYP  1                                           CSD093
      *                                                                                       CSD093
     C           *IN90     IFEQ '1'                                                           CSD093
      *                                                                                       CSD093
      ** Call to program ended in error.                                                      CSD093
      *                                                                                       CSD093
     C                     MOVEL'Y2U0032' W0RTN                                               CSD093
     C                     MOVEL*BLANKS   W0CLPG                                              CSD093
     C                     MOVEL'DCMTPGM' W0CLPG                                              CSD093
      *                                                                                       CSD093
      ** Send message '*Error occurred on CALL...'.                                           CSD093
      *                                                                                       CSD093
     C                     MOVEL'Y2U0032' ZAMSID                                              CSD093
     C                     MOVEL'Y2USRMSG'ZAMSGF                                              CSD093
     C                     MOVELW0CLPG    ZAMSDA                                              CSD093
     C                     EXSR ZASNMS                                                        CSD093
     C                     ENDIF                                                              CSD093
      *                                                                                       CSD093
      ** If an error was detected                                                             CSD093
      *                                                                                       CSD093
     C           W0RTN     IFNE *BLANK                                                        CSD093
     C                     MOVE '1'       *IN99                                               CSD093
     C                     ENDIF                                                              CSD093
      *                                                                                       CSD093
     C                     MOVEL'N'       #DDCMT                                              CSD093
     C                     MOVEL'Y'       WUF8OS                                              CSD093
      *                                                                                       CSD093
     C                     ENDIF                                                              CSD093
      * 00/Copy member SD0014VC11 - Client Details  *
     C/COPY WNCPYSRC,SD0014VC11                                           S01212
      * Securities trading.
      * CASE: DTL.Choose Securities Trading is Yes
     C           #DCHST    IFEQ 'Y'                        *IF
      * Check if ST client - Securities Clients  *
     C                     EXSR SDRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
      * Setup message data for message
     C                     MOVEL#DCHST    ZA0005           Choose Securiti
      * Send message 'Not a ST customer'
     C                     MOVEL'USR0319' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9938  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Display ST clients - Securities Clients  *
     C                     CLEARPFRC
     C                     MOVEL#1CUST    PFCUST           Customer Number
      *
     C                     CALL 'SD0341E'              90  Display ST clie
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PFRC             KEY: Securities
     C                     PARM WUCFAO    WQ0007  1        call futures &
     C                     PARM 'S'       WQ0008  1        mode
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0341E' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
     C                     MOVEL'USR0790' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: PGM.*Return code is *Previous Screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #DCHST           Choose Securiti
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Futures and options.
      * CASE: DTL.Choose Futures & Options is Yes
     C           #DCHFO    IFEQ 'Y'                        *IF
      * Check if F&O Customer - Futures & Options Clients  *
     C                     EXSR SERVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
      * Setup message data for message
     C                     MOVEL#DCHFO    ZA0006           Choose Futures
      * Send message 'Not a FO customer'
     C                     MOVEL'USR0320' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Display FO Clients - Futures & Options Clients  *
     C                     CLEARPGRC
     C                     MOVEL#1CUST    PGCUST           Customer Number
      *
     C                     CALL 'SD0331E'              90  Display FO Clie
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PGRC             KEY: Futures &
     C                     PARM 'S'       WQ0009  1        mode
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0331E' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
     C                     MOVEL'USR0790' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: PGM.*Return code is *Previous Screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #DCHFO           Choose Futures
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 00/Copy member SD0014VCP1 - Client Details  *
     C/COPY WNCPYSRC,SD0014VCP1                                           S01212
      * Portfolio Management
      * CASE: DTL.Portfolio Management Scr is Yes
     C           #DPMSC    IFEQ 'Y'                        *IF
      * Check for Non Deleted PM - Portfolio Manag Cust Dtls  *
     C                     EXSR SFRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
      * Setup message data for message
     C                     MOVEL#DPMSC    ZA0007           Portfolio Manag
      * Send message 'No PM details exist'
     C                     MOVEL'USR2359' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9940  *
      *
     C                     ELSE
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ 'Y2U0003'                  *IF
      * Disp Portfolio Management - Portfolio Manag Cust Dtls  *
     C                     CLEARPHRC
     C                     MOVEL#1CUST    PHCUST           Customer Number
      *
     C                     CALL 'SD0391E'              90  Disp Portfolio
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PHRC             KEY: Portfolio
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0391E' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check return code
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
     C                     MOVEL'USR0790' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: PGM.*Return code is *Previous Screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #DPMSC           Portfolio Manag
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
      * Setup message data for message
     C                     MOVEL#DPMSC    ZA0008           Portfolio Manag
      * Send message 'PM record has been deletd'
     C                     MOVEL'USR2557' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9940  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Portfolio Lending
      * CASE: DTL.Portfolio Lending Scr is Yes
     C           #DPLSC    IFEQ 'Y'                        *IF
      * Does Portfilio/L exist? - Portfolio Lend Cust Dtls  *
     C                     EXSR SGRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
      * Setup message data for message
     C                     MOVEL#DPLSC    ZA0009           Portfolio Lendi
      * Send message 'No PL details exist'
     C                     MOVEL'USR2360' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9941  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Disp Portfolio Lending - Portfolio Lend Cust Dtls  *
     C                     CLEARPIRC
     C                     MOVEL#1CUST    PICUST           Customer Number
      *
     C                     CALL 'SD0411E'              90  Disp Portfolio
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PIRC             KEY: Portfolio
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0411E' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
     C                     MOVEL'USR0790' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: PGM.*Return code is *Previous Screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #DPLSC           Portfolio Lendi
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Leo details
      * CASE: DTL.LEO Function field is Yes
     C           #DLEOF    IFEQ 'Y'                        *IF
      * Check Leo phase of day.
      * Check Leo Phase of Day - Standard Functions  *
     C                     CALL 'SCC1111'              90  Check Leo Phase
     C           WULPHS    PARM *BLANK    WQ0010  1        LPHAS Value fro
     C                     PARM *BLANK    WQ0011  1        LSTATUS Update
     C           WUAPRC    PARM *BLANK    WQ0012  7        Access Pgm Retu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SCC1111' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Check return code.
      * CASE: WRK.Access Pgm Return Code is *Normal
     C           WUAPRC    IFEQ *BLANK                     *IF
      * If Leo is in input cycle then allow enqy, else refuse.
      * CASE: WRK.LPHAS Value from Leo is Leo Input Cycle
     C           WULPHS    IFEQ 'I'                        *IF
      * Send message to LSTATUS.
      * Check Leo Phase of Day - Standard Functions  *
     C                     CALL 'SCC1111'              90  Check Leo Phase
     C           WULPHS    PARM *BLANK    WQ0013  1        LPHAS Value fro
     C                     PARM 'A'       WQ0014  1        LSTATUS Update
     C           WUAPRC    PARM *BLANK    WQ0015  7        Access Pgm Retu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SCC1111' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Check existence of Cust. - Customer LEO Details  *
     C                     EXSR SHRVGN
      * Check return code.
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
      * Setup message data for message
     C                     MOVEL#DLEOF    ZA0010           LEO Function fi
      * Send message 'No LEO Details'
     C                     MOVEL'USR2303' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9942  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Display LEO Details - Customer LEO Details  *
     C                     CALL 'SD1111E'              90  Display LEO Det
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1CUST    WQ0016  6        Customer Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD1111E' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check return code
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
     C                     MOVEL'USR0790' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: PGM.*Return code is *Previous Screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Start of change CTI001
      * TI details
      * CASE: DTL.Call TI Customer Function is Yes
     C           #DTICF    IFEQ 'Y'                        *IF
      * Check for TI customer ref - Trade Innov Cust Details  *
     C                     EXSR SIRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
      * Setup message data for message
     C                     MOVEL#DTICF    ZA0011           Call TI Custome
      * Send message 'TI Customer does not exis'
     C                     MOVEL'USR3535' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9944  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Display TI Customers - Trade Innov Cust Details  *
     C                     CALL 'SD0371E'              90  Display TI Cust
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1CUST    WQ0017  6        Customer Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0371E' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
     C                     MOVEL'USR0790' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: PGM.*Return code is *Previous Screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C**********           MOVEL'N'       #DTICF           Call TI Custome                   BUG2664
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * End of change CTI001
      * Start of S01522
      * UDC details
      * CASE: DTL.UDC Function field is Yes
     C           #DUDCF    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    WURTCD           Return Code wor
      * Call the UDC CL PGM - Client Details  *
     C                     CALL 'CGC0023'              90  Call the UDC CL
     C           WURTCD    PARM WURTCD    WQ0018  7        Return Code wor
     C                     PARM 'E'       WQ0019  1        Action Code
     C                     PARM P1CUST    WQ0020  6        Customer Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CGC0023' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * CASE: WRK.Return Code work field is USER QUIT REQUESTED
     C           WURTCD    IFEQ 'Y2U9999'                  *IF
     C                     MOVEL'USR0790' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: WRK.Return Code work field is Previous screen
     C           WURTCD    IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #DUDCF           UDC Function fi
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *                                                                                       CSD028
      ** If KYC Item is 'Y'                                                                   CSD028
      *                                                                                       CSD028
     C           #KYCIT    IFEQ 'Y'                                                           CSD028
     C           CSD028    ANDEQ'Y'                                                           CSD028
      *                                                                                       CSD028
     C                     MOVELP2ANCD    WUANCD                                              CSD028
      *                                                                                       CSD028
     C                     CLEARPORC                                                          CSD028
     C                     MOVEL#1CUST    P0CUST  6                                           CSD028
      *                                                                                       CSD028
     C                     CALL 'SD000050'             90                                     CSD028
     C                     PARM           P0CUST                                              CSD028
      *                                                                                       CSD028
     C           *IN90     IFEQ *ON                                                           CSD028
      *                                                                                       CSD028
      ** Call to program ended in error.                                                      CSD028
      *                                                                                       CSD028
     C                     MOVEL'Y2U0032' W0RTN                                               CSD028
     C                     MOVEL*BLANKS   W0CLPG                                              CSD028
     C                     MOVEL'SD0372R' W0CLPG                                              CSD028
      *                                                                                       CSD028
      ** Send message '*Error occurred on CALL...'.                                           CSD028
      *                                                                                       CSD028
     C                     MOVEL'USR6010' ZAMSID                                              CSD028
     C                     MOVEL'SDUSRMSG'ZAMSGF                                              CSD028
     C                     EXSR ZASNMS                                                        CSD028
     C                     ENDIF                                                              CSD028
      *                                                                                       CSD028
      ** If an error was detected                                                             CSD028
      *                                                                                       CSD028
     C           W0RTN     IFNE *BLANK                                                        CSD028
     C                     MOVE *ON       *IN99                                               CSD028
     C                     ENDIF                                                              CSD028
      *                                                                                       CSD028
     C                     MOVEL'N'       #KYCIT                                              CSD028
      *                                                                                       CSD028
     C                     ENDIF                                                              CSD028
      * End of S01522
     C                     END                             *FI
      * Maintenance mode
      * CASE: PAR.Action Code is Maintenance mode
     C           P2ANCD    IFEQ 'A'                        *IF
     C           P2ANCD    OREQ 'D'
     C           P2ANCD    OREQ 'I'
      * Start of Fix S01267
      * Customer marketing
      * CASE: DTL.Choose Customer Marketing is Yes
     C           #DCHCM    IFEQ 'Y'                        *IF
      * Edit Cust Marketing Group - Customer Marketing Groups  *
     C                     CLEARPJRC
     C                     MOVEL#1CUST    PJCUST           Customer Number
      *
     C                     CALL 'SD1421R'              90  Edit Cust Marke
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PJRC             KEY: Customer M
     C                     PARM P2ANCD    WQ0021  1        Action Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD1421R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check return code.
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
      * Delete processing.
      * CASE: PAR.Action Code is Delete
     C           P2ANCD    IFEQ 'D'                        *IF
      * Retrieve Client Marketing - Customer Marketing Groups  *
     C                     EXSR SJRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C***********          MOVEL*BLANK    P0RTN            *Return code   153812
     C                     MOVEL'USR0790' P0RTN            *Return code   153812
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     ELSE
      * CASE: PGM.*Return code is *Previous Screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #DCHCM           Choose Customer
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Delete processing.
      * CASE: DTL.Choose Customer Marketing is Delete
     C           #DCHCM    IFEQ 'D'                        *IF
      * Retrieve Client Marketing - Customer Marketing Groups  *
     C                     EXSR SKRVGN
      * Check return code.
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#DCHCM    ZA0012           Choose Customer
      * Send message 'Customer Group not found'
     C                     MOVEL'USR1558' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'D'       WUDELM           Delete Mode
      * Edit Cust Marketing Group - Customer Marketing Groups  *
     C                     CLEARPJRC
     C                     MOVEL#1CUST    PJCUST           Customer Number
      *
     C                     CALL 'SD1421R'              90  Edit Cust Marke
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PJRC             KEY: Customer M
     C                     PARM WUDELM    WQ0022  1        Action Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD1421R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check return code.
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: PGM.*Return code is *Previous Screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #DCHCM           Choose Customer
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
     C                     END                             *FI
     C                     END                             *FI
      *                                                                                       CRN001
      * Regulatory Reporting detail                                                           CRN001
     C           #DRGRP    IFEQ 'Y'                                                           CRN001
     C           #DRGRP    OREQ 'D'                                                           CRN001
     C                     EXSR TXRVGN                                                        CRN001
     C                     ENDIF                                                              CRN001
      *                                                                                       CRN001
      * End of Fix S01267
      * Start of change S01497.
      * Further Customer Details.
      * CASE: DTL.Further Customer Details is Yes
     C           #DFCUS    IFEQ 'Y'                        *IF
      * Further client details - Client Details  *
     C                     CALL 'SD0012X'              90  Further client
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1CUST    WQ0023  6        Customer Number
     C                     PARM P2ANCD    WQ0024  1        Action Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0012X' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check return code.
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
      * Delete processing.
      * CASE: PAR.Action Code is Delete
     C           P2ANCD    IFEQ 'D'                        *IF
      * Further client details - Client Details  *
     C                     CALL 'SD0012X'              90  Further client
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1CUST    WQ0025  6        Customer Number
     C                     PARM 'E'       WQ0026  1        Action Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0012X' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Access Obj:No Rec Found
     C           W0RTN     IFEQ '*NRF'                     *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     ELSE
      * CASE: PGM.*Return code is *Previous Screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #DFCUS           Further Custome
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Delete processing.
      * CASE: DTL.Further Customer Details is Delete
     C           #DFCUS    IFEQ 'D'                        *IF
      * Further client details - Client Details  *
     C                     CALL 'SD0012X'              90  Further client
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1CUST    WQ0027  6        Customer Number
     C                     PARM 'D'       WQ0028  1        Action Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0012X' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check return code.
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: PGM.*Return code is *Previous Screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: PGM.*Return code is Access Obj:No Rec Found
     C           W0RTN     IFEQ '*NRF'                     *IF
      * Setup message data for message
     C                     MOVEL#DFCUS    ZA0013           Further Custome
      * Send message 'No further details exist'
     C                     MOVEL'USR2363' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #DFCUS           Further Custome
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
     C                     END                             *FI
     C                     END                             *FI
      * End of change S01497.
      * Start of S01421
      * Additional Customer Details
      * CASE: DTL.Additional Cust Func Fld is Yes
     C           #DACFF    IFEQ 'Y'                        *IF
      * Edit Additional Cust Dtls - Additional Customer Dtls  *
     C                     CLEARPKRC
     C                     MOVEL#1CUST    PKCUST           Customer Number
      *
      ** If CGL032 is ON, call SDACUDSIN else call the old program                            CGL032
      *                                                                                       CGL032
     C                     MOVEL*BLANK    W0RTN                                               CGL032
      *                                                                                       CGL032
     C           CGL032    IFEQ 'Y'                                                           CGL032
     C           CSW207    OREQ 'Y'                                                         BUG14672
      *                                                                                       CGL032
     C                     EXSR SBRVGN                                                        CGL032
     C           W0RTN     IFEQ 'Y2U0005'                                                     CGL032
     C           P2ANCD    ANDEQ'A'                                                           CGL032
     C                     MOVEL'I'       WACTN                                               CGL032
     C                     ELSE                                                               CGL032
     C                     MOVELP2ANCD    WACTN                                               CGL032
     C                     ENDIF                                                              CGL032
     C                     MOVEL*BLANK    W0RTN                                               CGL032
      *                                                                                       CGL032
     C                     CALL SDACUD                 90                                     CGL032
     C                     PARM           PKRC                                                CGL032
     C                     PARM           WACTN                                               CGL032
      *                                                                                       CGL032
     C                     ELSE                                                               CGL032
     C                     CALL 'SD0041R'              90  Edit Additional
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PKRC             KEY: Additional
     C                     PARM P2ANCD    WQ0029  1        Action Code
     C                     PARM           P1CRNM                                             BUG5139
     C                     PARM           P1CRTN                                             BUG5139
     C                     PARM           P1BRCD                                             BUG5139
     C                     PARM           P1CRPC                                             BUG5139
     C                     PARM           P1LICD                                             BUG5139
     C                     ENDIF                                                              CGL032
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0041R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check return code.
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
      * Delete processing.
      * CASE: PAR.Action Code is Delete
     C           P2ANCD    IFEQ 'D'                        *IF
      * Check existance of Cust - Additional Customer Dtls  *
     C                     EXSR SLRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C***********          MOVEL*BLANK    P0RTN            *Return code   153812
     C                     MOVEL'USR0790' P0RTN            *Return code   153812
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     ELSE
      * CASE: PGM.*Return code is *Previous Screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #DACFF           Additional Cust
      **********                                                                  BUG26917 BUG26917A
     C********** CER048    IFEQ 'Y'                                               BUG26917 BUG26917A
     C********** PDTAIN    ANDEQ'Y'                                               BUG26917 BUG26917A
     C********** P2ANCD    ANDNE'E'                                               BUG26917 BUG26917A
     C**********           MOVE 'Y'       #DACFF                                  BUG26917 BUG26917A
     C**********           ENDIF                                                  BUG26917 BUG26917A
      **********                                                                  BUG26917 BUG26917A
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Delete processing.
      * CASE: DTL.Additional Cust Func Fld is Delete
     C           #DACFF    IFEQ 'D'                        *IF
      * Check existance of Cust - Additional Customer Dtls  *
     C                     EXSR SMRVGN
      * Check return code
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#DACFF    ZA0014           Additional Cust
      * Send message 'No additional details'
     C                     MOVEL'USR1965' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'D'       WUDELM           Delete Mode
      * Edit Additional Cust Dtls - Additional Customer Dtls  *
     C                     CLEARPKRC
     C                     MOVEL#1CUST    PKCUST           Customer Number
      *
      ** If CGL032 is ON, call SDACUDSIN else call the old program                            CGL032
      *                                                                                       CGL032
     C                     MOVEL*BLANK    W0RTN                                               CGL032
     C           CGL032    IFEQ 'Y'                                                           CGL032
     C           CSW207    OREQ 'Y'                                                         BUG14672
     C                     CALL SDACUD                 90                                     CGL032
     C                     PARM           PKRC                                                CGL032
     C                     PARM WUDELM    WACTN                                               CGL032
     C                     ELSE                                                               CGL032
     C                     CALL 'SD0041R'              90  Edit Additional
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PKRC             KEY: Additional
     C                     PARM WUDELM    WQ0030  1        Action Code
     C                     PARM           P1CRNM                                             BUG5139
     C                     PARM           P1CRTN                                             BUG5139
     C                     PARM           P1BRCD                                             BUG5139
     C                     PARM           P1CRPC                                             BUG5139
     C                     PARM           P1LICD                                             BUG5139
     C                     ENDIF                                                              CGL032
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0041R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check return code.
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: PGM.*Return code is *Previous Screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #DACFF           Additional Cust
      **********                                                                  BUG26917 BUG26917A
     C********** CER048    IFEQ 'Y'                                               BUG26917 BUG26917A
     C********** PDTAIN    ANDEQ'Y'                                               BUG26917 BUG26917A
     C********** P2ANCD    ANDNE'E'                                               BUG26917 BUG26917A
     C**********           MOVE 'Y'       #DACFF                                  BUG26917 BUG26917A
     C**********           ENDIF                                                  BUG26917 BUG26917A
      **********                                                                  BUG26917 BUG26917A
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
     C                     END                             *FI
     C                     END                             *FI
      * Customer Fees
      * CASE: DTL.Customer Fees Func Fld is Yes
     C           #DCFFF    IFEQ 'Y'                        *IF
      * 00/Copy member SD0014VC25 - Client Details  *
     C/COPY WNCPYSRC,SD0014VC25
      * Hook SD0014VC13 moved to here *                                   S01408
      * 00/Copy member SD0014VC13 - Client Details  *                     S01408
     C/COPY WNCPYSRC,SD0014VC13                                           S01408
      * Edit Customer Fees - Customer Fees Detail  *
     C                     CLEARPLRC
     C                     MOVEL#1CUST    PLCUST           Customer Number
      *
     C/COPY WNCPYSRC,SD0014VC01
     C                     CALL 'SD0361R'              90  Edit Customer F
     C/COPY WNCPYSRC,SD0014VC02
     C                     PARM *BLANK    W0RTN   7
     C/COPY WNCPYSRC,SD0014VC03
     C                     PARM           PLRC             KEY: Customer F
     C                     PARM P2ANCD    WQ0031  1        Action Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0361R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * 00/Copy member SD0014VC27 - Client Details  *
     C/COPY WNCPYSRC,SD0014VC27
      * Hook SD0014VC14 moved to here *                                   S01408
      * 00/Copy member SD0014VC14 - Client Details  *                     S01408
     C/COPY WNCPYSRC,SD0014VC14                                           S01408
      * Check return code.
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
      * Delete processing.
      * CASE: PAR.Action Code is Delete
     C           P2ANCD    IFEQ 'D'                        *IF
      * Check cusromer fees exist - Customer Fees Detail  *
     C                     EXSR SNRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     ELSE
      * CASE: PGM.*Return code is *Previous Screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #DCFFF           Customer Fees F
      * 00/Copy member SD0014VC15 - Client Details  *
     C/COPY WNCPYSRC,SD0014VC15
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Delete processing.
      * CASE: DTL.Customer Fees Func Fld is Delete
     C           #DCFFF    IFEQ 'D'                        *IF
      * Check cusromer fees exist - Customer Fees Detail  *
     C                     EXSR SORVGN
      * Check return code.
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#DCFFF    ZA0015           Customer Fees F
      * Send message 'No fee details'
     C                     MOVEL'USR1998' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9934  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'D'       WUDELM           Delete Mode
      * Edit Customer Fees - Customer Fees Detail  *
     C                     CLEARPLRC
     C                     MOVEL#1CUST    PLCUST           Customer Number
      *
     C                     CALL 'SD0361R'              90  Edit Customer F
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PLRC             KEY: Customer F
     C                     PARM WUDELM    WQ0032  1        Action Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0361R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C/COPY WNCPYSRC,SD0014VC26
      * Check return code.
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: PGM.*Return code is *Previous Screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #DCFFF           Customer Fees F
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
     C                     END                             *FI
     C                     END                             *FI
      * End of S01421
      * Start S01413
      * Cheques and Cards.
      * CASE: DTL.Choose Cheques and Cards is Yes
     C           #DCHCH    IFEQ 'Y'                        *IF
      * Edit Cheques and Cards - Client Details  *
     C                     CLEARPMRC
     C                     MOVEL#1CUST    PMCUST           Customer Number
      *
     C                     CALL 'SD0241R'              90  Edit Cheques an
     C           W0RTN     PARM W0RTN     WQ0033  7        *Return code
     C                     PARM           PMRC             KEY: Client Det
     C                     PARM           P1CSSN                                             BUG5139
     C                     PARM           P1CRNM                                             BUG5139
     C                     PARM           P1CRTN                                             BUG5139
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0241R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check return code.
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
     C***********          MOVEL*BLANK    P0RTN            *Return code   153812
     C                     MOVEL'USR0790' P0RTN            *Return code   153812
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: PGM.*Return code is *Previous Screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #DCHCH           Choose Cheques
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Delete processing.
      * CASE: DTL.Choose Cheques and Cards is Delete
     C           #DCHCH    IFEQ 'D'                        *IF
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
      * Edit Cheques and Cards - Client Details  *
     C                     CLEARPMRC
     C                     MOVEL#1CUST    PMCUST           Customer Number
      *
     C                     CALL 'SD0241R'              90  Edit Cheques an
     C           W0RTN     PARM W0RTN     WQ0034  7        *Return code
     C                     PARM           PMRC             KEY: Client Det
     C                     PARM           P1CSSN                                             BUG5139
     C                     PARM           P1CRNM                                             BUG5139
     C                     PARM           P1CRTN                                             BUG5139
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0241R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check return code.
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: PGM.*Return code is *Previous Screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #DCHCH           Choose Cheques
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Customer Safes.
      * CASE: DTL.Choose Customer Safes is Yes
     C           #DCHSA    IFEQ 'Y'                        *IF
      * Edit Customer Safes - Client Details  *
     C                     CLEARPNRC
     C                     MOVEL#1CUST    PNCUST           Customer Number
      *
     C                     CALL 'SD0291R'              90  Edit Customer S
     C           W0RTN     PARM W0RTN     WQ0035  7        *Return code
     C                     PARM           PNRC             KEY: Client Det
     C                     PARM           P1CSSN                                             BUG5139
     C                     PARM           P1CRNM                                             BUG5139
     C                     PARM           P1CRTN                                             BUG5139
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0291R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check return code.
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
     C***********          MOVEL*BLANK    P0RTN            *Return code   153812
     C                     MOVEL'USR0790' P0RTN            *Return Code   153812
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: PGM.*Return code is *Previous Screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #DCHSA           Choose Customer
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Delete processing.
      * CASE: DTL.Choose Customer Safes is Delete
     C           #DCHSA    IFEQ 'D'                        *IF
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
      * Edit Customer Safes - Client Details  *
     C                     CLEARPNRC
     C                     MOVEL#1CUST    PNCUST           Customer Number
      *
     C                     CALL 'SD0291R'              90  Edit Customer S
     C           W0RTN     PARM W0RTN     WQ0036  7        *Return code
     C                     PARM           PNRC             KEY: Client Det
     C                     PARM           P1CSSN                                             BUG5139
     C                     PARM           P1CRNM                                             BUG5139
     C                     PARM           P1CRTN                                             BUG5139
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0291R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check return code.
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: PGM.*Return code is *Previous Screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #DCHSA           Choose Customer
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * End S01413
      * Start CDL002
      * FX Netting.
      * CASE: DTL.FX Netting Dtls Func fld is Yes
     C           #DFXND    IFEQ 'Y'                        *IF
      * Amend/Insert Mode
      * CASE: PAR.Action Code is Insert or Amend
     C           P2ANCD    IFEQ 'A'                        *IF
     C           P2ANCD    OREQ 'I'
     C***********          MOVEL'A'       WUANCD           Action Code                        227847
     C                     MOVELP2ANCD    WUANCD           Action Code                        227847
      * FX Netting Maintenance - Client Details  *
     C                     CLEARPORC
     C                     MOVEL#1CUST    POCUST           Customer Number
      *
     C                     CALL 'SD0015R'              90  FX Netting Main
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PORC             KEY: Client Det
     C                     PARM WUANCD    WQ0037  1        Action Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0015R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: PGM.*Return code is *Previous Screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #DFXND           FX Netting Dtls
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Delete Mode
      * CASE: PAR.Action Code is Delete
     C           P2ANCD    IFEQ 'D'                        *IF
      * FX Netting Enquiry - Client Details  *
     C                     CALL 'SD0015E'              90  FX Netting Enqu
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1CUST    WQ0038  6        Customer Number
     C                     PARM P2ANCD    WQ0039  1        Action Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0015E' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
     C                     MOVEL'USR0790' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: PGM.*Return code is *Previous Screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #DFXND           FX Netting Dtls
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * End CDL002
      *                                                                   CDL006
      ** If Fiduciary Details field is 'Y'                                CDL006
      *                                                                   CDL006
     C           SFIDET    IFEQ 'Y'                                       CDL006
      *                                                                   CDL006
     C                     MOVELP2ANCD    WUANCD                          CDL006
      *                                                                   CDL006
     C                     CLEARPORC                                      CDL006
     C                     MOVEL#1CUST    POCUST                          CDL006
      *                                                                   CDL006
     C                     CALL 'SD1510'               90                 CDL006
     C                     PARM *BLANK    W0RTN                           CDL006
     C                     PARM           PORC                            CDL006
     C                     PARM WUANCD    WQ0037                          CDL006
      *                                                                   CDL006
     C           *IN90     IFEQ '1'                                       CDL006
      *                                                                   CDL006
      ** Call to program ended in error                                   CDL006
      *                                                                   CDL006
     C                     MOVEL'Y2U0032' W0RTN                           CDL006
     C                     MOVEL*BLANKS   W0CLPG                          CDL006
     C                     MOVEL'SD1510'  W0CLPG                          CDL006
      *                                                                   CDL006
      ** Send message '*Error occurred on CALL...'                        CDL006
      *                                                                   CDL006
     C                     MOVEL'Y2U0032' ZAMSID                          CDL006
     C                     MOVEL'Y2USRMSG'ZAMSGF                          CDL006
     C                     MOVELW0CLPG    ZAMSDA                          CDL006
     C                     EXSR ZASNMS                                    CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
      ** If an error was detected                                         CDL006
      *                                                                   CDL006
     C           W0RTN     IFNE *BLANK                                    CDL006
     C                     MOVE '1'       *IN99                           CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
      ** If F3 was pressed                                                CDL006
      *                                                                   CDL006
     C           W0RTN     IFEQ 'Y2U9999'                                 CDL006
     C                     MOVEL'USR0790' P0RTN                           CDL006
     C                     EXSR ZYEXPG                                    CDL006
     C                     ELSE                                           CDL006
      *                                                                   CDL006
      ** If F12 was pressed                                               CDL006
      *                                                                   CDL006
     C           W0RTN     IFEQ 'USR0790'                                 CDL006
     C                     MOVEL'Y'       W0DCF                           CDL006
     C                     GOTO DAEXIT                                    CDL006
     C                     ELSE                                           CDL006
      *                                                                   CDL006
     C                     MOVEL'N'       SFIDET                          CDL006
     C                     MOVEL'Y'       WUF8OS                          CDL006
     C                     ENDIF                                          CDL006
     C                     ENDIF                                          CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CGL018
      ** If Risk Weighted Assets code is 'Y'                              CGL018
      *                                                                   CGL018
     C           SWRWAC    IFEQ 'Y'                                       CGL018
      *                                                                   CGL018
     C                     MOVELP2ANCD    WUANCD                          CGL018
      *                                                                   CGL018
     C                     CLEARPORC                                      CGL018
     C                     MOVEL#1CUST    POCUST                          CGL018
      *                                                                   CGL018
     C                     CALL 'SD001242'             90                 CGL018
     C                     PARM *BLANK    W0RTN                           CGL018
     C                     PARM           PORC                            CGL018
     C                     PARM P2ANCD    WQ0006                          215916
     C                     PARM           P1CSSN                                             BUG5139
     C                     PARM           P1CRNM                                             BUG5139
     C                     PARM           P1CRTN                                             BUG5139
      *                                                                   CGL018
     C           *IN90     IFEQ '1'                                       CGL018
      *                                                                   CGL018
      ** Call to program ended in error.                                  CGL018
      *                                                                   CGL018
     C                     MOVEL'Y2U0032' W0RTN                           CGL018
     C                     MOVEL*BLANKS   W0CLPG                          CGL018
     C                     MOVEL'SD001242'W0CLPG                          CGL018
      *                                                                   CGL018
      ** Send message '*Error occurred on CALL...'.                       CGL018
      *                                                                   CGL018
     C                     MOVEL'Y2U0032' ZAMSID                          CGL018
     C                     MOVEL'Y2USRMSG'ZAMSGF                          CGL018
     C                     MOVELW0CLPG    ZAMSDA                          CGL018
     C                     EXSR ZASNMS                                    CGL018
     C                     ENDIF                                          CGL018
      *                                                                   CGL018
      ** If an error was detected                                         CGL018
      *                                                                   CGL018
     C           W0RTN     IFNE *BLANK                                    CGL018
     C                     MOVE '1'       *IN99                           CGL018
     C                     ENDIF                                          CGL018
      *                                                                   CGL018
     C                     SELEC                                          CGL018
      *                                                                   CGL018
      ** If F3 was pressed                                                CGL018
      *                                                                   CGL018
     C           W0RTN     WHEQ 'Y2U9999'                                 CGL018
     C                     MOVEL'USR0790' P0RTN                           CGL018
     C                     EXSR ZYEXPG                                    CGL018
      *                                                                   CGL018
      ** If F12 was pressed                                               CGL018
      *                                                                   CGL018
     C           W0RTN     WHEQ 'USR0790'                                 CGL018
     C                     MOVEL'Y'       W0DCF                           CGL018
     C                     GOTO DAEXIT                                    CGL018
      *                                                                   CGL018
     C                     ENDSL                                          CGL018
      *                                                                   CGL018
     C                     MOVEL'N'       SWRWAC                          CGL018
     C                     MOVEL'Y'       WUF8OS                          CGL018
      *                                                                   CGL018
     C                     ENDIF                                          CGL018
      *                                                                   CGL018
      *                                                                   CSE023
      ** If Withholding tax field is 'Y'.                                 CSE023
      *                                                                   CSE023
     C           SWITAX    IFEQ 'Y'                                       CSE023
      *                                                                   CSE023
     C                     MOVELP2ANCD    WUANCD                          CSE023
      *                                                                   CSE023
     C                     CLEARPORC                                      CSE023
     C                     MOVEL#1CUST    POCUST                          CSE023
      *                                                                   CSE023
     C                     CALL 'SD0372R'              90                 CSE023
     C                     PARM *BLANK    W0RTN                           CSE023
     C                     PARM           PORC                            CSE023
     C                     PARM WUANCD    WQ0037                          CSE023
      *                                                                   CSE023
     C           *IN90     IFEQ '1'                                       CSE023
      *                                                                   CSE023
      ** Call to program ended in error.                                  CSE023
      *                                                                   CSE023
     C                     MOVEL'Y2U0032' W0RTN                           CSE023
     C                     MOVEL*BLANKS   W0CLPG                          CSE023
     C                     MOVEL'SD0372R' W0CLPG                          CSE023
      *                                                                   CSE023
      ** Send message '*Error occurred on CALL...'.                       CSE023
      *                                                                   CSE023
     C                     MOVEL'Y2U0032' ZAMSID                          CSE023
     C                     MOVEL'Y2USRMSG'ZAMSGF                          CSE023
     C                     MOVELW0CLPG    ZAMSDA                          CSE023
     C                     EXSR ZASNMS                                    CSE023
     C                     ENDIF                                          CSE023
      *                                                                   CSE023
      ** If an error was detected                                         CSE023
      *                                                                   CSE023
     C           W0RTN     IFNE *BLANK                                    CSE023
     C                     MOVE '1'       *IN99                           CSE023
     C                     ENDIF                                          CSE023
      *                                                                   CSE023
     C                     SELEC                                          CSE023
      *                                                                   CSE023
      ** Customer not classified as safe custody or discretionary.        CSE023
      *                                                                   CSE023
     C           W0RTN     WHEQ '*CSNERR'                                 CSE023
     C                     MOVEL'USR7500' ZAMSID                          CSE023
     C                     MOVEL'SDUSRMSG'ZAMSGF                          CSE023
     C                     MOVELW0CLPG    ZAMSDA                          CSE023
     C                     EXSR ZASNMS                                    CSE023
     C                     MOVE '1'       *IN46                           CSE023
      *                                                                   CSE023
      ** No withholding tax record exist.                                 CSE023
      *                                                                   CSE023
     C           W0RTN     WHEQ '*NRF   '                                 CSE023
     C                     MOVEL'USR7501' ZAMSID                          CSE023
     C                     MOVEL'SDUSRMSG'ZAMSGF                          CSE023
     C                     MOVELW0CLPG    ZAMSDA                          CSE023
     C                     EXSR ZASNMS                                    CSE023
     C                     MOVE '1'       *IN99                           CSE023
     C                     MOVE '1'       *IN46                           CSE023
      *                                                                   CSE023
      ** If F3 was pressed                                                CSE023
      *                                                                   CSE023
     C           W0RTN     WHEQ 'Y2U9999'                                 CSE023
     C                     MOVEL'USR0790' P0RTN                           CSE023
     C                     EXSR ZYEXPG                                    CSE023
      *                                                                   CSE023
      ** If F12 was pressed                                               CSE023
      *                                                                   CSE023
     C           W0RTN     WHEQ 'USR0790'                                 CSE023
     C                     MOVEL'Y'       W0DCF                           CSE023
     C                     GOTO DAEXIT                                    CSE023
      *                                                                   CSE023
     C                     ENDSL                                          CSE023
      *                                                                   CSE023
     C                     MOVEL'N'       SWITAX                          CSE023
     C                     MOVEL'Y'       WUF8OS                          CSE023
      *                                                                   CSE023
     C                     ENDIF                                          CSE023
      *                                                                   CSE023
      ** If Document Management field is 'Y'.                                                 CSD093
      *                                                                                       CSD093
     C           #DDCMT    IFEQ 'Y'                                                           CSD093
     C                     CALL SDDCMT                 90                                     CSD093
     C                     PARM *BLANK    W0RTN                                               CSD093
     C                     PARM P2ANCD    PINMOD  1                                           CSD093
     C                     PARM P1CUST    PINCUS 10                                           CSD093
     C                     PARM 'C'       PINTYP  1                                           CSD093
      *                                                                                       CSD093
     C           *IN90     IFEQ '1'                                                           CSD093
      *                                                                                       CSD093
      ** Call to program ended in error.                                                      CSD093
      *                                                                                       CSD093
     C                     MOVEL'Y2U0032' W0RTN                                               CSD093
     C                     MOVEL*BLANKS   W0CLPG                                              CSD093
     C                     MOVEL'SDDCMT ' W0CLPG                                              CSD093
      *                                                                                       CSD093
      ** Send message '*Error occurred on CALL...'.                                           CSD093
      *                                                                                       CSD093
     C                     MOVEL'Y2U0032' ZAMSID                                              CSD093
     C                     MOVEL'Y2USRMSG'ZAMSGF                                              CSD093
     C                     MOVELW0CLPG    ZAMSDA                                              CSD093
     C                     EXSR ZASNMS                                                        CSD093
     C                     ENDIF                                                              CSD093
      *                                                                                       CSD093
      ** If an error was detected                                                             CSD093
      *                                                                                       CSD093
     C           W0RTN     IFNE *BLANK                                                        CSD093
     C                     MOVE '1'       *IN99                                               CSD093
     C                     ENDIF                                                              CSD093
      *                                                                                       CSD093
     C                     MOVEL'N'       #DDCMT                                              CSD093
     C                     MOVEL'Y'       WUF8OS                                              CSD093
      *                                                                                       CSD093
     C                     ENDIF                                                              CSD093
      *                                                                                       CSD093
      ** If KYC Item is 'Y'                                                                   CSD028
      *                                                                                       CSD028
     C           #KYCIT    IFEQ 'Y'                                                           CSD028
     C           CSD028    ANDEQ'Y'                                                           CSD028
      *                                                                                       CSD028
     C                     MOVELP2ANCD    WUANCD                                              CSD028
      *                                                                                       CSD028
     C                     CLEARPORC                                                          CSD028
     C                     MOVEL#1CUST    P0CUST  6                                           CSD028
      *                                                                                       CSD028
     C                     CALL 'SD000050'             90                                     CSD028
     C                     PARM           P0CUST                                              CSD028
      *                                                                                       CSD028
     C           *IN90     IFEQ *ON                                                           CSD028
      *                                                                                       CSD028
      ** Call to program ended in error.                                                      CSD028
      *                                                                                       CSD028
     C                     MOVEL'Y2U0032' W0RTN                                               CSD028
     C                     MOVEL*BLANKS   W0CLPG                                              CSD028
     C                     MOVEL'SD0372R' W0CLPG                                              CSD028
      *                                                                                       CSD028
      ** Send message '*Error occurred on CALL...'.                                           CSD028
      *                                                                                       CSD028
     C                     MOVEL'USR6010' ZAMSID                                              CSD028
     C                     MOVEL'SDUSRMSG'ZAMSGF                                              CSD028
     C                     EXSR ZASNMS                                                        CSD028
     C                     ENDIF                                                              CSD028
      *                                                                                       CSD028
      ** If an error was detected                                                             CSD028
      *                                                                                       CSD028
     C           W0RTN     IFNE *BLANK                                                        CSD028
     C                     MOVE *ON       *IN99                                               CSD028
     C                     ENDIF                                                              CSD028
      *                                                                                       CSD028
     C                     MOVEL'N'       #KYCIT                                              CSD028
      *                                                                                       CSD028
     C                     ENDIF                                                              CSD028
      * Start of S01467
     C                     MOVEL'N'       WUCFAO           call futures &
      * 00/Copy member SD0014VC12 - Client Details  *
     C/COPY WNCPYSRC,SD0014VC12                                           S01212
      * Securities Trading data
      * CASE: DTL.Choose Securities Trading is Yes
     C           #DCHST    IFEQ 'Y'                        *IF
      * 00/Copy member SD0014VC16 - Client Details  *
     C/COPY WNCPYSRC,SD0014VC16
      * Edit ST clients - Securities Clients  *
     C                     CLEARPPRC
     C                     MOVEL#1CUST    PPCUST           Customer Number
     C           CAP139    IFEQ 'Y'                                       CAP039
     C                     MOVEL'SDSECD'  WQMOD1                          CAP039
     C                     MOVEL'SIN'     WQMOD2                          CAP039
     C                     CALL 'SDC0001'              90                 CAP039
     C                     PARM           WQMODN                          CAP039
     C                     PARM           PPRC             KEY: SecuritiesCAP039
     C                     PARM P2ANCD    WQ0041  1        Action Code    CAP039
      *                                                                   CAP039
     C           *IN90     IFEQ '1'                                       CAP039
      * Call to program ended in error                                    CAP039
     C                     MOVEL'Y2U0032' W0RTN                           CAP039
     C                     MOVEL*BLANKS   W0CLPG 10                       CAP039
     C                     MOVEL'SDC0001' W0CLPG                          CAP039
      * Send message '*Error occured on CALL...'                          CAP039
     C                     MOVEL'Y2U0032' ZAMSID                          CAP039
     C                     MOVEL'Y2USRMSG'ZAMSGF                          CAP039
     C                     MOVELW0CLPG    ZAMSDA           Message data   CAP039
     C                     EXSR ZASNMS                                    CAP039
     C                     END                                            CAP039
      *
     C                     ELSE                                           CAP039
      *
     C/COPY WNCPYSRC,SD0014VC04
     C                     CALL 'SD0341R'              90  Edit ST clients
     C/COPY WNCPYSRC,SD0014VC05
     C                     PARM *BLANK    W0RTN   7
     C/COPY WNCPYSRC,SD0014VC06
     C                     PARM           PPRC             KEY: Securities
     C                     PARM WUCFAO    WQ0040  1        call futures &
     C                     PARM P2ANCD    WQ0041  1        Action Code
     C                     PARM 'S'       WQ0042  1        mode
     C/COPY WNCPYSRC,SD0014VC42
     C                     PARM           P1FRNT 20                                           CER001
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0341R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
     C                     END                                            CAP039
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * 00/Copy member SD0014VC17 - Client Details  *
     C/COPY WNCPYSRC,SD0014VC17
      * Check return code.
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
      * Delete processing.
      * CASE: PAR.Action Code is Delete
     C           P2ANCD    IFEQ 'D'                        *IF
      * retrieve client - Securities Clients  *
     C                     EXSR SPRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C***********          MOVEL*BLANK    P0RTN            *Return code   153812
     C                     MOVEL'USR0790' P0RTN            *Return code   153812
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     ELSE
      * CASE: PGM.*Return code is *Previous Screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #DCHST           Choose Securiti
      * 00/Copy member SD0014VC18 - Client Details  *
     C/COPY WNCPYSRC,SD0014VC18
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Delete processing.
      * CASE: DTL.Choose Securities Trading is Delete
     C           #DCHST    IFEQ 'D'                        *IF
      * Check if ST client - Securities Clients  *
     C                     EXSR SQRVGN
      * Check return code.
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#DCHST    ZA0016           Choose Securiti
      * Send message 'Not a ST customer'
     C                     MOVEL'USR0319' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9938  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'D'       WUDELM           Delete Mode
      * Edit ST clients - Securities Clients  *
     C                     CLEARPPRC
     C                     MOVEL#1CUST    PPCUST           Customer Number
      *
     C           CAP139    IFEQ 'Y'                                       CAP039
     C                     MOVEL'SDSECD'  WQMOD1                          CAP039
     C                     MOVEL'SIN'     WQMOD2                          CAP039
     C                     CALL 'SDC0001'              90                 CAP039
     C                     PARM           WQMODN                          CAP039
     C                     PARM           PPRC             KEY: SecuritiesCAP039
     C                     PARM WUDELM    WQ0044  1        Action Code    CAP039
      *                                                                   CAP039
     C           *IN90     IFEQ '1'                                       CAP039
      * Call to program ended in error                                    CAP039
     C                     MOVEL'Y2U0032' W0RTN                           CAP039
     C                     MOVEL*BLANKS   W0CLPG 10                       CAP039
     C                     MOVEL'SDC0001' W0CLPG                          CAP039
      * Send message '*Error occured on CALL...'                          CAP039
     C                     MOVEL'Y2U0032' ZAMSID                          CAP039
     C                     MOVEL'Y2USRMSG'ZAMSGF                          CAP039
     C                     MOVELW0CLPG    ZAMSDA           Message data   CAP039
     C                     EXSR ZASNMS                                    CAP039
     C                     END                                            CAP039
      *
     C                     ELSE                                           CAP039
      *
     C                     CALL 'SD0341R'              90  Edit ST clients
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PPRC             KEY: Securities
     C                     PARM WUCFAO    WQ0043  1        call futures &
     C                     PARM WUDELM    WQ0044  1        Action Code
     C                     PARM 'S'       WQ0045  1        mode
     C/COPY WNCPYSRC,SD0014VC43
     C                     PARM           P1FRNT 20                                           CER001
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0341R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
     C                     END                                            CAP039
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check return code.
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: PGM.*Return code is *Previous Screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #DCHST           Choose Securiti
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
     C                     END                             *FI
     C                     END                             *FI
      * Futures & Options
      * CASE: DTL.Choose Futures & Options is Yes
     C           #DCHFO    IFEQ 'Y'                        *IF
      * Edit FO Clients - Futures & Options Clients  *
     C                     CLEARPQRC
     C                     MOVEL#1CUST    PQCUST           Customer Number
     C/COPY WNCPYSRC,SD0014VC38
      *
     C                     CALL 'SD0331R'              90  Edit FO Clients
     C/COPY WNCPYSRC,SD0014VC39
     C                     PARM *BLANK    W0RTN   7
     C/COPY WNCPYSRC,SD0014VC40
     C                     PARM           PQRC             KEY: Futures &
     C                     PARM 'S'       WQ0046  1        mode
     C                     PARM P2ANCD    WQ0047  1        Action Code
     C           W0RTN     PARM W0RTN     WQ0048  7        *Return code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0331R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check return code.
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
      * Delete processing.
      * CASE: PAR.Action Code is Delete
     C           P2ANCD    IFEQ 'D'                        *IF
      * retrieve client - Futures & Options Clients  *
     C                     EXSR SRRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     ELSE
      * CASE: PGM.*Return code is *Previous Screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C/COPY WNCPYSRC,SD0014VC41
     C                     MOVEL'N'       #DCHFO           Choose Futures
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Delete processing.
      * CASE: DTL.Choose Futures & Options is Delete
     C           #DCHFO    IFEQ 'D'                        *IF
      * Check if F&O Customer - Futures & Options Clients  *
     C                     EXSR SSRVGN
      * Check return code.
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#DCHFO    ZA0017           Choose Futures
      * Send message 'Not a FO customer'
     C                     MOVEL'USR0320' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'D'       WUDELM           Delete Mode
      * Edit FO Clients - Futures & Options Clients  *
     C                     CLEARPQRC
     C                     MOVEL#1CUST    PQCUST           Customer Number
      *
     C                     CALL 'SD0331R'              90  Edit FO Clients
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PQRC             KEY: Futures &
     C                     PARM 'S'       WQ0049  1        mode
     C                     PARM WUDELM    WQ0050  1        Action Code
     C           W0RTN     PARM W0RTN     WQ0051  7        *Return code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0331R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check return code.
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: PGM.*Return code is *Previous Screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #DCHFO           Choose Futures
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
     C                     END                             *FI
     C                     END                             *FI
      * End of S01467
      * 00/Copy member SD0014VCP2 - Client Details  *
     C/COPY WNCPYSRC,SD0014VCP2                                           S01212
      * Start of S01486
      * Portfolio Management
      * CASE: DTL.Portfolio Management Scr is Yes
     C           #DPMSC    IFEQ 'Y'                        *IF
      * Check for Non Deleted PM - Portfolio Manag Cust Dtls  *
     C                     EXSR STRVGN
      * Check return code
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DPMSC    ZA0018           Portfolio Manag
      * Send message 'PM Rcd deleted'
     C                     MOVEL'USR2562' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9940  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Edit Portfolio Management - Portfolio Manag Cust Dtls  *
     C                     CLEARPRRC
     C                     MOVEL#1CUST    PRCUST           Customer Number
      *
     C                     CALL 'SD0391R'              90  Edit Portfolio
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PRRC             KEY: Portfolio
     C                     PARM P2ANCD    WQ0052  1        Action Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0391R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check return code.
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
      * Delete processing.
      * CASE: PAR.Action Code is Delete
     C           P2ANCD    IFEQ 'D'                        *IF
      * Does Porfolio/M exist? - Portfolio Manag Cust Dtls  *
     C                     EXSR SURVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     ELSE
      * CASE: PGM.*Return code is *Previous Screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #DPMSC           Portfolio Manag
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
     C                     ELSE
      * CASE: *OTHERWISE
      * Delete processing.
      * CASE: DTL.Portfolio Management Scr is Delete
     C           #DPMSC    IFEQ 'D'                        *IF
      * Check for Non Deleted PM - Portfolio Manag Cust Dtls  *
     C                     EXSR SVRVGN
      * Check return code.
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#DPMSC    ZA0019           Portfolio Manag
      * Send message 'No PM details exist'
     C                     MOVEL'USR2359' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9940  *
      *
     C                     ELSE
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ 'Y2U0003'                  *IF
     C                     MOVEL'D'       WUDELM           Delete Mode
      * Edit Portfolio Management - Portfolio Manag Cust Dtls  *
     C                     CLEARPRRC
     C                     MOVEL#1CUST    PRCUST           Customer Number
      *
     C                     CALL 'SD0391R'              90  Edit Portfolio
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PRRC             KEY: Portfolio
     C                     PARM WUDELM    WQ0053  1        Action Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0391R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check return code.
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: PGM.*Return code is *Previous Screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #DPMSC           Portfolio Manag
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DPMSC    ZA0020           Portfolio Manag
      * Send message 'PM record has been deltd'
     C                     MOVEL'USR2561' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9940  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
     C                     END                             *FI
     C                     END                             *FI
      * Portfolio Lending
      * CASE: DTL.Portfolio Lending Scr is Yes
     C           #DPLSC    IFEQ 'Y'                        *IF
      * 00/Copy member SD0014VC19 - Client Details  *
     C/COPY WNCPYSRC,SD0014VC19
      * Edit Portfolio Lending - Portfolio Lend Cust Dtls  *
     C                     CLEARPSRC
     C                     MOVEL#1CUST    PSCUST           Customer Number
      *
     C/COPY WNCPYSRC,SD0014VC07
     C                     CALL 'SD0411R'              90  Edit Portfolio
     C/COPY WNCPYSRC,SD0014VC08
     C                     PARM *BLANK    W0RTN   7
     C/COPY WNCPYSRC,SD0014VC09
     C                     PARM           PSRC             KEY: Portfolio
     C                     PARM P2ANCD    WQ0054  1        Action Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0411R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * 00/Copy member SD0014VC20 - Client Details  *
     C/COPY WNCPYSRC,SD0014VC20
      * Check return code.
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
      * Delete processing.
      * CASE: PAR.Action Code is Delete
     C           P2ANCD    IFEQ 'D'                        *IF
      * Does Portfilio/L exist? - Portfolio Lend Cust Dtls  *
     C                     EXSR SWRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     ELSE
      * CASE: PGM.*Return code is *Previous Screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #DPLSC           Portfolio Lendi
      * 00/Copy member SD0014VC21 - Client Details  *
     C/COPY WNCPYSRC,SD0014VC21
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Delete processing.
      * CASE: DTL.Portfolio Lending Scr is Delete
     C           #DPLSC    IFEQ 'D'                        *IF
      * Does Portfilio/L exist? - Portfolio Lend Cust Dtls  *
     C                     EXSR SXRVGN
      * Check return code.
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#DPLSC    ZA0021           Portfolio Lendi
      * Send message 'No PL details exist'
     C                     MOVEL'USR2360' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9941  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'D'       WUDELM           Delete Mode
      * Edit Portfolio Lending - Portfolio Lend Cust Dtls  *
     C                     CLEARPSRC
     C                     MOVEL#1CUST    PSCUST           Customer Number
      *
     C                     CALL 'SD0411R'              90  Edit Portfolio
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PSRC             KEY: Portfolio
     C                     PARM WUDELM    WQ0055  1        Action Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0411R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check return code.
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: PGM.*Return code is *Previous Screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #DPLSC           Portfolio Lendi
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
     C                     END                             *FI
     C                     END                             *FI
      * End of S01486
      * Start of S01467
      * Leo Customer details
      * CASE: DTL.LEO Function field is Yes
     C           #DLEOF    IFEQ 'Y'                        *IF
      * Check Leo phase of day.
      * Check Leo Phase of Day - Standard Functions  *
     C                     CALL 'SCC1111'              90  Check Leo Phase
     C           WULPHS    PARM *BLANK    WQ0056  1        LPHAS Value fro
     C                     PARM *BLANK    WQ0057  1        LSTATUS Update
     C           WUAPRC    PARM *BLANK    WQ0058  7        Access Pgm Retu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SCC1111' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Check return code.
      * CASE: WRK.Access Pgm Return Code is *Normal
     C           WUAPRC    IFEQ *BLANK                     *IF
      * If Leo is in input cycle then allow maint, else refuse.
      * CASE: WRK.LPHAS Value from Leo is Leo Input Cycle
     C           WULPHS    IFEQ 'I'                        *IF
      * Send message to LSTATUS.
      * Check Leo Phase of Day - Standard Functions  *
     C                     CALL 'SCC1111'              90  Check Leo Phase
     C           WULPHS    PARM *BLANK    WQ0059  1        LPHAS Value fro
     C                     PARM 'A'       WQ0060  1        LSTATUS Update
     C           WUAPRC    PARM *BLANK    WQ0061  7        Access Pgm Retu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SCC1111' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Edit Leo Customer Details - Customer LEO Details  *
     C                     CALL 'SD1111R'              90  Edit Leo Custom
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1CUST    WQ0062  6        Customer Number
     C                     PARM P2ANCD    WQ0063  1        Action Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD1111R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Maintenance processing.
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
      * Delete processing.
      * CASE: PAR.Action Code is Delete
     C           P2ANCD    IFEQ 'D'                        *IF
      * Check existence of Cust. - Customer LEO Details  *
     C                     EXSR SYRVGN
      * Check return code.
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     ELSE
      * CASE: PGM.*Return code is *Previous Screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #DLEOF           LEO Function fi
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
     C                     END                             *FI
     C                     END                             *FI
      * Check Leo Phase of Day - Standard Functions  *
     C                     CALL 'SCC1111'              90  Check Leo Phase
     C           WULPHS    PARM *BLANK    WQ0064  1        LPHAS Value fro
     C                     PARM 'R'       WQ0065  1        LSTATUS Update
     C           WUAPRC    PARM *BLANK    WQ0066  7        Access Pgm Retu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SCC1111' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DLEOF    ZA0022           LEO Function fi
      * Send message 'Leo not in Input Cycle'
     C                     MOVEL'USR2353' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9942  *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DLEOF    ZA0023           LEO Function fi
      * Send message 'Error Accessing LPHAS'
     C                     MOVEL'USR2352' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9942  *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: DTL.LEO Function field is Delete
     C           #DLEOF    IFEQ 'D'                        *IF
      * Check Leo phase of day.
      * Check Leo Phase of Day - Standard Functions  *
     C                     CALL 'SCC1111'              90  Check Leo Phase
     C           WULPHS    PARM *BLANK    WQ0067  1        LPHAS Value fro
     C                     PARM *BLANK    WQ0068  1        LSTATUS Update
     C           WUAPRC    PARM *BLANK    WQ0069  7        Access Pgm Retu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SCC1111' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * If Leo is in input cycle then allow deletion processing.
      * CASE: WRK.Access Pgm Return Code is *Normal
     C           WUAPRC    IFEQ *BLANK                     *IF
      * If Leo is in input cycle then allow delete, else refuse.
      * CASE: WRK.LPHAS Value from Leo is Leo Input Cycle
     C           WULPHS    IFEQ 'I'                        *IF
      * Send message to LSTATUS.
      * Check Leo Phase of Day - Standard Functions  *
     C                     CALL 'SCC1111'              90  Check Leo Phase
     C           WULPHS    PARM *BLANK    WQ0070  1        LPHAS Value fro
     C                     PARM 'A'       WQ0071  1        LSTATUS Update
     C           WUAPRC    PARM *BLANK    WQ0072  7        Access Pgm Retu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SCC1111' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Delete processing.
      * CASE: DTL.LEO Function field is Delete
     C           #DLEOF    IFEQ 'D'                        *IF
      * Check existence of Cust. - Customer LEO Details  *
     C                     EXSR SZRVGN
      * Check return code.
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#DLEOF    ZA0024           LEO Function fi
      * Send message 'No LEO Details'
     C                     MOVEL'USR2303' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9942  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'D'       WUDELM           Delete Mode
      * Edit Leo Customer Details - Customer LEO Details  *
     C                     CALL 'SD1111R'              90  Edit Leo Custom
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1CUST    WQ0073  6        Customer Number
     C                     PARM WUDELM    WQ0074  1        Action Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD1111R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check return code.
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: PGM.*Return code is *Previous Screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #DLEOF           LEO Function fi
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
     C                     END                             *FI
      * Check Leo Phase of Day - Standard Functions  *
     C                     CALL 'SCC1111'              90  Check Leo Phase
     C           WULPHS    PARM *BLANK    WQ0075  1        LPHAS Value fro
     C                     PARM 'R'       WQ0076  1        LSTATUS Update
     C           WUAPRC    PARM *BLANK    WQ0077  7        Access Pgm Retu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SCC1111' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DLEOF    ZA0025           LEO Function fi
      * Send message 'Leo not in Input Cycle'
     C                     MOVEL'USR2353' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9942  *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DLEOF    ZA0026           LEO Function fi
      * Send message 'Error Accessing LPHAS'
     C                     MOVEL'USR2352' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9942  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * End of S01467
      * Start of change CTI001
      * TI Interface
      * CASE: DTL.Call TI Customer Function is Yes
     C           #DTICF    IFEQ 'Y'                        *IF
      * Check for TI customer ref - Trade Innov Cust Details  *
     C                     EXSR TARVGN
      * Check return code
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DTICF    ZA0027           Call TI Custome
      * Send message 'TI Customer Deleted'
     C                     MOVEL'USR3541' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9944  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Edit TI Customers - Trade Innov Cust Details  *
     C                     CALL 'SD0371R'              90  Edit TI Custome
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1CUST    WQ0078  6        Customer Number
     C                     PARM P2ANCD    WQ0079  1        Action Code
     C           P1TICS    PARM P1TICS    WQ0080  1        TI Customer Fla
     C           P4CTID    PARM           P4CTID136        Changed TI Details                BUG3362
      *
     C                     MOVELWQ0080    #DTICF                                              238374
      *                                                                                       238374
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0371R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check return code.
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
      * Delete processing.
      * CASE: PAR.Action Code is Delete
     C           P2ANCD    IFEQ 'D'                        *IF
      * Check for TI customer ref - Trade Innov Cust Details  *
     C                     EXSR TBRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     ELSE
      * CASE: PGM.*Return code is *Previous Screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C**********           MOVEL'N'       #DTICF           Call TI Custome                   BUG2664
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
     C                     ELSE
      * CASE: *OTHERWISE
      * Delete processing.
      * CASE: DTL.Call TI Customer Function is Delete
     C           #DTICF    IFEQ 'D'                        *IF
      * Check for TI customer ref - Trade Innov Cust Details  *
     C                     EXSR TCRVGN
      * Check return code.
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#DTICF    ZA0028           Call TI Custome
      * Send message 'TI Customer does not exis'
     C                     MOVEL'USR3535' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9944  *
      *
     C                     ELSE
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ 'Y2U0003'                  *IF
     C                     MOVEL'D'       WUDELM           Delete Mode
      * Edit TI Customers - Trade Innov Cust Details  *
     C                     CALL 'SD0371R'              90  Edit TI Custome
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1CUST    WQ0081  6        Customer Number
     C                     PARM WUDELM    WQ0082  1        Action Code
     C           P1TICS    PARM P1TICS    WQ0083  1        TI Customer Fla
     C           P4CTID    PARM           P4CTID136        Changed TI Details                BUG3362
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0371R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check return code.
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: PGM.*Return code is *Previous Screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C**********           MOVEL'N'       #DTICF           Call TI Custome                   BUG2664
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DTICF    ZA0029           Call TI Custome
      * Send message 'TI Customer Deleted'
     C                     MOVEL'USR3541' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9944  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
     C                     END                             *FI
     C                     END                             *FI
      * End of change CTI001
      * Start of S01522
      * User Defined Correspondence.
      * CASE: DTL.UDC Function field is Yes
     C           #DUDCF    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    WURTCD           Return Code wor
      * Call the UDC CL PGM - Client Details  *
     C                     CALL 'CGC0023'              90  Call the UDC CL
     C           WURTCD    PARM WURTCD    WQ0084  7        Return Code wor
     C                     PARM P2ANCD    WQ0085  1        Action Code
     C                     PARM P1CUST    WQ0086  6        Customer Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CGC0023' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Check return code.
      * CASE: WRK.Return Code work field is USER QUIT REQUESTED
     C           WURTCD    IFEQ 'Y2U9999'                  *IF
     C***********          MOVEL*BLANK    P0RTN            *Return code   153812
     C                     MOVEL'USR0790' P0RTN            *Return code   153812
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: WRK.Return Code work field is Previous screen
     C           WURTCD    IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #DUDCF           UDC Function fi
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Delete processing.
      * CASE: DTL.UDC Function field is Delete
     C           #DUDCF    IFEQ 'D'                        *IF
     C                     MOVEL'Y'       WUF8OS           F8 Option Selec
     C                     MOVEL*BLANK    WURTCD           Return Code wor
      * Call the UDC CL PGM - Client Details  *
     C                     CALL 'CGC0023'              90  Call the UDC CL
     C           WURTCD    PARM WURTCD    WQ0087  7        Return Code wor
     C                     PARM 'U'       WQ0088  1        Action Code
     C                     PARM #1CUST    WQ0089  6        Customer Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CGC0023' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Check return code.
      * CASE: WRK.Return Code work field is USER QUIT REQUESTED
     C           WURTCD    IFEQ 'Y2U9999'                  *IF
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: WRK.Return Code work field is Previous screen
     C           WURTCD    IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #DUDCF           UDC Function fi
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * End of S01522
     C                     END                             *FI
      * End of change 076220
      * /COPY.
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy member SD0014VUDA - Client Details  *
     C*00/Copy member SD0014V   User Defined Action
     C/COPY WNCPYSRC,SD0014VUDA
     C                     END                             *FI
      * Start of change S01467.
      * F8 option selected processing.
      * CASE: WRK.F8 Option Selected is Option selected
     C           WUF8OS    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * End of change S01467.
      * Exit program
     C                     EXSR ZXEXPG
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBVLSC    BEGSR
      *================================================================
      * Validate screen input
      *================================================================
      * Validate Choose Securities Trading
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#DCHST    W0NSRQ  1        Choose Securiti
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1105244   Y2LSNO  70
     C           #DCHST    PARM #DCHST    W0EXVL 20        Choose Securiti
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
      * Validate Choose Futures & Options
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#DCHFO    W0NSRQ  1        Choose Futures
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1105247   Y2LSNO  70
     C           #DCHFO    PARM #DCHFO    W0EXVL 20        Choose Futures
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
      * USER: Validate fields
      * 00/Copy member SD0014VCP3 - Client Details  *
     C/COPY WNCPYSRC,SD0014VCP3                                           S01212
      * Start of change 076220
      * Enquiry mode
      * CASE: PAR.Action Code is Enquire
     C           P2ANCD    IFEQ 'E'                        *IF
      * Validate Marketing Information Select field.
      * CASE: DTL.Choose Customer Marketing is Enquiry
     C           #DCHCM    IFEQ 'N'                        *IF
     C           #DCHCM    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DCHCM    ZA0030           Choose Customer
      * Send message 'Inval value - must be Y/N'
     C                     MOVEL'USR0805' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
      *                                                                                       CRN001
      * Validate Regulatory Reporting Select field.                                           CRN001
     C           CRN001    IFEQ 'Y'                                                           CRN001
     C           #DRGRP    IFNE 'Y'                                                           CRN001
     C           #DRGRP    ANDNE'N'                                                           CRN001
     C                     MOVEL#DRGRP    ZA0030                                              CRN001
     C                     MOVEL'USR0805' ZAMSID                                              CRN001
     C                     EXSR ZASNMS                                                        CRN001
     C**********           SETON                     9948                            CRN001 BUG10154
     C                     SETON                     9949                                   BUG10154
     C                     ENDIF                                                              CRN001
     C                     ENDIF                                                              CRN001
      *                                                                                       CRN001
      * Validate input field for 'Further Customer Details'
      * CASE: WRK.SAR S01497 is Present
     C           WUFCSD    IFEQ 'Y'                        *IF
      * CASE: DTL.Further Customer Details is Enquiry
     C           #DFCUS    IFEQ 'N'                        *IF
     C           #DFCUS    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DFCUS    ZA0031           Further Custome
      * Send message 'Inval value - must be Y/N'
     C                     MOVEL'USR0805' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate input field for Additional Customer Details
      * CASE: WRK.SAR S01425 is Present
     C           WUWSAR    IFEQ 'Y'                        *IF
      * CASE: DTL.Additional Cust Func Fld is Valid value
     C           #DACFF    IFEQ 'N'                        *IF
     C           #DACFF    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DACFF    ZA0032           Additional Cust
      * Send message 'Inval value - must be Y/N'
     C                     MOVEL'USR0805' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate input field for Customer Service Fees
      * CASE: WRK.Display customer fees is Display
     C           WUDSCF    IFEQ 'Y'                        *IF
      * CASE: DTL.Customer Fees Func Fld is Valid value
     C           #DCFFF    IFEQ 'N'                        *IF
     C           #DCFFF    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DCFFF    ZA0033           Customer Fees F
      * Send message 'Inval value - must be Y/N'
     C                     MOVEL'USR0805' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9934  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate input fields for choosing Customer Cheques or Safes
      * CASE: WRK.Retail 3 is Yes
     C           WUNXST    IFEQ 'Y'                        *IF
      * Cheques and cards.
      * CASE: DTL.Choose Cheques and Cards is valid values
     C           #DCHCH    IFEQ *BLANK                     *IF
     C           #DCHCH    OREQ 'N'
     C           #DCHCH    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DCHCH    ZA0034           Choose Cheques
      * Send message 'Inval value - must be Y/N'
     C                     MOVEL'USR0805' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
      *
     C                     END                             *FI
      * Customer safes.
      * CASE: DTL.Choose Customer Safes is valid values
     C           #DCHSA    IFEQ *BLANK                     *IF
     C           #DCHSA    OREQ 'N'
     C           #DCHSA    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DCHSA    ZA0035           Choose Customer
      * Send message 'Inval value - must be Y/N'
     C                     MOVEL'USR0805' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9936  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Start CDL002
      * Validate Input field for FX Netting
      * CASE: WRK.FX Netting switched on is Yes
     C           WUY9ST    IFEQ 'Y'                        *IF
      * CASE: DTL.FX Netting Dtls Func fld is Valid Values
     C           #DFXND    IFEQ 'N'                        *IF
     C           #DFXND    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DFXND    ZA0036           FX Netting Dtls
      * Send message 'FX Netting Input fld  INV'
     C                     MOVEL'USR3137' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * End CDL002
      *                                                                   CDL006
      ** Validate Fiduciary Details                                       CDL006
      *                                                                   CDL006
     C           WUFIDS    IFEQ 'Y'                                       CDL006
      *                                                                   CDL006
      ** If Fiduciary Detail field is valid                               CDL006
      *                                                                   CDL006
     C           SFIDET    IFEQ 'N'                                       CDL006
     C           SFIDET    OREQ 'Y'                                       CDL006
     C                     ELSE                                           CDL006
      *                                                                   CDL006
      ** Setup message data for message                                   CDL006
      *                                                                   CDL006
     C                     MOVELSFIDET    ZA0036                          CDL006
      *                                                                   CDL006
      ** Send error message                                               CDL006
      *                                                                   CDL006
     C                     MOVEL'USR8614' ZAMSID                          CDL006
     C                     EXSR ZASNMS                                    CDL006
     C                     MOVE '1'       *IN99                           CDL006
     C                     MOVE '1'       *IN45                           CDL006
      *                                                                   CDL006
     C                     ENDIF                                          CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CSE023
      ** Validate Withholding tax details.                                CSE023
      *                                                                   CSE023
     C           WWITAX    IFEQ 'Y'                                       CSE023
      *                                                                   CSE023
      ** If Withholding tax field is valid.                               CSE023
      *                                                                   CSE023
     C           SWITAX    IFNE 'N'                                       CSE023
     C           SWITAX    ANDNE'Y'                                       CSE023
      *                                                                   CSE023
      ** Setup message data for message.                                  CSE023
      *                                                                   CSE023
     C                     MOVELSWITAX    ZA0036                          CSE023
      *                                                                   CSE023
      ** Send error message.                                              CSE023
      *                                                                   CSE023
     C                     MOVEL'USR7502' ZAMSID                          CSE023
     C                     MOVEL'SDUSRMSG'ZAMSGF                          CSE023
     C                     EXSR ZASNMS                                    CSE023
     C                     MOVE '1'       *IN99                           CSE023
     C                     MOVE '1'       *IN46                           CSE023
      *                                                                   CSE023
     C                     ENDIF                                          CSE023
     C                     ENDIF                                          CSE023
      *                                                                                       CSD028
     C           CSD028    IFEQ 'Y'                                                           CSD028
      *                                                                                       CSD028
      ** If KYC Item is Valid                                                                 CSD028
      *                                                                                       CSD028
     C           #KYCIT    IFNE 'N'                                                           CSD028
     C           #KYCIT    ANDNE'Y'                                                           CSD028
      *                                                                                       CSD028
      ** Setup message data for message.                                                      CSD028
      *                                                                                       CSD028
     C                     MOVEL#KYCIT    ZA0036                                              CSD028
      *                                                                                       CSD028
      ** Send error message.                                                                  CSD028
      *                                                                                       CSD028
     C                     MOVEL'USR6005' ZAMSID                                              CSD028
     C                     MOVEL'SDUSRMSG'ZAMSGF                                              CSD028
     C                     EXSR ZASNMS                                                        CSD028
     C                     MOVE *ON       *IN99                                               CSD028
     C                     MOVE *ON       *IN48                                               CSD028
      *                                                                                       CSD028
     C                     ELSE                                                               CSD028
     C                     MOVEL#1CUST    WCCUS#                                              CSD028
     C********** WNCUS#    CHAINSDKYCIL0             51                              CSD028 BUG10603
     C           WNCUS#    CHAINSDKYCIL1             51                                     BUG10603
     C           *IN51     IFEQ *ON                                                           CSD028
     C           #KYCIT    ANDEQ'Y'                                                           CSD028
     C                     MOVEL'USR6011' ZAMSID                                              CSD028
     C                     MOVEL'SDUSRMSG'ZAMSGF                                              CSD028
     C                     EXSR ZASNMS                                                        CSD028
     C                     MOVE *ON       *IN99                                               CSD028
     C                     MOVE *ON       *IN48                                               CSD028
     C                     ENDIF                                                              CSD028
     C                     ENDIF                                                              CSD028
     C                     ENDIF                                                              CSD028
      *                                                                                       CSD028
      ** Validate Risk Weighted Assets codes                              CGL018
      *                                                                   CGL018
     C           WURWAC    IFEQ 'Y'                                       CGL018
      *                                                                   CGL018
      ** If Risk Weighted Assets field is valid                           CGL018
      *                                                                   CGL018
     C           SWRWAC    IFNE 'N'                                       CGL018
     C           SWRWAC    ANDNE'Y'                                       CGL018
      *                                                                   CGL018
      ** Setup message data for message.                                  CGL018
      *                                                                   CGL018
     C                     MOVELSWRWAC    ZA0036                          CGL018
      *                                                                   CGL018
      ** Send error message.                                              CGL018
      *                                                                   CGL018
      * Send message 'Inval value - must be Y/N'                          CGL018
     C                     MOVEL'USR0805' ZAMSID                          CGL018
     C                     EXSR ZASNMS                                    CGL018
     C                     MOVE '1'       *IN99                           CGL018
     C                     MOVE '1'       *IN47                           CGL018
      *                                                                   CGL018
     C                     ENDIF                                          CGL018
     C                     ENDIF                                          CGL018
      * Validate input field for Securities Trading.
      * CASE: WRK.Securities is Yes
     C           WUSECS    IFEQ 'Y'                        *IF
      * CASE: DTL.Choose Securities Trading is Valid values
     C           #DCHST    IFEQ 'N'                        *IF
     C           #DCHST    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DCHST    ZA0037           Choose Securiti
      * Send message 'Inval value - must be Y/N'
     C                     MOVEL'USR0805' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9938  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate input field for Futures and Options.
      * CASE: WRK.Futures & Options is Yes
     C           WUFUOP    IFEQ 'Y'                        *IF
      * CASE: DTL.Choose Futures & Options is Valid values
     C           #DCHFO    IFEQ 'N'                        *IF
     C           #DCHFO    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DCHFO    ZA0038           Choose Futures
      * Send message 'Inval value - must be Y/N'
     C                     MOVEL'USR0805' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * 00/Copy member SD0014VCP4 - Client Details  *
     C/COPY WNCPYSRC,SD0014VCP4                                           S01212
      * Validate input field for Portfolio Management
      * CASE: WRK.Portfolio Management is Yes
     C           WUPFMG    IFEQ 'Y'                        *IF
      * CASE: DTL.Portfolio Management Scr is Valid values
     C           #DPMSC    IFEQ 'N'                        *IF
     C           #DPMSC    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DPMSC    ZA0039           Portfolio Manag
      * Send message 'Inval value - must be Y/N'
     C                     MOVEL'USR0805' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9940  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate input field for Portfolio Lending
      * CASE: WRK.Portfolio Lending is Yes
     C           WULMCR    IFEQ 'Y'                        *IF
      * CASE: DTL.Portfolio Lending Scr is Valid values
     C           #DPLSC    IFEQ 'N'                        *IF
     C           #DPLSC    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DPLSC    ZA0040           Portfolio Lendi
      * Send message 'Inval value - must be Y/N'
     C                     MOVEL'USR0805' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9941  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate input field for LEO
      * CASE: WRK.SAR S01467 is Present
     C           WUSSAR    IFEQ 'Y'                        *IF
      * CASE: DTL.LEO Function field is Valid values
     C           #DLEOF    IFEQ 'N'                        *IF
     C           #DLEOF    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DLEOF    ZA0041           LEO Function fi
      * Send message 'Inval value - must be Y/N'
     C                     MOVEL'USR0805' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9942  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Start of S01522
      * Validate input field for UDC
      * CASE: WRK.User Defined Correspondnc is Yes
     C           WUN1ST    IFEQ 'Y'                        *IF
      * CASE: DTL.UDC Function field is Valid values
     C           #DUDCF    IFEQ 'N'                        *IF
     C           #DUDCF    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DUDCF    ZA0042           UDC Function fi
      * Send message 'Inval value - must be Y/N'
     C                     MOVEL'USR0805' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9943  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * End of S01522
      * Start of change CTI001
      * Validate input field for TI Interface
      * CASE: WRK.Midas-Trade Innovation If is Yes
     C           WUN3ST    IFEQ 'Y'                        *IF
     C           CTI006    OREQ 'Y'                                                         MD030956
      * CASE: DTL.Call TI Customer Function is Valid values
     C           #DTICF    IFEQ 'N'                        *IF
     C           #DTICF    OREQ 'Y'
     C                     MOVEL#DTICF    P1TICS                                             BUG2664
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DTICF    ZA0043           Call TI Custome
      * Send message 'Inval value - must be Y/N'
     C                     MOVEL'USR0805' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9944  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * End of change CTI001
     C                     END                             *FI
      * Maintenance mode
      * CASE: PAR.Action Code is Maintenance mode
     C           P2ANCD    IFEQ 'A'                        *IF
     C           P2ANCD    OREQ 'D'
     C           P2ANCD    OREQ 'I'
      * Start of Fix S01267
      * Validate Customer Marketing.
      * CASE: DTL.Choose Customer Marketing is Maintenance
     C           #DCHCM    IFEQ 'D'                        *IF
     C           #DCHCM    OREQ 'N'
     C           #DCHCM    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DCHCM    ZA0044           Choose Customer
      * Send message 'Inval value - must be YND'
     C                     MOVEL'USR2480' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
      *                                                                                       CRN001
      * Validate Regulatory Reporting Select field.                                           CRN001
     C           CRN001    IFEQ 'Y'                                                           CRN001
     C           #DRGRP    IFNE 'Y'                                                           CRN001
     C           #DRGRP    ANDNE'N'                                                           CRN001
     C           #DRGRP    ANDNE'D'                                                           CRN001
     C                     MOVEL#DRGRP    ZA0044                                              CRN001
     C                     MOVEL'USR2480' ZAMSID                                              CRN001
     C                     EXSR ZASNMS                                                        CRN001
     C**********           SETON                     9948                            CRN001 BUG10154
     C                     SETON                     9949                                   BUG10154
     C                     ENDIF                                                              CRN001
     C                     ENDIF                                                              CRN001
      *                                                                                       CRN001
      * Start of change S01497.
      * Validate input field for Further Customer Details
      * CASE: WRK.SAR S01497 is Present
     C           WUFCSD    IFEQ 'Y'                        *IF
      * Check for valid values.
      * CASE: DTL.Further Customer Details is Maintenance
     C           #DFCUS    IFEQ 'N'                        *IF
     C           #DFCUS    OREQ 'Y'
     C           #DFCUS    OREQ 'D'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DFCUS    ZA0045           Further Custome
      * Send message 'Inval value - must be YND'
     C                     MOVEL'USR2480' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * End of change S01497.
      * Start of SAR S01421
      * Validate input field for Additional Customer Details
      * CASE: WRK.SAR S01425 is Present
     C           WUWSAR    IFEQ 'Y'                        *IF
      * CASE: DTL.Additional Cust Func Fld is Maintenance
     C           #DACFF    IFEQ 'D'                        *IF
     C           #DACFF    OREQ 'N'
     C           #DACFF    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DACFF    ZA0046           Additional Cust
      * Send message 'Inval value - must be YND'
     C                     MOVEL'USR2480' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate input field for Customer Fees
      * CASE: WRK.Display customer fees is Display
     C           WUDSCF    IFEQ 'Y'                        *IF
      * CASE: DTL.Customer Fees Func Fld is Maintenance
     C           #DCFFF    IFEQ 'D'                        *IF
     C           #DCFFF    OREQ 'N'
     C           #DCFFF    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DCFFF    ZA0047           Customer Fees F
      * Send message 'Inval value - must be YND'
     C                     MOVEL'USR2480' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9934  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * End of SAR S01421
      * End of Fix S01267
      * Start S01413
      * Customer Cheque and Safes details.
      * CASE: WRK.Retail 3 is Yes
     C           WUNXST    IFEQ 'Y'                        *IF
      * CASE: DTL.Choose Cheques and Cards is Maintenance
     C           #DCHCH    IFEQ 'D'                        *IF
     C           #DCHCH    OREQ 'N'
     C           #DCHCH    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DCHCH    ZA0048           Choose Cheques
      * Send message 'Inval value - must be YND'
     C                     MOVEL'USR2480' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
      *
     C                     END                             *FI
      * CASE: DTL.Choose Customer Safes is Maintenance
     C           #DCHSA    IFEQ 'D'                        *IF
     C           #DCHSA    OREQ 'N'
     C           #DCHSA    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DCHSA    ZA0049           Choose Customer
      * Send message 'Inval value - must be YND'
     C                     MOVEL'USR2480' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9936  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * End S01413
      * Start CDL002
      * Validate Input field for FX Netting
      * CASE: WRK.FX Netting switched on is Yes
     C           WUY9ST    IFEQ 'Y'                        *IF
      * CASE: DTL.FX Netting Dtls Func fld is Valid Values
     C           #DFXND    IFEQ 'N'                        *IF
     C           #DFXND    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DFXND    ZA0050           FX Netting Dtls
      * Send message 'FX Netting Input fld  INV'
     C                     MOVEL'USR3137' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * End CDL002
      *                                                                   CDL006
      ** Validate Fiduciary Details                                       CDL006
      *                                                                   CDL006
     C           WUFIDS    IFEQ 'Y'                                       CDL006
      *                                                                   CDL006
      ** If Fiduciary detail field is valid                               CDL006
      *                                                                   CDL006
     C           SFIDET    IFEQ 'N'                                       CDL006
     C           SFIDET    OREQ 'Y'                                       CDL006
     C                     ELSE                                           CDL006
      *                                                                   CDL006
      ** Setup message data for message                                   CDL006
      *                                                                   CDL006
     C                     MOVELSFIDET    ZA0050                          CDL006
      *                                                                   CDL006
      ** Send error message                                               CDL006
      *                                                                   CDL006
     C                     MOVEL'USR8614' ZAMSID                          CDL006
     C                     EXSR ZASNMS                                    CDL006
     C                     MOVE '1'       *IN99                           CDL006
     C                     MOVE '1'       *IN45                           CDL006
      *                                                                   CDL006
     C                     ENDIF                                          CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CSE023
      ** Validate Withholding tax details.                                CSE023
      *                                                                   CSE023
     C           WWITAX    IFEQ 'Y'                                       CSE023
      *                                                                   CSE023
      ** If withholding tax field is valid.                               CSE023
      *                                                                   CSE023
     C           SWITAX    IFNE 'N'                                       CSE023
     C           SWITAX    ANDNE'Y'                                       CSE023
      *                                                                   CSE023
      ** Setup message data for message                                   CSE023
      *                                                                   CSE023
     C                     MOVELSWITAX    ZA0050                          CSE023
      *                                                                   CSE023
      ** Send error message                                               CSE023
      *                                                                   CSE023
     C                     MOVEL'USR7502' ZAMSID                          CSE023
     C                     MOVEL'SDUSRMSG'ZAMSGF                          CSE023
     C                     EXSR ZASNMS                                    CSE023
     C                     MOVE '1'       *IN99                           CSE023
     C                     MOVE '1'       *IN46                           CSE023
      *                                                                   CSE023
     C                     ENDIF                                          CSE023
     C                     ENDIF                                          CSE023
      *                                                                   CSE023
      *                                                                                       CSD028
     C           CSD028    IFEQ 'Y'                                                           CSD028
      *                                                                                       CSD028
      ** If KYC Item is Valid                                                                 CSD028
      *                                                                                       CSD028
     C           #KYCIT    IFNE 'N'                                                           CSD028
     C           #KYCIT    ANDNE'Y'                                                           CSD028
      *                                                                                       CSD028
      ** Setup message data for message.                                                      CSD028
      *                                                                                       CSD028
     C                     MOVEL#KYCIT    ZA0036                                              CSD028
      *                                                                                       CSD028
      ** Send error message.                                                                  CSD028
      *                                                                                       CSD028
     C                     MOVEL'USR6005' ZAMSID                                              CSD028
     C                     MOVEL'SDUSRMSG'ZAMSGF                                              CSD028
     C                     EXSR ZASNMS                                                        CSD028
     C                     MOVE *ON       *IN99                                               CSD028
     C                     MOVE *ON       *IN48                                               CSD028
      *                                                                                       CSD028
     C                     ELSE                                                               CSD028
     C                     MOVEL#1CUST    WCCUS#                                              CSD028
     C********** WNCUS#    CHAINSDKYCIL0             51                              CSD028 BUG10603
     C           WNCUS#    CHAINSDKYCIL1             51                                     BUG10603
     C           *IN51     IFEQ *ON                                                           CSD028
     C           #KYCIT    ANDEQ'Y'                                                           CSD028
     C                     MOVEL'USR6011' ZAMSID                                              CSD028
     C                     MOVEL'SDUSRMSG'ZAMSGF                                              CSD028
     C                     EXSR ZASNMS                                                        CSD028
     C                     MOVE *ON       *IN99                                               CSD028
     C                     MOVE *ON       *IN48                                               CSD028
     C                     ENDIF                                                              CSD028
     C                     ENDIF                                                              CSD028
     C                     ENDIF                                                              CSD028
      *                                                                                       CSD028
      ** Validate Risk Weighted Assets codes                              CGL018
      *                                                                   CGL018
     C           WURWAC    IFEQ 'Y'                                       CGL018
      *                                                                   CGL018
      ** If withholding tax field is valid.                               CGL018
      *                                                                   CGL018
     C           SWRWAC    IFNE 'N'                                       CGL018
     C           SWRWAC    ANDNE'Y'                                       CGL018
      *                                                                   CGL018
      ** Setup message data for message                                   CGL018
      *                                                                   CGL018
     C                     MOVELSWRWAC    ZA0050                          CGL018
      *                                                                   CGL018
      ** Send error message                                               CGL018
      *                                                                   CGL018
      * Send message 'Inval value - must be Y/N'                          CGL018
     C                     MOVEL'USR0805' ZAMSID                          CGL018
     C                     EXSR ZASNMS                                    CGL018
     C                     MOVE '1'       *IN99                           CGL018
     C                     MOVE '1'       *IN47                           CGL018
      *                                                                   CGL018
     C                     ENDIF                                          CGL018
     C                     ENDIF                                          CGL018
      * Start of S01522
      * Validate input field for Securities Trading.
      * CASE: WRK.Securities is Yes
     C           WUSECS    IFEQ 'Y'                        *IF
      * CASE: DTL.Choose Securities Trading is maintenance
     C           #DCHST    IFEQ 'D'                        *IF
     C           #DCHST    OREQ 'N'
     C           #DCHST    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DCHST    ZA0051           Choose Securiti
      * Send message 'Inval value - must be YND'
     C                     MOVEL'USR2480' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9938  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate input field for Futures and Options.
      * CASE: WRK.Futures & Options is Yes
     C           WUFUOP    IFEQ 'Y'                        *IF
      * CASE: DTL.Choose Futures & Options is maintenance
     C           #DCHFO    IFEQ 'D'                        *IF
     C           #DCHFO    OREQ 'N'
     C           #DCHFO    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DCHFO    ZA0052           Choose Futures
      * Send message 'Inval value - must be YND'
     C                     MOVEL'USR2480' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * End of S01522
      * 00/Copy member SD0014VCP5 - Client Details  *
     C/COPY WNCPYSRC,SD0014VCP5                                           S01212
      * Start of S01486
      * Validate input field for Portfolio Management
      * CASE: WRK.Portfolio Management is Yes
     C           WUPFMG    IFEQ 'Y'                        *IF
      * CASE: DTL.Portfolio Management Scr is Maintenance
     C           #DPMSC    IFEQ 'D'                        *IF
     C           #DPMSC    OREQ 'N'
     C           #DPMSC    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DPMSC    ZA0053           Portfolio Manag
      * Send message 'Inval value - must be YND'
     C                     MOVEL'USR2480' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9940  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate input field for Portfolio Lending
      * CASE: WRK.Portfolio Lending is Yes
     C           WULMCR    IFEQ 'Y'                        *IF
      * CASE: DTL.Portfolio Lending Scr is Maintenance
     C           #DPLSC    IFEQ 'D'                        *IF
     C           #DPLSC    OREQ 'N'
     C           #DPLSC    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DPLSC    ZA0054           Portfolio Lendi
      * Send message 'Inval value - must be YND'
     C                     MOVEL'USR2480' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9941  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * End of S01486
      * Start of S01467
      * Validate input field for LEO Customer Details
      * CASE: WRK.SAR S01467 is Present
     C           WUSSAR    IFEQ 'Y'                        *IF
      * CASE: DTL.LEO Function field is Maintenance
     C           #DLEOF    IFEQ 'D'                        *IF
     C           #DLEOF    OREQ 'N'
     C           #DLEOF    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DLEOF    ZA0055           LEO Function fi
      * Send message 'Inval value - must be YND'
     C                     MOVEL'USR2480' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9942  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * End of S01467
      * Start of S01522
      * Validate input field for UDC Customer Details
      * CASE: WRK.User Defined Correspondnc is Yes
     C           WUN1ST    IFEQ 'Y'                        *IF
      * CASE: DTL.UDC Function field is Maintenence
     C           #DUDCF    IFEQ 'D'                        *IF
     C           #DUDCF    OREQ 'N'
     C           #DUDCF    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DUDCF    ZA0056           UDC Function fi
      * Send message 'Inval value - must be YND'
     C                     MOVEL'USR2480' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9943  *
      *
     C                     END                             *FI
      * 00/Copy member SD0014VC22 - Client Details  *
     C/COPY WNCPYSRC,SD0014VC22
     C                     END                             *FI
      * End of S01522
      * Hook SD0014VC13 moved and replaced with SD0014VCC1                S01408
     C*CO*Y*WN*PY*RC*SD0014VC13                                           S01408
     C/COPY WNCPYSRC,SD0014VCC1                                           S01408
      * Start of change CTI001
      * Validate input field for TI Interface
      * CASE: WRK.Midas-Trade Innovation If is Yes
     C           WUN3ST    IFEQ 'Y'                        *IF
     C           CTI006    OREQ 'Y'                                                         MD030956
      * CASE: DTL.Call TI Customer Function is Maintenance
     C           #DTICF    IFEQ 'D'                        *IF
     C           #DTICF    OREQ 'N'
     C           #DTICF    OREQ 'Y'
      * Get TI flag - Client Details  *
     C                     EXSR TDRVGN
     C                     MOVEL#DTICF    P1TICS                                             BUG2664
     C**********           Z-ADD1         YRSW03                          140709
     C**********           Z-ADD7         ZQ      50                      140709
     C********** YRSW03    IFLT 1                                         140709
     C********** ZQ        ORLT 1                                         140709
     C********** YRSW03    ORGT 00010                                     140709
     C********** ZQ        ORGT 00010                                     140709
     C**********           MOVEL'Y2U0510' W0RTN                           140709
     C**********           ELSE                                           140709
     C********** YRSW03    SUBST#1CSSN:ZQ WUTIS7    P  90  TI shortname po140709
     C***90*****           MOVEL'Y2U0510' W0RTN                           140709
     C**********           END                                            140709
      **If*the*customer*is*a*TI*customer*posn*7*must*be*blank**********   140709
      **CASE:**********************************************************   140709
      ***-*c1*AND*c2***************************************************   140709
      ****|-*c1****:*WRK.TI*shortname*position*7*is*Not*Blank**********   140709
      ****|-*c2****:*DTL.Call*TI*Customer*Function*is*Yes**************   140709
      ****'-***********************************************************   140709
     C**********           MOVEL'0'       Y0CX01  1                       140709
     C********** WUTIS7    IFNE *BLANK                     *IF            140709
     C********** #DTICF    IFEQ 'Y'                        *IF            140709
     C**********           MOVEL'1'       Y0CX01                          140709
     C**********           END                             *FI            140709
     C**********           END                             *FI            140709
     C********** Y0CX01    IFEQ '1'                        *IF            140709
      **Setup*message*data*for*message*********************************   140709
     C**********           MOVEL#DTICF    ZA0057           Call TI Custome140709
      **Send*message*'TI*Cust*not*valid'*******************************   140709
     C**********           MOVEL'USR3554' ZAMSID                          140709
     C**********           EXSR ZASNMS                                    140709
     C**********           SETON                     9944  *              140709
      **********                                                          140709
     C**********           END                             *FI            140709
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DTICF    ZA0058           Call TI Custome
      * Send message 'Inval value - must be YND'
     C                     MOVEL'USR2480' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9944  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * End of change CTI001
     C                     END                             *FI
      * End of change 076220
      * 00/Copy member SD0014VC10 - Client Details  *
     C/COPY WNCPYSRC,SD0014VC10                                           S01212
      * /COPY.
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy member SD0014VVFI - Client Details  *
     C*00/Copy member SD0014V   Validate Fields
     C/COPY WNCPYSRC,SD0014VVFI
     C                     END                             *FI
      * Bypass ref file checks if error already detected
     C   99                GOTO DBEXIT
      * Select existing record
     C                     EXSR VACKRL
      * Check reference to Location Codes
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Account Officers
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Country Codes
     C                     EXSR VDCKRL
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Country Codes
     C                     EXSR VECKRL
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Client Details
     C                     EXSR VFCKRL
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Branch Codes
     C                     EXSR VGCKRL
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Local Institutions
     C                     EXSR VHCKRL
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Local Industry Codes
     C                     EXSR VICKRL
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Customer Risk Weight Code
     C                     EXSR VJCKRL
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Message Type Descriptions
     C                     EXSR VKCKRL
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Message Type Descriptions
     C                     EXSR VLCKRL
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Message Type Descriptions
     C                     EXSR VMCKRL
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Message Type Descriptions
     C                     EXSR VNCKRL
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Message Type Descriptions
     C                     EXSR VOCKRL
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Message Type Descriptions
     C                     EXSR VPCKRL
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Message Type Descriptions
     C                     EXSR VQCKRL
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Message Type Descriptions
     C                     EXSR VRCKRL
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Message Type Descriptions
     C                     EXSR VSCKRL
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Message Type Descriptions
     C                     EXSR VTCKRL
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Message Type Descriptions
     C                     EXSR VUCKRL
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Message Type Descriptions
     C                     EXSR VVCKRL
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Message Type Descriptions
     C                     EXSR VWCKRL
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Message Type Descriptions
     C                     EXSR VXCKRL
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Message Type Descriptions
     C                     EXSR VYCKRL
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Message Network Details
     C                     EXSR VZCKRL
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Message Network Details
     C                     EXSR WACKRL
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Message Network Details
     C                     EXSR WBCKRL
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Message Network Details
     C                     EXSR WCCKRL
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Message Network Details
     C                     EXSR WDCKRL
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Message Network Details
     C                     EXSR WECKRL
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Message Network Details
     C                     EXSR WFCKRL
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Message Network Details
     C                     EXSR WGCKRL
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Message Network Details
     C                     EXSR WHCKRL
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CALC: Screen function fields
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy member SD0014VSFI - Client Details  *
     C*00/Copy member SD0014V   Calculate Function Flds
     C/COPY WNCPYSRC,SD0014VSFI
     C                     END                             *FI
      * USER: Validate relations
      * Start of change 076220
      * Maintenance mode
      * CASE: PAR.Action Code is Maintenance mode
     C           P2ANCD    IFEQ 'A'                        *IF
     C           P2ANCD    OREQ 'D'
     C           P2ANCD    OREQ 'I'
      * Start of S01522
      * Change 'D' to 'Y' for UDC.
      * CASE: DTL.UDC Function field is Delete
     C           #DUDCF    IFEQ 'D'                        *IF
     C                     MOVEL'Y'       #DUDCF           UDC Function fi
     C                     END                             *FI
      * End of S01522
      * CASE: PAR.Action Code is Delete
     C           P2ANCD    IFEQ 'D'                        *IF
      * Change 'D' to 'Y' for Customer Marketing.
      * CASE: DTL.Choose Customer Marketing is Delete
     C           #DCHCM    IFEQ 'D'                        *IF
     C                     MOVEL'Y'       #DCHCM           Choose Customer
     C                     END                             *FI
      *                                                                                       CRN001
      * Change 'D' to 'Y' for Regulatory Reporting.                                           CRN001
     C           #DRGRP    IFEQ 'D'                                                           CRN001
     C                     MOVEL'Y'       #DRGRP                                              CRN001
     C                     ENDIF                                                              CRN001
      *                                                                                       CRN001
      * Change 'D' to 'Y' for Further Customer Details.
      * CASE: DTL.Further Customer Details is Delete
     C           #DFCUS    IFEQ 'D'                        *IF
     C                     MOVEL'Y'       #DFCUS           Further Custome
     C                     END                             *FI
      * Change 'D' to 'Y' for Additional Customer Details.
      * CASE: DTL.Additional Cust Func Fld is Delete
     C           #DACFF    IFEQ 'D'                        *IF
     C                     MOVEL'Y'       #DACFF           Additional Cust
     C                     END                             *FI
      * Change 'D' to 'Y' for Customer Fees.
      * CASE: DTL.Customer Fees Func Fld is Delete
     C           #DCFFF    IFEQ 'D'                        *IF
     C                     MOVEL'Y'       #DCFFF           Customer Fees F
     C                     END                             *FI
      * Change 'D' to 'Y' for Customer Cheques.
      * CASE: DTL.Choose Cheques and Cards is Delete
     C           #DCHCH    IFEQ 'D'                        *IF
     C                     MOVEL'Y'       #DCHCH           Choose Cheques
     C                     END                             *FI
      * Change 'D' to 'Y' for Customer Safes.
      * CASE: DTL.Choose Customer Safes is Delete
     C           #DCHSA    IFEQ 'D'                        *IF
     C                     MOVEL'Y'       #DCHSA           Choose Customer
     C                     END                             *FI
      * Change 'D' to 'Y' for Securities Trading.
      * CASE: DTL.Choose Securities Trading is Delete
     C           #DCHST    IFEQ 'D'                        *IF
     C                     MOVEL'Y'       #DCHST           Choose Securiti
     C                     END                             *FI
      * Change 'D' to 'Y' for Futures and Options.
      * CASE: DTL.Choose Futures & Options is Delete
     C           #DCHFO    IFEQ 'D'                        *IF
     C                     MOVEL'Y'       #DCHFO           Choose Futures
     C                     END                             *FI
      * 00/Copy member SD0014VCP6 - Client Details  *
     C/COPY WNCPYSRC,SD0014VCP6                                           S01212
      * Change 'D' to 'Y' for Portfolio Management.
      * CASE: DTL.Portfolio Management Scr is Delete
     C           #DPMSC    IFEQ 'D'                        *IF
     C                     MOVEL'Y'       #DPMSC           Portfolio Manag
     C                     END                             *FI
      * Change 'D' to 'Y' for Portfolio Lending.
      * CASE: DTL.Portfolio Lending Scr is Delete
     C           #DPLSC    IFEQ 'D'                        *IF
     C                     MOVEL'Y'       #DPLSC           Portfolio Lendi
     C                     END                             *FI
      * Change 'D' to 'Y' for Leo.
      * CASE: DTL.LEO Function field is Delete
     C           #DLEOF    IFEQ 'D'                        *IF
     C                     MOVEL'Y'       #DLEOF           LEO Function fi
     C                     END                             *FI
      * Start of change CTI001
      * Change 'D' to 'Y' for TI Interface
      * CASE: DTL.Call TI Customer Function is Delete
     C           #DTICF    IFEQ 'D'                        *IF
     C                     MOVEL'Y'       #DTICF           Call TI Custome
     C                     END                             *FI
      * End of change CTI001
     C                     END                             *FI
      * S01267 - Amend processing for Customer Marketing Groups. If recor
      * does not already exist then program mode will change to Insert.
      * This is controlled in SD1421R.
      * Start of S01467
      * LEO Customer Details
      * CASE: DTL.LEO Function field is Yes
     C           #DLEOF    IFEQ 'Y'                        *IF
      * CASE: PAR.Action Code is Insert
     C           P2ANCD    IFEQ 'I'                        *IF
      * Check if there is a record for this customer on LEO files.
      * Build LEO Customer Number - Client Details  *
      *
      * Set up the LEO Customer number by adding two zeroes to
      * the begining of the Midas Customer number.
      *
     C                     MOVE *BLANK    WULCUN  80
     C                     MOVEL'00'      WULCUN
     C                     MOVE #1CUST    WULCUN
      *
      * Initialise 'Option for access object' field.
      *
     C                     MOVE *BLANK    WUEOTX  7
      *
     C                     MOVEL*BLANK    WUAPRC           Access Pgm Retu
     C                     MOVEL*BLANK    WUEOTX           Option for ACCO
     C                     MOVEL'*KEY'    WUEOTX           Option for ACCO
      * Call leo program CAOUCU - Customer LEO Details  *
     C                     CALL 'AOC0001'              90  Call leo progra
     C           WUAPRC    PARM WUAPRC    WQ0124  7        Access Pgm Retu
     C                     PARM WUEOTX    WQ0125  7        Option for ACCO
     C                     PARM WULCUN    WQ0126  80       LEO Customer (n
     C                     PARM WUKSTS    WQ0127  7        Key status
     C                     PARM WUSFMT    WQ0128256        Access object f
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'AOC0001' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * CASE: WRK.Access Pgm Return Code is AP No Record Found
     C           WUAPRC    IFEQ '*NRF'                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DLEOF    ZA0059           LEO Function fi
      * Send message 'LEO record already exists'
     C                     MOVEL'USR2304' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9942  *
      *
     C                     END                             *FI
     C                     MOVEL*BLANK    WUAPRC           Access Pgm Retu
     C                     MOVEL*BLANK    WUEOTX           Option for ACCO
     C                     MOVEL'*FREE'   WUEOTX           Option for ACCO
      * Call leo program CAOUCU - Customer LEO Details  *
     C                     CALL 'AOC0001'              90  Call leo progra
     C           WUAPRC    PARM WUAPRC    WQ0129  7        Access Pgm Retu
     C                     PARM WUEOTX    WQ0130  7        Option for ACCO
     C                     PARM WULCUN    WQ0131  80       LEO Customer (n
     C                     PARM WUKSTS    WQ0132  7        Key status
     C                     PARM WUSFMT    WQ0133256        Access object f
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'AOC0001' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
     C                     END                             *FI
      * End of S01467
      * Insert Action Code Processing
     C                     EXSR UASUBR                     Insert Action C
      * Delete Action Code Processing
     C                     EXSR UBSUBR                     Delete Action C
     C                     END                             *FI
      * End of change 076220
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy member SD0014VVRE - Client Details  *
     C*00/Copy member SD0014V   Validate Screen Relations
     C/COPY WNCPYSRC,SD0014VVRE
     C                     END                             *FI
      * Choose Customer Marketing required
     C           #DCHCM    IFEQ *BLANK                     IF
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *                                                                                       CRN001
      * Choose Regulatory Reporting                                                           CRN001
     C           CRN001    IFEQ 'Y'                                                           CRN001
     C           #DRGRP    IFEQ *BLANK                                                        CRN001
     C**********           SETON                     9948                            CRN001 BUG10154
     C                     SETON                     9949                                   BUG10154
     C                     MOVEL'Y2U0001' ZAMSID                                              CRN001
     C                     MOVEL'Y2USRMSG'ZAMSGF                                              CRN001
     C                     EXSR ZASNMS                                                        CRN001
     C                     ENDIF                                                              CRN001
     C                     ENDIF                                                              CRN001
      *                                                                                       CRN001
      * Further Customer Details required
     C           #DFCUS    IFEQ *BLANK                     IF
     C                     SETON                     9932  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * FX Netting Dtls Func fld required
     C           #DFXND    IFEQ *BLANK                     IF
     C                     SETON                     9937  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *                                                                   CDL006
      ** Fiduciary Details field required                                 CDL006
      *                                                                   CDL006
     C           SFIDET    IFEQ *BLANK                                    CDL006
     C           WUFIDS    ANDEQ'Y'                                       CDL006
     C                     MOVE '1'       *IN99                           CDL006
     C                     MOVE '1'       *IN45                           CDL006
      *                                                                   CDL006
      ** Send message '*Value required'                                   CDL006
      *                                                                   CDL006
     C                     MOVEL'Y2U0001' ZAMSID                          CDL006
     C                     MOVEL'Y2USRMSG'ZAMSGF                          CDL006
     C                     EXSR ZASNMS                                    CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CSE023
      ** Withholding tax field is required.                               CSE023
      *                                                                   CSE023
     C           SWITAX    IFEQ *BLANK                                    CSE023
     C           WWITAX    ANDEQ'Y'                                       CSE023
     C                     MOVE '1'       *IN99                           CSE023
     C                     MOVE '1'       *IN46                           CSE023
      *                                                                   CSE023
      ** Send message '*Value required'.                                  CSE023
      *                                                                   CSE023
     C                     MOVEL'Y2U0001' ZAMSID                          CSE023
     C                     MOVEL'Y2USRMSG'ZAMSGF                          CSE023
     C                     EXSR ZASNMS                                    CSE023
     C                     ENDIF                                          CSE023
      *                                                                   CSE023
      ** Risk Weighted Assets Codes field is required                     CGL018
      *                                                                   CGL018
     C           SWRWAC    IFEQ *BLANK                                    CGL018
     C           WURWAC    ANDEQ'Y'                                       CGL018
     C                     MOVE '1'       *IN99                           CGL018
     C                     MOVE '1'       *IN47                           CGL018
      *                                                                   CGL018
      ** Send message '*Value required'.                                  CGL018
      *                                                                   CGL018
     C                     MOVEL'Y2U0001' ZAMSID                          CGL018
     C                     MOVEL'Y2USRMSG'ZAMSGF                          CGL018
     C                     EXSR ZASNMS                                    CGL018
     C                     ENDIF                                          CGL018
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for screen
      *================================================================
      *                                                                   CDL006
      ** If WUFIDS is set to 'Y', set on *IN80 to display the             CDL006
      ** Fiduciary details                                                CDL006
      *                                                                   CDL006
     C                     MOVE '0'       *IN80                           CDL006
     C           WUFIDS    IFEQ 'Y'                                       CDL006
     C                     MOVE '1'       *IN80                           CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
      ** If WWITAX is set to 'Y', set on *IN81 to display the             CSE023
      ** Withholding tax field.                                           CSE023
      *                                                                   CSE023
     C                     MOVE '0'       *IN81                           CSE023
     C           WWITAX    IFEQ 'Y'                                       CSE023
     C                     MOVE '1'       *IN81                           CSE023
     C                     ENDIF                                          CSE023
      *                                                                   CSE023
      ** If WURWAC is set to 'Y', set on *IN82 to display the             CGL018
      ** Risk Weighted Assets Codes field                                 CGL018
      *                                                                   CGL018
     C                     MOVE '0'       *IN82                           CGL018
     C           WURWAC    IFEQ 'Y'                                       CGL018
     C                     MOVE '1'       *IN82                           CGL018
     C                     ENDIF                                          CGL018
      *                                                                   CSE023
     C**********           MOVE *ON       *IN83                                      CRN001 BUG10154
     C                     MOVE *ON       *IN84                                             BUG10154
     C           CRN001    IFEQ 'Y'                                                           CRN001
     C**********           MOVE *OFF      *IN83                                      CRN001 BUG10154
     C                     MOVE *OFF      *IN84                                             BUG10154
     C                     ENDIF                                                              CRN001
      *                                                                                       CRN001
      ** If CSD028 is set to 'Y', set on *IN83 to display the                                 CSD028
      ** KYC Item field                                                                       CSD028
      *                                                                                       CSD028
     C                     MOVE *OFF      *IN83                                               CSD028
     C           CSD028    IFEQ 'Y'                                                           CSD028
     C                     MOVE *ON       *IN83                                               CSD028
     C                     ENDIF                                                              CSD028
      *                                                                                       CSD028
     C                     MOVEL'0'       *IN79
     C           WUFCSD    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           WUWSAR    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           WUDSCF    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL'0'       *IN76
     C           WUNXST    IFEQ *BLANK                     *IF
     C           WUNXST    OREQ 'N'
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
     C                     MOVEL'0'       *IN75
     C           WUY9ST    IFEQ 'N'                        *IF
     C***********P2ANCD    OREQ 'I'                                                    225662 227847
     C                     MOVEL'1'       *IN75
     C                     END                             *FI
     C                     MOVEL'0'       *IN74
     C           WUDPIN    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN74
     C                     END                             *FI
     C                     MOVEL'0'       *IN73
     C           WUSECS    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN73
     C                     END                             *FI
     C                     MOVEL'0'       *IN72
     C           WUFUOP    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN72
     C                     END                             *FI
     C                     MOVEL'0'       *IN71
     C           WUPMSC    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN71
     C                     END                             *FI
     C                     MOVEL'0'       *IN70
     C           WULMCR    IFEQ *BLANK                     *IF
     C           WULMCR    OREQ 'N'
     C                     MOVEL'1'       *IN70
     C                     END                             *FI
     C                     MOVEL'0'       *IN69
     C           WUSSAR    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN69
     C                     END                             *FI
     C                     MOVEL'0'       *IN68
     C           WUN1ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN68
     C                     END                             *FI
     C/COPY WNCPYSRC,SD0014VC28
     C                     MOVEL'0'       *IN67
     C           WUN3ST    IFEQ 'N'                        *IF
     C           CTI006    OREQ 'N'                                                         MD030956
     C                     MOVEL'1'       *IN67
     C                     END                             *FI
      *                                                                                       CSD028
      ** If KYC Item set to 'Y', set on *IN83 to display the                                  CSD028
      ** KYC Item field                                                                       CSD028
      *                                                                                       CSD028
     C                     MOVE *OFF      *IN83                                               CSD028
     C           CSD028    IFEQ 'Y'                                                           CSD028
     C                     MOVE *ON       *IN83                                               CSD028
     C                     ENDIF                                                              CSD028
      *                                                                                       CSD028
     C/COPY WNCPYSRC,SD0014VC35
      *                                                                                       CSD093
      ** If CSD093 is set to 'Y', set on *IN87 to display the                                 CSD093
      ** Document Management Option                                                           CSD093
      *                                                                                       CSD093
     C                     MOVE '0'       *IN87                                               CSD093
     C           CSD093    IFEQ 'Y'                                                           CSD093
     C                     MOVE '1'       *IN87                                               CSD093
     C                     ENDIF                                                              CSD093
      *                                                                                       CSD093
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         MALDSC    BEGSR
      *================================================================
      * Load screen from passed parameters
      *================================================================
      *                                                                   CDL006
      ** If CDL006 is switched on, blank out field for Fiduciary Details  CDL006
      *                                                                   CDL006
     C           CDL006    IFEQ 'Y'                                       CDL006
     C                     MOVE *BLANKS   SFIDET                          CDL006
     C                     MOVE '0'       *IN45                           CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
      ** If CSE023 is switched on, blank out field for Withholding tax    CSE023
      *                                                                   CSE023
     C           CSE023    IFEQ 'Y'                                       CSE023
     C                     MOVE *BLANKS   SWITAX                          CSE023
     C                     MOVE '0'       *IN46                           CSE023
     C                     ENDIF                                          CSE023
      *                                                                   CSE023
      ** If CGL018 is switched on, blank out field for RWA Code           CGL018
      *                                                                   CGL018
     C           CGL018    IFEQ 'Y'                                       CGL018
     C                     MOVE *BLANKS   SWRWAC                          CGL018
     C                     MOVE '0'       *IN47                           CGL018
     C                     ENDIF                                          CGL018
      *                                                                   CSE023
     C                     MOVEL*BLANK    #DCSST           Customer shortn
     C                     MOVEL*BLANK    #1CNA1           Cust. Name & Ad
     C                     MOVEL*BLANK    #1CNA2           Cust. Name & Ad
     C                     MOVEL*BLANK    #1CNA3           Cust. Name & Ad
     C                     MOVEL*BLANK    #1CNA4           Cust. Name & Ad
     C                     MOVEL*BLANK    #1PAIN           Parent Indicato
     C                     MOVEL*BLANK    #1DRCS           DRS Customer Sh
     C                     MOVEL*BLANK    #1LCCD           Location Code
     C                     MOVEL*BLANK    #1ACOC           Account Officer
     C                     MOVEL*BLANK    #1CNCZ           Country of Citi
     C                     MOVEL*BLANK    #1COLC           Country of Loca
     C                     Z-ADD*ZERO     #1SSDT           Suspended Date
     C                     Z-ADD*ZERO     #1DOIC           Date of Initial
     C                     MOVEL*BLANK    #1PCNB           Parent Customer
     C                     MOVEL*BLANK    #1CASC           Customer Alpha
     C                     MOVEL*BLANK    #1BRCD           Branch code
     C                     MOVEL*BLANK    #1BNBI           Bank/non-bank I
     C                     MOVEL*BLANK    #1LINC           Local Instituti
     C                     MOVEL*BLANK    #1LICD           Local Industry
     C                     MOVEL*BLANK    #1CTNB           Customer Teleph
     C                     MOVEL*BLANK    #1REID           Reuter Id.
     C                     MOVEL*BLANK    #1BSIN           Branch/Subsidia
     C                     MOVEL*BLANK    #1CSTY           Customer Type
     C                     MOVEL*BLANK    #1TAIN           Taxable Indicat
     C                     MOVEL*BLANK    #1CSID           Customer Swift
     C                     MOVEL*BLANK    #1STAD           STTX Address
     C                     MOVEL*BLANK    #1TXA1           MIDAS Telex Sho
     C                     MOVEL*BLANK    #1TXA2           Telex Address 2
     C                     MOVEL*BLANK    #1TXA3           Telex Address 3
     C                     MOVEL*BLANK    #1TXA4           Telex Address 4
     C                     MOVEL*BLANK    #1TXA5           Telex Address 5
     C                     Z-ADD*ZERO     #1CHID           Chips Id
     C                     Z-ADD*ZERO     #1CHSC           Chaps sort code
     C                     Z-ADD*ZERO     #1CABA           Chips ABA
     C                     MOVEL*BLANK    #1BFIC           BOJ Fin. Inst.
     C                     MOVEL*BLANK    #1BLCD           Bankleitzahl Co
     C                     Z-ADD*ZERO     #1FWCD           Fedwire Code
     C                     Z-ADD*ZERO     #1LCD            Last Change Dat
     C                     MOVEL*BLANK    #1TYLC           Type of Last Ch
     C                     Z-ADD*ZERO     #1LALD           Last Audit Lett
     C                     Z-ADD*ZERO     #1LDHD           Last Dels Histo
     C                     Z-ADD*ZERO     #1LRLD           Last Retail Let
     C                     Z-ADD*ZERO     #1DTDL           Date Deleted
     C                     MOVEL*BLANK    #1LETI           LE Past/Int Tel
     C                     MOVEL*BLANK    #1CMTI           Customer Module
     C                     MOVEL*BLANK    #1GSFM           Generate SWIFT
     C                     MOVEL*BLANK    #1STFG           SWIFT or Telex
     C                     MOVEL*BLANK    #1RWCD           Risk Weighting
     C                     MOVEL*BLANK    #1NG01           Message Type No
     C                     MOVEL*BLANK    #1NG02           Message Type No
     C                     MOVEL*BLANK    #1NG03           Message Type No
     C                     MOVEL*BLANK    #1NG04           Message Type No
     C                     MOVEL*BLANK    #1NG05           Message Type No
     C                     MOVEL*BLANK    #1NG06           Message Type No
     C                     MOVEL*BLANK    #1NG07           Message Type No
     C                     MOVEL*BLANK    #1NG08           Message Type No
     C                     MOVEL*BLANK    #1NG09           Message Type No
     C                     MOVEL*BLANK    #1NG10           Message Type No
     C                     MOVEL*BLANK    #1NG11           Message Type No
     C                     MOVEL*BLANK    #1NG12           Message Type No
     C                     MOVEL*BLANK    #1NG13           Message Type No
     C                     MOVEL*BLANK    #1NG14           Message Type No
     C                     MOVEL*BLANK    #1NG15           Message Type No
     C                     MOVEL*BLANK    #1DS01           Default Status
     C                     MOVEL*BLANK    #1DS02           Default Status
     C                     MOVEL*BLANK    #1DS03           Default Status
     C                     MOVEL*BLANK    #1DS04           Default Status
     C                     MOVEL*BLANK    #1DS05           Default Status
     C                     MOVEL*BLANK    #1DS06           Default Status
     C                     MOVEL*BLANK    #1DS07           Default Status
     C                     MOVEL*BLANK    #1DS08           Default Status
     C                     MOVEL*BLANK    #1DS09           Default Status
     C                     MOVEL*BLANK    #1DS10           Default Status
     C                     MOVEL*BLANK    #1DS11           Default Status
     C                     MOVEL*BLANK    #1DS12           Default Status
     C                     MOVEL*BLANK    #1DS13           Default Status
     C                     MOVEL*BLANK    #1DS14           Default Status
     C                     MOVEL*BLANK    #1DS15           Default Status
     C                     MOVEL*BLANK    #1DNW1           Default Network
     C                     MOVEL*BLANK    #1DNW2           Default Network
     C                     MOVEL*BLANK    #1DNW3           Default Network
     C                     MOVEL*BLANK    #1DNW4           Default Network
     C                     MOVEL*BLANK    #1DNW5           Default Network
     C                     MOVEL*BLANK    #1DNW6           Default Network
     C                     MOVEL*BLANK    #1DNW7           Default Network
     C                     MOVEL*BLANK    #1DNW8           Default Network
     C                     MOVEL*BLANK    #1DNW9           Default Network
     C                     MOVEL*BLANK    #1CGRP           Retail Customer
     C                     MOVEL*BLANK    #1CDEL           Allow Deletion
     C                     Z-ADD*ZERO     #1ABA2           Chips ABA for C
     C                     MOVEL*BLANK    #1OGID           Midas Export Va
     C                     MOVEL*BLANK    #1SSDL           Stop Statement
     C                     Z-ADD*ZERO     #1ORED           Original entry
     C                     MOVEL*BLANK    #1MCAC           MA Analysis by
     C                     MOVEL*BLANK    #1CRPC           Corporate Custo
     C                     MOVEL*BLANK    #1PSWC           Pseudo SWIFT co
     C                     Z-ADD*ZERO     #1MGTP           Margin Type
     C                     MOVEL*BLANK    #1NET            Net Settlement
     C                     MOVEL*BLANK    #1NTGP           Netting Group
     C                     MOVEL*BLANK    #1NTCP           Net by Currency
     C                     Z-ADD*ZERO     #1NTND           Net Notice Days
     C                     MOVEL*BLANK    #1NTMM           Net Manual Matc
     C                     MOVELP1TICS    #1TICS           TI Customer Fla
     C                     MOVEL*BLANK    #1SWFI           SWIFT Financial
     C                     MOVELP1CUST    #1CUST           Customer Number
     C                     MOVELP1CSSN    #1CSSN           Customer Shortn
     C                     MOVELP1CRNM    #1CRNM           Customer Report
     C                     MOVELP1CRTN    #1CRTN           Customer Report
     C                     MOVEL*BLANK    #DCHCM           Choose Customer
     C                     MOVEL*BLANK    #DRGRP           Reg.Reporting                      CRN001
     C                     MOVEL*BLANK    #DFCUS           Further Custome
     C                     MOVEL*BLANK    #DACFF           Additional Cust
     C                     MOVEL*BLANK    #DCFFF           Customer Fees F
     C                     MOVEL*BLANK    #DCHCH           Choose Cheques
     C                     MOVEL*BLANK    #DCHSA           Choose Customer
     C/COPY WNCPYSRC,SD0014VC29
     C                     MOVEL*BLANK    #DFXND           FX Netting Dtls
     C                     MOVEL*BLANK    #DCHST           Choose Securiti
     C                     MOVEL*BLANK    #DCHFO           Choose Futures
     C                     MOVEL*BLANK    #DPMSC           Portfolio Manag
     C                     MOVEL*BLANK    #DPLSC           Portfolio Lendi
     C                     MOVEL*BLANK    #DLEOF           LEO Function fi
     C                     MOVEL*BLANK    #DUDCF           UDC Function fi
     C                     MOVEL*BLANK    #DTICF           Call TI Custome
      * CALC: Screen function fields
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy member SD0014VSFI - Client Details  *
     C*00/Copy member SD0014V   Calculate Function Flds
     C/COPY WNCPYSRC,SD0014VSFI
     C                     END                             *FI
      * USER: Load screen
      * 00/Copy member SD0014VC23 - Client Details  *
     C/COPY WNCPYSRC,SD0014VC23
      *                                                                   CDL006
      ** Move 'N' to Fiduciary Details field if CDL006 is switched on     CDL006
      *                                                                   CDL006
     C           CDL006    IFEQ 'Y'                                       CDL006
     C                     MOVE 'N'       SFIDET                          CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CSE023
      ** Move 'N' to Withholding tax field if CSE023 is switched on.      CSE023
      *                                                                   CSE023
     C           CSE023    IFEQ 'Y'                                       CSE023
     C                     MOVE 'N'       SWITAX                          CSE023
     C                     ENDIF                                          CSE023
      *                                                                   CSE023
      *                                                                                       CSD093
      ** Move 'N' to Document Management                                                      CSD093
      *                                                                                       CSD093
     C                     MOVE 'N'       #DDCMT                                              CSD093
      *                                                                                       CSD093
      ** Move 'N' to RWA Code field if CGL018 is switched on.             CGL018
      *                                                                   CGL018
     C           CGL018    IFEQ 'Y'                                       CGL018
     C                     MOVE 'N'       SWRWAC                          CGL018
     C                     ENDIF                                          CGL018
      * Start of change S01497.
     C                     MOVEL'N'       #DFCUS           Further Custome
      * End of change S01497.
      * Start of fix S01267
     C                     MOVEL'N'       #DCHCM           Choose Customer
      * End of fix S01267
      *                                                                                       CRN001
     C           CRN001    IFEQ 'Y'                                                           CRN001
     C                     MOVE 'N'       #DRGRP                                              CRN001
     C                     ENDIF                                                              CRN001
      * start S01413
     C                     MOVEL'N'       #DCHCH           Choose Cheques
     C                     MOVEL'N'       #DCHSA           Choose Customer
      * end S01413
      * Start of fix E19042
     C                     MOVEL'N'       #DCHST           Choose Securiti
     C                     MOVEL'N'       #DCHFO           Choose Futures
      * End of fix E19042
      * 00/Copy member SD0014VCP7 - Client Details  *
     C/COPY WNCPYSRC,SD0014VCP7                                           S01212
      * Start of SAR S01421
     C                     MOVEL'N'       #DACFF           Additional Cust
     C                     MOVEL'N'       #DCFFF           Customer Fees F
      * End of SAR S01421
      **********                                                                  BUG26917 BUG26917A
     C********** CER048    IFEQ 'Y'                                               BUG26917 BUG26917A
     C********** PDTAIN    ANDEQ'Y'                                               BUG26917 BUG26917A
     C********** P2ANCD    ANDNE'E'                                               BUG26917 BUG26917A
     C**********           MOVE 'Y'       #DACFF                                  BUG26917 BUG26917A
     C**********           ENDIF                                                  BUG26917 BUG26917A
      **********                                                                  BUG26917 BUG26917A
      * Start of S01486
     C                     MOVEL'N'       #DPMSC           Portfolio Manag
     C                     MOVEL'N'       #DPLSC           Portfolio Lendi
      * Start of S01486
      * Start of S01467
     C                     MOVEL'N'       #DLEOF           LEO Function fi
      * End of S01467
      * Start of S01522
     C                     MOVEL'N'       #DUDCF           UDC Function fi
      * End of S01522
      * Start of CDL002
     C                     MOVEL'N'       #DFXND           FX Netting Dtls
      * End of CDL002
     C                     MOVEL'N'       #KYCIT                                              CSD028
      * Start of change CTI001
     C           P2ANCD    IFEQ 'I'                                                          BUG6706
     C                     MOVEL'N'       #DTICF           Call TI Custome
     C                     ELSE                                                              BUG6706
      *                                                                                      BUG2664
      ** Display current value from SDCUSTPD passed as a parameter.                          BUG2664
      *                                                                                      BUG2664
     C                     MOVELP1TICS    #DTICF                                             BUG2664
     C                     ENDIF                                                             BUG6706
      * End of change CTI001
      * 00/Copy member SD0014VC24 - Client Details  *
     C/COPY WNCPYSRC,SD0014VC24
      *                                                                                       CER001
      ** Begin of PB3610                                                                      CER001
      *                                                                                       CER001
     C           PB3610    IFEQ 'Y'                                                           CER001
     C           P1FRNT    CHAINSDICEXL1             89                                       CER001
     C           *IN89     IFEQ *OFF                                                          CER001
     C                     MOVELPBSEDT    #DCHST                                              CER001
     C                     MOVELPBPLDT    #DPLSC                                              CER001
     C                     MOVELPBFFDT    #DCHFO                                              CER001
     C                     ENDIF                                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
      ** End of PB3610                                                                        CER001
      *                                                                                       CER001
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy member SD0014VLSR - Client Details  *
     C*00/Copy member SD0014V   Load Screen
     C/COPY WNCPYSRC,SD0014VLSR
     C                     END                             *FI
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Retrieve Client Marketing - Customer Marketing Groups  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           D7CUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1CUST    D7CUST           Customer Number
     C           KRSSA     CHAIN@D7REJB              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1478' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SAEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     END
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Check existance of Cust - Additional Customer Dtls  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           E5CUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1CUST    E5CUST           Customer Number
     C           KRSSB     CHAIN@ACUSL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1914' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     END
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Check cusromer fees exist - Customer Fees Detail  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           E6CUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1CUST    E6CUST           Customer Number
     C           KRSSC     CHAIN@CFCDL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1918' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     END
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Check if ST client - Securities Clients  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           BFCUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1CUST    BFCUST           Customer Number
     C           KRSSD     CHAIN@BFREDQ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0094' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     END
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Check if F&O Customer - Futures & Options Clients  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           BHCUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1CUST    BHCUST           Customer Number
     C           KRSSE     CHAIN@BHRED1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0174' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SEEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     END
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Check for Non Deleted PM - Portfolio Manag Cust Dtls  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           QBCUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1CUST    QBCUST           Customer Number
     C           KRSSF     CHAIN@PLCSL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2322' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SFEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Check whether it is a live record.
      * CASE: DB1.Type of Last Change is Delete
     C           QBTYLC    IFEQ 'D'                        *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Does Portfilio/L exist? - Portfolio Lend Cust Dtls  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           CUCUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1CUST    CUCUST           Customer Number
     C           KRSSG     CHAIN@LBCSL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2320' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     END
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Check existence of Cust. - Customer LEO Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           FGCUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1CUST    FGCUST           Customer Number
     C           KRSSH     CHAIN@CLEOL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2335' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SHEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     END
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Check for TI customer ref - Trade Innov Cust Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           TCCUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1CUST    TCCUST           Customer Number
     C           KRSSI     CHAIN@TICSL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3506' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SIEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     END
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Retrieve Client Marketing - Customer Marketing Groups  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           D7CUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1CUST    D7CUST           Customer Number
     C           KRSSJ     CHAIN@D7REJB              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1478' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SJEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     END
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Retrieve Client Marketing - Customer Marketing Groups  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           D7CUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1CUST    D7CUST           Customer Number
     C           KRSSK     CHAIN@D7REJB              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1478' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SKEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     END
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Check existance of Cust - Additional Customer Dtls  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           E5CUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1CUST    E5CUST           Customer Number
     C           KRSSL     CHAIN@ACUSL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1914' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SLEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     END
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Check existance of Cust - Additional Customer Dtls  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           E5CUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1CUST    E5CUST           Customer Number
     C           KRSSM     CHAIN@ACUSL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1914' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SMEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     END
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Check cusromer fees exist - Customer Fees Detail  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           E6CUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1CUST    E6CUST           Customer Number
     C           KRSSN     CHAIN@CFCDL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1918' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SNEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     END
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Check cusromer fees exist - Customer Fees Detail  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           E6CUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1CUST    E6CUST           Customer Number
     C           KRSSO     CHAIN@CFCDL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1918' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SOEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     END
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * retrieve client - Securities Clients  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           BFCUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1CUST    BFCUST           Customer Number
     C           KRSSP     CHAIN@BFREDQ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0094' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SPEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     END
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Check if ST client - Securities Clients  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           BFCUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1CUST    BFCUST           Customer Number
     C           KRSSQ     CHAIN@BFREDQ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0094' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SQEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     END
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * retrieve client - Futures & Options Clients  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           BHCUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1CUST    BHCUST           Customer Number
     C           KRSSR     CHAIN@BHRED1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0174' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SREXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     END
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Check if F&O Customer - Futures & Options Clients  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           BHCUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1CUST    BHCUST           Customer Number
     C           KRSSS     CHAIN@BHRED1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0174' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SSEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     END
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Check for Non Deleted PM - Portfolio Manag Cust Dtls  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           QBCUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1CUST    QBCUST           Customer Number
     C           KRSST     CHAIN@PLCSL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2322' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO STEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Check whether it is a live record.
      * CASE: DB1.Type of Last Change is Delete
     C           QBTYLC    IFEQ 'D'                        *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Does Porfolio/M exist? - Portfolio Manag Cust Dtls  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           QBCUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1CUST    QBCUST           Customer Number
     C           KRSSU     CHAIN@PLCSL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2322' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SUEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     END
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Check for Non Deleted PM - Portfolio Manag Cust Dtls  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           QBCUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1CUST    QBCUST           Customer Number
     C           KRSSV     CHAIN@PLCSL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2322' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SVEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Check whether it is a live record.
      * CASE: DB1.Type of Last Change is Delete
     C           QBTYLC    IFEQ 'D'                        *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Does Portfilio/L exist? - Portfolio Lend Cust Dtls  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           CUCUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1CUST    CUCUST           Customer Number
     C           KRSSW     CHAIN@LBCSL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2320' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SWEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     END
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * Does Portfilio/L exist? - Portfolio Lend Cust Dtls  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           CUCUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1CUST    CUCUST           Customer Number
     C           KRSSX     CHAIN@LBCSL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2320' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SXEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     END
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * Check existence of Cust. - Customer LEO Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           FGCUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1CUST    FGCUST           Customer Number
     C           KRSSY     CHAIN@CLEOL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2335' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SYEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     END
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * Check existence of Cust. - Customer LEO Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           FGCUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1CUST    FGCUST           Customer Number
     C           KRSSZ     CHAIN@CLEOL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2335' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SZEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     END
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * Check for TI customer ref - Trade Innov Cust Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           TCCUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1CUST    TCCUST           Customer Number
     C           KRSTA     CHAIN@TICSL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3506' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TAEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     END
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * Check for TI customer ref - Trade Innov Cust Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           TCCUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1CUST    TCCUST           Customer Number
     C           KRSTB     CHAIN@TICSL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3506' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TBEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     END
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * Check for TI customer ref - Trade Innov Cust Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           TCCUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1CUST    TCCUST           Customer Number
     C           KRSTC     CHAIN@TICSL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3506' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TCEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     END
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * Get TI flag - Client Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           BBCUST           Customer Number
      * Move fields to key list
     C                     MOVELP1CUST    BBCUST           Customer Number
     C           KRSTD     CHAIN@BBREBF              90    *
      * Data record not found
     C   90                MOVEL'USR0081' W0RTN   7
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * Check existance of Cust - Additional Customer Dtls  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           E5CUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1CUST    E5CUST           Customer Number
     C           KRSTE     CHAIN@ACUSL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1914' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TEEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     END
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * Check cusromer fees exist - Customer Fees Detail  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           E6CUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1CUST    E6CUST           Customer Number
     C           KRSTF     CHAIN@CFCDL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1918' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TFEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     END
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * Check if ST client - Securities Clients  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           BFCUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1CUST    BFCUST           Customer Number
     C           KRSTG     CHAIN@BFREDQ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0094' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TGEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     END
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * Check if F&O Customer - Futures & Options Clients  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           BHCUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1CUST    BHCUST           Customer Number
     C           KRSTH     CHAIN@BHRED1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0174' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO THEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     END
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * Does Porfolio/M exist? - Portfolio Manag Cust Dtls  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTI     KLIST
     C                     KFLD           QBCUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1CUST    QBCUST           Customer Number
     C           KRSTI     CHAIN@PLCSL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2322' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TIEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     END
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * Does Portfilio/L exist? - Portfolio Lend Cust Dtls  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           CUCUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1CUST    CUCUST           Customer Number
     C           KRSTJ     CHAIN@LBCSL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2320' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TJEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     END
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKRVGN    BEGSR
      *================================================================
      * Check for TI customer ref - Trade Innov Cust Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTK     KLIST
     C                     KFLD           TCCUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1CUST    TCCUST           Customer Number
     C           KRSTK     CHAIN@TICSL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3506' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TKEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     END
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLRVGN    BEGSR
      *================================================================
      * Retrieve Client Marketing - Customer Marketing Groups  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTL     KLIST
     C                     KFLD           D7CUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1CUST    D7CUST           Customer Number
     C           KRSTL     CHAIN@D7REJB              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1478' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TLEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     END
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMRVGN    BEGSR
      *================================================================
      * Check existance of Cust - Additional Customer Dtls  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTM     KLIST
     C                     KFLD           E5CUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1CUST    E5CUST           Customer Number
     C           KRSTM     CHAIN@ACUSL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1914' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TMEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     END
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNRVGN    BEGSR
      *================================================================
      * Check cusromer fees exist - Customer Fees Detail  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTN     KLIST
     C                     KFLD           E6CUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1CUST    E6CUST           Customer Number
     C           KRSTN     CHAIN@CFCDL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1918' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TNEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     END
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TORVGN    BEGSR
      *================================================================
      * Check if ST client - Securities Clients  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTO     KLIST
     C                     KFLD           BFCUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1CUST    BFCUST           Customer Number
     C           KRSTO     CHAIN@BFREDQ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0094' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TOEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     END
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPRVGN    BEGSR
      *================================================================
      * Check if F&O Customer - Futures & Options Clients  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTP     KLIST
     C                     KFLD           BHCUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1CUST    BHCUST           Customer Number
     C           KRSTP     CHAIN@BHRED1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0174' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TPEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     END
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQRVGN    BEGSR
      *================================================================
      * Does Porfolio/M exist? - Portfolio Manag Cust Dtls  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTQ     KLIST
     C                     KFLD           QBCUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1CUST    QBCUST           Customer Number
     C           KRSTQ     CHAIN@PLCSL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2322' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TQEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     END
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         TRRVGN    BEGSR
      *================================================================
      * Does Portfilio/L exist? - Portfolio Lend Cust Dtls  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTR     KLIST
     C                     KFLD           CUCUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1CUST    CUCUST           Customer Number
     C           KRSTR     CHAIN@LBCSL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2320' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TREXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     END
      *================================================================
     CSR         TREXIT    ENDSR
      /EJECT
     CSR         TSRVGN    BEGSR
      *================================================================
      * Check existence of Cust. - Customer LEO Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTS     KLIST
     C                     KFLD           FGCUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1CUST    FGCUST           Customer Number
     C           KRSTS     CHAIN@CLEOL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2335' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TSEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     END
      *================================================================
     CSR         TSEXIT    ENDSR
      /EJECT
     CSR         TTRVGN    BEGSR
      *================================================================
      * Check for TI customer ref - Trade Innov Cust Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTT     KLIST
     C                     KFLD           TCCUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1CUST    TCCUST           Customer Number
     C           KRSTT     CHAIN@TICSL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3506' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TTEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     END
      *================================================================
     CSR         TTEXIT    ENDSR
      /EJECT
     CSR         TURVGN    BEGSR
      *================================================================
      * Get all Midas Modules - MIDAS Modules  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTU     KLIST
     C                     KFLD           BGMODS           Modules
      * Move fields to key list
     C                     MOVE *BLANK    BGMODS           Modules
     C                     MOVEL'MMOD'    BGMODS           Modules
     C           KRSTU     CHAIN@BGREC8              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0096' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * Setup message data for message
     C                     MOVEL'SDMMODPD'ZA0075           Filename
      * Send message 'Database Error (ICD)'
     C                     MOVEL'USR0377' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO TUEXIT                     *QUIT
     C                     GOTO TUEXIT
     C                     END
      *
      * USER: Exit processing
      * PAR = DB1 By name
     C                     MOVELBGMTMI    WUMTMI           Midas/Telex Mod
     C                     MOVELBGSWFT    WUSWFT           SWIFT Funds Tra
     C                     MOVELBGSWST    WUSWST           SWIFT Securitie
     C                     MOVELBGSWCL    WUSWCL           SWIFT Customer
     C                     MOVELBGSWSL    WUSWSL           SWIFT Synd Loan
     C                     MOVELBGSWSM    WUSWSM           SWIFT Statement
     C                     MOVELBGSWDL    WUSWDL           SWIFT Dealing
     C                     MOVELBGSDGL    WUSDGL           Standing data/G
     C                     MOVELBGDLFX    WUDLFX           Dealing: FX
     C                     MOVELBGSYLN    WUSYLN           Syndicated Loan
     C                     MOVELBGEXMG    WUEXMG           Exposure Manage
     C                     MOVELBGFNMO    WUFNMO           Financial Model
     C                     MOVELBGSTRT    WUSTRT           Statutory Retur
     C                     MOVELBGCSLN    WUCSLN           Customer Lendin
     C                     MOVELBGRTBN    WURTBN           Retail Banking
     C                     MOVELBGMSDL    WUMSDL           Midas/Swift dir
     C                     MOVELBGSECS    WUSECS           Securities
     C                     MOVELBGAURC    WUAURC           Auto-reconcilia
     C                     MOVELBGBDLI    WUBDLI           Bond Dealers In
     C                     MOVELBGDRSD    WUDRSD           DRS Standing Da
     C                     MOVELBGDRCM    WUDRCM           DRS Control mod
     C                     MOVELBGDRFE    WUDRFE           DRS Foreign Exc
     C                     MOVELBGDRMM    WUDRMM           DRS Money Marke
     C                     MOVELBGDRAR    WUDRAR           DRS Arbitrage
     C                     MOVELBGFDTR    WUFDTR           Funds Transfer
     C                     MOVELBGDRCA    WUDRCA           DRS Common Appl
     C                     MOVELBGFUOP    WUFUOP           Futures & Optio
     C                     MOVELBGMTSL    WUMTSL           Midas/Telex Syn
     C                     MOVELBGMTDL    WUMTDL           Midas/Telex Dea
     C                     MOVELBGMTGL    WUMTGL           Midas/Telex Gen
     C                     MOVELBGMTCL    WUMTCL           Midas/Telex Cus
     C                     MOVELBGNWMI    WUNWMI           Message Managem
     C                     MOVELBGFIIN    WUFIIN           FRA/IRS Indicat
     C                     MOVELBGDLMM    WUDLMM           Dealing: MM
     C                     MOVELBGINCN    WUINCN           Internal Contra
     C                     MOVELBGTRMG    WUTRMG           Treasury Manage
     C                     MOVELBGRKMG    WURKMG           Interest Risk M
     C                     MOVELBGTSKY    WUTSKY           Testkey
     C                     MOVELBGMIDQ    WUMIDQ           Midas/Q
     C                     MOVELBGMFIC    WUMFIC           Microfiche
     C                     MOVELBGIOAC    WUIOAC           Interest on acc
     C                     MOVELBGWDPR    WUWDPR           Window processi
     C                     MOVELBGSARP    WUSARP           SAR's processin
     C                     MOVELBGFRIN    WUFRIN           French return i
     C                     MOVELBGLRIN    WULRIN           Lux return indi
     C                     MOVELBGDRIN    WUDRIN           Dutch return in
     C                     MOVELBGGRIN    WUGRIN           German return i
     C                     MOVELBGBRIN    WUBRIN           Belgian return
     C                     MOVELBGIRIN    WUIRIN           Italian return
     C                     MOVELBGSWEI    WUSWEI           Swift External
     C                     MOVELBGPFMG    WUPFMG           Portfolio Manag
     C                     MOVELBGCRMG    WUCRMG           Credit Manageme
     C                     MOVELBGHORP    WUHORP           Head Office Rep
     C                     MOVELBGAVBL    WUAVBL           Average Balance
     C                     MOVELBGMARG    WUMARG           Margins
     C                     MOVELBGCFMT    WUCFMT           Confirmation Ma
     C                     MOVELBGMIMX    WUMIMX           Mimix
     C                     MOVELBGRCFI    WURCFI           Report Control
     C                     MOVELBGAMIN    WUAMIN           Amps Int
     C                     MOVELBGSWRT    WUSWRT           Swiss Returns
     C                     MOVELBGFLND    WUFLND           Fiduciary Loans
     C                     MOVELBGLMCR    WULMCR           Portfolio Lendi
     C                     MOVELBGCNTX    WUCNTX           Cantonal Tax
     C                     MOVELBGSTDU    WUSTDU           Stamp Duty
     C                     MOVELBGUDRS    WUUDRS           Use DRS Shortna
     C                     MOVELBGCHDL    WUCHDL           Chips Dealing
     C                     MOVELBGCHLN    WUCHLN           Chips Lending
     C                     MOVELBGCHOB    WUCHOB           Chips Opening B
     C                     MOVELBGCHIP    WUCHIP           CHIPS
     C                     MOVELBGCHDI    WUCHDI           Chips Direct Li
     C                     MOVELBGOPDK    WUOPDK           Optical Disk
     C                     MOVELBGMBIN    WUMBIN           Multi-branching
     C                     MOVELBGNNST    WUNNST           Leo Data Nucleu
     C                     MOVELBGNOST    WUNOST           Leo Letters of
     C                     MOVELBGNPST    WUNPST           Leo Collections
     C                     MOVELBGNQST    WUNQST           Leo Bills/Finan
     C                     MOVELBGNRST    WUNRST           Leo Bankers Acc
     C                     MOVELBGNSST    WUNSST           Leo Reimburseme
     C                     MOVELBGNTST    WUNTST           Taxes
     C                     MOVELBGNUST    WUNUST           History & Audit
     C                     MOVELBGNVST    WUNVST           Management Acco
     C                     MOVELBGNWST    WUNWST           IBLC Returns
     C                     MOVELBGNXST    WUNXST           Retail 3
     C                     MOVELBGNYST    WUNYST           Interest on Acc
     C                     MOVELBGNZST    WUNZST           Midas Export Da
     C                     MOVELBGN0ST    WUN0ST           Analytical Acco
     C                     MOVELBGN1ST    WUN1ST           User Defined Co
     C                     MOVELBGN2ST    WUN2ST           Midas-Plato Int
     C                     MOVELBGN3ST    WUN3ST           Midas-Trade Inn
     C                     MOVELBGN4ST    WUN4ST           Reserved for La
     C                     MOVELBGN5ST    WUN5ST           Reserved for La
     C                     MOVELBGN6ST    WUN6ST           Reserved for La
     C                     MOVELBGN7ST    WUN7ST           Reserved for La
     C                     MOVELBGN8ST    WUN8ST           Reserved for La
     C                     MOVELBGN9ST    WUN9ST           Reserved for La
     C                     MOVELBGOAST    WUOAST           Reserved for La
     C                     MOVELBGOBST    WUOBST           Reserved for La
     C                     MOVELBGOCST    WUOCST           Reserved for La
     C                     MOVELBGODST    WUODST           Reserved for La
     C                     MOVELBGOEST    WUOEST           Reserved for La
     C                     MOVELBGOFST    WUOFST           Reserved for La
     C                     MOVELBGOGST    WUOGST           Reserved for La
     C                     MOVELBGOHST    WUOHST           Reserved for La
     C                     MOVELBGOIST    WUOIST           Reserved for La
     C                     MOVELBGOJST    WUOJST           Reserved for La
     C                     MOVELBGOKST    WUOKST           Reserved for La
     C                     MOVELBGOLST    WUOLST           Reserved for La
     C                     MOVELBGOMST    WUOMST           Reserved for La
     C                     MOVELBGONST    WUONST           Reserved for La
     C                     MOVELBGOOST    WUOOST           Reserved for La
     C                     MOVELBGOPST    WUOPST           Reserved for La
     C                     MOVELBGOQST    WUOQST           Reserved for La
     C                     MOVELBGORST    WUORST           Reserved for La
     C                     MOVELBGOSST    WUOSST           Reserved for La
      *================================================================
     CSR         TUEXIT    ENDSR
      /EJECT
     CSR         TVRVGN    BEGSR
      *================================================================
      * Get Port Man ICD fields - Portfolio Management ICD  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTV     KLIST
     C                     KFLD           FCPORT           Portfolio Manag
      * Move fields to key list
     C                     MOVE *BLANK    FCPORT           Portfolio Manag
     C                     MOVEL'PORT'    FCPORT           Portfolio Manag
     C           KRSTV     CHAIN@PORTL1              90    *
      * Data record not found
     C   90                MOVEL'USR2284' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELFCR997    WUR997           Ref Attached to
     C                     MOVELFCPORS    WUPORS           Portfolios Supp
     C                     END
      *================================================================
     CSR         TVEXIT    ENDSR
      /EJECT
     CSR         TWRVGN    BEGSR
      *================================================================
      * Retrieve Int Cust Branch - Branch Codes  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WABICN    WQTW01           Branch Internal
      * Define keylist
     C           KRSTW     KLIST
     C                     KFLD           WQTW01           Branch Internal
      * Move fields to key list
     C                     MOVELP1CUST    WQTW01           Branch Internal
     C           KRSTW     SETLL@BRCHFM                    *
     C           KRSTW     READE@BRCHFM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0075' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO TWEXIT
     C                     END
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'BRANCH'  W0RTN            *Return code
     C           KRSTW     READE@BRCHFM                  90*
     C                     END
      *================================================================
     CSR         TWEXIT    ENDSR
      /EJECT
     C           TXRVGN    BEGSR                                                              CRN001
      *                                                                                       CRN001
     C           #DRGRP    IFEQ 'D'                                                           CRN001
     C                     MOVE 'D'       ACTION                                              CRN001
     C                     ELSE                                                               CRN001
     C                     MOVE P2ANCD    ACTION                                              CRN001
     C                     ENDIF                                                              CRN001
      *                                                                                       CRN001
     C*****                CALL 'SD000040'                                            CRN001 BUG9233
     C                     CALL 'SD000040'             90                                    BUG9233
     C                     PARM *BLANKS   RTNMSG  7                                           CRN001
     C                     PARM P1CUST    PCUST   7                                           CRN001
     C                     PARM           ACTION  1                                           CRN001
      *                                                                                       CRN001
     C           *IN90     IFEQ '1'                                                          BUG9233
      * Call to program ended in error                                                       BUG9233
     C                     MOVEL'Y2U0032' W0RTN                                              BUG9233
     C                     MOVEL*BLANKS   W0CLPG 10                                          BUG9233
     C                     MOVEL'SD000040'W0CLPG                                             BUG9233
      * Send message '*Error occured on CALL...'                                             BUG9233
     C                     MOVEL'Y2U0032' ZAMSID                                             BUG9233
     C                     MOVEL'Y2USRMSG'ZAMSGF                                             BUG9233
     C                     MOVELW0CLPG    ZAMSDA           Message data                      BUG9233
     C                     EXSR ZASNMS                                                       BUG9233
     C                     END                                                               BUG9233
      *                                                                                      BUG9233
     C                     SELEC                                                              CRN001
     C           RTNMSG    WHEQ *BLANKS                                                       CRN001
      *                                                                                       CRN001
      *  *Return code is *User QUIT requested                                                BUG9233
     C           RTNMSG    WHEQ 'Y2U9999'                                                    BUG9233
     C                     MOVEL'USR0790' P0RTN            *Return code                      BUG9233
     C                     EXSR ZYEXPG                                                       BUG9233
      *                                                                                      BUG9233
     C           RTNMSG    WHEQ '*ERROR'                                                      CRN001
     C                     EXSR *PSSR                                                         CRN001
      *                                                                                       CRN001
     C                     OTHER                                                              CRN001
     C                     MOVE RTNMSG    ZAMSID                                              CRN001
     C                     EXSR ZASNMS                                                        CRN001
     C                     ENDSL                                                              CRN001
      *                                                                                       CRN001
     C                     MOVE 'N'       #DRGRP                                              CRN001
     C                     MOVEL'Y'       WUF8OS                                              CRN001
      *                                                                                       CRN001
     C                     ENDSR                                                              CRN001
      /EJECT                                                                                  CRN001
     C***SR*****    SRACUS    BEGSR                                               BUG26917 BUG26917A
      **********=======================================================           BUG26917 BUG26917A
      **********                                                                  BUG26917 BUG26917A
     C**********           CALL 'AOACUSR0'                                        BUG26917 BUG26917A
     C**********           PARM *BLANKS   @RTCD                                   BUG26917 BUG26917A
     C**********           PARM '*KEY   ' @OPTN                                   BUG26917 BUG26917A
     C**********           PARM P1CUST    PCUST1  6                               BUG26917 BUG26917A
     C**********           PARM SDACUS    DSLDY                                   BUG26917 BUG26917A
      **********                                                                  BUG26917 BUG26917A
     C********** @RTCD     IFNE *BLANKS                                           BUG26917 BUG26917A
     C**********           MOVE 'N'       ACUSRC  1                               BUG26917 BUG26917A
     C**********           ELSE                                                   BUG26917 BUG26917A
     C**********           MOVE 'Y'       ACUSRC                                  BUG26917 BUG26917A
     C**********           ENDIF                                                  BUG26917 BUG26917A
      **********                                                                  BUG26917 BUG26917A
     C**********           ENDSR                                                  BUG26917 BUG26917A
      ***/EJECT                                                                   BUG26917 BUG26917A
     CSR         UASUBR    BEGSR
      *================================================================
      * Insert Action Code Processing
      *================================================================
      * Start of Fix S01267
      * Change 088433 - Remove Marketing Information record existance che
      * Start of S01421
      * Additional customer details
      * CASE: DTL.Additional Cust Func Fld is Yes
     C           #DACFF    IFEQ 'Y'                        *IF
      * CASE: PAR.Action Code is Insert
     C           P2ANCD    IFEQ 'I'                        *IF
      * Check existance of Cust - Additional Customer Dtls  *
     C                     EXSR TERVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DACFF    ZA0060           Additional Cust
      * Send message 'Additional Customer Dt EX'
     C                     MOVEL'USR1915' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Customer fees
      * CASE: DTL.Customer Fees Func Fld is Yes
     C           #DCFFF    IFEQ 'Y'                        *IF
      * CASE: PAR.Action Code is Insert
     C           P2ANCD    IFEQ 'I'                        *IF
      * Check cusromer fees exist - Customer Fees Detail  *
     C                     EXSR TFRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DCFFF    ZA0061           Customer Fees F
      * Send message 'Customer Fees Detail   EX'
     C                     MOVEL'USR1919' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9934  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * End of S01421
      * End of Fix S01267
      * Securities Trading
      * CASE: DTL.Choose Securities Trading is Yes
     C           #DCHST    IFEQ 'Y'                        *IF
      * CASE: PAR.Action Code is Insert
     C           P2ANCD    IFEQ 'I'                        *IF
      * Check if ST client - Securities Clients  *
     C                     EXSR TGRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message '*Record already exists'
     C                     MOVEL'Y2U0003' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Futures & Options
      * CASE: DTL.Choose Futures & Options is Yes
     C           #DCHFO    IFEQ 'Y'                        *IF
      * CASE: PAR.Action Code is Insert
     C           P2ANCD    IFEQ 'I'                        *IF
      * Check if F&O Customer - Futures & Options Clients  *
     C                     EXSR THRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message '*Record already exists'
     C                     MOVEL'Y2U0003' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 00/Copy member SD0014VCP8 - Client Details  *
     C/COPY WNCPYSRC,SD0014VCP8                                           S01212
      * Start of S01486
      * Portfolio Management
      * CASE: DTL.Portfolio Management Scr is Yes
     C           #DPMSC    IFEQ 'Y'                        *IF
      * CASE: PAR.Action Code is Insert
     C           P2ANCD    IFEQ 'I'                        *IF
      * Does Porfolio/M exist? - Portfolio Manag Cust Dtls  *
     C                     EXSR TIRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DPMSC    ZA0062           Portfolio Manag
      * Send message 'PM details already exist'
     C                     MOVEL'USR2361' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9940  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Portfolio Lending
      * CASE: DTL.Portfolio Lending Scr is Yes
     C           #DPLSC    IFEQ 'Y'                        *IF
      * CASE: PAR.Action Code is Insert
     C           P2ANCD    IFEQ 'I'                        *IF
      * Does Portfilio/L exist? - Portfolio Lend Cust Dtls  *
     C                     EXSR TJRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DPLSC    ZA0063           Portfolio Lendi
      * Send message 'PL details already exist'
     C                     MOVEL'USR2362' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9941  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * End of S01486
      * Start of S01467
      * LEO Customer Details
      * CASE: DTL.LEO Function field is Yes
     C           #DLEOF    IFEQ 'Y'                        *IF
      * CASE: PAR.Action Code is Insert
     C           P2ANCD    IFEQ 'I'                        *IF
      * Check if there is a record for this customer on LEO files.
      * Build LEO Customer Number - Client Details  *
     C                     MOVE *BLANK    WULCUN  80
     C                     MOVEL'00'      WULCUN
     C                     MOVE #1CUST    WULCUN
     C                     MOVE *BLANK    WUEOTX  7
     C                     MOVEL*BLANK    WUAPRC           Access Pgm Retu
     C                     MOVEL*BLANK    WUEOTX           Option for ACCO
     C                     MOVEL'*KEY'    WUEOTX           Option for ACCO
      * Call leo program CAOUCU - Customer LEO Details  *
     C                     CALL 'AOC0001'              90  Call leo progra
     C           WUAPRC    PARM WUAPRC    WQ0134  7        Access Pgm Retu
     C                     PARM WUEOTX    WQ0135  7        Option for ACCO
     C                     PARM WULCUN    WQ0136  80       LEO Customer (n
     C                     PARM WUKSTS    WQ0137  7        Key status
     C                     PARM WUSFMT    WQ0138256        Access object f
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'AOC0001' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * CASE: WRK.Access Pgm Return Code is AP No Record Found
     C           WUAPRC    IFEQ '*NRF'                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DLEOF    ZA0064           LEO Function fi
      * Send message 'LEO record already exists'
     C                     MOVEL'USR2304' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9942  *
      *
     C                     END                             *FI
     C                     MOVEL*BLANK    WUAPRC           Access Pgm Retu
     C                     MOVEL*BLANK    WUEOTX           Option for ACCO
     C                     MOVEL'*FREE'   WUEOTX           Option for ACCO
      * Call leo program CAOUCU - Customer LEO Details  *
     C                     CALL 'AOC0001'              90  Call leo progra
     C           WUAPRC    PARM WUAPRC    WQ0139  7        Access Pgm Retu
     C                     PARM WUEOTX    WQ0140  7        Option for ACCO
     C                     PARM WULCUN    WQ0141  80       LEO Customer (n
     C                     PARM WUKSTS    WQ0142  7        Key status
     C                     PARM WUSFMT    WQ0143256        Access object f
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'AOC0001' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
     C                     END                             *FI
      * End of S01467
      * Start of change CTI001
      * TI customer details
      * CASE: DTL.Call TI Customer Function is Yes
     C           #DTICF    IFEQ 'Y'                        *IF
      **Insert*processing                                                                     183032
      **CASE:*PAR.Action*Code*is*Insert                                                       183032
      ** Insert and Amend processing                                                          183032
      ** CASE: PAR.Action Code is Insert or Amend                                             183032
      *                                                                                       183032
     C           P2ANCD    IFEQ 'I'                        *IF
     C           P2ANCD    OREQ 'A'                                                           183032
     C           P1LINC    IFEQ *BLANKS                                                       183032
     C                     MOVEL#DTICF    ZA0076                                              183032
     C                     MOVEL'N'       #DTICF                                              183032
     C                     MOVEL'USR3571' ZAMSID                                              183032
     C                     EXSR ZASNMS                                                        183032
     C                     MOVE *ON       *IN44                                               183032
     C                     MOVE *ON       *IN99                                               183032
      *                                                                                       237624
     C                     MOVEL'N'       P1TICS                                              237624
     C                     GOTO UAEXIT                                                        183032
     C                     ENDIF                                                              183032
      *                                                                                       196149
      ** If customer is a parent, customer cannot be TI.                                      196149
      *                                                                                       196149
     C           P3PAIN    IFEQ 'P'                                                           196149
     C                     MOVEL'Y'       WUF8OS                                              196149
     C                     MOVEL#DTICF    ZA0077                                              196149
      *                                                                                       196149
      ** Send message 'Customer is parent, cannot be TI.'                                     196149
      *                                                                                       196149
     C                     MOVEL'USR3961' ZAMSID                                              196149
     C                     EXSR ZASNMS                                                        196149
     C                     MOVE '1'       *IN99                                               196149
     C                     MOVE '1'       *IN33                                               196149
     C                     ENDIF                                                              196149
      * Check for TI customer ref - Trade Innov Cust Details  *
     C                     EXSR TKRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     ELSE
     C           P2ANCD    IFEQ 'I'                                                           183032
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DTICF    ZA0065           Call TI Custome
      **Send*message*'TI*Customer*does*not*exis'                                              183032
      ** For insert mode, send message 'TI Customer already exist'                            183032
      *                                                                                       183032
     C***********          MOVEL'USR3535' ZAMSID                                              183032
     C                     MOVEL'USR3534' ZAMSID                                              183032
     C                     EXSR ZASNMS
     C                     SETON                     9944  *
     C                     ENDIF                                                              183032
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * End of change CTI001
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Delete Action Code Processing
      *================================================================
      * Start of Fix S01267
      * Marketing Information
      * CASE: DTL.Choose Customer Marketing is Yes
     C           #DCHCM    IFEQ 'Y'                        *IF
      * CASE: PAR.Action Code is Delete
     C           P2ANCD    IFEQ 'D'                        *IF
      * Retrieve Client Marketing - Customer Marketing Groups  *
     C                     EXSR TLRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#DCHCM    ZA0066           Choose Customer
      * Send message 'Customer Group not found'
     C                     MOVEL'USR1558' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * End of Fix S01267
      * Start of S01421
      * Additional customer details
      * CASE: DTL.Additional Cust Func Fld is Yes
     C           #DACFF    IFEQ 'Y'                        *IF
      * CASE: PAR.Action Code is Delete
     C           P2ANCD    IFEQ 'D'                        *IF
      * Check existance of Cust - Additional Customer Dtls  *
     C                     EXSR TMRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#DACFF    ZA0067           Additional Cust
      * Send message 'No additional details'
     C                     MOVEL'USR1965' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Customer fees
      * CASE: DTL.Customer Fees Func Fld is Yes
     C           #DCFFF    IFEQ 'Y'                        *IF
      * CASE: PAR.Action Code is Delete
     C           P2ANCD    IFEQ 'D'                        *IF
      * Check cusromer fees exist - Customer Fees Detail  *
     C                     EXSR TNRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#DCFFF    ZA0068           Customer Fees F
      * Send message 'No fee details'
     C                     MOVEL'USR1998' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9934  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * End of S01421
      * Securities Trading
      * CASE: DTL.Choose Securities Trading is Yes
     C           #DCHST    IFEQ 'Y'                        *IF
      * CASE: PAR.Action Code is Delete
     C           P2ANCD    IFEQ 'D'                        *IF
      * Check if ST client - Securities Clients  *
     C                     EXSR TORVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#DCHST    ZA0069           Choose Securiti
      * Send message 'Not a ST customer'
     C                     MOVEL'USR0319' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9938  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Futures & Options
      * CASE: DTL.Choose Futures & Options is Yes
     C           #DCHFO    IFEQ 'Y'                        *IF
      * CASE: PAR.Action Code is Delete
     C           P2ANCD    IFEQ 'D'                        *IF
      * Check if F&O Customer - Futures & Options Clients  *
     C                     EXSR TPRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#DCHFO    ZA0070           Choose Futures
      * Send message 'Not a FO customer'
     C                     MOVEL'USR0320' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 00/Copy member SD0014VCP9 - Client Details  *
     C/COPY WNCPYSRC,SD0014VCP9                                           S01212
      * Start of S01486
      * Portfolio Management
      * CASE: DTL.Portfolio Management Scr is Yes
     C           #DPMSC    IFEQ 'Y'                        *IF
      * CASE: PAR.Action Code is Delete
     C           P2ANCD    IFEQ 'D'                        *IF
      * Does Porfolio/M exist? - Portfolio Manag Cust Dtls  *
     C                     EXSR TQRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#DPMSC    ZA0071           Portfolio Manag
      * Send message 'No PM details exist'
     C                     MOVEL'USR2359' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9940  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Portfolio Lending
      * CASE: DTL.Portfolio Lending Scr is Yes
     C           #DPLSC    IFEQ 'Y'                        *IF
      * CASE: PAR.Action Code is Delete
     C           P2ANCD    IFEQ 'D'                        *IF
      * Does Portfilio/L exist? - Portfolio Lend Cust Dtls  *
     C                     EXSR TRRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#DPLSC    ZA0072           Portfolio Lendi
      * Send message 'No PL details exist'
     C                     MOVEL'USR2360' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9941  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * End of S01486
      * Start of S01467
      * LEO Customer Details
      * CASE: DTL.LEO Function field is Yes
     C           #DLEOF    IFEQ 'Y'                        *IF
      * CASE: PAR.Action Code is Delete
     C           P2ANCD    IFEQ 'D'                        *IF
      * Check if there is a record for this customer.
      * Check existence of Cust. - Customer LEO Details  *
     C                     EXSR TSRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#DLEOF    ZA0073           LEO Function fi
      * Send message 'Customer does not exist'
     C                     MOVEL'USR2345' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9942  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * End of S01467
      * Start of change CTI001
      * TI customer details
      * CASE: DTL.Call TI Customer Function is Yes
     C           #DTICF    IFEQ 'Y'                        *IF
      * CASE: PAR.Action Code is Delete
     C           P2ANCD    IFEQ 'D'                        *IF
      * Check for TI customer ref - Trade Innov Cust Details  *
     C                     EXSR TTRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#DTICF    ZA0074           Call TI Custome
      * Send message 'TI Customer does not exis'
     C                     MOVEL'USR3535' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9944  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * End of change CTI001
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Select existing record
      *================================================================
      * Name search required?
     C                     MOVEL#1CUST    WK1X01  1
     C           WK1X01    IFEQ '?'                        Customer Number
     C                     CALL 'SD0010S'              90  Select Client D
     C                     PARM *BLANK    W0RTN   7
     C           #1CUST    PARM #1CUST    WQ0090  6        Customer Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0010S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to Location Codes
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1LCCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Location Code
     C                     CALL 'SD0550S'              90  Select Location
     C                     PARM *BLANK    W0RTN   7
     C           #1LCCD    PARM #1LCCD    WQ0091  3        Location Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0550S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VBEXIT
     C                     END
     C                     END
      *................................................................
      * If Midas/TI Interface is on and this is a TI Customer             126676
      * then Institution Code is mandatory; so send error message if      126676
      * it is not entered.                                                126676
      *                                                                   126676
     C           WUN3ST    IFEQ 'Y'                                       126676
     C           #DTICF    ANDEQ'Y'                                       126676
     C           BBTICS    ANDEQ'Y'                                       145461
     C           P1LINC    ANDEQ*BLANKS                                   126676
     C           CTI006    OREQ 'Y'                                                         MD030956
     C           #DTICF    ANDEQ'Y'                                                         MD030956
     C           BBTICS    ANDEQ'Y'                                                         MD030956
     C           P1LINC    ANDEQ*BLANKS                                                     MD030956
      * Setup message data for message                                    126676
     C                     MOVEL#DTICF    ZA0076                          126676
      * Send message 'Institution Code is mandatory for TI Customers'     126676
     C***********          MOVEL'USR3566' ZAMSID                   126676 132720
     C                     MOVEL'USR3571' ZAMSID                          132720
     C                     EXSR ZASNMS                                    126676
     C                     SETON                     9944                 126676
     C                     ENDIF                                          126676
      *                                                                   126676
      * If all low order keys not entered, exit
     C           #1LCCD    IFEQ *BLANK                     Location Code
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBDV    KLIST
     C                     KFLD           DVLCCD           Location Code
      * Setup key
     C                     MOVEL#1LCCD    DVLCCD           Location Code
     C           KLVBDV    CHAIN@DVREHH              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
      * Send message 'Location Codes         NF'
     C                     MOVEL'USR0653' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0653' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Account Officers
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1ACOC    WK1X01  1
     C           WK1X01    IFEQ '?'                        Account Officer
     C                     CALL 'SD0201S'              90  Select Account
     C                     PARM *BLANK    W0RTN   7
     C           #1ACOC    PARM #1ACOC    WQ0092  2        Account Officer
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0201S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1ACOC    IFEQ *BLANK                     Account Officer
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCAZ    KLIST
     C                     KFLD           AZACOC           Account Officer
      * Setup key
     C                     MOVEL#1ACOC    AZACOC           Account Officer
     C           KLVCAZ    CHAIN@AZREBO              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Account Officers       NF'
     C                     MOVEL'USR0057' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0057' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check reference to Country Codes
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1CNCZ    WK1X01  1
     C           WK1X01    IFEQ '?'                        Country Code
     C                     CALL 'SD0180S'              90  Select Country
     C                     PARM *BLANK    W0RTN   7
     C           #1CNCZ    PARM #1CNCZ    WQ0093  2        Country Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0180S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VDEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1CNCZ    IFEQ *BLANK                     Country Code
     C                     GOTO VDEXIT
     C                     END
      *
     C           KLVDA4    KLIST
     C                     KFLD           A4CNCD           Country Code
      * Setup key
     C                     MOVEL#1CNCZ    A4CNCD           Country Code
     C           KLVDA4    CHAIN@A4REBR              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VDEXIT
     C                     END
      * Send message 'Country Codes          NF'
     C                     MOVEL'USR0067' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0067' W0RTN
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         VECKRL    BEGSR
      *================================================================
      * Check reference to Country Codes
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1COLC    WK1X01  1
     C           WK1X01    IFEQ '?'                        Country Code
     C                     CALL 'SD0180S'              90  Select Country
     C                     PARM *BLANK    W0RTN   7
     C           #1COLC    PARM #1COLC    WQ0094  2        Country Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0180S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VEEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1COLC    IFEQ *BLANK                     Country Code
     C                     GOTO VEEXIT
     C                     END
      *
     C           KLVEA4    KLIST
     C                     KFLD           A4CNCD           Country Code
      * Setup key
     C                     MOVEL#1COLC    A4CNCD           Country Code
     C           KLVEA4    CHAIN@A4REBR              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VEEXIT
     C                     END
      * Send message 'Country Codes          NF'
     C                     MOVEL'USR0067' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0067' W0RTN
      *================================================================
     CSR         VEEXIT    ENDSR
      /EJECT
     CSR         VFCKRL    BEGSR
      *================================================================
      * Check reference to Client Details
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1PCNB    WK1X01  1
     C           WK1X01    IFEQ '?'                        Customer Number
     C                     CALL 'SD0010S'              90  Select Client D
     C                     PARM *BLANK    W0RTN   7
     C           #1PCNB    PARM #1PCNB    WQ0095  6        Customer Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0010S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VFEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1PCNB    IFEQ *BLANK                     Customer Number
     C                     GOTO VFEXIT
     C                     END
      *
     C           KLVFBB    KLIST
     C                     KFLD           BBCUST           Customer Number
      * Setup key
     C                     MOVEL#1PCNB    BBCUST           Customer Number
     C           KLVFBB    CHAIN@BBREBF              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VFEXIT
     C                     END
      * Send message 'Client Details         NF'
     C                     MOVEL'USR0081' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0081' W0RTN
      *================================================================
     CSR         VFEXIT    ENDSR
      /EJECT
     CSR         VGCKRL    BEGSR
      *================================================================
      * Check reference to Branch Codes
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1BRCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Branch code
     C                     CALL 'SD0061S'              90  Select Branch C
     C                     PARM *BLANK    W0RTN   7
     C           #1BRCD    PARM #1BRCD    WQ0096  3        Branch code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0061S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VGEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1BRCD    IFEQ *BLANK                     Branch code
     C                     GOTO VGEXIT
     C                     END
      *
     C           KLVGA8    KLIST
     C                     KFLD           A8BRCD           Branch code
      * Setup key
     C                     MOVEL#1BRCD    A8BRCD           Branch code
     C           KLVGA8    CHAIN@A8REB0              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VGEXIT
     C                     END
      * Send message 'Branch code            NF'
     C                     MOVEL'USR0075' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0075' W0RTN
      *================================================================
     CSR         VGEXIT    ENDSR
      /EJECT
     CSR         VHCKRL    BEGSR
      *================================================================
      * Check reference to Local Institutions
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1LINC    WK1X01  1
     C           WK1X01    IFEQ '?'                        Local Instituti
     C                     CALL 'SD0090S'              90  Select Local In
     C                     PARM *BLANK    W0RTN   7
     C           #1LINC    PARM #1LINC    WQ0097  2        Local Instituti
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0090S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VHEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1LINC    IFEQ *BLANK                     Local Instituti
     C                     GOTO VHEXIT
     C                     END
      *
     C           KLVHAK    KLIST
     C                     KFLD           AKLINC           Local Instituti
      * Setup key
     C                     MOVEL#1LINC    AKLINC           Local Instituti
     C           KLVHAK    CHAIN@AKREBI              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VHEXIT
     C                     END
      * Send message 'Local Institutions     NF'
     C                     MOVEL'USR0027' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0027' W0RTN
      *================================================================
     CSR         VHEXIT    ENDSR
      /EJECT
     CSR         VICKRL    BEGSR
      *================================================================
      * Check reference to Local Industry Codes
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1LICD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Local Industry
     C                     CALL 'SD0100S'              90  Select Local In
     C                     PARM *BLANK    W0RTN   7
     C           #1LICD    PARM #1LICD    WQ0098  3        Local Industry
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0100S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VIEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1LICD    IFEQ *BLANK                     Local Industry
     C                     GOTO VIEXIT
     C                     END
      *
     C           KLVIAO    KLIST
     C                     KFLD           AOLICD           Local Industry
      * Setup key
     C                     MOVEL#1LICD    AOLICD           Local Industry
     C           KLVIAO    CHAIN@AOREBL              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VIEXIT
     C                     END
      * Send message 'Local Industry Codes   NF'
     C                     MOVEL'USR0035' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0035' W0RTN
      *================================================================
     CSR         VIEXIT    ENDSR
      /EJECT
     CSR         VJCKRL    BEGSR
      *================================================================
      * Check reference to Customer Risk Weight Code
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1RWCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Risk Weighting
     C                     CALL 'SD1400S'              90  Select Customer
     C                     PARM *BLANK    W0RTN   7
     C           #1RWCD    PARM #1RWCD    WQ0099  4        Risk Weighting
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD1400S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VJEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1RWCD    IFEQ *BLANK                     Risk Weighting
     C                     GOTO VJEXIT
     C                     END
      *
     C           KLVJD5    KLIST
     C                     KFLD           D5RWCD           Risk Weighting
      * Setup key
     C                     MOVEL#1RWCD    D5RWCD           Risk Weighting
     C           KLVJD5    CHAIN@D5REI5              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VJEXIT
     C                     END
      * Send message 'Customer Risk Weight C NF'
     C                     MOVEL'USR1459' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1459' W0RTN
      *================================================================
     CSR         VJEXIT    ENDSR
      /EJECT
     CSR         VKCKRL    BEGSR
      *================================================================
      * Check reference to Message Type Descriptions
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DS01    WK1X01  1
     C           WK1X01    IFEQ '?'                        Message Type
     C                     CALL 'SD2030S'              90  Select Message
     C                     PARM *BLANK    W0RTN   7
     C           #1DS01    PARM #1DS01    WQ0100  3        Message Type
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD2030S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VKEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DS01    IFEQ *BLANK                     Message Type
     C                     GOTO VKEXIT
     C                     END
      *
     C           KLVKEE    KLIST
     C                     KFLD           EEMTPY           Message Type
      * Setup key
     C                     MOVEL#1DS01    EEMTPY           Message Type
     C           KLVKEE    CHAIN@EEREJ2              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VKEXIT
     C                     END
      * Send message 'Message Type Descripti NF'
     C                     MOVEL'USR1539' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1539' W0RTN
      *================================================================
     CSR         VKEXIT    ENDSR
      /EJECT
     CSR         VLCKRL    BEGSR
      *================================================================
      * Check reference to Message Type Descriptions
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DS02    WK1X01  1
     C           WK1X01    IFEQ '?'                        Message Type
     C                     CALL 'SD2030S'              90  Select Message
     C                     PARM *BLANK    W0RTN   7
     C           #1DS02    PARM #1DS02    WQ0101  3        Message Type
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD2030S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VLEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DS02    IFEQ *BLANK                     Message Type
     C                     GOTO VLEXIT
     C                     END
      *
     C           KLVLEE    KLIST
     C                     KFLD           EEMTPY           Message Type
      * Setup key
     C                     MOVEL#1DS02    EEMTPY           Message Type
     C           KLVLEE    CHAIN@EEREJ2              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VLEXIT
     C                     END
      * Send message 'Message Type Descripti NF'
     C                     MOVEL'USR1539' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1539' W0RTN
      *================================================================
     CSR         VLEXIT    ENDSR
      /EJECT
     CSR         VMCKRL    BEGSR
      *================================================================
      * Check reference to Message Type Descriptions
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DS03    WK1X01  1
     C           WK1X01    IFEQ '?'                        Message Type
     C                     CALL 'SD2030S'              90  Select Message
     C                     PARM *BLANK    W0RTN   7
     C           #1DS03    PARM #1DS03    WQ0102  3        Message Type
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD2030S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VMEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DS03    IFEQ *BLANK                     Message Type
     C                     GOTO VMEXIT
     C                     END
      *
     C           KLVMEE    KLIST
     C                     KFLD           EEMTPY           Message Type
      * Setup key
     C                     MOVEL#1DS03    EEMTPY           Message Type
     C           KLVMEE    CHAIN@EEREJ2              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VMEXIT
     C                     END
      * Send message 'Message Type Descripti NF'
     C                     MOVEL'USR1539' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1539' W0RTN
      *================================================================
     CSR         VMEXIT    ENDSR
      /EJECT
     CSR         VNCKRL    BEGSR
      *================================================================
      * Check reference to Message Type Descriptions
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DS04    WK1X01  1
     C           WK1X01    IFEQ '?'                        Message Type
     C                     CALL 'SD2030S'              90  Select Message
     C                     PARM *BLANK    W0RTN   7
     C           #1DS04    PARM #1DS04    WQ0103  3        Message Type
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD2030S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VNEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DS04    IFEQ *BLANK                     Message Type
     C                     GOTO VNEXIT
     C                     END
      *
     C           KLVNEE    KLIST
     C                     KFLD           EEMTPY           Message Type
      * Setup key
     C                     MOVEL#1DS04    EEMTPY           Message Type
     C           KLVNEE    CHAIN@EEREJ2              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VNEXIT
     C                     END
      * Send message 'Message Type Descripti NF'
     C                     MOVEL'USR1539' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1539' W0RTN
      *================================================================
     CSR         VNEXIT    ENDSR
      /EJECT
     CSR         VOCKRL    BEGSR
      *================================================================
      * Check reference to Message Type Descriptions
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DS05    WK1X01  1
     C           WK1X01    IFEQ '?'                        Message Type
     C                     CALL 'SD2030S'              90  Select Message
     C                     PARM *BLANK    W0RTN   7
     C           #1DS05    PARM #1DS05    WQ0104  3        Message Type
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD2030S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VOEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DS05    IFEQ *BLANK                     Message Type
     C                     GOTO VOEXIT
     C                     END
      *
     C           KLVOEE    KLIST
     C                     KFLD           EEMTPY           Message Type
      * Setup key
     C                     MOVEL#1DS05    EEMTPY           Message Type
     C           KLVOEE    CHAIN@EEREJ2              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VOEXIT
     C                     END
      * Send message 'Message Type Descripti NF'
     C                     MOVEL'USR1539' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1539' W0RTN
      *================================================================
     CSR         VOEXIT    ENDSR
      /EJECT
     CSR         VPCKRL    BEGSR
      *================================================================
      * Check reference to Message Type Descriptions
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DS06    WK1X01  1
     C           WK1X01    IFEQ '?'                        Message Type
     C                     CALL 'SD2030S'              90  Select Message
     C                     PARM *BLANK    W0RTN   7
     C           #1DS06    PARM #1DS06    WQ0105  3        Message Type
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD2030S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VPEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DS06    IFEQ *BLANK                     Message Type
     C                     GOTO VPEXIT
     C                     END
      *
     C           KLVPEE    KLIST
     C                     KFLD           EEMTPY           Message Type
      * Setup key
     C                     MOVEL#1DS06    EEMTPY           Message Type
     C           KLVPEE    CHAIN@EEREJ2              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VPEXIT
     C                     END
      * Send message 'Message Type Descripti NF'
     C                     MOVEL'USR1539' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1539' W0RTN
      *================================================================
     CSR         VPEXIT    ENDSR
      /EJECT
     CSR         VQCKRL    BEGSR
      *================================================================
      * Check reference to Message Type Descriptions
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DS07    WK1X01  1
     C           WK1X01    IFEQ '?'                        Message Type
     C                     CALL 'SD2030S'              90  Select Message
     C                     PARM *BLANK    W0RTN   7
     C           #1DS07    PARM #1DS07    WQ0106  3        Message Type
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD2030S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VQEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DS07    IFEQ *BLANK                     Message Type
     C                     GOTO VQEXIT
     C                     END
      *
     C           KLVQEE    KLIST
     C                     KFLD           EEMTPY           Message Type
      * Setup key
     C                     MOVEL#1DS07    EEMTPY           Message Type
     C           KLVQEE    CHAIN@EEREJ2              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VQEXIT
     C                     END
      * Send message 'Message Type Descripti NF'
     C                     MOVEL'USR1539' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1539' W0RTN
      *================================================================
     CSR         VQEXIT    ENDSR
      /EJECT
     CSR         VRCKRL    BEGSR
      *================================================================
      * Check reference to Message Type Descriptions
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DS08    WK1X01  1
     C           WK1X01    IFEQ '?'                        Message Type
     C                     CALL 'SD2030S'              90  Select Message
     C                     PARM *BLANK    W0RTN   7
     C           #1DS08    PARM #1DS08    WQ0107  3        Message Type
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD2030S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VREXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DS08    IFEQ *BLANK                     Message Type
     C                     GOTO VREXIT
     C                     END
      *
     C           KLVREE    KLIST
     C                     KFLD           EEMTPY           Message Type
      * Setup key
     C                     MOVEL#1DS08    EEMTPY           Message Type
     C           KLVREE    CHAIN@EEREJ2              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VREXIT
     C                     END
      * Send message 'Message Type Descripti NF'
     C                     MOVEL'USR1539' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1539' W0RTN
      *================================================================
     CSR         VREXIT    ENDSR
      /EJECT
     CSR         VSCKRL    BEGSR
      *================================================================
      * Check reference to Message Type Descriptions
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DS09    WK1X01  1
     C           WK1X01    IFEQ '?'                        Message Type
     C                     CALL 'SD2030S'              90  Select Message
     C                     PARM *BLANK    W0RTN   7
     C           #1DS09    PARM #1DS09    WQ0108  3        Message Type
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD2030S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VSEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DS09    IFEQ *BLANK                     Message Type
     C                     GOTO VSEXIT
     C                     END
      *
     C           KLVSEE    KLIST
     C                     KFLD           EEMTPY           Message Type
      * Setup key
     C                     MOVEL#1DS09    EEMTPY           Message Type
     C           KLVSEE    CHAIN@EEREJ2              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VSEXIT
     C                     END
      * Send message 'Message Type Descripti NF'
     C                     MOVEL'USR1539' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1539' W0RTN
      *================================================================
     CSR         VSEXIT    ENDSR
      /EJECT
     CSR         VTCKRL    BEGSR
      *================================================================
      * Check reference to Message Type Descriptions
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DS10    WK1X01  1
     C           WK1X01    IFEQ '?'                        Message Type
     C                     CALL 'SD2030S'              90  Select Message
     C                     PARM *BLANK    W0RTN   7
     C           #1DS10    PARM #1DS10    WQ0109  3        Message Type
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD2030S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VTEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DS10    IFEQ *BLANK                     Message Type
     C                     GOTO VTEXIT
     C                     END
      *
     C           KLVTEE    KLIST
     C                     KFLD           EEMTPY           Message Type
      * Setup key
     C                     MOVEL#1DS10    EEMTPY           Message Type
     C           KLVTEE    CHAIN@EEREJ2              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VTEXIT
     C                     END
      * Send message 'Message Type Descripti NF'
     C                     MOVEL'USR1539' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1539' W0RTN
      *================================================================
     CSR         VTEXIT    ENDSR
      /EJECT
     CSR         VUCKRL    BEGSR
      *================================================================
      * Check reference to Message Type Descriptions
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DS11    WK1X01  1
     C           WK1X01    IFEQ '?'                        Message Type
     C                     CALL 'SD2030S'              90  Select Message
     C                     PARM *BLANK    W0RTN   7
     C           #1DS11    PARM #1DS11    WQ0110  3        Message Type
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD2030S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VUEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DS11    IFEQ *BLANK                     Message Type
     C                     GOTO VUEXIT
     C                     END
      *
     C           KLVUEE    KLIST
     C                     KFLD           EEMTPY           Message Type
      * Setup key
     C                     MOVEL#1DS11    EEMTPY           Message Type
     C           KLVUEE    CHAIN@EEREJ2              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VUEXIT
     C                     END
      * Send message 'Message Type Descripti NF'
     C                     MOVEL'USR1539' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1539' W0RTN
      *================================================================
     CSR         VUEXIT    ENDSR
      /EJECT
     CSR         VVCKRL    BEGSR
      *================================================================
      * Check reference to Message Type Descriptions
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DS12    WK1X01  1
     C           WK1X01    IFEQ '?'                        Message Type
     C                     CALL 'SD2030S'              90  Select Message
     C                     PARM *BLANK    W0RTN   7
     C           #1DS12    PARM #1DS12    WQ0111  3        Message Type
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD2030S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VVEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DS12    IFEQ *BLANK                     Message Type
     C                     GOTO VVEXIT
     C                     END
      *
     C           KLVVEE    KLIST
     C                     KFLD           EEMTPY           Message Type
      * Setup key
     C                     MOVEL#1DS12    EEMTPY           Message Type
     C           KLVVEE    CHAIN@EEREJ2              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VVEXIT
     C                     END
      * Send message 'Message Type Descripti NF'
     C                     MOVEL'USR1539' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1539' W0RTN
      *================================================================
     CSR         VVEXIT    ENDSR
      /EJECT
     CSR         VWCKRL    BEGSR
      *================================================================
      * Check reference to Message Type Descriptions
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DS13    WK1X01  1
     C           WK1X01    IFEQ '?'                        Message Type
     C                     CALL 'SD2030S'              90  Select Message
     C                     PARM *BLANK    W0RTN   7
     C           #1DS13    PARM #1DS13    WQ0112  3        Message Type
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD2030S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VWEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DS13    IFEQ *BLANK                     Message Type
     C                     GOTO VWEXIT
     C                     END
      *
     C           KLVWEE    KLIST
     C                     KFLD           EEMTPY           Message Type
      * Setup key
     C                     MOVEL#1DS13    EEMTPY           Message Type
     C           KLVWEE    CHAIN@EEREJ2              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VWEXIT
     C                     END
      * Send message 'Message Type Descripti NF'
     C                     MOVEL'USR1539' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1539' W0RTN
      *================================================================
     CSR         VWEXIT    ENDSR
      /EJECT
     CSR         VXCKRL    BEGSR
      *================================================================
      * Check reference to Message Type Descriptions
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DS14    WK1X01  1
     C           WK1X01    IFEQ '?'                        Message Type
     C                     CALL 'SD2030S'              90  Select Message
     C                     PARM *BLANK    W0RTN   7
     C           #1DS14    PARM #1DS14    WQ0113  3        Message Type
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD2030S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VXEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DS14    IFEQ *BLANK                     Message Type
     C                     GOTO VXEXIT
     C                     END
      *
     C           KLVXEE    KLIST
     C                     KFLD           EEMTPY           Message Type
      * Setup key
     C                     MOVEL#1DS14    EEMTPY           Message Type
     C           KLVXEE    CHAIN@EEREJ2              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VXEXIT
     C                     END
      * Send message 'Message Type Descripti NF'
     C                     MOVEL'USR1539' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1539' W0RTN
      *================================================================
     CSR         VXEXIT    ENDSR
      /EJECT
     CSR         VYCKRL    BEGSR
      *================================================================
      * Check reference to Message Type Descriptions
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DS15    WK1X01  1
     C           WK1X01    IFEQ '?'                        Message Type
     C                     CALL 'SD2030S'              90  Select Message
     C                     PARM *BLANK    W0RTN   7
     C           #1DS15    PARM #1DS15    WQ0114  3        Message Type
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD2030S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VYEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DS15    IFEQ *BLANK                     Message Type
     C                     GOTO VYEXIT
     C                     END
      *
     C           KLVYEE    KLIST
     C                     KFLD           EEMTPY           Message Type
      * Setup key
     C                     MOVEL#1DS15    EEMTPY           Message Type
     C           KLVYEE    CHAIN@EEREJ2              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VYEXIT
     C                     END
      * Send message 'Message Type Descripti NF'
     C                     MOVEL'USR1539' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1539' W0RTN
      *================================================================
     CSR         VYEXIT    ENDSR
      /EJECT
     CSR         VZCKRL    BEGSR
      *================================================================
      * Check reference to Message Network Details
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DNW1    WK1X01  1
     C           WK1X01    IFEQ '?'                        Network
     C                     CALL 'SD2000S'              90  Select Message
     C                     PARM *BLANK    W0RTN   7
     C           #1DNW1    PARM #1DNW1    WQ0115  6        Network
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD2000S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VZEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DNW1    IFEQ *BLANK                     Network
     C                     GOTO VZEXIT
     C                     END
      *
     C           KLVZED    KLIST
     C                     KFLD           EDNWRK           Network
      * Setup key
     C                     MOVEL#1DNW1    EDNWRK           Network
     C           KLVZED    CHAIN@EDREJZ              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VZEXIT
     C                     END
      * Send message 'Message Network Detail NF'
     C                     MOVEL'USR1537' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1537' W0RTN
      *================================================================
     CSR         VZEXIT    ENDSR
      /EJECT
     CSR         WACKRL    BEGSR
      *================================================================
      * Check reference to Message Network Details
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DNW2    WK1X01  1
     C           WK1X01    IFEQ '?'                        Network
     C                     CALL 'SD2000S'              90  Select Message
     C                     PARM *BLANK    W0RTN   7
     C           #1DNW2    PARM #1DNW2    WQ0116  6        Network
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD2000S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO WAEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DNW2    IFEQ *BLANK                     Network
     C                     GOTO WAEXIT
     C                     END
      *
     C           KLWAED    KLIST
     C                     KFLD           EDNWRK           Network
      * Setup key
     C                     MOVEL#1DNW2    EDNWRK           Network
     C           KLWAED    CHAIN@EDREJZ              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO WAEXIT
     C                     END
      * Send message 'Message Network Detail NF'
     C                     MOVEL'USR1537' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1537' W0RTN
      *================================================================
     CSR         WAEXIT    ENDSR
      /EJECT
     CSR         WBCKRL    BEGSR
      *================================================================
      * Check reference to Message Network Details
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DNW3    WK1X01  1
     C           WK1X01    IFEQ '?'                        Network
     C                     CALL 'SD2000S'              90  Select Message
     C                     PARM *BLANK    W0RTN   7
     C           #1DNW3    PARM #1DNW3    WQ0117  6        Network
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD2000S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO WBEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DNW3    IFEQ *BLANK                     Network
     C                     GOTO WBEXIT
     C                     END
      *
     C           KLWBED    KLIST
     C                     KFLD           EDNWRK           Network
      * Setup key
     C                     MOVEL#1DNW3    EDNWRK           Network
     C           KLWBED    CHAIN@EDREJZ              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO WBEXIT
     C                     END
      * Send message 'Message Network Detail NF'
     C                     MOVEL'USR1537' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1537' W0RTN
      *================================================================
     CSR         WBEXIT    ENDSR
      /EJECT
     CSR         WCCKRL    BEGSR
      *================================================================
      * Check reference to Message Network Details
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DNW4    WK1X01  1
     C           WK1X01    IFEQ '?'                        Network
     C                     CALL 'SD2000S'              90  Select Message
     C                     PARM *BLANK    W0RTN   7
     C           #1DNW4    PARM #1DNW4    WQ0118  6        Network
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD2000S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO WCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DNW4    IFEQ *BLANK                     Network
     C                     GOTO WCEXIT
     C                     END
      *
     C           KLWCED    KLIST
     C                     KFLD           EDNWRK           Network
      * Setup key
     C                     MOVEL#1DNW4    EDNWRK           Network
     C           KLWCED    CHAIN@EDREJZ              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO WCEXIT
     C                     END
      * Send message 'Message Network Detail NF'
     C                     MOVEL'USR1537' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1537' W0RTN
      *================================================================
     CSR         WCEXIT    ENDSR
      /EJECT
     CSR         WDCKRL    BEGSR
      *================================================================
      * Check reference to Message Network Details
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DNW5    WK1X01  1
     C           WK1X01    IFEQ '?'                        Network
     C                     CALL 'SD2000S'              90  Select Message
     C                     PARM *BLANK    W0RTN   7
     C           #1DNW5    PARM #1DNW5    WQ0119  6        Network
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD2000S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO WDEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DNW5    IFEQ *BLANK                     Network
     C                     GOTO WDEXIT
     C                     END
      *
     C           KLWDED    KLIST
     C                     KFLD           EDNWRK           Network
      * Setup key
     C                     MOVEL#1DNW5    EDNWRK           Network
     C           KLWDED    CHAIN@EDREJZ              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO WDEXIT
     C                     END
      * Send message 'Message Network Detail NF'
     C                     MOVEL'USR1537' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1537' W0RTN
      *================================================================
     CSR         WDEXIT    ENDSR
      /EJECT
     CSR         WECKRL    BEGSR
      *================================================================
      * Check reference to Message Network Details
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DNW6    WK1X01  1
     C           WK1X01    IFEQ '?'                        Network
     C                     CALL 'SD2000S'              90  Select Message
     C                     PARM *BLANK    W0RTN   7
     C           #1DNW6    PARM #1DNW6    WQ0120  6        Network
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD2000S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO WEEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DNW6    IFEQ *BLANK                     Network
     C                     GOTO WEEXIT
     C                     END
      *
     C           KLWEED    KLIST
     C                     KFLD           EDNWRK           Network
      * Setup key
     C                     MOVEL#1DNW6    EDNWRK           Network
     C           KLWEED    CHAIN@EDREJZ              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO WEEXIT
     C                     END
      * Send message 'Message Network Detail NF'
     C                     MOVEL'USR1537' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1537' W0RTN
      *================================================================
     CSR         WEEXIT    ENDSR
      /EJECT
     CSR         WFCKRL    BEGSR
      *================================================================
      * Check reference to Message Network Details
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DNW7    WK1X01  1
     C           WK1X01    IFEQ '?'                        Network
     C                     CALL 'SD2000S'              90  Select Message
     C                     PARM *BLANK    W0RTN   7
     C           #1DNW7    PARM #1DNW7    WQ0121  6        Network
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD2000S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO WFEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DNW7    IFEQ *BLANK                     Network
     C                     GOTO WFEXIT
     C                     END
      *
     C           KLWFED    KLIST
     C                     KFLD           EDNWRK           Network
      * Setup key
     C                     MOVEL#1DNW7    EDNWRK           Network
     C           KLWFED    CHAIN@EDREJZ              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO WFEXIT
     C                     END
      * Send message 'Message Network Detail NF'
     C                     MOVEL'USR1537' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1537' W0RTN
      *================================================================
     CSR         WFEXIT    ENDSR
      /EJECT
     CSR         WGCKRL    BEGSR
      *================================================================
      * Check reference to Message Network Details
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DNW8    WK1X01  1
     C           WK1X01    IFEQ '?'                        Network
     C                     CALL 'SD2000S'              90  Select Message
     C                     PARM *BLANK    W0RTN   7
     C           #1DNW8    PARM #1DNW8    WQ0122  6        Network
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD2000S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO WGEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DNW8    IFEQ *BLANK                     Network
     C                     GOTO WGEXIT
     C                     END
      *
     C           KLWGED    KLIST
     C                     KFLD           EDNWRK           Network
      * Setup key
     C                     MOVEL#1DNW8    EDNWRK           Network
     C           KLWGED    CHAIN@EDREJZ              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO WGEXIT
     C                     END
      * Send message 'Message Network Detail NF'
     C                     MOVEL'USR1537' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1537' W0RTN
      *================================================================
     CSR         WGEXIT    ENDSR
      /EJECT
     CSR         WHCKRL    BEGSR
      *================================================================
      * Check reference to Message Network Details
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DNW9    WK1X01  1
     C           WK1X01    IFEQ '?'                        Network
     C                     CALL 'SD2000S'              90  Select Message
     C                     PARM *BLANK    W0RTN   7
     C           #1DNW9    PARM #1DNW9    WQ0123  6        Network
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD2000S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO WHEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DNW9    IFEQ *BLANK                     Network
     C                     GOTO WHEXIT
     C                     END
      *
     C           KLWHED    KLIST
     C                     KFLD           EDNWRK           Network
      * Setup key
     C                     MOVEL#1DNW9    EDNWRK           Network
     C           KLWHED    CHAIN@EDREJZ              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO WHEXIT
     C                     END
      * Send message 'Message Network Detail NF'
     C                     MOVEL'USR1537' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1537' W0RTN
      *================================================================
     CSR         WHEXIT    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
      * USER: Exit program processing
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy member SD0014VEPP - Client Details  *
     C*00/Copy member SD0014V   Exit Program Processing
     C/COPY WNCPYSRC,SD0014VEPP
     C                     END                             *FI
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Pass CLIENT DETAILS SCREEN or PREVIOUS SCREEN request to          153812
      * calling program.                                                  153812
     C           *IN03     IFEQ '1'                                       153812
     C           *IN12     OREQ '1'                                       153812
     C                     MOVEL'USR0790' P0RTN                           153812
     C                     END                             *FI            153812
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
      *                                                                   CDL006
      ** Data area LDA                                                    CDL006
      *                                                                   CDL006
     C           *NAMVAR   DEFN           LDA                             CDL006
      *                                                                   CDL006
      ** Check if switchable feature CDL006 is switched on                CDL006
      *                                                                   CDL006
     C                     CALL 'AOSARDR0'                                CDL006
     C                     PARM '       ' @RTCD   7                       CDL006
     C                     PARM '*VERIFY' @OPTN   7                       CDL006
     C                     PARM 'CDL006'  @SARD   6                       CDL006
     C           SCSARD    PARM SCSARD    DSSDY                           CDL006
      *                                                                   CDL006
     C           @RTCD     IFEQ '*ERROR'                                  CDL006
      *                                                                   CDL006
      ** Call to program ended in error                                   CDL006
      *                                                                   CDL006
     C                     MOVEL'Y2U0032' W0RTN                           CDL006
     C                     MOVEL*BLANKS   W0CLPG                          CDL006
     C                     MOVEL'AOSARDR0'W0CLPG                          CDL006
      *                                                                   CDL006
      ** Send message '*Error occurred on CALL...'                        CDL006
      *                                                                   CDL006
     C                     MOVEL'Y2U0032' ZAMSID                          CDL006
     C                     MOVEL'Y2USRMSG'ZAMSGF                          CDL006
     C                     MOVELW0CLPG    ZAMSDA                          CDL006
     C                     EXSR ZASNMS                                    CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C           @RTCD     IFNE *BLANK                                    CDL006
     C           @RTCD     ANDNE'*NRF '                                   CDL006
     C           *LOCK     IN   LDA                                       CDL006
     C                     Z-ADD001       DBASE            ************   CDL006
     C                     MOVEL'SCSARDPD'DBFILE           * DBERR 01 *   CDL006
     C                     MOVEL'CDL006'  DBKEY            ************   CDL006
     C                     OUT  LDA                                       CDL006
     C                     EXSR *PSSR                                     CDL006
     C                     ELSE                                           CDL006
     C                     MOVE 'N'       WUFIDS                          CDL006
     C                     MOVE 'N'       CDL006                          CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C           @RTCD     IFEQ *BLANKS                                   CDL006
     C                     MOVE 'Y'       CDL006  1                       CDL006
     C                     MOVE 'Y'       WUFIDS  1                       CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
      ** Check if switchable feature CSE023 is switched on.               CSE023
      *                                                                   CSE023
     C                     CALL 'AOSARDR0'                                CSE023
     C                     PARM '       ' @RTCD                           CSE023
     C                     PARM '*VERIFY' @OPTN                           CSE023
     C                     PARM 'CSE023'  @SARD                           CSE023
     C           SCSARD    PARM SCSARD    DSSDY                           CSE023
      *                                                                   CSE023
     C           @RTCD     IFEQ '*ERROR'                                  CSE023
      *                                                                   CSE023
      ** Call to program ended in error.                                  CSE023
      *                                                                   CSE023
     C                     MOVEL'Y2U0032' W0RTN                           CSE023
     C                     MOVEL*BLANKS   W0CLPG                          CSE023
     C                     MOVEL'AOSARDR0'W0CLPG                          CSE023
      *                                                                   CSE023
      ** Send message '*Error occurred on CALL...'.                       CSE023
      *                                                                   CSE023
     C                     MOVEL'Y2U0032' ZAMSID                          CSE023
     C                     MOVEL'Y2USRMSG'ZAMSGF                          CSE023
     C                     MOVELW0CLPG    ZAMSDA                          CSE023
     C                     EXSR ZASNMS                                    CSE023
     C                     ENDIF                                          CSE023
      *                                                                   CSE023
     C           @RTCD     IFNE *BLANK                                    CSE023
     C           @RTCD     ANDNE'*NRF '                                   CSE023
     C           *LOCK     IN   LDA                                       CSE023
     C                     Z-ADD002       DBASE            ************   CSE023
     C                     MOVEL'SCSARDPD'DBFILE           * DBERR 02 *   CSE023
     C                     MOVEL'CSE023'  DBKEY            ************   CSE023
     C                     OUT  LDA                                       CSE023
     C                     EXSR *PSSR                                     CSE023
     C                     ELSE                                           CSE023
     C                     MOVE 'N'       WWITAX                          CSE023
     C                     MOVE 'N'       CSE023                          CSE023
     C                     ENDIF                                          CSE023
      *                                                                   CSE023
     C           @RTCD     IFEQ *BLANKS                                   CSE023
     C                     MOVE 'Y'       CSE023  1                       CSE023
     C                     MOVE 'Y'       WWITAX  1                       CSE023
     C                     ENDIF                                          CSE023
      ** Check if switchable feature CGL018 is switched on.               CGL018
      *                                                                   CGL018
     C                     CALL 'AOSARDR0'                                CGL018
     C                     PARM '       ' @RTCD                           CGL018
     C                     PARM '*VERIFY' @OPTN                           CGL018
     C                     PARM 'CGL018'  @SARD                           CGL018
     C           SCSARD    PARM SCSARD    DSSDY                           CGL018
      *                                                                   CGL018
     C           @RTCD     IFEQ '*ERROR'                                  CGL018
      *                                                                   CGL018
      ** Call to program ended in error.                                  CGL018
      *                                                                   CGL018
     C                     MOVEL'Y2U0032' W0RTN                           CGL018
     C                     MOVEL*BLANKS   W0CLPG                          CGL018
     C                     MOVEL'AOSARDR0'W0CLPG                          CGL018
      *                                                                   CGL018
      ** Send message '*Error occurred on CALL...'.                       CGL018
      *                                                                   CGL018
     C                     MOVEL'Y2U0032' ZAMSID                          CGL018
     C                     MOVEL'Y2USRMSG'ZAMSGF                          CGL018
     C                     MOVELW0CLPG    ZAMSDA                          CGL018
     C                     EXSR ZASNMS                                    CGL018
     C                     ENDIF                                          CGL018
      *                                                                   CGL018
     C           @RTCD     IFNE *BLANK                                    CGL018
     C           @RTCD     ANDNE'*NRF '                                   CGL018
     C           *LOCK     IN   LDA                                       CGL018
     C                     Z-ADD003       DBASE            ************   CGL018
     C                     MOVEL'SCSARDPD'DBFILE           * DBERR 03 *   CGL018
     C                     MOVEL'CGL018'  DBKEY            ************   CGL018
     C                     OUT  LDA                                       CGL018
     C                     EXSR *PSSR                                     CGL018
     C                     ELSE                                           CGL018
     C                     MOVE 'N'       WURWAC                          CGL018
     C                     MOVE 'N'       CGL018                          CGL018
     C                     ENDIF                                          CGL018
      *                                                                   CGL018
     C           @RTCD     IFEQ *BLANKS                                   CGL018
     C                     MOVE 'Y'       CGL018  1                       CGL018
     C                     MOVE 'Y'       WURWAC  1                       CGL018
     C                     ENDIF                                          CGL018
      *                                                                                       CSD028
      ** Check if switchable feature CSD028 is switched on                                    CSD028
      *                                                                                       CSD028
     C                     CALL 'AOSARDR0'                                                    CSD028
     C                     PARM '       ' PRTCD   7                                           CSD028
     C                     PARM '*VERIFY' POPTN   7                                           CSD028
     C                     PARM 'CSD028'  PSARD   6                                           CSD028
     C           SCSARD    PARM SCSARD    DSSDY                                               CSD028
      *                                                                                       CSD028
     C           PRTCD     IFEQ '*ERROR'                                                      CSD028
      *                                                                                       CSD028
      ** Call to program ended in error                                                       CSD028
      *                                                                                       CSD028
     C                     MOVEL'Y2U0032' W0RTN                                               CSD028
     C                     MOVEL*BLANKS   W0CLPG                                              CSD028
     C                     MOVEL'AOSARDR0'W0CLPG                                              CSD028
      *                                                                                       CSD028
      ** Send message '*Error occurred on CALL...'                                            CSD028
      *                                                                                       CSD028
     C                     MOVEL'Y2U0032' ZAMSID                                              CSD028
     C                     MOVEL'Y2USRMSG'ZAMSGF                                              CSD028
     C                     MOVELW0CLPG    ZAMSDA                                              CSD028
     C                     EXSR ZASNMS                                                        CSD028
     C                     ENDIF                                                              CSD028
      *                                                                                       CSD028
     C           PRTCD     IFNE *BLANK                                                        CSD028
     C           PRTCD     ANDNE'*NRF '                                                       CSD028
     C           *LOCK     IN   LDA                                                           CSD028
     C                     Z-ADD001       DBASE                                               CSD028
     C                     MOVEL'SCSARDPD'DBFILE                                              CSD028
     C                     MOVEL'CSD028'  DBKEY                                               CSD028
     C                     OUT  LDA                                                           CSD028
     C                     EXSR *PSSR                                                         CSD028
     C                     ELSE                                                               CSD028
     C                     MOVE 'N'       CSD028                                              CSD028
     C                     ENDIF                                                              CSD028
      *                                                                                       CSD028
     C           PRTCD     IFEQ *BLANKS                                                       CSD028
     C                     MOVE 'Y'       CSD028  1                                           CSD028
     C                     ENDIF                                                              CSD028
      *                                                                   CSE023
      ** Check if switchable feature CSD093 is switched on.                                   CSD093
      *                                                                                       CSD093
     C                     CALL 'AOSARDR0'                                                    CSD093
     C                     PARM '       ' @RTCD                                               CSD093
     C                     PARM '*VERIFY' @OPTN                                               CSD093
     C                     PARM 'CSD093'  @SARD                                               CSD093
     C           SCSARD    PARM SCSARD    DSSDY                                               CSD093
      *                                                                                       CSD093
     C           @RTCD     IFEQ '*ERROR'                                                      CSD093
      *                                                                                       CSD093
      ** Call to program ended in error.                                                      CSD093
      *                                                                                       CSD093
     C                     MOVEL'Y2U0032' W0RTN                                               CSD093
     C                     MOVEL*BLANKS   W0CLPG                                              CSD093
     C                     MOVEL'AOSARDR0'W0CLPG                                              CSD093
      *                                                                                       CSD093
      ** Send message '*Error occurred on CALL...'.                                           CSD093
      *                                                                                       CSD093
     C                     MOVEL'Y2U0032' ZAMSID                                              CSD093
     C                     MOVEL'Y2USRMSG'ZAMSGF                                              CSD093
     C                     MOVELW0CLPG    ZAMSDA                                              CSD093
     C                     EXSR ZASNMS                                                        CSD093
     C                     ENDIF                                                              CSD093
      *                                                                                       CSD093
     C           @RTCD     IFNE *BLANK                                                        CSD093
     C           @RTCD     ANDNE'*NRF '                                                       CSD093
     C           *LOCK     IN   LDA                                                           CSD093
     C                     Z-ADD002       DBASE                                               CSD093
     C                     MOVEL'SCSARDPD'DBFILE                                              CSD093
     C                     MOVEL'CSD093'  DBKEY                                               CSD093
     C                     OUT  LDA                                                           CSD093
     C                     EXSR *PSSR                                                         CSD093
     C                     ELSE                                                               CSD093
     C                     MOVE 'N'       CSD093                                              CSD093
     C                     ENDIF                                                              CSD093
      *                                                                                       CSD093
     C           @RTCD     IFEQ *BLANKS                                                       CSD093
     C                     MOVE 'Y'       CSD093  1                                           CSD093
      *                                                                                       CSD093
     C                     ENDIF                                                              CSD093
      *                                                                                       CSD093
      ** Check if switchable feature CGL032 is switched on.                                   CGL032
      *                                                                                       CGL032
     C                     CALL 'AOSARDR0'                                                    CGL032
     C                     PARM '       ' @RTCD                                               CGL032
     C                     PARM '*VERIFY' @OPTN                                               CGL032
     C                     PARM 'CGL032'  @SARD                                               CGL032
     C           SCSARD    PARM SCSARD    DSSDY                                               CGL032
      *                                                                                       CGL032
     C           @RTCD     IFEQ '*ERROR'                                                      CGL032
      *                                                                                       CGL032
      ** Call to program ended in error.                                                      CGL032
      *                                                                                       CGL032
     C                     MOVEL'Y2U0032' W0RTN                                               CGL032
     C                     MOVEL*BLANKS   W0CLPG                                              CGL032
     C                     MOVEL'AOSARDR0'W0CLPG                                              CGL032
      *                                                                                       CGL032
      ** Send message '*Error occurred on CALL...'.                                           CGL032
      *                                                                                       CGL032
     C                     MOVEL'Y2U0032' ZAMSID                                              CGL032
     C                     MOVEL'Y2USRMSG'ZAMSGF                                              CGL032
     C                     MOVELW0CLPG    ZAMSDA                                              CGL032
     C                     EXSR ZASNMS                                                        CGL032
     C                     ENDIF                                                              CGL032
      *                                                                                       CGL032
     C           @RTCD     IFNE *BLANK                                                        CGL032
     C           @RTCD     ANDNE'*NRF '                                                       CGL032
     C           *LOCK     IN   LDA                                                           CGL032
     C                     Z-ADD102       DBASE            ************                       CGL032
     C                     MOVEL'SCSARDPD'DBFILE           * DBERR 102*                       CGL032
     C                     MOVEL'CGL032'  DBKEY            ************                       CGL032
     C                     OUT  LDA                                                           CGL032
     C                     EXSR *PSSR                                                         CGL032
     C                     ELSE                                                               CGL032
     C                     MOVE 'N'       CGL032                                              CGL032
     C                     ENDIF                                                              CGL032
      *                                                                                       CGL032
     C           @RTCD     IFEQ *BLANKS                                                       CGL032
     C                     MOVE 'Y'       CGL032  1                                           CGL032
     C                     ENDIF                                                              CGL032
      *                                                                                       CGL032
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
      * Hook SD0014VC14 moved and replaced with SD0014VCC2                S01408
     C*CO*Y*WN*PY*RC*SD0014VC14                                           S01408
     C/COPY WNCPYSRC,SD0014VCC2                                           S01408
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Setup job date/time
      *
     C                     Z-ADDUDATE     ##JDT
      * Set century digit (If YY prior to 1940 treat as 20YY)
     C           ##JYY     IFLT 40
     C                     Z-ADD1         ##JCC
     C                     ELSE
     C                     Z-ADD0         ##JCC
     C                     END
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field S01212
     C                     MOVEL*BLANK    WUMFTS  1
      * Define work field F8 Option Selected
     C                     MOVEL*BLANK    WUF8OS  1
      * Obtain default message file
     C           *NAMVAR   DEFN Y2MGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field call futures & options
     C                     MOVEL*BLANK    WUCFAO  1
      * Define work field LPHAS Value from Leo
     C                     MOVEL*BLANK    WULPHS  1
      * Define work field Access Pgm Return Code
     C                     MOVEL*BLANK    WUAPRC  7
      * Define work field Return Code work field
     C                     MOVEL*BLANK    WURTCD  7
      * Define work field Delete Mode
     C                     MOVEL*BLANK    WUDELM  1
      * Define work field Action Code
     C                     MOVEL*BLANK    WUANCD  1
      * Define work field SAR S01497
     C                     MOVEL*BLANK    WUFCSD  1
      * Define work field SAR S01425
     C                     MOVEL*BLANK    WUWSAR  1
      * Define work field Display customer fees
     C                     MOVEL*BLANK    WUDSCF  1
      * Define work field Retail 3
     C                     MOVEL*BLANK    WUNXST  1
      * Define work field FX Netting switched on
     C                     MOVEL*BLANK    WUY9ST  1
      * Define work field Securities
     C                     MOVEL*BLANK    WUSECS  1
      * Define work field Futures & Options
     C                     MOVEL*BLANK    WUFUOP  1
      * Define work field Portfolio Management
     C                     MOVEL*BLANK    WUPFMG  1
      * Define work field Portfolio Lending
     C                     MOVEL*BLANK    WULMCR  1
      * Define work field SAR S01467
     C                     MOVEL*BLANK    WUSSAR  1
      * Define work field User Defined Correspondnc
     C                     MOVEL*BLANK    WUN1ST  1
      * Define work field Midas-Trade Innovation If
     C                     MOVEL*BLANK    WUN3ST  1
      * Define work field Customer Shortname
     C                     MOVEL*BLANK    WUCSSN 10
      * Define work field TI Customer Flag
     C                     MOVEL*BLANK    WUTICS  1
      **Define*work*field*TI*shortname*position*7**********************   140709
     C**********           MOVEL*BLANK    WUTIS7  1                       140709
      * Define work field Option for ACCOBJ
     C                     MOVEL*BLANK    WUEOTX  7
      * Define work field LEO Customer (numeric)
     C                     Z-ADD*ZERO     WULCUN  80
      * Define work field Key status
     C                     MOVEL*BLANK    WUKSTS  7
      * Define work field Access object format
     C                     MOVEL*BLANK    WUSFMT256
      * Define work field Display Product Info ?
     C                     MOVEL*BLANK    WUDPIN  1
      * Define work field Portfolio Management Scr
     C                     MOVEL*BLANK    WUPMSC  1
      * Define work field Midas Run Date
     C                     MOVEL*BLANK    WUMRDT  7
      * Define work field Run day number
     C                     Z-ADD*ZERO     WURDNB  50
      * Define work field Set Up Complete
     C                     MOVEL*BLANK    WUSUC   1
      * Define work field Date format flag
     C                     MOVEL*BLANK    WUDFF   1
      * Define work field Multi-branching Indicator
     C                     MOVEL*BLANK    WUMBIN  1
      * Define work field Midas/Telex Module Ind.
     C                     MOVEL*BLANK    WUMTMI  1
      * Define work field SWIFT Funds Transfer
     C                     MOVEL*BLANK    WUSWFT  1
      * Define work field SWIFT Securities Trading
     C                     MOVEL*BLANK    WUSWST  1
      * Define work field SWIFT Customer Lending
     C                     MOVEL*BLANK    WUSWCL  1
      * Define work field SWIFT Synd Loans (REDUN)
     C                     MOVEL*BLANK    WUSWSL  1
      * Define work field SWIFT Statements
     C                     MOVEL*BLANK    WUSWSM  1
      * Define work field SWIFT Dealing
     C                     MOVEL*BLANK    WUSWDL  1
      * Define work field Standing data/Gen.Ledger
     C                     MOVEL*BLANK    WUSDGL  1
      * Define work field Dealing: FX
     C                     MOVEL*BLANK    WUDLFX  1
      * Define work field Syndicated Loans (REDUN)
     C                     MOVEL*BLANK    WUSYLN  1
      * Define work field Exposure Management
     C                     MOVEL*BLANK    WUEXMG  1
      * Define work field Financial Modeller
     C                     MOVEL*BLANK    WUFNMO  1
      * Define work field Statutory Returns
     C                     MOVEL*BLANK    WUSTRT  1
      * Define work field Customer Lending
     C                     MOVEL*BLANK    WUCSLN  1
      * Define work field Retail Banking
     C                     MOVEL*BLANK    WURTBN  1
      * Define work field Midas/Swift direct link
     C                     MOVEL*BLANK    WUMSDL  1
      * Define work field Auto-reconciliations
     C                     MOVEL*BLANK    WUAURC  1
      * Define work field Bond Dealers Interface
     C                     MOVEL*BLANK    WUBDLI  1
      * Define work field DRS Standing Data
     C                     MOVEL*BLANK    WUDRSD  1
      * Define work field DRS Control module
     C                     MOVEL*BLANK    WUDRCM  1
      * Define work field DRS Foreign Exchange
     C                     MOVEL*BLANK    WUDRFE  1
      * Define work field DRS Money Market
     C                     MOVEL*BLANK    WUDRMM  1
      * Define work field DRS Arbitrage
     C                     MOVEL*BLANK    WUDRAR  1
      * Define work field Funds Transfer
     C                     MOVEL*BLANK    WUFDTR  1
      * Define work field DRS Common Applications
     C                     MOVEL*BLANK    WUDRCA  1
      * Define work field Midas/Telex Synd. Loans
     C                     MOVEL*BLANK    WUMTSL  1
      * Define work field Midas/Telex Dealing
     C                     MOVEL*BLANK    WUMTDL  1
      * Define work field Midas/Telex Gen. Ledger
     C                     MOVEL*BLANK    WUMTGL  1
      * Define work field Midas/Telex Cust. Lending
     C                     MOVEL*BLANK    WUMTCL  1
      * Define work field Message Management
     C                     MOVEL*BLANK    WUNWMI  1
      * Define work field FRA/IRS Indicator
     C                     MOVEL*BLANK    WUFIIN  1
      * Define work field Dealing: MM
     C                     MOVEL*BLANK    WUDLMM  1
      * Define work field Internal Contracts
     C                     MOVEL*BLANK    WUINCN  1
      * Define work field Treasury Management
     C                     MOVEL*BLANK    WUTRMG  1
      * Define work field Interest Risk Management
     C                     MOVEL*BLANK    WURKMG  1
      * Define work field Testkey
     C                     MOVEL*BLANK    WUTSKY  1
      * Define work field Midas/Q
     C                     MOVEL*BLANK    WUMIDQ  1
      * Define work field Microfiche
     C                     MOVEL*BLANK    WUMFIC  1
      * Define work field Interest on accounts
     C                     MOVEL*BLANK    WUIOAC  1
      * Define work field Window processing requir.
     C                     MOVEL*BLANK    WUWDPR  1
      * Define work field SAR's processing required
     C                     MOVEL*BLANK    WUSARP  1
      * Define work field French return indicator
     C                     MOVEL*BLANK    WUFRIN  1
      * Define work field Lux return indicator
     C                     MOVEL*BLANK    WULRIN  1
      * Define work field Dutch return indicator
     C                     MOVEL*BLANK    WUDRIN  1
      * Define work field German return indicator
     C                     MOVEL*BLANK    WUGRIN  1
      * Define work field Belgian return indicator
     C                     MOVEL*BLANK    WUBRIN  1
      * Define work field Italian return indicator
     C                     MOVEL*BLANK    WUIRIN  1
      * Define work field Swift External Interface
     C                     MOVEL*BLANK    WUSWEI  1
      * Define work field Credit Management.
     C                     MOVEL*BLANK    WUCRMG  1
      * Define work field Head Office Reporting
     C                     MOVEL*BLANK    WUHORP  1
      * Define work field Average Balances
     C                     MOVEL*BLANK    WUAVBL  1
      * Define work field Margins
     C                     MOVEL*BLANK    WUMARG  1
      * Define work field Confirmation Matching
     C                     MOVEL*BLANK    WUCFMT  1
      * Define work field Mimix
     C                     MOVEL*BLANK    WUMIMX  1
      * Define work field Report Control Facility
     C                     MOVEL*BLANK    WURCFI  1
      * Define work field Amps Int
     C                     MOVEL*BLANK    WUAMIN  1
      * Define work field Swiss Returns
     C                     MOVEL*BLANK    WUSWRT  1
      * Define work field Fiduciary Loans & Deposit
     C                     MOVEL*BLANK    WUFLND  1
      * Define work field Cantonal Tax
     C                     MOVEL*BLANK    WUCNTX  1
      * Define work field Stamp Duty
     C                     MOVEL*BLANK    WUSTDU  1
      * Define work field Use DRS Shortnames
     C                     MOVEL*BLANK    WUUDRS  1
      * Define work field Chips Dealing
     C                     MOVEL*BLANK    WUCHDL  1
      * Define work field Chips Lending
     C                     MOVEL*BLANK    WUCHLN  1
      * Define work field Chips Opening Balance
     C                     MOVEL*BLANK    WUCHOB  1
      * Define work field CHIPS
     C                     MOVEL*BLANK    WUCHIP  1
      * Define work field Chips Direct Link
     C                     MOVEL*BLANK    WUCHDI  1
      * Define work field Optical Disk
     C                     MOVEL*BLANK    WUOPDK  1
      * Define work field Leo Data Nucleus
     C                     MOVEL*BLANK    WUNNST  1
      * Define work field Leo Letters of Credit
     C                     MOVEL*BLANK    WUNOST  1
      * Define work field Leo Collections
     C                     MOVEL*BLANK    WUNPST  1
      * Define work field Leo Bills/Financing
     C                     MOVEL*BLANK    WUNQST  1
      * Define work field Leo Bankers Acceptances
     C                     MOVEL*BLANK    WUNRST  1
      * Define work field Leo Reimbursements
     C                     MOVEL*BLANK    WUNSST  1
      * Define work field Taxes
     C                     MOVEL*BLANK    WUNTST  1
      * Define work field History & Audit Facility
     C                     MOVEL*BLANK    WUNUST  1
      * Define work field Management Accounts
     C                     MOVEL*BLANK    WUNVST  1
      * Define work field IBLC Returns
     C                     MOVEL*BLANK    WUNWST  1
      * Define work field Interest on Accounts 3
     C                     MOVEL*BLANK    WUNYST  1
      * Define work field Midas Export Data Module
     C                     MOVEL*BLANK    WUNZST  1
      * Define work field Analytical Accounting
     C                     MOVEL*BLANK    WUN0ST  1
      * Define work field Midas-Plato Interface
     C                     MOVEL*BLANK    WUN2ST  1
      * Define work field Reserved for Later Use 41
     C                     MOVEL*BLANK    WUN4ST  1
      * Define work field Reserved for Later Use 42
     C                     MOVEL*BLANK    WUN5ST  1
      * Define work field Reserved for Later Use 43
     C                     MOVEL*BLANK    WUN6ST  1
      * Define work field Reserved for Later Use 44
     C                     MOVEL*BLANK    WUN7ST  1
      * Define work field Reserved for Later Use 45
     C                     MOVEL*BLANK    WUN8ST  1
      * Define work field Reserved for Later Use 46
     C                     MOVEL*BLANK    WUN9ST  1
      * Define work field Reserved for Later Use 47
     C                     MOVEL*BLANK    WUOAST  1
      * Define work field Reserved for Later Use 48
     C                     MOVEL*BLANK    WUOBST  1
      * Define work field Reserved for Later Use 49
     C                     MOVEL*BLANK    WUOCST  1
      * Define work field Reserved for Later Use 50
     C                     MOVEL*BLANK    WUODST  1
      * Define work field Reserved for Later Use 51
     C                     MOVEL*BLANK    WUOEST  1
      * Define work field Reserved for Later Use 52
     C                     MOVEL*BLANK    WUOFST  1
      * Define work field Reserved for Later Use 53
     C                     MOVEL*BLANK    WUOGST  1
      * Define work field Reserved for Later Use 54
     C                     MOVEL*BLANK    WUOHST  1
      * Define work field Reserved for Later Use 55
     C                     MOVEL*BLANK    WUOIST  1
      * Define work field Reserved for Later Use 56
     C                     MOVEL*BLANK    WUOJST  1
      * Define work field Reserved for Later Use 57
     C                     MOVEL*BLANK    WUOKST  1
      * Define work field Reserved for Later Use 58
     C                     MOVEL*BLANK    WUOLST  1
      * Define work field Reserved for Later Use 59
     C                     MOVEL*BLANK    WUOMST  1
      * Define work field Reserved for Later Use 60
     C                     MOVEL*BLANK    WUONST  1
      * Define work field Reserved for Later Use 61
     C                     MOVEL*BLANK    WUOOST  1
      * Define work field Reserved for Later Use 62
     C                     MOVEL*BLANK    WUOPST  1
      * Define work field Reserved for Later Use 63
     C                     MOVEL*BLANK    WUOQST  1
      * Define work field Reserved for Later Use 64
     C                     MOVEL*BLANK    WUORST  1
      * Define work field Reserved for Later Use 65
     C                     MOVEL*BLANK    WUOSST  1
      * Define work field SAR number field
     C                     MOVEL*BLANK    WUSARN  6
      * Define work field SAR S01423
     C                     MOVEL*BLANK    WUSARW  1
      * Define work field SAR S01464
     C                     MOVEL*BLANK    WURTST  1
      * Define work field Ref Attached to 9997
     C                     MOVEL*BLANK    WUR997  4
      * Define work field Portfolios Supported
     C                     MOVEL*BLANK    WUPORS  1
      * Define work field Branch code
     C                     MOVEL*BLANK    WUBRCD  3
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW02  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW03  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW04  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW05  50       *Synon (5,0) wo
     C                     MOVEL*BLANKS   YRSW06  1        *String work fi
     C                     MOVEL*BLANKS   YRSW07  1        *String work fi
     C                     MOVEL*BLANKS   YRSW08  7        *Return code
     C                     MOVEL*BLANKS   YRSW09  1        *String work fi
      * *Synon (9999) work field
     C                     MOVEL*BLANKS   YRSW0A           *Synon (9999) w
      * *Synon (9999) work field
     C                     MOVEL*BLANKS   YRSW0B           *Synon (9999) w
      * *Synon (9999) work field
     C                     MOVEL*BLANKS   YRSW0C           *Synon (9999) w
      * *Synon (9999) work field
     C                     MOVEL*BLANKS   YRSW0D           *Synon (9999) w
     C                     MOVEL*BLANKS   YRSW0E  1        *String work fi
     C                     MOVEL*BLANKS   YRSW0F  1        *String work fi
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Open files
     C/COPY WNCPYSRC,SD0014VC36
     C                     OPEN SD0014V#
     C/COPY WNCPYSRC,SD0014VC37
     C                     OPEN SDCMRKL1
     C                     OPEN SDACUSL1
     C                     OPEN SDCFCDL1
     C                     OPEN SDSECSL1
     C                     OPEN SDFOCSL1
     C                     OPEN SDPLCSL1
     C                     OPEN SDLBCSL1
     C                     OPEN SDCLEOL1
     C                     OPEN SDTICSL1
     C                     OPEN SDCUSTL1
     C                     OPEN SDLOCNL1
     C                     OPEN SDACOFL1
     C                     OPEN SDCTRYL1
     C                     OPEN SDBRCHL1
     C                     OPEN SDINSTL1
     C                     OPEN SDINDSL1
     C                     OPEN SDCRWCL1
     C                     OPEN SDMTPYL1
     C                     OPEN SDNWRKL1
     C                     OPEN SDMMODL1
     C                     OPEN SDPORTL1
     C                     OPEN SDBRCHL5
     C                     MOVEL'N'       W0PMT   1
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * Start of change S01459.
      * SD0014V precompiler - Client Details  *
      * Remove Last Amend Box and Creation Parameters functions.
      * End of change S01459.
      * Copyright Statement 1988 - Standard Functions  * copyright
      * Get Rundate - Rundate  *
     C           *NAMVAR   DEFN           RUNDAT
     C                     IN   RUNDAT
     C                     MOVE MRDT      ##MRDT  7        RUN DATE
     C                     MOVE MRDT      WUMRDT
     C                     MOVE RDNB      WURDNB           RUNDAY NO.
     C                     MOVE SUC       WUSUC            SET UP COMPLT
     C                     MOVE DFF       WUDFF            DTE FMT FLAG
     C                     MOVE MBIN      WUMBIN           MULTI BR. IND
      * Start of S01522.
      * Call 'get all Midas Modules' to retrieve the module flags.
      * Get all Midas Modules - MIDAS Modules  *
     C                     EXSR TURVGN
      * Remove the call to 'Get ST & FO indicators'
      * End of S01522.
      * Start of Fix S01267
      * Display Product Information?
      * CASE: PAR.Parent Indicator is Parent
     C           P3PAIN    IFEQ 'P'                        *IF
     C                     MOVEL'N'       WUSECS           Securities
     C                     MOVEL'N'       WUFUOP           Futures & Optio
     C                     END                             *FI
      * End of Fix S01267
      * Start of S01522.
      * Called 'get all Midas Modules' to retrieve the module flags.
      * Remove the call to 'Get Retail 3/IOA Indic'
      * Start S01413
      * End S01413
      * End of S01522.
      * Start of SAR S01421
      * Start of S01425 - Additional Customer Details
     C                     MOVEL'N'       WUWSAR           SAR S01425
     C                     MOVEL'S01425'  WUSARN           SAR number fiel
     C                     MOVEL*BLANK    WUAPRC           Access Pgm Retu
      * SAR switched on check - Standard Functions  *
     C                     CALL 'AOSARDR0'             90  SAR switched on
     C           WUAPRC    PARM WUAPRC    WQ0144  7        Access Pgm Retu
     C                     PARM '*VERIFY' WQ0145  7        Option for ACCO
     C           WUSARN    PARM WUSARN    WQ0146  6        SAR number fiel
     C                     PARM *BLANK    WQ0147 76        Access obj dumm
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'AOSARDR0'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Check return code.
      * CASE: WRK.Access Pgm Return Code is AP No Record Found
     C           WUAPRC    IFEQ '*NRF'                     *IF
     C                     MOVEL'N'       WUWSAR           SAR S01425
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUWSAR           SAR S01425
     C                     END                             *FI
      * Free SCSARDPD
      * SAR switched on check - Standard Functions  *
     C                     CALL 'AOSARDR0'             90  SAR switched on
     C           WUAPRC    PARM WUAPRC    WQ0148  7        Access Pgm Retu
     C                     PARM '*FREE'   WQ0149  7        Option for ACCO
     C           WUSARN    PARM WUSARN    WQ0150  6        SAR number fiel
     C                     PARM *BLANK    WQ0151 76        Access obj dumm
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'AOSARDR0'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * End of S01425
      * Start of S01423 - Customer Fees
     C                     MOVEL'N'       WUSARW           SAR S01423
     C                     MOVEL'S01423'  WUSARN           SAR number fiel
     C                     MOVEL*BLANK    WUAPRC           Access Pgm Retu
      * SAR switched on check - Standard Functions  *
     C                     CALL 'AOSARDR0'             90  SAR switched on
     C           WUAPRC    PARM WUAPRC    WQ0152  7        Access Pgm Retu
     C                     PARM '*VERIFY' WQ0153  7        Option for ACCO
     C           WUSARN    PARM WUSARN    WQ0154  6        SAR number fiel
     C                     PARM *BLANK    WQ0155 76        Access obj dumm
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'AOSARDR0'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Check return code.
      * CASE: WRK.Access Pgm Return Code is AP No Record Found
     C           WUAPRC    IFEQ '*NRF'                     *IF
     C                     MOVEL'N'       WUSARW           SAR S01423
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUSARW           SAR S01423
     C                     END                             *FI
      * Free SCSARDPD
      * SAR switched on check - Standard Functions  *
     C                     CALL 'AOSARDR0'             90  SAR switched on
     C           WUAPRC    PARM WUAPRC    WQ0156  7        Access Pgm Retu
     C                     PARM '*FREE'   WQ0157  7        Option for ACCO
     C           WUSARN    PARM WUSARN    WQ0158  6        SAR number fiel
     C                     PARM *BLANK    WQ0159 76        Access obj dumm
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'AOSARDR0'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * End of S01423
      * End of SAR S01421
      * Start of S01464 - Safe custody fees
     C                     MOVEL'N'       WURTST           SAR S01464
     C                     MOVEL'S01464'  WUSARN           SAR number fiel
     C                     MOVEL*BLANK    WUAPRC           Access Pgm Retu
      * SAR switched on check - Standard Functions  *
     C                     CALL 'AOSARDR0'             90  SAR switched on
     C           WUAPRC    PARM WUAPRC    WQ0160  7        Access Pgm Retu
     C                     PARM '*VERIFY' WQ0161  7        Option for ACCO
     C           WUSARN    PARM WUSARN    WQ0162  6        SAR number fiel
     C                     PARM *BLANK    WQ0163 76        Access obj dumm
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'AOSARDR0'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *                                                                   CSD008
      ** Call access program AOSARDR0- determine if CSD008 is installed   CSD008
      *                                                                   CSD008
     C                     CALL 'AOSARDR0'             90                 CSD008
     C                     PARM '       ' @RTCD                           CSD008
     C                     PARM '*VERIFY' @OPTN                           CSD008
     C                     PARM 'CSD008'  @SARD                           CSD008
     C           SCSARD    PARM SCSARD    DSSDY                           CSD008
      *                                                                   CSD008
     C           *IN90     IFEQ '1'                                       CSD008
      *                                                                   CSD008
      ** Call to program ended in error                                   CSD008
      *                                                                   CSD008
     C                     MOVEL'Y2U0032' W0RTN                           CSD008
     C                     MOVEL*BLANKS   W0CLPG                          CSD008
     C                     MOVEL'AOSARDR0'W0CLPG                          CSD008
      *                                                                   CSD008
      ** Send message '*Error occurred on CALL...'                        CSD008
      *                                                                   CSD008
     C                     MOVEL'Y2U0032' ZAMSID                          CSD008
     C                     MOVEL'Y2USRMSG'ZAMSGF                          CSD008
     C                     MOVELW0CLPG    ZAMSDA                          CSD008
     C                     EXSR ZASNMS                                    CSD008
     C                     ENDIF                                          CSD008
      *                                                                   CSD008
      ** Handle Database Error.                                           CSD008
      *                                                                   CSD008
     C           @RTCD     IFNE *BLANKS                                   CSD008
     C           @RTCD     ANDNE'*NRF   '                                 CSD008
     C           *LOCK     IN   LDA                                       CSD008
     C                     MOVE 'SCSARDPD'DBFILE                          CSD008
     C                     MOVEL@OPTN     DBKEY            *************  CSD008
     C                     Z-ADD003       DBASE            * DBERR 003 *  CSD008
     C                     MOVEL'SD0014V' DBPGM            *************  CSD008
     C                     OUT  LDA                                       CSD008
     C                     EXSR *PSSR                                     CSD008
     C                     ENDIF                                          CSD008
      *                                                                   CSD008
      ** CSD008 is installed                                              CSD008
      *                                                                   CSD008
     C           @RTCD     IFEQ *BLANKS                                   CSD008
     C                     MOVE 'Y'       CSD008  1                       CSD008
     C                     ELSE                                           CSD008
     C                     MOVE 'N'       CSD008                          CSD008
     C                     ENDIF                                          CSD008
      *
      * CASE: WRK.Access Pgm Return Code is AP No Record Found
     C           WUAPRC    IFEQ '*NRF'                     *IF
     C                     MOVEL'N'       WURTST           SAR S01464
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WURTST           SAR S01464
     C                     END                             *FI
     C                     MOVEL'N'       WUDSCF           Display custome
      * CASE:
      *  - c1 AND c2 OR c1 ORc2
      *   |- c1    : WRK.SAR S01423 is Present
      *   |- c2    : WRK.SAR S01464 is Present
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUSARW    IFEQ 'Y'                        *IF
     C           WURTST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WUSARW    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WURTST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C           CSD008    OREQ 'Y'                                       CSD008
     C                     MOVEL'Y'       WUDSCF           Display custome
     C                     END                             *FI
      * End of S01464
     C                     MOVEL'Y'       WUMFTS           S01212
      * Start of S01467 - Midas-LEO Integration
     C                     MOVEL'N'       WUSSAR           SAR S01467
     C                     MOVEL'S01467'  WUSARN           SAR number fiel
     C                     MOVEL*BLANK    WUAPRC           Access Pgm Retu
      * SAR switched on check - Standard Functions  *
     C                     CALL 'AOSARDR0'             90  SAR switched on
     C           WUAPRC    PARM WUAPRC    WQ0164  7        Access Pgm Retu
     C                     PARM '*VERIFY' WQ0165  7        Option for ACCO
     C           WUSARN    PARM WUSARN    WQ0166  6        SAR number fiel
     C                     PARM *BLANK    WQ0167 76        Access obj dumm
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'AOSARDR0'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Check return code.
      * CASE: WRK.Access Pgm Return Code is AP No Record Found
     C           WUAPRC    IFEQ '*NRF'                     *IF
     C                     MOVEL'N'       WUSSAR           SAR S01467
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUSSAR           SAR S01467
     C                     END                             *FI
      * End of S01467
      * Start of S01522.
      * Called 'get all Midas Modules' to retrieve the module flags.
      * Remove the call to 'Get Portfolio Management'
      * Remove the call to 'Get Portfolio Lending'
      * Start of S01486
      * End of S01486
      * End of S01522.
      * Start of change S01497.
     C                     MOVEL'N'       WUFCSD           SAR S01497
     C                     MOVEL'S01497'  WUSARN           SAR number fiel
     C                     MOVEL*BLANK    WUAPRC           Access Pgm Retu
      * SAR switched on check - Standard Functions  *
     C                     CALL 'AOSARDR0'             90  SAR switched on
     C           WUAPRC    PARM WUAPRC    WQ0168  7        Access Pgm Retu
     C                     PARM '*VERIFY' WQ0169  7        Option for ACCO
     C           WUSARN    PARM WUSARN    WQ0170  6        SAR number fiel
     C                     PARM *BLANK    WQ0171 76        Access obj dumm
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'AOSARDR0'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Check return code.
      * CASE: WRK.Access Pgm Return Code is AP No Record Found
     C           WUAPRC    IFEQ '*NRF'                     *IF
     C                     MOVEL'N'       WUFCSD           SAR S01497
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUFCSD           SAR S01497
     C                     END                             *FI
      * End of change S01497.
      * /COPY.
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy member SD0014VIPG - Client Details  *
     C/COPY WNCPYSRC,SD0014VCPG
     C                     END                             *FI
      * Display Product Information?
      * CASE:
      *  - c1 AND c2 AND c3 AND c4 AND c5 AND c6
      *   |- c1    : WRK.Securities is No
      *   |- c2    : WRK.Futures & Options is No
      *   |- c3    : WRK.Portfolio Management is No
      *   |- c4    : WRK.Portfolio Lending is No
      *   |- c5    : WRK.SAR S01467 is Not present
      *   |- c6    : WRK.Midas-Trade Innovation If is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUSECS    IFEQ 'N'                        *IF
     C           WUFUOP    IFEQ 'N'                        *IF
     C           WUPFMG    IFEQ 'N'                        *IF
     C           WULMCR    IFEQ 'N'                        *IF
     C           WUSSAR    IFEQ 'N'                        *IF
     C           WUN3ST    IFEQ 'N'                        *IF
     C           CTI006    OREQ 'N'                        *IF                              MD030956
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       WUDPIN           Display Product
     C                     END                             *FI
      * Start CPM004
      * Portfolio Management - set display indicator
      * CASE: WRK.Portfolio Management is Yes
     C           WUPFMG    IFEQ 'Y'                        *IF
      * Get Port Man ICD fields - Portfolio Management ICD  *
     C                     EXSR TVRVGN
      * CASE: WRK.Portfolios Supported is Customer
     C           WUPORS    IFEQ 'C'                        *IF
     C                     MOVEL'Y'       WUPMSC           Portfolio Manag
     C                     ELSE
      * CASE: *OTHERWISE
      * Retrieve Int Cust Branch - Branch Codes  *
     C                     EXSR TWRVGN
      * CASE: PGM.*Return code is Customer on branch codes
     C           W0RTN     IFEQ 'BRANCH'                   *IF
     C                     MOVEL'Y'       WUPMSC           Portfolio Manag
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUPMSC           Portfolio Manag
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUPMSC           Portfolio Manag
     C                     END                             *FI
      * End CPM004
      * Start of change CDL002.
     C                     MOVEL'N'       WUY9ST           FX Netting swit
     C                     MOVEL'CDL002'  WUSARN           SAR number fiel
     C                     MOVEL*BLANK    WUAPRC           Access Pgm Retu
      * SAR switched on check - Standard Functions  *
     C                     CALL 'AOSARDR0'             90  SAR switched on
     C           WUAPRC    PARM WUAPRC    WQ0172  7        Access Pgm Retu
     C                     PARM '*VERIFY' WQ0173  7        Option for ACCO
     C           WUSARN    PARM WUSARN    WQ0174  6        SAR number fiel
     C                     PARM *BLANK    WQ0175 76        Access obj dumm
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'AOSARDR0'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Check return code.
      * CASE: WRK.Access Pgm Return Code is AP No Record Found
     C           WUAPRC    IFEQ '*NRF'                     *IF
     C                     MOVEL'N'       WUY9ST           FX Netting swit
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUY9ST           FX Netting swit
     C                     END                             *FI
      * End of change CDL002.
     C/COPY WNCPYSRC,SD0014VC44
      *                                                                                       CER001
      ** Start of change PB3610.                                                              CER001
      *                                                                                       CER001
     C                     MOVEL'N'       PB3610                                              CER001
     C                     MOVEL'PB3610'  WUSARN                                              CER001
     C                     MOVEL*BLANK    WUAPRC                                              CER001
      *                                                                                       CER001
      ** SAR switched on check - Standard Functions                                           CER001
      *                                                                                       CER001
     C                     CALL 'AOSARDR0'             90                                     CER001
     C           WUAPRC    PARM WUAPRC    WQ0172  7                                           CER001
     C                     PARM '*VERIFY' WQ0173  7                                           CER001
     C           WUSARN    PARM WUSARN    WQ0174  6                                           CER001
     C                     PARM *BLANK    WQ0175 76                                           CER001
      *                                                                                       CER001
     C           *IN90     IFEQ '1'                                                           CER001
      *                                                                                       CER001
      ** Call to program ended in error                                                       CER001
      *                                                                                       CER001
     C                     MOVEL'Y2U0032' W0RTN                                               CER001
     C                     MOVEL*BLANKS   W0CLPG 10                                           CER001
     C                     MOVEL'AOSARDR0'W0CLPG                                              CER001
      *                                                                                       CER001
      ** Send message '*Error occured on CALL...'                                             CER001
      *                                                                                       CER001
     C                     MOVEL'Y2U0032' ZAMSID                                              CER001
     C                     MOVEL'Y2USRMSG'ZAMSGF                                              CER001
     C                     MOVELW0CLPG    ZAMSDA                                              CER001
     C                     EXSR ZASNMS                                                        CER001
     C                     END                                                                CER001
      *                                                                                       CER001
      ** Check return code.                                                                   CER001
      ** CASE: WRK.Access Pgm Return Code is AP No Record Found                               CER001
      *                                                                                       CER001
     C           WUAPRC    IFNE *BLANKS                                                       CER001
     C                     MOVEL'N'       PB3610  1                                           CER001
     C                     ELSE                                                               CER001
      *                                                                                       CER001
      ** CASE: *OTHERWISE                                                                     CER001
      *                                                                                       CER001
     C                     MOVEL'Y'       PB3610                                              CER001
     C                     OPEN SDICEXL1                                                      CER001
     C                     END                                                                CER001
      *                                                                                       CER001
      ** End of change PB3610.                                                                CER001
      *                                                                                       CER001
      * Start of change CAP039.
      *                                                                   CAP039
      ** Check if switchable feature CAP139 is switched on                CAP039
      *                                                                   CAP039
     C                     CALL 'AOSARDR0'                                CAP039
     C                     PARM '       ' @RTCD   7                       CAP039
     C                     PARM '*VERIFY' @OPTN   7                       CAP039
     C                     PARM 'CAP139'  @SARD   6                       CAP039
     C           SCSARD    PARM SCSARD    DSSDY                           CAP039
      *                                                                   CAP039
     C           @RTCD     IFEQ '*ERROR'                                  CAP039
      *                                                                   CAP039
      ** Call to program ended in error                                   CAP039
      *                                                                   CAP039
     C                     MOVEL'Y2U0032' W0RTN                           CAP039
     C                     MOVEL*BLANKS   W0CLPG                          CAP039
     C                     MOVEL'AOSARDR0'W0CLPG                          CAP039
      *                                                                   CAP039
      ** Send message '*Error occurred on CALL...'                        CAP039
      *                                                                   CAP039
     C                     MOVEL'Y2U0032' ZAMSID                          CAP039
     C                     MOVEL'Y2USRMSG'ZAMSGF                          CAP039
     C                     MOVELW0CLPG    ZAMSDA                          CAP039
     C                     EXSR ZASNMS                                    CAP039
     C                     ENDIF                                          CAP039
      *                                                                   CAP039
     C           @RTCD     IFNE *BLANK                                    CAP039
     C           @RTCD     ANDNE'*NRF '                                   CAP039
     C           *LOCK     IN   LDA                                       CAP039
     C                     Z-ADD001       DBASE            ************   CAP039
     C                     MOVEL'SCSARDPD'DBFILE           * DBERR 01 *   CAP039
     C                     MOVEL'CAP139'  DBKEY            ************   CAP039
     C                     OUT  LDA                                       CAP039
     C                     EXSR *PSSR                                     CAP039
     C                     ELSE                                           CAP039
     C                     MOVE 'N'       CAP139                          CAP039
     C                     ENDIF                                          CAP039
      *                                                                   CAP039
     C           @RTCD     IFEQ *BLANKS                                   CAP039
     C                     MOVE 'Y'       CAP139  1                       CAP039
     C                     ENDIF                                          CAP039
      * End of change CAP039.                                             CAP039
      *                                                                   CAP039
      ** Check CSW207 feature, force CGL032 to be switched on                               BUG14672
      *                                                                                     BUG14672
     C                     CALL 'SWIF2007'                                                  BUG14672
     C                     PARM '       ' @RTCD                                             BUG14672
     C           @RTCD     IFEQ 'CSW2007'                                                   BUG14672
     C                     MOVEL'Y'       CSW207  1                                         BUG14672
     C                     ELSE                                                             BUG14672
     C                     MOVEL'N'       CSW207                                            BUG14672
     C                     ENDIF                                                            BUG14672
      *                                                                                     BUG14672
     C                     CALL 'AOSARDR0'                                                    CRN001
     C                     PARM           @RTCD                                               CRN001
     C                     PARM '*VERIFY' @OPTN                                               CRN001
     C                     PARM 'CRN001'  @SARD                                               CRN001
      *                                                                                       CRN001
     C                     SELEC                                                              CRN001
     C           @RTCD     WHEQ *BLANK                                                        CRN001
     C                     MOVE 'Y'       CRN001  1                                           CRN001
     C           @RTCD     WHEQ '*NRF'                                                        CRN001
     C                     MOVEL'N'       CRN001                                              CRN001
     C                     OTHER                                                              CRN001
     C                     EXSR *PSSR                                                         CRN001
     C                     ENDSL                                                              CRN001
      *                                                                                       CRN001
     C                     MOVELP1CRNM    PKCRNM                                             BUG4454
     C                     MOVELP1CRTN    PKCRTN                                             BUG4454
     C                     MOVELP1BRCD    PKBRCD                                             BUG4454
     C                     MOVELP1CRPC    PKCRPC                                             BUG4454
     C                     MOVELP1LICD    PKLICD                                             BUG4454
      ***********                                                                 BUG26917 BUG26917A
      ***Check*if*CER048*is*ON*                                                   BUG26917 BUG26917A
      **********                                                                  BUG26917 BUG26917A
     C**********           CALL 'AOSARDR0'                                        BUG26917 BUG26917A
     C**********           PARM *BLANKS   @RTCD                                   BUG26917 BUG26917A
     C**********           PARM '*VERIFY' @OPTN                                   BUG26917 BUG26917A
     C**********           PARM 'CER048'  @SARD                                   BUG26917 BUG26917A
     C********** SCSARD    PARM SCSARD    DSSDY                                   BUG26917 BUG26917A
      **********                                                                  BUG26917 BUG26917A
     C********** @RTCD     IFNE *BLANK                                            BUG26917 BUG26917A
     C********** @RTCD     ANDNE'*NRF '                                           BUG26917 BUG26917A
     C**********           Z-ADD004       DBASE                                   BUG26917 BUG26917A
     C**********           MOVEL'SCSARDPD'DBFILE                                  BUG26917 BUG26917A
     C**********           MOVEL'CER048'  DBKEY                                   BUG26917 BUG26917A
     C**********           ENDIF                                                  BUG26917 BUG26917A
      **********                                                                  BUG26917 BUG26917A
     C********** @RTCD     IFEQ *BLANK                                            BUG26917 BUG26917A
     C**********           MOVE 'Y'       CER048  1                               BUG26917 BUG26917A
     C**********           ELSE                                                   BUG26917 BUG26917A
     C**********           MOVE 'N'       CER048                                  BUG26917 BUG26917A
     C**********           ENDIF                                                  BUG26917 BUG26917A
      **********                                                                  BUG26917 BUG26917A
      * Load screen
      *                                                                                     MD030956
      ** Check whether CTI006 is switched on                                                MD030956
      *                                                                                     MD030956
     C                     CALL 'AOSARDR0'                                                  MD030956
     C                     PARM *BLANKS   @RTCD                                             MD030956
     C                     PARM '*VERIFY' @OPTN                                             MD030956
     C                     PARM 'CTI006'  @SARD                                             MD030956
     C           SCSARD    PARM SCSARD    DSSDY                                             MD030956
      *                                                                                     MD030956
     C           @RTCD     IFNE *BLANK                                                      MD030956
     C           @RTCD     ANDNE'*NRF '                                                     MD030956
     C                     Z-ADD005       DBASE                                             MD030956
     C                     MOVEL'SCSARDPD'DBFILE                                            MD030956
     C                     MOVEL'CTI006'  DBKEY                                             MD030956
     C                     ENDIF                                                            MD030956
      *                                                                                     MD030956
     C           @RTCD     IFEQ *BLANK                                                      MD030956
     C                     MOVE 'Y'       CTI006  1                                         MD030956
     C                     ELSE                                                             MD030956
     C                     MOVE 'N'       CTI006                                            MD030956
     C                     ENDIF                                                            MD030956
     C                     EXSR MALDSC
      *================================================================
     CSR         ZZEXIT    ENDSR
      /EJECT
     CSR         *PSSR     BEGSR
      *****************************************************************
      *                                                               *
      * *PSSR  - Program exception error routine                      *
      *          Called automatically if a program error occurs,      *
      *          or directly by the program code using EXSR.          *
      *          This subroutine DUMPs the program just once.         *
      *                                                               *
      *****************************************************************
      *
      * Core function specific processing.
      *
     C/COPY WNCPYSRC,SD0014VPSC
      *
      * Start of PSSR user point.
      *
     C/COPY WNCPYSRC,SD0014VPS1
      *
      * Standard Midas PSSR processing.
      *
     C/COPY SDCPYSRC,SDPSSRINT
      *
      * End of PSSR user point.
      *
     C/COPY WNCPYSRC,SD0014VPS2
      *
      *================================================================
     CSR                   ENDSR
      *================================================================
     O/COPY WNCPYSRC,SD0014VOPG
** CPY@     : Copyright notice for inclusion in all programs
(c) Misys International Banking Systems Ltd. 2001
