     H        1   Y
      *****************************************************************
/*OVR *  OVRDBF FILE(GPACDXL0) TOFILE(GPACODXL0)                      *                       CGP001
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas SD Account codes report')                        *
     F*****************************************************************
     F*                                                               *
     F*  Midas - STANDING DATA MODULES                                *
     F*                                                               *
     F*   SD0030P - Account Codes Report                              *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
     F*                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      *  Prev Amend No. MD030956           Date 09Oct14               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 CRE015             Date 18Dec09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CDL013             Date 10Jul06               *
      *                 BUG10644           Date 21Feb06               *
      *                 CER001             Date 25Apr05               *
      *                 CPB004             Date 11Jul02               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL014             Date 20Oct03               *
      *                 TCA105             Date 01Apr04               *
      *                 CGP001             Date 02Mar04               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 132486             Date 27Jun01               *
      * Midas DBA 3.02 -----------------------------------------------*
      *                 CGL010             Date 08Nov99               *
      *                 CPB001             Date 18Oct99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CSD005             Date 04Mar99               *
      *                 CTI002             Date 27AUG98               *
     F*                 131458             Date 05Mar98               *
     F*                 128437             DATE 07Jan97               *
     F*                 CTI001             DATE 30SEP97               *
     F*                 CRE002             Date 03Feb97               *
     F*                 S01408             Date 15Sep95               *
     F*                 S01408             Date 07Sep95               *
     F*                 S01408             DATE 04AUG95               *
     F*                 080042             DATE 14DEC94               *
     F*                 S01408             DATE 19AUG94               *
     F*                 063606             DATE 03FEB94               *
     F*                 S01413             DATE 03FEB94               *
     F*                 E23836             DATE 26SEP91               *
     F*                 RT0070             DATE 23MAY91               *
     F*                 S01314             DATE 22APR91               *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  MD030956 - Additional changes to BFM-TI enhancement          *
      *  CRE015 - Retail Term and Notice Accounts                     *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CDL013 - Tiered Withholding Tax                              *
      *  BUG10644 - Usage of *IN66 is wrong                           *
      *  CER001 - LUX Upgrade to MidasPlus                            *
      *  CPB004 - Add 'To be transferred to TOF' flag for each        *
      *           account code.                                       *
      *  CLE025 - Credit Lines                                        *
      *  CGL014 - Collateral Processing                               *
     F*  TCA105 - No database error if record not on GPACODXPD        *
      *  CGP001 - Global Processing                                   *
      *  132486 - Enrol SD0030PM in RCF.                              *
      *  CGL010 - Future Value Dated Journal Entries for              *
      *           Non-Retail Accounts.                                *
     F*  CPB001 - 'Private Banking' Module                            *
     F*  CSD005 - Addition of Standing Data Account Narrative field   *
     F*           on condition of switchable feature CSD005 to        *
     F*           replace account name.                               *
     F*  CTI002 - ADDITION OF TRADE FINANCE EXPOSURE FIELDS           *
     F*  131458 - no override on QUSERMSG for ZA1310 CRE002           *
     F*  128437 - Correct message file not being selected             *
     F*  CTI001 - Midas / Trade Innovation Interface Phase 1          *
     F*  CRE002 - Retail Accruals Processing Enhancement.             *
     F*         - Print additional text against the DR & CR accrual   *
     F*           and capitalisation account fields.                  *
     F*  S01408 - Hook SD0030PEP2 added.                              *
     F*  S01408 - Hook SD0030PCP2 added.                              *
     F*           Hook SD0030PCP3 added.                              *
     F*           Hook SD0030PCP4 added.                              *
     F*  S01408 - Addition of hooks:                                  *
     F*           SD0030PEP1, SD0030PCP1                              *
     F*  080042 - PM Instrument Code not printed on report            *
     F*  S01408 - Addition of hooks:                                  *
     F*           SD0030PFPG, SD0030PIPG,SD0030PPDR,SD0030PCPG.       *
     F*  063606 - Addition of Withholding tax details.                *
     F*  S01413 - Retail 3 Incorporation.                             *
     F*  E23836 - Indicator 79 should be set on for Retail.           *
     F*  RT0070 - 'A' mode of report should only show account codes   *
     F*           changed today. Audit report should be printed.      *
     F*  S01314 - Changes made during PTF incorporation.              *
     F*           Addition of report title setup and R10 parameters   *
     F*                                                               *
     F*****************************************************************
     Z* CRTRPGPGM
      *
     H* SYNOPSIS :
     H* - Print report of file contents.
     H* Generated by  : Synon/2  Version:  8646
     H* Function type : Print file  Version:   0.1
      *
     H*  Company :
     H*  System  : Midas Standing Data
     H* User name  : F7387SY
     H* Date       : 14/03/91 time: 14:26:16
      *  (c) Finastra International Limited 2001                      *
     H*
      *================================================================
     M* Maintenance   :
      *================================================================
     F********************************************************************
     F*  P R O G R A M     C R E A T I O N     P A R A M E T E R S    *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     F/COPY WNCPYSRC,SD0030PFPG                                           S01408
     FSDACX2L0IF  E           K        DISK                           UC                      CER001
      *                                                                                       CER001
      ** RTV: Account Codes        ER - Extension file                                        CER001
      *                                                                                       CER001
     FSDACODL1IF  E           K        DISK
      * RTV: Account Codes             Retrieval index
      *
      *                                                                                       CDL013
     FSDACOAL1IF  E           K        DISK                                                   CDL013
      *                                                                                       CDL013
      * Retrieval: Tiered Withholding Tax Extension File                                      CDL013
      *                                                                                       CDL013
     FSDBANKL1IF  E           K        DISK
      * RTV: Bank Details              Retrieval index
      *
     F/COPY WNCPYSRC,SD0030PF01
     FSDFCTLL1IF  E           K        DISK                               RT0070
      * RTV: Standing Data Controls    Retrieval index                    RT0070
      *                                                                   RT0070
     FSDFCTLL0UF  E           K        DISK                               RT0070
      * UPD: Standing Data Controls    Update index                       RT0070
      *                                                                   RT0070
     F*D0030PMO*  E             97     PRINTER                            132486
     F**********                                    KINFDS INFDS$         132486
     FSD0030PMO   E             97     PRINTER      KINFDS SPOOL      UC  132486
      * PRT: Midas SD Mapped Account Codes Rpt.
      *
     FGPACDXL0IF  E           K        DISK                           UC                      CGP001
     F                                              KINFSR *PSSR                              CGP001
     F            GPACODXD0                         KRENAMEGPACDXD0                           CGP001
      *                                                                                       CGP001
      ** Midas GP Global Account Codes X-Reference                                            CGP001
      *                                                                                       CGP001
     FSDACD1L0IF  E           K        DISK                           UC                      CRE015
     F                                              KINFSR *PSSR                              CRE015
      *                                                                                       CRE015
      ** Midas SD Account Codes - T&N Accounts                                                CRE015
      *                                                                                       CRE015
     E* Description     : Copyright notice for inclusion in all programs
     E*
     E********************************************************************
     E*                                                                   S01408
     E/COPY WNCPYSRC,SD0030PEP1                                           S01408
     E*                                                                   S01408
     E                    CPY@    1   1 80               Copyright
     E**********          @CN     1   3 25               Long constants.  S01413
     E                    @CN     1   4 25               Long constants.  S01413
     E                    CMD     1   2 41                                131458
     E                    OVRC    1   1 80                                                    CGP001
      ** Override Command Array                                                               CGP001
      *                                                                                       CGP001
     E*                                                                   S01408
     E/COPY WNCPYSRC,SD0030PEP2                                           S01408
      *                                                                                       CER001
     E                    BLC         3132                                                    CER001
      *                                                                                       CER001
      ** IBLC 2002 Extended informations array                                                CER001
      *                                                                                       CER001
     E*                                                                   S01408
     I*                                                                   S01408
     I*00/Copy Member SD0030P   Initialise Program I-Spec                 S01408
     I/COPY WNCPYSRC,SD0030PIPG                                           S01408
      *                                                                                       CRE015
      ** Rename Account Code for SDACD1L0                                                     CRE015
      *                                                                                       CRE015
     ISDACD1D0                                                                                CRE015
     I              A5ACCD                          AXACCD                                    CRE015
      *                                                                                       CRE015
      *                                                                                       CER001
     IIBFROM      DS                                                                          CER001
      *                                                                                       CER001
      ** Extended informations from IBLC 2002 (1 Used)                                        CER001
      *                                                                                       CER001
     I                                        1 132 IBFRO1                                    CER001
     I                                      133 264 IBFRO2                                    CER001
     I                                      265 396 IBFRO3                                    CER001
      *                                                                   063606
     ISDBANK    E DSSDBANKPD                                              063606
     I*                                                                   063606
     I** Data Structure for Bank Details                                  063606
     I*                                                                   063606
     ISDCURR    E DSSDCURRPD                                              063606
     I*                                                                   063606
     I** Data Structure for Currency Details                              063606
     I*                                                                   063606
     ISCSARD    E DSSCSARDPD                                              CRE002
     I*                                                                   CRE002
     I** Data Structure for Switchable Features Details                   CRE002
     I*                                                                   CRE002
     IDSSDY     E DSDSSDY                                                 063606
     I*                                                                   063606
     I** Second DS for access progrmas, Long data structure               063606
     I*                                                                   063606
     I*
     I* Description     : Copyright notice for inclusion in all programs
     I*
      /EJECT
      * Data structures:-
     IPGMDS     ESDSY2PGDSP
      * Program data structure.
     IJBDTTM      DS
      * Job date/time.
     I                                        1   60##JDT
     I                                        1   20##JYY
     I                                        3   40##JMM
     I                                        5   60##JDD
     I                                        7  120##JTM
     I                                        7   80##JHH
     I                                        9  100##JNN
     I                                       11  120##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure.
      *
     ISPOOL       DS                                                      132486
     I                                       83  92 SFILE                 132486
     I                                    B 123 1240SFNUM                 132486
     I                                    B 367 3680LINE                  132486
     IRUNDAT      DS
     I                                        1   7 MRDT
     I                                    P   8  100RDNB
     I                                       11  11 SUC
     I                                       12  12 DFF
     I                                       13  13 MBIN
     IA@CPY       DS
     I* Copyright array
     I                                        1  80 CPY@
      /EJECT
      * Parameter declarations.
     IP1PARM      DS
      * I:    Audit/Request Status Ind                                    RT0070
     I                                        1   1 P1ARSI                RT0070
     I*                                                                   RT0070
     IP2PARM      DS                                                      RT0070
     I* I:    Sequence number                                             RT0070
     I                                        1   5 P2RSQN                RT0070
     I                                        1   5 SEQ                   132486
     I*                                                                   RT0070
     IP3PARM      DS                                                      RT0070
     I* I:    Entity                                                      RT0070
     I                                        1   3 P3ENTY                RT0070
     I*                                                                   RT0070
      **I:****Account*Codes*on*Old*File***                                RT0070
     I***********                         P   1   30P1ACOF                RT0070
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Database Error (ICD)'
      * Filename
     I                                        1  10 ZA0001
     ILDA         DS                            256                                           CGP001
      ** Local data area for database error details                                           CGP001
      *                                                                                       CGP001
     I                                      134 141 DBFILE                                    CGP001
     I                                      142 170 DBKEY                                     CGP001
     I                                      171 180 DBPGM                                     CGP001
     I                                      181 1830DBASE                                     CGP001
     I*                                                                   S01413
     I** Data structure for modules file                                  S01413
     ISDMMOD    E DSSDMMODPD                                              S01413
     I*                                                                   S01413
     I** Short Data Structure for Access Objects                          S01413
     IDSFDY     E DSDSFDY                                                 S01413
      *                                                                   S01314
     I/COPY WNCPYSRC,SD0030PI01
      ** Setup constant fields for report title                           S01314
      *                                                                   S01314
     I              '              ACCOUN-C         WUARTL                S01314
     I              'T CODES LISTING'                                     S01314
     I              '              -------C         WUUNDL                S01314
     I              '---------------'                                     S01314
      *                                                                                       CGP001
     I              'GOGETZONE'           C         GOPGM                                     CGP001
     I              'ERROR IN GOGETZONE'  C         GOMSG                                     CGP001
      ** Global Processing Constants                                                          CGP001
      *                                                                                       CGP001
      /EJECT
      *****************************************************************
     C           *ENTRY    PLIST                           Entry parameter
      *                                                                   RT0070
     C***********          PARM           @@PRM1  1        Dummy ParS01314RT0070
     C***********          PARM           P0RTN   7        Return code    RT0070
     C***********P1ACOF    PARM           WP0001  50       Account Codes oRT0070
     C***********          PARM           @@PRM2  1        Dummy ParS01314RT0070
     C***********          PARM           @@PRM3  3        Dummy ParS01314RT0070
      *                                                                   RT0070
     C                     PARM           P0RTN   7        Return code    RT0070
     C           P1ARSI    PARM           WP0001  1        Audit/Request  RT0070
     C           P2RSQN    PARM           WP0002  5        Sequence numberRT0070
     C                     PARM           @@PARM  1        Dummy Parm     RT0070
     C           P3ENTY    PARM           WP0003  3        Entity         RT0070
      *****************************************************************
      * Initialise
     C                     EXSR ZZINIT
      *
      * Clear overflow indicator.
     C                     SETOF                     97
      * Establish starting position.
     C           *LOVAL    SETLL@A5REA6                    *
      * Read first record.
     C                     READ @A5REA6                  90*
     C                     MOVEL*IN90     W0EOF   1
      * Print null report headings.
     C           W0EOF     IFEQ '1'
     C                     WRITEZZPAGHDR
     C                     WRITEZZENDRPT
     C                     ELSE
      * Request all headings.
     C                     MOVEL'Y'       L0      1        Page headings
      **Initialise*final*totals.***                                       RT0070
     C***********          Z-ADD*ZERO     ZTACOF           Account Codes  RT0070
     C***********          Z-ADD*ZERO     ZTACNF           Account Codes  RT0070
     C                     Z-ADD*ZERO     ZTNCRC  50       No of CalculateRT0070
      * Print report body.
     C           W0EOF     DOWEQ'0'
     C/COPY WNCPYSRC,SD0030PC05
      **Print*headings.*                                                  RT0070
     C***********          EXSR BAPRHD                                    RT0070
      *                                                                   063606
     C                     MOVE A5MISU    WMISU  16                       063606
     C                     CALL 'ZEDIT'                                   063606
     C           WMISU     PARM WMISU     WFLD16 16                       063606
     C                     PARM WDECS     WADEC   10                      063606
      *                                                                   063606
      *                                                                   063606
      * Print report detail line.
     C                     EXSR CAPRDT
      * Hold current values.
      * Read next record.
     C                     READ @A5REA6                  90*
     C                     MOVEL*IN90     W0EOF
     C/COPY WNCPYSRC,SD0030PC03
      * Determine level changes.
     C                     EXSR DALVCH
      * Print totals.
     C                     EXSR EAPRTT
      * Process necessary heading requests
     C                     EXSR FASGHD
     C                     END
     C                     WRITEZZENDRPT
     C                     END
      * Exit program.
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *****************************************************************
      /EJECT
     C***SR******   BAPRHD    BEGSR                                       RT0070
      ***********======================================================   RT0070
      **Print*report*Headers.*                                            RT0070
      ***********======================================================   RT0070
     C***********L0        IFEQ 'Y'                                       RT0070
     C***********          WRITEZZPAGHDR                                  RT0070
     C***********          END                                            RT0070
      ***********                                                         RT0070
      ***********======================================================   RT0070
     C***SR******   BAEXIT    ENDSR                                       RT0070
      /EJECT
     CSR         CAPRDT    BEGSR
      *================================================================
      * Print report detail line.
      *================================================================
      * Load detail line.
     C                     Z-ADDA5ACPR    XRACPR           Acct Post Reten
     C                     MOVELA5ACCD    XRACCD           Account Code
     C                     MOVELA5ACCN    XRACCN           Account Code Na
     C           *IN73     IFEQ *ON                                       CSD005
     C                     MOVELA5NARR    XRNARR           AccT Code Narr CSD005
     C                     ENDIF                                          CSD005
     C                     MOVELA5ACST    XRACST           Account Sub-typ
     C                     MOVELA5TOIN    XRTOIN           Title Only Indi
     C                     MOVELA5ACTY    XRACTY           Account type
     C                     MOVELA5ACSC    XRACSC           Account Section
     C                     MOVELA5CIAC    XRCIAC           Credit Int. Acc
     C                     MOVELA5CIAD    XRCIAD           Credit Int. Acc
     C                     MOVELA5DIAC    XRDIAC           Debt Interest A
     C                     MOVELA5DIAD    XRDIAD           Debt Interest A
     C                     MOVELA5ICIC    XRICIC           Interest Capita
     C                     MOVELA5ICID    XRICID           Interest Capita
      *                                                                   CPB004
      ** To be transferred to TOF                                         CPB004
      *                                                                   CPB004
     C********** *IN66     IFEQ *ON                                                  CPB004 BUG10644
     C           *IN67     IFEQ *ON                                                         BUG10644
     C                     MOVELA5TRAN    XRTRAN                          CPB004
     C                     ENDIF                                          CPB004
     C                     Z-ADDA5SRLC    XRSRLC           Stat Returns BS
     C                     Z-ADDA5SRFC    XRSRFC           Stat Returns BS
     C                     Z-ADDA5RPCD    XRRPCD           Reporting Code
     C                     Z-ADDA5LCD     XRLCD            Last Change Dat
     C                     MOVELA5TYLC    XRTYLC           Type of Last Ch
      *                                                                                       CGP001
      ** If CGP001 is enabled,                                                                CGP001
      ** retrieve Global Processing details                                                   CGP001
      *                                                                                       CGP001
     C           CGP001    IFEQ 'Y'                                                           CGP001
     C                     EXSR SRGPAC                                                        CGP001
     C                     ENDIF                                                              CGP001
      *                                                                                       CGP001
     C* If Midas/TI Interface is on then load TI Accout Type field        CTI001
     C*                                                                   CTI001
     C           *IN77     IFEQ *ON                                       CTI001
     C                     MOVELA5TIAT    XRTIAT           TI Account TypeCTI001
     C                     MOVELA5TFCT    XRTFCT           TF EXPOSURE A/CCTI002
     C                     ENDIF                                          CTI001
      *                                                                   CGL010
      ** Transitory Account Codes                                         CGL010
      *                                                                   CGL010
     C                     MOVEL*BLANKS   XRTRDA                          CGL010
     C                     MOVEL*BLANKS   XRTRCA                          CGL010
     C           A5TRDA    IFGT *ZERO                                     CGL010
     C                     MOVELA5TRDA    XRTRDA                          CGL010
     C                     ENDIF                                          CGL010
     C           A5TRCA    IFGT *ZERO                                     CGL010
     C                     MOVELA5TRCA    XRTRCA                          CGL010
     C                     ENDIF                                          CGL010
     C*                                                                   CTI001
     C*                                                                   S01408
     C/COPY WNCPYSRC,SD0030PCP2                                           S01408
     C*                                                                   S01408
     C           ULX043    IFEQ 'Y'                                                           CER001
     C                     MOVE A5ACCD    NNACCD                                              CER001
     C           NNACCD    CHAINSDACX2L0             88                                       CER001
     C           *IN88     IFEQ '0'                                                           CER001
     C                     Z-ADDSDIM93    XRIM93                                              CER001
     C                     Z-ADDSDSHAT    XRSHAT                                              CER001
     C                     ELSE                                                               CER001
     C                     Z-ADD0         XRIM93                                              CER001
     C                     Z-ADD0         XRSHAT                                              CER001
     C                     ENDIF                                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
      *                                                                                       CDL013
      ** If CDL013 present then set up printer fields for Retail and                          CDL013
      ** Corporate W/H Tax Account Codes                                                      CDL013
      *                                                                                       CDL013
     C           CDL013    IFEQ '1'                                                           CDL013
     C                     MOVE *ON       *IN80                                               CDL013
     C           A5ACCD    CHAINSDACOAL1             92                                       CDL013
     C           *IN92     IFEQ *ON                                                           CDL013
     C                     MOVE *BLANK    XRWTRC                                              CDL013
     C                     MOVE *BLANK    XRWTCC                                              CDL013
     C                     ELSE                                                               CDL013
     C                     MOVE EACRE     XRWTRC                                              CDL013
     C                     MOVE EACCO     XRWTCC                                              CDL013
     C                     ENDIF                                                              CDL013
     C                     ENDIF                                                              CDL013
      *                                                                                       CDL013
      *                                                                                       CRE015
      ** If CRE015 is ON, set up printer fields for Account Codes Audit Report                CRE015
      *                                                                                       CRE015
     C           CRE015    IFEQ 'Y'                                                           CRE015
     C                     SETON                     81                                       CRE015
     C                     MOVELA5ACCD    PCACCD                                              CRE015
     C           KRTVAC    KLIST                                                              CRE015
     C                     KFLD           PCACCD 10                                           CRE015
     C           KRTVAC    CHAINSDACD1D0             92                                       CRE015
     C           *IN92     IFEQ *OFF                                                          CRE015
     C                     MOVE A5CHIA    AXCHIA                                              CRE015
     C           *IN80     IFEQ *OFF                                                          CRE015
     C                     MOVE A5RTDN    AXRTDN                                              CRE015
     C                     MOVE A5RTDI    AXRTDI                                              CRE015
     C                     ELSE                                                               CRE015
     C                     MOVE A5RTDN    AYRTDN                                              CRE015
     C                     MOVE A5RTDI    AYRTDI                                              CRE015
     C                     ENDIF                                                              CRE015
     C                     ELSE                                                               CRE015
     C                     MOVE 'O'       A5ATTY                                              CRE015
     C                     MOVE *BLANKS   AXCHIA                                              CRE015
     C                     MOVE *BLANKS   A5RTTY                                              CRE015
     C                     MOVE *BLANKS   A5NVCD                                              CRE015
     C                     MOVE *BLANKS   A5PRFC                                              CRE015
     C           *IN80     IFEQ *OFF                                                          CRE015
     C                     MOVE *BLANKS   AXRTDN                                              CRE015
     C                     MOVE *BLANKS   AXRTDI                                              CRE015
     C                     ELSE                                                               CRE015
     C                     MOVE *BLANKS   AYRTDN                                              CRE015
     C                     MOVE *BLANKS   AYRTDI                                              CRE015
     C                     ENDIF                                                              CRE015
     C                     ENDIF                                                              CRE015
     C                     ENDIF                                                              CRE015
      *                                                                                       CRE015
     C                     MOVE A5DIPD    XRDIPD                          S01413
     C                     MOVE A5DIPC    XRDIPC                          S01413
     C                     MOVE A5CIPC    XRCIPC                          S01413
     C                     MOVE A5CISU    XRCISU                          S01413
     C                     MOVE A5CINS    XRCINS                          S01413
     C                     MOVE A5WTAC    XRWTAC                          S01413
     C                     MOVE WMISU     XRMISU                          063606
     C*                                                                   S01408
     C/COPY WNCPYSRC,SD0030PCP3                                           S01408
     C*                                                                   S01408
      *                                                                                       CER001
      ** Read IBLC 2002 Ext Details                                                           CER001
      *                                                                                       CER001
     C           ULX043    IFEQ 'Y'                                                           CER001
     C                     CALL 'IL0452'                                                      CER001
     C                     PARM A5ACCD    PACOD  10                                           CER001
     C                     PARM *BLANKS   IBFROM                                              CER001
      *                                                                                       CER001
     C                     MOVEAIBFROM    BLC                                                 CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C           BGPFMG    IFEQ 'Y'                                       080042
     C           BGLMCR    OREQ 'Y'                                       080042
     C           BGN4ST    OREQ 'Y'                                       CPB001
     C           CGL014    OREQ 'Y'                                                           CGL014
     C           CLE025    OREQ 'Y'                                                           CLE025
     C                     MOVELA5INNR    XRINNR                          080042
     C                     MOVE '1'       *IN40                           080042
     C                     END                                            080042
     C                     MOVEL'Y'       W0PFM
      * USER: Process detail record
     C***********          ADD  1         ZTACNF           Account Codes  RT0070
      *                                                                   RT0070
     C                     MOVELP1ARSI    WUARSI           Audit/Request  RT0070
      * Process Detail Rec PRTFIL                                         RT0070
     C                     ADD  1         WUWKNB           work number    RT0070
      *CASE:     PAR.Audit/Request Status Ind is Audit Mode               RT0070
     C           WUARSI    IFEQ 'A'                        *IF            RT0070
      *CASE:     PAR.Last Change Date NE WRK.run day number               RT0070
     C           XRLCD     IFNE WURDNB                     *IF            RT0070
     C                     MOVEL'N'       W0PFM            *Print format  RT0070
     C                     END                             *FI            RT0070
     C                     END                             *FI            RT0070
      *CASE:     PGM.*Print format is Print format                        RT0070
     C           W0PFM     IFEQ 'Y'                        *IF            RT0070
     C                     ADD  1         ZTNCRC           No of CalculateRT0070
     C                     END                             *FI            RT0070
      * Check File Date - Rundate  *                                      RT0070
     C                     CALL 'ZDATE2'               90  Check File DateRT0070
     C                     PARM XRLCD     WQ0005  50       Work Midas DateRT0070
     C                     PARM WUDFF     WQ0006  1        date format flaRT0070
     C           WUWCDT    PARM *ZERO     WQ0007  60       Work Converted RT0070
     C           XRACDT    PARM *BLANK    WQ0008  7        Work Alpha DateRT0070
      *                                                                   RT0070
     C           *IN90     IFEQ '1'                                       RT0070
      * Call to program ended in error.                                   RT0070
     C                     MOVEL'Y2U0021' W0RTN   7                       RT0070
     C                     END                                            RT0070
      *                                                                   RT0070
      * PAR.alpha of last change = Condition name of PAR.Type of Last ChanRT0070
     C                     CALL 'Y2RVCNR'              90  *              RT0070
     C                     PARM           W0RTN   7        Return code    RT0070
     C                     PARM 1100584   Y2LSNO  70       List number    RT0070
     C                     PARM XRTYLC    W0INVL 20        Type of Last ChRT0070
     C                     PARM ' '       W0VLMP  1        Value mapped?  RT0070
     C           XRALCH    PARM           W0CNNM 25        alpha of last cRT0070
      *                                                                   RT0070
      * 00/Copy Member SD0030PPDR -                                       S01408
     C/COPY WNCPYSRC,SD0030PPDR                                           S01408
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form.
      *                                                                   RT0070
      * Print column headings if required.                                RT0070
      *                                                                   RT0070
     C                     WRITEZZPAGHDR                                  RT0070
      * Print detail line.
     C           XRACTY    IFEQ 'R'                                       E23836
     C                     SETON                     79                   E23836
     C                     END                                            E23836
     C/COPY WNCPYSRC,SD0030PC01
      *
      *** If switchable feature is active then write alternative detail   CSD005
      *** in printer file with account narrative field                    CSD005
      *                                                                   CSD005
     C                     WRITEZZDTLRCD
     C*                                                                   S01408
     C/COPY WNCPYSRC,SD0030PCP4                                           S01408
     C*                                                                   S01408
      *                                                                                       CER001
      ** Output IBLC 2002 Detail if Found                                                     CER001
      *                                                                                       CER001
     C           ULX043    IFEQ 'Y'                                                           CER001
     C                     MOVEL*BLANKS   RRFROM                                              CER001
     C                     WRITEZZIBLC02                                                      CER001
      *                                                                                       CER001
      ** Currently only 1 lines used                                                          CER001
      *                                                                                       CER001
     C                     DO   3         BL      10                                          CER001
     C           BLC,BL    IFNE *BLANKS                                                       CER001
     C                     MOVELBLC,BL    RRFROM                                              CER001
      *                                                                                       CER001
      ** If there is not enough space on the                                                  CER001
      ** physical page for this format:-                                                      CER001
      *                                                                                       CER001
     C           *IN97     IFEQ *ON                                                           CER001
     C                     WRITEZZPAGHDR                                                      CER001
     C                     MOVE *OFF      *IN97                                               CER001
     C                     MOVEL*BLANKS   RRFROM                                              CER001
     C                     WRITEZZIBLC02                                                      CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C                     MOVELBLC,BL    RRFROM                                              CER001
     C                     WRITEZZIBLC02                                                      CER001
     C                     ENDIF                                                              CER001
     C                     ENDDO                           3 lines                            CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C                     SETOF                     79                   E23836
     C                     END
     C*                                                                   S01408
     C/COPY WNCPYSRC,SD0030PCP1                                           S01408
     C*                                                                   S01408
      *================================================================
     CSR         CAEXIT    ENDSR
      *****************************************************************                       CGP001
      /EJECT                                                                                  CGP001
      *****************************************************************                       CGP001
      *                                                               *                       CGP001
      *  SRGPGZ - Gets the Zone via GOGETZONE.                        *                       CGP001
      *                                                               *                       CGP001
      *****************************************************************                       CGP001
     C           SRGPGZ    BEGSR                                                              CGP001
      *                                                                                       CGP001
     C                     CALL GOPGM                                                         CGP001
     C                     PARM *BLANKS   PZRTCD  7                                           CGP001
     C                     PARM *BLANKS   PZERMS 50                                           CGP001
     C                     PARM 'N'       PZFCHK  1                                           CGP001
     C                     PARM *BLANKS   PZZONE 10                                           CGP001
     C                     PARM *BLANKS   PZSHTC  4                                           CGP001
     C                     PARM *ZERO     PZRDNB  50                                          CGP001
     C                     PARM *ZERO     PZDNWD  50                                          CGP001
     C                     PARM *BLANKS   PZBCCY  3                                           CGP001
     C                     PARM *ZERO     PZNJOB  10                                          CGP001
      *                                                                                       CGP001
     C           PZRTCD    IFEQ *BLANKS                                                       CGP001
     C                     MOVE PZZONE    WZONE  10                                           CGP001
     C                     ELSE                                                               CGP001
      *                                                                                       CGP001
     C           PZRTCD    IFEQ '*ERROR'                                                      CGP001
     C                     MOVELGOMSG     PZERMS                                              CGP001
     C                     MOVE *ON       *INU7                                               CGP001
     C                     MOVE *ON       *INU8                                               CGP001
     C                     MOVE *ON       *INLR                                               CGP001
     C                     EXSR *PSSR                                                         CGP001
     C                     ENDIF                                                              CGP001
      *                                                                                       CGP001
     C                     ENDIF                                                              CGP001
      *                                                                                       CGP001
     C                     ENDSR                                                              CGP001
      *****************************************************************                       CGP001
      /EJECT                                                                                  CGP001
      *****************************************************************                       CGP001
      *                                                               *                       CGP001
      *  SRGPAC - Gets the Global Account Codes.                      *                       CGP001
      *                                                               *                       CGP001
      *****************************************************************                       CGP001
     C           SRGPAC    BEGSR                                                              CGP001
      *                                                                                       CGP001
     C                     MOVE WZONE     KZONE                                               CGP001
     C                     MOVE A5ACCD    KACOD                                               CGP001
      *                                                                                       CGP001
     C           KGPXR     CHAINGPACDXL0            N46                                       CGP001
      *                                                                                       CGP001
     C           *IN46     IFEQ *OFF                                                          CGP001
     C                     MOVE ACGACD    XGACD                                               CGP001
     C                     MOVE ACGPRD    XPRDC                                               CGP001
     C                     MOVE ACGINS    XINSC                                               CGP001
     C                     ELSE                                                               CGP001
     C                     MOVE *BLANK    XGACD                                               TCA105
     C                     MOVE *BLANK    XPRDC                                               TCA105
     C                     MOVE *BLANK    XINSC                                               TCA105
     C************LOCK*****IN   LDA                                                    CGP001 TCA105
     C*********************MOVEL'GPACOD'  DBFILE                                       CGP001 TCA105
     C*********************CAT  'XPD':0   DBFILE                                       CGP001 TCA105
     C*********************MOVELKZONE     DBKEY                                        CGP001 TCA105
     C*********************CAT  KACOD:0   DBKEY                                        CGP001 TCA105
     C*********************MOVEL'03'      DBASE                                        CGP001 TCA105
     C*********************OUT  LDA                                                    CGP001 TCA105
     C*********************MOVE *ON       *INU7                                        CGP001 TCA105
     C*********************MOVE *ON       *INU8                                        CGP001 TCA105
     C*********************MOVE *ON       *INLR                                        CGP001 TCA105
     C*********************EXSR *PSSR                                                  CGP001 TCA105
     C                     ENDIF                                                              CGP001
      *                                                                                       CGP001
     C                     ENDSR                                                              CGP001
      *****************************************************************                       CGP001
      /EJECT                                                                                  CGP001
      *****************************************************************                       CGP001
      *                                                               *                       CGP001
      *  SRGPOF - Opens the Global Processing Cross-Reference Files.  *                       CGP001
      *                                                               *                       CGP001
      *****************************************************************                       CGP001
     C           SRGPOF    BEGSR                                                              CGP001
      *                                                                                       CGP001
     C                     Z-ADD80        PLEN   155                                          CGP001
      *                                                                                       CGP001
     C                     MOVE OVRC,1    PCMD   80                                           CGP001
      *                                                                                       CGP001
     C                     CALL 'QCMDEXC'                                                     CGP001
     C                     PARM           PCMD                                                CGP001
     C                     PARM           PLEN                                                CGP001
      *                                                                                       CGP001
     C                     OPEN GPACDXL0                                                      CGP001
      *                                                                                       CGP001
     C                     ENDSR                                                              CGP001
      *****************************************************************                       CGP001
      /EJECT
     CSR         DALVCH    BEGSR
      *================================================================
      * Detect level changes.
      *================================================================
      * Clear all level breaks.
     C                     MOVEL*BLANK    L0               Page headings
      * Clear heading length to print.
     C                     Z-ADD*ZERO     @$HDL
      *
      * End of file - Signal all level breaks.
     C           W0EOF     IFEQ '1'
     C                     ELSE
     C                     END
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         EAPRTT    BEGSR
      *================================================================
      * Print report Totals.
      *================================================================
      * Print level break totals as required
      * End of file - Print final totals.
     C           W0EOF     IFEQ '1'
     C                     MOVEL'Y'       W0PFM
      * USER: Process End of Report
      *CASE:     CUR.No of Calculated Recs is Compare to Zero             RT0070
     C           ZTNCRC    IFEQ *ZERO                      *IF            RT0070
     C                     MOVEL'0'       WUALZR           Alpha Zero     RT0070
     C                     END                             *FI            RT0070
      *CASE:     PAR.Audit/Request Status Ind is Audit Mode               RT0070
     C           P1ARSI    IFEQ 'A'                        *IF            RT0070
      * Audit/On-Req RTV on FCTL - Standing Data Controls  *              RT0070
     C                     EXSR SARVG2                                    RT0070
      *CASE:     WRK.work number NE WRK.No of Records on file             RT0070
     C           WUWKNB    IFNE WUNORF                     *IF            RT0070
     C                     MOVEL'N'       WUWFLG           work flag      RT0070
     C                     END                             *FI            RT0070
      * Audit printfile override - Standing Data Controls  *              RT0070
     C                     CALL 'SDC540P'              90  Audit printfileRT0070
     C                     PARM 'SD0030AU'WQ0009 10        *PROGRAM       RT0070
     C                     PARM WUWFLG    WQ0010  1        work flag      RT0070
     C                     PARM WUNOIN    WQ0011  50       No of Records IRT0070
     C                     PARM WUNOAM    WQ0012  50       No of Records ART0070
     C                     PARM WUNODL    WQ0013  50       No of records DRT0070
     C                     PARM WUWKNB    WQ0014  50       work number    RT0070
     C                     PARM WUNORF    WQ0015  50       No of Records oRT0070
     C                     PARM WUARTL    WQ0016 53        Audit/Request TRT0070
     C                     PARM WUUNDL    WQ0017 53        Underline      RT0070
      *                                                                   RT0070
     C           *IN90     IFEQ '1'                                       RT0070
      * Call to program ended in error.                                   RT0070
     C                     MOVEL'Y2U0021' W0RTN   7                       RT0070
     C                     END                                            RT0070
      *                                                                   RT0070
      *CASE:     PGM.*Return code is *Record does not exist               RT0070
     C           W0RTN     IFEQ 'Y2U0005'                  *IF            RT0070
      * Database Error U7 U8 - Standing Data Controls  *                  RT0070
     C*                                                                   RT0070
     C** DATABASE ERROR, SET ON SWITHES U7 AND U8                         RT0070
     C*                                                                   RT0070
     C                     SETON                     U7U8                 RT0070
     C*                                                                   RT0070
     C                     ELSE                                           RT0070
      *CASE:     WRK.work flag is Incorrect                               RT0070
     C           WUWFLG    IFEQ 'N'                        *IF            RT0070
      * File Control Error U8 - Standing Data Controls  *                 RT0070
     C*                                                                   RT0070
     C** FILE CONTROLS OUT OF BALANCE SETON U8                            RT0070
     C*                                                                   RT0070
     C                     SETON                         U8               RT0070
     C*                                                                   RT0070
     C                     ELSE                                           RT0070
      *CASE:     PGM.*Return code is *Field attribute types EX            RT0070
     C           W0RTN     IFEQ 'Y2U0021'                  *IF            RT0070
     C                     ELSE                                           RT0070
      *CASE:     *OTHERWISE                                               RT0070
      * Change Standing Data Cont - Standing Data Controls  *             RT0070
     C                     EXSR SBCHRC                                    RT0070
     C                     END                             *FI            RT0070
     C                     END                             *FI            RT0070
     C                     END                             *FI            RT0070
     C                     END                             *FI            RT0070
      *                                                                   RT0070
     C***********          Z-ADDP1ACOF    ZTACOF           Account Codes oRT0070
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:-
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 4
      * Signal artificial overflow.
     C                     SETON                     97
      * Print page headers.
     C                     WRITEZZPAGHDR
     C                     END
      *                                                                   RT0070
      * Print format.
     C           ZTNCRC    IFEQ 0                                         RT0070
     C                     MOVE '1'       *IN75                           RT0070
     C                     END                                            RT0070
     C                     WRITEZZFINTTL
     C                     END
     C                     END
      *
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         FASGHD    BEGSR
      *================================================================
      * Signal required header formats.
      *================================================================
      * Cascade skip to new page requests upwards.
      * Request page headings.
     C                     MOVEL'Y'       L0
      *
     C           *IN97     IFNE '1'
     C           L0        ANDNE'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line.
     C           W0OFL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE @$HDL
     C                     SETON                     97
     C                     ELSE
      * Signal overflow if requested headings would cause
      * detail format to be printed past end of page
     C                     ADD  12        @$HDL
     C           W0PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE @$HDL
     C                     SETON                     97
     C                     END
     C                     END
     C                     END
      * Overflow detected.
     C           *IN97     IFEQ '1'
      * Request page headings.
     C                     MOVEL'Y'       L0
      * Request all formats which print on overflow.
     C                     SETOF                     97
     C                     END
      *================================================================
     CSR         FAEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Get Bank Title - Bank Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define Keylist.
     C           KRSSA     KLIST
     C                     KFLD           BJBANK           Bank
      * Move fields to key list.
     C                     MOVEL@CN,01    BJBANK           Bank
     C           KRSSA     CHAIN@BJREEF              90    *
     C           *IN90     IFEQ '1'
      * DBF Record not found.
     C                     MOVEL'USR0197' W0RTN   7
      * USER: Processing if DBF record not found
     C                     MOVEL@CN,02    W0RTN            *Return code
      * Setup message data for message.
     C                     MOVEL@CN,03    ZA0001           Filename
      * Send message 'Database Error (ICD)'
     C                     MOVEL'USR0377' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     99    *
      *
     C                     GOTO SAEXIT                     *QUIT
     C                     GOTO SAEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process DBF record
      * PAR = DB1 By name
     C                     MOVELBJURPT    WUURPT           User Report Tit
     C                     END
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SARVG2    BEGSR                                          RT0070
      *================================================================   RT0070
      * Audit/On-Req RTV on FCTL - Standing Data Controls  *              RT0070
      *================================================================   RT0070
     C                     MOVEL*BLANK    W0RTN   7                       RT0070
      * Define Keylist.                                                   RT0070
     C           KRSA2     KLIST                                          RT0070
     C                     KFLD           AHFLNM           Filename       RT0070
      * Move fields to key list.                                          RT0070
     C                     MOVEL'SDACODPD'AHFLNM           Filename       RT0070
     C           KRSA2     CHAIN@AHREAV              90    *              RT0070
     C           *IN90     IFEQ '1'                                       RT0070
      * DBF Record not found.                                             RT0070
     C                     MOVEL'USR0020' W0RTN   7                       RT0070
      * USER: Processing if DBF record not found                          RT0070
     C                     MOVEL'Y2U0005' W0RTN            *Return code   RT0070
     C                     GOTO SA2EXT                                    RT0070
     C                     END                                            RT0070
      *                                                                   RT0070
     C           *IN90     IFEQ '0'                                       RT0070
      * USER: Process DBF record                                          RT0070
      * PAR = DB1 By name                                                 RT0070
     C                     Z-ADDAHNORC    WUNORF           No. of Records RT0070
     C                     Z-ADDAHNOIN    WUNOIN           No. of Inserts RT0070
     C                     Z-ADDAHNOAM    WUNOAM           No. of Amends  RT0070
     C                     Z-ADDAHNODL    WUNODL           No. of Deletes RT0070
     C                     END                                            RT0070
      *================================================================   RT0070
     CSR         SA2EXT    ENDSR                                          RT0070
      /EJECT                                                              RT0070
     CSR         SBCHRC    BEGSR                                          RT0070
      *================================================================   RT0070
      * Change Standing Data Cont - Standing Data Controls  *             RT0070
      *================================================================   RT0070
     C                     MOVEL*BLANK    W0RTN   7                       RT0070
      * Move key fields to @AHREAU                                        RT0070
     C                     MOVEL'SDACODPD'AHFLNM           Filename       RT0070
      *                                                                   RT0070
     C           KLCHSB    KLIST                                          RT0070
     C                     KFLD           AHFLNM           Filename       RT0070
     C           KLCHSB    CHAIN@AHREAU              9091  *              RT0070
      *                                                                   RT0070
     C           *IN90     IFEQ '1'                                       RT0070
      * Record not found.                                                 RT0070
     C                     MOVEL'Y2U0009' W0RTN   7                       RT0070
      * Send message '*Record no longer on file'                          RT0070
     C                     MOVEL'Y2U0009' ZAMSID           Message id.    RT0070
     C                     MOVEL'Y2USRMSG'ZAMSGF           Message file.  RT0070
     C                     EXSR ZASNMS                     Send message   RT0070
     C                     GOTO SBEXIT                                    RT0070
     C                     END                                            RT0070
      *                                                                   RT0070
     C           *IN91     IFEQ '1'                                       RT0070
      * Record locked.                                                    RT0070
     C                     MOVEL'Y2U0004' W0RTN   7                       RT0070
     C                     GOTO SBEXIT                                    RT0070
     C                     END                                            RT0070
      *                                                                   RT0070
      * USER: Processing after DBF read                                   RT0070
     C                     ADD  AHNORC    WUNORC           No. of Records RT0070
     C                     ADD  AHNOIN    WUNOIN           No. of Inserts RT0070
     C                     ADD  AHNOAM    WUNOAM           No. of Amends  RT0070
     C                     ADD  AHNODL    WUNODL           No. of Deletes RT0070
      * Move Non-key fields to @AHREAU                                    RT0070
     C                     Z-ADDWUNORC    AHNORC           No. of Records RT0070
     C                     Z-ADD*ZERO     AHNOIN           No. of Inserts RT0070
     C                     Z-ADD*ZERO     AHNOAM           No. of Amends  RT0070
     C                     Z-ADD*ZERO     AHNODL           No. of Deletes RT0070
      *                                                                   RT0070
     C                     UPDAT@AHREAU                91  *              RT0070
     C           *IN91     IFEQ '1'                                       RT0070
      * Change error detected.                                            RT0070
     C                     MOVEL'Y2U0004' W0RTN   7                       RT0070
     C                     ELSE                                           RT0070
      * DBF Change successful.                                            RT0070
     C                     END                                            RT0070
      *================================================================   RT0070
     CSR         SBEXIT    ENDSR                                          RT0070
      /EJECT                                                              RT0070
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue.
      *================================================================
     C           ZAPGM     IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGM
     C                     END
      * If no message file specified use default.
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGM  10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message Id.
     C                     PARM           ZAMSGF 10        Message file.
     C                     PARM           ZAMSDA132        Message data.
     C                     PARM           ZAMSTP  7        Message type.
      * Clear all fields for default mechanism next time.
     C                     MOVEL*BLANK    ZAPGM            Program queue
     C                     MOVEL*BLANK    ZAPGRL           Rel queue
     C                     MOVEL*BLANK    ZAMSID           Message Id.
     C                     MOVEL*BLANK    ZAMSGF           Message file.
     C                     MOVEL*BLANK    ZAMSDA           Message data.
     C                     MOVEL*BLANK    ZAMSTP           Message type.
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     Z-ADD15        MSGLEN                       131458
     C                     MOVELCMD,2     CMD1                         131458
     C                     CALL 'QCMDEXC'                              131458
     C                     PARM           CMD1                         131458
     C                     PARM           MSGLEN                       131458
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct.
      *================================================================
      *                                                                                       CGP001
     C           CGP001    IFEQ 'Y'                                                           CGP001
     C                     CLOSEGPACDXL0                                                      CGP001
     C                     ENDIF                                                              CGP001
      *                                                                                       CER001
     C           ULX043    IFEQ 'Y'                                                           CER001
     C                     CLOSESDACX2L0                                                      CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CRE015
     C           CRE015    IFEQ 'Y'                                                           CRE015
     C                     CLOSESDACD1L0                                                      CRE015
     C                     ENDIF                                                              CRE015
      * Terminate program.
     C                     SETON                     LR
      *
      * Exit program.
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation.
      *================================================================
      *                                                                                       CGP001
      ** Global Processing X-Reference Key Defn                                               CGP001
      *                                                                                       CGP001
     C           *LIKE     DEFN WZONE     KZONE                                               CGP001
     C           *LIKE     DEFN A5ACCD    KACOD                                               CGP001
     C           *LIKE     DEFN SDACOD    NNACCD                                              CER001
      *                                                                                       CGP001
      ** Global Processing X-Reference Key List                                               CGP001
      *                                                                                       CGP001
     C           KGPXR     KLIST                                                              CGP001
     C                     KFLD           KZONE                                               CGP001
     C                     KFLD           KACOD                                               CGP001
      *                                                                                       CGP001
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
      * Setup job date/time.
     C                     Z-ADDUDATE     ##JDT            Job date.
     C                     TIME           ##JTM            Job time.
     C                     TIME           ##TME   60       Screen time.
      * Define work field Midas Run Date
     C                     MOVEL*BLANK    WUMRDT  7
      * Define work field Run day number
     C                     Z-ADD*ZERO     WURDNB  50
      * Define work field Set Up Complete
     C                     MOVEL*BLANK    WUSUC   1
      * Define work field Date format flag
     C                     MOVEL*BLANK    WUDFF   1
      * Define work field Multi-branching Indicator
     C                     MOVEL*BLANK    WUMBIN  1
      * Define work field User Report Title
     C                     MOVEL*BLANK    WUURPT 53
      * Define work field Audit/Request Status Ind                        RT0070
     C                     MOVEL*BLANK    WUARSI  1                       RT0070
      * Define work field work number                                     RT0070
     C                     Z-ADD*ZERO     WUWKNB  50                      RT0070
      * Define work field Work Converted Date                             RT0070
     C                     Z-ADD*ZERO     WUWCDT  60                      RT0070
      * Define work field Alpha Zero                                      RT0070
     C                     MOVEL*BLANK    WUALZR  1                       RT0070
      * Define work field No of Records on file                           RT0070
     C                     Z-ADD*ZERO     WUNORF  50                      RT0070
      * Define work field No. of Inserts                                  RT0070
     C                     Z-ADD*ZERO     WUNOIN  50                      RT0070
      * Define work field No. of Amends                                   RT0070
     C                     Z-ADD*ZERO     WUNOAM  50                      RT0070
      * Define work field No. of Deletes                                  RT0070
     C                     Z-ADD*ZERO     WUNODL  50                      RT0070
      * Define work field work flag                                       RT0070
     C                     MOVEL*BLANK    WUWFLG  1                       RT0070
      * Define work field No. of Records                                  RT0070
     C                     Z-ADD*ZERO     WUNORC  50                      RT0070
      * Obtain default message file.
     C           *NAMVAR   DEFN Y2MGFLA   ZADFMF 10
     C                     IN   ZADFMF
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
      * Adjust page length and overflow as necessary.
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * USER: Initialise program
      * Standard RPG Creation PAR - Standard Functions  *
      * Get Rundate - Rundate  *
     C           *NAMVAR   DEFN           RUNDAT
     C                     IN   RUNDAT
     C                     MOVE MRDT      ##MRDT           RUN DATE
     C                     MOVE MRDT      WUMRDT
     C                     MOVE RDNB      WURDNB           RUNDAY NO.
     C                     MOVE SUC       WUSUC            SET UP COMPLT
     C                     MOVE DFF       WUDFF            DTE FMT FLAG
     C                     MOVE MBIN      WUMBIN           MULTI BR. IND
      * Copyright Statement - Standard Functions  * copyright
      * Get Title
      * Get Bank Title - Bank Details  *
     C                     EXSR SARVGN
      * Move title to header - *Standard header/footer  *
     C* 7.10.89 Missing Source - Inserted During Incorporation            S01216
     C* Move User Report Title into Header Field in DDS for PRTF          S01216
     C*                                                                   S01216
     C*********************MOVE #IURPT    ##AGNA                   S01216 S01229
     C                     MOVE WUURPT    ##URPT                   S01216 S01229
     C                     MOVELWUARTL    ##ARTL                          S01314
     C                     MOVELWUUNDL    ##UNDL                          S01314
      *                                                                                       CDL013
      ***   Check if CAR CDL013 is installed                                                  CDL013
      *                                                                                       CDL013
     C                     CALL 'AOSARDR0'             85                                     CDL013
     C                     PARM *BLANK    WQ0063  7                                           CDL013
     C                     PARM '*VERIFY' WQ0064  7                                           CDL013
     C                     PARM 'CDL013'  WQ0065  6                                           CDL013
     C                     PARM *BLANK    WQ0066 76                                           CDL013
      *                                                                                       CDL013
      ** If program fails send error message                                                  CDL013
      *                                                                                       CDL013
     C           *IN85     IFEQ *ON                                                           CDL013
     C                     MOVEL'Y2U0032' ZAMSID                                              CDL013
     C                     MOVEL'Y2USRMSG'ZAMSGF                                              CDL013
     C                     EXSR ZASNMS                                                        CDL013
      *                                                                                       CDL013
     C                     ELSE                                                               CDL013
      *                                                                                       CDL013
      ** CAR CDL013 is not installed set off flag                                             CDL013
      *                                                                                       CDL013
     C           WQ0063    IFEQ '*NRF'                                                        CDL013
     C                     MOVE '0'       CDL013  1                                           CDL013
      *                                                                                       CDL013
      ** CAR CDL013 is installed set on flag.                                                 CDL013
      *                                                                                       CDL013
     C                     ELSE                                                               CDL013
     C                     MOVE '1'       CDL013                                              CDL013
     C                     END                                                                CDL013
     C                     END                                                                CDL013
     C*                                                                   S01408
     C*00/Copy Member SD0030P   Initialise Program I-Spec                 S01408
     C/COPY WNCPYSRC,SD0030PCPG                                           S01408
      *                                                                   S01408
      *                                                                   S01413
      ** Set ind for Retail 3 fields.                                     S01413
     C                     CALL 'AOMMODR0'                                S01413
     C                     PARM '*MSG'    @RTCD   7                       S01413
     C                     PARM '*FIRST ' @OPTN   7                       S01413
     C           SDMMOD    PARM SDMMOD    DSFDY                           S01413
      *                                                                   S01413
     C           @RTCD     IFNE *BLANKS                                   S01413
     C                     MOVEL'USR0197' W0RTN   7                       S01413
     C                     MOVEL@CN,02    W0RTN            *Return code   S01413
     C                     MOVEL@CN,04    ZA0001           Filename       S01413
     C                     MOVEL'USR0377' ZAMSID           Message id.    S01413
     C                     EXSR ZASNMS                     Send message   S01413
     C                     GOTO ZZEXIT                                    S01413
     C                     END                                            S01413
      *                                                                   S01413
     C           BGNXST    IFEQ 'Y'                                       S01413
     C           BGNTST    ANDEQ'Y'                                       S01413
     C                     MOVE *ON       *IN74                           S01413
     C                     ELSE                                           S01413
     C                     MOVE *OFF      *IN74                           S01413
     C                     END                                            S01413
      *
      * If Midas/TI Interface is on then print TI Account Type            CTI001
      *                                                                   CTI001
     C           BGN3ST    IFEQ 'Y'                                       CTI001
     C                     MOVE *ON       *IN77                           CTI001
     C                     ELSE                                           CTI001
     C                     MOVE *OFF      *IN77                           CTI001
     C                     ENDIF                                          CTI001
      *                                                                   CTI001
     C                     EXSR SRBANK                                    063606
     C                     EXSR SRCURR                                    063606
     C                     Z-ADDA6NBDP    WDECS   10                      063606
      *                                                                   CRE002
     C/COPY WNCPYSRC,SD0030PC04
      *                                                                                       CER001
      ** Check Whether Feature ULX043 is present or not                                       CER001
      *                                                                                       CER001
     C                     MOVE 'N'       ULX043  1                                           CER001
     C                     MOVE *OFF      *IN52                                               CER001
     C           BGNWST    IFEQ 'Y'                        Lux Reporting                      CER001
     C                     CALL 'AOSARDR0'                                                    CER001
     C                     PARM *BLANKS   @RTCD                                               CER001
     C                     PARM '*VERIFY' @OPTN                                               CER001
     C                     PARM 'ULX043'  @SARD                                               CER001
     C           SCSARD    PARM *BLANKS   DSFDY                                               CER001
      *                                                                                       CER001
     C           @RTCD     IFNE '*NRF   '                                                     CER001
     C           @RTCD     ANDNE*BLANKS                                                       CER001
     C           *LOCK     IN   LDA                                                           CER001
     C                     MOVEL'SD0030P' DBPGM                                               CER001
     C                     MOVEL'SCSARDPD'DBFILE                                              CER001
     C                     MOVEL'ULX043'  DBKEY                                               CER001
     C                     Z-ADD01        DBASE                                               CER001
     C                     OUT  LDA                                                           CER001
     C                     EXSR *PSSR                                                         CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C           @RTCD     IFEQ *BLANK                                                        CER001
     C                     MOVE 'Y'       ULX043                                              CER001
     C                     OPEN SDACX2L0                                                      CER001
     C                     MOVE *ON       *IN52                                               CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C                     ENDIF                           BGNWST                             CER001
      *                                                                                       CER001
      * Access SAR details to see if CRE002 is switched on                CRE002
     C                     CALL 'AOSARDR0'                                CRE002
     C                     PARM *BLANKS   @RTCD   7                       CRE002
     C                     PARM '*VERIFY' @OPTN   7                       CRE002
     C                     PARM 'CRE002'  @SARD   6                       CRE002
     C           SCSARD    PARM *BLANKS   DSFDY                           CRE002
      *                                                                   CRE002
     C                     MOVE *BLANKS   CRE002  1                       CRE002
     C           @RTCD     IFEQ *BLANKS                    B1             CRE002
     C                     MOVEL'Y'       CRE002                          CRE002
     C                     ENDIF                           E1             CRE002
      *                                                                   CGL010
      ** Access SAR details to see if CGL010 is switched on               CGL010
      *                                                                   CGL010
     C                     CALL 'AOSARDR0'                                CGL010
     C                     PARM *BLANKS   @RTCD                           CGL010
     C                     PARM '*VERIFY' @OPTN                           CGL010
     C                     PARM 'CGL010'  @SARD                           CGL010
     C           SCSARD    PARM *BLANKS   DSFDY                           CGL010
      *                                                                   CGL010
     C                     MOVE *OFF      *IN19                           CGL010
     C           @RTCD     IFEQ *BLANKS                                   CGL010
     C                     MOVE *ON       *IN19                           CGL010
     C                     ENDIF                                          CGL010
      *                                                                   CRE002
      *** Use access program AOSARDR0 to retrieve switchable features     CSD005
      *                                                                   CSD005
     C                     CALL 'AOSARDR0'             90  SAR switched onCSD005
     C                     PARM *BLANKS   @RTCD   7        Access Pgm RetuCSD005
     C                     PARM '*VERIFY' @OPTN   7        Option for ACCOCSD005
     C                     PARM 'CSD005'  @SARN   6        SAR number fielCSD005
     C           SCSARD    PARM *BLANKS   DSFDY            Access obj dummCSD005
      *                                                                   CSD005
      *** If call end in error send error message                         CSD005
      *                                                                   CSD005
     C           *IN90     IFEQ '1'                                       CSD005
      *                                                                   CSD005
     C                     MOVEL'Y2U0032' W0RTN                           CSD005
     C                     MOVEL*BLANKS   W0CLPG 10                       CSD005
     C                     MOVEL'AOSARDR0'W0CLPG                          CSD005
      *
      *** Send message '*Error occured on CALL...'                        CSD005
      *
     C                     MOVEL'Y2U0032' ZAMSID                          CSD005
     C                     MOVEL'Y2USRMSG'ZAMSGF                          CSD005
     C                     MOVELW0CLPG    ZAMSDA           Message data   CSD005
     C                     EXSR ZASNMS                                    CSD005
     C                     ENDIF                                          CSD005
      *                                                                                       CGL014
     C                     MOVE 'N'       CGL014  1                                           CGL014
      *                                                                                       CGL014
      ** Access SAR details to see if CGL014 is switched on                                   CGL014
      *                                                                                       CGL014
     C                     CALL 'AOSARDR0'                                                    CGL014
     C                     PARM *BLANKS   PRTCD   7                                           CGL014
     C                     PARM '*VERIFY' POPTN   7                                           CGL014
     C                     PARM 'CGL014'  PSARD   6                                           CGL014
     C           SCSARD    PARM SCSARD    DSFDY                                               CGL014
      *                                                                                       CGL014
     C           PRTCD     IFNE *BLANKS                                                       CGL014
     C           PRTCD     ANDNE'*NRF   '                                                     CGL014
     C                     MOVEL'Y2U0032' W0RTN                                               CGL014
     C                     MOVEL*BLANKS   W0CLPG                                              CGL014
     C                     MOVEL'AOSARDR0'W0CLPG                                              CGL014
     C                     MOVEL'Y2U0032' ZAMSID                                              CGL014
     C                     MOVEL'Y2USRMSG'ZAMSGF                                              CGL014
     C                     MOVELW0CLPG    ZAMSDA                                              CGL014
     C                     EXSR ZASNMS                                                        CGL014
     C                     ENDIF                                                              CGL014
      *                                                                                       CGL014
     C           PRTCD     IFEQ *BLANKS                                                       CGL014
     C                     MOVE 'Y'       CGL014                                              CGL014
     C                     ENDIF                                                              CGL014
      *                                                                                       CLE025
     C                     MOVE 'N'       CLE025  1                                           CLE025
      *                                                                                       CLE025
      ** Access SAR details to see if CLE025 is switched on                                   CLE025
      *                                                                                       CLE025
     C                     CALL 'AOSARDR0'                                                    CLE025
     C                     PARM *BLANKS   PRTCD                                               CLE025
     C                     PARM '*VERIFY' POPTN                                               CLE025
     C                     PARM 'CLE025'  PSARD                                               CLE025
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE025
      *                                                                                       CLE025
     C           PRTCD     IFNE *BLANKS                                                       CLE025
     C           PRTCD     ANDNE'*NRF   '                                                     CLE025
     C                     MOVEL'Y2U0032' W0RTN                                               CLE025
     C                     MOVEL*BLANKS   W0CLPG                                              CLE025
     C                     MOVEL'AOSARDR0'W0CLPG                                              CLE025
     C                     MOVEL'Y2U0032' ZAMSID                                              CLE025
     C                     MOVEL'Y2USRMSG'ZAMSGF                                              CLE025
     C                     MOVELW0CLPG    ZAMSDA                                              CLE025
     C                     EXSR ZASNMS                                                        CLE025
     C                     ENDIF                                                              CLE025
      *                                                                                       CLE025
     C           PRTCD     IFEQ *BLANKS                                                       CLE025
     C                     MOVE 'Y'       CLE025                                              CLE025
     C                     ENDIF                                                              CLE025
      *                                                                   CSD005
      *** Switch on Account Narrative feature if appropriate              CSD005
      *                                                                   CSD005
     C                     SELEC                                          CSD005
     C           @RTCD     WHEQ *BLANK                                    CSD005
     C                     MOVE *ON       *IN73                           CSD005
     C           @RTCD     WHEQ '*NRF'                                    CSD005
     C                     MOVE *OFF      *IN73                           CSD005
     C                     ENDSL                                          CSD005
      *                                                                                       CGP001
      ** Check if CGP001 is enabled.                                                          CGP001
      *                                                                                       CGP001
     C           *NAMVAR   DEFN           LDA                                                 CGP001
      *                                                                                       CGP001
     C                     CALL 'AOSARDR0'                                                    CGP001
     C                     PARM *BLANKS   PRTCD   7                                           CGP001
     C                     PARM '*VERIFY' POPTN   7                                           CGP001
     C                     PARM 'CGP001'  PSARD   6                                           CGP001
     C           SCSARD    PARM *BLANKS   DSFDY                                               CGP001
      *                                                                                       CGP001
     C                     MOVE 'N'       CGP001  1                                           CGP001
     C                     MOVE *OFF      *IN66                                               CGP001
     C           PRTCD     IFEQ *BLANKS                                                       CGP001
     C                     MOVE 'Y'       CGP001                                              CGP001
     C                     MOVE *ON       *IN66                                               CGP001
      *                                                                                       CGP001
      ** Open the Global Processing Files.                                                    CGP001
      *                                                                                       CGP001
     C                     EXSR SRGPOF                                                        CGP001
      *                                                                                       CGP001
      ** Get the Zone.                                                                        CGP001
      *                                                                                       CGP001
     C                     EXSR SRGPGZ                                                        CGP001
     C                     ELSE                                                               CGP001
      *                                                                                       CGP001
     C           PRTCD     IFNE '*NRF'                                                        CGP001
     C                     MOVEL'SCSARDPD'DBFILE                                              CGP001
     C                     MOVEL'CGP001'  DBKEY                                               CGP001
     C                     MOVEL'07'      DBASE                                               CGP001
     C                     MOVE *ON       *INU7                                               CGP001
     C                     MOVE *ON       *INU8                                               CGP001
     C                     MOVE *ON       *INLR                                               CGP001
     C                     EXSR *PSSR                                                         CGP001
     C                     ENDIF                                                              CGP001
      *                                                                                       CGP001
     C                     ENDIF                                                              CGP001
      *                                                                                       CRE015
      ** Access SAR details to see if CRE015 is switched on                                   CRE015
      *                                                                                       CRE015
     C                     CALL 'AOSARDR0'                                                    CRE015
     C                     PARM *BLANKS   @RTCD                                               CRE015
     C                     PARM '*VERIFY' @OPTN                                               CRE015
     C                     PARM 'CRE015'  @SARN                                               CRE015
     C           SCSARD    PARM *BLANKS   DSFDY                                               CRE015
      *                                                                                       CRE015
     C           @RTCD     IFEQ *BLANKS                                                       CRE015
     C                     MOVE 'Y'       CRE015  1                                           CRE015
     C                     OPEN SDACD1L0                                                      CRE015
     C                     ELSE                                                               CRE015
     C                     MOVE 'N'       CRE015                                              CRE015
     C                     ENDIF                                                              CRE015
      *                                                                                     MD030956
      ** Access SAR details to see if CTI007 is switched on                                 MD030956
      *                                                                                     MD030956
     C                     CALL 'AOSARDR0'                                                  MD030956
     C                     PARM *BLANKS   @RTCD                                             MD030956
     C                     PARM '*VERIFY' @OPTN                                             MD030956
     C                     PARM 'CTI007'  @SARN                                             MD030956
     C           SCSARD    PARM *BLANKS   DSFDY                                             MD030956
      *                                                                                     MD030956
     C           @RTCD     IFEQ *BLANKS                                                     MD030956
     C                     MOVE 'Y'       CTI007  1                                         MD030956
     C                     MOVE '1'       *IN77                                             MD030956
     C                     MOVE '1'       *IN78                                             MD030956
     C                     ELSE                                                             MD030956
     C                     MOVE 'N'       CTI007                                            MD030956
     C                     MOVE '0'       *IN78                                             MD030956
     C                     ENDIF                                                            MD030956
      *                                                                   CSD005
      *** Use access program AOSARDR0 to retrieve switchable features     CPB004
      *                                                                   CPB004
     C                     CALL 'AOSARDR0'             90  SAR switched onCPB004
     C                     PARM *BLANKS   @RTCD   7        Access Pgm RetuCPB004
     C                     PARM '*VERIFY' @OPTN   7        Option for ACCOCPB004
     C                     PARM 'CPB004'  @SARN   6        SAR number fielCPB004
     C           SCSARD    PARM *BLANKS   DSFDY            Access obj dummCPB004
      *                                                                   CPB004
      *** If call end in error send error message                         CPB004
      *                                                                   CPB004
     C           *IN90     IFEQ '1'                                       CPB004
      *                                                                   CPB004
     C                     MOVEL'Y2U0032' W0RTN                           CPB004
     C                     MOVEL*BLANKS   W0CLPG 10                       CPB004
     C                     MOVEL'AOSARDR0'W0CLPG                          CPB004
      *                                                                   CPB004
      *** Send message '*Error occured on CALL...'                        CPB004
      *                                                                   CPB004
     C                     MOVEL'Y2U0032' ZAMSID                          CPB004
     C                     MOVEL'Y2USRMSG'ZAMSGF                          CPB004
     C                     MOVELW0CLPG    ZAMSDA           Message data   CPB004
     C                     EXSR ZASNMS                                    CPB004
     C                     ENDIF                                          CPB004
      *                                                                   CPB004
      *** Switch on Account Narrative feature if appropriate              CPB004
      *                                                                   CPB004
     C                     SELEC                                          CPB004
     C           @RTCD     WHEQ *BLANK                                    CPB004
     C**********           MOVE *ON       *IN66                                      CPB004 BUG10644
     C                     MOVE *ON       *IN67                                             BUG10644
     C           @RTCD     WHEQ '*NRF'                                    CPB004
     C**********           MOVE *OFF      *IN66                                      CPB004 BUG10644
     C                     MOVE *OFF      *IN67                                             BUG10644
     C                     ENDSL                                          CPB004
      *                                                                   CPB004
     C                     MOVEL'GBSDU'   GBMSG  10                       128437
     C                     MOVE 'SRMSG'   GBMSG                           128437
      *                                                                   128437
     C           ZA1311    PLIST                                          CRE002
     C                     PARM           MSGID   7                       CRE002
     C                     PARM *BLANKS   MSGDT0 40                       CRE002
     C                     PARM *BLANKS   MSGDT1 40                       CRE002
     C                     PARM *BLANKS   MSGDT2 40                       CRE002
     C                     PARM *BLANKS   MSGDT3 40                       CRE002
     C                     PARM *BLANKS   MSGDT4 40                       CRE002
     C                     PARM *BLANKS   MSGDT5 40                       CRE002
     C                     PARM *BLANKS   MSGDT6 40                       CRE002
     C                     PARM *BLANKS   MSGDT7 40                       CRE002
     C                     PARM *BLANKS   MSGDT8 40                       CRE002
     C                     PARM *BLANKS   MSGDT9 40                       CRE002
     C                     PARM *BLANKS   MNARR 200                       CRE002
     C                     PARM           GBMSG  10                       128437
     C                     MOVELCMD,1     CMD1                            131458
     C                     Z-ADD41        MSGLEN 155                      131458
     C                     CALL 'QCMDEXC'                                 131458
     C                     PARM           CMD1   41                       131458
     C                     PARM           MSGLEN                          131458
      *                                                                   CRE002
      * Text NOT conditioned on switchable feature                        CRE002
     C                     MOVEL'USR3557' MSGID                           CRE002
     C***********          CALL 'ZA1310'  ZA1311                   CRE002 128437
     C                     CALL 'ZAC1310' ZA1311                          128437
     C                     MOVELMNARR     XRDIDX                          CRE002
      *                                                                   CRE002
     C                     MOVEL'USR3559' MSGID                           CRE002
     C***********          CALL 'ZA1310'  ZA1311                   CRE002 128437
     C                     CALL 'ZAC1310' ZA1311                          128437
     C                     MOVELMNARR     XRCICX                          CRE002
      *                                                                   CRE002
      * If CRE002 is ON....                                               CRE002
     C           CRE002    IFEQ 'Y'                        B1             CRE002
      *                                                                   CRE002
      * ....set text for Interim A/c processing                           CRE002
     C                     MOVEL'USR3560' MSGID                           CRE002
     C***********          CALL 'ZA1310'  ZA1311                   CRE002 128437
     C                     CALL 'ZAC1310' ZA1311                          128437
     C                     MOVELMNARR     XRDICX                          CRE002
      *                                                                   CRE002
     C                     MOVEL'USR3560' MSGID                           CRE002
     C***********          CALL 'ZA1310'  ZA1311                   CRE002 128437
     C                     CALL 'ZAC1310' ZA1311                          128437
     C                     MOVELMNARR     XRCIDX                          CRE002
      *                                                                   CRE002
     C                     MOVEL'USR3556' MSGID                           CRE002
     C***********          CALL 'ZA1310'  ZA1311                   CRE002 128437
     C                     CALL 'ZAC1310' ZA1311                          128437
     C                     MOVELMNARR     XRICDX                          CRE002
      *                                                                   CRE002
     C                     MOVEL'USR3558' MSGID                           CRE002
     C***********          CALL 'ZA1310'  ZA1311                   CRE002 128437
     C                     CALL 'ZAC1310' ZA1311                          128437
     C                     MOVELMNARR     XRICCX                          CRE002
      *                                                                   CRE002
      * If CRE002 is OFF....                                              CRE002
     C                     ELSE                            X1             CRE002
      *                                                                   CRE002
      * ....set text for standard processing                              CRE002
     C                     MOVEL'USR3556' MSGID                           CRE002
     C***********          CALL 'ZA1310'  ZA1311                   CRE002 128437
     C                     CALL 'ZAC1310' ZA1311                          128437
     C                     MOVELMNARR     XRDICX                          CRE002
      *                                                                   CRE002
     C                     MOVEL'USR3558' MSGID                           CRE002
     C***********          CALL 'ZA1310'  ZA1311                   CRE002 128437
     C                     CALL 'ZAC1310' ZA1311                          128437
     C                     MOVELMNARR     XRCIDX                          CRE002
      *                                                                   CRE002
     C                     MOVEL'USR3557' MSGID                           CRE002
     C***********          CALL 'ZA1310'  ZA1311                   CRE002 128437
     C                     CALL 'ZAC1310' ZA1311                          128437
     C                     MOVELMNARR     XRICDX                          CRE002
      *                                                                   CRE002
     C                     MOVEL'USR3559' MSGID                           CRE002
     C***********          CALL 'ZA1310'  ZA1311                   CRE002 128437
     C                     CALL 'ZAC1310' ZA1311                          128437
     C                     MOVELMNARR     XRICCX                          CRE002
      *                                                                   CRE002
     C                     ENDIF                           E1             CRE002
      *                                                                   CRE002
     C*                                                                   132486
     C                     OPEN SD0030PM                                  132486
     C*                                                                   132486
     C** Ensure Report spool file recorded by RCF.                        132486
     C*                                                                   132486
     C                     Z-ADDSFNUM     ZSNUM   60                      132486
     C*                                                                   132486
     C                     CALL 'ZSFILE'                                  132486
     C                     PARM           SEQ     5                       132486
     C                     PARM *BLANKS   @PARM   3                       132486
     C                     PARM           SFILE                           132486
     C                     PARM           ZSNUM                           132486
     C                     PARM           ZSERR   1                       132486
     C*                                                                   132486
     C           ZSERR     IFEQ 'Y'                                       132486
     C*                                                                   132486
     C**  Error during ZSFILE processing, return to calling program.      132486
     C*                                                                   132486
     C                     MOVE '1'       *INU7                           132486
     C                     MOVE '1'       *INU8                           132486
     C                     MOVE '1'       *INLR                           132486
     C                     RETRN                                          132486
     C                     END                                            132486
      *================================================================
     CSR         ZZEXIT    ENDSR
      /EJECT                                                              063606
     C           SRBANK    BEGSR                                          063606
      *                                                                   063606
      ** Access  SDBANKPD for Base currency                               063606
      *                                                                   063606
     C                     CALL 'AOBANKR0'                                063606
     C                     PARM '*DBERR  '@RTCD   7                       063606
     C                     PARM '*FIRST'  @OPTN   7                       063606
     C           SDBANK    PARM SDBANK    DSFDY                           063606
     C*                                                                   063606
     C                     ENDSR                                          063606
     C*                                                                   063606
     C           SRCURR    BEGSR                                          063606
      *                                                                   063606
      ** Access  SDCURRPD for No. of Decimal Places                       063606
      *                                                                   063606
     C                     CALL 'AOCURRR0'                                063606
     C                     PARM '*DBERR  '@RTCD                           063606
     C                     PARM '*KEY    '@OPTN                           063606
     C                     PARM BJCYCD    @CCY    3                       063606
     C           SDCURR    PARM SDCURR    DSSDY                           063606
      *                                                                   063606
     C                     ENDSR                                          063606
      *                                                                   063606
      *****************************************************************                       CGP001
      /EJECT                                                                                  CGP001
      *****************************************************************                       CGP001
     CSR         *PSSR     BEGSR                                                              CGP001
      *****************************************************************                       CGP001
      *                                                               *                       CGP001
      * *PSSR  - Program exception error routine                      *                       CGP001
      *          Called automatically if a program error occurs,      *                       CGP001
      *          or directly by the program code using EXSR.          *                       CGP001
      *          This subroutine DUMPs the program just once.         *                       CGP001
      *                                                               *                       CGP001
      *****************************************************************                       CGP001
      *                                                                                       CGP001
      * Standard Midas PSSR processing.                                                       CGP001
      *                                                                                       CGP001
     C/COPY SDCPYSRC,SDPSSRBCH                                                                CGP001
      *                                                                                       CGP001
      *****************************************************************                       CGP001
     CSR                   ENDSR                                                              CGP001
      *****************************************************************                       CGP001
     C/COPY WNCPYSRC,SD0030PC02
** CPY@     : Copyright notice for inclusion in all programs
(c) Finastra International Limited 2001
** @CN Long constants used in program.
BANK
Y2U0005
SDBANKPD
SDMMODPD                                                                  S01413
**   CMD - COMMAND TO OVERIDE MESSAGE FILE                                131458
OVRMSGF MSGF(QUSERMSG) TOMSGF(GBSDUSRMSG)
DLTOVR QUSERMSG
** OVRC                                                                                       CGP001
OVRDBF FILE(GPACDXL0) TOFILE(GPACODXL0)                                                       CGP001
