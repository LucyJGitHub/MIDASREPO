     H        1   Y
      *****************************************************************
/*OVR *  OVRDBF FILE(GPACDXL0) TOFILE(GPACODXL0)                      *                       CGP001
/*OVR *  OVRDBF FILE(GPPRDXL0) TOFILE(GPPRODXL0)                      *                      BUG2312
/*OVR *  OVRDBF FILE(GPINSXL0) TOFILE(GPINSTXL0)                      *                      BUG2312
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas SD Account code enquiry')                        *
      *****************************************************************
      *                                                               *
      *  Midas - Standing Data Module                                 *
      *                                                               *
      *  SD0031E - Display account code                               *
      *                                                               *
      *  Function:  This program displays account code record details *
      *                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. MD062338           Date 19Mar24               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 CGL165             Date 23Feb15               *
      *                 MD030956           Date 09Oct14               *
      *                 MD028343           Date 10Jul14               *
      *                 CER059             Date 19Jul10               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 CRE015             Date 18Dec09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 245932             Date 13Apr07               *
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 234422             Date 10Jul06               *
      *                 CDL013             Date 10Jul06               *
      *                 CSD031             Date 10Apr06               *
      *                 CGL052             Date 03Feb06               *
      *                 CER001             Date 25Apr05               *
      *                 CPB004             Date 11Jul02               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL014             Date 20Oct03               *
      *                 BUG2312            Date 05May04               *
      *                 TCA105             Date 01Apr04               *
      *                 CGP001             Date 05Mar04               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4.01 -------------------------------------------*
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      * Midas DBA 3.03 -----------------------------------------------*
      * Midas DBA 3.02 -----------------------------------------------*
      *                 CGL010             Date 08Nov99               *
      *                 CPB001             Date 18Oct99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CSD005             Date 03MAR99               *
      *                 CFT002             Date 18Nov98               *
      *                 CTI002             Date 26AUG98               *
      *                 CSD003             Date 27OCT97               *
      *                 CTI001             DATE 25JUL97               *
      *                 CRE002             DATE 03FEB97               *
      *                 CAC001             DATE 06FEB96               *
      *                 S01522             DATE 10OCT94               *
      *                 S01486             DATE 29JUN94               *
      *                 063606             DATE 01FEB94               *
      *                 S01461             DATE 14JAN94               *
      *                 S01459             DATE 14JAN94               *
      *                 S01437             DATE 16SEP93               *
      *                 S01413             DATE 28JUN93               *
      *                 E23836             DATE 11SEP91               *
      *                 E24400             DATE 06SEP91               *
      *                 S01267             DATE 30JAN91               *
      *                 LN0947             DATE 24JAN91               *
      *                 E19592             DATE 10FEB90               *
      *                 S01216             DATE 10FEB90               *
      *                 S01212             DATE 10FEB90               *
      *                                                               *
      *****************************************************************
      *                                                               *
      *  MD062338 - Authority issue when accessing UDC details from   *
      *             Standing Data Account Codes Maintenance Enquiry   *
      *  MD046248 - Finastra Rebranding                               *
      *  CGL165 - Dual Withholding Tax                                *
      *  MD030956 - Additional changes to BFM-TI enhancement          *
      *  MD028343 - Incorrect label of Trade Finance Exposure Account *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (Recompile)                                         *
      *  CRE015 - Retail Term and Notice Accounts                     *
      *  245932 - Midas SD Account Code Enquiry SD0031E# Display File *
      *           (Recompile)
      *  234422 - Search record in SDACODPA only if CDL013 is *on     *
      *  CDL013 - Tiered Withholding Tax                              *
      *  CSD031 - Enhanced Centralised Static Data                    *
      *  CGL052 - Upgrade LBV058 to Midas Plus.                       *
      *           Amend Washout Processing                            *
      *           Recompile over changes in SD0030GDTA                *
      *  CER001 - LUX Upgrade to MidasPlus                            *
      *  CPB004 - Add 'To be transferred to TOF' flag to be           *
      *           displayed for each account code.                    *
      *  CLE025 - Credit Lines                                        *
      *  CGL014 - Collateral Processing                               *
      *  BUG2312 - Global product code and global instrument code     *
      *          - are being retrieved from incorrect file (GPACODXPD)*
      *          - They should be coming from the following :-        *
      *          - Global product code <-- GPPRODXPD.                 *
      *          - Global instrument code <-- GPPRODXPD.              *
     F*  TCA105 - No database error if record not on GPACODXPD       *
      *  CGP001 - Global Processing                                   *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CGL010 - Future Value Dated Journal Entries for              *
      *           Non-Retail Accounts.                                *
      *  CPB001 - 'Private Banking' Module                            *
      *  CSD005 - Addition of Standing Data Account Narrative field   *
      *           on condition of switchable feature CSD005 to        *
      *           replace account name.                               *
      *  CFT002 - Straight Through Processing Phase 1                 *
      *           - Include Vostro & Loro Account Flags               *
      *  CTI002 - Trade innovation :                                  *
      *           - New Field  Trade Finance Contingent Account.      *
      *           - Recompile over changed SDGELRL1.                  *
      *  CSD003 - Synon Closedown Project (SD):                       *
      *           - Program removed from SD model.                    *
      *  CTI001 - Midas-Trade Innovation Interface:                   *
      *           - Addition of 'TI Account Type' field.              *
      *  CRE002 - Retail Accruals Processing Enhancement.             *
      *  CAC001 - Profit Centre Accounting - additional fields:       *
      *            Management Accnts Analysis By Profit Centre;       *
      *            Management Accnts Analysis By Book;                *
      *            Management Accnts Analysis By Assoc. Customer;     *
      *            Management Accnts Analysis By Product.             *
      *  S01522 - User Defined Correspondence development.            *
      *  S01486 - Private Banking:                                    *
      *           Addition of 'Portfolio Management Instrument Code'. *
      *  063606 - The number of decimal places for                    *
      *           'Minimum withholding tax' should be the same as     *
      *           that for the base currency.                         *
      *  S01461 - The Midas Export module processing was removed      *
      *           and moved to the Eureka platform.                   *
      *  S01459 - Addition of headerbox and PSSR processing.          *
      *  S01437 - Add 'Midas Export Account Code' field               *
      *           to the screen.                                      *
      *  S01413 - Retail 3 incorporation:- Withholding Tax details    *
      *           available.                                          *
      *  E23836 - Change 'Debt' to 'Debit' on screen for 'Interest    *
      *           Accrual A/c Code'                                   *
      *  E24400 - Change description of Acct Post Retention on        *
      *           screen to 'Posting Retention Period'                *
      *  S01267 - MIS Changes.                                        *
      *  LN0947 - REGENERATE DUE TO CHANGE IN SDACODPD                *
      *  E19592 - Screen design changed so Debits appear on left of   *
      *           (or above) Credits.                                 *
      *  S01216 - Release 1 Enhancements                              *
      *  S01212 - /Copy and Window Processing                         *
      *                                                               *
      ****************************************************************
     F*
     F/COPY WNCPYSRC,SD0031EFPG
     F*
     FSD0031E#CF  E                    WORKSTN                        UC
     F                                              KINFDS INFDS#
     F                                              KINFSR *PSSR
      * DSP: Midas SD Account code enquiry
      *
     FSDACODL1IF  E           K        DISK                           UC
     F                                              KINFDS INFDS1
     F                                              KINFSR *PSSR
      * RTV : Midas SD Account codes retrieval
      *
      *                                                                                       CDL013
     FSDACOAL1IF  E           K        DISK         KINFSR *PSSR      UC                      CDL013
      * Account code ext. file input.                                                         CDL013
      *                                                                                       CDL013
     FSDMMODL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0001
     F                                              KINFSR *PSSR
      * RTV : Midas SD Midas module flags retrieval
      *
     FSDBANKL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0002
     F                                              KINFSR *PSSR
      * RTV : Midas SD Bank details ICD retrieval
      *
     FSDCURRL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0003
     F                                              KINFSR *PSSR
      * RTV : Midas SD Currency codes retrieval
      *
     FSDGELRL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0004
     F                                              KINFSR *PSSR
      * RTV : Midas SD General ledger ICD details retrieval
      *
     FGPACDXL0IF  E           K        DISK                           UC                      CGP001
     F                                              KINFSR *PSSR                              CGP001
     F            GPACODXD0                         KRENAMEGPACDXD0                           CGP001
      ** Midas GP Global Account Codes X-Reference                                            CGP001
      *                                                                                       CGP001
     FGPPRDXL0IF  E           K        DISK                           UC                     BUG2312
     F                                              KINFSR *PSSR                             BUG2312
     F            GPPRODXD0                         KRENAMEGPPRDXD0                          BUG2312
      ** Midas GP Global Products X-Reference                                                BUG2312
      *                                                                                      BUG2312
     FGPINSXL0IF  E           K        DISK                           UC                     BUG2312
     F                                              KINFSR *PSSR                             BUG2312
     F            GPINSTXD0                         KRENAMEGPINSXD0                          BUG2312
      ** Midas GP Global Instruments X-Reference                                             BUG2312
      *                                                                                      BUG2312
     FSDAACDL1IF  E           K        DISK                           UC                      CSD031
     F                                              KINFSR *PSSR                              CSD031
      *                                                                                       CRE015
      ** Midas SD Account Codes - T&N Accounts                                                CRE015
      *                                                                                       CRE015
     FSDACD1L0IF  E           K        DISK                           UC                      CRE015
     F                                              KINFSR *PSSR                              CRE015
     E* Description     : Copyright notice for inclusion in all programs
     E*
     E********************************************************************
     E                    CPY@    1   1 80               Copyright
     E**********          OVRC    1   1 80                                            CGP001 BUG2312
     E                    OVRC    1   3 80                                                   BUG2312
      ** Override Command Array                                                               CGP001
      *                                                                                       CGP001
     E*
     E/COPY WNCPYSRC,SD0031EEPG
     E*
     I*
     I* Description     : Copyright notice for inclusion in all programs
     I*
     I****/COPY QWINDSRC,DLE1DTA                                          S01229
      *                                                                                       CRE015
      ** Rename Account Code for SDACD1L0                                                     CRE015
      *                                                                                       CRE015
     ISDACD1D0                                                                                CRE015
     I              A5ACCD                          AXACCD                                    CRE015
     I/COPY QWINDSRC,SD0030GDTA                                           S01229
     IDATALX      DS                           1024                                           CER001
     I                                        1  10 #2ACCD                                    CER001
     I                                       11  17 #1RTRN                                    CER001
     I                                       18  18 #1TOIN                                    CER001
     I                                       19  19 #1ACTY                                    CER001
     I*
     I/COPY WNCPYSRC,SD0031EIPG
     I*
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     ILDA         DS                            256                                           CGP001
      ** Local data area for database error details                                           CGP001
      *                                                                                       CGP001
     I                                      134 141 DBFILE                                    CGP001
     I                                      142 170 DBKEY                                     CGP001
     I                                      171 180 DBPGM                                     CGP001
     I                                      181 1830DBASE                                     CGP001
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
      *-------------------------------------------------------------------CFT002
     IDSFDY     E DSDSFDY                                                 CFT002
      * DS for Access Programs, short data structure.                     CFT002
      *-------------------------------------------------------------------CFT002
     IDSSARD    E DSSCSARDPD                                              CFT002
      * Definition: Switchable Features Accessed Via Access Program.      CFT002
      *-------------------------------------------------------------------CFT002
     IRUNDAT      DS
     I                                        1   7 MRDT
     I                                    P   8  100RDNB
     I                                       11  11 SUC
     I                                       12  12 DFF
     I                                       13  13 MBIN
     IA@CPY       DS
      * Copyright array
     I                                        1  80 CPY@
     IID0001      DS                            528
      * File information data structure
      *
     IID0002      DS                            528
      * File information data structure
      *
     IID0003      DS                            528
      * File information data structure
      *
     IID0004      DS                            528
      * File information data structure
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I : MAP Account Code
     I**********                              1   4 P1ACCD                                    CGL029
     I                                        1  10 P1ACCD                                    CGL029
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Receivable'
      * Message data for 'Income'
      * Message data for 'Expense'
      * Message data for 'Payable'
      * Message data for 'Receivable'
      * Message data for 'Payable'
      * Message data for 'Receivable'
      * Message data for 'Interim'
      * Message data for 'Interim'
      * Message data for 'Payable'
      * Message data for 'Income'
      * Message data for 'Expense'
      * Message data for 'Database Error (ICD)'
      * Filename
     I                                        1  10 ZA0001
      * Message data for 'Database Error (ICD)'
      * Filename
     I                                        1  10 ZA0002
      *                                                                                       CGP001
     I              'GOGETZONE'           C         GOPGM                                     CGP001
     I              'ERROR IN GOGETZONE'  C         GOMSG                                     CGP001
      ** Global Processing Constants                                                          CGP001
      *                                                                                       CGP001
     I              'WITHHOLDING TAX DETA-C         WWHTX                                   MD028343
     I              'ILS:-        '                                                         MD028343
     I              'Trade Finance Exposu-C         WTFCA                                   MD028343
     I**********    're  Accnt...:'                                                MD028343 MD030956
     I              're Account..:'                                                         MD030956
      *                                                                                     MD062338
      ** Data to retrieve the menu group/item codes                                         MD062338
     IZMITEM      DS                                                                        MD062338
     I                                        1  10 INDX                                    MD062338
      *                                                                                     MD062338
      ** Menu item index                                                                    MD062338
     I              '0000000363'          C         UDCENQ                                  MD062338
     I              '0000000479'          C         ACCENQ                                  MD062338
      *                                                                                     MD062338
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C********** P1ACCD    PARM           WP0001  4        Account Code                       CGL029
     C           P1ACCD    PARM           WP0001 10                                           CGL029
     C                     PARM           PMODE   1                                           CSD031
     C/COPY WNCPYSRC,SD0031EC11
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Check passed parameters
     C                     EXSR FACKPM
      * Perform once if all passed, else repeat
     C           W0RPT     DOUEQ'N'
      * Display and process key screen
     C                     EXSR BADSKY
     C                     END
      * Terminate program
     C                     EXSR ZXEXPG
      *****************************************************************
      /EJECT
     CSR         BADSKY    BEGSR
      *================================================================
      * Display and process key screen
      *================================================================
      * Initialize key screen
     C                     EXSR MDIZ#K
      * Bypass first display of key screen is possible
     C                     MOVEL'Y'       W0BYP   1
      * Signal start of transaction
     C                     MOVEL'Y'       W0TRN   1
      *
     C           W0TRN     DOWEQ'Y'
     C           W0TRN     OREQ 'K'
      * Ensure transaction continues (if reset)
     C                     MOVEL'Y'       W0TRN   1
      * Conduct screen conversation
     C           W0TRN     DOWEQ'Y'
      * Is bypass key screen still viable?
     C           W0BYP     IFEQ 'Y'
     C           #1ACCD    IFEQ *BLANK                     Account Code
      * One or more key fields is blank
     C           *IN05     OREQ '1'
      * HOME: Reset screen fields
     C                     MOVEL'N'       W0BYP
     C                     END
     C                     END
      * Bypass key screen
     C           W0BYP     IFNE 'Y'
      * Display key screen
     C                     EXSR BBEXFM
     C                     END
      * Cancel key screen bypass
     C                     MOVEL'N'       W0BYP
      * Process response to key screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   05                CAS            BDHMKY
      * Process key screen input
     C                     CAS            BEPRKY
     C                     END
     C           W0TRN     DOWEQ'R'
     C                     MOVEL'Y'       W0TRN
     C                     EXSR BEPRKY
     C                     END
      *
     C                     END
     C                     END
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBEXFM    BEGSR
      *================================================================
      * Display key screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSAK
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE HELP25    *IN25
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDKEY
      * Enable PUTOVR
     C                     SETON                     86
      * Test cursor
     C                     EXSR Y8TST
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         BDHMKY    BEGSR
      *================================================================
      * Process HOME key
      *================================================================
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         BDEXIT    ENDSR
      /EJECT
     CSR         BEPRKY    BEGSR
      *================================================================
      * Process key screen input
      *================================================================
      * Initialise detail screen
     C                     EXSR MAIZ#1
      * Validate key fields
     C                     EXSR BFVLKY
     C           *IN99     CABEQ'1'       BEEXIT
      * Check for existing record
     C           KRTV      KLIST
     C                     KFLD           A5ACCD           Account Code
      * Setup key
     C                     MOVEL#1ACCD    A5ACCD           Account Code
     C           CSD032    IFEQ 'Y'                                                           CSD031
     C           PMODE     ANDEQ'A'                                                           CSD031
     C           KRTV      CHAINSDAACDL1             9091                                     CSD031
     C                     ELSE                                                               CSD031
     C           KRTV      CHAIN@A5REA6              9091  *
     C                     ENDIF                                                              CSD031
     C           *IN91     IFEQ '1'
      * Record locked
     C                     SETON                     9931  *
     C                     GOTO BEEXIT
     C                     END                             FI 91
      *
      * If record does not exist, then signal error
     C           *IN90     IFEQ '1'
     C                     SETON                     9931  *
      * Send message 'Account Codes          NF'
     C                     MOVEL'USR0069' ZAMSID
     C                     EXSR ZASNMS
     C                     ELSE
      *                                                                                       CDL013
      ***   Check if CAR CDL013 is installed                                                  CDL013
      *                                                                                       CDL013
     C                     CALL 'AOSARDR0'             85                                     CDL013
     C                     PARM *BLANK    WQ0063  7                                           CDL013
     C                     PARM '*VERIFY' WQ0064  7                                           CDL013
     C                     PARM 'CDL013'  WQ0065  6                                           CDL013
     C                     PARM *BLANK    WQ0066 76                                           CDL013
      *                                                                                       CDL013
      ** If program fails send error message                                                  CDL013
      *                                                                                       CDL013
     C           *IN85     IFEQ *ON                                                           CDL013
     C                     MOVEL'Y2U0032' ZAMSID                                              CDL013
     C                     MOVEL'Y2USRMSG'ZAMSGF                                              CDL013
     C                     EXSR ZASNMS                                                        CDL013
      *                                                                                       CDL013
     C                     ELSE                                                               CDL013
      *                                                                                       CDL013
      ** CAR CDL013 is not installed set off flag                                             CDL013
      *                                                                                       CDL013
     C           WQ0063    IFEQ '*NRF'                                                        CDL013
     C                     MOVE '0'       CDL013  1                                           CDL013
     C                     MOVE *ON       *IN83                                               CDL013
      *                                                                                       CDL013
      ** CAR CDL013 is installed set on flag.                                                 CDL013
      *                                                                                       CDL013
     C                     ELSE                                                               CDL013
     C                     MOVE '1'       CDL013                                              CDL013
     C                     MOVE *OFF      *IN83                                               CDL013
     C                     ENDIF                                                              CDL013
     C                     ENDIF                                                              CDL013
      *                                                                                       CDL013
      ** Access Extension File                                                                CDL013
      *                                                                                       CDL013
     C           CDL013    IFEQ '1'                                                           234422
     C           KRTV      CHAINSDACOAL1             85                                       CDL013
      *                                                                                       CDL013
      ** If record not found send message 'Record not found'                                  CDL013
      *                                                                                       CDL013
     C           *IN85     IFEQ *ON                                                           CDL013
     C                     MOVEL'XXW0104' ZAMSID                                              CDL013
     C                     MOVEL'SDUSRMSG'ZAMSGF                                              CDL013
     C                     EXSR ZASNMS                                                        CDL013
     C                     MOVE *ON       *IN99                                               CDL013
     C                     MOVE *ON       *IN31                                               CDL013
     C                     GOTO BEEXIT                                                        CDL013
     C                     ENDIF                                                              CDL013
     C                     ENDIF                                                              234422
     C/COPY WNCPYSRC,SD0031EC06
     C                     EXSR MBFL#1
      * CALC: Detail screen function fields
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy Member SD0031ESFF - Account Codes  *
     C*
     C/COPY WNCPYSRC,SD0031ESFF
     C*
     C                     END                             *FI
      * USER: Load detail screen from DBF record
      * Start of 063606
      * Zalign Withholding tax - Account Codes  *
     C                     MOVE *BLANKS   WUZASF           ZALIGN Screen F
     C                     MOVE A5MISU    WUZASF           ZALIGN Screen F
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0001 16        ZALIGN Screen F
     C                     PARM WUZAND    WQ0002  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     MOVELWUZASF    #DWTSC           Withholding Tax
      * End of 063606
      * Start of CRE002
      * CASE: WRK.CRE002 is Not present
     C           WURAPE    IFEQ 'N'                        *IF
      * Setup message data for message
      * Retrieve message Receivable
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR3195' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C           #DFLD1    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Setup message data for message
      * Retrieve message Income
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR3196' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C           #DFLD2    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Setup message data for message
      * Retrieve message Expense
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR3197' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C           #DFLD3    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Setup message data for message
      * Retrieve message Payable
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR3198' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C           #DFLD4    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Setup message data for message
      * Retrieve message Receivable
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR3195' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C           #DFLD5    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Setup message data for message
      * Retrieve message Payable
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR3198' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C           #DFLD6    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Retrieve message Receivable
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR3195' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C           #DFLD1    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Setup message data for message
      * Retrieve message Interim
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR3199' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C           #DFLD2    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Setup message data for message
      * Retrieve message Interim
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR3199' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C           #DFLD3    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Setup message data for message
      * Retrieve message Payable
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR3198' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C           #DFLD4    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Setup message data for message
      * Retrieve message Income
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR3196' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C           #DFLD5    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Setup message data for message
      * Retrieve message Expense
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR3197' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C           #DFLD6    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
     C                     END                             *FI
      * End of CRE002
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy Member SD0031ELDS - Account Codes  *
     C*
     C/COPY WNCPYSRC,SD0031ELDS
     C*
     C                     END                             *FI
     C                     END
      *
     C   99                GOTO BEEXIT
      * No error: Display and process details
     C                     EXSR CADSDA
      *
      *================================================================
     CSR         BEEXIT    ENDSR
      /EJECT
     CSR         BFVLKY    BEGSR
      *================================================================
      * Validate key fields
      *================================================================
      * Select existing record
     C                     EXSR VACKRL
      * USER: Validate key screen
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy Member SD0031EVKS - Account Codes  *
     C*
     C/COPY WNCPYSRC,SD0031EVKS
     C*
     C                     END                             *FI
      * Account Code required
     C           #1ACCD    IFEQ *BLANK                     IF
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         BFEXIT    ENDSR
      /EJECT
     CSR         CADSDA    BEGSR
      *================================================================
      * Display and process detail screen
      *================================================================
      * Conduct detail screen conversation
      * - repeat until screen control flag is reset:
     C                     MOVEL'Y'       W0TRN2  1                                           CRE015
     C           W0TRN     DOWEQ'Y'
     C           W0TRN2    OREQ 'P'                                                           CRE015
      * Display detail screen
     C                     EXSR CBEXFM
      * Process response to detail screen
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
      * Process detail screen input
      * Redisplay previous screen
     C   12                CAS            CCDSPV
      * HOME: Reset screen fields
     C   05                CAS            CCDSPV
      * Process key screen input
     C                     CAS            CFPRSC
     C                     END
      *
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT                                                                                  CRE015
     CSR         CXPRTN    BEGSR                                                              CRE015
      *================================================================                       CRE015
      * Display and Process Term and Notice Details Screen                                    CRE015
      *================================================================                       CRE015
      *                                                                                       CRE015
      ** Set up screen values                                                                 CRE015
      *                                                                                       CRE015
     C                     EXSR MXIZ#1                                                        CRE015
     C                     MOVEL'Y'       W0TRN                                               CRE015
      *                                                                                       CRE015
      ** Rewrite header                                                                       CRE015
      *                                                                                       CRE015
     C           W0BYP     IFEQ 'Y'                                                           CRE015
     C                     EXSR BBEXFM                                                        CRE015
     C                     ENDIF                                                              CRE015
      *                                                                                       CRE015
     C           W0TRN     DOWEQ'Y'                                                           CRE015
      *                                                                                       CRE015
      ** Display detail screen                                                                CRE015
      *                                                                                       CRE015
     C                     EXSR DXEXFM                                                        CRE015
      *                                                                                       CRE015
      ** Cancel & exit program                                                                CRE015
      *                                                                                       CRE015
     C   03                CAS            ZXEXPG                                              CRE015
      *                                                                                       CRE015
      ** Redisplay previous screen                                                            CRE015
      *                                                                                       CRE015
     C   12                CAS            FFDSPV                                              CRE015
     C                     ENDCS                                                              CRE015
     C                     MOVE 'N'       W0TRN                                               CRE015
      *                                                                                       CRE015
     C                     ENDDO                                                              CRE015
      *================================================================                       CRE015
     CSR         CXEXIT    ENDSR                                                              CRE015
      /EJECT                                                                                  CRE015
     CSR         DXEXFM    BEGSR                                                              CRE015
      *================================================================                       CRE015
      * Display Term & Notice Screen and Process Help Request                                 CRE015
      *================================================================                       CRE015
      *                                                                                       CRE015
      ** Update screen time                                                                   CRE015
      *                                                                                       CRE015
     C                     TIME           ##TME                                               CRE015
      *                                                                                       CRE015
      ** PUTOVR unless conditioned fields change                                              CRE015
      *                                                                                       CRE015
     C                     SETON                         86                                   CRE015
      *                                                                                       CRE015
      ** Set cursor by *SET CURSOR data                                                       CRE015
      *                                                                                       CRE015
     C           YSETCS    IFEQ 'Y'                                                           CRE015
     C                     EXSR Y0SET                                                         CRE015
     C                     ENDIF                                                              CRE015
     C                     WRITE#MSGCTL                                                       CRE015
     C                     WRITE#CMDTXT2                                                      CRE015
     C                     EXFMT#RCDDTL2                                                      CRE015
      *                                                                                       CRE015
      ** Test cursor                                                                          CRE015
      *                                                                                       CRE015
     C                     EXSR Y8TST                                                         CRE015
      *                                                                                       CRE015
      ** Clear set cursor DDS indicator                                                       CRE015
      *                                                                                       CRE015
     C           WCSRLC    IFEQ 'OFF'                                                         CRE015
     C                     SETOF                     94                                       CRE015
     C                     ENDIF                                                              CRE015
      *                                                                                       CRE015
      ** Update job time                                                                      CRE015
      *                                                                                       CRE015
     C                     TIME           ##JTM                                               CRE015
      *                                                                                       CRE015
      ** Clear messages from program message queue                                            CRE015
      *                                                                                       CRE015
     C                     CALL 'Y2CLMSC'                                                     CRE015
     C                     PARM ##PGM     ZAPGMQ 10                                           CRE015
     C                     PARM '*SAME'   ZAPGRL  5                                           CRE015
      *                                                                                       CRE015
      ** Reset first message only flag                                                        CRE015
      *                                                                                       CRE015
     C                     MOVEL'Y'       ZAFSMS  1                                           CRE015
      *                                                                                       CRE015
      ** Reset global error indicator                                                         CRE015
      *                                                                                       CRE015
     C                     SETOF                         99                                   CRE015
     C           YSETCS    IFEQ 'Y'                                                           CRE015
     C                     EXSR Y9CLR                                                         CRE015
     C                     ENDIF                                                              CRE015
      *================================================================                       CRE015
     CSR         DXEXIT    ENDSR                                                              CRE015
      /EJECT                                                                                  CRE015
     CSR         MXIZ#1    BEGSR                                                              CRE015
      *================================================================                       CRE015
      * Get Field Value from SDACD1PD File                                                    CRE015
      *================================================================                       CRE015
     C           KRTVAC    KLIST                                                              CRE015
     C                     KFLD           PCACCD                                              CRE015
      *                                                                                       CRE015
     C                     MOVEL#1ACCD    PCACCD 10                                           CRE015
     C           KRTVAC    CHAINSDACD1D0             9091                                     CRE015
     C                     MOVELA5ACCD    #1ACCD                                              CRE015
     C           *IN90     IFEQ '1'                                                           CRE015
     C                     MOVE 'O'       #1ATTY                                              CRE015
     C                     MOVE *BLANKS   #1CHIA                                              CRE015
     C                     MOVE *BLANKS   #1RTTY                                              CRE015
     C                     MOVE *BLANKS   #1NCVD                                              CRE015
     C                     MOVE *BLANKS   #1PRFC                                              CRE015
     C                     MOVE *BLANKS   #1RTDN                                              CRE015
     C                     MOVE *BLANKS   #1RTDI                                              CRE015
     C                     ELSE                                                               CRE015
     C                     MOVE A5ATTY    #1ATTY                                              CRE015
     C                     MOVE A5RTTY    #1RTTY                                              CRE015
     C                     MOVE A5NVCD    #1NCVD                                              CRE015
     C                     MOVE A5PRFC    #1PRFC                                              CRE015
     C           A5CHIA    IFEQ *ZERO                                                         CRE015
     C                     MOVE *BLANKS   #1CHIA                                              CRE015
     C                     ELSE                                                               CRE015
     C                     MOVE A5CHIA    #1CHIA                                              CRE015
     C                     ENDIF                                                              CRE015
     C           A5RTDN    IFEQ *ZERO                                                         CRE015
     C                     MOVE *BLANKS   #1RTDN                                              CRE015
     C                     ELSE                                                               CRE015
     C                     MOVE A5RTDN    #1RTDN                                              CRE015
     C                     ENDIF                                                              CRE015
     C           A5RTDI    IFEQ *ZERO                                                         CRE015
     C                     MOVE *BLANKS   #1RTDI                                              CRE015
     C                     ELSE                                                               CRE015
     C                     MOVE A5RTDI    #1RTDI                                              CRE015
     C                     ENDIF                                                              CRE015
     C                     ENDIF                                                              CRE015
      *================================================================                       CRE015
     CSR         MXEXIT    ENDSR                                                              CRE015
      /EJECT                                                                                  CRE015
     CSR         FFDSPV    BEGSR                                                              CRE015
      *================================================================                       CRE015
      * Redisplay Previous Screen                                                             CRE015
      *================================================================                       CRE015
     C   05                MOVEL'R'       W0TRN                                               CRE015
     C   12                MOVEL'P'       W0TRN2                                              CRE015
      *                                                                                       CRE015
     CSR         FFEXIT    ENDSR                                                              CRE015
      *****************************************************************                       CGP001
      /EJECT                                                                                  CGP001
      *****************************************************************                       CGP001
      *                                                               *                       CGP001
      *  SRGPGZ - Gets the Zone via GOGETZONE.                        *                       CGP001
      *                                                               *                       CGP001
      *****************************************************************                       CGP001
     C           SRGPGZ    BEGSR                                                              CGP001
      *                                                                                       CGP001
     C                     CALL GOPGM                                                         CGP001
     C                     PARM *BLANKS   PZRTCD  7                                           CGP001
     C                     PARM *BLANKS   PZERMS 50                                           CGP001
     C                     PARM 'N'       PZFCHK  1                                           CGP001
     C                     PARM *BLANKS   PZZONE 10                                           CGP001
     C                     PARM *BLANKS   PZSHTC  4                                           CGP001
     C                     PARM *ZERO     PZRDNB  50                                          CGP001
     C                     PARM *ZERO     PZDNWD  50                                          CGP001
     C                     PARM *BLANKS   PZBCCY  3                                           CGP001
     C                     PARM *ZERO     PZNJOB  10                                          CGP001
      *                                                                                       CGP001
     C           PZRTCD    IFEQ *BLANKS                                                       CGP001
     C                     MOVE PZZONE    WZONE  10                                           CGP001
     C                     ELSE                                                               CGP001
      *                                                                                       CGP001
     C           PZRTCD    IFEQ '*ERROR'                                                      CGP001
     C                     MOVELGOMSG     PZERMS                                              CGP001
     C                     MOVE *ON       *INU7                                               CGP001
     C                     MOVE *ON       *INU8                                               CGP001
     C                     MOVE *ON       *INLR                                               CGP001
     C                     EXSR *PSSR                                                         CGP001
     C                     ENDIF                                                              CGP001
      *                                                                                       CGP001
     C                     ENDIF                                                              CGP001
      *                                                                                       CGP001
     C                     ENDSR                                                              CGP001
      *****************************************************************                       CGP001
      /EJECT                                                                                  CGP001
      *****************************************************************                       CGP001
      *                                                               *                       CGP001
      *  SRGPAC - Gets the Global Account Codes.                      *                       CGP001
      *           Product and Instrument code overwritten in s/r      *                      BUG2312
      *           SRGPPI from files GPPRDXL0 and GPINSXL0             *                      BUG2312
      *                                                               *                       CGP001
      *****************************************************************                       CGP001
     C           SRGPAC    BEGSR                                                              CGP001
      *                                                                                       CGP001
     C                     MOVE WZONE     KZONE                                               CGP001
     C                     MOVE A5ACCD    KACOD                                               CGP001
      *                                                                                       CGP001
     C********** KGPXR     CHAINGPACDXL0            N46                               CGP001 BUG2312
     C           KGPAC     CHAINGPACDXL0            N46                                      BUG2312
      *                                                                                       CGP001
     C           *IN46     IFEQ *OFF                                                          CGP001
     C                     MOVE ACGACD    #1GACD                                              CGP001
     C                     MOVE ACGPRD    #1PRDC                                              CGP001
     C                     MOVE ACGINS    #1INSC                                              CGP001
     C                     ELSE                                                               CGP001
     C                     MOVE *BLANK    #1GACD                                              TCA105
     C                     MOVE *BLANK    #1PRDC                                              TCA105
     C                     MOVE *BLANK    #1INSC                                              TCA105
     C*********************MOVEL'GPACOD'  DBFILE                                       CGP001 TCA105
     C*********************CAT  'XPD':0   DBFILE                                       CGP001 TCA105
     C*********************MOVELKZONE     DBKEY                                        CGP001 TCA105
     C*********************CAT  KACOD:0   DBKEY                                        CGP001 TCA105
     C*********************MOVEL'03'      DBASE                                        CGP001 TCA105
     C*********************MOVE *ON       *INU7                                        CGP001 TCA105
     C*********************MOVE *ON       *INU8                                        CGP001 TCA105
     C*********************MOVE *ON       *INLR                                        CGP001 TCA105
     C*********************EXSR *PSSR                                                  CGP001 TCA105
     C                     ENDIF                                                              CGP001
      *                                                                                       CGP001
     C                     ENDSR                                                              CGP001
      *****************************************************************                      BUG2312
      /EJECT                                                                                 BUG2312
      *****************************************************************                      BUG2312
      *                                                               *                      BUG2312
      *  SRGPPI - Gets the Global Product and Instrument Codes.       *                      BUG2312
      *                                                               *                      BUG2312
      *****************************************************************                      BUG2312
     C           SRGPPI    BEGSR                                                             BUG2312
      *                                                                                      BUG2312
     C                     MOVE *BLANKS   #1PRDC                                             BUG2312
     C                     MOVE *BLANKS   #1INSC                                             BUG2312
      *                                                                                      BUG2312
     C                     MOVE WZONE     KZONE                                              BUG2312
     C                     MOVE 'GL'      KMOD                                               BUG2312
     C                     MOVEL#1ACCD    KTRTP                                              BUG2312
     C                     MOVE #1ACCD    KTRST                                              BUG2312
      *                                                                                      BUG2312
     C           KGPXR     CHAINGPPRDXL0            N46                                      BUG2312
      *                                                                                      BUG2312
     C           *IN46     IFEQ *OFF                                                         BUG2312
     C                     MOVE PDGPRD    #1PRDC                                             BUG2312
     C                     ENDIF                                                             BUG2312
      *                                                                                      BUG2312
     C           KGPXR     CHAINGPINSXL0            N46                                      BUG2312
      *                                                                                      BUG2312
     C           *IN46     IFEQ *OFF                                                         BUG2312
     C                     MOVE INGINS    #1INSC                                             BUG2312
     C                     ENDIF                                                             BUG2312
      *                                                                                      BUG2312
     C                     ENDSR                                                             BUG2312
      *****************************************************************                       CGP001
      /EJECT                                                                                  CGP001
      *****************************************************************                       CGP001
      *                                                               *                       CGP001
      *  SRGPOF - Opens the Global Processing Cross-Reference Files.  *                       CGP001
      *           Need to open GPPRDXL0 and GPINSXL0 as well.         *                      BUG2312
      *                                                               *                       CGP001
      *****************************************************************                       CGP001
     C           SRGPOF    BEGSR                                                              CGP001
      *                                                                                       CGP001
     C                     Z-ADD80        PLEN   155                                          CGP001
      *                                                                                       CGP001
     C                     DO   3         WIDX    10                                         BUG2312
      *                                                                                      BUG2312
     C**********           MOVE OVRC,1    PCMD   80                                   CGP001 BUG2312
     C                     MOVE OVRC,WIDX PCMD   80                                          BUG2312
      *                                                                                       CGP001
     C                     CALL 'QCMDEXC'                                                     CGP001
     C                     PARM           PCMD                                                CGP001
     C                     PARM           PLEN                                                CGP001
      *                                                                                      BUG2312
     C                     ENDDO                                                             BUG2312
      *                                                                                       CGP001
     C                     OPEN GPACDXL0                                                      CGP001
     C                     OPEN GPPRDXL0                                                     BUG2312
     C                     OPEN GPINSXL0                                                     BUG2312
      *                                                                                       CGP001
     C                     ENDSR                                                              CGP001
      *****************************************************************                       CGP001
      /EJECT
     CSR         CBEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE HELP25    *IN25
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y1SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT2
     C                     EXFMT#RCDDTL1
      * Enable PUTOVR
     C                     SETON                     86
      * Test cursor
     C                     EXSR Y8TST
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CBEXIT    ENDSR
      /EJECT
     CSR         CCDSPV    BEGSR
      *================================================================
      * Redisplay previous screen
      *================================================================
      * USER: Process key screen request
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy Member SD0031EPKR - Account Codes  *
     C*
     C/COPY WNCPYSRC,SD0031EPKR
     C*
     C                     END                             *FI
     C                     MOVEL'USR0790' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C   05                MOVEL'Y'       W0TRN
     C   12                MOVEL'K'       W0TRN
      *================================================================
     CSR         CCEXIT    ENDSR
      /EJECT
     CSR         CFPRSC    BEGSR
      *================================================================
      * Validate record
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
     C                     MOVEL'Y'       W0TRN
      * Validate details
     C                     EXSR DCVLDL
      * QUIT if error:
     C   99                GOTO CFEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       CFEXIT
     C           CRE015    IFEQ 'Y'                                                           CRE015
     C           #1ACTY    ANDEQ'R'                                                           CRE015
     C                     EXSR CXPRTN                                                        CRE015
     C           W0DCF     IFEQ 'Y'                                                           CRE015
     C                     GOTO CFEXIT                                                        CRE015
     C                     ENDIF                                                              CRE015
     C                     ENDIF                                                              CRE015
      * Process record:
     C           *IN12     IFEQ *OFF                                                          CRE015
     C                     EXSR EBPR##
     C                     MOVE 'N'       W0TRN                                               CRE015
     C                     MOVE 'Y'       W0TRN2                                              CRE015
     C                     ENDIF                                                              CRE015
      *================================================================
     CSR         CFEXIT    ENDSR
      /EJECT
     CSR         DCVLDL    BEGSR
      *================================================================
      * Validate details
      *================================================================
      * CALC: Detail screen function fields
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy Member SD0031ESFF - Account Codes  *
     C*
     C/COPY WNCPYSRC,SD0031ESFF
     C*
     C                     END                             *FI
      * USER: Validate detail screen
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
     C/COPY WNCPYSRC,SD0031EC01
      * CASE: WRK.Window processing requir. is Yes
     C           WUWDPR    IFEQ 'Y'                        *IF
      * Start of SAR S01117
      * WM call Window Manager - Window manager  *
     C/COPY WNCPYSRC,WN0481CCP1                                           S01408
      *                                                                                       CER001
     C                     Z-ADD1         SCRN    10                                          CER001
      *                                                                                       CER001
     C           SCRN      DOULT1                                                             CER001
     C           SCRN      ORGT 3                                                             CER001
      *                                                                                       CER001
     C                     MOVE 'N'       W0DCF                                               CER001
     C                     MOVEL#1ACCD    #2ACCD                                              CER001
      *                                                                                       CER001
     C                     SELEC                                                              CER001
     C           SCRN      WHEQ 1                                                             CER001
     C                     EXSR SRLX04                                                        CER001
     C           SCRN      WHEQ 2                                                             CER001
     C                     EXSR SRLX43                                                        CER001
     C           SCRN      WHEQ 3                                                             CER001
     C                     EXSR SRLX52                                                        CER001
     C                     ENDSL                                                              CER001
      *                                                                                       CER001
      ** If enter key pressed                                                                 CER001
      *                                                                                       CER001
     C           W0RTN     IFEQ *BLANKS                                                       CER001
     C                     ADD  1         SCRN                                                CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
      ** If F12 key pressed or window/DB error                                                CER001
      *                                                                                       CER001
     C           W0RTN     IFEQ 'USR0790'                                                     CER001
     C           W0RTN     OREQ 'USR0563'                                                     CER001
     C           W0RTN     OREQ 'Y2U0004'                                                     CER001
     C                     MOVEL'Y'       W0DCF                                               CER001
     C                     SUB  1         SCRN                                                CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
      ** If F3 key pressed                                                                    CER001
      *                                                                                       CER001
     C           W0RTN     IFEQ 'Y2U9999'                                                     CER001
     C                     LEAVE                                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C                     ENDDO                                                              CER001
      *                                                                                       CER001
     C           W0RTN     IFEQ 'Y2U9999'                                                     CER001
     C                     MOVELW0RTN     P0RTN                                               CER001
     C                     MOVEL'Y'       W0DCF                                               CER001
     C                     EXSR ZYEXPG                                                        CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C           ULX004    IFEQ 'Y'                                                           CER001
     C           ULX043    OREQ 'Y'                                                           CER001
     C           ULX053    OREQ 'Y'                                                           CER001
     C           W0RTN     IFNE *BLANKS                                                       CER001
     C                     MOVE 'Y'       W0DCF                                               CER001
     C                     GOTO DCEXIT                                                        CER001
     C                     ENDIF                                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C***********          CALL 'WIND01'                                  S01212
     C                     CALL 'WN0010'                                  S01212
     C*********************PARM           ##PGM            Program        S01212
     C                     PARM ##PGM     UPGM   10        Program        S01212
     C*********************PARM *BLANK    FKEY    2        Function Key   S01212
     C                     PARM *BLANK    UFKEY   2        Function Key   S01212
     C*********************PARM           WUMEST           Action  S01212 S01229
     C*********************PARM           WUWMAC           Action  S01212 S01229
     C                     PARM 'E'       UACTCD  1        Action  S01212 S01229
     C                     PARM           DATA             Trans Data     S01212
     C                     PARM *BLANK    W0RTN            Return Code    S01212
     C                     PARM           SPARE 256        Spare Field    LN0355
      * WM Check Return
      * CASE: PAR.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: PAR.*Return code is WN Window Error
     C           W0RTN     IFEQ 'USR0563'                  *IF
      * Send message 'WN Window Error'
     C                     MOVEL'USR0563' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DCEXIT                     *QUIT
     C                     ELSE
      * CASE: PAR.*Return code is *DBF update error
     C           W0RTN     IFEQ 'Y2U0004'                  *IF
      * Send message 'WN Database Error'
     C                     MOVEL'USR0567' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DCEXIT                     *QUIT
     C                     ELSE
      * CASE: PAR.*Return code is *Previous Screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * End of SAR S01117
      * 00/Copy Member SD0031EVSW - Account Codes  *
     C*
     C/COPY WNCPYSRC,SD0031EVSW
     C*
     C                     END                             *FI
     C                     END                             *FI
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy Member SD0031EVDS - Account Codes  *
     C*
     C/COPY WNCPYSRC,SD0031EVDS
     C*
     C                     END                             *FI
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         EBPR##    BEGSR
      *================================================================
      * Process record:
      *================================================================
      * USER: Perform confirmed action
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy Member SD0031EPCA - Account Codes  *
     C*
     C/COPY WNCPYSRC,SD0031EPCA
     C*
     C                     END                             *FI
      * Quit if error signalled
     C   99                GOTO EBEXIT
      * USER: Process command keys
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy Member SD0031EPCK - Account Codes  *
     C*
     C/COPY WNCPYSRC,SD0031EPCK
     C*
     C                     END                             *FI
      * Start of S01522
      * User Defined Correspondence
      * CASE: WRK.User Defined Correspondnc is Yes
     C           WUN1ST    IFEQ 'Y'                        *IF
      * CASE: DTL.Title Only Indicator is NO
     C           #1TOIN    IFEQ 'N'                        *IF
      *                                                                                     MD062338
      ** Change ZMITEM to UDC Enquiry Menu Item                                             MD062338
     C           *LOCK     IN   ZMITEM                                                      MD062338
     C                     MOVELUDCENQ    INDX                                              MD062338
     C                     OUT  ZMITEM                                                      MD062338
      *                                                                                     MD062338
     C                     MOVEL*BLANK    WURTCD           Return Code wor
      * Call the UDC CL PGM - Account Codes  *
     C                     CALL 'CGC0021'              90  Call the UDC CL
     C           WURTCD    PARM WURTCD    WQ0004  7        Return Code wor
     C                     PARM 'E'       WQ0005  1        Action Code
     C**********           PARM P1ACCD    WQ0006  4        Account Code                       CGL029
     C                     PARM P1ACCD    WQ0006 10                                           CGL029
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CGC0021' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *                                                                                     MD062338
      ** Change ZMITEM back to Account Codes Enquiry Menu Item                              MD062338
     C           *LOCK     IN   ZMITEM                                                      MD062338
     C                     MOVELACCENQ    INDX                                              MD062338
     C                     OUT  ZMITEM                                                      MD062338
      *
      * F3 Processing
      * CASE: WRK.Return Code work field is USER QUIT REQUESTED
     C           WURTCD    IFEQ 'Y2U9999'                  *IF
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * F12 Processing
      * CASE: WRK.Return Code work field is Previous screen
     C           WURTCD    IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * End of S01522
      * Quit if error signalled
     C   99                GOTO EBEXIT
      * Restart program for next record
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         FACKPM    BEGSR
      *================================================================
      * Check passed parameters
      *================================================================
      * Is full key present?
     C           P1ACCD    IFEQ *BLANK                     Account Code
      * Not every key field passed - loop program
     C                     MOVEL'Y'       W0RPT   1
     C                     ELSE
      * Full key passed, so single shot program
     C                     MOVEL'N'       W0RPT
     C                     END
      *================================================================
     CSR         FAEXIT    ENDSR
      /EJECT
     CSR         GADSAK    BEGSR
      *================================================================
      * Set key screen conditioning indicators
      *================================================================
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSAD    BEGSR
      *================================================================
      * Set detail screen conditioning indicators
      *================================================================
      * Protect key fields on detail screen
     C                     SETON                     88    *
     C                     MOVEL'0'       *IN79
     C           WUDMPN    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           WUCMC1    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           WUN3ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL'0'       *IN76
     C********** WUPFMG    IFEQ *BLANK                     *IF            CPB001
     C********** WUPFMG    OREQ 'N'                                       CPB001
     C           WUPFMG    IFNE 'Y'                                       CPB001
     C           WUN4ST    ANDNE'Y'                                       CPB001
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
      *                                                                                       CGL014
     C           CGL014    IFEQ 'Y'                                                           CGL014
     C           CLE025    OREQ 'Y'                                                           CLE025
     C                     MOVE *OFF      *IN76                                               CGL014
     C                     ENDIF                                                              CGL014
      *                                                                                       CGL014
     C                     MOVEL'0'       *IN75
      *                                                                                     MD028343
     C           *IN59     IFEQ '1'                                                         MD028343
     C                     MOVELWWHTX     #1WHTF                                            MD028343
     C                     ENDIF                                                            MD028343
      *                                                                                     MD028343
     C           WUDSWT    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN75
     C                     MOVEL*BLANKS   #1WHTF                                            MD028343
     C                     END                             *FI
      *                                                                                       CDL013
     C           CDL013    IFEQ '1'                                                           CDL013
     C                     MOVE *OFF      *IN83                                               CDL013
     C                     ELSE                                                               CDL013
     C                     MOVE *ON       *IN83                                               CDL013
     C                     ENDIF                                                              CDL013
      *                                                                                       CDL013
     C/COPY WNCPYSRC,SD0031EC07
      * Enable key screen
     C                     SETON                     87    *
      *                                                                CFT002
      *----------------------------------------------------------------CFT002
      * If Decode & Auto Gen Installed, display Vostro and Loro Codes  CFT002
      *                                                                CFT002
     C           CFT002    IFEQ 'Y'                        If Feature OCFT002
     C                     MOVE *ON       *IN74             Set Ind    CFT002
     C                     ELSE                            Else        CFT002
     C                     MOVE *OFF      *IN74             Set Ind    CFT002
     C                     ENDIF                           End If      CFT002
      *                                                                   CPB004
      * If "Acount Closing" is installed                                  CPB004
      *                                                                                       CPB004
     C           WPB004    IFEQ 'Y'                        If Feature                         CPB004
     C                     MOVE *ON       *IN66             Set Ind                           CPB004
     C                     ELSE                            Else                               CPB004
     C                     MOVE *OFF      *IN66             Set Ind                           CPB004
     C                     ENDIF                           End If                             CPB004
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise record - except for key fields and "neither" paramete
      *================================================================
     C                     MOVEL*BLANK    #1ACGC           Midas Export Va
     C                     MOVEL*BLANK    #1MATR           Man A/C Anal Tr
     C                     MOVEL*BLANK    #1FNAC           Funding Account
     C                     MOVEL*BLANK    #1FNBR           Funding Base Ra
     C                     MOVEL*BLANK    #1FNIC           Funding Int A/C
     C                     MOVEL*BLANK    #1FNAA           Funding Accrual
     C                     MOVEL*BLANK    #1CAAC           Capitalise to t
     C                     Z-ADD*ZERO     #1LCD            Last Change Dat
     C                     MOVEL*BLANK    #1TYLC           Type of Last Ch
     C                     MOVEL*BLANK    #1TRFD           A/C transferred
     C                     Z-ADD*ZERO     #1MISU           Min Int subject
     C                     MOVEL*BLANK    #1ACCN           Account Code Na
     C                     MOVEL*BLANK    #1ACTY           Account type
     C                     MOVEL*BLANK    #1VOST           Vostro Account CFT002
     C                     MOVEL*BLANK    #1LORO           Loro Account   CFT002
     C                     MOVEL*BLANK    #1ACST           Account Sub-typ
     C                     MOVEL*BLANK    #1MAPC           Man A/C Anal Pr
     C                     MOVEL*BLANK    #1ACSC           Account Section
     C                     MOVEL*BLANK    #1MABK           Man A/C Anal Bo
     C                     Z-ADD*ZERO     #1ACPR           Acct Post Reten
     C                     MOVEL*BLANK    #1MAAC           Man A/C Anal As
     C                     MOVEL*BLANK    #1TOIN           Title Only Indi
      *
     C                     MOVEL*BLANK    #1NARR           Acct Code Narr CSD005
      *
     C                     MOVEL*BLANK    #1MAPR           Man A/C Anal Pr
     C                     MOVEL*BLANK    #DFLD1           Field one
     C                     MOVEL*BLANK    #1DIAD           Debt Interest A
     C                     MOVEL*BLANK    #DFLD2           Field two
     C                     MOVEL*BLANK    #1DIAC           Debt Interest A
     C                     MOVEL*BLANK    #DFLD3           Field three
     C                     MOVEL*BLANK    #1CIAD           Credit Int. Acc
     C                     MOVEL*BLANK    #DFLD4           Field four
     C                     MOVEL*BLANK    #1CIAC           Credit Int. Acc
     C                     MOVEL*BLANK    #DFLD5           Field five
     C                     MOVEL*BLANK    #1ICID           Interest Capita
     C                     MOVEL*BLANK    #DFLD6           Field six
     C                     MOVEL*BLANK    #1ICIC           Interest Capita
     C                     Z-ADD*ZERO     #1SRLC           Stat Returns BS
     C                     Z-ADD*ZERO     #1SRFC           Stat Returns BS
     C                     MOVEL*BLANK    #1TIAT           TI Account Type
     C                     Z-ADD*ZERO     #1RPCD           Reporting Code
     C                     MOVEL*BLANK    #1INNR           PM Instrument C
     C                     MOVEL*BLANK    #1DIPD           Dr Int pay A/C
     C                     MOVEL*BLANK    #1DIPC           Dr Int pay A/C
     C                     MOVEL*BLANK    #1WTAC           Withholding Tax
     C*                                                                                       CDL013
     C                     MOVEL*BLANK    #1WTCC           WHT Corp. A/CD                     CDL013
     C/COPY WNCPYSRC,SD0031EC08
     C                     MOVEL*BLANK    #1CIPC           Cr Int pay A/C
     C                     MOVEL*BLANK    #DWTSC           Withholding Tax
     C                     MOVEL*BLANK    #1CISU           Cr Int pay A/C
     C                     MOVEL*BLANK    #1CINS           Cr Int pay A/C
      *                                                                   CGL010
      ** Transitory Account Codes                                         CGL010
      *                                                                   CGL010
     C                     MOVEL*BLANKS   DDTRDA                          CGL010
     C                     MOVEL*BLANKS   DDTRCA                          CGL010
     C                     MOVE *BLANKS   #1GACD                                              CGP001
     C                     MOVE *BLANKS   #1PRDC                                              CGP001
     C                     MOVE *BLANKS   #1INSC                                              CGP001
      *                                                                                       CPB004
     C                     MOVEL*BLANK    #1TRAN                                              CPB004
     C           CSD032    IFEQ 'Y'                                                           CSD031
     C                     MOVE *BLANK    #1GPDT                                              CSD031
     C                     MOVEL*BLANKS   #1EACC                                              CSD031
     C                     ENDIF                                                              CSD031
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @A5REA6 fields to screen
      *================================================================
     C                     MOVELA5ACGC    #1ACGC           Midas Export Va
     C                     MOVELA5MATR    #1MATR           Man A/C Anal Tr
     C                     MOVELA5FNAC    #1FNAC           Funding Account
     C                     MOVELA5FNBR    #1FNBR           Funding Base Ra
     C                     MOVELA5FNIC    #1FNIC           Funding Int A/C
     C                     MOVELA5FNAA    #1FNAA           Funding Accrual
     C                     MOVELA5CAAC    #1CAAC           Capitalise to t
     C                     Z-ADDA5LCD     #1LCD            Last Change Dat
     C                     MOVELA5TYLC    #1TYLC           Type of Last Ch
     C                     MOVELA5TRFD    #1TRFD           A/C transferred
     C                     Z-ADDA5MISU    #1MISU           Min Int subject
     C                     MOVELA5ACCD    #1ACCD           Account Code
     C                     MOVELA5ACCN    #1ACCN           Account Code Na
     C                     MOVELA5ACTY    #1ACTY           Account type
     C                     MOVELA5VOST    #1VOST           Vostro Account CFT002
     C                     MOVELA5LORO    #1LORO           Loro Account   CFT002
     C                     MOVELA5ACST    #1ACST           Account Sub-typ
     C                     MOVELA5MAPC    #1MAPC           Man A/C Anal Pr
     C                     MOVELA5ACSC    #1ACSC           Account Section
     C                     MOVELA5MABK    #1MABK           Man A/C Anal Bo
     C                     Z-ADDA5ACPR    #1ACPR           Acct Post Reten
     C                     MOVELA5MAAC    #1MAAC           Man A/C Anal As
     C                     MOVELA5TOIN    #1TOIN           Title Only Indi
      *
     C                     MOVELA5NARR    #1NARR           AccT Code Narr CSD005
      *
     C                     MOVELA5MAPR    #1MAPR           Man A/C Anal Pr
     C                     MOVELA5DIAD    #1DIAD           Debt Interest A
     C                     MOVELA5DIAC    #1DIAC           Debt Interest A
     C                     MOVELA5CIAD    #1CIAD           Credit Int. Acc
     C                     MOVELA5CIAC    #1CIAC           Credit Int. Acc
     C                     MOVELA5ICID    #1ICID           Interest Capita
     C                     MOVELA5ICIC    #1ICIC           Interest Capita
     C                     Z-ADDA5SRLC    #1SRLC           Stat Returns BS
     C                     Z-ADDA5SRFC    #1SRFC           Stat Returns BS
     C                     MOVELA5TIAT    #1TIAT           TI Account Type
     C                     Z-ADDA5RPCD    #1RPCD           Reporting Code
     C                     MOVELA5INNR    #1INNR           PM Instrument C
     C                     MOVELA5DIPD    #1DIPD           Dr Int pay A/C
     C                     MOVELA5DIPC    #1DIPC           Dr Int pay A/C
     C                     MOVELA5WTAC    #1WTAC           Withholding Tax
      *                                                                                       CDL013
     C                     MOVELEACCO     #1WTCC           WHT Corp. A/CD                     CDL013
     C/COPY WNCPYSRC,SD0031EC09
     C                     MOVELA5CIPC    #1CIPC           Cr Int pay A/C
     C                     MOVELA5CISU    #1CISU           Cr Int pay A/C
     C                     MOVELA5CINS    #1CINS           Cr Int pay A/C
     C                     MOVELA5TFCT    #1TFCA           CTI002      /C
      *                                                                                       CSD031
     C           CSD032    IFEQ 'Y'                                                           CSD031
      *                                                                                       CSD031
      *** Convert Effective Date to screen format                                             CSD031
      *                                                                                       CSD031
     C                     CALL 'ZDATE2'                                                      CSD031
     C                     PARM           A5EACC                                              CSD031
     C                     PARM           BJDFIN                                              CSD031
     C                     PARM           ZDATE   60                                          CSD031
     C                     PARM           DATEB   7                                           CSD031
     C                     MOVELDATEB     #1EACC                                              CSD031
     C                     MOVE A5GPDT    #1GPDT                                              CSD031
     C                     ENDIF                                                              CSD031
     C/COPY WNCPYSRC,SD0031EC12
      *                                                                   CGL010
      ** Transitory Account Codes                                         CGL010
      *                                                                   CGL010
     C           A5TRDA    IFGT *ZERO                                     CGL010
     C                     MOVELA5TRDA    DDTRDA                          CGL010
     C                     ENDIF                                          CGL010
     C           A5TRCA    IFGT *ZERO                                     CGL010
     C                     MOVELA5TRCA    DDTRCA                          CGL010
     C                     ENDIF                                          CGL010
      *                                                                                       CGP001
      ** Move the Global Processing fields to screen                                          CGP001
      ** if CGP001 is enabled.                                                                CGP001
      *                                                                                       CGP001
     C           CGP001    IFEQ 'Y'                                                           CGP001
     C                     EXSR SRGPAC                                                        CGP001
     C                     EXSR SRGPPI                                                       BUG2312
     C                     ENDIF                                                              CGP001
      *                                                                                       CPB004
     C           WPB004    IFEQ 'Y'                                                           CPB004
     C                     MOVELA5TRAN    #1TRAN                                              CPB004
     C                     ENDIF                                                              CPB004
      *                                                                                       CPB004
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MDIZ#K    BEGSR
      *================================================================
      * Initialize key screen
      *================================================================
     C                     MOVELP1ACCD    #1ACCD           Account Code
      * USER: Load key screen
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy Member SD0031ELKS - Account Codes  *
     C*
     C/COPY WNCPYSRC,SD0031ELKS
     C*
     C                     END                             *FI
      *================================================================
     CSR         MDEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Get all Midas Modules - MIDAS Modules  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           BGMODS           Modules
      * Move fields to key list
     C                     MOVE *BLANK    BGMODS           Modules
     C                     MOVEL'MMOD'    BGMODS           Modules
     C           KRSSA     CHAIN@BGREC8              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0096' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * Setup message data for message
     C                     MOVEL'SDMMODPD'ZA0001           Filename
      * Send message 'Database Error (ICD)'
     C                     MOVEL'USR0377' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO SAEXIT                     *QUIT
     C                     GOTO SAEXIT
     C                     END
      *
      * USER: Exit processing
      * PAR = DB1 By name
     C                     MOVELBGMTMI    WUMTMI           Midas/Telex Mod
     C                     MOVELBGSWFT    WUSWFT           SWIFT Funds Tra
     C                     MOVELBGSWST    WUSWST           SWIFT Securitie
     C                     MOVELBGSWCL    WUSWCL           SWIFT Customer
     C                     MOVELBGSWSL    WUSWSL           SWIFT Synd Loan
     C                     MOVELBGSWSM    WUSWSM           SWIFT Statement
     C                     MOVELBGSWDL    WUSWDL           SWIFT Dealing
     C                     MOVELBGSDGL    WUSDGL           Standing data/G
     C                     MOVELBGDLFX    WUDLFX           Dealing: FX
     C                     MOVELBGSYLN    WUSYLN           Syndicated Loan
     C                     MOVELBGEXMG    WUEXMG           Exposure Manage
     C                     MOVELBGFNMO    WUFNMO           Financial Model
     C                     MOVELBGSTRT    WUSTRT           Statutory Retur
     C                     MOVELBGCSLN    WUCSLN           Customer Lendin
     C                     MOVELBGRTBN    WURTBN           Retail Banking
     C                     MOVELBGMSDL    WUMSDL           Midas/Swift dir
     C                     MOVELBGSECS    WUSECS           Securities
     C                     MOVELBGAURC    WUAURC           Auto-reconcilia
     C                     MOVELBGBDLI    WUBDLI           Bond Dealers In
     C                     MOVELBGDRSD    WUDRSD           DRS Standing Da
     C                     MOVELBGDRCM    WUDRCM           DRS Control mod
     C                     MOVELBGDRFE    WUDRFE           DRS Foreign Exc
     C                     MOVELBGDRMM    WUDRMM           DRS Money Marke
     C                     MOVELBGDRAR    WUDRAR           DRS Arbitrage
     C                     MOVELBGFDTR    WUFDTR           Funds Transfer
     C                     MOVELBGDRCA    WUDRCA           DRS Common Appl
     C                     MOVELBGFUOP    WUFUOP           Futures & Optio
     C                     MOVELBGMTSL    WUMTSL           Midas/Telex Syn
     C                     MOVELBGMTDL    WUMTDL           Midas/Telex Dea
     C                     MOVELBGMTGL    WUMTGL           Midas/Telex Gen
     C                     MOVELBGMTCL    WUMTCL           Midas/Telex Cus
     C                     MOVELBGNWMI    WUNWMI           Message Managem
     C                     MOVELBGFIIN    WUFIIN           FRA/IRS Indicat
     C                     MOVELBGDLMM    WUDLMM           Dealing: MM
     C                     MOVELBGINCN    WUINCN           Internal Contra
     C                     MOVELBGTRMG    WUTRMG           Treasury Manage
     C                     MOVELBGRKMG    WURKMG           Interest Risk M
     C                     MOVELBGTSKY    WUTSKY           Testkey
     C                     MOVELBGMIDQ    WUMIDQ           Midas/Q
     C                     MOVELBGMFIC    WUMFIC           Microfiche
     C                     MOVELBGIOAC    WUIOAC           Interest on acc
     C                     MOVELBGWDPR    WUWDPR           Window processi
     C                     MOVELBGSARP    WUSARP           SAR's processin
     C                     MOVELBGFRIN    WUFRIN           French return i
     C                     MOVELBGLRIN    WULRIN           Lux return indi
     C                     MOVELBGDRIN    WUDRIN           Dutch return in
     C                     MOVELBGGRIN    WUGRIN           German return i
     C                     MOVELBGBRIN    WUBRIN           Belgian return
     C                     MOVELBGIRIN    WUIRIN           Italian return
     C                     MOVELBGSWEI    WUSWEI           Swift External
     C                     MOVELBGPFMG    WUPFMG           Portfolio Manag
     C                     MOVELBGCRMG    WUCRMG           Credit Manageme
     C                     MOVELBGHORP    WUHORP           Head Office Rep
     C                     MOVELBGAVBL    WUAVBL           Average Balance
     C                     MOVELBGMARG    WUMARG           Margins
     C                     MOVELBGCFMT    WUCFMT           Confirmation Ma
     C                     MOVELBGMIMX    WUMIMX           Mimix
     C                     MOVELBGRCFI    WURCFI           Report Control
     C                     MOVELBGAMIN    WUAMIN           Amps Int
     C                     MOVELBGSWRT    WUSWRT           Swiss Returns
     C                     MOVELBGFLND    WUFLND           Fiduciary Loans
     C                     MOVELBGLMCR    WULMCR           Portfolio Lendi
     C                     MOVELBGCNTX    WUCNTX           Cantonal Tax
     C                     MOVELBGSTDU    WUSTDU           Stamp Duty
     C                     MOVELBGUDRS    WUUDRS           Use DRS Shortna
     C                     MOVELBGCHDL    WUCHDL           Chips Dealing
     C                     MOVELBGCHLN    WUCHLN           Chips Lending
     C                     MOVELBGCHOB    WUCHOB           Chips Opening B
     C                     MOVELBGCHIP    WUCHIP           CHIPS
     C                     MOVELBGCHDI    WUCHDI           Chips Direct Li
     C                     MOVELBGOPDK    WUOPDK           Optical Disk
     C                     MOVELBGMBIN    WUMBIN           Multi-branching
     C                     MOVELBGNNST    WUNNST           Leo Data Nucleu
     C                     MOVELBGNOST    WUNOST           Leo Letters of
     C                     MOVELBGNPST    WUNPST           Leo Collections
     C                     MOVELBGNQST    WUNQST           Leo Bills/Finan
     C                     MOVELBGNRST    WUNRST           Leo Bankers Acc
     C                     MOVELBGNSST    WUNSST           Leo Reimburseme
     C                     MOVELBGNTST    WUNTST           Taxes
     C                     MOVELBGNUST    WUNUST           History & Audit
     C                     MOVELBGNVST    WUNVST           Management Acco
     C                     MOVELBGNWST    WUNWST           IBLC Returns
     C                     MOVELBGNXST    WUNXST           Retail 3
     C                     MOVELBGNYST    WUNYST           Interest on Acc
     C                     MOVELBGNZST    WUNZST           Midas Export Da
     C                     MOVELBGN0ST    WUN0ST           Analytical Acco
     C                     MOVELBGN1ST    WUN1ST           User Defined Co
     C                     MOVELBGN2ST    WUN2ST           Midas-Plato Int
     C                     MOVELBGN3ST    WUN3ST           Midas-Trade Inn
     C                     MOVELBGN4ST    WUN4ST           Private BankingCPB001
     C                     MOVELBGN5ST    WUN5ST           Reserved for La
     C                     MOVELBGN6ST    WUN6ST           Reserved for La
     C                     MOVELBGN7ST    WUN7ST           Reserved for La
     C                     MOVELBGN8ST    WUN8ST           Reserved for La
     C                     MOVELBGN9ST    WUN9ST           Reserved for La
     C                     MOVELBGOAST    WUOAST           Reserved for La
     C                     MOVELBGOBST    WUOBST           Reserved for La
     C                     MOVELBGOCST    WUOCST           Reserved for La
     C                     MOVELBGODST    WUODST           Reserved for La
     C                     MOVELBGOEST    WUOEST           Reserved for La
     C                     MOVELBGOFST    WUOFST           Reserved for La
     C                     MOVELBGOGST    WUOGST           Reserved for La
     C                     MOVELBGOHST    WUOHST           Reserved for La
     C                     MOVELBGOIST    WUOIST           Reserved for La
     C                     MOVELBGOJST    WUOJST           Reserved for La
     C                     MOVELBGOKST    WUOKST           Reserved for La
     C                     MOVELBGOLST    WUOLST           Reserved for La
     C                     MOVELBGOMST    WUOMST           Reserved for La
     C                     MOVELBGONST    WUONST           Reserved for La
     C                     MOVELBGOOST    WUOOST           Reserved for La
     C                     MOVELBGOPST    WUOPST           Reserved for La
     C                     MOVELBGOQST    WUOQST           Reserved for La
     C                     MOVELBGORST    WUORST           Reserved for La
     C                     MOVELBGOSST    WUOSST           Reserved for La
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Get Base Currency - Bank Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           BJBANK           Bank
      * Move fields to key list
     C                     MOVE *BLANK    BJBANK           Bank
     C                     MOVEL'BANK'    BJBANK           Bank
     C           KRSSB     CHAIN@BJREEF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0197' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * Setup message data for message
     C                     MOVEL'SDBANKPD'ZA0002           Filename
      * Send message 'Database Error (ICD)'
     C                     MOVEL'USR0377' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO SBEXIT                     *QUIT
     C                     GOTO SBEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBJCYCD    WUCYCD           Currency Code
     C                     END
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Get Number of Dec Places - Currency Codes  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           A6CYCD           Currency Code
      * Move fields to key list
     C                     MOVELWUCYCD    A6CYCD           Currency Code
     C           KRSSC     CHAIN@A6REA3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0071' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     Z-ADDA6NBDP    WUNBDP           Number of Decim
     C                     END
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Check Profit Centres Used - General Ledger Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           BKGNLG           General Ledger
      * Move fields to key list
     C                     MOVE *BLANK    BKGNLG           General Ledger
     C                     MOVEL'GELR'    BKGNLG           General Ledger
     C           KRSSD     CHAIN@BKREEC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0199' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBKPRCU    WUPRCU           Profit Centres
     C                     END
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Get 'Window required' ind - MIDAS Modules  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           BGMODS           Modules
      * Move fields to key list
     C                     MOVE *BLANK    BGMODS           Modules
     C                     MOVEL'MMOD'    BGMODS           Modules
     C           KRSSE     CHAIN@BGREC8              90    *
      * Data record not found
     C   90                MOVEL'USR0096' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Window processing requir. is Yes
     C           BGWDPR    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUWDPR           Window processi
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Select existing record
      *================================================================
      * Name search required?
     C                     MOVEL#1ACCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Account Code
     C                     CALL 'SD0031S'              90  Select Account
     C                     PARM *BLANK    W0RTN   7
     C********** #1ACCD    PARM #1ACCD    WQ0003  4        Account Code                       CGL029
     C           #1ACCD    PARM #1ACCD    WQ0003 10                                           CGL029
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0031S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y1SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y1EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C           @#DFMT    IFEQ '#RCDKEY'
      * KEY Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     END
     C           @#DFMT    IFEQ '#RCDDTL1'
      * DETAIL Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     END
     C           @#DFMT    IFEQ '#RCDDTL2'                                                    CRE015
      *                                                                                       CRE015
      ** Term & Notice Detail Screen                                                          CRE015
      *                                                                                       CRE015
     C                     Z-ADD@#RWCL    ZINPOS  50                                          CRE015
     C           ZINPOS    DIV  256       W0CRW                                               CRE015
     C                     MVR            W0CCL                                               CRE015
     C                     ENDIF                                                              CRE015
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM 1         YYLGCT  50       # of grps
     C                     PARM W0GRP     YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel and exit from key screen
      *================================================================
      * USER: Exit program processing
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy Member SD0031EEPP - Account Codes  *
     C*
     C/COPY WNCPYSRC,SD0031EEPP
     C*
     C                     END                             *FI
      * CASE: KEY.*CMD key is *Exit
     C           *IN03     IFEQ '1'                        *IF
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      *                                                                                       CGP001
     C           CGP001    IFEQ 'Y'                                                           CGP001
     C                     CLOSEGPACDXL0                                                      CGP001
     C                     ENDIF                                                              CGP001
      *                                                                                       CSD031
     C           CSD032    IFEQ 'Y'                                                           CSD031
     C                     CLOSESDAACDL1                                                      CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CRE015
     C           CRE015    IFEQ 'Y'                                                           CRE015
     C                     CLOSESDACD1L0                                                      CRE015
     C                     ENDIF                                                              CRE015
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
      *                                                                                       CGP001
      ** Global Processing X-Reference Key Defn                                               CGP001
      *                                                                                       CGP001
     C           *LIKE     DEFN WZONE     KZONE                                               CGP001
     C           *LIKE     DEFN A5ACCD    KACOD                                               CGP001
      *                                                                                       CGP001
      ** Global Processing X-Reference Key List                                               CGP001
      *                                                                                       CGP001
     C********** KGPXR     KLIST                                                      CGP001 BUG2312
     C           KGPAC     KLIST                                                             BUG2312
     C                     KFLD           KZONE                                               CGP001
     C                     KFLD           KACOD                                               CGP001
      *                                                                                      BUG2312
      ** The 'real' Global Processing X-Reference Key List                                   BUG2312
      *                                                                                      BUG2312
     C           KGPXR     KLIST                                                             BUG2312
     C                     KFLD           KZONE                                              BUG2312
     C                     KFLD           KMOD    2                                          BUG2312
     C                     KFLD           KTRTP   5                                          BUG2312
     C                     KFLD           KTRST   5                                          BUG2312
      *                                                                                       CGP001
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Setup job date/time
      *
     C                     Z-ADDUDATE     ##JDT
      * Set century digit (If YY prior to 1940 treat as 20YY)
     C           ##JYY     IFLT 40
     C                     Z-ADD1         ##JCC
     C                     ELSE
     C                     Z-ADD0         ##JCC
     C                     END
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Obtain default message file
     C           *NAMVAR   DEFN Y2MGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field S01212
     C                     MOVEL*BLANK    WUMFTS  1
      * Define work field ZALIGN Screen Fun Field
     C                     MOVEL*BLANK    WUZASF 16
      * Define work field ZALIGN No Of Decimals
     C                     Z-ADD*ZERO     WUZAND  10
      * Define work field CRE002
     C                     MOVEL*BLANK    WURAPE  1
      * Define work field Window processing requir.
     C                     MOVEL*BLANK    WUWDPR  1
      * Define work field User Defined Correspondnc
     C                     MOVEL*BLANK    WUN1ST  1
      * Define work field Return Code work field
     C                     MOVEL*BLANK    WURTCD  7
      * Define work field Dsp Man Acc Anl by PC Nar
     C                     MOVEL*BLANK    WUDMPN  1
      * Define work field CMC001
     C                     MOVEL*BLANK    WUCMC1  1
      * Define work field Midas-Trade Innovation If
     C                     MOVEL*BLANK    WUN3ST  1
      * Define work field Portfolio Management
     C                     MOVEL*BLANK    WUPFMG  1
      * Define work field Dsp withholding tax Flds
     C                     MOVEL*BLANK    WUDSWT  1
      * Define work field Midas Run Date
     C                     MOVEL*BLANK    WUMRDT  7
      * Define work field Run day number
     C                     Z-ADD*ZERO     WURDNB  50
      * Define work field Set Up Complete
     C                     MOVEL*BLANK    WUSUC   1
      * Define work field Date format flag
     C                     MOVEL*BLANK    WUDFF   1
      * Define work field Multi-branching Indicator
     C                     MOVEL*BLANK    WUMBIN  1
      * Define work field Midas/Telex Module Ind.
     C                     MOVEL*BLANK    WUMTMI  1
      * Define work field SWIFT Funds Transfer
     C                     MOVEL*BLANK    WUSWFT  1
      * Define work field SWIFT Securities Trading
     C                     MOVEL*BLANK    WUSWST  1
      * Define work field SWIFT Customer Lending
     C                     MOVEL*BLANK    WUSWCL  1
      * Define work field SWIFT Synd Loans (REDUN)
     C                     MOVEL*BLANK    WUSWSL  1
      * Define work field SWIFT Statements
     C                     MOVEL*BLANK    WUSWSM  1
      * Define work field SWIFT Dealing
     C                     MOVEL*BLANK    WUSWDL  1
      * Define work field Standing data/Gen.Ledger
     C                     MOVEL*BLANK    WUSDGL  1
      * Define work field Dealing: FX
     C                     MOVEL*BLANK    WUDLFX  1
      * Define work field Syndicated Loans (REDUN)
     C                     MOVEL*BLANK    WUSYLN  1
      * Define work field Exposure Management
     C                     MOVEL*BLANK    WUEXMG  1
      * Define work field Financial Modeller
     C                     MOVEL*BLANK    WUFNMO  1
      * Define work field Statutory Returns
     C                     MOVEL*BLANK    WUSTRT  1
      * Define work field Customer Lending
     C                     MOVEL*BLANK    WUCSLN  1
      * Define work field Retail Banking
     C                     MOVEL*BLANK    WURTBN  1
      * Define work field Midas/Swift direct link
     C                     MOVEL*BLANK    WUMSDL  1
      * Define work field Securities
     C                     MOVEL*BLANK    WUSECS  1
      * Define work field Auto-reconciliations
     C                     MOVEL*BLANK    WUAURC  1
      * Define work field Bond Dealers Interface
     C                     MOVEL*BLANK    WUBDLI  1
      * Define work field DRS Standing Data
     C                     MOVEL*BLANK    WUDRSD  1
      * Define work field DRS Control module
     C                     MOVEL*BLANK    WUDRCM  1
      * Define work field DRS Foreign Exchange
     C                     MOVEL*BLANK    WUDRFE  1
      * Define work field DRS Money Market
     C                     MOVEL*BLANK    WUDRMM  1
      * Define work field DRS Arbitrage
     C                     MOVEL*BLANK    WUDRAR  1
      * Define work field Funds Transfer
     C                     MOVEL*BLANK    WUFDTR  1
      * Define work field DRS Common Applications
     C                     MOVEL*BLANK    WUDRCA  1
      * Define work field Futures & Options
     C                     MOVEL*BLANK    WUFUOP  1
      * Define work field Midas/Telex Synd. Loans
     C                     MOVEL*BLANK    WUMTSL  1
      * Define work field Midas/Telex Dealing
     C                     MOVEL*BLANK    WUMTDL  1
      * Define work field Midas/Telex Gen. Ledger
     C                     MOVEL*BLANK    WUMTGL  1
      * Define work field Midas/Telex Cust. Lending
     C                     MOVEL*BLANK    WUMTCL  1
      * Define work field Message Management
     C                     MOVEL*BLANK    WUNWMI  1
      * Define work field FRA/IRS Indicator
     C                     MOVEL*BLANK    WUFIIN  1
      * Define work field Dealing: MM
     C                     MOVEL*BLANK    WUDLMM  1
      * Define work field Internal Contracts
     C                     MOVEL*BLANK    WUINCN  1
      * Define work field Treasury Management
     C                     MOVEL*BLANK    WUTRMG  1
      * Define work field Interest Risk Management
     C                     MOVEL*BLANK    WURKMG  1
      * Define work field Testkey
     C                     MOVEL*BLANK    WUTSKY  1
      * Define work field Midas/Q
     C                     MOVEL*BLANK    WUMIDQ  1
      * Define work field Microfiche
     C                     MOVEL*BLANK    WUMFIC  1
      * Define work field Interest on accounts
     C                     MOVEL*BLANK    WUIOAC  1
      * Define work field SAR's processing required
     C                     MOVEL*BLANK    WUSARP  1
      * Define work field French return indicator
     C                     MOVEL*BLANK    WUFRIN  1
      * Define work field Lux return indicator
     C                     MOVEL*BLANK    WULRIN  1
      * Define work field Dutch return indicator
     C                     MOVEL*BLANK    WUDRIN  1
      * Define work field German return indicator
     C                     MOVEL*BLANK    WUGRIN  1
      * Define work field Belgian return indicator
     C                     MOVEL*BLANK    WUBRIN  1
      * Define work field Italian return indicator
     C                     MOVEL*BLANK    WUIRIN  1
      * Define work field Swift External Interface
     C                     MOVEL*BLANK    WUSWEI  1
      * Define work field Credit Management.
     C                     MOVEL*BLANK    WUCRMG  1
      * Define work field Head Office Reporting
     C                     MOVEL*BLANK    WUHORP  1
      * Define work field Average Balances
     C                     MOVEL*BLANK    WUAVBL  1
      * Define work field Margins
     C                     MOVEL*BLANK    WUMARG  1
      * Define work field Confirmation Matching
     C                     MOVEL*BLANK    WUCFMT  1
      * Define work field Mimix
     C                     MOVEL*BLANK    WUMIMX  1
      * Define work field Report Control Facility
     C                     MOVEL*BLANK    WURCFI  1
      * Define work field Amps Int
     C                     MOVEL*BLANK    WUAMIN  1
      * Define work field Swiss Returns
     C                     MOVEL*BLANK    WUSWRT  1
      * Define work field Fiduciary Loans & Deposit
     C                     MOVEL*BLANK    WUFLND  1
      * Define work field Portfolio Lending
     C                     MOVEL*BLANK    WULMCR  1
      * Define work field Cantonal Tax
     C                     MOVEL*BLANK    WUCNTX  1
      * Define work field Stamp Duty
     C                     MOVEL*BLANK    WUSTDU  1
      * Define work field Use DRS Shortnames
     C                     MOVEL*BLANK    WUUDRS  1
      * Define work field Chips Dealing
     C                     MOVEL*BLANK    WUCHDL  1
      * Define work field Chips Lending
     C                     MOVEL*BLANK    WUCHLN  1
      * Define work field Chips Opening Balance
     C                     MOVEL*BLANK    WUCHOB  1
      * Define work field CHIPS
     C                     MOVEL*BLANK    WUCHIP  1
      * Define work field Chips Direct Link
     C                     MOVEL*BLANK    WUCHDI  1
      * Define work field Optical Disk
     C                     MOVEL*BLANK    WUOPDK  1
      * Define work field Leo Data Nucleus
     C                     MOVEL*BLANK    WUNNST  1
      * Define work field Leo Letters of Credit
     C                     MOVEL*BLANK    WUNOST  1
      * Define work field Leo Collections
     C                     MOVEL*BLANK    WUNPST  1
      * Define work field Leo Bills/Financing
     C                     MOVEL*BLANK    WUNQST  1
      * Define work field Leo Bankers Acceptances
     C                     MOVEL*BLANK    WUNRST  1
      * Define work field Leo Reimbursements
     C                     MOVEL*BLANK    WUNSST  1
      * Define work field Taxes
     C                     MOVEL*BLANK    WUNTST  1
      * Define work field History & Audit Facility
     C                     MOVEL*BLANK    WUNUST  1
      * Define work field Management Accounts
     C                     MOVEL*BLANK    WUNVST  1
      * Define work field IBLC Returns
     C                     MOVEL*BLANK    WUNWST  1
      * Define work field Retail 3
     C                     MOVEL*BLANK    WUNXST  1
      * Define work field Interest on Accounts 3
     C                     MOVEL*BLANK    WUNYST  1
      * Define work field Midas Export Data Module
     C                     MOVEL*BLANK    WUNZST  1
      * Define work field Analytical Accounting
     C                     MOVEL*BLANK    WUN0ST  1
      * Define work field Midas-Plato Interface
     C                     MOVEL*BLANK    WUN2ST  1
      * Define work field Reserved for Later Use 41
     C                     MOVEL*BLANK    WUN4ST  1
      * Define work field Reserved for Later Use 42
     C                     MOVEL*BLANK    WUN5ST  1
      * Define work field Reserved for Later Use 43
     C                     MOVEL*BLANK    WUN6ST  1
      * Define work field Reserved for Later Use 44
     C                     MOVEL*BLANK    WUN7ST  1
      * Define work field Reserved for Later Use 45
     C                     MOVEL*BLANK    WUN8ST  1
      * Define work field Reserved for Later Use 46
     C                     MOVEL*BLANK    WUN9ST  1
      * Define work field Reserved for Later Use 47
     C                     MOVEL*BLANK    WUOAST  1
      * Define work field Reserved for Later Use 48
     C                     MOVEL*BLANK    WUOBST  1
      * Define work field Reserved for Later Use 49
     C                     MOVEL*BLANK    WUOCST  1
      * Define work field Reserved for Later Use 50
     C                     MOVEL*BLANK    WUODST  1
      * Define work field Reserved for Later Use 51
     C                     MOVEL*BLANK    WUOEST  1
      * Define work field Reserved for Later Use 52
     C                     MOVEL*BLANK    WUOFST  1
      * Define work field Reserved for Later Use 53
     C                     MOVEL*BLANK    WUOGST  1
      * Define work field Reserved for Later Use 54
     C                     MOVEL*BLANK    WUOHST  1
      * Define work field Reserved for Later Use 55
     C                     MOVEL*BLANK    WUOIST  1
      * Define work field Reserved for Later Use 56
     C                     MOVEL*BLANK    WUOJST  1
      * Define work field Reserved for Later Use 57
     C                     MOVEL*BLANK    WUOKST  1
      * Define work field Reserved for Later Use 58
     C                     MOVEL*BLANK    WUOLST  1
      * Define work field Reserved for Later Use 59
     C                     MOVEL*BLANK    WUOMST  1
      * Define work field Reserved for Later Use 60
     C                     MOVEL*BLANK    WUONST  1
      * Define work field Reserved for Later Use 61
     C                     MOVEL*BLANK    WUOOST  1
      * Define work field Reserved for Later Use 62
     C                     MOVEL*BLANK    WUOPST  1
      * Define work field Reserved for Later Use 63
     C                     MOVEL*BLANK    WUOQST  1
      * Define work field Reserved for Later Use 64
     C                     MOVEL*BLANK    WUORST  1
      * Define work field Reserved for Later Use 65
     C                     MOVEL*BLANK    WUOSST  1
      * Define work field Currency Code
     C                     MOVEL*BLANK    WUCYCD  3
      * Define work field Number of Decimal Places
     C                     Z-ADD*ZERO     WUNBDP  10
      * Define work field SAR number field
     C                     MOVEL*BLANK    WUSARN  6
      * Define work field Access Pgm Return Code
     C                     MOVEL*BLANK    WUAPRC  7
      * Define work field Access obj dummy DS (76)
     C                     MOVEL*BLANK    WUFDY  76
      * Define work field Profit Centres Used
     C                     MOVEL*BLANK    WUPRCU  1
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Open files
     C                     OPEN SD0031E#
     C                     OPEN SDACODL1
     C                     OPEN SDMMODL1
     C                     OPEN SDBANKL1
     C                     OPEN SDCURRL1
     C                     OPEN SDGELRL1
      *                                                                                       CDL013
     C                     OPEN SDACOAL1                                                      CDL013
     C/COPY WNCPYSRC,SD0031EC05
     C                     MOVEL'N'       W0PMT   1
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * Start of S01459
      * Remove the last amend box function.
      * Remove the creation parameters function.
      * SD0031E precompiler - Account Codes  *
      * End of S01459
      * Get Rundate - Rundate  *
     C           *NAMVAR   DEFN           RUNDAT
     C                     IN   RUNDAT
     C                     MOVE MRDT      ##MRDT  7        RUN DATE
     C                     MOVE MRDT      WUMRDT
     C                     MOVE RDNB      WURDNB           RUNDAY NO.
     C                     MOVE SUC       WUSUC            SET UP COMPLT
     C                     MOVE DFF       WUDFF            DTE FMT FLAG
     C                     MOVE MBIN      WUMBIN           MULTI BR. IND
      *                                                                                     MD062338
      ** ZMITEM Data Area                                                                   MD062338
     C           *NAMVAR   DEFN           ZMITEM                                            MD062338
      *                                                                                     MD062338
      * Copyright Statement 1988 - Standard Functions  * copyright
      * Start of S01522
      * Call 'Get all Midas Modules' to retrive the module flags.
      * Get all Midas Modules - MIDAS Modules  *
     C                     EXSR SARVGN
      * End of S01522
      * Start of 063606
      * Get Base Currency - Bank Details  *
     C                     EXSR SBRVGN
      * Get Number of Dec Places - Currency Codes  *
     C                     EXSR SCRVGN
     C                     Z-ADDWUNBDP    WUZAND           ZALIGN No Of De
     C                     MOVEL'N'       WUDSWT           Dsp withholding
      * Start of S01522
      * Called 'Get all Midas Modules' to retrive the module flags.
      * Instead of 'Get Taxes & R3 indicators'
      * start S01413
      * Display or hide Withholding tax fields.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Retail 3 is Yes
      *   |- c2    : WRK.Taxes is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUNXST    IFEQ 'Y'                        *IF
     C           WUNTST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUDSWT           Dsp withholding
     C                     END                             *FI
      * end S01413
      * End of S01522
      * End of 063606
      * Start of S01461
      * Remove the processing for 'Midas export' module.
      * Determine which Midas modules are switched 'on' in the system.
      * Start of S01522
      * Called 'Get all Midas Modules' to retrive the module flags.
      * End of S01522
      * End of S01461
      * Start of S01522
      * Called 'Get all Midas Modules' to retrive the module flags.
      * Instead of 'Get Portfolio Management'
      * Start of S01486
      * End of S01486
      * End of S01522
      *                                                                   CSD005
      *** Move switch into  working field                                 CSD005
      *                                                                   CSD005
     C                     MOVEL'CSD005'  WUSARN           SAR number fielCSD005
      *                                                                   CSD005
      *** Retrieve the status of the switchable feature                   CSD005
      *                                                                   CSD005
     C                     CALL 'AOSARDR0'             90  SAR switched onCSD005
     C           WUAPRC    PARM WUAPRC    WQ0015  7        Access Pgm RetuCSD005
     C                     PARM '*VERIFY' WQ0016  7        Option for ACCOCSD005
     C           WUSARN    PARM WUSARN    WQ0017  6        SAR number fielCSD005
     C                     PARM WUFDY     WQ0018 76        Access obj dummCSD005
      *                                                                   CSD005
      *** If call end in error send error message                         CSD005
      *                                                                   CSD005
     C           *IN90     IFEQ '1'                                       CSD005
      *                                                                   CSD005
     C                     MOVEL'Y2U0032' W0RTN                           CSD005
     C                     MOVEL*BLANKS   W0CLPG 10                       CSD005
     C                     MOVEL'AOSARDR0'W0CLPG                          CSD005
      *
      *** Send message '*Error occured on CALL...'                        CSD005
      *
     C                     MOVEL'Y2U0032' ZAMSID                          CSD005
     C                     MOVEL'Y2USRMSG'ZAMSGF                          CSD005
     C                     MOVELW0CLPG    ZAMSDA           Message data   CSD005
     C                     EXSR ZASNMS                                    CSD005
     C                     ENDIF                                          CSD005
      *                                                                   CSD005
      *** If no error on call then switch on feature indicator            CSD005
      *                                                                   CSD005
     C                     SELEC                                          CSD005
     C           WUAPRC    WHEQ *BLANK                                    CSD005
     C                     MOVE *ON       *IN69                           CSD005
     C           WUAPRC    WHEQ '*NRF'                                    CSD005
     C                     MOVE *OFF      *IN69                           CSD005
     C                     ENDSL                                          CSD005
      *                                                                   CSD005
      *** Move switch into working field                                  CPB004
      *                                                                   CPB004
     C                     MOVEL'CPB004'  WUSARN           SAR number fielCPB004
      *                                                                   CPB004
      *** Retrieve the status of the switchable feature                   CPB004
      *                                                                   CPB004
     C                     CALL 'AOSARDR0'             90  SAR switched onCPB004
     C           WUAPRC    PARM WUAPRC    WQ0146  7        Access Pgm RetuCPB004
     C                     PARM '*VERIFY' WQ0147  7        Option         CPB004
     C           WUSARN    PARM WUSARN    WQ0148  6        SAR number fielCPB004
     C                     PARM WUFDY     WQ0149 76        Access obj dummCPB004
      *                                                                   CPB004
      *** If call end in error send error message                         CPB004
      *                                                                   CPB004
     C           *IN90     IFEQ '1'                                       CPB004
      *                                                                   CPB004
     C                     MOVEL'Y2U0032' W0RTN                           CPB004
     C                     MOVEL*BLANKS   W0CLPG 10                       CPB004
     C                     MOVEL'AOSARDR0'W0CLPG                          CPB004
      *                                                                   CPB004
      *** Send message '*Error occured on CALL...'                        CPB004
      *                                                                   CPB004
     C                     MOVEL'Y2U0032' ZAMSID                          CPB004
     C                     MOVEL'Y2USRMSG'ZAMSGF                          CPB004
     C                     MOVELW0CLPG    ZAMSDA           Message data   CPB004
     C                     EXSR ZASNMS                                    CPB004
     C                     ENDIF                                          CPB004
      *                                                                   CPB004
      *** If no error on call then switch on feature indicator            CPB004
      *                                                                   CPB004
     C                     SELEC                                          CPB004
     C           WUAPRC    WHEQ *BLANK                                    CPB004
     C                     MOVE 'Y'       WPB004  1                       CPB004
     C           WUAPRC    WHEQ '*NRF'                                    CPB004
     C                     MOVE 'N'       WPB004                          CPB004
     C                     ENDSL                                          CPB004
      *                                                                   CPB004
      * Start CAC001 - Profit Centre Accounting.
      * Check to see if CAC001 - Profit Centre Accounting - is present.
     C                     MOVEL'CMC001'  WUSARN           SAR number fiel
      * SAR switched on check - Standard Functions  *
     C                     CALL 'AOSARDR0'             90  SAR switched on
     C           WUAPRC    PARM WUAPRC    WQ0007  7        Access Pgm Retu
     C                     PARM '*VERIFY' WQ0008  7        Option for ACCO
     C           WUSARN    PARM WUSARN    WQ0009  6        SAR number fiel
     C                     PARM WUFDY     WQ0010 76        Access obj dumm
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'AOSARDR0'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Check return code.
      * CASE: WRK.Access Pgm Return Code is *Normal
     C           WUAPRC    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       WUCMC1           CMC001
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUCMC1           CMC001
     C                     END                             *FI
      * Check Profit Centres Used - General Ledger Details  *
     C                     EXSR SDRVGN
      * Set Input/Output indicator for 'Man. Acc. Analysis by Profit Cent
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.CMC001 is Present
      *   |- c2    : WRK.Profit Centres Used is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUCMC1    IFEQ 'Y'                        *IF
     C           WUPRCU    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUDMPN           Dsp Man Acc Anl
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUDMPN           Dsp Man Acc Anl
     C                     END                             *FI
      * End CAC001
      * Start CRE002 - Retail Accruals Processing Enhancement
      * Check if CRE002 - Retail Accruals Processing Enhancement is prese
     C                     MOVEL'CRE002'  WUSARN           SAR number fiel
      * SAR switched on check - Standard Functions  *
     C                     CALL 'AOSARDR0'             90  SAR switched on
     C           WUAPRC    PARM WUAPRC    WQ0011  7        Access Pgm Retu
     C                     PARM '*VERIFY' WQ0012  7        Option for ACCO
     C           WUSARN    PARM WUSARN    WQ0013  6        SAR number fiel
     C                     PARM WUFDY     WQ0014 76        Access obj dumm
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'AOSARDR0'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Check return code.
      * CASE: WRK.Access Pgm Return Code is *Normal
     C           WUAPRC    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       WURAPE           CRE002
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WURAPE           CRE002
     C                     END                             *FI
      * End CRE002
      *-------------------------------------------------------------------CFT002
      * Check if CFT002 - Decode & Auto-Gen STP Processing is present     CFT002
      *                                                                   CFT002
     C                     CALL 'AOSARDR0'                 Rtv SAR        CFT002
     C                     PARM *BLANKS   P@RTCD  7        -B:Return Code CFT002
     C                     PARM '*VERIFY' P@OPTN  7        -I:Action      CFT002
     C                     PARM 'CFT002'  P@SARD  6        -I:SAR Id      CFT002
     C           DSSARD    PARM *BLANKS   DSFDY            -O:Format      CFT002
      *                                                                   CFT002
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -CFT002
      * Check return code.                                                CFT002
      *                                                                   CFT002
     C           P@RTCD    IFEQ *BLANK                     If Feature on  CFT002
     C                     MOVE 'Y'       CFT002  1         Set Flag      CFT002
     C                     ELSE                            Else           CFT002
     C                     MOVE 'N'       CFT002            Set Flag      CFT002
     C                     END                             End If         CFT002
      *                                                                   CFT002
     C                     MOVEL'Y'       WUMFTS           S01212
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * Get 'Window required' ind - MIDAS Modules  *
     C                     EXSR SERVGN
      * Account Data Structure - Account Codes  *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     END                             *FI
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy Member SD0031EFPG - Account Codes  *
      * 00/Copy Member SD0031EEPG - Account Codes  *
      * 00/Copy Member SD0031EIPG - Account Codes  *
      * 00/Copy Member SD0031ECPG - Account Codes  *
     C*
     C/COPY WNCPYSRC,SD0031ECPG
     C*
      * 00/Copy Member SD0031EOPG - Account Codes  *
     C                     END                             *FI
      *                                                                                     MD030956
      ** Access SAR details to see if CTI007 is switched on                                 MD030956
      *                                                                                     MD030956
     C                     CALL 'AOSARDR0'                                                  MD030956
     C                     PARM *BLANKS   P@RTCD                                            MD030956
     C                     PARM '*VERIFY' P@OPTN                                            MD030956
     C                     PARM 'CTI007'  P@SARD                                            MD030956
     C           DSSARD    PARM *BLANKS   DSFDY                                             MD030956
      *                                                                                     MD030956
     C           P@RTCD    IFEQ *BLANKS                                                     MD030956
     C                     MOVE 'Y'       CTI007  1                                         MD030956
     C                     OPEN SDACD1L0                                                    MD030956
     C                     ELSE                                                             MD030956
     C                     MOVE 'N'       CTI007                                            MD030956
     C                     ENDIF                                                            MD030956
      *
      *                                                                                       CTI002
      * Check to see if CTI002 - is present.                                                  CTI002
     C                     MOVEL'CTI002'  WUSARN           SAR number fiel                    CTI002
      * SAR switched on check - Standard Functions  *                                         CTI002
     C                     CALL 'AOSARDR0'             90  SAR switched on                    CTI002
     C           WUAPRC    PARM WUAPRC    WQ0015  7        Access Pgm Retu                    CTI002
     C                     PARM '*VERIFY' WQ0016  7        Option for ACCO                    CTI002
     C           WUSARN    PARM WUSARN    WQ0017  6        SAR number fiel                    CTI002
     C                     PARM WUFDY     WQ0018 76        Access obj dumm                    CTI002
      *                                                                                       CTI002
     C           *IN90     IFEQ '1'                                                           CTI002
      * Call to program ended in error                                                        CTI002
     C                     MOVEL'Y2U0032' W0RTN                                               CTI002
     C                     MOVEL*BLANKS   W0CLPG 10                                           CTI002
     C                     MOVEL'AOSARDR0'W0CLPG                                              CTI002
      * Send message '*Error occured on CALL...'                                              CTI002
     C                     MOVEL'Y2U0032' ZAMSID                                              CTI002
     C                     MOVEL'Y2USRMSG'ZAMSGF                                              CTI002
     C                     MOVELW0CLPG    ZAMSDA           Message data                       CTI002
     C                     EXSR ZASNMS                                                        CTI002
     C                     END                                                                CTI002
      *                                                                                       CTI002
      * Check return code.                                                                    CTI002
      * CASE: WRK.Access Pgm Return Code is *Normal                                           CTI002
      *       AND TRADE INNOVATION ACTIVE                                                     CTI002
     C           WUAPRC    IFEQ *BLANK                     *IF                                CTI002
     C           WUN3ST    ANDEQ'Y'                                                           CTI002
     C           CTI007    OREQ 'Y'                                                         MD030956
     C                     MOVEL'0'       *IN59            CTI002                             CTI002
     C                     MOVELWTFCA     #1WHTF                                            MD028343
     C                     ELSE                                                               CTI002
      * CASE: *OTHERWISE                                                                      CTI002
     C                     MOVEL'1'       *IN59            CTI002                             CTI002
     C                     MOVEL*BLANKS   #1WHTF                                            MD028343
     C                     END                             *FI                                CTI002
      *                                                                   CGL010
      ** Access SAR details to see if CGL010 is switched on               CGL010
     C                     CALL 'AOSARDR0'                                CGL010
     C                     PARM *BLANKS   P@RTCD                          CGL010
     C                     PARM '*VERIFY' P@OPTN                          CGL010
     C                     PARM 'CGL010'  P@SARD                          CGL010
     C           DSSARD    PARM *BLANKS   DSFDY                           CGL010
      *                                                                   CGL010
     C                     MOVE *OFF      *IN60                           CGL010
     C           P@RTCD    IFEQ *BLANKS                                   CGL010
     C                     MOVE *ON       *IN60                           CGL010
     C                     ENDIF                                          CGL010
      *                                                                                       CGL014
     C                     MOVE 'N'       CGL014  1                                           CGL014
      *                                                                                       CGL014
      ** Access SAR details to see if CGL014 is switched on                                   CGL014
      *                                                                                       CGL014
     C                     CALL 'AOSARDR0'                                                    CGL014
     C                     PARM *BLANKS   PRTCD   7                                           CGL014
     C                     PARM '*VERIFY' POPTN   7                                           CGL014
     C                     PARM 'CGL014'  PSARD   6                                           CGL014
     C           DSSARD    PARM *BLANKS   DSFDY                                               CGL014
      *                                                                                       CGL014
     C           PRTCD     IFEQ *BLANKS                                                       CGL014
     C                     MOVE 'Y'       CGL014                                              CGL014
     C                     ENDIF                                                              CGL014
      *                                                                                       CLE025
     C                     MOVE 'N'       CLE025  1                                           CLE025
      *                                                                                       CLE025
      ** Access SAR details to see if CLE025 is switched on                                   CLE025
      *                                                                                       CLE025
     C                     CALL 'AOSARDR0'                                                    CLE025
     C                     PARM *BLANKS   PRTCD                                               CLE025
     C                     PARM '*VERIFY' POPTN                                               CLE025
     C                     PARM 'CLE025'  PSARD                                               CLE025
     C           DSSARD    PARM *BLANKS   DSFDY                                               CLE025
      *                                                                                       CLE025
     C           PRTCD     IFEQ *BLANKS                                                       CLE025
     C                     MOVE 'Y'       CLE025                                              CLE025
     C                     ENDIF                                                              CLE025
      *                                                                                       CLE025
      *                                                                                       CGP001
      ** Check if CGP001 is enabled.                                                          CGP001
      *                                                                                       CGP001
     C           *NAMVAR   DEFN           LDA                                                 CGP001
      *                                                                                       CGP001
     C                     CALL 'AOSARDR0'                                                    CGP001
     C                     PARM *BLANKS   PRTCD   7                                           CGP001
     C                     PARM '*VERIFY' POPTN   7                                           CGP001
     C                     PARM 'CGP001'  PSARD   6                                           CGP001
     C           DSSARD    PARM *BLANKS   DSFDY                                               CGP001
      *                                                                                       CGP001
     C                     MOVE 'N'       CGP001  1                                           CGP001
     C                     MOVE *OFF      *IN68                                               CGP001
     C           PRTCD     IFEQ *BLANKS                                                       CGP001
     C                     MOVE 'Y'       CGP001                                              CGP001
     C                     MOVE *ON       *IN68                                               CGP001
      *                                                                                       CGP001
      ** Open the Global Processing Files.                                                    CGP001
      *                                                                                       CGP001
     C                     EXSR SRGPOF                                                        CGP001
      *                                                                                       CGP001
      ** Get the Zone.                                                                        CGP001
      *                                                                                       CGP001
     C                     EXSR SRGPGZ                                                        CGP001
      *                                                                                       CGP001
     C                     ELSE                                                               CGP001
      *                                                                                       CGP001
     C           PRTCD     IFNE '*NRF'                                                        CGP001
     C                     MOVEL'SCSARDPD'DBFILE                                              CGP001
     C                     MOVEL'CGP001'  DBKEY                                               CGP001
     C                     MOVEL'07'      DBASE                                               CGP001
     C                     MOVE *ON       *INU7                                               CGP001
     C                     MOVE *ON       *INU8                                               CGP001
     C                     MOVE *ON       *INLR                                               CGP001
     C                     EXSR *PSSR                                                         CGP001
     C                     ENDIF                                                              CGP001
      *                                                                                       CGP001
     C                     ENDIF                                                              CGP001
      *                                                                                       CSD031
     C                     MOVE 'N'       CSD032  1                                           CSD031
     C                     MOVE *OFF      *IN80                                               CSD031
     C                     MOVE *OFF      *IN81                                               CSD031
      *                                                                                       CSD031
      ** Access SAR details to see if CSD032 is switched on                                   CSD031
      *                                                                                       CSD031
     C                     CALL 'AOSARDR0'                                                    CSD031
     C                     PARM *BLANKS   PRTCD                                               CSD031
     C                     PARM '*VERIFY' POPTN                                               CSD031
     C                     PARM 'CSD032'  PSARD                                               CSD031
     C           DSSARD    PARM *BLANKS   DSFDY                                               CSD031
      *                                                                                       CSD031
     C           PRTCD     IFEQ *BLANKS                                                       CSD031
     C                     MOVE 'Y'       CSD032                                              CSD031
     C                     MOVE *ON       *IN80                                               CSD031
     C                     OPEN SDAACDL1                                                      CSD031
     C           PMODE     IFEQ 'C'                                                           CSD031
     C                     MOVE *ON       *IN81                                               CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
     C           PRTCD     IFNE *BLANKS                                                       CSD031
     C           PRTCD     ANDNE'*NRF   '                                                     CSD031
     C                     MOVEL'SCSARDPD'DBKEY                                               CSD031
     C                     MOVEL'08'      DBASE                                               CSD031
     C                     EXSR *PSSR                                                         CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      *                                                                                       CER001
      ** Determine if ULX004 is installed                                                     CER001
      *                                                                                       CER001
     C                     CALL 'AOSARDR0'                                                    CER001
     C                     PARM *BLANKS   P@RTCD                                              CER001
     C                     PARM '*VERIFY' P@OPTN                                              CER001
     C                     PARM 'ULX004'  P@SARD                                              CER001
     C           DSSARD    PARM *BLANKS   DSFDY                                               CER001
      *                                                                                       CER001
     C           P@RTCD    IFEQ *BLANK                                                        CER001
     C                     MOVE 'Y'       ULX004  1                                           CER001
     C                     ELSE                                                               CER001
     C                     MOVE 'N'       ULX004                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
      ** Determine if ULX043 is installed                                                     CER001
      *                                                                                       CER001
     C                     CALL 'AOSARDR0'                                                    CER001
     C                     PARM *BLANKS   P@RTCD                                              CER001
     C                     PARM '*VERIFY' P@OPTN                                              CER001
     C                     PARM 'ULX043'  P@SARD                                              CER001
     C           DSSARD    PARM *BLANKS   DSFDY                                               CER001
      *                                                                                       CER001
     C           P@RTCD    IFEQ *BLANK                                                        CER001
     C                     MOVE 'Y'       ULX043  1                                           CER001
     C                     ELSE                                                               CER001
     C                     MOVE 'N'       ULX043                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
      ** Determine if ULX053 is installed                                                     CER001
      *                                                                                       CER001
     C                     CALL 'AOSARDR0'                                                    CER001
     C                     PARM *BLANKS   P@RTCD                                              CER001
     C                     PARM '*VERIFY' P@OPTN                                              CER001
     C                     PARM 'ULX053'  P@SARD                                              CER001
     C           DSSARD    PARM *BLANKS   DSFDY                                               CER001
      *                                                                                       CER001
     C           P@RTCD    IFEQ *BLANK                                                        CER001
     C                     MOVE 'Y'       ULX053  1                                           CER001
     C                     ELSE                                                               CER001
     C                     MOVE 'N'       ULX053                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
      ** Access SAR details to see if CRE015 is switched on                                   CRE015
      *                                                                                       CRE015
     C                     CALL 'AOSARDR0'                                                    CRE015
     C                     PARM *BLANKS   P@RTCD                                              CRE015
     C                     PARM '*VERIFY' P@OPTN                                              CRE015
     C                     PARM 'CRE015'  P@SARD                                              CRE015
     C           DSSARD    PARM *BLANKS   DSFDY                                               CRE015
      *                                                                                       CRE015
     C           P@RTCD    IFEQ *BLANKS                                                       CRE015
     C                     MOVE 'Y'       CRE015  1                                           CRE015
     C                     OPEN SDACD1L0                                                      CRE015
     C                     ELSE                                                               CRE015
     C                     MOVE 'N'       CRE015                                              CRE015
     C                     ENDIF                                                              CRE015
      *                                                                                       CRE015
      ** Access SAR details to see if CGL165 is switched on                                   CGL165
      *                                                                                       CGL165
     C                     CALL 'AOSARDR0'                                                    CGL165
     C                     PARM *BLANKS   P@RTCD                                              CGL165
     C                     PARM '*VERIFY' P@OPTN                                              CGL165
     C                     PARM 'CGL165'  P@SARD                                              CGL165
     C           DSSARD    PARM *BLANKS   DSFDY                                               CGL165
      *                                                                                       CGL165
     C           P@RTCD    IFEQ *BLANKS                                                       CGL165
     C                     MOVE 'Y'       CGL165  1                                           CGL165
     C                     MOVE *ON       *IN93                                               CGL165
     C                     ELSE                                                               CGL165
     C                     MOVE 'N'       CGL165                                              CGL165
     C                     ENDIF                                                              CGL165
      *                                                                                       CGL165
     C/COPY WNCPYSRC,SD0031EC10
      *================================================================
     CSR         ZZEXIT    ENDSR
      *                                                                                       CER001
      /EJECT                                                                                  CER001
      *----------------------------------------------------------------                       CER001
      *  SRLX04 - Display LUX Account Codes 1                                                 CER001
      *----------------------------------------------------------------                       CER001
     C           SRLX04    BEGSR                                                              CER001
     C                     MOVEL#1ACCD    #2ACCD                                              CER001
     C           ULX004    IFEQ 'Y'                                                           CER001
     C                     CALL 'SD0037'                                                      CER001
     C                     PARM           RTCODE  1                                           CER001
     C                     PARM 'E'       ACTION  1                                           CER001
     C                     PARM           DATALX                                              CER001
     C                     PARM           W0RTN                                               CER001
     C                     ENDIF                                                              CER001
     C                     ENDSR                                                              CER001
      *                                                                                       CER001
      /EJECT                                                                                  CER001
      *----------------------------------------------------------------                       CER001
      *  SRLX43 - Display LUX Account Codes 2                                                 CER001
      *----------------------------------------------------------------                       CER001
     C           SRLX43    BEGSR                                                              CER001
     C                     MOVEL#1ACCD    #2ACCD                                              CER001
     C           ULX043    IFEQ 'Y'                                                           CER001
     C                     CALL 'SD0040'                                                      CER001
     C                     PARM           RTCODE                                              CER001
     C                     PARM 'E'       ACTION                                              CER001
     C                     PARM           DATALX                                              CER001
     C                     PARM           W0RTN                                               CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C                     ENDSR                                                              CER001
      /EJECT                                                                                  CER001
      *----------------------------------------------------------------                       CER001
      *  SRLX52 - Midas IBAN related character                                                CER001
      *----------------------------------------------------------------                       CER001
     C           SRLX52    BEGSR                                                              CER001
      *                                                                                       CER001
     C           ULX053    IFEQ 'Y'                                                           CER001
     C                     CALL 'SD0039'                                                      CER001
     C                     PARM           RTCODE                                              CER001
     C                     PARM 'E'       ACTION                                              CER001
     C                     PARM           DATALX                                              CER001
     C                     PARM           W0RTN                                               CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C                     ENDSR                                                              CER001
      /EJECT
     CSR         *PSSR     BEGSR
      *****************************************************************
      *                                                               *
      * *PSSR  - Program exception error routine                      *
      *          Called automatically if a program error occurs,      *
      *          or directly by the program code using EXSR.          *
      *          This subroutine DUMPs the program just once.         *
      *                                                               *
      *****************************************************************
      *
      * Core function specific processing.
      *
     C/COPY WNCPYSRC,SD0031EPSC
      *
      * Start of PSSR user point.
      *
     C/COPY WNCPYSRC,SD0031EPS1
      *
      * Standard Midas PSSR processing.
      *
     C/COPY SDCPYSRC,SDPSSRINT
      *
      * End of PSSR user point.
      *
     C/COPY WNCPYSRC,SD0031EPS2
      *
      *================================================================
     CSR                   ENDSR
      *================================================================
     O*
     O/COPY WNCPYSRC,SD0031EOPG
     O*
** CPY@     : Copyright notice for inclusion in all programs
(c) Finastra International Limited 2001
** OVRC                                                                                       CGP001
OVRDBF FILE(GPACDXL0) TOFILE(GPACODXL0)                                                       CGP001
OVRDBF FILE(GPPRDXL0) TOFILE(GPPRODXL0)                                                      BUG2312
OVRDBF FILE(GPINSXL0) TOFILE(GPINSTXL0)                                                      BUG2312
