     H DATEDIT(*YMD)
      *****************************************************************
/**** *  RPGBASE                                                      *                     MD058755
/*STD *  RPGSQLBND                                                    *                     MD058755
/*EXI *  TEXT('Midas SD Retail trans types aud/req report')           *
     H/TITLE Retail Trans Types Reques Print file
     F*****************************************************************
     F*                                                               *
     F*  Midas - STANDING DATA MODULES
     F*                                                               *
     F*  SD0130P - RETAIL TRANSACTION TYPES Aud/Req Report            *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
     F*      1990,1993                                                *
     F*                                                               *
      *  Last Amend No. MD061008           Date 31Dec21               *
      *  Prev Amend No. CSW101             Date 03Feb23               *
      *                 MD058755           Date 01Sep21               *
      *                 CGL177             Date 25May17               *
      *                 MD046248           Date 27Oct17               *
      *                 CGL154             Date 13Oct14               *
      *                 CER059             Date 19Jul10               *
      *                 CER030             Date 09Jul08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.01 -----------------------------------------------*
      *                 163534             Date 02Jul99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 093698             Date 20Sep95               *
     F*                 CRT001             DATE 31MAR95               *
     F*                 081440             DATE 30JAN95               *
     F*                 S01413             DATE 13APR93               *
     F*                 S01117             DATE 03MAY90               *
     F*                 S01117             DATE 19APR90               *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
      *  MD061008 - Deliverable Data Split for SDFCTLPA and GPFCTLPA  *
      *  CSW101 - PAYplus Interface.                                  *
      *           Recompiled                                          *
      *  MD058755 - Deliverable Data Split for SDRETRPD and TABLETZ   *
      *  CGL177 - CRS Reporting Phase 2                               *
      *  MD046248 - Finastra Rebranding                               *
      *  CGL154 - FATCA Reporting                                     *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER030 - Multicash German Feature                            *
     F*  163534 - Correct printing of the + addition of 4 fields      *
     F*           when RBA is on (CRT002) as per RTS.                 *
     F*  093698 - Increase the range of allowable Retail Transaction  *
     F*           Types.                                              *
     F*  CRT001 - Change of output layout + addition of 4 fields      *
     F*  081440 - List does not show PM fields                        *
     F*  S01413 - Retail 3 Incorporation.                             *
     F*  S01117 - Include Dummy Parameter                             *
     F*  S01117 - Rel 10 Multi-branching changes                      *
     F*                                                               *
     F*****************************************************************
     F* CRTRPGPGM
      *
     H* SYNOPSIS :
     H* - Print report of file contents.
     H* Generated by  : Synon/2  Version:  8646
     H* Function type : Print file  Version:   0.1
      *
     H* Company    : Midas Standing Data
     H* System     : Midas Standing Data
     H* User name  : C7275SYN
     H* Date       : 30/01/90 time: 13:39:45
      *  (c) Finastra International Limited 2001                      *
     H*
      *================================================================
     F* Maintenance   :
      *================================================================
     F********************************************************************
     F*  P R O G R A M     C R E A T I O N     P A R A M E T E R S    *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     F/COPY WNCPYSRC,SD0130PFPG
      *
     F*SDRETRL1* IF   E           K DISK                                                    MD058755
      * RTV: Retail Transaction Types  Retrieval index
      *
     F*SDFCTLL1* IF   E           K DISK                                                    MD061008
      * RTV: Standing Data Controls    Retrieval index
      *
     FSDBANKL1  IF   E           K DISK
      * RTV: Bank Details              Retrieval index
      *
     F*SDFCTLL0* UF   E           K DISK                                                    MD061008
      * UPD: Standing Data Controls    Update index
      *
     FTABTBRE   IF   E             DISK                                         S01413
      * RTV: Retail 3 ICD              Retrieval index                    S01413
     F*SD0130P$O   E             97     PRINTER                           S01117
     FSD0130PM  O    E             PRINTER OFLIND(*IN97)                        S01117
     F                                     INFDS(INFDS$)
      * PRT: Retail Trans Types Reques Print file
      *
     FSDNTTIL0  IF   E           K DISK
      *                                                                                       CER030
      ** Midas Network Transaction Identifier                                                 CER030
      *                                                                                       CER030
     D UAR             S              1    DIM(53)
     D ULN             S              1    DIM(53)
     D UARRAY          S             26    DIM(2) CTDATA PERRCD(1)
      *
      ** SAVE INDICATOR *IN 99
      *
     D/COPY WNCPYSRC,SD0130PEPG
     D @CN             S             25    DIM(11) CTDATA PERRCD(1)             Long constants.
     D/COPY WNCPYSRC,SD0130PIPG
      /EJECT
      * Data structures:-
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Program data structure.
     D JBDTTM          DS
      * Job date/time.
     D  ##JDT                  1      6  0
     D  ##JYY                  1      2  0
     D  ##JMM                  3      4  0
     D  ##JDD                  5      6  0
     D  ##JTM                  7     12  0
     D  ##JHH                  7      8  0
     D  ##JNN                  9     10  0
     D  ##JSS                 11     12  0
     D INFDS$        E DS                  EXTNAME(Y2I$DSP)
      * Printer file information data structure.
      *
     D RUNDAT          DS
     D  MRDT                   1      7
     D  RDNB                   8     10P 0
     D  SUC                   11     11
     D  DFF                   12     12
     D  MBIN                  13     13
      /EJECT
      * Parameter declarations.
     D P1PARM          DS
      * I:    Audit/Request Status Ind
     D  P1ARSI                 1      1
     D*                                                                   S01117
     D P2PARM          DS                                                       S01117
     D* I:    Sequence number                                             S01117
     D  P2RSQN                 1      5                                         S01117
     D*                                                                   S01117
     D P3PARM          DS                                                       S01117
     D* I:    Entity                                                      S01117
     D  P3ENTY                 1      3                                         S01117
     D*                                                                   S01117
     D                 DS
     D  ZAMSDA                 1    132
      * Message data for 'Database Error (ICD)'
      * Filename
     D  ZA0001                 1     10
     D*                                                                   S01413
     D SDMMOD        E DS                  EXTNAME(SDMMODPD)                    S01413
     D*                                                                   S01413
     D**  External DS for Module Details.                                 S01413
     D*                                                                   S01413
     D DSFDY         E DS                  EXTNAME(DSFDY)                       S01413
     D*                                                                   S01413
     D** First DS for access programs, Short data structure               S01413
     D/COPY WNCPYSRC,SD0130PI01
     D*                                                                   S01413
      *                                                                                       CER030
      ** External DS for SAR Details                                                          CER030
      *                                                                                       CER030
     D SCSARD        E DS                  EXTNAME(SCSARDPD)
     D SDRETR        E DS                  EXTNAME(SDRTRJW0)                                MD058755
     D QSDFC1          DS                                                                   MD061008
     D  AHFLNM                 1     10                                                     MD061008
     D  AHNORC                11     13P 0                                                  MD061008
     D  AHNOIN                14     16P 0                                                  MD061008
     D  AHNOAM                17     19P 0                                                  MD061008
     D  AHNODL                20     22P 0                                                  MD061008
      /EJECT
      *****************************************************************
     C     *ENTRY        PLIST                                                  Entry parameter
     C                   PARM                    P0RTN             7            Return code
     C     P1ARSI        PARM                    WP0001            1            Audit/Request S
     C     P2RSQN        PARM                    WP0002            5            Sequence numberS0111
     C                   PARM                    @@PARM            1            Dummy Parm     S0111
     C     P3ENTY        PARM                    WP0003            3            Entity         S0111
      *****************************************************************
      * Initialise
     C                   EXSR      ZZINIT
      *
      * Clear overflow indicator.
     C                   SETOFF                                       97
      * Establish starting position.
     C******LOVAL        SETLL     @A1RECX                                      *           MD058755
     C/EXEC SQL                                                                             MD058755
     C+ declare ACursor insensitive scroll cursor for                                       MD058755
     C+ select * from SDRTRJW0                                                              MD058755
     C+ order by A1RTTY                                                                     MD058755
     C/END-EXEC                                                                             MD058755
                                                                                            MD058755
     C/EXEC SQL                                                                             MD058755
     C+ open ACursor                                                                        MD058755
     C/END-EXEC                                                                             MD058755
                                                                                            MD058755
      * Read first record with user selection.
     C                   EXSR      GARDRC
      * Print null report headings.
     C     W0EOF         IFEQ      '1'
     C                   WRITE     ZZPAGHDR
      * USER: Null report processing
      * 03/COPY RQPFNRP - Retail Transaction Types  *
     C/COPY WNCPYSRC,SD0130PNRP
      * Print 'No records found' + 'No. of Recs. Printed = 0'             CRT001
     C                   MOVE      *ON           *IN76                          No Dtls to Rpt.CRT00
     C                   WRITE     ZZFINTTL                                                    CRT00
     C                   MOVE      *OFF          *IN76                          Rtn 2 StatusQuoCRT00
      *                                                                   CRT001
     C                   WRITE     ZZENDRPT
     C                   ELSE
      * Request all headings.
     C                   MOVEL     'Y'           L0                1            Page headings
      * Initialise final totals.
     C                   MOVEL     *BLANK        ZTCON                          *CON (Screen co
     C                   Z-ADD     *ZERO         ZTNCRC                         No of Calculate
      * Print report body.
     C     W0EOF         DOWEQ     '0'
      **Print*headings.                                                   CRT001
     C***********          EXSR BAPRHD                                    CRT001
      * Print report detail line.
     C                   EXSR      CAPRDT
      * Hold current values.
      * Read next record with user selection.
     C                   EXSR      GARDRC
      * Determine level changes.
     C                   EXSR      DALVCH
      * Print totals.
     C                   EXSR      EAPRTT
      * Process necessary heading requests
     C                   EXSR      FASGHD
     C                   END
     C                   WRITE     ZZENDRPT
     C                   END
      * Exit program.
     C                   MOVEL     *BLANK        P0RTN
     C                   EXSR      ZYEXPG
      *****************************************************************
      /EJECT
     C*R*********BAPRHD    BEGSR                                          CRT001
      ***********======================================================   CRT001
      **Print*report*Headers.                                             CRT001
      ***********======================================================   CRT001
      **Clear*column*headings control flag.                               CRT001
     C***********          MOVEL*BLANK    BAPR    1                       CRT001
      ***********                                                         CRT001
     C***********L0        IFEQ 'Y'                                       CRT001
     C***********          WRITEZZPAGHDR                                  CRT001
     C***********          MOVEL'Y'       BAPR                            CRT001
     C***********          END                                            CRT001
      ***********                                                         CRT001
      ***********======================================================   CRT001
     C*R*********BAEXIT    ENDSR                                          CRT001
      /EJECT
     CSR   CAPRDT        BEGSR
      *================================================================
      * Print report detail line.
      *================================================================
      * Load detail line.
     C                   Z-ADD     A1LCD         XRLCD                          Last Change Dat
     C                   MOVEL     A1TYLC        XRTYLC                         Type of Last Ch
     C                   MOVEL     A1RTTY        XRRTTY                         Retail Transact
     C                   MOVEL     A1RTNM        XRRTNM                         Retail Transact
     C                   MOVEL     A1COIN        XRCOIN                         Customer Origin
     C                   MOVEL     A1DCIN        XRDCIN                         Debit/Credit In
     C                   MOVEL     A1RVIN        XRRVIN                         Reversal Indica
     C                   MOVEL     A1PADI        XRPADI                         Print Advices I
     C                   MOVEL     A1ASGL        XRASGL                         Assoc GL NumberCRT00
     C                   MOVEL     A1PASB        XRPASB                         Passbook Tran  CRT00
     C                   MOVEL     A1CIND        XRCIND                         Cash Indicator CRT00
     C                   MOVEL     A1CLIN        XRCLIN                         Clearing Ind.  CRT00
     C                   MOVEL     *BLANK        XRACDT                         alpha change da
     C                   MOVEL     *BLANK        XRALCH                         alpha of last c
     C                   MOVEL     *BLANK        XRWFFR                         Window Function
     C                   MOVEL     *BLANK        XRWF1R                         Window Function
     C                   MOVEL     *BLANK        XRWF2R                         Window Function
     C                   MOVEL     'Y'           W0PFM
     C                   MOVE      A1RTTY        XRRTTS            5 0          Tran Type Size CRT00
     C     CGL154        IFEQ      'Y'                                                         CGL15
     C     CGL177        OREQ      'Y'                                                         CGL17
     C                   MOVE      A1FTPT        XRFTPT            1            FATCA Pay.Type CGL15
     C                   END                                                                   CGL15
     C*                                                                   S01413
     C** Write Account Commission field if BGNXST & CDTO = 'Y'            S01413
     C*                                                                   S01413
     C     *IN50         IFEQ      '1'                                          *IF            S0141
     C                   MOVEL     A1ACOM        XRACOM                         Account Commis S0141
     C                   ELSE                                                                  S0141
     C                   MOVEL     *BLANKS       XRACOM                                        S0141
     C                   END                                                    *FI            S0141
     C                   MOVEL     A1CPTC        XRCPTC                         Ch. Port. Cap. 08144
     C                   MOVEL     A1PFMC        XRPFMC                         Perf. Category 08144
     C                   MOVEL     A1ATRA        XRAPRA                         Apply to R A/c 08144
      * USER: Process detail record
     C                   MOVEL     P1ARSI        WUARSI                         Audit/Request S
      * Process Detail Rec PRTFIL
     C                   ADD       1             WUWKNB                         work number
      *CASE:     PAR.Audit/Request Status Ind is Audit Mode
     C     WUARSI        IFEQ      @CN(01)                                      *IF
      *CASE:     PAR.Last Change Date NE WRK.run day number
     C     XRLCD         IFNE      WURDNB                                       *IF
     C                   MOVEL     @CN(02)       W0PFM                          *Print format
     C                   END                                                    *FI
     C                   END                                                    *FI
      *CASE:     PGM.*Print format is Print format
     C     W0PFM         IFEQ      @CN(03)                                      *IF
     C                   ADD       1             ZTNCRC                         No of Calculate
      *CASE:*****PAR.No of Calculated Recs is Equal 1                     CRT001
     C***********ZTNCRC    IFEQ 1                          *IF            CRT001
      **Change*Print*Control*to Y - Standing Data Controls  *             CRT001
     C***********                                                         CRT001
     C**Set*Print*Control*To Y To Enable Column Headers To Be             CRT001
     C***********   Printed On First Record..                             CRT001
     C***********                                                         CRT001
     C***********          MOVEL'Y'       BAPR    1                       CRT001
     C***********          END                             *FI            CRT001
     C                   END                                                    *FI
      * Check File Date - Rundate  *
     C                   CALL      'ZDATE2'                             90      Check File Date
     C                   PARM      XRLCD         WQ0001            5 0          Work Midas Date
     C                   PARM      WUDFF         WQ0002            1            date format fla
     C     WUWCDT        PARM      *ZERO         WQ0003            6 0          Work Converted
     C     XRACDT        PARM      *BLANK        WQ0004            7            Work Alpha Date
      *
     C     *IN90         IFEQ      '1'
      * Call to program ended in error.
     C                   MOVEL     'Y2U0021'     W0RTN             7
     C                   END
      *
      * PAR.alpha of last change = Condition name of PAR.Type of Last Change
     C                   CALL      'Y2RVCNR'                            90      *
     C                   PARM                    W0RTN             7            Return code
     C                   PARM      1100584       Y2LSNO            7 0          List number
     C                   PARM      XRTYLC        W0INVL           20            Type of Last Ch
     C                   PARM      ' '           W0VLMP            1            Value mapped?
     C     XRALCH        PARM                    W0CNNM           25            alpha of last c
      *
      * 04/COPY RQPFPDR - Retail Transaction Types  *
     C/COPY WNCPYSRC,SD0130PPDR
     C     W0PFM         IFEQ      'Y'
      **Print*column*headings*if*required.                                CRT001
     C***********BAPR      IFEQ 'Y'                                       CRT001
     C***********          WRITEZZCOLHDG                                  CRT001
     C***********          MOVEL*BLANK    BAPR                            CRT001
     C***********          END                                            CRT001
      * Convert fields to external form.
     C                   MOVEL     '0'           *IN79
     C     XRWFFR        IFEQ      *BLANK                                       *IF
     C                   MOVEL     '1'           *IN79
     C                   END                                                    *FI
     C                   MOVEL     '0'           *IN78
     C     XRWF1R        IFEQ      *BLANK                                       *IF
     C                   MOVEL     '1'           *IN78
     C                   END                                                    *FI
     C                   MOVEL     '0'           *IN77
     C     XRWF2R        IFEQ      *BLANK                                       *IF
     C                   MOVEL     '1'           *IN77
     C                   END                                                    *FI
      *                                                                   CRT001
      * Print ASGL, PASB, CIND & CLIN subject to Transaction Type.        CRT001
      * XRRTTS is XRRTTY but Numeric                                      CRT001
      *                                                                   CRT001
     C                   MOVE      *OFF          *IN54                                         CRT00
     C     XRRTTS        IFGE      99500                                                       CRT00
     C***********XRRTTS    ANDLT99600                               CRT001093698
     C     XRRTTS        ANDLT     99800                                                       09369
     C                   MOVE      *ON           *IN54                                         CRT00
     C                   ENDIF                                                                 CRT00
     C*                                                                   CRT001
      * Print detail line.                                                CRT001
      *                                                                   CRT001
     C                   WRITE     ZZPAGHDR                                                    CRT00
     C                   WRITE     ZZDTLRCD
      *                                                                                       CER030
     C     CGL013        IFEQ      'Y'
     C     CER030        OREQ      'Y'
      *                                                                                       CER030
     C                   MOVEL     'N'           WFIRST            1
     C     *LIKE         DEFINE    A1RTTY        KRTTY
     C                   MOVEL     A1RTTY        KRTTY
     C     KRTTY         SETLL     SDNTTIL0
     C     KRTTY         READE     SDNTTIL0                               52
      *                                                                                       CER030
     C     *IN52         DOWNE     *ON
      *                                                                                       CER030
     C     @$CLN         IFGE      @$OFL
     C                   WRITE     ZZPAGHDR
     C                   WRITE     ZZP1HEDR
     C                   ELSE
      *                                                                                       CER030
     C     WFIRST        IFEQ      'N'
     C                   WRITE     ZZP1HEDR
     C                   MOVE      'Y'           WFIRST
     C                   ENDIF
      *                                                                                       CER030
     C                   ENDIF
      *                                                                                       CER030
     C                   MOVE      NINWRK        RNWRK
     C                   MOVE      NINTTI        RTRANS
     C                   WRITE     ZZP1DETL
     C     KRTTY         READE     SDNTTIL0                               52
      *                                                                                       CER030
     C                   ENDDO
      *                                                                                       CER030
     C                   ENDIF
      *                                                                                       CER030
     C                   END
      *================================================================
     CSR   CAEXIT        ENDSR
      /EJECT
     CSR   DALVCH        BEGSR
      *================================================================
      * Detect level changes.
      *================================================================
      * Clear all level breaks.
     C                   MOVEL     *BLANK        L0                             Page headings
      * Clear heading length to print.
     C                   Z-ADD     *ZERO         @$HDL
      *
      * End of file - Signal all level breaks.
     C     W0EOF         IFEQ      '1'
     C                   ELSE
      * Adjust for column headings.
     C     @$HDL         IFGT      *ZERO
     C                   ADD       3             @$HDL
     C                   END
      *
     C                   END
      *================================================================
     CSR   DAEXIT        ENDSR
      /EJECT
     CSR   EAPRTT        BEGSR
      *================================================================
      * Print report Totals.
      *================================================================
      * Print level break totals as required
      * End of file - Print final totals.
     C     W0EOF         IFEQ      '1'
     C                   MOVEL     'Y'           W0PFM
      * USER: Process End of Report
      *CASE:     CUR.No of Calculated Recs is Compare to Zero
     C     ZTNCRC        IFEQ      *ZERO                                        *IF
     C                   MOVEL     @CN(04)       WUALZR                         Alpha Zero
     C                   END                                                    *FI
      *CASE:     PAR.Audit/Request Status Ind is Audit Mode
     C     P1ARSI        IFEQ      @CN(01)                                      *IF
      * Audit/On-Req RTV on FCTL - Standing Data Controls  *
     C                   EXSR      SARVGN
      *CASE:     WRK.work number NE WRK.No of Records on file
     C     WUWKNB        IFNE      WUNORF                                       *IF
     C                   MOVEL     @CN(02)       WUWFLG                         work flag
     C                   END                                                    *FI
      * Audit printfile override - Standing Data Controls  *
     C                   CALL      'SDC540P'                            90      Audit printfile
     C                   PARM      @CN(07)       WQ0005           10            *PROGRAM
     C                   PARM      WUWFLG        WQ0006            1            work flag
     C                   PARM      WUNORI        WQ0007            5 0          No of Records I
     C                   PARM      WUNORA        WQ0008            5 0          No of Records A
     C                   PARM      WUNORD        WQ0009            5 0          No of records D
     C                   PARM      WUWKNB        WQ0010            5 0          work number
     C                   PARM      WUNORF        WQ0011            5 0          No of Records o
     C                   PARM      WUARTL        WQ0012           53            Audit/Request T
     C                   PARM      WUUNDL        WQ0013           53            Underline
      *
     C     *IN90         IFEQ      '1'
      * Call to program ended in error.
     C                   MOVEL     'Y2U0021'     W0RTN             7
     C                   END
      *
      *CASE:     PGM.*Return code is *Record does not exist
     C     W0RTN         IFEQ      @CN(06)                                      *IF
      * Database Error U7 U8 - Standing Data Controls  *
     C*
     C** DATABASE ERROR, SET ON SWITHES U7 AND U8
     C*
     C                   SETON                                        U7U8
     C*
     C                   ELSE
      *CASE:     WRK.work flag is Incorrect
     C     WUWFLG        IFEQ      @CN(02)                                      *IF
      * File Control Error U8 - Standing Data Controls  *
     C*
     C** FILE CONTROLS OUT OF BALANCE SETON U8
     C*
     C                   SETON                                            U8
     C*
     C                   ELSE
      *CASE:     PGM.*Return code is *Field attribute types EX
     C     W0RTN         IFEQ      @CN(08)                                      *IF
     C                   ELSE
      *CASE:     *OTHERWISE
      * Change Standing Data Cont - Standing Data Controls  *
     C                   EXSR      SBCHRC
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * 05/COPY RQPFPER - Retail Transaction Types  *
     C/COPY WNCPYSRC,SD0130PPER
     C     W0PFM         IFEQ      'Y'
      * If there is not enough space on the
      * physical page for this format:-
     C     @$PGL         SUB       @$CLN         @$WRK
     C     @$WRK         IFLE      5
      * Signal artificial overflow.
     C                   SETON                                        97
      * Print page headers.
     C                   WRITE     ZZPAGHDR
     C                   END
     C                   MOVEL     '0'           *IN76
     C     WUALZR        IFEQ      @CN(04)                                      *IF
     C                   MOVEL     '1'           *IN76
     C                   END                                                    *FI
      * Print format.
     C                   WRITE     ZZFINTTL
     C                   END
     C                   END
      *
      *================================================================
     CSR   EAEXIT        ENDSR
      /EJECT
     CSR   FASGHD        BEGSR
      *================================================================
      * Signal required header formats.
      *================================================================
      * Cascade skip to new page requests upwards.
      *
     C     *IN97         IFNE      '1'
     C     L0            ANDNE     'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line.
     C     W0OFL         SUB       @$CLN         @$WRK
     C     @$WRK         IFLE      @$HDL
     C                   SETON                                        97
     C                   ELSE
      * Signal overflow if requested headings would cause
      * detail format to be printed past end of page
     C                   ADD       5             @$HDL
     C     W0PGL         SUB       @$CLN         @$WRK
     C     @$WRK         IFLE      @$HDL
     C                   SETON                                        97
     C                   END
     C                   END
     C                   END
      * Overflow detected.
     C     *IN97         IFEQ      '1'
      * Request page headings.
     C                   MOVEL     'Y'           L0
      * Request all formats which print on overflow.
     C                   SETOFF                                       97
     C                   END
      *================================================================
     CSR   FAEXIT        ENDSR
      /EJECT
     CSR   GARDRC        BEGSR
      *================================================================
      * Read next record with user selection.
      *================================================================
     C     W0RSL         DOUEQ     'Y'
     C**********         READ      @A1RECX                                90    *           MD058755
     C/EXEC SQL                                                                             MD058755
     C+ fetch next from ACursor into :SDRETR                                                MD058755
     C/END-EXEC                                                                             MD058755
                                                                                            MD058755
     C                   setoff                                       90                    MD058755
     C                   If        SQLCODE = 100                                            MD058755
     C                   seton                                        90                    MD058755
     C                   Endif                                                              MD058755
                                                                                            MD058755
     C                   MOVEL     *IN90         W0EOF             1
      * Quit if no record read.
     C     W0EOF         CABEQ     '1'           GAEXIT
      * Select record unless user action states otherwise.
     C                   MOVEL     'Y'           W0RSL             1
      * USER: Record selection processing
      * 02/COPY RQPFPRSP - Retail Transaction Types  *
     C/COPY WNCPYSRC,SD0130PRSP
     C                   END
      *================================================================
     CSR   GAEXIT        ENDSR
      /EJECT
     CSR   SARVGN        BEGSR
      *================================================================
      * Audit/On-Req RTV on FCTL - Standing Data Controls  *
      *================================================================
     C                   MOVEL     *BLANK        W0RTN             7
      * Define Keylist.
     C     KRSSA         KLIST
     C                   KFLD                    AHFLNM                         Filename
      * Move fields to key list.
     C                   MOVEL     @CN(05)       AHFLNM                         Filename
     C*****KRSSA         CHAIN     @AHREAU                            90        *           MD061008
     C                   CALL      'SD000119'                                               MD061008
     C                   PARM      '*RTV'        ZMODE             4                        MD061008
     C                   PARM                    AHFLNM                                     MD061008
     C                   PARM      0             AHNORC                                     MD061008
     C                   PARM      0             AHNOIN                                     MD061008
     C                   PARM      0             AHNOAM                                     MD061008
     C                   PARM      0             AHNODL                                     MD061008
     C                   PARM      *BLANKS       ZRETRN           10                        MD061008
      *                                                                                     MD061008
     C                   SETOFF                                       90                    MD061008
     C     ZRETRN        IFEQ      '*NRF'                                                   MD061008
     C                   SETON                                        90                    MD061008
     C                   ENDIF                                                              MD061008
      *                                                                                     MD061008
     C     *IN90         IFEQ      '1'
      * DBF Record not found.
     C                   MOVEL     'USR0020'     W0RTN             7
      * USER: Processing if DBF record not found
     C                   MOVEL     @CN(06)       W0RTN                          *Return code
     C                   GOTO      SAEXIT
     C                   END
      *
     C     *IN90         IFEQ      '0'
      * USER: Process DBF record
      * PAR = DB1 By name
     C                   Z-ADD     AHNORC        WUNORF                         No. of Records
     C                   Z-ADD     AHNOIN        WUNORI                         No. of Inserts
     C                   Z-ADD     AHNOAM        WUNORA                         No. of Amends
     C                   Z-ADD     AHNODL        WUNORD                         No. of Deletes
     C                   END
      *================================================================
     CSR   SAEXIT        ENDSR
      /EJECT
     CSR   SBCHRC        BEGSR
      *================================================================
      * Change Standing Data Cont - Standing Data Controls  *
      *================================================================
     C                   MOVEL     *BLANK        W0RTN             7
      * Move key fields to @AHREAU
     C                   MOVEL     @CN(05)       AHFLNM                         Filename
      *
     C     KLCHSB        KLIST
     C                   KFLD                    AHFLNM                         Filename
     C*****KLCHSB        CHAIN     @AHREAU                            9091      *           MD061008
     C                   CALL      'SD000119'                                               MD061008
     C                   PARM      '*RTV'        ZMODE             4                        MD061008
     C                   PARM                    AHFLNM                                     MD061008
     C                   PARM      0             AHNORC                                     MD061008
     C                   PARM      0             AHNOIN                                     MD061008
     C                   PARM      0             AHNOAM                                     MD061008
     C                   PARM      0             AHNODL                                     MD061008
     C                   PARM      *BLANKS       ZRETRN           10                        MD061008
      *                                                                                     MD061008
     C                   SETOFF                                       9091                  MD061008
     C     ZRETRN        IFEQ      '*NRF'                                                   MD061008
     C                   SETON                                        90                    MD061008
     C                   ENDIF                                                              MD061008
     C     ZRETRN        IFEQ      '*ERROR'                                                 MD061008
     C                   SETON                                        91                    MD061008
     C                   ENDIF                                                              MD061008
      *                                                                                     MD061008
      *
     C     *IN90         IFEQ      '1'
      * Record not found.
     C                   MOVEL     'Y2U0009'     W0RTN             7
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID                         Message id.
     C                   MOVEL     'Y2USRMSG'    ZAMSGF                         Message file.
     C                   EXSR      ZASNMS                                       Send message
     C                   GOTO      SBEXIT
     C                   END
      *
     C     *IN91         IFEQ      '1'
      * Record locked.
     C                   MOVEL     'Y2U0004'     W0RTN             7
     C                   GOTO      SBEXIT
     C                   END
      *
      * USER: Processing after DBF read
     C                   ADD       AHNORC        WUNORC                         No. of Records
     C                   ADD       AHNOIN        WUNOIN                         No. of Inserts
     C                   ADD       AHNOAM        WUNOAM                         No. of Amends
     C                   ADD       AHNODL        WUNODL                         No. of Deletes
      * Move Non-key fields to @AHREAU
     C                   Z-ADD     WUNORC        AHNORC                         No. of Records
     C                   Z-ADD     *ZERO         AHNOIN                         No. of Inserts
     C                   Z-ADD     *ZERO         AHNOAM                         No. of Amends
     C                   Z-ADD     *ZERO         AHNODL                         No. of Deletes
      *
     C**********         UPDATE    @AHREAU                              91      *           MD061008
     C                   CALL      'SD000119'                                               MD061008
     C                   PARM      '*UPD'        ZMODE                                      MD061008
     C                   PARM                    AHFLNM                                     MD061008
     C                   PARM                    AHNORC                                     MD061008
     C                   PARM                    AHNOIN                                     MD061008
     C                   PARM                    AHNOAM                                     MD061008
     C                   PARM                    AHNODL                                     MD061008
     C                   PARM      *BLANKS       ZRETRN                                     MD061008
                                                                                            MD061008
     C                   SETOFF                                       91                    MD061008
     C     ZRETRN        IFNE      *BLANKS                                                  MD061008
     C                   SETON                                        91                    MD061008
     C                   ENDIF                                                              MD061008
                                                                                            MD061008
     C     *IN91         IFEQ      '1'
      * Change error detected.
     C                   MOVEL     'Y2U0004'     W0RTN             7
     C                   ELSE
      * DBF Change successful.
     C                   END
      *================================================================
     CSR   SBEXIT        ENDSR
      /EJECT
     CSR   SCRVGN        BEGSR
      *================================================================
      * Get Bank Title - Bank Details  *
      *================================================================
     C                   MOVEL     *BLANK        W0RTN             7
      * Define Keylist.
     C     KRSSC         KLIST
     C                   KFLD                    BJBANK                         Bank
      * Move fields to key list.
     C                   MOVEL     @CN(09)       BJBANK                         Bank
     C     KRSSC         CHAIN     @BJREEF                            90        *
     C     *IN90         IFEQ      '1'
      * DBF Record not found.
     C                   MOVEL     'USR0197'     W0RTN             7
      * USER: Processing if DBF record not found
     C                   MOVEL     @CN(06)       W0RTN                          *Return code
      * Setup message data for message.
     C                   MOVEL     @CN(10)       ZA0001                         Filename
      * Send message 'Database Error (ICD)'
     C                   MOVEL     'USR0377'     ZAMSID                         Message id.
     C                   EXSR      ZASNMS                                       Send message
     C                   SETON                                        99        *
      *
     C                   GOTO      SCEXIT                                       *QUIT
     C                   GOTO      SCEXIT
     C                   END
      *
     C     *IN90         IFEQ      '0'
      * USER: Process DBF record
      * PAR = DB1 By name
     C                   MOVEL     BJURPT        WUURPT                         User Report Tit
     C                   END
      *================================================================
     CSR   SCEXIT        ENDSR
      /EJECT
     CSR   ZASNMS        BEGSR
      *================================================================
      * Send message to program's message queue.
      *================================================================
     C     ZAPGM         IFEQ      *BLANK
     C                   MOVEL     ##PGM         ZAPGM
     C                   END
      * If no message file specified use default.
     C     ZAMSGF        IFEQ      *BLANK
     C                   MOVEL     ZADFMF        ZAMSGF
     C                   END
     C                   CALL      'Y2SNMGC'
     C                   PARM                    ZAPGM            10            Program queue
     C                   PARM                    ZAPGRL            5            Rel queue
     C                   PARM                    ZAMSID            7            Message Id.
     C                   PARM                    ZAMSGF           10            Message file.
     C                   PARM                    ZAMSDA          132            Message data.
     C                   PARM                    ZAMSTP            7            Message type.
      * Clear all fields for default mechanism next time.
     C                   MOVEL     *BLANK        ZAPGM                          Program queue
     C                   MOVEL     *BLANK        ZAPGRL                         Rel queue
     C                   MOVEL     *BLANK        ZAMSID                         Message Id.
     C                   MOVEL     *BLANK        ZAMSGF                         Message file.
     C                   MOVEL     *BLANK        ZAMSDA                         Message data.
     C                   MOVEL     *BLANK        ZAMSTP                         Message type.
      *================================================================
     CSR   ZAEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                   MOVEL     *BLANK        P0RTN
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct.
      *================================================================
     C/EXEC SQL                                                                             MD058755
     C+ close ACursor                                                                       MD058755
     C/END-EXEC                                                                             MD058755
                                                                                            MD058755
      * Terminate program.
     C                   SETON                                        LR
      *
      * Exit program.
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation.
      *================================================================
     C                   MOVE      *BLANK        P0RTN
     C                   MOVE      *BLANK        W0RTN             7
      * Setup job date/time.
     C                   Z-ADD     UDATE         ##JDT                          Job date.
     C                   TIME                    ##JTM                          Job time.
     C                   TIME                    ##TME             6 0          Screen time.
      * Define work field Audit/Request Status Ind
     C                   MOVEL     *BLANK        WUARSI            1
      * Define work field work number
     C                   Z-ADD     *ZERO         WUWKNB            5 0
      * Define work field run day number
     C                   Z-ADD     *ZERO         WURDNB            5 0
      * Define work field date format flag
     C                   MOVEL     *BLANK        WUDFF             1
      * Define work field Work Converted Date
     C                   Z-ADD     *ZERO         WUWCDT            6 0
      * Define work field Alpha Zero
     C                   MOVEL     *BLANK        WUALZR            1
      * Define work field No of Records on file
     C                   Z-ADD     *ZERO         WUNORF            5 0
      * Define work field No of Records Inserted
     C                   Z-ADD     *ZERO         WUNORI            5 0
      * Define work field No of Records Amended
     C                   Z-ADD     *ZERO         WUNORA            5 0
      * Define work field No of records Deleted
     C                   Z-ADD     *ZERO         WUNORD            5 0
      * Define work field work flag
     C                   MOVEL     *BLANK        WUWFLG            1
      * Define work field Audit/Request Title
     C                   MOVEL     *BLANK        WUARTL           53
      * Define work field Underline
     C                   MOVEL     *BLANK        WUUNDL           53
      * Define work field No. of Records
     C                   Z-ADD     *ZERO         WUNORC            5 0
      * Define work field No. of Inserts
     C                   Z-ADD     *ZERO         WUNOIN            5 0
      * Define work field No. of Amends
     C                   Z-ADD     *ZERO         WUNOAM            5 0
      * Define work field No. of Deletes
     C                   Z-ADD     *ZERO         WUNODL            5 0
      * Define work field midas rundate
     C                   MOVEL     *BLANK        WUMRDT            7
      * Define work field Set Up Complete
     C                   MOVEL     *BLANK        WUSUC             1
      * Define work field Multi-branching Indicator
     C                   MOVEL     *BLANK        WUMBIN            1
      * Define work field User Report Title
     C                   MOVEL     *BLANK        WUURPT           53
     C* Define work field ZSFILE error                                    S01117
     C                   MOVEL     *BLANK        WUZSER            1                           S0111
      * Obtain default message file.
     C     *DTAARA       DEFINE    Y2MGFLA       ZADFMF           10
     C                   IN        ZADFMF
     C                   MOVEL     *BLANK        W0PFM             1
     C                   Z-ADD     *ZERO         @$WRK             4 0
     C                   Z-ADD     *ZERO         @$HDL             4 0
      * Adjust page length and overflow as necessary.
     C     @$PGL         SUB       2             W0PGL             4 0
     C     @$OFL         IFGE      W0PGL
     C     W0PGL         SUB       2             W0OFL             4 0
     C                   ELSE
     C                   Z-ADD     @$OFL         W0OFL
     C                   END
      * USER: Initialise program
      * Standard RPG Creation PAR - Standard Functions  *
      * /COPY member Amdt header - Retail Transaction Types  *
      * Get Rundate - Rundate  *
     C     *DTAARA       DEFINE                  RUNDAT
     C                   IN        RUNDAT
     C                   MOVE      MRDT          ##MRDT
     C                   MOVE      MRDT          WUMRDT
     C                   MOVE      RDNB          WURDNB
     C                   MOVE      SUC           WUSUC
     C                   MOVE      DFF           WUDFF
     C                   MOVE      MBIN          WUMBIN
      * Get Title
      * Get Bank Title - Bank Details  *
     C                   EXSR      SCRVGN
      * Move title to header - *Standard header/footer  *
     C* 7.10.89 Missing Source - Inserted During Incorporation            S01216
     C* Move User Report Title into Header Field in DDS for PRTF          S01216
     C*                                                                   S01216
     C                   MOVE      WUURPT        ##URPT                                        S0121
      * Get Narrative Title - Narrative Codes  *
     C     *IN99         IFEQ      '1'
     C                   MOVE      1             UIND              1 0
     C                   SETOFF                                           99
     C                   ELSE
     C                   MOVE      0             UIND
     C                   END
     C*                                                                   S01413
     C** Access Module Details & Retail 3 ICD                             S01413
     C*                                                                   S01413
     C                   CALL      'AOMMODR0'                                                  S0141
     C                   PARM      '*MSG    '    @RTCD             7                           S0141
     C                   PARM      '*FIRST  '    @OPTN             7                           S0141
     C     SDMMOD        PARM      SDMMOD        DSFDY                                         S0141
     C*                                                                   S01413
     C                   READ      TABTBRE                                51                   S0141
     C*                                                                   S01413
     C     BGNXST        IFEQ      @CN(03)                                      *IF            S0141
     C     CDTO          ANDEQ     @CN(03)                                                     S0141
     C                   MOVE      '1'           *IN50                                         S0141
     C                   ELSE                                                                  S0141
     C                   MOVE      '0'           *IN50                                         S0141
     C                   END                                                                   S0141
     C*                                                                   081440
     C** Check that Portfolio Management is installed                     081440
     C*                                                                   081440
     C     BGPFMG        IFEQ      @CN(03)                                                     08144
     C                   MOVE      '1'           *IN52                                         08144
     C                   ELSE                                                                  08144
     C                   MOVE      '0'           *IN52                                         08144
     C                   END                                                                   08144
      *                                                                   CRT001
      **   Retail Teller System, CRT001 present?                          CRT001
      *                                                                   CRT001
     C                   MOVE      *BLANKS       WUAPRC                                        CRT00
      *                                                                   CRT001
     C                   CALL      'AOSARDR0'                                                  CRT00
     C                   PARM                    WUAPRC            7                           CRT00
     C                   PARM      '*VERIFY'     OPTION            7                           CRT00
     C                   PARM      'CRT001'      WUSARN            6                           CRT00
     C                   PARM      *BLANK        RCD3             76                           CRT00
      *                                                                   CRT001
     C     WUAPRC        IFEQ      *BLANK                                                      CRT00
     C                   MOVE      *ON           *IN53                          On if RTS pres.CRT00
     C                   ENDIF                                                                 CRT00
      *                                                                   163534
      **   Retail Branch Access, CRT002 present?                          163534
      *                                                                   163534
     C                   MOVE      *BLANKS       WUAPRC                                        16353
      *                                                                   163534
     C                   CALL      'AOSARDR0'                                                  16353
     C                   PARM                    WUAPRC            7                           16353
     C                   PARM      '*VERIFY'     OPTION            7                           16353
     C                   PARM      'CRT002'      WUSARN            6                           16353
     C                   PARM      *BLANK        RCD3             76                           16353
      *                                                                   163534
     C     WUAPRC        IFEQ      *BLANK                                                      16353
     C                   MOVE      *ON           *IN53                          On if RBA pres.16353
     C                   ENDIF                                                                 16353
     C*                                                                   163534
      *                                                                   CGL154
      ** Check if CGL154 - FATCA Reporting is ON                          CGL154
      *                                                                   CGL154
     C                   MOVE      *BLANKS       WUAPRC                                        CGL15
     C                   MOVE      'N'           CGL154            1                           CGL15
      *                                                                   CGL154
     C                   CALL      'AOSARDR0'                                                  CGL15
     C                   PARM                    WUAPRC            7                           CGL15
     C                   PARM      '*VERIFY'     OPTION            7                           CGL15
     C                   PARM      'CGL154'      WUSARN            6                           CGL15
     C                   PARM      *BLANK        RCD3             76                           CGL15
      *                                                                   CGL154
     C     WUAPRC        IFEQ      *BLANK                                                      CGL15
     C**********           MOVE *ON       *IN55                    CGL154 CGL177
     C                   MOVE      'Y'           CGL154                                        CGL15
     C                   ENDIF                                                                 CGL15
      *                                                                   CGL177
      ** Check if CGL177 - CRS Reporting Phase 2 is ON                    CGL177
      *                                                                   CGL177
     C                   MOVE      *BLANKS       WUAPRC                                        CGL17
     C                   MOVE      'N'           CGL177            1                           CGL17
      *                                                                   CGL177
     C                   CALL      'AOSARDR0'                                                  CGL17
     C                   PARM                    WUAPRC            7                           CGL17
     C                   PARM      '*VERIFY'     OPTION            7                           CGL17
     C                   PARM      'CGL177'      WUSARN            6                           CGL17
     C                   PARM      *BLANK        RCD3             76                           CGL17
      *                                                                   CGL177
     C     WUAPRC        IFEQ      *BLANK                                                      CGL17
     C                   MOVE      'Y'           CGL177                                        CGL17
     C                   ENDIF                                                                 CGL17
      *                                                                   CGL177
     C     CGL154        IFEQ      'Y'                                                         CGL17
     C     CGL177        OREQ      'Y'                                                         CGL17
     C                   MOVE      '1'           *IN55                                         CGL17
     C                   ELSE                                                                  CGL17
     C                   MOVE      '0'           *IN55                                         CGL17
     C                   ENDIF                                                                 CGL17
      *
      ** CALCULATE END OF TEXT POINT
     C                   Z-ADD     1             U                 2 0
     C                   MOVEA     @CN(11)       UAR(U)
     C*
     C     *IN99         DOWEQ     '0'
     C     ' '           LOOKUP    UAR(U)                                 99
     C                   ADD       1             U
     C     UAR(U)        COMP      ' '                                    99
     C                   END
      *
     C**
     C*
     C*          P1LSST    IFEQ 'A'                                       S01216
     C     P1ARSI        IFEQ      'A'                                                         S0121
     C                   MOVEL     UARRAY(1)     UTEMP            26
     C                   MOVEA     UTEMP         UAR(U)
     C                   ADD       26            U
     C                   ELSE
      *
     C                   MOVEA     UARRAY(2)     UAR(U)                         * IF A THIRD
     C                   ADD       7             U                              OPTION TO ARRAY
     C                   END                                                    IS ADDED A
      *                                                    TEMP STORAGE
      *                                                    * IS REQUIRED.
      **  STORE  TEXT IN USTORE FIELD
      *
     C                   MOVEA     UAR           USTORE           53
     C                   MOVE      *BLANKS       UAR
      *
      *
      *
     C     53            SUB       U             UB                2 0
     C     UB            DIV       2             UB
     C                   MVR                     UR                1 0
     C     UB            ADD       U             U
     C     U             SUB       1             U
      *
      *
      **  INSERT UNDERLINE TO ARRAY
      **
     C                   MOVEA     *ALL'-'       ULN(UB)
     C                   MOVEA     *BLANKS       ULN(U)
      *
      *
     C     UB            IFGT      0
     C                   MOVEA     USTORE        UAR(UB)
     C                   ELSE
     C                   MOVEA     USTORE        UAR
     C                   END
      *
      **  MOVE ARRAY VALUE  TO SCREEN TEXT FIELD
      *
     C*                    MOVEAUAR       ##EYTX                          S01216
     C                   MOVEA     UAR           ##ARTL           53                           S0121
     C*                    MOVEAUAR       WUEYTX
     C                   MOVEA     UAR           WUARTL
     C*                    MOVEAULN       ##BJNA                          S01216
     C                   MOVEA     ULN           ##UNDL           53                           S0121
     C                   MOVEA     ULN           WUUNDL
      *
      *
      ** RESET INDICATOR *IN 99
      *
     C     UIND          IFEQ      1
     C                   SETON                                            99
     C                   ELSE
     C                   SETOFF                                           99
     C                   END
     C*
     C** Set up spool file number - Standard functions *                  S01117
     C*                                                                   S01117
     C                   Z-ADD     @$FNB         WUSFNB            6 0                         S0111
     C*                                                                   S01117
     C** ZSFILE - write report rqs - Standard functions *                 S01117
     C*                                                                   S01117
     C                   CALL      'ZSFILE'                             90                     S0111
     C                   PARM      P2RSQN        UURSQN            5            RCF seq no.    S0111
     C                   PARM      P3ENTY        UUENTY            3            Entity         S0111
     C                   PARM      @$FVN         UUSFNM           10            Spool file nameS0111
     C                   PARM      WUSFNB        UUSFNB            6 0          Spool file no. S0111
     C     WUZSER        PARM      *BLANK        UUZSER            1            ZSFILE error   S0111
     C*                                                                   S01117
     C** Call to program ended in error                                   S01117
     C*                                                                   S01117
     C     *IN90         IFEQ      '1'                                                         S0111
     C                   MOVEL     'Y2U0021'     W0RTN             7                           S0111
     C                   END                                                                   S0111
     C*                                                                   S01117
     C** CASE: WRK.ZSFILE is error occurred                               S01117
     C*                                                                   S01117
     C     WUZSER        IFEQ      'Y'                                                         S0111
     C                   MOVEL     'Y2U0004'     P0RTN                                         S0111
     C                   EXSR      ZYEXPG                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01117
      *                                                                                       CER030
      ** Check the switchable feature CER030                                                  CER030
      *                                                                                       CER030
     C                   CALL      'AOSARDR0'
     C                   PARM      *BLANKS       PRTCD             7
     C                   PARM      '*VERIFY'     POPTN             7
     C                   PARM      'CER030'      PSARD             6
     C     SCSARD        PARM      SCSARD        DSFDY
      *                                                                                       CER030
     C     PRTCD         IFEQ      *BLANKS
     C                   MOVEL     'Y'           CER030            1
     C                   ELSE
     C                   MOVEL     'N'           CER030
     C                   ENDIF
      *                                                                                       CER030
      ** Check the switchable feature CGL013                                                  CER030
      *                                                                                       CER030
     C                   CALL      'AOSARDR0'
     C                   PARM      *BLANKS       PRTCD
     C                   PARM      '*VERIFY'     POPTN
     C                   PARM      'CGL013'      PSARD
     C     SCSARD        PARM      SCSARD        DSFDY
      *                                                                                       CER030
     C     PRTCD         IFEQ      *BLANKS
     C                   MOVEL     'Y'           CGL013            1
     C                   ELSE
     C                   MOVEL     'N'           CGL013
     C                   ENDIF
      *
      * 01/COPY  RQPFPFPG - Retail Transaction Types  *
     C/COPY WNCPYSRC,SD0130PCPG
      *================================================================
     CSR   ZZEXIT        ENDSR
     O/COPY WNCPYSRC,SD0130POPG
**   ARRAY ENTRIES FOR REPORT TITLE
MAINTENANCE - AUDIT REPORT
LISTING
** @CN Long constants used in program.
A
N
Y
0
SDRETRPD                                                                  S01117
Y2U0005
SD0130AU                                                                  S01117
Y2U0021
BANK
SDBANKPD
RETAIL TRANSACTION
