     H        1   Y
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas SD Display all holidays')
      *****************************************************************
      *                                                               *
      *  Midas - Standing Data Module                                 *
      *                                                               *
      *  SD0160D - Display all holidays.                              *
      *                                                               *
      *  Function:  This program displays all holidays in the         *
      *             system.                                           *
      *  (phase(s))                                                   *
      *                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. MD050882           Date 23Jun23               *
      *  Prev Amend No. MD056853           Date 29Sep20               *
      *                 MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 BUG11788           Date 01Aug06               *
      *                 BUG11787           Date 27Jul06               *
      *                 BUG11709           Date 17Jun06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CGL029             Date 01Sep03               *
      *                 CSD012             Date 15Oct02               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.03 -----------------------------------------------*
      *                 CSD003             Date 01Jul99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 084942             DATE 20JUN95               *
      *                 S01459             DATE 20JUN95               *
      *                 028323             DATE 08APR93               *
      *                 LN0168             DATE 26JUN90               *
      *                                                               *
      *****************************************************************
      *                                                               *
      *  MD050882 - Add authorization step to 'Delete by Year' action *
      *  MD056853 - Recompiled over changed SD0160D#.                 *
      *  MD046248 - Finastra Rebranding                               *
      *  BUG11788 - Effective date not update in zonal list view      *
      *  BUG11787 - Accepted holiday previously pending in F11        *
      *             was not reflected in zonal listview               *
      *  BUG11709 - DB error encountered upon entering the program.   *
      *             Put back SDHOLL8 when loading records in subfile. *
      *  CSD031 - Enhanced Centralised Static Data                    *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CSD012 - Standing Data Authorisation.                        *
      *  CSD003 - Synon Closedown Project (SD):                       *
      *           - Program removed from SD model.                    *
      *  084942 - Allow deletion of holidays in future.               *
      *  S01459 - Addition of PSSR and midas header box.              *
      *  028323 - REMOVE APOSTOPHE FROM SCREEN TITLE.                 *
      *  LN0168 - SET SCAN LIMIT TO 99999.                            *
      *                                                               *
      *****************************************************************
     F/COPY WNCPYSRC,SD0160DFPG
     FSD0160D#CF  E                    WORKSTN                        UC
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
     F                                              KINFSR *PSSR
      * DSP: Midas SD Display all holidays
      *
     F*SDHOLL8*IF  E           K        DISK                           UC                     CSD031
     F*********                                     KINFDS INFDS1                             CSD031
     F*********                                     KINFSR *PSSR                              CSD031
     FSDHOLL8 IF  E           K        DISK                           UC                    BUG11709
     F                                              KINFDS INFDS1                           BUG11709
     F                                              KINFSR *PSSR                            BUG11709
      * RSQ : Midas SD Holidays test access path
      *
     FGPHOLIL1IF  E           K        DISK                           UC                      CSD031
     F            GPHOLID0                          KRENAMEGPHOL1                             CSD031
     F                                              KINFSR *PSSR                              CSD031
      * RSQ : Midas SD Holidays                                                               CSD031
      *                                                                                       CSD031
     FSDHOLL0 UF  E           K        DISK                      A    UC                      CSD031
     F                                              KCOMIT                                    CSD031
     F            @HOLPHG                           KRENAMESDHOL0                             CSD031
     F                                              KINFSR *PSSR                              CSD031
      * RSQ : Midas SD Holidays                                                               CSD031
      *                                                                                       CSD031
     FSDHOLL3 IF  E           K        DISK                           UC
     F                                              KINFDS ID0001
     F                                              KINFSR *PSSR
      * RSQ : Midas SD Holidays non-global holiday check
      *                                                                                       CSD012
     FSDAULGL0IF  E           K        DISK                                                   CSD012
      * RTV : Authorisation Log - by Key                                                      CSD012
      *
     FSDAHDYL0UF  E           K        DISK                           UC                      CSD031
     F            SDHOLD0                           KRENAMESDAHL0                             CSD031
     F                                              KINFSR *PSSR                              CSD031
      * RSQ : Holidays Acceptance file                                                        CSD031
      *                                                                                       CSD031
     FSDAHDYL1IF  E           K        DISK                           UC                      CSD031
     F            SDAHDYD0                          KRENAMESDAHL1                             CSD031
     F                                              KINFSR *PSSR                              CSD031
      * RSQ : Holidays Acceptance file                                                        CSD031
      *                                                                                       CSD031
     FSDAHDYL7IF  E           K        DISK                           UC                      CSD031
     F            SDAHDYD0                          KRENAMESDAHL7                             CSD031
     F                                              KINFSR *PSSR                              CSD031
      * RSQ : Holidays Acceptance file                                                        CSD031
      *                                                                                       CSD031
     FSDAHDYL3IF  E           K        DISK                           UC                      CSD031
     F            SDAHDYD0                          KRENAMESDAHL3                             CSD031
     F                                              KINFSR *PSSR                              CSD031
      * RSQ : Holidays Acceptance file                                                        CSD031
      *                                                                                       CSD031
     FSDFCTLL0UF  E           K        DISK                           UC                      CSD031
     F                                              KCOMIT                                    CSD031
     F                                              KINFDS ID0007                             CSD031
     F                                              KINFSR *PSSR                              CSD031
     E* Description     : Copyright notice for inclusion in all programs
     E*
     E********************************************************************
     E                    CPY@    1   1 80               Copyright array
     E                    MMM    12  12  3                                                    CSD031
     E/COPY ZSRSRC,ZDATE1Z1                                                                   CSD031
     E* MOVE A BLANK STRING INTO THE DISPLAY FILE'S FOOTER DEPENDING   ON THE
     E* MODE
     E                    CTX1    1   1 78
     I@HOLPH1
      * Midas SD Holidays non-global holiday check
      * Renamed input format fields
     I              DGCYCD                          WACYCD
     I              DGLCCD                          WALCCD
     I              DGYRNB                          WAYRNB
      /EJECT                                                                                  CSD031
      *                                                                                       CSD031
      ** Data Structure for SDHOLL0                                                           CSD031
      *                                                                                       CSD031
     ISDHOL0                                                                                  CSD031
     I              DGCYCD                          WGCYCD                                    CSD031
     I              DGLCCD                          WGLCCD                                    CSD031
     I              DGYRNB                          WGYRNB                                    CSD031
     I              DGJDNB                          WGJDNB                                    CSD031
     I              DGDDNB                          WGDDNB                                    CSD031
     I              DGJA01                          WGJA01                                    CSD031
     I              DGJA02                          WGJA02                                    CSD031
     I              DGJA03                          WGJA03                                    CSD031
     I              DGJA04                          WGJA04                                    CSD031
     I              DGJA05                          WGJA05                                    CSD031
     I              DGJA06                          WGJA06                                    CSD031
     I              DGJA07                          WGJA07                                    CSD031
     I              DGJA08                          WGJA08                                    CSD031
     I              DGJA09                          WGJA09                                    CSD031
     I              DGJA10                          WGJA10                                    CSD031
     I              DGJA11                          WGJA11                                    CSD031
     I              DGJA12                          WGJA12                                    CSD031
     I              DGJA13                          WGJA13                                    CSD031
     I              DGJA14                          WGJA14                                    CSD031
     I              DGJA15                          WGJA15                                    CSD031
     I              DGJA16                          WGJA16                                    CSD031
     I              DGJA17                          WGJA17                                    CSD031
     I              DGJA18                          WGJA18                                    CSD031
     I              DGJA19                          WGJA19                                    CSD031
     I              DGJA20                          WGJA20                                    CSD031
     I              DGJA21                          WGJA21                                    CSD031
     I              DGJA22                          WGJA22                                    CSD031
     I              DGJA23                          WGJA23                                    CSD031
     I              DGJA24                          WGJA24                                    CSD031
     I              DGJA25                          WGJA25                                    CSD031
     I              DGJA26                          WGJA26                                    CSD031
     I              DGJA27                          WGJA27                                    CSD031
     I              DGJA28                          WGJA28                                    CSD031
     I              DGJA29                          WGJA29                                    CSD031
     I              DGJA30                          WGJA30                                    CSD031
     I              DGJA31                          WGJA31                                    CSD031
     I              DGFE01                          WGFE01                                    CSD031
     I              DGFE02                          WGFE02                                    CSD031
     I              DGFE03                          WGFE03                                    CSD031
     I              DGFE04                          WGFE04                                    CSD031
     I              DGFE05                          WGFE05                                    CSD031
     I              DGFE06                          WGFE06                                    CSD031
     I              DGFE07                          WGFE07                                    CSD031
     I              DGFE08                          WGFE08                                    CSD031
     I              DGFE09                          WGFE09                                    CSD031
     I              DGFE10                          WGFE10                                    CSD031
     I              DGFE11                          WGFE11                                    CSD031
     I              DGFE12                          WGFE12                                    CSD031
     I              DGFE13                          WGFE13                                    CSD031
     I              DGFE14                          WGFE14                                    CSD031
     I              DGFE15                          WGFE15                                    CSD031
     I              DGFE16                          WGFE16                                    CSD031
     I              DGFE17                          WGFE17                                    CSD031
     I              DGFE18                          WGFE18                                    CSD031
     I              DGFE19                          WGFE19                                    CSD031
     I              DGFE20                          WGFE20                                    CSD031
     I              DGFE21                          WGFE21                                    CSD031
     I              DGFE22                          WGFE22                                    CSD031
     I              DGFE23                          WGFE23                                    CSD031
     I              DGFE24                          WGFE24                                    CSD031
     I              DGFE25                          WGFE25                                    CSD031
     I              DGFE26                          WGFE26                                    CSD031
     I              DGFE27                          WGFE27                                    CSD031
     I              DGFE28                          WGFE28                                    CSD031
     I              DGFE29                          WGFE29                                    CSD031
     I              DGMA01                          WGMA01                                    CSD031
     I              DGMA02                          WGMA02                                    CSD031
     I              DGMA03                          WGMA03                                    CSD031
     I              DGMA04                          WGMA04                                    CSD031
     I              DGMA05                          WGMA05                                    CSD031
     I              DGMA06                          WGMA06                                    CSD031
     I              DGMA07                          WGMA07                                    CSD031
     I              DGMA08                          WGMA08                                    CSD031
     I              DGMA09                          WGMA09                                    CSD031
     I              DGMA10                          WGMA10                                    CSD031
     I              DGMA11                          WGMA11                                    CSD031
     I              DGMA12                          WGMA12                                    CSD031
     I              DGMA13                          WGMA13                                    CSD031
     I              DGMA14                          WGMA14                                    CSD031
     I              DGMA15                          WGMA15                                    CSD031
     I              DGMA16                          WGMA16                                    CSD031
     I              DGMA17                          WGMA17                                    CSD031
     I              DGMA18                          WGMA18                                    CSD031
     I              DGMA19                          WGMA19                                    CSD031
     I              DGMA20                          WGMA20                                    CSD031
     I              DGMA21                          WGMA21                                    CSD031
     I              DGMA22                          WGMA22                                    CSD031
     I              DGMA23                          WGMA23                                    CSD031
     I              DGMA24                          WGMA24                                    CSD031
     I              DGMA25                          WGMA25                                    CSD031
     I              DGMA26                          WGMA26                                    CSD031
     I              DGMA27                          WGMA27                                    CSD031
     I              DGMA28                          WGMA28                                    CSD031
     I              DGMA29                          WGMA29                                    CSD031
     I              DGMA30                          WGMA30                                    CSD031
     I              DGMA31                          WGMA31                                    CSD031
     I              DGAP01                          WGAP01                                    CSD031
     I              DGAP02                          WGAP02                                    CSD031
     I              DGAP03                          WGAP03                                    CSD031
     I              DGAP04                          WGAP04                                    CSD031
     I              DGAP05                          WGAP05                                    CSD031
     I              DGAP06                          WGAP06                                    CSD031
     I              DGAP07                          WGAP07                                    CSD031
     I              DGAP08                          WGAP08                                    CSD031
     I              DGAP09                          WGAP09                                    CSD031
     I              DGAP10                          WGAP10                                    CSD031
     I              DGAP11                          WGAP11                                    CSD031
     I              DGAP12                          WGAP12                                    CSD031
     I              DGAP13                          WGAP13                                    CSD031
     I              DGAP14                          WGAP14                                    CSD031
     I              DGAP15                          WGAP15                                    CSD031
     I              DGAP16                          WGAP16                                    CSD031
     I              DGAP17                          WGAP17                                    CSD031
     I              DGAP18                          WGAP18                                    CSD031
     I              DGAP19                          WGAP19                                    CSD031
     I              DGAP20                          WGAP20                                    CSD031
     I              DGAP21                          WGAP21                                    CSD031
     I              DGAP22                          WGAP22                                    CSD031
     I              DGAP23                          WGAP23                                    CSD031
     I              DGAP24                          WGAP24                                    CSD031
     I              DGAP25                          WGAP25                                    CSD031
     I              DGAP26                          WGAP26                                    CSD031
     I              DGAP27                          WGAP27                                    CSD031
     I              DGAP28                          WGAP28                                    CSD031
     I              DGAP29                          WGAP29                                    CSD031
     I              DGAP30                          WGAP30                                    CSD031
     I              DGMY01                          WGMY01                                    CSD031
     I              DGMY02                          WGMY02                                    CSD031
     I              DGMY03                          WGMY03                                    CSD031
     I              DGMY04                          WGMY04                                    CSD031
     I              DGMY05                          WGMY05                                    CSD031
     I              DGMY06                          WGMY06                                    CSD031
     I              DGMY07                          WGMY07                                    CSD031
     I              DGMY08                          WGMY08                                    CSD031
     I              DGMY09                          WGMY09                                    CSD031
     I              DGMY10                          WGMY10                                    CSD031
     I              DGMY11                          WGMY11                                    CSD031
     I              DGMY12                          WGMY12                                    CSD031
     I              DGMY13                          WGMY13                                    CSD031
     I              DGMY14                          WGMY14                                    CSD031
     I              DGMY15                          WGMY15                                    CSD031
     I              DGMY16                          WGMY16                                    CSD031
     I              DGMY17                          WGMY17                                    CSD031
     I              DGMY18                          WGMY18                                    CSD031
     I              DGMY19                          WGMY19                                    CSD031
     I              DGMY20                          WGMY20                                    CSD031
     I              DGMY21                          WGMY21                                    CSD031
     I              DGMY22                          WGMY22                                    CSD031
     I              DGMY23                          WGMY23                                    CSD031
     I              DGMY24                          WGMY24                                    CSD031
     I              DGMY25                          WGMY25                                    CSD031
     I              DGMY26                          WGMY26                                    CSD031
     I              DGMY27                          WGMY27                                    CSD031
     I              DGMY28                          WGMY28                                    CSD031
     I              DGMY29                          WGMY29                                    CSD031
     I              DGMY30                          WGMY30                                    CSD031
     I              DGMY31                          WGMY31                                    CSD031
     I              DGJU01                          WGJU01                                    CSD031
     I              DGJU02                          WGJU02                                    CSD031
     I              DGJU03                          WGJU03                                    CSD031
     I              DGJU04                          WGJU04                                    CSD031
     I              DGJU05                          WGJU05                                    CSD031
     I              DGJU06                          WGJU06                                    CSD031
     I              DGJU07                          WGJU07                                    CSD031
     I              DGJU08                          WGJU08                                    CSD031
     I              DGJU09                          WGJU09                                    CSD031
     I              DGJU10                          WGJU10                                    CSD031
     I              DGJU11                          WGJU11                                    CSD031
     I              DGJU12                          WGJU12                                    CSD031
     I              DGJU13                          WGJU13                                    CSD031
     I              DGJU14                          WGJU14                                    CSD031
     I              DGJU15                          WGJU15                                    CSD031
     I              DGJU16                          WGJU16                                    CSD031
     I              DGJU17                          WGJU17                                    CSD031
     I              DGJU18                          WGJU18                                    CSD031
     I              DGJU19                          WGJU19                                    CSD031
     I              DGJU20                          WGJU20                                    CSD031
     I              DGJU21                          WGJU21                                    CSD031
     I              DGJU22                          WGJU22                                    CSD031
     I              DGJU23                          WGJU23                                    CSD031
     I              DGJU24                          WGJU24                                    CSD031
     I              DGJU25                          WGJU25                                    CSD031
     I              DGJU26                          WGJU26                                    CSD031
     I              DGJU27                          WGJU27                                    CSD031
     I              DGJU28                          WGJU28                                    CSD031
     I              DGJU29                          WGJU29                                    CSD031
     I              DGJU30                          WGJU30                                    CSD031
     I              DGJL01                          WGJL01                                    CSD031
     I              DGJL02                          WGJL02                                    CSD031
     I              DGJL03                          WGJL03                                    CSD031
     I              DGJL04                          WGJL04                                    CSD031
     I              DGJL05                          WGJL05                                    CSD031
     I              DGJL06                          WGJL06                                    CSD031
     I              DGJL07                          WGJL07                                    CSD031
     I              DGJL08                          WGJL08                                    CSD031
     I              DGJL09                          WGJL09                                    CSD031
     I              DGJL10                          WGJL10                                    CSD031
     I              DGJL11                          WGJL11                                    CSD031
     I              DGJL12                          WGJL12                                    CSD031
     I              DGJL13                          WGJL13                                    CSD031
     I              DGJL14                          WGJL14                                    CSD031
     I              DGJL15                          WGJL15                                    CSD031
     I              DGJL16                          WGJL16                                    CSD031
     I              DGJL17                          WGJL17                                    CSD031
     I              DGJL18                          WGJL18                                    CSD031
     I              DGJL19                          WGJL19                                    CSD031
     I              DGJL20                          WGJL20                                    CSD031
     I              DGJL21                          WGJL21                                    CSD031
     I              DGJL22                          WGJL22                                    CSD031
     I              DGJL23                          WGJL23                                    CSD031
     I              DGJL24                          WGJL24                                    CSD031
     I              DGJL25                          WGJL25                                    CSD031
     I              DGJL26                          WGJL26                                    CSD031
     I              DGJL27                          WGJL27                                    CSD031
     I              DGJL28                          WGJL28                                    CSD031
     I              DGJL29                          WGJL29                                    CSD031
     I              DGJL30                          WGJL30                                    CSD031
     I              DGJL31                          WGJL31                                    CSD031
     I              DGAU01                          WGAU01                                    CSD031
     I              DGAU02                          WGAU02                                    CSD031
     I              DGAU03                          WGAU03                                    CSD031
     I              DGAU04                          WGAU04                                    CSD031
     I              DGAU05                          WGAU05                                    CSD031
     I              DGAU06                          WGAU06                                    CSD031
     I              DGAU07                          WGAU07                                    CSD031
     I              DGAU08                          WGAU08                                    CSD031
     I              DGAU09                          WGAU09                                    CSD031
     I              DGAU10                          WGAU10                                    CSD031
     I              DGAU11                          WGAU11                                    CSD031
     I              DGAU12                          WGAU12                                    CSD031
     I              DGAU13                          WGAU13                                    CSD031
     I              DGAU14                          WGAU14                                    CSD031
     I              DGAU15                          WGAU15                                    CSD031
     I              DGAU16                          WGAU16                                    CSD031
     I              DGAU17                          WGAU17                                    CSD031
     I              DGAU18                          WGAU18                                    CSD031
     I              DGAU19                          WGAU19                                    CSD031
     I              DGAU20                          WGAU20                                    CSD031
     I              DGAU21                          WGAU21                                    CSD031
     I              DGAU22                          WGAU22                                    CSD031
     I              DGAU23                          WGAU23                                    CSD031
     I              DGAU24                          WGAU24                                    CSD031
     I              DGAU25                          WGAU25                                    CSD031
     I              DGAU26                          WGAU26                                    CSD031
     I              DGAU27                          WGAU27                                    CSD031
     I              DGAU28                          WGAU28                                    CSD031
     I              DGAU29                          WGAU29                                    CSD031
     I              DGAU30                          WGAU30                                    CSD031
     I              DGAU31                          WGAU31                                    CSD031
     I              DGSE01                          WGSE01                                    CSD031
     I              DGSE02                          WGSE02                                    CSD031
     I              DGSE03                          WGSE03                                    CSD031
     I              DGSE04                          WGSE04                                    CSD031
     I              DGSE05                          WGSE05                                    CSD031
     I              DGSE06                          WGSE06                                    CSD031
     I              DGSE07                          WGSE07                                    CSD031
     I              DGSE08                          WGSE08                                    CSD031
     I              DGSE09                          WGSE09                                    CSD031
     I              DGSE10                          WGSE10                                    CSD031
     I              DGSE11                          WGSE11                                    CSD031
     I              DGSE12                          WGSE12                                    CSD031
     I              DGSE13                          WGSE13                                    CSD031
     I              DGSE14                          WGSE14                                    CSD031
     I              DGSE15                          WGSE15                                    CSD031
     I              DGSE16                          WGSE16                                    CSD031
     I              DGSE17                          WGSE17                                    CSD031
     I              DGSE18                          WGSE18                                    CSD031
     I              DGSE19                          WGSE19                                    CSD031
     I              DGSE20                          WGSE20                                    CSD031
     I              DGSE21                          WGSE21                                    CSD031
     I              DGSE22                          WGSE22                                    CSD031
     I              DGSE23                          WGSE23                                    CSD031
     I              DGSE24                          WGSE24                                    CSD031
     I              DGSE25                          WGSE25                                    CSD031
     I              DGSE26                          WGSE26                                    CSD031
     I              DGSE27                          WGSE27                                    CSD031
     I              DGSE28                          WGSE28                                    CSD031
     I              DGSE29                          WGSE29                                    CSD031
     I              DGSE30                          WGSE30                                    CSD031
     I              DGOC01                          WGOC01                                    CSD031
     I              DGOC02                          WGOC02                                    CSD031
     I              DGOC03                          WGOC03                                    CSD031
     I              DGOC04                          WGOC04                                    CSD031
     I              DGOC05                          WGOC05                                    CSD031
     I              DGOC06                          WGOC06                                    CSD031
     I              DGOC07                          WGOC07                                    CSD031
     I              DGOC08                          WGOC08                                    CSD031
     I              DGOC09                          WGOC09                                    CSD031
     I              DGOC10                          WGOC10                                    CSD031
     I              DGOC11                          WGOC11                                    CSD031
     I              DGOC12                          WGOC12                                    CSD031
     I              DGOC13                          WGOC13                                    CSD031
     I              DGOC14                          WGOC14                                    CSD031
     I              DGOC15                          WGOC15                                    CSD031
     I              DGOC16                          WGOC16                                    CSD031
     I              DGOC17                          WGOC17                                    CSD031
     I              DGOC18                          WGOC18                                    CSD031
     I              DGOC19                          WGOC19                                    CSD031
     I              DGOC20                          WGOC20                                    CSD031
     I              DGOC21                          WGOC21                                    CSD031
     I              DGOC22                          WGOC22                                    CSD031
     I              DGOC23                          WGOC23                                    CSD031
     I              DGOC24                          WGOC24                                    CSD031
     I              DGOC25                          WGOC25                                    CSD031
     I              DGOC26                          WGOC26                                    CSD031
     I              DGOC27                          WGOC27                                    CSD031
     I              DGOC28                          WGOC28                                    CSD031
     I              DGOC29                          WGOC29                                    CSD031
     I              DGOC30                          WGOC30                                    CSD031
     I              DGOC31                          WGOC31                                    CSD031
     I              DGNO01                          WGNO01                                    CSD031
     I              DGNO02                          WGNO02                                    CSD031
     I              DGNO03                          WGNO03                                    CSD031
     I              DGNO04                          WGNO04                                    CSD031
     I              DGNO05                          WGNO05                                    CSD031
     I              DGNO06                          WGNO06                                    CSD031
     I              DGNO07                          WGNO07                                    CSD031
     I              DGNO08                          WGNO08                                    CSD031
     I              DGNO09                          WGNO09                                    CSD031
     I              DGNO10                          WGNO10                                    CSD031
     I              DGNO11                          WGNO11                                    CSD031
     I              DGNO12                          WGNO12                                    CSD031
     I              DGNO13                          WGNO13                                    CSD031
     I              DGNO14                          WGNO14                                    CSD031
     I              DGNO15                          WGNO15                                    CSD031
     I              DGNO16                          WGNO16                                    CSD031
     I              DGNO17                          WGNO17                                    CSD031
     I              DGNO18                          WGNO18                                    CSD031
     I              DGNO19                          WGNO19                                    CSD031
     I              DGNO20                          WGNO20                                    CSD031
     I              DGNO21                          WGNO21                                    CSD031
     I              DGNO22                          WGNO22                                    CSD031
     I              DGNO23                          WGNO23                                    CSD031
     I              DGNO24                          WGNO24                                    CSD031
     I              DGNO25                          WGNO25                                    CSD031
     I              DGNO26                          WGNO26                                    CSD031
     I              DGNO27                          WGNO27                                    CSD031
     I              DGNO28                          WGNO28                                    CSD031
     I              DGNO29                          WGNO29                                    CSD031
     I              DGNO30                          WGNO30                                    CSD031
     I              DGDE01                          WGDE01                                    CSD031
     I              DGDE02                          WGDE02                                    CSD031
     I              DGDE03                          WGDE03                                    CSD031
     I              DGDE04                          WGDE04                                    CSD031
     I              DGDE05                          WGDE05                                    CSD031
     I              DGDE06                          WGDE06                                    CSD031
     I              DGDE07                          WGDE07                                    CSD031
     I              DGDE08                          WGDE08                                    CSD031
     I              DGDE09                          WGDE09                                    CSD031
     I              DGDE10                          WGDE10                                    CSD031
     I              DGDE11                          WGDE11                                    CSD031
     I              DGDE12                          WGDE12                                    CSD031
     I              DGDE13                          WGDE13                                    CSD031
     I              DGDE14                          WGDE14                                    CSD031
     I              DGDE15                          WGDE15                                    CSD031
     I              DGDE16                          WGDE16                                    CSD031
     I              DGDE17                          WGDE17                                    CSD031
     I              DGDE18                          WGDE18                                    CSD031
     I              DGDE19                          WGDE19                                    CSD031
     I              DGDE20                          WGDE20                                    CSD031
     I              DGDE21                          WGDE21                                    CSD031
     I              DGDE22                          WGDE22                                    CSD031
     I              DGDE23                          WGDE23                                    CSD031
     I              DGDE24                          WGDE24                                    CSD031
     I              DGDE25                          WGDE25                                    CSD031
     I              DGDE26                          WGDE26                                    CSD031
     I              DGDE27                          WGDE27                                    CSD031
     I              DGDE28                          WGDE28                                    CSD031
     I              DGDE29                          WGDE29                                    CSD031
     I              DGDE30                          WGDE30                                    CSD031
     I              DGDE31                          WGDE31                                    CSD031
     I              DGLCD                           WGLCD                                     CSD031
     I              DGTYLC                          WGTYLC                                    CSD031
     I              DGZONE                          WGZONE                                    CSD031
     I              DGIUSR                          WGIUSR                                    CSD031
     I              DGAUSR                          WGAUSR                                    CSD031
     I              DGXUSR                          WGXUSR                                    CSD031
     I              DGAACC                          WGAACC                                    CSD031
     I              DGEACC                          WGEACC                                    CSD031
     I              DGGPDT                          WGGPDT                                    CSD031
      /EJECT
     I*
     I* Description     : Copyright notice for inclusion in all programs
     I*
     I*
     I** REDEFINE THE LAST TWO CHARACTERS OF THE MIDAS DATE SO THAT
     I** THE YEAR CAN BE RETRIEVED
     I*
      /EJECT
      * Data structures:
     ILDA       E DSLDA                         256                                           CSD012
     I              SPARE                           SPAREX                                    CSD012
      ** Local data area for database error details                                           CSD012
      *                                                                                       CSD012
     IWDATE       DS                                                                          CSD031
     I                                        1   2 WDD                                       CSD031
     I                                        3   4 WMM                                       CSD031
     I                                        5   6 WYY                                       CSD031
      *                                                                                       CSD031
      ** MIDAS date conversion                                                                CSD031
      *                                                                                       CSD031
     IPGMDS     ESDSY2PGDSP
      * Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     IDSFDY     E DSDSFDY                                                                     CSD031
      ** DS for access programs, short data structure                                         CSD031
      *                                                                                       CSD031
     ISDBANK    E DSSDBANKPD                                                                  CSD031
      ** Bank details file                                                                    CSD031
      *                                                                                       CSD031
      * Outward parameters
     IPARC        DS                             10
      * KEY : Midas SD Holidays test access path
      * I : MAP Currency Code
     I                                        1   3 PACYCD
      * I : MAP Location Code
     I                                        4   6 PALCCD
      * I : MAP Year Number
     I                                        7  10 PAYRNB
      *
      * Outward parameters
     IPBRC        DS                             10
      * KEY : Midas SD Holidays test access path
      * I : RST Currency Code
     I                                        1   3 PBCYCD
      * I : RST Location Code
     I                                        4   6 PBLCCD
      * I : RST Year Number
     I                                        7  10 PBYRNB
      *
     IA@CPY       DS
     I* Copyright array
     I                                        1  80 CPY@
     IRUNDAT      DS
     I                                        1   7 MRDT
     I                                    P   8  100RDNB
     I                                       11  11 SUC
     I                                       12  12 DFF
     I                                       13  13 MBIN
     I            DS
     I                                        1   7 WUMRDT
     I                                        6   70UYRN
     IID0001      DS                            528
      * File information data structure
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I :  Display file mode
     I                                        1   1 P1DFMD
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Location code invalid'
      * Location Code -Func. Fld
     I                                        1   3 ZA0001
      * Message data for 'Update Error'
      * *SFLSEL
     I                                        1   1 ZA0002
      * Message data for 'Update Error'
      * *SFLSEL
     I                                        1   1 ZA0003
      * Message data for 'Deletion invalid <2 years'
      * *SFLSEL
     I                                        1   1 ZA0004
      * Message data for 'Update Error'
      * *SFLSEL
     I                                        1   1 ZA0005
      * Message data for 'Deletion invalid non-glob'
      * *SFLSEL
     I                                        1   1 ZA0006
      * Message data for 'value for field not valid'
      * *SFLSEL
     I                                        1   1 ZA0007
      * Message data for 'value for field not valid'
      * *SFLSEL
     I                                        1   1 ZA0008
      *                                                                                       CSD012
     I***K1HOL**     DS                             20                                 CSD012 CGL029
     IK1HOL       DS                             26                                           CGL029
     I                                        1   3 K1CYCD                                    CSD012
     I                                        4   6 K1LCCD                                    CSD012
     I                                        7  10 K1YRNB                                    CSD012
      *                                                                                       CSD012
      * Data structure for AOSVALR0 string                                                    CSD012
     I            DS                                                                          CSD012
     I                                        1 200 SVAL1                                     CSD012
     I                                        1   1 SVAL11                                    CSD012
      *                                                                                       CSD012
      * System Value                                                                          CSD012
     I            DS                                                                          CSD012
     I I            'AuthReqHolidaysMaint'    1  20 SVALK1                                    CSD012
      *                                                                                       CSD012
      * Function Description                                                                  CSD012
     I            DS                                                                          CSD012
     I I            'HOLIDAY DETAILS '        1  21 FUNCD                                     CSD012
      *                                                                                       CSD012
     I              'Accept to Zone '     C         GHDR1                                     CSD031
     I              ' Central Data  '     C         GHDR2                                     CSD031
     I              'Action'              C         GHDR3                                     CSD031
      *                                                                                       CSD031
     IQSDFC1    E DSSDFCTLL0                                                                  CSD031
      * UPD : Midas SD Standing data controls update                                          CSD031
      *                                                                                       CSD031
     IID0007      DS                            528                                           CSD031
      * File information data structure                                                       CSD031
      *                                                                                       CSD031
     IYARDCS      DS                             22                                           CSD031
     IYBRDCS      DS                             22                                           CSD031
     IYDRDCS      DS                             22                                           CSD031
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1DFMD    PARM           WP0001  1        Display file mo
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise & load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
     C           WP0001    IFEQ 'A'                                                           CSD031
     C                     MOVE *OFF      *IN95                                               CSD031
     C                     ELSE                                                               CSD031
     C                     MOVE *ON       *IN95                                               CSD031
     C                     ENDIF                                                              CSD031
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   05                CAS            FBRQRL
      * TOGGLE MODE: Request subfile reload                                                   CSD031
     C   11                CAS            CHGZMD                                              CSD031
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END                             OD W0RSF
     C                     END                             OD *HIVAL
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise and load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
      * Position DBF file
     C           KPOS      KLIST
     C                     KFLD           DGCYCD           Currency Code
     C                     KFLD           DGLCCD           Location Code
     C                     KFLD           DGYRNB           Year Number
      * Setup key
     C                     MOVEL#2CYCD    DGCYCD           Currency Code
     C                     MOVEL#2LCCD    DGLCCD           Location Code
     C                     MOVEL#2YRNB    DGYRNB           Year Number
     C                     SELEC                                                              CSD031
     C           CSD041    WHEQ 'G'                                                           CSD031
     C           KPOS      SETLLGPHOL1                                                        CSD031
     C                     READ GPHOL1                 8782                                   CSD031
     C           CSD041    WHEQ 'Z'                                                           CSD031
     C           WP0001    ANDEQ'A'                                                           CSD031
     C           KPOS      SETLLSDAHL1                                                        CSD031
     C                     READ SDAHL1                 8782                                   CSD031
     C                     OTHER                                                              CSD031
     C********** KPOS      SETLLSDHOL0                                               CSD031 BUG11709
     C**********           READ SDHOL0                 8782                          CSD031 BUG11709
     C           KPOS      SETLL@HOLPH0                                                     BUG11709
     C                     READ @HOLPH0                8782*82                              BUG11709
     C                     ENDSL                                                              CSD031
      * Save previous selector values
     C           *LIKE     DEFN #2LCD     WZLCD
     C                     MOVEL#2LCD     WZLCD            Last Change Dat
     C           *LIKE     DEFN #2TYLC    WZTYLC
     C                     MOVEL#2TYLC    WZTYLC           Type of Last Ch
     C           *LIKE     DEFN #2CYCD    WZCYCD
     C                     MOVEL#2CYCD    WZCYCD           Currency Code
     C           *LIKE     DEFN #2LCCD    WZLCCD
     C                     MOVEL#2LCCD    WZLCCD           Location Code
     C           *LIKE     DEFN #2YRNB    WZYRNB
     C                     MOVEL#2YRNB    WZYRNB           Year Number
     C           CSD041    IFEQ 'G'                                                           CSD031
     C           CSD041    OREQ 'Z'                                                           CSD031
     C           *LIKE     DEFN #2ACZN    WACZN                                               CSD031
     C                     MOVEL#2ACZN    WACZN                                               CSD031
     C           *LIKE     DEFN #2EFDT    WEFDT                                               CSD031
     C                     MOVEL#2EFDT    WEFDT                                               CSD031
     C           *LIKE     DEFN #2ACTN    WACTN                                               CSD031
     C                     MOVEL#2ACTN    WACTN                                               CSD031
     C                     ENDIF                                                              CSD031
      * Load subfile page
     C                     Z-ADD0         ##RROK  50
     C                     EXSR BBLDSF
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page
      *================================================================
      * Re-establish fields in read-ahead record
     C   27                DO
     C                     SELEC                                                              CSD031
     C           CSD041    WHEQ 'G'                                                           CSD031
     C  N82                READPGPHOL1                   90                                   CSD031
     C  N82                READ GPHOL1                   90                                   CSD031
     C           CSD041    WHEQ 'Z'                                                           CSD031
     C           WP0001    ANDEQ'A'                                                           CSD031
     C  N82                READPSDAHL1                   90                                   CSD031
     C  N82                READ SDAHL1                   90                                   CSD031
     C                     OTHER                                                              CSD031
     C**N82*****           READPSDHOL0                   90                          CSD031 BUG11709
     C**N82*****           READ SDHOL0                   90                          CSD031 BUG11709
     C  N82                READP@HOLPH0                  90                                 BUG11709
     C  N82                READ @HOLPH0                  90                                 BUG11709
     C                     ENDSL                                                              CSD031
     C                     END
      *
      * Setof record error indicators
     C                     MOVEL*ALL'0'   WKIND0  1
     C                     MOVEAWKIND0    *IN,34
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
      * Reset count of DBF records read
     C                     Z-ADD0         ##RRRD  50
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next SFL page until SFL page full, or
      * Scan limit reached
     C           *IN82     DOWEQ'0'                        DO
     C           ##RROK    ANDLT##SFLN
     C           ##RRRD    ANDLTW0SLM
      * Check selection fields - if fail, read next record
     C           #2LCD     IFNE *ZERO                      Last Change Dat
     C           DGLCD     CABNE#2LCD     BB020            Last Change Dat
     C                     END
     C           #2TYLC    IFNE *BLANK                     Type of Last Ch
     C           DGTYLC    CABNE#2TYLC    BB020            Type of Last Ch
     C                     END
     C           #2CYCD    IFEQ *BLANK                     Currency Code
     C           #2LCCD    IFNE *BLANK                     Location Code
     C           DGLCCD    CABNE#2LCCD    BB020            Location Code
     C                     END
     C                     END
     C           #2CYCD    IFEQ *BLANK                     Currency Code
     C           #2LCCD    OREQ *BLANK                     Location Code
     C           #2YRNB    IFNE *BLANK                     Year Number
     C           DGYRNB    CABNE#2YRNB    BB020            Year Number
     C                     END
     C                     END                                                                CSD031
      *                                                                                       CSD031
      ** Filter for Accept to zone                                                            CSD031
      *                                                                                       CSD031
     C           #2ACZN    IFNE *BLANK                                                        CSD031
     C           CSD041    IFEQ 'G'                                                           CSD031
     C           DGAACC    CABNE#2ACZN    BB020                                               CSD031
     C                     ENDIF                                                              CSD031
     C           CSD041    IFEQ 'Z'                                                           CSD031
     C           WP0001    ANDEQ'C'                                                           CSD031
     C           WGGPDT    CABNE#2ACZN    BB020                                               CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      ** Filter for Effective date                                                            CSD031
      *                                                                                       CSD031
     C           #2EFDT    IFNE *BLANK                                                        CSD031
     C                     MOVE *ZERO     WDATE                                               CSD031
     C           3         SUBST#2EFDT:3  WMMM    3                                           CSD031
     C                     Z-ADD1         WI      50                                          CSD031
     C           WMMM      LOKUPMMM,WI                   90                                   CSD031
     C           *IN90     IFEQ *ON                                                           CSD031
     C                     MOVE #2EFDT    WYY                                                 CSD031
     C                     MOVE WI        WMM                                                 CSD031
     C                     MOVEL#2EFDT    WDD                                                 CSD031
     C                     ENDIF                                                              CSD031
     C                     MOVE WDATE     ZDATE                                               CSD031
     C                     EXSR ZDATE1                                                        CSD031
     C           *IN99     IFEQ *ON                                                           CSD031
     C                     MOVEL'ASM0045' ZAMSID                                              CSD031
     C                     EXSR ZASNMS                                                        CSD031
     C                     SETON                     9935                                     CSD031
     C                     ELSE                                                               CSD031
     C                     Z-ADDZDAYNO    WEACC   50                                          CSD031
     C           CSD041    IFEQ 'G'                                                           CSD031
     C           DGEACC    CABNEWEACC     BB020                                               CSD031
     C                     ENDIF                                                              CSD031
     C           CSD041    IFEQ 'Z'                                                           CSD031
     C           WP0001    ANDEQ'C'                                                           CSD031
     C           WGEACC    CABNEWEACC     BB020                                               CSD031
     C                     ENDIF                                                              CSD031
     C           CSD041    IFEQ 'Z'                                                           CSD031
     C           WP0001    ANDEQ'A'                                                           CSD031
     C           DGEACC    CABNEWEACC     BB020                                               CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      ** Filter for Action                                                                    CSD031
      *                                                                                       CSD031
     C           #2ACTN    IFNE *BLANK                                                        CSD031
     C                     SELEC                                                              CSD031
     C           #2ACTN    WHEQ 'INSERT'                                                      CSD031
     C                     MOVEL'I'       SELACN  1                                           CSD031
     C           #2ACTN    WHEQ 'DELETE'                                                      CSD031
     C                     MOVEL'D'       SELACN                                              CSD031
     C           #2ACTN    WHEQ 'AMEND '                                                      CSD031
     C                     MOVEL'A'       SELACN                                              CSD031
     C                     ENDSL                                                              CSD031
     C           DGTYLC    CABNESELACN    BB020                                               CSD031
     C                     ENDIF                                                              CSD031
      * Load SFL fields
     C                     EXSR MBFL#1
     C                     MOVEL'Y'       W0RSL   1
      * Allow for possible *Set Cursor processing
     C                     ADD  1         ##RR
      * USER: Initialize subfile record from DBF record
      * CASE: DB1.Location Code is Global Value
     C           DGLCCD    IFEQ '***'                      *IF
     C                     MOVEL*BLANK    #RLCDF           Location Code -
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELDGLCCD    #RLCDF           Location Code -
     C                     END                             *FI
     C                     SUB  1         ##RR
      * DBF record not selected
     C           W0RSL     CABNE'Y'       BB020
      * Output to subfile
     C                     ADD  1         ##RR
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
     C                     WRITE#SFLRCD
     C           BB020     TAG
      * Increment scan check count
     C                     ADD  1         ##RRRD
     C                     SELEC                                                              CSD031
     C           CSD041    WHEQ 'G'                                                           CSD031
     C                     READ GPHOL1                   82                                   CSD031
     C           CSD041    WHEQ 'Z'                                                           CSD031
     C           WP0001    ANDEQ'A'                                                           CSD031
     C                     READ SDAHL1                   82                                   CSD031
     C                     OTHER                                                              CSD031
     C**********           READ SDHOL0                   82                          CSD031 BUG11709
     C                     READ @HOLPH0                  82                                 BUG11709
     C                     ENDSL                                                              CSD031
     C                     END                             OD 1 - ##SFPG
      *................................................................
     C           BB900     TAG
      *................................................................
      * If no DBF records found, display error message
     C           ##RR      IFEQ *ZERO
     C           *IN82     ANDEQ'1'
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI ##RR = *ZERO
      *
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      * If scan limit reached, display error message
     C           ##RRRD    IFGE W0SLM
      * Send message '*Scan limit reached'
     C                     MOVEL'Y2U0017' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     ELSE
     C                     Z-ADD0         ##RROK
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen
      *================================================================
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE HELP25    *IN25
      * Update screen time
     C                     TIME           ##TME
      * PUTOVR unless conditioned fields change
     C                     SETON                     86
     C           *IN81     IFNE CAIN81
     C                     SETOF                     86
     C                     END
     C                     MOVE *IN81     CAIN81  1
     C           CHGMOD    IFEQ 'Y'                                                           CSD031
     C                     SETOF                     86                                       CSD031
     C                     MOVE 'N'       CHGMOD                                              CSD031
     C                     ENDIF                                                              CSD031
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     SETOF                       8392*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * CALC: Subfile control function fields
      * CASE: CTL.Location Code is Global Value
     C           #2LCCD    IFEQ '***'                      *IF
      * Setup message data for message
     C                     MOVEL#2LCCD    ZA0001           Location Code
      * Send message 'Location code invalid'
     C                     MOVEL'USR0737' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * Change of position specified
     C           WZCYCD    CASNE#2CYCD    FBRQRL
     C           WZLCCD    CASNE#2LCCD    FBRQRL
     C           WZYRNB    CASNE#2YRNB    FBRQRL
     C   95      WACZN     CASNE#2ACZN    FBRQRL                                              CSD031
     C           WEFDT     CASNE#2EFDT    FBRQRL                                              CSD031
     C                     END
      * Reload subfile requested
     C           W0RSF     CABEQ'Y'       DAEXIT
     C           *IN81     IFEQ '1'
      * Process subfile records
     C                     EXSR DBPRSF
     C                     END
      * If error, quit processing
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * USER: Process command keys
      * CASE: PAR.Display file mode is Maintenance mode
     C           P1DFMD    IFEQ 'M'                        *IF
      * CASE: CTL.*CMD key is *Go to 'Add' mode
     C           *IN09     IFEQ '1'                        *IF
      * 00/Copy Member SD0160DCP2 - Holidays  *
     C/COPY WNCPYSRC,SD0160DCP2
      * Add Holidays for Year - Holidays  *
     C                     CALL 'SD0161V'              90  Add Holidays fo
     C                     PARM *BLANK    W0RTN   7
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0161V' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: CTL.*CMD key is CF10
     C           *IN10     IFEQ '1'                        *IF
     C           WUYEAR    SUB  2         WULYRD           Latest Year for
      * Years Eligable for Del. - Holidays  *
     C                     CALL 'SD0161D'              90  Years Eligible
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WULYRD    WQ0001  40       Latest Year for
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0161D' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: CTL.*CMD key is *Go to 'Add' mode
     C           *IN09     IFEQ '1'                        *IF
      * Send message 'Function key not allowed'
     C                     MOVEL'USR0533' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: CTL.*CMD key is CF10
     C           *IN10     IFEQ '1'                        *IF
      * Send message 'Function key not allowed'
     C                     MOVEL'USR0533' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
     C                     READC#SFLRCD                  92*
     C           *IN92     DOWEQ'0'
      * Process subfile record
     C                     EXSR DCPRSR
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Setof error indicators and SFLNXTCHG
     C                     MOVEAWKIND0    *IN,34
     C                     SETOF                     98    *
      *                                                                                       CSD031
      ** Validation of selections                                                             CSD031
      *                                                                                       CSD031
     C           #1SEL     IFEQ *BLANKS                                                       CSD031
     C                     MOVE *OFF      *IN84                                               CSD031
     C                     GOTO DCEXIT                                                        CSD031
     C                     ENDIF                                                              CSD031
     C                     SELEC                                                              CSD031
     C           CSD041    WHEQ 'G'                                                           CSD031
     C           #1SEL     IFNE 'A'                                                           CSD031
     C           #1SEL     ANDNE'D'                                                           CSD031
     C           #1SEL     ANDNE'E'                                                           CSD031
     C                     MOVE *ON       *IN34                                               CSD031
     C                     MOVE *OFF      *IN84                                               CSD031
     C                     MOVEL#1SEL     ZA0001                                              CSD031
     C                     MOVEL'ASM0002' ZAMSID                                              CSD031
     C                     MOVEL'SDUSRMSG'ZAMSGF                                              CSD031
     C                     EXSR ZASNMS                                                        CSD031
     C                     GOTO DCEXIT                                                        CSD031
     C                     ENDIF                                                              CSD031
     C           CSD041    WHEQ 'Z'                                                           CSD031
     C           WP0001    ANDEQ'C'                                                           CSD031
     C           #1SEL     IFNE 'A'                                                           CSD031
     C           #1SEL     ANDNE'D'                                                           CSD031
     C           #1SEL     ANDNE'E'                                                           CSD031
     C                     MOVE *ON       *IN34                                               CSD031
     C                     MOVE *OFF      *IN84                                               CSD031
     C                     MOVEL#1SEL     ZA0001                                              CSD031
     C                     MOVEL'ASM0002' ZAMSID                                              CSD031
     C                     MOVEL'SDUSRMSG'ZAMSGF                                              CSD031
     C                     EXSR ZASNMS                                                        CSD031
     C                     GOTO DCEXIT                                                        CSD031
     C                     ENDIF                                                              CSD031
     C           CSD041    WHEQ 'Z'                                                           CSD031
     C           WP0001    ANDEQ'A'                                                           CSD031
     C           #1SEL     IFNE 'X'                                                           CSD031
     C           #1SEL     ANDNE'D'                                                           CSD031
     C           #1SEL     ANDNE'E'                                                           CSD031
     C                     MOVE *ON       *IN34                                               CSD031
     C                     MOVE *OFF      *IN84                                               CSD031
     C                     MOVEL#1SEL     ZA0001                                              CSD031
     C                     MOVEL'ASM0002' ZAMSID                                              CSD031
     C                     MOVEL'SDUSRMSG'ZAMSGF                                              CSD031
     C                     EXSR ZASNMS                                                        CSD031
     C                     GOTO DCEXIT                                                        CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDSL                                                              CSD031
      *                                                                                       CSD031
      * USER: Process subfile record (Pre-confirm)
      * 00/Copy Member SD0160DCP3 - Holidays  *
     C/COPY WNCPYSRC,SD0160DCP3
      * CASE: RCD.*SFLSEL is *Enquire
     C           #1SEL     IFEQ 'E'                        *IF
      * Dsp a Years Holidays - Holidays  *
     C                     CLEARPARC
     C                     MOVEL#1CYCD    PACYCD           Currency Code
     C                     MOVEL#1LCCD    PALCCD           Location Code
     C                     MOVEL#1YRNB    PAYRNB           Year Number
      *
     C                     CALL 'SD0161E'              90  Dsp a Years Hol
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Holidays
      *                                                                                       CSD031
      ** Mode parameter                                                                       CSD031
      *                                                                                       CSD031
     C                     PARM           WP0001                                              CSD031
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0161E' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * CASE: PAR.Display file mode is Maintenance mode
     C           P1DFMD    IFEQ 'M'                        *IF
      *                                                                                       CSD012
      * If Authorisation check is on, for Amend or Delete actions,                            CSD012
      * check if unathorised record exists on Authorisation Log.                              CSD012
     C           #1SEL     IFEQ 'A'                                                           CSD012
     C           AUTHRQ    ANDEQ'Y'                                                           CSD012
     C           #1SEL     OREQ 'D'                                                           CSD012
     C           AUTHRQ    ANDEQ'Y'                                                           CSD012
      *                                                                                       CSD012
     C                     MOVEL#1CYCD    K1CYCD                                              CSD012
     C           #1LCCD    IFEQ *BLANKS                                                       CSD012
     C                     MOVE '***'     K1LCCD                                              CSD012
     C                     ELSE                                                               CSD012
     C                     MOVEL#1LCCD    K1LCCD                                              CSD012
     C                     ENDIF                                                              CSD012
     C                     MOVEL#1YRNB    K1YRNB                                              CSD012
     C           KAULG     CHAINSDAULGL0             90                                       CSD012
      *                                                                                       CSD012
      * If record exists then prevent insert                                                  CSD012
     C           *IN90     IFEQ *OFF                                                          CSD012
      * Setup message data for message                                                        CSD012
      *                                                                                       CSD012
     C                     MOVEL#1SEL     ZA0001           *SFLSEL                            CSD012
     C                     MOVEL'USR9265' ZAMSID                                              CSD012
     C                     MOVEL'SDUSRMSG'ZAMSGF                                              CSD012
     C                     EXSR ZASNMS                                                        CSD012
     C                     SETON                     9834                                     CSD012
     C                     GOTO TAGERR                                                        CSD012
      *                                                                                     MD050882
     C                     ELSE                                                             MD050882
     C                     MOVE '***'     K1CYCD                                            MD050882
     C           KAULG     CHAINSDAULGL0             90                                     MD050882
      *                                                                                     MD050882
      ** If deletion by year exists, prevent insert                                         MD050882
     C           *IN90     IFEQ '0'                                                         MD050882
      *                                                                                     MD050882
      ** Setup message data for message                                                     MD050882
     C                     MOVEL#1SEL     ZA0001           *SFLSEL                          MD050882
     C                     MOVEL'USR9484' ZAMSID                                            MD050882
     C                     MOVEL'SDUSRMSG'ZAMSGF                                            MD050882
     C                     EXSR ZASNMS                                                      MD050882
     C                     SETON                     9834                                   MD050882
     C                     GOTO TAGERR                                                      MD050882
     C                     ENDIF                                                            MD050882
      *                                                                                     MD050882
     C                     ENDIF                                                              CSD012
      *                                                                                       CSD012
     C                     ENDIF                                                              CSD012
      *                                                                                       CSD012
      * CASE: RCD.*SFLSEL is *Amend
     C           #1SEL     IFEQ 'A'                        *IF
      *                                                                                       CSD031
      ** Check if there are pending changes                                                   CSD031
      *                                                                                       CSD031
     C           CSD041    IFEQ 'Z'                                                           CSD031
     C                     MOVEL#1CYCD    DGCYCD                                              CSD031
     C                     MOVEL#1LCCD    DGLCCD                                              CSD031
     C                     MOVEL#1YRNB    DGYRNB                                              CSD031
     C                     MOVE ' '       WMODE                                               CSD031
     C           KPOS      CHAINSDAHDYL3             90                                       CSD031
     C           *IN90     IFEQ *OFF                                                          CSD031
     C                     MOVEL#1SEL     ZA0001                                              CSD031
     C                     MOVEL'CSD0002' ZAMSID                                              CSD031
     C                     MOVEL'SDUSRMSG'ZAMSGF                                              CSD031
     C                     EXSR ZASNMS                                                        CSD031
     C                     GOTO DCEXIT                                                        CSD031
     C                     ENDIF                                                              CSD031
     C                     ELSE                                                               CSD031
     C                     MOVE WP0001    WMODE                                               CSD031
     C                     ENDIF                                                              CSD031
     C                     MOVE #1ACZN    WACZN1                                              CSD031
     C                     MOVE #1EFDS    WEFDT1                                              CSD031
      * Amend Holidays - Holidays  *
     C                     CLEARPBRC
     C                     MOVEL#1CYCD    PBCYCD           Currency Code
     C                     MOVEL#1LCCD    PBLCCD           Location Code
     C                     MOVEL#1YRNB    PBYRNB           Year Number
      *
     C                     CALL 'SD0160X'              90  Amend Holidays
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Holidays
     C                     PARM 'A'       WQ0002  1        Action Code
     C           WUDRTC    PARM *BLANK    WQ0003  7        Duplicate Retur
     C                     PARM           WMODE   1                                           CSD031
     C                     PARM           WACZN1  1                                           CSD031
     C                     PARM           WEFDT1  6                                           CSD031
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0160X' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CASE: WRK.Duplicate Return Code is *User QUIT requested
     C           WUDRTC    IFEQ 'Y2U9999'                  *IF
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: WRK.Duplicate Return Code is *ROLLBACK required
     C           WUDRTC    IFEQ 'Y2U0018'                  *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0002           *SFLSEL
      * Send message 'Update Error'
     C                     MOVEL'USR0810' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9834  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: RCD.*SFLSEL is *Delete
     C           #1SEL     IFEQ 'D'                        *IF
      *                                                                                       CSD031
      ** Check if delete is at central level and accept to zone is set to 'Y'                 CSD031
      *                                                                                       CSD031
     C           CSD041    IFEQ 'G'                                                           CSD031
     C                     MOVE ' '       WMODE                                               CSD031
     C           #1ACZN    IFEQ 'Y'                                                           CSD031
     C                     MOVEL#1SEL     ZA0001                                              CSD031
     C                     MOVEL'CSD0007' ZAMSID                                              CSD031
     C                     MOVEL'SDUSRMSG'ZAMSGF                                              CSD031
     C                     EXSR ZASNMS                                                        CSD031
     C                     GOTO DCEXIT                                                        CSD031
     C                     ENDIF                                                              CSD031
     C                     ELSE                                                               CSD031
     C           CSD041    IFEQ 'Z'                                                           CSD031
      *                                                                                       CSD031
      ** Check if there are pending changes on change mode                                    CSD031
      *                                                                                       CSD031
     C           WP0001    IFEQ 'C'                                                           CSD031
     C                     MOVE WP0001    WMODE                                               CSD031
     C                     MOVEL#1CYCD    DGCYCD                                              CSD031
     C                     MOVEL#1LCCD    DGLCCD                                              CSD031
     C                     MOVEL#1YRNB    DGYRNB                                              CSD031
     C                     MOVE #1ACZN    WACZN1                                              CSD031
     C                     MOVE #1EFDS    WEFDT1                                              CSD031
     C           KPOS      CHAINSDAHDYL3             90                                       CSD031
     C           *IN90     IFEQ *OFF                                                          CSD031
     C                     MOVEL#1SEL     ZA0001                                              CSD031
     C                     MOVEL'CSD0002' ZAMSID                                              CSD031
     C                     MOVEL'SDUSRMSG'ZAMSGF                                              CSD031
     C                     EXSR ZASNMS                                                        CSD031
     C                     GOTO DCEXIT                                                        CSD031
     C                     ENDIF                                                              CSD031
     C                     MOVEL#1CYCD    DGCYCD                                              CSD031
     C                     ELSE                                                               CSD031
     C                     EXSR SRACCP                                                        CSD031
     C                     MOVE 'Y'       W0RSF                                               CSD031
     C                     GOTO DCEXIT                                                        CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
      * Able to delete a record if the location code is not blank (***)
      * CASE: RCD.Location Code is Not Global Value
     C           #1LCCD    IFNE '***'                      *IF
      * Amend Holidays - Holidays  *
     C                     CLEARPBRC
     C                     MOVEL#1CYCD    PBCYCD           Currency Code
     C                     MOVEL#1LCCD    PBLCCD           Location Code
     C                     MOVEL#1YRNB    PBYRNB           Year Number
      *
     C                     CALL 'SD0160X'              90  Amend Holidays
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Holidays
     C                     PARM 'D'       WQ0004  1        Action Code
     C           WUDRTC    PARM *BLANK    WQ0005  7        Duplicate Retur
     C                     PARM           WMODE   1                                           CSD031
     C                     PARM           WACZN1  1                                           CSD031
     C                     PARM           WEFDT1  6                                           CSD031
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0160X' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CASE: WRK.Duplicate Return Code is *User QUIT requested
     C           WUDRTC    IFEQ 'Y2U9999'                  *IF
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: WRK.Duplicate Return Code is *ROLLBACK required
     C           WUDRTC    IFEQ 'Y2U0018'                  *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0003           *SFLSEL
      * Send message 'Update Error'
     C                     MOVEL'USR0810' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9834  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: *OTHERWISE
      * Record is the global location so cannot be deleted if any other h
      * exist for the currency
      * Check for Non-Global Hols - Holidays  *
     C                     EXSR SARVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * If record does not exist then it can be deleted if the year is mo
      * two years before this year
     C                     MOVE #1YRNB    WUFYRV           File's Year Val
      * Start of 084942
      * CASE: WRK.File's Year Value Numeric LE WRK.Present Year
     C           WUFYRV    IFLE WUYEAR                     *IF
     C           WUYEAR    SUB  WUFYRV    WUYDIF           No of Years Dif
     C                     ELSE
      * CASE: *OTHERWISE
     C           *ZERO     ADD  2         WUYDIF           No of Years Dif
     C                     END                             *FI
      * End of 084942
      * CASE: WRK.No of Years Difference is Less than two years diff
     C           WUYDIF    IFLT 2                          *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0004           *SFLSEL
      * Send message 'Deletion invalid <2 years'
     C                     MOVEL'USR0673' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9834  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Amend Holidays - Holidays  *
     C                     CLEARPBRC
     C                     MOVEL#1CYCD    PBCYCD           Currency Code
     C                     MOVEL#1LCCD    PBLCCD           Location Code
     C                     MOVEL#1YRNB    PBYRNB           Year Number
     C           CSD041    IFEQ 'G'                                                           CSD031
     C                     MOVE ' '       WMODE                                               CSD031
     C                     ELSE                                                               CSD031
     C                     MOVE WP0001    WMODE                                               CSD031
     C                     ENDIF                                                              CSD031
     C                     MOVE #1ACZN    WACZN1                                              CSD031
     C                     MOVE #1EFDS    WEFDT1                                              CSD031
      *
     C                     CALL 'SD0160X'              90  Amend Holidays
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Holidays
     C                     PARM 'D'       WQ0006  1        Action Code
     C           WUDRTC    PARM *BLANK    WQ0007  7        Duplicate Retur
     C                     PARM           WMODE   1                                           CSD031
     C                     PARM           WACZN1  1                                           CSD031
     C                     PARM           WEFDT1  6                                           CSD031
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0160X' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CASE: WRK.Duplicate Return Code is *User QUIT requested
     C           WUDRTC    IFEQ 'Y2U9999'                  *IF
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: WRK.Duplicate Return Code is *ROLLBACK required
     C           WUDRTC    IFEQ 'Y2U0018'                  *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0005           *SFLSEL
      * Send message 'Update Error'
     C                     MOVEL'USR0810' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9834  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0006           *SFLSEL
      * Send message 'Deletion invalid non-glob'
     C                     MOVEL'USR0671' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9834  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *                                                                                       CSD031
      ** Execute zone activity                                                                CSD031
      *                                                                                       CSD031
     C           CSD041    IFEQ 'Z'                                                           CSD031
     C                     EXSR SRACCP                                                        CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C           WP0001    IFEQ 'C'                                                           CSD031
     C           *IN98     ANDEQ*OFF                                                          CSD031
     C           #1EFDT    ANDNE*BLANK                                                        CSD031
     C           #1SEL     ANDNE'E'                                                           CSD003
     C                     MOVE *ZERO     WDATE                                               CSD031
     C           3         SUBST#1EFDT:3  WMMM    3                                           CSD031
     C                     Z-ADD1         WI      50                                          CSD031
     C           WMMM      LOKUPMMM,WI                   90                                   CSD031
     C           *IN90     IFEQ *ON                                                           CSD031
     C                     MOVE #1EFDT    WYY                                                 CSD031
     C                     MOVE WI        WMM                                                 CSD031
     C                     MOVEL#1EFDT    WDD                                                 CSD031
     C                     ENDIF                                                              CSD031
     C                     MOVE WDATE     ZDATE                                               CSD031
     C                     EXSR ZDATE1                                                        CSD031
     C           *IN99     IFEQ *ON                                                           CSD031
     C                     MOVEL'ASM0045' ZAMSID                                              CSD031
     C                     EXSR ZASNMS                                                        CSD031
     C                     ELSE                                                               CSD031
     C                     Z-ADDZDAYNO    WEACC                                               CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     ELSE
      * CASE: *OTHERWISE
      * If the display file mode is 'E' - enquire then the entry of eithe
      * 'D' is not allowed
      * CASE: RCD.*SFLSEL is *Amend
     C           #1SEL     IFEQ 'A'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0007           *SFLSEL
      * Send message 'value for field not valid'
     C                     MOVEL'USR0553' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9834  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     ELSE
      * CASE: RCD.*SFLSEL is *Delete
     C           #1SEL     IFEQ 'D'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0008           *SFLSEL
      * Send message 'value for field not valid'
     C                     MOVEL'USR0553' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9834  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           TAGERR    TAG                                                                CSD012
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C  N99                Z-ADD##RR      ##SFRC     99    *
      * SFLNXTCHG
     C                     SETON                     84
     C                     ELSE
      * SFLRCD valid
      * SFLNXTCHG
     C                     SETOF                     84
     C                     MOVEL*BLANK    #1SEL
     C                     END                             FI *IN98
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move SDHOL0 fields to subfile                                                         CSD031
      *================================================================
     C                     MOVEL*BLANK    #1SEL
     C                     MOVELDGLCCD    #1LCCD           Location Code
     C                     Z-ADDDGLCD     #1LCD            Last Change Dat
     C                     MOVELDGTYLC    #1TYLC           Type of Last Ch
     C                     MOVELDGCYCD    #1CYCD           Currency Code
     C                     MOVELDGYRNB    #1YRNB           Year Number
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL*BLANK    #RLCDF           Location Code -
     C                     MOVELDGGPDT    #1ACZN                                            BUG11709
      *                                                                                       CSD031
     C                     SELEC                                                              CSD031
     C           CSD041    WHEQ 'G'                                                           CSD031
     C                     MOVELDGAACC    #1ACZN                                              CSD031
     C           CSD041    WHEQ 'Z'                                                           CSD031
     C           WP0001    ANDEQ'C'                                                           CSD031
     C**********           MOVELWGLCCD    #1LCCD                                     CSD031 BUG11709
     C**********           Z-ADDWGLCD     #1LCD                                      CSD031 BUG11709
     C**********           MOVELWGTYLC    #1TYLC                                     CSD031 BUG11709
     C**********           MOVELWGCYCD    #1CYCD                                     CSD031 BUG11709
     C**********           MOVELWGYRNB    #1YRNB                                     CSD031 BUG11709
     C**********           MOVELWGGPDT    #1ACZN                                     CSD031 BUG11709
     C                     ENDSL                                                              CSD031
      *                                                                                       CSD031
     C           CSD041    IFEQ 'G'                                                           CSD031
     C                     CALL 'ZDATE2'                                                      CSD031
     C                     PARM           DGEACC                                              CSD031
     C                     PARM 'D'       ZJDFIN  1                                           CSD031
     C                     PARM           ZDATE   60                                          CSD031
     C                     PARM           DATEB   7                                           CSD031
     C                     MOVELDATEB     #1EFDT                                              CSD031
     C                     MOVE ZDATE     #1EFDS                                              CSD031
     C                     ENDIF                                                              CSD031
     C           CSD041    IFEQ 'Z'                                                           CSD031
     C           WP0001    ANDEQ'C'                                                           CSD031
     C                     CALL 'ZDATE2'                                                      CSD031
     C**********           PARM           WGEACC                                     CSD031 BUG11709
     C                     PARM           DGEACC                                            BUG11709
     C                     PARM 'D'       ZJDFIN  1                                           CSD031
     C                     PARM           ZDATE   60                                          CSD031
     C                     PARM           DATEB   7                                           CSD031
     C                     MOVELDATEB     #1EFDT                                              CSD031
     C                     MOVE ZDATE     #1EFDS                                              CSD031
     C                     ENDIF                                                              CSD031
     C           CSD041    IFEQ 'Z'                                                           CSD031
     C           WP0001    ANDEQ'A'                                                           CSD031
     C                     CALL 'ZDATE2'                                                      CSD031
     C                     PARM           DGEACC                                              CSD031
     C                     PARM 'D'       ZJDFIN  1                                           CSD031
     C                     PARM           ZDATE   60                                          CSD031
     C                     PARM           DATEB   7                                           CSD031
     C                     MOVELDATEB     #1EFDT                                              CSD031
     C                     MOVE ZDATE     #1EFDS                                              CSD031
     C                     SELEC                                                              CSD031
     C           DGTYLC    WHEQ 'I'                                                           CSD031
     C                     MOVEL'INSERT'  #1ACTN                                              CSD031
     C           DGTYLC    WHEQ 'D'                                                           CSD031
     C                     MOVEL'DELETE'  #1ACTN                                              CSD031
     C           DGTYLC    WHEQ 'A'                                                           CSD031
     C                     MOVEL'AMEND '  #1ACTN                                              CSD031
     C                     ENDSL                                                              CSD031
     C                     ENDIF                                                              CSD031
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     Z-ADD*ZERO     #2LCD            Last Change Dat
     C                     MOVEL*BLANK    #2TYLC           Type of Last Ch
     C                     MOVEL*BLANK    #2CYCD           Currency Code
     C                     MOVEL*BLANK    #2LCCD           Location Code
     C                     MOVEL*BLANK    #2YRNB           Year Number
      *                                                                                       CSD031
     C           CSD041    IFEQ 'G'                                                           CSD031
     C           CSD041    OREQ 'Z'                                                           CSD031
     C                     MOVEL*BLANK    #2ACZN                                              CSD031
     C                     MOVEL*BLANK    #2EFDT                                              CSD031
     C                     MOVEL*BLANK    #2ACTN                                              CSD031
     C                     ENDIF                                                              CSD031
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Check for Non-Global Hols - Holidays  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * Declare restrictor key work fields
     C           *LIKE     DEFN WACYCD    WQSA01           Currency Code
     C           *LIKE     DEFN WAYRNB    WQSA02           Year Number
      * Define keylist
     C           KPSSA     KLIST
     C                     KFLD           WQSA01           Currency Code
     C                     KFLD           WQSA02           Year Number
     C                     KFLD           WALCCD           Location Code
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Currency Code
     C                     KFLD           WQSA02           Year Number
      * Move fields to key list
     C                     MOVEL#1CYCD    WQSA01           Currency Code
     C                     MOVEL#1YRNB    WQSA02           Year Number
     C                     MOVEL#1LCCD    WALCCD           Location Code
     C           CSD041    IFEQ 'Z'                                                           CSD031
     C           KPSSA     SETLLSDAHL7                                                        CSD031
     C           KRSSA     READESDAHL7                   90                                   CSD031
     C                     ELSE                                                               CSD031
     C           KPSSA     SETLL@HOLPH1                    *
     C           KRSSA     READE@HOLPH1                  90*
     C                     ENDIF                                                              CSD031
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0657' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SAEXIT
     C                     END
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Location Code is Not Global Value
     C           WALCCD    IFNE '***'                      *IF
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     END                             *FI
     C           CSD041    IFEQ 'Z'                                                           CSD031
     C           KRSSA     READESDAHL7                   90                                   CSD031
     C                     ELSE                                                               CSD031
     C           KRSSA     READE@HOLPH1                  90*
     C                     ENDIF                                                              CSD031
     C                     END
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           *NAMVAR   DEFN           LDA                                                 CSD012
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Setup job date/time
      *
     C                     Z-ADDUDATE     ##JDT
      * Set century digit (If YY prior to 1940 treat as 20YY)
     C           ##JYY     IFLT 40
     C                     Z-ADD1         ##JCC
     C                     ELSE
     C                     Z-ADD0         ##JCC
     C                     END
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Obtain default message file
     C           *NAMVAR   DEFN Y2MGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Latest Year for Deletion
     C                     Z-ADD*ZERO     WULYRD  40
      * Define work field Present Year
     C                     Z-ADD*ZERO     WUYEAR  40
      * Define work field Duplicate Return Code
     C                     MOVEL*BLANK    WUDRTC  7
      * Define work field File's Year Value Numeric
     C                     Z-ADD*ZERO     WUFYRV  40
      * Define work field No of Years Difference
     C                     Z-ADD*ZERO     WUYDIF  30
      * Define work field Midas Run Date
     C                     MOVEL*BLANK    WUMRDT  7
      * Define work field Run day number
     C                     Z-ADD*ZERO     WURDNB  50
      * Define work field Set Up Complete
     C                     MOVEL*BLANK    WUSUC   1
      * Define work field Date format flag
     C                     MOVEL*BLANK    WUDFF   1
      * Define work field Multi-branching Indicator
     C                     MOVEL*BLANK    WUMBIN  1
      * Define work field Location Code -Func. Fld
     C                     MOVEL*BLANK    WULCDF  3
      * Define work field No. of Records                                                      CSD031
     C                     Z-ADD*ZERO     WUNORC  50                                          CSD031
      * Define work field No. of Inserts                                                      CSD031
     C                     Z-ADD*ZERO     WUNOIN  50                                          CSD031
      * Define work field No. of Amends                                                       CSD031
     C                     Z-ADD*ZERO     WUNOAM  50                                          CSD031
      * Define work field No. of Deletes                                                      CSD031
     C                     Z-ADD*ZERO     WUNODL  50                                          CSD031
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Open files
     C                     OPEN SD0160D#
     C                     OPEN SDHOLL8                                                     BUG11709
     C                     OPEN SDHOLL3
     C                     MOVEL'N'       W0PMT   1
     C                     Z-ADD14        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      *                                                                                       CSD031
      ** Check if CSD041 is switched on                                                       CSD031
      *                                                                                       CSD031
     C                     MOVE 'N'       CHGMOD  1                                           CSD031
     C                     MOVE 'N'       CSD041  1                                           CSD031
     C                     CALL 'AOSARDR0'                                                    CSD031
     C                     PARM *BLANKS   PRTCD                                               CSD031
     C                     PARM '*VERIFY' POPTN                                               CSD031
     C                     PARM 'CSD041'  PSARD                                               CSD031
      *                                                                                       CSD031
     C           PRTCD     IFEQ *BLANKS                                                       CSD031
     C           *INU1     IFEQ '1'                                                           CSD031
     C                     OPEN GPHOLIL1                                                      CSD031
     C                     MOVE 'G'       CSD041                                              CSD031
     C                     MOVE *ON       *IN91                                               CSD031
     C                     MOVE GHDR1     #2ZNHD                                              CSD031
     C                     ELSE                                                               CSD031
     C                     OPEN SDAHDYL0                                                      CSD031
     C                     OPEN SDHOLL0                                                       CSD031
     C                     OPEN SDAHDYL1                                                      CSD031
     C                     OPEN SDAHDYL3                                                      CSD031
     C                     OPEN SDAHDYL7                                                      CSD031
     C                     OPEN SDFCTLL0                                                      CSD031
     C                     MOVE 'C'       WP0001                                              CSD031
     C                     MOVE 'Z'       CSD041                                              CSD031
     C                     MOVE *ON       *IN93                                               CSD031
     C                     MOVE GHDR2     #2ZNHD                                              CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
     C           PRTCD     IFNE *BLANKS                                                       CSD031
     C           PRTCD     ANDNE'*NRF   '                                                     CSD031
     C                     MOVEL'SCSARDPD'DBKEY                                               CSD031
     C                     MOVEL'08'      DBASE                                               CSD031
     C                     EXSR *PSSR                                                         CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     CALL 'AOBANKR0'                                                    CSD031
     C                     PARM '*MSG   ' PRTCD                                               CSD031
     C                     PARM '*FIRST ' POPTN                                               CSD031
     C           SDBANK    PARM SDBANK    DSFDY                                               CSD031
      *                                                                                       CSD031
     C           PRTCD     IFNE *BLANK                                                        CSD031
     C                     MOVEL'SDBANKPD'DBFILE                                              CSD031
     C                     Z-ADD4         DBASE                                               CSD031
     C                     EXSR *PSSR                                                         CSD031
     C                     ENDIF                                                              CSD031
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD500       W0SLM   50
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * Start of S01459
      * Remove the call to last amend box and creation parameters.
      * SD0160D precompiler - Holidays  *
      * End of S01459
      * Copyright Statement 1988 - Standard Functions  *
      * Get Rundate - Rundate  *
     C           *NAMVAR   DEFN           RUNDAT
     C                     IN   RUNDAT
     C                     MOVE MRDT      ##MRDT  7        RUN DATE
     C                     MOVE MRDT      WUMRDT
     C                     MOVE RDNB      WURDNB           RUNDAY NO.
     C                     MOVE SUC       WUSUC            SET UP COMPLT
     C                     MOVE DFF       WUDFF            DTE FMT FLAG
     C                     MOVE MBIN      WUMBIN           MULTI BR. IND
      * Calculate Present Year - Holidays  *
     C*
     C** SINCE MIDAS RUN DATES START IN 1972, IF THE YEAR IS GREATER
     C** THAN OR EQUAL TO 72 ASSUME IT IS IN THE 1900'S IF NOT IT IS
     C** IN THE 2000'S.
     C           UYRN      IFGE 72
     C           1900      ADD  UYRN      WUYEAR
     C                     ELSE
     C           2000      ADD  UYRN      WUYEAR
     C                     END
      * Set up CMD text for DSPF - Holidays  *
     C***************************************************************
     C*
     C* SET UP THE COMMAND TEXT FOR THE HOLIDAYS DISPLAY FILE - NOTE
     C* THAT THIS IS NOT A STANDARD TEXT
     C*
     C***************************************************************
     C*
     C                     MOVEL'SDUSRMSG'WUMSGF 10
     C                     MOVE *BLANKS   WUMTXT 80
     C*
     C           P1DFMD    IFEQ 'E'
     C                     MOVEACTX1,1    ##CTX1
     C* Setup footer text:
     C* E=Enquire   F3=Main Menu   F5=Refresh
     C                     MOVEL'USR3341' WUMSID  7        Message Identifier
     C                     CALL 'SDRTVTXT'             90  Retrieve MSGF message
     C           WUMSID    PARM WUMSID    WQ0286  7        Message Identifier
     C           WUMSGF    PARM WUMSGF    WQ0287 10        Message File Name
     C           WUMTXT    PARM WUMTXT    WQ0288 80        Message Text
     C                     MOVELWUMTXT    ##CTX2
     C*
     C           *IN90     IFEQ '1'
     C* Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SDRTVTXT'W0CLPG
     C* Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
     C                     ELSE
     C* Setup footer text:
     C* A=Amend   D=Delete   E=Enquire
     C                     MOVEL'USR3357' WUMSID           Message Identifier
     C                     CALL 'SDRTVTXT'             90  Retrieve MSGF message
     C           WUMSID    PARM WUMSID    WQ0286  7        Message Identifier
     C           WUMSGF    PARM WUMSGF    WQ0287 10        Message File Name
     C           WUMTXT    PARM WUMTXT    WQ0288 80        Message Text
     C                     MOVELWUMTXT    ##CTX1
     C*
     C           *IN90     IFEQ '1'
     C* Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SDRTVTXT'W0CLPG
     C* Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
     C* Setup footer text:
     C* F3=Main Menu   F5=Refresh   F9=Go to 'Add' Mode
     C* F10=Delete by Year
     C                     SELEC                                                              CSD031
     C           CSD041    WHEQ 'G'                                                           CSD031
     C                     MOVEL'CSD0016' WUMSID                                              CSD031
     C           CSD041    WHEQ 'Z'                                                           CSD031
     C                     MOVEL'CSD0017' WUMSID                                              CSD031
     C                     OTHER                                                              CSD031
     C                     MOVEL'USR3358' WUMSID                                              CSD031
     C                     ENDSL                                                              CSD031
     C                     CALL 'SDRTVTXT'             90  Retrieve MSGF message
     C           WUMSID    PARM WUMSID    WQ0286  7        Message Identifier
     C           WUMSGF    PARM WUMSGF    WQ0287 10        Message File Name
     C           WUMTXT    PARM WUMTXT    WQ0288 80        Message Text
     C                     MOVELWUMTXT    ##CTX2
     C*
     C           *IN90     IFEQ '1'
     C* Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SDRTVTXT'W0CLPG
     C* Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
     C                     END
     C*
     C                     MOVEL*BLANK    WULCDF           Location Code -
      * Set up Title for DSPF - Holidays  *
     C*****************************************************************
     C*
     C* Set up the title for the Holiday's display file.
     C*
     C*****************************************************************
     C                     MOVEL'SDUSRMSG'WUMSGF 10
     C                     MOVE *BLANKS   WUMTXT 80
     C*
     C           P1DFMD    IFEQ 'M'
     C* Setup footer text:
     C* Holidays Maintenance
     C                     SELEC                                                              CSD031
     C           CSD041    WHEQ 'G'                                                           CSD031
     C                     MOVEL'CSD0018' WUMSID                                              CSD031
     C                     OTHER                                                              CSD031
     C                     MOVEL'USR3424' WUMSID  7                                           CSD031
     C                     ENDSL                                                              CSD031
     C                     CALL 'SDRTVTXT'             90  Retrieve MSGF message
     C           WUMSID    PARM WUMSID    WQ0286  7        Message Identifier
     C           WUMSGF    PARM WUMSGF    WQ0287 10        Message File Name
     C           WUMTXT    PARM WUMTXT    WQ0288 80        Message Text
     C                     MOVELWUMTXT    ##URPT
     C*
     C           *IN90     IFEQ '1'
     C* Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SDRTVTXT'W0CLPG
     C* Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
     C                     ELSE
     C* Setup footer text:
     C* Holidays Enquiry
     C                     SELEC                                                              CSD031
     C           CSD041    WHEQ 'G'                                                           CSD031
     C                     MOVEL'CSD0019' WUMSID                                              CSD031
     C                     OTHER                                                              CSD031
     C                     MOVEL'USR3425' WUMSID                                              CSD031
     C                     ENDSL                                                              CSD031
     C                     CALL 'SDRTVTXT'             90  Retrieve MSGF message
     C           WUMSID    PARM WUMSID    WQ0286  7        Message Identifier
     C           WUMSGF    PARM WUMSGF    WQ0287 10        Message File Name
     C           WUMTXT    PARM WUMTXT    WQ0288 80        Message Text
     C                     MOVELWUMTXT    ##URPT
     C*
     C           *IN90     IFEQ '1'
     C* Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SDRTVTXT'W0CLPG
     C* Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
     C                     END
      * Start of Fix LN0168
     C                     Z-ADD99999     W0SLM            *Scan limit
      * End of Fix LN0168
      * 00/Copy Member SD0160DCP1 - Holidays  *
     C/COPY WNCPYSRC,SD0160DCP1
      * 00/Copy Member SD0160DFPG - Holidays  *
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *                                                                                       CSD012
      * Define keylist for SDAULGL0                                                           CSD012
     C           KAULG     KLIST                                                              CSD012
     C                     KFLD           K1HOL                                               CGL029
     C**********           KFLD           K1HOL  20                                    CSD012 CGL029
      *                                                                                       CSD012
      * Check if CSD012 is switched on                                                        CSD012
     C                     CALL 'AOSARDR0'                                                    CSD012
     C                     PARM           PRTCD   7                                           CSD012
     C                     PARM '*VERIFY' POPTN   7                                           CSD012
     C                     PARM 'CSD012'  PSARD   6                                           CSD012
      *                                                                                       CSD012
     C           PRTCD     IFEQ *BLANKS                                                       CSD012
     C                     MOVE 'Y'       CSD012  1                                           CSD012
     C                     ELSE                                                               CSD012
     C                     MOVE 'N'       CSD012                                              CSD012
     C                     ENDIF                                                              CSD012
      *                                                                                       CSD012
      * Check if Holiday Authorisation is ON                                                  CSD012
     C           CSD012    IFEQ 'Y'                                                           CSD012
      *                                                                                       CSD012
     C                     CALL 'AOSVALR0'                                                    CSD012
     C                     PARM *BLANKS   RTNCDE  7                                           CSD012
     C                     PARM           SVALK1 20                                           CSD012
     C                     PARM           SVAL1 200                                           CSD012
     C                     PARM           SVALK2 20                                           CSD012
     C                     PARM           SVAL2 200                                           CSD012
     C                     PARM           SVALK3 20                                           CSD012
     C                     PARM           SVAL3 200                                           CSD012
     C                     PARM           SVALK4 20                                           CSD012
     C                     PARM           SVAL4 200                                           CSD012
     C                     PARM           SVALK5 20                                           CSD012
     C                     PARM           SVAL5 200                                           CSD012
     C                     PARM           SVALK6 20                                           CSD012
     C                     PARM           SVAL6 200                                           CSD012
     C                     PARM           SVALK7 20                                           CSD012
     C                     PARM           SVAL7 200                                           CSD012
     C                     PARM           SVALK8 20                                           CSD012
     C                     PARM           SVAL8 200                                           CSD012
     C                     PARM           SVALK9 20                                           CSD012
     C                     PARM           SVAL9 200                                           CSD012
     C                     PARM           SVALK0 20                                           CSD012
     C                     PARM           SVAL10200                                           CSD012
      *                                                                                       CSD012
     C           RTNCDE    IFNE *BLANKS                                                       CSD012
     C           SVAL10    IFEQ '*NRF'                                                        CSD012
     C                     MOVE SVALK0    DBKEY                                               CSD012
     C                     ENDIF                                                              CSD012
     C           SVAL9     IFEQ '*NRF'                                                        CSD012
     C                     MOVE SVALK9    DBKEY                                               CSD012
     C                     ENDIF                                                              CSD012
     C           SVAL8     IFEQ '*NRF'                                                        CSD012
     C                     MOVE SVALK8    DBKEY                                               CSD012
     C                     ENDIF                                                              CSD012
     C           SVAL7     IFEQ '*NRF'                                                        CSD012
     C                     MOVE SVALK7    DBKEY                                               CSD012
     C                     ENDIF                                                              CSD012
     C           SVAL6     IFEQ '*NRF'                                                        CSD012
     C                     MOVE SVALK6    DBKEY                                               CSD012
     C                     ENDIF                                                              CSD012
     C           SVAL5     IFEQ '*NRF'                                                        CSD012
     C                     MOVE SVALK5    DBKEY                                               CSD012
     C                     ENDIF                                                              CSD012
     C           SVAL4     IFEQ '*NRF'                                                        CSD012
     C                     MOVE SVALK4    DBKEY                                               CSD012
     C                     ENDIF                                                              CSD012
     C           SVAL3     IFEQ '*NRF'                                                        CSD012
     C                     MOVE SVALK3    DBKEY                                               CSD012
     C                     ENDIF                                                              CSD012
     C           SVAL2     IFEQ '*NRF'                                                        CSD012
     C                     MOVE SVALK2    DBKEY                                               CSD012
     C                     ENDIF                                                              CSD012
     C           SVAL1     IFEQ '*NRF'                                                        CSD012
     C                     MOVE SVALK1    DBKEY                                               CSD012
     C                     ENDIF                                                              CSD012
     C           *LOCK     IN   LDA                                                           CSD012
     C                     Z-ADD1         DBASE                                               CSD012
     C                     MOVE 'SDSVALPD'DBFILE                                              CSD012
     C                     MOVE 'SD0160D' DBPGM                                               CSD012
     C                     OUT  LDA                                                           CSD012
     C                     EXSR *PSSR                                                         CSD012
     C                     ENDIF                                                              CSD012
      *                                                                                       CSD012
      * If Holiday Authorisation ON set to Authorise                                          CSD012
     C           SVAL11    IFEQ 'Y'                                                           CSD012
     C                     MOVE 'Y'       AUTHRQ  1                                           CSD012
     C                     ELSE                                                               CSD012
     C                     MOVE 'N'       AUTHRQ                                              CSD012
     C                     ENDIF                                                              CSD012
      *                                                                                       CSD012
     C                     ENDIF                                                              CSD012
      *                                                                                       CSD012
      *================================================================
     CSR         ZZEXIT    ENDSR
      /EJECT
     CSR         CHGZMD    BEGSR                                                              CSD031
      *================================================================                       CSD031
      * Toggle mode (Change or Accept)                                                        CSD031
      *================================================================                       CSD031
      *                                                                                       CSD031
      ** Change screen on F11.                                                                CSD031
      *                                                                                       CSD031
     C                     MOVE 'Y'       CHGMOD                                              CSD031
     C           CSD041    IFEQ 'Z'                                                           CSD031
      *                                                                                       CSD031
     C           WP0001    IFEQ 'C'                                                           CSD031
      *                                                                                       CSD031
     C                     MOVE *BLANK    ##CTX1                                              CSD031
     C                     MOVE *ON       *IN96                                               CSD031
     C                     MOVE *OFF      *IN93                                               CSD031
     C                     MOVE 'A'       WP0001                                              CSD031
     C                     MOVE *BLANK    #2ZNHD                                              CSD031
     C                     MOVE GHDR3     #2ZNAC                                              CSD031
     C                     MOVEL'CSD0013' WUMSID                                              CSD031
     C                     CALL 'SDRTVTXT'             90                                     CSD031
     C           WUMSID    PARM WUMSID    WQ0286  7                                           CSD031
     C           WUMSGF    PARM WUMSGF    WQ0287 10                                           CSD031
     C           WUMTXT    PARM WUMTXT    WQ0288 80                                           CSD031
     C                     MOVELWUMTXT    ##CTX2                                              CSD031
     C                     MOVEL'CSD0024' WUMSID                                              CSD031
     C                     CALL 'SDRTVTXT'             90                                     CSD031
     C           WUMSID    PARM WUMSID    WQ0286  7                                           CSD031
     C           WUMSGF    PARM WUMSGF    WQ0287 10                                           CSD031
     C           WUMTXT    PARM WUMTXT    WQ0288 80                                           CSD031
     C                     MOVELWUMTXT    ##URPT                                              CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
     C                     MOVE *ON       *IN93                                               CSD031
     C                     MOVE *OFF      *IN96                                               CSD031
     C                     MOVE 'C'       WP0001                                              CSD031
     C                     MOVE GHDR2     #2ZNHD                                              CSD031
     C                     MOVEL'USR3357' WUMSID                                              CSD031
     C                     CALL 'SDRTVTXT'             90                                     CSD031
     C           WUMSID    PARM WUMSID    WQ0286  7                                           CSD031
     C           WUMSGF    PARM WUMSGF    WQ0287 10                                           CSD031
     C           WUMTXT    PARM WUMTXT    WQ0288 80                                           CSD031
     C                     MOVELWUMTXT    ##CTX1                                              CSD031
     C                     MOVEL'CSD0017' WUMSID                                              CSD031
     C                     CALL 'SDRTVTXT'             90                                     CSD031
     C           WUMSID    PARM WUMSID    WQ0286  7                                           CSD031
     C           WUMSGF    PARM WUMSGF    WQ0287 10                                           CSD031
     C           WUMTXT    PARM WUMTXT    WQ0288 80                                           CSD031
     C                     MOVELWUMTXT    ##CTX2                                              CSD031
     C                     MOVEL'USR3424' WUMSID                                              CSD031
     C                     CALL 'SDRTVTXT'             90                                     CSD031
     C           WUMSID    PARM WUMSID    WQ0286  7                                           CSD031
     C           WUMSGF    PARM WUMSGF    WQ0287 10                                           CSD031
     C           WUMTXT    PARM WUMTXT    WQ0288 80                                           CSD031
     C                     MOVELWUMTXT    ##URPT                                              CSD031
      *                                                                                       CSD031
     C                     ENDIF                                                              CSD031
     C*                                                                                       CSD031
     C           *IN90     IFEQ '1'                                                           CSD031
     C* Call to program ended in error                                                        CSD031
     C                     MOVEL'Y2U0032' W0RTN                                               CSD031
     C                     MOVEL*BLANKS   W0CLPG 10                                           CSD031
     C                     MOVEL'SDRTVTXT'W0CLPG                                              CSD031
     C* Send message '*Error occured on CALL...'                                              CSD031
     C                     MOVEL'Y2U0032' ZAMSID                                              CSD031
     C                     MOVEL'Y2USRMSG'ZAMSGF                                              CSD031
     C                     MOVELW0CLPG    ZAMSDA                                              CSD031
     C                     EXSR ZASNMS                                                        CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     EXSR FBRQRL                                                        CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      *================================================================                       CSD031
     CSR         CHGEXT    ENDSR                                                              CSD031
      /EJECT                                                                                  CSD031
     CSR         SRACCP    BEGSR                                                              CSD031
      *================================================================                       CSD031
      * Accept central data in zone                                                           CSD031
      *================================================================                       CSD031
      *                                                                                       CSD031
     C                     SELEC                                                              CSD031
      *                                                                                       CSD031
     C           #1SEL     WHEQ 'D'                                                           CSD031
     C           WP0001    ANDEQ'A'                                                           CSD031
     C                     MOVEL#1CYCD    DGCYCD                                              CSD031
     C                     MOVEL#1LCCD    DGLCCD                                              CSD031
     C                     MOVEL#1YRNB    DGYRNB                                              CSD031
     C           KPOS      CHAINSDAHDYL0             90                                       CSD031
     C           *IN90     IFEQ *OFF                                                          CSD031
     C                     DELETSDAHL0                                                        CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C           #1SEL     WHEQ 'X'                                                           CSD031
     C                     SELEC                                                              CSD031
     C           #1ACTN    WHEQ 'INSERT'                                                      CSD031
     C                     MOVEL'I'       SELACN                                              CSD031
     C           #1ACTN    WHEQ 'DELETE'                                                      CSD031
     C                     MOVEL'D'       SELACN                                              CSD031
     C           #1ACTN    WHEQ 'AMEND '                                                      CSD031
     C                     MOVEL'A'       SELACN                                              CSD031
     C                     ENDSL                                                              CSD031
      *                                                                                       CSD031
     C                     SELEC                                                              CSD031
     C           SELACN    WHEQ 'I'                                                           CSD031
     C                     MOVEL#1CYCD    DGCYCD                                              CSD031
     C                     MOVEL#1LCCD    DGLCCD                                              CSD031
     C                     MOVEL#1YRNB    DGYRNB                                              CSD031
     C           KPOS      CHAINSDAHDYL0             97                                       CSD031
     C           KPOS      CHAINSDHOLL0              90                                       CSD031
     C           *IN90     IFEQ *ON                                                           CSD031
     C           *IN97     ANDEQ*OFF                                                          CSD031
     C                     EXSR MOVZON                                                        CSD031
     C                     WRITESDHOL0                                                        CSD031
      *                                                                                       CSD031
      ** Update trailer file                                                                  CSD031
      *                                                                                       CSD031
     C                     Z-ADD1         WUNORC           No. of Records                     CSD031
     C                     Z-ADD1         WUNOIN           No. of Inserts                     CSD031
     C                     Z-ADD*ZERO     WUNOAM           No. of Amends                      CSD031
     C                     Z-ADD*ZERO     WUNODL           No. of Deletes                     CSD031
     C                     EXSR SECHRC                                                        CSD031
      *                                                                                       CSD031
     C                     COMIT                                                              CSD031
     C                     ENDIF                                                              CSD031
     C                     DELETSDAHL0                                                        CSD031
      *                                                                                       CSD031
     C           SELACN    WHEQ 'A'                                                           CSD031
     C                     MOVEL#1CYCD    DGCYCD                                              CSD031
     C                     MOVEL#1LCCD    DGLCCD                                              CSD031
     C                     MOVEL#1YRNB    DGYRNB                                              CSD031
     C           KPOS      CHAINSDAHDYL0             97                                       CSD031
     C           KPOS      CHAINSDHOLL0              90                                       CSD031
     C           *IN90     IFEQ *OFF                                                          CSD031
     C           *IN97     ANDEQ*OFF                                                          CSD031
     C                     EXSR TRSHOL                                                        CSD031
     C                     UPDATSDHOL0                                                        CSD031
      *                                                                                       CSD031
      ** Update trailer file                                                                  CSD031
      *                                                                                       CSD031
     C                     Z-ADD*ZERO     WUNORC           No. of Records                     CSD031
     C                     Z-ADD*ZERO     WUNOIN           No. of Inserts                     CSD031
     C                     Z-ADD1         WUNOAM           No. of Amends                      CSD031
     C                     Z-ADD*ZERO     WUNODL           No. of Deletes                     CSD031
     C                     EXSR SICHRC                                                        CSD031
      *                                                                                       CSD031
     C                     COMIT                                                              CSD031
      *                                                                                     BUG11787
     C                     ELSE                                                             BUG11787
     C           *IN90     IFEQ *ON                                                         BUG11787
     C           *IN97     ANDEQ*OFF                                                        BUG11787
     C                     EXSR MOVZON                                                      BUG11787
     C                     WRITESDHOL0                                                      BUG11787
      *                                                                                     BUG11787
      ** Update trailer file                                                                BUG11787
      *                                                                                     BUG11787
     C                     Z-ADD1         WUNORC           No. of Records                   BUG11787
     C                     Z-ADD1         WUNOIN           No. of Inserts                   BUG11787
     C                     Z-ADD*ZERO     WUNOAM           No. of Amends                    BUG11787
     C                     Z-ADD*ZERO     WUNODL           No. of Deletes                   BUG11787
     C                     EXSR SECHRC                                                      BUG11787
      *                                                                                     BUG11787
     C                     COMIT                                                            BUG11787
     C                     ENDIF                                                            BUG11787
      *                                                                                     BUG11787
     C                     ENDIF                                                              CSD031
     C                     DELETSDAHL0                                                        CSD031
      *                                                                                       CSD031
     C           SELACN    WHEQ 'D'                                                           CSD031
     C                     MOVEL#1CYCD    DGCYCD                                              CSD031
     C                     MOVEL#1LCCD    DGLCCD                                              CSD031
     C                     MOVEL#1YRNB    DGYRNB                                              CSD031
     C           KPOS      CHAINSDAHDYL0             97                                       CSD031
     C           *IN97     IFEQ *OFF                                                          CSD031
     C                     DELETSDAHL0                                                        CSD031
     C                     ENDIF                                                              CSD031
     C           KPOS      CHAINSDHOLL0              90                                       CSD031
     C           *IN90     IFEQ *OFF                                                          CSD031
     C                     DELETSDHOL0                                                        CSD031
      *                                                                                       CSD031
      ** Update trailer file                                                                  CSD031
      *                                                                                       CSD031
     C                     Z-ADD-1        WUNORC           No. of Records                     CSD031
     C                     Z-ADD*ZERO     WUNOIN           No. of Inserts                     CSD031
     C                     Z-ADD*ZERO     WUNOAM           No. of Amends                      CSD031
     C                     Z-ADD1         WUNODL           No. of Deletes                     CSD031
     C                     EXSR SGCHRC                                                        CSD031
      *                                                                                       CSD031
     C                     COMIT                                                              CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDSL                                                              CSD031
      *                                                                                       CSD031
     C                     EXSR FBRQRL                                                        CSD031
     C                     ENDSL                                                              CSD031
      *                                                                                       CSD031
      *================================================================                       CSD031
     CSR         SRAEXT    ENDSR                                                              CSD031
      /EJECT                                                                                  CSD031
     CSR         TRSHOL    BEGSR                                                              CSD031
      *================================================================                       CSD031
      * Transfer holiday from SDAHDYL0 to SDHOLL0                                             CSD031
      *================================================================                       CSD031
      *                                                                                       CSD031
     C           DGJA01    IFNE WGJA01                                                        CSD031
     C                     MOVE DGJA01    WGJA01                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJA02    IFNE WGJA02                                                        CSD031
     C                     MOVE DGJA02    WGJA02                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJA03    IFNE WGJA03                                                        CSD031
     C                     MOVE DGJA03    WGJA03                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJA04    IFNE WGJA04                                                        CSD031
     C                     MOVE DGJA04    WGJA04                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJA05    IFNE WGJA05                                                        CSD031
     C                     MOVE DGJA05    WGJA05                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJA06    IFNE WGJA06                                                        CSD031
     C                     MOVE DGJA06    WGJA06                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJA07    IFNE WGJA07                                                        CSD031
     C                     MOVE DGJA07    WGJA07                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJA08    IFNE WGJA08                                                        CSD031
     C                     MOVE DGJA08    WGJA08                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJA09    IFNE WGJA09                                                        CSD031
     C                     MOVE DGJA09    WGJA09                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJA10    IFNE WGJA10                                                        CSD031
     C                     MOVE DGJA10    WGJA10                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJA11    IFNE WGJA11                                                        CSD031
     C                     MOVE DGJA11    WGJA11                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJA12    IFNE WGJA12                                                        CSD031
     C                     MOVE DGJA12    WGJA12                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJA13    IFNE WGJA13                                                        CSD031
     C                     MOVE DGJA13    WGJA13                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJA14    IFNE WGJA14                                                        CSD031
     C                     MOVE DGJA14    WGJA14                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJA15    IFNE WGJA15                                                        CSD031
     C                     MOVE DGJA15    WGJA15                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJA16    IFNE WGJA16                                                        CSD031
     C                     MOVE DGJA16    WGJA16                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJA17    IFNE WGJA17                                                        CSD031
     C                     MOVE DGJA17    WGJA17                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJA18    IFNE WGJA18                                                        CSD031
     C                     MOVE DGJA18    WGJA18                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJA19    IFNE WGJA19                                                        CSD031
     C                     MOVE DGJA19    WGJA19                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJA20    IFNE WGJA20                                                        CSD031
     C                     MOVE DGJA20    WGJA20                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJA21    IFNE WGJA21                                                        CSD031
     C                     MOVE DGJA21    WGJA21                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJA22    IFNE WGJA22                                                        CSD031
     C                     MOVE DGJA22    WGJA22                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJA23    IFNE WGJA23                                                        CSD031
     C                     MOVE DGJA23    WGJA23                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJA24    IFNE WGJA24                                                        CSD031
     C                     MOVE DGJA24    WGJA24                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJA25    IFNE WGJA25                                                        CSD031
     C                     MOVE DGJA25    WGJA25                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJA26    IFNE WGJA26                                                        CSD031
     C                     MOVE DGJA26    WGJA26                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJA27    IFNE WGJA27                                                        CSD031
     C                     MOVE DGJA27    WGJA27                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJA28    IFNE WGJA28                                                        CSD031
     C                     MOVE DGJA28    WGJA28                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJA29    IFNE WGJA29                                                        CSD031
     C                     MOVE DGJA29    WGJA29                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJA30    IFNE WGJA30                                                        CSD031
     C                     MOVE DGJA30    WGJA30                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJA31    IFNE WGJA31                                                        CSD031
     C                     MOVE DGJA31    WGJA31                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGFE01    IFNE WGFE01                                                        CSD031
     C                     MOVE DGFE01    WGFE01                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGFE02    IFNE WGFE02                                                        CSD031
     C                     MOVE DGFE02    WGFE02                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGFE03    IFNE WGFE03                                                        CSD031
     C                     MOVE DGFE03    WGFE03                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGFE04    IFNE WGFE04                                                        CSD031
     C                     MOVE DGFE04    WGFE04                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGFE05    IFNE WGFE05                                                        CSD031
     C                     MOVE DGFE05    WGFE05                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGFE06    IFNE WGFE06                                                        CSD031
     C                     MOVE DGFE06    WGFE06                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGFE07    IFNE WGFE07                                                        CSD031
     C                     MOVE DGFE07    WGFE07                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGFE08    IFNE WGFE08                                                        CSD031
     C                     MOVE DGFE08    WGFE08                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGFE09    IFNE WGFE09                                                        CSD031
     C                     MOVE DGFE09    WGFE09                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGFE10    IFNE WGFE10                                                        CSD031
     C                     MOVE DGFE10    WGFE10                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGFE11    IFNE WGFE11                                                        CSD031
     C                     MOVE DGFE11    WGFE11                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGFE12    IFNE WGFE12                                                        CSD031
     C                     MOVE DGFE12    WGFE12                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGFE13    IFNE WGFE13                                                        CSD031
     C                     MOVE DGFE13    WGFE13                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGFE14    IFNE WGFE14                                                        CSD031
     C                     MOVE DGFE14    WGFE14                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGFE15    IFNE WGFE15                                                        CSD031
     C                     MOVE DGFE15    WGFE15                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGFE16    IFNE WGFE16                                                        CSD031
     C                     MOVE DGFE16    WGFE16                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGFE17    IFNE WGFE17                                                        CSD031
     C                     MOVE DGFE17    WGFE17                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGFE18    IFNE WGFE18                                                        CSD031
     C                     MOVE DGFE18    WGFE18                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGFE19    IFNE WGFE19                                                        CSD031
     C                     MOVE DGFE19    WGFE19                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGFE20    IFNE WGFE20                                                        CSD031
     C                     MOVE DGFE20    WGFE20                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGFE21    IFNE WGFE21                                                        CSD031
     C                     MOVE DGFE21    WGFE21                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGFE22    IFNE WGFE22                                                        CSD031
     C                     MOVE DGFE22    WGFE22                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGFE23    IFNE WGFE23                                                        CSD031
     C                     MOVE DGFE23    WGFE23                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGFE24    IFNE WGFE24                                                        CSD031
     C                     MOVE DGFE24    WGFE24                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGFE25    IFNE WGFE25                                                        CSD031
     C                     MOVE DGFE25    WGFE25                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGFE26    IFNE WGFE26                                                        CSD031
     C                     MOVE DGFE26    WGFE26                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGFE27    IFNE WGFE27                                                        CSD031
     C                     MOVE DGFE27    WGFE27                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGFE28    IFNE WGFE28                                                        CSD031
     C                     MOVE DGFE28    WGFE28                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGFE29    IFNE WGFE29                                                        CSD031
     C                     MOVE DGFE29    WGFE29                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMA01    IFNE WGMA01                                                        CSD031
     C                     MOVE DGMA01    WGMA01                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMA02    IFNE WGMA02                                                        CSD031
     C                     MOVE DGMA02    WGMA02                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMA03    IFNE WGMA03                                                        CSD031
     C                     MOVE DGMA03    WGMA03                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMA04    IFNE WGMA04                                                        CSD031
     C                     MOVE DGMA04    WGMA04                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMA05    IFNE WGMA05                                                        CSD031
     C                     MOVE DGMA05    WGMA05                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMA06    IFNE WGMA06                                                        CSD031
     C                     MOVE DGMA06    WGMA06                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMA07    IFNE WGMA07                                                        CSD031
     C                     MOVE DGMA07    WGMA07                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMA08    IFNE WGMA08                                                        CSD031
     C                     MOVE DGMA08    WGMA08                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMA09    IFNE WGMA09                                                        CSD031
     C                     MOVE DGMA09    WGMA09                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMA10    IFNE WGMA10                                                        CSD031
     C                     MOVE DGMA10    WGMA10                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMA11    IFNE WGMA11                                                        CSD031
     C                     MOVE DGMA11    WGMA11                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMA12    IFNE WGMA12                                                        CSD031
     C                     MOVE DGMA12    WGMA12                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMA13    IFNE WGMA13                                                        CSD031
     C                     MOVE DGMA13    WGMA13                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMA14    IFNE WGMA14                                                        CSD031
     C                     MOVE DGMA14    WGMA14                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMA15    IFNE WGMA15                                                        CSD031
     C                     MOVE DGMA15    WGMA15                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMA16    IFNE WGMA16                                                        CSD031
     C                     MOVE DGMA16    WGMA16                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMA17    IFNE WGMA17                                                        CSD031
     C                     MOVE DGMA17    WGMA17                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMA18    IFNE WGMA18                                                        CSD031
     C                     MOVE DGMA18    WGMA18                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMA19    IFNE WGMA19                                                        CSD031
     C                     MOVE DGMA19    WGMA19                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMA20    IFNE WGMA20                                                        CSD031
     C                     MOVE DGMA20    WGMA20                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMA21    IFNE WGMA21                                                        CSD031
     C                     MOVE DGMA21    WGMA21                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMA22    IFNE WGMA22                                                        CSD031
     C                     MOVE DGMA22    WGMA22                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMA23    IFNE WGMA23                                                        CSD031
     C                     MOVE DGMA23    WGMA23                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMA24    IFNE WGMA24                                                        CSD031
     C                     MOVE DGMA24    WGMA24                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMA25    IFNE WGMA25                                                        CSD031
     C                     MOVE DGMA25    WGMA25                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMA26    IFNE WGMA26                                                        CSD031
     C                     MOVE DGMA26    WGMA26                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMA27    IFNE WGMA27                                                        CSD031
     C                     MOVE DGMA27    WGMA27                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMA28    IFNE WGMA28                                                        CSD031
     C                     MOVE DGMA28    WGMA28                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMA29    IFNE WGMA29                                                        CSD031
     C                     MOVE DGMA29    WGMA29                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMA30    IFNE WGMA30                                                        CSD031
     C                     MOVE DGMA30    WGMA30                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMA31    IFNE WGMA31                                                        CSD031
     C                     MOVE DGMA31    WGMA31                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAP01    IFNE WGAP01                                                        CSD031
     C                     MOVE DGAP01    WGAP01                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAP02    IFNE WGAP02                                                        CSD031
     C                     MOVE DGAP02    WGAP02                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAP03    IFNE WGAP03                                                        CSD031
     C                     MOVE DGAP03    WGAP03                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAP04    IFNE WGAP04                                                        CSD031
     C                     MOVE DGAP04    WGAP04                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAP05    IFNE WGAP05                                                        CSD031
     C                     MOVE DGAP05    WGAP05                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAP06    IFNE WGAP06                                                        CSD031
     C                     MOVE DGAP06    WGAP06                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAP07    IFNE WGAP07                                                        CSD031
     C                     MOVE DGAP07    WGAP07                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAP08    IFNE WGAP08                                                        CSD031
     C                     MOVE DGAP08    WGAP08                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAP09    IFNE WGAP09                                                        CSD031
     C                     MOVE DGAP09    WGAP09                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAP10    IFNE WGAP10                                                        CSD031
     C                     MOVE DGAP10    WGAP10                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAP11    IFNE WGAP11                                                        CSD031
     C                     MOVE DGAP11    WGAP11                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAP12    IFNE WGAP12                                                        CSD031
     C                     MOVE DGAP12    WGAP12                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAP13    IFNE WGAP13                                                        CSD031
     C                     MOVE DGAP13    WGAP13                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAP14    IFNE WGAP14                                                        CSD031
     C                     MOVE DGAP14    WGAP14                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAP15    IFNE WGAP15                                                        CSD031
     C                     MOVE DGAP15    WGAP15                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAP16    IFNE WGAP16                                                        CSD031
     C                     MOVE DGAP16    WGAP16                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAP17    IFNE WGAP17                                                        CSD031
     C                     MOVE DGAP17    WGAP17                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAP18    IFNE WGAP18                                                        CSD031
     C                     MOVE DGAP18    WGAP18                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAP19    IFNE WGAP19                                                        CSD031
     C                     MOVE DGAP19    WGAP19                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAP20    IFNE WGAP20                                                        CSD031
     C                     MOVE DGAP20    WGAP20                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAP21    IFNE WGAP21                                                        CSD031
     C                     MOVE DGAP21    WGAP21                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAP22    IFNE WGAP22                                                        CSD031
     C                     MOVE DGAP22    WGAP22                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAP23    IFNE WGAP23                                                        CSD031
     C                     MOVE DGAP23    WGAP23                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAP24    IFNE WGAP24                                                        CSD031
     C                     MOVE DGAP24    WGAP24                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAP25    IFNE WGAP25                                                        CSD031
     C                     MOVE DGAP25    WGAP25                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAP26    IFNE WGAP26                                                        CSD031
     C                     MOVE DGAP26    WGAP26                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAP27    IFNE WGAP27                                                        CSD031
     C                     MOVE DGAP27    WGAP27                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAP28    IFNE WGAP28                                                        CSD031
     C                     MOVE DGAP28    WGAP28                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAP29    IFNE WGAP29                                                        CSD031
     C                     MOVE DGAP29    WGAP29                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAP30    IFNE WGAP30                                                        CSD031
     C                     MOVE DGAP30    WGAP30                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMY01    IFNE WGMY01                                                        CSD031
     C                     MOVE DGMY01    WGMY01                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMY02    IFNE WGMY02                                                        CSD031
     C                     MOVE DGMY02    WGMY02                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMY03    IFNE WGMY03                                                        CSD031
     C                     MOVE DGMY03    WGMY03                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMY04    IFNE WGMY04                                                        CSD031
     C                     MOVE DGMY04    WGMY04                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMY05    IFNE WGMY05                                                        CSD031
     C                     MOVE DGMY05    WGMY05                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMY06    IFNE WGMY06                                                        CSD031
     C                     MOVE DGMY06    WGMY06                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMY07    IFNE WGMY07                                                        CSD031
     C                     MOVE DGMY07    WGMY07                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMY08    IFNE WGMY08                                                        CSD031
     C                     MOVE DGMY08    WGMY08                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMY09    IFNE WGMY09                                                        CSD031
     C                     MOVE DGMY09    WGMY09                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMY10    IFNE WGMY10                                                        CSD031
     C                     MOVE DGMY10    WGMY10                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMY11    IFNE WGMY11                                                        CSD031
     C                     MOVE DGMY11    WGMY11                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMY12    IFNE WGMY12                                                        CSD031
     C                     MOVE DGMY12    WGMY12                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMY13    IFNE WGMY13                                                        CSD031
     C                     MOVE DGMY13    WGMY13                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMY14    IFNE WGMY14                                                        CSD031
     C                     MOVE DGMY14    WGMY14                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMY15    IFNE WGMY15                                                        CSD031
     C                     MOVE DGMY15    WGMY15                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMY16    IFNE WGMY16                                                        CSD031
     C                     MOVE DGMY16    WGMY16                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMY17    IFNE WGMY17                                                        CSD031
     C                     MOVE DGMY17    WGMY17                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMY18    IFNE WGMY18                                                        CSD031
     C                     MOVE DGMY18    WGMY18                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMY19    IFNE WGMY19                                                        CSD031
     C                     MOVE DGMY19    WGMY19                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMY20    IFNE WGMY20                                                        CSD031
     C                     MOVE DGMY20    WGMY20                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMY21    IFNE WGMY21                                                        CSD031
     C                     MOVE DGMY21    WGMY21                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMY22    IFNE WGMY22                                                        CSD031
     C                     MOVE DGMY22    WGMY22                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMY23    IFNE WGMY23                                                        CSD031
     C                     MOVE DGMY23    WGMY23                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMY24    IFNE WGMY24                                                        CSD031
     C                     MOVE DGMY24    WGMY24                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMY25    IFNE WGMY25                                                        CSD031
     C                     MOVE DGMY25    WGMY25                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMY26    IFNE WGMY26                                                        CSD031
     C                     MOVE DGMY26    WGMY26                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMY27    IFNE WGMY27                                                        CSD031
     C                     MOVE DGMY27    WGMY27                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMY28    IFNE WGMY28                                                        CSD031
     C                     MOVE DGMY28    WGMY28                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMY29    IFNE WGMY29                                                        CSD031
     C                     MOVE DGMY29    WGMY29                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMY30    IFNE WGMY30                                                        CSD031
     C                     MOVE DGMY30    WGMY30                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGMY31    IFNE WGMY31                                                        CSD031
     C                     MOVE DGMY31    WGMY31                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJU01    IFNE WGJU01                                                        CSD031
     C                     MOVE DGJU01    WGJU01                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJU02    IFNE WGJU02                                                        CSD031
     C                     MOVE DGJU02    WGJU02                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJU03    IFNE WGJU03                                                        CSD031
     C                     MOVE DGJU03    WGJU03                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJU04    IFNE WGJU04                                                        CSD031
     C                     MOVE DGJU04    WGJU04                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJU05    IFNE WGJU05                                                        CSD031
     C                     MOVE DGJU05    WGJU05                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJU06    IFNE WGJU06                                                        CSD031
     C                     MOVE DGJU06    WGJU06                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJU07    IFNE WGJU07                                                        CSD031
     C                     MOVE DGJU07    WGJU07                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJU08    IFNE WGJU08                                                        CSD031
     C                     MOVE DGJU08    WGJU08                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJU09    IFNE WGJU09                                                        CSD031
     C                     MOVE DGJU09    WGJU09                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJU10    IFNE WGJU10                                                        CSD031
     C                     MOVE DGJU10    WGJU10                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJU11    IFNE WGJU11                                                        CSD031
     C                     MOVE DGJU11    WGJU11                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJU12    IFNE WGJU12                                                        CSD031
     C                     MOVE DGJU12    WGJU12                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJU13    IFNE WGJU13                                                        CSD031
     C                     MOVE DGJU13    WGJU13                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJU14    IFNE WGJU14                                                        CSD031
     C                     MOVE DGJU14    WGJU14                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJU15    IFNE WGJU15                                                        CSD031
     C                     MOVE DGJU15    WGJU15                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJU16    IFNE WGJU16                                                        CSD031
     C                     MOVE DGJU16    WGJU16                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJU17    IFNE WGJU17                                                        CSD031
     C                     MOVE DGJU17    WGJU17                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJU18    IFNE WGJU18                                                        CSD031
     C                     MOVE DGJU18    WGJU18                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJU19    IFNE WGJU19                                                        CSD031
     C                     MOVE DGJU19    WGJU19                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJU20    IFNE WGJU20                                                        CSD031
     C                     MOVE DGJU20    WGJU20                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJU21    IFNE WGJU21                                                        CSD031
     C                     MOVE DGJU21    WGJU21                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJU22    IFNE WGJU22                                                        CSD031
     C                     MOVE DGJU22    WGJU22                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJU23    IFNE WGJU23                                                        CSD031
     C                     MOVE DGJU23    WGJU23                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJU24    IFNE WGJU24                                                        CSD031
     C                     MOVE DGJU24    WGJU24                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJU25    IFNE WGJU25                                                        CSD031
     C                     MOVE DGJU25    WGJU25                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJU26    IFNE WGJU26                                                        CSD031
     C                     MOVE DGJU26    WGJU26                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJU27    IFNE WGJU27                                                        CSD031
     C                     MOVE DGJU27    WGJU27                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJU28    IFNE WGJU28                                                        CSD031
     C                     MOVE DGJU28    WGJU28                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJU29    IFNE WGJU29                                                        CSD031
     C                     MOVE DGJU29    WGJU29                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJU30    IFNE WGJU30                                                        CSD031
     C                     MOVE DGJU30    WGJU30                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJL01    IFNE WGJL01                                                        CSD031
     C                     MOVE DGJL01    WGJL01                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJL02    IFNE WGJL02                                                        CSD031
     C                     MOVE DGJL02    WGJL02                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJL03    IFNE WGJL03                                                        CSD031
     C                     MOVE DGJL03    WGJL03                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJL04    IFNE WGJL04                                                        CSD031
     C                     MOVE DGJL04    WGJL04                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJL05    IFNE WGJL05                                                        CSD031
     C                     MOVE DGJL05    WGJL05                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJL06    IFNE WGJL06                                                        CSD031
     C                     MOVE DGJL06    WGJL06                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJL07    IFNE WGJL07                                                        CSD031
     C                     MOVE DGJL07    WGJL07                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJL08    IFNE WGJL08                                                        CSD031
     C                     MOVE DGJL08    WGJL08                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJL09    IFNE WGJL09                                                        CSD031
     C                     MOVE DGJL09    WGJL09                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJL10    IFNE WGJL10                                                        CSD031
     C                     MOVE DGJL10    WGJL10                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJL11    IFNE WGJL11                                                        CSD031
     C                     MOVE DGJL11    WGJL11                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJL12    IFNE WGJL12                                                        CSD031
     C                     MOVE DGJL12    WGJL12                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJL13    IFNE WGJL13                                                        CSD031
     C                     MOVE DGJL13    WGJL13                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJL14    IFNE WGJL14                                                        CSD031
     C                     MOVE DGJL14    WGJL14                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJL15    IFNE WGJL15                                                        CSD031
     C                     MOVE DGJL15    WGJL15                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJL16    IFNE WGJL16                                                        CSD031
     C                     MOVE DGJL16    WGJL16                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJL17    IFNE WGJL17                                                        CSD031
     C                     MOVE DGJL17    WGJL17                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJL18    IFNE WGJL18                                                        CSD031
     C                     MOVE DGJL18    WGJL18                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJL19    IFNE WGJL19                                                        CSD031
     C                     MOVE DGJL19    WGJL19                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJL20    IFNE WGJL20                                                        CSD031
     C                     MOVE DGJL20    WGJL20                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJL21    IFNE WGJL21                                                        CSD031
     C                     MOVE DGJL21    WGJL21                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJL22    IFNE WGJL22                                                        CSD031
     C                     MOVE DGJL22    WGJL22                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJL23    IFNE WGJL23                                                        CSD031
     C                     MOVE DGJL23    WGJL23                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJL24    IFNE WGJL24                                                        CSD031
     C                     MOVE DGJL24    WGJL24                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJL25    IFNE WGJL25                                                        CSD031
     C                     MOVE DGJL25    WGJL25                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJL26    IFNE WGJL26                                                        CSD031
     C                     MOVE DGJL26    WGJL26                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJL27    IFNE WGJL27                                                        CSD031
     C                     MOVE DGJL27    WGJL27                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJL28    IFNE WGJL28                                                        CSD031
     C                     MOVE DGJL28    WGJL28                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJL29    IFNE WGJL29                                                        CSD031
     C                     MOVE DGJL29    WGJL29                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJL30    IFNE WGJL30                                                        CSD031
     C                     MOVE DGJL30    WGJL30                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGJL31    IFNE WGJL31                                                        CSD031
     C                     MOVE DGJL31    WGJL31                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAU01    IFNE WGAU01                                                        CSD031
     C                     MOVE DGAU01    WGAU01                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAU02    IFNE WGAU02                                                        CSD031
     C                     MOVE DGAU02    WGAU02                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAU03    IFNE WGAU03                                                        CSD031
     C                     MOVE DGAU03    WGAU03                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAU04    IFNE WGAU04                                                        CSD031
     C                     MOVE DGAU04    WGAU04                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAU05    IFNE WGAU05                                                        CSD031
     C                     MOVE DGAU05    WGAU05                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAU06    IFNE WGAU06                                                        CSD031
     C                     MOVE DGAU06    WGAU06                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAU07    IFNE WGAU07                                                        CSD031
     C                     MOVE DGAU07    WGAU07                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAU08    IFNE WGAU08                                                        CSD031
     C                     MOVE DGAU08    WGAU08                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAU09    IFNE WGAU09                                                        CSD031
     C                     MOVE DGAU09    WGAU09                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAU10    IFNE WGAU10                                                        CSD031
     C                     MOVE DGAU10    WGAU10                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAU11    IFNE WGAU11                                                        CSD031
     C                     MOVE DGAU11    WGAU11                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAU12    IFNE WGAU12                                                        CSD031
     C                     MOVE DGAU12    WGAU12                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAU13    IFNE WGAU13                                                        CSD031
     C                     MOVE DGAU13    WGAU13                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAU14    IFNE WGAU14                                                        CSD031
     C                     MOVE DGAU14    WGAU14                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAU15    IFNE WGAU15                                                        CSD031
     C                     MOVE DGAU15    WGAU15                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAU16    IFNE WGAU16                                                        CSD031
     C                     MOVE DGAU16    WGAU16                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAU17    IFNE WGAU17                                                        CSD031
     C                     MOVE DGAU17    WGAU17                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAU18    IFNE WGAU18                                                        CSD031
     C                     MOVE DGAU18    WGAU18                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAU19    IFNE WGAU19                                                        CSD031
     C                     MOVE DGAU19    WGAU19                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAU20    IFNE WGAU20                                                        CSD031
     C                     MOVE DGAU20    WGAU20                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAU21    IFNE WGAU21                                                        CSD031
     C                     MOVE DGAU21    WGAU21                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAU22    IFNE WGAU22                                                        CSD031
     C                     MOVE DGAU22    WGAU22                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAU23    IFNE WGAU23                                                        CSD031
     C                     MOVE DGAU23    WGAU23                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAU24    IFNE WGAU24                                                        CSD031
     C                     MOVE DGAU24    WGAU24                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAU25    IFNE WGAU25                                                        CSD031
     C                     MOVE DGAU25    WGAU25                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAU26    IFNE WGAU26                                                        CSD031
     C                     MOVE DGAU26    WGAU26                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAU27    IFNE WGAU27                                                        CSD031
     C                     MOVE DGAU27    WGAU27                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAU28    IFNE WGAU28                                                        CSD031
     C                     MOVE DGAU28    WGAU28                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAU29    IFNE WGAU29                                                        CSD031
     C                     MOVE DGAU29    WGAU29                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAU30    IFNE WGAU30                                                        CSD031
     C                     MOVE DGAU30    WGAU30                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGAU31    IFNE WGAU31                                                        CSD031
     C                     MOVE DGAU31    WGAU31                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGSE01    IFNE WGSE01                                                        CSD031
     C                     MOVE DGSE01    WGSE01                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGSE02    IFNE WGSE02                                                        CSD031
     C                     MOVE DGSE02    WGSE02                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGSE03    IFNE WGSE03                                                        CSD031
     C                     MOVE DGSE03    WGSE03                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGSE04    IFNE WGSE04                                                        CSD031
     C                     MOVE DGSE04    WGSE04                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGSE05    IFNE WGSE05                                                        CSD031
     C                     MOVE DGSE05    WGSE05                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGSE06    IFNE WGSE06                                                        CSD031
     C                     MOVE DGSE06    WGSE06                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGSE07    IFNE WGSE07                                                        CSD031
     C                     MOVE DGSE07    WGSE07                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGSE08    IFNE WGSE08                                                        CSD031
     C                     MOVE DGSE08    WGSE08                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGSE09    IFNE WGSE09                                                        CSD031
     C                     MOVE DGSE09    WGSE09                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGSE10    IFNE WGSE10                                                        CSD031
     C                     MOVE DGSE10    WGSE10                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGSE11    IFNE WGSE11                                                        CSD031
     C                     MOVE DGSE11    WGSE11                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGSE12    IFNE WGSE12                                                        CSD031
     C                     MOVE DGSE12    WGSE12                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGSE13    IFNE WGSE13                                                        CSD031
     C                     MOVE DGSE13    WGSE13                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGSE14    IFNE WGSE14                                                        CSD031
     C                     MOVE DGSE14    WGSE14                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGSE15    IFNE WGSE15                                                        CSD031
     C                     MOVE DGSE15    WGSE15                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGSE16    IFNE WGSE16                                                        CSD031
     C                     MOVE DGSE16    WGSE16                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGSE17    IFNE WGSE17                                                        CSD031
     C                     MOVE DGSE17    WGSE17                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGSE18    IFNE WGSE18                                                        CSD031
     C                     MOVE DGSE18    WGSE18                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGSE19    IFNE WGSE19                                                        CSD031
     C                     MOVE DGSE19    WGSE19                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGSE20    IFNE WGSE20                                                        CSD031
     C                     MOVE DGSE20    WGSE20                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGSE21    IFNE WGSE21                                                        CSD031
     C                     MOVE DGSE21    WGSE21                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGSE22    IFNE WGSE22                                                        CSD031
     C                     MOVE DGSE22    WGSE22                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGSE23    IFNE WGSE23                                                        CSD031
     C                     MOVE DGSE23    WGSE23                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGSE24    IFNE WGSE24                                                        CSD031
     C                     MOVE DGSE24    WGSE24                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGSE25    IFNE WGSE25                                                        CSD031
     C                     MOVE DGSE25    WGSE25                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGSE26    IFNE WGSE26                                                        CSD031
     C                     MOVE DGSE26    WGSE26                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGSE27    IFNE WGSE27                                                        CSD031
     C                     MOVE DGSE27    WGSE27                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGSE28    IFNE WGSE28                                                        CSD031
     C                     MOVE DGSE28    WGSE28                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGSE29    IFNE WGSE29                                                        CSD031
     C                     MOVE DGSE29    WGSE29                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGSE30    IFNE WGSE30                                                        CSD031
     C                     MOVE DGSE30    WGSE30                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGOC01    IFNE WGOC01                                                        CSD031
     C                     MOVE DGOC01    WGOC01                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGOC02    IFNE WGOC02                                                        CSD031
     C                     MOVE DGOC02    WGOC02                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGOC03    IFNE WGOC03                                                        CSD031
     C                     MOVE DGOC03    WGOC03                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGOC04    IFNE WGOC04                                                        CSD031
     C                     MOVE DGOC04    WGOC04                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGOC05    IFNE WGOC05                                                        CSD031
     C                     MOVE DGOC05    WGOC05                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGOC06    IFNE WGOC06                                                        CSD031
     C                     MOVE DGOC06    WGOC06                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGOC07    IFNE WGOC07                                                        CSD031
     C                     MOVE DGOC07    WGOC07                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGOC08    IFNE WGOC08                                                        CSD031
     C                     MOVE DGOC08    WGOC08                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGOC09    IFNE WGOC09                                                        CSD031
     C                     MOVE DGOC09    WGOC09                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGOC10    IFNE WGOC10                                                        CSD031
     C                     MOVE DGOC10    WGOC10                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGOC11    IFNE WGOC11                                                        CSD031
     C                     MOVE DGOC11    WGOC11                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGOC12    IFNE WGOC12                                                        CSD031
     C                     MOVE DGOC12    WGOC12                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGOC13    IFNE WGOC13                                                        CSD031
     C                     MOVE DGOC13    WGOC13                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGOC14    IFNE WGOC14                                                        CSD031
     C                     MOVE DGOC14    WGOC14                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGOC15    IFNE WGOC15                                                        CSD031
     C                     MOVE DGOC15    WGOC15                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGOC16    IFNE WGOC16                                                        CSD031
     C                     MOVE DGOC16    WGOC16                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGOC17    IFNE WGOC17                                                        CSD031
     C                     MOVE DGOC17    WGOC17                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGOC18    IFNE WGOC18                                                        CSD031
     C                     MOVE DGOC18    WGOC18                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGOC19    IFNE WGOC19                                                        CSD031
     C                     MOVE DGOC19    WGOC19                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGOC20    IFNE WGOC20                                                        CSD031
     C                     MOVE DGOC20    WGOC20                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGOC21    IFNE WGOC21                                                        CSD031
     C                     MOVE DGOC21    WGOC21                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGOC22    IFNE WGOC22                                                        CSD031
     C                     MOVE DGOC22    WGOC22                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGOC23    IFNE WGOC23                                                        CSD031
     C                     MOVE DGOC23    WGOC23                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGOC24    IFNE WGOC24                                                        CSD031
     C                     MOVE DGOC24    WGOC24                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGOC25    IFNE WGOC25                                                        CSD031
     C                     MOVE DGOC25    WGOC25                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGOC26    IFNE WGOC26                                                        CSD031
     C                     MOVE DGOC26    WGOC26                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGOC27    IFNE WGOC27                                                        CSD031
     C                     MOVE DGOC27    WGOC27                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGOC28    IFNE WGOC28                                                        CSD031
     C                     MOVE DGOC28    WGOC28                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGOC29    IFNE WGOC29                                                        CSD031
     C                     MOVE DGOC29    WGOC29                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGOC30    IFNE WGOC30                                                        CSD031
     C                     MOVE DGOC30    WGOC30                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGOC31    IFNE WGOC31                                                        CSD031
     C                     MOVE DGOC31    WGOC31                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGNO01    IFNE WGNO01                                                        CSD031
     C                     MOVE DGNO01    WGNO01                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGNO02    IFNE WGNO02                                                        CSD031
     C                     MOVE DGNO02    WGNO02                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGNO03    IFNE WGNO03                                                        CSD031
     C                     MOVE DGNO03    WGNO03                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGNO04    IFNE WGNO04                                                        CSD031
     C                     MOVE DGNO04    WGNO04                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGNO05    IFNE WGNO05                                                        CSD031
     C                     MOVE DGNO05    WGNO05                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGNO06    IFNE WGNO06                                                        CSD031
     C                     MOVE DGNO06    WGNO06                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGNO07    IFNE WGNO07                                                        CSD031
     C                     MOVE DGNO07    WGNO07                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGNO08    IFNE WGNO08                                                        CSD031
     C                     MOVE DGNO08    WGNO08                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGNO09    IFNE WGNO09                                                        CSD031
     C                     MOVE DGNO09    WGNO09                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGNO10    IFNE WGNO10                                                        CSD031
     C                     MOVE DGNO10    WGNO10                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGNO11    IFNE WGNO11                                                        CSD031
     C                     MOVE DGNO11    WGNO11                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGNO12    IFNE WGNO12                                                        CSD031
     C                     MOVE DGNO12    WGNO12                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGNO13    IFNE WGNO13                                                        CSD031
     C                     MOVE DGNO13    WGNO13                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGNO14    IFNE WGNO14                                                        CSD031
     C                     MOVE DGNO14    WGNO14                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGNO15    IFNE WGNO15                                                        CSD031
     C                     MOVE DGNO15    WGNO15                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGNO16    IFNE WGNO16                                                        CSD031
     C                     MOVE DGNO16    WGNO16                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGNO17    IFNE WGNO17                                                        CSD031
     C                     MOVE DGNO17    WGNO17                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGNO18    IFNE WGNO18                                                        CSD031
     C                     MOVE DGNO18    WGNO18                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGNO19    IFNE WGNO19                                                        CSD031
     C                     MOVE DGNO19    WGNO19                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGNO20    IFNE WGNO20                                                        CSD031
     C                     MOVE DGNO20    WGNO20                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGNO21    IFNE WGNO21                                                        CSD031
     C                     MOVE DGNO21    WGNO21                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGNO22    IFNE WGNO22                                                        CSD031
     C                     MOVE DGNO22    WGNO22                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGNO23    IFNE WGNO23                                                        CSD031
     C                     MOVE DGNO23    WGNO23                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGNO24    IFNE WGNO24                                                        CSD031
     C                     MOVE DGNO24    WGNO24                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGNO25    IFNE WGNO25                                                        CSD031
     C                     MOVE DGNO25    WGNO25                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGNO26    IFNE WGNO26                                                        CSD031
     C                     MOVE DGNO26    WGNO26                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGNO27    IFNE WGNO27                                                        CSD031
     C                     MOVE DGNO27    WGNO27                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGNO28    IFNE WGNO28                                                        CSD031
     C                     MOVE DGNO28    WGNO28                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGNO29    IFNE WGNO29                                                        CSD031
     C                     MOVE DGNO29    WGNO29                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGNO30    IFNE WGNO30                                                        CSD031
     C                     MOVE DGNO30    WGNO30                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGDE01    IFNE WGDE01                                                        CSD031
     C                     MOVE DGDE01    WGDE01                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGDE02    IFNE WGDE02                                                        CSD031
     C                     MOVE DGDE02    WGDE02                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGDE03    IFNE WGDE03                                                        CSD031
     C                     MOVE DGDE03    WGDE03                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGDE04    IFNE WGDE04                                                        CSD031
     C                     MOVE DGDE04    WGDE04                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGDE05    IFNE WGDE05                                                        CSD031
     C                     MOVE DGDE05    WGDE05                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGDE06    IFNE WGDE06                                                        CSD031
     C                     MOVE DGDE06    WGDE06                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGDE07    IFNE WGDE07                                                        CSD031
     C                     MOVE DGDE07    WGDE07                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGDE08    IFNE WGDE08                                                        CSD031
     C                     MOVE DGDE08    WGDE08                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGDE09    IFNE WGDE09                                                        CSD031
     C                     MOVE DGDE09    WGDE09                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGDE10    IFNE WGDE10                                                        CSD031
     C                     MOVE DGDE10    WGDE10                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGDE11    IFNE WGDE11                                                        CSD031
     C                     MOVE DGDE11    WGDE11                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGDE12    IFNE WGDE12                                                        CSD031
     C                     MOVE DGDE12    WGDE12                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGDE13    IFNE WGDE13                                                        CSD031
     C                     MOVE DGDE13    WGDE13                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGDE14    IFNE WGDE14                                                        CSD031
     C                     MOVE DGDE14    WGDE14                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGDE15    IFNE WGDE15                                                        CSD031
     C                     MOVE DGDE15    WGDE15                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGDE16    IFNE WGDE16                                                        CSD031
     C                     MOVE DGDE16    WGDE16                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGDE17    IFNE WGDE17                                                        CSD031
     C                     MOVE DGDE17    WGDE17                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGDE18    IFNE WGDE18                                                        CSD031
     C                     MOVE DGDE18    WGDE18                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGDE19    IFNE WGDE19                                                        CSD031
     C                     MOVE DGDE19    WGDE19                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGDE20    IFNE WGDE20                                                        CSD031
     C                     MOVE DGDE20    WGDE20                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGDE21    IFNE WGDE21                                                        CSD031
     C                     MOVE DGDE21    WGDE21                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGDE22    IFNE WGDE22                                                        CSD031
     C                     MOVE DGDE22    WGDE22                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGDE23    IFNE WGDE23                                                        CSD031
     C                     MOVE DGDE23    WGDE23                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGDE24    IFNE WGDE24                                                        CSD031
     C                     MOVE DGDE24    WGDE24                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGDE25    IFNE WGDE25                                                        CSD031
     C                     MOVE DGDE25    WGDE25                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGDE26    IFNE WGDE26                                                        CSD031
     C                     MOVE DGDE26    WGDE26                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGDE27    IFNE WGDE27                                                        CSD031
     C                     MOVE DGDE27    WGDE27                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGDE28    IFNE WGDE28                                                        CSD031
     C                     MOVE DGDE28    WGDE28                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGDE29    IFNE WGDE29                                                        CSD031
     C                     MOVE DGDE29    WGDE29                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGDE30    IFNE WGDE30                                                        CSD031
     C                     MOVE DGDE30    WGDE30                                              CSD031
     C                     ENDIF                                                              CSD031
     C           DGDE31    IFNE WGDE31                                                        CSD031
     C                     MOVE DGDE31    WGDE31                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      *================================================================                       CSD031
     CSR         TRSEXT    ENDSR                                                              CSD031
      /EJECT                                                                                  CSD031
     CSR         MOVZON    BEGSR                                                              CSD031
      *================================================================                       CSD031
      * Move data from SDAHDYL0 to SDHOLL0                                                    CSD031
      *================================================================                       CSD031
      *                                                                                       CSD031
     C                     MOVE DGCYCD    WGCYCD                                              CSD031
     C                     MOVE DGLCCD    WGLCCD                                              CSD031
     C                     MOVE DGYRNB    WGYRNB                                              CSD031
     C                     Z-ADDDGJDNB    WGJDNB                                              CSD031
     C                     Z-ADDDGDDNB    WGDDNB                                              CSD031
     C                     MOVE DGJA01    WGJA01                                              CSD031
     C                     MOVE DGJA02    WGJA02                                              CSD031
     C                     MOVE DGJA03    WGJA03                                              CSD031
     C                     MOVE DGJA04    WGJA04                                              CSD031
     C                     MOVE DGJA05    WGJA05                                              CSD031
     C                     MOVE DGJA06    WGJA06                                              CSD031
     C                     MOVE DGJA07    WGJA07                                              CSD031
     C                     MOVE DGJA08    WGJA08                                              CSD031
     C                     MOVE DGJA09    WGJA09                                              CSD031
     C                     MOVE DGJA10    WGJA10                                              CSD031
     C                     MOVE DGJA11    WGJA11                                              CSD031
     C                     MOVE DGJA12    WGJA12                                              CSD031
     C                     MOVE DGJA13    WGJA13                                              CSD031
     C                     MOVE DGJA14    WGJA14                                              CSD031
     C                     MOVE DGJA15    WGJA15                                              CSD031
     C                     MOVE DGJA16    WGJA16                                              CSD031
     C                     MOVE DGJA17    WGJA17                                              CSD031
     C                     MOVE DGJA18    WGJA18                                              CSD031
     C                     MOVE DGJA19    WGJA19                                              CSD031
     C                     MOVE DGJA20    WGJA20                                              CSD031
     C                     MOVE DGJA21    WGJA21                                              CSD031
     C                     MOVE DGJA22    WGJA22                                              CSD031
     C                     MOVE DGJA23    WGJA23                                              CSD031
     C                     MOVE DGJA24    WGJA24                                              CSD031
     C                     MOVE DGJA25    WGJA25                                              CSD031
     C                     MOVE DGJA26    WGJA26                                              CSD031
     C                     MOVE DGJA27    WGJA27                                              CSD031
     C                     MOVE DGJA28    WGJA28                                              CSD031
     C                     MOVE DGJA29    WGJA29                                              CSD031
     C                     MOVE DGJA30    WGJA30                                              CSD031
     C                     MOVE DGJA31    WGJA31                                              CSD031
     C                     MOVE DGFE01    WGFE01                                              CSD031
     C                     MOVE DGFE02    WGFE02                                              CSD031
     C                     MOVE DGFE03    WGFE03                                              CSD031
     C                     MOVE DGFE04    WGFE04                                              CSD031
     C                     MOVE DGFE05    WGFE05                                              CSD031
     C                     MOVE DGFE06    WGFE06                                              CSD031
     C                     MOVE DGFE07    WGFE07                                              CSD031
     C                     MOVE DGFE08    WGFE08                                              CSD031
     C                     MOVE DGFE09    WGFE09                                              CSD031
     C                     MOVE DGFE10    WGFE10                                              CSD031
     C                     MOVE DGFE11    WGFE11                                              CSD031
     C                     MOVE DGFE12    WGFE12                                              CSD031
     C                     MOVE DGFE13    WGFE13                                              CSD031
     C                     MOVE DGFE14    WGFE14                                              CSD031
     C                     MOVE DGFE15    WGFE15                                              CSD031
     C                     MOVE DGFE16    WGFE16                                              CSD031
     C                     MOVE DGFE17    WGFE17                                              CSD031
     C                     MOVE DGFE18    WGFE18                                              CSD031
     C                     MOVE DGFE19    WGFE19                                              CSD031
     C                     MOVE DGFE20    WGFE20                                              CSD031
     C                     MOVE DGFE21    WGFE21                                              CSD031
     C                     MOVE DGFE22    WGFE22                                              CSD031
     C                     MOVE DGFE23    WGFE23                                              CSD031
     C                     MOVE DGFE24    WGFE24                                              CSD031
     C                     MOVE DGFE25    WGFE25                                              CSD031
     C                     MOVE DGFE26    WGFE26                                              CSD031
     C                     MOVE DGFE27    WGFE27                                              CSD031
     C                     MOVE DGFE28    WGFE28                                              CSD031
     C                     MOVE DGFE29    WGFE29                                              CSD031
     C                     MOVE DGMA01    WGMA01                                              CSD031
     C                     MOVE DGMA02    WGMA02                                              CSD031
     C                     MOVE DGMA03    WGMA03                                              CSD031
     C                     MOVE DGMA04    WGMA04                                              CSD031
     C                     MOVE DGMA05    WGMA05                                              CSD031
     C                     MOVE DGMA06    WGMA06                                              CSD031
     C                     MOVE DGMA07    WGMA07                                              CSD031
     C                     MOVE DGMA08    WGMA08                                              CSD031
     C                     MOVE DGMA09    WGMA09                                              CSD031
     C                     MOVE DGMA10    WGMA10                                              CSD031
     C                     MOVE DGMA11    WGMA11                                              CSD031
     C                     MOVE DGMA12    WGMA12                                              CSD031
     C                     MOVE DGMA13    WGMA13                                              CSD031
     C                     MOVE DGMA14    WGMA14                                              CSD031
     C                     MOVE DGMA15    WGMA15                                              CSD031
     C                     MOVE DGMA16    WGMA16                                              CSD031
     C                     MOVE DGMA17    WGMA17                                              CSD031
     C                     MOVE DGMA18    WGMA18                                              CSD031
     C                     MOVE DGMA19    WGMA19                                              CSD031
     C                     MOVE DGMA20    WGMA20                                              CSD031
     C                     MOVE DGMA21    WGMA21                                              CSD031
     C                     MOVE DGMA22    WGMA22                                              CSD031
     C                     MOVE DGMA23    WGMA23                                              CSD031
     C                     MOVE DGMA24    WGMA24                                              CSD031
     C                     MOVE DGMA25    WGMA25                                              CSD031
     C                     MOVE DGMA26    WGMA26                                              CSD031
     C                     MOVE DGMA27    WGMA27                                              CSD031
     C                     MOVE DGMA28    WGMA28                                              CSD031
     C                     MOVE DGMA29    WGMA29                                              CSD031
     C                     MOVE DGMA30    WGMA30                                              CSD031
     C                     MOVE DGMA31    WGMA31                                              CSD031
     C                     MOVE DGAP01    WGAP01                                              CSD031
     C                     MOVE DGAP02    WGAP02                                              CSD031
     C                     MOVE DGAP03    WGAP03                                              CSD031
     C                     MOVE DGAP04    WGAP04                                              CSD031
     C                     MOVE DGAP05    WGAP05                                              CSD031
     C                     MOVE DGAP06    WGAP06                                              CSD031
     C                     MOVE DGAP07    WGAP07                                              CSD031
     C                     MOVE DGAP08    WGAP08                                              CSD031
     C                     MOVE DGAP09    WGAP09                                              CSD031
     C                     MOVE DGAP10    WGAP10                                              CSD031
     C                     MOVE DGAP11    WGAP11                                              CSD031
     C                     MOVE DGAP12    WGAP12                                              CSD031
     C                     MOVE DGAP13    WGAP13                                              CSD031
     C                     MOVE DGAP14    WGAP14                                              CSD031
     C                     MOVE DGAP15    WGAP15                                              CSD031
     C                     MOVE DGAP16    WGAP16                                              CSD031
     C                     MOVE DGAP17    WGAP17                                              CSD031
     C                     MOVE DGAP18    WGAP18                                              CSD031
     C                     MOVE DGAP19    WGAP19                                              CSD031
     C                     MOVE DGAP20    WGAP20                                              CSD031
     C                     MOVE DGAP21    WGAP21                                              CSD031
     C                     MOVE DGAP22    WGAP22                                              CSD031
     C                     MOVE DGAP23    WGAP23                                              CSD031
     C                     MOVE DGAP24    WGAP24                                              CSD031
     C                     MOVE DGAP25    WGAP25                                              CSD031
     C                     MOVE DGAP26    WGAP26                                              CSD031
     C                     MOVE DGAP27    WGAP27                                              CSD031
     C                     MOVE DGAP28    WGAP28                                              CSD031
     C                     MOVE DGAP29    WGAP29                                              CSD031
     C                     MOVE DGAP30    WGAP30                                              CSD031
     C                     MOVE DGMY01    WGMY01                                              CSD031
     C                     MOVE DGMY02    WGMY02                                              CSD031
     C                     MOVE DGMY03    WGMY03                                              CSD031
     C                     MOVE DGMY04    WGMY04                                              CSD031
     C                     MOVE DGMY05    WGMY05                                              CSD031
     C                     MOVE DGMY06    WGMY06                                              CSD031
     C                     MOVE DGMY07    WGMY07                                              CSD031
     C                     MOVE DGMY08    WGMY08                                              CSD031
     C                     MOVE DGMY09    WGMY09                                              CSD031
     C                     MOVE DGMY10    WGMY10                                              CSD031
     C                     MOVE DGMY11    WGMY11                                              CSD031
     C                     MOVE DGMY12    WGMY12                                              CSD031
     C                     MOVE DGMY13    WGMY13                                              CSD031
     C                     MOVE DGMY14    WGMY14                                              CSD031
     C                     MOVE DGMY15    WGMY15                                              CSD031
     C                     MOVE DGMY16    WGMY16                                              CSD031
     C                     MOVE DGMY17    WGMY17                                              CSD031
     C                     MOVE DGMY18    WGMY18                                              CSD031
     C                     MOVE DGMY19    WGMY19                                              CSD031
     C                     MOVE DGMY20    WGMY20                                              CSD031
     C                     MOVE DGMY21    WGMY21                                              CSD031
     C                     MOVE DGMY22    WGMY22                                              CSD031
     C                     MOVE DGMY23    WGMY23                                              CSD031
     C                     MOVE DGMY24    WGMY24                                              CSD031
     C                     MOVE DGMY25    WGMY25                                              CSD031
     C                     MOVE DGMY26    WGMY26                                              CSD031
     C                     MOVE DGMY27    WGMY27                                              CSD031
     C                     MOVE DGMY28    WGMY28                                              CSD031
     C                     MOVE DGMY29    WGMY29                                              CSD031
     C                     MOVE DGMY30    WGMY30                                              CSD031
     C                     MOVE DGMY31    WGMY31                                              CSD031
     C                     MOVE DGJU01    WGJU01                                              CSD031
     C                     MOVE DGJU02    WGJU02                                              CSD031
     C                     MOVE DGJU03    WGJU03                                              CSD031
     C                     MOVE DGJU04    WGJU04                                              CSD031
     C                     MOVE DGJU05    WGJU05                                              CSD031
     C                     MOVE DGJU06    WGJU06                                              CSD031
     C                     MOVE DGJU07    WGJU07                                              CSD031
     C                     MOVE DGJU08    WGJU08                                              CSD031
     C                     MOVE DGJU09    WGJU09                                              CSD031
     C                     MOVE DGJU10    WGJU10                                              CSD031
     C                     MOVE DGJU11    WGJU11                                              CSD031
     C                     MOVE DGJU12    WGJU12                                              CSD031
     C                     MOVE DGJU13    WGJU13                                              CSD031
     C                     MOVE DGJU14    WGJU14                                              CSD031
     C                     MOVE DGJU15    WGJU15                                              CSD031
     C                     MOVE DGJU16    WGJU16                                              CSD031
     C                     MOVE DGJU17    WGJU17                                              CSD031
     C                     MOVE DGJU18    WGJU18                                              CSD031
     C                     MOVE DGJU19    WGJU19                                              CSD031
     C                     MOVE DGJU20    WGJU20                                              CSD031
     C                     MOVE DGJU21    WGJU21                                              CSD031
     C                     MOVE DGJU22    WGJU22                                              CSD031
     C                     MOVE DGJU23    WGJU23                                              CSD031
     C                     MOVE DGJU24    WGJU24                                              CSD031
     C                     MOVE DGJU25    WGJU25                                              CSD031
     C                     MOVE DGJU26    WGJU26                                              CSD031
     C                     MOVE DGJU27    WGJU27                                              CSD031
     C                     MOVE DGJU28    WGJU28                                              CSD031
     C                     MOVE DGJU29    WGJU29                                              CSD031
     C                     MOVE DGJU30    WGJU30                                              CSD031
     C                     MOVE DGJL01    WGJL01                                              CSD031
     C                     MOVE DGJL02    WGJL02                                              CSD031
     C                     MOVE DGJL03    WGJL03                                              CSD031
     C                     MOVE DGJL04    WGJL04                                              CSD031
     C                     MOVE DGJL05    WGJL05                                              CSD031
     C                     MOVE DGJL06    WGJL06                                              CSD031
     C                     MOVE DGJL07    WGJL07                                              CSD031
     C                     MOVE DGJL08    WGJL08                                              CSD031
     C                     MOVE DGJL09    WGJL09                                              CSD031
     C                     MOVE DGJL10    WGJL10                                              CSD031
     C                     MOVE DGJL11    WGJL11                                              CSD031
     C                     MOVE DGJL12    WGJL12                                              CSD031
     C                     MOVE DGJL13    WGJL13                                              CSD031
     C                     MOVE DGJL14    WGJL14                                              CSD031
     C                     MOVE DGJL15    WGJL15                                              CSD031
     C                     MOVE DGJL16    WGJL16                                              CSD031
     C                     MOVE DGJL17    WGJL17                                              CSD031
     C                     MOVE DGJL18    WGJL18                                              CSD031
     C                     MOVE DGJL19    WGJL19                                              CSD031
     C                     MOVE DGJL20    WGJL20                                              CSD031
     C                     MOVE DGJL21    WGJL21                                              CSD031
     C                     MOVE DGJL22    WGJL22                                              CSD031
     C                     MOVE DGJL23    WGJL23                                              CSD031
     C                     MOVE DGJL24    WGJL24                                              CSD031
     C                     MOVE DGJL25    WGJL25                                              CSD031
     C                     MOVE DGJL26    WGJL26                                              CSD031
     C                     MOVE DGJL27    WGJL27                                              CSD031
     C                     MOVE DGJL28    WGJL28                                              CSD031
     C                     MOVE DGJL29    WGJL29                                              CSD031
     C                     MOVE DGJL30    WGJL30                                              CSD031
     C                     MOVE DGJL31    WGJL31                                              CSD031
     C                     MOVE DGAU01    WGAU01                                              CSD031
     C                     MOVE DGAU02    WGAU02                                              CSD031
     C                     MOVE DGAU03    WGAU03                                              CSD031
     C                     MOVE DGAU04    WGAU04                                              CSD031
     C                     MOVE DGAU05    WGAU05                                              CSD031
     C                     MOVE DGAU06    WGAU06                                              CSD031
     C                     MOVE DGAU07    WGAU07                                              CSD031
     C                     MOVE DGAU08    WGAU08                                              CSD031
     C                     MOVE DGAU09    WGAU09                                              CSD031
     C                     MOVE DGAU10    WGAU10                                              CSD031
     C                     MOVE DGAU11    WGAU11                                              CSD031
     C                     MOVE DGAU12    WGAU12                                              CSD031
     C                     MOVE DGAU13    WGAU13                                              CSD031
     C                     MOVE DGAU14    WGAU14                                              CSD031
     C                     MOVE DGAU15    WGAU15                                              CSD031
     C                     MOVE DGAU16    WGAU16                                              CSD031
     C                     MOVE DGAU17    WGAU17                                              CSD031
     C                     MOVE DGAU18    WGAU18                                              CSD031
     C                     MOVE DGAU19    WGAU19                                              CSD031
     C                     MOVE DGAU20    WGAU20                                              CSD031
     C                     MOVE DGAU21    WGAU21                                              CSD031
     C                     MOVE DGAU22    WGAU22                                              CSD031
     C                     MOVE DGAU23    WGAU23                                              CSD031
     C                     MOVE DGAU24    WGAU24                                              CSD031
     C                     MOVE DGAU25    WGAU25                                              CSD031
     C                     MOVE DGAU26    WGAU26                                              CSD031
     C                     MOVE DGAU27    WGAU27                                              CSD031
     C                     MOVE DGAU28    WGAU28                                              CSD031
     C                     MOVE DGAU29    WGAU29                                              CSD031
     C                     MOVE DGAU30    WGAU30                                              CSD031
     C                     MOVE DGAU31    WGAU31                                              CSD031
     C                     MOVE DGSE01    WGSE01                                              CSD031
     C                     MOVE DGSE02    WGSE02                                              CSD031
     C                     MOVE DGSE03    WGSE03                                              CSD031
     C                     MOVE DGSE04    WGSE04                                              CSD031
     C                     MOVE DGSE05    WGSE05                                              CSD031
     C                     MOVE DGSE06    WGSE06                                              CSD031
     C                     MOVE DGSE07    WGSE07                                              CSD031
     C                     MOVE DGSE08    WGSE08                                              CSD031
     C                     MOVE DGSE09    WGSE09                                              CSD031
     C                     MOVE DGSE10    WGSE10                                              CSD031
     C                     MOVE DGSE11    WGSE11                                              CSD031
     C                     MOVE DGSE12    WGSE12                                              CSD031
     C                     MOVE DGSE13    WGSE13                                              CSD031
     C                     MOVE DGSE14    WGSE14                                              CSD031
     C                     MOVE DGSE15    WGSE15                                              CSD031
     C                     MOVE DGSE16    WGSE16                                              CSD031
     C                     MOVE DGSE17    WGSE17                                              CSD031
     C                     MOVE DGSE18    WGSE18                                              CSD031
     C                     MOVE DGSE19    WGSE19                                              CSD031
     C                     MOVE DGSE20    WGSE20                                              CSD031
     C                     MOVE DGSE21    WGSE21                                              CSD031
     C                     MOVE DGSE22    WGSE22                                              CSD031
     C                     MOVE DGSE23    WGSE23                                              CSD031
     C                     MOVE DGSE24    WGSE24                                              CSD031
     C                     MOVE DGSE25    WGSE25                                              CSD031
     C                     MOVE DGSE26    WGSE26                                              CSD031
     C                     MOVE DGSE27    WGSE27                                              CSD031
     C                     MOVE DGSE28    WGSE28                                              CSD031
     C                     MOVE DGSE29    WGSE29                                              CSD031
     C                     MOVE DGSE30    WGSE30                                              CSD031
     C                     MOVE DGOC01    WGOC01                                              CSD031
     C                     MOVE DGOC02    WGOC02                                              CSD031
     C                     MOVE DGOC03    WGOC03                                              CSD031
     C                     MOVE DGOC04    WGOC04                                              CSD031
     C                     MOVE DGOC05    WGOC05                                              CSD031
     C                     MOVE DGOC06    WGOC06                                              CSD031
     C                     MOVE DGOC07    WGOC07                                              CSD031
     C                     MOVE DGOC08    WGOC08                                              CSD031
     C                     MOVE DGOC09    WGOC09                                              CSD031
     C                     MOVE DGOC10    WGOC10                                              CSD031
     C                     MOVE DGOC11    WGOC11                                              CSD031
     C                     MOVE DGOC12    WGOC12                                              CSD031
     C                     MOVE DGOC13    WGOC13                                              CSD031
     C                     MOVE DGOC14    WGOC14                                              CSD031
     C                     MOVE DGOC15    WGOC15                                              CSD031
     C                     MOVE DGOC16    WGOC16                                              CSD031
     C                     MOVE DGOC17    WGOC17                                              CSD031
     C                     MOVE DGOC18    WGOC18                                              CSD031
     C                     MOVE DGOC19    WGOC19                                              CSD031
     C                     MOVE DGOC20    WGOC20                                              CSD031
     C                     MOVE DGOC21    WGOC21                                              CSD031
     C                     MOVE DGOC22    WGOC22                                              CSD031
     C                     MOVE DGOC23    WGOC23                                              CSD031
     C                     MOVE DGOC24    WGOC24                                              CSD031
     C                     MOVE DGOC25    WGOC25                                              CSD031
     C                     MOVE DGOC26    WGOC26                                              CSD031
     C                     MOVE DGOC27    WGOC27                                              CSD031
     C                     MOVE DGOC28    WGOC28                                              CSD031
     C                     MOVE DGOC29    WGOC29                                              CSD031
     C                     MOVE DGOC30    WGOC30                                              CSD031
     C                     MOVE DGOC31    WGOC31                                              CSD031
     C                     MOVE DGNO01    WGNO01                                              CSD031
     C                     MOVE DGNO02    WGNO02                                              CSD031
     C                     MOVE DGNO03    WGNO03                                              CSD031
     C                     MOVE DGNO04    WGNO04                                              CSD031
     C                     MOVE DGNO05    WGNO05                                              CSD031
     C                     MOVE DGNO06    WGNO06                                              CSD031
     C                     MOVE DGNO07    WGNO07                                              CSD031
     C                     MOVE DGNO08    WGNO08                                              CSD031
     C                     MOVE DGNO09    WGNO09                                              CSD031
     C                     MOVE DGNO10    WGNO10                                              CSD031
     C                     MOVE DGNO11    WGNO11                                              CSD031
     C                     MOVE DGNO12    WGNO12                                              CSD031
     C                     MOVE DGNO13    WGNO13                                              CSD031
     C                     MOVE DGNO14    WGNO14                                              CSD031
     C                     MOVE DGNO15    WGNO15                                              CSD031
     C                     MOVE DGNO16    WGNO16                                              CSD031
     C                     MOVE DGNO17    WGNO17                                              CSD031
     C                     MOVE DGNO18    WGNO18                                              CSD031
     C                     MOVE DGNO19    WGNO19                                              CSD031
     C                     MOVE DGNO20    WGNO20                                              CSD031
     C                     MOVE DGNO21    WGNO21                                              CSD031
     C                     MOVE DGNO22    WGNO22                                              CSD031
     C                     MOVE DGNO23    WGNO23                                              CSD031
     C                     MOVE DGNO24    WGNO24                                              CSD031
     C                     MOVE DGNO25    WGNO25                                              CSD031
     C                     MOVE DGNO26    WGNO26                                              CSD031
     C                     MOVE DGNO27    WGNO27                                              CSD031
     C                     MOVE DGNO28    WGNO28                                              CSD031
     C                     MOVE DGNO29    WGNO29                                              CSD031
     C                     MOVE DGNO30    WGNO30                                              CSD031
     C                     MOVE DGDE01    WGDE01                                              CSD031
     C                     MOVE DGDE02    WGDE02                                              CSD031
     C                     MOVE DGDE03    WGDE03                                              CSD031
     C                     MOVE DGDE04    WGDE04                                              CSD031
     C                     MOVE DGDE05    WGDE05                                              CSD031
     C                     MOVE DGDE06    WGDE06                                              CSD031
     C                     MOVE DGDE07    WGDE07                                              CSD031
     C                     MOVE DGDE08    WGDE08                                              CSD031
     C                     MOVE DGDE09    WGDE09                                              CSD031
     C                     MOVE DGDE10    WGDE10                                              CSD031
     C                     MOVE DGDE11    WGDE11                                              CSD031
     C                     MOVE DGDE12    WGDE12                                              CSD031
     C                     MOVE DGDE13    WGDE13                                              CSD031
     C                     MOVE DGDE14    WGDE14                                              CSD031
     C                     MOVE DGDE15    WGDE15                                              CSD031
     C                     MOVE DGDE16    WGDE16                                              CSD031
     C                     MOVE DGDE17    WGDE17                                              CSD031
     C                     MOVE DGDE18    WGDE18                                              CSD031
     C                     MOVE DGDE19    WGDE19                                              CSD031
     C                     MOVE DGDE20    WGDE20                                              CSD031
     C                     MOVE DGDE21    WGDE21                                              CSD031
     C                     MOVE DGDE22    WGDE22                                              CSD031
     C                     MOVE DGDE23    WGDE23                                              CSD031
     C                     MOVE DGDE24    WGDE24                                              CSD031
     C                     MOVE DGDE25    WGDE25                                              CSD031
     C                     MOVE DGDE26    WGDE26                                              CSD031
     C                     MOVE DGDE27    WGDE27                                              CSD031
     C                     MOVE DGDE28    WGDE28                                              CSD031
     C                     MOVE DGDE29    WGDE29                                              CSD031
     C                     MOVE DGDE30    WGDE30                                              CSD031
     C                     MOVE DGDE31    WGDE31                                              CSD031
     C                     Z-ADDDGLCD     WGLCD                                               CSD031
     C                     MOVE DGTYLC    WGTYLC                                              CSD031
     C                     MOVE DGZONE    WGZONE                                              CSD031
     C                     MOVE DGIUSR    WGIUSR                                              CSD031
     C                     MOVE DGAUSR    WGAUSR                                              CSD031
     C                     MOVE DGXUSR    WGXUSR                                              CSD031
     C                     MOVE DGAACC    WGAACC                                              CSD031
     C**********           Z-ADDDGEACC    WGEACC                                     CSD031 BUG11788
     C                     Z-ADDBJRDNB    WGEACC                                            BUG11788
     C                     MOVE DGGPDT    WGGPDT                                              CSD031
      *                                                                                       CSD031
      *================================================================                       CSD031
     CSR         MOVEXT    ENDSR                                                              CSD031
      /EJECT
     CSR         *PSSR     BEGSR
      *****************************************************************
      *                                                               *
      * *PSSR  - Program exception error routine                      *
      *          Called automatically if a program error occurs,      *
      *          or directly by the program code using EXSR.          *
      *          This subroutine DUMPs the program just once.         *
      *                                                               *
      *****************************************************************
      *
      * Core function specific processing.
      *
     C/COPY WNCPYSRC,SD0160DPSC
      *
      * Start of PSSR user point.
      *
     C/COPY WNCPYSRC,SD0160DPS1
      *
      * Standard Midas PSSR processing.
      *
     C/COPY SDCPYSRC,SDPSSRINT
      *
      * End of PSSR user point.
      *
     C/COPY WNCPYSRC,SD0160DPS2
      *
      *================================================================
     CSR                   ENDSR
      *================================================================
      /EJECT                                                                                  CSD031
     CSR         SECHRC    BEGSR                                                              CSD031
      *================================================================                       CSD031
      * Change Standing Data Cont - Standing Data Controls  *                                 CSD031
      *================================================================                       CSD031
     C                     MOVEL*BLANK    W0RTN   7                                           CSD031
      * Set PGM.*Record Data Changed flag                                                     CSD031
     C                     MOVE 'N'       YARDC   1                                           CSD031
      *                                                                                       CSD031
      * Move key fields to @AHREAU                                                            CSD031
     C                     MOVE *BLANK    AHFLNM           Filename                           CSD031
     C                     MOVEL'SDHOLPD' AHFLNM           Filename                           CSD031
      *                                                                                       CSD031
     C           KLCHSE    KLIST                                                              CSD031
     C                     KFLD           AHFLNM           Filename                           CSD031
     C           KLCHSE    CHAIN@AHREAU              9091  *                                  CSD031
      *                                                                                       CSD031
     C           *IN90     IFEQ '1'                                                           CSD031
      * Record not found                                                                      CSD031
     C                     MOVEL'Y2U0009' W0RTN   7                                           CSD031
      * Send message '*Record no longer on file'                                              CSD031
     C                     MOVEL'Y2U0009' ZAMSID                                              CSD031
     C                     MOVEL'Y2USRMSG'ZAMSGF                                              CSD031
     C                     EXSR ZASNMS                                                        CSD031
     C                     GOTO SEEXIT                                                        CSD031
     C                     END                                                                CSD031
      *                                                                                       CSD031
     C           *IN91     IFEQ '1'                                                           CSD031
      * Record locked                                                                         CSD031
     C                     MOVEL'Y2U0004' W0RTN   7                                           CSD031
     C                     GOTO SEEXIT                                                        CSD031
     C                     END                                                                CSD031
      *                                                                                       CSD031
      * Store record data for null update check                                               CSD031
     C                     MOVE QSDFC1    YARDCS                                              CSD031
      * USER: Processing after Data read                                                      CSD031
     C                     ADD  AHNORC    WUNORC           No. of Records                     CSD031
     C                     ADD  AHNOIN    WUNOIN           No. of Inserts                     CSD031
     C                     ADD  AHNOAM    WUNOAM           No. of Amends                      CSD031
     C                     ADD  AHNODL    WUNODL           No. of Deletes                     CSD031
      * Move non-key fields to @AHREAU                                                        CSD031
     C                     Z-ADDWUNORC    AHNORC           No. of Records                     CSD031
     C                     Z-ADDWUNOIN    AHNOIN           No. of Inserts                     CSD031
     C                     Z-ADDWUNOAM    AHNOAM           No. of Amends                      CSD031
     C                     Z-ADDWUNODL    AHNODL           No. of Deletes                     CSD031
      *                                                                                       CSD031
      * Set PGM.*Record Data Changed flag                                                     CSD031
     C           QSDFC1    IFNE YARDCS                                                        CSD031
     C                     MOVE 'Y'       YARDC                                               CSD031
     C                     END                                                                CSD031
      * If changed update record otherwise release record                                     CSD031
     C           YARDC     IFEQ 'Y'                                                           CSD031
     C                     UPDAT@AHREAU                91  *                                  CSD031
     C                     ELSE                                                               CSD031
      * Release record lock                                                                   CSD031
     C                     UNLCKSDFCTLL0               91  *                                  CSD031
     C                     END                                                                CSD031
     C           *IN91     IFEQ '1'                                                           CSD031
      * Change error detected                                                                 CSD031
     C                     MOVEL'Y2U0004' W0RTN   7                                           CSD031
     C                     ELSE                                                               CSD031
      *                                                                                       CSD031
      * DBF change successful                                                                 CSD031
     C                     END                                                                CSD031
     C           SEEXIT    ENDSR                                                              CSD031
      *================================================================                       CSD031
      /EJECT                                                                                  CSD031
     CSR         SICHRC    BEGSR                                                              CSD031
      *================================================================                       CSD031
      * Change Standing Data Cont - Standing Data Controls  *                                 CSD031
      *================================================================                       CSD031
     C                     MOVEL*BLANK    W0RTN   7                                           CSD031
      * Set PGM.*Record Data Changed flag                                                     CSD031
     C                     MOVE 'N'       YDRDC   1                                           CSD031
      *                                                                                       CSD031
      * Move key fields to @AHREAU                                                            CSD031
     C                     MOVE *BLANK    AHFLNM           Filename                           CSD031
     C                     MOVEL'SDHOLPD' AHFLNM           Filename                           CSD031
      *                                                                                       CSD031
     C           KLCHSI    KLIST                                                              CSD031
     C                     KFLD           AHFLNM           Filename                           CSD031
     C           KLCHSI    CHAIN@AHREAU              9091  *                                  CSD031
      *                                                                                       CSD031
     C           *IN90     IFEQ '1'                                                           CSD031
      * Record not found                                                                      CSD031
     C                     MOVEL'Y2U0009' W0RTN   7                                           CSD031
      * Send message '*Record no longer on file'                                              CSD031
     C                     MOVEL'Y2U0009' ZAMSID                                              CSD031
     C                     MOVEL'Y2USRMSG'ZAMSGF                                              CSD031
     C                     EXSR ZASNMS                                                        CSD031
     C                     GOTO SIEXIT                                                        CSD031
     C                     END                                                                CSD031
      *                                                                                       CSD031
     C           *IN91     IFEQ '1'                                                           CSD031
      * Record locked                                                                         CSD031
     C                     MOVEL'Y2U0004' W0RTN   7                                           CSD031
     C                     GOTO SIEXIT                                                        CSD031
     C                     END                                                                CSD031
      *                                                                                       CSD031
      * Store record data for null update check                                               CSD031
     C                     MOVE QSDFC1    YDRDCS                                              CSD031
      * USER: Processing after Data read                                                      CSD031
     C                     ADD  AHNORC    WUNORC           No. of Records                     CSD031
     C                     ADD  AHNOIN    WUNOIN           No. of Inserts                     CSD031
     C                     ADD  AHNOAM    WUNOAM           No. of Amends                      CSD031
     C                     ADD  AHNODL    WUNODL           No. of Deletes                     CSD031
      * Move non-key fields to @AHREAU                                                        CSD031
     C                     Z-ADDWUNORC    AHNORC           No. of Records                     CSD031
     C                     Z-ADDWUNOIN    AHNOIN           No. of Inserts                     CSD031
     C                     Z-ADDWUNOAM    AHNOAM           No. of Amends                      CSD031
     C                     Z-ADDWUNODL    AHNODL           No. of Deletes                     CSD031
      *                                                                                       CSD031
      * Set PGM.*Record Data Changed flag                                                     CSD031
     C           QSDFC1    IFNE YDRDCS                                                        CSD031
     C                     MOVE 'Y'       YDRDC                                               CSD031
     C                     END                                                                CSD031
      * If changed update record otherwise release record                                     CSD031
     C           YDRDC     IFEQ 'Y'                                                           CSD031
     C                     UPDAT@AHREAU                91  *                                  CSD031
     C                     ELSE                                                               CSD031
      * Release record lock                                                                   CSD031
     C                     UNLCKSDFCTLL0               91  *                                  CSD031
     C                     END                                                                CSD031
     C           *IN91     IFEQ '1'                                                           CSD031
      * Change error detected                                                                 CSD031
     C                     MOVEL'Y2U0004' W0RTN   7                                           CSD031
     C                     ELSE                                                               CSD031
      *                                                                                       CSD031
      * DBF change successful                                                                 CSD031
     C                     END                                                                CSD031
      *================================================================                       CSD031
     CSR         SIEXIT    ENDSR                                                              CSD031
      /EJECT                                                                                  CSD031
     CSR         SGCHRC    BEGSR                                                              CSD031
      *================================================================                       CSD031
      * Change Standing Data Cont - Standing Data Controls  *                                 CSD031
      *================================================================                       CSD031
     C                     MOVEL*BLANK    W0RTN   7                                           CSD031
      * Set PGM.*Record Data Changed flag                                                     CSD031
     C                     MOVE 'N'       YBRDC   1                                           CSD031
      *                                                                                       CSD031
      * Move key fields to @AHREAU                                                            CSD031
     C                     MOVE *BLANK    AHFLNM           Filename                           CSD031
     C                     MOVEL'SDHOLPD' AHFLNM           Filename                           CSD031
      *                                                                                       CSD031
     C           KLCHSG    KLIST                                                              CSD031
     C                     KFLD           AHFLNM           Filename                           CSD031
     C           KLCHSG    CHAIN@AHREAU              9091  *                                  CSD031
      *                                                                                       CSD031
     C           *IN90     IFEQ '1'                                                           CSD031
      * Record not found                                                                      CSD031
     C                     MOVEL'Y2U0009' W0RTN   7                                           CSD031
      * Send message '*Record no longer on file'                                              CSD031
     C                     MOVEL'Y2U0009' ZAMSID                                              CSD031
     C                     MOVEL'Y2USRMSG'ZAMSGF                                              CSD031
     C                     EXSR ZASNMS                                                        CSD031
     C                     GOTO SGEXIT                                                        CSD031
     C                     END                                                                CSD031
      *                                                                                       CSD031
     C           *IN91     IFEQ '1'                                                           CSD031
      * Record locked                                                                         CSD031
     C                     MOVEL'Y2U0004' W0RTN   7                                           CSD031
     C                     GOTO SGEXIT                                                        CSD031
     C                     END                                                                CSD031
      *                                                                                       CSD031
      * Store record data for null update check                                               CSD031
     C                     MOVE QSDFC1    YBRDCS                                              CSD031
      * USER: Processing after Data read                                                      CSD031
     C                     ADD  AHNORC    WUNORC           No. of Records                     CSD031
     C                     ADD  AHNOIN    WUNOIN           No. of Inserts                     CSD031
     C                     ADD  AHNOAM    WUNOAM           No. of Amends                      CSD031
     C                     ADD  AHNODL    WUNODL           No. of Deletes                     CSD031
      * Move non-key fields to @AHREAU                                                        CSD031
     C                     Z-ADDWUNORC    AHNORC           No. of Records                     CSD031
     C                     Z-ADDWUNOIN    AHNOIN           No. of Inserts                     CSD031
     C                     Z-ADDWUNOAM    AHNOAM           No. of Amends                      CSD031
     C                     Z-ADDWUNODL    AHNODL           No. of Deletes                     CSD031
      *                                                                                       CSD031
      * Set PGM.*Record Data Changed flag                                                     CSD031
     C           QSDFC1    IFNE YBRDCS                                                        CSD031
     C                     MOVE 'Y'       YBRDC                                               CSD031
     C                     END                                                                CSD031
      * If changed update record otherwise release record                                     CSD031
     C           YBRDC     IFEQ 'Y'                                                           CSD031
     C                     UPDAT@AHREAU                91  *                                  CSD031
     C                     ELSE                                                               CSD031
      * Release record lock                                                                   CSD031
     C                     UNLCKSDFCTLL0               91  *                                  CSD031
     C                     END                                                                CSD031
     C           *IN91     IFEQ '1'                                                           CSD031
      * Change error detected                                                                 CSD031
     C                     MOVEL'Y2U0004' W0RTN   7                                           CSD031
     C                     ELSE                                                               CSD031
      *                                                                                       CSD031
      * DBF change successful                                                                 CSD031
     C                     END                                                                CSD031
      *================================================================                       CSD031
     CSR         SGEXIT    ENDSR                                                              CSD031
     C/COPY ZSRSRC,ZDATE1Z2                                                                   CSD031
** CPY@     : Copyright notice for inclusion in all programs
(c) Finastra International Limited 2001
** MMM                                                                                        CSD031
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC                                                          CSD031
** ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN                                            CSD031
0366073110961461                                                                              CSD031
** ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR                                              CSD031
000031059090120151181212243273304334365                                                       CSD031
** CTX1

