     H            Y
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas Dsp a Year's Holidays  Display record')          *
     H/TITLE Midas SD Dsp a Year's Holidays
     Z* CRTRPGPGM
      *
     H* SYNOPSIS :
     H* - Display DBF file records, one at a time.
     H* Generated by  : Synon/2  Version:  8646
     H* Function type : Display record(1 screen)  Version:   0.1
      *
     H*  Company :
     H*  System  : Midas Standing Data
     H* User name  : F7387SY
     H* Date       : 14/03/91 time: 20:09:11
      *  (c) Misys International Banking Systems Ltd. 2001            *
     H*
      *================================================================
     M* Maintenance   :
      *================================================================
     F********************************************************************
     F*  P R O G R A M     C R E A T I O N     P A R A M E T E R S    *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     F*****************************************************************
     F*                                                               *
      *  Last Amend No. CER059             Date 19Jul10               *
      *  Prev Amend No. CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 20Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CAAA03             Date 28Mar04               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 LN0662             Date 24Jan91               *
     F*                 S01212                   DATE 14SEP89         *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *                (Recompile)                                    *
      *  CSD031 - Enhanced Centralised Static Data                    *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CAAA03 - Webfacing Changes (recompile).                      *
     F*  LN0662 - REGENERATE DUE TO CHANGE IN SDCURRPD                *
     F*  S01212 - /COPIES                                             *
     F*                                                               *
     F*****************************************************************
     F*00/Copy Member SD0161E   Initialise Program F-Spec
     F/COPY WNCPYSRC,SD0161EFPG
     FSD0161E#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: Midas SD Dsp a Year's Holidays
      *
     FSDHOLL8 IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RSQ: Holidays                  test access path
      *
     FSDHOLL4 IF  E           K        DISK
      * RSQ: Holidays                  1st Quarter
      *
     FSDCURRL1IF  E           K        DISK
      * RTV: Currency Codes            Retrieval index
      *
     FSDLOCNL1IF  E           K        DISK
      * RTV: Location Codes            Retrieval index
      *
     FSDMMODL1IF  E           K        DISK
      * RTV: MIDAS Modules             Retrieval index
      *
     FGPHOLIL1IF  E           K        DISK                                                   CSD031
      ** RTV: GP Holidays                                                                     CSD031
      *                                                                                       CSD031
     FGPLOCNL1IF  E           K        DISK                                                   CSD031
      ** RTV: GP Location Codes                                                               CSD031
      *                                                                                       CSD031
     FGPHOLIL2IF  E           K        DISK                                                   CSD031
     F            GPHOLID0                          KRENAMEGPHOLID2                           CSD031
      ** RTV: GP Holidays                                                                     CSD031
      *                                                                                       CSD031
     FSDAHDYL1IF  E           K        DISK                                                   CSD031
      ** RTV: SD Holidays Acceptance                                                          CSD031
      *                                                                                       CSD031
     FSDAHDYL8IF  E           K        DISK                                                   CSD031
     F            SDAHDYD0                          KRENAMESDAHDYD8                           CSD031
      ** RTV: SD Holidays Acceptance                                                          CSD031
      *                                                                                       CSD031
     E                    JAN    31  31  2
     E                    FEB1   28  28  2
     E                    FEB2   29  29  2
     E                    MAR    31  31  2
     E                    TEMP       37  2
     E                    JAST       37  1
     E                    FEST       37  1
     E                    MAST       37  1
     E* Description     : Copyright notice for inclusion in all programs
     E*
     E********************************************************************
     E                    CPY@    1   1 80               Copyright     array
     E*00/Copy Member SD0161E   Initialise Program E-Spec
     E/COPY WNCPYSRC,SD0161EEPG
     E                    @CN     1  11 25               Long constants.
      * Renamed input format fields.
     I@HOLPH8
      * Holidays                  1st Quarter
     I              DGCYCD                          WACYCD
     I              DGLCCD                          WALCCD
     I              DGYRNB                          WAYRNB
     I              DGJDNB                          WAJDNB
     I              DGDDNB                          WADDNB
     I              DGJA01                          WAJA01
     I              DGJA02                          WAJA02
     I              DGJA03                          WAJA03
     I              DGJA04                          WAJA04
     I              DGJA05                          WAJA05
     I              DGJA06                          WAJA06
     I              DGJA07                          WAJA07
     I              DGJA08                          WAJA08
     I              DGJA09                          WAJA09
     I              DGJA10                          WAJA10
     I              DGJA11                          WAJA11
     I              DGJA12                          WAJA12
     I              DGJA13                          WAJA13
     I              DGJA14                          WAJA14
     I              DGJA15                          WAJA15
     I              DGJA16                          WAJA16
     I              DGJA17                          WAJA17
     I              DGJA18                          WAJA18
     I              DGJA19                          WAJA19
     I              DGJA20                          WAJA20
     I              DGJA21                          WAJA21
     I              DGJA22                          WAJA22
     I              DGJA23                          WAJA23
     I              DGJA24                          WAJA24
     I              DGJA25                          WAJA25
     I              DGJA26                          WAJA26
     I              DGJA27                          WAJA27
     I              DGJA28                          WAJA28
     I              DGJA29                          WAJA29
     I              DGJA30                          WAJA30
     I              DGJA31                          WAJA31
     I              DGFE01                          WAFE01
     I              DGFE02                          WAFE02
     I              DGFE03                          WAFE03
     I              DGFE04                          WAFE04
     I              DGFE05                          WAFE05
     I              DGFE06                          WAFE06
     I              DGFE07                          WAFE07
     I              DGFE08                          WAFE08
     I              DGFE09                          WAFE09
     I              DGFE10                          WAFE10
     I              DGFE11                          WAFE11
     I              DGFE12                          WAFE12
     I              DGFE13                          WAFE13
     I              DGFE14                          WAFE14
     I              DGFE15                          WAFE15
     I              DGFE16                          WAFE16
     I              DGFE17                          WAFE17
     I              DGFE18                          WAFE18
     I              DGFE19                          WAFE19
     I              DGFE20                          WAFE20
     I              DGFE21                          WAFE21
     I              DGFE22                          WAFE22
     I              DGFE23                          WAFE23
     I              DGFE24                          WAFE24
     I              DGFE25                          WAFE25
     I              DGFE26                          WAFE26
     I              DGFE27                          WAFE27
     I              DGFE28                          WAFE28
     I              DGFE29                          WAFE29
     I              DGMA01                          WAMA01
     I              DGMA02                          WAMA02
     I              DGMA03                          WAMA03
     I              DGMA04                          WAMA04
     I              DGMA05                          WAMA05
     I              DGMA06                          WAMA06
     I              DGMA07                          WAMA07
     I              DGMA08                          WAMA08
     I              DGMA09                          WAMA09
     I              DGMA10                          WAMA10
     I              DGMA11                          WAMA11
     I              DGMA12                          WAMA12
     I              DGMA13                          WAMA13
     I              DGMA14                          WAMA14
     I              DGMA15                          WAMA15
     I              DGMA16                          WAMA16
     I              DGMA17                          WAMA17
     I              DGMA18                          WAMA18
     I              DGMA19                          WAMA19
     I              DGMA20                          WAMA20
     I              DGMA21                          WAMA21
     I              DGMA22                          WAMA22
     I              DGMA23                          WAMA23
     I              DGMA24                          WAMA24
     I              DGMA25                          WAMA25
     I              DGMA26                          WAMA26
     I              DGMA27                          WAMA27
     I              DGMA28                          WAMA28
     I              DGMA29                          WAMA29
     I              DGMA30                          WAMA30
     I              DGMA31                          WAMA31
     I              DGLCD                           WALCD
     I              DGTYLC                          WATYLC
     IGPHOLID2                                                                                CSD031
      * Holidays                  1st Quarter                                                 CSD031
     I              DGCYCD                          WACYCD                                    CSD031
     I              DGLCCD                          WALCCD                                    CSD031
     I              DGYRNB                          WAYRNB                                    CSD031
     I              DGJDNB                          WAJDNB                                    CSD031
     I              DGDDNB                          WADDNB                                    CSD031
     I              DGJA01                          WAJA01                                    CSD031
     I              DGJA02                          WAJA02                                    CSD031
     I              DGJA03                          WAJA03                                    CSD031
     I              DGJA04                          WAJA04                                    CSD031
     I              DGJA05                          WAJA05                                    CSD031
     I              DGJA06                          WAJA06                                    CSD031
     I              DGJA07                          WAJA07                                    CSD031
     I              DGJA08                          WAJA08                                    CSD031
     I              DGJA09                          WAJA09                                    CSD031
     I              DGJA10                          WAJA10                                    CSD031
     I              DGJA11                          WAJA11                                    CSD031
     I              DGJA12                          WAJA12                                    CSD031
     I              DGJA13                          WAJA13                                    CSD031
     I              DGJA14                          WAJA14                                    CSD031
     I              DGJA15                          WAJA15                                    CSD031
     I              DGJA16                          WAJA16                                    CSD031
     I              DGJA17                          WAJA17                                    CSD031
     I              DGJA18                          WAJA18                                    CSD031
     I              DGJA19                          WAJA19                                    CSD031
     I              DGJA20                          WAJA20                                    CSD031
     I              DGJA21                          WAJA21                                    CSD031
     I              DGJA22                          WAJA22                                    CSD031
     I              DGJA23                          WAJA23                                    CSD031
     I              DGJA24                          WAJA24                                    CSD031
     I              DGJA25                          WAJA25                                    CSD031
     I              DGJA26                          WAJA26                                    CSD031
     I              DGJA27                          WAJA27                                    CSD031
     I              DGJA28                          WAJA28                                    CSD031
     I              DGJA29                          WAJA29                                    CSD031
     I              DGJA30                          WAJA30                                    CSD031
     I              DGJA31                          WAJA31                                    CSD031
     I              DGFE01                          WAFE01                                    CSD031
     I              DGFE02                          WAFE02                                    CSD031
     I              DGFE03                          WAFE03                                    CSD031
     I              DGFE04                          WAFE04                                    CSD031
     I              DGFE05                          WAFE05                                    CSD031
     I              DGFE06                          WAFE06                                    CSD031
     I              DGFE07                          WAFE07                                    CSD031
     I              DGFE08                          WAFE08                                    CSD031
     I              DGFE09                          WAFE09                                    CSD031
     I              DGFE10                          WAFE10                                    CSD031
     I              DGFE11                          WAFE11                                    CSD031
     I              DGFE12                          WAFE12                                    CSD031
     I              DGFE13                          WAFE13                                    CSD031
     I              DGFE14                          WAFE14                                    CSD031
     I              DGFE15                          WAFE15                                    CSD031
     I              DGFE16                          WAFE16                                    CSD031
     I              DGFE17                          WAFE17                                    CSD031
     I              DGFE18                          WAFE18                                    CSD031
     I              DGFE19                          WAFE19                                    CSD031
     I              DGFE20                          WAFE20                                    CSD031
     I              DGFE21                          WAFE21                                    CSD031
     I              DGFE22                          WAFE22                                    CSD031
     I              DGFE23                          WAFE23                                    CSD031
     I              DGFE24                          WAFE24                                    CSD031
     I              DGFE25                          WAFE25                                    CSD031
     I              DGFE26                          WAFE26                                    CSD031
     I              DGFE27                          WAFE27                                    CSD031
     I              DGFE28                          WAFE28                                    CSD031
     I              DGFE29                          WAFE29                                    CSD031
     I              DGMA01                          WAMA01                                    CSD031
     I              DGMA02                          WAMA02                                    CSD031
     I              DGMA03                          WAMA03                                    CSD031
     I              DGMA04                          WAMA04                                    CSD031
     I              DGMA05                          WAMA05                                    CSD031
     I              DGMA06                          WAMA06                                    CSD031
     I              DGMA07                          WAMA07                                    CSD031
     I              DGMA08                          WAMA08                                    CSD031
     I              DGMA09                          WAMA09                                    CSD031
     I              DGMA10                          WAMA10                                    CSD031
     I              DGMA11                          WAMA11                                    CSD031
     I              DGMA12                          WAMA12                                    CSD031
     I              DGMA13                          WAMA13                                    CSD031
     I              DGMA14                          WAMA14                                    CSD031
     I              DGMA15                          WAMA15                                    CSD031
     I              DGMA16                          WAMA16                                    CSD031
     I              DGMA17                          WAMA17                                    CSD031
     I              DGMA18                          WAMA18                                    CSD031
     I              DGMA19                          WAMA19                                    CSD031
     I              DGMA20                          WAMA20                                    CSD031
     I              DGMA21                          WAMA21                                    CSD031
     I              DGMA22                          WAMA22                                    CSD031
     I              DGMA23                          WAMA23                                    CSD031
     I              DGMA24                          WAMA24                                    CSD031
     I              DGMA25                          WAMA25                                    CSD031
     I              DGMA26                          WAMA26                                    CSD031
     I              DGMA27                          WAMA27                                    CSD031
     I              DGMA28                          WAMA28                                    CSD031
     I              DGMA29                          WAMA29                                    CSD031
     I              DGMA30                          WAMA30                                    CSD031
     I              DGMA31                          WAMA31                                    CSD031
     I              DGLCD                           WALCD                                     CSD031
     I              DGTYLC                          WATYLC                                    CSD031
     ISDAHDYD8                                                                                CSD031
      * Holidays                  1st Quarter                                                 CSD031
     I              DGCYCD                          WACYCD                                    CSD031
     I              DGLCCD                          WALCCD                                    CSD031
     I              DGYRNB                          WAYRNB                                    CSD031
     I              DGJDNB                          WAJDNB                                    CSD031
     I              DGDDNB                          WADDNB                                    CSD031
     I              DGJA01                          WAJA01                                    CSD031
     I              DGJA02                          WAJA02                                    CSD031
     I              DGJA03                          WAJA03                                    CSD031
     I              DGJA04                          WAJA04                                    CSD031
     I              DGJA05                          WAJA05                                    CSD031
     I              DGJA06                          WAJA06                                    CSD031
     I              DGJA07                          WAJA07                                    CSD031
     I              DGJA08                          WAJA08                                    CSD031
     I              DGJA09                          WAJA09                                    CSD031
     I              DGJA10                          WAJA10                                    CSD031
     I              DGJA11                          WAJA11                                    CSD031
     I              DGJA12                          WAJA12                                    CSD031
     I              DGJA13                          WAJA13                                    CSD031
     I              DGJA14                          WAJA14                                    CSD031
     I              DGJA15                          WAJA15                                    CSD031
     I              DGJA16                          WAJA16                                    CSD031
     I              DGJA17                          WAJA17                                    CSD031
     I              DGJA18                          WAJA18                                    CSD031
     I              DGJA19                          WAJA19                                    CSD031
     I              DGJA20                          WAJA20                                    CSD031
     I              DGJA21                          WAJA21                                    CSD031
     I              DGJA22                          WAJA22                                    CSD031
     I              DGJA23                          WAJA23                                    CSD031
     I              DGJA24                          WAJA24                                    CSD031
     I              DGJA25                          WAJA25                                    CSD031
     I              DGJA26                          WAJA26                                    CSD031
     I              DGJA27                          WAJA27                                    CSD031
     I              DGJA28                          WAJA28                                    CSD031
     I              DGJA29                          WAJA29                                    CSD031
     I              DGJA30                          WAJA30                                    CSD031
     I              DGJA31                          WAJA31                                    CSD031
     I              DGFE01                          WAFE01                                    CSD031
     I              DGFE02                          WAFE02                                    CSD031
     I              DGFE03                          WAFE03                                    CSD031
     I              DGFE04                          WAFE04                                    CSD031
     I              DGFE05                          WAFE05                                    CSD031
     I              DGFE06                          WAFE06                                    CSD031
     I              DGFE07                          WAFE07                                    CSD031
     I              DGFE08                          WAFE08                                    CSD031
     I              DGFE09                          WAFE09                                    CSD031
     I              DGFE10                          WAFE10                                    CSD031
     I              DGFE11                          WAFE11                                    CSD031
     I              DGFE12                          WAFE12                                    CSD031
     I              DGFE13                          WAFE13                                    CSD031
     I              DGFE14                          WAFE14                                    CSD031
     I              DGFE15                          WAFE15                                    CSD031
     I              DGFE16                          WAFE16                                    CSD031
     I              DGFE17                          WAFE17                                    CSD031
     I              DGFE18                          WAFE18                                    CSD031
     I              DGFE19                          WAFE19                                    CSD031
     I              DGFE20                          WAFE20                                    CSD031
     I              DGFE21                          WAFE21                                    CSD031
     I              DGFE22                          WAFE22                                    CSD031
     I              DGFE23                          WAFE23                                    CSD031
     I              DGFE24                          WAFE24                                    CSD031
     I              DGFE25                          WAFE25                                    CSD031
     I              DGFE26                          WAFE26                                    CSD031
     I              DGFE27                          WAFE27                                    CSD031
     I              DGFE28                          WAFE28                                    CSD031
     I              DGFE29                          WAFE29                                    CSD031
     I              DGMA01                          WAMA01                                    CSD031
     I              DGMA02                          WAMA02                                    CSD031
     I              DGMA03                          WAMA03                                    CSD031
     I              DGMA04                          WAMA04                                    CSD031
     I              DGMA05                          WAMA05                                    CSD031
     I              DGMA06                          WAMA06                                    CSD031
     I              DGMA07                          WAMA07                                    CSD031
     I              DGMA08                          WAMA08                                    CSD031
     I              DGMA09                          WAMA09                                    CSD031
     I              DGMA10                          WAMA10                                    CSD031
     I              DGMA11                          WAMA11                                    CSD031
     I              DGMA12                          WAMA12                                    CSD031
     I              DGMA13                          WAMA13                                    CSD031
     I              DGMA14                          WAMA14                                    CSD031
     I              DGMA15                          WAMA15                                    CSD031
     I              DGMA16                          WAMA16                                    CSD031
     I              DGMA17                          WAMA17                                    CSD031
     I              DGMA18                          WAMA18                                    CSD031
     I              DGMA19                          WAMA19                                    CSD031
     I              DGMA20                          WAMA20                                    CSD031
     I              DGMA21                          WAMA21                                    CSD031
     I              DGMA22                          WAMA22                                    CSD031
     I              DGMA23                          WAMA23                                    CSD031
     I              DGMA24                          WAMA24                                    CSD031
     I              DGMA25                          WAMA25                                    CSD031
     I              DGMA26                          WAMA26                                    CSD031
     I              DGMA27                          WAMA27                                    CSD031
     I              DGMA28                          WAMA28                                    CSD031
     I              DGMA29                          WAMA29                                    CSD031
     I              DGMA30                          WAMA30                                    CSD031
     I              DGMA31                          WAMA31                                    CSD031
     I              DGLCD                           WALCD                                     CSD031
     I              DGTYLC                          WATYLC                                    CSD031
      *
     I*
     I* Description     : Copyright notice for inclusion in all programs
     I*
     I/COPY QWINDSRC,SD0160GDTA
     I*00/Copy Member SD0161E   Initialise Program I-Spec
     I/COPY WNCPYSRC,SD0161EIPG
      /EJECT
      * Data structures:-
     IPGMDS     ESDSY2PGDSP
      * Program data structure.
     IJBDTTM      DS
      * Job date/time.
     I                                        1   60##JDT
     I                                        1   20##JYY
     I                                        3   40##JMM
     I                                        5   60##JDD
     I                                        7  120##JTM
     I                                        7   80##JHH
     I                                        9  100##JNN
     I                                       11  120##JSS
     IINFDS#    E DSY2I#DSP
      * Display file data structure.
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure.
      *
     I            DS
     I                                        1   2 #DJ01N
     I                                        3   4 #DJ02N
     I                                        5   6 #DJ03N
     I                                        7   8 #DJ04N
     I                                        9  10 #DJ05N
     I                                       11  12 #DJ06N
     I                                       13  14 #DJ07N
     I                                       15  16 #DJ08N
     I                                       17  18 #DJ09N
     I                                       19  20 #DJ10N
     I                                       21  22 #DJ11N
     I                                       23  24 #DJ12N
     I                                       25  26 #DJ13N
     I                                       27  28 #DJ14N
     I                                       29  30 #DJ15N
     I                                       31  32 #DJ16N
     I                                       33  34 #DJ17N
     I                                       35  36 #DJ18N
     I                                       37  38 #DJ19N
     I                                       39  40 #DJ20N
     I                                       41  42 #DJ21N
     I                                       43  44 #DJ22N
     I                                       45  46 #DJ23N
     I                                       47  48 #DJ24N
     I                                       49  50 #DJ25N
     I                                       51  52 #DJ26N
     I                                       53  54 #DJ27N
     I                                       55  56 #DJ28N
     I                                       57  58 #DJ29N
     I                                       59  60 #DJ30N
     I                                       61  62 #DJ31N
     I                                       63  64 #DJ32N
     I                                       65  66 #DJ33N
     I                                       67  68 #DJ34N
     I                                       69  70 #DJ35N
     I                                       71  72 #DJ36N
     I                                       73  74 #DJ37N
     I                                        1  74 JANUAR
     I            DS
     I                                        1   2 #DF01N
     I                                        3   4 #DF02N
     I                                        5   6 #DF03N
     I                                        7   8 #DF04N
     I                                        9  10 #DF05N
     I                                       11  12 #DF06N
     I                                       13  14 #DF07N
     I                                       15  16 #DF08N
     I                                       17  18 #DF09N
     I                                       19  20 #DF10N
     I                                       21  22 #DF11N
     I                                       23  24 #DF12N
     I                                       25  26 #DF13N
     I                                       27  28 #DF14N
     I                                       29  30 #DF15N
     I                                       31  32 #DF16N
     I                                       33  34 #DF17N
     I                                       35  36 #DF18N
     I                                       37  38 #DF19N
     I                                       39  40 #DF20N
     I                                       41  42 #DF21N
     I                                       43  44 #DF22N
     I                                       45  46 #DF23N
     I                                       47  48 #DF24N
     I                                       49  50 #DF25N
     I                                       51  52 #DF26N
     I                                       53  54 #DF27N
     I                                       55  56 #DF28N
     I                                       57  58 #DF29N
     I                                       59  60 #DF30N
     I                                       61  62 #DF31N
     I                                       63  64 #DF32N
     I                                       65  66 #DF33N
     I                                       67  68 #DF34N
     I                                       69  70 #DF35N
     I                                       71  72 #DF36N
     I                                       73  74 #DF37N
     I                                        1  74 FEBRUA
     I            DS
     I                                        1   2 #DM01N
     I                                        3   4 #DM02N
     I                                        5   6 #DM03N
     I                                        7   8 #DM04N
     I                                        9  10 #DM05N
     I                                       11  12 #DM06N
     I                                       13  14 #DM07N
     I                                       15  16 #DM08N
     I                                       17  18 #DM09N
     I                                       19  20 #DM10N
     I                                       21  22 #DM11N
     I                                       23  24 #DM12N
     I                                       25  26 #DM13N
     I                                       27  28 #DM14N
     I                                       29  30 #DM15N
     I                                       31  32 #DM16N
     I                                       33  34 #DM17N
     I                                       35  36 #DM18N
     I                                       37  38 #DM19N
     I                                       39  40 #DM20N
     I                                       41  42 #DM21N
     I                                       43  44 #DM22N
     I                                       45  46 #DM23N
     I                                       47  48 #DM24N
     I                                       49  50 #DM25N
     I                                       51  52 #DM26N
     I                                       53  54 #DM27N
     I                                       55  56 #DM28N
     I                                       57  58 #DM29N
     I                                       59  60 #DM30N
     I                                       61  62 #DM31N
     I                                       63  64 #DM32N
     I                                       65  66 #DM33N
     I                                       67  68 #DM34N
     I                                       69  70 #DM35N
     I                                       71  72 #DM36N
     I                                       73  74 #DM37N
     I                                        1  74 MARCH
     I            DS
     I                                        1   1 #DJ01S
     I                                        2   2 #DJ02S
     I                                        3   3 #DJ03S
     I                                        4   4 #DJ04S
     I                                        5   5 #DJ05S
     I                                        6   6 #DJ06S
     I                                        7   7 #DJ07S
     I                                        8   8 #DJ08S
     I                                        9   9 #DJ09S
     I                                       10  10 #DJ10S
     I                                       11  11 #DJ11S
     I                                       12  12 #DJ12S
     I                                       13  13 #DJ13S
     I                                       14  14 #DJ14S
     I                                       15  15 #DJ15S
     I                                       16  16 #DJ16S
     I                                       17  17 #DJ17S
     I                                       18  18 #DJ18S
     I                                       19  19 #DJ19S
     I                                       20  20 #DJ20S
     I                                       21  21 #DJ21S
     I                                       22  22 #DJ22S
     I                                       23  23 #DJ23S
     I                                       24  24 #DJ24S
     I                                       25  25 #DJ25S
     I                                       26  26 #DJ26S
     I                                       27  27 #DJ27S
     I                                       28  28 #DJ28S
     I                                       29  29 #DJ29S
     I                                       30  30 #DJ30S
     I                                       31  31 #DJ31S
     I                                       32  32 #DJ32S
     I                                       33  33 #DJ33S
     I                                       34  34 #DJ34S
     I                                       35  35 #DJ35S
     I                                       36  36 #DJ36S
     I                                       37  37 #DJ37S
     I                                        1  37 JAST
     I            DS
     I                                        1   1 WUJA01
     I                                        2   2 WUJA02
     I                                        3   3 WUJA03
     I                                        4   4 WUJA04
     I                                        5   5 WUJA05
     I                                        6   6 WUJA06
     I                                        7   7 WUJA07
     I                                        8   8 WUJA08
     I                                        9   9 WUJA09
     I                                       10  10 WUJA10
     I                                       11  11 WUJA11
     I                                       12  12 WUJA12
     I                                       13  13 WUJA13
     I                                       14  14 WUJA14
     I                                       15  15 WUJA15
     I                                       16  16 WUJA16
     I                                       17  17 WUJA17
     I                                       18  18 WUJA18
     I                                       19  19 WUJA19
     I                                       20  20 WUJA20
     I                                       21  21 WUJA21
     I                                       22  22 WUJA22
     I                                       23  23 WUJA23
     I                                       24  24 WUJA24
     I                                       25  25 WUJA25
     I                                       26  26 WUJA26
     I                                       27  27 WUJA27
     I                                       28  28 WUJA28
     I                                       29  29 WUJA29
     I                                       30  30 WUJA30
     I                                       31  31 WUJA31
     I                                        1  31 JANFLD
     I            DS
     I                                        1   1 #DF01S
     I                                        2   2 #DF02S
     I                                        3   3 #DF03S
     I                                        4   4 #DF04S
     I                                        5   5 #DF05S
     I                                        6   6 #DF06S
     I                                        7   7 #DF07S
     I                                        8   8 #DF08S
     I                                        9   9 #DF09S
     I                                       10  10 #DF10S
     I                                       11  11 #DF11S
     I                                       12  12 #DF12S
     I                                       13  13 #DF13S
     I                                       14  14 #DF14S
     I                                       15  15 #DF15S
     I                                       16  16 #DF16S
     I                                       17  17 #DF17S
     I                                       18  18 #DF18S
     I                                       19  19 #DF19S
     I                                       20  20 #DF20S
     I                                       21  21 #DF21S
     I                                       22  22 #DF22S
     I                                       23  23 #DF23S
     I                                       24  24 #DF24S
     I                                       25  25 #DF25S
     I                                       26  26 #DF26S
     I                                       27  27 #DF27S
     I                                       28  28 #DF28S
     I                                       29  29 #DF29S
     I                                       30  30 #DF30S
     I                                       31  31 #DF31S
     I                                       32  32 #DF32S
     I                                       33  33 #DF33S
     I                                       34  34 #DF34S
     I                                       35  35 #DF35S
     I                                       36  36 #DF36S
     I                                       37  37 #DF37S
     I                                        1  37 FEST
     I            DS
     I                                        1   1 WUFE01
     I                                        2   2 WUFE02
     I                                        3   3 WUFE03
     I                                        4   4 WUFE04
     I                                        5   5 WUFE05
     I                                        6   6 WUFE06
     I                                        7   7 WUFE07
     I                                        8   8 WUFE08
     I                                        9   9 WUFE09
     I                                       10  10 WUFE10
     I                                       11  11 WUFE11
     I                                       12  12 WUFE12
     I                                       13  13 WUFE13
     I                                       14  14 WUFE14
     I                                       15  15 WUFE15
     I                                       16  16 WUFE16
     I                                       17  17 WUFE17
     I                                       18  18 WUFE18
     I                                       19  19 WUFE19
     I                                       20  20 WUFE20
     I                                       21  21 WUFE21
     I                                       22  22 WUFE22
     I                                       23  23 WUFE23
     I                                       24  24 WUFE24
     I                                       25  25 WUFE25
     I                                       26  26 WUFE26
     I                                       27  27 WUFE27
     I                                       28  28 WUFE28
     I                                       29  29 WUFE29
     I                                        1  29 FEBFLD
     I            DS
     I                                        1   1 #DM01S
     I                                        2   2 #DM02S
     I                                        3   3 #DM03S
     I                                        4   4 #DM04S
     I                                        5   5 #DM05S
     I                                        6   6 #DM06S
     I                                        7   7 #DM07S
     I                                        8   8 #DM08S
     I                                        9   9 #DM09S
     I                                       10  10 #DM10S
     I                                       11  11 #DM11S
     I                                       12  12 #DM12S
     I                                       13  13 #DM13S
     I                                       14  14 #DM14S
     I                                       15  15 #DM15S
     I                                       16  16 #DM16S
     I                                       17  17 #DM17S
     I                                       18  18 #DM18S
     I                                       19  19 #DM19S
     I                                       20  20 #DM20S
     I                                       21  21 #DM21S
     I                                       22  22 #DM22S
     I                                       23  23 #DM23S
     I                                       24  24 #DM24S
     I                                       25  25 #DM25S
     I                                       26  26 #DM26S
     I                                       27  27 #DM27S
     I                                       28  28 #DM28S
     I                                       29  29 #DM29S
     I                                       30  30 #DM30S
     I                                       31  31 #DM31S
     I                                       32  32 #DM32S
     I                                       33  33 #DM33S
     I                                       34  34 #DM34S
     I                                       35  35 #DM35S
     I                                       36  36 #DM36S
     I                                       37  37 #DM37S
     I                                        1  37 MAST
     I            DS
     I                                        1   1 WUMA01
     I                                        2   2 WUMA02
     I                                        3   3 WUMA03
     I                                        4   4 WUMA04
     I                                        5   5 WUMA05
     I                                        6   6 WUMA06
     I                                        7   7 WUMA07
     I                                        8   8 WUMA08
     I                                        9   9 WUMA09
     I                                       10  10 WUMA10
     I                                       11  11 WUMA11
     I                                       12  12 WUMA12
     I                                       13  13 WUMA13
     I                                       14  14 WUMA14
     I                                       15  15 WUMA15
     I                                       16  16 WUMA16
     I                                       17  17 WUMA17
     I                                       18  18 WUMA18
     I                                       19  19 WUMA19
     I                                       20  20 WUMA20
     I                                       21  21 WUMA21
     I                                       22  22 WUMA22
     I                                       23  23 WUMA23
     I                                       24  24 WUMA24
     I                                       25  25 WUMA25
     I                                       26  26 WUMA26
     I                                       27  27 WUMA27
     I                                       28  28 WUMA28
     I                                       29  29 WUMA29
     I                                       30  30 WUMA30
     I                                       31  31 WUMA31
     I                                        1  31 MARFLD
      * Outward parameters.
     IPARC        DS                             10
      * KEY: Holidays                  test access path
      * I:MAP Currency Code
     I                                        1   3 PACYCD
      * I:MAP Location Code
     I                                        4   6 PALCCD
      * I:MAP Year Number
     I                                        7  10 PAYRNB
      *
     IA@CPY       DS
     I* Copyright array
     I                                        1  80 CPY@
     IRUNDAT      DS
     I                                        1   7 MRDT
     I                                    P   8  100RDNB
     I                                       11  11 SUC
     I                                       12  12 DFF
     I                                       13  13 MBIN
      *                                                                                       CSD031
     IDSFDY     E DSDSFDY                                                                     CSD031
      * DS for Access Programs, short data structure.                                         CSD031
      *                                                                                       CSD031
     IDSSARD    E DSSCSARDPD                                                                  CSD031
      * Definition: Switchable Features Accessed Via Access Program.                          CSD031
      *                                                                                       CSD031
      /EJECT
      * Parameter declarations.
     IP1PARM      DS                             10
      * KEY: Holidays                  test access path
      * I:MAP Currency Code
     I                                        1   3 P1CYCD
      * I:MAP Location Code
     I                                        4   6 P1LCCD
      * I:MAP Year Number
     I                                        7  10 P1YRNB
      *                                                                                       CSD031
      ** Constant Variable                                                                    CSD031
      *                                                                                       CSD031
     I              'Accept to Zone..:'   C         WKAACC                                    CSD031
     I              'Central Data..:'     C         WKGPDT                                    CSD031
      /EJECT
      *****************************************************************
     C           *ENTRY    PLIST                           Entry parameter
     C                     PARM           P0RTN   7        Return code
     C                     PARM           P1PARM           KEY: Holidays
     C                     PARM           PMODE   1                                           CSD031
      *****************************************************************
      * Initialise
     C                     EXSR ZZINIT
      *
      * Check passed parameters.
     C                     EXSR FACKPM
      * Perform once if all passed, else repeat.
     C           W0RPT     DOUEQ'N'
      * Display and process key screen.
     C                     EXSR BADSKY
     C                     END
      * Terminate program.
     C                     EXSR ZXEXPG
      *****************************************************************
      /EJECT
     CSR         BADSKY    BEGSR
      *================================================================
      * Display and process key screen.
      *================================================================
      * Initialise key screen
     C                     EXSR MDIZ#K
      * Bypass first display of key screen is possible.
     C                     MOVEL'Y'       W0BYP   1
      * Signal start of transaction.
     C                     MOVEL'Y'       W0TRN   1
      *
     C           W0TRN     DOWEQ'Y'
     C           W0TRN     OREQ 'R'
      * Ensure transaction continues (if reset).
     C                     MOVEL'Y'       W0TRN   1
      * Initialise detail screen.
     C                     EXSR MAIZ#1
      * Conduct screen conversation:
     C           W0TRN     DOWEQ'Y'
      * Is bypass key screen still viable?
     C           W0BYP     IFEQ 'Y'
     C           #1CYCD    IFEQ *BLANK                     Currency Code
     C           #1LCCD    OREQ *BLANK                     Location Code
     C           #1YRNB    OREQ *BLANK                     Year Number
      * One or more key field is blank.
     C                     MOVEL'N'       W0BYP
     C                     END
     C                     END
      * Bypass key screen.
     C           W0BYP     IFNE 'Y'
      * Display key screen.
     C                     EXSR BBEXFM
     C                     END
      * Cancel key screen bypass.
     C                     MOVEL'N'       W0BYP
      * Process response to key screen:
      * Cancel & exit program.
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields.
     C   05                CAS            BDHMKY
      * Process key screen input.
     C                     CAS            BEPRKY
     C                     END
      *
     C                     END
     C                     END
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBEXFM    BEGSR
      *================================================================
      * Display key screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators.
     C                     EXSR GADSAK
      * Update screen time.
     C                     TIME           ##TME            Screen time.
     C           W0HLP     DOUEQ'N'
      * Enable PUTOVR.
     C                     SETON                     86
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDKEY
     C                     MOVEL'N'       W0HLP   1        Reset help requ
      * If help requested, display help text.
     C   25                EXSR ZHHPKY                     Display help te
     C                     END
      * Update job time.
     C                     TIME           ##JTM            Job time.
      * Clear messages from program message queue.
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGM  10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag.
     C                     MOVEL'Y'       ZAFSMS  1      99*
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         BDHMKY    BEGSR
      *================================================================
      * Process HOME key
      *================================================================
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         BDEXIT    ENDSR
      /EJECT
     CSR         BEPRKY    BEGSR
      *================================================================
      * Process key screen.
      *================================================================
      * Validate key fields.
     C                     EXSR BFVLKY
     C           *IN99     CABEQ'1'       BEEXIT
      * Select existing record.
     C                     EXSR VACKRL
      * Check for existing record.
     C           KRTV      KLIST
     C                     KFLD           DGCYCD           Currency Code
     C                     KFLD           DGLCCD           Location Code
     C                     KFLD           DGYRNB           Year Number
      * Setup key.
     C                     MOVEL#1CYCD    DGCYCD           Currency Code
     C                     MOVEL#1LCCD    DGLCCD           Location Code
     C                     MOVEL#1YRNB    DGYRNB           Year Number
      *                                                                                       CSD031
      ** If CSD041 is enabled.                                                                CSD031
      *                                                                                       CSD031
     C           CSD041    IFEQ 'Y'                                                           CSD031
      *                                                                                       CSD031
      ** Read SDAHDYL1 file if CSD041 is enabled and at Zone Level and                        CSD031
      ** Acceptance Mode                                                                      CSD031
      *                                                                                       CSD031
     C           *INU1     IFEQ *OFF                                                          CSD031
      *                                                                                       CSD031
     C           PMODE     IFEQ 'A'                                                           CSD031
     C           KRTV      CHAINSDAHDYD0             9091                                     CSD031
     C                     ELSE                                                               CSD031
     C           KRTV      CHAIN@HOLPH0              9091                                     CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      ** Read GPHOLIL1 file if CSD041 is enabled and at Central Level.                        CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
     C           KRTV      CHAINGPHOLID0             9091                                     CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
     C           KRTV      CHAIN@HOLPH0              9091  *
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C           *IN91     IFEQ '1'
      * Record locked.
     C                     SETON                     993132*
     C                     SETON                     33    *
     C                     GOTO BEEXIT
     C                     END                             FI 91
      *
      * If record does not exist then signal error
     C           *IN90     IFEQ '1'
     C                     SETON                     993132*
     C                     SETON                     33    *
      * Send message 'Holidays               NF'
     C                     MOVEL'USR0657' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     ELSE
     C                     EXSR MBFL#1
      * CALC: Detail screen function fields
      *CASE:     WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ @CN,01                     *IF
      * 00/Copy Member SD0161ESFF - Holidays  *
     C*00/Copy Member SD0161E   Calculate Detail Func Fld
     C/COPY WNCPYSRC,SD0161ESFF
     C                     END                             *FI
      * USER: Load detail screen from DBF record
      *CASE:     DB1.Location Code is Global Value
     C           DGLCCD    IFEQ @CN,02                     *IF
     C                     MOVEL*BLANK    #DLCDF           Location Code -
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVELDGLCCD    #DLCDF           Location Code -
     C                     END                             *FI
      * Set up Month Days 1st Q - Holidays  *
     C* SET UP THE DAY NUMBERS FOR THE SCREEN (JANUARY)
     C           1         ADD  WUDYCD    X       20
     C                     MOVEAJAN       TEMP,X
     C                     MOVEATEMP      JANUAR
     C                     MOVEA*BLANKS   TEMP
     C* SET UP THE DAY NUMBER FOR THE SCREEN (FEBRUARY)
     C           X         ADD  3         X
     C           X         IFGT 7
     C           X         SUB  7         X
     C                     END
     C           WULYRI    IFEQ 'N'
     C                     MOVEAFEB1      TEMP,X
     C                     ELSE
     C                     MOVEAFEB2      TEMP,X
     C                     END
     C                     MOVEATEMP      FEBRUA
     C                     MOVEA*BLANKS   TEMP
     C* SET UP THE DAY NUMBER FOR THE SCREEN (MARCH)
     C           WULYRI    IFEQ 'Y'
     C           X         ADD  1         X
     C           X         IFGT 7
     C           X         SUB  7         X
     C                     END
     C                     END
     C                     MOVEAMAR       TEMP,X
     C                     MOVEATEMP      MARCH
      * Get Holidays for 1st Q - Holidays  *
     C                     EXSR SARVGN
      * Set up existing Holidays - Holidays  *
     C* CALCULATE THE FIELD DIFFERENTIAL FOR JANUARY
     C           WUDYCD    ADD  1         X
     C           @CN,05    IFEQ 'S'
     C                     MOVEAJANFLD    JAST,X
     C                     ELSE
     C                     MOVEAJAST,X    JANFLD
     C                     END
     C* CALCULATE THE FIELD DIFFERENTIAL FOR FEBRUARY
     C           X         ADD  3         X
     C           X         IFGT 7
     C           X         SUB  7         X
     C                     END
     C           @CN,05    IFEQ 'S'
     C                     MOVEAFEBFLD    FEST,X
     C* IF IT IS NOT A LEAP YEAR HIDE THE VALUE FOR 29/2
     C           WULYRI    IFEQ 'N'
     C           X         ADD  28        L       20
     C                     MOVE *BLANK    FEST,L
     C                     END
     C                     ELSE
     C                     MOVEAFEST,X    FEBFLD
     C                     END
     C* CALCULATE THE FIELD DIFFERENTIAL FOR MARCH
     C           WULYRI    IFEQ 'Y'
     C           X         ADD  1         X
     C           X         IFGT 7
     C           X         SUB  7         X
     C                     END
     C                     END
     C           @CN,05    IFEQ 'S'
     C                     MOVEAMARFLD    MAST,X
     C                     ELSE
     C                     MOVEAMAST,X    MARFLD
     C                     END
     C* IF IT IS NOT A LEAP YEAR THEN ENSURE THAT FEB 29 IS BLANK
     C           WULYRI    IFEQ 'N'
     C                     MOVE *BLANK    WUFE29
     C                     END
      *CASE:     WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ @CN,01                     *IF
      * 00/Copy Member SD0161ELDS - Holidays  *
     C*00/Copy Member SD0161E   Load Detail Screen
     C/COPY WNCPYSRC,SD0161ELDS
     C                     END                             *FI
     C                     END
      *
     C   99                GOTO BEEXIT
      * No errors: Display and process details
     C                     EXSR CADSDA
      *
      *================================================================
     CSR         BEEXIT    ENDSR
      /EJECT
     CSR         BFVLKY    BEGSR
      *================================================================
      * Validate key fields.
      *================================================================
      * Check relations.
      * Check reference to Currency Codes.
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     9931  *
     C                     END
      * Check reference to Location Codes.
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     9932  *
     C                     END
      * USER: Validate key screen
      *CASE:     WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ @CN,01                     *IF
      * 00/Copy Member SD0161EVKS - Holidays  *
     C*00/Copy Member SD0161E   Validate Key Screen
     C/COPY WNCPYSRC,SD0161EVKS
     C                     END                             *FI
      * Currency Code required.
     C           #1CYCD    IFEQ *BLANK                     IF
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID           Message id.
     C                     MOVEL'Y2USRMSG'ZAMSGF           Message file.
     C                     EXSR ZASNMS                     Send message
     C                     END                             FI
      * Location Code required.
     C           #1LCCD    IFEQ *BLANK                     IF
     C                     SETON                     9932  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID           Message id.
     C                     MOVEL'Y2USRMSG'ZAMSGF           Message file.
     C                     EXSR ZASNMS                     Send message
     C                     END                             FI
      * Year Number required.
     C           #1YRNB    IFEQ *BLANK                     IF
     C                     SETON                     9933  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID           Message id.
     C                     MOVEL'Y2USRMSG'ZAMSGF           Message file.
     C                     EXSR ZASNMS                     Send message
     C                     END                             FI
      *================================================================
     CSR         BFEXIT    ENDSR
      /EJECT
     CSR         CADSDA    BEGSR
      *================================================================
      * Display and process details.
      *================================================================
      * Conduct detail screen conversation:
      * - repeat until screen control flag is reset:
     C           W0TRN     DOWEQ'Y'
      * Display detail screen.
     C                     EXSR CBEXFM
      * Process response to detail screen:
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields.
      * Process detail screen input.
      * Redisplay previous screen
     C   12                CAS            CCDSPV
     C                     CAS            CFPRSC
     C                     END
      *
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         CBEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests.
      *================================================================
      * Set screen conditioning indicators.
     C                     EXSR GBDSAD
      * Update screen time.
     C                     TIME           ##TME            Screen time.
     C           W0HLP     DOUEQ'N'
      * Enable PUTOVR.
     C                     SETON                     86
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT2
     C                     EXFMT#RCDDTL1
     C                     MOVEL'N'       W0HLP   1        Reset help requ
      * If help requested, display help text.
     C   25                EXSR ZHHPKY                     Display help te
     C                     END
      * Update job time.
     C                     TIME           ##JTM            Job time.
      * Clear messages from program message queue.
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGM  10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag.
     C                     MOVEL'Y'       ZAFSMS  1      99*
      *================================================================
     CSR         CBEXIT    ENDSR
      /EJECT
     CSR         CCDSPV    BEGSR
      *================================================================
      * Redisplay previous screen.
      *================================================================
      * USER: Process key screen request
      *CASE:     WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ @CN,01                     *IF
      * 00/Copy Member SD0161EPKR - Holidays  *
     C*00/Copy Member SD0161E   Process Key Screen Rqst
     C/COPY WNCPYSRC,SD0161EPKR
     C                     END                             *FI
     C                     MOVEL@CN,06    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     MOVEL'R'       W0TRN
      *================================================================
     CSR         CCEXIT    ENDSR
      /EJECT
     CSR         CFPRSC    BEGSR
      *================================================================
      * Validate record.
      *================================================================
      * Confirm/update is not defered.
     C                     MOVEL'N'       W0DCF   1
      * Validate details.
     C                     EXSR DCVLDL
      * Quit if error:
     C   99                GOTO CFEXIT
      * Defer confirm/update requested:
     C           W0DCF     CABEQ'Y'       CFEXIT
      * Process record:
     C                     EXSR EBPR##
      *================================================================
     CSR         CFEXIT    ENDSR
      /EJECT
     CSR         DCVLDL    BEGSR
      *================================================================
      * Validate details.
      *================================================================
      * CALC: Detail screen function fields
      *CASE:     WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ @CN,01                     *IF
      * 00/Copy Member SD0161ESFF - Holidays  *
     C*00/Copy Member SD0161E   Calculate Detail Func Fld
     C/COPY WNCPYSRC,SD0161ESFF
     C                     END                             *FI
      * USER: Validate detail screen
      *CASE:     WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ @CN,01                     *IF
      *CASE:     WRK.Window processing requir. is Yes
     C           WUWDPR    IFEQ @CN,01                     *IF
      * WM call Window Manager - Window manager  *
     C***********          CALL 'WIND01'                                  S01212
     C                     CALL 'WN0010'                                  S01212
     C*********************PARM           ##PGM            Program        S01212
     C                     PARM ##PGM     UPGM   10        Program        S01212
     C*********************PARM *BLANK    FKEY    2        Function Key   S01212
     C                     PARM *BLANK    UFKEY   2        Function Key   S01212
     C*********************PARM           WUMEST           Action  S01212 S01229
     C*********************PARM           WUWMAC           Action  S01212 S01229
     C                     PARM @CN,07    UACTCD  1        Action  S01212 S01229
     C                     PARM           DATA             Trans Data     S01212
     C                     PARM *BLANK    W0RTN            Return Code    S01212
     C                     PARM           SPARE 256        Spare Field    LN0355
      * WM Check Return
      *CASE:     PAR.*Return code is *User QUIT requested
     C           W0RTN     IFEQ @CN,08                     *IF
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      *CASE:     PAR.*Return code is WN Window Error
     C           W0RTN     IFEQ @CN,09                     *IF
      * Send message 'WN Window Error'
     C                     MOVEL'USR0563' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     99    *
      *
     C                     MOVEL@CN,01    W0DCF            *Defer confirm
     C                     GOTO DCEXIT                     *QUIT
     C                     ELSE
      *CASE:     PAR.*Return code is *DBF update error
     C           W0RTN     IFEQ @CN,10                     *IF
      * Send message 'WN Database Error'
     C                     MOVEL'USR0567' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     99    *
      *
     C                     MOVEL@CN,01    W0DCF            *Defer confirm
     C                     GOTO DCEXIT                     *QUIT
     C                     ELSE
      *CASE:     PAR.*Return code is *Previous Screen
     C           W0RTN     IFEQ @CN,06                     *IF
     C                     MOVEL@CN,01    W0DCF            *Defer confirm
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 00/Copy Member SD0161EVSW - Holidays  *
     C*00/Copy Member SD0161E   Validate Detail Scrn Wdw
     C/COPY WNCPYSRC,SD0161EVSW
     C                     END                             *FI
      * 00/Copy Member SD0161EVDS - Holidays  *
     C*00/Copy Member SD0161E   Validate Detail Screen
     C/COPY WNCPYSRC,SD0161EVDS
     C                     END                             *FI
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         EBPR##    BEGSR
      *================================================================
      * Process record.
      *================================================================
      * USER: Perform confirmed action
      * Dsp a Years Holidays 2 - Holidays  *
     C                     MOVEL*BLANK    PARC
     C                     MOVEL#1CYCD    PACYCD           Currency Code
     C                     MOVEL#1LCCD    PALCCD           Location Code
     C                     MOVEL#1YRNB    PAYRNB           Year Number
      *
     C                     CALL 'SD0162E'              90  Dsp a Years Hol
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM           PARC             KEY: Holidays
     C                     PARM WUDYCD    WQ0006  10       Day Code
     C                     PARM WULYRI    WQ0007  1        Leap Year Indic
     C                     PARM PMODE     WMODE   1                                           CSD031
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Error detected ?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *CASE:     PGM.*Return code is *Previous Screen
     C           W0RTN     IFEQ @CN,06                     *IF
     C                     MOVEL@CN,01    W0DCF            *Defer confirm
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      *CASE:     WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ @CN,01                     *IF
      * 00/Copy Member SD0161EPCA - Holidays  *
     C*00/Copy Member SD0161E   Perform Confrimed Action
     C/COPY WNCPYSRC,SD0161EPCA
     C                     END                             *FI
      * Quit if error signalled.
     C   99                GOTO EBEXIT
      * USER: Process command keys
      *CASE:     WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ @CN,01                     *IF
      * 00/Copy Member SD0161EPCK - Holidays  *
     C*00/Copy Member SD0161E   Process Command Keys
     C/COPY WNCPYSRC,SD0161EPCK
     C                     END                             *FI
      * Quit if error signalled.
     C   99                GOTO EBEXIT
      * Restart program for next record.
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         FACKPM    BEGSR
      *================================================================
      * Check passed parameters.
      *================================================================
      * Is full key present?
     C           P1CYCD    IFEQ *BLANK                     Currency Code
     C           P1LCCD    OREQ *BLANK                     Location Code
     C           P1YRNB    OREQ *BLANK                     Year Number
      * Not every key field passed - loop program.
     C                     MOVEL'Y'       W0RPT   1
     C                     ELSE
      * Full key passed, so single shot program.
     C                     MOVEL'N'       W0RPT
     C                     END
      *================================================================
     CSR         FAEXIT    ENDSR
      /EJECT
     CSR         GADSAK    BEGSR
      *================================================================
      * Set key screen conditioning indicators.
      *================================================================
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSAD    BEGSR
      *================================================================
      * Set detail screen conditioning indicators.
      *================================================================
      * Protect key fields on detail screen.
     C                     SETON                     88    *
      * Enable key screen.
     C                     SETON                     87    *
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise record - except for key fields.
      *================================================================
     C                     Z-ADD*ZERO     #1LCD            Last Change Dat
     C                     MOVEL*BLANK    #1TYLC           Type of Last Ch
     C                     MOVEL*BLANK    #DLCDF           Location Code -
     C                     MOVEL*BLANK    #DJ01N           January 01 Nume
     C                     MOVEL*BLANK    #DJ01S           January 01 Stat
     C                     MOVEL*BLANK    #DJ08N           January 08 Nume
     C                     MOVEL*BLANK    #DJ08S           January 08 Stat
     C                     MOVEL*BLANK    #DJ15N           January 15 Nume
     C                     MOVEL*BLANK    #DJ15S           January 15 Stat
     C                     MOVEL*BLANK    #DJ22N           January 22 Nume
     C                     MOVEL*BLANK    #DJ22S           January 22 Stat
     C                     MOVEL*BLANK    #DJ29N           January 29 Nume
     C                     MOVEL*BLANK    #DJ29S           January 29 Stat
     C                     MOVEL*BLANK    #DJ36N           January 36 Nume
     C                     MOVEL*BLANK    #DJ36S           January 36 Stat
     C                     MOVEL*BLANK    #DF01N           February 01 Num
     C                     MOVEL*BLANK    #DF01S           February 01 Sta
     C                     MOVEL*BLANK    #DF08N           February 08 Num
     C                     MOVEL*BLANK    #DF08S           February 08 Sta
     C                     MOVEL*BLANK    #DF15N           February 15 Num
     C                     MOVEL*BLANK    #DF15S           February 15 Sta
     C                     MOVEL*BLANK    #DF22N           February 22 Num
     C                     MOVEL*BLANK    #DF22S           February 22 Sta
     C                     MOVEL*BLANK    #DF29N           February 29 Num
     C                     MOVEL*BLANK    #DF29S           February 29 Sta
     C                     MOVEL*BLANK    #DJ02N           January 02 Nume
     C                     MOVEL*BLANK    #DJ02S           January 02 Stat
     C                     MOVEL*BLANK    #DJ09N           January 09 Nume
     C                     MOVEL*BLANK    #DJ09S           January 09 Stat
     C                     MOVEL*BLANK    #DJ16N           January 16 Nume
     C                     MOVEL*BLANK    #DJ16S           January 16 Stat
     C                     MOVEL*BLANK    #DJ23N           January 23 Nume
     C                     MOVEL*BLANK    #DJ23S           January 23 Stat
     C                     MOVEL*BLANK    #DJ30N           January 30 Nume
     C                     MOVEL*BLANK    #DJ30S           January 30 Stat
     C                     MOVEL*BLANK    #DJ37N           January 37 Nume
     C                     MOVEL*BLANK    #DJ37S           January 37 Stat
     C                     MOVEL*BLANK    #DF02N           February 02 Num
     C                     MOVEL*BLANK    #DF02S           February 02 Sta
     C                     MOVEL*BLANK    #DF09N           February 09 Num
     C                     MOVEL*BLANK    #DF09S           February 09 Sta
     C                     MOVEL*BLANK    #DF16N           February 16 Num
     C                     MOVEL*BLANK    #DF16S           February 16 Sta
     C                     MOVEL*BLANK    #DF23N           February 23 Num
     C                     MOVEL*BLANK    #DF23S           February 23 Sta
     C                     MOVEL*BLANK    #DF30N           February 30 Num
     C                     MOVEL*BLANK    #DF30S           February 30 Sta
     C                     MOVEL*BLANK    #DJ03N           January 03 Nume
     C                     MOVEL*BLANK    #DJ03S           January 03 Stat
     C                     MOVEL*BLANK    #DJ10N           January 10 Nume
     C                     MOVEL*BLANK    #DJ10S           January 10 Stat
     C                     MOVEL*BLANK    #DJ17N           January 17 Nume
     C                     MOVEL*BLANK    #DJ17S           January 17 Stat
     C                     MOVEL*BLANK    #DJ24N           January 24 Nume
     C                     MOVEL*BLANK    #DJ24S           January 24 Stat
     C                     MOVEL*BLANK    #DJ31N           January 31 Nume
     C                     MOVEL*BLANK    #DJ31S           January 31 Stat
     C                     MOVEL*BLANK    #DF03N           February 03 Num
     C                     MOVEL*BLANK    #DF03S           February 03 Sta
     C                     MOVEL*BLANK    #DF10N           February 10 Num
     C                     MOVEL*BLANK    #DF10S           February 10 Sta
     C                     MOVEL*BLANK    #DF17N           February 17 Num
     C                     MOVEL*BLANK    #DF17S           February 17 Sta
     C                     MOVEL*BLANK    #DF24N           February 24 Num
     C                     MOVEL*BLANK    #DF24S           February 24 Sta
     C                     MOVEL*BLANK    #DF31N           February 31 Num
     C                     MOVEL*BLANK    #DF31S           February 31 Sta
     C                     MOVEL*BLANK    #DJ04N           January 04 Nume
     C                     MOVEL*BLANK    #DJ04S           January 04 Stat
     C                     MOVEL*BLANK    #DJ11N           January 11 Nume
     C                     MOVEL*BLANK    #DJ11S           January 11 Stat
     C                     MOVEL*BLANK    #DJ18N           January 18 Nume
     C                     MOVEL*BLANK    #DJ18S           January 18 Stat
     C                     MOVEL*BLANK    #DJ25N           January 25 Nume
     C                     MOVEL*BLANK    #DJ25S           January 25 Stat
     C                     MOVEL*BLANK    #DJ32N           January 32 Nume
     C                     MOVEL*BLANK    #DJ32S           January 32 Stat
     C                     MOVEL*BLANK    #DF04N           February 04 Num
     C                     MOVEL*BLANK    #DF04S           February 04 Sta
     C                     MOVEL*BLANK    #DF11N           February 11 Num
     C                     MOVEL*BLANK    #DF11S           February 11 Sta
     C                     MOVEL*BLANK    #DF18N           February 18 Num
     C                     MOVEL*BLANK    #DF18S           February 18 Sta
     C                     MOVEL*BLANK    #DF25N           February 25 Num
     C                     MOVEL*BLANK    #DF25S           February 25 Sta
     C                     MOVEL*BLANK    #DF32N           February 32 Num
     C                     MOVEL*BLANK    #DF32S           February 32 Sta
     C                     MOVEL*BLANK    #DJ05N           January 05 Nume
     C                     MOVEL*BLANK    #DJ05S           January 05 Stat
     C                     MOVEL*BLANK    #DJ12N           January 12 Nume
     C                     MOVEL*BLANK    #DJ12S           January 12 Stat
     C                     MOVEL*BLANK    #DJ19N           January 19 Nume
     C                     MOVEL*BLANK    #DJ19S           January 19 Stat
     C                     MOVEL*BLANK    #DJ26N           January 26 Nume
     C                     MOVEL*BLANK    #DJ26S           January 26 Stat
     C                     MOVEL*BLANK    #DJ33N           January 33 Nume
     C                     MOVEL*BLANK    #DJ33S           January 33 Stat
     C                     MOVEL*BLANK    #DF05N           February 05 Num
     C                     MOVEL*BLANK    #DF05S           February 05 Sta
     C                     MOVEL*BLANK    #DF12N           February 12 Num
     C                     MOVEL*BLANK    #DF12S           February 12 Sta
     C                     MOVEL*BLANK    #DF19N           February 19 Num
     C                     MOVEL*BLANK    #DF19S           February 19 Sta
     C                     MOVEL*BLANK    #DF26N           February 26 Num
     C                     MOVEL*BLANK    #DF26S           February 26 Sta
     C                     MOVEL*BLANK    #DF33N           February 33 Num
     C                     MOVEL*BLANK    #DF33S           February 33 Sta
     C                     MOVEL*BLANK    #DJ06N           January 06 Nume
     C                     MOVEL*BLANK    #DJ06S           January 06 Stat
     C                     MOVEL*BLANK    #DJ13N           January 13 Nume
     C                     MOVEL*BLANK    #DJ13S           January 13 Stat
     C                     MOVEL*BLANK    #DJ20N           January 20 Nume
     C                     MOVEL*BLANK    #DJ20S           January 20 Stat
     C                     MOVEL*BLANK    #DJ27N           January 27 Nume
     C                     MOVEL*BLANK    #DJ27S           January 27 Stat
     C                     MOVEL*BLANK    #DJ34N           January 34 Nume
     C                     MOVEL*BLANK    #DJ34S           January 34 Stat
     C                     MOVEL*BLANK    #DF06N           February 06 Num
     C                     MOVEL*BLANK    #DF06S           February 06 Sta
     C                     MOVEL*BLANK    #DF13N           February 13 Num
     C                     MOVEL*BLANK    #DF13S           February 13 Sta
     C                     MOVEL*BLANK    #DF20N           February 20 Num
     C                     MOVEL*BLANK    #DF20S           February 20 Sta
     C                     MOVEL*BLANK    #DF27N           February 27 Num
     C                     MOVEL*BLANK    #DF27S           February 27 Sta
     C                     MOVEL*BLANK    #DF34N           February 34 Num
     C                     MOVEL*BLANK    #DF34S           February 34 Sta
     C                     MOVEL*BLANK    #DJ07N           January 07 Nume
     C                     MOVEL*BLANK    #DJ07S           January 07 Stat
     C                     MOVEL*BLANK    #DJ14N           January 14 Nume
     C                     MOVEL*BLANK    #DJ14S           January 14 Stat
     C                     MOVEL*BLANK    #DJ21N           January 21 Nume
     C                     MOVEL*BLANK    #DJ21S           January 21 Stat
     C                     MOVEL*BLANK    #DJ28N           January 28 Nume
     C                     MOVEL*BLANK    #DJ28S           January 28 Stat
     C                     MOVEL*BLANK    #DJ35N           January 35 Nume
     C                     MOVEL*BLANK    #DJ35S           January 35 Stat
     C                     MOVEL*BLANK    #DF07N           February 07 Num
     C                     MOVEL*BLANK    #DF07S           February 07 Sta
     C                     MOVEL*BLANK    #DF14N           February 14 Num
     C                     MOVEL*BLANK    #DF14S           February 14 Sta
     C                     MOVEL*BLANK    #DF21N           February 21 Num
     C                     MOVEL*BLANK    #DF21S           February 21 Sta
     C                     MOVEL*BLANK    #DF28N           February 28 Num
     C                     MOVEL*BLANK    #DF28S           February 28 Sta
     C                     MOVEL*BLANK    #DF35N           February 35 Num
     C                     MOVEL*BLANK    #DF35S           February 35 Sta
     C                     MOVEL*BLANK    #DM01N           March 01 Numeri
     C                     MOVEL*BLANK    #DM01S           March 01 Status
     C                     MOVEL*BLANK    #DM08N           March 08 Numeri
     C                     MOVEL*BLANK    #DM08S           March 08 Status
     C                     MOVEL*BLANK    #DM15N           March 15 Numeri
     C                     MOVEL*BLANK    #DM15S           March 15 Status
     C                     MOVEL*BLANK    #DM22N           March 22 Numeri
     C                     MOVEL*BLANK    #DM22S           March 22 Status
     C                     MOVEL*BLANK    #DM29N           March 29 Numeri
     C                     MOVEL*BLANK    #DM29S           March 29 Status
     C                     MOVEL*BLANK    #DM36N           March 36 Numeri
     C                     MOVEL*BLANK    #DM36S           March 36 Status
     C                     MOVEL*BLANK    #DM02N           March 02 Numeri
     C                     MOVEL*BLANK    #DM02S           March 02 Status
     C                     MOVEL*BLANK    #DM09N           March 09 Numeri
     C                     MOVEL*BLANK    #DM09S           March 09 Status
     C                     MOVEL*BLANK    #DM16N           March 16 Numeri
     C                     MOVEL*BLANK    #DM16S           March 16 Status
     C                     MOVEL*BLANK    #DM23N           March 23 Numeri
     C                     MOVEL*BLANK    #DM23S           March 23 Status
     C                     MOVEL*BLANK    #DM30N           March 30 Numeri
     C                     MOVEL*BLANK    #DM30S           March 30 Status
     C                     MOVEL*BLANK    #DM37N           March 37 Numeri
     C                     MOVEL*BLANK    #DM37S           March 37 Status
     C                     MOVEL*BLANK    #DM03N           March 03 Numeri
     C                     MOVEL*BLANK    #DM03S           March 03 Status
     C                     MOVEL*BLANK    #DM10N           March 10 Numeri
     C                     MOVEL*BLANK    #DM10S           March 10 Status
     C                     MOVEL*BLANK    #DM17N           March 17 Numeri
     C                     MOVEL*BLANK    #DM17S           March 17 Status
     C                     MOVEL*BLANK    #DM24N           March 24 Numeri
     C                     MOVEL*BLANK    #DM24S           March 24 Status
     C                     MOVEL*BLANK    #DM31N           March 31 Numeri
     C                     MOVEL*BLANK    #DM31S           March 31 Status
     C                     MOVEL*BLANK    #DM04N           March 04 Numeri
     C                     MOVEL*BLANK    #DM04S           March 04 Status
     C                     MOVEL*BLANK    #DM11N           March 11 Numeri
     C                     MOVEL*BLANK    #DM11S           March 11 Status
     C                     MOVEL*BLANK    #DM18N           March 18 Numeri
     C                     MOVEL*BLANK    #DM18S           March 18 Status
     C                     MOVEL*BLANK    #DM25N           March 25 Numeri
     C                     MOVEL*BLANK    #DM25S           March 25 Status
     C                     MOVEL*BLANK    #DM32N           March 32 Numeri
     C                     MOVEL*BLANK    #DM32S           March 32 Status
     C                     MOVEL*BLANK    #DM05N           March 05 Numeri
     C                     MOVEL*BLANK    #DM05S           March 05 Status
     C                     MOVEL*BLANK    #DM12N           March 12 Numeri
     C                     MOVEL*BLANK    #DM12S           March 12 Status
     C                     MOVEL*BLANK    #DM19N           March 19 Numeri
     C                     MOVEL*BLANK    #DM19S           March 19 Status
     C                     MOVEL*BLANK    #DM26N           March 26 Numeri
     C                     MOVEL*BLANK    #DM26S           March 26 Status
     C                     MOVEL*BLANK    #DM33N           March 33 Numeri
     C                     MOVEL*BLANK    #DM33S           March 33 Status
     C                     MOVEL*BLANK    #DM06N           March 06 Numeri
     C                     MOVEL*BLANK    #DM06S           March 06 Status
     C                     MOVEL*BLANK    #DM13N           March 13 Numeri
     C                     MOVEL*BLANK    #DM13S           March 13 Status
     C                     MOVEL*BLANK    #DM20N           March 20 Numeri
     C                     MOVEL*BLANK    #DM20S           March 20 Status
     C                     MOVEL*BLANK    #DM27N           March 27 Numeri
     C                     MOVEL*BLANK    #DM27S           March 27 Status
     C                     MOVEL*BLANK    #DM34N           March 34 Numeri
     C                     MOVEL*BLANK    #DM34S           March 34 Status
     C                     MOVEL*BLANK    #DM07N           March 07 Numeri
     C                     MOVEL*BLANK    #DM07S           March 07 Status
     C                     MOVEL*BLANK    #DM14N           March 14 Numeri
     C                     MOVEL*BLANK    #DM14S           March 14 Status
     C                     MOVEL*BLANK    #DM21N           March 21 Numeri
     C                     MOVEL*BLANK    #DM21S           March 21 Status
     C                     MOVEL*BLANK    #DM28N           March 28 Numeri
     C                     MOVEL*BLANK    #DM28S           March 28 Status
     C                     MOVEL*BLANK    #DM35N           March 35 Numeri
     C                     MOVEL*BLANK    #DM35S           March 35 Status
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @HOLPH0 fields to screen.
      *================================================================
     C                     MOVELDGLCCD    #1LCCD           Location Code
     C                     Z-ADDDGLCD     #1LCD            Last Change Dat
     C                     MOVELDGTYLC    #1TYLC           Type of Last Ch
     C                     MOVELDGCYCD    #1CYCD           Currency Code
     C                     MOVELDGYRNB    #1YRNB           Year Number
      *                                                                                       CSD031
      ** Move data if CSD041 is enabled.                                                      CSD031
      *                                                                                       CSD031
     C           CSD041    IFEQ 'Y'                                                           CSD031
      *                                                                                       CSD031
     C                     MOVE *OFF      *IN27                                               CSD031
     C           *INU1     IFEQ *OFF                                                          CSD031
      *                                                                                       CSD031
     C           PMODE     IFEQ 'A'                                                           CSD031
     C                     MOVEL*BLANKS   #1HPDT                                              CSD031
     C                     MOVEL*BLANKS   #1GPDT                                              CSD031
     C                     ELSE                                                               CSD031
     C                     MOVELWKGPDT    #1HPDT                                              CSD031
     C                     MOVELDGGPDT    #1GPDT                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C           DGEACC    IFNE *ZEROS                                                        CSD031
     C                     Z-ADDDGEACC    ZDAYNO                                              CSD031
     C                     CALL 'ZDATE2'                                                      CSD031
     C                     PARM           ZDAYNO  50                                          CSD031
     C                     PARM WUDFF     DATFMT  1                                           CSD031
     C                     PARM           ZDATE   60                                          CSD031
     C                     PARM           ZADATE  7                                           CSD031
     C                     MOVELZDATE     #1EACC                                              CSD031
     C                     ELSE                                                               CSD031
     C                     MOVE *BLANKS   #1EACC                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
     C                     MOVELWKAACC    #1HPDT                                              CSD031
     C                     MOVELDGAACC    #1GPDT                                              CSD031
      *                                                                                       CSD031
     C           DGEACC    IFNE *ZEROS                                                        CSD031
     C                     Z-ADDDGEACC    ZDAYNO                                              CSD031
     C                     CALL 'ZDATE2'                                                      CSD031
     C                     PARM           ZDAYNO  50                                          CSD031
     C                     PARM WUDFF     DATFMT  1                                           CSD031
     C                     PARM           ZDATE   60                                          CSD031
     C                     PARM           ZADATE  7                                           CSD031
     C                     MOVELZDATE     #1EACC                                              CSD031
     C                     ELSE                                                               CSD031
     C                     MOVE *BLANKS   #1EACC                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     ENDIF                                                              CSD031
     C                     ELSE                                                               CSD031
     C                     MOVE *ON       *IN27                                               CSD031
      *                                                                                       CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MDIZ#K    BEGSR
      *================================================================
      * Initialise key screen.
      *================================================================
     C                     MOVELP1CYCD    #1CYCD           Currency Code
     C                     MOVELP1LCCD    #1LCCD           Location Code
     C                     MOVELP1YRNB    #1YRNB           Year Number
      * USER: Load key screen
      *CASE:     WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ @CN,01                     *IF
      * 00/Copy Member SD0161ELKS - Holidays  *
     C*00/Copy Member SD0161E   Load Key Screen
     C/COPY WNCPYSRC,SD0161ELKS
     C                     END                             *FI
      *================================================================
     CSR         MDEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Get Holidays for 1st Q - Holidays  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields.
     C           *LIKE     DEFN WACYCD    WQSA01           Currency Code
     C           *LIKE     DEFN WALCCD    WQSA02           Location Code
     C           *LIKE     DEFN WAYRNB    WQSA03           Year Number
      * Define Keylist.
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Currency Code
     C                     KFLD           WQSA02           Location Code
     C                     KFLD           WQSA03           Year Number
      * Move fields to key list.
     C                     MOVELDGCYCD    WQSA01           Currency Code
     C                     MOVELDGLCCD    WQSA02           Location Code
     C                     MOVELDGYRNB    WQSA03           Year Number
      *                                                                                       CSD031
      ** If CSD041 is enabled.                                                                CSD031
      *                                                                                       CSD031
     C           CSD041    IFEQ 'Y'                                                           CSD031
      *                                                                                       CSD031
      ** Read SDAHDYL8 file if CSD041 is enabled and at Zone Level and                        CSD031
      ** Acceptance Mode                                                                      CSD031
      *                                                                                       CSD031
     C           *INU1     IFEQ *OFF                                                          CSD031
      *                                                                                       CSD031
     C           PMODE     IFEQ 'A'                                                           CSD031
     C           KRSSA     SETLLSDAHDYD8                                                      CSD031
     C           KRSSA     READESDAHDYD8                 90                                   CSD031
     C                     ELSE                                                               CSD031
     C           KRSSA     SETLL@HOLPH8                                                       CSD031
     C           KRSSA     READE@HOLPH8                  90                                   CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      ** Read GPHOLIL2 file if CSD041 is enabled and at Central Level.                        CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
     C           KRSSA     SETLLGPHOLID2                                                      CSD031
     C           KRSSA     READEGPHOLID2                 90                                   CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
     C           KRSSA     SETLL@HOLPH8                    *
     C           KRSSA     READE@HOLPH8                  90*
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C           *IN90     IFEQ '1'
      * DBF Record not found.
     C                     MOVEL'USR0657' W0RTN   7
      * USER: Processing if DBF record not found
     C                     MOVEL@CN,03    W0RTN            *Return code
     C                     GOTO SAEXIT
     C                     END
      *
     C           *IN90     DOWEQ'0'
      * USER: Process DBF record
     C                     MOVEL@CN,04    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWAJA01    WUJA01           January 1
     C                     MOVELWAJA02    WUJA02           January 2
     C                     MOVELWAJA03    WUJA03           January 3
     C                     MOVELWAJA04    WUJA04           January 4
     C                     MOVELWAJA05    WUJA05           January 5
     C                     MOVELWAJA06    WUJA06           January 6
     C                     MOVELWAJA07    WUJA07           January 7
     C                     MOVELWAJA08    WUJA08           January 8
     C                     MOVELWAJA09    WUJA09           January 9
     C                     MOVELWAJA10    WUJA10           January 10
     C                     MOVELWAJA11    WUJA11           January 11
     C                     MOVELWAJA12    WUJA12           January 12
     C                     MOVELWAJA13    WUJA13           January 13
     C                     MOVELWAJA14    WUJA14           January 14
     C                     MOVELWAJA15    WUJA15           January 15
     C                     MOVELWAJA16    WUJA16           January 16
     C                     MOVELWAJA17    WUJA17           January 17
     C                     MOVELWAJA18    WUJA18           January 18
     C                     MOVELWAJA19    WUJA19           January 19
     C                     MOVELWAJA20    WUJA20           January 20
     C                     MOVELWAJA21    WUJA21           January 21
     C                     MOVELWAJA22    WUJA22           January 22
     C                     MOVELWAJA23    WUJA23           January 23
     C                     MOVELWAJA24    WUJA24           January 24
     C                     MOVELWAJA25    WUJA25           January 25
     C                     MOVELWAJA26    WUJA26           January 26
     C                     MOVELWAJA27    WUJA27           January 27
     C                     MOVELWAJA28    WUJA28           January 28
     C                     MOVELWAJA29    WUJA29           January 29
     C                     MOVELWAJA30    WUJA30           January 30
     C                     MOVELWAJA31    WUJA31           January 31
     C                     MOVELWAFE01    WUFE01           February 1
     C                     MOVELWAFE02    WUFE02           February 2
     C                     MOVELWAFE03    WUFE03           February 3
     C                     MOVELWAFE04    WUFE04           February 4
     C                     MOVELWAFE05    WUFE05           February 5
     C                     MOVELWAFE06    WUFE06           February 6
     C                     MOVELWAFE07    WUFE07           February 7
     C                     MOVELWAFE08    WUFE08           February 8
     C                     MOVELWAFE09    WUFE09           February 9
     C                     MOVELWAFE10    WUFE10           February 10
     C                     MOVELWAFE11    WUFE11           February 11
     C                     MOVELWAFE12    WUFE12           February 12
     C                     MOVELWAFE13    WUFE13           February 13
     C                     MOVELWAFE14    WUFE14           February 14
     C                     MOVELWAFE15    WUFE15           February 15
     C                     MOVELWAFE16    WUFE16           February 16
     C                     MOVELWAFE17    WUFE17           February 17
     C                     MOVELWAFE18    WUFE18           February 18
     C                     MOVELWAFE19    WUFE19           February 19
     C                     MOVELWAFE20    WUFE20           February 20
     C                     MOVELWAFE21    WUFE21           February 21
     C                     MOVELWAFE22    WUFE22           February 22
     C                     MOVELWAFE23    WUFE23           February 23
     C                     MOVELWAFE24    WUFE24           February 24
     C                     MOVELWAFE25    WUFE25           February 25
     C                     MOVELWAFE26    WUFE26           February 26
     C                     MOVELWAFE27    WUFE27           February 27
     C                     MOVELWAFE28    WUFE28           February 28
     C                     MOVELWAFE29    WUFE29           February 29
     C                     MOVELWAMA01    WUMA01           March 1
     C                     MOVELWAMA02    WUMA02           March 2
     C                     MOVELWAMA03    WUMA03           March 3
     C                     MOVELWAMA04    WUMA04           March 4
     C                     MOVELWAMA05    WUMA05           March 5
     C                     MOVELWAMA06    WUMA06           March 6
     C                     MOVELWAMA07    WUMA07           March 7
     C                     MOVELWAMA08    WUMA08           March 8
     C                     MOVELWAMA09    WUMA09           March 9
     C                     MOVELWAMA10    WUMA10           March 10
     C                     MOVELWAMA11    WUMA11           March 11
     C                     MOVELWAMA12    WUMA12           March 12
     C                     MOVELWAMA13    WUMA13           March 13
     C                     MOVELWAMA14    WUMA14           March 14
     C                     MOVELWAMA15    WUMA15           March 15
     C                     MOVELWAMA16    WUMA16           March 16
     C                     MOVELWAMA17    WUMA17           March 17
     C                     MOVELWAMA18    WUMA18           March 18
     C                     MOVELWAMA19    WUMA19           March 19
     C                     MOVELWAMA20    WUMA20           March 20
     C                     MOVELWAMA21    WUMA21           March 21
     C                     MOVELWAMA22    WUMA22           March 22
     C                     MOVELWAMA23    WUMA23           March 23
     C                     MOVELWAMA24    WUMA24           March 24
     C                     MOVELWAMA25    WUMA25           March 25
     C                     MOVELWAMA26    WUMA26           March 26
     C                     MOVELWAMA27    WUMA27           March 27
     C                     MOVELWAMA28    WUMA28           March 28
     C                     MOVELWAMA29    WUMA29           March 29
     C                     MOVELWAMA30    WUMA30           March 30
     C                     MOVELWAMA31    WUMA31           March 31
      *                                                                                       CSD031
     C           CSD041    IFEQ 'Y'                                                           CSD031
     C           *INU1     IFEQ *OFF                                                          CSD031
      *                                                                                       CSD031
     C           PMODE     IFEQ 'A'                                                           CSD031
     C           KRSSA     READESDAHDYD8                 90                                   CSD031
     C                     ELSE                                                               CSD031
     C           KRSSA     READE@HOLPH8                  90                                   CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
     C           KRSSA     READEGPHOLID2                 90                                   CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
     C           KRSSA     READE@HOLPH8                  90*
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     END
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Get 'Window required' ind - MIDAS Modules  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define Keylist.
     C           KRSSB     KLIST
     C                     KFLD           BGMODS           Modules
      * Move fields to key list.
     C                     MOVEL@CN,11    BGMODS           Modules
     C           KRSSB     CHAIN@BGREC8              90    *
      * DBF Record not found.
     C   90                MOVEL'USR0096' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process DBF record
      *CASE:     DB1.Window processing requir. is Yes
     C           BGWDPR    IFEQ @CN,01                     *IF
     C                     MOVEL@CN,01    WUWDPR           Window processi
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Select existing record.
      *================================================================
      * Name search required ?
     C                     MOVEL#1CYCD    WK1X01  1        Currency Code
     C                     MOVEL#1LCCD    WK1X02  1        Location Code
     C                     MOVEL#1YRNB    WK1X03  1        Year Number
     C           WK1X01    IFEQ '?'                        Currency Code
     C           WK1X02    OREQ '?'                        Location Code
     C           WK1X03    OREQ '?'                        Year Number
     C                     CALL 'SD0160S'              90  *
     C                     PARM           W0RTN   7        Return code
     C           #1CYCD    PARM #1CYCD    WQ0001  3        Currency Code
     C           #1LCCD    PARM #1LCCD    WQ0002  3        Location Code
     C           #1YRNB    PARM #1YRNB    WQ0003  4        Year Number
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
     C                     MOVEL'Y'       W0DCF   1        Defer confirm
     C                     END
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to Currency Codes.
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required ?
     C                     MOVEL#1CYCD    WK1X01  1        Currency Code
     C           WK1X01    IFEQ '?'                        Currency Code
     C                     CALL 'SD0020S'              90  *
     C                     PARM           W0RTN   7        Return code
     C           #1CYCD    PARM #1CYCD    WQ0004  3        Currency Code
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
     C                     MOVEL'Y'       W0DCF   1        Defer confirm
      * No value selected exit.
     C           W0RTN     CABNE*BLANK    VBEXIT
     C                     END
      *................................................................
      * If all low order keys not entered, exit.
     C           #1CYCD    IFEQ *BLANK                     Currency Code
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBA6    KLIST
     C                     KFLD           A6CYCD           Currency Code
      * Setup key.
     C                     MOVEL#1CYCD    A6CYCD           Currency Code
     C           KLVBA6    CHAIN@A6REA3              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals.
     C                     GOTO VBEXIT
     C                     END
      * Send message 'Currency Codes         NF'
     C                     MOVEL'USR0071' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     MOVEL'USR0071' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Location Codes.
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required ?
     C                     MOVEL#1LCCD    WK1X01  1        Location Code
     C           WK1X01    IFEQ '?'                        Location Code
     C                     CALL 'SD0550S'              90  *
     C                     PARM           W0RTN   7        Return code
     C           #1LCCD    PARM #1LCCD    WQ0005  3        Location Code
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
     C                     MOVEL'Y'       W0DCF   1        Defer confirm
      * No value selected exit.
     C           W0RTN     CABNE*BLANK    VCEXIT
     C                     END
      *................................................................
      * If all low order keys not entered, exit.
     C           #1LCCD    IFEQ *BLANK                     Location Code
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCDV    KLIST
     C                     KFLD           DVLCCD           Location Code
      * Setup key.
     C                     MOVEL#1LCCD    DVLCCD           Location Code
     C           CSD041    IFEQ 'Y'                                                           CSD031
     C           *INU1     ANDEQ*ON                                                           CSD031
     C           KLVCDV    CHAINSDLOCND0             9091                                     CSD031
     C                     ELSE                                                               CSD031
     C           KLVCDV    CHAIN@DVREHH              9091  *
     C                     ENDIF                                                              CSD031
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals.
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Location Codes         NF'
     C                     MOVEL'USR0653' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     MOVEL'USR0653' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue.
      *================================================================
     C           ZAPGM     IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGM
     C                     END
      * If no message file specified use default.
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGM  10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message Id.
     C                     PARM           ZAMSGF 10        Message file.
     C                     PARM           ZAMSDA132        Message data.
     C                     PARM           ZAMSTP  7        Message type.
      * Clear all fields for default mechanism next time.
     C                     MOVEL*BLANK    ZAPGM            Program queue
     C                     MOVEL*BLANK    ZAPGRL           Rel queue
     C                     MOVEL*BLANK    ZAMSID           Message Id.
     C                     MOVEL*BLANK    ZAMSGF           Message file.
     C                     MOVEL*BLANK    ZAMSDA           Message data.
     C                     MOVEL*BLANK    ZAMSTP           Message type.
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text.
      *================================================================
     C                     MOVEL'Y'       W0HLP   1        Signal help req
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Member name.
     C                     PARM *BLANK    YYHPFL 10        *DFT text file.
     C                     PARM *BLANK    YYHPLB 10        Help text lib.
     C                     PARM           W0RTN   7        Return Code.
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel and exit from key screen.
      *================================================================
      * USER: Exit program processing
      *CASE:     WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ @CN,01                     *IF
      * 00/Copy Member SD0161EEPP - Holidays  *
     C*00/Copy Member SD0161E   Exit Program Processing
     C/COPY WNCPYSRC,SD0161EEPP
     C                     END                             *FI
      *CASE:     KEY.*CMD key is *Exit
     C           *IN03     IFEQ '1'                        *IF
     C                     MOVEL@CN,08    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct.
      *================================================================
      * Terminate program.
     C                     SETON                     LR
      *
      * Exit program.
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation.
      *================================================================
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
      * Setup job date/time.
     C                     Z-ADDUDATE     ##JDT            Job date.
     C                     TIME           ##JTM            Job time.
     C                     TIME           ##TME   60       Screen time.
      * Obtain default message file.
     C           *NAMVAR   DEFN Y2MGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field S01212
     C                     MOVEL*BLANK    WUMFTS  1
      * Define work field Day Code
     C                     Z-ADD*ZERO     WUDYCD  10
      * Define work field Leap Year Indicator
     C                     MOVEL*BLANK    WULYRI  1
      * Define work field January 1
     C                     MOVEL*BLANK    WUJA01  1
      * Define work field January 2
     C                     MOVEL*BLANK    WUJA02  1
      * Define work field January 3
     C                     MOVEL*BLANK    WUJA03  1
      * Define work field January 4
     C                     MOVEL*BLANK    WUJA04  1
      * Define work field January 5
     C                     MOVEL*BLANK    WUJA05  1
      * Define work field January 6
     C                     MOVEL*BLANK    WUJA06  1
      * Define work field January 7
     C                     MOVEL*BLANK    WUJA07  1
      * Define work field January 8
     C                     MOVEL*BLANK    WUJA08  1
      * Define work field January 9
     C                     MOVEL*BLANK    WUJA09  1
      * Define work field January 10
     C                     MOVEL*BLANK    WUJA10  1
      * Define work field January 11
     C                     MOVEL*BLANK    WUJA11  1
      * Define work field January 12
     C                     MOVEL*BLANK    WUJA12  1
      * Define work field January 13
     C                     MOVEL*BLANK    WUJA13  1
      * Define work field January 14
     C                     MOVEL*BLANK    WUJA14  1
      * Define work field January 15
     C                     MOVEL*BLANK    WUJA15  1
      * Define work field January 16
     C                     MOVEL*BLANK    WUJA16  1
      * Define work field January 17
     C                     MOVEL*BLANK    WUJA17  1
      * Define work field January 18
     C                     MOVEL*BLANK    WUJA18  1
      * Define work field January 19
     C                     MOVEL*BLANK    WUJA19  1
      * Define work field January 20
     C                     MOVEL*BLANK    WUJA20  1
      * Define work field January 21
     C                     MOVEL*BLANK    WUJA21  1
      * Define work field January 22
     C                     MOVEL*BLANK    WUJA22  1
      * Define work field January 23
     C                     MOVEL*BLANK    WUJA23  1
      * Define work field January 24
     C                     MOVEL*BLANK    WUJA24  1
      * Define work field January 25
     C                     MOVEL*BLANK    WUJA25  1
      * Define work field January 26
     C                     MOVEL*BLANK    WUJA26  1
      * Define work field January 27
     C                     MOVEL*BLANK    WUJA27  1
      * Define work field January 28
     C                     MOVEL*BLANK    WUJA28  1
      * Define work field January 29
     C                     MOVEL*BLANK    WUJA29  1
      * Define work field January 30
     C                     MOVEL*BLANK    WUJA30  1
      * Define work field January 31
     C                     MOVEL*BLANK    WUJA31  1
      * Define work field February 1
     C                     MOVEL*BLANK    WUFE01  1
      * Define work field February 2
     C                     MOVEL*BLANK    WUFE02  1
      * Define work field February 3
     C                     MOVEL*BLANK    WUFE03  1
      * Define work field February 4
     C                     MOVEL*BLANK    WUFE04  1
      * Define work field February 5
     C                     MOVEL*BLANK    WUFE05  1
      * Define work field February 6
     C                     MOVEL*BLANK    WUFE06  1
      * Define work field February 7
     C                     MOVEL*BLANK    WUFE07  1
      * Define work field February 8
     C                     MOVEL*BLANK    WUFE08  1
      * Define work field February 9
     C                     MOVEL*BLANK    WUFE09  1
      * Define work field February 10
     C                     MOVEL*BLANK    WUFE10  1
      * Define work field February 11
     C                     MOVEL*BLANK    WUFE11  1
      * Define work field February 12
     C                     MOVEL*BLANK    WUFE12  1
      * Define work field February 13
     C                     MOVEL*BLANK    WUFE13  1
      * Define work field February 14
     C                     MOVEL*BLANK    WUFE14  1
      * Define work field February 15
     C                     MOVEL*BLANK    WUFE15  1
      * Define work field February 16
     C                     MOVEL*BLANK    WUFE16  1
      * Define work field February 17
     C                     MOVEL*BLANK    WUFE17  1
      * Define work field February 18
     C                     MOVEL*BLANK    WUFE18  1
      * Define work field February 19
     C                     MOVEL*BLANK    WUFE19  1
      * Define work field February 20
     C                     MOVEL*BLANK    WUFE20  1
      * Define work field February 21
     C                     MOVEL*BLANK    WUFE21  1
      * Define work field February 22
     C                     MOVEL*BLANK    WUFE22  1
      * Define work field February 23
     C                     MOVEL*BLANK    WUFE23  1
      * Define work field February 24
     C                     MOVEL*BLANK    WUFE24  1
      * Define work field February 25
     C                     MOVEL*BLANK    WUFE25  1
      * Define work field February 26
     C                     MOVEL*BLANK    WUFE26  1
      * Define work field February 27
     C                     MOVEL*BLANK    WUFE27  1
      * Define work field February 28
     C                     MOVEL*BLANK    WUFE28  1
      * Define work field February 29
     C                     MOVEL*BLANK    WUFE29  1
      * Define work field March 1
     C                     MOVEL*BLANK    WUMA01  1
      * Define work field March 2
     C                     MOVEL*BLANK    WUMA02  1
      * Define work field March 3
     C                     MOVEL*BLANK    WUMA03  1
      * Define work field March 4
     C                     MOVEL*BLANK    WUMA04  1
      * Define work field March 5
     C                     MOVEL*BLANK    WUMA05  1
      * Define work field March 6
     C                     MOVEL*BLANK    WUMA06  1
      * Define work field March 7
     C                     MOVEL*BLANK    WUMA07  1
      * Define work field March 8
     C                     MOVEL*BLANK    WUMA08  1
      * Define work field March 9
     C                     MOVEL*BLANK    WUMA09  1
      * Define work field March 10
     C                     MOVEL*BLANK    WUMA10  1
      * Define work field March 11
     C                     MOVEL*BLANK    WUMA11  1
      * Define work field March 12
     C                     MOVEL*BLANK    WUMA12  1
      * Define work field March 13
     C                     MOVEL*BLANK    WUMA13  1
      * Define work field March 14
     C                     MOVEL*BLANK    WUMA14  1
      * Define work field March 15
     C                     MOVEL*BLANK    WUMA15  1
      * Define work field March 16
     C                     MOVEL*BLANK    WUMA16  1
      * Define work field March 17
     C                     MOVEL*BLANK    WUMA17  1
      * Define work field March 18
     C                     MOVEL*BLANK    WUMA18  1
      * Define work field March 19
     C                     MOVEL*BLANK    WUMA19  1
      * Define work field March 20
     C                     MOVEL*BLANK    WUMA20  1
      * Define work field March 21
     C                     MOVEL*BLANK    WUMA21  1
      * Define work field March 22
     C                     MOVEL*BLANK    WUMA22  1
      * Define work field March 23
     C                     MOVEL*BLANK    WUMA23  1
      * Define work field March 24
     C                     MOVEL*BLANK    WUMA24  1
      * Define work field March 25
     C                     MOVEL*BLANK    WUMA25  1
      * Define work field March 26
     C                     MOVEL*BLANK    WUMA26  1
      * Define work field March 27
     C                     MOVEL*BLANK    WUMA27  1
      * Define work field March 28
     C                     MOVEL*BLANK    WUMA28  1
      * Define work field March 29
     C                     MOVEL*BLANK    WUMA29  1
      * Define work field March 30
     C                     MOVEL*BLANK    WUMA30  1
      * Define work field March 31
     C                     MOVEL*BLANK    WUMA31  1
      * Define work field Window processing requir.
     C                     MOVEL*BLANK    WUWDPR  1
      * Define work field Midas Run Date
     C                     MOVEL*BLANK    WUMRDT  7
      * Define work field Run day number
     C                     Z-ADD*ZERO     WURDNB  50
      * Define work field Set Up Complete
     C                     MOVEL*BLANK    WUSUC   1
      * Define work field Date format flag
     C                     MOVEL*BLANK    WUDFF   1
      * Define work field Multi-branching Indicator
     C                     MOVEL*BLANK    WUMBIN  1
      * Define work field Year - Numeric Field
     C                     Z-ADD*ZERO     WUYRNF  40
      * USER: Initialise program
      * Standard RPG Creation PAR - Standard Functions  *
      * Last Amend Box SD0161E - Holidays  *
      * Copyright Statement - Standard Functions  *
      * Get Rundate - Rundate  *
     C           *NAMVAR   DEFN           RUNDAT
     C                     IN   RUNDAT
     C                     MOVE MRDT      ##MRDT           RUN DATE
     C                     MOVE MRDT      WUMRDT
     C                     MOVE RDNB      WURDNB           RUNDAY NO.
     C                     MOVE SUC       WUSUC            SET UP COMPLT
     C                     MOVE DFF       WUDFF            DTE FMT FLAG
     C                     MOVE MBIN      WUMBIN           MULTI BR. IND
     C                     MOVE P1YRNB    WUYRNF           Year - Numeric
      * Calc. Day for 1JANxxxx - Holidays  *
     C                     MOVE WUYRNF    UYR     20
     C           UYR       MULT 1.25      UYRTOT  30
     C                     ADD  1         UYRTOT
     C* CALCULATE WHETHER IT IS A LEAP YEAR
     C           UYR       IFLT 72
     C           100       ADD  UYR       UYRLP   30
     C                     ADD  6         UYRTOT
     C                     ELSE
     C                     ADD  UYR       UYRLP
     C                     END
     C           UYRLP     DIV  4         UYRDIV  30
     C                     MVR            URMD    10
     C** IF REMAINDER IS ZERO THEN IT IS A LEAP YEAR
     C           URMD      IFEQ 0
     C                     MOVE 'Y'       WULYRI
     C                     ELSE
     C                     MOVE 'N'       WULYRI
     C                     ADD  1         UYRTOT
     C                     END
     C** DIVIDE BY SEVEN REMAINDER GIVES THE DAY
     C** 1 - SUNDAY
     C** 2 - MONDAY
     C** 3 - TUESDAY
     C** 4 - WEDNESDAY
     C** 5 - THURSDAY
     C** 6 - FRIDAY
     C** 7 - SATURDAY
     C           UYRTOT    DIV  7         UYRTOT
     C                     MVR            WUDYCD
     C                     MOVEL@CN,01    WUMFTS           S01212
      *CASE:     WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ @CN,01                     *IF
      * Get 'Window required' ind - MIDAS Modules  *
     C                     EXSR SBRVGN
      * DATA DS for Holidays - Holidays  *
      * 00/Copy Member SD0161EFPG - Holidays  *
      * 00/Copy Member SD0161EEPG - Holidays  *
      * 00/Copy Member SD0161EIPG - Holidays  *
      * 00/Copy Member SD0161ECPG - Holidays  *
     C*00/Copy Member SD0161E   Initialise Program C-Spec
     C/COPY WNCPYSRC,SD0161ECPG
      * 00/Copy Member SD0161EOPG - Holidays  *
     C                     END                             *FI
      *                                                                                       CSD031
      ** Check if CSD041 is switched on                                                       CSD031
      *                                                                                       CSD031
     C                     MOVE 'N'       CSD041  1                                           CSD031
     C                     CALL 'AOSARDR0'                                                    CSD031
     C                     PARM *BLANKS   PRTCD   7                                           CSD031
     C                     PARM '*VERIFY' POPTN   7                                           CSD031
     C                     PARM 'CSD041'  PSARD   6                                           CSD031
     C           DSSARD    PARM *BLANKS   DSFDY                                               CSD031
      *                                                                                       CSD031
     C           PRTCD     IFEQ *BLANKS                                                       CSD031
     C                     MOVE 'Y'       CSD041                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      *================================================================
     CSR         ZZEXIT    ENDSR
     O*00/Copy Member SD0161E   Initialise Program O-Spec
     O/COPY WNCPYSRC,SD0161EOPG
** JAN
 1 2 3 4 5 6 7 8 910111213141516171819202122232425262728293031
** FEB1
 1 2 3 4 5 6 7 8 910111213141516171819202122232425262728
** FEB2
 1 2 3 4 5 6 7 8 91011121314151617181920212223242526272829
** MAR
 1 2 3 4 5 6 7 8 910111213141516171819202122232425262728293031
** CPY@     : Copyright notice for inclusion in all programs
(c) Misys International Banking Systems Ltd. 2001
** @CN Long constants used in program.
Y
***
Y2U0005
Y2U0003
S
USR0790
E
Y2U9999
USR0563
Y2U0004
MMOD
