     H        1   Y
      *****************************************************************
/*OVR *  OVRDBF FILE(GZSDBANK) TOFILE(GZSDBANKL2)                     *                       CSD031
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas SD Edit a Years holidays Q1')                    *
      *****************************************************************
      *                                                               *
      *  Midas - Standing Data Module                                 *
      *                                                               *
      *  SD0161R - Maintain holidays 1                                *
      *                                                               *
      *  Function:  This program maintains the holidays for the       *
      *             first quarter of the year.                        *
      *                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Note: Core amendments to this program must be applied        *
      *        via the core synon model.                              *
      *                                                               *
      *  Note: Synon programmers - DTAARA/YINDPTYSYA in Y2SY must     *
      *        be set to a value of *ATRIND for generation and        *
      *        reset to *ERRIND when generation is complete.          *
      *                                                               *
      *  Last Amend No. MD037087           Date 06Jun20
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 CTI006             Date 31Mar14               *
      *                 MD021992           Date 23Aug13               *
      *                 CER059             Date 19Jul10               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 BUG13704           Date 03May07               *
      *                 BG12014            Date 05Dec06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CAAA03             Date 28Mar04               *
      *                 CGL029             Date 01Sep03               *
      *                 CSD012             Date 15Oct02               *
      * Midas Release 4.01.02 ----------------------------------------*
      *                 203681             Date 14May02               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 165382             Date 31Mar01               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 094290             Date 09Oct95               *
      *                 084942             Date 17Jun95               *
      *                 063310             DATE 17FEB94               *
      *                 S01459             DATE 14JAN94               *
      *                 LN0662             DATE 24JAN91               *
      *                 S01212             DATE 14SEP89               *
      *                                                               *
      *****************************************************************
      *                                                               *
      *  MD037087 - Holidays cannot be changed when previous day      *
      *           - Applied for MD055478                              *
      *  MD046248 - Finastra Rebranding                               *
      *  CTI006 - Trade Finance BF Midas 2.2 Interface                *
      *  MD021992 - It is possible to amend previous date in Calendar *
      *             (Recompile)                                       *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (Recompile)                                         *
      *  BUG13704 - The trigger program to update the Equation        *
      *             holiday table from the Midas Holiday              *
      *             Maintenance does not appear to work.              *
      *  BG12014 - Holiday updates are not replicated into equation.  *
      *  CSD031 - Enhanced Centralised Static data                    *
      *  CAAA03 - Webfacing Changes (recompile).                      *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CSD012 - Standing Data Authorisation.                        *
      *  203681 - Recompiled due to changes in SDHOLVLD2.             *
      *  165382 - Fixed to check if a holiday was changed to a working*
      *           date which falls between the run date and the next  *
      *           working date.  Applied fix 132649.                  *
      *  094290 - All fields appear on the screen because the         *
      *           function ran out of indicators.                     *
      *         - Amended records not being saved to the database.    *
      *  084942 - Date format is not checked                          *
      *  063310 - Do not allow the user to change today or the next   *
      *           working day to a holiday.                           *
      *  S01459 - Addition of headerbox and PSSR processing.          *
      *  LN0662 - REGENERATE DUE TO CHANGE IN SDCURRPD                *
      *  S01212 - /COPIES                                             *
      *                                                               *
      *****************************************************************
     F*00/Copy Member SD0161R   Initialise Program F-spec
     F/COPY WNCPYSRC,SD0161RFPG
     FSD0161R#CF  E                    WORKSTN                        UC
     F                                              KINFDS INFDS#
     F                                              KINFSR *PSSR
      * DSP: Midas SD Holiday maintenance January to March
      *
     FSDHOLL8 IF  E           K        DISK                           UC
     F                                              KINFDS INFDS1
     F                                              KINFSR *PSSR
      * RSQ : Holidays                  test access path
      *
     FSDHOLL4 IF  E           K        DISK                           UC
     F                                              KINFDS ID0001
     F                                              KINFSR *PSSR
      * RSQ : Holidays                  1st Quarter
      *
     FSDCURRL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0002
     F                                              KINFSR *PSSR
      * RTV : Midas SD Currency codes retrieval
      *
     FSDLOCNL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0003
     F                                              KINFSR *PSSR
      * RTV : Location Codes            Retrieval index
      *
     FSDBANKL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0004
     F                                              KINFSR *PSSR
      * RTV : Midas SD Bank details ICD retrieval
      *
     FSDMMODL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0005
     F                                              KINFSR *PSSR
      * RTV : Midas SD Midas module flags retrieval
      *
     FSDHOLL0 UF  E           K        DISK                      A    UC
     F                                              KCOMIT
     F                                              KINFDS ID0006
     F                                              KINFSR *PSSR
      * UPD : Holidays                  Update index
      *
     FSDFCTLL0UF  E           K        DISK                           UC
     F                                              KCOMIT
     F                                              KINFDS ID0007
     F                                              KINFSR *PSSR
      * UPD : Midas SD Standing data controls update
      *                                                                                       CSD012
     FGPLOCNL1IF  E           K        DISK                           UC                      CSD012
     F                                              KINFSR *PSSR                              CSD012
      ** RTV : Location Codes            Retrieval index                                      CSD012
      *                                                                                       CSD012
     FSDHOSHL0UF  E           K        DISK                      A    UC                      CSD012
     F                                              KCOMIT                                    CSD012
      * UPD : Holidays Shadow file                                                            CSD012
      *                                                                                       CSD012
     FSDAULGL1UF  E           K        DISK                      A                            CSD012
     F                                              KCOMIT                                    CSD012
      * UPD : Authorisation Log - by Key                                                      CSD012
      *                                                                                       CSD031
      ** Central Holidays Logical File                                                        CSD031
     FGPHOLIL0UF  E           K        DISK                      A    UC                      CSD031
     F                                              KCOMIT                                    CSD031
     F                                              KINFSR *PSSR                              CSD031
      *                                                                                       CSD031
      ** Central Holidays Logical File                                                        CSD031
     FGPHOLIL1IF  E           K        DISK                           UC                      CSD031
     F                                              KINFSR *PSSR                              CSD031
     F            GPHOLID0                          KRENAMEGPHOLID1                           CSD031
      *                                                                                       CSD031
      ** Central Holidays Logical File                                                        CSD031
     FGPHOLIL2IF  E           K        DISK                           UC                      CSD031
     F                                              KINFSR *PSSR                              CSD031
     F            GPHOLID0                          KRENAMEGPHOLID2                           CSD031
      *                                                                                       CSD031
      ** Holidays Acceptance Logical File                                                     CSD031
     FSDAHDYL1IF  E           K        DISK                           UC                      CSD031
     F                                              KINFSR *PSSR                              CSD031
     F            SDAHDYD0                          KRENAMESDAHDYD1                           CSD031
      *                                                                                       CSD031
      ** Holidays Acceptance Logical File                                                     CSD031
     FSDAHDYL8IF  E           K        DISK                           UC                      CSD031
     F                                              KINFSR *PSSR                              CSD031
     F            SDAHDYD0                          KRENAMESDAHDYD8                           CSD031
      *                                                                                       CSD031
      ** Midas GZ Bank Details ICD (Override to GZSDBANKL2)                                   CSD031
     FGZSDBANKIF  E                    DISK                           UC                      CSD031
     F                                              KINFSR *PSSR                              CSD031
     F            SDBANKD0                          KRENAMEGZBANKD0                           CSD031
      *                                                                                      BG12014
      * RTV : MIDAS SD Branch codes retrieval for location codes                             BG12014
     FSDBRCL10IF  E           K        DISK                                                  BG12014
      * Logical file for retriEving location in a branch                                     BG12014
      *                                                                                      BG12014
     FTGZSDBL1IF  E           K        DISK                                                  BG12014
     F            T_GZSDBRCB                        KRENAMEGZSDBR                            BG12014
      *
     E                    JAN    31  31  2
     E                    FEB1   28  28  2
     E                    FEB2   29  29  2
     E                    MAR    31  31  2
     E                    TEMP       37  2
     E                    JANA       37  1                                063310
     E                    FEBA       37  1                                063310
     E                    MARA       37  1                                063310
     E                    JAST       37  1
     E                    FEST       37  1
     E                    MAST       37  1
     E                    AENA    1   3 78
     E*
     E*  DETAIL LINE COMMAND KEY TEXT
     E*
     E* Description     : Copyright notice for inclusion in all programs
     E*
     E********************************************************************
     E                    CPY@    1   1 80               Copyright
     E                    OVRD    1   1 80                                                    CSD031
     E*00/Copy Member SD0161R   Initialise Program E-spec
     E/COPY WNCPYSRC,SD0161REPG
     I@HOLPH8
      * Holidays                  1st Quarter
      * Renamed input format fields
     I              DGCYCD                          WACYCD
     I              DGLCCD                          WALCCD
     I              DGYRNB                          WAYRNB
     I              DGJDNB                          WAJDNB
     I              DGDDNB                          WADDNB
     I              DGJA01                          WAJA01
     I              DGJA02                          WAJA02
     I              DGJA03                          WAJA03
     I              DGJA04                          WAJA04
     I              DGJA05                          WAJA05
     I              DGJA06                          WAJA06
     I              DGJA07                          WAJA07
     I              DGJA08                          WAJA08
     I              DGJA09                          WAJA09
     I              DGJA10                          WAJA10
     I              DGJA11                          WAJA11
     I              DGJA12                          WAJA12
     I              DGJA13                          WAJA13
     I              DGJA14                          WAJA14
     I              DGJA15                          WAJA15
     I              DGJA16                          WAJA16
     I              DGJA17                          WAJA17
     I              DGJA18                          WAJA18
     I              DGJA19                          WAJA19
     I              DGJA20                          WAJA20
     I              DGJA21                          WAJA21
     I              DGJA22                          WAJA22
     I              DGJA23                          WAJA23
     I              DGJA24                          WAJA24
     I              DGJA25                          WAJA25
     I              DGJA26                          WAJA26
     I              DGJA27                          WAJA27
     I              DGJA28                          WAJA28
     I              DGJA29                          WAJA29
     I              DGJA30                          WAJA30
     I              DGJA31                          WAJA31
     I              DGFE01                          WAFE01
     I              DGFE02                          WAFE02
     I              DGFE03                          WAFE03
     I              DGFE04                          WAFE04
     I              DGFE05                          WAFE05
     I              DGFE06                          WAFE06
     I              DGFE07                          WAFE07
     I              DGFE08                          WAFE08
     I              DGFE09                          WAFE09
     I              DGFE10                          WAFE10
     I              DGFE11                          WAFE11
     I              DGFE12                          WAFE12
     I              DGFE13                          WAFE13
     I              DGFE14                          WAFE14
     I              DGFE15                          WAFE15
     I              DGFE16                          WAFE16
     I              DGFE17                          WAFE17
     I              DGFE18                          WAFE18
     I              DGFE19                          WAFE19
     I              DGFE20                          WAFE20
     I              DGFE21                          WAFE21
     I              DGFE22                          WAFE22
     I              DGFE23                          WAFE23
     I              DGFE24                          WAFE24
     I              DGFE25                          WAFE25
     I              DGFE26                          WAFE26
     I              DGFE27                          WAFE27
     I              DGFE28                          WAFE28
     I              DGFE29                          WAFE29
     I              DGMA01                          WAMA01
     I              DGMA02                          WAMA02
     I              DGMA03                          WAMA03
     I              DGMA04                          WAMA04
     I              DGMA05                          WAMA05
     I              DGMA06                          WAMA06
     I              DGMA07                          WAMA07
     I              DGMA08                          WAMA08
     I              DGMA09                          WAMA09
     I              DGMA10                          WAMA10
     I              DGMA11                          WAMA11
     I              DGMA12                          WAMA12
     I              DGMA13                          WAMA13
     I              DGMA14                          WAMA14
     I              DGMA15                          WAMA15
     I              DGMA16                          WAMA16
     I              DGMA17                          WAMA17
     I              DGMA18                          WAMA18
     I              DGMA19                          WAMA19
     I              DGMA20                          WAMA20
     I              DGMA21                          WAMA21
     I              DGMA22                          WAMA22
     I              DGMA23                          WAMA23
     I              DGMA24                          WAMA24
     I              DGMA25                          WAMA25
     I              DGMA26                          WAMA26
     I              DGMA27                          WAMA27
     I              DGMA28                          WAMA28
     I              DGMA29                          WAMA29
     I              DGMA30                          WAMA30
     I              DGMA31                          WAMA31
     I              DGLCD                           WALCD
     I              DGTYLC                          WATYLC
      *
      ** Rename Fields                                                                        CSD031
     IGPHOLID2                                                                                CSD031
      * Holidays (Global)         1st Quarter                                                 CSD031
      * Renamed input format fields                                                           CSD031
     I              DGCYCD                          WACYCD                                    CSD031
     I              DGLCCD                          WALCCD                                    CSD031
     I              DGYRNB                          WAYRNB                                    CSD031
     I              DGJDNB                          WAJDNB                                    CSD031
     I              DGDDNB                          WADDNB                                    CSD031
     I              DGJA01                          WAJA01                                    CSD031
     I              DGJA02                          WAJA02                                    CSD031
     I              DGJA03                          WAJA03                                    CSD031
     I              DGJA04                          WAJA04                                    CSD031
     I              DGJA05                          WAJA05                                    CSD031
     I              DGJA06                          WAJA06                                    CSD031
     I              DGJA07                          WAJA07                                    CSD031
     I              DGJA08                          WAJA08                                    CSD031
     I              DGJA09                          WAJA09                                    CSD031
     I              DGJA10                          WAJA10                                    CSD031
     I              DGJA11                          WAJA11                                    CSD031
     I              DGJA12                          WAJA12                                    CSD031
     I              DGJA13                          WAJA13                                    CSD031
     I              DGJA14                          WAJA14                                    CSD031
     I              DGJA15                          WAJA15                                    CSD031
     I              DGJA16                          WAJA16                                    CSD031
     I              DGJA17                          WAJA17                                    CSD031
     I              DGJA18                          WAJA18                                    CSD031
     I              DGJA19                          WAJA19                                    CSD031
     I              DGJA20                          WAJA20                                    CSD031
     I              DGJA21                          WAJA21                                    CSD031
     I              DGJA22                          WAJA22                                    CSD031
     I              DGJA23                          WAJA23                                    CSD031
     I              DGJA24                          WAJA24                                    CSD031
     I              DGJA25                          WAJA25                                    CSD031
     I              DGJA26                          WAJA26                                    CSD031
     I              DGJA27                          WAJA27                                    CSD031
     I              DGJA28                          WAJA28                                    CSD031
     I              DGJA29                          WAJA29                                    CSD031
     I              DGJA30                          WAJA30                                    CSD031
     I              DGJA31                          WAJA31                                    CSD031
     I              DGFE01                          WAFE01                                    CSD031
     I              DGFE02                          WAFE02                                    CSD031
     I              DGFE03                          WAFE03                                    CSD031
     I              DGFE04                          WAFE04                                    CSD031
     I              DGFE05                          WAFE05                                    CSD031
     I              DGFE06                          WAFE06                                    CSD031
     I              DGFE07                          WAFE07                                    CSD031
     I              DGFE08                          WAFE08                                    CSD031
     I              DGFE09                          WAFE09                                    CSD031
     I              DGFE10                          WAFE10                                    CSD031
     I              DGFE11                          WAFE11                                    CSD031
     I              DGFE12                          WAFE12                                    CSD031
     I              DGFE13                          WAFE13                                    CSD031
     I              DGFE14                          WAFE14                                    CSD031
     I              DGFE15                          WAFE15                                    CSD031
     I              DGFE16                          WAFE16                                    CSD031
     I              DGFE17                          WAFE17                                    CSD031
     I              DGFE18                          WAFE18                                    CSD031
     I              DGFE19                          WAFE19                                    CSD031
     I              DGFE20                          WAFE20                                    CSD031
     I              DGFE21                          WAFE21                                    CSD031
     I              DGFE22                          WAFE22                                    CSD031
     I              DGFE23                          WAFE23                                    CSD031
     I              DGFE24                          WAFE24                                    CSD031
     I              DGFE25                          WAFE25                                    CSD031
     I              DGFE26                          WAFE26                                    CSD031
     I              DGFE27                          WAFE27                                    CSD031
     I              DGFE28                          WAFE28                                    CSD031
     I              DGFE29                          WAFE29                                    CSD031
     I              DGMA01                          WAMA01                                    CSD031
     I              DGMA02                          WAMA02                                    CSD031
     I              DGMA03                          WAMA03                                    CSD031
     I              DGMA04                          WAMA04                                    CSD031
     I              DGMA05                          WAMA05                                    CSD031
     I              DGMA06                          WAMA06                                    CSD031
     I              DGMA07                          WAMA07                                    CSD031
     I              DGMA08                          WAMA08                                    CSD031
     I              DGMA09                          WAMA09                                    CSD031
     I              DGMA10                          WAMA10                                    CSD031
     I              DGMA11                          WAMA11                                    CSD031
     I              DGMA12                          WAMA12                                    CSD031
     I              DGMA13                          WAMA13                                    CSD031
     I              DGMA14                          WAMA14                                    CSD031
     I              DGMA15                          WAMA15                                    CSD031
     I              DGMA16                          WAMA16                                    CSD031
     I              DGMA17                          WAMA17                                    CSD031
     I              DGMA18                          WAMA18                                    CSD031
     I              DGMA19                          WAMA19                                    CSD031
     I              DGMA20                          WAMA20                                    CSD031
     I              DGMA21                          WAMA21                                    CSD031
     I              DGMA22                          WAMA22                                    CSD031
     I              DGMA23                          WAMA23                                    CSD031
     I              DGMA24                          WAMA24                                    CSD031
     I              DGMA25                          WAMA25                                    CSD031
     I              DGMA26                          WAMA26                                    CSD031
     I              DGMA27                          WAMA27                                    CSD031
     I              DGMA28                          WAMA28                                    CSD031
     I              DGMA29                          WAMA29                                    CSD031
     I              DGMA30                          WAMA30                                    CSD031
     I              DGMA31                          WAMA31                                    CSD031
     I              DGLCD                           WALCD                                     CSD031
     I              DGTYLC                          WATYLC                                    CSD031
      *                                                                                       CSD031
      ** Rename Fields                                                                        CSD031
     ISDAHDYD8                                                                                CSD031
      * Holidays (Zonal / Accept) 1st Quarter                                                 CSD031
      * Renamed input format fields                                                           CSD031
     I              DGCYCD                          WACYCD                                    CSD031
     I              DGLCCD                          WALCCD                                    CSD031
     I              DGYRNB                          WAYRNB                                    CSD031
     I              DGJDNB                          WAJDNB                                    CSD031
     I              DGDDNB                          WADDNB                                    CSD031
     I              DGJA01                          WAJA01                                    CSD031
     I              DGJA02                          WAJA02                                    CSD031
     I              DGJA03                          WAJA03                                    CSD031
     I              DGJA04                          WAJA04                                    CSD031
     I              DGJA05                          WAJA05                                    CSD031
     I              DGJA06                          WAJA06                                    CSD031
     I              DGJA07                          WAJA07                                    CSD031
     I              DGJA08                          WAJA08                                    CSD031
     I              DGJA09                          WAJA09                                    CSD031
     I              DGJA10                          WAJA10                                    CSD031
     I              DGJA11                          WAJA11                                    CSD031
     I              DGJA12                          WAJA12                                    CSD031
     I              DGJA13                          WAJA13                                    CSD031
     I              DGJA14                          WAJA14                                    CSD031
     I              DGJA15                          WAJA15                                    CSD031
     I              DGJA16                          WAJA16                                    CSD031
     I              DGJA17                          WAJA17                                    CSD031
     I              DGJA18                          WAJA18                                    CSD031
     I              DGJA19                          WAJA19                                    CSD031
     I              DGJA20                          WAJA20                                    CSD031
     I              DGJA21                          WAJA21                                    CSD031
     I              DGJA22                          WAJA22                                    CSD031
     I              DGJA23                          WAJA23                                    CSD031
     I              DGJA24                          WAJA24                                    CSD031
     I              DGJA25                          WAJA25                                    CSD031
     I              DGJA26                          WAJA26                                    CSD031
     I              DGJA27                          WAJA27                                    CSD031
     I              DGJA28                          WAJA28                                    CSD031
     I              DGJA29                          WAJA29                                    CSD031
     I              DGJA30                          WAJA30                                    CSD031
     I              DGJA31                          WAJA31                                    CSD031
     I              DGFE01                          WAFE01                                    CSD031
     I              DGFE02                          WAFE02                                    CSD031
     I              DGFE03                          WAFE03                                    CSD031
     I              DGFE04                          WAFE04                                    CSD031
     I              DGFE05                          WAFE05                                    CSD031
     I              DGFE06                          WAFE06                                    CSD031
     I              DGFE07                          WAFE07                                    CSD031
     I              DGFE08                          WAFE08                                    CSD031
     I              DGFE09                          WAFE09                                    CSD031
     I              DGFE10                          WAFE10                                    CSD031
     I              DGFE11                          WAFE11                                    CSD031
     I              DGFE12                          WAFE12                                    CSD031
     I              DGFE13                          WAFE13                                    CSD031
     I              DGFE14                          WAFE14                                    CSD031
     I              DGFE15                          WAFE15                                    CSD031
     I              DGFE16                          WAFE16                                    CSD031
     I              DGFE17                          WAFE17                                    CSD031
     I              DGFE18                          WAFE18                                    CSD031
     I              DGFE19                          WAFE19                                    CSD031
     I              DGFE20                          WAFE20                                    CSD031
     I              DGFE21                          WAFE21                                    CSD031
     I              DGFE22                          WAFE22                                    CSD031
     I              DGFE23                          WAFE23                                    CSD031
     I              DGFE24                          WAFE24                                    CSD031
     I              DGFE25                          WAFE25                                    CSD031
     I              DGFE26                          WAFE26                                    CSD031
     I              DGFE27                          WAFE27                                    CSD031
     I              DGFE28                          WAFE28                                    CSD031
     I              DGFE29                          WAFE29                                    CSD031
     I              DGMA01                          WAMA01                                    CSD031
     I              DGMA02                          WAMA02                                    CSD031
     I              DGMA03                          WAMA03                                    CSD031
     I              DGMA04                          WAMA04                                    CSD031
     I              DGMA05                          WAMA05                                    CSD031
     I              DGMA06                          WAMA06                                    CSD031
     I              DGMA07                          WAMA07                                    CSD031
     I              DGMA08                          WAMA08                                    CSD031
     I              DGMA09                          WAMA09                                    CSD031
     I              DGMA10                          WAMA10                                    CSD031
     I              DGMA11                          WAMA11                                    CSD031
     I              DGMA12                          WAMA12                                    CSD031
     I              DGMA13                          WAMA13                                    CSD031
     I              DGMA14                          WAMA14                                    CSD031
     I              DGMA15                          WAMA15                                    CSD031
     I              DGMA16                          WAMA16                                    CSD031
     I              DGMA17                          WAMA17                                    CSD031
     I              DGMA18                          WAMA18                                    CSD031
     I              DGMA19                          WAMA19                                    CSD031
     I              DGMA20                          WAMA20                                    CSD031
     I              DGMA21                          WAMA21                                    CSD031
     I              DGMA22                          WAMA22                                    CSD031
     I              DGMA23                          WAMA23                                    CSD031
     I              DGMA24                          WAMA24                                    CSD031
     I              DGMA25                          WAMA25                                    CSD031
     I              DGMA26                          WAMA26                                    CSD031
     I              DGMA27                          WAMA27                                    CSD031
     I              DGMA28                          WAMA28                                    CSD031
     I              DGMA29                          WAMA29                                    CSD031
     I              DGMA30                          WAMA30                                    CSD031
     I              DGMA31                          WAMA31                                    CSD031
     I              DGLCD                           WALCD                                     CSD031
     I              DGTYLC                          WATYLC                                    CSD031
      *                                                                                       CSD031
      ** Rename Fields for GZSDBANKL2                                                         CSD031
     IGZBANKD0                                                                                CSD031
     I              BJDFIN                          GZDFIN                                    CSD031
      *                                                                                       CSD031
      * FILE STRUCTURE RENAME FOR SQL TABLE
     IGZSDBR                                                                                 BG12014
     I              A8BRCD                          A8BRCD                                   BG12014
     I              A8MNBR                          A8MNBR                                   BG12014
     I              A8BRTY                          A8BRTY                                   BG12014
     I              A8BRNM                          A8BRNM                                   BG12014
     I              A8BRTN                          A8BRTN                                   BG12014
     I              A8BRZN                          A8BRZN                                   BG12014
     I              A8LCCD                          A8LCCD                                   BG12014
     I              A8STCD                          A8STC                                    BG12014
     I              A8BSWT                          A8BSWT                                   BG12014
     I              A8BNCB                          A8BNCB                                   BG12014
     I*
     I* Description     : Copyright notice for inclusion in all programs
     I*
     I/COPY QWINDSRC,SD0160GDTA
     I*00/Copy Member SD0161R   Initialise Program I-spec
     I/COPY WNCPYSRC,SD0161RIPG
      /EJECT
      * Data structures:
      *                                                                                       CSD012
     ILDA       E DSLDA                         256                                           CSD012
     I              SPARE                           SPAREX                                    CSD012
      ** Local data area for database error details                                           CSD012
      *                                                                                       CSD012
     IPGMDS     ESDSY2PGDSP
      * Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     I@1DBRC    E DSSDHOLL0
      * UPD : Holidays                  Update index
      * Current/previous master file format fields for change control
      * Rename all fields not in retrieval path
     I              DGJDNB                          WZ0001
     I              DGDDNB                          WZ0002
     I              DGJA01                          WZ0003
     I              DGJA02                          WZ0004
     I              DGJA03                          WZ0005
     I              DGJA04                          WZ0006
     I              DGJA05                          WZ0007
     I              DGJA06                          WZ0008
     I              DGJA07                          WZ0009
     I              DGJA08                          WZ0010
     I              DGJA09                          WZ0011
     I              DGJA10                          WZ0012
     I              DGJA11                          WZ0013
     I              DGJA12                          WZ0014
     I              DGJA13                          WZ0015
     I              DGJA14                          WZ0016
     I              DGJA15                          WZ0017
     I              DGJA16                          WZ0018
     I              DGJA17                          WZ0019
     I              DGJA18                          WZ0020
     I              DGJA19                          WZ0021
     I              DGJA20                          WZ0022
     I              DGJA21                          WZ0023
     I              DGJA22                          WZ0024
     I              DGJA23                          WZ0025
     I              DGJA24                          WZ0026
     I              DGJA25                          WZ0027
     I              DGJA26                          WZ0028
     I              DGJA27                          WZ0029
     I              DGJA28                          WZ0030
     I              DGJA29                          WZ0031
     I              DGJA30                          WZ0032
     I              DGJA31                          WZ0033
     I              DGFE01                          WZ0034
     I              DGFE02                          WZ0035
     I              DGFE03                          WZ0036
     I              DGFE04                          WZ0037
     I              DGFE05                          WZ0038
     I              DGFE06                          WZ0039
     I              DGFE07                          WZ0040
     I              DGFE08                          WZ0041
     I              DGFE09                          WZ0042
     I              DGFE10                          WZ0043
     I              DGFE11                          WZ0044
     I              DGFE12                          WZ0045
     I              DGFE13                          WZ0046
     I              DGFE14                          WZ0047
     I              DGFE15                          WZ0048
     I              DGFE16                          WZ0049
     I              DGFE17                          WZ0050
     I              DGFE18                          WZ0051
     I              DGFE19                          WZ0052
     I              DGFE20                          WZ0053
     I              DGFE21                          WZ0054
     I              DGFE22                          WZ0055
     I              DGFE23                          WZ0056
     I              DGFE24                          WZ0057
     I              DGFE25                          WZ0058
     I              DGFE26                          WZ0059
     I              DGFE27                          WZ0060
     I              DGFE28                          WZ0061
     I              DGFE29                          WZ0062
     I              DGMA01                          WZ0063
     I              DGMA02                          WZ0064
     I              DGMA03                          WZ0065
     I              DGMA04                          WZ0066
     I              DGMA05                          WZ0067
     I              DGMA06                          WZ0068
     I              DGMA07                          WZ0069
     I              DGMA08                          WZ0070
     I              DGMA09                          WZ0071
     I              DGMA10                          WZ0072
     I              DGMA11                          WZ0073
     I              DGMA12                          WZ0074
     I              DGMA13                          WZ0075
     I              DGMA14                          WZ0076
     I              DGMA15                          WZ0077
     I              DGMA16                          WZ0078
     I              DGMA17                          WZ0079
     I              DGMA18                          WZ0080
     I              DGMA19                          WZ0081
     I              DGMA20                          WZ0082
     I              DGMA21                          WZ0083
     I              DGMA22                          WZ0084
     I              DGMA23                          WZ0085
     I              DGMA24                          WZ0086
     I              DGMA25                          WZ0087
     I              DGMA26                          WZ0088
     I              DGMA27                          WZ0089
     I              DGMA28                          WZ0090
     I              DGMA29                          WZ0091
     I              DGMA30                          WZ0092
     I              DGMA31                          WZ0093
     I              DGAP01                          WZ0094
     I              DGAP02                          WZ0095
     I              DGAP03                          WZ0096
     I              DGAP04                          WZ0097
     I              DGAP05                          WZ0098
     I              DGAP06                          WZ0099
     I              DGAP07                          WZ0100
     I              DGAP08                          WZ0101
     I              DGAP09                          WZ0102
     I              DGAP10                          WZ0103
     I              DGAP11                          WZ0104
     I              DGAP12                          WZ0105
     I              DGAP13                          WZ0106
     I              DGAP14                          WZ0107
     I              DGAP15                          WZ0108
     I              DGAP16                          WZ0109
     I              DGAP17                          WZ0110
     I              DGAP18                          WZ0111
     I              DGAP19                          WZ0112
     I              DGAP20                          WZ0113
     I              DGAP21                          WZ0114
     I              DGAP22                          WZ0115
     I              DGAP23                          WZ0116
     I              DGAP24                          WZ0117
     I              DGAP25                          WZ0118
     I              DGAP26                          WZ0119
     I              DGAP27                          WZ0120
     I              DGAP28                          WZ0121
     I              DGAP29                          WZ0122
     I              DGAP30                          WZ0123
     I              DGMY01                          WZ0124
     I              DGMY02                          WZ0125
     I              DGMY03                          WZ0126
     I              DGMY04                          WZ0127
     I              DGMY05                          WZ0128
     I              DGMY06                          WZ0129
     I              DGMY07                          WZ0130
     I              DGMY08                          WZ0131
     I              DGMY09                          WZ0132
     I              DGMY10                          WZ0133
     I              DGMY11                          WZ0134
     I              DGMY12                          WZ0135
     I              DGMY13                          WZ0136
     I              DGMY14                          WZ0137
     I              DGMY15                          WZ0138
     I              DGMY16                          WZ0139
     I              DGMY17                          WZ0140
     I              DGMY18                          WZ0141
     I              DGMY19                          WZ0142
     I              DGMY20                          WZ0143
     I              DGMY21                          WZ0144
     I              DGMY22                          WZ0145
     I              DGMY23                          WZ0146
     I              DGMY24                          WZ0147
     I              DGMY25                          WZ0148
     I              DGMY26                          WZ0149
     I              DGMY27                          WZ0150
     I              DGMY28                          WZ0151
     I              DGMY29                          WZ0152
     I              DGMY30                          WZ0153
     I              DGMY31                          WZ0154
     I              DGJU01                          WZ0155
     I              DGJU02                          WZ0156
     I              DGJU03                          WZ0157
     I              DGJU04                          WZ0158
     I              DGJU05                          WZ0159
     I              DGJU06                          WZ0160
     I              DGJU07                          WZ0161
     I              DGJU08                          WZ0162
     I              DGJU09                          WZ0163
     I              DGJU10                          WZ0164
     I              DGJU11                          WZ0165
     I              DGJU12                          WZ0166
     I              DGJU13                          WZ0167
     I              DGJU14                          WZ0168
     I              DGJU15                          WZ0169
     I              DGJU16                          WZ0170
     I              DGJU17                          WZ0171
     I              DGJU18                          WZ0172
     I              DGJU19                          WZ0173
     I              DGJU20                          WZ0174
     I              DGJU21                          WZ0175
     I              DGJU22                          WZ0176
     I              DGJU23                          WZ0177
     I              DGJU24                          WZ0178
     I              DGJU25                          WZ0179
     I              DGJU26                          WZ0180
     I              DGJU27                          WZ0181
     I              DGJU28                          WZ0182
     I              DGJU29                          WZ0183
     I              DGJU30                          WZ0184
     I              DGJL01                          WZ0185
     I              DGJL02                          WZ0186
     I              DGJL03                          WZ0187
     I              DGJL04                          WZ0188
     I              DGJL05                          WZ0189
     I              DGJL06                          WZ0190
     I              DGJL07                          WZ0191
     I              DGJL08                          WZ0192
     I              DGJL09                          WZ0193
     I              DGJL10                          WZ0194
     I              DGJL11                          WZ0195
     I              DGJL12                          WZ0196
     I              DGJL13                          WZ0197
     I              DGJL14                          WZ0198
     I              DGJL15                          WZ0199
     I              DGJL16                          WZ0200
     I              DGJL17                          WZ0201
     I              DGJL18                          WZ0202
     I              DGJL19                          WZ0203
     I              DGJL20                          WZ0204
     I              DGJL21                          WZ0205
     I              DGJL22                          WZ0206
     I              DGJL23                          WZ0207
     I              DGJL24                          WZ0208
     I              DGJL25                          WZ0209
     I              DGJL26                          WZ0210
     I              DGJL27                          WZ0211
     I              DGJL28                          WZ0212
     I              DGJL29                          WZ0213
     I              DGJL30                          WZ0214
     I              DGJL31                          WZ0215
     I              DGAU01                          WZ0216
     I              DGAU02                          WZ0217
     I              DGAU03                          WZ0218
     I              DGAU04                          WZ0219
     I              DGAU05                          WZ0220
     I              DGAU06                          WZ0221
     I              DGAU07                          WZ0222
     I              DGAU08                          WZ0223
     I              DGAU09                          WZ0224
     I              DGAU10                          WZ0225
     I              DGAU11                          WZ0226
     I              DGAU12                          WZ0227
     I              DGAU13                          WZ0228
     I              DGAU14                          WZ0229
     I              DGAU15                          WZ0230
     I              DGAU16                          WZ0231
     I              DGAU17                          WZ0232
     I              DGAU18                          WZ0233
     I              DGAU19                          WZ0234
     I              DGAU20                          WZ0235
     I              DGAU21                          WZ0236
     I              DGAU22                          WZ0237
     I              DGAU23                          WZ0238
     I              DGAU24                          WZ0239
     I              DGAU25                          WZ0240
     I              DGAU26                          WZ0241
     I              DGAU27                          WZ0242
     I              DGAU28                          WZ0243
     I              DGAU29                          WZ0244
     I              DGAU30                          WZ0245
     I              DGAU31                          WZ0246
     I              DGSE01                          WZ0247
     I              DGSE02                          WZ0248
     I              DGSE03                          WZ0249
     I              DGSE04                          WZ0250
     I              DGSE05                          WZ0251
     I              DGSE06                          WZ0252
     I              DGSE07                          WZ0253
     I              DGSE08                          WZ0254
     I              DGSE09                          WZ0255
     I              DGSE10                          WZ0256
     I              DGSE11                          WZ0257
     I              DGSE12                          WZ0258
     I              DGSE13                          WZ0259
     I              DGSE14                          WZ0260
     I              DGSE15                          WZ0261
     I              DGSE16                          WZ0262
     I              DGSE17                          WZ0263
     I              DGSE18                          WZ0264
     I              DGSE19                          WZ0265
     I              DGSE20                          WZ0266
     I              DGSE21                          WZ0267
     I              DGSE22                          WZ0268
     I              DGSE23                          WZ0269
     I              DGSE24                          WZ0270
     I              DGSE25                          WZ0271
     I              DGSE26                          WZ0272
     I              DGSE27                          WZ0273
     I              DGSE28                          WZ0274
     I              DGSE29                          WZ0275
     I              DGSE30                          WZ0276
     I              DGOC01                          WZ0277
     I              DGOC02                          WZ0278
     I              DGOC03                          WZ0279
     I              DGOC04                          WZ0280
     I              DGOC05                          WZ0281
     I              DGOC06                          WZ0282
     I              DGOC07                          WZ0283
     I              DGOC08                          WZ0284
     I              DGOC09                          WZ0285
     I              DGOC10                          WZ0286
     I              DGOC11                          WZ0287
     I              DGOC12                          WZ0288
     I              DGOC13                          WZ0289
     I              DGOC14                          WZ0290
     I              DGOC15                          WZ0291
     I              DGOC16                          WZ0292
     I              DGOC17                          WZ0293
     I              DGOC18                          WZ0294
     I              DGOC19                          WZ0295
     I              DGOC20                          WZ0296
     I              DGOC21                          WZ0297
     I              DGOC22                          WZ0298
     I              DGOC23                          WZ0299
     I              DGOC24                          WZ0300
     I              DGOC25                          WZ0301
     I              DGOC26                          WZ0302
     I              DGOC27                          WZ0303
     I              DGOC28                          WZ0304
     I              DGOC29                          WZ0305
     I              DGOC30                          WZ0306
     I              DGOC31                          WZ0307
     I              DGNO01                          WZ0308
     I              DGNO02                          WZ0309
     I              DGNO03                          WZ0310
     I              DGNO04                          WZ0311
     I              DGNO05                          WZ0312
     I              DGNO06                          WZ0313
     I              DGNO07                          WZ0314
     I              DGNO08                          WZ0315
     I              DGNO09                          WZ0316
     I              DGNO10                          WZ0317
     I              DGNO11                          WZ0318
     I              DGNO12                          WZ0319
     I              DGNO13                          WZ0320
     I              DGNO14                          WZ0321
     I              DGNO15                          WZ0322
     I              DGNO16                          WZ0323
     I              DGNO17                          WZ0324
     I              DGNO18                          WZ0325
     I              DGNO19                          WZ0326
     I              DGNO20                          WZ0327
     I              DGNO21                          WZ0328
     I              DGNO22                          WZ0329
     I              DGNO23                          WZ0330
     I              DGNO24                          WZ0331
     I              DGNO25                          WZ0332
     I              DGNO26                          WZ0333
     I              DGNO27                          WZ0334
     I              DGNO28                          WZ0335
     I              DGNO29                          WZ0336
     I              DGNO30                          WZ0337
     I              DGDE01                          WZ0338
     I              DGDE02                          WZ0339
     I              DGDE03                          WZ0340
     I              DGDE04                          WZ0341
     I              DGDE05                          WZ0342
     I              DGDE06                          WZ0343
     I              DGDE07                          WZ0344
     I              DGDE08                          WZ0345
     I              DGDE09                          WZ0346
     I              DGDE10                          WZ0347
     I              DGDE11                          WZ0348
     I              DGDE12                          WZ0349
     I              DGDE13                          WZ0350
     I              DGDE14                          WZ0351
     I              DGDE15                          WZ0352
     I              DGDE16                          WZ0353
     I              DGDE17                          WZ0354
     I              DGDE18                          WZ0355
     I              DGDE19                          WZ0356
     I              DGDE20                          WZ0357
     I              DGDE21                          WZ0358
     I              DGDE22                          WZ0359
     I              DGDE23                          WZ0360
     I              DGDE24                          WZ0361
     I              DGDE25                          WZ0362
     I              DGDE26                          WZ0363
     I              DGDE27                          WZ0364
     I              DGDE28                          WZ0365
     I              DGDE29                          WZ0366
     I              DGDE30                          WZ0367
     I              DGDE31                          WZ0368
     I              DGAACC                          WZ0369                                    CSD031
     I              DGEACC                          WZ0370                                    CSD031
     I              DGGPDT                          WZ0371                                    CSD031
      *
     I@2DBRC    E DSSDHOSHL0                                                                  CSD012
      * Holidays Shadow file                                                                  CSD012
     I              DGCYCD                          @CYCD                                     CSD012
     I              DGLCCD                          @LCCD                                     CSD012
     I              DGYRNB                          @YRNB                                     CSD012
     I              DGLCD                           @LCD                                      CSD012
     I              DGTYLC                          @TYLC                                     CSD012
      *                                                                                       CSD012
     I***#1DBRC******DS                            386                                        CSD031
     I#1DBRC      DS                            431                                           CDS031
      * Stored master file format fields
     I                                        1   1 #1DB1
      *
     I            DS
     I                                        1   2 #DJ01N
     I                                        3   4 #DJ02N
     I                                        5   6 #DJ03N
     I                                        7   8 #DJ04N
     I                                        9  10 #DJ05N
     I                                       11  12 #DJ06N
     I                                       13  14 #DJ07N
     I                                       15  16 #DJ08N
     I                                       17  18 #DJ09N
     I                                       19  20 #DJ10N
     I                                       21  22 #DJ11N
     I                                       23  24 #DJ12N
     I                                       25  26 #DJ13N
     I                                       27  28 #DJ14N
     I                                       29  30 #DJ15N
     I                                       31  32 #DJ16N
     I                                       33  34 #DJ17N
     I                                       35  36 #DJ18N
     I                                       37  38 #DJ19N
     I                                       39  40 #DJ20N
     I                                       41  42 #DJ21N
     I                                       43  44 #DJ22N
     I                                       45  46 #DJ23N
     I                                       47  48 #DJ24N
     I                                       49  50 #DJ25N
     I                                       51  52 #DJ26N
     I                                       53  54 #DJ27N
     I                                       55  56 #DJ28N
     I                                       57  58 #DJ29N
     I                                       59  60 #DJ30N
     I                                       61  62 #DJ31N
     I                                       63  64 #DJ32N
     I                                       65  66 #DJ33N
     I                                       67  68 #DJ34N
     I                                       69  70 #DJ35N
     I                                       71  72 #DJ36N
     I                                       73  74 #DJ37N
     I                                        1  74 JANUAR
     I            DS
     I                                        1   2 #DF01N
     I                                        3   4 #DF02N
     I                                        5   6 #DF03N
     I                                        7   8 #DF04N
     I                                        9  10 #DF05N
     I                                       11  12 #DF06N
     I                                       13  14 #DF07N
     I                                       15  16 #DF08N
     I                                       17  18 #DF09N
     I                                       19  20 #DF10N
     I                                       21  22 #DF11N
     I                                       23  24 #DF12N
     I                                       25  26 #DF13N
     I                                       27  28 #DF14N
     I                                       29  30 #DF15N
     I                                       31  32 #DF16N
     I                                       33  34 #DF17N
     I                                       35  36 #DF18N
     I                                       37  38 #DF19N
     I                                       39  40 #DF20N
     I                                       41  42 #DF21N
     I                                       43  44 #DF22N
     I                                       45  46 #DF23N
     I                                       47  48 #DF24N
     I                                       49  50 #DF25N
     I                                       51  52 #DF26N
     I                                       53  54 #DF27N
     I                                       55  56 #DF28N
     I                                       57  58 #DF29N
     I                                       59  60 #DF30N
     I                                       61  62 #DF31N
     I                                       63  64 #DF32N
     I                                       65  66 #DF33N
     I                                       67  68 #DF34N
     I                                       69  70 #DF35N
     I                                       71  72 #DF36N
     I                                       73  74 #DF37N
     I                                        1  74 FEBRUA
     I            DS
     I                                        1   2 #DM01N
     I                                        3   4 #DM02N
     I                                        5   6 #DM03N
     I                                        7   8 #DM04N
     I                                        9  10 #DM05N
     I                                       11  12 #DM06N
     I                                       13  14 #DM07N
     I                                       15  16 #DM08N
     I                                       17  18 #DM09N
     I                                       19  20 #DM10N
     I                                       21  22 #DM11N
     I                                       23  24 #DM12N
     I                                       25  26 #DM13N
     I                                       27  28 #DM14N
     I                                       29  30 #DM15N
     I                                       31  32 #DM16N
     I                                       33  34 #DM17N
     I                                       35  36 #DM18N
     I                                       37  38 #DM19N
     I                                       39  40 #DM20N
     I                                       41  42 #DM21N
     I                                       43  44 #DM22N
     I                                       45  46 #DM23N
     I                                       47  48 #DM24N
     I                                       49  50 #DM25N
     I                                       51  52 #DM26N
     I                                       53  54 #DM27N
     I                                       55  56 #DM28N
     I                                       57  58 #DM29N
     I                                       59  60 #DM30N
     I                                       61  62 #DM31N
     I                                       63  64 #DM32N
     I                                       65  66 #DM33N
     I                                       67  68 #DM34N
     I                                       69  70 #DM35N
     I                                       71  72 #DM36N
     I                                       73  74 #DM37N
     I                                        1  74 MARCH
     I            DS
     I                                        1   1 #DJ01S
     I                                        2   2 #DJ02S
     I                                        3   3 #DJ03S
     I                                        4   4 #DJ04S
     I                                        5   5 #DJ05S
     I                                        6   6 #DJ06S
     I                                        7   7 #DJ07S
     I                                        8   8 #DJ08S
     I                                        9   9 #DJ09S
     I                                       10  10 #DJ10S
     I                                       11  11 #DJ11S
     I                                       12  12 #DJ12S
     I                                       13  13 #DJ13S
     I                                       14  14 #DJ14S
     I                                       15  15 #DJ15S
     I                                       16  16 #DJ16S
     I                                       17  17 #DJ17S
     I                                       18  18 #DJ18S
     I                                       19  19 #DJ19S
     I                                       20  20 #DJ20S
     I                                       21  21 #DJ21S
     I                                       22  22 #DJ22S
     I                                       23  23 #DJ23S
     I                                       24  24 #DJ24S
     I                                       25  25 #DJ25S
     I                                       26  26 #DJ26S
     I                                       27  27 #DJ27S
     I                                       28  28 #DJ28S
     I                                       29  29 #DJ29S
     I                                       30  30 #DJ30S
     I                                       31  31 #DJ31S
     I                                       32  32 #DJ32S
     I                                       33  33 #DJ33S
     I                                       34  34 #DJ34S
     I                                       35  35 #DJ35S
     I                                       36  36 #DJ36S
     I                                       37  37 #DJ37S
     I                                        1  37 JAST
     I            DS
     I                                        1   1 WUJA01
     I                                        2   2 WUJA02
     I                                        3   3 WUJA03
     I                                        4   4 WUJA04
     I                                        5   5 WUJA05
     I                                        6   6 WUJA06
     I                                        7   7 WUJA07
     I                                        8   8 WUJA08
     I                                        9   9 WUJA09
     I                                       10  10 WUJA10
     I                                       11  11 WUJA11
     I                                       12  12 WUJA12
     I                                       13  13 WUJA13
     I                                       14  14 WUJA14
     I                                       15  15 WUJA15
     I                                       16  16 WUJA16
     I                                       17  17 WUJA17
     I                                       18  18 WUJA18
     I                                       19  19 WUJA19
     I                                       20  20 WUJA20
     I                                       21  21 WUJA21
     I                                       22  22 WUJA22
     I                                       23  23 WUJA23
     I                                       24  24 WUJA24
     I                                       25  25 WUJA25
     I                                       26  26 WUJA26
     I                                       27  27 WUJA27
     I                                       28  28 WUJA28
     I                                       29  29 WUJA29
     I                                       30  30 WUJA30
     I                                       31  31 WUJA31
     I                                        1  31 JANFLD
     I            DS
     I                                        1   1 #DF01S
     I                                        2   2 #DF02S
     I                                        3   3 #DF03S
     I                                        4   4 #DF04S
     I                                        5   5 #DF05S
     I                                        6   6 #DF06S
     I                                        7   7 #DF07S
     I                                        8   8 #DF08S
     I                                        9   9 #DF09S
     I                                       10  10 #DF10S
     I                                       11  11 #DF11S
     I                                       12  12 #DF12S
     I                                       13  13 #DF13S
     I                                       14  14 #DF14S
     I                                       15  15 #DF15S
     I                                       16  16 #DF16S
     I                                       17  17 #DF17S
     I                                       18  18 #DF18S
     I                                       19  19 #DF19S
     I                                       20  20 #DF20S
     I                                       21  21 #DF21S
     I                                       22  22 #DF22S
     I                                       23  23 #DF23S
     I                                       24  24 #DF24S
     I                                       25  25 #DF25S
     I                                       26  26 #DF26S
     I                                       27  27 #DF27S
     I                                       28  28 #DF28S
     I                                       29  29 #DF29S
     I                                       30  30 #DF30S
     I                                       31  31 #DF31S
     I                                       32  32 #DF32S
     I                                       33  33 #DF33S
     I                                       34  34 #DF34S
     I                                       35  35 #DF35S
     I                                       36  36 #DF36S
     I                                       37  37 #DF37S
     I                                        1  37 FEST
     I            DS
     I                                        1   1 WUFE01
     I                                        2   2 WUFE02
     I                                        3   3 WUFE03
     I                                        4   4 WUFE04
     I                                        5   5 WUFE05
     I                                        6   6 WUFE06
     I                                        7   7 WUFE07
     I                                        8   8 WUFE08
     I                                        9   9 WUFE09
     I                                       10  10 WUFE10
     I                                       11  11 WUFE11
     I                                       12  12 WUFE12
     I                                       13  13 WUFE13
     I                                       14  14 WUFE14
     I                                       15  15 WUFE15
     I                                       16  16 WUFE16
     I                                       17  17 WUFE17
     I                                       18  18 WUFE18
     I                                       19  19 WUFE19
     I                                       20  20 WUFE20
     I                                       21  21 WUFE21
     I                                       22  22 WUFE22
     I                                       23  23 WUFE23
     I                                       24  24 WUFE24
     I                                       25  25 WUFE25
     I                                       26  26 WUFE26
     I                                       27  27 WUFE27
     I                                       28  28 WUFE28
     I                                       29  29 WUFE29
     I                                        1  29 FEBFLD
     I            DS
     I                                        1   1 #DM01S
     I                                        2   2 #DM02S
     I                                        3   3 #DM03S
     I                                        4   4 #DM04S
     I                                        5   5 #DM05S
     I                                        6   6 #DM06S
     I                                        7   7 #DM07S
     I                                        8   8 #DM08S
     I                                        9   9 #DM09S
     I                                       10  10 #DM10S
     I                                       11  11 #DM11S
     I                                       12  12 #DM12S
     I                                       13  13 #DM13S
     I                                       14  14 #DM14S
     I                                       15  15 #DM15S
     I                                       16  16 #DM16S
     I                                       17  17 #DM17S
     I                                       18  18 #DM18S
     I                                       19  19 #DM19S
     I                                       20  20 #DM20S
     I                                       21  21 #DM21S
     I                                       22  22 #DM22S
     I                                       23  23 #DM23S
     I                                       24  24 #DM24S
     I                                       25  25 #DM25S
     I                                       26  26 #DM26S
     I                                       27  27 #DM27S
     I                                       28  28 #DM28S
     I                                       29  29 #DM29S
     I                                       30  30 #DM30S
     I                                       31  31 #DM31S
     I                                       32  32 #DM32S
     I                                       33  33 #DM33S
     I                                       34  34 #DM34S
     I                                       35  35 #DM35S
     I                                       36  36 #DM36S
     I                                       37  37 #DM37S
     I                                        1  37 MAST
     I            DS
     I                                        1   1 WUMA01
     I                                        2   2 WUMA02
     I                                        3   3 WUMA03
     I                                        4   4 WUMA04
     I                                        5   5 WUMA05
     I                                        6   6 WUMA06
     I                                        7   7 WUMA07
     I                                        8   8 WUMA08
     I                                        9   9 WUMA09
     I                                       10  10 WUMA10
     I                                       11  11 WUMA11
     I                                       12  12 WUMA12
     I                                       13  13 WUMA13
     I                                       14  14 WUMA14
     I                                       15  15 WUMA15
     I                                       16  16 WUMA16
     I                                       17  17 WUMA17
     I                                       18  18 WUMA18
     I                                       19  19 WUMA19
     I                                       20  20 WUMA20
     I                                       21  21 WUMA21
     I                                       22  22 WUMA22
     I                                       23  23 WUMA23
     I                                       24  24 WUMA24
     I                                       25  25 WUMA25
     I                                       26  26 WUMA26
     I                                       27  27 WUMA27
     I                                       28  28 WUMA28
     I                                       29  29 WUMA29
     I                                       30  30 WUMA30
     I                                       31  31 WUMA31
     I                                        1  31 MARFLD
     I            DS
     I                                        1 132 UMSDA
     I                                        1  10 UMERR
     I                                       11  12 UDERR
     IQSDFC1    E DSSDFCTLL0
      * UPD : Midas SD Standing data controls update
      *
     IYARDCS      DS                             22
     IYBRDCS      DS                             22
     IYCRDCS      DS                            386
     IYDRDCS      DS                             22
     IA@CPY       DS
     I* Copyright array
     I                                        1  80 CPY@
     IRUNDAT      DS
     I                                        1   7 MRDT
     I                                    P   8  100RDNB
     I                                       11  11 SUC
     I                                       12  12 DFF
     I                                       13  13 MBIN
     IID0001      DS                            528
      * File information data structure
      *
     IID0002      DS                            528
      * File information data structure
      *
     IID0003      DS                            528
      * File information data structure
      *
     IID0004      DS                            528
      * File information data structure
      *
     IID0005      DS                            528
      * File information data structure
      *
     IID0006      DS                            528
      * File information data structure
      *
     IID0007      DS                            528
      * File information data structure
      *
      *                                                                                     BG12014
     IIDPASS      DS                                                                        BG12014
     I                                        1  92 DATA1                                   BG12014
     I                                       93  94 ZONE1                                   BG12014
     I                                       95 256 DATA2                                   BG12014
      /EJECT
      * Parameter declarations
     IP1PARM      DS                             10
      * KEY: Holidays                  test access path
      * I : MAP Currency Code
     I                                        1   3 P1CYCD
      * I : MAP Location Code
     I                                        4   6 P1LCCD
      * I : MAP Year Number
     I                                        7  10 P1YRNB
     IP2PARM      DS
      * I :  Action Code
     I                                        1   1 P2ANCD
     IP3PARM      DS
      * I :  Day Code
     I                                        1   10P3DYCD
     IP4PARM      DS
      * I :  Leap Year Indicator
     I                                        1   1 P4LYRI
     IP5PARM      DS
      * I :  Program recalled
     I                                        1   1 P5PGMR
      *                                                                                       CSD012
     I***K1HOL**     DS                             20                                 CSD012 CGL029
     IK1HOL       DS                             26                                           CGL029
     I                                        1   3 K1CYCD                                    CSD012
     I                                        4   6 K1LCCD                                    CSD012
     I                                        7  10 K1YRNB                                    CSD012
      *                                                                                       CSD012
      * Data structure for AOSVALR0 string                                                    CSD012
     I            DS                                                                          CSD012
     I                                        1 200 SVAL1                                     CSD012
     I                                        1   1 SVAL11                                    CSD012
      *                                                                                       CSD012
      * System Value                                                                          CSD012
     I            DS                                                                          CSD012
     I I            'AuthReqHolidaysMaint'    1  20 SVALK1                                    CSD012
      *                                                                                       CSD012
      * Function Description                                                                  CSD012
     I            DS                                                                          CSD012
     I I            'HOLIDAY DETAILS'         1  21 FUNCD                                     CSD012
     I I            'ZoneSystemName'         22  41 ZONEST                                   BG12014
      *                                                                                       CSD012
      ** Constants                                                                          MD037087
     I              'HolidayBackChange'   C         HOLBCK                                  MD037087
      *                                                                                     MD037087
      *                                                                                       CTI006
      * Outward parameters                                                                    CTI006
      * Midas SD Deleted records file                                                         CTI006
     IPFRC        DS                           3064                                           CTI006
     I                                        1  10 PFFNME                                    CTI006
     I                                       11  60 PFLKEY                                    CTI006
     I                                       61 310 PFDR01                                    CTI006
     I                                      311 560 PFDR02                                    CTI006
     I                                      561 810 PFDR03                                    CTI006
     I                                      8111060 PFDR04                                    CTI006
     I                                     10611310 PFDR05                                    CTI006
     I                                     13111560 PFDR06                                    CTI006
     I                                     15611810 PFDR07                                    CTI006
     I                                     18112060 PFDR08                                    CTI006
     I                                     20612310 PFDR09                                    CTI006
     I                                     23112560 PFDR00                                    CTI006
     I                                     25612810 PFDR11                                    CTI006
     I                                     28113060 PFDR12                                    CTI006
     I                                    P306130630PFLCD                                     CTI006
     I                                     30643064 PFTYLC                                    CTI006
      *                                                                                       CTI006
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C                     PARM           P1PARM           KEY: Holidays
     C           P2ANCD    PARM           WP0001  1        Action Code
     C           P3DYCD    PARM           WP0002  10       Day Code
     C           P4LYRI    PARM           WP0003  1        Leap Year Indic
     C           P5PGMR    PARM           WP0004  1        Program recalle
      *                                                                                       CSD031
      ** Mode Parameter                                                                       CSD031
     C                     PARM           @PMODE  1                                           CSD031
      *                                                                                       CSD031
      ** Accept to Zone Parameter                                                             CSD031
     C                     PARM #1ACTZ    @PACTZ  1                                           CSD031
      *                                                                                       CSD031
      ** Effective Date                                                                       CSD031
     C                     PARM #1EFDT    @PEFDT  6                                           CSD031
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Check passed parameters
     C                     EXSR FACKPM
      * Perform once if all passed, else repeat
     C           W0RPT     DOUEQ'N'
      * Display and process key screen
     C                     EXSR BADSKY
     C                     END
      * Terminate program
     C                     EXSR ZXEXPG
      *****************************************************************
      /EJECT
     CSR         BADSKY    BEGSR
      *================================================================
      * Display and process key screen
      *================================================================
      * Initialize key screen
     C                     EXSR MDIZ#K
      * Bypass first display of key screen is possible
     C                     MOVEL'Y'       W0BYP   1
      * Signal start of transaction
     C                     MOVEL'Y'       W0TRN   1
     C           W0TRN     DOWEQ'Y'
     C           W0TRN     OREQ 'K'
      * Ensure transaction continues (if reset)
     C                     MOVEL'Y'       W0TRN   1
      * Conduct screen conversation
     C           W0TRN     DOWEQ'Y'
      * Is bypass key screen still viable?
     C           W0BYP     IFEQ 'Y'
     C           #1CYCD    IFEQ *BLANK                     Currency Code
     C           #1LCCD    OREQ *BLANK                     Location Code
     C           #1YRNB    OREQ *BLANK                     Year Number
      * One or more key fields is blank
     C           *IN05     OREQ '1'
      * HOME: Reset screen fields
     C                     MOVEL'N'       W0BYP
     C                     END
     C                     END
      * Bypass key screen
     C           W0BYP     IFNE 'Y'
      * Display key screen
     C                     EXSR BBEXFM
     C                     END
      * Cancel key screen bypass
     C                     MOVEL'N'       W0BYP
      * Process response to key screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * Switch between *ADD/*CHANGE modes
     C   09                CAS            BCCHMD
      * HOME: Reset screen fields
     C   05                CAS            BDHMKY
      * Process key screen input
     C                     CAS            BEPRKY
     C                     END
     C           W0TRN     DOWEQ'R'
     C                     MOVEL'Y'       W0TRN
     C                     EXSR BEPRKY
     C                     END
      *
     C                     END
     C                     END
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBEXFM    BEGSR
      *================================================================
      * Display key screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSAK
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE HELP25    *IN25
      * PUTOVR unless conditioned fields change
     C                     SETON                         86*
     C           *IN89     IFNE BBIN89
     C                     SETOF                         86*
     C                     END
     C                     MOVE *IN89     BBIN89  1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDKEY
      * Test cursor
     C                     EXSR Y8TST
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1
      * Reset global error indicator
     C                     SETOF                         99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         BCCHMD    BEGSR
      *================================================================
      * Switch between *ADD/*CHANGE modes
      *================================================================
     C           W0PMD     IFEQ 'ADD'
     C                     MOVEL'CHG'     W0PMD   3
     C                     ELSE
     C                     MOVEL'ADD'     W0PMD
     C                     END
      *================================================================
     CSR         BCEXIT    ENDSR
      /EJECT
     CSR         BDHMKY    BEGSR
      *================================================================
      * Process HOME key
      *================================================================
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         BDEXIT    ENDSR
      /EJECT
     CSR         BEPRKY    BEGSR
      *================================================================
      * Process key screen input
      *================================================================
      * Initialise detail screen
     C                     EXSR MAIZ#1
      * Validate key fields
     C                     EXSR BFVLKY
     C           *IN99     CABEQ'1'       BEEXIT
     C           W0PMD     IFNE 'ADD'
      * Check for existing record
     C           KRTV      KLIST
     C                     KFLD           DGCYCD           Currency Code
     C                     KFLD           DGLCCD           Location Code
     C                     KFLD           DGYRNB           Year Number
      * Setup key
     C                     MOVEL#1CYCD    DGCYCD           Currency Code
     C                     MOVEL#1LCCD    DGLCCD           Location Code
     C                     MOVEL#1YRNB    DGYRNB           Year Number
      *                                                                                       CSD031
      ** Use appropriate files                                                                CSD031
      *                                                                                       CSD031
     C           CSD041    IFEQ 'Y'                                                           CSD031
     C                     SELEC                                                              CSD031
      *                                                                                       CSD031
      ** Global                                                                               CSD031
     C           W@MODE    WHEQ 'G'                                                           CSD031
     C           KRTV      CHAINGPHOLID1             9091                                     CSD031
      *                                                                                       CSD031
      ** Zonal / Accept Mode                                                                  CSD031
     C           W@MODE    WHEQ 'A'                                                           CSD031
     C           KRTV      CHAINSDAHDYD1             9091                                     CSD031
      *                                                                                       CSD031
      ** Zonal / Change Mode                                                                  CSD031
     C                     OTHER                                                              CSD031
     C           KRTV      CHAIN@HOLPH0              9091                                     CSD031
     C                     ENDSL                                                              CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
      *                                                                                       CSD031
     C           KRTV      CHAIN@HOLPH0              9091  *
     C                     ENDIF                                                              CSD031
      *
      * If CSD012 is ON and Holidays is ON, do not worry about record                         CSD012
      * not being found on SDHOLPD check on shadow file.                                      CSD012
     C           *IN90     IFEQ '1'                                                           CSD012
     C           CSD012    IFEQ 'Y'                                                           CSD012
     C           SVAL11    ANDEQ'Y'                                                           CSD012
     C           KRTV      CHAINSDHOSHL0             9091  *                                  CSD012
     C                     MOVEL@2DBRC    @1DBRC                                              CSD012
      *                                                                                       CSD012
      * Ensure key values are not lost.                                                       CSD012
     C                     MOVEL#1CYCD    DGCYCD           Currency Code                      CSD012
     C                     MOVEL#1LCCD    DGLCCD           Location Code                      CSD012
     C                     MOVEL#1YRNB    DGYRNB           Year Number                        CSD012
     C                     ENDIF                                                              CSD012
     C                     ENDIF                                                              CSD012
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     SETON                     993132*
     C                     SETON                     33    *
     C                     GOTO BEEXIT
     C                     END                             FI 91
      *
     C                     END
      * Verify record existence against program mode
     C           W0PMD     IFNE 'ADD'
      * If record does not exist, error
     C           *IN90     IFEQ '1'
     C                     SETON                     993132*
     C                     SETON                     33    *
      * Send message 'Holidays               NF'
     C                     MOVEL'USR0657' ZAMSID
     C                     EXSR ZASNMS
     C                     ELSE
     C                     EXSR MBFL#1
      * CALC: Detail screen function fields
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy Member SD0161RSFF - Holidays  *
     C*00/Copy Member SD0161R   Calc Detail Function Flds
     C/COPY WNCPYSRC,SD0161RSFF
     C                     END                             *FI
      * USER: Initialize detail screen (existing record)
      * CASE: PAR.Location Code is Global Value
     C           P1LCCD    IFEQ '***'                      *IF
     C                     MOVEL*BLANK    #DLCDF           Location Code -
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELP1LCCD    #DLCDF           Location Code -
     C                     END                             *FI
      * Get Holidays for 1st Q - Holidays  *
     C                     EXSR SARVGN
      * Set up Month Days 1st Q - Holidays  *
     C* SET UP THE DAY NUMBERS FOR THE SCREEN (JANUARY)
     C           1         ADD  P3DYCD    X       20
     C                     MOVEAJAN       TEMP,X
     C                     MOVEATEMP      JANUAR
     C                     MOVEA*BLANKS   TEMP
     C* SET UP THE DAY NUMBER FOR THE SCREEN (FEBRUARY)
     C           X         ADD  3         X
     C           X         IFGT 7
     C           X         SUB  7         X
     C                     END
     C           P4LYRI    IFEQ 'N'
     C                     MOVEAFEB1      TEMP,X
     C                     ELSE
     C                     MOVEAFEB2      TEMP,X
     C                     END
     C                     MOVEATEMP      FEBRUA
     C                     MOVEA*BLANKS   TEMP
     C* SET UP THE DAY NUMBER FOR THE SCREEN (MARCH)
     C           P4LYRI    IFEQ 'Y'
     C           X         ADD  1         X
     C           X         IFGT 7
     C           X         SUB  7         X
     C                     END
     C                     END
     C                     MOVEAMAR       TEMP,X
     C                     MOVEATEMP      MARCH
      * Set up existing Holidays - Holidays  *
     C* CALCULATE THE FIELD DIFFERENTIAL FOR JANUARY
     C           P3DYCD    ADD  1         X
     C           'S'       IFEQ 'S'
     C                     MOVEAJANFLD    JAST,X
     C                     ELSE
     C                     MOVEAJAST,X    JANFLD
     C                     END
     C*                                                                   063310
     C** SET HOLIDAY INDICATOR TO 'H' IF ENTRY IS 'X'.                    063310
     C*                                                                   063310
     C                     MOVEA*BLANKS   JANA                            063310
     C           1         DO   37        Z       20                      063310
     C           JAST,Z    IFEQ 'X'                                       063310
     C                     MOVEA'H'       JANA,Z                          063310
     C                     END                                            063310
     C                     END                                            063310
     C*                                                                   063310
     C* CALCULATE THE FIELD DIFFERENTIAL FOR FEBRUARY
     C           X         ADD  3         X
     C           X         IFGT 7
     C           X         SUB  7         X
     C                     END
     C           'S'       IFEQ 'S'
     C                     MOVEAFEBFLD    FEST,X
     C* IF IT IS NOT A LEAP YEAR HIDE THE VALUE FOR 29/2
     C           P4LYRI    IFEQ 'N'
     C           X         ADD  28        L       20
     C                     MOVE *BLANK    FEST,L
     C                     END
     C                     ELSE
     C                     MOVEAFEST,X    FEBFLD
     C                     END
     C*                                                                   063310
     C** SET HOLIDAY INDICATOR TO 'H' IF ENTRY IS 'X'.                    063310
     C*                                                                   063310
     C                     MOVEA*BLANKS   FEBA                            063310
     C           1         DO   37        Z       20                      063310
     C           FEST,Z    IFEQ 'X'                                       063310
     C                     MOVEA'H'       FEBA,Z                          063310
     C                     END                                            063310
     C                     END                                            063310
     C*                                                                   063310
     C* CALCULATE THE FIELD DIFFERENTIAL FOR MARCH
     C           P4LYRI    IFEQ 'Y'
     C           X         ADD  1         X
     C           X         IFGT 7
     C           X         SUB  7         X
     C                     END
     C                     END
     C           'S'       IFEQ 'S'
     C                     MOVEAMARFLD    MAST,X
     C                     ELSE
     C                     MOVEAMAST,X    MARFLD
     C                     END
     C*                                                                   063310
     C** SET HOLIDAY INDICATOR TO 'H' IF ENTRY IS 'X'.                    063310
     C*                                                                   063310
     C                     MOVEA*BLANKS   MARA                            063310
     C           1         DO   37        Z       20                      063310
     C           MAST,Z    IFEQ 'X'                                       063310
     C                     MOVEA'H'       MARA,Z                          063310
     C                     END                                            063310
     C                     END                                            063310
     C*                                                                   063310
     C* IF IT IS NOT A LEAP YEAR THEN ENSURE THAT FEB 29 IS BLANK
     C           P4LYRI    IFEQ 'N'
     C                     MOVE *BLANK    WUFE29
     C                     END
      * Set up DTL footer - Holidays  *
     C*
     C*  If Action Code is Delete :
     C*
     C           P2ANCD    IFEQ 'D'                                       S01229
     C                     MOVEAAENA,1    ##CTX1                          S01229
     C                     END
     C*
     C*  If Action Code is Insert :
     C*
     C           P2ANCD    IFEQ 'I'                                       S01229
     C                     MOVEAAENA,2    ##CTX1                          S01229
     C                     END
     C*
     C*  If Action Code is Amend :
     C*
     C           P2ANCD    IFEQ 'A'                                       S01229
     C                     MOVEAAENA,3    ##CTX1                          S01229
     C                     END
     C*
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy Member SD0161RISE - Holidays  *
     C*00/Copy Member SD0161R   Initialise Dtl Exist Rcd
     C/COPY WNCPYSRC,SD0161RISE
     C                     END                             *FI
     C                     END
      *
     C                     ELSE
      * USER: Initialize detail screen (new record)
      * Set up DTL footer - Holidays  *
     C*
     C*  If Action Code is Delete :
     C*
     C           P2ANCD    IFEQ 'D'                                       S01229
     C                     MOVEAAENA,1    ##CTX1                          S01229
     C                     END
     C*
     C*  If Action Code is Insert :
     C*
     C           P2ANCD    IFEQ 'I'                                       S01229
     C                     MOVEAAENA,2    ##CTX1                          S01229
     C                     END
     C*
     C*  If Action Code is Amend :
     C*
     C           P2ANCD    IFEQ 'A'                                       S01229
     C                     MOVEAAENA,3    ##CTX1                          S01229
     C                     END
     C*
      * Set up Month Days 1st Q - Holidays  *
     C* SET UP THE DAY NUMBERS FOR THE SCREEN (JANUARY)
     C           1         ADD  P3DYCD    X       20
     C                     MOVEAJAN       TEMP,X
     C                     MOVEATEMP      JANUAR
     C                     MOVEA*BLANKS   TEMP
     C* SET UP THE DAY NUMBER FOR THE SCREEN (FEBRUARY)
     C           X         ADD  3         X
     C           X         IFGT 7
     C           X         SUB  7         X
     C                     END
     C           P4LYRI    IFEQ 'N'
     C                     MOVEAFEB1      TEMP,X
     C                     ELSE
     C                     MOVEAFEB2      TEMP,X
     C                     END
     C                     MOVEATEMP      FEBRUA
     C                     MOVEA*BLANKS   TEMP
     C* SET UP THE DAY NUMBER FOR THE SCREEN (MARCH)
     C           P4LYRI    IFEQ 'Y'
     C           X         ADD  1         X
     C           X         IFGT 7
     C           X         SUB  7         X
     C                     END
     C                     END
     C                     MOVEAMAR       TEMP,X
     C                     MOVEATEMP      MARCH
      * CASE: PAR.Location Code is Global Value
     C           P1LCCD    IFEQ '***'                      *IF
     C                     MOVEL*BLANK    #DLCDF           Location Code -
      * Retrieve standard Holiday - Currency Codes  *
     C                     EXSR SBRVGN
      * Set up Standard Holidays - Holidays  *
     C                     MOVEA*BLANKS   JAST
     C                     MOVEA*BLANKS   FEST
     C                     MOVEA*BLANKS   MAST
     C*
     C           WUSATH    IFEQ 'Y'
     C           1         DO   37        H       20
     C                     MOVEA'X'       JAST,H
     C                     MOVEA'X'       FEST,H
     C                     MOVEA'X'       MAST,H
     C                     END  7
     C                     END
     C           WUSUNH    IFEQ 'Y'
     C           2         DO   37        H
     C                     MOVEA'X'       JAST,H
     C                     MOVEA'X'       FEST,H
     C                     MOVEA'X'       MAST,H
     C                     END  7
     C                     END
     C           WUMONH    IFEQ 'Y'
     C           3         DO   37        H
     C                     MOVEA'X'       JAST,H
     C                     MOVEA'X'       FEST,H
     C                     MOVEA'X'       MAST,H
     C                     END  7
     C                     END
     C           WUTUEH    IFEQ 'Y'
     C           4         DO   37        H
     C                     MOVEA'X'       JAST,H
     C                     MOVEA'X'       FEST,H
     C                     MOVEA'X'       MAST,H
     C                     END  7
     C                     END
     C           WUWEDH    IFEQ 'Y'
     C           5         DO   37        H
     C                     MOVEA'X'       JAST,H
     C                     MOVEA'X'       FEST,H
     C                     MOVEA'X'       MAST,H
     C                     END  7
     C                     END
     C           WUTHUH    IFEQ 'Y'
     C           6         DO   37        H
     C                     MOVEA'X'       JAST,H
     C                     MOVEA'X'       FEST,H
     C                     MOVEA'X'       MAST,H
     C                     END  7
     C                     END
     C           WUFRIH    IFEQ 'Y'
     C           7         DO   37        H
     C                     MOVEA'X'       JAST,H
     C                     MOVEA'X'       FEST,H
     C                     MOVEA'X'       MAST,H
     C                     END  7
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELP1LCCD    #DLCDF           Location Code -
      * Get Holidays for 1st Q - Holidays  *
     C                     EXSR SCRVGN
      * Set up existing Holidays - Holidays  *
     C* CALCULATE THE FIELD DIFFERENTIAL FOR JANUARY
     C           P3DYCD    ADD  1         X
     C           'S'       IFEQ 'S'
     C                     MOVEAJANFLD    JAST,X
     C                     ELSE
     C                     MOVEAJAST,X    JANFLD
     C                     END
     C*                                                                   063310
     C** SET HOLIDAY INDICATOR TO 'H' IF ENTRY IS 'X'.                    063310
     C*                                                                   063310
     C                     MOVEA*BLANKS   JANA                            063310
     C           1         DO   37        Z       20                      063310
     C           JAST,Z    IFEQ 'X'                                       063310
     C                     MOVEA'H'       JANA,Z                          063310
     C                     END                                            063310
     C                     END                                            063310
     C*                                                                   063310
     C* CALCULATE THE FIELD DIFFERENTIAL FOR FEBRUARY
     C           X         ADD  3         X
     C           X         IFGT 7
     C           X         SUB  7         X
     C                     END
     C           'S'       IFEQ 'S'
     C                     MOVEAFEBFLD    FEST,X
     C* IF IT IS NOT A LEAP YEAR HIDE THE VALUE FOR 29/2
     C           P4LYRI    IFEQ 'N'
     C           X         ADD  28        L       20
     C                     MOVE *BLANK    FEST,L
     C                     END
     C                     ELSE
     C                     MOVEAFEST,X    FEBFLD
     C                     END
     C*                                                                   063310
     C** SET HOLIDAY INDICATOR TO 'H' IF ENTRY IS 'X'.                    063310
     C*                                                                   063310
     C                     MOVEA*BLANKS   FEBA                            063310
     C           1         DO   37        Z       20                      063310
     C           FEST,Z    IFEQ 'X'                                       063310
     C                     MOVEA'H'       FEBA,Z                          063310
     C                     END                                            063310
     C                     END                                            063310
     C*                                                                   063310
     C* CALCULATE THE FIELD DIFFERENTIAL FOR MARCH
     C           P4LYRI    IFEQ 'Y'
     C           X         ADD  1         X
     C           X         IFGT 7
     C           X         SUB  7         X
     C                     END
     C                     END
     C           'S'       IFEQ 'S'
     C                     MOVEAMARFLD    MAST,X
     C                     ELSE
     C                     MOVEAMAST,X    MARFLD
     C                     END
     C*                                                                   063310
     C** SET HOLIDAY INDICATOR TO 'H' IF ENTRY IS 'X'.                    063310
     C*                                                                   063310
     C                     MOVEA*BLANKS   MARA                            063310
     C           1         DO   37        Z       20                      063310
     C           MAST,Z    IFEQ 'X'                                       063310
     C                     MOVEA'H'       MARA,Z                          063310
     C                     END                                            063310
     C                     END                                            063310
     C*                                                                   063310
     C* IF IT IS NOT A LEAP YEAR THEN ENSURE THAT FEB 29 IS BLANK
     C           P4LYRI    IFEQ 'N'
     C                     MOVE *BLANK    WUFE29
     C                     END
     C                     END                             *FI
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy Member SD0161RISN - Holidays  *
     C*00/Copy Member SD0161R   Initialise Dtl New Rcd
     C/COPY WNCPYSRC,SD0161RISN
     C                     END                             *FI
     C                     END
      *..................................................
     C   99                GOTO BEEXIT
      * No error: Display and process details
     C                     EXSR CADSDA
      *
      *================================================================
     CSR         BEEXIT    ENDSR
      /EJECT
     CSR         BFVLKY    BEGSR
      *================================================================
      * Validate key fields
      *================================================================
     C           W0PMD     IFNE 'ADD'
      * Select existing record
     C                     EXSR VACKRL
     C                     END
      * Check relations
      * Check reference to Currency Codes
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * Check reference to Location Codes
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
      * USER: Validate key screen
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy Member SD0161RVKS - Holidays  *
     C*00/Copy Member SD0161R   Validate Key Screen
     C/COPY WNCPYSRC,SD0161RVKS
     C                     END                             *FI
      * Currency Code required
     C           #1CYCD    IFEQ *BLANK                     IF
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Location Code required
     C           #1LCCD    IFEQ *BLANK                     IF
     C                     SETON                     9932  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Year Number required
     C           #1YRNB    IFEQ *BLANK                     IF
     C                     SETON                     9933  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         BFEXIT    ENDSR
      /EJECT
     CSR         CADSDA    BEGSR
      *================================================================
      * Display and process detail screen
      *================================================================
      * Conduct detail screen conversation
      * - repeat until screen control flag is reset:
     C           W0TRN     DOWEQ'Y'
      * Display detail screen
     C                     EXSR CBEXFM
      * Process response to detail screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * Redisplay previous screen
     C   12                CAS            CCDSPV
      * HOME: Reset screen fields
     C   05                CAS            CCDSPV
      * Process detail screen input
     C                     CAS            CFPRSC
     C                     END
     C           W0TRN     IFEQ 'R'
     C           W0PMD     IFEQ 'ADD'
     C                     EXSR MAIZ#1
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         CBEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE HELP25    *IN25
      * PUTOVR unless conditioned fields change
     C                     SETON                         86*
     C           *IN89     IFNE CBIN89
     C           CSD041    OREQ 'Y'                                                           CSD031
     C                     SETOF                         86*
     C                     END
     C                     MOVE *IN89     CBIN89  1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y1SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT2
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1
      * Reset global error indicator
     C                     SETOF                         99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CBEXIT    ENDSR
      /EJECT
     CSR         CCDSPV    BEGSR
      *================================================================
      * Redisplay previous screen
      *================================================================
      * USER: Process key screen request
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy Member SD0161RPKR - Holidays  *
     C*00/Copy Member SD0161R   Process Key Screen Rqst
     C/COPY WNCPYSRC,SD0161RPKR
     C                     END                             *FI
     C                     MOVEL'USR0790' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C   05                MOVEL'R'       W0TRN
     C   12                MOVEL'K'       W0TRN
      *================================================================
     CSR         CCEXIT    ENDSR
      /EJECT
     CSR         CFPRSC    BEGSR
      *================================================================
      * Validate record
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * If delete is not pending....
      * Validate details
     C  N10                CAS            DCVLDL
     C                     END
      * QUIT if error:
     C   99                GOTO CFEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       CFEXIT
      * No error: update record
     C                     EXSR EBPR##
      *================================================================
     CSR         CFEXIT    ENDSR
      /EJECT
     CSR         DCVLDL    BEGSR
      *================================================================
      * Validate details
      *================================================================
      *                                                                                       CSD031
      ** Validate CSD031 Enhancements                                                         CSD031
      *                                                                                       CSD031
     C           CSD041    IFEQ 'Y'                                                           CSD031
     C           P2ANCD    ANDNE'E'                                                           CSD031
     C           *INU1     ANDEQ*ON                                                           CSD031
     C                     EXSR SR031                                                         CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      * USER: Validate detail screen fields
      * Enter pressed, display holidays for the next quarter
      * CASE: PAR.Action Code is Delete
     C           P2ANCD    IFEQ 'D'                        *IF
     C                     MOVEL'*ERROR*' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: *OTHERWISE
      * Validate Hol. Sts Fields - Holidays  *
     C                     MOVE *BLANKS   UDERR
     C                     MOVE *BLANKS   UMERR
     C                     MOVEA*BLANKS   TEMP
     C                     MOVEAJANUAR    TEMP
     C                     MOVE 'January' UMERR
     C* VALIDATE ALL THE HOLIDAY STATUS FIELDS FOR JANUARY
     C           1         DO   37        C       20
     C           JAST,C    IFNE 'X'
     C           JAST,C    ANDNE*BLANK
     C*
     C                     MOVEATEMP,C    UDERR
     C* SEND ERROR MESSAGE
     C                     CALL 'Y2SNMGC'
     C                     PARM ##PGM     ZAPGM
     C                     PARM           ZAPGRL
     C                     PARM 'USR0727' ZAMSID
     C                     PARM ZADFMF    ZAMSGF
     C                     PARM           UMSDA
     C                     PARM           ZAMSTP
     C                     SETON                     99
     C                     END
      *                                                                   165382
      ** Add checking for holiday change to working date.                 165382
      *                                                                   165382
     C           JAST,C    IFEQ ' '                                       165382
     C           JANA,C    ANDNE' '                                       165382
     C           P2ANCD    ANDEQ'A'                                       165382
     C                     MOVEATEMP,C    @DD     2                       165382
     C           WUDFF     IFEQ 'D'                                       165382
     C                     MOVE 01        @DDMM   40                      165382
     C                     MOVEL@DD       @DDMM                           165382
     C                     ELSE                                           165382
     C                     MOVE @DD       @DDMM                           165382
     C                     MOVEL01        @DDMM                           165382
     C                     END                                            165382
     C/COPY SDCPYSRC,SDHOLVLD2                                            165382
     C                     END                                            165382
     C*                                                                   063310
     C** VALIDATE IF DATE HAS BEEN AMENDED                                063310
     C*                                                                   063310
     C           JAST,C    IFEQ 'X'                                       063310
     C           JANA,C    ANDNE'H'                                       063310
     C           P2ANCD    ANDEQ'A'                                       063310
     C                     MOVEATEMP,C    @DD     2                       063310
     C           WUDFF     IFEQ 'D'                                       084942
     C                     MOVE 01        @DDMM   40                      063310
     C                     MOVEL@DD       @DDMM                           063310
     C                     ELSE                                           084942
     C                     MOVE @DD       @DDMM                           084942
     C                     MOVEL01        @DDMM                           084942
     C                     END                                            084942
     C/COPY SDCPYSRC,SDHOLVLD1                                            063310
     C                     END                                            063310
     C*                                                                   063310
     C                     END
     C* VALIDATE ALL THE HOLIDAY STATUS FIELDS FOR FEBRUARY
     C                     MOVE *BLANKS   UMERR
     C                     MOVE *BLANKS   UDERR
     C                     MOVEA*BLANKS   TEMP
     C                     MOVEAFEBRUA    TEMP
     C                     MOVE 'February'UMERR
     C           1         DO   37        C
     C           FEST,C    IFNE 'X'
     C           FEST,C    ANDNE*BLANK
     C*
     C                     MOVEATEMP,C    UDERR
     C* SEND ERROR MESSAGE
     C                     CALL 'Y2SNMGC'
     C                     PARM ##PGM     ZAPGM
     C                     PARM           ZAPGRL
     C                     PARM 'USR0727' ZAMSID
     C                     PARM ZADFMF    ZAMSGF
     C                     PARM           UMSDA
     C                     PARM           ZAMSTP
     C                     SETON                     99
     C                     END
      *                                                                   165382
      ** Add checking for holiday change to working date.                 165382
      *                                                                   165382
     C           FEST,C    IFEQ ' '                                       165382
     C           FEBA,C    ANDNE' '                                       165382
     C           P2ANCD    ANDEQ'A'                                       165382
     C                     MOVEATEMP,C    @DD     2                       165382
     C           WUDFF     IFEQ 'D'                                       165382
     C                     MOVE 02        @DDMM   40                      165382
     C                     MOVEL@DD       @DDMM                           165382
     C                     ELSE                                           165382
     C                     MOVE @DD       @DDMM                           165382
     C                     MOVEL02        @DDMM                           165382
     C                     END                                            165382
     C/COPY SDCPYSRC,SDHOLVLD2                                            165382
     C                     END                                            165382
     C*                                                                   063310
     C** VALIDATE IF DATE HAS BEEN AMENDED                                063310
     C*                                                                   063310
     C           FEST,C    IFEQ 'X'                                       063310
     C           FEBA,C    ANDNE'H'                                       063310
     C           P2ANCD    ANDEQ'A'                                       063310
     C                     MOVEATEMP,C    @DD     2                       063310
     C           WUDFF     IFEQ 'D'                        084942         084942
     C                     MOVE 02        @DDMM   40                      063310
     C                     MOVEL@DD       @DDMM                           063310
     C                     ELSE                                           084942
     C                     MOVE @DD       @DDMM                           084942
     C                     MOVEL02        @DDMM                           084942
     C                     END                                            084942
     C/COPY SDCPYSRC,SDHOLVLD1                                            063310
     C                     END                                            063310
     C*                                                                   063310
     C                     END
     C* VALIDATE ALL THE HOLIDAY STATUS FIELDS FOR MARCH
     C                     MOVE *BLANKS   UMERR
     C                     MOVE *BLANKS   UDERR
     C                     MOVEA*BLANKS   TEMP
     C                     MOVEAMARCH     TEMP
     C                     MOVE 'March'   UMERR
     C           1         DO   37        C
     C           MAST,C    IFNE 'X'
     C           MAST,C    ANDNE*BLANK
     C*
     C                     MOVEATEMP,C    UDERR
     C* SEND ERROR MESSAGE
     C                     CALL 'Y2SNMGC'
     C                     PARM ##PGM     ZAPGM
     C                     PARM           ZAPGRL
     C                     PARM 'USR0727' ZAMSID
     C                     PARM ZADFMF    ZAMSGF
     C                     PARM           UMSDA
     C                     PARM           ZAMSTP
     C                     SETON                     99
     C                     END
      *                                                                   165382
      ** Add checking for holiday change to working date.                 165382
      *                                                                   165382
     C           MAST,C    IFEQ ' '                                       165382
     C           MARA,C    ANDNE' '                                       165382
     C           P2ANCD    ANDEQ'A'                                       165382
     C                     MOVEATEMP,C    @DD     2                       165382
     C           WUDFF     IFEQ 'D'                                       165382
     C                     MOVE 03        @DDMM   40                      165382
     C                     MOVEL@DD       @DDMM                           165382
     C                     ELSE                                           165382
     C                     MOVE @DD       @DDMM                           165382
     C                     MOVEL03        @DDMM                           165382
     C                     END                                            165382
     C/COPY SDCPYSRC,SDHOLVLD2                                            165382
     C                     END                                            165382
     C*                                                                   063310
     C** VALIDATE IF DATE HAS BEEN AMENDED                                063310
     C*                                                                   063310
     C           MAST,C    IFEQ 'X'                                       063310
     C           MARA,C    ANDNE'H'                                       063310
     C           P2ANCD    ANDEQ'A'                                       063310
     C                     MOVEATEMP,C    @DD     2                       063310
     C           WUDFF     IFEQ 'D'                                       084942
     C                     MOVE 03        @DDMM   40                      063310
     C                     MOVEL@DD       @DDMM                           063310
     C                     ELSE                                           084942
     C                     MOVE @DD       @DDMM                           084942
     C                     MOVEL03        @DDMM                           084942
     C                     END                                            084942
     C/COPY SDCPYSRC,SDHOLVLD1                                            063310
     C                     END                                            063310
     C*                                                                   063310
     C                     END
     C** CHECK TO SEE IF ANY ERRORS HAVE OCCURRED I.E. INDICATOR
     C** 99 IS ON.
     C           *IN99     IFEQ '1'
     C                     MOVE 'Y'       WUERCD
     C                     ELSE
     C                     MOVE 'N'       WUERCD
     C                     END
     C                     END                             *FI
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy Member SD0161RVSF - Holidays  *
     C*00/Copy Member SD0161R   Validate Detail Screen
     C/COPY WNCPYSRC,SD0161RVSF
     C                     END                             *FI
      * CALC: Detail screen function fields
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy Member SD0161RSFF - Holidays  *
     C*00/Copy Member SD0161R   Calc Detail Function Flds
     C/COPY WNCPYSRC,SD0161RSFF
     C                     END                             *FI
      * USER: Validate detail screen relations
      * If there were no errors in the validation of the holiday status f
      * move all the values from the screen to the work fields
      * CASE: WRK.Err Code is Error Not Found
     C           WUERCD    IFEQ 'N'                        *IF
      * Set up existing Holidays - Holidays  *
     C* CALCULATE THE FIELD DIFFERENTIAL FOR JANUARY
     C           P3DYCD    ADD  1         X
     C           'F'       IFEQ 'S'
     C                     MOVEAJANFLD    JAST,X
     C                     ELSE
     C                     MOVEAJAST,X    JANFLD
     C                     END
     C*                                                                   063310
     C** SET HOLIDAY INDICATOR TO 'H' IF ENTRY IS 'X'.                    063310
     C*                                                                   063310
     C                     MOVEA*BLANKS   JANA                            063310
     C           1         DO   37        Z       20                      063310
     C           JAST,Z    IFEQ 'X'                                       063310
     C                     MOVEA'H'       JANA,Z                          063310
     C                     END                                            063310
     C                     END                                            063310
     C*                                                                   063310
     C* CALCULATE THE FIELD DIFFERENTIAL FOR FEBRUARY
     C           X         ADD  3         X
     C           X         IFGT 7
     C           X         SUB  7         X
     C                     END
     C           'F'       IFEQ 'S'
     C                     MOVEAFEBFLD    FEST,X
     C* IF IT IS NOT A LEAP YEAR HIDE THE VALUE FOR 29/2
     C           P4LYRI    IFEQ 'N'
     C           X         ADD  28        L       20
     C                     MOVE *BLANK    FEST,L
     C                     END
     C                     ELSE
     C                     MOVEAFEST,X    FEBFLD
     C                     END
     C*                                                                   063310
     C** SET HOLIDAY INDICATOR TO 'H' IF ENTRY IS 'X'.                    063310
     C*                                                                   063310
     C                     MOVEA*BLANKS   FEBA                            063310
     C           1         DO   37        Z       20                      063310
     C           FEST,Z    IFEQ 'X'                                       063310
     C                     MOVEA'H'       FEBA,Z                          063310
     C                     END                                            063310
     C                     END                                            063310
     C*                                                                   063310
     C* CALCULATE THE FIELD DIFFERENTIAL FOR MARCH
     C           P4LYRI    IFEQ 'Y'
     C           X         ADD  1         X
     C           X         IFGT 7
     C           X         SUB  7         X
     C                     END
     C                     END
     C           'F'       IFEQ 'S'
     C                     MOVEAMARFLD    MAST,X
     C                     ELSE
     C                     MOVEAMAST,X    MARFLD
     C                     END
     C*                                                                   063310
     C** SET HOLIDAY INDICATOR TO 'H' IF ENTRY IS 'X'.                    063310
     C*                                                                   063310
     C                     MOVEA*BLANKS   MARA                            063310
     C           1         DO   37        Z       20                      063310
     C           MAST,Z    IFEQ 'X'                                       063310
     C                     MOVEA'H'       MARA,Z                          063310
     C                     END                                            063310
     C                     END                                            063310
     C*                                                                   063310
     C* IF IT IS NOT A LEAP YEAR THEN ENSURE THAT FEB 29 IS BLANK
     C           P4LYRI    IFEQ 'N'
     C                     MOVE *BLANK    WUFE29
     C                     END
      * CASE: PAR.Action Code is Insert
     C           P2ANCD    IFEQ 'I'                        *IF
      * Set up 1st Jan - Holidays  *
     C                     MOVE P1YRNB    WUWSDT
     C                     MOVEL'0101'    WUWSDT
      * Check Screen Date - Rundate  *
     C                     CALL 'ZDATE1'               90  Check Screen Da
     C           W0RTN     PARM W0RTN     WQ0006  7        *Return code
     C           WUWSDT    PARM WUWSDT    WQ0007  60       Work Screen Dat
     C           WUDFF     PARM WUDFF     WQ0008  1        Date format fla
     C           WUWFDT    PARM *ZERO     WQ0009  50       Work File Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZDATE1'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVE WUWFDT    WUJDNB           1st January Day
      * Set up 31st Dec - Holidays  *
     C                     MOVE P1YRNB    WUWSDT
     C           WUDFF     IFEQ 'D'
     C                     MOVEL'3112'    WUWSDT
     C                     ELSE
     C                     MOVEL'1231'    WUWSDT
     C                     END
      * Check Screen Date - Rundate  *
     C                     CALL 'ZDATE1'               90  Check Screen Da
     C           W0RTN     PARM W0RTN     WQ0010  7        *Return code
     C           WUWSDT    PARM WUWSDT    WQ0011  60       Work Screen Dat
     C           WUDFF     PARM WUDFF     WQ0012  1        Date format fla
     C           WUWFDT    PARM *ZERO     WQ0013  50       Work File Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZDATE1'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVE WUWFDT    WUDDNB           31st December D
     C                     MOVEL'I'       WUTYLC           Type of Last Ch
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'A'       WUTYLC           Type of Last Ch
     C                     END                             *FI
     C                     END                             *FI
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy Member SD0161RVSR - Holidays  *
     C*00/Copy Member SD0161R   Validate Screen Relns
     C/COPY WNCPYSRC,SD0161RVSR
     C                     END                             *FI
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         EBPR##    BEGSR
      *================================================================
      * Process record:
      *================================================================
      * Process delete request
     C   10                CAS            EDDLRQ
      * Process add request
     C           W0PMD     CASEQ'ADD'     ECADRQ
      * Process update request
     C           W0PMD     CASNE'ADD'     EECHRQ
     C                     END
     C           W0RTN     IFNE *BLANK
      * ROLLBACK required
     C                     MOVEL'Y2U0018' P0RTN
     C                     EXSR ZYEXPG
     C                     END
     C           W0RTN     IFEQ *BLANK
      * USER: Process command keys
      * CASE: PAR.Action Code is Delete
     C           P2ANCD    IFEQ 'D'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.*CMD key is *Delete
     C           *IN10     IFEQ '1'                        *IF
      * Clear the meaaage queue to remove the 'record deleted' message
      * Clear Message Queue - Holidays  *
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGM  10
     C                     PARM '*SAME'   ZAPGRL  5
      * Send message 'Function key not allowed'
     C                     MOVEL'USR0533' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO EBEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy Member SD0161RPCK - Holidays  *
     C*00/Copy Member SD0161R   Process Command Keys
     C/COPY WNCPYSRC,SD0161RPCK
     C                     END                             *FI
     C           W0PMD     IFEQ 'ADD'
      * Exit after successful add
     C                     MOVEL'N'       W0RPT
     C                     END
      * Restart program for next record
     C                     MOVEL'N'       W0TRN
     C                     END
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         ECADRQ    BEGSR
      *================================================================
      * Process add request
      *================================================================
      * USER: Create DBF record
      * Create Holidays - Holidays  *
     C                     EXSR SDCRRC
     C           W0RTN     IFEQ *BLANK
      * Send message '*Record added'
     C                     MOVEL'Y2U0011' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
      *================================================================
     CSR         ECEXIT    ENDSR
      /EJECT
     CSR         EDDLRQ    BEGSR
      *================================================================
      * Process delete request
      *================================================================
      * USER: Delete DBF record
      * Delete Holidays - Holidays  *
     C                     EXSR SFDLRC
     C           W0RTN     IFEQ *BLANK
      * Send message '*Record deleted'
     C                     MOVEL'Y2U0013' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
      *================================================================
     CSR         EDEXIT    ENDSR
      /EJECT
     CSR         EECHRQ    BEGSR
      *================================================================
      * Process update request
      *================================================================
      * USER: Change DBF record
      * Change Holidays - Holidays  *
     C                     EXSR SHCHRC
     C           W0RTN     IFNE *BLANK
      * Data update error
      * Reset screen fields if changed record
     C           W0RTN     CASEQ'Y2U0007' MBFL#1
     C                     END
     C                     ELSE
      * Send message '*Record changed'
     C                     MOVEL'Y2U0012' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
      *================================================================
     CSR         EEEXIT    ENDSR
      /EJECT
     CSR         FACKPM    BEGSR
      *================================================================
      * Check passed parameters
      *================================================================
      * Is full key present?
     C           P1CYCD    IFEQ *BLANK                     Currency Code
     C           P1LCCD    OREQ *BLANK                     Location Code
     C           P1YRNB    OREQ *BLANK                     Year Number
      * Not every key field passed - loop program
     C                     MOVEL'Y'       W0RPT   1
     C                     ELSE
      * Full key passed, so single shot program
     C                     MOVEL'N'       W0RPT
     C                     END
      *================================================================
     CSR         FAEXIT    ENDSR
      /EJECT
     CSR         GADSAK    BEGSR
      *================================================================
      * Set key screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSAD    BEGSR
      *================================================================
      * Set detail screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      * Protect key fields on detail screen
     C                     SETON                     88    *
     C                     MOVEL'0'       *IN79
     C           #DJ01N    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           #DJ36N    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           #DF01N    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL'0'       *IN76
     C           #DF29N    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
     C                     MOVEL'0'       *IN75
     C           #DJ02N    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN75
     C                     END                             *FI
     C                     MOVEL'0'       *IN74
     C           #DJ37N    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN74
     C                     END                             *FI
     C                     MOVEL'0'       *IN73
     C           #DF02N    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN73
     C                     END                             *FI
     C                     MOVEL'0'       *IN72
     C           #DF30N    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN72
     C                     END                             *FI
     C                     MOVEL'0'       *IN71
     C           #DJ03N    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN71
     C                     END                             *FI
     C                     MOVEL'0'       *IN70
     C           #DF03N    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN70
     C                     END                             *FI
     C                     MOVEL'0'       *IN69
     C           #DF31N    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN69
     C                     END                             *FI
     C                     MOVEL'0'       *IN68
     C           #DJ04N    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN68
     C                     END                             *FI
     C                     MOVEL'0'       *IN67
     C           #DJ32N    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN67
     C                     END                             *FI
     C                     MOVEL'0'       *IN66
     C           #DF04N    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN66
     C                     END                             *FI
     C                     MOVEL'0'       *IN65
     C           #DF32N    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN65
     C                     END                             *FI
     C                     MOVEL'0'       *IN64
     C           #DJ05N    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN64
     C                     END                             *FI
     C                     MOVEL'0'       *IN63
     C           #DJ33N    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN63
     C                     END                             *FI
     C                     MOVEL'0'       *IN62
     C           #DF05N    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN62
     C                     END                             *FI
     C                     MOVEL'0'       *IN61
     C           #DF33N    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN61
     C                     END                             *FI
     C                     MOVEL'0'       *IN60
     C           #DJ06N    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN60
     C                     END                             *FI
     C                     MOVEL'0'       *IN59
     C           #DJ34N    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN59
     C                     END                             *FI
     C                     MOVEL'0'       *IN58
     C           #DF06N    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN58
     C                     END                             *FI
     C                     MOVEL'0'       *IN57
     C           #DF34N    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN57
     C                     END                             *FI
     C                     MOVEL'0'       *IN56
     C           #DJ35N    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN56
     C                     END                             *FI
     C                     MOVEL'0'       *IN55
     C           #DF35N    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN55
     C                     END                             *FI
     C                     MOVEL'0'       *IN54
     C           #DM01N    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN54
     C                     END                             *FI
     C                     MOVEL'0'       *IN53
     C           #DM36N    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN53
     C                     END                             *FI
     C                     MOVEL'0'       *IN52
     C           #DM02N    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN52
     C                     END                             *FI
     C                     MOVEL'0'       *IN51
     C           #DM37N    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN51
     C                     END                             *FI
     C                     MOVEL'0'       *IN50
     C           #DM03N    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN50
     C                     END                             *FI
     C                     MOVEL'0'       *IN49
     C           #DM04N    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN49
     C                     END                             *FI
     C                     MOVEL'0'       *IN48
     C           #DM32N    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN48
     C                     END                             *FI
     C                     MOVEL'0'       *IN47
     C           #DM05N    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN47
     C                     END                             *FI
     C                     MOVEL'0'       *IN46
     C           #DM33N    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN46
     C                     END                             *FI
     C                     MOVEL'0'       *IN45
     C           #DM06N    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN45
     C                     END                             *FI
     C                     MOVEL'0'       *IN44
     C           #DM34N    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN44
     C                     END                             *FI
     C                     MOVEL'0'       *IN43
     C           #DM35N    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN43
     C                     END                             *FI
      * Enable key screen
     C                     SETON                     87    *
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise record - except for key fields and "neither" paramete
      *================================================================
     C                     Z-ADD*ZERO     #1LCD            Last Change Dat
     C                     MOVEL*BLANK    #1TYLC           Type of Last Ch
     C                     MOVEL*BLANK    #DLCDF           Location Code -
     C                     MOVEL*BLANK    #DJ01N           January 01 Nume
     C                     MOVEL*BLANK    #DJ01S           January 01 Stat
     C                     MOVEL*BLANK    #DJ08N           January 08 Nume
     C                     MOVEL*BLANK    #DJ08S           January 08 Stat
     C                     MOVEL*BLANK    #DJ15N           January 15 Nume
     C                     MOVEL*BLANK    #DJ15S           January 15 Stat
     C                     MOVEL*BLANK    #DJ22N           January 22 Nume
     C                     MOVEL*BLANK    #DJ22S           January 22 Stat
     C                     MOVEL*BLANK    #DJ29N           January 29 Nume
     C                     MOVEL*BLANK    #DJ29S           January 29 Stat
     C                     MOVEL*BLANK    #DJ36N           January 36 Nume
     C                     MOVEL*BLANK    #DJ36S           January 36 Stat
     C                     MOVEL*BLANK    #DF01N           February 01 Num
     C                     MOVEL*BLANK    #DF01S           February 01 Sta
     C                     MOVEL*BLANK    #DF08N           February 08 Num
     C                     MOVEL*BLANK    #DF08S           February 08 Sta
     C                     MOVEL*BLANK    #DF15N           February 15 Num
     C                     MOVEL*BLANK    #DF15S           February 15 Sta
     C                     MOVEL*BLANK    #DF22N           February 22 Num
     C                     MOVEL*BLANK    #DF22S           February 22 Sta
     C                     MOVEL*BLANK    #DF29N           February 29 Num
     C                     MOVEL*BLANK    #DF29S           February 29 Sta
     C                     MOVEL*BLANK    #DJ02N           January 02 Nume
     C                     MOVEL*BLANK    #DJ02S           January 02 Stat
     C                     MOVEL*BLANK    #DJ09N           January 09 Nume
     C                     MOVEL*BLANK    #DJ09S           January 09 Stat
     C                     MOVEL*BLANK    #DJ16N           January 16 Nume
     C                     MOVEL*BLANK    #DJ16S           January 16 Stat
     C                     MOVEL*BLANK    #DJ23N           January 23 Nume
     C                     MOVEL*BLANK    #DJ23S           January 23 Stat
     C                     MOVEL*BLANK    #DJ30N           January 30 Nume
     C                     MOVEL*BLANK    #DJ30S           January 30 Stat
     C                     MOVEL*BLANK    #DJ37N           January 37 Nume
     C                     MOVEL*BLANK    #DJ37S           January 37 Stat
     C                     MOVEL*BLANK    #DF02N           February 02 Num
     C                     MOVEL*BLANK    #DF02S           February 02 Sta
     C                     MOVEL*BLANK    #DF09N           February 09 Num
     C                     MOVEL*BLANK    #DF09S           February 09 Sta
     C                     MOVEL*BLANK    #DF16N           February 16 Num
     C                     MOVEL*BLANK    #DF16S           February 16 Sta
     C                     MOVEL*BLANK    #DF23N           February 23 Num
     C                     MOVEL*BLANK    #DF23S           February 23 Sta
     C                     MOVEL*BLANK    #DF30N           February 30 Num
     C                     MOVEL*BLANK    #DF30S           February 30 Sta
     C                     MOVEL*BLANK    #DJ03N           January 03 Nume
     C                     MOVEL*BLANK    #DJ03S           January 03 Stat
     C                     MOVEL*BLANK    #DJ10N           January 10 Nume
     C                     MOVEL*BLANK    #DJ10S           January 10 Stat
     C                     MOVEL*BLANK    #DJ17N           January 17 Nume
     C                     MOVEL*BLANK    #DJ17S           January 17 Stat
     C                     MOVEL*BLANK    #DJ24N           January 24 Nume
     C                     MOVEL*BLANK    #DJ24S           January 24 Stat
     C                     MOVEL*BLANK    #DJ31N           January 31 Nume
     C                     MOVEL*BLANK    #DJ31S           January 31 Stat
     C                     MOVEL*BLANK    #DF03N           February 03 Num
     C                     MOVEL*BLANK    #DF03S           February 03 Sta
     C                     MOVEL*BLANK    #DF10N           February 10 Num
     C                     MOVEL*BLANK    #DF10S           February 10 Sta
     C                     MOVEL*BLANK    #DF17N           February 17 Num
     C                     MOVEL*BLANK    #DF17S           February 17 Sta
     C                     MOVEL*BLANK    #DF24N           February 24 Num
     C                     MOVEL*BLANK    #DF24S           February 24 Sta
     C                     MOVEL*BLANK    #DF31N           February 31 Num
     C                     MOVEL*BLANK    #DF31S           February 31 Sta
     C                     MOVEL*BLANK    #DJ04N           January 04 Nume
     C                     MOVEL*BLANK    #DJ04S           January 04 Stat
     C                     MOVEL*BLANK    #DJ11N           January 11 Nume
     C                     MOVEL*BLANK    #DJ11S           January 11 Stat
     C                     MOVEL*BLANK    #DJ18N           January 18 Nume
     C                     MOVEL*BLANK    #DJ18S           January 18 Stat
     C                     MOVEL*BLANK    #DJ25N           January 25 Nume
     C                     MOVEL*BLANK    #DJ25S           January 25 Stat
     C                     MOVEL*BLANK    #DJ32N           January 32 Nume
     C                     MOVEL*BLANK    #DJ32S           January 32 Stat
     C                     MOVEL*BLANK    #DF04N           February 04 Num
     C                     MOVEL*BLANK    #DF04S           February 04 Sta
     C                     MOVEL*BLANK    #DF11N           February 11 Num
     C                     MOVEL*BLANK    #DF11S           February 11 Sta
     C                     MOVEL*BLANK    #DF18N           February 18 Num
     C                     MOVEL*BLANK    #DF18S           February 18 Sta
     C                     MOVEL*BLANK    #DF25N           February 25 Num
     C                     MOVEL*BLANK    #DF25S           February 25 Sta
     C                     MOVEL*BLANK    #DF32N           February 32 Num
     C                     MOVEL*BLANK    #DF32S           February 32 Sta
     C                     MOVEL*BLANK    #DJ05N           January 05 Nume
     C                     MOVEL*BLANK    #DJ05S           January 05 Stat
     C                     MOVEL*BLANK    #DJ12N           January 12 Nume
     C                     MOVEL*BLANK    #DJ12S           January 12 Stat
     C                     MOVEL*BLANK    #DJ19N           January 19 Nume
     C                     MOVEL*BLANK    #DJ19S           January 19 Stat
     C                     MOVEL*BLANK    #DJ26N           January 26 Nume
     C                     MOVEL*BLANK    #DJ26S           January 26 Stat
     C                     MOVEL*BLANK    #DJ33N           January 33 Nume
     C                     MOVEL*BLANK    #DJ33S           January 33 Stat
     C                     MOVEL*BLANK    #DF05N           February 05 Num
     C                     MOVEL*BLANK    #DF05S           February 05 Sta
     C                     MOVEL*BLANK    #DF12N           February 12 Num
     C                     MOVEL*BLANK    #DF12S           February 12 Sta
     C                     MOVEL*BLANK    #DF19N           February 19 Num
     C                     MOVEL*BLANK    #DF19S           February 19 Sta
     C                     MOVEL*BLANK    #DF26N           February 26 Num
     C                     MOVEL*BLANK    #DF26S           February 26 Sta
     C                     MOVEL*BLANK    #DF33N           February 33 Num
     C                     MOVEL*BLANK    #DF33S           February 33 Sta
     C                     MOVEL*BLANK    #DJ06N           January 06 Nume
     C                     MOVEL*BLANK    #DJ06S           January 06 Stat
     C                     MOVEL*BLANK    #DJ13N           January 13 Nume
     C                     MOVEL*BLANK    #DJ13S           January 13 Stat
     C                     MOVEL*BLANK    #DJ20N           January 20 Nume
     C                     MOVEL*BLANK    #DJ20S           January 20 Stat
     C                     MOVEL*BLANK    #DJ27N           January 27 Nume
     C                     MOVEL*BLANK    #DJ27S           January 27 Stat
     C                     MOVEL*BLANK    #DJ34N           January 34 Nume
     C                     MOVEL*BLANK    #DJ34S           January 34 Stat
     C                     MOVEL*BLANK    #DF06N           February 06 Num
     C                     MOVEL*BLANK    #DF06S           February 06 Sta
     C                     MOVEL*BLANK    #DF13N           February 13 Num
     C                     MOVEL*BLANK    #DF13S           February 13 Sta
     C                     MOVEL*BLANK    #DF20N           February 20 Num
     C                     MOVEL*BLANK    #DF20S           February 20 Sta
     C                     MOVEL*BLANK    #DF27N           February 27 Num
     C                     MOVEL*BLANK    #DF27S           February 27 Sta
     C                     MOVEL*BLANK    #DF34N           February 34 Num
     C                     MOVEL*BLANK    #DF34S           February 34 Sta
     C                     MOVEL*BLANK    #DJ07N           January 07 Nume
     C                     MOVEL*BLANK    #DJ07S           January 07 Stat
     C                     MOVEL*BLANK    #DJ14N           January 14 Nume
     C                     MOVEL*BLANK    #DJ14S           January 14 Stat
     C                     MOVEL*BLANK    #DJ21N           January 21 Nume
     C                     MOVEL*BLANK    #DJ21S           January 21 Stat
     C                     MOVEL*BLANK    #DJ28N           January 28 Nume
     C                     MOVEL*BLANK    #DJ28S           January 28 Stat
     C                     MOVEL*BLANK    #DJ35N           January 35 Nume
     C                     MOVEL*BLANK    #DJ35S           January 35 Stat
     C                     MOVEL*BLANK    #DF07N           February 07 Num
     C                     MOVEL*BLANK    #DF07S           February 07 Sta
     C                     MOVEL*BLANK    #DF14N           February 14 Num
     C                     MOVEL*BLANK    #DF14S           February 14 Sta
     C                     MOVEL*BLANK    #DF21N           February 21 Num
     C                     MOVEL*BLANK    #DF21S           February 21 Sta
     C                     MOVEL*BLANK    #DF28N           February 28 Num
     C                     MOVEL*BLANK    #DF28S           February 28 Sta
     C                     MOVEL*BLANK    #DF35N           February 35 Num
     C                     MOVEL*BLANK    #DF35S           February 35 Sta
     C                     MOVEL*BLANK    #DM01N           March 01 Numeri
     C                     MOVEL*BLANK    #DM01S           March 01 Status
     C                     MOVEL*BLANK    #DM08N           March 08 Numeri
     C                     MOVEL*BLANK    #DM08S           March 08 Status
     C                     MOVEL*BLANK    #DM15N           March 15 Numeri
     C                     MOVEL*BLANK    #DM15S           March 15 Status
     C                     MOVEL*BLANK    #DM22N           March 22 Numeri
     C                     MOVEL*BLANK    #DM22S           March 22 Status
     C                     MOVEL*BLANK    #DM29N           March 29 Numeri
     C                     MOVEL*BLANK    #DM29S           March 29 Status
     C                     MOVEL*BLANK    #DM36N           March 36 Numeri
     C                     MOVEL*BLANK    #DM36S           March 36 Status
     C                     MOVEL*BLANK    #DM02N           March 02 Numeri
     C                     MOVEL*BLANK    #DM02S           March 02 Status
     C                     MOVEL*BLANK    #DM09N           March 09 Numeri
     C                     MOVEL*BLANK    #DM09S           March 09 Status
     C                     MOVEL*BLANK    #DM16N           March 16 Numeri
     C                     MOVEL*BLANK    #DM16S           March 16 Status
     C                     MOVEL*BLANK    #DM23N           March 23 Numeri
     C                     MOVEL*BLANK    #DM23S           March 23 Status
     C                     MOVEL*BLANK    #DM30N           March 30 Numeri
     C                     MOVEL*BLANK    #DM30S           March 30 Status
     C                     MOVEL*BLANK    #DM37N           March 37 Numeri
     C                     MOVEL*BLANK    #DM37S           March 37 Status
     C                     MOVEL*BLANK    #DM03N           March 03 Numeri
     C                     MOVEL*BLANK    #DM03S           March 03 Status
     C                     MOVEL*BLANK    #DM10N           March 10 Numeri
     C                     MOVEL*BLANK    #DM10S           March 10 Status
     C                     MOVEL*BLANK    #DM17N           March 17 Numeri
     C                     MOVEL*BLANK    #DM17S           March 17 Status
     C                     MOVEL*BLANK    #DM24N           March 24 Numeri
     C                     MOVEL*BLANK    #DM24S           March 24 Status
     C                     MOVEL*BLANK    #DM31N           March 31 Numeri
     C                     MOVEL*BLANK    #DM31S           March 31 Status
     C                     MOVEL*BLANK    #DM04N           March 04 Numeri
     C                     MOVEL*BLANK    #DM04S           March 04 Status
     C                     MOVEL*BLANK    #DM11N           March 11 Numeri
     C                     MOVEL*BLANK    #DM11S           March 11 Status
     C                     MOVEL*BLANK    #DM18N           March 18 Numeri
     C                     MOVEL*BLANK    #DM18S           March 18 Status
     C                     MOVEL*BLANK    #DM25N           March 25 Numeri
     C                     MOVEL*BLANK    #DM25S           March 25 Status
     C                     MOVEL*BLANK    #DM32N           March 32 Numeri
     C                     MOVEL*BLANK    #DM32S           March 32 Status
     C                     MOVEL*BLANK    #DM05N           March 05 Numeri
     C                     MOVEL*BLANK    #DM05S           March 05 Status
     C                     MOVEL*BLANK    #DM12N           March 12 Numeri
     C                     MOVEL*BLANK    #DM12S           March 12 Status
     C                     MOVEL*BLANK    #DM19N           March 19 Numeri
     C                     MOVEL*BLANK    #DM19S           March 19 Status
     C                     MOVEL*BLANK    #DM26N           March 26 Numeri
     C                     MOVEL*BLANK    #DM26S           March 26 Status
     C                     MOVEL*BLANK    #DM33N           March 33 Numeri
     C                     MOVEL*BLANK    #DM33S           March 33 Status
     C                     MOVEL*BLANK    #DM06N           March 06 Numeri
     C                     MOVEL*BLANK    #DM06S           March 06 Status
     C                     MOVEL*BLANK    #DM13N           March 13 Numeri
     C                     MOVEL*BLANK    #DM13S           March 13 Status
     C                     MOVEL*BLANK    #DM20N           March 20 Numeri
     C                     MOVEL*BLANK    #DM20S           March 20 Status
     C                     MOVEL*BLANK    #DM27N           March 27 Numeri
     C                     MOVEL*BLANK    #DM27S           March 27 Status
     C                     MOVEL*BLANK    #DM34N           March 34 Numeri
     C                     MOVEL*BLANK    #DM34S           March 34 Status
     C                     MOVEL*BLANK    #DM07N           March 07 Numeri
     C                     MOVEL*BLANK    #DM07S           March 07 Status
     C                     MOVEL*BLANK    #DM14N           March 14 Numeri
     C                     MOVEL*BLANK    #DM14S           March 14 Status
     C                     MOVEL*BLANK    #DM21N           March 21 Numeri
     C                     MOVEL*BLANK    #DM21S           March 21 Status
     C                     MOVEL*BLANK    #DM28N           March 28 Numeri
     C                     MOVEL*BLANK    #DM28S           March 28 Status
     C                     MOVEL*BLANK    #DM35N           March 35 Numeri
     C                     MOVEL*BLANK    #DM35S           March 35 Status
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @HOLPH0 fields to screen
      *================================================================
     C                     MOVELDGLCCD    #1LCCD           Location Code
     C                     Z-ADDDGLCD     #1LCD            Last Change Dat
     C                     MOVELDGTYLC    #1TYLC           Type of Last Ch
     C                     MOVELDGCYCD    #1CYCD           Currency Code
     C                     MOVELDGYRNB    #1YRNB           Year Number
      * Hold existing record image
     C                     MOVEL@1DBRC    #1DBRC
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MDIZ#K    BEGSR
      *================================================================
      * Initialize key screen
      *================================================================
     C                     MOVELP1CYCD    #1CYCD           Currency Code
     C                     MOVELP1LCCD    #1LCCD           Location Code
     C                     MOVELP1YRNB    #1YRNB           Year Number
     C                     MOVE @PACTZ    #1ACTZ           Accept to Zone                     CSD031
     C           @PEFDT    IFEQ '000000'                                                      CSD031
     C                     MOVE *BLANKS   #1EFDT                                              CSD031
     C                     ELSE                                                               CSD031
     C                     MOVE @PEFDT    #1EFDT           Effective Date                     CSD031
     C                     ENDIF                                                              CSD031
      * USER: Initialize key screen
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy Member SD0161RIKS - Holidays  *
     C*00/Copy Member SD0161R   Initialise Key Screen
     C/COPY WNCPYSRC,SD0161RIKS
     C                     END                             *FI
      *================================================================
     CSR         MDEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Get Holidays for 1st Q - Holidays  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WACYCD    WQSA01           Currency Code
     C           *LIKE     DEFN WALCCD    WQSA02           Location Code
     C           *LIKE     DEFN WAYRNB    WQSA03           Year Number
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Currency Code
     C                     KFLD           WQSA02           Location Code
     C                     KFLD           WQSA03           Year Number
      * Move fields to key list
     C                     MOVELDGCYCD    WQSA01           Currency Code
     C                     MOVELDGLCCD    WQSA02           Location Code
     C                     MOVELDGYRNB    WQSA03           Year Number
      *                                                                                       CSD031
      ** Use appropriate files                                                                CSD031
      *                                                                                       CSD031
     C           CSD041    IFEQ 'Y'                                                           CSD031
     C                     SELEC                                                              CSD031
      *                                                                                       CSD031
      ** Global                                                                               CSD031
     C           W@MODE    WHEQ 'G'                                                           CSD031
     C           KRSSA     SETLLGPHOLID2                                                      CSD031
     C           KRSSA     READEGPHOLID2                 90                                   CSD031
      *                                                                                       CSD031
      ** Zonal / Accept Mode                                                                  CSD031
     C           W@MODE    WHEQ 'A'                                                           CSD031
     C           KRSSA     SETLLSDAHDYD8                                                      CSD031
     C           KRSSA     READESDAHDYD8                 90                                   CSD031
      *                                                                                       CSD031
      ** Zonal / Change Mode                                                                  CSD031
     C                     OTHER                                                              CSD031
     C           KRSSA     SETLL@HOLPH8                                                       CSD031
     C           KRSSA     READE@HOLPH8                  90                                   CSD031
     C                     ENDSL                                                              CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
      *                                                                                       CSD031
     C           KRSSA     SETLL@HOLPH8                    *
     C           KRSSA     READE@HOLPH8                  90*
     C                     ENDIF                                                              CSD031
     C           *IN90     IFEQ '1'
      *                                                                                       CSD012
      * If CSD012 is ON and Holidays is ON and Insert no error                                CSD012
      * as will not be on this file.                                                          CSD012
     C           CSD012    IFEQ 'Y'                                                           CSD012
     C           SVAL11    ANDEQ'Y'                                                           CSD012
     C           P2ANCD    ANDEQ'I'                                                           CSD012
     C                     ELSE                                                               CSD012
      * Data record not found
     C                     MOVEL'USR0657' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SAEXIT
     C                     ENDIF                                                              CSD012
     C                     END
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWAJA01    WUJA01           January 1
     C                     MOVELWAJA02    WUJA02           January 2
     C                     MOVELWAJA03    WUJA03           January 3
     C                     MOVELWAJA04    WUJA04           January 4
     C                     MOVELWAJA05    WUJA05           January 5
     C                     MOVELWAJA06    WUJA06           January 6
     C                     MOVELWAJA07    WUJA07           January 7
     C                     MOVELWAJA08    WUJA08           January 8
     C                     MOVELWAJA09    WUJA09           January 9
     C                     MOVELWAJA10    WUJA10           January 10
     C                     MOVELWAJA11    WUJA11           January 11
     C                     MOVELWAJA12    WUJA12           January 12
     C                     MOVELWAJA13    WUJA13           January 13
     C                     MOVELWAJA14    WUJA14           January 14
     C                     MOVELWAJA15    WUJA15           January 15
     C                     MOVELWAJA16    WUJA16           January 16
     C                     MOVELWAJA17    WUJA17           January 17
     C                     MOVELWAJA18    WUJA18           January 18
     C                     MOVELWAJA19    WUJA19           January 19
     C                     MOVELWAJA20    WUJA20           January 20
     C                     MOVELWAJA21    WUJA21           January 21
     C                     MOVELWAJA22    WUJA22           January 22
     C                     MOVELWAJA23    WUJA23           January 23
     C                     MOVELWAJA24    WUJA24           January 24
     C                     MOVELWAJA25    WUJA25           January 25
     C                     MOVELWAJA26    WUJA26           January 26
     C                     MOVELWAJA27    WUJA27           January 27
     C                     MOVELWAJA28    WUJA28           January 28
     C                     MOVELWAJA29    WUJA29           January 29
     C                     MOVELWAJA30    WUJA30           January 30
     C                     MOVELWAJA31    WUJA31           January 31
     C                     MOVELWAFE01    WUFE01           February 1
     C                     MOVELWAFE02    WUFE02           February 2
     C                     MOVELWAFE03    WUFE03           February 3
     C                     MOVELWAFE04    WUFE04           February 4
     C                     MOVELWAFE05    WUFE05           February 5
     C                     MOVELWAFE06    WUFE06           February 6
     C                     MOVELWAFE07    WUFE07           February 7
     C                     MOVELWAFE08    WUFE08           February 8
     C                     MOVELWAFE09    WUFE09           February 9
     C                     MOVELWAFE10    WUFE10           February 10
     C                     MOVELWAFE11    WUFE11           February 11
     C                     MOVELWAFE12    WUFE12           February 12
     C                     MOVELWAFE13    WUFE13           February 13
     C                     MOVELWAFE14    WUFE14           February 14
     C                     MOVELWAFE15    WUFE15           February 15
     C                     MOVELWAFE16    WUFE16           February 16
     C                     MOVELWAFE17    WUFE17           February 17
     C                     MOVELWAFE18    WUFE18           February 18
     C                     MOVELWAFE19    WUFE19           February 19
     C                     MOVELWAFE20    WUFE20           February 20
     C                     MOVELWAFE21    WUFE21           February 21
     C                     MOVELWAFE22    WUFE22           February 22
     C                     MOVELWAFE23    WUFE23           February 23
     C                     MOVELWAFE24    WUFE24           February 24
     C                     MOVELWAFE25    WUFE25           February 25
     C                     MOVELWAFE26    WUFE26           February 26
     C                     MOVELWAFE27    WUFE27           February 27
     C                     MOVELWAFE28    WUFE28           February 28
     C                     MOVELWAFE29    WUFE29           February 29
     C                     MOVELWAMA01    WUMA01           March 1
     C                     MOVELWAMA02    WUMA02           March 2
     C                     MOVELWAMA03    WUMA03           March 3
     C                     MOVELWAMA04    WUMA04           March 4
     C                     MOVELWAMA05    WUMA05           March 5
     C                     MOVELWAMA06    WUMA06           March 6
     C                     MOVELWAMA07    WUMA07           March 7
     C                     MOVELWAMA08    WUMA08           March 8
     C                     MOVELWAMA09    WUMA09           March 9
     C                     MOVELWAMA10    WUMA10           March 10
     C                     MOVELWAMA11    WUMA11           March 11
     C                     MOVELWAMA12    WUMA12           March 12
     C                     MOVELWAMA13    WUMA13           March 13
     C                     MOVELWAMA14    WUMA14           March 14
     C                     MOVELWAMA15    WUMA15           March 15
     C                     MOVELWAMA16    WUMA16           March 16
     C                     MOVELWAMA17    WUMA17           March 17
     C                     MOVELWAMA18    WUMA18           March 18
     C                     MOVELWAMA19    WUMA19           March 19
     C                     MOVELWAMA20    WUMA20           March 20
     C                     MOVELWAMA21    WUMA21           March 21
     C                     MOVELWAMA22    WUMA22           March 22
     C                     MOVELWAMA23    WUMA23           March 23
     C                     MOVELWAMA24    WUMA24           March 24
     C                     MOVELWAMA25    WUMA25           March 25
     C                     MOVELWAMA26    WUMA26           March 26
     C                     MOVELWAMA27    WUMA27           March 27
     C                     MOVELWAMA28    WUMA28           March 28
     C                     MOVELWAMA29    WUMA29           March 29
     C                     MOVELWAMA30    WUMA30           March 30
     C                     MOVELWAMA31    WUMA31           March 31
      *                                                                                       CSD031
      ** Use appropriate files                                                                CSD031
      *                                                                                       CSD031
     C           CSD041    IFEQ 'Y'                                                           CSD031
     C                     SELEC                                                              CSD031
      *                                                                                       CSD031
      ** Global                                                                               CSD031
     C           W@MODE    WHEQ 'G'                                                           CSD031
     C           KRSSA     READEGPHOLID2                 90                                   CSD031
      *                                                                                       CSD031
      ** Zonal / Accept Mode                                                                  CSD031
     C           W@MODE    WHEQ 'A'                                                           CSD031
     C           KRSSA     READESDAHDYD8                 90                                   CSD031
      *                                                                                       CSD031
      ** Zonal / Change Mode                                                                  CSD031
     C                     OTHER                                                              CSD031
     C           KRSSA     READE@HOLPH8                  90                                   CSD031
     C                     ENDSL                                                              CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
      *                                                                                       CSD031
     C           KRSSA     READE@HOLPH8                  90*
     C                     ENDIF                                                              CSD031
     C                     END
      *                                                                                       CSD012
      * If CSD012 is ON and Holidays is ON, see if record exists                              CSD012
      * on Shadow file. If so display these details as F12 must have                          CSD012
      * taken from the following screen.                                                      CSD012
     C           CSD012    IFEQ 'Y'                                                           CSD012
     C           SVAL11    ANDEQ'Y'                                                           CSD012
     C           KRSSA     CHAINSDHOSHL0             90    *                                  CSD012
     C           *IN90     IFEQ *OFF                                                          CSD012
     C                     MOVELDGJA01    WUJA01           January 1                          CSD012
     C                     MOVELDGJA02    WUJA02           January 2                          CSD012
     C                     MOVELDGJA03    WUJA03           January 3                          CSD012
     C                     MOVELDGJA04    WUJA04           January 4                          CSD012
     C                     MOVELDGJA05    WUJA05           January 5                          CSD012
     C                     MOVELDGJA06    WUJA06           January 6                          CSD012
     C                     MOVELDGJA07    WUJA07           January 7                          CSD012
     C                     MOVELDGJA08    WUJA08           January 8                          CSD012
     C                     MOVELDGJA09    WUJA09           January 9                          CSD012
     C                     MOVELDGJA10    WUJA10           January 10                         CSD012
     C                     MOVELDGJA11    WUJA11           January 11                         CSD012
     C                     MOVELDGJA12    WUJA12           January 12                         CSD012
     C                     MOVELDGJA13    WUJA13           January 13                         CSD012
     C                     MOVELDGJA14    WUJA14           January 14                         CSD012
     C                     MOVELDGJA15    WUJA15           January 15                         CSD012
     C                     MOVELDGJA16    WUJA16           January 16                         CSD012
     C                     MOVELDGJA17    WUJA17           January 17                         CSD012
     C                     MOVELDGJA18    WUJA18           January 18                         CSD012
     C                     MOVELDGJA19    WUJA19           January 19                         CSD012
     C                     MOVELDGJA20    WUJA20           January 20                         CSD012
     C                     MOVELDGJA21    WUJA21           January 21                         CSD012
     C                     MOVELDGJA22    WUJA22           January 22                         CSD012
     C                     MOVELDGJA23    WUJA23           January 23                         CSD012
     C                     MOVELDGJA24    WUJA24           January 24                         CSD012
     C                     MOVELDGJA25    WUJA25           January 25                         CSD012
     C                     MOVELDGJA26    WUJA26           January 26                         CSD012
     C                     MOVELDGJA27    WUJA27           January 27                         CSD012
     C                     MOVELDGJA28    WUJA28           January 28                         CSD012
     C                     MOVELDGJA29    WUJA29           January 29                         CSD012
     C                     MOVELDGJA30    WUJA30           January 30                         CSD012
     C                     MOVELDGJA31    WUJA31           January 31                         CSD012
     C                     MOVELDGFE01    WUFE01           February 1                         CSD012
     C                     MOVELDGFE02    WUFE02           February 2                         CSD012
     C                     MOVELDGFE03    WUFE03           February 3                         CSD012
     C                     MOVELDGFE04    WUFE04           February 4                         CSD012
     C                     MOVELDGFE05    WUFE05           February 5                         CSD012
     C                     MOVELDGFE06    WUFE06           February 6                         CSD012
     C                     MOVELDGFE07    WUFE07           February 7                         CSD012
     C                     MOVELDGFE08    WUFE08           February 8                         CSD012
     C                     MOVELDGFE09    WUFE09           February 9                         CSD012
     C                     MOVELDGFE10    WUFE10           February 10                        CSD012
     C                     MOVELDGFE11    WUFE11           February 11                        CSD012
     C                     MOVELDGFE12    WUFE12           February 12                        CSD012
     C                     MOVELDGFE13    WUFE13           February 13                        CSD012
     C                     MOVELDGFE14    WUFE14           February 14                        CSD012
     C                     MOVELDGFE15    WUFE15           February 15                        CSD012
     C                     MOVELDGFE16    WUFE16           February 16                        CSD012
     C                     MOVELDGFE17    WUFE17           February 17                        CSD012
     C                     MOVELDGFE18    WUFE18           February 18                        CSD012
     C                     MOVELDGFE19    WUFE19           February 19                        CSD012
     C                     MOVELDGFE20    WUFE20           February 20                        CSD012
     C                     MOVELDGFE21    WUFE21           February 21                        CSD012
     C                     MOVELDGFE22    WUFE22           February 22                        CSD012
     C                     MOVELDGFE23    WUFE23           February 23                        CSD012
     C                     MOVELDGFE24    WUFE24           February 24                        CSD012
     C                     MOVELDGFE25    WUFE25           February 25                        CSD012
     C                     MOVELDGFE26    WUFE26           February 26                        CSD012
     C                     MOVELDGFE27    WUFE27           February 27                        CSD012
     C                     MOVELDGFE28    WUFE28           February 28                        CSD012
     C                     MOVELDGFE29    WUFE29           February 29                        CSD012
     C                     MOVELDGMA01    WUMA01           March 1                            CSD012
     C                     MOVELDGMA02    WUMA02           March 2                            CSD012
     C                     MOVELDGMA03    WUMA03           March 3                            CSD012
     C                     MOVELDGMA04    WUMA04           March 4                            CSD012
     C                     MOVELDGMA05    WUMA05           March 5                            CSD012
     C                     MOVELDGMA06    WUMA06           March 6                            CSD012
     C                     MOVELDGMA07    WUMA07           March 7                            CSD012
     C                     MOVELDGMA08    WUMA08           March 8                            CSD012
     C                     MOVELDGMA09    WUMA09           March 9                            CSD012
     C                     MOVELDGMA10    WUMA10           March 10                           CSD012
     C                     MOVELDGMA11    WUMA11           March 11                           CSD012
     C                     MOVELDGMA12    WUMA12           March 12                           CSD012
     C                     MOVELDGMA13    WUMA13           March 13                           CSD012
     C                     MOVELDGMA14    WUMA14           March 14                           CSD012
     C                     MOVELDGMA15    WUMA15           March 15                           CSD012
     C                     MOVELDGMA16    WUMA16           March 16                           CSD012
     C                     MOVELDGMA17    WUMA17           March 17                           CSD012
     C                     MOVELDGMA18    WUMA18           March 18                           CSD012
     C                     MOVELDGMA19    WUMA19           March 19                           CSD012
     C                     MOVELDGMA20    WUMA20           March 20                           CSD012
     C                     MOVELDGMA21    WUMA21           March 21                           CSD012
     C                     MOVELDGMA22    WUMA22           March 22                           CSD012
     C                     MOVELDGMA23    WUMA23           March 23                           CSD012
     C                     MOVELDGMA24    WUMA24           March 24                           CSD012
     C                     MOVELDGMA25    WUMA25           March 25                           CSD012
     C                     MOVELDGMA26    WUMA26           March 26                           CSD012
     C                     MOVELDGMA27    WUMA27           March 27                           CSD012
     C                     MOVELDGMA28    WUMA28           March 28                           CSD012
     C                     MOVELDGMA29    WUMA29           March 29                           CSD012
     C                     MOVELDGMA30    WUMA30           March 30                           CSD012
     C                     MOVELDGMA31    WUMA31           March 31                           CSD012
     C                     ENDIF                                                              CSD012
     C                     ENDIF                                                              CSD012
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Retrieve standard Holiday - Currency Codes  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           A6CYCD           Currency Code
      * Move fields to key list
     C                     MOVEL#1CYCD    A6CYCD           Currency Code
     C           KRSSB     CHAIN@A6REA3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0071' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA6WEDH    WUWEDH           WED. Holiday
     C                     MOVELA6MONH    WUMONH           MON. Holiday
     C                     MOVELA6TUEH    WUTUEH           TUES. Holiday
     C                     MOVELA6THUH    WUTHUH           THURS. Holiday
     C                     MOVELA6FRIH    WUFRIH           FRI. Holiday
     C                     MOVELA6SATH    WUSATH           SAT. Holiday
     C                     MOVELA6SUNH    WUSUNH           SUN. Holiday
     C                     END
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Get Holidays for 1st Q - Holidays  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WACYCD    WQSC01           Currency Code
     C           *LIKE     DEFN WALCCD    WQSC02           Location Code
     C           *LIKE     DEFN WAYRNB    WQSC03           Year Number
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Currency Code
     C                     KFLD           WQSC02           Location Code
     C                     KFLD           WQSC03           Year Number
      * Move fields to key list
     C                     MOVELP1CYCD    WQSC01           Currency Code
     C                     MOVEL'***'     WQSC02           Location Code
     C                     MOVELP1YRNB    WQSC03           Year Number
      *                                                                                       CSD031
      ** Use appropriate files                                                                CSD031
      *                                                                                       CSD031
     C           CSD041    IFEQ 'Y'                                                           CSD031
     C                     SELEC                                                              CSD031
      *                                                                                       CSD031
      ** Global                                                                               CSD031
     C           W@MODE    WHEQ 'G'                                                           CSD031
     C           KRSSA     SETLLGPHOLID2                                                      CSD031
     C           KRSSA     READEGPHOLID2                 90                                   CSD031
      *                                                                                       CSD031
      ** Zonal / Accept Mode                                                                  CSD031
     C           W@MODE    WHEQ 'A'                                                           CSD031
     C           KRSSA     SETLLSDAHDYD8                                                      CSD031
     C           KRSSA     READESDAHDYD8                 90                                   CSD031
      *                                                                                       CSD031
      ** Zonal / Change Mode                                                                  CSD031
     C                     OTHER                                                              CSD031
     C           KRSSA     SETLL@HOLPH8                                                       CSD031
     C           KRSSA     READE@HOLPH8                  90                                   CSD031
     C                     ENDSL                                                              CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
      *                                                                                       CSD031
     C           KRSSC     SETLL@HOLPH8                    *
     C           KRSSC     READE@HOLPH8                  90*
     C                     ENDIF                                                              CSD031
     C           *IN90     IFEQ '1'
      *                                                                                       CSD012
      * If CSD012 is ON and Holidays is ON and Insert no error                                CSD012
      * as will not be on this file.                                                          CSD012
     C           CSD012    IFEQ 'Y'                                                           CSD012
     C           SVAL11    ANDEQ'Y'                                                           CSD012
     C           P2ANCD    ANDEQ'I'                                                           CSD012
     C                     ELSE                                                               CSD012
      * Data record not found
     C                     MOVEL'USR0657' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF                                                              CSD012
     C                     END
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWAJA01    WUJA01           January 1
     C                     MOVELWAJA02    WUJA02           January 2
     C                     MOVELWAJA03    WUJA03           January 3
     C                     MOVELWAJA04    WUJA04           January 4
     C                     MOVELWAJA05    WUJA05           January 5
     C                     MOVELWAJA06    WUJA06           January 6
     C                     MOVELWAJA07    WUJA07           January 7
     C                     MOVELWAJA08    WUJA08           January 8
     C                     MOVELWAJA09    WUJA09           January 9
     C                     MOVELWAJA10    WUJA10           January 10
     C                     MOVELWAJA11    WUJA11           January 11
     C                     MOVELWAJA12    WUJA12           January 12
     C                     MOVELWAJA13    WUJA13           January 13
     C                     MOVELWAJA14    WUJA14           January 14
     C                     MOVELWAJA15    WUJA15           January 15
     C                     MOVELWAJA16    WUJA16           January 16
     C                     MOVELWAJA17    WUJA17           January 17
     C                     MOVELWAJA18    WUJA18           January 18
     C                     MOVELWAJA19    WUJA19           January 19
     C                     MOVELWAJA20    WUJA20           January 20
     C                     MOVELWAJA21    WUJA21           January 21
     C                     MOVELWAJA22    WUJA22           January 22
     C                     MOVELWAJA23    WUJA23           January 23
     C                     MOVELWAJA24    WUJA24           January 24
     C                     MOVELWAJA25    WUJA25           January 25
     C                     MOVELWAJA26    WUJA26           January 26
     C                     MOVELWAJA27    WUJA27           January 27
     C                     MOVELWAJA28    WUJA28           January 28
     C                     MOVELWAJA29    WUJA29           January 29
     C                     MOVELWAJA30    WUJA30           January 30
     C                     MOVELWAJA31    WUJA31           January 31
     C                     MOVELWAFE01    WUFE01           February 1
     C                     MOVELWAFE02    WUFE02           February 2
     C                     MOVELWAFE03    WUFE03           February 3
     C                     MOVELWAFE04    WUFE04           February 4
     C                     MOVELWAFE05    WUFE05           February 5
     C                     MOVELWAFE06    WUFE06           February 6
     C                     MOVELWAFE07    WUFE07           February 7
     C                     MOVELWAFE08    WUFE08           February 8
     C                     MOVELWAFE09    WUFE09           February 9
     C                     MOVELWAFE10    WUFE10           February 10
     C                     MOVELWAFE11    WUFE11           February 11
     C                     MOVELWAFE12    WUFE12           February 12
     C                     MOVELWAFE13    WUFE13           February 13
     C                     MOVELWAFE14    WUFE14           February 14
     C                     MOVELWAFE15    WUFE15           February 15
     C                     MOVELWAFE16    WUFE16           February 16
     C                     MOVELWAFE17    WUFE17           February 17
     C                     MOVELWAFE18    WUFE18           February 18
     C                     MOVELWAFE19    WUFE19           February 19
     C                     MOVELWAFE20    WUFE20           February 20
     C                     MOVELWAFE21    WUFE21           February 21
     C                     MOVELWAFE22    WUFE22           February 22
     C                     MOVELWAFE23    WUFE23           February 23
     C                     MOVELWAFE24    WUFE24           February 24
     C                     MOVELWAFE25    WUFE25           February 25
     C                     MOVELWAFE26    WUFE26           February 26
     C                     MOVELWAFE27    WUFE27           February 27
     C                     MOVELWAFE28    WUFE28           February 28
     C                     MOVELWAFE29    WUFE29           February 29
     C                     MOVELWAMA01    WUMA01           March 1
     C                     MOVELWAMA02    WUMA02           March 2
     C                     MOVELWAMA03    WUMA03           March 3
     C                     MOVELWAMA04    WUMA04           March 4
     C                     MOVELWAMA05    WUMA05           March 5
     C                     MOVELWAMA06    WUMA06           March 6
     C                     MOVELWAMA07    WUMA07           March 7
     C                     MOVELWAMA08    WUMA08           March 8
     C                     MOVELWAMA09    WUMA09           March 9
     C                     MOVELWAMA10    WUMA10           March 10
     C                     MOVELWAMA11    WUMA11           March 11
     C                     MOVELWAMA12    WUMA12           March 12
     C                     MOVELWAMA13    WUMA13           March 13
     C                     MOVELWAMA14    WUMA14           March 14
     C                     MOVELWAMA15    WUMA15           March 15
     C                     MOVELWAMA16    WUMA16           March 16
     C                     MOVELWAMA17    WUMA17           March 17
     C                     MOVELWAMA18    WUMA18           March 18
     C                     MOVELWAMA19    WUMA19           March 19
     C                     MOVELWAMA20    WUMA20           March 20
     C                     MOVELWAMA21    WUMA21           March 21
     C                     MOVELWAMA22    WUMA22           March 22
     C                     MOVELWAMA23    WUMA23           March 23
     C                     MOVELWAMA24    WUMA24           March 24
     C                     MOVELWAMA25    WUMA25           March 25
     C                     MOVELWAMA26    WUMA26           March 26
     C                     MOVELWAMA27    WUMA27           March 27
     C                     MOVELWAMA28    WUMA28           March 28
     C                     MOVELWAMA29    WUMA29           March 29
     C                     MOVELWAMA30    WUMA30           March 30
     C                     MOVELWAMA31    WUMA31           March 31
      *                                                                                       CSD031
      ** Use appropriate files                                                                CSD031
      *                                                                                       CSD031
     C           CSD041    IFEQ 'Y'                                                           CSD031
     C                     SELEC                                                              CSD031
      *                                                                                       CSD031
      ** Global                                                                               CSD031
     C           W@MODE    WHEQ 'G'                                                           CSD031
     C           KRSSA     READEGPHOLID2                 90                                   CSD031
      *                                                                                       CSD031
      ** Zonal / Accept Mode                                                                  CSD031
     C           W@MODE    WHEQ 'A'                                                           CSD031
     C           KRSSA     READESDAHDYD8                 90                                   CSD031
      *                                                                                       CSD031
      ** Zonal / Change Mode                                                                  CSD031
     C                     OTHER                                                              CSD031
     C           KRSSA     READE@HOLPH8                  90                                   CSD031
     C                     ENDSL                                                              CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
      *                                                                                       CSD031
     C           KRSSC     READE@HOLPH8                  90*
     C                     ENDIF                                                              CSD031
     C                     END
      *                                                                                       CSD012
      * If CSD012 is ON and Holidays is ON, see if record exists                              CSD012
      * on Shadow file. If so display these details as F12 must have                          CSD012
      * taken from the following screen.                                                      CSD012
     C           CSD012    IFEQ 'Y'                                                           CSD012
     C           SVAL11    ANDEQ'Y'                                                           CSD012
     C           KRSSC     CHAINSDHOSHL0             90    *                                  CSD012
     C           *IN90     IFEQ *OFF                                                          CSD012
     C                     MOVELDGJA01    WUJA01           January 1                          CSD012
     C                     MOVELDGJA02    WUJA02           January 2                          CSD012
     C                     MOVELDGJA03    WUJA03           January 3                          CSD012
     C                     MOVELDGJA04    WUJA04           January 4                          CSD012
     C                     MOVELDGJA05    WUJA05           January 5                          CSD012
     C                     MOVELDGJA06    WUJA06           January 6                          CSD012
     C                     MOVELDGJA07    WUJA07           January 7                          CSD012
     C                     MOVELDGJA08    WUJA08           January 8                          CSD012
     C                     MOVELDGJA09    WUJA09           January 9                          CSD012
     C                     MOVELDGJA10    WUJA10           January 10                         CSD012
     C                     MOVELDGJA11    WUJA11           January 11                         CSD012
     C                     MOVELDGJA12    WUJA12           January 12                         CSD012
     C                     MOVELDGJA13    WUJA13           January 13                         CSD012
     C                     MOVELDGJA14    WUJA14           January 14                         CSD012
     C                     MOVELDGJA15    WUJA15           January 15                         CSD012
     C                     MOVELDGJA16    WUJA16           January 16                         CSD012
     C                     MOVELDGJA17    WUJA17           January 17                         CSD012
     C                     MOVELDGJA18    WUJA18           January 18                         CSD012
     C                     MOVELDGJA19    WUJA19           January 19                         CSD012
     C                     MOVELDGJA20    WUJA20           January 20                         CSD012
     C                     MOVELDGJA21    WUJA21           January 21                         CSD012
     C                     MOVELDGJA22    WUJA22           January 22                         CSD012
     C                     MOVELDGJA23    WUJA23           January 23                         CSD012
     C                     MOVELDGJA24    WUJA24           January 24                         CSD012
     C                     MOVELDGJA25    WUJA25           January 25                         CSD012
     C                     MOVELDGJA26    WUJA26           January 26                         CSD012
     C                     MOVELDGJA27    WUJA27           January 27                         CSD012
     C                     MOVELDGJA28    WUJA28           January 28                         CSD012
     C                     MOVELDGJA29    WUJA29           January 29                         CSD012
     C                     MOVELDGJA30    WUJA30           January 30                         CSD012
     C                     MOVELDGJA31    WUJA31           January 31                         CSD012
     C                     MOVELDGFE01    WUFE01           February 1                         CSD012
     C                     MOVELDGFE02    WUFE02           February 2                         CSD012
     C                     MOVELDGFE03    WUFE03           February 3                         CSD012
     C                     MOVELDGFE04    WUFE04           February 4                         CSD012
     C                     MOVELDGFE05    WUFE05           February 5                         CSD012
     C                     MOVELDGFE06    WUFE06           February 6                         CSD012
     C                     MOVELDGFE07    WUFE07           February 7                         CSD012
     C                     MOVELDGFE08    WUFE08           February 8                         CSD012
     C                     MOVELDGFE09    WUFE09           February 9                         CSD012
     C                     MOVELDGFE10    WUFE10           February 10                        CSD012
     C                     MOVELDGFE11    WUFE11           February 11                        CSD012
     C                     MOVELDGFE12    WUFE12           February 12                        CSD012
     C                     MOVELDGFE13    WUFE13           February 13                        CSD012
     C                     MOVELDGFE14    WUFE14           February 14                        CSD012
     C                     MOVELDGFE15    WUFE15           February 15                        CSD012
     C                     MOVELDGFE16    WUFE16           February 16                        CSD012
     C                     MOVELDGFE17    WUFE17           February 17                        CSD012
     C                     MOVELDGFE18    WUFE18           February 18                        CSD012
     C                     MOVELDGFE19    WUFE19           February 19                        CSD012
     C                     MOVELDGFE20    WUFE20           February 20                        CSD012
     C                     MOVELDGFE21    WUFE21           February 21                        CSD012
     C                     MOVELDGFE22    WUFE22           February 22                        CSD012
     C                     MOVELDGFE23    WUFE23           February 23                        CSD012
     C                     MOVELDGFE24    WUFE24           February 24                        CSD012
     C                     MOVELDGFE25    WUFE25           February 25                        CSD012
     C                     MOVELDGFE26    WUFE26           February 26                        CSD012
     C                     MOVELDGFE27    WUFE27           February 27                        CSD012
     C                     MOVELDGFE28    WUFE28           February 28                        CSD012
     C                     MOVELDGFE29    WUFE29           February 29                        CSD012
     C                     MOVELDGMA01    WUMA01           March 1                            CSD012
     C                     MOVELDGMA02    WUMA02           March 2                            CSD012
     C                     MOVELDGMA03    WUMA03           March 3                            CSD012
     C                     MOVELDGMA04    WUMA04           March 4                            CSD012
     C                     MOVELDGMA05    WUMA05           March 5                            CSD012
     C                     MOVELDGMA06    WUMA06           March 6                            CSD012
     C                     MOVELDGMA07    WUMA07           March 7                            CSD012
     C                     MOVELDGMA08    WUMA08           March 8                            CSD012
     C                     MOVELDGMA09    WUMA09           March 9                            CSD012
     C                     MOVELDGMA10    WUMA10           March 10                           CSD012
     C                     MOVELDGMA11    WUMA11           March 11                           CSD012
     C                     MOVELDGMA12    WUMA12           March 12                           CSD012
     C                     MOVELDGMA13    WUMA13           March 13                           CSD012
     C                     MOVELDGMA14    WUMA14           March 14                           CSD012
     C                     MOVELDGMA15    WUMA15           March 15                           CSD012
     C                     MOVELDGMA16    WUMA16           March 16                           CSD012
     C                     MOVELDGMA17    WUMA17           March 17                           CSD012
     C                     MOVELDGMA18    WUMA18           March 18                           CSD012
     C                     MOVELDGMA19    WUMA19           March 19                           CSD012
     C                     MOVELDGMA20    WUMA20           March 20                           CSD012
     C                     MOVELDGMA21    WUMA21           March 21                           CSD012
     C                     MOVELDGMA22    WUMA22           March 22                           CSD012
     C                     MOVELDGMA23    WUMA23           March 23                           CSD012
     C                     MOVELDGMA24    WUMA24           March 24                           CSD012
     C                     MOVELDGMA25    WUMA25           March 25                           CSD012
     C                     MOVELDGMA26    WUMA26           March 26                           CSD012
     C                     MOVELDGMA27    WUMA27           March 27                           CSD012
     C                     MOVELDGMA28    WUMA28           March 28                           CSD012
     C                     MOVELDGMA29    WUMA29           March 29                           CSD012
     C                     MOVELDGMA30    WUMA30           March 30                           CSD012
     C                     MOVELDGMA31    WUMA31           March 31                           CSD012
     C                     ENDIF                                                              CSD012
     C                     ENDIF                                                              CSD012
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCRRC    BEGSR
      *================================================================
      * Create Holidays - Holidays  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @HOLPHG
     C                     MOVEL#1CYCD    DGCYCD           Currency Code
     C                     MOVEL#1LCCD    DGLCCD           Location Code
     C                     MOVEL#1YRNB    DGYRNB           Year Number
     C                     Z-ADDWUJDNB    DGJDNB           1st January Day
     C                     Z-ADDWUDDNB    DGDDNB           31st December D
     C                     MOVELWUJA01    DGJA01           January 1
     C                     MOVELWUJA02    DGJA02           January 2
     C                     MOVELWUJA03    DGJA03           January 3
     C                     MOVELWUJA04    DGJA04           January 4
     C                     MOVELWUJA05    DGJA05           January 5
     C                     MOVELWUJA06    DGJA06           January 6
     C                     MOVELWUJA07    DGJA07           January 7
     C                     MOVELWUJA08    DGJA08           January 8
     C                     MOVELWUJA09    DGJA09           January 9
     C                     MOVELWUJA10    DGJA10           January 10
     C                     MOVELWUJA11    DGJA11           January 11
     C                     MOVELWUJA12    DGJA12           January 12
     C                     MOVELWUJA13    DGJA13           January 13
     C                     MOVELWUJA14    DGJA14           January 14
     C                     MOVELWUJA15    DGJA15           January 15
     C                     MOVELWUJA16    DGJA16           January 16
     C                     MOVELWUJA17    DGJA17           January 17
     C                     MOVELWUJA18    DGJA18           January 18
     C                     MOVELWUJA19    DGJA19           January 19
     C                     MOVELWUJA20    DGJA20           January 20
     C                     MOVELWUJA21    DGJA21           January 21
     C                     MOVELWUJA22    DGJA22           January 22
     C                     MOVELWUJA23    DGJA23           January 23
     C                     MOVELWUJA24    DGJA24           January 24
     C                     MOVELWUJA25    DGJA25           January 25
     C                     MOVELWUJA26    DGJA26           January 26
     C                     MOVELWUJA27    DGJA27           January 27
     C                     MOVELWUJA28    DGJA28           January 28
     C                     MOVELWUJA29    DGJA29           January 29
     C                     MOVELWUJA30    DGJA30           January 30
     C                     MOVELWUJA31    DGJA31           January 31
     C                     MOVELWUFE01    DGFE01           February 1
     C                     MOVELWUFE02    DGFE02           February 2
     C                     MOVELWUFE03    DGFE03           February 3
     C                     MOVELWUFE04    DGFE04           February 4
     C                     MOVELWUFE05    DGFE05           February 5
     C                     MOVELWUFE06    DGFE06           February 6
     C                     MOVELWUFE07    DGFE07           February 7
     C                     MOVELWUFE08    DGFE08           February 8
     C                     MOVELWUFE09    DGFE09           February 9
     C                     MOVELWUFE10    DGFE10           February 10
     C                     MOVELWUFE11    DGFE11           February 11
     C                     MOVELWUFE12    DGFE12           February 12
     C                     MOVELWUFE13    DGFE13           February 13
     C                     MOVELWUFE14    DGFE14           February 14
     C                     MOVELWUFE15    DGFE15           February 15
     C                     MOVELWUFE16    DGFE16           February 16
     C                     MOVELWUFE17    DGFE17           February 17
     C                     MOVELWUFE18    DGFE18           February 18
     C                     MOVELWUFE19    DGFE19           February 19
     C                     MOVELWUFE20    DGFE20           February 20
     C                     MOVELWUFE21    DGFE21           February 21
     C                     MOVELWUFE22    DGFE22           February 22
     C                     MOVELWUFE23    DGFE23           February 23
     C                     MOVELWUFE24    DGFE24           February 24
     C                     MOVELWUFE25    DGFE25           February 25
     C                     MOVELWUFE26    DGFE26           February 26
     C                     MOVELWUFE27    DGFE27           February 27
     C                     MOVELWUFE28    DGFE28           February 28
     C                     MOVELWUFE29    DGFE29           February 29
     C                     MOVELWUMA01    DGMA01           March 1
     C                     MOVELWUMA02    DGMA02           March 2
     C                     MOVELWUMA03    DGMA03           March 3
     C                     MOVELWUMA04    DGMA04           March 4
     C                     MOVELWUMA05    DGMA05           March 5
     C                     MOVELWUMA06    DGMA06           March 6
     C                     MOVELWUMA07    DGMA07           March 7
     C                     MOVELWUMA08    DGMA08           March 8
     C                     MOVELWUMA09    DGMA09           March 9
     C                     MOVELWUMA10    DGMA10           March 10
     C                     MOVELWUMA11    DGMA11           March 11
     C                     MOVELWUMA12    DGMA12           March 12
     C                     MOVELWUMA13    DGMA13           March 13
     C                     MOVELWUMA14    DGMA14           March 14
     C                     MOVELWUMA15    DGMA15           March 15
     C                     MOVELWUMA16    DGMA16           March 16
     C                     MOVELWUMA17    DGMA17           March 17
     C                     MOVELWUMA18    DGMA18           March 18
     C                     MOVELWUMA19    DGMA19           March 19
     C                     MOVELWUMA20    DGMA20           March 20
     C                     MOVELWUMA21    DGMA21           March 21
     C                     MOVELWUMA22    DGMA22           March 22
     C                     MOVELWUMA23    DGMA23           March 23
     C                     MOVELWUMA24    DGMA24           March 24
     C                     MOVELWUMA25    DGMA25           March 25
     C                     MOVELWUMA26    DGMA26           March 26
     C                     MOVELWUMA27    DGMA27           March 27
     C                     MOVELWUMA28    DGMA28           March 28
     C                     MOVELWUMA29    DGMA29           March 29
     C                     MOVELWUMA30    DGMA30           March 30
     C                     MOVELWUMA31    DGMA31           March 31
     C                     MOVEL*BLANK    DGAP01           April 1
     C                     MOVEL*BLANK    DGAP02           April 2
     C                     MOVEL*BLANK    DGAP03           April 3
     C                     MOVEL*BLANK    DGAP04           April 4
     C                     MOVEL*BLANK    DGAP05           April 5
     C                     MOVEL*BLANK    DGAP06           April 6
     C                     MOVEL*BLANK    DGAP07           April 7
     C                     MOVEL*BLANK    DGAP08           April 8
     C                     MOVEL*BLANK    DGAP09           April 9
     C                     MOVEL*BLANK    DGAP10           April 10
     C                     MOVEL*BLANK    DGAP11           April 11
     C                     MOVEL*BLANK    DGAP12           April 12
     C                     MOVEL*BLANK    DGAP13           April 13
     C                     MOVEL*BLANK    DGAP14           April 14
     C                     MOVEL*BLANK    DGAP15           April 15
     C                     MOVEL*BLANK    DGAP16           April 16
     C                     MOVEL*BLANK    DGAP17           April 17
     C                     MOVEL*BLANK    DGAP18           April 18
     C                     MOVEL*BLANK    DGAP19           April 19
     C                     MOVEL*BLANK    DGAP20           April 20
     C                     MOVEL*BLANK    DGAP21           April 21
     C                     MOVEL*BLANK    DGAP22           April 22
     C                     MOVEL*BLANK    DGAP23           April 23
     C                     MOVEL*BLANK    DGAP24           April 24
     C                     MOVEL*BLANK    DGAP25           April 25
     C                     MOVEL*BLANK    DGAP26           April 26
     C                     MOVEL*BLANK    DGAP27           April 27
     C                     MOVEL*BLANK    DGAP28           April 28
     C                     MOVEL*BLANK    DGAP29           April 29
     C                     MOVEL*BLANK    DGAP30           April 30
     C                     MOVEL*BLANK    DGMY01           May 1
     C                     MOVEL*BLANK    DGMY02           May 2
     C                     MOVEL*BLANK    DGMY03           May 3
     C                     MOVEL*BLANK    DGMY04           May 4
     C                     MOVEL*BLANK    DGMY05           May 5
     C                     MOVEL*BLANK    DGMY06           May 6
     C                     MOVEL*BLANK    DGMY07           May 7
     C                     MOVEL*BLANK    DGMY08           May 8
     C                     MOVEL*BLANK    DGMY09           May 9
     C                     MOVEL*BLANK    DGMY10           May 10
     C                     MOVEL*BLANK    DGMY11           May 11
     C                     MOVEL*BLANK    DGMY12           May 12
     C                     MOVEL*BLANK    DGMY13           May 13
     C                     MOVEL*BLANK    DGMY14           May 14
     C                     MOVEL*BLANK    DGMY15           May 15
     C                     MOVEL*BLANK    DGMY16           May 16
     C                     MOVEL*BLANK    DGMY17           May 17
     C                     MOVEL*BLANK    DGMY18           May 18
     C                     MOVEL*BLANK    DGMY19           May 19
     C                     MOVEL*BLANK    DGMY20           May 20
     C                     MOVEL*BLANK    DGMY21           May 21
     C                     MOVEL*BLANK    DGMY22           May 22
     C                     MOVEL*BLANK    DGMY23           May 23
     C                     MOVEL*BLANK    DGMY24           May 24
     C                     MOVEL*BLANK    DGMY25           May 25
     C                     MOVEL*BLANK    DGMY26           May 26
     C                     MOVEL*BLANK    DGMY27           May 27
     C                     MOVEL*BLANK    DGMY28           May 28
     C                     MOVEL*BLANK    DGMY29           May 29
     C                     MOVEL*BLANK    DGMY30           May 30
     C                     MOVEL*BLANK    DGMY31           May 31
     C                     MOVEL*BLANK    DGJU01           June 1
     C                     MOVEL*BLANK    DGJU02           June 2
     C                     MOVEL*BLANK    DGJU03           June 3
     C                     MOVEL*BLANK    DGJU04           June 4
     C                     MOVEL*BLANK    DGJU05           June 5
     C                     MOVEL*BLANK    DGJU06           June 6
     C                     MOVEL*BLANK    DGJU07           June 7
     C                     MOVEL*BLANK    DGJU08           June 8
     C                     MOVEL*BLANK    DGJU09           June 9
     C                     MOVEL*BLANK    DGJU10           June 10
     C                     MOVEL*BLANK    DGJU11           June 11
     C                     MOVEL*BLANK    DGJU12           June 12
     C                     MOVEL*BLANK    DGJU13           June 13
     C                     MOVEL*BLANK    DGJU14           June 14
     C                     MOVEL*BLANK    DGJU15           June 15
     C                     MOVEL*BLANK    DGJU16           June 16
     C                     MOVEL*BLANK    DGJU17           June 17
     C                     MOVEL*BLANK    DGJU18           June 18
     C                     MOVEL*BLANK    DGJU19           June 19
     C                     MOVEL*BLANK    DGJU20           June 20
     C                     MOVEL*BLANK    DGJU21           June 21
     C                     MOVEL*BLANK    DGJU22           June 22
     C                     MOVEL*BLANK    DGJU23           June 23
     C                     MOVEL*BLANK    DGJU24           June 24
     C                     MOVEL*BLANK    DGJU25           June 25
     C                     MOVEL*BLANK    DGJU26           June 26
     C                     MOVEL*BLANK    DGJU27           June 27
     C                     MOVEL*BLANK    DGJU28           June 28
     C                     MOVEL*BLANK    DGJU29           June 29
     C                     MOVEL*BLANK    DGJU30           June 30
     C                     MOVEL*BLANK    DGJL01           July 1
     C                     MOVEL*BLANK    DGJL02           July 2
     C                     MOVEL*BLANK    DGJL03           July 3
     C                     MOVEL*BLANK    DGJL04           July 4
     C                     MOVEL*BLANK    DGJL05           July 5
     C                     MOVEL*BLANK    DGJL06           July 6
     C                     MOVEL*BLANK    DGJL07           July 7
     C                     MOVEL*BLANK    DGJL08           July 8
     C                     MOVEL*BLANK    DGJL09           July 9
     C                     MOVEL*BLANK    DGJL10           July 10
     C                     MOVEL*BLANK    DGJL11           July 11
     C                     MOVEL*BLANK    DGJL12           July 12
     C                     MOVEL*BLANK    DGJL13           July 13
     C                     MOVEL*BLANK    DGJL14           July 14
     C                     MOVEL*BLANK    DGJL15           July 15
     C                     MOVEL*BLANK    DGJL16           July 16
     C                     MOVEL*BLANK    DGJL17           July 17
     C                     MOVEL*BLANK    DGJL18           July 18
     C                     MOVEL*BLANK    DGJL19           July 19
     C                     MOVEL*BLANK    DGJL20           July 20
     C                     MOVEL*BLANK    DGJL21           July 21
     C                     MOVEL*BLANK    DGJL22           July 22
     C                     MOVEL*BLANK    DGJL23           July 23
     C                     MOVEL*BLANK    DGJL24           July 24
     C                     MOVEL*BLANK    DGJL25           July 25
     C                     MOVEL*BLANK    DGJL26           July 26
     C                     MOVEL*BLANK    DGJL27           July 27
     C                     MOVEL*BLANK    DGJL28           July 28
     C                     MOVEL*BLANK    DGJL29           July 29
     C                     MOVEL*BLANK    DGJL30           July 30
     C                     MOVEL*BLANK    DGJL31           July 31
     C                     MOVEL*BLANK    DGAU01           August 1
     C                     MOVEL*BLANK    DGAU02           August 2
     C                     MOVEL*BLANK    DGAU03           August 3
     C                     MOVEL*BLANK    DGAU04           August 4
     C                     MOVEL*BLANK    DGAU05           August 5
     C                     MOVEL*BLANK    DGAU06           August 6
     C                     MOVEL*BLANK    DGAU07           August 7
     C                     MOVEL*BLANK    DGAU08           August 8
     C                     MOVEL*BLANK    DGAU09           August 9
     C                     MOVEL*BLANK    DGAU10           August 10
     C                     MOVEL*BLANK    DGAU11           August 11
     C                     MOVEL*BLANK    DGAU12           August 12
     C                     MOVEL*BLANK    DGAU13           August 13
     C                     MOVEL*BLANK    DGAU14           August 14
     C                     MOVEL*BLANK    DGAU15           August 15
     C                     MOVEL*BLANK    DGAU16           August 16
     C                     MOVEL*BLANK    DGAU17           August 17
     C                     MOVEL*BLANK    DGAU18           August 18
     C                     MOVEL*BLANK    DGAU19           August 19
     C                     MOVEL*BLANK    DGAU20           August 20
     C                     MOVEL*BLANK    DGAU21           August 21
     C                     MOVEL*BLANK    DGAU22           August 22
     C                     MOVEL*BLANK    DGAU23           August 23
     C                     MOVEL*BLANK    DGAU24           August 24
     C                     MOVEL*BLANK    DGAU25           August 25
     C                     MOVEL*BLANK    DGAU26           August 26
     C                     MOVEL*BLANK    DGAU27           August 27
     C                     MOVEL*BLANK    DGAU28           August 28
     C                     MOVEL*BLANK    DGAU29           August 29
     C                     MOVEL*BLANK    DGAU30           August 30
     C                     MOVEL*BLANK    DGAU31           August 31
     C                     MOVEL*BLANK    DGSE01           September 1
     C                     MOVEL*BLANK    DGSE02           September 2
     C                     MOVEL*BLANK    DGSE03           September 3
     C                     MOVEL*BLANK    DGSE04           September 4
     C                     MOVEL*BLANK    DGSE05           September 5
     C                     MOVEL*BLANK    DGSE06           September 6
     C                     MOVEL*BLANK    DGSE07           September 7
     C                     MOVEL*BLANK    DGSE08           September 8
     C                     MOVEL*BLANK    DGSE09           September 9
     C                     MOVEL*BLANK    DGSE10           September 10
     C                     MOVEL*BLANK    DGSE11           September 11
     C                     MOVEL*BLANK    DGSE12           September 12
     C                     MOVEL*BLANK    DGSE13           September 13
     C                     MOVEL*BLANK    DGSE14           September 14
     C                     MOVEL*BLANK    DGSE15           September 15
     C                     MOVEL*BLANK    DGSE16           September 16
     C                     MOVEL*BLANK    DGSE17           September 17
     C                     MOVEL*BLANK    DGSE18           September 18
     C                     MOVEL*BLANK    DGSE19           September 19
     C                     MOVEL*BLANK    DGSE20           September 20
     C                     MOVEL*BLANK    DGSE21           September 21
     C                     MOVEL*BLANK    DGSE22           September 22
     C                     MOVEL*BLANK    DGSE23           September 23
     C                     MOVEL*BLANK    DGSE24           September 24
     C                     MOVEL*BLANK    DGSE25           September 25
     C                     MOVEL*BLANK    DGSE26           September 26
     C                     MOVEL*BLANK    DGSE27           September 27
     C                     MOVEL*BLANK    DGSE28           September 28
     C                     MOVEL*BLANK    DGSE29           September 29
     C                     MOVEL*BLANK    DGSE30           September 30
     C                     MOVEL*BLANK    DGOC01           October 1
     C                     MOVEL*BLANK    DGOC02           October 2
     C                     MOVEL*BLANK    DGOC03           October 3
     C                     MOVEL*BLANK    DGOC04           October 4
     C                     MOVEL*BLANK    DGOC05           October 5
     C                     MOVEL*BLANK    DGOC06           October 6
     C                     MOVEL*BLANK    DGOC07           October 7
     C                     MOVEL*BLANK    DGOC08           October 8
     C                     MOVEL*BLANK    DGOC09           October 9
     C                     MOVEL*BLANK    DGOC10           October 10
     C                     MOVEL*BLANK    DGOC11           October 11
     C                     MOVEL*BLANK    DGOC12           October 12
     C                     MOVEL*BLANK    DGOC13           October 13
     C                     MOVEL*BLANK    DGOC14           October 14
     C                     MOVEL*BLANK    DGOC15           October 15
     C                     MOVEL*BLANK    DGOC16           October 16
     C                     MOVEL*BLANK    DGOC17           October 17
     C                     MOVEL*BLANK    DGOC18           October 18
     C                     MOVEL*BLANK    DGOC19           October 19
     C                     MOVEL*BLANK    DGOC20           October 20
     C                     MOVEL*BLANK    DGOC21           October 21
     C                     MOVEL*BLANK    DGOC22           October 22
     C                     MOVEL*BLANK    DGOC23           October 23
     C                     MOVEL*BLANK    DGOC24           October 24
     C                     MOVEL*BLANK    DGOC25           October 25
     C                     MOVEL*BLANK    DGOC26           October 26
     C                     MOVEL*BLANK    DGOC27           October 27
     C                     MOVEL*BLANK    DGOC28           October 28
     C                     MOVEL*BLANK    DGOC29           October 29
     C                     MOVEL*BLANK    DGOC30           October 30
     C                     MOVEL*BLANK    DGOC31           October 31
     C                     MOVEL*BLANK    DGNO01           November 1
     C                     MOVEL*BLANK    DGNO02           November 2
     C                     MOVEL*BLANK    DGNO03           November 3
     C                     MOVEL*BLANK    DGNO04           November 4
     C                     MOVEL*BLANK    DGNO05           November 5
     C                     MOVEL*BLANK    DGNO06           November 6
     C                     MOVEL*BLANK    DGNO07           November 7
     C                     MOVEL*BLANK    DGNO08           November 8
     C                     MOVEL*BLANK    DGNO09           November 9
     C                     MOVEL*BLANK    DGNO10           November 10
     C                     MOVEL*BLANK    DGNO11           November 11
     C                     MOVEL*BLANK    DGNO12           November 12
     C                     MOVEL*BLANK    DGNO13           November 13
     C                     MOVEL*BLANK    DGNO14           November 14
     C                     MOVEL*BLANK    DGNO15           November 15
     C                     MOVEL*BLANK    DGNO16           November 16
     C                     MOVEL*BLANK    DGNO17           November 17
     C                     MOVEL*BLANK    DGNO18           November 18
     C                     MOVEL*BLANK    DGNO19           November 19
     C                     MOVEL*BLANK    DGNO20           November 20
     C                     MOVEL*BLANK    DGNO21           November 21
     C                     MOVEL*BLANK    DGNO22           November 22
     C                     MOVEL*BLANK    DGNO23           November 23
     C                     MOVEL*BLANK    DGNO24           November 24
     C                     MOVEL*BLANK    DGNO25           November 25
     C                     MOVEL*BLANK    DGNO26           November 26
     C                     MOVEL*BLANK    DGNO27           November 27
     C                     MOVEL*BLANK    DGNO28           November 28
     C                     MOVEL*BLANK    DGNO29           November 29
     C                     MOVEL*BLANK    DGNO30           November 30
     C                     MOVEL*BLANK    DGDE01           December 1
     C                     MOVEL*BLANK    DGDE02           December 2
     C                     MOVEL*BLANK    DGDE03           December 3
     C                     MOVEL*BLANK    DGDE04           December 4
     C                     MOVEL*BLANK    DGDE05           December 5
     C                     MOVEL*BLANK    DGDE06           December 6
     C                     MOVEL*BLANK    DGDE07           December 7
     C                     MOVEL*BLANK    DGDE08           December 8
     C                     MOVEL*BLANK    DGDE09           December 9
     C                     MOVEL*BLANK    DGDE10           December 10
     C                     MOVEL*BLANK    DGDE11           December 11
     C                     MOVEL*BLANK    DGDE12           December 12
     C                     MOVEL*BLANK    DGDE13           December 13
     C                     MOVEL*BLANK    DGDE14           December 14
     C                     MOVEL*BLANK    DGDE15           December 15
     C                     MOVEL*BLANK    DGDE16           December 16
     C                     MOVEL*BLANK    DGDE17           December 17
     C                     MOVEL*BLANK    DGDE18           December 18
     C                     MOVEL*BLANK    DGDE19           December 19
     C                     MOVEL*BLANK    DGDE20           December 20
     C                     MOVEL*BLANK    DGDE21           December 21
     C                     MOVEL*BLANK    DGDE22           December 22
     C                     MOVEL*BLANK    DGDE23           December 23
     C                     MOVEL*BLANK    DGDE24           December 24
     C                     MOVEL*BLANK    DGDE25           December 25
     C                     MOVEL*BLANK    DGDE26           December 26
     C                     MOVEL*BLANK    DGDE27           December 27
     C                     MOVEL*BLANK    DGDE28           December 28
     C                     MOVEL*BLANK    DGDE29           December 29
     C                     MOVEL*BLANK    DGDE30           December 30
     C                     MOVEL*BLANK    DGDE31           December 31
     C                     Z-ADDWURDNB    DGLCD            Last Change Dat
     C                     MOVEL'I'       DGTYLC           Type of Last Ch
      *
     C           KLCRSD    KLIST
     C                     KFLD           DGCYCD           Currency Code
     C                     KFLD           DGLCCD           Location Code
     C                     KFLD           DGYRNB           Year Number
      * Check for duplicate primary key
      *                                                                                       CSD031
      ** Use appropriate files                                                                CSD031
      *                                                                                       CSD031
     C           CSD041    IFEQ 'Y'                                                           CSD031
     C                     SELEC                                                              CSD031
      *                                                                                       CSD031
      ** Global                                                                               CSD031
     C           W@MODE    WHEQ 'G'                                                           CSD031
     C           KLCRSD    SETLLSDHOLD0                  90                                   CSD031
      *                                                                                       CSD031
      ** Zonal / Change Mode                                                                  CSD031
     C                     OTHER                                                              CSD031
     C           KLCRSD    SETLL@HOLPHG                  90                                   CSD031
     C                     ENDSL                                                              CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
      *                                                                                       CSD031
     C           KLCRSD    SETLL@HOLPHG                  90*
     C                     ENDIF                                                              CSD031
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0658' W0RTN   7
      * Send message 'Holidays               EX'
     C                     MOVEL'USR0658' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     END
      *
      * If CSD012 is ON and Holidays is ON, output                                            CSD012
      * details to Shadow file and Authoristion Log then exit.                                CSD012
     C           CSD012    IFEQ 'Y'                                                           CSD012
     C           SVAL11    ANDEQ'Y'                                                           CSD012
     C                     WRITESDHOSHD0               91                                     CSD012
      *                                                                                       CSD012
     C                     MOVEL#1CYCD    K1CYCD                                              CSD012
     C                     MOVEL#1LCCD    K1LCCD                                              CSD012
     C                     MOVEL#1YRNB    K1YRNB                                              CSD012
     C           KAULG     CHAINSDAULGL1             90                                       CSD012
      *                                                                                       CSD012
      * If record does not exist write details to Authoristion Log                            CSD012
     C           *IN90     IFEQ *ON                                                           CSD012
     C                     MOVELK1HOL     ALKEY                                               CSD012
     C                     MOVELFUNCD     ALFUNC                                              CSD012
     C                     MOVE 'I'       ALACTN                                              CSD012
     C                     MOVE ##USR     ALUSER                                              CSD012
     C                     WRITESDAULGD0                                                      CSD012
     C                     ENDIF                                                              CSD012
      *                                                                                       CSD012
     C                     GOTO SDEXIT                                                        CSD012
     C                     ELSE                                                               CSD012
      *                                                                                       CSD012
      *                                                                                       CSD031
      ** Use appropriate files                                                                CSD031
      *                                                                                       CSD031
     C           CSD041    IFEQ 'Y'                                                           CSD031
     C                     SELEC                                                              CSD031
      *                                                                                       CSD031
      ** Global                                                                               CSD031
     C           W@MODE    WHEQ 'G'                                                           CSD031
     C                     MOVE #1ACTZ    DGAACC           Accept to Zone                     CSD031
     C                     MOVE W@WFDT    DGEACC           Accept by Effective Date           CSD031
     C                     MOVE 'Y'       DGGPDT           Central Data Indicator             CSD031
     C                     WRITESDHOLD0                91                                     CSD031
      *                                                                                       CSD031
      ** Zonal / Change Mode                                                                  CSD031
     C                     OTHER                                                              CSD031
     C                     WRITE@HOLPHG                91                                     CSD031
     C                     ENDSL                                                              CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
      *                                                                                       CSD031
     C                     WRITE@HOLPHG                91  *
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD012
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
     C                     Z-ADD1         WUNORC           No. of Records
     C                     Z-ADD1         WUNOIN           No. of Inserts
     C                     Z-ADD*ZERO     WUNOAM           No. of Amends
     C                     Z-ADD*ZERO     WUNODL           No. of Deletes
     C           CSD041    IFEQ 'N'                                                           CSD031
      * Change Standing Data Cont - Standing Data Controls  *
     C                     EXSR SECHRC
     C                     ELSE                                                               CSD031
     C           *INU1     IFEQ *OFF                                                          CSD031
      * Change Standing Data Cont - Standing Data Controls  *                                 CSD031
     C                     EXSR SECHRC                                                        CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
     C                     END
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECHRC    BEGSR
      *================================================================
      * Change Standing Data Cont - Standing Data Controls  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE 'N'       YARDC   1
      *
      * Move key fields to @AHREAU
     C                     MOVE *BLANK    AHFLNM           Filename
     C                     MOVEL'SDHOLPD' AHFLNM           Filename
      *
     C           KLCHSE    KLIST
     C                     KFLD           AHFLNM           Filename
     C           KLCHSE    CHAIN@AHREAU              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     END
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     GOTO SEEXIT
     C                     END
      *
      * Store record data for null update check
     C                     MOVE QSDFC1    YARDCS
      * USER: Processing after Data read
     C                     ADD  AHNORC    WUNORC           No. of Records
     C                     ADD  AHNOIN    WUNOIN           No. of Inserts
     C                     ADD  AHNOAM    WUNOAM           No. of Amends
     C                     ADD  AHNODL    WUNODL           No. of Deletes
      * Move non-key fields to @AHREAU
     C                     Z-ADDWUNORC    AHNORC           No. of Records
     C                     Z-ADDWUNOIN    AHNOIN           No. of Inserts
     C                     Z-ADDWUNOAM    AHNOAM           No. of Amends
     C                     Z-ADDWUNODL    AHNODL           No. of Deletes
      *
      * Set PGM.*Record Data Changed flag
     C           QSDFC1    IFNE YARDCS
     C                     MOVE 'Y'       YARDC
     C                     END
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@AHREAU                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKSDFCTLL0               91  *
     C                     END
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     END
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFDLRC    BEGSR
      *================================================================
      * Delete Holidays - Holidays  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data update
      * CASE: PAR.Action Code is Delete
     C           P2ANCD    IFEQ 'D'                        *IF
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * CASE: WRK.Window processing requir. is Yes
     C           WUWDPR    IFEQ 'Y'                        *IF
      * WM call Window Manager - Window manager  *
     C***********          CALL 'WIND01'                                  S01212
     C                     CALL 'WN0010'                                  S01212
     C*********************PARM           ##PGM            Program        S01212
     C                     PARM ##PGM     UPGM   10        Program        S01212
     C*********************PARM *BLANK    FKEY    2        Function Key   S01212
     C                     PARM *BLANK    UFKEY   2        Function Key   S01212
     C*********************PARM           WUMEST           Action  S01212 S01229
     C*********************PARM           WUWMAC           Action  S01212 S01229
     C                     PARM 'D'       UACTCD  1        Action  S01212 S01229
     C                     PARM           DATA             Trans Data     S01212
     C                     PARM *BLANK    W0RTN            Return Code    S01212
     C                     PARM           SPARE 256        Spare Field    LN0355
      * WM Check Return
      * CASE: PAR.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: PAR.*Return code is WN Window Error
     C           W0RTN     IFEQ 'USR0563'                  *IF
      * Send message 'WN Window Error'
     C                     MOVEL'USR0563' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO SFEXIT                     *QUIT
     C                     ELSE
      * CASE: PAR.*Return code is *DBF update error
     C           W0RTN     IFEQ 'Y2U0004'                  *IF
      * Send message 'WN Database Error'
     C                     MOVEL'USR0567' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO SFEXIT                     *QUIT
     C                     ELSE
      * CASE: PAR.*Return code is *Previous Screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO SFEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 00/Copy Member SD0161RDBW - Holidays  *
     C*00/Copy Member SD0161R   Proc Before Delete - WN
     C/COPY WNCPYSRC,SD0161RDBW
     C                     END                             *FI
      * 00/Copy Member SD0161RDBU - Holidays  *
     C*00/Copy Member SD0161R   Processing Before Delete
     C/COPY WNCPYSRC,SD0161RDBU
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Delete is not allowed when the program is in amend or insert
      * mode. Message is sent by the edit record.
     C                     GOTO SFEXIT                     *QUIT
     C                     END                             *FI
      * Move key fields to @HOLPHG
     C                     MOVELP1CYCD    DGCYCD           Currency Code
     C                     MOVELP1LCCD    DGLCCD           Location Code
     C                     MOVELP1YRNB    DGYRNB           Year Number
      *
     C           KLDLSF    KLIST
     C                     KFLD           DGCYCD           Currency Code
     C                     KFLD           DGLCCD           Location Code
     C                     KFLD           DGYRNB           Year Number
      *                                                                                       CSD031
      ** Use appropriate files                                                                CSD031
      *                                                                                       CSD031
     C           CSD041    IFEQ 'Y'                                                           CSD031
     C                     SELEC                                                              CSD031
      *                                                                                       CSD031
      ** Global                                                                               CSD031
     C           W@MODE    WHEQ 'G'                                                           CSD031
     C           KLDLSF    CHAINSDHOLD0              9091                                     CSD031
      *                                                                                       CSD031
      ** Zonal / Change Mode                                                                  CSD031
     C                     OTHER                                                              CSD031
     C           KLDLSF    CHAIN@HOLPHG              9091                                     CSD031
     C                     ENDSL                                                              CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
      *                                                                                       CSD031
     C           KLDLSF    CHAIN@HOLPHG              9091  *
     C                     ENDIF                                                              CSD031
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     END
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     END
      *
      * Check for changed record
     C           #1DBRC    IFNE @1DBRC                     IF
     C                     MOVEL'Y2U0007' W0RTN   7
      * Send message '*Update not accepted'
     C                     MOVEL'Y2U0007' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
      * Release record lock
      *                                                                                       CSD031
      ** Use appropriate files                                                                CSD031
      *                                                                                       CSD031
     C           CSD041    IFEQ 'Y'                                                           CSD031
     C                     SELEC                                                              CSD031
      *                                                                                       CSD031
      ** Global                                                                               CSD031
     C           W@MODE    WHEQ 'G'                                                           CSD031
     C           KLDLSF    SETLLSDHOLD0              9091                                     CSD031
      *                                                                                       CSD031
      ** Zonal / Change Mode                                                                  CSD031
     C                     OTHER                                                              CSD031
     C           KLDLSF    SETLL@HOLPHG              9091                                     CSD031
     C                     ENDSL                                                              CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
      *                                                                                       CSD031
     C           KLDLSF    SETLL@HOLPHG              9091  *
     C                     ENDIF                                                              CSD031
     C                     GOTO SFEXIT
     C                     END                             FI #1DBRC
      *................................................................
      * If CSD012 is ON and Holidays is ON, output                                            CSD012
      * details to Shadow file and Authoristion Log then exit.                                CSD012
     C           CSD012    IFEQ 'Y'                                                           CSD012
     C           SVAL11    ANDEQ'Y'                                                           CSD012
     C                     MOVEL'D'       DGTYLC           Type of Last Ch                    CSD012
     C                     WRITESDHOSHD0               91                                     CSD012
      *                                                                                       CSD012
     C                     MOVEL#1CYCD    K1CYCD                                              CSD012
     C                     MOVEL#1LCCD    K1LCCD                                              CSD012
     C                     MOVEL#1YRNB    K1YRNB                                              CSD012
     C           KAULG     CHAINSDAULGL1             90                                       CSD012
      *                                                                                       CSD012
      * If record does not exist write details to Authoristion Log                            CSD012
     C           *IN90     IFEQ *ON                                                           CSD012
     C                     MOVELK1HOL     ALKEY                                               CSD012
     C                     MOVELFUNCD     ALFUNC                                              CSD012
     C                     MOVE 'D'       ALACTN                                              CSD012
     C                     MOVE ##USR     ALUSER                                              CSD012
     C                     WRITESDAULGD0                                                      CSD012
     C                     ENDIF                                                              CSD012
      *                                                                                       CSD012
     C                     GOTO SFEXIT                                                        CSD012
     C                     ELSE                                                               CSD012
      *                                                                                       CSD012
      *                                                                                       CSD031
      ** Use appropriate files                                                                CSD031
      *                                                                                       CSD031
     C           CSD041    IFEQ 'Y'                                                           CSD031
     C                     SELEC                                                              CSD031
      *                                                                                       CSD031
      ** Global                                                                               CSD031
     C           W@MODE    WHEQ 'G'                                                           CSD031
     C                     DELETSDHOLD0                91                                     CSD031
      *                                                                                       CSD031
      ** Zonal / Change Mode                                                                  CSD031
     C                     OTHER                                                              CSD031
     C                     DELET@HOLPHG                91                                     CSD031
     C           CTI006    IFEQ 'Y'                                                           CTI006
     C                     EXSR SRDELT                                                        CTI006
     C                     ENDIF                                                              CTI006
     C                     ENDSL                                                              CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
      *                                                                                       CSD031
     C                     DELET@HOLPHG                91  *
     C           CTI006    IFEQ 'Y'                                                           CTI006
     C                     EXSR SRDELT                                                        CTI006
     C                     ENDIF                                                              CTI006
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD012
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * DBF delete successful
      * USER: Processing after Data update
     C                     Z-ADD-1        WUNORC           No. of Records
     C                     Z-ADD*ZERO     WUNOIN           No. of Inserts
     C                     Z-ADD*ZERO     WUNOAM           No. of Amends
     C                     Z-ADD1         WUNODL           No. of Deletes
     C           CSD041    IFEQ 'N'                                                           CSD031
      * Change Standing Data Cont - Standing Data Controls  *
     C                     EXSR SGCHRC
      * Once the record has been deleted exit from the program
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy Member SD0161RDAU - Holidays  *
     C*00/Copy Member SD0161R   Processing After Delete
     C/COPY WNCPYSRC,SD0161RDAU
     C                     END                             *FI
     C                     ELSE                                                               CSD031
     C           *INU1     IFEQ *OFF                                                          CSD031
      * Change Standing Data Cont - Standing Data Controls  *                                 CSD031
     C                     EXSR SGCHRC                                                        CSD031
      * Once the record has been deleted exit from the program                                CSD031
     C                     MOVELW0RTN     P0RTN            *Return code                       CSD031
     C                     EXSR ZYEXPG                                                        CSD031
      * CASE: WRK.S01212 is Fix installed                                                     CSD031
     C           WUMFTS    IFEQ 'Y'                        *IF                                CSD031
      * 00/Copy Member SD0161RDAU - Holidays  *                                               CSD031
     C*00/Copy Member SD0161R   Processing After Delete                                       CSD031
     C/COPY WNCPYSRC,SD0161RDAU                                                               CSD031
     C                     END                             *FI                                CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
     C                     END
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCHRC    BEGSR
      *================================================================
      * Change Standing Data Cont - Standing Data Controls  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE 'N'       YBRDC   1
      *
      * Move key fields to @AHREAU
     C                     MOVE *BLANK    AHFLNM           Filename
     C                     MOVEL'SDHOLPD' AHFLNM           Filename
      *
     C           KLCHSG    KLIST
     C                     KFLD           AHFLNM           Filename
     C           KLCHSG    CHAIN@AHREAU              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     END
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     GOTO SGEXIT
     C                     END
      *
      * Store record data for null update check
     C                     MOVE QSDFC1    YBRDCS
      * USER: Processing after Data read
     C                     ADD  AHNORC    WUNORC           No. of Records
     C                     ADD  AHNOIN    WUNOIN           No. of Inserts
     C                     ADD  AHNOAM    WUNOAM           No. of Amends
     C                     ADD  AHNODL    WUNODL           No. of Deletes
      * Move non-key fields to @AHREAU
     C                     Z-ADDWUNORC    AHNORC           No. of Records
     C                     Z-ADDWUNOIN    AHNOIN           No. of Inserts
     C                     Z-ADDWUNOAM    AHNOAM           No. of Amends
     C                     Z-ADDWUNODL    AHNODL           No. of Deletes
      *
      * Set PGM.*Record Data Changed flag
     C           QSDFC1    IFNE YBRDCS
     C                     MOVE 'Y'       YBRDC
     C                     END
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@AHREAU                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKSDFCTLL0               91  *
     C                     END
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     END
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCHRC    BEGSR
      *================================================================
      * Change Holidays - Holidays  *
      *================================================================
      * Clear all neither parameters
     C                     Z-ADD*ZERO     WN0001  50       1st January Day
     C                     Z-ADD*ZERO     WN0002  50       31st December D
     C                     MOVEL*BLANK    WN0003  1        April 1
     C                     MOVEL*BLANK    WN0004  1        April 2
     C                     MOVEL*BLANK    WN0005  1        April 3
     C                     MOVEL*BLANK    WN0006  1        April 4
     C                     MOVEL*BLANK    WN0007  1        April 5
     C                     MOVEL*BLANK    WN0008  1        April 6
     C                     MOVEL*BLANK    WN0009  1        April 7
     C                     MOVEL*BLANK    WN0010  1        April 8
     C                     MOVEL*BLANK    WN0011  1        April 9
     C                     MOVEL*BLANK    WN0012  1        April 10
     C                     MOVEL*BLANK    WN0013  1        April 11
     C                     MOVEL*BLANK    WN0014  1        April 12
     C                     MOVEL*BLANK    WN0015  1        April 13
     C                     MOVEL*BLANK    WN0016  1        April 14
     C                     MOVEL*BLANK    WN0017  1        April 15
     C                     MOVEL*BLANK    WN0018  1        April 16
     C                     MOVEL*BLANK    WN0019  1        April 17
     C                     MOVEL*BLANK    WN0020  1        April 18
     C                     MOVEL*BLANK    WN0021  1        April 19
     C                     MOVEL*BLANK    WN0022  1        April 20
     C                     MOVEL*BLANK    WN0023  1        April 21
     C                     MOVEL*BLANK    WN0024  1        April 22
     C                     MOVEL*BLANK    WN0025  1        April 23
     C                     MOVEL*BLANK    WN0026  1        April 24
     C                     MOVEL*BLANK    WN0027  1        April 25
     C                     MOVEL*BLANK    WN0028  1        April 26
     C                     MOVEL*BLANK    WN0029  1        April 27
     C                     MOVEL*BLANK    WN0030  1        April 28
     C                     MOVEL*BLANK    WN0031  1        April 29
     C                     MOVEL*BLANK    WN0032  1        April 30
     C                     MOVEL*BLANK    WN0033  1        May 1
     C                     MOVEL*BLANK    WN0034  1        May 2
     C                     MOVEL*BLANK    WN0035  1        May 3
     C                     MOVEL*BLANK    WN0036  1        May 4
     C                     MOVEL*BLANK    WN0037  1        May 5
     C                     MOVEL*BLANK    WN0038  1        May 6
     C                     MOVEL*BLANK    WN0039  1        May 7
     C                     MOVEL*BLANK    WN0040  1        May 8
     C                     MOVEL*BLANK    WN0041  1        May 9
     C                     MOVEL*BLANK    WN0042  1        May 10
     C                     MOVEL*BLANK    WN0043  1        May 11
     C                     MOVEL*BLANK    WN0044  1        May 12
     C                     MOVEL*BLANK    WN0045  1        May 13
     C                     MOVEL*BLANK    WN0046  1        May 14
     C                     MOVEL*BLANK    WN0047  1        May 15
     C                     MOVEL*BLANK    WN0048  1        May 16
     C                     MOVEL*BLANK    WN0049  1        May 17
     C                     MOVEL*BLANK    WN0050  1        May 18
     C                     MOVEL*BLANK    WN0051  1        May 19
     C                     MOVEL*BLANK    WN0052  1        May 20
     C                     MOVEL*BLANK    WN0053  1        May 21
     C                     MOVEL*BLANK    WN0054  1        May 22
     C                     MOVEL*BLANK    WN0055  1        May 23
     C                     MOVEL*BLANK    WN0056  1        May 24
     C                     MOVEL*BLANK    WN0057  1        May 25
     C                     MOVEL*BLANK    WN0058  1        May 26
     C                     MOVEL*BLANK    WN0059  1        May 27
     C                     MOVEL*BLANK    WN0060  1        May 28
     C                     MOVEL*BLANK    WN0061  1        May 29
     C                     MOVEL*BLANK    WN0062  1        May 30
     C                     MOVEL*BLANK    WN0063  1        May 31
     C                     MOVEL*BLANK    WN0064  1        June 1
     C                     MOVEL*BLANK    WN0065  1        June 2
     C                     MOVEL*BLANK    WN0066  1        June 3
     C                     MOVEL*BLANK    WN0067  1        June 4
     C                     MOVEL*BLANK    WN0068  1        June 5
     C                     MOVEL*BLANK    WN0069  1        June 6
     C                     MOVEL*BLANK    WN0070  1        June 7
     C                     MOVEL*BLANK    WN0071  1        June 8
     C                     MOVEL*BLANK    WN0072  1        June 9
     C                     MOVEL*BLANK    WN0073  1        June 10
     C                     MOVEL*BLANK    WN0074  1        June 11
     C                     MOVEL*BLANK    WN0075  1        June 12
     C                     MOVEL*BLANK    WN0076  1        June 13
     C                     MOVEL*BLANK    WN0077  1        June 14
     C                     MOVEL*BLANK    WN0078  1        June 15
     C                     MOVEL*BLANK    WN0079  1        June 16
     C                     MOVEL*BLANK    WN0080  1        June 17
     C                     MOVEL*BLANK    WN0081  1        June 18
     C                     MOVEL*BLANK    WN0082  1        June 19
     C                     MOVEL*BLANK    WN0083  1        June 20
     C                     MOVEL*BLANK    WN0084  1        June 21
     C                     MOVEL*BLANK    WN0085  1        June 22
     C                     MOVEL*BLANK    WN0086  1        June 23
     C                     MOVEL*BLANK    WN0087  1        June 24
     C                     MOVEL*BLANK    WN0088  1        June 25
     C                     MOVEL*BLANK    WN0089  1        June 26
     C                     MOVEL*BLANK    WN0090  1        June 27
     C                     MOVEL*BLANK    WN0091  1        June 28
     C                     MOVEL*BLANK    WN0092  1        June 29
     C                     MOVEL*BLANK    WN0093  1        June 30
     C                     MOVEL*BLANK    WN0094  1        July 1
     C                     MOVEL*BLANK    WN0095  1        July 2
     C                     MOVEL*BLANK    WN0096  1        July 3
     C                     MOVEL*BLANK    WN0097  1        July 4
     C                     MOVEL*BLANK    WN0098  1        July 5
     C                     MOVEL*BLANK    WN0099  1        July 6
     C                     MOVEL*BLANK    WN0100  1        July 7
     C                     MOVEL*BLANK    WN0101  1        July 8
     C                     MOVEL*BLANK    WN0102  1        July 9
     C                     MOVEL*BLANK    WN0103  1        July 10
     C                     MOVEL*BLANK    WN0104  1        July 11
     C                     MOVEL*BLANK    WN0105  1        July 12
     C                     MOVEL*BLANK    WN0106  1        July 13
     C                     MOVEL*BLANK    WN0107  1        July 14
     C                     MOVEL*BLANK    WN0108  1        July 15
     C                     MOVEL*BLANK    WN0109  1        July 16
     C                     MOVEL*BLANK    WN0110  1        July 17
     C                     MOVEL*BLANK    WN0111  1        July 18
     C                     MOVEL*BLANK    WN0112  1        July 19
     C                     MOVEL*BLANK    WN0113  1        July 20
     C                     MOVEL*BLANK    WN0114  1        July 21
     C                     MOVEL*BLANK    WN0115  1        July 22
     C                     MOVEL*BLANK    WN0116  1        July 23
     C                     MOVEL*BLANK    WN0117  1        July 24
     C                     MOVEL*BLANK    WN0118  1        July 25
     C                     MOVEL*BLANK    WN0119  1        July 26
     C                     MOVEL*BLANK    WN0120  1        July 27
     C                     MOVEL*BLANK    WN0121  1        July 28
     C                     MOVEL*BLANK    WN0122  1        July 29
     C                     MOVEL*BLANK    WN0123  1        July 30
     C                     MOVEL*BLANK    WN0124  1        July 31
     C                     MOVEL*BLANK    WN0125  1        August 1
     C                     MOVEL*BLANK    WN0126  1        August 2
     C                     MOVEL*BLANK    WN0127  1        August 3
     C                     MOVEL*BLANK    WN0128  1        August 4
     C                     MOVEL*BLANK    WN0129  1        August 5
     C                     MOVEL*BLANK    WN0130  1        August 6
     C                     MOVEL*BLANK    WN0131  1        August 7
     C                     MOVEL*BLANK    WN0132  1        August 8
     C                     MOVEL*BLANK    WN0133  1        August 9
     C                     MOVEL*BLANK    WN0134  1        August 10
     C                     MOVEL*BLANK    WN0135  1        August 11
     C                     MOVEL*BLANK    WN0136  1        August 12
     C                     MOVEL*BLANK    WN0137  1        August 13
     C                     MOVEL*BLANK    WN0138  1        August 14
     C                     MOVEL*BLANK    WN0139  1        August 15
     C                     MOVEL*BLANK    WN0140  1        August 16
     C                     MOVEL*BLANK    WN0141  1        August 17
     C                     MOVEL*BLANK    WN0142  1        August 18
     C                     MOVEL*BLANK    WN0143  1        August 19
     C                     MOVEL*BLANK    WN0144  1        August 20
     C                     MOVEL*BLANK    WN0145  1        August 21
     C                     MOVEL*BLANK    WN0146  1        August 22
     C                     MOVEL*BLANK    WN0147  1        August 23
     C                     MOVEL*BLANK    WN0148  1        August 24
     C                     MOVEL*BLANK    WN0149  1        August 25
     C                     MOVEL*BLANK    WN0150  1        August 26
     C                     MOVEL*BLANK    WN0151  1        August 27
     C                     MOVEL*BLANK    WN0152  1        August 28
     C                     MOVEL*BLANK    WN0153  1        August 29
     C                     MOVEL*BLANK    WN0154  1        August 30
     C                     MOVEL*BLANK    WN0155  1        August 31
     C                     MOVEL*BLANK    WN0156  1        September 1
     C                     MOVEL*BLANK    WN0157  1        September 2
     C                     MOVEL*BLANK    WN0158  1        September 3
     C                     MOVEL*BLANK    WN0159  1        September 4
     C                     MOVEL*BLANK    WN0160  1        September 5
     C                     MOVEL*BLANK    WN0161  1        September 6
     C                     MOVEL*BLANK    WN0162  1        September 7
     C                     MOVEL*BLANK    WN0163  1        September 8
     C                     MOVEL*BLANK    WN0164  1        September 9
     C                     MOVEL*BLANK    WN0165  1        September 10
     C                     MOVEL*BLANK    WN0166  1        September 11
     C                     MOVEL*BLANK    WN0167  1        September 12
     C                     MOVEL*BLANK    WN0168  1        September 13
     C                     MOVEL*BLANK    WN0169  1        September 14
     C                     MOVEL*BLANK    WN0170  1        September 15
     C                     MOVEL*BLANK    WN0171  1        September 16
     C                     MOVEL*BLANK    WN0172  1        September 17
     C                     MOVEL*BLANK    WN0173  1        September 18
     C                     MOVEL*BLANK    WN0174  1        September 19
     C                     MOVEL*BLANK    WN0175  1        September 20
     C                     MOVEL*BLANK    WN0176  1        September 21
     C                     MOVEL*BLANK    WN0177  1        September 22
     C                     MOVEL*BLANK    WN0178  1        September 23
     C                     MOVEL*BLANK    WN0179  1        September 24
     C                     MOVEL*BLANK    WN0180  1        September 25
     C                     MOVEL*BLANK    WN0181  1        September 26
     C                     MOVEL*BLANK    WN0182  1        September 27
     C                     MOVEL*BLANK    WN0183  1        September 28
     C                     MOVEL*BLANK    WN0184  1        September 29
     C                     MOVEL*BLANK    WN0185  1        September 30
     C                     MOVEL*BLANK    WN0186  1        October 1
     C                     MOVEL*BLANK    WN0187  1        October 2
     C                     MOVEL*BLANK    WN0188  1        October 3
     C                     MOVEL*BLANK    WN0189  1        October 4
     C                     MOVEL*BLANK    WN0190  1        October 5
     C                     MOVEL*BLANK    WN0191  1        October 6
     C                     MOVEL*BLANK    WN0192  1        October 7
     C                     MOVEL*BLANK    WN0193  1        October 8
     C                     MOVEL*BLANK    WN0194  1        October 9
     C                     MOVEL*BLANK    WN0195  1        October 10
     C                     MOVEL*BLANK    WN0196  1        October 11
     C                     MOVEL*BLANK    WN0197  1        October 12
     C                     MOVEL*BLANK    WN0198  1        October 13
     C                     MOVEL*BLANK    WN0199  1        October 14
     C                     MOVEL*BLANK    WN0200  1        October 15
     C                     MOVEL*BLANK    WN0201  1        October 16
     C                     MOVEL*BLANK    WN0202  1        October 17
     C                     MOVEL*BLANK    WN0203  1        October 18
     C                     MOVEL*BLANK    WN0204  1        October 19
     C                     MOVEL*BLANK    WN0205  1        October 20
     C                     MOVEL*BLANK    WN0206  1        October 21
     C                     MOVEL*BLANK    WN0207  1        October 22
     C                     MOVEL*BLANK    WN0208  1        October 23
     C                     MOVEL*BLANK    WN0209  1        October 24
     C                     MOVEL*BLANK    WN0210  1        October 25
     C                     MOVEL*BLANK    WN0211  1        October 26
     C                     MOVEL*BLANK    WN0212  1        October 27
     C                     MOVEL*BLANK    WN0213  1        October 28
     C                     MOVEL*BLANK    WN0214  1        October 29
     C                     MOVEL*BLANK    WN0215  1        October 30
     C                     MOVEL*BLANK    WN0216  1        October 31
     C                     MOVEL*BLANK    WN0217  1        November 1
     C                     MOVEL*BLANK    WN0218  1        November 2
     C                     MOVEL*BLANK    WN0219  1        November 3
     C                     MOVEL*BLANK    WN0220  1        November 4
     C                     MOVEL*BLANK    WN0221  1        November 5
     C                     MOVEL*BLANK    WN0222  1        November 6
     C                     MOVEL*BLANK    WN0223  1        November 7
     C                     MOVEL*BLANK    WN0224  1        November 8
     C                     MOVEL*BLANK    WN0225  1        November 9
     C                     MOVEL*BLANK    WN0226  1        November 10
     C                     MOVEL*BLANK    WN0227  1        November 11
     C                     MOVEL*BLANK    WN0228  1        November 12
     C                     MOVEL*BLANK    WN0229  1        November 13
     C                     MOVEL*BLANK    WN0230  1        November 14
     C                     MOVEL*BLANK    WN0231  1        November 15
     C                     MOVEL*BLANK    WN0232  1        November 16
     C                     MOVEL*BLANK    WN0233  1        November 17
     C                     MOVEL*BLANK    WN0234  1        November 18
     C                     MOVEL*BLANK    WN0235  1        November 19
     C                     MOVEL*BLANK    WN0236  1        November 20
     C                     MOVEL*BLANK    WN0237  1        November 21
     C                     MOVEL*BLANK    WN0238  1        November 22
     C                     MOVEL*BLANK    WN0239  1        November 23
     C                     MOVEL*BLANK    WN0240  1        November 24
     C                     MOVEL*BLANK    WN0241  1        November 25
     C                     MOVEL*BLANK    WN0242  1        November 26
     C                     MOVEL*BLANK    WN0243  1        November 27
     C                     MOVEL*BLANK    WN0244  1        November 28
     C                     MOVEL*BLANK    WN0245  1        November 29
     C                     MOVEL*BLANK    WN0246  1        November 30
     C                     MOVEL*BLANK    WN0247  1        December 1
     C                     MOVEL*BLANK    WN0248  1        December 2
     C                     MOVEL*BLANK    WN0249  1        December 3
     C                     MOVEL*BLANK    WN0250  1        December 4
     C                     MOVEL*BLANK    WN0251  1        December 5
     C                     MOVEL*BLANK    WN0252  1        December 6
     C                     MOVEL*BLANK    WN0253  1        December 7
     C                     MOVEL*BLANK    WN0254  1        December 8
     C                     MOVEL*BLANK    WN0255  1        December 9
     C                     MOVEL*BLANK    WN0256  1        December 10
     C                     MOVEL*BLANK    WN0257  1        December 11
     C                     MOVEL*BLANK    WN0258  1        December 12
     C                     MOVEL*BLANK    WN0259  1        December 13
     C                     MOVEL*BLANK    WN0260  1        December 14
     C                     MOVEL*BLANK    WN0261  1        December 15
     C                     MOVEL*BLANK    WN0262  1        December 16
     C                     MOVEL*BLANK    WN0263  1        December 17
     C                     MOVEL*BLANK    WN0264  1        December 18
     C                     MOVEL*BLANK    WN0265  1        December 19
     C                     MOVEL*BLANK    WN0266  1        December 20
     C                     MOVEL*BLANK    WN0267  1        December 21
     C                     MOVEL*BLANK    WN0268  1        December 22
     C                     MOVEL*BLANK    WN0269  1        December 23
     C                     MOVEL*BLANK    WN0270  1        December 24
     C                     MOVEL*BLANK    WN0271  1        December 25
     C                     MOVEL*BLANK    WN0272  1        December 26
     C                     MOVEL*BLANK    WN0273  1        December 27
     C                     MOVEL*BLANK    WN0274  1        December 28
     C                     MOVEL*BLANK    WN0275  1        December 29
     C                     MOVEL*BLANK    WN0276  1        December 30
     C                     MOVEL*BLANK    WN0277  1        December 31
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE 'N'       YCRDC   1
      *
      * Move key fields to @HOLPHG
     C                     MOVEL#1CYCD    DGCYCD           Currency Code
     C                     MOVEL#1LCCD    DGLCCD           Location Code
     C                     MOVEL#1YRNB    DGYRNB           Year Number
      *
     C           KLCHSH    KLIST
     C                     KFLD           DGCYCD           Currency Code
     C                     KFLD           DGLCCD           Location Code
     C                     KFLD           DGYRNB           Year Number
      *                                                                                       CSD031
      ** Use appropriate files                                                                CSD031
      *                                                                                       CSD031
     C           CSD041    IFEQ 'Y'                                                           CSD031
     C                     SELEC                                                              CSD031
      *                                                                                       CSD031
      ** Global                                                                               CSD031
     C           W@MODE    WHEQ 'G'                                                           CSD031
     C           KLCHSH    CHAINSDHOLD0              9091                                     CSD031
      *                                                                                       CSD031
      ** Zonal / Change Mode                                                                  CSD031
     C                     OTHER                                                              CSD031
     C           KLCHSH    CHAIN@HOLPHG              9091                                     CSD031
     C                     ENDSL                                                              CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
      *                                                                                       CSD031
     C           KLCHSH    CHAIN@HOLPHG              9091  *
     C                     ENDIF                                                              CSD031
      *
      * If CSD012 is ON and Holidays is ON, do not worry about record                         CSD012
      * not being found on SDHOLPD check on shadow file.                                      CSD012
     C           *IN90     IFEQ '1'                                                           CSD012
     C           CSD012    IFEQ 'Y'                                                           CSD012
     C           SVAL11    ANDEQ'Y'                                                           CSD012
     C           KRTV      CHAINSDHOSHL0             9091  *                                  CSD012
     C                     MOVEL@2DBRC    @1DBRC                                              CSD012
      *                                                                                       CSD012
      * Ensure key values are not lost.                                                       CSD012
     C                     MOVEL#1CYCD    DGCYCD           Currency Code                      CSD012
     C                     MOVEL#1LCCD    DGLCCD           Location Code                      CSD012
     C                     MOVEL#1YRNB    DGYRNB           Year Number                        CSD012
     C                     ENDIF                                                              CSD012
     C                     ENDIF                                                              CSD012
      *
     C           *IN90     IFEQ '1'
      *
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     END
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     GOTO SHEXIT
     C                     END
      *
      * Check for changed record
     C           #1DBRC    IFNE @1DBRC                     IF
     C                     MOVEL'Y2U0007' W0RTN   7
      * Send message '*Update not accepted'
     C                     MOVEL'Y2U0007' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
      * Release record lock
     C                     UNLCKSDHOLL0                91  *
     C           CSD012    IFEQ 'Y'                                                           CSD012
     C           SVAL11    ANDEQ'Y'                                                           CSD012
     C                     UNLCKSDHOSHL0               91  *                                  CSD012
     C                     ENDIF                                                              CSD012
     C                     GOTO SHEXIT
     C                     END                             FI #1DBRC
      * Store record data for null update check
     C                     MOVE @1DBRC    YCRDCS
      * Move non-key fields to @HOLPHG
     C                     MOVELWUJA01    DGJA01           January 1
     C                     MOVELWUJA02    DGJA02           January 2
     C                     MOVELWUJA03    DGJA03           January 3
     C                     MOVELWUJA04    DGJA04           January 4
     C                     MOVELWUJA05    DGJA05           January 5
     C                     MOVELWUJA06    DGJA06           January 6
     C                     MOVELWUJA07    DGJA07           January 7
     C                     MOVELWUJA08    DGJA08           January 8
     C                     MOVELWUJA09    DGJA09           January 9
     C                     MOVELWUJA10    DGJA10           January 10
     C                     MOVELWUJA11    DGJA11           January 11
     C                     MOVELWUJA12    DGJA12           January 12
     C                     MOVELWUJA13    DGJA13           January 13
     C                     MOVELWUJA14    DGJA14           January 14
     C                     MOVELWUJA15    DGJA15           January 15
     C                     MOVELWUJA16    DGJA16           January 16
     C                     MOVELWUJA17    DGJA17           January 17
     C                     MOVELWUJA18    DGJA18           January 18
     C                     MOVELWUJA19    DGJA19           January 19
     C                     MOVELWUJA20    DGJA20           January 20
     C                     MOVELWUJA21    DGJA21           January 21
     C                     MOVELWUJA22    DGJA22           January 22
     C                     MOVELWUJA23    DGJA23           January 23
     C                     MOVELWUJA24    DGJA24           January 24
     C                     MOVELWUJA25    DGJA25           January 25
     C                     MOVELWUJA26    DGJA26           January 26
     C                     MOVELWUJA27    DGJA27           January 27
     C                     MOVELWUJA28    DGJA28           January 28
     C                     MOVELWUJA29    DGJA29           January 29
     C                     MOVELWUJA30    DGJA30           January 30
     C                     MOVELWUJA31    DGJA31           January 31
     C                     MOVELWUFE01    DGFE01           February 1
     C                     MOVELWUFE02    DGFE02           February 2
     C                     MOVELWUFE03    DGFE03           February 3
     C                     MOVELWUFE04    DGFE04           February 4
     C                     MOVELWUFE05    DGFE05           February 5
     C                     MOVELWUFE06    DGFE06           February 6
     C                     MOVELWUFE07    DGFE07           February 7
     C                     MOVELWUFE08    DGFE08           February 8
     C                     MOVELWUFE09    DGFE09           February 9
     C                     MOVELWUFE10    DGFE10           February 10
     C                     MOVELWUFE11    DGFE11           February 11
     C                     MOVELWUFE12    DGFE12           February 12
     C                     MOVELWUFE13    DGFE13           February 13
     C                     MOVELWUFE14    DGFE14           February 14
     C                     MOVELWUFE15    DGFE15           February 15
     C                     MOVELWUFE16    DGFE16           February 16
     C                     MOVELWUFE17    DGFE17           February 17
     C                     MOVELWUFE18    DGFE18           February 18
     C                     MOVELWUFE19    DGFE19           February 19
     C                     MOVELWUFE20    DGFE20           February 20
     C                     MOVELWUFE21    DGFE21           February 21
     C                     MOVELWUFE22    DGFE22           February 22
     C                     MOVELWUFE23    DGFE23           February 23
     C                     MOVELWUFE24    DGFE24           February 24
     C                     MOVELWUFE25    DGFE25           February 25
     C                     MOVELWUFE26    DGFE26           February 26
     C                     MOVELWUFE27    DGFE27           February 27
     C                     MOVELWUFE28    DGFE28           February 28
     C                     MOVELWUFE29    DGFE29           February 29
     C                     MOVELWUMA01    DGMA01           March 1
     C                     MOVELWUMA02    DGMA02           March 2
     C                     MOVELWUMA03    DGMA03           March 3
     C                     MOVELWUMA04    DGMA04           March 4
     C                     MOVELWUMA05    DGMA05           March 5
     C                     MOVELWUMA06    DGMA06           March 6
     C                     MOVELWUMA07    DGMA07           March 7
     C                     MOVELWUMA08    DGMA08           March 8
     C                     MOVELWUMA09    DGMA09           March 9
     C                     MOVELWUMA10    DGMA10           March 10
     C                     MOVELWUMA11    DGMA11           March 11
     C                     MOVELWUMA12    DGMA12           March 12
     C                     MOVELWUMA13    DGMA13           March 13
     C                     MOVELWUMA14    DGMA14           March 14
     C                     MOVELWUMA15    DGMA15           March 15
     C                     MOVELWUMA16    DGMA16           March 16
     C                     MOVELWUMA17    DGMA17           March 17
     C                     MOVELWUMA18    DGMA18           March 18
     C                     MOVELWUMA19    DGMA19           March 19
     C                     MOVELWUMA20    DGMA20           March 20
     C                     MOVELWUMA21    DGMA21           March 21
     C                     MOVELWUMA22    DGMA22           March 22
     C                     MOVELWUMA23    DGMA23           March 23
     C                     MOVELWUMA24    DGMA24           March 24
     C                     MOVELWUMA25    DGMA25           March 25
     C                     MOVELWUMA26    DGMA26           March 26
     C                     MOVELWUMA27    DGMA27           March 27
     C                     MOVELWUMA28    DGMA28           March 28
     C                     MOVELWUMA29    DGMA29           March 29
     C                     MOVELWUMA30    DGMA30           March 30
     C                     MOVELWUMA31    DGMA31           March 31
     C                     Z-ADDWURDNB    DGLCD            Last Change Dat
     C                     MOVELWUTYLC    DGTYLC           Type of Last Ch
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YCRDCS
     C                     MOVE 'Y'       YCRDC
     C                     END
      * USER: Processing before Data update
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * CASE: WRK.Window processing requir. is Yes
     C           WUWDPR    IFEQ 'Y'                        *IF
      * WM call Window Manager - Window manager  *
     C***********          CALL 'WIND01'                                  S01212
     C                     CALL 'WN0010'                                  S01212
     C*********************PARM           ##PGM            Program        S01212
     C                     PARM ##PGM     UPGM   10        Program        S01212
     C*********************PARM *BLANK    FKEY    2        Function Key   S01212
     C                     PARM *BLANK    UFKEY   2        Function Key   S01212
     C*********************PARM           WUMEST           Action  S01212 S01229
     C*********************PARM           WUWMAC           Action  S01212 S01229
     C                     PARM 'A'       UACTCD  1        Action  S01212 S01229
     C                     PARM           DATA             Trans Data     S01212
     C                     PARM *BLANK    W0RTN            Return Code    S01212
     C                     PARM           SPARE 256        Spare Field    LN0355
      * WM Check Return
      * CASE: PAR.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: PAR.*Return code is WN Window Error
     C           W0RTN     IFEQ 'USR0563'                  *IF
      * Send message 'WN Window Error'
     C                     MOVEL'USR0563' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO SHEXIT                     *QUIT
     C                     ELSE
      * CASE: PAR.*Return code is *DBF update error
     C           W0RTN     IFEQ 'Y2U0004'                  *IF
      * Send message 'WN Database Error'
     C                     MOVEL'USR0567' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO SHEXIT                     *QUIT
     C                     ELSE
      * CASE: PAR.*Return code is *Previous Screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO SHEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 00/Copy Member SD0161RBUW - Holidays  *
     C*00/Copy Member SD0161R   Before Update, Window on
     C/COPY WNCPYSRC,SD0161RBUW
     C                     END                             *FI
      * Ensure that file is updated.
     C                     MOVEL'Y'       YCRDC            *Record Data Ch
      * 00/Copy Member SD0161RBDU - Holidays  *
     C*00/Copy Member SD0161R   Processing Before Update
     C/COPY WNCPYSRC,SD0161RBDU
     C                     END                             *FI
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YCRDCS
     C                     MOVE 'Y'       YCRDC
     C                     END
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
      *                                                                                       CSD012
      * If CSD012 is ON and Holidays is ON, output                                            CSD012
      * details to Shadow file and Authoristion Log then exit.                                CSD012
     C           CSD012    IFEQ 'Y'                                                           CSD012
     C           SVAL11    ANDEQ'Y'                                                           CSD012
     C           KLCHSH    CHAINSDHOSHL0             90                                       CSD012
     C           *IN90     IFEQ *ON                                                           CSD012
     C                     WRITESDHOSHD0                                                      CSD012
     C                     ELSE                                                               CSD012
     C                     MOVELWUJA01    DGJA01           January 1                          CSD012
     C                     MOVELWUJA02    DGJA02           January 2                          CSD012
     C                     MOVELWUJA03    DGJA03           January 3                          CSD012
     C                     MOVELWUJA04    DGJA04           January 4                          CSD012
     C                     MOVELWUJA05    DGJA05           January 5                          CSD012
     C                     MOVELWUJA06    DGJA06           January 6                          CSD012
     C                     MOVELWUJA07    DGJA07           January 7                          CSD012
     C                     MOVELWUJA08    DGJA08           January 8                          CSD012
     C                     MOVELWUJA09    DGJA09           January 9                          CSD012
     C                     MOVELWUJA10    DGJA10           January 10                         CSD012
     C                     MOVELWUJA11    DGJA11           January 11                         CSD012
     C                     MOVELWUJA12    DGJA12           January 12                         CSD012
     C                     MOVELWUJA13    DGJA13           January 13                         CSD012
     C                     MOVELWUJA14    DGJA14           January 14                         CSD012
     C                     MOVELWUJA15    DGJA15           January 15                         CSD012
     C                     MOVELWUJA16    DGJA16           January 16                         CSD012
     C                     MOVELWUJA17    DGJA17           January 17                         CSD012
     C                     MOVELWUJA18    DGJA18           January 18                         CSD012
     C                     MOVELWUJA19    DGJA19           January 19                         CSD012
     C                     MOVELWUJA20    DGJA20           January 20                         CSD012
     C                     MOVELWUJA21    DGJA21           January 21                         CSD012
     C                     MOVELWUJA22    DGJA22           January 22                         CSD012
     C                     MOVELWUJA23    DGJA23           January 23                         CSD012
     C                     MOVELWUJA24    DGJA24           January 24                         CSD012
     C                     MOVELWUJA25    DGJA25           January 25                         CSD012
     C                     MOVELWUJA26    DGJA26           January 26                         CSD012
     C                     MOVELWUJA27    DGJA27           January 27                         CSD012
     C                     MOVELWUJA28    DGJA28           January 28                         CSD012
     C                     MOVELWUJA29    DGJA29           January 29                         CSD012
     C                     MOVELWUJA30    DGJA30           January 30                         CSD012
     C                     MOVELWUJA31    DGJA31           January 31                         CSD012
     C                     MOVELWUFE01    DGFE01           February 1                         CSD012
     C                     MOVELWUFE02    DGFE02           February 2                         CSD012
     C                     MOVELWUFE03    DGFE03           February 3                         CSD012
     C                     MOVELWUFE04    DGFE04           February 4                         CSD012
     C                     MOVELWUFE05    DGFE05           February 5                         CSD012
     C                     MOVELWUFE06    DGFE06           February 6                         CSD012
     C                     MOVELWUFE07    DGFE07           February 7                         CSD012
     C                     MOVELWUFE08    DGFE08           February 8                         CSD012
     C                     MOVELWUFE09    DGFE09           February 9                         CSD012
     C                     MOVELWUFE10    DGFE10           February 10                        CSD012
     C                     MOVELWUFE11    DGFE11           February 11                        CSD012
     C                     MOVELWUFE12    DGFE12           February 12                        CSD012
     C                     MOVELWUFE13    DGFE13           February 13                        CSD012
     C                     MOVELWUFE14    DGFE14           February 14                        CSD012
     C                     MOVELWUFE15    DGFE15           February 15                        CSD012
     C                     MOVELWUFE16    DGFE16           February 16                        CSD012
     C                     MOVELWUFE17    DGFE17           February 17                        CSD012
     C                     MOVELWUFE18    DGFE18           February 18                        CSD012
     C                     MOVELWUFE19    DGFE19           February 19                        CSD012
     C                     MOVELWUFE20    DGFE20           February 20                        CSD012
     C                     MOVELWUFE21    DGFE21           February 21                        CSD012
     C                     MOVELWUFE22    DGFE22           February 22                        CSD012
     C                     MOVELWUFE23    DGFE23           February 23                        CSD012
     C                     MOVELWUFE24    DGFE24           February 24                        CSD012
     C                     MOVELWUFE25    DGFE25           February 25                        CSD012
     C                     MOVELWUFE26    DGFE26           February 26                        CSD012
     C                     MOVELWUFE27    DGFE27           February 27                        CSD012
     C                     MOVELWUFE28    DGFE28           February 28                        CSD012
     C                     MOVELWUFE29    DGFE29           February 29                        CSD012
     C                     MOVELWUMA01    DGMA01           March 1                            CSD012
     C                     MOVELWUMA02    DGMA02           March 2                            CSD012
     C                     MOVELWUMA03    DGMA03           March 3                            CSD012
     C                     MOVELWUMA04    DGMA04           March 4                            CSD012
     C                     MOVELWUMA05    DGMA05           March 5                            CSD012
     C                     MOVELWUMA06    DGMA06           March 6                            CSD012
     C                     MOVELWUMA07    DGMA07           March 7                            CSD012
     C                     MOVELWUMA08    DGMA08           March 8                            CSD012
     C                     MOVELWUMA09    DGMA09           March 9                            CSD012
     C                     MOVELWUMA10    DGMA10           March 10                           CSD012
     C                     MOVELWUMA11    DGMA11           March 11                           CSD012
     C                     MOVELWUMA12    DGMA12           March 12                           CSD012
     C                     MOVELWUMA13    DGMA13           March 13                           CSD012
     C                     MOVELWUMA14    DGMA14           March 14                           CSD012
     C                     MOVELWUMA15    DGMA15           March 15                           CSD012
     C                     MOVELWUMA16    DGMA16           March 16                           CSD012
     C                     MOVELWUMA17    DGMA17           March 17                           CSD012
     C                     MOVELWUMA18    DGMA18           March 18                           CSD012
     C                     MOVELWUMA19    DGMA19           March 19                           CSD012
     C                     MOVELWUMA20    DGMA20           March 20                           CSD012
     C                     MOVELWUMA21    DGMA21           March 21                           CSD012
     C                     MOVELWUMA22    DGMA22           March 22                           CSD012
     C                     MOVELWUMA23    DGMA23           March 23                           CSD012
     C                     MOVELWUMA24    DGMA24           March 24                           CSD012
     C                     MOVELWUMA25    DGMA25           March 25                           CSD012
     C                     MOVELWUMA26    DGMA26           March 26                           CSD012
     C                     MOVELWUMA27    DGMA27           March 27                           CSD012
     C                     MOVELWUMA28    DGMA28           March 28                           CSD012
     C                     MOVELWUMA29    DGMA29           March 29                           CSD012
     C                     MOVELWUMA30    DGMA30           March 30                           CSD012
     C                     MOVELWUMA31    DGMA31           March 31                           CSD012
     C                     Z-ADDWURDNB    DGLCD            Last Change Dat                    CSD012
     C                     MOVELWUTYLC    DGTYLC           Type of Last Ch                    CSD012
     C                     UPDATSDHOSHD0                                                      CSD012
     C                     ENDIF                                                              CSD012
      *                                                                                       CSD012
     C                     MOVEL#1CYCD    K1CYCD                                              CSD012
     C                     MOVEL#1LCCD    K1LCCD                                              CSD012
     C                     MOVEL#1YRNB    K1YRNB                                              CSD012
     C           KAULG     CHAINSDAULGL1             90                                       CSD012
      *                                                                                       CSD012
      * If record does not exist write details to Authoristion Log                            CSD012
     C           *IN90     IFEQ *ON                                                           CSD012
     C                     MOVELK1HOL     ALKEY                                               CSD012
     C                     MOVELFUNCD     ALFUNC                                              CSD012
     C                     MOVE 'A'       ALACTN                                              CSD012
     C                     MOVE ##USR     ALUSER                                              CSD012
     C                     WRITESDAULGD0                                                      CSD012
     C                     ENDIF                                                              CSD012
      *                                                                                       CSD012
     C                     GOTO SHEXIT                                                        CSD012
     C                     ELSE                                                               CSD012
      *                                                                                       CSD012
      *                                                                                       CSD031
      ** Use appropriate files                                                                CSD031
      *                                                                                       CSD031
     C           CSD041    IFEQ 'Y'                                                           CSD031
     C                     SELEC                                                              CSD031
      *                                                                                       CSD031
      ** Global                                                                               CSD031
     C           W@MODE    WHEQ 'G'                                                           CSD031
     C                     MOVE #1ACTZ    DGAACC                                              CSD031
     C                     MOVE W@WFDT    DGEACC                                              CSD031
     C                     MOVE 'Y'       DGGPDT                                              CSD031
     C                     UPDATSDHOLD0                91                                     CSD031
      *                                                                                       CSD031
      ** Zonal / Change Mode                                                                  CSD031
     C                     OTHER                                                              CSD031
     C                     UPDAT@HOLPHG                91                                     CSD031
     C                     ENDSL                                                              CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
      *                                                                                       CSD031
     C                     UPDAT@HOLPHG                91  *
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD012
     C                     ELSE
      * Release record lock
     C                     UNLCKSDHOLL0                91  *
     C           CSD012    IFEQ 'Y'                                                           CSD012
     C           SVAL11    ANDEQ'Y'                                                           CSD012
     C                     UNLCKSDHOSHL0               91  *                                  CSD012
     C                     ENDIF                                                              CSD012
     C                     END
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * Update saved record image
     C                     MOVEL@1DBRC    #1DBRC
      * DBF change successful
      * USER: Processing after Data update
      * Since the first edit record may be called more than once should
      * only update the file controls once i.e. first time only
      * CASE: PAR.Program recalled is Program first time
     C           P5PGMR    IFEQ 'N'                        *IF
     C                     Z-ADD*ZERO     WUNORC           No. of Records
     C                     Z-ADD*ZERO     WUNOIN           No. of Inserts
     C                     Z-ADD1         WUNOAM           No. of Amends
     C                     Z-ADD*ZERO     WUNODL           No. of Deletes
     C           CSD041    IFEQ 'N'                                                           CSD031
      * Change Standing Data Cont - Standing Data Controls  *
     C                     EXSR SICHRC
     C                     ELSE                                                               CSD031
     C           *INU1     IFEQ *OFF                                                          CSD031
      * Change Standing Data Cont - Standing Data Controls  *                                 CSD031
     C                     EXSR SICHRC                                                        CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
     C                     END                             *FI
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy Member SD0162RADU - Holidays  *
     C*00/Copy Member SD0162R   Processing After Update
     C/COPY WNCPYSRC,SD0162RADU
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICHRC    BEGSR
      *================================================================
      * Change Standing Data Cont - Standing Data Controls  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE 'N'       YDRDC   1
      *
      * Move key fields to @AHREAU
     C                     MOVE *BLANK    AHFLNM           Filename
     C                     MOVEL'SDHOLPD' AHFLNM           Filename
      *
     C           KLCHSI    KLIST
     C                     KFLD           AHFLNM           Filename
     C           KLCHSI    CHAIN@AHREAU              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     END
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     GOTO SIEXIT
     C                     END
      *
      * Store record data for null update check
     C                     MOVE QSDFC1    YDRDCS
      * USER: Processing after Data read
     C                     ADD  AHNORC    WUNORC           No. of Records
     C                     ADD  AHNOIN    WUNOIN           No. of Inserts
     C                     ADD  AHNOAM    WUNOAM           No. of Amends
     C                     ADD  AHNODL    WUNODL           No. of Deletes
      * Move non-key fields to @AHREAU
     C                     Z-ADDWUNORC    AHNORC           No. of Records
     C                     Z-ADDWUNOIN    AHNOIN           No. of Inserts
     C                     Z-ADDWUNOAM    AHNOAM           No. of Amends
     C                     Z-ADDWUNODL    AHNODL           No. of Deletes
      *
      * Set PGM.*Record Data Changed flag
     C           QSDFC1    IFNE YDRDCS
     C                     MOVE 'Y'       YDRDC
     C                     END
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@AHREAU                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKSDFCTLL0               91  *
     C                     END
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     END
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Get next working date - Bank Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           BJBANK           Bank
      * Move fields to key list
     C                     MOVE *BLANK    BJBANK           Bank
     C                     MOVEL'BANK'    BJBANK           Bank
     C           KRSSJ     CHAIN@BJREEF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0197' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SJEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     Z-ADDBJDNWD    WUDNWD           Date of Next Wo
     C                     END
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Get 'Window required' ind - MIDAS Modules  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           BGMODS           Modules
      * Move fields to key list
     C                     MOVE *BLANK    BGMODS           Modules
     C                     MOVEL'MMOD'    BGMODS           Modules
     C           KRSSK     CHAIN@BGREC8              90    *
      * Data record not found
     C   90                MOVEL'USR0096' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Window processing requir. is Yes
     C           BGWDPR    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUWDPR           Window processi
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Select existing record
      *================================================================
      * Name search required?
     C                     MOVEL#1CYCD    WK1X01  1
     C                     MOVEL#1LCCD    WK1X02  1
     C                     MOVEL#1YRNB    WK1X03  1
     C           WK1X01    IFEQ '?'                        Currency Code
     C           WK1X02    OREQ '?'                        Location Code
     C           WK1X03    OREQ '?'                        Year Number
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1CYCD' defaulted for 'Currency Code'.
      * Field '(KEY) #1LCCD' defaulted for 'Location Code'.
      * Field '(KEY) #1YRNB' defaulted for 'Year Number'.
     C                     CALL 'SD0160S'              90  Select Holidays
     C                     PARM *BLANK    W0RTN   7
     C           #1CYCD    PARM #1CYCD    WQ0001  3        Currency Code
     C           #1LCCD    PARM #1LCCD    WQ0002  3        Location Code
     C           #1YRNB    PARM #1YRNB    WQ0003  4        Year Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0160S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     993132*
     C                     SETON                     33    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to Currency Codes
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1CYCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Currency Code
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1CYCD' defaulted for 'Currency Code'.
     C                     CALL 'SD0020S'              90  Select Currency
     C                     PARM *BLANK    W0RTN   7
     C           #1CYCD    PARM #1CYCD    WQ0004  3        Currency Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0020S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9931  *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VBEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1CYCD    IFEQ *BLANK                     Currency Code
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBA6    KLIST
     C                     KFLD           A6CYCD           Currency Code
      * Setup key
     C                     MOVEL#1CYCD    A6CYCD           Currency Code
     C           KLVBA6    CHAIN@A6REA3              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
      * Send message 'Currency Codes         NF'
     C                     MOVEL'USR0071' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0071' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Location Codes
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1LCCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Location Code
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1LCCD' defaulted for 'Location Code'.
     C                     CALL 'SD0550S'              90  Select Location
     C                     PARM *BLANK    W0RTN   7
     C           #1LCCD    PARM #1LCCD    WQ0005  3        Location Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0550S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9932  *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1LCCD    IFEQ *BLANK                     Location Code
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCDV    KLIST
     C                     KFLD           DVLCCD           Location Code
      * Setup key
     C                     MOVEL#1LCCD    DVLCCD           Location Code
     C           CSD041    IFEQ 'Y'                                                           CSD031
     C           *INU1     ANDEQ*ON                                                           CSD031
     C           KLVCDV    CHAINSDLOCND0             9091                                     CSD031
     C                     ELSE                                                               CSD031
     C           KLVCDV    CHAIN@DVREHH              9091  *
     C                     ENDIF                                                              CSD031
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     EXSR VLDLCR
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Location Codes         NF'
     C                     MOVEL'USR0653' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0653' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT                                                                                  CSD031
      *                                                                                       CSD031
      *****************************************************************                       CSD031
      *                                                               *                       CSD031
      *  SR031 - Subroutine To Process CSD031 Validations             *                       CSD031
      *                                                               *                       CSD031
      *****************************************************************                       CSD031
      *                                                                                       CSD031
     C           SR031     BEGSR                                                              CSD031
      *                                                                                       CSD031
     C                     MOVEA'00'      *IN,82                                              CSD031
      *                                                                                       CSD031
      ** Validate Accept to Zone and Effective Date fields                                    CSD031
      *                                                                                       CSD031
     C           #1ACTZ    IFEQ *BLANKS                                                       CSD031
     C                     MOVE 'N'       #1ACTZ                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      ** Accept to Zone fields should either be Y or N                                        CSD031
     C           #1ACTZ    IFNE 'Y'                                                           CSD031
     C           #1ACTZ    ANDNE'N'                                                           CSD031
     C                     CALL 'Y2SNMGC'                                                     CSD031
     C                     PARM ##PGM     ZAPGM                                               CSD031
     C                     PARM           ZAPGRL                                              CSD031
     C                     PARM 'CSD0033' ZAMSID                                              CSD031
     C                     PARM ZADFMF    ZAMSGF                                              CSD031
     C                     PARM           UMSDA                                               CSD031
     C                     PARM           ZAMSTP                                              CSD031
     C                     SETON                     9982                                     CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      ** Accept to Zone should be N when Effective Date is entered                            CSD031
     C           #1EFDT    IFNE *BLANKS                                                       CSD031
     C           #1ACTZ    ANDEQ'Y'                                                           CSD031
     C                     CALL 'Y2SNMGC'                                                     CSD031
     C                     PARM ##PGM     ZAPGM                                               CSD031
     C                     PARM           ZAPGRL                                              CSD031
     C                     PARM 'CSD0001' ZAMSID                                              CSD031
     C                     PARM ZADFMF    ZAMSGF                                              CSD031
     C                     PARM           UMSDA                                               CSD031
     C                     PARM           ZAMSTP                                              CSD031
     C                     MOVE *ON       *IN99                                               CSD031
     C                     MOVE *ON       *IN83                                               CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      ** Action code shouldn't be Delete when Effective Date is entered                       CSD031
     C           #1EFDT    IFNE *BLANKS                                                       CSD031
     C           #1ACTZ    ANDEQ'N'                                                           CSD031
     C           P2ANCD    ANDEQ'D'                                                           CSD031
     C                     CALL 'Y2SNMGC'                                                     CSD031
     C                     PARM ##PGM     ZAPGM                                               CSD031
     C                     PARM           ZAPGRL                                              CSD031
     C                     PARM 'CSD0004' ZAMSID                                              CSD031
     C                     PARM ZADFMF    ZAMSGF                                              CSD031
     C                     PARM           UMSDA                                               CSD031
     C                     PARM           ZAMSTP                                              CSD031
     C                     SETON                     9983                                     CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      ** Check if date format is valid                                                        CSD031
     C           #1EFDT    IFEQ *BLANKS                                                       CSD031
     C                     Z-ADD*ZEROS    W@WFDT                                              CSD031
     C                     ELSE                                                               CSD031
     C                     MOVE #1EFDT    W@SCDT                                              CSD031
     C                     CALL 'ZDATE1'               90                                     CSD031
     C                     PARM *BLANKS   W@RTRN  7                                           CSD031
     C                     PARM           W@SCDT  60                                          CSD031
     C                     PARM           W@DFMT  1                                           CSD031
     C                     PARM *ZEROS    W@WFDT  50                                          CSD031
      *                                                                                       CSD031
      ** Call to program ZDATE1 ended in error, send error msg.                               CSD031
     C           *IN90     IFEQ *ON                                                           CSD031
     C                     MOVEL'Y2U0032' W0RTN                                               CSD031
     C                     MOVEL*BLANKS   W0CLPG 10                                           CSD031
     C                     MOVEL'ZDATE1'  W0CLPG                                              CSD031
     C                     MOVEL'Y2U0032' ZAMSID                                              CSD031
     C                     MOVEL'Y2USRMSG'ZAMSGF                                              CSD031
     C                     MOVELW0CLPG    ZAMSDA                                              CSD031
     C                     EXSR ZASNMS                                                        CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      ** If date format is not valid, send error message                                      CSD031
     C           W@RTRN    IFNE *BLANKS                                                       CSD031
     C                     CALL 'Y2SNMGC'                                                     CSD031
     C                     PARM ##PGM     ZAPGM                                               CSD031
     C                     PARM           ZAPGRL                                              CSD031
     C                     PARM 'CSD0015' ZAMSID                                              CSD031
     C                     PARM ZADFMF    ZAMSGF                                              CSD031
     C                     PARM           UMSDA                                               CSD031
     C                     PARM           ZAMSTP                                              CSD031
     C                     SETON                     9983                                     CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     ENDSR                                                              CSD031
      *                                                                                       CSD031
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y1SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y1EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C           @#DFMT    IFEQ '#RCDKEY'
      * KEY Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     END
     C           @#DFMT    IFEQ '#RCDDTL1'
      * DETAIL Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     END
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM 1         YYLGCT  50       # of grps
     C                     PARM W0GRP     YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel and exit from key screen
      *================================================================
      * USER: Exit program processing
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy Member SD0161REPP - Holidays  *
     C*00/Copy Member SD0161R   Exit Program Processing
     C/COPY WNCPYSRC,SD0161REPP
     C                     END                             *FI
      * CASE: KEY.*CMD key is *Exit
     C           *IN03     IFEQ '1'                        *IF
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
      *================================================================                      BG12014
      *VALIDATE LOCATION IF CRE026 IS ON                                                     BG12014
     CSR         VLDLCR    BEGSR                                                             BG12014
      * VALIDATION OF LOCATION CODE IF CRE026 IS ON                                          BG12014
      * IF CRE026 IS INSTALLED AND LOCATION CODE NOT BLANKS                                  BG12014
     C           CRE026    IFEQ 'Y'                                                          BG12014
     C           #1LCCD    ANDNE*BLANKS                                                      BG12014
     C           #1LCCD    ANDNE'***'                                                       BUG13704
     C           *LIKE     DEFN #1LCCD    KLCCD            Location Code                     BG12014
     C           *LIKE     DEFN #1LCCD    KLCCD1                                             BG12014
     C                     MOVELP@VL01    KZONE                                              BG12014
     C                     MOVELP@VL01    KZONE1                                             BG12014
     C* KLIST FOR BRANCH CODE                                                                BG12014
     C           KSDBRC    KLIST                                                             BG12014
     C                     KFLD           KLCCD                                              BG12014
     C                     KFLD           KZONE  10                                          BG12014
     C           KSDBL1    KLIST                                                             BG12014
     C                     KFLD           KLCCD1                                             BG12014
     C                     KFLD           KZONE1 10                                          BG12014
     C                     MOVEL#1LCCD    KLCCD                                              BG12014
     C                     MOVEL#1LCCD    KLCCD1                                             BG12014
     C                     MOVELP@VL01    KZONE                                              BG12014
     C                     MOVELP@VL01    KZONE1                                             BG12014
      *          CHAIN BRANCH FILE                                                           BG12014
      *                                                                                      BG12014
     C           KSDBRC    CHAINSDBRCHD0             90    *                                 BG12014
      *                                                                                      BG12014
     C           *IN90     IFEQ '1'                                                          BG12014
     C*                                                                                      BG12014
     C           KSDBL1    SETLLGZSDBR                                                       BG12014
     C           KSDBL1    READEGZSDBR                   91                                  BG12014
     C           *IN91     IFEQ '0'                                                          BG12014
     C           A8MNBR    ANDEQ*BLANKS                                                      BG12014
     C                     MOVE 'N'       CEND    1                                          BG12014
     C           CEND      DOWEQ'Y'                                                          BG12014
     C                     READ GZSDBR                   90                                  BG12014
     C           *IN90     IFEQ '0'                                                          BG12014
     C           A8MNBR    IFNE *BLANKS                                                      BG12014
     C           A8LCCD    ANDEQKLCCD1                                                       BG12014
     C           A8BRZN    ANDEQKZONE1                                                       BG12014
     C                     MOVEL'Y'       CEND                                               BG12014
     C                     MOVE *OFF      *IN90                                              BG12014
     C                     ENDIF                                                             BG12014
     C           *IN90     IFEQ '1'                                                          BG12014
     C                     MOVEL'Y'       CEND                                               BG12014
     C                     MOVE *ON       *IN90                                              BG12014
     C                     ENDIF                                                             BG12014
     C                     ENDIF                                                             BG12014
     C                     ENDDO                                                             BG12014
     C                     ENDIF                                                             BG12014
     C* ERROR MESSAGE                                                                        BG12014
     C           *IN90     IFEQ '1'                                                          BG12014
     C           *IN91     OREQ '1'                                                          BG12014
     C                     MOVEL'USR9992' ZAMSID                                             BG12014
     C                     MOVEL'SDUSRMSG'ZAMSGF                                             BG12014
     C                     EXSR ZASNMS                                                       BG12014
     C                     SETON                     9932                                    BG12014
     C                     ENDIF                                                             BG12014
     C                     ENDIF                                                             BG12014
     C                     ENDIF                                                             BG12014
     C           LCREXT    ENDSR                                                             BG12014
      *================================================================                      BG12014
      /EJECT                                                                                 BG12014
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     CLOSESDHOSHL0                                                      CSD012
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           *NAMVAR   DEFN           LDA                                                 CSD012
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Setup job date/time
      *
     C                     Z-ADDUDATE     ##JDT
      * Set century digit (If YY prior to 1940 treat as 20YY)
     C           ##JYY     IFLT 40
     C                     Z-ADD1         ##JCC
     C                     ELSE
     C                     Z-ADD0         ##JCC
     C                     END
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Obtain default message file
     C           *NAMVAR   DEFN Y2MGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field S01212
     C                     MOVEL*BLANK    WUMFTS  1
      * Define work field January 1
     C                     MOVEL*BLANK    WUJA01  1
      * Define work field January 2
     C                     MOVEL*BLANK    WUJA02  1
      * Define work field January 3
     C                     MOVEL*BLANK    WUJA03  1
      * Define work field January 4
     C                     MOVEL*BLANK    WUJA04  1
      * Define work field January 5
     C                     MOVEL*BLANK    WUJA05  1
      * Define work field January 6
     C                     MOVEL*BLANK    WUJA06  1
      * Define work field January 7
     C                     MOVEL*BLANK    WUJA07  1
      * Define work field January 8
     C                     MOVEL*BLANK    WUJA08  1
      * Define work field January 9
     C                     MOVEL*BLANK    WUJA09  1
      * Define work field January 10
     C                     MOVEL*BLANK    WUJA10  1
      * Define work field January 11
     C                     MOVEL*BLANK    WUJA11  1
      * Define work field January 12
     C                     MOVEL*BLANK    WUJA12  1
      * Define work field January 13
     C                     MOVEL*BLANK    WUJA13  1
      * Define work field January 14
     C                     MOVEL*BLANK    WUJA14  1
      * Define work field January 15
     C                     MOVEL*BLANK    WUJA15  1
      * Define work field January 16
     C                     MOVEL*BLANK    WUJA16  1
      * Define work field January 17
     C                     MOVEL*BLANK    WUJA17  1
      * Define work field January 18
     C                     MOVEL*BLANK    WUJA18  1
      * Define work field January 19
     C                     MOVEL*BLANK    WUJA19  1
      * Define work field January 20
     C                     MOVEL*BLANK    WUJA20  1
      * Define work field January 21
     C                     MOVEL*BLANK    WUJA21  1
      * Define work field January 22
     C                     MOVEL*BLANK    WUJA22  1
      * Define work field January 23
     C                     MOVEL*BLANK    WUJA23  1
      * Define work field January 24
     C                     MOVEL*BLANK    WUJA24  1
      * Define work field January 25
     C                     MOVEL*BLANK    WUJA25  1
      * Define work field January 26
     C                     MOVEL*BLANK    WUJA26  1
      * Define work field January 27
     C                     MOVEL*BLANK    WUJA27  1
      * Define work field January 28
     C                     MOVEL*BLANK    WUJA28  1
      * Define work field January 29
     C                     MOVEL*BLANK    WUJA29  1
      * Define work field January 30
     C                     MOVEL*BLANK    WUJA30  1
      * Define work field January 31
     C                     MOVEL*BLANK    WUJA31  1
      * Define work field February 1
     C                     MOVEL*BLANK    WUFE01  1
      * Define work field February 2
     C                     MOVEL*BLANK    WUFE02  1
      * Define work field February 3
     C                     MOVEL*BLANK    WUFE03  1
      * Define work field February 4
     C                     MOVEL*BLANK    WUFE04  1
      * Define work field February 5
     C                     MOVEL*BLANK    WUFE05  1
      * Define work field February 6
     C                     MOVEL*BLANK    WUFE06  1
      * Define work field February 7
     C                     MOVEL*BLANK    WUFE07  1
      * Define work field February 8
     C                     MOVEL*BLANK    WUFE08  1
      * Define work field February 9
     C                     MOVEL*BLANK    WUFE09  1
      * Define work field February 10
     C                     MOVEL*BLANK    WUFE10  1
      * Define work field February 11
     C                     MOVEL*BLANK    WUFE11  1
      * Define work field February 12
     C                     MOVEL*BLANK    WUFE12  1
      * Define work field February 13
     C                     MOVEL*BLANK    WUFE13  1
      * Define work field February 14
     C                     MOVEL*BLANK    WUFE14  1
      * Define work field February 15
     C                     MOVEL*BLANK    WUFE15  1
      * Define work field February 16
     C                     MOVEL*BLANK    WUFE16  1
      * Define work field February 17
     C                     MOVEL*BLANK    WUFE17  1
      * Define work field February 18
     C                     MOVEL*BLANK    WUFE18  1
      * Define work field February 19
     C                     MOVEL*BLANK    WUFE19  1
      * Define work field February 20
     C                     MOVEL*BLANK    WUFE20  1
      * Define work field February 21
     C                     MOVEL*BLANK    WUFE21  1
      * Define work field February 22
     C                     MOVEL*BLANK    WUFE22  1
      * Define work field February 23
     C                     MOVEL*BLANK    WUFE23  1
      * Define work field February 24
     C                     MOVEL*BLANK    WUFE24  1
      * Define work field February 25
     C                     MOVEL*BLANK    WUFE25  1
      * Define work field February 26
     C                     MOVEL*BLANK    WUFE26  1
      * Define work field February 27
     C                     MOVEL*BLANK    WUFE27  1
      * Define work field February 28
     C                     MOVEL*BLANK    WUFE28  1
      * Define work field February 29
     C                     MOVEL*BLANK    WUFE29  1
      * Define work field March 1
     C                     MOVEL*BLANK    WUMA01  1
      * Define work field March 2
     C                     MOVEL*BLANK    WUMA02  1
      * Define work field March 3
     C                     MOVEL*BLANK    WUMA03  1
      * Define work field March 4
     C                     MOVEL*BLANK    WUMA04  1
      * Define work field March 5
     C                     MOVEL*BLANK    WUMA05  1
      * Define work field March 6
     C                     MOVEL*BLANK    WUMA06  1
      * Define work field March 7
     C                     MOVEL*BLANK    WUMA07  1
      * Define work field March 8
     C                     MOVEL*BLANK    WUMA08  1
      * Define work field March 9
     C                     MOVEL*BLANK    WUMA09  1
      * Define work field March 10
     C                     MOVEL*BLANK    WUMA10  1
      * Define work field March 11
     C                     MOVEL*BLANK    WUMA11  1
      * Define work field March 12
     C                     MOVEL*BLANK    WUMA12  1
      * Define work field March 13
     C                     MOVEL*BLANK    WUMA13  1
      * Define work field March 14
     C                     MOVEL*BLANK    WUMA14  1
      * Define work field March 15
     C                     MOVEL*BLANK    WUMA15  1
      * Define work field March 16
     C                     MOVEL*BLANK    WUMA16  1
      * Define work field March 17
     C                     MOVEL*BLANK    WUMA17  1
      * Define work field March 18
     C                     MOVEL*BLANK    WUMA18  1
      * Define work field March 19
     C                     MOVEL*BLANK    WUMA19  1
      * Define work field March 20
     C                     MOVEL*BLANK    WUMA20  1
      * Define work field March 21
     C                     MOVEL*BLANK    WUMA21  1
      * Define work field March 22
     C                     MOVEL*BLANK    WUMA22  1
      * Define work field March 23
     C                     MOVEL*BLANK    WUMA23  1
      * Define work field March 24
     C                     MOVEL*BLANK    WUMA24  1
      * Define work field March 25
     C                     MOVEL*BLANK    WUMA25  1
      * Define work field March 26
     C                     MOVEL*BLANK    WUMA26  1
      * Define work field March 27
     C                     MOVEL*BLANK    WUMA27  1
      * Define work field March 28
     C                     MOVEL*BLANK    WUMA28  1
      * Define work field March 29
     C                     MOVEL*BLANK    WUMA29  1
      * Define work field March 30
     C                     MOVEL*BLANK    WUMA30  1
      * Define work field March 31
     C                     MOVEL*BLANK    WUMA31  1
      * Define work field WED. Holiday
     C                     MOVEL*BLANK    WUWEDH  1
      * Define work field MON. Holiday
     C                     MOVEL*BLANK    WUMONH  1
      * Define work field TUES. Holiday
     C                     MOVEL*BLANK    WUTUEH  1
      * Define work field THURS. Holiday
     C                     MOVEL*BLANK    WUTHUH  1
      * Define work field FRI. Holiday
     C                     MOVEL*BLANK    WUFRIH  1
      * Define work field SAT. Holiday
     C                     MOVEL*BLANK    WUSATH  1
      * Define work field SUN. Holiday
     C                     MOVEL*BLANK    WUSUNH  1
      * Define work field Err Code
     C                     MOVEL*BLANK    WUERCD  1
      * Define work field Work Screen Date
     C                     Z-ADD*ZERO     WUWSDT  60
      * Define work field Date format flag
     C                     MOVEL*BLANK    WUDFF   1
      * Define work field Work File Date
     C                     Z-ADD*ZERO     WUWFDT  50
      * Define work field 1st January Day Number
     C                     Z-ADD*ZERO     WUJDNB  50
      * Define work field 31st December Day Number
     C                     Z-ADD*ZERO     WUDDNB  50
      * Define work field Type of Last Change
     C                     MOVEL*BLANK    WUTYLC  1
      * Define work field Run day number
     C                     Z-ADD*ZERO     WURDNB  50
      * Define work field No. of Records
     C                     Z-ADD*ZERO     WUNORC  50
      * Define work field No. of Inserts
     C                     Z-ADD*ZERO     WUNOIN  50
      * Define work field No. of Amends
     C                     Z-ADD*ZERO     WUNOAM  50
      * Define work field No. of Deletes
     C                     Z-ADD*ZERO     WUNODL  50
      * Define work field Window processing requir.
     C                     MOVEL*BLANK    WUWDPR  1
      * Define work field Midas Run Date
     C                     MOVEL*BLANK    WUMRDT  7
      * Define work field Set Up Complete
     C                     MOVEL*BLANK    WUSUC   1
      * Define work field Multi-branching Indicator
     C                     MOVEL*BLANK    WUMBIN  1
      * Define work field Date of Next Working Day
     C                     Z-ADD*ZERO     WUDNWD  50
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      *                                                                                       CSD031
      ** Check if CSD041 is switched on                                                       CSD031
      *                                                                                       CSD031
     C                     CALL 'AOSARDR0'                                                    CSD031
     C                     PARM           PRTCD   7                                           CSD031
     C                     PARM '*VERIFY' POPTN   7                                           CSD031
     C                     PARM 'CSD041'  PSARD   6                                           CSD031
      *                                                                                       CSD031
     C           PRTCD     IFEQ *BLANKS                                                       CSD031
     C                     MOVE 'Y'       CSD041  1                                           CSD031
     C                     MOVE *ON       *IN85                                               CSD031
     C                     MOVE *ON       *IN80                                               CSD031
     C                     ELSE                                                               CSD031
     C                     MOVE 'N'       CSD041                                              CSD031
     C                     MOVE *OFF      *IN85                                               CSD031
     C                     MOVE *OFF      *IN80                                               CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      ** Open related files                                                                   CSD031
     C           CSD041    IFEQ 'Y'                                                           CSD031
     C                     OPEN SD0161R#                                                      CSD031
     C                     OPEN SDCURRL1                                                      CSD031
     C                     OPEN SDLOCNL1                                                      CSD031
     C                     OPEN SDBANKL1                                                      CSD031
     C                     OPEN SDMMODL1                                                      CSD031
     C                     OPEN SDFCTLL0                                                      CSD031
     C                     OPEN SDHOSHL0                                                      CSD031
     C           *INU1     IFEQ *ON                                                           CSD031
     C                     OPEN GPLOCNL1                                                      CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      ** Read GZSDBANKPD Details                                                              CSD031
      *                                                                                       CSD031
     C                     Z-ADD80        PLEN   155                                          CSD031
     C                     MOVE OVRD,1    PCMD   80                                           CSD031
      *                                                                                       CSD031
     C                     CALL 'QCMDEXC'                                                     CSD031
     C                     PARM           PCMD                                                CSD031
     C                     PARM           PLEN                                                CSD031
     C                     OPEN GZSDBANK                                                      CSD031
     C                     READ GZSDBANK                 90                                   CSD031
     C           *IN90     IFEQ *ON                                                           CSD031
     C                     MOVEL'GZSDBANK'DBFILE                                              CSD031
     C                     Z-ADD002       DBASE                                               CSD031
     C                     EXSR *PSSR                                                         CSD031
     C                     ELSE                                                               CSD031
     C                     MOVELGZDFIN    W@DFMT                                              CSD031
     C                     ENDIF                                                              CSD031
     C                     CLOSEGZSDBANK                                                      CSD031
      *                                                                                       CSD031
      ** If Central Level, open global files                                                  CSD031
     C           *INU1     IFEQ *ON                                                           CSD031
     C                     OPEN GPHOLIL1                                                      CSD031
     C                     OPEN GPHOLIL2                                                      CSD031
     C                     OPEN GPHOLIL0                                                      CSD031
     C                     MOVE 'G'       W@MODE  1                                           CSD031
     C                     MOVE *ON       *IN81                                               CSD031
     C                     ELSE                                                               CSD031
      *                                                                                       CSD031
      ** If Zonal Level and Accept Mode, open Acceptance files                                CSD031
     C           @PMODE    IFEQ 'A'                                                           CSD031
     C                     OPEN SDAHDYL1                                                      CSD031
     C                     OPEN SDAHDYL8                                                      CSD031
     C                     MOVE 'A'       W@MODE                                              CSD031
     C                     MOVE *ON       *IN80                                               CSD031
     C                     ELSE                                                               CSD031
     C                     OPEN SDHOLL8                                                       CSD031
     C                     OPEN SDHOLL4                                                       CSD031
     C                     MOVE 'C'       W@MODE                                              CSD031
     C                     MOVE *OFF      *IN80                                               CSD031
     C                     ENDIF                                                              CSD031
     C                     MOVE *OFF      *IN81                                               CSD031
     C                     OPEN SDHOLL0                                                       CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
      * Open files
     C                     OPEN SD0161R#
     C                     OPEN SDHOLL8
     C                     OPEN SDHOLL4
     C                     OPEN SDCURRL1
     C                     OPEN SDLOCNL1
     C                     OPEN SDBANKL1
     C                     OPEN SDMMODL1
     C                     OPEN SDHOLL0
     C                     OPEN SDFCTLL0
     C                     OPEN SDHOSHL0                                                      CSD012
      *                                                                                       CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     MOVEL'N'       W0PMT   1
     C                     MOVEL'CHG'     W0PMD   3
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * Start of S01459
      * Remove the last amend box function.
      * Remove the creation parameters function.
      * SD0161R Precompiler - Holidays  *
      * End of S01459
      * Copyright Statement - Standard Functions  *
      * Get Rundate - Rundate  *
     C           *NAMVAR   DEFN           RUNDAT
     C                     IN   RUNDAT
     C                     MOVE MRDT      ##MRDT  7        RUN DATE
     C                     MOVE MRDT      WUMRDT
     C                     MOVE RDNB      WURDNB           RUNDAY NO.
     C                     MOVE SUC       WUSUC            SET UP COMPLT
     C                     MOVE DFF       WUDFF            DTE FMT FLAG
     C                     MOVE MBIN      WUMBIN           MULTI BR. IND
      * Start of 063310
      * Get the date of the next working day fron SDBANKPD.
      * Get next working date - Bank Details  *
     C                     EXSR SJRVGN
      * End of 063310
      * CASE: PAR.Action Code is Insert
     C           P2ANCD    IFEQ 'I'                        *IF
      * CASE: PAR.Program recalled is Program re-called
     C           P5PGMR    IFEQ 'Y'                        *IF
     C                     MOVEL'CHG'     W0PMD            *Program mode
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'ADD'     W0PMD            *Program mode
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'CHG'     W0PMD            *Program mode
     C                     END                             *FI
     C                     MOVEL'Y'       WUMFTS           S01212
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * Get 'Window required' ind - MIDAS Modules  *
     C                     EXSR SKRVGN
      * DATA DS for Holidays - Holidays  *
      * 00/Copy Member SD0161RFPG - Holidays  *
      * 00/Copy Member SD0161REPG - Holidays  *
      * 00/Copy Member SD0161RIPG - Holidays  *
      * 00/Copy Member SD0161RCPG - Holidays  *
     C*00/Copy Member SD0161R   Initialise Program C-spec
     C/COPY WNCPYSRC,SD0161RCPG
      * 00/Copy Member SD0161ROPG - Holidays  *
     C                     END                             *FI
      *                                                                                       CSD012
      * Define keylist for SDAULGL1                                                           CSD012
     C           KAULG     KLIST                                                              CSD012
     C**********           KFLD           K1HOL  20                                    CSD012 CGL029
     C                     KFLD           K1HOL  26                                           CGL029
      *                                                                                       CSD012
      * Check if CSD012 is switched on                                                        CSD012
     C                     CALL 'AOSARDR0'                                                    CSD012
     C                     PARM           PRTCD   7                                           CSD012
     C                     PARM '*VERIFY' POPTN   7                                           CSD012
     C                     PARM 'CSD012'  PSARD   6                                           CSD012
      *                                                                                       CSD012
     C           PRTCD     IFEQ *BLANKS                                                       CSD012
     C                     MOVE 'Y'       CSD012  1                                           CSD012
     C                     ELSE                                                               CSD012
     C                     MOVE 'N'       CSD012                                              CSD012
     C                     ENDIF                                                              CSD012
     C                     MOVE 'N'       CRE026  1                                          BG12014
      * Check if CRE026 is switched on                                                       BG12014
     C                     CALL 'AOSARDR0'                                                   BG12014
     C                     PARM           PRTCD                                              BG12014
     C                     PARM '*VERIFY' POPTN                                              BG12014
     C                     PARM 'CRE026'  PSARD                                              BG12014
      *                                                                                      BG12014
     C           PRTCD     IFEQ *BLANKS                                                      BG12014
     C                     MOVE 'Y'       CRE026                                             BG12014
     C                     ELSE                                                              BG12014
     C                     MOVE 'N'       CRE026                                             BG12014
     C                     ENDIF                                                             BG12014
      *                                                                                       CSD012
      * Check if Holiday Authorisation is on                                                  CSD012
     C           CSD012    IFEQ 'Y'                                                           CSD012
      *                                                                                       CSD012
     C                     CALL 'AOSVALR0'                                                    CSD012
     C                     PARM *BLANKS   RTNCDE  7                                           CSD012
     C                     PARM           SVALK1 20                                           CSD012
     C                     PARM           SVAL1 200                                           CSD012
     C                     PARM           SVALK2 20                                           CSD012
     C                     PARM           SVAL2 200                                           CSD012
     C                     PARM           SVALK3 20                                           CSD012
     C                     PARM           SVAL3 200                                           CSD012
     C                     PARM           SVALK4 20                                           CSD012
     C                     PARM           SVAL4 200                                           CSD012
     C                     PARM           SVALK5 20                                           CSD012
     C                     PARM           SVAL5 200                                           CSD012
     C                     PARM           SVALK6 20                                           CSD012
     C                     PARM           SVAL6 200                                           CSD012
     C                     PARM           SVALK7 20                                           CSD012
     C                     PARM           SVAL7 200                                           CSD012
     C                     PARM           SVALK8 20                                           CSD012
     C                     PARM           SVAL8 200                                           CSD012
     C                     PARM           SVALK9 20                                           CSD012
     C                     PARM           SVAL9 200                                           CSD012
     C                     PARM           SVALK0 20                                           CSD012
     C                     PARM           SVAL10200                                           CSD012
      *                                                                                       CSD012
     C           RTNCDE    IFNE *BLANKS                                                       CSD012
     C           SVAL10    IFEQ '*NRF'                                                        CSD012
     C                     MOVE SVALK0    DBKEY                                               CSD012
     C                     ENDIF                                                              CSD012
     C           SVAL9     IFEQ '*NRF'                                                        CSD012
     C                     MOVE SVALK9    DBKEY                                               CSD012
     C                     ENDIF                                                              CSD012
     C           SVAL8     IFEQ '*NRF'                                                        CSD012
     C                     MOVE SVALK8    DBKEY                                               CSD012
     C                     ENDIF                                                              CSD012
     C           SVAL7     IFEQ '*NRF'                                                        CSD012
     C                     MOVE SVALK7    DBKEY                                               CSD012
     C                     ENDIF                                                              CSD012
     C           SVAL6     IFEQ '*NRF'                                                        CSD012
     C                     MOVE SVALK6    DBKEY                                               CSD012
     C                     ENDIF                                                              CSD012
     C           SVAL5     IFEQ '*NRF'                                                        CSD012
     C                     MOVE SVALK5    DBKEY                                               CSD012
     C                     ENDIF                                                              CSD012
     C           SVAL4     IFEQ '*NRF'                                                        CSD012
     C                     MOVE SVALK4    DBKEY                                               CSD012
     C                     ENDIF                                                              CSD012
     C           SVAL3     IFEQ '*NRF'                                                        CSD012
     C                     MOVE SVALK3    DBKEY                                               CSD012
     C                     ENDIF                                                              CSD012
     C           SVAL2     IFEQ '*NRF'                                                        CSD012
     C                     MOVE SVALK2    DBKEY                                               CSD012
     C                     ENDIF                                                              CSD012
     C           SVAL1     IFEQ '*NRF'                                                        CSD012
     C                     MOVE SVALK1    DBKEY                                               CSD012
     C                     ENDIF                                                              CSD012
     C           *LOCK     IN   LDA                                                           CSD012
     C                     Z-ADD1         DBASE                                               CSD012
     C                     MOVE 'SDSVALPD'DBFILE                                              CSD012
     C                     MOVE 'SD0161R' DBPGM                                               CSD012
     C                     OUT  LDA                                                           CSD012
     C                     EXSR *PSSR                                                         CSD012
     C                     ENDIF                                                              CSD012
      *                                                                                       CSD012
     C                     ENDIF                                                              CSD012
      *                                                                                       CSD012
      *                                                                                      BG12014
      * RETRIEVE CURRENT ZONE VALUES FOR VALIDATION.                                         BG12014
     C                     MOVELZONEST    PZONE  20                                          BG12014
     C                     CALL 'AOSVALR0'                                                   BG12014
     C                     PARM *BLANKS   P@RTCD  7                                          BG12014
     C                     PARM PZONE     P@OP01 20                                          BG12014
     C                     PARM *BLANKS   P@VL01200                                          BG12014
     C                     PARM *BLANKS   P@OP02 20                                          BG12014
     C                     PARM *BLANKS   P@VL02200                                          BG12014
     C                     PARM *BLANKS   P@OP03 20                                          BG12014
     C                     PARM *BLANKS   P@VL03200                                          BG12014
     C                     PARM *BLANKS   P@OP04 20                                          BG12014
     C                     PARM *BLANKS   P@VL04200                                          BG12014
     C                     PARM *BLANKS   P@OP05 20                                          BG12014
     C                     PARM *BLANKS   P@VL05200                                          BG12014
     C                     PARM *BLANKS   P@OP06 20                                          BG12014
     C                     PARM *BLANKS   P@VL06200                                          BG12014
     C                     PARM *BLANKS   P@OP07 20                                          BG12014
     C                     PARM *BLANKS   P@VL07200                                          BG12014
     C                     PARM *BLANKS   P@OP08 20                                          BG12014
     C                     PARM *BLANKS   P@VL08200                                          BG12014
     C                     PARM *BLANKS   P@OP09 20                                          BG12014
     C                     PARM *BLANKS   P@VL09200                                          BG12014
     C                     PARM *BLANKS   P@OP10 20                                          BG12014
     C                     PARM *BLANKS   P@VL10200                                          BG12014
      *                                                                                      BG12014
     C           P@RTCD    IFNE *BLANKS                                                      BG12014
     C           P@VL10    IFEQ '*NRF'                                                       BG12014
     C                     MOVE P@OP10    DBKEY                                              BG12014
     C                     ENDIF                                                             BG12014
     C           P@VL09    IFEQ '*NRF'                                                       BG12014
     C                     MOVE P@OP09    DBKEY                                              BG12014
     C                     ENDIF                                                             BG12014
     C           P@VL08    IFEQ '*NRF'                                                       BG12014
     C                     MOVE P@OP08    DBKEY                                              BG12014
     C                     ENDIF                                                             BG12014
     C           P@VL07    IFEQ '*NRF'                                                       BG12014
     C                     MOVE P@OP07    DBKEY                                              BG12014
     C                     ENDIF                                                             BG12014
     C           P@VL06    IFEQ '*NRF'                                                       BG12014
     C                     MOVE P@OP06    DBKEY                                              BG12014
     C                     ENDIF                                                             BG12014
     C           P@VL05    IFEQ '*NRF'                                                       BG12014
     C                     MOVE P@OP05    DBKEY                                              BG12014
     C                     ENDIF                                                             BG12014
     C           P@VL04    IFEQ '*NRF'                                                       BG12014
     C                     MOVE P@OP04    DBKEY                                              BG12014
     C                     ENDIF                                                             BG12014
     C           P@VL03    IFEQ '*NRF'                                                       BG12014
     C                     MOVE P@OP03    DBKEY                                              BG12014
     C                     ENDIF                                                             BG12014
     C           P@VL02    IFEQ '*NRF'                                                       BG12014
     C                     MOVE P@OP02    DBKEY                                              BG12014
     C                     ENDIF                                                             BG12014
     C           P@VL01    IFEQ '*NRF'                                                       BG12014
     C                     MOVE P@OP01    DBKEY                                              BG12014
     C                     ENDIF                                                             BG12014
     C           *LOCK     IN   LDA                                                          BG12014
     C                     Z-ADD1         DBASE                                              BG12014
     C                     MOVE 'SDSVALPD'DBFILE                                             BG12014
     C                     MOVE 'SD0161V' DBPGM                                              BG12014
     C                     OUT  LDA                                                          BG12014
     C                     EXSR *PSSR                                                        BG12014
     C                     ENDIF                                                             BG12014
      *                                                                                      BG12014
      * RETRIEVE FLAG FOR EDITING HOLIDAYS.                                                 MD037087
      *                                                                                     MD037087
     C                     CALL 'AOSVALR0'                                                  MD037087
     C                     PARM *BLANKS   P@RTCD  7                                         MD037087
     C                     PARM HOLBCK    P@OP01 20                                         MD037087
     C                     PARM *BLANKS   P@VL01200                                         MD037087
     C                     PARM *BLANKS   P@OP02 20                                         MD037087
     C                     PARM *BLANKS   P@VL02200                                         MD037087
     C                     PARM *BLANKS   P@OP03 20                                         MD037087
     C                     PARM *BLANKS   P@VL03200                                         MD037087
     C                     PARM *BLANKS   P@OP04 20                                         MD037087
     C                     PARM *BLANKS   P@VL04200                                         MD037087
     C                     PARM *BLANKS   P@OP05 20                                         MD037087
     C                     PARM *BLANKS   P@VL05200                                         MD037087
     C                     PARM *BLANKS   P@OP06 20                                         MD037087
     C                     PARM *BLANKS   P@VL06200                                         MD037087
     C                     PARM *BLANKS   P@OP07 20                                         MD037087
     C                     PARM *BLANKS   P@VL07200                                         MD037087
     C                     PARM *BLANKS   P@OP08 20                                         MD037087
     C                     PARM *BLANKS   P@VL08200                                         MD037087
     C                     PARM *BLANKS   P@OP09 20                                         MD037087
     C                     PARM *BLANKS   P@VL09200                                         MD037087
     C                     PARM *BLANKS   P@OP10 20                                         MD037087
     C                     PARM *BLANKS   P@VL10200                                         MD037087
      *                                                                                     MD037087
     C                     MOVEL'N'       WEDTHL  1                                         MD037087
     C           P@RTCD    IFEQ *BLANKS                                                     MD037087
     C                     MOVELP@VL01    WEDTHL                                            MD037087
     C                     ENDIF                                                            MD037087
      *                                                                                     MD037087
      ** Check if CTI006 is switched on                                                       CTI006
      *                                                                                       CTI006
     C                     MOVE 'N'       CTI006  1                                           CTI006
     C                     CALL 'AOSARDR0'                                                    CTI006
     C                     PARM *BLANKS   PRTCD                                               CTI006
     C                     PARM '*VERIFY' POPTN                                               CTI006
     C                     PARM 'CTI006'  PSARD                                               CTI006
      *                                                                                       CTI006
     C           PRTCD     IFNE *BLANKS                                                       CTI006
     C           PRTCD     ANDNE'*NRF'                                                        CTI006
     C           *LOCK     IN   LDA                                                           CTI006
     C                     MOVEL'SCSARDPD'DBFILE                                              CTI006
     C                     MOVEL'CTI006'  DBKEY                                               CTI006
     C                     Z-ADD0004      DBASE                                               CTI006
     C                     EXSR *PSSR                                                         CTI006
     C                     ENDIF                                                              CTI006
      *                                                                                       CTI006
     C           PRTCD     IFEQ *BLANKS                                                       CTI006
     C                     MOVE 'Y'       CTI006                                              CTI006
     C                     ENDIF                                                              CTI006
      *                                                                                       CTI006
      *================================================================
     CSR         ZZEXIT    ENDSR
      /EJECT
      *****************************************************************                       CTI006
     C           SRDELT    BEGSR                                                              CTI006
      *****************************************************************                       CTI006
      *                                                                                       CTI006
      ** Write to Deleted File                                                                CTI006
     C                     MOVE *BLANKS   WCYLOC  6                                           CTI006
     C                     MOVE *BLANKS   WLONGD 11                                           CTI006
     C                     MOVE *BLANKS   WLYRNB  5                                           CTI006
     C                     CLEARPFRC                                                          CTI006
     C                     MOVELP1CYCD    WCYLOC                                              CTI006
     C                     MOVE P1LCCD    WCYLOC                                              CTI006
     C                     MOVELP1YRNB    WLYRNB                                              CTI006
     C                     MOVELWCYLOC    WLONGD                                              CTI006
     C                     MOVE WLYRNB    WLONGD                                              CTI006
      *                                                                                       CTI006
     C                     MOVEL'SDHOLPD' PFFNME              i                               CTI006
     C                     MOVELWLONGD    PFLKEY                                              CTI006
     C                     MOVEL*BLANK    PFDR01                                              CTI006
     C                     MOVEL*BLANKS   PFDR02                                              CTI006
     C                     MOVEL*BLANKS   PFDR03                                              CTI006
     C                     MOVEL*BLANKS   PFDR04                                              CTI006
     C                     MOVEL*BLANKS   PFDR05                                              CTI006
     C                     MOVEL*BLANKS   PFDR06                                              CTI006
     C                     MOVEL*BLANKS   PFDR07                                              CTI006
     C                     MOVEL*BLANKS   PFDR08                                              CTI006
     C                     MOVEL*BLANKS   PFDR09                                              CTI006
     C                     MOVEL*BLANKS   PFDR00                                              CTI006
     C                     MOVEL*BLANKS   PFDR11                                              CTI006
     C                     MOVEL*BLANKS   PFDR12                                              CTI006
     C                     MOVELBJRDNB    PFLCD                                               CTI006
     C                     MOVEL'D'       PFTYLC                                              CTI006
     C                     DUMP                                                               CTI006
     C                     CALL 'SD0520X'                                                     CTI006
     C                     PARM *BLANK    P0RTN                                               CTI006
     C                     PARM           PFRC                                                CTI006
      * Error detected?                                                                       CTI006
     C           P0RTN     IFEQ '*ERROR'                                                      CTI006
     C                     MOVEL*BLANK    DBKEY                                               CTI006
     C*                    MOVELWLONGD    DBKEY                                               CTI006
     C                     MOVEL'SDHOLPD' DBFILE                                              CTI006
     C                     MOVEL'003'     DBASE                                               CTI006
     C                     EXSR *PSSR                                                         CTI006
     C                     END                                                                CTI006
      *                                                                                       CTI006
     C                     ENDSR                                                              CTI006
      *****************************************************************                       CTI006
      /EJECT                                                                                  CTI006
      *****************************************************************                       CTI006
     CSR         *PSSR     BEGSR
      *****************************************************************
      *                                                               *
      * *PSSR  - Program exception error routine                      *
      *          Called automatically if a program error occurs,      *
      *          or directly by the program code using EXSR.          *
      *          This subroutine DUMPs the program just once.         *
      *                                                               *
      *****************************************************************
      *
      * Core function specific processing.
      *
     C/COPY WNCPYSRC,SD0161RPSC
      *
      * Start of PSSR user point.
      *
     C/COPY WNCPYSRC,SD0161RPS1
      *
      * Standard Midas PSSR processing.
      *
     C/COPY SDCPYSRC,SDPSSRINT
      *
      * End of PSSR user point.
      *
     C/COPY WNCPYSRC,SD0161RPS2
      *
      *================================================================
     CSR                   ENDSR
      *================================================================
     O*00/Copy Member SD0161R   Initialise Program O-spec
     O/COPY WNCPYSRC,SD0161ROPG
** JAN
 1 2 3 4 5 6 7 8 910111213141516171819202122232425262728293031
** FEB1
 1 2 3 4 5 6 7 8 910111213141516171819202122232425262728
** FEB2
 1 2 3 4 5 6 7 8 91011121314151617181920212223242526272829
** MAR
 1 2 3 4 5 6 7 8 910111213141516171819202122232425262728293031
** DETAIL LINE COMMAND KEY TEXT
F3=Main Menu   F10=Delete   F12=Previous   ENTER=Next Quarter
F3=Exit   F12=Previous   ENTER=Next Quarter
F3=Main Menu   F12=Previous   ENTER=Next Quarter
** CPY@     : Copyright notice for inclusion in all programs
(c) Finastra International Limited 2001
** OVRD                                                                                       CSD031
OVRDBF FILE(GZSDBANK) TOFILE(GZSDBANKL2)                                                      CSD031
