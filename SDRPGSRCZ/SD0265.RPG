     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas SD Maint-Mode3(Seton Sys Setup Flg)')            *
/*XBIA*: OVRDBF CLINTSE CLINT                                       : *
/*XBIB*: OVRDBF TABLE TABICD                                        : *
     F*****************************************************************
     F*                                                               *
     F*  Midas - STANDING DATA MODULE
     F*                                                               *
     F*  SD0265 - I.C.D. SET ON SYSTEM SETUP FLAG - MODE 3            *
     F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
     F*                                                               *
      *  Last Amend No. CER059             Date 19Jul10               *
      *  Prev Amend No. BUG23967           Date 14May09               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 CSE022             Date 29Mar01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 137224             Date 26Mar01               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*                 039660             Date 05Feb94               *
     F*                 S01455             Date 08Nov93               *
     F*                 E27222             DATE 05SEP91               *
     F*                 RT0004             DATE 08MAY91               *
     F*                 S01314             DATE 04APR91               *
     F*                 E23804             DATE 03OCT90               *
     F*                 E23394             DATE 10SEP90               *
     F*                 E16053             DATE 16AUG90               *
     F*                 E20312             DATE 13AUG90               *
     F*                 S01251             DATE 03FEB90               *
     F*                 E18499             DATE 17/11/89              *
     F*                 E18365             DATE 22/05/89              *
     F*                 S01176             DATE 22/08/88              *
     F*                 E14642             DATE 16/08/88              *
     F*                 S01168             DATE 24/07/88              *  *
     F*                 S01127             DATE 10/06/88              *
     F*                 S01158             DATE 10/05/88              *
     F*                 S01129             DATE 09/01/87              *
     F*                 S01119             DATE 01/07/87              *
     F*                 S01124             DATE 00/00/00              *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  BUG23967 - Add Local Industry Code Field.                    *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CSE022 - Depository Definition Enhancement                   *
     F*  137224 - Check whether Portfolio Management exist in SDMMODPD*
     F*           in order to display or not display error msg 118.   *
     F*  039660 - MARKET TO MARKET DARE MUST BE LESS THAN RUN DATE    *
     F*  S01455 - 'FF' ACCOUNT KEY ENHANCEMENTS.                      *
     F*           Recompiled due to changes in PF/TABTB80.            *
     F*  E27222 - THE AUDIT REPORT SHOULD BE HEADED SD0265AU NOT      *
     F*           SD0265 AS IT IS AT PRESENT.                         *
     F*  RT0004 - P1 REPORT CHANGED TO AU.                            *
     F*           LDA FIELD CORRECTED.                                *
     F*           REMOVE PAY/RECEIVE PRIORITY VALIDATION CODE.        *
     F*           REMOVE BRANCH CODE FOR DEALING VALIDATION.          *
     F*           REMOVE DEFAULT SECURITIES TRADING BRANCH VALIDATION.*
     F*           REMOVE AT BOND CODE.                                *
     F*           ERROR TEXT ARRAY 'BRANCH ACCRUAL' CHANGED TO        *
     F*            'ACCRUAL/PROFIT'                                   *
     F*  S01314 - CHGS MADE DURING PTF INCORPORATION                  *
     F*             REMOVE LETTERS OF CREDIT REF                      *
     F*             DROP TABLETJ REF FROM TABSE                       *
     F*             LOCC PREV DEFINED WITH DIFF ATTRIBUTES            *
     F*  E23804 - REFERENCES TO FRA/IRS AND FINANCIAL FUTURES         *
     F*           SHOULD BE REMOVED FROM TABTB95 - THEY BEAR NO       *
     F*           RELATION TO EXPOSURE MANAGEMENT.                    *
     F*  E23394 - CHECK FOR INTEREST ON ACCOUNTS                      *
     F*  E16053 - SYSTEM ERROR PROCESSING REPORTING INCORRECT         *
     F*  E20312 - IF MARK TO MARKET FREQ. IS BLANK ON SE-ICD YOU CAN  *   E20312
     F*           NEVER SET ON SYSTEM SETUP FLAG.                     *   E20312
     F*  S01251 - SYNON FIELD/PROGRAM NAME CHANGES                    *   E18499
     F*  E18499 - 'SECURITY' CODE SHOULD BE SKIPPED IF SECURITY       *   E18499
     F*           TRADING MODULE NOT ON SYSTEM.                       *   E18499
     F*  E18365 - UPDATE RUNDAT AND CHANGE DATE TEST                  *
     F*  S01168 - UPDATE SD SYNON FILE                                *  *
     F*  S01176 - SECURITIES TRADING RELEASE 3.1 (AUSTRALIA)          *   S01176
     F*  E14642 - DATABASE ERROR WAS OCCURRING IF RECORD              *   E14642
     F*           EXISTS ON TABTB40. SHOULD BE IF DOESN'T EXIST       *   E14342
     F*  S01127 - FUTURES AND OPTIONS INCORPORATION                   *   S01127
     F*  S01129 - SECURITIES TRADING RELEASE 2                        *   S01129
     F*  S01158 - POST INCORPORATION DEVELOPMENT FIXES                *   S01158
     F*                                                               *
     F*****************************************************************
0015 F***TABLE** UF  F      96 12AI     2 DISK                                                CGL029
     FTABLE   UF  F     230 12AI     2 DISK                                                   CGL029
     F                                              KCOMIT
     FSDBANKL0UF  E           K        DISK                               S01168
     F                                              KCOMIT                S01168
     FCLINTSE IF  E           K        DISK                               S01129
     F            CLINTCAF                          KIGNORE               S01129
     F            CLINTCBF                          KIGNORE               S01129
     F            CLINTCCF                          KIGNORE               S01129
     F            CLINTC1F                          KIGNORE               S01129
     FTABSE   IF  E           K        DISK                               S01129
     F            TABLETAF                          KIGNORE               S01129
     F            TABTB10F                          KIGNORE               S01129
     F            TABTB11F                          KIGNORE               S01129
     F            TABTB40F                          KIGNORE               S01129
     F            TABTE10F                          KIGNORE               S01129
     F            TABTE20F                          KIGNORE               S01129
     F            TABTG10F                          KRENAMETABG10SE       S01129
     F            TABTG20F                          KIGNORE               S01129
     F            TABLETHF                          KIGNORE               S01129
     F************TABLETJF                          KIGNORE         S01129S01314
     F            TABLETKF                          KIGNORE               S01129
     F            TABLETLF                          KIGNORE               S01129
     F            TABLETNF                          KIGNORE               S01129
     F            TABLETPF                          KIGNORE               S01129
     F            TABLETRF                          KRENAMETABTRSE        S01129
     F            TABLETXF                          KIGNORE               S01129
     F            TABLET2F                          KIGNORE               S01129
     F            TABLET3F                          KIGNORE               S01129
     FTABTB95 IF  E                    DISK                               S01129
     FBOOKD   IF  E           K        DISK                               S01129
0019 F***CLINT** IF  F     256  7AI     2 DISK                                                CGL029
     FCLINT   IF  F     266  7AI     2 DISK                                                   CGL029
     F*PRINT  O   F     132     OF     PRINTER                            S01124
     F***SD0265P1O***F     132     OF     PRINTER                  S01124 RT0004
     FSD0265AUO   F     132     OF     PRINTER                            RT0004
     F*
     F********************************************************************
     //EJECT
0022 F*
0023 F* ID F  C  H  L    FUNCTION OF INDICATORS
0024 F* 01            TABLE - FILE HEADER RECORD.
0025 F* 02                    INSTALLATION CONTROL DATA HEADER RECORD.
0026 F* 03                  - INSTALLATION CONTROL DATA RECORD 1-ACTIVE.
0027 F* 04                  - INSTALLATION CONTROL DATA RECORD 2-ACTIVE.
0028 F* 05                  - INSTALLATION CONTROL DATA RECORD 3-ACTIVE.
0029 F* 06                  - INSTALLATION CONTROL DATA RECORD 4-ACTIVE.
0030 F* 07                  - INSTALLATION CONTROL DATA RECORD 5-ACTIVE.
     F* 12                  - INSTALLATION CONTROL DATA RECORD 80-ACTIVE  S01127
0030 F* 16                  - INSTALLATION CONTROL DATA RECORD 6-ACTIVE.
0030 F* 17                  - INSTALLATION CONTROL DATA RECORD 35-ACTIVE
0031 F* 08                  - BRANCH CODES RECORD-ACTIVE.
0032 F* 09                  - CURRENCIES RECORD 1-ACTIVE.
0033 F* 10                  - ACCOUNT CODES RECORD 1-ACTIVE, NON-TITLE.
0034 F* 11                  - COUNTRIES RECORD-ACTIVE.
0038 F* 13            BOOKD - BOOK DETAILS RECORD - ACTIVE.               S01127
0038 F* 15            CLINT - CUSTOMER STANDING DATA RECORD-ACTIVE.
     F* 18                  - SECURITIES TRADING RECORD-ACTIVE
0039 F**
0045 F* 19            CATCHALL
0046 F**
0045 F*    20         SYSTEM SETUP FLAG ON; ERROR IN SYSTEM
0051 F**
0052 F*       22      EXPOSURE MANAGEMENT MODULE PRESENT IN SYSTEM.
0052 F********23******SECURITIES TRADING MODULE PRESENT IN SYSTEM.        S01129
0052 F*       23      SECURITIES TRADING RELEASE 1 PRESENT IN SYSTEM.     S01129
0052 F*       24      STATUTORY RETURNS MODULE PRESENT IN SYSTEM.
0053 F*       25      DEALING MODULE PRESENT IN SYSTEM.
0054 F*       26      RETAIL II MODULE PRESENT IN SYSTEM.
0055 F*       27      COMMERCIAL LOANS MODULE PRESENT IN SYSTEM
0055 F*       28      CUSTOMER LENDING MODULE PRESENT IN SYSTEM
     F*       34      FINANCIAL FUTURES + OPTIONS MODULE IN SYSTEM        S01127
0056 F**
0057 F*       29      WORK INDICATOR.
0058 F*       30      WORK INDICATOR.
0058 F*       31      ERROR INDICATOR.
0058 F*       33,34   ERROR INDICATOR (EM)                                S01129
0058 F*       35      USED IN ALPHA CHECK S/R                             S01129
     F*       40-49   WORK INDICATORS FOR CUSTOMER LENDING VALIDATION
     F*       60      END OF BRANCH CODES
     F*       61      EUROCLEAR PARTICIPANT
     F*       62      CEDEL PARTICIPANT
0052 F*       65      SECURITIES TRADING RELEASE 2 MODULE PRESENT IN SYSTES01129
0059 F**
0133 F*               EXCEPTION OUTPUT/UPDATE INDICATORS ARE-
     F*       71      UPDATE TABLE DETAIL RECORD.
     F*       72      UPDATE TABLE HEADER RECORD.
0137 F*       73      UPDATE TABLE FILE HEADER RECORD.
0139 F**
0140 F*       69      CHAIN TO ANY FILE FAILED IF ON.                     S01129
0140 F*       76      CHAIN TO TABLE FILE FAILED IF ON.
0143 F**
0146 F*       80      ERROR:  DO NOT SET ON SYSTEM SETUP FLAG.
0147 F**
0148 F*               SUB-CONDITIONING FOR OUTPUT INDICATORS 70 & 71-
0149 F*       81      RECORD 1.
0158 F**
0159 F*       89      CHAIN TO CLINT FILE FAILED IF ON.
0160 F**
0159 F*       98      DATE FORMAT FROM ICD RECORD                         S01129
0174 F*               EXTERNAL INDICATOR MEANINGS ON OUTPUT-
0177 F*          U3   SYSTEM ERROR, INVALID DATA.
0182 F*          U8   DATABASE ERROR, REQUIRED RECORDS NOT FOUND.
     F*               N.B. U8 ENDS THE PROGRAM AND CONDITIONS
0184 F*                    FOLLOWING CL EXECUTION.
0185 F**
0186 F*            LR SETON IN CALCULATIONS TO END PROGRAM.
0187 F**
0187 //EJECT
0011 E********************************************************************
     E                    CPY@    1   1 80
0199 E                    ERR     1  10 50               ERROR MESSAGES  *
     E                    PRIN        6  1               PAY/REC PRIORITY
     E                    PRCH        6  1               PAY/REC PRIORITY
0117 E                    ZA1        16  1               ZALIGN SR. ARRAY
0118 E                    ZA2        16  1               ZALIGN SR. ARRAY
0118 E                    PDUE        8  3               PAST DUE VALS.
     E                    ALP    26  26  1               ALPHABETIC CHARS.S01129
     E                    ACK         3  1               ALPHABETIC FIELD S01129
     E**********          DC         10  6 0                                           S01129 CSD027
     E                    DC         10  6                                                    CSD027
     E                    SEQ        10  2 0             MODULE SEQUENCES S01129
     E                    SQD        10  2 0             DUP MOD SEQUENCESS01129
0187 E**                                                                 *
0011 E********************************************************************
0187 //EJECT
0208 I**   TABLE FILE - FILE HEADER RECORD.
0209 I**
0210 ITABLE   NS  01   1 CH   2 C0   3 C0
0212 I                                        2   30RECT
0237 I                                        1  96 LOT
0238 I**
0239 I**   TABLE FILE - TABLE HEADER RECORD.
0240 I**
0241 I        NS  02   1 CH   2 C0   3 C1
0242 I                                        1   1 RECI
0243 I                                        2   30RECT
0245 I                                       18  210NINS
0246 I                                       22  250NDEL
0247 I                                       26  290NAMD
0248 I                                        1  96 LOT
0249 I**
0250 I**   TABLE FILE - INSTALLATION CONTROL DATA RECORD 1.
0251 I**
0252 I        NS  03   1 CD   2 C0   3 C1
0253 I       AND      12 C1  13 C0
0254 I                                        1   1 RECI
0255 I                                        2   30RECT
     I                                       14  66 TITL
0258 I                                       67  67 DATF
0259 I                                       68  700DFBR
0260 I                                       74  74 MODI1
0261 I                                       75  75 MODI2
0262 I*****                                  74  76 MODI                  S01129
0263 I*****                                  74  76 MODI                  S01129
0263 I                                       76  76 MODI3                 S01129
0265 I                                    P  77  790RUND
     I                                       80  86 RUNA
0267 I                                       87  870SFLG        20
0261 I                                       88  88 MODI4                 S01129
0261 I                                       89  89 MODI5                 S01129
0268 I                                    P  90  920LCD
0269 I                                       93  93 CHTP
0270 I                                    P  94  960TNLU
0271 I                                        1  96 LOT
0272 I**
0273 I**   TABLE FILE - INSTALLATION CONTROL DATA RECORD 2.
0274 I**
0275 I        NS  04   1 CD   2 C0   3 C1
0276 I       AND      12 C1  13 C1
0277 I                                        1   1 RECI
0278 I                                        2   30RECT
0279 I                                       12  130RCDE
0280 I                                       14  16 BCCY
0281 I                                       17  19 BCYL
0282 I                                       20  22 HOCY
0283 I**********                             23  280HEAD                                      CSD027
0283 I                                       23  28 HEAD                                      CSD027
0284 I                                    P  29  310APDA
0285 I                                       35  35 APFQ
0287 I                                       39  40 CUZR
0288 I                                    P  41  430DNWD
0289 I                                       44  460BVLP
0290 I                                       47  49 LOCY
0291 I                                       50  510FDAY
0292 I                                       52  52 ACLD
     I                                       69  71 LCCY
     I                                       72  770WTIM
0293 I                                       86  86 ISAV
0295 I                                    P  90  920LCD
0296 I                                       93  93 CHTP
0297 I                                    P  94  960TNLU
0298 I                                        1  96 LOT
0299 I**
0300 I**   TABLE FILE - INSTALLATION CONTROL DATA RECORD 3.
0301 I**
0302 I        NS  05   1 CD   2 C0   3 C1
0303 I       AND      12 C2  13 C0
0304 I                                        1   1 RECI
0305 I                                        2   30RECT
0306 I                                       12  130RCDE
0307 I**********                             14  170COMS                                      CGL029
0308 I**********                             18  210CADC                                      CGL029
     I                                       14  170QQCOMS                                    CGL029
     I                                       18  210QQCADC                                    CGL029
0309 I                                    P  22  250MDIC
0310 I                                    P  26  290MDIA
0311 I                                    P  30  330MCIC
0312 I**********                             34  370SRPL                                      CGL029
0313 I**********                             38  410SPAC                                      CGL029
0314 I**********                             42  450SWAC                                      CGL029
0315 I**********                             46  490FTAC                                      CGL029
0316 I**********                             50  530TAC4                                      CGL029
0317 I**********                             54  570TAC5                                      CGL029
     I                                       34  370QQSRPL                                    CGL029
     I                                       38  410QQSPAC                                    CGL029
     I                                       42  450QQSWAC                                    CGL029
     I                                       46  490QQFTAC                                    CGL029
     I                                       50  530QQTAC4                                    CGL029
     I                                       54  570QQTAC5                                    CGL029
0318 I                                    P  58  610MCIA
0319 I                                    P  63  650NOBA
0320 I                                    P  66  680TSIZ
0321 I                                       69  69 RACN
0322 I                                       70  700GLSI
0323 I                                       71  710RTSI
0324 I                                       72  720DLSI
0325 I                                       73  730NOSI
0326 I                                       74  740CTSI
0327 I                                    P  75  770ELAC
0328 I                                    P  78  800ECAC
0329 I                                    P  90  920LCD
0330 I                                       93  93 CHTP
0331 I                                    P  94  960TNLU
     I                                       97 1060COMS                                      CGL029
     I                                      107 1160CADC                                      CGL029
     I                                      117 1260SRPL                                      CGL029
     I                                      127 1360SPAC                                      CGL029
     I                                      137 1460SWAC                                      CGL029
     I                                      147 1560FTAC                                      CGL029
     I                                      157 1660TAC4                                      CGL029
     I                                      167 1760TAC5                                      CGL029
0332 I                                        1  96 LOT
0333 I**
0334 I**   TABLE FILE - INSTALLATION CONTROL DATA RECORD 4.
0335 I**
0336 I        NS  06   1 CD   2 C0   3 C1
0337 I       AND      12 C3  13 C0
0338 I                                        1   1 RECI
0339 I                                        2   30RECT
0340 I                                       12  130RCDE
0341 I**********                             14  190LSAC                                      CSD027
0341 I                                       14  19 LSAC                                      CSD027
0342 I                                    P  90  920LCD
0343 I                                       93  93 CHTP
0344 I                                    P  94  960TNLU
0345 I                                        1  96 LOT
     I**
     I**   TABLE FILE - INSTALLATION CONTROL DATA RECORD 35.
     I**
     I        NS  17   1 CD   2 C0   3 C1
     I       AND      12 C3  13 C5
     I                                        1   1 RECI
     I                                        2   30RECT
     I                                       12  130RCDE
     I                                       14  150PFMS
     I                                       16  170PFST
     I                                       18  18 UNPP
     I                                       19  19 UNLP
     I                                       21  230STBP
     I                                       24  24 PLPT
     I                                       25  25 PLPV
     I                                       26  26 EURI
     I                                       27  27 CEDI
     I                                       28  29 NEN1
     I                                       30  31 NCN1
     I                                       32  33 NEN2
     I                                       34  35 NCN2
     I**********                             36  410ECLN                                      CSD027
     I**********                             42  470CCLN                                      CSD027
     I                                       36  41 ECLN                                      CSD027
     I                                       42  47 CCLN                                      CSD027
     I                                       48  50 ECCC
     I                                       51  53 CDCC
     I                                       54  54 ACCE
     I                                    P  55  570FPDT
     I                                    P  58  600DLWK
     I                                    P  61  630LWDM
     I                                       64  66 BEF
     I                                       67  69 DEM
     I                                       70  72 JPY
     I                                       73  73 EUAT
     I                                       74  74 BAIF
     I                                       75  75 DLEI
     I                                    P  90  920LCD
     I                                       93  93 CHTP
     I                                    P  94  960TNLU
0377 I                                        1  96 LOT
0346 I**
0347 I**   TABLE FILE - INSTALLATION CONTROL DATA RECORD 5.
0348 I**
0349 I        NS  07   1 CD   2 C0   3 C1
0350 I       AND      12 C4  13 C0
0351 I                                        1   1 RECI
0352 I                                        2   30RECT
0353 I                                       12  130RCDE
     I                                       14  14 IRFRA                 S01119
0354 I**********                             18  210CSAC                                      CGL029
     I                                       18  210QQCSAC                                    CGL029
0355 I                                       22  22 TLII
0356 I                                       23  23 MCRI
0357 I                                    P  24  250MCEP
0358 I                                       26  270MCLP
0359 I                                       28  28 FRDI
0360 I                                       29  29 BRCF
0361 I**********                             30  350PSCN                                      CSD027
0361 I                                       30  35 PSCN                                      CSD027
0362 I                                       36  380DLBR
0363 I**********                             39  420FRPA                                      CGL029
0364 I**********                             43  460FRPC                                      CGL029
     I                                       39  420QQFRPA                                    CGL029
     I                                       43  460QQFRPC                                    CGL029
0365 I                                       47  49 USCY
0366 I                                       50  52 STCY
0367 I                                    P  53  553MBGE
0368 I                                       57  57 FFNY
0369 I                                       58  58 OURC
0370 I                                       59  59 BRNC
0371 I                                       60  60 LCYN
0372 I                                       61  61 ETBI
     I                                       75  77 CLCY
     I                                       78  78 PRSW
     I                                       79  79 PRCI
     I                                       80  80 PRCA
     I                                       81  81 PRTX
     I                                       82  82 PRFW
     I                                       83  83 PRBW
0374 I                                    P  90  920LCD
0375 I                                       93  93 CHTP
0376 I                                    P  94  960TNLU
     I                                       97 1060CSAC                                      CGL029
     I                                      107 1160FRPA                                      CGL029
     I                                      117 1260FRPC                                      CGL029
0377 I                                        1  96 LOT
0346 I**                                                                  S01119
0347 I**   TABLE FILE - INSTALLATION CONTROL DATA RECORD 70 - FRA/IRS     S01119
0348 I**                                                                  S01119
0349 I        NS       1 CD   2 C0   3 C1                                 S01119
0350 I       AND      12 C7  13 C0                                        S01119
0351 I                                        1   1 RECI                  S01119
0351 I                                       15  15 HEOCF                 S01119
0351 I                                       16  16 HFRAA                 S01119
0351 I                                    P  17  204FRLPC                 S01119
0351 I                                       21  240FRLPD                 S01119
0351 I                                    P  25  284FRUPC                 S01119
0351 I                                       29  320FRUPD                 S01119
0351 I                                    P  33  364IRLPC                 S01119
0351 I                                       37  400IRLPD                 S01119
0351 I                                    P  41  444IRUPC                 S01119
0351 I                                       45  480IRUPD                 S01119
0351 I                                    P  90  920LCD                   S01119
0351 I                                       93  93 CHTP                  S01119
0351 I                                    P  94  960TNLU                  S01119
0346 I**
0347 I**   TABLE FILE - INSTALLATION CONTROL DATA RECORD 6.
0348 I**
0349 I        NS  16   1 CD   2 C0   3 C1
0350 I       AND      12 C5  13 C0
0351 I                                        1   1 RECI
0352 I                                        2   30RECT
0353 I                                       12  130RCDE
0317 I                                       14  14 BTIN
0318 I                                       15  160BDAY
0319 I                                    P  17  180PDUE1
0320 I                                    P  19  200PDUE2
0321 I                                    P  21  220PDUE3
0322 I                                    P  23  240PDUE4
0323 I                                    P  25  260PDUE5
0324 I                                    P  27  280PDUE6
0325 I                                    P  29  300PDUE7
0326 I                                    P  31  320PDUE8
0327 I                                    P  33  380LARG
0328 I                                       39  39 BRLF
0329 I                                    P  40  420LEAC
0330 I                                    P  90  920LCD
0331 I                                       93  93 CHTP
0332 I                                    P  94  960TNLU
0333 I                                        1  96 LOT
     I**                                                                  S01127
     I**   TABLE FILE - INSTALLATION CONTROL DATA RECORD 80.              S01127
     I**                                                                  S01127
     I        NS  12   1 CD   2 C0   3 C1                                 S01127
     I       AND      12 C8  13 C0                                        S01127
     I                                        1   1 RECI                  S01127
     I                                        2   30RECT                  S01127
     I                                       12  130RCDE                  S01127
     I                                       14  15 DFTB                  S01127
     I                                       16  17 DFCB                  S01127
     I**********                             29  320DFBA                               S01127 CGL029
     I**********                             33  360DFCA                               S01127 CGL029
     I                                       29  320QQDFBA                                    CGL029
     I                                       33  360QQDFCA                                    CGL029
     I                                    P  90  920LCD                   S01127
     I                                       93  93 CHTP                  S01127
     I                                    P  94  960TNLU                  S01127
     I                                       99 1080DFBA                                      CGL029
     I                                      109 1180DFCA                                      CGL029
     I                                        1  96 LOT                   S01127
0378 I**
0379 I**   TABLE FILE - BRANCH CODES RECORD.
0380 I**
0381 I        NS  08   1 CD   2 C1   3 C0
0382 I                                        1   1 RECI
0383 I                                        2   30RECT
0384 I                                       11  130BRCD
0385 I                                       14  43 BRNM
0386 I**********                             44  490BICN                                      CSD027
0386 I                                       44  49 BICN                                      CSD027
0387 I***************************************50  51 LOCC                  S01314
0387 I                                       50  51 LOCCX                 S01314
0388 I                                       52  53 CMPY
0389 I                                    P  90  920LCD
0390 I                                       93  93 CHTP
0391 I                                    P  94  960TNLU
0392 I**
0393 I**   TABLE FILE - CURRENCIES RECORD 1.
0394 I**
0395 I        NS  09   1 CD   2 C2   3 C0
0396 I       AND      13 C1
0397 I                                        1   1 RECI
0398 I                                        2   30RECT
0399 I                                       10  12 CCY
0400 I                                       13  130SREC
0401 I                                       14  27 CCNM
0402 I                                    P  28  348SPOT
0403 I                                       35  37 CCYS
0404 I                                       38  380CDP
0405 I                                       39  390TNOT
0406 I                                       40  40 DCCY
0407 I                                       41  44 SRC1
0408 I                                       45  48 SRC2
0409 I**********                             49  520TACC                                      CGL029
0410 I**********                             53  560TEQV                                      CGL029
0411 I**********                             57  600SWQV                                      CGL029
0412 I**********                             61  640TAC4TG                                    CGL029
0413 I**********                             65  680TAC5TG                                    CGL029
     I                                       49  520QQTACC                                    CGL029
     I                                       53  560QQTEQV                                    CGL029
     I                                       57  600QQSWQV                                    CGL029
     I                                       61  640QQTAC4                                    CGL029
     I                                       65  680QQTAC5                                    CGL029
0414 I**   ABOVE TWO FIELDS SUFFIXED TO AVOID FIELD NAME DUPLICATION.
0415 I                                       69  69 HIND
0416 I                                    P  70  768PART
0417 I                                       77  780SSNO
0418 I                                    P  79  858ERLC
0419 I                                    P  90  920LCD
0420 I                                       93  93 CHTP
0421 I                                    P  94  960TNLU
     I                                      181 1900TACC                                      CGL029
     I                                      191 2000TEQV                                      CGL029
     I                                      201 2100SWQV                                      CGL029
     I                                      211 2200TAC4TG                                    CGL029
     I                                      221 2300TAC5TG                                    CGL029
0422 I**
0423 I**   TABLE FILE - ACCOUNT CODES RECORD 1.
0424 I**
0425 I********NS  10   1 CD   2 C3   3 C0                                                     CGL029
0426 I*******AND      13 C1  48 CN                                                            CGL029
0427 I**********                              1   1 RECI                                      CGL029
0428 I**********                              2   30RECT                                      CGL029
0429 I**********                              9  120ACOD                                      CGL029
0430 I**********                             13  130SREC                                      CGL029
0431 I**********                             14  38 ACKN                                      CGL029
0432 I**********                             39  39 ATYP                                      CGL029
0433 I**********                          P  40  420SHLC                                      CGL029
0434 I**********                          P  43  450SHFC                                      CGL029
0435 I**********                             48  48 TITO                                      CGL029
0436 I**********                             49  520BSDR                                      CGL029
0437 I**********                             53  560BSCR                                      CGL029
0438 I**********                             57  600PLDR                                      CGL029
0439 I**********                             61  640PLCR                                      CGL029
0440 I**********                             65  740RPCD                                      CGL029
0441 I**********                             75  76 ACCS                                      CGL029
0442 I**********                             77  77 STYP                                      CGL029
0443 I**********                          P  90  920LCD                                       CGL029
0444 I**********                             93  93 CHTP                                      CGL029
0445 I**********                          P  94  960TNLU                                      CGL029
0446 I**
0447 I**   TABLE FILE - COUNTRIES RECORD.
0448 I**
0449 I        NS  11   1 CD   2 C5   3 C0
0450 I                                        1   1 RECI
0451 I                                        2   30RECT
0452 I                                       12  13 CCOD
0453 I                                       14  43 CNM
0454 I                                       44  45 REGC
0455 I                                       46  480DEPT
0456 I                                    P  49  510DEPX
0457 I                                    P  52  560DEPA
0458 I                                       57  57 DEPF
0459 I                                    P  58  600DEPR
0460 I                                       61  620DLRD
0461 I                                       63  650FRXT
0462 I                                    P  66  680FRXX
0463 I                                    P  69  730FRXA
0464 I                                       74  74 FRXF
0465 I                                    P  75  770FRXR
0466 I                                       78  790FLRD
0467 I                                    P  90  920LCD
0468 I                                       93  93 CHTP
0469 I                                    P  94  960TNLU
0470 I**
0471 I**   CATCHALL.
0472 I        NS  19
     I                                        2   30RECT
0473 I                                        1  96 LOT
     I*                                                                   S01127
     IBOOKDDF                                                             S01127
     I**   BOOK DETAILS FILE                                              S01127
     I              RECI                            RECIB                 S01127
0528 I**
0530 I**   CLIENT FILE - CUSTOMER STANDING DATA RECORD.
0531 I**
0532 ICLINT   NS  15   1 CD   8 CA
0533 I                                        1   1 RECI
0534 I**********                              2   70CNUM                                      CSD027
0534 I                                        2   7 CNUM                                      CSD027
0535 I                                        8   8 RCDT
0536 I                                        9  28 CRNM
0537 I                                       29  38 CTWN
0538 I                                       39  48 CSNM
0539 I                                       49  56 CASK
0540 I                                       57  68 TELX
0541 I                                       69  80 CSID
0542 I                                       81  82 ACOC
0543 I                                       83  83 CBSI
0544 I                                       84  85 CCTZ
0545 I                                       86  87 CLOC
0546 I**********                             88  930CPAR                                      CSD027
0546 I                                       88  93 CPAR                                      CSD027
0547 I                                       94  960BRCD
0548 I                                       97  98 LINS
0549 I                                       99 101 LIND
0550 I                                    P 102 1040DASU
0551 I                                    P 105 1070CDIC
0552 I                                    P 108 1100DADE
0553 I                                      111 111 CMIN
0554 I                                      112 112 CTYP
0555 I                                      113 124 TELF
0556 I                                      125 133 CHID
0557 I                                      134 136 CHAB
0558 I                                    P 250 2520LCD
0559 I                                      253 253 CHTP
0560 I                                    P 254 2560TNLU
0561 I                                      262 264 LOIC                                    BUG23967
     I**
     I**   CLIENT FILE - SECURITIES TRADING DATA RECORD.
     I**
     I        NS  18   1 CD   8 C1
     I                                        1   1 RECI
     I**********                              2   70CNUM                                      CSD027
     I                                        2   7 CNUM                                      CSD027
     I                                        8   8 RCDT
     I                                        9  130EURO
     I                                       14  15 ECAT
     I**********                             16  210CEDL                                      CSD027
     I                                       16  21 CEDL                                      CSD027
     I                                       22  23 CEAC
     I                                       24  24 FUNG
     I                                       25  25 DISC
     I**********                             26  310ECN1                                      CSD027
     I**********                             32  370ECN2                                      CSD027
     I**********                             38  430CED1                                      CSD027
     I**********                             44  490CED2                                      CSD027
     I**********                             50  550KASS                                      CSD027
     I**********                             56  610OTHE                                      CSD027
     I                                       26  31 ECN1                                      CSD027
     I                                       32  37 ECN2                                      CSD027
     I                                       38  43 CED1                                      CSD027
     I                                       44  49 CED2                                      CSD027
     I                                       50  55 KASS                                      CSD027
     I                                       56  61 OTHE                                      CSD027
     I**********                             62  650STAC                                      CGL029
     I                                       62  650QQSTAC                                    CGL029
     I                                       66  70 RETC
     I                                    P  71  730CONT
     I                                       74 249 ZZ01
     I                                    P 250 2520LCD
     I                                      253 253 CHTP
     I                                    P 254 2560TNLU
     I                                      257 2660STAC                                      CGL029
0565 I**
0592 I**   CATCHALL FOR DELETED RECORDS.
0593 I        NS  19
0595 I**
      * DATA STRUCTURE DEPOTS (TABTB36)                                   S01129
     IDCDS        DS                                                      S01129
     I**********                              1   60DC01                               S01129 CSD027
     I**********                              7  120DC02                               S01129 CSD027
     I**********                             13  180DC03                               S01129 CSD027
     I**********                             19  240DC04                               S01129 CSD027
     I**********                             25  300DC05                               S01129 CSD027
     I**********                             31  360DC06                               S01129 CSD027
     I**********                             37  420DC07                               S01129 CSD027
     I**********                             43  480DC08                               S01129 CSD027
     I**********                             49  540DC09                               S01129 CSD027
     I**********                             55  600DC10                               S01129 CSD027
     I                                        1   6 DC01                                      CSD027
     I                                        7  12 DC02                                      CSD027
     I                                       13  18 DC03                                      CSD027
     I                                       19  24 DC04                                      CSD027
     I                                       25  30 DC05                                      CSD027
     I                                       31  36 DC06                                      CSD027
     I                                       37  42 DC07                                      CSD027
     I                                       43  48 DC08                                      CSD027
     I                                       49  54 DC09                                      CSD027
     I                                       55  60 DC10                                      CSD027
     I                                        1  60 DC                    S01129
     ISEQDS       DS                                                      S01129
     I                                        1  20 SEQDSF                S01129
     I                                        1  20 SEQ                   S01129
     I**                                                                  S01129
0596 I**   DATA STRUCTURE TO ACCESS LOCAL DATA AREA.
0599 IPSDS       SDS
0600 I                                      244 246 WSID
0601 I                                      245 246 WSID2
     I                                      254 263 USRID
0602 I**
0596 I**   DATA STRUCTURE TO USE IF ANY DATABASE ERRORS OCCUR.
0599 ILDA        UDS                            256
     I***********                           134 138 DBFILE                RT0004
     I***********                           139 167 DBKEY                 RT0004
     I***********                           168 175 DBPGM                 RT0004
     I***********                           176 1770DBASE                 RT0004
     I                                      134 141 DBFILE                RT0004
     I                                      142 170 DBKEY                 RT0004
     I                                      171 180 DBPGM                 RT0004
     I                                      181 1830DBASE                 RT0004
     I**                                                                  S01129
     I**  DATA STRUCTURE OVER TABLE FILE KEY                              S01129
     ITABKEY      DS                                                      S01129
     I                                        1  12 KEY                   S01129
     I                                        1   2 TYPE                  S01129
     I                                        9  11 KCCY                  S01129
     I**
     I**  DATA STRUCTURE TO UPDATE LAST TRANSACTION NUMBER DTAARA
     I**
     IDNATN       DS                              5
     I                                        1   50FNATN
     I**
     I**  DATA STRUCTURE TO PROVIDE TEXT ON COMIT ENTRY IN JOURNAL
     I**
     ICMTTXT      DS                             51
     I                                        1   50NATN
     I                                        6   7 MDID
     I                                        8  15 PGMN
     I                                       16  18 WSIDX
     I                                       19  240MTIME
     I                                       25  25 FCTNX
     I                                       26  35 USRIDX
     I                                       51  51 SFLGX
     I*
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
0602 I**
     I* DATA AREA DATA STRUCTURE FOR RUNDAT - UPDATE OF SYSTEM SET-UP     E18365
     I* FLAG                                                              E18365
     IRUNDAT     UDS                                                      E18365
     I                                        1  13 FIELDS                E18365
     I***********                            11  11 SSF                   S01251
     I                                       11  11 SUC                   S01251
     ISDMMOD    E DSSDMMODPD                                              137224
     I**  Data structure for module details                               137224
     IDSFDY     E DSDSFDY                                                 137224
     I*  First DS for access programs, short data structure               137224
     ISDACOD    E DSSDACODPD                                                                  CGL029
     IDSSDY     E DSDSSDY                                                                     CGL029
0603 I*****************************************************************
     //EJECT
0609 C**
     C*   DEFINING EXTERNAL DATA AREA RUNDAT                              E18365
     C           *NAMVAR   DEFN           RUNDAT                          E18365
     C*   SET ON OVERFLOW TO PRINT OUTPUT HEADINGS
     C                     SETON                     OF
     C**
     C**  INITIALISE THE FIELDS USED TO DETECT DATABASE ERRORS.
     C                     MOVEL'SD0265'  DBPGM
     C                     Z-ADD0         DBASE
     C                     MOVE *BLANK    DBFILE
     C                     MOVE *BLANK    DBKEY
     C**
0610 C**   RESET EXTERNAL INDICATORS FOR LATER REUSE.
0611 C                     SETOF                     U1U2U3
0613 C                     SETOF                     U8
     C**
     C**   SETUP TIME
     C**
     C                     EXSR TIME
     C**
     C**   DETERMINE IF STATUS OF I.C.D.RECORDS IS VALID.
0615 C**
0616 C**   IF A DATABASE OR SYSTEM ERROR IS FOUND INDICATORS ARE SET
0617 C**   TO REFLECT THE ERROR CONDITION AND TO END THE PROGRAM.
0638 C**
0639 C**   TABLE FILE HEADER RECORD.  DATABASE ERROR IF NOT FOUND.
     C**   DATABASE ERROR POINT 1.
0640 C                     MOVEL'00'      TABKEY 12
0641 C                     EXSR TABRED                     ** DB01 **
     C*
     C           *IN01     IFEQ '0'
     C                     SETON                     U8
     C                     MOVE 998       ERROR   30
     C                     Z-ADD1         DBASE
     C                     MOVEL'TABLE'   DBFILE
     C                     MOVELTABKEY    DBKEY
0644 C                     EXSR EDSPLY
0645 C                     GOTO SETEOJ
     C                     END
0646 C**
0647 C**   TABLE HEADER RECORD.  DATABASE ERROR IF NOT FOUND.
     C**   DATABASE ERROR POINT 2.
0648 C                     MOVEL'01'      TABKEY
     C                     EXSR TABRED                     ** DB02 **
     C*
     C           *IN02     IFEQ '0'
     C                     SETON                     U8
     C                     MOVE 998       ERROR
     C                     Z-ADD2         DBASE
     C                     MOVEL'TABLE'   DBFILE
     C                     MOVELTABKEY    DBKEY
0644 C                     EXSR EDSPLY
0645 C                     GOTO SETEOJ
     C                     END
0654 C**
0655 C**   INSTALLATION CONTROL DATA RECORD 1.
0656 C**   MUST EXIST ELSE SYSTEM ERROR IF NOT FOUND.
     C**   DATABASE ERROR POINT 3.
     C                     MOVE '10'      TABKEY
     C                     EXSR TABRED                     ** DB03 **
     C*
     C           *IN03     IFEQ '0'
     C                     SETON                     U8
     C                     MOVE 998       ERROR
     C                     Z-ADD3         DBASE
     C                     MOVEL'TABLE'   DBFILE
     C                     MOVELTABKEY    DBKEY
     C                     EXSR EDSPLY
     C                     GOTO SETEOJ
     C                     END
     C**
0670 C**   SYSTEM SET-UP FLAG MUST BE OFF.
     C**   SYSTEM ERROR IF THIS IS NOT TRUE.
     C           *IN20     IFEQ '1'
     C                     SETON                     U3
     C                     Z-ADD999       ERROR
     C                     EXSR EDSPLY
     C                     GOTO SETEOJ
     C                     END
     C**                                                                  S01129
     C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01129
     C           DATF      COMP 'M'                      98MMDDYY, 98 ON  S01129
     C**
0671 C**   DETERMINE MODULES PRESENT IN SYSTEM.
     C                     TESTB'6'       MODI1          22EXP MNGMT
     C                     TESTB'4'       MODI1          23SEC. TRADINGS
0672 C                     TESTB'0'       MODI2          24STAT. RETURNS
0673 C                     TESTB'1'       MODI1          25DEALING
0674 C                     TESTB'7'       MODI2          26RETAIL II
0674 C  N26                TESTB'2'       MODI5          26I.O.A          E23394
0675 C                     TESTB'3'       MODI1          27COMM.LOANS.
0675 C                     TESTB'1'       MODI2          28CUST.LEND.
0675 C                     TESTB'4'       MODI3          65SEC TRAD R2    S01129
0675 C                     TESTB'0'       MODI5          34FUT.+ OPTIONS  S01127
0676 C**
0677 C**   INSTALLATION CONTROL DATA RECORD 2.
     C**   MUST EXIST ELSE SYSTEM ERROR IF NOT FOUND.
     C**   DATABASE ERROR POINT 4.
     C                     MOVE '11'      TABKEY
     C                     EXSR TABRED                     ** DB04 **
     C*
     C           *IN04     IFEQ '0'
     C                     SETON                     U8
     C                     MOVE 998       ERROR
     C                     Z-ADD4         DBASE
     C                     MOVEL'TABLE'   DBFILE
     C                     MOVELTABKEY    DBKEY
     C                     EXSR EDSPLY
     C                     GOTO SETEOJ
     C                     END
0692 C**
0693 C**   INSTALLATION CONTROL DATA RECORD 3.
0656 C**   MUST EXIST ELSE DATABASE ERROR IF NOT FOUND.
     C**   DATABASE ERROR POINT 5.
     C                     MOVE '20'      TABKEY
     C                     EXSR TABRED                     ** DB05 **
     C*
     C           *IN05     IFEQ '0'
     C                     SETON                     U8
     C                     MOVE 998       ERROR
     C                     Z-ADD5         DBASE
     C                     MOVEL'TABLE'   DBFILE
     C                     MOVELTABKEY    DBKEY
     C                     EXSR EDSPLY
     C                     GOTO SETEOJ
     C                     END
0708 C**
0709 C**   INSTALLATION CONTROL DATA RECORD 4.
0711 C**   MUST EXIST IF STAT. RETURNS MODULE PRESENT IN SYSTEM.
0712 C**   SYSTEM ERROR IF NOT FOUND.
0713 C                     MOVE '30'      TABKEY
0714 C                     EXSR TABRED
     C*                                                                   E16053
     C           *IN06     IFEQ '0'                                       E16053
     C           *IN24     ANDEQ'1'                                       E16053
     C                     SETON                     U8                   E16053
     C                     MOVE 999       ERROR                           E16053
     C                     Z-ADD16        DBASE                           E16053
     C                     MOVEL'TABLE'   DBFILE                          E16053
     C                     MOVELTABKEY    DBKEY                           E16053
     C                     EXSR EDSPLY                                    E16053
     C                     GOTO SETEOJ                                    E16053
     C                     END                                            E16053
0716 C**N06*24*************SETON                     U3                   E16053
0717 C***U3****************Z-ADD999       ERROR                           E16053
0718 C***U3****************EXSR EDSPLY                                    E16053
0719 C***U3****************GOTO SETEOJ                                    E16053
0720 C**
     C**
     C**   INSTALLATION CONTROL DATA RECORD 35.
     C**   MUST EXIST SEC. TRADING MODULE PRESENT IN SYSTEM.
     C**   SYSTEM ERROR IF NOT FOUND.
     C                     MOVE '35'      TABKEY
     C                     EXSR TABRED
     C*                                                                   E16053
     C           *IN17     IFEQ '0'                                       E16053
     C           *IN23     ANDEQ'1'                                       E16053
     C                     SETON                     U8                   E16053
     C                     MOVE 999       ERROR                           E16053
     C                     Z-ADD17        DBASE                           E16053
     C                     MOVEL'TABLE'   DBFILE                          E16053
     C                     MOVELTABKEY    DBKEY                           E16053
     C                     EXSR EDSPLY                                    E16053
     C                     GOTO SETEOJ                                    E16053
     C                     END                                            E16053
0716 C**N17*23*************SETON                     U3                   E16053
0717 C***U3****************Z-ADD999       ERROR                           E16053
0718 C***U3****************EXSR EDSPLY                                    E16053
0719 C***U3****************GOTO SETEOJ                                    E16053
0720 C**                                                                  S01129
     C**                                                                  S01129
     C**   INSTALLATION CONTROL DATA RECORD 36.                           S01129
     C**   MUST EXIST SEC. TRADING RELEASE 2  MODULE PRESENT IN SYSTEM.   S01129
     C**   SYSTEM ERROR IF NOT FOUND.                                     S01129
     C                     MOVE '36'      TABKEY                          S01129
     C           TABKEY    CHAINTABSE                76                   S01129
     C*                                                                   E16053
     C           *IN76     IFEQ '1'                                       E16053
     C           *IN65     ANDEQ'1'                                       E16053
     C                     SETON                     U8                   E16053
     C                     MOVE 999       ERROR                           E16053
     C                     Z-ADD18        DBASE                           E16053
     C                     MOVEL'TABLE'   DBFILE                          E16053
     C                     MOVELTABKEY    DBKEY                           E16053
     C                     EXSR EDSPLY                                    E16053
     C                     GOTO SETEOJ                                    E16053
     C                     END                                            E16053
     C***76*65*************SETON                     U3             S01129E16053
     C***U3****************Z-ADD999       ERROR                     S01129E16053
     C***U3****************EXSR EDSPLY                              S01129E16053
     C***U3****************GOTO SETEOJ                              S01129E16053
     C**
0721 C**   INSTALLATION CONTROL DATA RECORD 5.
     C**   MUST EXIST IF DEALING MODULE PRESENT IN SYSTEM.
     C**   SYSTEM ERROR IF NOT FOUND.
0725 C                     MOVE '40'      TABKEY
0726 C                     EXSR TABRED
     C*                                                                   E16053
     C           *IN07     IFEQ '0'                                       E16053
     C           *IN25     ANDEQ'1'                                       E16053
     C                     SETON                     U8                   E16053
     C                     MOVE 999       ERROR                           E16053
     C                     Z-ADD19        DBASE                           E16053
     C                     MOVEL'TABLE'   DBFILE                          E16053
     C                     MOVELTABKEY    DBKEY                           E16053
     C                     EXSR EDSPLY                                    E16053
     C                     GOTO SETEOJ                                    E16053
     C                     END                                            E16053
0728 C**N07*25*************SETON                     U3                   E16053
0729 C***U3****************Z-ADD999       ERROR                           E16053
0730 C***U3****************EXSR EDSPLY                                    E16053
0731 C***U3****************GOTO SETEOJ                                    E16053
     C**                                                                  S01119
0721 C**   INSTALLATION CONTROL DATA RECORD 70 - FRA/IRS                  S01119
     C**   MUST EXIST IF FRA/IRS PRESENT IN SYSTEM.                       S01119
     C**   SYSTEM ERROR IF NOT FOUND.                                     S01119
     C           IRFRA     IFEQ 'Y'                                       S01119
0725 C                     MOVE '70'      TABKEY                          S01119
0726 C                     EXSR TABRED                                    S01119
     C*                                                                   E16053
     C           *IN76     IFEQ '1'                                       E16053
     C           *IN19     OREQ '1'                                       E16053
     C                     SETON                     U8                   E16053
     C                     MOVE 999       ERROR                           E16053
     C                     Z-ADD20        DBASE                           E16053
     C                     MOVEL'TABLE'   DBFILE                          E16053
     C                     MOVELTABKEY    DBKEY                           E16053
     C                     EXSR EDSPLY                                    E16053
     C                     GOTO SETEOJ                                    E16053
     C                     END                                            E16053
0728 C***76****************                                         S01119E16053
0728 C*R*19****************SETON                     U3             S01119E16053
0729 C***U3****************Z-ADD999       ERROR                           E16053
0730 C***U3****************EXSR EDSPLY                                    E16053
0731 C***U3****************GOTO SETEOJ                                    E16053
     C                     END                                            S01119
0720 C**
0721 C**   INSTALLATION CONTROL DATA RECORD 6.
     C**   MUST EXIST IF CUSTOMER LENDING MODULE PRESENT
     C**   IN SYSTEM.SYSTEM ERROR IF NOT FOUND.
0725 C                     MOVE '50'      TABKEY
0726 C                     EXSR TABRED
     C*                                                                   E16053
     C           *IN16     IFEQ '0'                                       E16053
     C           *IN28     ANDEQ'1'                                       E16053
     C                     SETON                     U8                   E16053
     C                     MOVE 999       ERROR                           E16053
     C                     Z-ADD21        DBASE                           E16053
     C                     MOVEL'TABLE'   DBFILE                          E16053
     C                     MOVELTABKEY    DBKEY                           E16053
     C                     EXSR EDSPLY                                    E16053
     C                     GOTO SETEOJ                                    E16053
     C                     END                                            E16053
0728 C**N16*28*************SETON                     U3                   E16053
0729 C***U3****************Z-ADD999       ERROR                           E16053
0730 C***U3****************EXSR EDSPLY                                    E16053
0731 C***U3****************GOTO SETEOJ                                    E16053
     C**                                                                  S01127
     C**   INSTALLATION CONTROL DATA RECORD 80.                           S01127
     C**   MUST EXIST IF FUTURES + OPTIONS MODULE PRESENT IN SYSTEM.      S01127
     C**   SYSTEM ERROR IF NOT FOUND.                                     S01127
     C                     MOVE '80'      TABKEY                          S01127
     C                     EXSR TABRED                                    S01127
     C*                                                                   E16053
     C           *IN12     IFEQ '0'                                       E16053
     C           *IN34     ANDEQ'1'                                       E16053
     C                     SETON                     U8                   E16053
     C                     MOVE 999       ERROR                           E16053
     C                     Z-ADD22        DBASE                           E16053
     C                     MOVEL'TABLE'   DBFILE                          E16053
     C                     MOVELTABKEY    DBKEY                           E16053
     C                     EXSR EDSPLY                                    E16053
     C                     GOTO SETEOJ                                    E16053
     C                     END                                            E16053
0728 C**N12*34*************SETON                     U3                   E16053
0729 C***U3****************Z-ADD999       ERROR                           E16053
0730 C***U3****************EXSR EDSPLY                                    E16053
0731 C***U3****************GOTO SETEOJ                                    E16053
0742 C**
0743 C**   SET UP CONSTANT FOR BRANCH CODES KEY.
0744 C                     MOVEL'10'      BRCKEY 12
0745 C**
0746 C**   SET UP CONSTANT FOR CURRENCIES KEY.
0747 C                     MOVE '1'       CCYKEY  4
0748 C**
0749 C**   SET UP CONSTANT FOR ACCOUNT CODES KEY.
0750 C**********           MOVE '1'       ACCKEY  5                                           CGL029
0751 C**
0752 C**   SET UP CONSTANT FOR COUNTRIES KEY.
0753 C                     MOVEL'50'      CTYKEY 12
0754 C**
0755 C**   SET UP CONSTANT FOR CUSTOMER KEY.
0756 C                     MOVE 'A'       CLTKEY  7
0757 C**
0758 C**   SET UP BLANK FIELD.
0759 C                     MOVE ' '       BLANKS150
0760 C**
0761 C**   SET UP ZERO FIELDS FOR NUMERIC OUTPUT.
0762 C                     Z-ADD0         ZERO03  30
0763 C                     Z-ADD0         ZERO04  40
0764 C                     Z-ADD0         ZERO05  50
0765 C                     Z-ADD0         ZERO06  60
0766 C                     Z-ADD0         ZERO07  70
0767 C**
2233 C**   PROGRAM PROCESSING TO SET ON SYSTEM SET UP FLAG.
2234 C**   NO MANUAL INPUT REQUIRED, CHECK FOR REQUIRED FIELDS.
2236 C**
2237 C**   DEFAULT BRANCH NUMBER, IF PRESENT MUST BE A VALID BRANCH CODE.
2238 C           DFBR      COMP 0                    30
2239 C                     MOVE DFBR      BRCKEY
2240 C                     MOVE BRCKEY    TABKEY
2241 C   30                EXSR TABRED
2242 C                     Z-ADD4         ERROR
2243 C   30N08             EXSR EDSPLY
2244 C**
2245 C**   BASE CURRENCY FOR ACCOUNTING, MUST BE A VALID CURRENCY.
2246 C                     MOVELBCCY      CCYKEY
2247 C                     MOVEL'20      'TABKEY
2248 C                     MOVE CCYKEY    TABKEY
2249 C                     EXSR TABRED
2250 C                     Z-ADD31        ERROR
2251 C  N09                EXSR EDSPLY
2252 C**
2253 C**   BASE CURRENCY FOR LIMITS, MUST BE A VALID CURRENCY,
2254 C**   REQUIRED ONLY IF DEALING MODULE PRESENT.
2255 C                     MOVELBCYL      CCYKEY
2256 C                     MOVE CCYKEY    TABKEY
2257 C   25                EXSR TABRED
2258 C                     Z-ADD32        ERROR
2259 C   25N09             EXSR EDSPLY
2260 C**
2261 C**   HEAD OFFICE CURRENCY, IF PRESENT MUST BE A VALID CURRENCY.
2262 C           HOCY      COMP ' '                  30
2263 C                     MOVELHOCY      CCYKEY
2264 C                     MOVE CCYKEY    TABKEY
2265 C   30                EXSR TABRED
2266 C                     Z-ADD34        ERROR
2267 C   30N09             EXSR EDSPLY
2268 C**
2269 C**   CUSTOMER NUMBER OF HEAD OFFICE,
2270 C**   IF PRESENT MUST BE A VALID CUSTOMER.
2271 C********** HEAD      COMP 0                    30                                       CSD027
2271 C           HEAD      COMP *BLANKS              30                                       CSD027
2272 C                     MOVELHEAD      CLTKEY
2273 C   30                EXSR CLTCHN
2274 C                     Z-ADD35        ERROR
2275 C   30N15             EXSR EDSPLY
2276 C**
2277 C**   COUNTRY OF USER, IF PRESENT MUST BE A VALID COUNTRY.
2278 C           CUZR      COMP ' '                  30
2279 C                     MOVE CUZR      CTYKEY
2280 C                     MOVE CTYKEY    TABKEY
2281 C   30                EXSR TABRED
2282 C                     Z-ADD42        ERROR
2283 C   30N11             EXSR EDSPLY
2284 C**
2285 C**   LOCAL CURRENCY, MUST BE A VALID CURRENCY.
2286 C                     MOVELLOCY      CCYKEY
2287 C                     MOVEL'20      'TABKEY
2288 C                     MOVE CCYKEY    TABKEY
2289 C                     EXSR TABRED
2290 C                     Z-ADD33        ERROR
2291 C  N09                EXSR EDSPLY
2292 C**
2293 C**   COMPUTER SUSPENSE ACCOUNT CODE,
2294 C**   MUST BE A VALID NON-TITLE ACCOUNT CODE.
2295 C**********           MOVELCOMS      ACCKEY                                              CGL029
2296 C**********           MOVEL'30      'TABKEY                                              CGL029
2297 C**********           MOVE ACCKEY    TABKEY                                              CGL029
2298 C**********           EXSR TABRED                                                        CGL029
     C                     MOVELCOMS      WACOD                                               CGL029
     C                     EXSR SRACOD                                                        CGL029
2299 C                     Z-ADD44        ERROR
     C***10***** ATYP      COMP 'R'                  1010                                     CGL029
     C   10      A5ACTY    COMP 'R'                  1010                                     CGL029
2300 C  N10                EXSR EDSPLY
2301 C**
2302 C**   CURRENT ACCOUNT DEFAULT ACCOUNT CODE,
2303 C**   MUST BE A VALID NON-TITLE ACCOUNT CODE,
2304 C**   REQUIRED ONLY IF RETAIL II MODULE PRESENT.
2305 C**********           MOVELCADC      ACCKEY                                              CGL029
2306 C**********           MOVE ACCKEY    TABKEY                                              CGL029
2307 C***26*****           EXSR TABRED                                                        CGL029
     C                     MOVELCADC      WACOD                                               CGL029
     C           *IN26     IFEQ *ON                                                           CGL029
     C                     EXSR SRACOD                                                        CGL029
     C                     ENDIF                                                              CGL029
2308 C                     Z-ADD46        ERROR
2309 C   26N10             EXSR EDSPLY
2310 C**
2311 C**   SPOT REVALUATION PROFIT/LOSS ACCOUNT CODE
2312 C**   MUST BE A VALID NON-TILE ACCOUNT CODE.
2313 C**********           MOVELSRPL      ACCKEY                                              CGL029
2314 C**********           MOVE ACCKEY    TABKEY                                              CGL029
2315 C**********           EXSR TABRED                                                        CGL029
     C                     MOVELSRPL      WACOD                                               CGL029
     C                     EXSR SRACOD                                                        CGL029
2316 C                     Z-ADD56        ERROR
     C***10***** ATYP      COMP 'R'                  1010                                     CGL029
     C   10      A5ACTY    COMP 'R'                  1010                                     CGL029
2317 C  N10                EXSR EDSPLY
2318 C**
     C/COPY WNCPYSRC,SD0265C001
2319 C**   SPOT TRADE ACCOUNT CODE, MUST BE A VALID NON-TITLE A/C CODE.
2321 C**********           MOVELSPAC      ACCKEY                                              CGL029
2322 C**********           MOVE ACCKEY    TABKEY                                              CGL029
2324 C**********           EXSR TABRED                                                        CGL029
     C                     MOVELSPAC      WACOD                                               CGL029
     C                     EXSR SRACOD                                                        CGL029
2325 C                     Z-ADD57        ERROR
     C***10***** ATYP      COMP 'R'                  1010                                     CGL029
     C   10      A5ACTY    COMP 'R'                  1010                                     CGL029
2327 C  N10                EXSR EDSPLY
     C/COPY WNCPYSRC,SD0265C002
     C**
     C***VALIDATE*PAY/RECEIVE*PRIORITIES*                                 RT0004
     C***********          MOVE PRSW      PRIN,1                          RT0004
     C***********          MOVE PRCI      PRIN,2                          RT0004
     C***********          MOVE PRCA      PRIN,3                          RT0004
     C***********          MOVE PRTX      PRIN,4                          RT0004
     C***********          MOVE PRFW      PRIN,5                          RT0004
     C***********          MOVE PRBW      PRIN,6                          RT0004
     C***********          Z-ADD0         N       10                      RT0004
     C***********PRPBEG    TAG                             ** PRBEG TAG **RT0004
     C***********N         ADD  1         N                               RT0004
     C***********          Z-ADD1         M       10                      RT0004
     C***NO*DUPLICATES*ALLOWED*EXCEPT*BLANKS*                             RT0004
     C***********                                                         RT0004
     C***********PRCHK     TAG                             ** PRCHK TAG **RT0004
     C***********M         COMP N                        30               RT0004
     C***30******          MOVE PRIN,N    PRCH,N                          RT0004
     C***30******          GOTO PRPEND                                    RT0004
     C***********PRIN,N    COMP PRCH,M                   30               RT0004
     C***30******PRCH,N    COMP ' '                  3232                 RT0004
     C***30N32***          GOTO PRPEND                                    RT0004
     C***30*32***          Z-ADD85        ERROR                           RT0004
     C***30*32***          EXSR EDSPLY                                    RT0004
     C***30*32***          GOTO PEND                                      RT0004
     C***********M         ADD  1         M                               RT0004
     C***********          GOTO PRCHK                                     RT0004
     C***********                                                         RT0004
     C***********PRPEND    TAG                             ** PRPEND TAG *RT0004
     C***********N         COMP 6                      30                 RT0004
     C***30******          GOTO PRPBEG                                    RT0004
     C***********PEND      TAG                             ** PEND TAG ** RT0004
     C*                                                                   S01129
     C*                                                                   S01129
     C* PERFORM VALIDATION FOR SECURITIES TRADING RELEASE 2               S01129
     C           *IN65     IFEQ '1'                                       S01129
     C                     EXSR SEVAL                                     S01129
     C                     END                                            S01129
     C**
     C** VALIDATE NEXT SIX FIELDS ONLY IF SEC. TRADING MODULE PRESENT
     C  N23                GOTO STEND
     C*
     C                     SETOF                     606162
     C                     MOVEL'10      'TABKEY
     C                     MOVE ' 000'    TABKEY
     C           TABKEY    SETLLTABLE
     C*
     C           *IN60     DOWEQ'0'
     C                     READ TABLE                    60
     C           *IN08     IFNE '1'
     C           RECT      COMP 10                   6060
     C                     ELSE
     C                     MOVELBICN      CLTKEY
     C                     MOVE '1'       CLTKEY
     C                     EXSR CLTCHN
     C           *IN89     IFNE '1'
     C           *IN18     IFEQ '1'
     C           *IN61     IFNE '1'
     C           ECAT      COMP 'P '                     61
     C                     END
     C           *IN62     IFNE '1'
     C           CEAC      COMP 'P '                     62
     C                     END
     C                     END
     C                     END
     C                     END
     C  N61
     CORN62                END
     C*****
     C****
     C***  VALIDATION FOR FOLLOWING FIELDS SKIPPED AS NOT INPUT
     C***       BY ICDR MAINT
     C****
     C*****
     C                     GOTO NOENT1
     C*
     C* NOSTRO FOR EUROCLEAR NO. 1 - NEN1
     C*
     C           NEN1      IFEQ '  '
     C           *IN61     IFEQ '1'
     C                     Z-ADD27        ERROR
     C                     EXSR EDSPLY
     C                     END
     C                     ELSE
     C           *IN61     IFNE '1'
     C                     Z-ADD48        ERROR
     C                     EXSR EDSPLY
     C                     END
     C                     END
     C*
     C* NOSTRO FOR CEDEL NO. 1 - NCN1
     C*
     C           NCN1      IFEQ '  '
     C           *IN62     IFEQ '1'
     C                     Z-ADD29        ERROR
     C                     EXSR EDSPLY
     C                     END
     C                     ELSE
     C           *IN62     IFNE '1'
     C                     Z-ADD49        ERROR
     C                     EXSR EDSPLY
     C                     END
     C                     END
     C*
     C* NOSTRO FOR EUROCLEAR NO. 2 - NEN2
     C*
     C           NEN2      IFNE '  '
     C           *IN61     IFNE '1'
     C                     Z-ADD50        ERROR
     C                     EXSR EDSPLY
     C                     END
     C                     END
     C*
     C* NOSTRO FOR CEDEL NO. 2 - NCN2
     C*
     C           NCN2      IFNE '  '
     C           *IN62     IFNE '1'
     C                     Z-ADD51        ERROR
     C                     EXSR EDSPLY
     C                     END
     C                     END
     C*
     C* EUROCLEAR CLIENT NUMBER - ECLN
     C*
     C           *IN61     IFEQ '1'
     C                     MOVELECLN      CLTKEY
     C                     EXSR CLTCHN
     C                     Z-ADD33        ERROR
     C  N18                EXSR EDSPLY
     C           NOENT1    TAG                             ** NOENT1 TAG**
     C*
     C* EUROCLEAR CURRENCY CODE - ECCC
     C*
     C                     MOVEL'20      'TABKEY
     C                     MOVELECCC      CCYKEY
     C                     MOVE CCYKEY    TABKEY
     C                     EXSR TABRED
     C                     Z-ADD36        ERROR
     C  N09                EXSR EDSPLY
     C                     END
     C*****
     C****
     C***  VALIDATION FOR FOLLOWING FIELD  SKIPPED AS NOT INPUT
     C***       BY ICDR MAINT
     C****
     C*****
     C                     GOTO NOENT2
     C*
     C* CEDEL CLIENT NUMBER - CCLN
     C*
     C           *IN62     IFEQ '1'
     C                     MOVELCCLN      CLTKEY
     C                     EXSR CLTCHN
     C                     Z-ADD34        ERROR
     C  N18                EXSR EDSPLY
     C           NOENT2    TAG                             ** NOENT2 TAG**
     C*
     C* CEDEL CURRENCY CODE - CDCC
     C*
     C                     MOVEL'20      'TABKEY
     C                     MOVELCDCC      CCYKEY
     C                     MOVE CCYKEY    TABKEY
     C                     EXSR TABRED
     C                     Z-ADD38        ERROR
     C  N09                EXSR EDSPLY
     C                     END
     C           STEND     TAG                             ** STEND TAG **
     C*
     C*    RESET CLIENT KEY
     C*
     C                     MOVE 'A'       CLTKEY
     C**                                                                  S01127
     C** VALIDATE NEXT 4 FIELDS ONLY IF FF MODULE PRESENT                 S01127
     C**                                                                  S01127
     C           *IN34     IFEQ '1'                                       S01127
     C**                                                                  S01127
     C**   DEFAULT TRADE BOOK, MUST BE A VALID BOOK CODE                  S01127
     C           DFTB      CHAINBOOKD                13                   S01127
     C  N13      RECIB     COMP 'D'                  1313                 S01127
     C           *IN13     IFEQ '1'                                       S01127
     C                     Z-ADD200       ERROR                           S01127
     C                     EXSR EDSPLY                                    S01127
     C                     END                                            S01127
     C**                                                                  S01127
     C**   DEFAULT CUSTOMER BOOK, MUST BE A VALID BOOK CODE               S01127
     C           DFCB      CHAINBOOKD                13                   S01127
     C  N13      RECIB     COMP 'D'                  1313                 S01127
     C           *IN13     IFEQ '1'                                       S01127
     C                     Z-ADD201       ERROR                           S01127
     C                     EXSR EDSPLY                                    S01127
     C                     END                                            S01127
     C**                                                                  S01127
     C**   DEFAULT BROKER ACCOUNT CODE, IF PRESENT                        S01127
     C**   MUST BE VALID NON-TITLE ACCOUNT CODE.                          S01127
     C           DFBA      IFNE 0                                         S01127
     C**********           MOVEL'30      'TABKEY                                       S01127 CGL029
     C**********           MOVELDFBA      ACCKEY                                       S01127 CGL029
     C**********           MOVE ACCKEY    TABKEY                                       S01127 CGL029
     C**********           EXSR TABRED                                                 S01127 CGL029
     C                     MOVELDFBA      WACOD                                               CGL029
     C                     EXSR SRACOD                                                        CGL029
     C           *IN10     IFEQ '0'                                       S01127
     C                     Z-ADD207       ERROR                           S01127
     C                     EXSR EDSPLY                                    S01127
     C                     END                                            S01127
     C                     END                                            S01127
     C**                                                                  S01127
     C**   DEFAULT CUSTOMER ACCOUNT CODE, IF PRESENT                      S01127
     C**   MUST BE VALID NON-TITLE ACCOUNT CODE.                          S01127
     C           DFCA      IFNE 0                                         S01127
     C**********           MOVEL'30      'TABKEY                                       S01127 CGL029
     C**********           MOVELDFCA      ACCKEY                                       S01127 CGL029
     C**********           MOVE ACCKEY    TABKEY                                       S01127 CGL029
     C**********           EXSR TABRED                                                 S01127 CGL029
     C                     MOVELDFCA      WACOD                                               CGL029
     C                     EXSR SRACOD                                                        CGL029
     C           *IN10     IFEQ '0'                                       S01127
     C                     Z-ADD208       ERROR                           S01127
     C                     EXSR EDSPLY                                    S01127
     C                     END                                            S01127
     C                     END                                            S01127
     C**                                                                  S01127
     C                     END                                            S01127
2328 C**
     C***VALIDATE*NEXT*FOUR*FIELDS*ONLY*IF*EM*MODULE*PRESENT              S01129
     C** VALIDATE NEXT FIELDS ONLY IF EM MODULE PRESENT                   S01129
     C**
     C  N22                GOTO EMEND
     C*                                                                   S01129
     C** ACCESS TABTB95 RECORD                                            S01129
     C                     READ TABTB95                  04               S01129
     C           *IN04     IFEQ '1'                                       S01129
     C                     SETON                     U8                   S01129
     C                     MOVE 998       ERROR                           S01129
     C                     Z-ADD13        DBASE                           S01129
     C                     MOVEL'TABLE'   DBFILE                          S01129
     C                     MOVEL'01      'DBKEY                           S01129
     C                     MOVE '95'      DBKEY                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     GOTO SETEOJ                                    S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C** ACCESS TABTB40 RECORD                                            S01129
     C                     MOVEL'01      'TABKEY                          S01129
     C                     MOVE '  40'    TABKEY                          S01129
0726 C                     EXSR TABRED                                    S01129
     C************IN07     IFEQ '1'                                S01129 E14642
     C           *IN07     IFNE '1'                                       E14642
     C                     SETON                     U8                   S01129
     C                     MOVE 998       ERROR                           S01129
     C                     Z-ADD14        DBASE                           S01129
     C                     MOVEL'TABLE'   DBFILE                          S01129
     C                     MOVEL'01      'DBKEY                           S01129
     C                     MOVE '40'      DBKEY                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     GOTO SETEOJ                                    S01129
     C                     END                                            S01129
     C*
     C* LIMIT CURRENCY CODE - LCCY
     C*
     C                     MOVEL'20      'TABKEY
     C                     MOVELLCCY      CCYKEY
     C                     MOVE CCYKEY    TABKEY
     C                     EXSR TABRED
     C*                    Z-ADD200       ERROR                           S01129
     C                     Z-ADD230       ERROR                           S01129
     C  N09                EXSR EDSPLY
     C*                                                                   S01129
     C*  VALIDATE TIME                                                    S01129
     C*  DEVIDE TIME INTO HOURS, MINS AND SECS                            S01129
     C           TMCHK     TAG                                            S01129
     C           WTIM      COMP 000000                 3333               S01129
     C   33                GOTO ENDVL                                     S01129
     C                     MOVELWTIM      WKHRS   20                      S01129
     C                     MOVE WTIM      TEMP1   40                      S01129
     C                     MOVELTEMP1     WKMINS  20                      S01129
     C                     MOVE TEMP1     WKSECS  20                      S01129
     C           WKHRS     COMP 24                   33                   S01129
     C  N33      WKHRS     COMP 00                     33                 S01129
     C   33                GOTO ENDVL                                     S01129
     C**                                                                  S01129
     C           WKMINS    COMP 60                   33                   S01129
     C  N33      WKMINS    COMP 00                     33                 S01129
     C   33                GOTO ENDVL                                     S01129
     C**                                                                  S01129
     C           WKSECS    COMP 60                   33                   S01129
     C  N33      WKSECS    COMP 00                     33                 S01129
     C           ENDVL     TAG                                            S01129
     C*                                                                   S01129
     C           *IN33     IFEQ '1'                                       S01129
     C                     MOVE '231'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C* VALIDATE MODULE SEQUENCES INPUT                                   S01129
     C*                                                                   S01129
     C*  - MOVE INPUT FIELDS INTO SEQUENCE ARRAY                          S01129
     C*  - CLEAR IND ARRAY FOR SETTING ERROR INDICATORS                   S01129
     C*                                                                   S01129
     C                     MOVE MSFX      SEQ,1                           S01129
     C                     MOVE MSMM      SEQ,2                           S01129
     C*********************MOVE MSIF      SEQ,3                     S01129E23804
     C                     MOVE *ZEROS    SEQ,3                           E23804
     C                     MOVE MSLN      SEQ,4                           S01129
     C                     MOVE MSRE      SEQ,5                           S01129
     C*********************MOVE MSLC      SEQ,6                    S01129 S01314
     C                     MOVE *ZEROS    SEQ,6                           S01314
     C                     MOVE MSSC      SEQ,7                           S01129
     C                     MOVE MSSI      SEQ,8                           S01129
     C                     MOVE MSSP      SEQ,9                           S01129
     C*********************MOVE MSFI      SEQ,10                    S01129E23804
     C                     MOVE *ZEROS    SEQ,10                          E23804
     C                     SETOF                     3334                 S01129
     C*                                                                   S01129
     C*  - IF ALL MODULE SEQUENCES ARE BLANK - EXIT FROM VALIDATION       S01129
     C*                                                                   S01129
     C           SEQDSF    IFEQ *ZEROS                                    S01129
     C                     GOTO EMDSQ                                     S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C* CHECK FOR ANY ENTRIES OTHER THAN BLANK AND 01-10                  S01129
     C*                                                                   S01129
     C                     Z-ADD1         A       20                      S01129
     C                     DO   10        A                               S01129
     C           SEQ,A     IFLT 00                                        S01129
     C           SEQ,A     ORGT 10                                        S01129
     C                     MOVE '1'       *IN34                           S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C           *IN34     IFEQ '1'                                       S01129
     C                     MOVE '232'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C*  - CHECK FOR DUPLICATE SEQUENCES ENTERED                          S01129
     C*                                                                   S01129
     C                     MOVE SEQ       SQD                             S01129
     C*                                                                   S01129
     C                     DO   10        A                               S01129
     C*  - CHECK FOR PORTFOLIO OR ISSUER                                  S01129
     C                     Z-ADD1         B       20                      S01129
     C                     DO   10        B                               S01129
     C*                                                                   S01129
     C           SEQ,A     IFEQ SQD,B                                     S01129
     C           SEQ,A     ANDNE*ZEROS                                    S01129
     C           A         ANDNEB                                         S01129
     C                     MOVE '1'       *IN33                           S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C           *IN33     IFEQ '1'                                       S01129
     C                     MOVE '233'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C*  - CHECK THAT IF SEQUENCE ENTERED FOR MODULE THAT THE MODULE IS   S01129
     C*      IN THE SYSTEM                                                S01129
     C*                                                                   S01129
     C*  - FOREIGN EXCHANGE                                               S01129
     C           MSFX      IFNE *ZEROS                                    S01129
     C                     TESTB'1'       MODI1          34               S01129
     C           *IN34     IFNE '1'                                       S01129
     C                     MOVE '1'       *IN33                           S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C*  - MONEY MARKET                                                   S01129
     C           MSMM      IFNE *ZEROS                                    S01129
     C                     TESTB'1'       MODI1          34               S01129
     C           *IN34     IFNE '1'                                       S01129
     C                     MOVE '1'       *IN33                           S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C***-*IRS/FRA                                                        S01129
     C***********MSIF******IFNE *ZEROS                              S01129E23804
     C***********IRFRA*****IFNE 'Y'                                 S01129E23804
     C*********************MOVE '1'       *IN33                     S01129E23804
     C*********************END                                      S01129E23804
     C*********************END                                      S01129E23804
     C*                                                                   S01129
     C*  - LOANS                                                          S01129
     C           MSLN      IFNE *ZEROS                                    S01129
     C                     TESTB'3'       MODI1          34               S01129
     C  N34                TESTB'1'       MODI2          34               S01129
     C           *IN34     IFNE '1'                                       S01129
     C                     MOVE '1'       *IN33                           S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C*  - RETAIL                                                         S01129
     C           MSRE      IFNE *ZEROS                                    S01129
     C                     TESTB'7'       MODI2          34               S01129
     C  N34                TESTB'2'       MODI5          34               E23394
     C           *IN34     IFNE '1'                                       S01129
     C                     MOVE '1'       *IN33                           S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C***-*LETTERS OF CREDIT                                      S01129  S01314
     C***********MSLC      IFNE *ZEROS                            S01129  S01314
     C*********************TESTB'5'       MODI1          34       S01129  S01314
     C************IN34     IFNE '1'                               S01129  S01314
     C*********************MOVE '1'       *IN33                   S01129  S01314
     C*********************END                                    S01129  S01314
     C*********************END                                    S01129  S01314
     C*                                                                   S01129
     C*  - SE COUNTERPARTY                                                S01129
     C           MSSC      IFNE *ZEROS                                    S01129
     C                     TESTB'4'       MODI3          34               S01129
     C           *IN34     IFNE '1'                                       S01129
     C                     MOVE '1'       *IN33                           S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C*  - ISSUER                                                         S01129
     C           MSSI      IFNE *ZEROS                                    S01129
     C                     TESTB'4'       MODI3          34               S01129
     C           *IN34     IFNE '1'                                       S01129
     C                     MOVE '1'       *IN33                           S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C*  - PORTFOLIO OFFSET                                               S01129
     C           MSSP      IFNE *ZEROS                                    S01129
     C                     TESTB'4'       MODI3          34               S01129
     C           *IN34     IFNE '1'                                       S01129
     C                     MOVE '1'       *IN33                           S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C***-*FUTURES*AND*OPTIONS                                            S01129
     C***********MSFI******IFNE *ZEROS                                    S01129
     C*********************TESTB'0'       MODI5          34               S01129
     C************IN34*****IFNE '1'                                       S01129
     C*********************MOVE '1'       *IN33                           S01129
     C*********************END                                            S01129
     C*********************END                                            S01129
     C*                                                                   S01129
     C           *IN33     IFEQ '1'                                       S01129
     C                     MOVE '235'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C* IF NO MODULE SEQUENCES ENTERED, NO OTHER DATA SHOULD BE ENTERED   S01129
     C*                                                                   S01129
     C           EMDSQ     TAG                                            S01129
     C*                                                                   S01129
     C           SEQDSF    IFEQ *ZEROS                                    S01129
     C           IFTR      IFNE *BLANKS                                   S01129
     C           PFTR      ORNE *BLANKS                                   S01129
     C           LSNG      ORNE *BLANKS                                   S01129
     C           PIFX      ORNE *BLANKS                                   S01129
     C           CPTG      ORNE *BLANKS                                   S01129
     C           AFPC      ORNE *BLANKS                                   S01129
     C                     ADD  1         X                               S01129
     C                     MOVE '242'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C                     ELSE                                           S01129
     C*                                                                   S01129
     C* THE FOLLOWING VALIDATION IS ONLY DONE IF MODULE SEQUENCE/S ARE    S01129
     C*  ENTERED                                                          S01129
     C*                                                                   S01129
     C           MSSC      IFNE *ZEROS                                    E18499
     C*                                                                   S01129
     C* ISSUER RISK FACTORED - IFTR                                       S01129
     C*                                                                   S01129
     C           IFTR      IFEQ *BLANKS                                   S01129
     C           IFTR      ORNE 'N'                                       S01129
     C           IFTR      ANDNE'Y'                                       S01129
     C                     Z-ADD236       ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C* PORTFOLIO HOLDINGS FACTORED - PFTR                                S01129
     C*                                                                   S01129
     C           PFTR      IFEQ *BLANKS                                   S01129
     C           PFTR      ORNE 'N'                                       S01129
     C           PFTR      ANDNE'Y'                                       S01129
     C                     Z-ADD237       ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C* LONG/SHORT HOLDINGS NET/GROSS - LSNG                              S01129
     C*                                                                   S01129
     C           LSNG      IFEQ *BLANKS                                   S01129
     C           LSNG      ORNE 'N'                                       S01129
     C           LSNG      ANDNE'G'                                       S01129
     C                     Z-ADD238       ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C* PORTFOLIO INCLUDES FX - PIFX                                      S01129
     C*                                                                   S01129
     C           PIFX      IFEQ *BLANKS                                   S01129
     C           PIFX      ORNE 'N'                                       S01129
     C           PIFX      ANDNE'Y'                                       S01129
     C                     Z-ADD239       ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C* COUNTERPARTY TAKEN GROSS - CPTG                                   S01129
     C*                                                                   S01129
     C           CPTG      IFEQ *BLANKS                                   S01129
     C           CPTG      ORNE 'N'                                       S01129
     C           CPTG      ANDNE'Y'                                       S01129
     C                     Z-ADD240       ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C* ALLOW FOR PAY CODE - AFPC                                         S01129
     C*                                                                   S01129
     C           AFPC      IFEQ *BLANKS                                   S01129
     C           AFPC      ORNE 'N'                                       S01129
     C           AFPC      ANDNE'Y'                                       S01129
     C                     Z-ADD241       ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C                     END                                            E18499
     C                     END                                            S01129
     C**                                                                  S01129
     C           EMEND     TAG                             ** EMEND TAG **
2328 C**
     C** VALIDATE NEXT FOUR FIELDS ONLY IF DEALING MODULE PRESENT
2330 C  N25                GOTO SRTAG
2331 C**
2332 C**   SWAP TRADE ACCOUNT CODE, IF PRESENT
2333 C**   MUST BE VALID NON-TITLE ACCOUNT CODE.
2334 C           SWAC      COMP 0                    30
     C**********           MOVEL'30      'TABKEY                                              CGL029
2335 C**********           MOVELSWAC      ACCKEY                                              CGL029
2336 C**********           MOVE ACCKEY    TABKEY                                              CGL029
     C**********           MOVEL'30     ' TABKEY                                              CGL029
2337 C***30*****           EXSR TABRED                                                        CGL029
     C                     MOVELSWAC      WACOD                                               CGL029
     C           *IN30     IFEQ *ON                                                           CGL029
     C                     EXSR SRACOD                                                        CGL029
     C                     ENDIF                                                              CGL029
2338 C                     Z-ADD58        ERROR
     C***10***** ATYP      COMP 'R'                  1010                                     CGL029
     C   10      A5ACTY    COMP 'R'                  1010                                     CGL029
2339 C   30N10             EXSR EDSPLY
2340 C**
2341 C**   FORWARD TRADE ACCOUNT CODE, IF PRESENT
2342 C**   MUST BE A VALID NON-TITLE ACCOUNT CODE.
2343 C           FTAC      COMP 0                    30
2344 C**********           MOVELFTAC      ACCKEY                                              CGL029
2345 C**********           MOVE ACCKEY    TABKEY                                              CGL029
2346 C***30*****           EXSR TABRED                                                        CGL029
     C                     MOVELFTAC      WACOD                                               CGL029
     C           *IN30     IFEQ *ON                                                           CGL029
     C                     EXSR SRACOD                                                        CGL029
     C                     ENDIF                                                              CGL029
2347 C                     Z-ADD59        ERROR
     C***10***** ATYP      COMP 'R'                  1010                                     CGL029
     C   10      A5ACTY    COMP 'R'                  1010                                     CGL029
2348 C   30N10             EXSR EDSPLY
2349 C**
2350 C**   TRADE ACCOUNT CODE NUMBER 4,
2351 C**   IF PRESENT MUST BE A VALID NON-TITLE ACCOUNT CODE.
2352 C           TAC4      COMP 0                    30
2353 C**********           MOVELTAC4      ACCKEY                                              CGL029
2354 C**********           MOVE ACCKEY    TABKEY                                              CGL029
2355 C***30*****           EXSR TABRED                                                        CGL029
     C                     MOVELTAC4      WACOD                                               CGL029
     C           *IN30     IFEQ *ON                                                           CGL029
     C                     EXSR SRACOD                                                        CGL029
     C                     ENDIF                                                              CGL029
2356 C                     Z-ADD60        ERROR
     C***10***** ATYP      COMP 'R'                  1010                                     CGL029
     C   10      A5ACTY    COMP 'R'                  1010                                     CGL029
2357 C   30N10             EXSR EDSPLY
2358 C**
2359 C**   TRADE ACCOUNT CODE NUMBER 5,
2360 C**   IF PRESENT MUST BE A VALID NON-TITLE ACCOUNT CODE.
2361 C           TAC5      COMP 0                    30
2362 C**********           MOVELTAC5      ACCKEY                                              CGL029
2363 C**********           MOVE ACCKEY    TABKEY                                              CGL029
2364 C***30*****           EXSR TABRED                                                        CGL029
     C                     MOVELTAC5      WACOD                                               CGL029
     C           *IN30     IFEQ *ON                                                           CGL029
     C                     EXSR SRACOD                                                        CGL029
     C                     ENDIF                                                              CGL029
2365 C                     Z-ADD61        ERROR
     C***10***** ATYP      COMP 'R'                  1010                                     CGL029
     C   10      A5ACTY    COMP 'R'                  1010                                     CGL029
2366 C   30N10             EXSR EDSPLY
2367 C**
2368 C**   VALIDATE NEXT FIELD ONLY IF STATUTORY RETURNS MODULE PRESENT.
2369 C           SRTAG     TAG                             ** SRTAG TAG **
2370 C  N24                GOTO DLTAG
2371 C**
2372 C**   LOCAL STATUTORY AUTHORITY CUSTOMER NUMBER,
2373 C**   MUST BE A VALID CUSTOMER.
2374 C                     MOVELLSAC      CLTKEY
2375 C                     EXSR CLTCHN
2376 C                     Z-ADD77        ERROR
2377 C  N15                EXSR EDSPLY
2378 C**
2379 C**   VALIDATE NEXT THIRTEEN FIELDS ONLY IF DEALING MODULE PRESENT.
2380 C           DLTAG     TAG                             ** DLTAG TAG **
2381 C  N25                GOTO LETAG
2382 C**
2383 C**   COMPENSATING ACCOUNT CODE,MUST BE A VALID NON-TITLE A/C CODE.
2384 C**********           MOVELCOMS      ACCKEY                                              CGL029
2385 C**********           MOVE ACCKEY    TABKEY                                              CGL029
     C**********           MOVEL'30     ' TABKEY                                              CGL029
2386 C**********           EXSR TABRED                                                        CGL029
     C                     MOVELCOMS      WACOD                                               CGL029
     C                     EXSR SRACOD                                                        CGL029
2387 C                     Z-ADD45        ERROR
     C***10***** ATYP      COMP 'R'                  1010                                     CGL029
     C   10      A5ACTY    COMP 'R'                  1010                                     CGL029
2388 C  N10                EXSR EDSPLY
2389 C**
2390 C**   TWO LEVEL INPUT INDICATOR, MUST BE Y OR N.
2391 C           TLII      COMP 'N'                  3030
2392 C   30      TLII      COMP 'Y'                  3030
2393 C                     Z-ADD47        ERROR
2394 C   30                EXSR EDSPLY
2395 C**
2396 C**   MATURITY CONFIRMATIONS REQUIRED INDICATOR, MUST BE Y OR N.
2397 C           MCRI      COMP 'N'                  3030
2398 C   30      MCRI      COMP 'Y'                  303029
2399 C                     Z-ADD48        ERROR
2400 C   30                EXSR EDSPLY
2401 C**
2402 C**   MATURITY CONFIRMATIONS ELAPSED PERIOD IN WORKING DAYS,
2403 C**   MUST BE NON ZERO IF CONFIRMATIONS REQUIRED IND. IS Y.
2404 C           MCEP      COMP 0                      3030
2405 C                     Z-ADD50        ERROR
2406 C   29 30             EXSR EDSPLY
2407 C**
2408 C**   MATURITY CONFIRMATIONS TO GO PERIOD IN WORKING DAYS,
2409 C**   MUST BE NON ZERO IF CONFIRMATIONS REQUIRED IND. IS Y.
2410 C           MCLP      COMP 0                      3030
2411 C                     Z-ADD52        ERROR
2412 C   29 30             EXSR EDSPLY
2413 C**
2414 C**   FORWARD REVALUATION OF DEPOSIT INTEREST
2415 C**   REQUIRED INDICATOR, MUST BE Y OR N.
2416 C           FRDI      COMP 'N'                  3030
2417 C   30      FRDI      COMP 'Y'                  3030
2418 C                     Z-ADD54        ERROR
2419 C   30                EXSR EDSPLY
2420 C**
2421 C**   BASE RATE CHANGE FACILITY INDICATOR, MUST BE Y OR N.
2422 C           BRCF      COMP 'N'                  3030
2423 C   30      BRCF      COMP 'Y'                  3030
2424 C                     Z-ADD63        ERROR
2425 C   30                EXSR EDSPLY
     C**                                                                  S01119
0721 C**   FRA/IRS INDICATOR                                              S01119
     C**   ONLY 'YES' IF BASE RATE CHANGE FACILITY ALLOWED                S01119
     C           IRFRA     IFEQ 'Y'                                       S01119
0725 C           BRCF      ANDNE'Y'                                       S01119
2424 C                     Z-ADD80        ERROR                           S01119
2425 C                     EXSR EDSPLY                                    S01119
     C                     END                                            S00119
     C**                                                                  S01119
0721 C**   FRA/IRS PRESENT                                                S01119
     C**   ACCRUE HEDGED MUST BE Y OR N                                   S01119
     C           IRFRA     IFEQ 'Y'                                       S01119
0725 C           HFRAA     ANDNE'N'                                       S01119
0725 C           HFRAA     ANDNE'Y'                                       S01119
2424 C                     Z-ADD81        ERROR                           S01119
2425 C                     EXSR EDSPLY                                    S01119
     C                     END                                            S00119
     C**                                                                  S01119
0721 C**   FRA/IRS PRESENT                                                S01119
     C**   HEDGED EVENTS ON CASHFLOW MUST BE Y OR N                       S01119
     C           IRFRA     IFEQ 'Y'                                       S01119
0725 C           HEOCF     ANDNE'Y'                                       S01119
0725 C           HEOCF     ANDNE'N'                                       S01119
2424 C                     Z-ADD82        ERROR                           S01119
2425 C                     EXSR EDSPLY                                    S01119
     C                     END                                            S00119
     C**                                                                  S01119
2426 C**
2428 C**   INTERNAL CONTRACT CUSTOMER NUMBER
2429 C**   IF PRESENT MUST BE A VALID CUSTOMER.
2430 C********** PSCN      COMP 0                    30                                       CSD027
2430 C           PSCN      COMP *BLANKS              30                                       CSD027
2431 C                     MOVELPSCN      CLTKEY
2432 C   30                EXSR CLTCHN
2433 C                     Z-ADD65        ERROR
2434 C   30N15             EXSR EDSPLY
2435 C**
2436 C*****BRANCH*CODE*FOR*DEALING,*MUST*BE*A*VALID*BRANCH*CODE.*         RT0004
2437 C***********          MOVE DLBR      BRCKEY                          RT0004
2438 C***********          MOVE BRCKEY    TABKEY                          RT0004
2439 C***********          EXSR TABRED                                    RT0004
2440 C***********          Z-ADD68        ERROR                           RT0004
2441 C**N08*****           EXSR EDSPLY                                    RT0004
2442 C**
2443 C**   FORWARD REVALUATION PROFIT/LOSS ACCOUNT CODE,
2444 C**   MUST BE A VALID NON-TITLE ACCOUNT CODE.
2445 C**   MUST NOT BE THE SAME AS THE FORWARD REVALUATION
2446 C**   PROFIT/LOSS AMOUNT CODE
2447 C**********           MOVELFRPA      ACCKEY                                              CGL029
2448 C**********           MOVEL'30      'TABKEY                                              CGL029
2449 C**********           MOVE ACCKEY    TABKEY                                              CGL029
2450 C**********           EXSR TABRED                                                        CGL029
     C                     MOVELFRPA      WACOD                                               CGL029
     C                     EXSR SRACOD                                                        CGL029
2452 C                     Z-ADD70        ERROR
2453 C   10      FRPA      COMP FRPC                 1010
     C***10***** ATYP      COMP 'R'                  1010                                     CGL029
     C   10      A5ACTY    COMP 'R'                  1010                                     CGL029
2454 C  N10                EXSR EDSPLY
2455 C**
2456 C**   FORWARD REVALUATION PROFIT/LOSS CONTRA ACCOUNT CODE,
2457 C**   MUST BE A VALID NON-TITLE ACCOUNT CODE.
2458 C**********           MOVELFRPC      ACCKEY                                              CGL029
2459 C**********           MOVE ACCKEY    TABKEY                                              CGL029
2460 C**********           EXSR TABRED                                                        CGL029
     C                     MOVELFRPC      WACOD                                               CGL029
     C                     EXSR SRACOD                                                        CGL029
2461 C                     Z-ADD72        ERROR
     C***10***** ATYP      COMP 'R'                  1010                                     CGL029
     C   10      A5ACTY    COMP 'R'                  1010                                     CGL029
2462 C  N10                EXSR EDSPLY
2463 C**
2464 C**   U.S. DOLLAR CURRENCY CODE, MUST BE A VALID CURRENCY CODE.
2465 C                     MOVELUSCY      CCYKEY
2466 C                     MOVEL'20      'TABKEY
2467 C                     MOVE CCYKEY    TABKEY
2468 C                     EXSR TABRED
2469 C                     Z-ADD74        ERROR
2470 C  N09                EXSR EDSPLY
2471 C**
2472 C**   STERLING CURRENCY CODE, MUST BE A VALID CURRENCY CODE.
2473 C                     MOVELSTCY      CCYKEY
2474 C                     MOVE CCYKEY    TABKEY
2475 C                     EXSR TABRED
2476 C                     Z-ADD76        ERROR
2477 C  N09                EXSR EDSPLY
2478 C**
2479 C** MUST HAVE VALID BRANCH ACCRUAL INDICATOR
2480 C                     MOVEL'01      'TABKEY
2481 C                     MOVE '  11'    TABKEY
2482 C                     EXSR TABRED
2483 C  N04                Z-ADD998       ERROR
2484 C  N04                EXSR EDSPLY
2485 C           ACLD      COMP ' '                      30
2486 C   30                Z-ADD995       ERROR
2487 C   30                EXSR EDSPLY
     C** VALIDATE NEXT FIELD ONLY IF CUSTOMER LENDING PRESENT
     C           LETAG     TAG                             ** LETAG TAG*
     C  N28                GOTO CLTAG
     C**
     C** VALIDATE BILL/TELEX INDICATOR
     C**
     C           BTIN      COMP 'B'                      40
     C  N40      BTIN      COMP 'T'                      40
     C  N40      BTIN      COMP 'N'                  484840
     C   48                Z-ADD100       ERROR
     C   48                EXSR EDSPLY
0717 C**
     C** VALIDATE BILLING DAYS
0723 C  N41      BDAY      COMP 01                     41
0724 C  N41      BDAY      COMP 28                   41
0725 C   41                Z-ADD101       ERROR
0726 C   41                EXSR EDSPLY
 727 C*
 728 C* VALIDATE IPDU,1
 625 C*
 626 C*    IF PAST DUE FIELDS ARE ZERO, MOVE IN BLANKS
 627 C*
0628 C           PDUE1     COMP 0                        49
0630 C   49                MOVE '   '     PDUE,1
     C  N49                MOVE PDUE1     PDUE,1
0631 C           PDUE2     COMP 0                        49
0633 C   49                MOVE '   '     PDUE,2
     C  N49                MOVE PDUE2     PDUE,2
0634 C           PDUE3     COMP 0                        49
0636 C   49                MOVE '   '     PDUE,3
     C  N49                MOVE PDUE3     PDUE,3
0637 C           PDUE4     COMP 0                        49
0639 C   49                MOVE '   '     PDUE,4
     C  N49                MOVE PDUE4     PDUE,4
0640 C           PDUE5     COMP 0                        49
0642 C   49                MOVE '   '     PDUE,5
     C  N49                MOVE PDUE5     PDUE,5
0643 C           PDUE6     COMP 0                        49
0645 C   49                MOVE '   '     PDUE,6
     C  N49                MOVE PDUE6     PDUE,6
0646 C           PDUE7     COMP 0                        49
0648 C   49                MOVE '   '     PDUE,7
     C  N49                MOVE PDUE7     PDUE,7
0649 C           PDUE8     COMP 0                        49
0651 C   49                MOVE '   '     PDUE,8
     C  N49                MOVE PDUE8     PDUE,8
     C*
0729 C                     MOVELPDUE,1    NUM4    40
0730 C                     MOVELNUM4      ALF3    3
0731 C           PDUE,1    COMP ALF3                 4242
 732 C*
0733 C  N42      PDUE,1    COMP '001'                  42
0734 C  N42      PDUE,1    COMP '360'                42
0736 C   42                Z-ADD102       ERROR
0737 C   42                EXSR EDSPLY
 739 C*
 740 C* VALIDATE IPDU(2-8)
0741 C                     Z-ADD2         X       10
0742 C                     Z-ADD1         Y       10
 743 C*
0744 C           LOOP      TAG                             ** LOOP TAG **
 745 C*
 746 C* IF BLANK, CHECK SUBSEQUENT IPDUS ALSO BLANK
0747 C   43      PDUE,X    COMP '   '                424243
0748 C  N43N42   PDUE,X    COMP '   '                    43
0749 C   43                MOVE '000'     PDUE,X
0750 C   43                GOTO PDBLNK
 751 C*
0752 C  N42                MOVELPDUE,X    NUM4
0753 C  N42                MOVELNUM4      ALF3
0754 C  N42      PDUE,X    COMP ALF3                 4242
 755 C*
 756 C* IF NOT BLANK, MUST BE GREATER THAN PREVIOUS IPDU
0757 C  N42      PDUE,X    COMP PDUE,Y                 4242
 758 C*
 759 C* AND NO GREATER THAN 360
0760 C  N42      PDUE,X    COMP '360'                42
 761 C*
0762 C   42                Z-ADD103       ERROR
0763 C   42                EXSR EDSPLY
 765 C*
0766 C           PDBLNK    TAG                             ** PDBLNK TAG**
 768 C*
0769 C           X         COMP 8                        44
0770 C   44                GOTO QLARG
0771 C           X         ADD  1         X
0772 C           Y         ADD  1         Y
0773 C                     GOTO LOOP
 774 C*
 775 C*
0776 C           QLARG     TAG                             ** QLARG TAG **
 777 C*
 778 C*    VALIDATE LARG  - MUST BE GREATER THAN  0
 779 C*
 780 C*    EXECUTE Z-ALIGN TO VALIDATE NO DEC PLACES.
0781 C  N45                MOVE BLANKS    ZFIELD
0782 C  N45                MOVE LARG      ZFIELD 16
0783 C  N45                Z-ADD0         ZADEC   10
0784 C  N45                Z-ADD11        ZADIG   20
0785 C  N45                EXSR ZALIGN                     99 ON = ERROR
0786 C  N45N99             MOVE ZFIELD    OLARG  110
0787 C  N45N99   OLARG     COMP 0                      4545
0788 C  N45 99             SETON                     45
0789 C   45                Z-ADD104       ERROR
0790 C   45                EXSR EDSPLY
 791 C*
 792 C*    VALIDATE BRLF - MUST BE 'Y' OR 'N'
 793 C*
0794 C           BRLF      COMP 'Y'                      46
0795 C  N46      BRLF      COMP 'N'                  474746
     C  N46                Z-ADD105       ERROR
     C  N46                EXSR EDSPLY
 796 C*
     C**
     C** VALIDATE NEXT FIELD ONLY IF COMMERCIAL LOANS PRESENT
     C           CLTAG     TAG                             ** CLTAG TAG*
     C  N27                GOTO BRNCHS
2471 C**
2472 C**   COMMERCIAL LOANS REPORTING CURRENCY
     C** MUST BE A VALID DEALING CURRENCY
2473 C                     MOVELCLCY      CCYKEY
2466 C                     MOVEL'20      'TABKEY
2474 C                     MOVE CCYKEY    TABKEY
2475 C                     EXSR TABRED
2476 C                     Z-ADD95        ERROR
     C   09      DCCY      COMP 'Y'                      09
2477 C  N09                EXSR EDSPLY
2488 C**   ENSURE ALL BRANCHES HAVE BRANCH INTERNAL CUSTOMER NUMBER.
2489 C           BRNCHS    TAG                             ** BRNCHS TAG *
2490 C**
2491 C**   SET LOWER LIMITS FOR BRANCHES TABLE.
2492 C                     MOVEL'10      'TABKEY
2493 C                     MOVE '    '    TABKEY
2494 C           TABKEY    SETLLTABLE
2495 C**
2496 C**   LOOP TO READ AND CHECK BRANCH RECORDS.
2497 C           BRREAD    TAG                             ** BRREAD TAG *
2498 C**
2499 C                     SETOF                     2930
2500 C                     SETOF                     010419
2501 C                     READ TABLE                    30
2502 C**
2503 C**   READ AGAIN IF BRANCH CODES HEADER.
2504 C**
2505 C   01      RECT      COMP 10                       29
2506 C   01 29             GOTO BRREAD
2507 C**
2508 C**   END READ IF NEXT TABLE HEADER OR END OF FILE REACHED.
2509 C   01
2510 COR 09
     COR 30                GOTO ENDRED
2511 C**
2512 C**   READ NEXT RECORD IF DELETED FOUND.
2513 C   19                GOTO BRREAD
2514 C**
2515 C**   CHECK BRANCH RECORD FOR INTERNAL CUSTOMER NUMBER
2516 C**   AND READ NEXT RECORD IF VALID.
2517 C***08***** BICN      COMP 0                    30                                       CSD027
2517 C   08      BICN      COMP *BLANKS              30                                       CSD027
2518 C   08 30             GOTO BRREAD
2519 C**
2520 C**   OUTPUT ERROR MESSAGE FOR INVALID.
2521 C                     Z-ADD993       ERROR
2522 C                     EXSR EDSPLY
2523 C**
2524 C           ENDRED    TAG                             ** ENDRED TAG *
2525 C**
2527 C**   CHECK IF SYSTEM SETUP FLAG CAN BE SET ON.
2528 C**   IF NOT, ISSUE ERROR MESSAGE, SET SWITCH U3 AND END.
2529 C**   INDICATOR 80 SET IN EDSPLY SUBROUTINE.
2530 C   80                Z-ADD992       ERROR
     C   80                SETON                     U3
2531 C   80                EXSR EDSPLY
2532 C   80                GOTO SETEOJ
2533 C**
2535 C**   SET SYSTEM SET-UP FLAG ON.
2536 C                     SETON                     81
2537 C                     EXSR UDLOGD
     C*                                                                   S01168
     C** SET SYSTEM SET UP FLAG ON IN SDBANKL0                            S01168
     C*                                                                   S01168
     C                     MOVEL'BANK'    ICDFLG 10                       S01168
     C           ICDFLG    CHAINSDBANKL0             99                   S01168
     C           *IN99     IFEQ '0'                                       S01168
     C***********          MOVE 'Y'       BJAUST                    S01168S01251
     C                     MOVE 'Y'       BJSUC                           S01251
     C                     UPDAT@BJREEE                                   S01168
     C                     ELSE                                           S01168
     C                     SETON                     U8                   S01168
     C                     Z-ADD15        DBASE            ** DATABASE ERRS01168
     C                     MOVEL'SDBNK'   DBFILE                          S01168
     C                     MOVEL'SDBANKL0'DBKEY                           S01168
0645 C                     GOTO SETEOJ                                    S01168
     C                     END                                            S01168
     C** SET SYSTEM SET UP FLAG ON IN RUNDAT                              E18365
     C           *LOCK     IN   RUNDAT                                    E18365
     C***********          MOVE 'Y'       SSF                   E18365    S01251
     C                     MOVE 'Y'       SUC                   E18365    S01251
     C                     OUT  RUNDAT                                    E18365
2540 C**
2541 C**   CALCULATIONS TO SET LR AND AND END PROGRAM.
2542 C           SETEOJ    TAG                             ** SETEOJ TAG *
     C**
     C                     EXSR TIME
2543 C**
2544 C**   SET INDICATOR FOR ABNORMAL TERMINATION.
2545 C                     SETOF                     30
2546 C   80
2547 COR U3
2550 COR U8                SETON                     30
2552 C**
2563 C**   DISPLAY END OF PROGRAM MESSAGES.
2564 C**
     C           *INOF     IFEQ '1'
     C                     SETON                     31
     C                     EXCPTHEADER
     C                     SETOF                     31
     C                     END
     C                     EXCPTERRPRT
     C**
     C                     EXCPTEOJ
     C**
     C                     SETON                     LR
     C**
     C**   END COMMITMENT CYCLE UNLESS DATABASE OR SYSTEM ERROR.
     C   LRNU3NU8          COMIT
     C**
     C********************************************************************
     //EJECT
2586 C********************************************************************
2587 C**
2588 C**   EDSPLY SR. TO DISPLAY ERROR MESSAGES.
2589 C**
2590 C           EDSPLY    BEGSR                           *** EDSPLY ***
2591 C**
2592 C**   DETERMINE ERROR MESSAGE TO BE DISPLAYED.
2593 C           ERROR     COMP 999                      30
2594 C   30                Z-ADD8         S       10
2595 C           ERROR     COMP 998                      30
2596 C   30                Z-ADD7         S
2597 C           ERROR     COMP 997                      30
2598 C   30                Z-ADD6         S
2599 C           ERROR     COMP 996                      30
2600 C   30                Z-ADD5         S
2601 C           ERROR     COMP 995                      30
2602 C   30                Z-ADD4         S
2605 C           ERROR     COMP 993                      30
2606 C   30                Z-ADD3         S
2607 C           ERROR     COMP 992                      30
2608 C   30                Z-ADD2         S
     C**
     C****       ERROR     COMP 200                    3030               S01129
     C****       ERROR     COMP 242                    3030         S01129S01127
     C           ERROR     COMP 300                    3030               S01127
     C** IF NEW MODULE ERROR CODE FOR INVALID DATA IS GREATER
     C***THAN*200*THEN*THE*ABOVE*LINE*WILL*HAVE*TO*BE*AMENDED OTHERWISE   S01129
     C***THAN*242*THEN*THE*ABOVE*LINE*WILL*HAVE*TO*BE*AMENDED*OTHERWISE   S01127
     C** THAN 300 THEN THE ABOVE LINE WILL HAVE TO BE AMENDED OTHERWISE   S01127
     C** THE ERROR REPORT WILL NOT CONTAIN ALL APPLICABLE ERROR CODES.
     C           *IN30     IFEQ '1'
2612 C                     Z-ADD1         S
2613 C                     MOVELERROR     ERRWRK 25
2614 C                     MOVE ERRWRK    ERR,S
     C                     END
2615 C**
2616 C**   PRINT ERROR MESSAGE.
     C           *INOF     IFEQ '1'
     C                     SETON                     31
     C                     EXCPTHEADER
     C                     SETOF                     31OF
     C                     END
     C                     EXCPTERRPRT
2618 C**
2619 C**   SET COMMON ERROR INDICATOR.
2620 C                     SETON                     80
2621 C**
2622 C                     ENDSR
2623 C**
      *****************************************************************                       CGL029
      /EJECT                                                                                  CGL029
      *****************************************************************                       CGL029
      *                                                               *                       CGL029
      *  SRACOD - Check for Existence of Account Codes                *                       CGL029
      *                                                               *                       CGL029
      *****************************************************************                       CGL029
      *                                                                                       CGL029
     C           SRACOD    BEGSR                                                              CGL029
      *                                                                                       CGL029
     C                     MOVE *OFF      *IN10                                               CGL029
      *                                                                                       CGL029
     C                     CALL 'AOACODR0'                                                    CGL029
     C                     PARM *BLANK    PRTCD   7                                           CGL029
     C                     PARM '*KEY    'POPTN   7                                           CGL029
     C                     PARM           WACOD  10                                           CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
      *                                                                                       CGL029
     C           PRTCD     IFNE *BLANKS                                                       CGL029
     C                     MOVE 998       ERROR                                               CGL029
     C                     Z-ADD23        DBASE                                               CGL029
     C                     MOVEL'SDACODPD'DBFILE                                              CGL029
     C                     MOVELWACOD     DBKEY                                               CGL029
     C                     EXSR EDSPLY                                                        CGL029
     C                     GOTO SETEOJ                                                        CGL029
     C                     ELSE                                                               CGL029
      *                                                                                       CGL029
     C           A5TOIN    IFEQ 'N'                                                           CGL029
     C                     MOVE *ON       *IN10                                               CGL029
     C                     ENDIF                                                              CGL029
      *                                                                                       CGL029
     C                     ENDIF                                                              CGL029
      *                                                                                       CGL029
     C                     ENDSR                                                              CGL029
      *                                                                                       CGL029
      *****************************************************************                       CGL029
2624 C**
2625 C********************************************************************
2626 C**
2627 C**   TABRED SR. TO EXECUTE TABCHN & EXCPTN SUBROUTINES.
2628 C**
2629 C           TABRED    BEGSR                           *** TABRED ***
2630 C**
2631 C**   RANDOM ACCESS TABLE FILE.
2632 C                     EXSR TABCHN
2633 C**
2634 C**   RELEASE TABLE FILE.
2635 C  N76                SETON                     86
2636 C   86                EXSR EXCPTN
2637 C**
2638 C                     ENDSR
2640 C**
2641 C********************************************************************
2642 C**
2643 C**   TABCHN SR. TO RANDOM ACCESS TABLE FILE.
2644 C**
2645 C           TABCHN    BEGSR                           *** TABCHN ***
2646 C**
2647 C**   RESET INDICATORS.
2648 C                     SETOF                     010203
2649 C                     SETOF                     040506
2650 C                     SETOF                     070809
2651 C                     SETOF                     101176
     C*********            SETOF                     17                   S01127
     C                     SETOF                     1712                 S01127
2652 C**
2653 C**   RANDOM ACCESS TABLE FILE BY KEY.
2654 C           TABKEY    CHAINTABLE                76    ON NOT THERE
2655 C**
2656 C                     ENDSR
2657 C**
2659 C********************************************************************
2660 C**
2661 C**   EXCPTN SR. TO PERFORM EXCEPTION TIME OUTPUT
2662 C**              AND RESET EXCPTION CONTROL INDICATORS.
2663 C**
2664 C           EXCPTN    BEGSR                           *** EXCPTN ***
2665 C**
2666 C**   EXCEPTION OUTPUT.
2667 C                     EXCPT
2668 C**
2669 C**   RESET INDICATORS.
     C                     SETOF                     717273
2672 C                     SETOF                     868788
2673 C**
2674 C                     ENDSR
2675 C**
2677 C********************************************************************
2678 C**
     C**   UDLOGD SR. TO PERFORM UPDATE OF
2680 C**              INSTALLATION CONTROL DATA RECORDS.
2681 C**
2684 C           UDLOGD    BEGSR                           *** UDLOGD ***
2685 C**
     C**
2690 C**   ACCESS INSTALLATION CONTROL DATA RECORD READY FOR UPDATE.
2691 C                     MOVEL'01      'TABKEY
2692 C   81                MOVE '      10'TABKEY
2697 C                     EXSR TABCHN
     C**
     C**   OBTAIN LAST TRANSACTION NUMBER AND
     C**   SET UP STANDARD OUTPUT INFORMATION.
2728 C                     EXSR TIME
     C                     EXSR ZTNLU1
     C                     MOVE 'SD'      MDID
     C                     MOVEL'SD0265'  PGMN
     C                     MOVE WSID      WSIDX
     C                     MOVE 'A'       FCTNX
     C                     MOVE USRID     USRIDX
2738 C**
2739 C**   UPDATE/ADD TABLE FILE RECORD.
2742 C                     SETON                     71
2743 C                     EXSR TIME
2744 C                     EXSR EXCPTN
2745 C**
2746 C**   INCREMENT NUMBER AND TYPE OF UPDATES.
2747 C                     MOVE 0         SNINS
2748 C                     MOVE 0         SNAMD
2749 C  N03N04N05
2750 CANN06N07             Z-ADD1         SNINS   10
2751 C   03
2752 COR 04
2753 COR 05
2754 COR 06
2755 COR 07                Z-ADD1         SNAMD   10
2756 C**
2757 C**   GET TABLE HEADER RECORD READY FOR UPDATE.
2758 C                     MOVE '        'TABKEY
2759 C                     EXSR TABCHN
2760 C**
2761 C**   IF HEADER NOT FOUND, DATABASE ERROR.
     C**   DATABASE ERROR POINT 8.                        ** DB08 **
     C**
     C           *IN02     IFEQ '0'
     C                     SETON                     U8
     C                     Z-ADD8         DBASE
     C                     MOVELTABKEY    DBKEY
     C                     MOVEL'TABLE'   DBFILE
     C                     GOTO UDLERR
     C                     END
2764 C**
2765 C**   INCREMENT TABLE HEADER NUMBER AND TYPE OF UPDATES.
2766 C           NINS      ADD  SNINS     NINS
2767 C           NAMD      ADD  SNAMD     NAMD
2780 C**
2781 C**   UPDATE TABLE HEADER RECORD.
2783 C           UDTAB2    TAG                             ** UDTAB2 TAG *
2784 C                     SETON                     72
2785 C                     EXSR TIME
2786 C                     EXSR EXCPTN
2787 C**
2788 C**   GET TABLE FILE HEADER RECORD READY FOR UPDATE.
2789 C                     MOVEL'00      'TABKEY
2790 C                     EXSR TABCHN
2791 C**
2792 C**   IF HEADER NOT FOUND, DATABASE ERROR.
     C**   DATABASE ERROR POINT 10.                       ** DB10 **
     C**
     C           *IN01     IFEQ '0'
     C                     SETON                     U8
     C                     Z-ADD10        DBASE
     C                     MOVELTABKEY    DBKEY
     C                     MOVEL'TABLE'   DBFILE
     C                     GOTO UDLERR
     C                     END
2795 C**
2796 C**   UPDATE TABLE FILE HEADER.
2797 C                     SETON                     73
2798 C                     EXSR EXCPTN
     C**
     C**   ACCESS I.C.D.RECORD 1 TO OBTAIN SFLG VALUE.
     C                     MOVEL'01      'TABKEY
     C                     MOVE '      10'TABKEY
     C                     EXSR TABCHN
     C**
     C**   UPDATES FINISHED - END COMMITMENT CYCLE.
     C                     MOVE SFLG      SFLGX
     C           CMTTXT    COMIT
2825 C**
2828 C**   OUTPUT ERROR MESSAGE IF ERROR CONDITION DETECTED.
2829 C           UDLERR    TAG                             ** UDLERR TAG *
     C   U8                EXSR DSERR
2833 C**
2835 C**   RESET RECORD INDICATORS.
2836 C                     SETOF                     818283
2837 C                     SETOF                     8485
2838 C**
2839 C                     ENDSR
2841 C**
2869 C********************************************************************
2870 C**
2871 C**   DSERR SR. TO OUTPUT ERROR MESSAGES AND RELEASE FILES.
2872 C**             ONLY USED WHEN IN UDLOG SECTION OF PROGRAM.
2873 C**
2874 C           DSERR     BEGSR                           *** DSERR ***
2875 C**
2876 C**   SET ERROR MESSAGE SUBSCRIPT.
2879 C   U8                Z-ADD998       ERROR
2880 C**
2881 C**   ISSUE MESSAGE.
2882 C                     EXSR EDSPLY
2883 C**
2884 C**   SET INDICATORS TO, AND RELEASE FILES.
     C                     SETON                     8788
2886 C  N76                SETON                     86
2888 C                     EXSR EXCPTN
2889 C**
2890 C                     ENDSR
2892 C**
2893 C********************************************************************
2894 C**
2895 C**   TIME SR. TO OBTAIN TIME.
2896 C**
2897 C           TIME      BEGSR                           *** TIME ***
2898 C**
2899 C                     TIME           MTIME   60
2900 C**
2901 C                     ENDSR
2902 C**
2904 C********************************************************************
2960 C**
2961 C**   CLTCHN SR. TO RANDOM ACCESS CLIENT FILE.
2962 C**
2963 C           CLTCHN    BEGSR                           *** CLTCHN ***
2964 C**
2965 C**   RESET INDICATOR.
2966 C                     SETOF                     15
     C                     SETOF                     18
2967 C**
2968 C**   RANDOM ACCESS CLIENT FILE BY KEY.
2969 C           CLTKEY    CHAINCLINT                89
2970 C**
2971 C                     ENDSR
2972 C**
     C********************************************************************
     C**
2895 C**   SEVAL = VALIDATE SECURITIES TRADING RELEASE 2 FIELDS           S01129
2896 C**                                                                  S01129
2897 C           SEVAL     BEGSR                           *** SEVAL***   S01129
     C*                                                                   S01129
     C*                                                                   S01129
     C* PERIOD FOR MATURED SECURITIES - RTMS                              S01129
     C*                                                                   S01129
     C           RTMS      IFLE 12                                        S01129
     C           RTMS      ANDGE1                                         S01129
     C                     ELSE                                           S01129
     C                     MOVE '132'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C*                                                                   S01129
     C* PERIOD FOR SETTLED TRADES - RTST                                  S01129
     C*                                                                   S01129
     C           RTST      IFLE 12                                        S01129
     C           RTST      ANDGE1                                         S01129
     C                     ELSE                                           S01129
     C                     Z-ADD133       ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C*                                                                   S01129
     C* PERIOD FOR BACK VALUATION - BKVP                                  S01129
     C*                                                                   S01129
     C           BKVP      IFLE 366                                       S01129
     C           BKVP      ANDGE1                                         S01129
     C                     ELSE                                           S01129
     C                     MOVE '134'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C*                                                                   S01129
     C* PERIOD FOR DIARY ENTRIES - RTDE                                   S01129
     C*                                                                   S01129
     C           RTDE      IFLE 12                                        S01129
     C           RTDE      ANDGE1                                         S01129
     C                     ELSE                                           S01129
     C                     MOVE '135'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C* EUROCLEAR CURRENCY CODE - ECYC                                    S01129
     C*                                                                   S01129
     C           ECLD      IFEQ 'Y'                                       S01129
     C           ECYC      ANDEQ*BLANK                                    S01129
     C                     MOVE '136'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     ELSE                                           S01129
     C*                                                                   S01129
     C* CHAIN TO TABLE FILE IF NECESSARY                                  S01129
     C                     MOVEL'20      'KEY                             S01129
     C                     MOVE ECYC      KCCY                            S01129
     C                     MOVE '1'       KEY                             S01129
     C           KEY       CHAINTABSE                69                   S01129
     C           *IN69     IFNE '1'                                       S01129
     C           RECI      COMP 'D'                  6969                 S01129
     C                     END                                            S01129
     C           *IN69     IFEQ '1'                                       S01129
     C                     MOVE '106'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C* CURRENCY CODE FOR CEDEL - CCYC                                    S01129
     C*                                                                   S01129
     C           CCYC      IFEQ *BLANK                                    S01129
     C                     MOVE '107'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     ELSE                                           S01129
     C*                                                                   S01129
     C* CHAIN TO TABLE FILE IF NECESSARY                                  S01129
     C                     MOVEL'20      'TABKEY                          S01129
     C                     MOVE CCYC      KCCY                            S01129
     C                     MOVE '1'       KEY                             S01129
     C           KEY       CHAINTABSE                69                   S01129
     C           *IN69     IFNE '1'                                       S01129
     C           RECI      COMP 'D'                  6969                 S01129
     C                     END                                            S01129
     C           *IN69     IFEQ '1'                                       S01129
     C                     MOVE '107'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C* EUROCLEAR DEUTCHEMARK EQUIVALENT - ECDM                           S01129
     C*                                                                   S01129
     C           ECLD      IFEQ 'Y'                                       S01129
     C           ECDM      IFEQ *BLANK                                    S01129
     C                     MOVE '108'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     ELSE                                           S01129
     C                     MOVEAECDM      ACK                             S01129
     C                     EXSR ALPCHK                                    S01129
     C           *IN35     IFEQ '0'                                       S01129
     C                     MOVE '108'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C*                                                                   S01129
     C* EUROCLEAR BELGIAN FRANCS EQUIVALENT - ECBF                        S01129
     C*                                                                   S01129
     C           ECLD      IFEQ 'Y'                                       S01129
     C           ECBF      IFEQ *BLANK                                    S01129
     C                     MOVE '109'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     ELSE                                           S01129
     C                     MOVEAECBF      ACK                             S01129
     C                     EXSR ALPCHK                                    S01129
     C           *IN35     IFEQ '0'                                       S01129
     C                     MOVE '109'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C*                                                                   S01129
     C* EUROCLEAR JAPANESE YEN EQUIVALENT - ECJY                          S01129
     C*                                                                   S01129
     C           ECLD      IFEQ 'Y'                                       S01129
     C           ECJY      IFEQ *BLANK                                    S01129
     C                     MOVE '110'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     ELSE                                           S01129
     C                     MOVEAECJY      ACK                             S01129
     C                     EXSR ALPCHK                                    S01129
     C           *IN35     IFEQ '0'                                       S01129
     C                     MOVE '110'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C*                                                                   S01129
     C* EUROCLEAR INTERFACE - ECLD                                        S01129
     C*                                                                   S01129
     C           ECLD      IFNE ' '                                       S01129
     C           ECLD      ANDNE'Y'                                       S01129
     C           ECLD      ANDNE'N'                                       S01129
     C                     MOVE '111'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C*                                                                   S01129
     C* AUTO TRANSMISSION INTERFACE - ATRM                                S01129
     C*                                                                   S01129
     C           ECLD      IFNE 'Y'                                       S01129
     C           ATRM      IFNE ' '                                       S01129
     C                     MOVE '112'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C                     ELSE                                           S01129
     C           ATRM      IFNE '1'                                       S01129
     C           ATRM      ANDNE'2'                                       S01129
     C           ATRM      ANDNE'3'                                       S01129
     C                     MOVE '113'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C                     END                                            S01129
      ***********                                                   S01129RT0004
     C***********                                                   S01129RT0004
     C**AT*BOND*INTERFACE - ATBD                                    S01129RT0004
     C***********                                                   S01129RT0004
     C***********ATBD      IFEQ ' '                                 S01129RT0004
     C***********          MOVE '114'     ERROR                     S01129RT0004
     C***********          EXSR EDSPLY                              S01129RT0004
     C***********          ELSE                                     S01129RT0004
     C***********ATBD      IFNE 'Y'                                 S01129RT0004
     C***********ATBD      ANDNE'N'                                 S01129RT0004
     C***********          MOVE '114'     ERROR                     S01129RT0004
     C***********          EXSR EDSPLY                              S01129RT0004
     C***********          END                                      S01129RT0004
     C***********          END                                      S01129RT0004
     C*                                                                   S01129
     C* DL EVENTS INTERFACE - DLEV                                        S01129
     C*                                                                   S01129
     C           DLEV      IFEQ ' '                                       S01129
     C                     MOVE '115'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     ELSE                                           S01129
     C           DLEV      IFNE 'Y'                                       S01129
     C           DLEV      ANDNE'N'                                       S01129
     C                     MOVE '115'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
\    C* FI COLLATERAL INTERFACE - FICL                                    S01129
     C*                                                                   S01129
     C           FICL      IFEQ ' '                                       S01129
     C                     MOVE '116'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     ELSE                                           S01129
     C           FICL      IFNE 'Y'                                       S01129
     C           FICL      ANDNE'N'                                       S01129
     C                     MOVE '116'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C* DEFAULT BOOK - MARKET - DMKB                                      S01129
     C           DMKB      IFEQ *BLANK                                    S01129
     C                     MOVE '117'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     ELSE                                           S01129
     C           DMKB      CHAINBOOKD                69                   S01129
     C           *IN69     IFNE '1'                                       S01129
     C           RECI      COMP 'D'                  6969                 S01129
     C                     END                                            S01129
     C           *IN69     IFEQ '1'                                       S01129
     C                     MOVE '117'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C* DEFAULT BOOK - PORTFOLIO - DPFB                                   S01129
     C*                                                                   S01129
     C*                                                                   137224
     C**  Get module details using access object                          137224
     C*                                                                   137224
     C                     CALL 'AOMMODR0'                                137224
     C                     PARM '*MSG   ' @RTCD   7                       137224
     C                     PARM '*FIRST ' @OPTN   7                       137224
     C           SDMMOD    PARM SDMMOD    DSFDY                           137224
     C*                                                                   137224
     C**  If Portfolio Management is on, open PM files                    137224
     C*                                                                   137224
     C           BGPFMG    IFEQ 'Y'                                       137224
     C*                                                                   137224
     C           DPFB      IFEQ *BLANK                                    S01129
     C                     MOVE '118'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     ELSE                                           S01129
     C           DPFB      CHAINBOOKD                69                   S01129
     C           *IN69     IFNE '1'                                       S01129
     C           RECI      COMP 'D'                  6969                 S01129
     C                     END                                            S01129
     C           *IN69     IFEQ '1'                                       S01129
     C                     MOVE '118'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C                     END                                            137224
     C*                                                                   S01129
     C* DEFAULT TRADE SUBTYPE - MARKET - DMKS                             S01129
     C*                                                                   S01129
     C           DMKS      IFEQ *BLANK                                    S01129
     C                     MOVE '119'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     ELSE                                           S01129
     C                     MOVE *BLANKS   KEY                             S01129
     C                     MOVEL'42      'KEY                             S01129
     C                     MOVE DMKS      KEY                             S01129
     C           KEY       CHAINTABSE                69                   S01129
     C           *IN69     IFNE '1'                                       S01129
     C           RECI      COMP 'D'                  6969                 S01129
     C                     END                                            S01129
     C           *IN69     IFEQ '1'                                       S01129
     C                     MOVE '119'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C* DEFAULT TRADE SUBTYPE - PORTFOLIO - DPFS                          S01129
     C*                                                                   S01129
     C           DPFS      IFEQ *BLANK                                    S01129
     C                     MOVE '120'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     ELSE                                           S01129
     C                     MOVE *BLANKS   KEY                             S01129
     C                     MOVEL'42      'KEY                             S01129
     C                     MOVE DPFS      KEY                             S01129
     C           KEY       CHAINTABSE                69                   S01129
     C           *IN69     IFNE '1'                                       S01129
     C           RECI      COMP 'D'                  6969                 S01129
     C                     END                                            S01129
     C           *IN69     IFEQ '1'                                       S01129
     C                     MOVE '120'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C* DEFAULT TRADE SUBTYPE - BOOK TRANSFER - DTRS                      S01129
     C*                                                                   S01129
     C           DTRS      IFEQ *BLANK                                    S01129
     C                     MOVE '121'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     ELSE                                           S01129
     C                     MOVE *BLANKS   KEY                             S01129
     C                     MOVEL'42      'KEY                             S01129
     C                     MOVE DTRS      KEY                             S01129
     C           KEY       CHAINTABSE                69                   S01129
     C           *IN69     IFNE '1'                                       S01129
     C           RECI      COMP 'D'                  6969                 S01129
     C                     END                                            S01129
     C           *IN69     IFEQ '1'                                       S01129
     C                     MOVE '121'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C**DEFAULT*BRANCH*-*DSTB*                                     S01129 RT0004
     C***********                                                  S01129 RT0004
     C***********DSTB      IFEQ *ZERO                              S01129 RT0004
     C***********          MOVE '122'     ERROR                    S01129 RT0004
     C***********          EXSR EDSPLY                             S01129 RT0004
     C***********          ELSE                                    S01129 RT0004
     C***********          MOVE *BLANKS   KEY                      S01129 RT0004
     C***********          MOVEL'10      'KEY                      S01129 RT0004
     C***********          MOVE DSTB      KEY                      S01129 RT0004
     C***********KEY       CHAINTABSE                69            S01129 RT0004
     C************IN69     IFNE '1'                                S01129 RT0004
     C***********RECI      COMP 'D'                  6969          S01129 RT0004
     C***********          END                                     S01129 RT0004
     C************IN69     IFEQ '1'                                S01129 RT0004
     C***********          MOVE '122'     ERROR                    S01129 RT0004
     C***********          EXSR EDSPLY                             S01129 RT0004
     C***********          END                                     S01129 RT0004
     C***********          END                                     S01129 RT0004
     C*                                                                   S01129
     C* END OF WEEK - EOWK                                                S01129
     C*                                                                   S01129
     C****       EOWK      IFEQ *ZERO                              S01129 S01158
     C****                 MOVE '123'     ERROR                    S01129 S01158
     C****                 EXSR EDSPLY                             S01129 S01158
     C****                 ELSE                                    S01129 S01158
     C****       EOWK      IFLT RUND                               S01129 S01158
     C****                 MOVE '124'     ERROR                    S01129 S01158
     C****                 EXSR EDSPLY                             S01129 S01158
     C****                 END                                     S01129 S01158
     C****                 END                                     S01129 S01158
     C*                                                                   S01129
     C* REPROMPT DEFAULTS - RPMD                                          S01129
     C*                                                                   S01129
     C           RPMD      IFEQ ' '                                       S01129
     C                     MOVE '125'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     ELSE                                           S01129
     C           RPMD      IFNE 'Y'                                       S01129
     C           RPMD      ANDNE'N'                                       S01129
     C                     MOVE '125'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C* DEPOTS 1-10 - DC ARRAY                                            S01129
     C*                                                                   S01129
     C*                                                                   S01129
     C                     MOVE '0'       ZZCB    1                       S01129
     C                     Z-ADD1         Z       20                      S01129
     C                     Z-ADD1         Z1      20                      S01129
     C                     Z-ADD1         Z2      20                      S01129
     C                     Z-ADD56        Z3      20                      S01129
     C                     DO   10        Z                               S01129
     C                     ADD  1         Z3                              S01129
      * FIRST DEPOT MUST BE EUROCLEAR                                     S01129
     C           Z         IFEQ 1                                         S01129
     C           DC,Z      CHAINCLINTSEF             69                   S01129
     C           *IN69     IFEQ '0'                                       S01129
     C           RECI      ANDEQ'*'                                       S01129
     C                     SETON                     69                   S01129
     C                     END                                            S01129
     C           *IN69     IFEQ '0'                                       S01129
     C           C1DI      ANDNE'E'                                       S01129
     C                     SETON                     69                   S01129
     C                     END                                            S01129
     C           *IN69     IFEQ '1'                                       S01129
     C                     MOVE '128'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C                     ELSE                                           S01129
      * SECOND DEPOT MUST BE CEDEL                                        S01129
     C           Z         IFEQ 2                                         S01129
     C           DC,Z      CHAINCLINTSEF             69                   S01129
     C           *IN69     IFEQ '0'                                       S01129
     C           RECI      ANDEQ'*'                                       S01129
     C                     SETON                     69                   S01129
     C                     END                                            S01129
     C           *IN69     IFEQ '0'                                       S01129
     C           C1DI      ANDNE'C'                                       S01129
     C                     SETON                     69                   S01129
     C                     END                                            S01129
     C           *IN69     IFEQ '1'                                       S01129
     C                     MOVE '129'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C                     ELSE                                           S01129
      **THIRD*DEPOT*MUST*BE*KASSENVEREIN***************************       S01129              CSE022
     C********** Z         IFEQ 3                                         S01129              CSE022
     C********** DC,Z      CHAINCLINTSEF             69                   S01129              CSE022
     C********** *IN69     IFEQ '0'                                       S01129              CSE022
     C********** RECI      ANDEQ'*'                                       S01129              CSE022
     C**********           SETON                     69                   S01129              CSE022
     C**********           END                                            S01129              CSE022
     C********** *IN69     IFEQ '0'                                       S01129              CSE022
     C********** C1DI      ANDNE'K'                                       S01129              CSE022
     C**********           SETON                     69                   S01129              CSE022
     C**********           END                                            S01129              CSE022
     C********** *IN69     IFEQ '1'                                       S01129              CSE022
     C**********           MOVE '130'     ERROR                           S01129              CSE022
     C**********           EXSR EDSPLY                                    S01129              CSE022
     C**********           END                                            S01129              CSE022
     C**********           ELSE                                           S01129              CSE022
      **4TH*ONWARDS*-*IF*BLANK*SET*FLAG****************************       S01129              CSE022
      *                                                                                       CSE022
      ** 3RD ONWARDS - IF BLANK SET FLAG                                                      CSE022
      *                                                                                       CSE022
     C********** DC,Z      IFEQ *ZERO                                                  S01129 CSD027
     C           DC,Z      IFEQ *BLANKS                                                       CSD027
     C                     MOVE '1'       ZZCB                            S01129
     C                     ELSE                                           S01129
      *             - IF NOT BLANK & PREVIOUS WAS - ERROR                 S01129
     C           ZZCB      IFEQ '1'                                       S01129
     C                     MOVE '126'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
      *             - IF NOT BLANK CHECK A VALID CUSTOMER                 S01129
     C           DC,Z      CHAINCLINTSEF             69                   S01129
     C           *IN69     IFEQ '0'                                       S01129
     C           RECI      ANDEQ'*'                                       S01129
     C                     SETON                     69                   S01129
     C                     END                                            S01129
     C           *IN69     IFEQ '1'                                       S01129
     C                     MOVE '127'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     ELSE                                           S01129
      *             - IF VALID CHECK NOT DUPLICATE                        S01129
     C           Z         SUB  1         Z1      20                      S01129
     C                     DO   Z1        Z2                              S01129
     C           DC,Z2     IFEQ DC,Z                                      S01129
     C                     MOVE '131'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     GOTO V2001                                     S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C           V2001     TAG                                            S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C**********           END                                            S01129              CSE022
     C                     END                                            S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C* REALLOWANCE FOR BANK - RBAP                                       S01129
     C*                                                                   S01129
     C           RBAP      IFEQ ' '                                       S01129
     C                     MOVE '201'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     ELSE                                           S01129
     C           RBAP      IFNE 'Y'                                       S01129
     C           RBAP      ANDNE'N'                                       S01129
     C                     MOVE '201'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C* REALLOWANCE FOR CUSTOMER - RCAP                                   S01129
     C*                                                                   S01129
     C           RCAP      IFEQ ' '                                       S01129
     C                     MOVE '202'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     ELSE                                           S01129
     C           RCAP      IFNE 'Y'                                       S01129
     C           RCAP      ANDNE'N'                                       S01129
     C                     MOVE '202'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C* CHARGES/COMMISSION FOR BANK - CBAP                                S01129
     C*                                                                   S01129
     C           CBAP      IFEQ ' '                                       S01129
     C                     MOVE '203'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     ELSE                                           S01129
     C           CBAP      IFNE 'Y'                                       S01129
     C           CBAP      ANDNE'N'                                       S01129
     C                     MOVE '203'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C* CHARGES/COMMISSION FOR CUSTOMER - CCAP                            S01129
     C*                                                                   S01129
     C           CCAP      IFEQ ' '                                       S01129
     C                     MOVE '204'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     ELSE                                           S01129
     C           CCAP      IFNE 'Y'                                       S01129
     C           CCAP      ANDNE'N'                                       S01129
     C                     MOVE '204'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C*                                                                   S01129
     C* TRADE/VALUE DATE VALUATIONS - TVVL                                S01129
     C*                                                                   S01129
     C           TVVL      IFEQ ' '                                       S01129
     C                     MOVE '205'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     ELSE                                           S01129
     C           TVVL      IFNE 'T'                                       S01129
     C           TVVL      ANDNE'V'                                       S01129
     C                     MOVE '205'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C* TRADE/VALUE COLLATERAL - TVCL                                     S01129
     C*                                                                   S01129
     C           TVCL      IFEQ ' '                                       S01129
     C                     MOVE '206'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     ELSE                                           S01129
     C           TVCL      IFNE 'T'                                       S01129
     C           TVCL      ANDNE'V'                                       S01129
     C                     MOVE '206'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C* COLLATERAL CURRENCY CONVERSION - CCCV                             S01129
     C*                                                                   S01129
     C           CCCV      IFLE 100                                       S01129
     C           CCCV      ANDGE0                                         S01129
     C                     ELSE                                           S01129
     C                     MOVE '207'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C* MARKET/BOOK CONVERSION  - MBEX                                    S01129
     C*                                                                   S01129
     C           MBEX      IFEQ ' '                                       S01129
     C                     MOVE '208'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     ELSE                                           S01129
     C           MBEX      IFNE 'M'                                       S01129
     C           MBEX      ANDNE'B'                                       S01129
     C                     MOVE '208'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C* ALL HOLDINGS LIMIT FACTOR - AHLF                                  S01129
     C*                                                                   S01129
     C           AHLF      IFLE 100                                       S01129
     C           AHLF      ANDGE1                                         S01129
     C                     ELSE                                           S01129
     C                     MOVE '209'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C* DISCRETIONARY  LIMIT FACTOR - DSLF                                S01129
     C*                                                                   S01129
     C           DSLF      IFLE 100                                       S01129
     C           DSLF      ANDGE1                                         S01129
     C                     ELSE                                           S01129
     C                     MOVE '210'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C* CUSTOMER LIMIT FACTOR - CSLF                                      S01129
     C*                                                                   S01129
     C           CSLF      IFLE 100                                       S01129
     C           CSLF      ANDGE1                                         S01129
     C                     ELSE                                           S01129
     C                     MOVE '211'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C* REALISED PROFIT BASIS - RPBS                                      S01129
     C*                                                                   S01129
     C           RPBS      IFEQ ' '                                       S01129
     C                     MOVE '212'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     ELSE                                           S01129
     C           RPBS      IFNE 'T'                                       S01129
     C           RPBS      ANDNE'V'                                       S01129
     C           RPBS      ANDNE'B'                                       S01129
     C                     MOVE '212'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C* UNREALISED PROFIT BASIS - UPBS                                    S01129
     C*                                                                   S01129
     C           UPBS      IFNE ' '                                       S01129
     C           UPBS      ANDNE'T'                                       S01129
     C           UPBS      ANDNE'V'                                       S01129
     C           UPBS      ANDNE'B'                                       S01129
     C                     MOVE '213'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C* UNREALISED PROFIT POSTING - UPPS                                  S01129
     C*                                                                   S01129
     C           UPPS      IFEQ ' '                                       S01129
     C                     MOVE '214'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     ELSE                                           S01129
     C           UPPS      IFNE 'P'                                       S01129
     C           UPPS      ANDNE'L'                                       S01129
     C           UPPS      ANDNE'B'                                       S01129
     C                     MOVE '214'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C*                                                                   S01129
     C*                                                                   S01129
     C* ADJUST UNREALISED PROFIT - AUPR                                   S01129
     C*                                                                   S01129
     C           AUPR      IFEQ ' '                                       S01129
     C                     MOVE '215'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     ELSE                                           S01129
     C           AUPR      IFNE 'Y'                                       S01129
     C           AUPR      ANDNE'N'                                       S01129
     C                     MOVE '215'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C* SUMMARISE DAILY TRADES - SMDT                                     S01129
     C*                                                                   S01129
     C           SMDT      IFEQ ' '                                       S01129
     C                     MOVE '216'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     ELSE                                           S01129
     C           SMDT      IFNE 'Y'                                       S01129
     C           SMDT      ANDNE'N'                                       S01129
     C                     MOVE '216'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C* FIFO ACCOUNTING - FIFO                                            S01129
     C*                                                                   S01129
     C           FIFO      IFEQ ' '                                       S01129
     C                     MOVE '217'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     ELSE                                           S01129
     C           FIFO      IFNE 'Y'                                       S01129
     C           FIFO      ANDNE'N'                                       S01129
     C                     MOVE '217'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C* SPLIT PURCHASED INTEREST - SPIT                                   S01129
     C*                                                                   S01129
     C           SPIT      IFEQ ' '                                       S01129
     C                     MOVE '218'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     ELSE                                           S01129
     C           SPIT      IFNE 'Y'                                       S01129
     C           SPIT      ANDNE'N'                                       S01129
     C                     MOVE '218'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C*                                                                   S01129
     C*                                                                   S01129
     C* SPLIT NEGATIVE ACCRUAL - SNAC                                     S01129
     C*                                                                   S01129
     C           SNAC      IFEQ ' '                                       S01129
     C                     MOVE '219'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     ELSE                                           S01129
     C           SNAC      IFNE 'Y'                                       S01129
     C           SNAC      ANDNE'N'                                       S01129
     C                     MOVE '219'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C* TRADE SUB-TYPES ON ACCOUNT KEYS  - TSAK                           S01129
     C*                                                                   S01129
     C           TSAK      IFEQ ' '                                       S01129
     C                     MOVE '220'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     ELSE                                           S01129
     C           TSAK      IFNE 'Y'                                       S01129
     C           TSAK      ANDNE'N'                                       S01129
     C                     MOVE '220'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C* CROSS CURRENCY ENTRIES - CCYE                                     S01129
     C*                                                                   S01129
     C           CCYE      IFEQ ' '                                       S01129
     C                     MOVE '221'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     ELSE                                           S01129
     C           CCYE      IFNE 'T'                                       S01129
     C           CCYE      ANDNE'V'                                       S01129
     C           CCYE      ANDNE'B'                                       S01129
     C                     MOVE '221'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C* AUTOPOST POSITION SETTLEMENT - APNS                               S01129
     C*                                                                   S01129
     C           APNS      IFEQ ' '                                       S01129
     C                     MOVE '222'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     ELSE                                           S01129
     C           APNS      IFNE 'Y'                                       S01129
     C           APNS      ANDNE'N'                                       S01129
     C                     MOVE '222'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C* MARK TO MARKET FREQUENCY - MMKF                                   S01129
     C*                                                                   S01129
     C           MMKF      IFNE 'B'                                       S01129
     C           MMKF      ANDNE'D'                                       S01129
     C           MMKF      ANDNE'F'                                       S01129
     C           MMKF      ANDNE'L'                                       S01129
     C           MMKF      ANDNE'M'                                       S01129
     C           MMKF      ANDNE'Q'                                       S01129
     C           MMKF      ANDNE'R'                                       S01129
     C           MMKF      ANDNE'S'                                       S01129
     C           MMKF      ANDNE'T'                                       S01129
     C           MMKF      ANDNE'W'                                       S01129
     C           MMKF      ANDNE'X'                                       S01129
     C           MMKF      ANDNE'Y'                                       S01129
     C           MMKF      ANDNE' '                                       E20312
     C                     MOVE '223'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C* MARK TO MARKET BASE DATE - MMBD                                   S01129
     C*                                                                   S01129
     C           MMBD      IFEQ *ZERO                                     S01129
      * NO ENTRY HAS BEEN MADE                                            S01129
     C           MMKF      IFEQ 'L'                                       S01129
     C           MMKF      OREQ 'M'                                       S01129
     C           MMKF      OREQ 'Q'                                       S01129
     C           MMKF      OREQ 'R'                                       S01129
     C           MMKF      OREQ 'S'                                       S01129
     C           MMKF      OREQ 'T'                                       S01129
     C           MMKF      OREQ 'X'                                       S01129
     C           MMKF      OREQ 'Y'                                       S01129
     C                     MOVE '225'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C                     ELSE                                           S01129
      * ENTRY HAS BEEN MADE                                               S01129
     C           MMKF      IFEQ 'B'                                       S01129
     C           MMKF      OREQ 'D'                                       S01129
     C           MMKF      OREQ 'F'                                       S01129
     C           MMKF      OREQ 'W'                                       S01129
     C           MMKF      OREQ ' '                                       S01129
     C                     MOVE '224'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     ELSE                                           S01129
     C           MMBD      IFLE 31                                        S01129
     C**         MMBD      ANDLE1                                  S01129 E18365
     C           MMBD      ANDGE1                                         E18365
     C                     ELSE                                           S01129
     C                     MOVE '225'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C* MARK TO MARKET NEXT DATE - MMND                                   S01129
     C*                                                                   S01129
     C           MMND      IFNE *ZERO                                     S01129
      * ENTRY HAS BEEN MADE                                               S01129
     C           MMKF      IFEQ ' '                                       S01129
     C                     MOVE '226'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     ELSE                                           S01129
     C********** MMND      IFLE RUND                                S01129039660
     C           MMND      IFLT RUND                                      039660
     C                     MOVE '227'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C                     ELSE                                           S01129
      * NO ENTRY HAS BEEN MADE                                            S01129
     C           MMKF      IFNE ' '                                       S01129
     C                     MOVE '227'     ERROR                           S01129
     C                     EXSR EDSPLY                                    S01129
     C                     END                                            S01129
     C                     END                                            S01129
     C*                                                                   S01176
     C*    TRADE CONFIRMATION TYPE - TCFT                                 S01176
     C*                                                                   S01176
     C           TCFT      LOKUPALP                      30               S01176
     C           *IN30     IFEQ '0'                                       S01176
     C                     MOVE '243'     ERROR                           S01176
     C                     EXSR EDSPLY                                    S01176
     C                     END                                            S01176
2900 C**                                                                  S01129
2901 C                     ENDSR                                          S01129
2902 C**                                                                  S01129
     C**                                                                  S01129
     C********************************************************************S01129
     C**                                                                  S01129
     C** SUBROUTINE TO CHECK FOR ALPHABETIC ENTRY                         S01129
     C**                                                                  S01129
     C**                                                                  S01129
     C           ALPCHK    BEGSR                                          S01129
     C*                    Z-ADD0         A       10                      S01129
     C                     Z-ADD0         A                               S01129
     C                     DO   3                                         S01129
     C                     SETOF                     35                   S01129
     C           1         ADD  A         A                               S01129
     C           ACK,A     LOKUPALP                      35               S01129
     C   35                END                                            S01129
     C                     ENDSR                                          S01129
     C**                                                                  S01129
2972 C**                                                                  S01129
     C********************************************************************S01129
     C**                                                                  S01129
     C**   ZALIGN SR. TO VALIDATE AND RIGHT-ALIGN NUMERIC FIELDS.
     C**
     C           ZALIGN    BEGSR                           *** ZALIGN ***
     C**
     C                     SETOF                     929399
     C**
     C**   SAVE INPUT FIELD IN ARRAY, ZA1.
     C                     MOVEAZFIELD    ZA1
     C**
     C**   CALCULATION TO DEFINE NUMBER STRUCTURE CONTROL FIELDS.
     C                     Z-ADDZADIG     ZADIG   20
     C                     Z-ADDZADEC     ZADEC   10
     C**
     C**   CALCULATIONS TO DEFINE/CLEAR FIELDS.
     C                     MOVE ' '       ZA2
     C                     MOVEAZA2       ZFIELD 16
     C                     Z-ADD0         ZX      20
     C                     Z-ADD0         ZY      20
     C**
     C**   ENSURE REQUIRED STRUCTURE OF FIELD IS VALID.
     C           ZADIG     ADD  ZADEC     ZZ      20
     C           ZZ        COMP 15                   99
     C   99                GOTO ZAEND
     C**
     C**   LOOP TO FIND DECIMAL POINT, BLANKS AND CHARACTERS.
     C           ZATAG1    TAG                             ** ZATAG1 TAG *
     C           ZX        ADD  1         ZX
     C**
     C**   CHECK FOR DECIMAL POINT. ERROR IF SECOND DECIMAL POINT.
     C           ZA1,ZX    COMP '.'                      90
     C   90 93             SETON                     99
     C   99                GOTO ZAEND
     C**
     C**
     C**   CHECK FOR 'M' CONSTANT. ERROR IF NOT LAST CHARACTER ENTERED
     C           ZA1,ZX    COMP 'M'                      96
     C   96                DO
     C           ZX        COMP 15                   99  99
     C   99                GOTO ZAEND
     C           ZX        ADD  1         ZX
     C           ZA1,ZX    COMP ' '                  9999
     C   99                GOTO ZAEND
     C           ZX        SUB  1         ZX
     C           ZX        COMP 9                    99
     C   99                GOTO ZAEND
     C                     END
     C**
     C**   CHECK FOR 'T' CONSTANT. ERROR IF NOT LAST CHARACTER ENTERED
     C           ZA1,ZX    COMP 'T'                      97
     C   97                DO
     C           ZX        COMP 15                   99  99
     C   99                GOTO ZAEND
     C           ZX        ADD  1         ZX
     C           ZA1,ZX    COMP ' '                  9999
     C   99                GOTO ZAEND
     C           ZX        SUB  1         ZX
     C           ZX        COMP 12                   99
     C   99                GOTO ZAEND
     C                     END
     C**
     C**   CLEAR ALPHAMERIC CONSTANT FROM ZA1
     C   96
     COR 97                MOVE ' '       ZA1,ZX
     C**
     C**   CHECK FOR BLANKS. BYPASS FOR FIRST BLANK AFTER A DIGIT.
     C           ZA1,ZX    COMP ' '                      91
     C   91 92             GOTO ZATAG2
     C**
     C**   CHECK FOR NUMERIC, IF NOT '.' OR ' '.
     C  N90N91   ZA1,ZX    COMP '0'                    99
     C  N90N91N99ZA1,ZX    COMP '9'                  99
     C   99                GOTO ZAEND                      NOT NUMERIC
     C**
     C**   STORE DIGITS IN ARRAY AND HOW MANY.
     C**   ZY, TOTAL OF DIGITS IN THE INPUT FIELD.
     C**   ZZ, TOTAL OF DIGITS TO THE LEFT OF DECIMAL POINT.
     C  N90N91   ZY        ADD  1         ZY         92
     C  N90N91             MOVE ZA1,ZX    ZA2,ZY
     C   90                Z-ADDZY        ZZ         93  93
     C**
     C           ZX        COMP 16                     94  CHECK IF ALL
     C   94                GOTO ZATAG1
     C**
     C           ZATAG2    TAG                             ** ZATAG2 TAG *
     C**
     C**   IF 'M' SPECIFIED, MULTIPLY ZA1 BY 1 MILLION
     C   96      ZZ        ADD  6         ZZ
     C**
     C**   IF 'T' SPECIFIED, MULTIPLY ZA1 BY 1 THOUSAND
     C   97      ZZ        ADD  3         ZZ
     C**
     C**   FILL IN ZEROS IN ANY BLANKS LEFT OF DECIMAL POINT
     C   96 93
     COR 97 93   ZZ        DOWGTZY
     C           ZY        ADD  1         ZY
     C                     MOVE '0'       ZA2,ZY
     C                     END
     C**
     C**   IF CONSTANT SPECIFIED WITH NO DECIMAL POINT ZEROISE BLANKS
     C   96N93             DO   6
     C           ZY        ADD  1         ZY
     C                     MOVE '0'       ZA2,ZY
     C                     END
     C**
     C   97N93             DO   3
     C           ZY        ADD  1         ZY
     C                     MOVE '0'       ZA2,ZY
     C                     END
     C**
     C**   IF NO DECIMAL POINT FOUND, SET TOTAL FIELD ZZ.
     C  N93                Z-ADDZY        ZZ
     C**
     C**   CHECK FOR EMBEDDED BLANKS.
     C   91 92             MOVEAZA1,ZX    ZFIELD
     C   91 92   ZFIELD    COMP ' '                  9999
     C   99                GOTO ZAEND                      EMBEDDED BLANK
     C**
     C**   ENSURE THAT NUMBER OF DIGITS ENTERED EITHER SIDE
     C**   OF DECIMAL POINT ARE NOT MORE THAN ALLOWED.
     C           ZZ        COMP ZADIG                99
     C           ZY        SUB  ZZ        ZX
     C  N99      ZADEC     SUB  ZX        ZX           9995
     C   99                GOTO ZAEND
     C   95                GOTO ZATAG4                     NO TRAILING
     C**                                                   BLANKS.
     C**   FILL THE TRAILING BLANKS WITH ZEROS.
     C           ZY        ADD  ZX        ZZ
     C           ZATAG3    TAG                             ** ZATAG3 TAG *
     C           ZY        ADD  1         ZY
     C                     MOVE '0'       ZA2,ZY
     C           ZY        COMP ZZ                     94
     C   94                GOTO ZATAG3
     C**
     C**   RIGHT-ALIGN THE VALUE BY MOVING BACK TO ARRAY, ZA1.
     C           ZATAG4    TAG                             ** ZATAG4 TAG *
     C                     MOVE '0'       ZA1
     C                     Z-ADD16        ZX
     C           ZATAG5    TAG                             ** ZATAG5 TAG *
     C           ZY        COMP 0                        94
     C   94                GOTO ZATAG6
     C                     MOVE ZA2,ZY    ZA1,ZX
     C           ZY        SUB  1         ZY
     C           ZX        SUB  1         ZX
     C                     GOTO ZATAG5
     C           ZATAG6    TAG                             ** ZATAG6 TAG *
     C**
     C**   MOVE VALIDATED AND RIGHT-ALIGNED NUMBER BACK INTO ZFIELD.
     C                     MOVEAZA1       ZFIELD
     C**
     C                     SETOF                     9697
     C**
     C           ZAEND     ENDSR                           * ZAEND ENDSR *
     C**
     C**
     C********************************************************************
     C*
     C*   ZTNLU1 SR. - TO LOCK THE TRANSACTION NUMBER DATA AREA AND
     C*                THEN UPDATE AND RELEASE THE DATA AREA.
     C*
     C           ZTNLU1    BEGSR
     C           *NAMVAR   DEFN MNATN     DNATN
     C           *LOCK     IN   DNATN
     C                     MOVE FNATN     NATN    50
     C                     MOVE FNATN     ZZWK05  50
     C                     ADD  1         ZZWK05
     C                     MOVE ZZWK05    FNATN
     C                     OUT  DNATN
     C                     ENDSR
     C*****************************************************************
     //EJECT
3694 O**
3695 O**   TABLE FILE OUTPUT.
3696 O**
3697 O**   UPDATE FILE HEADER RECORD.
3698 OTABLE   E        73
3699 O                         LOT       96
3700 O                                   14 '1'
3701 O**
3702 O**   UPDATE TABLE HEADER RECORD.
3703 O        E        72
3704 O                         LOT       96
3705 O                         NINS      21
3706 O                         NDEL      25
3707 O                         NAMD      29
3708 O**
3709 O**   UPDATE TABLE DETAIL RECORDS.
3730 O**   AMENDMENT OR INSERT OVER DELETED RECORD.
3731 O        E        71 81N76
3732 O                 03      LOT       96
3733 O                                    1 'D'
3744 O                                   87 '1'
3745 O                         RUND      92P
3747 O                                   93 'A'
3749 O                         NATN      96P
     O**
     O*PRINT  E  202   31      HEADER                                     S01124
     O*D0265P1E  202   31      HEADER                              S01124 RT0004
     OSD0265AUE  202   31      HEADER                                     RT0004
     O**********                         22 'REFERENCE SD0265'            E27222
     O                                   22 'REFERENCE SD0265AU'          E27222
     O                         TITL      89
     O                                   96 'DATE'
     O                         RUNA     104
     O                                  111 'TIME'
     O                         MTIME    120 '  .  .  '
     O                                  126 'PAGE'
     O                         PAGE  3  132
     O        E  1     31      HEADER
     O                                   66 'ERROR MESSAGES REPORT'
     O        E  2     31      HEADER
     O                                   66 '---------------------'
     O        E  2     30      ERRPRT
     O                                   25 'ERROR VALUE IS ...'
     O                         ERROR     30
     O                         ERR,S     90
     O        E  2     U8      EOJ
     O                                   25 'DATABASE ERROR AT '
     O                         DBASE     30
     O                                   48 'FILE NAME'
     O                         DBFILE    54
     O                                   60 'KEY'
     O                         DBKEY     90
     O        E  2             EOJ
     O                 80      ERR,09    90
     O                N80      ERR,10    90
     O        E  1             EOJ
     O                                   65 '***END OF REPORT***'
     O**
     O** ERROR CODE ARRAY 04 CHANGED FROM 'BRANCH ACCRUAL' TO 'ACCRUAL    RT0004
     O** PROFIT'                                                          RT0004
**  CPY@
(c) Misys International Banking Systems Ltd. 2001
**   ERR - ERROR CODE DISPLAYS
INVALID DATA, ERROR CODE 000                      01
SYSTEM SET UP FLAG NOT SET ON                     02
BRANCH(ES) MISSING INTERNAL CUSTOMER NUMBER       03
INVALID ACCRUAL/PROFIT INDICATOR                  04
JOB*TERMINATED*-*LOG*FILE*FULL********************05*******************
JOB TERMINATED - SYSTEM ERROR                     06
JOB TERMINATED - DATABASE IN ERROR                07
SYSTEM ERROR, INVALID DATA.                       08
ABNORMAL END OF JOB                               09
NORMAL END OF JOB, SYSTEM SET-UP FLAG ON.         10
**   ALP - LETTERS IN ALPHABET                                            S01129
ABCDEFGHIJKLMNOPQRSTUVWXYZ                                                S01129
