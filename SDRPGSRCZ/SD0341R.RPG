     H        1   Y
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas SD Securities clients maintenance')              *
      *****************************************************************
      *                                                               *
      *  Midas - Standing Data Module                                 *
      *                                                               *
      *  SD0341R - Securities Clients Maintenance                     *
      *                                                               *
      *  Function:  This program maintains the securites clients      *
      *             records                                           *
      *                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. MD061008           Date 31Dec21               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 AR906833           Date 18Dec12               *
      *                 CER059             Date 19Jul10               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 CRE026             Date 24May06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD027             Date 09Dec05               *
      *                 CER001             Date 25Apr05               *
      *                 CSW037A            Date 02May05               *
      *                 BUG6198            Date 04Apr05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 BUG3122            Date 17Jul04               *
      *                 CSC022             Date 24Feb04               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4.01.02 ----------------------------------------*
      *                 207057             Date 02Aug02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 204139             Date 15Apr02               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 CSE022             Date 29Mar01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 161659             Date 31Jan01               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 CAP039             Date 16Aug00               *
      * Midas DBA 3.02 ---------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CSD005             Date 01MAR99               *
      *                 CTI002             Date 23Sep98               *
      *                 137034             Date 11Oct98               *
      *                 CSD003             Date 27Oct97               *
      *                 122096             Date 22Aug97               *
      *                 S01496             DATE 11AUG94               *
      *                 S01464             DATE 11APR94               *
      *                 062786             DATE 04MAR94               *
      *                 S01446             DATE 02MAR94               *
      *                 066562             DATE 09FEB94               *
      *                 045112             DATE 18NOV93               *
      *                 S01459             DATE 18NOV93               *
      *                 S01433             DATE 22OCT93               *
      *                 E28480             DATE 12SEP91               *
      *                 E28322             DATE 09SEP91               *
      *                 E25679             DATE 06SEP91               *
      *                 LN1104             DATE 24JAN91               *
      *                 LN0947             DATE 24JAN91               *
      *                 LN0662             DATE 24JAN91               *
      *                 E16464             DATE 22NOV90               *
      *                 LN0973             DATE 13NOV90               *
      *                 S01117             DATE 12NOV90               *
      *                 S01212             DATE 12NOV90               *
      *                 S01269             DATE 05NOV90               *
      *                 S01219             DATE SEP89                 *
      *                 S01190             DATE 23AUG89               *
      *                 E17779             DATE                       *
      *                 E18371             DATE                       *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  MD061008 - Deliverable Data Split for SDFCTLPA and GPFCTLPA  *
      *  MD046248 - Finastra Rebranding                               *
      *  AR906833 - Allows deletion of Sec. Trading Customers that    *
      *             are still needed by the system.                   *
      *             Used SD0340U program in validation of security    *
      *             customer. Applied AR663084. (Child: AR906834)     *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (Recompile)                                         *
      *  CRE026 - Consumer Banking (Recompile)                        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CER001 - LUX Upgrade to MidasPlus                            *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  BUG6198- Cannot save new Details for CUSD (Recompile)        *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  BUG3122 - Recompiled due to changes in SDSECSPD.             *
      *  CSC022 - Commitment Control Changes for MidasPlus            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  207057 - Display correct footer when program called from     *
      *           Customer Details option.                            *
      *  204139 - Timestamp field is not being initialised causing    *
      *           data mapping error on write.                        *
      *  CSE022 - Depository Definition Enhancement                   *
      *  161659 - New Ranges are now accepted for EUROCLEAR           *
      *           References to remove ranges validation.             *
      *  CAP039 - Recompiled : File SDSECSPD changed                  *
      *  CSD005 - Standing Data Account Narrative.  Add new field     *
      *           to SDACODPD.  Recompilation of programs.            *
      *  CTI002 - Recompiled : File SDACODPD changed                  *
      *  137034 - Depot input fields are still shown even if there's  *
      *           no Depot in it. Fix is to condition the said fields.*
      *  CSD003 - Synon Closedown Project (SD):                       *
      *           - Program removed from SD model.                    *
      *  122096 - Addition of call to SD0520X to save deleted         *
      *           records for audit during COB.                       *
      *  S01496 - Jyske Enhancements:                                 *
      *           - Addition of 'Trade Charges Group' and             *
      *             'Positino Settlement Charge Group'.               *
      *  S01464 - Safe Custody Fees:                                  *
      *           - Addition of 'Safe Custody Fees' flag.             *
      *           - Addition of 'Custody Fees Group Code' field.      *
      *  062786 - When account code was blank, the program updated    *
      *           the file with the incorrect account sequence.       *
      *  S01446 - Recompiled over changes to SECGTDL2.                *
      *  066562 - Field BVAPS renamed to BVAPST on SDSTRDPD.          *
      *           Regenerate and recompile program.                   *
      *  045112 - Remove modulus check for CEDEL as it is no longer   *
      *           required by CEDEL.                                  *
      *  S01459 - Addition of headerbox and PSSR processing.          *
      *  S01433 - REGENERATE/RECOMPILE OVER CHANGED SDCURRPD.         *
      *  E28480 - DISPLAY NUMERIC DATE IN FORM DDMMYY FOR 'NEXT       *
      *           STATEMENT DATE'                                     *
      *  E28322 - PASS PARAMETER FOR EUROCLEAR FROM 'RETRIEVE DEPOTS' *
      *           AND THEN RETRIEVE ITS SHORTNAME                     *
      *  E25679 - STATEMENT FREQUENCY, NEXT STATEMENT DATE AND        *
      *           STATEMENT BASE DATE CAN BE ENTERED FOR CUSTOMER     *
      *           CLASSIFICATION S, D, M OR I ONLY.                   *
      *           STATEMENT FREQUENCY SHOULD NOT DEFAULT.             *
      *           STATEMENT BASE DATE DEFAULTS TO 31 IF STATEMENT     *
      *           FREQUENCY IS L, M, Q, R, S, T, X, OR Y.             *
      *  LN1104 - RECOMPILE DUE TO CHANGE IN SDCUSTPD                 *
      *  LN0947 - REGENERATE DUE TO CHANGE IN SDACODPD                *
      *  LN0662 - REGENERATE DUE TO CHANGE IN SDCURRPD                *
      *  E16464 - PREVENT DELETION IF CUSTOMER HAS A POSITION (LN1017)*
      *  LN0973 - MODULUS CHAECKING FOR CEDEL IS INCORRECT            *
      *  S01117 - R10 UPGRADE (DELIVERED AS LN0968)                   *
      *  S01212 - /COPY AND WINDOW (DELIVERED AS LN0968)              *
      *  S01269 - PROGRAM RECOMPILED DUE TO CHANGE IN SDSTRDPD        *
      *  S01219 - SE Customer Details Enhancements                    *
      *  S01190 - EUCLID enhancements                                 *
      *  E17779 -                                                     *
      *  E18371 -                                                     *
      *                                                               *
      *****************************************************************
     F***CDEPC** IF  E           K        DISK                                       E16464 AR906833
     F/COPY WNCPYSRC,SD0341RFPG
      * Invalid Customers Details extra data file                                             CER001
     FSDICEXL1IF  E           K        DISK         KINFSR *PSSR      UC                      CER001
      *                                                                                       CER001
     FSD0341R#CF  E                    WORKSTN                        UC
     F                                              KINFDS INFDS#
     F                                              KINFSR *PSSR
      * DSP: Midas SD Securities clients maintenance
      *
     FSDSECSL1IF  E           K        DISK                           UC
     F                                              KINFDS INFDS1
     F                                              KINFSR *PSSR
      * RTV : Midas SD Securities clients retrieval
      *
     FSDCUSTL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0001
     F                                              KINFSR *PSSR
      * RTV : Midas SD Customer details retrieval
      *
     FSDSTRDL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0002
     F                                              KINFSR *PSSR
      * RTV : Midas SD Securities trading ICD retrieval
      *
     FSDACODL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0003
     F                                              KINFSR *PSSR
      * RTV : Midas SD Account codes retrieval
      *
     FSDCURRL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0004
     F                                              KINFSR *PSSR
      * RTV : Midas SD Currency codes retrieval
      *
     FSDALTNL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0005
     F                                              KINFSR *PSSR
      * RTV : Midas SD Alternate names and address retrieval
      *
     FSDBANKL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0006
     F                                              KINFSR *PSSR
      * RTV : Midas SD Bank details ICD retrieval
      *
     FSECGTDL2IF  E           K        DISK                           UC
     F                                              KINFDS ID0007
     F                                              KINFSR *PSSR
      * RSQ : Midas SD Charge types detail get charge code
      *
     FSDMMODL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0008
     F                                              KINFSR *PSSR
      * RTV : Midas SD Midas module flags retrieval
      *
     FSDSECSL0UF  E           K        DISK                      A    UC
     F                                              KCOMIT
     F                                              KINFDS ID0009
     F                                              KINFSR *PSSR
      * UPD : Midas SD Securities clients update
      *
     F*SDFCTLL0UF  E           K        DISK                           UC                   MD061008
     F**********                                    KCOMIT                                  MD061008
     F**********                                    KINFDS ID0010                           MD061008
     F**********                                    KINFSR *PSSR                            MD061008
      * UPD : Midas SD Standing data controls update
      *
     F*****************************************************************   137034
      /EJECT                                                              137034
     F*****************************************************************   137034
     F*                                                               *   137034
     F*  F U N C T I O N   O F   I N D I C A T O R S                  *   137034
     F*                                                               *   137034
     F*   80      No Depot number 8                                   *   137034
     F*   81      No Depot number 9                                   *   137034
     F*   82      No Depot number 10                                  *   137034
     F*                                                               *   137034
     F*****************************************************************   137034
     E                    ZMNM   12  12  3
     E* Description     : Copyright notice for inclusion in all programs
     E*
     E********************************************************************
     E                    CPY@    1   1 80               Copyright array
      *                                                                                       CSC022
      ** Commitment Control Array                                                             CSC022
     E                    WCMTAR     10 10                                                    CSC022
      *                                                                                       CSC022
     E/COPY WNCPYSRC,SD0341REPG
     I*                                                                   S01219
     I*                                                                   S01219
     I*
     I* Description     : Copyright notice for inclusion in all programs
     I*
     I*
     I/COPY QWINDSRC,SD0340GDTA
     I*00/Copy Member SD0341R   Initialise Program
     I/COPY WNCPYSRC,SD0341RIPG
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     I@1DBRC    E DSSDSECSL0
      * UPD : Midas SD Securities clients update
      * Current/previous master file format fields for change control
      *
     I*#1DBRC*****DS***                         165                                           CAP039
     I***#1DBRC*     DS                            232                                 CAP039 CGL029
     I#1DBRC      DS                            442                                           CGL029
      * Stored master file format fields
     I                                        1   1 #1DB1
      *
     IRDATE       DS
     I                                        1   2 DAY
     I                                        3   5 MONTH
     I                                        6   70YEAR
     I                                        6   7 YEARC
     I            DS                                                      S01219
     I                                        1   6 DEP1A                 S01219
     I                                        1   60DEP1N                 S01219
     I*                                                                   S01219
     I            DS                                                      S01219
     I                                        1   6 DEP2A                 S01219
     I                                        1   60DEP2N                 S01219
     I*                                                                   S01219
      * Outward parameters
     IPARC        DS                              6
      * KEY : Midas SD Futures and Options client retrieval
      * I : MAP Customer Number
     I                                        1   6 PACUST
      *
     I*QSDFC1***E DSSDFCTLL0                                                                MD061008
     IQSDFC1      DS                                                                        MD061008
     I                                        1  10 AHFLNM                                  MD061008
     I                                    P  11  130AHNORC                                  MD061008
     I                                    P  14  160AHNOIN                                  MD061008
     I                                    P  17  190AHNOAM                                  MD061008
     I                                    P  20  220AHNODL                                  MD061008
      *                                                                                     MD061008
      * UPD : Midas SD Standing data controls update
     IYARDCS      DS                             22
     IWUDELR      DS
     I                                        1 250 WUDR01
     I                                      251 500 WUDR02
     I                                      501 750 WUDR03
     I                                      7511000 WUDR04
     I                                     10011250 WUDR05
     I                                     12511500 WUDR06
     I                                     15011750 WUDR07
     I                                     17512000 WUDR08
     I                                     20012250 WUDR09
     I                                     22512500 WUDR00
     I                                     25012750 WUDR11
     I                                     27513000 WUDR12
      *                                                                                     AR906833
     I@UCDS2      DS                            200                                         AR906833
     I                                        1 200 @UD200                                  AR906833
     I                                       13  13 @UD213                                  AR906833
     I                                       14  14 @UD214                                  AR906833
     I                                       15  15 @UD215                                  AR906833
     I                                       16  16 @UD216                                  AR906833
     I                                       17  17 @UD217                                  AR906833
     I                                       19  19 @UD219                                  AR906833
     I                                       20  20 @UD220                                  AR906833
     I                                       21  21 @UD221                                  AR906833
     I                                       22  22 @UD222                                  AR906833
     I                                       23  23 @UD223                                  AR906833
     I                                       24  24 @UD224                                  AR906833
     I                                       25  25 @UD225                                  AR906833
     I                                       26  26 @UD226                                  AR906833
     I                                       27  27 @UD227                                  AR906833
     I                                       28  28 @UD228                                  AR906833
     I                                       29  29 @UD229                                  AR906833
      *                                                                                     AR906833
     I@UCDS3      DS                            200                                         AR906833
     I                                        1 200 @UD400                                  AR906833
     I                                        1   1 @UD401                                  AR906833
     I                                        2   2 @UD402                                  AR906833
     I                                        3   3 @UD403                                  AR906833
     I                                        4   4 @UD404                                  AR906833
     I                                        5   5 @UD405                                  AR906833
     I                                        6   6 @UD406                                  AR906833
     I                                        7   7 @UD407                                  AR906833
     I                                        8   8 @UD408                                  AR906833
     I                                        9   9 @UD409                                  AR906833
     I                                       10  10 @UD410                                  AR906833
      * Outward parameters
     IPBRC        DS                           3064
      * RCD : Midas SD Deleted records file retrieval
      * I :  File name
     I                                        1  10 PBFNME
      * I :  Long Key
     I                                       11  60 PBLKEY
      * I :  Deleted Data Record Pt1
     I                                       61 310 PBDR01
      * I :  Deleted Data Record Pt2
     I                                      311 560 PBDR02
      * I :  Deleted Data Record Pt3
     I                                      561 810 PBDR03
      * I :  Deleted Data Record Pt4
     I                                      8111060 PBDR04
      * I :  Deleted Data Record Pt5
     I                                     10611310 PBDR05
      * I :  Deleted Data Record Pt6
     I                                     13111560 PBDR06
      * I :  Deleted Data Record Pt7
     I                                     15611810 PBDR07
      * I :  Deleted Data Record Pt8
     I                                     18112060 PBDR08
      * I :  Deleted Data Record Pt9
     I                                     20612310 PBDR09
      * I :  Deleted Data Record Pt10
     I                                     23112560 PBDR00
      * I :  Deleted Data Record Pt11
     I                                     25612810 PBDR11
      * I :  Deleted Data Record Pt12
     I                                     28113060 PBDR12
      * I :  Last Change Date
     I                                    P306130630PBLCD
      * I :  Type of Last Change
     I                                     30643064 PBTYLC
      *
     IYBRDCS      DS                             22
     I*YCRDCS*****DS***                         165                                           CAP039
     IYCRDCS      DS                            232                                           CAP039
     IYDRDCS      DS                             22
     IRUNDAT      DS
     I                                        1   7 MRDT
     I                                    P   8  100RDNB
     I                                       11  11 SUC
     I                                       12  12 DFF
     I                                       13  13 MBIN
     IA@CPY       DS
     I* Copyright array
     I                                        1  80 CPY@
     IUUSDY     E DSDSSDY
     I*
     I* 800 byte DS for incoming data from Access Program
     I*
     ID@CUGR    E DSSECUGRPD
     I*
     I* DS TO HOLD DATA READ FROM FILE TO BE USED WITHIN THE PROGRAM
     I*
     IID0001      DS                            528
      * File information data structure
      *
     IID0002      DS                            528
      * File information data structure
      *
     IID0003      DS                            528
      * File information data structure
      *
     IID0004      DS                            528
      * File information data structure
      *
     IID0005      DS                            528
      * File information data structure
      *
     IID0006      DS                            528
      * File information data structure
      *
     IID0007      DS                            528
      * File information data structure
      *
     IID0008      DS                            528
      * File information data structure
      *
     IID0009      DS                            528
      * File information data structure
      *
     IID0010      DS                            528
      * File information data structure
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS                              6
      * KEY: Midas SD Securities clients retrieval
      * I : MAP Customer Number
     I                                        1   6 P1CUST
     IP2PARM      DS
      * I :  call futures & options
     I                                        1   1 P2CFAO
     IP3PARM      DS
      * I :  Action Code
     I                                        1   1 P3ANCD
     IP4PARM      DS
      * I :  mode
     I                                        1   1 P4MODE
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Database Error (ICD)'
      * Filename
     I                                        1  10 ZA0001
      * Message data for 'Database Error (ICD)'
      * Filename
     I                                        1  10 ZA0002
      * Message data for 'Classification Invalid'
      * Classification
     I                                        1   1 ZA0003
      * Message data for 'Statement Freq Invalid'
      * Statement frequency
     I                                        1   1 ZA0004
      * Message data for 'Cedel Fung Ind Invalid'
      * Cedel Fungibility ind.
     I                                        1   1 ZA0005
      * Message data for 'Pledge Agreement Invalid'
      * Pledge Agreement
     I                                        1   1 ZA0006
      * Message data for 'Auto-Settle Ind Invalid'
      * Auto-Settle Indicator
     I                                        1   1 ZA0007
      * Message data for 'Safe Cust Fees Flag Inval'
      * Subject to Custody Fees
     I                                        1   1 ZA0008
      * Message data for 'Sub to Cus Fee Not N/Blnk'
      * Subject to Custody Fees
     I                                        1   1 ZA0009
      * Message data for 'Trade charges grp not req'
      * Trade Charges Group
     I                                        1   2 ZA0010
      * Message data for 'Trade Charges Grp NF'
      * Trade Charges Group
     I                                        1   2 ZA0011
      * Message data for 'Trade Charges Grp is reqd'
      * Trade Charges Group
     I                                        1   2 ZA0012
      * Message data for 'Custody Fees Group Invald'
      * Custody Fees Group Code
     I                                        1   2 ZA0013
      * Message data for 'Cust Fees Gp Cde non-blnk'
      * Custody Fees Group Code
     I                                        1   2 ZA0014
      * Message data for 'Posn Settle not required'
      * Position Settl. Charge GR
     I                                        1   2 ZA0015
      * Message data for 'Posn Settlement grp NF'
      * Position Settl. Charge GR
     I                                        1   2 ZA0016
      * Message data for 'Posn Settle is required'
      * Position Settl. Charge GR
     I                                        1   2 ZA0017
      * Message data for 'Invalid Classification...'
      * Classification
     I                                        1   1 ZA0018
      * Message data for 'Stat. Freq. must be blank'
      * Statement frequency
     I                                        1   1 ZA0019
      * Classification
     I                                        2   2 ZA0020
      * Message data for 'Next Stat. must be blank'
      * ST next statement date
     I                                        1   6 ZA0021
      * Classification
     I                                        7   7 ZA0022
      * Message data for 'Stat. B.D. must be blank'
      * Classification
     I                                        1   1 ZA0023
      * Stat.Base Date in Month
     I                                    P   2   30ZA0024
      * Message data for 'Database Error (ICD)'
      * Filename
     I                                        1  10 ZA0025
      * Message data for 'Portfolio currency'
      * Currency Code
     I                                        1   3 ZA0026
      * Message data for 'Settlement currency'
      * Currency Code
     I                                        1   3 ZA0027
      * Message data for 'Invalid settlement curr.'
      * Currency Code
     I                                        1   3 ZA0028
      * Message data for 'Invalid settlement curr.'
      * Currency Code
     I                                        1   3 ZA0029
      * Message data for 'Account code not allowed'
      * Account Code
     I**********                              1   4 ZA0030                                    CGL029
     I                                        1  10 ZA0030                                    CGL029
      * Message data for 'Account code mustn't be t'
      * Interbranch Branch A/c
     I**********                              1   4 ZA0031                                    CGL029
     I                                        1  10 ZA0031                                    CGL029
      * Message data for 'Account sequence not all'
      * Sequence
     I                                        1   2 ZA0032
      * Message data for 'Field Not Numeric'
      * alpha of last change
     I                                        1   6 ZA0033
      * Message data for 'Invalid address code'
      * Address Code
     I                                        1   1 ZA0034
      * Message data for 'Cedel Fung.Ind. mandatory'
      * Cedel Fungibility ind.
     I                                        1   1 ZA0035
      * Message data for 'Cedel fung ind mand DI=C'
      * Cedel Fungibility ind.
     I                                        1   1 ZA0036
      * Message data for 'Stat. frequency not all.'
      * Statement frequency
     I                                        1   1 ZA0037
      * Message data for 'Next statement date N.A.'
      * ST next statement date
     I                                        1   6 ZA0038
      * Message data for 'Invalid Date'
      * Alpha Date
     I                                        1   6 ZA0039
      * Message data for 'Next statement date inv.'
      * ST next statement date
     I                                        1   6 ZA0040
      * Message data for 'Stat. Base Date not all.'
      * Statement Base Day Screen
     I                                        1   2 ZA0041
      * Message data for 'Field Not Numeric'
      * alpha of last change
     I                                        1   6 ZA0042
      * Message data for 'Stat Base Day Invalid'
      * Alpha Date
     I                                        1   6 ZA0043
      * Message data for 'Invalid tax code'
      * Tax Code
     I                                        1   2 ZA0044
      * Message data for 'Invalid reference at E/C'
      * Depot Reference 1
     I                                        1   6 ZA0045
      * Message data for 'Invalid reference at E/C'
      * Depot Reference 1
     I                                        1   6 ZA0046
      * Message data for 'Entry not allowed (Depot)'
      * Depot Reference 2
     I                                        1   6 ZA0047
      * Message data for 'Entry not allowed (Depot)'
      * Depot Reference 2
     I                                        1   6 ZA0048
      * Message data for 'Entry not allowed (Depot)'
      * Depot Reference 2
     I                                        1   6 ZA0049
      * Message data for 'Entry not allowed (Depot)'
      * Depot Reference 2
     I                                        1   6 ZA0050
      * Message data for 'Entry not allowed (Depot)'
      * Depot Reference 2
     I                                        1   6 ZA0051
      * Message data for 'Entry not allowed (Depot)'
      * Depot Reference 2
     I                                        1   6 ZA0052
      * Message data for 'Entry not allowed (Depot)'
      * Depot Reference 2
     I                                        1   6 ZA0053
      * Message data for 'Entry not allowed (Depot)'
      * Depot Reference 2
     I                                        1   6 ZA0054
      * Message data for 'Entry not allowed (Depot)'
      * Depot Reference 2
     I                                        1   6 ZA0055
      * Message data for 'Invalid reference at E/C'
      * Depot Reference 1
     I                                        1   6 ZA0056
      * Message data for 'Invalid reference at cedl'
      * Depot Reference 2
     I                                        1   6 ZA0057
      * Message data for 'Invalid depot reference'
      * Depot Reference 1
     I                                        1   6 ZA0058
      * Message data for 'Invalid depot reference'
      * Depot Reference 1
     I                                        1   6 ZA0059
      * Message data for 'Invalid depot reference'
      * Depot Reference 1
     I                                        1   6 ZA0060
      * Message data for 'Invalid depot reference'
      * Depot Reference 1
     I                                        1   6 ZA0061
      * Message data for 'Invalid depot reference'
      * Depot Reference 1
     I                                        1   6 ZA0062
      * Message data for 'Invalid depot reference'
      * Depot Reference 1
     I                                        1   6 ZA0063
      * Message data for 'Invalid depot reference'
      * Depot Reference 1
     I                                        1   6 ZA0064
      * Message data for 'Invalid depot reference'
      * Depot Reference 1
     I                                        1   6 ZA0065
      * Message data for 'Invalid depot reference'
      * Depot Reference 1
     I                                        1   6 ZA0066
      * Message data for 'Invalid depot reference'
      * Depot Reference 1
     I                                        1   6 ZA0067
      * Message data for 'Invalid depot reference'
      * Depot Reference 1
     I                                        1   6 ZA0068
      * Message data for 'Invalid depot reference'
      * Depot Reference 1
     I                                        1   6 ZA0069
      * Message data for 'Invalid depot reference'
      * Depot Reference 1
     I                                        1   6 ZA0070
      * Message data for 'Invalid depot reference'
      * Depot Reference 1
     I                                        1   6 ZA0071
      * Message data for 'Invalid depot reference'
      * Depot Reference 1
     I                                        1   6 ZA0072
      * Message data for 'Invalid depot reference'
      * Depot Reference 1
     I                                        1   6 ZA0073
      * Message data for 'Invalid depot reference'
      * Depot Reference 1
     I                                        1   6 ZA0074
      * Message data for 'Invalid depot reference'
      * Depot Reference 1
     I                                        1   6 ZA0075
      * Message data for 'Invalid depot reference'
      * Depot Reference 1
     I                                        1   6 ZA0076
      * Message data for 'Invalid depot reference'
      * Depot Reference 1
     I                                        1   6 ZA0077
      * Message data for 'Value required (depot ref'
      * Depot Reference 1
     I                                        1   6 ZA0078
      * Message data for 'Invalid reference at cedl'
      * Depot Reference 2
     I                                        1   6 ZA0079
      * Message data for 'Entry not allowed (Depot)'
      * Depot Reference 2
     I                                        1   6 ZA0080
      * Message data for 'Entry not allowed (Depot)'
      * Depot Reference 2
     I                                        1   6 ZA0081
      * Message data for 'Entry not allowed (Depot)'
      * Depot Reference 2
     I                                        1   6 ZA0082
      * Message data for 'Entry not allowed (Depot)'
      * Depot Reference 2
     I                                        1   6 ZA0083
      * Message data for 'Entry not allowed (Depot)'
      * Depot Reference 2
     I                                        1   6 ZA0084
      * Message data for 'Entry not allowed (Depot)'
      * Depot Reference 2
     I                                        1   6 ZA0085
      * Message data for 'Entry not allowed (Depot)'
      * Depot Reference 2
     I                                        1   6 ZA0086
      * Message data for 'Entry not allowed (Depot)'
      * Depot Reference 2
     I                                        1   6 ZA0087
      * Message data for 'Entry not allowed (Depot)'
      * Depot Reference 2
     I                                        1   6 ZA0088
      * Message data for 'Entry not allowed (Depot)'
      * Depot Reference 2
     I                                        1   6 ZA0089
      * Message data for 'Entry not allowed (Depot)'
      * Depot Reference 2
     I                                        1   6 ZA0090
      * Message data for 'Entry not allowed (Depot)'
      * Depot Reference 2
     I                                        1   6 ZA0091
      * Message data for 'Entry not allowed (Depot)'
      * Depot Reference 2
     I                                        1   6 ZA0092
      * Message data for 'Entry not allowed (Depot)'
      * Depot Reference 2
     I                                        1   6 ZA0093
      * Message data for 'Entry not allowed (Depot)'
      * Depot Reference 2
     I                                        1   6 ZA0094
      * Message data for 'Entry not allowed (Depot)'
      * Depot Reference 2
     I                                        1   6 ZA0095
      * Message data for 'Entry not allowed (Depot)'
      * Depot Reference 2
     I                                        1   6 ZA0096
      * Message data for 'Entry not allowed (Depot)'
      * Depot Reference 2
     I                                        1   6 ZA0097
      * Message data for 'Participant must be......'
      * Part./Non-part. 1
     I                                        1   2 ZA0098
      * Message data for 'Entry not allowed (Depot)'
      * Depot Reference 2
     I                                        1   6 ZA0099
      * Message data for 'Mandatory entry (P/NP)'
      * Part./Non-part. 1
     I                                        1   2 ZA0100
      * Message data for 'Part/Non Part Invalid'
      * Part./Non-part. 1
     I                                        1   2 ZA0101
      * Message data for 'Mandatory entry (P/NP)'
      * Part./Non-part. 1
     I                                        1   2 ZA0102
      * Message data for 'Part/Non Part Invalid'
      * Part./Non-part. 1
     I                                        1   2 ZA0103
      * Message data for 'Mandatory entry (P/NP)'
      * Part./Non-part. 1
     I                                        1   2 ZA0104
      * Message data for 'Part/Non Part Invalid'
      * Part./Non-part. 1
     I                                        1   2 ZA0105
      * Message data for 'Mandatory entry (P/NP)'
      * Part./Non-part. 1
     I                                        1   2 ZA0106
      * Message data for 'Part/Non Part Invalid'
      * Part./Non-part. 1
     I                                        1   2 ZA0107
      * Message data for 'Mandatory entry (P/NP)'
      * Part./Non-part. 1
     I                                        1   2 ZA0108
      * Message data for 'Part/Non Part Invalid'
      * Part./Non-part. 1
     I                                        1   2 ZA0109
      * Message data for 'Mandatory entry (P/NP)'
      * Part./Non-part. 1
     I                                        1   2 ZA0110
      * Message data for 'Part/Non Part Invalid'
      * Part./Non-part. 1
     I                                        1   2 ZA0111
      * Message data for 'Mandatory entry (P/NP)'
      * Part./Non-part. 1
     I                                        1   2 ZA0112
      * Message data for 'Part/Non Part Invalid'
      * Part./Non-part. 1
     I                                        1   2 ZA0113
      * Message data for 'Mandatory entry (P/NP)'
      * Part./Non-part. 1
     I                                        1   2 ZA0114
      * Message data for 'Part/Non Part Invalid'
      * Part./Non-part. 1
     I                                        1   2 ZA0115
      * Message data for 'Mandatory entry (P/NP)'
      * Part./Non-part. 1
     I                                        1   2 ZA0116
      * Message data for 'Part/Non Part Invalid'
      * Part./Non-part. 1
     I                                        1   2 ZA0117
      * Message data for 'Mandatory entry (P/NP)'
      * Part./Non-part. 1
     I                                        1   2 ZA0118
      * Message data for 'Part/Non Part Invalid'
      * Part./Non-part. 1
     I                                        1   2 ZA0119
      * Message data for 'Part/Non part not allowed'
      * Part./Non-part. 1
     I                                        1   2 ZA0120
      * Message data for 'Part/Non part not allowed'
      * Part./Non-part. 1
     I                                        1   2 ZA0121
      * Message data for 'Part/Non part not allowed'
      * Part./Non-part. 1
     I                                        1   2 ZA0122
      * Message data for 'Part/Non part not allowed'
      * Part./Non-part. 1
     I                                        1   2 ZA0123
      * Message data for 'Part/Non part not allowed'
      * Part./Non-part. 1
     I                                        1   2 ZA0124
      * Message data for 'Part/Non part not allowed'
      * Part./Non-part. 1
     I                                        1   2 ZA0125
      * Message data for 'Part/Non part not allowed'
      * Part./Non-part. 1
     I                                        1   2 ZA0126
      * Message data for 'Part/Non part not allowed'
      * Part./Non-part. 1
     I                                        1   2 ZA0127
      * Message data for 'Part/Non part not allowed'
      * Part./Non-part. 1
     I                                        1   2 ZA0128
      * Message data for 'Part/Non part not allowed'
      * Part./Non-part. 1
     I                                        1   2 ZA0129
      * Message data for 'Database Error (ICD)'
      * Filename
     I                                        1  10 ZA0130
      * Message data for 'Database Error (ICD)'
      * Filename
     I                                        1  10 ZA0131
      *                                                                                       204139
      * TIMESTAMP INITIALISATION CONSTANT                                                     204139
     I              '0001-01-01-00.00.00.-C         TIMEST                                    204139
     I              '000000'                                                                  204139
      *                                                                                       204139
      ** Dummy Data Structures used by Access Programs.                                       CSC022
     IDSFDY     E DSDSFDY                                                                     CSC022
      *                                                                                       CSC022
      ** Switchable Features File                                                             CSC022
     ISCSARD    E DSSCSARDPD                                                                  CSC022
      *                                                                                       CSC022
      ** Commitment Control dataarea                                                          CSC022
     ISCCMT       DS                            256                                           CSC022
     I                                        1   30WCMTNO                                    CSC022
     I                                        4 103 WCMTJB                                    CSC022
      *                                                                                       CSC022
      ** Local data area for database error details                                           CSC022
     ILDA       E DSLDA                         256                                           CSC022
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C                     PARM           P1PARM           KEY: Securities
     C           P2CFAO    PARM           WP0001  1        call futures &
     C           P3ANCD    PARM           WP0002  1        Action Code
     C           P4MODE    PARM           WP0003  1        mode
     C/COPY WNCPYSRC,SD0341RC24
     C                     PARM           P1FRNT 20                                           CER001
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Check passed parameters
     C                     EXSR FACKPM
      * Perform once if all passed, else repeat
     C           W0RPT     DOUEQ'N'
      * Display and process key screen
     C                     EXSR BADSKY
     C                     END
      * Terminate program
     C                     EXSR ZXEXPG
      *****************************************************************
      /EJECT
     CSR         BADSKY    BEGSR
      *================================================================
      * Display and process key screen
      *================================================================
      * Initialize key screen
     C                     EXSR MDIZ#K
      * Bypass first display of key screen is possible
     C                     MOVEL'Y'       W0BYP   1
      * Signal start of transaction
     C                     MOVEL'Y'       W0TRN   1
     C           W0TRN     DOWEQ'Y'
     C           W0TRN     OREQ 'K'
      * Ensure transaction continues (if reset)
     C                     MOVEL'Y'       W0TRN   1
      * Conduct screen conversation
     C           W0TRN     DOWEQ'Y'
      * Is bypass key screen still viable?
     C           W0BYP     IFEQ 'Y'
     C           #1CUST    IFEQ *BLANK                     Customer Number
      * One or more key fields is blank
     C           *IN05     OREQ '1'
      * HOME: Reset screen fields
     C                     MOVEL'N'       W0BYP
     C                     END
     C                     END
      * Bypass key screen
     C           W0BYP     IFNE 'Y'
      * Display key screen
     C                     EXSR BBEXFM
     C                     END
      * Cancel key screen bypass
     C                     MOVEL'N'       W0BYP
      * Process response to key screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * Switch between *ADD/*CHANGE modes
     C   09                CAS            BCCHMD
      * HOME: Reset screen fields
     C   05                CAS            BDHMKY
      * Process key screen input
     C                     CAS            BEPRKY
     C                     END
     C           W0TRN     DOWEQ'R'
     C                     MOVEL'Y'       W0TRN
     C                     EXSR BEPRKY
     C                     END
      *
     C                     END
     C                     END
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBEXFM    BEGSR
      *================================================================
      * Display key screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSAK
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE HELP25    *IN25
      * PUTOVR unless conditioned fields change
     C                     SETON                         86*
     C           *IN89     IFNE BBIN89
     C                     SETOF                         86*
     C                     END
     C                     MOVE *IN89     BBIN89  1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C/COPY WNCPYSRC,SD0341RC08
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDKEY
     C/COPY WNCPYSRC,SD0341RC09
      * Test cursor
     C                     EXSR Y8TST
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C/COPY WNCPYSRC,SD0341RC10
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
     C/COPY WNCPYSRC,SD0341RC11
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1
      * Reset global error indicator
     C                     SETOF                         99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         BCCHMD    BEGSR
      *================================================================
      * Switch between *ADD/*CHANGE modes
      *================================================================
     C           W0PMD     IFEQ 'ADD'
     C                     MOVEL'CHG'     W0PMD   3
     C                     ELSE
     C                     MOVEL'ADD'     W0PMD
     C                     END
      *================================================================
     CSR         BCEXIT    ENDSR
      /EJECT
     CSR         BDHMKY    BEGSR
      *================================================================
      * Process HOME key
      *================================================================
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         BDEXIT    ENDSR
      /EJECT
     CSR         BEPRKY    BEGSR
      *================================================================
      * Process key screen input
      *================================================================
      * Initialise detail screen
     C                     EXSR MAIZ#1
      * Validate key fields
     C                     EXSR BFVLKY
     C           *IN99     CABEQ'1'       BEEXIT
      * Check for existing record
     C           KRTV      KLIST
     C                     KFLD           BFCUST           Customer Number
      * Setup key
     C                     MOVEL#1CUST    BFCUST           Customer Number
     C           KRTV      CHAIN@BFREDQ              9091  *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     SETON                     9931  *
     C                     GOTO BEEXIT
     C                     END                             FI 91
      *
      * If record does not exist, flip to add mode
     C           *IN90     IFEQ '1'
     C                     MOVEL'ADD'     W0PMD
      * USER: Initialize detail screen (new record)
      * Clients DTL Screen Footer - Standard Functions  *
     C*
     C                     MOVEL'SDUSRMSG'WUMSGF 10
     C                     MOVE *BLANKS   WUMTXT 80
     C*
     C           P3ANCD    IFEQ 'D'                                       S01229
     C           P4MODE    IFEQ 'M'                                       S01229
     C* Setup footer text:
     C* F3=Main Menu   F10=Delete   F12=Previous
     C                     MOVEL'USR3350' WUMSID  7        Message Identifier
     C                     CALL 'SDRTVTXT'             90  Retrieve MSGF message
     C           WUMSID    PARM WUMSID    WQ0286  7        Message Identifier
     C           WUMSGF    PARM WUMSGF    WQ0287 10        Message File Name
     C           WUMTXT    PARM WUMTXT    WQ0288 80        Message Text
     C                     MOVELWUMTXT    ##CTX1
     C*
     C           *IN90     IFEQ '1'
     C* Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SDRTVTXT'W0CLPG
     C* Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
     C                     ELSE
     C* Setup footer text:
     C* F3=Client Details   F10=Delete   F12=Previous
     C                     MOVEL'USR3339' WUMSID           Message Identifier
     C                     CALL 'SDRTVTXT'             90  Retrieve MSGF message
     C           WUMSID    PARM WUMSID    WQ0286  7        Message Identifier
     C           WUMSGF    PARM WUMSGF    WQ0287 10        Message File Name
     C           WUMTXT    PARM WUMTXT    WQ0288 80        Message Text
     C                     MOVELWUMTXT    ##CTX1
     C*
     C           *IN90     IFEQ '1'
     C* Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SDRTVTXT'W0CLPG
     C* Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
     C                     END
     C                     END
     C           P3ANCD    IFEQ 'A'                                       S01229
     C           P4MODE    IFEQ 'M'                                       S01229
     C* Setup footer text:
     C* F3=Main Menu   F12=Previous
     C                     MOVEL'USR3346' WUMSID           Message Identifier
     C                     CALL 'SDRTVTXT'             90  Retrieve MSGF message
     C           WUMSID    PARM WUMSID    WQ0286  7        Message Identifier
     C           WUMSGF    PARM WUMSGF    WQ0287 10        Message File Name
     C           WUMTXT    PARM WUMTXT    WQ0288 80        Message Text
     C                     MOVELWUMTXT    ##CTX1
     C*
     C           *IN90     IFEQ '1'
     C* Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SDRTVTXT'W0CLPG
     C* Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
     C                     ELSE
     C* Setup footer text:
     C* F3=Client Details   F12=Previous
     C**********           MOVEL'USR3339' WUMSID           Message Identifier                 207057
     C                     MOVEL'USR3340' WUMSID           Message Identifier                 207057
     C                     CALL 'SDRTVTXT'             90  Retrieve MSGF message
     C           WUMSID    PARM WUMSID    WQ0286  7        Message Identifier
     C           WUMSGF    PARM WUMSGF    WQ0287 10        Message File Name
     C           WUMTXT    PARM WUMTXT    WQ0288 80        Message Text
     C                     MOVELWUMTXT    ##CTX1
     C*
     C           *IN90     IFEQ '1'
     C* Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SDRTVTXT'W0CLPG
     C* Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
     C                     END
     C                     END
     C           P3ANCD    IFEQ 'I'                                       S01229
     C           P4MODE    IFEQ 'M'                                       S01229
     C* Setup footer text:
     C* F3=Main Menu   F12=Previous
     C                     MOVEL'USR3346' WUMSID           Message Identifier
     C                     CALL 'SDRTVTXT'             90  Retrieve MSGF message
     C           WUMSID    PARM WUMSID    WQ0286  7        Message Identifier
     C           WUMSGF    PARM WUMSGF    WQ0287 10        Message File Name
     C           WUMTXT    PARM WUMTXT    WQ0288 80        Message Text
     C                     MOVELWUMTXT    ##CTX1
     C*
     C           *IN90     IFEQ '1'
     C* Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SDRTVTXT'W0CLPG
     C* Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
     C                     ELSE
     C* Setup footer text:
     C* F3=Client Details   F12=Previous
     C**********           MOVEL'USR3339' WUMSID           Message Identifier                 207057
     C                     MOVEL'USR3340' WUMSID           Message Identifier                 207057
     C                     CALL 'SDRTVTXT'             90  Retrieve MSGF message
     C           WUMSID    PARM WUMSID    WQ0286  7        Message Identifier
     C           WUMSGF    PARM WUMSGF    WQ0287 10        Message File Name
     C           WUMTXT    PARM WUMTXT    WQ0288 80        Message Text
     C                     MOVELWUMTXT    ##CTX1
     C*
     C           *IN90     IFEQ '1'
     C* Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SDRTVTXT'W0CLPG
     C* Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
     C                     END
     C                     END
     C*
      * Retrieve for other screen - Client Details  *
     C                     EXSR SARVGN
      * start E28322
      * Retrieve Depot 1 (EUROCLEAR), as well as the rest
      * Retrieve depots - Securities Trading Data  *
     C                     EXSR SBRVGN
      * retrieve shortname for Depot 1 (EUROCLEAR)
      * Retrieve shortname - Client Details  *
     C                     EXSR SCRVGN
      * end E28322
      * Retrieve shortname - Client Details  *
     C                     EXSR SDRVGN
      * Retrieve shortname - Client Details  *
     C                     EXSR SERVGN
      * Retrieve shortname - Client Details  *
     C                     EXSR SFRVGN
      * Retrieve shortname - Client Details  *
     C                     EXSR SGRVGN
      * Retrieve shortname - Client Details  *
     C                     EXSR SHRVGN
      * Retrieve shortname - Client Details  *
     C                     EXSR SIRVGN
      * Retrieve shortname - Client Details  *
     C                     EXSR SJRVGN
      * Retrieve shortname - Client Details  *
     C                     EXSR SKRVGN
      * Retrieve shortname - Client Details  *
     C                     EXSR SLRVGN
      * Start of SAR S01212
      * 00/Copy Member SD0341RISN - Securities Clients  *
     C*00/Copy Member SD0341R   Initialise Dtl New Rcd
     C/COPY WNCPYSRC,SD0341RISN
      * End of SAR S01212
     C                     ELSE
      * If record does exist, flip to change mode
     C                     MOVEL'CHG'     W0PMD
      * Load screen fields from DBF
     C                     EXSR MBFL#1
      * CALC: Detail screen function fields
      * Start of SAR S01212
      * 00/Copy Member SD0341RSFF - Securities Clients  *
     C*00/Copy Member SD0341R   Calc Detail Function Flds
     C/COPY WNCPYSRC,SD0341RSFF
      * End of SAR S01212
      * USER: Initialize detail screen (existing record)
      * Clients DTL Screen Footer - Standard Functions  *
     C*
     C                     MOVEL'SDUSRMSG'WUMSGF 10
     C                     MOVE *BLANKS   WUMTXT 80
     C*
     C           P3ANCD    IFEQ 'D'                                       S01229
     C           P4MODE    IFEQ 'M'                                       S01229
     C* Setup footer text:
     C* F3=Main Menu   F10=Delete   F12=Previous
     C                     MOVEL'USR3350' WUMSID  7        Message Identifier
     C                     CALL 'SDRTVTXT'             90  Retrieve MSGF message
     C           WUMSID    PARM WUMSID    WQ0286  7        Message Identifier
     C           WUMSGF    PARM WUMSGF    WQ0287 10        Message File Name
     C           WUMTXT    PARM WUMTXT    WQ0288 80        Message Text
     C                     MOVELWUMTXT    ##CTX1
     C*
     C           *IN90     IFEQ '1'
     C* Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SDRTVTXT'W0CLPG
     C* Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
     C                     ELSE
     C* Setup footer text:
     C* F3=Client Details   F10=Delete   F12=Previous
     C                     MOVEL'USR3339' WUMSID           Message Identifier
     C                     CALL 'SDRTVTXT'             90  Retrieve MSGF message
     C           WUMSID    PARM WUMSID    WQ0286  7        Message Identifier
     C           WUMSGF    PARM WUMSGF    WQ0287 10        Message File Name
     C           WUMTXT    PARM WUMTXT    WQ0288 80        Message Text
     C                     MOVELWUMTXT    ##CTX1
     C*
     C           *IN90     IFEQ '1'
     C* Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SDRTVTXT'W0CLPG
     C* Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
     C                     END
     C                     END
     C           P3ANCD    IFEQ 'A'                                       S01229
     C           P4MODE    IFEQ 'M'                                       S01229
     C* Setup footer text:
     C* F3=Main Menu   F12=Previous
     C                     MOVEL'USR3346' WUMSID           Message Identifier
     C                     CALL 'SDRTVTXT'             90  Retrieve MSGF message
     C           WUMSID    PARM WUMSID    WQ0286  7        Message Identifier
     C           WUMSGF    PARM WUMSGF    WQ0287 10        Message File Name
     C           WUMTXT    PARM WUMTXT    WQ0288 80        Message Text
     C                     MOVELWUMTXT    ##CTX1
     C*
     C           *IN90     IFEQ '1'
     C* Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SDRTVTXT'W0CLPG
     C* Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
     C                     ELSE
     C* Setup footer text:
     C* F3=Client Details   F12=Previous
     C**********           MOVEL'USR3339' WUMSID           Message Identifier                 207057
     C                     MOVEL'USR3340' WUMSID           Message Identifier                 207057
     C                     CALL 'SDRTVTXT'             90  Retrieve MSGF message
     C           WUMSID    PARM WUMSID    WQ0286  7        Message Identifier
     C           WUMSGF    PARM WUMSGF    WQ0287 10        Message File Name
     C           WUMTXT    PARM WUMTXT    WQ0288 80        Message Text
     C                     MOVELWUMTXT    ##CTX1
     C*
     C           *IN90     IFEQ '1'
     C* Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SDRTVTXT'W0CLPG
     C* Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
     C                     END
     C                     END
     C           P3ANCD    IFEQ 'I'                                       S01229
     C           P4MODE    IFEQ 'M'                                       S01229
     C* Setup footer text:
     C* F3=Main Menu   F12=Previous
     C                     MOVEL'USR3346' WUMSID           Message Identifier
     C                     CALL 'SDRTVTXT'             90  Retrieve MSGF message
     C           WUMSID    PARM WUMSID    WQ0286  7        Message Identifier
     C           WUMSGF    PARM WUMSGF    WQ0287 10        Message File Name
     C           WUMTXT    PARM WUMTXT    WQ0288 80        Message Text
     C                     MOVELWUMTXT    ##CTX1
     C*
     C           *IN90     IFEQ '1'
     C* Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SDRTVTXT'W0CLPG
     C* Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
     C                     ELSE
     C* Setup footer text:
     C* F3=Client Details   F12=Previous
     C**********           MOVEL'USR3339' WUMSID           Message Identifier                 207057
     C                     MOVEL'USR3340' WUMSID           Message Identifier                 207057
     C                     CALL 'SDRTVTXT'             90  Retrieve MSGF message
     C           WUMSID    PARM WUMSID    WQ0286  7        Message Identifier
     C           WUMSGF    PARM WUMSGF    WQ0287 10        Message File Name
     C           WUMTXT    PARM WUMTXT    WQ0288 80        Message Text
     C                     MOVELWUMTXT    ##CTX1
     C*
     C           *IN90     IFEQ '1'
     C* Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SDRTVTXT'W0CLPG
     C* Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
     C                     END
     C                     END
     C*
     C                     MOVEL'N'       WUDELA           Deletion Allowe
      * CASE: DB1.No. of Trades for Cust. is Equal to zero
     C           BFNTFC    IFEQ *ZERO                      *IF
     C                     MOVEL'Y'       WUDELA           Deletion Allowe
     C                     END                             *FI
      * Start of SAR S01117
      * CASE: DB1.Next statement date is not zero
     C           BFNSDT    IFNE *ZERO                      *IF
      * Check File Date - Rundate  *
     C                     CALL 'ZDATE2'               90  Check File Date
     C                     PARM BFNSDT    WQ0001  50       Work Midas Date
     C                     PARM WUDFF     WQ0002  1        Date format fla
     C           WUWCDT    PARM *ZERO     WQ0003  60       Work Converted
     C           WUWADT    PARM *BLANK    WQ0004  7        Work Alpha Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZDATE2'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * start E28480
      * move 6 digit numeric field to screen, not alpha
     C                     MOVEL*BLANK    #DSNSD           ST next stateme
     C                     MOVELWUWCDT    #DSNSD           ST next stateme
      * end E28480
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #DSNSD           ST next stateme
     C                     END                             *FI
      * End of SAR S01117
      * Retrieve for other screen - Client Details  *
     C                     EXSR SMRVGN
      * start E28322
      * retrieve Depot 1 (EUROCLEAR), as well as the rest
      * Retrieve depots - Securities Trading Data  *
     C                     EXSR SNRVGN
      * retrieve shortname for Depot 1 (EUROCLEAR)
      * Retrieve shortname - Client Details  *
     C                     EXSR SORVGN
      * end E28322
      * Retrieve shortname - Client Details  *
     C                     EXSR SPRVGN
      * Retrieve shortname - Client Details  *
     C                     EXSR SQRVGN
      * Retrieve shortname - Client Details  *
     C                     EXSR SRRVGN
      * Retrieve shortname - Client Details  *
     C                     EXSR SSRVGN
      * Retrieve shortname - Client Details  *
     C                     EXSR STRVGN
      * Retrieve shortname - Client Details  *
     C                     EXSR SURVGN
      * Retrieve shortname - Client Details  *
     C                     EXSR SVRVGN
      * Retrieve shortname - Client Details  *
     C                     EXSR SWRVGN
      * Retrieve shortname - Client Details  *
     C                     EXSR SXRVGN
      * Start of SAR S01117
      * Set up the numeric fields that are now alpha on the screen
      * Account sequence
      * CASE: DB1.Account sequence number is not blank
     C           BFACSN    IFNE *ZERO                      *IF
      * MOVE Sequence to ZALIGN - Securities Clients  *
     C                     MOVE BFACSN    WUZASF
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0005 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0006  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * MOVE ZASF to Sequence - Securities Clients  *
     C                     MOVE WUZASF    #DSQNC
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #DSQNC           Sequence
     C                     END                             *FI
      * Statement Base Day Number
      * CASE: DB1.Stat.Base Date in Month is Not Blank
     C           BFSBDM    IFNE *ZERO                      *IF
      * MOVE Stat.Base Day No - Securities Clients  *
     C                     MOVE BFSBDM    WUZASF
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0007 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0008  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * MOVE ZASF to State Base D - Securities Clients  *
     C                     MOVE WUZASF    #DSTBD
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #DSTBD           Statement Base
     C                     END                             *FI
      * End of SAR S01117
      * Start of SAR S01212
      * 00/Copy Member SD0341RISE - Securities Clients  *
     C*00/Copy Member SD0341R   Initialise Dtl Exist Rcd
     C/COPY WNCPYSRC,SD0341RISE
      * End of SAR S01212
     C                     END
      *..................................................
     C   99                GOTO BEEXIT
      * No error: Display and process details
     C                     EXSR CADSDA
      *
      *================================================================
     CSR         BEEXIT    ENDSR
      /EJECT
     CSR         BFVLKY    BEGSR
      *================================================================
      * Validate key fields
      *================================================================
     C           W0PMD     IFNE 'ADD'
      * Select existing record
     C                     EXSR VACKRL
     C                     END
      * Check relations
      * Check reference to Client Details
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * USER: Validate key screen
      * Start of SAR S01212
      * 00/Copy Member SD0341RVKS - Securities Clients  *
     C*00/Copy Member SD0341R   Validate Key Screen
     C/COPY WNCPYSRC,SD0341RVKS
      * End of SAR S01212
      * Customer Number required
     C           #1CUST    IFEQ *BLANK                     IF
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         BFEXIT    ENDSR
      /EJECT
     CSR         CADSDA    BEGSR
      *================================================================
      * Display and process detail screen
      *================================================================
      * Conduct detail screen conversation
      * - repeat until screen control flag is reset:
     C           W0TRN     DOWEQ'Y'
      * Display detail screen
     C                     EXSR CBEXFM
      * Process response to detail screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * Redisplay previous screen
     C   12                CAS            CCDSPV
      * HOME: Reset screen fields
     C   05                CAS            CCDSPV
      * Process detail screen input
     C                     CAS            CFPRSC
     C                     END
     C           W0TRN     IFEQ 'R'
     C           W0PMD     IFEQ 'ADD'
     C                     EXSR MAIZ#1
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         CBEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE HELP25    *IN25
      * PUTOVR unless conditioned fields change
     C                     SETON                         86*
     C           *IN89     IFNE CBIN89
     C                     SETOF                         86*
     C                     END
     C                     MOVE *IN89     CBIN89  1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y1SET
     C                     END
     C/COPY WNCPYSRC,SD0341RC23
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT2
     C                     EXFMT#RCDDTL1
     C/COPY WNCPYSRC,SD0341RC12
      * Test cursor
     C                     EXSR Y8TST
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C/COPY WNCPYSRC,SD0341RC13
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
     C/COPY WNCPYSRC,SD0341RC14
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1
      * Reset global error indicator
     C                     SETOF                         99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CBEXIT    ENDSR
      /EJECT
     CSR         CCDSPV    BEGSR
      *================================================================
      * Redisplay previous screen
      *================================================================
      * USER: Process key screen request
      * Start of SAR S01212
      * 00/Copy Member SD0341RPKR - Securities Clients  *
     C*00/Copy Member SD0341R   Process Key Screen Rqst
     C/COPY WNCPYSRC,SD0341RPKR
      * End of SAR S01212
      * Start of SAR S01117
      * CASE: PAR.mode is From special clients
     C           P4MODE    IFEQ 'S'                        *IF
      * Exit Program - No ROLBK - Standard Functions  *
      *================================================================
      * Exit program: Direct without rollback.
      *================================================================
      * Move return code to output parameters
     C                     MOVE 'USR0790' P0RTN
      *
      * Terminate program.
     C                     SETON                     LR
      *
      * Exit program.
     C                     RETRN
      *
      *================================================================
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'USR0790' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * End of SAR S01117
     C   05                MOVEL'R'       W0TRN
     C   12                MOVEL'K'       W0TRN
      *================================================================
     CSR         CCEXIT    ENDSR
      /EJECT
     CSR         CFPRSC    BEGSR
      *================================================================
      * Validate record
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * If delete is not pending....
      * Validate details
     C  N10                CAS            DCVLDL
     C                     END
     C/COPY WNCPYSRC,SD0341RC15
      * QUIT if error:
     C   99                GOTO CFEXIT
      * Defer confirm/update requested
     C/COPY WNCPYSRC,SD0341RC16
     C           W0DCF     CABEQ'Y'       CFEXIT
     C/COPY WNCPYSRC,SD0341RC17
      * No error: update record
     C                     EXSR EBPR##
      *================================================================
     CSR         CFEXIT    ENDSR
      /EJECT
     CSR         DCVLDL    BEGSR
      *================================================================
      * Validate details
      *================================================================
      * Validate Classification
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1CLAS    W0NSRQ  1        Classification
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1101775   Y2LSNO  70
     C           #1CLAS    PARM #1CLAS    W0EXVL 20        Classification
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
      * Validate Statement frequency
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1STFQ    W0NSRQ  1        Statement frequ
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1101038   Y2LSNO  70
     C           #1STFQ    PARM #1STFQ    W0EXVL 20        Statement frequ
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
      * Validate Cedel Fungibility ind.
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1CFIN    W0NSRQ  1        Cedel Fungibili
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1101787   Y2LSNO  70
     C           #1CFIN    PARM #1CFIN    W0EXVL 20        Cedel Fungibili
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
      * Validate Pledge Agreement
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1PLAG    W0NSRQ  1        Pledge Agreemen
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1101790   Y2LSNO  70
     C           #1PLAG    PARM #1PLAG    W0EXVL 20        Pledge Agreemen
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
      * Validate Auto-Settle Indicator
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1ASIN    W0NSRQ  1        Auto-Settle Ind
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1107121   Y2LSNO  70
     C           #1ASIN    PARM #1ASIN    W0EXVL 20        Auto-Settle Ind
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
      * Validate Part./Non-part. 1
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1PNP1    W0NSRQ  1        Part./Non-part.
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1101784   Y2LSNO  70
     C           #1PNP1    PARM #1PNP1    W0EXVL 20        Part./Non-part.
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
      * Validate Part./Non-part. 2
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1PNP2    W0NSRQ  1        Part./Non-part.
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1101784   Y2LSNO  70
     C           #1PNP2    PARM #1PNP2    W0EXVL 20        Part./Non-part.
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
      * Validate Part./Non-part. 3
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1PNP3    W0NSRQ  1        Part./Non-part.
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1101784   Y2LSNO  70
     C           #1PNP3    PARM #1PNP3    W0EXVL 20        Part./Non-part.
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
      * Validate Part./Non-part. 4
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1PNP4    W0NSRQ  1        Part./Non-part.
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1101784   Y2LSNO  70
     C           #1PNP4    PARM #1PNP4    W0EXVL 20        Part./Non-part.
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
      * Validate Part./Non-part. 5
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1PNP5    W0NSRQ  1        Part./Non-part.
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1101784   Y2LSNO  70
     C           #1PNP5    PARM #1PNP5    W0EXVL 20        Part./Non-part.
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
      * Validate Part./Non-part. 6
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1PNP6    W0NSRQ  1        Part./Non-part.
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1101784   Y2LSNO  70
     C           #1PNP6    PARM #1PNP6    W0EXVL 20        Part./Non-part.
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
      * Validate Part./Non-part. 7
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1PNP7    W0NSRQ  1        Part./Non-part.
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1101784   Y2LSNO  70
     C           #1PNP7    PARM #1PNP7    W0EXVL 20        Part./Non-part.
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
      * Validate Part./Non-part. 8
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1PNP8    W0NSRQ  1        Part./Non-part.
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1101784   Y2LSNO  70
     C           #1PNP8    PARM #1PNP8    W0EXVL 20        Part./Non-part.
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
      * Validate Part./Non-part. 9
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1PNP9    W0NSRQ  1        Part./Non-part.
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1101784   Y2LSNO  70
     C           #1PNP9    PARM #1PNP9    W0EXVL 20        Part./Non-part.
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
      * Validate Part./Non-part. 10
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1PNP0    W0NSRQ  1        Part./Non-part.
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1101784   Y2LSNO  70
     C           #1PNP0    PARM #1PNP0    W0EXVL 20        Part./Non-part.
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
      * USER: Validate detail screen fields
     C                     MOVEL'N'       WUF3PR           F3 Pressed
      * CASE: PAR.Action Code is Delete
     C           P3ANCD    IFEQ 'D'                        *IF
      * Start of SAR S01117
      * F12 is valid in both modes now
      * Send message 'F3/F10/F12 only valid opt'
     C                     MOVEL'USR0536' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DCEXIT                     *QUIT
      * End of SAR S01117
     C                     END                             *FI
      * Start of SAR S01117
      * CASE: DTL.Classification is *ALL values
     C           #1CLAS    IFEQ 'S'                        *IF
     C           #1CLAS    OREQ 'D'
     C           #1CLAS    OREQ 'M'
     C           #1CLAS    OREQ 'I'
     C           #1CLAS    OREQ 'X'
     C           #1CLAS    OREQ 'E'
     C           #1CLAS    OREQ 'C'
     C********** #1CLAS    OREQ 'K'                                                           CSE022
     C           #1CLAS    OREQ *BLANK
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1CLAS    ZA0003           Classification
      * Send message 'Classification Invalid'
     C                     MOVEL'USR1491' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
      * CASE: DTL.Statement frequency is *ALL values
     C           #1STFQ    IFEQ 'M'                        *IF
     C           #1STFQ    OREQ 'S'
     C           #1STFQ    OREQ 'T'
     C           #1STFQ    OREQ 'R'
     C           #1STFQ    OREQ 'B'
     C           #1STFQ    OREQ 'L'
     C           #1STFQ    OREQ 'A'
     C           #1STFQ    OREQ 'Q'
     C           #1STFQ    OREQ 'X'
     C           #1STFQ    OREQ 'Y'
     C           #1STFQ    OREQ 'Z'
     C           #1STFQ    OREQ 'D'
     C           #1STFQ    OREQ 'W'
     C           #1STFQ    OREQ 'F'
     C           #1STFQ    OREQ 'P'
     C           #1STFQ    OREQ 'K'
     C           #1STFQ    OREQ 'H'
     C           #1STFQ    OREQ 'G'
     C           #1STFQ    OREQ *BLANK
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1STFQ    ZA0004           Statement frequ
      * Send message 'Statement Freq Invalid'
     C                     MOVEL'USR1492' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9936  *
      *
     C                     END                             *FI
      * CASE: DTL.Cedel Fungibility ind. is *ALL values
     C           #1CFIN    IFEQ 'F'                        *IF
     C           #1CFIN    OREQ 'N'
     C           #1CFIN    OREQ *BLANK
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1CFIN    ZA0005           Cedel Fungibili
      * Send message 'Cedel Fung Ind Invalid'
     C                     MOVEL'USR1493' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9941  *
      *
     C                     END                             *FI
      * CASE: DTL.Pledge Agreement is *ALL values
     C           #1PLAG    IFEQ 'Y'                        *IF
     C           #1PLAG    OREQ 'N'
     C           #1PLAG    OREQ *BLANK
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1PLAG    ZA0006           Pledge Agreemen
      * Send message 'Pledge Agreement Invalid'
     C                     MOVEL'USR1494' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9942  *
      *
     C                     END                             *FI
      * CASE: DTL.Auto-Settle Indicator is *ALL values
     C           #1ASIN    IFEQ *BLANK                     *IF
     C           #1ASIN    OREQ 'Y'
     C           #1ASIN    OREQ 'N'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1ASIN    ZA0007           Auto-Settle Ind
      * Send message 'Auto-Settle Ind Invalid'
     C                     MOVEL'USR1495' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9944  *
      *
     C                     END                             *FI
      * End of SAR S01117
      * Start of change S01464.
      * Validate Subject to Custody Fees.
      * CASE: WRK.Safe Custody Fees Flag is Yes
     C           WUCUIN    IFEQ 'Y'                        *IF
      * Validate Subject to Custody Fees.
      * CASE: DTL.Classification is Equal to S or D
     C           #1CLAS    IFEQ 'D'                        *IF
     C           #1CLAS    OREQ 'S'
      * Check that Subject to Custody Fees is 'N', 'Y' or blank.
      * CASE: DTL.Subject to Custody Fees is Valid values
     C           #1SBJF    IFEQ 'N'                        *IF
     C           #1SBJF    OREQ 'Y'
     C           #1SBJF    OREQ *BLANK
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1SBJF    ZA0008           Subject to Cust
      * Send message 'Safe Cust Fees Flag Inval'
     C                     MOVEL'USR2339' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9945  *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Check that Subject to Custody Fees is 'N' or blank.
      * CASE: DTL.Subject to Custody Fees is N or Blank
     C           #1SBJF    IFEQ *BLANK                     *IF
     C           #1SBJF    OREQ 'N'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1SBJF    ZA0009           Subject to Cust
      * Send message 'Sub to Cus Fee Not N/Blnk'
     C                     MOVEL'USR2344' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9945  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * End of change S01464.
      * Start of S01496
      * Trade Charges Group
      * CASE: WRK.SAR S01496 is Present
     C           WUJYSK    IFEQ 'Y'                        *IF
     C/COPY WNCPYSRC,SD0341RC18
      * CASE: DTL.Trade Charges Group is Entered
     C           #1TDCG    IFNE *BLANK                     *IF
      * CASE: DTL.Classification is Not S, D or M
     C           #1CLAS    IFEQ 'C'                        *IF
     C           #1CLAS    OREQ 'X'
     C           #1CLAS    OREQ 'E'
     C           #1CLAS    OREQ 'I'
     C********** #1CLAS    OREQ 'K'                                                           CSE022
      * Setup message data for message
     C                     MOVEL#1TDCG    ZA0010           Trade Charges G
      * Send message 'Trade charges grp not req'
     C                     MOVEL'USR2589' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9946  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#1TDCG    WUTQKF           Test ? in Key F
      * CASE: WRK.Test ? in Key Field is Question Mark
     C           WUTQKF    IFEQ '?'                        *IF
     C                     MOVEL#1TDCG    WUCUGR           Work Charge Gro
      * Call AOCUGRR0 - Standard Functions  *     *KEY
     C*
     C                     CALL 'AOCUGRR0'
     C           WUAPRC    PARM WUAPRC    UUAPRC  7        RETURN CDE
     C                     PARM '*KEY'    UUAPOP  7        OPTION
     C                     PARM WUCUGR    UUCUGR  2        CHARGE GROUP
     C           D@CUGR    PARM *BLANK    UUSDY            FORMAT
     C*
      * Check if selection was made
      * CASE: WRK.Access Pgm Return Code is No selection
     C           WUAPRC    IFEQ '*NOSEL'                   *IF
      * Send message 'Trade Charges Grp not sel'
     C                     MOVEL'USR2591' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: *OTHERWISE
      * Move Trade Charges Group - Securities Clients  *
     C*
     C                     MOVE CGCUGR    #1TDCG
     C*
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#1TDCG    WUCUGR           Work Charge Gro
      * Call AOCUGRR0 - Standard Functions  *     *VERIFY
     C*
     C                     CALL 'AOCUGRR0'
     C           WUAPRC    PARM WUAPRC    UUAPRC  7        RETURN CDE
     C                     PARM '*VERIFY' UUAPOP  7        OPTION
     C                     PARM WUCUGR    UUCUGR  2        CHARGE GROUP
     C           D@CUGR    PARM *BLANK    UUSDY            FORMAT
     C*
      * Check access object return code
      * CASE: WRK.Access Pgm Return Code is *Normal
     C           WUAPRC    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1TDCG    ZA0011           Trade Charges G
      * Send message 'Trade Charges Grp NF'
     C                     MOVEL'USR2592' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9946  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Classification is S, D or M.
      * CASE: DTL.Classification is S, D or M
     C           #1CLAS    IFEQ 'D'                        *IF
     C           #1CLAS    OREQ 'M'
     C           #1CLAS    OREQ 'S'
      * Setup message data for message
     C                     MOVEL#1TDCG    ZA0012           Trade Charges G
      * Send message 'Trade Charges Grp is reqd'
     C                     MOVEL'USR2590' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9946  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * End of S01496
      * Start of change S01464.
      * Validate Custody Fees Group Code.
      * CASE: WRK.Safe Custody Fees Flag is Yes
     C           WUCUIN    IFEQ 'Y'                        *IF
      * Validate Custody Fees Group Code.
      * CASE: DTL.Subject to Custody Fees is Subject
     C           #1SBJF    IFEQ 'Y'                        *IF
      * Validate Custody Fees Group Code.
      * CASE: DTL.Custody Fees Group Code is Blank
     C           #1CFGC    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Custody Fees Group A/Obj - Standard Functions  *
     C                     CALL 'AOCFGRR0'             90  Custody Fees Gr
     C           WUAPRC    PARM *BLANK    WQ0011  7        Access Pgm Retu
     C                     PARM '*VERIFY' WQ0012  7        Access Pgm Opti
     C                     PARM #1CFGC    WQ0013  2        Custody Fees Gr
     C           WUAOF2    PARM *BLANK    WQ0014200        Access Object F
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'AOCFGRR0'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Check return code.
      * CASE: WRK.Access Pgm Return Code is *Normal
     C           WUAPRC    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1CFGC    ZA0013           Custody Fees Gr
      * Send message 'Custody Fees Group Invald'
     C                     MOVEL'USR2342' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9947  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Validate Custody Fees Group Code.
      * CASE: DTL.Custody Fees Group Code is Blank
     C           #1CFGC    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1CFGC    ZA0014           Custody Fees Gr
      * Send message 'Cust Fees Gp Cde non-blnk'
     C                     MOVEL'USR2351' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9947  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * End of change S01464.
      * Start of S01496
      * Position Settlement Charge Group
      * CASE: WRK.SAR S01496 is Present
     C           WUJYSK    IFEQ 'Y'                        *IF
     C/COPY WNCPYSRC,SD0341RC19
      * CASE: DTL.Position Settl. Charge GR is Entered
     C           #1PSCG    IFNE *BLANK                     *IF
      * CASE: DTL.Classification is Not S, D or M
     C           #1CLAS    IFEQ 'C'                        *IF
     C           #1CLAS    OREQ 'X'
     C           #1CLAS    OREQ 'E'
     C           #1CLAS    OREQ 'I'
     C********** #1CLAS    OREQ 'K'                                                           CSE022
      * Setup message data for message
     C                     MOVEL#1PSCG    ZA0015           Position Settl.
      * Send message 'Posn Settle not required'
     C                     MOVEL'USR2593' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9948  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#1PSCG    WUTQKF           Test ? in Key F
      * Test for '?'.
      * CASE: WRK.Test ? in Key Field is Question Mark
     C           WUTQKF    IFEQ '?'                        *IF
     C                     MOVEL#1PSCG    WUCUGR           Work Charge Gro
      * Call AOCUGRR0 - Standard Functions  *     *KEY
     C*
     C                     CALL 'AOCUGRR0'
     C           WUAPRC    PARM WUAPRC    UUAPRC  7        RETURN CDE
     C                     PARM '*KEY'    UUAPOP  7        OPTION
     C                     PARM WUCUGR    UUCUGR  2        CHARGE GROUP
     C           D@CUGR    PARM *BLANK    UUSDY            FORMAT
     C*
      * Check if selection was made
      * CASE: WRK.Access Pgm Return Code is No selection
     C           WUAPRC    IFEQ '*NOSEL'                   *IF
      * Send message 'Posn Settle not selected'
     C                     MOVEL'USR2594' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: *OTHERWISE
      * Move Position Settle Grp - Securities Clients  *
     C*
     C                     MOVE CGCUGR    #1PSCG
     C*
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#1PSCG    WUCUGR           Work Charge Gro
      * Call AOCUGRR0 - Standard Functions  *     *VERIFY
     C*
     C                     CALL 'AOCUGRR0'
     C           WUAPRC    PARM WUAPRC    UUAPRC  7        RETURN CDE
     C                     PARM '*VERIFY' UUAPOP  7        OPTION
     C                     PARM WUCUGR    UUCUGR  2        CHARGE GROUP
     C           D@CUGR    PARM *BLANK    UUSDY            FORMAT
     C*
      * Check access object return code
      * CASE: WRK.Access Pgm Return Code is *Normal
     C           WUAPRC    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1PSCG    ZA0016           Position Settl.
      * Send message 'Posn Settlement grp NF'
     C                     MOVEL'USR2595' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9948  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Classification is S, D or M.
      * CASE: DTL.Classification is S, D or M
     C           #1CLAS    IFEQ 'D'                        *IF
     C           #1CLAS    OREQ 'M'
     C           #1CLAS    OREQ 'S'
      * Setup message data for message
     C                     MOVEL#1PSCG    ZA0017           Position Settl.
      * Send message 'Posn Settle is required'
     C                     MOVEL'USR2596' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9948  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * End of S01496
      * Start of SAR S01212
      * 00/Copy Member SD0341RVSF - Securities Clients  *
     C*00/Copy Member SD0341R   Validate Detail Screen
     C/COPY WNCPYSRC,SD0341RVSF
      * End of SAR S01212
      * Check relations
      * Check reference to Account Codes
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9934  *
     C                     END
      * Check reference to Currency Codes
     C                     EXSR VDCKRL
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
      * Check reference to Currency Codes
     C                     EXSR VECKRL
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9933  *
     C                     END
      * Check reference to Alternate Names & Address
     C                     EXSR VFCKRL
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9939  *
     C                     END
      * CALC: Detail screen function fields
      * Start of SAR S01212
      * 00/Copy Member SD0341RSFF - Securities Clients  *
     C*00/Copy Member SD0341R   Calc Detail Function Flds
     C/COPY WNCPYSRC,SD0341RSFF
      * End of SAR S01212
      * USER: Validate detail screen relations
      * S01219 -  SE customer details enhancements
     C                     EXSR UASUBR                     S01219 -  SE cu
      * Check currency codes
      * Portfolio Currency Code
      * CASE: DTL.Classification is Equal to S or D
     C           #1CLAS    IFEQ 'D'                        *IF
     C           #1CLAS    OREQ 'S'
      * CASE: DTL.Portfolio currency code is blank
     C           #1PCYC    IFEQ *BLANK                     *IF
      * Get Base Currency - Bank Details  *
     C                     EXSR SYRVGN
     C                     MOVELWUCYCD    #1PCYC           Portfolio curre
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.Portfolio currency code is not blank
     C           #1PCYC    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1PCYC    ZA0026           Portfolio curre
      * Send message 'Portfolio currency'
     C                     MOVEL'USR0251' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Currency Code
      * CASE: DTL.Currency Code is not blank
     C           #1CYCD    IFNE *BLANK                     *IF
      * CASE: DTL.Classification is Check for portfolio curr.
     C           #1CLAS    IFEQ 'C'                        *IF
     C           #1CLAS    OREQ 'E'
     C           #1CLAS    OREQ 'I'
     C********** #1CLAS    OREQ 'K'                                                           CSE022
     C           #1CLAS    OREQ 'M'
     C           #1CLAS    OREQ 'X'
      * Setup message data for message
     C                     MOVEL#1CYCD    ZA0027           Currency Code
      * Send message 'Settlement currency'
     C                     MOVEL'USR0253' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Start of SAR S01117
      * Get dealing indicator - Currency Codes  *
     C                     EXSR SZRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#1CYCD    ZA0028           Currency Code
      * Send message 'Invalid settlement curr.'
     C                     MOVEL'USR0302' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.Dealing Currency Ind. is No
     C           WUDLCI    IFEQ 'N'                        *IF
      * Setup message data for message
     C                     MOVEL#1CYCD    ZA0029           Currency Code
      * Send message 'Invalid settlement curr.'
     C                     MOVEL'USR0302' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * End of SAR S01117
     C                     END                             *FI
     C                     END                             *FI
      * Check account code
      * Account Code
      * CASE: DTL.Account Code is Non-blank
     C           #1ACCD    IFNE *BLANK                     *IF
      * Start of SAR S01117
      * CASE: DTL.Classification is check for account code
     C           #1CLAS    IFEQ 'C'                        *IF
     C           #1CLAS    OREQ 'E'
     C           #1CLAS    OREQ 'I'
     C********** #1CLAS    OREQ 'K'                                                           CSE022
     C           #1CLAS    OREQ 'X'
      * Setup message data for message
     C                     MOVEL#1ACCD    ZA0030           Account Code
      * Send message 'Account code not allowed'
     C                     MOVEL'USR0254' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9934  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * retrieve type as well - Account Codes  *
     C                     EXSR TARVGN
      * CASE: WRK.Title Only Indicator is YES
     C           WUTOIN    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1ACCD    ZA0031           Account Code
      * Send message 'Account code mustn't be t'
     C                     MOVEL'USR0221' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9934  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * End of SAR S01117
     C                     END                             *FI
      * Check account sequence
      * Account Sequence
      * CASE: DTL.Account Code is blank
     C           #1ACCD    IFEQ *BLANK                     *IF
      * CASE: DTL.Sequence is Not Blank
     C           #DSQNC    IFNE *BLANK                     *IF
      * Start of 062786
     C                     Z-ADD*ZERO     #1ACSN           Account sequenc
      * End of 062786
      * Setup message data for message
     C                     MOVEL#DSQNC    ZA0032           Sequence
      * Send message 'Account sequence not all'
     C                     MOVEL'USR0255' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.Sequence is Blank
     C           #DSQNC    IFEQ *BLANK                     *IF
     C                     MOVEL'01'      #DSQNC           Sequence
     C                     Z-ADD01        #1ACSN           Account sequenc
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: *OTHERWISE
      * Start of SAR S01117
      * Check that the sequence number is numeric
      * ZALIGN Account Sequence - Securities Clients  *
     C                     MOVE #DSQNC    WUZASF
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0021  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0022 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0023  10       ZALIGN No Of De
     C                     PARM 2         WQ0024  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0025 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUERCD           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUERCD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0026 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0027  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * CASE: WRK.Err Code is Error Found
     C           WUERCD    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DSQNC    ZA0033           Sequence
      * Send message 'Field Not Numeric'
     C                     MOVEL'USR0822' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * MOVE ZASF to Sequence - Securities Clients  *
     C                     MOVE WUZASF    #DSQNC
     C                     MOVE WUZAFF    #1ACSN           Account sequenc
     C                     END                             *FI
      * End of SAR S01117
     C                     END                             *FI
     C                     END                             *FI
      * Check Alternative Name & Address
      * Alternate Names and Addresses
      * CASE: DTL.Address Code is Not blank
     C           #1ADCD    IFNE *BLANK                     *IF
      * Get Alt.Name & Address - Alternate Names & Address  *
     C                     EXSR TBRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#1ADCD    ZA0034           Address Code
      * Send message 'Invalid address code'
     C                     MOVEL'USR0303' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Check Cedel fungibility indicator
      * Cedel Fungability Indicator
      * CASE: DTL.Classification is Market
     C           #1CLAS    IFEQ 'M'                        *IF
      * CASE: DTL.Part./Non-part. 2 is Yes
     C           #1PNP2    IFEQ 'P'                        *IF
      * CASE: DTL.Cedel Fungibility ind. is Blank
     C           #1CFIN    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1CFIN    ZA0035           Cedel Fungibili
      * Send message 'Cedel Fung.Ind. mandatory'
     C                     MOVEL'USR0256' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9941  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Cedel Fungability Indicator
      * CASE: DTL.Classification is Cedel
     C           #1CLAS    IFEQ 'C'                        *IF
      * CASE: DTL.Cedel Fungibility ind. is Blank
     C           #1CFIN    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1CFIN    ZA0036           Cedel Fungibili
      * Send message 'Cedel fung ind mand DI=C'
     C                     MOVEL'USR0339' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9941  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Check statement frequency
      * start E25679
      * Allow frequency for Classifications I and M as well as S or D
      * Statement Frequency
      * CASE: DTL.Classification is Equal to I, M, S or D
     C           #1CLAS    IFEQ 'D'                        *IF
     C           #1CLAS    OREQ 'M'
     C           #1CLAS    OREQ 'S'
     C           #1CLAS    OREQ 'I'
      * remove default for statement frequency
      * end E25679
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.Statement frequency is not blank
     C           #1STFQ    IFEQ 'T'                        *IF
     C           #1STFQ    OREQ 'D'
     C           #1STFQ    OREQ 'F'
     C           #1STFQ    OREQ 'L'
     C           #1STFQ    OREQ 'B'
     C           #1STFQ    OREQ 'M'
     C           #1STFQ    OREQ 'A'
     C           #1STFQ    OREQ 'Z'
     C           #1STFQ    OREQ 'H'
     C           #1STFQ    OREQ 'P'
     C           #1STFQ    OREQ 'K'
     C           #1STFQ    OREQ 'G'
     C           #1STFQ    OREQ 'Q'
     C           #1STFQ    OREQ 'S'
     C           #1STFQ    OREQ 'X'
     C           #1STFQ    OREQ 'W'
     C           #1STFQ    OREQ 'Y'
     C           #1STFQ    OREQ 'R'
      * Setup message data for message
     C                     MOVEL#1STFQ    ZA0037           Statement frequ
      * Send message 'Stat. frequency not all.'
     C                     MOVEL'USR0257' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9936  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Check next statement date
      * Next Statement Date
      * CASE: DTL.ST next statement date is Not Blank
     C           #DSNSD    IFNE *BLANK                     *IF
      * Start of SAR S01117
      * CASE: DTL.Statement frequency is equal blank
     C           #1STFQ    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DSNSD    ZA0038           ST next stateme
      * Send message 'Next statement date N.A.'
     C                     MOVEL'USR0258' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE #DSNSD    WUWSDT           Work Screen Dat
      * Check Screen Date - Rundate  *
     C                     CALL 'ZDATE1'               90  Check Screen Da
     C           W0RTN     PARM W0RTN     WQ0028  7        *Return code
     C           WUWSDT    PARM WUWSDT    WQ0029  60       Work Screen Dat
     C           WUDFF     PARM WUDFF     WQ0030  1        Date format fla
     C           #1NSDT    PARM *ZERO     WQ0031  50       Work File Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZDATE1'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Date validation
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
      * Setup message data for message
     C                     MOVEL#DSNSD    ZA0039           ST next stateme
      * Send message 'Invalid Date'
     C                     MOVEL'USR0182' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.Next statement date LE WRK.Run day number
     C           #1NSDT    IFLE WURDNB                     *IF
      * Setup message data for message
     C                     MOVEL#DSNSD    ZA0040           ST next stateme
      * Send message 'Next statement date inv.'
     C                     MOVEL'USR0259' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #DSNSD           ST next stateme
     C                     MOVELWUWSDT    #DSNSD           ST next stateme
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * End of SAR S01117
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.Classification is Equal to S or D
     C           #1CLAS    IFEQ 'D'                        *IF
     C           #1CLAS    OREQ 'S'
      * Default stat. next date - Securities Clients  *
      * DATF: DATE FORMAT FLAG
      * URES: DATE TO WRITE TO DISK - SEE JB FOR PARAMETER PASSING
     C*********************MOVE #IAANA    RDATE                           S01229
     C*********************MOVE #IE3ST    DATF    1                       S01229
     C*********************MOVE #IMIRD    RDATE                           S01229
     C                     MOVE WUMRDT    RDATE                           S01229
     C                     MOVE WUSDFF    DATF    1                       S01229
      *
      ** 31-DAY MONTHS
      *
     C           MONTH     IFEQ 'JAN'
     C           MONTH     OREQ 'MAR'
     C           MONTH     OREQ 'MAY'
     C           MONTH     OREQ 'JUL'
     C           MONTH     OREQ 'AUG'
     C           MONTH     OREQ 'OCT'
     C           MONTH     OREQ 'DEC'
     C                     Z-ADD31        DAY2    20
     C                     END
      *
      ** 30-DAY MONTHS
      *
     C           MONTH     IFEQ 'APR'
     C           MONTH     OREQ 'JUN'
     C           MONTH     OREQ 'SEP'
     C           MONTH     OREQ 'NOV'
     C                     Z-ADD30        DAY2
     C                     END
      *
      ** FEBRUARY
      *
     C           MONTH     IFEQ 'FEB'
     C           YEAR      DIV  4         UWRK    20
     C                     MVR            ULEAP   10
      *
      ** LEAP YEAR PROCESSING: REMAINDER OF DIVISION IS 0
      *
     C           ULEAP     IFEQ 0
     C                     Z-ADD29        DAY2
     C                     ELSE
     C                     Z-ADD28        DAY2
     C                     END
     C                     END
      *
      ** MOVE DATE INTO CORRECT FORMAT FOR ZDATE ROUTINE
      *
     C                     Z-ADD1         UX      20
     C           MONTH     LOKUPZMNM,UX                  90
      *
      ** SET UP ZDATE PARAMETER USING DATE FORMAT FLAG
      *
      ** MMDDYY
      *
     C           DATF      IFEQ 'M'
     C                     MOVE DAY2      UZDT4   40
     C                     MOVELUX        UZDT4
     C                     MOVELUZDT4     UZDT    60
     C           YEARC     IFEQ *BLANK
     C                     MOVE *ZEROS    YEAR
     C                     END
     C                     MOVE YEAR      UZDT
      *
     C                     ELSE
      *
      ** DDMMYY
      *
     C                     MOVELDAY2      UZDT4   40
     C                     MOVE UX        UZDT4
     C                     MOVELUZDT4     UZDT    60
     C           YEARC     IFEQ *BLANK
     C                     MOVE *ZEROS    YEAR
     C                     END
     C                     MOVE YEAR      UZDT
     C                     END
      *
     C                     CALL 'ZDATE1'
     C                     PARM           ZERR    7
     C                     PARM           UZDT
     C                     PARM           DATF
     C                     PARM           URES    50
     C*********************MOVE URES      #OGINB                          S01229
     C*********************MOVE URES      #ONVDT                          S01229
     C                     MOVE URES      #1NSDT                          S01229
      *
      * Start of SAR S01117
      * Defaulting was incorrect - was being defaulted as a run day
      * number
      * Check File Date - Rundate  *
     C                     CALL 'ZDATE2'               90  Check File Date
     C                     PARM #1NSDT    WQ0032  50       Work Midas Date
     C                     PARM WUDFF     WQ0033  1        Date format fla
     C           WUWCDT    PARM *ZERO     WQ0034  60       Work Converted
     C           WUWADT    PARM *BLANK    WQ0035  7        Work Alpha Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZDATE2'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     MOVEL*BLANK    #DSNSD           ST next stateme
     C                     MOVELWUWCDT    #DSNSD           ST next stateme
     C                     MOVEL'Y'       W0DCF            *Defer confirm
      * End of SAR S01117
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     #1NSDT           Next statement
     C                     MOVEL*BLANK    #DSNSD           ST next stateme
     C                     END                             *FI
     C                     END                             *FI
      * Check statement base date
      * Statement Base Date
      * CASE: DTL.Statement Base Day Screen is Blank
     C           #DSTBD    IFEQ *BLANK                     *IF
      * CASE: DTL.Statement frequency is L,M,Q,R,S,T,X,Y
     C           #1STFQ    IFEQ 'T'                        *IF
     C           #1STFQ    OREQ 'L'
     C           #1STFQ    OREQ 'M'
     C           #1STFQ    OREQ 'Q'
     C           #1STFQ    OREQ 'S'
     C           #1STFQ    OREQ 'X'
     C           #1STFQ    OREQ 'Y'
     C           #1STFQ    OREQ 'R'
      * start E25679
      * Default Statement base date if frequency is L,M,Q,R,S,T,X or Y
      * Frequency only allowed for Classification I, M, S or D,
      * so remove Case statement to check Classification
     C                     Z-ADD31        #1SBDM           Stat.Base Date
     C                     MOVEL'31'      #DSTBD           Statement Base
      * end E25679
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     #1SBDM           Stat.Base Date
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.Statement frequency is Not L,M,Q,R,S,T.X,Y
     C           #1STFQ    IFEQ 'D'                        *IF
     C           #1STFQ    OREQ *BLANK
     C           #1STFQ    OREQ 'F'
     C           #1STFQ    OREQ 'B'
     C           #1STFQ    OREQ 'A'
     C           #1STFQ    OREQ 'Z'
     C           #1STFQ    OREQ 'H'
     C           #1STFQ    OREQ 'P'
     C           #1STFQ    OREQ 'K'
     C           #1STFQ    OREQ 'G'
     C           #1STFQ    OREQ 'W'
      * Setup message data for message
     C                     MOVEL#DSTBD    ZA0041           Statement Base
      * Send message 'Stat. Base Date not all.'
     C                     MOVEL'USR0262' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9938  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Start of SAR S01117
      * Check that the day number is numeric
      * ZALIGN Statement Base Day - Securities Clients  *
     C                     MOVE #DSTBD    WUZASF
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0036  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0037 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0038  10       ZALIGN No Of De
     C                     PARM 2         WQ0039  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0040 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUERCD           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUERCD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0041 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0042  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * CASE: WRK.Err Code is Error Found
     C           WUERCD    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DSTBD    ZA0042           Statement Base
      * Send message 'Field Not Numeric'
     C                     MOVEL'USR0822' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9938  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUZAFF    #1SBDM           Stat.Base Date
      * MOVE ZASF to State Base D - Securities Clients  *
     C                     MOVE WUZASF    #DSTBD
      * CASE: DTL.Stat.Base Date in Month is Valid number
     C           #1SBDM    IFGE 1                          *IF
     C           #1SBDM    ANDLE31
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DSTBD    ZA0043           Statement Base
      * Send message 'Stat Base Day Invalid'
     C                     MOVEL'USR1497' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9938  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * End of SAR S01117
     C                     END                             *FI
     C                     END                             *FI
      * Default Pledge Agreement
      * Pledge Agreement
      * CASE: DTL.Pledge Agreement is blank
     C           #1PLAG    IFEQ *BLANK                     *IF
     C                     MOVEL'N'       #1PLAG           Pledge Agreemen
     C                     END                             *FI
      * Check Tax Code
      * 00/Copy Member SD0341RC01 - Securities Clients  *
     C/COPY WNCPYSRC,SD0341RC01
      * Tax Code
      * CASE: DTL.Tax Code is Not blank
     C           #1TCD     IFNE *BLANK                     *IF
     C                     MOVEL#1TCD     WUCCOM           Charge/Commissi
      * Get Charge Code - Charge Types Detail Physi  *
     C                     EXSR TCRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#1TCD     ZA0044           Tax Code
      * Send message 'Invalid tax code'
     C                     MOVEL'USR0279' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9943  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * 00/Copy Member SD0341RC02 - Securities Clients  *
     C/COPY WNCPYSRC,SD0341RC02
      * Default Auto-Settle Indicator
      * Auto-settle indicator
      * CASE: DTL.Auto-Settle Indicator is Blank
     C           #1ASIN    IFEQ *BLANK                     *IF
     C                     MOVEL'N'       #1ASIN           Auto-Settle Ind
     C                     END                             *FI
      * Check Depots
      * Classification is E
      * Classification is E
      * CASE: DTL.Classification is Euroclear
     C           #1CLAS    IFEQ 'E'                        *IF
      * Start of Fix E18371
      * Start of SAR S01190
      * CASE: DTL.Depot 1 is Not blank
     C           #DDP01    IFNE *BLANK                     *IF
      * Start of SAR S01219
      * CASE: DTL.Depot Reference 1 is Not blank
     C           #1DRF1    IFNE *BLANK                     *IF
      * Get rid of trailing blank - Securities Clients  * S01219
     C*                                                                   S01219
     C*********************MOVE #BCQTX    USER1A  1                S01219 S01229
     C                     MOVE #1DRF1    USER1A  1                S01219 S01229
     C           USER1A    IFEQ *BLANK                                    S01219
     C*********************MOVEL#BCQTX    USER5A  5                S01219 S01229
     C                     MOVEL#1DRF1    USER5A  5                S01219 S01229
     C*********************MOVE *BLANK    #BCQTX                   S01219 S01229
     C                     MOVE *BLANK    #1DRF1                   S01219 S01229
     C*********************MOVE USER5A    #BCQTX                   S01219 S01229
     C                     MOVE USER5A    #1DRF1                   S01219 S01229
     C                     END                                            S01219
     C*                                                                   S01219
      * Check Euroclear Range - Securities Clients  * S01219
     C*                                                                   S01219
     C*********************MOVE 'N'       #OMLTS                          S01229
     C                     MOVE 'N'       WUVLRG                          S01229
     C*********************MOVE #ICPTX    DEP1A                    S01219 S01229
     C                     MOVE #1DRF1    DEP1A                    S01219 S01229
     C*                                                                   S01219
     C********** DEP1N     IFGE 90000                              S01219 161659
     C********** DEP1N     ANDLE99999                              S01219 161659
     C*********************MOVE 'Y'       #OMLTS                   S01219 S01229
     C**********           MOVE 'Y'       WUVLRG                   S01229 161659
     C**********           END                                     S01219 161659
     C*                                                                   S01219
     C********** DEP1N     IFGE 60000                              S01219 161659
     C********** DEP1N     ANDLE69999                              S01219 161659
     C*********************MOVE 'Y'       #OMLTS                   S01219 S01229
     C**********           MOVE 'Y'       WUVLRG                   S01229 161659
     C**********           END                                     S01219 161659
     C*                                                                   S01219
     C                     END                             *FI
      * End of SAR S01219
      **CASE:*WRK.Valid*Range*is*No                                       161659
     C********** WUVLRG    IFEQ 'N'                        *IF            161659
      **Setup*message*data*for*message                                    161659
     C**********           MOVEL#1DRF1    ZA0045           Depot Reference161659
      **Send*message*'Invalid*reference*at*E/C'                           161659
     C**********           MOVEL'USR0263' ZAMSID                          161659
     C**********           EXSR ZASNMS                                    161659
     C**********           SETON                     9950  *              161659
      **********                                                          161659
     C**********           END                             *FI            161659
     C                     END                             *FI
      * CASE: DTL.Depot 1 is Not blank
     C           #DDP01    IFNE *BLANK                     *IF
      * Start of SAR S01219
      * CASE: DTL.Depot Reference 1 is Not blank
     C           #1DRF1    IFNE *BLANK                     *IF
      * Get rid of trailing blank - Securities Clients  * S01219
     C*                                                                   S01219
     C*********************MOVE #BCQTX    USER1A  1                S01219 S01229
     C                     MOVE #1DRF1    USER1A  1                S01219 S01229
     C           USER1A    IFEQ *BLANK                                    S01219
     C*********************MOVEL#BCQTX    USER5A  5                S01219 S01229
     C                     MOVEL#1DRF1    USER5A  5                S01219 S01229
     C*********************MOVE *BLANK    #BCQTX                   S01219 S01229
     C                     MOVE *BLANK    #1DRF1                   S01219 S01229
     C*********************MOVE USER5A    #BCQTX                   S01219 S01229
     C                     MOVE USER5A    #1DRF1                   S01219 S01229
     C                     END                                            S01219
     C*                                                                   S01219
      * Check Euroclear Range - Securities Clients  * S01219
     C*                                                                   S01219
     C*********************MOVE 'N'       #OMLTS                          S01229
     C                     MOVE 'N'       WUVLRG                          S01229
     C*********************MOVE #ICPTX    DEP1A                    S01219 S01229
     C                     MOVE #1DRF1    DEP1A                    S01219 S01229
     C*                                                                   S01219
     C********** DEP1N     IFGE 90000                              S01219 161659
     C********** DEP1N     ANDLE99999                              S01219 161659
     C*********************MOVE 'Y'       #OMLTS                   S01219 S01229
     C**********           MOVE 'Y'       WUVLRG                   S01229 161659
     C**********           END                                     S01219 161659
     C*                                                                   S01219
     C********** DEP1N     IFGE 60000                              S01219 161659
     C********** DEP1N     ANDLE69999                              S01219 161659
     C*********************MOVE 'Y'       #OMLTS                   S01219 S01229
     C**********           MOVE 'Y'       WUVLRG                   S01229 161659
     C**********           END                                     S01219 161659
     C*                                                                   S01219
     C                     END                             *FI
      * End of SAR S01219
      **CASE:*WRK.Valid*Range*is*No                                       161659
     C********** WUVLRG    IFEQ 'N'                        *IF            161659
      **Setup*message*data*for*message                                    161659
     C**********           MOVEL#1DRF1    ZA0046           Depot Reference161659
      **Send*message*'Invalid*reference*at*E/C'                           161659
     C**********           MOVEL'USR0263' ZAMSID                          161659
     C**********           EXSR ZASNMS                                    161659
     C**********           SETON                     9950  *              161659
      **********                                                          161659
     C**********           END                             *FI            161659
     C                     END                             *FI
      * End of SAR S01190
      * End of Fix E18371
      * CASE: DTL.Depot Reference 2 is Not blank
     C           #1DRF2    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1DRF2    ZA0047           Depot Reference
      * Send message 'Entry not allowed (Depot)'
     C                     MOVEL'USR0264' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9952  *
      *
     C                     END                             *FI
      * CASE: DTL.Depot Reference 3 is Not blank
     C           #1DRF3    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1DRF3    ZA0048           Depot Reference
      * Send message 'Entry not allowed (Depot)'
     C                     MOVEL'USR0264' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9954  *
      *
     C                     END                             *FI
      * CASE: DTL.Depot Reference 4 is Not blank
     C           #1DRF4    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1DRF4    ZA0049           Depot Reference
      * Send message 'Entry not allowed (Depot)'
     C                     MOVEL'USR0264' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9956  *
      *
     C                     END                             *FI
      * CASE: DTL.Depot Reference 5 is Not blank
     C           #1DRF5    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1DRF5    ZA0050           Depot Reference
      * Send message 'Entry not allowed (Depot)'
     C                     MOVEL'USR0264' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9958  *
      *
     C                     END                             *FI
      * CASE: DTL.Depot Reference 6 is Not blank
     C           #1DRF6    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1DRF6    ZA0051           Depot Reference
      * Send message 'Entry not allowed (Depot)'
     C                     MOVEL'USR0264' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9960  *
      *
     C                     END                             *FI
      * CASE: DTL.Depot Reference 7 is Not blank
     C           #1DRF7    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1DRF7    ZA0052           Depot Reference
      * Send message 'Entry not allowed (Depot)'
     C                     MOVEL'USR0264' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9962  *
      *
     C                     END                             *FI
      * CASE: DTL.Depot Reference 8 is Not blank
     C           #1DRF8    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1DRF8    ZA0053           Depot Reference
      * Send message 'Entry not allowed (Depot)'
     C                     MOVEL'USR0264' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9964  *
      *
     C                     END                             *FI
      * CASE: DTL.Depot Reference 9 is Not blank
     C           #1DRF9    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1DRF9    ZA0054           Depot Reference
      * Send message 'Entry not allowed (Depot)'
     C                     MOVEL'USR0264' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9966  *
      *
     C                     END                             *FI
      * CASE: DTL.Depot Reference 10 is Not blank
     C           #1DRF0    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1DRF0    ZA0055           Depot Reference
      * Send message 'Entry not allowed (Depot)'
     C                     MOVEL'USR0264' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9968  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Classification is M or X
      * Classification is M or X
      * CASE: DTL.Classification is M or X
     C           #1CLAS    IFEQ 'X'                        *IF
     C           #1CLAS    OREQ 'M'
      * CASE: DTL.Depot Reference 1 is Not blank
     C           #1DRF1    IFNE *BLANK                     *IF
      * Start of SAR S01190
      * Start of SAR S01219
      * Get rid of trailing blank - Securities Clients  * S01219
     C*                                                                   S01219
     C*********************MOVE #BCQTX    USER1A  1                S01219 S01229
     C                     MOVE #1DRF1    USER1A  1                S01219 S01229
     C           USER1A    IFEQ *BLANK                                    S01219
     C*********************MOVEL#BCQTX    USER5A  5                S01219 S01229
     C                     MOVEL#1DRF1    USER5A  5                S01219 S01229
     C*********************MOVE *BLANK    #BCQTX                   S01219 S01229
     C                     MOVE *BLANK    #1DRF1                   S01219 S01229
     C*********************MOVE USER5A    #BCQTX                   S01219 S01229
     C                     MOVE USER5A    #1DRF1                   S01219 S01229
     C                     END                                            S01219
     C*                                                                   S01219
      * Check Euroclear Range - Securities Clients  * S01219
     C*                                                                   S01219
     C*********************MOVE 'N'       #OMLTS                          S01229
     C                     MOVE 'N'       WUVLRG                          S01229
     C*********************MOVE #ICPTX    DEP1A                    S01219 S01229
     C                     MOVE #1DRF1    DEP1A                    S01219 S01229
     C*                                                                   S01219
     C********** DEP1N     IFGE 90000                              S01219 161659
     C********** DEP1N     ANDLE99999                              S01219 161659
     C*********************MOVE 'Y'       #OMLTS                   S01219 S01229
     C**********           MOVE 'Y'       WUVLRG                   S01229 161659
     C**********           END                                     S01219 161659
     C*                                                                   S01219
     C********** DEP1N     IFGE 60000                              S01219 161659
     C********** DEP1N     ANDLE69999                              S01219 161659
     C*********************MOVE 'Y'       #OMLTS                   S01219 S01229
     C**********           MOVE 'Y'       WUVLRG                   S01229 161659
     C**********           END                                     S01219 161659
     C*                                                                   S01219
      * End of SAR S01219
      **CASE:*WRK.Valid Range*is*No                                       161659
     C********** WUVLRG    IFEQ 'N'                        *IF            161659
      **Setup*message*data*for*message                                    161659
     C**********           MOVEL#1DRF1    ZA0056           Depot Reference161659
      **Send*message*'Invalid*reference*at*E/C'                           161659
     C**********           MOVEL'USR0263' ZAMSID                          161659
     C**********           EXSR ZASNMS                                    161659
     C**********           SETON                     9950  *              161659
      **********                                                          161659
     C**********           END                             *FI            161659
      * End of SAR S01190
     C                     END                             *FI
      * CASE: DTL.Depot Reference 2 is Not blank
     C           #1DRF2    IFNE *BLANK                     *IF
      * Start of SAR S01219
      * Get rid of trailing blank - Securities Clients  * S01219
     C*                                                                   S01219
     C*********************MOVE #BCQTX    USER1A  1                S01219 S01229
     C                     MOVE #1DRF2    USER1A  1                S01219 S01229
     C           USER1A    IFEQ *BLANK                                    S01219
     C*********************MOVEL#BCQTX    USER5A  5                S01219 S01229
     C                     MOVEL#1DRF2    USER5A  5                S01219 S01229
     C*********************MOVE *BLANK    #BCQTX                   S01219 S01229
     C                     MOVE *BLANK    #1DRF2                   S01219 S01229
     C*********************MOVE USER5A    #BCQTX                   S01219 S01229
     C                     MOVE USER5A    #1DRF2                   S01219 S01229
     C                     END                                            S01219
     C*                                                                   S01219
      * Check range 00001-99999 - Securities Clients  * S01219
     C*                                                                   S01219
     C*********************MOVE #ICQTX    DEP2A                    S01219 S01229
     C                     MOVE #1DRF2    DEP2A                    S01219 S01229
     C           DEP2N     IFLT 1                                         S01219
     C           DEP2N     ORGT 99999                                     S01219
     C*********************MOVE 'E'       #OMXST                   S01219 S01229
     C                     MOVE 'E'       WUWTRG                   S01219 S01229
     C                     END                                            S01219
      * CASE: WRK.Within Range 00001-99999 is Error
     C           WUWTRG    IFEQ 'E'                        *IF
      * Setup message data for message
     C                     MOVEL#1DRF2    ZA0057           Depot Reference
      * Send message 'Invalid reference at cedl'
     C                     MOVEL'USR0626' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9952  *
      *
     C                     MOVEL*BLANK    WUWTRG           Within Range 00
     C                     END                             *FI
      * End of SAR S01219
      * Start of 045112
      * Remove check modulus on CEDEL
      * End of 045112
     C                     END                             *FI
     C                     END                             *FI
      * Classification is S,D or I
      * Classification is S,D or I
      * CASE: DTL.Classification is Equal to I, D or S
     C           #1CLAS    IFEQ 'D'                        *IF
     C           #1CLAS    OREQ 'I'
     C           #1CLAS    OREQ 'S'
      * CASE: DTL.Depot Reference 1 is Not blank
     C           #1DRF1    IFNE *BLANK                     *IF
     C                     MOVEL#1DRF1    WUWCUS           Workfield on cu
      * Retrieve classification - Securities Clients  *
     C                     EXSR TDRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#1DRF1    ZA0058           Depot Reference
      * Send message 'Invalid depot reference'
     C                     MOVEL'USR0268' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9950  *
      *
     C                     END                             *FI
      * CASE: WRK.Classification is Euroclear
     C           WUCLAS    IFEQ 'E'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1DRF1    ZA0059           Depot Reference
      * Send message 'Invalid depot reference'
     C                     MOVEL'USR0268' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9950  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DTL.Depot Reference 2 is Not blank
     C           #1DRF2    IFNE *BLANK                     *IF
     C                     MOVEL#1DRF2    WUWCUS           Workfield on cu
      * Retrieve classification - Securities Clients  *
     C                     EXSR TERVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#1DRF2    ZA0060           Depot Reference
      * Send message 'Invalid depot reference'
     C                     MOVEL'USR0268' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9952  *
      *
     C                     END                             *FI
      * CASE: WRK.Classification is Cedel
     C           WUCLAS    IFEQ 'C'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1DRF2    ZA0061           Depot Reference
      * Send message 'Invalid depot reference'
     C                     MOVEL'USR0268' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9952  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DTL.Depot Reference 3 is Not blank
     C           #1DRF3    IFNE *BLANK                     *IF
     C                     MOVEL#1DRF3    WUWCUS           Workfield on cu
      * Retrieve classification - Securities Clients  *
     C                     EXSR TFRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#1DRF3    ZA0062           Depot Reference
      * Send message 'Invalid depot reference'
     C                     MOVEL'USR0268' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9954  *
      *
     C                     END                             *FI
      **CASE:*WRK.Classification*is*Kassenverein***********************                       CSE022
     C********** WUCLAS    IFEQ 'K'                        *IF                                CSE022
     C**********           ELSE                                                               CSE022
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1DRF3    ZA0063           Depot Reference
      * Send message 'Invalid depot reference'
     C                     MOVEL'USR0268' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9954  *
      *
     C**********           END                             *FI                                CSE022
     C                     END                             *FI
      * CASE: DTL.Depot Reference 4 is Not blank
     C           #1DRF4    IFNE *BLANK                     *IF
     C                     MOVEL#1DRF4    WUWCUS           Workfield on cu
      * Retrieve classification - Securities Clients  *
     C                     EXSR TGRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#1DRF4    ZA0064           Depot Reference
      * Send message 'Invalid depot reference'
     C                     MOVEL'USR0268' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9956  *
      *
     C                     END                             *FI
      * CASE: WRK.Classification is Depot
     C           WUCLAS    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1DRF4    ZA0065           Depot Reference
      * Send message 'Invalid depot reference'
     C                     MOVEL'USR0268' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9956  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DTL.Depot Reference 5 is Not blank
     C           #1DRF5    IFNE *BLANK                     *IF
     C                     MOVEL#1DRF5    WUWCUS           Workfield on cu
      * Retrieve classification - Securities Clients  *
     C                     EXSR THRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#1DRF5    ZA0066           Depot Reference
      * Send message 'Invalid depot reference'
     C                     MOVEL'USR0268' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9958  *
      *
     C                     END                             *FI
      * CASE: WRK.Classification is Depot
     C           WUCLAS    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1DRF5    ZA0067           Depot Reference
      * Send message 'Invalid depot reference'
     C                     MOVEL'USR0268' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9958  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DTL.Depot Reference 6 is Not blank
     C           #1DRF6    IFNE *BLANK                     *IF
     C                     MOVEL#1DRF6    WUWCUS           Workfield on cu
      * Retrieve classification - Securities Clients  *
     C                     EXSR TIRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#1DRF6    ZA0068           Depot Reference
      * Send message 'Invalid depot reference'
     C                     MOVEL'USR0268' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9960  *
      *
     C                     END                             *FI
      * CASE: WRK.Classification is Depot
     C           WUCLAS    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1DRF6    ZA0069           Depot Reference
      * Send message 'Invalid depot reference'
     C                     MOVEL'USR0268' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9960  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DTL.Depot Reference 7 is Not blank
     C           #1DRF7    IFNE *BLANK                     *IF
     C                     MOVEL#1DRF7    WUWCUS           Workfield on cu
      * Retrieve classification - Securities Clients  *
     C                     EXSR TJRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#1DRF7    ZA0070           Depot Reference
      * Send message 'Invalid depot reference'
     C                     MOVEL'USR0268' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9962  *
      *
     C                     END                             *FI
      * CASE: WRK.Classification is Depot
     C           WUCLAS    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1DRF7    ZA0071           Depot Reference
      * Send message 'Invalid depot reference'
     C                     MOVEL'USR0268' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9962  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DTL.Depot Reference 8 is Not blank
     C           #1DRF8    IFNE *BLANK                     *IF
     C                     MOVEL#1DRF8    WUWCUS           Workfield on cu
      * Retrieve classification - Securities Clients  *
     C                     EXSR TKRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#1DRF8    ZA0072           Depot Reference
      * Send message 'Invalid depot reference'
     C                     MOVEL'USR0268' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9964  *
      *
     C                     END                             *FI
      * CASE: WRK.Classification is Depot
     C           WUCLAS    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1DRF8    ZA0073           Depot Reference
      * Send message 'Invalid depot reference'
     C                     MOVEL'USR0268' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9964  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DTL.Depot Reference 9 is Not blank
     C           #1DRF9    IFNE *BLANK                     *IF
     C                     MOVEL#1DRF9    WUWCUS           Workfield on cu
      * Retrieve classification - Securities Clients  *
     C                     EXSR TLRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#1DRF9    ZA0074           Depot Reference
      * Send message 'Invalid depot reference'
     C                     MOVEL'USR0268' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9966  *
      *
     C                     END                             *FI
      * CASE: WRK.Classification is Depot
     C           WUCLAS    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1DRF9    ZA0075           Depot Reference
      * Send message 'Invalid depot reference'
     C                     MOVEL'USR0268' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9966  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DTL.Depot Reference 10 is Not blank
     C           #1DRF0    IFNE *BLANK                     *IF
     C                     MOVEL#1DRF0    WUWCUS           Workfield on cu
      * Retrieve classification - Securities Clients  *
     C                     EXSR TMRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#1DRF0    ZA0076           Depot Reference
      * Send message 'Invalid depot reference'
     C                     MOVEL'USR0268' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9968  *
      *
     C                     END                             *FI
      * CASE: WRK.Classification is Depot
     C           WUCLAS    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1DRF0    ZA0077           Depot Reference
      * Send message 'Invalid depot reference'
     C                     MOVEL'USR0268' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9968  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Classification is C
      * Classification is C
      * CASE: DTL.Classification is Cedel
     C           #1CLAS    IFEQ 'C'                        *IF
      * Start of Fix E18371
      * CASE: DTL.Depot 2 is Not blank
     C           #DDP02    IFNE *BLANK                     *IF
      * CASE: DTL.Depot Reference 2 is Blank
     C           #1DRF2    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1DRF2    ZA0078           Depot Reference
      * Send message 'Value required (depot ref'
     C                     MOVEL'USR0317' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9952  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * End of Fix E18371
      * CASE: DTL.Depot Reference 2 is Not blank
     C           #1DRF2    IFNE *BLANK                     *IF
      * Start of SAR S01219
      * Get rid of trailing blank - Securities Clients  * S01219
     C*                                                                   S01219
     C*********************MOVE #BCQTX    USER1A  1                S01219 S01229
     C                     MOVE #1DRF2    USER1A  1                S01219 S01229
     C           USER1A    IFEQ *BLANK                                    S01219
     C*********************MOVEL#BCQTX    USER5A  5                S01219 S01229
     C                     MOVEL#1DRF2    USER5A  5                S01219 S01229
     C*********************MOVE *BLANK    #BCQTX                   S01219 S01229
     C                     MOVE *BLANK    #1DRF2                   S01219 S01229
     C*********************MOVE USER5A    #BCQTX                   S01219 S01229
     C                     MOVE USER5A    #1DRF2                   S01219 S01229
     C                     END                                            S01219
     C*                                                                   S01219
      * Check range 00001-99999 - Securities Clients  * S01219
     C*                                                                   S01219
     C*********************MOVE #ICQTX    DEP2A                    S01219 S01229
     C                     MOVE #1DRF2    DEP2A                    S01219 S01229
     C           DEP2N     IFLT 1                                         S01219
     C           DEP2N     ORGT 99999                                     S01219
     C*********************MOVE 'E'       #OMXST                   S01219 S01229
     C                     MOVE 'E'       WUWTRG                   S01219 S01229
     C                     END                                            S01219
      * CASE: WRK.Within Range 00001-99999 is Error
     C           WUWTRG    IFEQ 'E'                        *IF
      * Setup message data for message
     C                     MOVEL#1DRF2    ZA0079           Depot Reference
      * Send message 'Invalid reference at cedl'
     C                     MOVEL'USR0626' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9952  *
      *
     C                     MOVEL*BLANK    WUWTRG           Within Range 00
     C                     END                             *FI
      * End of SAR S01219
      * Start of 045112
      * Remove check modulus on CEDEL
      * End of 045112
     C                     END                             *FI
      * CASE: DTL.Depot Reference 1 is Not blank
     C           #1DRF1    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1DRF1    ZA0080           Depot Reference
      * Send message 'Entry not allowed (Depot)'
     C                     MOVEL'USR0264' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9950  *
      *
     C                     END                             *FI
      * CASE: DTL.Depot Reference 3 is Not blank
     C           #1DRF3    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1DRF3    ZA0081           Depot Reference
      * Send message 'Entry not allowed (Depot)'
     C                     MOVEL'USR0264' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9954  *
      *
     C                     END                             *FI
      * CASE: DTL.Depot Reference 4 is Not blank
     C           #1DRF4    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1DRF4    ZA0082           Depot Reference
      * Send message 'Entry not allowed (Depot)'
     C                     MOVEL'USR0264' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9956  *
      *
     C                     END                             *FI
      * CASE: DTL.Depot Reference 5 is Not blank
     C           #1DRF5    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1DRF5    ZA0083           Depot Reference
      * Send message 'Entry not allowed (Depot)'
     C                     MOVEL'USR0264' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9958  *
      *
     C                     END                             *FI
      * CASE: DTL.Depot Reference 6 is Not blank
     C           #1DRF6    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1DRF6    ZA0084           Depot Reference
      * Send message 'Entry not allowed (Depot)'
     C                     MOVEL'USR0264' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9960  *
      *
     C                     END                             *FI
      * CASE: DTL.Depot Reference 7 is Not blank
     C           #1DRF7    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1DRF7    ZA0085           Depot Reference
      * Send message 'Entry not allowed (Depot)'
     C                     MOVEL'USR0264' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9962  *
      *
     C                     END                             *FI
      * CASE: DTL.Depot Reference 8 is Not blank
     C           #1DRF8    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1DRF8    ZA0086           Depot Reference
      * Send message 'Entry not allowed (Depot)'
     C                     MOVEL'USR0264' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9964  *
      *
     C                     END                             *FI
      * CASE: DTL.Depot Reference 9 is Not blank
     C           #1DRF9    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1DRF9    ZA0087           Depot Reference
      * Send message 'Entry not allowed (Depot)'
     C                     MOVEL'USR0264' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9966  *
      *
     C                     END                             *FI
      * CASE: DTL.Depot Reference 10 is Not blank
     C           #1DRF0    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1DRF0    ZA0088           Depot Reference
      * Send message 'Entry not allowed (Depot)'
     C                     MOVEL'USR0264' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9968  *
      *
     C                     END                             *FI
     C                     END                             *FI
      **Classification*is*K********************************************                       CSE022
      **Classification*is*K********************************************                       CSE022
      **CASE:*DTL.Classification*is*Kassenverein***********************                       CSE022
     C********** #1CLAS    IFEQ 'K'                        *IF                                CSE022
      **CASE:*DTL.Depot*Reference*1*is*Not*blank***********************                       CSE022
     C********** #1DRF1    IFNE *BLANK                     *IF                                CSE022
      **Setup*message*data*for*message*********************************                       CSE022
     C**********           MOVEL#1DRF1    ZA0089           Depot Reference                    CSE022
      **Send*message*'Entry*not*allowed*(Depot)'***********************                       CSE022
     C**********           MOVEL'USR0264' ZAMSID                                              CSE022
     C**********           EXSR ZASNMS                                                        CSE022
     C**********           SETON                     9950  *                                  CSE022
      **********                                                                              CSE022
     C**********           END                             *FI                                CSE022
      **CASE:*DTL.Depot*Reference*2*is*Not*blank***********************                       CSE022
     C********** #1DRF2    IFNE *BLANK                     *IF                                CSE022
      **Setup*message*data*for*message*********************************                       CSE022
     C**********           MOVEL#1DRF2    ZA0090           Depot Reference                    CSE022
      **Send*message*'Entry*not*allowed*(Depot)'***********************                       CSE022
     C**********           MOVEL'USR0264' ZAMSID                                              CSE022
     C**********           EXSR ZASNMS                                                        CSE022
     C**********           SETON                     9952  *                                  CSE022
      **********                                                                              CSE022
     C**********           END                             *FI                                CSE022
      **CASE:*DTL.Depot*Reference*4*is*Not*blank***********************                       CSE022
     C********** #1DRF4    IFNE *BLANK                     *IF                                CSE022
      **Setup*message*data*for*message*********************************                       CSE022
     C**********           MOVEL#1DRF4    ZA0091           Depot Reference                    CSE022
      **Send*message*'Entry*not*allowed*(Depot)'***********************                       CSE022
     C**********           MOVEL'USR0264' ZAMSID                                              CSE022
     C**********           EXSR ZASNMS                                                        CSE022
     C**********           SETON                     9956  *                                  CSE022
      **********                                                                              CSE022
     C**********           END                             *FI                                CSE022
      **CASE:*DTL.Depot*Reference*5*is*Not*blank***********************                       CSE022
     C********** #1DRF5    IFNE *BLANK                     *IF                                CSE022
      **Setup*message*data*for*message*********************************                       CSE022
     C**********           MOVEL#1DRF5    ZA0092           Depot Reference                    CSE022
      **Send*message*'Entry*not*allowed*(Depot)'***********************                       CSE022
     C**********           MOVEL'USR0264' ZAMSID                                              CSE022
     C**********           EXSR ZASNMS                                                        CSE022
     C**********           SETON                     9958  *                                  CSE022
      **********                                                                              CSE022
     C**********           END                             *FI                                CSE022
      **CASE:*DTL.Depot*Reference*6*is*Not*blank***********************                       CSE022
     C********** #1DRF6    IFNE *BLANK                     *IF                                CSE022
      **Setup*message*data*for*message*********************************                       CSE022
     C**********           MOVEL#1DRF6    ZA0093           Depot Reference                    CSE022
      **Send*message*'Entry*not*allowed*(Depot)'***********************                       CSE022
     C**********           MOVEL'USR0264' ZAMSID                                              CSE022
     C**********           EXSR ZASNMS                                                        CSE022
     C**********           SETON                     9960  *                                  CSE022
      **********                                                                              CSE022
     C**********           END                             *FI                                CSE022
      **CASE:*DTL.Depot*Reference*7*is*Not*blank***********************                       CSE022
     C********** #1DRF7    IFNE *BLANK                     *IF                                CSE022
      **Setup*message*data*for*message*********************************                       CSE022
     C**********           MOVEL#1DRF7    ZA0094           Depot Reference                    CSE022
      **Send*message*'Entry*not*allowed*(Depot)'***********************                       CSE022
     C**********           MOVEL'USR0264' ZAMSID                                              CSE022
     C**********           EXSR ZASNMS                                                        CSE022
     C**********           SETON                     9962  *                                  CSE022
      **********                                                                              CSE022
     C**********           END                             *FI                                CSE022
      **CASE:*DTL.Depot*Reference*8*is*Not*blank***********************                       CSE022
     C********** #1DRF8    IFNE *BLANK                     *IF                                CSE022
      **Setup*message*data*for*message*********************************                       CSE022
     C**********           MOVEL#1DRF8    ZA0095           Depot Reference                    CSE022
      **Send*message*'Entry*not*allowed*(Depot)'***********************                       CSE022
     C**********           MOVEL'USR0264' ZAMSID                                              CSE022
     C**********           EXSR ZASNMS                                                        CSE022
     C**********           SETON                     9964  *                                  CSE022
      **********                                                                              CSE022
     C**********           END                             *FI                                CSE022
      **CASE:*DTL.Depot*Reference*9*is*Not*blank***********************                       CSE022
     C********** #1DRF9    IFNE *BLANK                     *IF                                CSE022
      **Setup*message*data*for*message*********************************                       CSE022
     C**********           MOVEL#1DRF9    ZA0096           Depot Reference                    CSE022
      **Send*message*'Entry*not*allowed*(Depot)'***********************                       CSE022
     C**********           MOVEL'USR0264' ZAMSID                                              CSE022
     C**********           EXSR ZASNMS                                                        CSE022
     C**********           SETON                     9966  *                                  CSE022
      **********                                                                              CSE022
     C**********           END                             *FI                                CSE022
      **CASE:*DTL.Depot*Reference*10*is*Not*blank**********************                       CSE022
     C********** #1DRF0    IFNE *BLANK                     *IF                                CSE022
      **Setup*message*data*for*message*********************************                       CSE022
     C**********           MOVEL#1DRF0    ZA0097           Depot Reference                    CSE022
      **Send*message*'Entry*not*allowed*(Depot)'***********************                       CSE022
     C**********           MOVEL'USR0264' ZAMSID                                              CSE022
     C**********           EXSR ZASNMS                                                        CSE022
     C**********           SETON                     9968  *                                  CSE022
      **********                                                                              CSE022
     C**********           END                             *FI                                CSE022
     C**********           END                             *FI                                CSE022
      * Start of SAR S01219
      * Classification is X
      * Classification is X
      * CASE: DTL.Classification is Depot
     C           #1CLAS    IFEQ 'X'                        *IF
      * CASE: DTL.Part./Non-part. 1 is Yes
     C           #1PNP1    IFEQ 'P'                        *IF
      * Setup message data for message
     C                     MOVEL#1PNP1    ZA0098           Part./Non-part.
      * Send message 'Participant must be......'
     C                     MOVEL'USR0555' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9951  *
      *
     C                     END                             *FI
      * CASE: DTL.Depot Reference 3 is Not blank
     C           #1DRF3    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1DRF3    ZA0099           Depot Reference
      * Send message 'Entry not allowed (Depot)'
     C                     MOVEL'USR0264' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9954  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * End of SAR S01219
      * Check Participant/Non participant
      * Start of SAR S01117
      * Participant/Non Participant
      * CASE: DTL.Classification is Equal to I, D or S
     C           #1CLAS    IFEQ 'D'                        *IF
     C           #1CLAS    OREQ 'I'
     C           #1CLAS    OREQ 'S'
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.Depot Reference 1 is Not blank
     C           #1DRF1    IFNE *BLANK                     *IF
      * CASE: DTL.Part./Non-part. 1 is blank
     C           #1PNP1    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1PNP1    ZA0100           Part./Non-part.
      * Send message 'Mandatory entry (P/NP)'
     C                     MOVEL'USR0270' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9951  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.Part./Non-part. 1 is Valid Values
     C           #1PNP1    IFEQ 'NP'                       *IF
     C           #1PNP1    OREQ 'P'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1PNP1    ZA0101           Part./Non-part.
      * Send message 'Part/Non Part Invalid'
     C                     MOVEL'USR1496' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9951  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DTL.Depot Reference 2 is Not blank
     C           #1DRF2    IFNE *BLANK                     *IF
      * CASE: DTL.Part./Non-part. 2 is blank
     C           #1PNP2    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1PNP2    ZA0102           Part./Non-part.
      * Send message 'Mandatory entry (P/NP)'
     C                     MOVEL'USR0270' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9953  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.Part./Non-part. 2 is Valid Values
     C           #1PNP2    IFEQ 'NP'                       *IF
     C           #1PNP2    OREQ 'P'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1PNP2    ZA0103           Part./Non-part.
      * Send message 'Part/Non Part Invalid'
     C                     MOVEL'USR1496' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9953  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DTL.Depot Reference 3 is Not blank
     C           #1DRF3    IFNE *BLANK                     *IF
      * CASE: DTL.Part./Non-part. 3 is blank
     C           #1PNP3    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1PNP3    ZA0104           Part./Non-part.
      * Send message 'Mandatory entry (P/NP)'
     C                     MOVEL'USR0270' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9955  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.Part./Non-part. 3 is Valid Values
     C           #1PNP3    IFEQ 'NP'                       *IF
     C           #1PNP3    OREQ 'P'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1PNP3    ZA0105           Part./Non-part.
      * Send message 'Part/Non Part Invalid'
     C                     MOVEL'USR1496' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9955  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DTL.Depot Reference 4 is Not blank
     C           #1DRF4    IFNE *BLANK                     *IF
      * CASE: DTL.Part./Non-part. 4 is blank
     C           #1PNP4    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1PNP4    ZA0106           Part./Non-part.
      * Send message 'Mandatory entry (P/NP)'
     C                     MOVEL'USR0270' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9957  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.Part./Non-part. 4 is Valid Values
     C           #1PNP4    IFEQ 'NP'                       *IF
     C           #1PNP4    OREQ 'P'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1PNP4    ZA0107           Part./Non-part.
      * Send message 'Part/Non Part Invalid'
     C                     MOVEL'USR1496' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9957  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DTL.Depot Reference 5 is Not blank
     C           #1DRF5    IFNE *BLANK                     *IF
      * CASE: DTL.Part./Non-part. 5 is blank
     C           #1PNP5    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1PNP5    ZA0108           Part./Non-part.
      * Send message 'Mandatory entry (P/NP)'
     C                     MOVEL'USR0270' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9959  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.Part./Non-part. 5 is Valid Values
     C           #1PNP5    IFEQ 'NP'                       *IF
     C           #1PNP5    OREQ 'P'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1PNP5    ZA0109           Part./Non-part.
      * Send message 'Part/Non Part Invalid'
     C                     MOVEL'USR1496' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9959  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DTL.Depot Reference 6 is Not blank
     C           #1DRF6    IFNE *BLANK                     *IF
      * CASE: DTL.Part./Non-part. 6 is blank
     C           #1PNP6    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1PNP6    ZA0110           Part./Non-part.
      * Send message 'Mandatory entry (P/NP)'
     C                     MOVEL'USR0270' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9961  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.Part./Non-part. 6 is Valid Values
     C           #1PNP6    IFEQ 'NP'                       *IF
     C           #1PNP6    OREQ 'P'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1PNP6    ZA0111           Part./Non-part.
      * Send message 'Part/Non Part Invalid'
     C                     MOVEL'USR1496' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9961  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DTL.Depot Reference 7 is Not blank
     C           #1DRF7    IFNE *BLANK                     *IF
      * CASE: DTL.Part./Non-part. 7 is blank
     C           #1PNP7    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1PNP7    ZA0112           Part./Non-part.
      * Send message 'Mandatory entry (P/NP)'
     C                     MOVEL'USR0270' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9963  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.Part./Non-part. 7 is Valid Values
     C           #1PNP7    IFEQ 'NP'                       *IF
     C           #1PNP7    OREQ 'P'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1PNP7    ZA0113           Part./Non-part.
      * Send message 'Part/Non Part Invalid'
     C                     MOVEL'USR1496' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9963  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DTL.Depot Reference 8 is Not blank
     C           #1DRF8    IFNE *BLANK                     *IF
      * CASE: DTL.Part./Non-part. 8 is blank
     C           #1PNP8    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1PNP8    ZA0114           Part./Non-part.
      * Send message 'Mandatory entry (P/NP)'
     C                     MOVEL'USR0270' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9965  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.Part./Non-part. 8 is Valid Values
     C           #1PNP8    IFEQ 'NP'                       *IF
     C           #1PNP8    OREQ 'P'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1PNP8    ZA0115           Part./Non-part.
      * Send message 'Part/Non Part Invalid'
     C                     MOVEL'USR1496' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9965  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DTL.Depot Reference 9 is Not blank
     C           #1DRF9    IFNE *BLANK                     *IF
      * CASE: DTL.Part./Non-part. 9 is blank
     C           #1PNP9    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1PNP9    ZA0116           Part./Non-part.
      * Send message 'Mandatory entry (P/NP)'
     C                     MOVEL'USR0270' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9967  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.Part./Non-part. 9 is Valid Values
     C           #1PNP9    IFEQ 'NP'                       *IF
     C           #1PNP9    OREQ 'P'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1PNP9    ZA0117           Part./Non-part.
      * Send message 'Part/Non Part Invalid'
     C                     MOVEL'USR1496' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9967  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DTL.Depot Reference 10 is Not blank
     C           #1DRF0    IFNE *BLANK                     *IF
      * CASE: DTL.Part./Non-part. 10 is blank
     C           #1PNP0    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1PNP0    ZA0118           Part./Non-part.
      * Send message 'Mandatory entry (P/NP)'
     C                     MOVEL'USR0270' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9969  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.Part./Non-part. 10 is Valid Values
     C           #1PNP0    IFEQ 'NP'                       *IF
     C           #1PNP0    OREQ 'P'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1PNP0    ZA0119           Part./Non-part.
      * Send message 'Part/Non Part Invalid'
     C                     MOVEL'USR1496' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9969  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Participant/Non Participant
      * CASE: DTL.Depot Reference 1 is Blank
     C           #1DRF1    IFEQ *BLANK                     *IF
      * CASE: DTL.Part./Non-part. 1 is Not blank
     C           #1PNP1    IFEQ 'NP'                       *IF
     C           #1PNP1    OREQ 'P'
      * Setup message data for message
     C                     MOVEL#1PNP1    ZA0120           Part./Non-part.
      * Send message 'Part/Non part not allowed'
     C                     MOVEL'USR0301' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9951  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Participant/Non Participant
      * CASE: DTL.Depot Reference 2 is Blank
     C           #1DRF2    IFEQ *BLANK                     *IF
      * CASE: DTL.Part./Non-part. 2 is Not blank
     C           #1PNP2    IFEQ 'NP'                       *IF
     C           #1PNP2    OREQ 'P'
      * Setup message data for message
     C                     MOVEL#1PNP2    ZA0121           Part./Non-part.
      * Send message 'Part/Non part not allowed'
     C                     MOVEL'USR0301' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9953  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Participant/Non Participant
      * CASE: DTL.Depot Reference 3 is Blank
     C           #1DRF3    IFEQ *BLANK                     *IF
      * CASE: DTL.Part./Non-part. 3 is Not blank
     C           #1PNP3    IFEQ 'NP'                       *IF
     C           #1PNP3    OREQ 'P'
      * Setup message data for message
     C                     MOVEL#1PNP3    ZA0122           Part./Non-part.
      * Send message 'Part/Non part not allowed'
     C                     MOVEL'USR0301' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9955  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Participant/Non Participant
      * CASE: DTL.Depot Reference 4 is Blank
     C           #1DRF4    IFEQ *BLANK                     *IF
      * CASE: DTL.Part./Non-part. 4 is Not blank
     C           #1PNP4    IFEQ 'NP'                       *IF
     C           #1PNP4    OREQ 'P'
      * Setup message data for message
     C                     MOVEL#1PNP4    ZA0123           Part./Non-part.
      * Send message 'Part/Non part not allowed'
     C                     MOVEL'USR0301' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9957  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Participant/Non Participant
      * CASE: DTL.Depot Reference 5 is Blank
     C           #1DRF5    IFEQ *BLANK                     *IF
      * CASE: DTL.Part./Non-part. 5 is Not blank
     C           #1PNP5    IFEQ 'NP'                       *IF
     C           #1PNP5    OREQ 'P'
      * Setup message data for message
     C                     MOVEL#1PNP5    ZA0124           Part./Non-part.
      * Send message 'Part/Non part not allowed'
     C                     MOVEL'USR0301' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9959  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Participant/Non Participant
      * CASE: DTL.Depot Reference 6 is Blank
     C           #1DRF6    IFEQ *BLANK                     *IF
      * CASE: DTL.Part./Non-part. 6 is Not blank
     C           #1PNP6    IFEQ 'NP'                       *IF
     C           #1PNP6    OREQ 'P'
      * Setup message data for message
     C                     MOVEL#1PNP6    ZA0125           Part./Non-part.
      * Send message 'Part/Non part not allowed'
     C                     MOVEL'USR0301' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9961  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Participant/Non Participant
      * CASE: DTL.Depot Reference 7 is Blank
     C           #1DRF7    IFEQ *BLANK                     *IF
      * CASE: DTL.Part./Non-part. 7 is Not blank
     C           #1PNP7    IFEQ 'NP'                       *IF
     C           #1PNP7    OREQ 'P'
      * Setup message data for message
     C                     MOVEL#1PNP7    ZA0126           Part./Non-part.
      * Send message 'Part/Non part not allowed'
     C                     MOVEL'USR0301' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9963  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Participant/Non Participant
      * CASE: DTL.Depot Reference 8 is Blank
     C           #1DRF8    IFEQ *BLANK                     *IF
      * CASE: DTL.Part./Non-part. 8 is Not blank
     C           #1PNP8    IFEQ 'NP'                       *IF
     C           #1PNP8    OREQ 'P'
      * Setup message data for message
     C                     MOVEL#1PNP8    ZA0127           Part./Non-part.
      * Send message 'Part/Non part not allowed'
     C                     MOVEL'USR0301' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9965  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Participant/Non Participant
      * CASE: DTL.Depot Reference 9 is Blank
     C           #1DRF9    IFEQ *BLANK                     *IF
      * CASE: DTL.Part./Non-part. 9 is Not blank
     C           #1PNP9    IFEQ 'NP'                       *IF
     C           #1PNP9    OREQ 'P'
      * Setup message data for message
     C                     MOVEL#1PNP9    ZA0128           Part./Non-part.
      * Send message 'Part/Non part not allowed'
     C                     MOVEL'USR0301' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9967  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Participant/Non Participant
      * CASE: DTL.Depot Reference 10 is Blank
     C           #1DRF0    IFEQ *BLANK                     *IF
      * CASE: DTL.Part./Non-part. 10 is Not blank
     C           #1PNP0    IFEQ 'NP'                       *IF
     C           #1PNP0    OREQ 'P'
      * Setup message data for message
     C                     MOVEL#1PNP0    ZA0129           Part./Non-part.
      * Send message 'Part/Non part not allowed'
     C                     MOVEL'USR0301' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9969  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Start of SAR S01212
      * 00/Copy Member SD0341RVSR - Securities Clients  *
     C*00/Copy Member SD0341R   Validate Screen Relns
     C/COPY WNCPYSRC,SD0341RVSR
      * End of SAR S01212
      * Classification required
     C           #1CLAS    IFEQ *BLANK                     IF
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         EBPR##    BEGSR
      *================================================================
      * Process record:
      *================================================================
      * Process delete request
     C   10                CAS            EDDLRQ
      * Process add request
     C           W0PMD     CASEQ'ADD'     ECADRQ
      * Process update request
     C           W0PMD     CASNE'ADD'     EECHRQ
     C                     END
     C/COPY WNCPYSRC,SD0341RC05
     C           W0RTN     IFNE *BLANK
      * Error: ROLLBACK any DBF changes
     C           CSC022    IFEQ 'N'                                                           CSC022
     C                     ROLBK
     C                     ELSE                                                               CSC022
     C           WSKIP     IFNE 'Y'                                                           CSC022
     C                     ROLBK                                                              CSC022
     C                     ELSE                                                               CSC022
     C                     SETON                     U7U8                                     CSC022
     C                     ENDIF                                                              CSC022
     C                     ENDIF                                                              CSC022
     C                     GOTO EBEXIT
     C                     ELSE
      * Otherwise COMMIT any DBF changes
     C           CSC022    IFEQ 'N'                                                           CSC022
     C           WSKIP     OREQ 'N'                                                           CSC022
     C           CSC022    ANDEQ'Y'                                                           CSC022
     C                     COMIT
     C                     ENDIF                                                              CSC022
     C                     END
     C           W0RTN     IFEQ *BLANK
      * USER: Process command keys
      * CASE: PAR.call futures & options is Yes
     C           P2CFAO    IFEQ 'Y'                        *IF
      * CASE: DTL.*CMD key is *Exit
     C           *IN03     IFEQ '1'                        *IF
      * Exit Program - No ROLBK - Standard Functions  *
     C                     MOVE 'Y2U9999' P0RTN
     C                     SETON                     LR
     C                     RETRN
     C                     ELSE
      * CASE: *OTHERWISE
      * Edit FO Clients - Futures & Options Clients  *
     C                     CLEARPARC
     C                     MOVEL#1CUST    PACUST           Customer Number
      *
     C                     CALL 'SD0331R'              90  Edit FO Clients
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Futures &
     C                     PARM P4MODE    WQ0043  1        mode
     C                     PARM P3ANCD    WQ0044  1        Action Code
     C           W0RTN     PARM W0RTN     WQ0045  7        *Return code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0331R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.*CMD key is *Exit
     C           *IN03     IFEQ '1'                        *IF
      * Exit Program - No ROLBK - Standard Functions  *
     C                     MOVE 'Y2U9999' P0RTN
     C                     SETON                     LR
     C                     RETRN
     C                     END                             *FI
     C                     END                             *FI
      * Start of SAR S01212
      * 00/Copy Member SD0341RPCK - Securities Clients  *
     C*00/Copy Member SD0341R   Process Command Keys
     C/COPY WNCPYSRC,SD0341RPCK
      * End of SAR S01212
     C           W0PMD     IFEQ 'ADD'
      * Exit after successful add
     C                     MOVEL'N'       W0RPT
     C                     END
      * Restart program for next record
     C                     MOVEL'N'       W0TRN
     C                     END
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         ECADRQ    BEGSR
      *================================================================
      * Process add request
      *================================================================
      * USER: Create DBF record
      * Create Securities Clients - Securities Clients  *
     C                     EXSR TNCRRC
     C           W0RTN     IFEQ *BLANK
     C/COPY WNCPYSRC,SD0341RC20
      * Send message '*Record added'
     C                     MOVEL'Y2U0011' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
      *================================================================
     CSR         ECEXIT    ENDSR
      /EJECT
     CSR         EDDLRQ    BEGSR
      *================================================================
      * Process delete request
      *================================================================
      * USER: Delete DBF record
      * Delete Securities Clients - Securities Clients  *
     C                     EXSR TPDLRC
     C           W0RTN     IFEQ *BLANK
      * Send message '*Record deleted'
     C                     MOVEL'Y2U0013' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
      *================================================================
     CSR         EDEXIT    ENDSR
      /EJECT
     CSR         EECHRQ    BEGSR
      *================================================================
      * Process update request
      *================================================================
      * USER: Change DBF record
      * Change Securities Clients - Securities Clients  *
     C                     EXSR TRCHRC
     C           W0RTN     IFNE *BLANK
      * Data update error
      * Reset screen fields if changed record
     C           W0RTN     CASEQ'Y2U0007' MBFL#1
     C                     END
     C                     ELSE
      * Send message '*Record changed'
     C                     MOVEL'Y2U0012' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
      *================================================================
     CSR         EEEXIT    ENDSR
      /EJECT
     CSR         FACKPM    BEGSR
      *================================================================
      * Check passed parameters
      *================================================================
      * Is full key present?
     C           P1CUST    IFEQ *BLANK                     Customer Number
      * Not every key field passed - loop program
     C                     MOVEL'Y'       W0RPT   1
     C                     ELSE
      * Full key passed, so single shot program
     C                     MOVEL'N'       W0RPT
     C                     END
      *================================================================
     CSR         FAEXIT    ENDSR
      /EJECT
     CSR         GADSAK    BEGSR
      *================================================================
      * Set key screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSAD    BEGSR
      *================================================================
      * Set detail screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      * Protect key fields on detail screen
     C                     SETON                     88    *
     C                     MOVEL'0'       *IN79
     C           WUACOP    IFEQ *BLANK                     *IF
     C           WUACOP    OREQ 'N'
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           WUCUIN    IFEQ *BLANK                     *IF
     C           WUCUIN    OREQ 'N'
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           WUJYSK    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL'0'       *IN76
     C           #DDP01    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
     C                     MOVEL'0'       *IN75
     C           #DDP02    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN75
     C                     END                             *FI
     C                     MOVEL'0'       *IN74
     C           #DDP03    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN74
     C                     END                             *FI
     C                     MOVEL'0'       *IN73
     C           #DDP04    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN73
     C                     END                             *FI
     C                     MOVEL'0'       *IN72
     C           #DDP05    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN72
     C                     END                             *FI
     C                     MOVEL'0'       *IN71
     C           #DDP06    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN71
     C                     END                             *FI
     C                     MOVEL'0'       *IN70
     C           #DDP07    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN70
     C                     END                             *FI
     C                     MOVEL'0'       *IN80                           137034
     C           #DDP08    IFEQ *BLANK                     *IF            137034
     C                     MOVEL'1'       *IN80                           137034
     C                     END                             *FI            137034
     C                     MOVEL'0'       *IN81                           137034
     C           #DDP09    IFEQ *BLANK                     *IF            137034
     C                     MOVEL'1'       *IN81                           137034
     C                     END                             *FI            137034
     C                     MOVEL'0'       *IN82                           137034
     C           #DDP10    IFEQ *BLANK                     *IF            137034
     C                     MOVEL'1'       *IN82                           137034
     C                     END                             *FI            137034
      * Enable key screen
     C                     SETON                     87    *
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise record - except for key fields and "neither" paramete
      *================================================================
     C                     Z-ADD*ZERO     #1ACSN           Account sequenc
     C                     Z-ADD*ZERO     #1NSDT           Next statement
     C                     Z-ADD*ZERO     #1SBDM           Stat.Base Date
     C                     Z-ADD*ZERO     #1LCD            Last Change Dat
     C                     MOVEL*BLANK    #1TYLC           Type of Last Ch
     C                     Z-ADD*ZERO     #1NTFC           No. of Trades f
     C                     MOVEL*BLANK    #DCSST           Customer shortn
     C                     MOVEL*BLANK    #DRNFF           Report Name FF
     C                     MOVEL*BLANK    #DRTFF           Report Town FF
     C                     MOVEL*BLANK    #1CLAS           Classification
     C                     MOVEL*BLANK    #1PCYC           Portfolio curre
     C                     MOVEL*BLANK    #1CYCD           Currency Code
     C                     MOVEL*BLANK    #1ACCD           Account Code
     C                     MOVEL*BLANK    #DSQNC           Sequence
     C                     MOVEL*BLANK    #1STFQ           Statement frequ
     C                     MOVEL*BLANK    #DSNSD           ST next stateme
     C                     MOVEL*BLANK    #DSTBD           Statement Base
     C                     MOVEL*BLANK    #1ADCD           Address Code
     C                     MOVEL*BLANK    #1SRCD           Statutory retur
     C                     MOVEL*BLANK    #1CFIN           Cedel Fungibili
     C                     MOVEL*BLANK    #1PLAG           Pledge Agreemen
     C                     MOVEL*BLANK    #1TCD            Tax Code
     C                     MOVEL*BLANK    #1ASIN           Auto-Settle Ind
     C                     MOVEL*BLANK    #1SBJF           Subject to Cust
     C                     MOVEL*BLANK    #1TDCG           Trade Charges G
     C                     MOVEL*BLANK    #1CFGC           Custody Fees Gr
     C                     MOVEL*BLANK    #1PSCG           Position Settl.
     C                     MOVEL*BLANK    #1NARR           Narrative
     C                     MOVEL*BLANK    #DDP01           Depot 1
     C                     MOVEL*BLANK    #1DRF1           Depot Reference
     C                     MOVEL*BLANK    #1PNP1           Part./Non-part.
     C                     MOVEL*BLANK    #DDP02           Depot 2
     C                     MOVEL*BLANK    #1DRF2           Depot Reference
     C                     MOVEL*BLANK    #1PNP2           Part./Non-part.
     C                     MOVEL*BLANK    #DDP03           Depot 3
     C                     MOVEL*BLANK    #1DRF3           Depot Reference
     C                     MOVEL*BLANK    #1PNP3           Part./Non-part.
     C                     MOVEL*BLANK    #DDP04           Depot 4
     C                     MOVEL*BLANK    #1DRF4           Depot Reference
     C                     MOVEL*BLANK    #1PNP4           Part./Non-part.
     C                     MOVEL*BLANK    #DDP05           Depot 5
     C                     MOVEL*BLANK    #1DRF5           Depot Reference
     C                     MOVEL*BLANK    #1PNP5           Part./Non-part.
     C                     MOVEL*BLANK    #DDP06           Depot 6
     C                     MOVEL*BLANK    #1DRF6           Depot Reference
     C                     MOVEL*BLANK    #1PNP6           Part./Non-part.
     C                     MOVEL*BLANK    #DDP07           Depot 7
     C                     MOVEL*BLANK    #1DRF7           Depot Reference
     C                     MOVEL*BLANK    #1PNP7           Part./Non-part.
     C                     MOVEL*BLANK    #DDP08           Depot 8
     C                     MOVEL*BLANK    #1DRF8           Depot Reference
     C                     MOVEL*BLANK    #1PNP8           Part./Non-part.
     C                     MOVEL*BLANK    #DDP09           Depot 9
     C                     MOVEL*BLANK    #1DRF9           Depot Reference
     C                     MOVEL*BLANK    #1PNP9           Part./Non-part.
     C                     MOVEL*BLANK    #DDP10           Depot 10
     C                     MOVEL*BLANK    #1DRF0           Depot Reference
     C                     MOVEL*BLANK    #1PNP0           Part./Non-part.
     C/COPY WNCPYSRC,SD0341RC03
     C           PB3610    IFEQ 'Y'                                                           CER001
     C           P1FRNT    CHAINSDICEXL1             89                                       CER001
     C           *IN89     IFEQ *OFF                                                          CER001
     C                     MOVELPBCLAS    #1CLAS                                              CER001
     C                     MOVELPBPCYC    #1PCYC                                              CER001
     C                     MOVELPBCYCD    #1CYCD                                              CER001
     C                     MOVELPBACCD    #1ACCD                                              CER001
     C                     MOVELPBACSN    #DSQNC                                              CER001
     C                     MOVELPBCFIN    #1CFIN                                              CER001
     C                     MOVELPBSTFQ    #1STFQ                                              CER001
     C                     MOVELPBSBDM    #DSTBD                                              CER001
     C                     MOVELPBASIN    #1ASIN                                              CER001
     C                     ENDIF                                                              CER001
     C                     ENDIF                                                              CER001
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @BFREDQ fields to screen
      *================================================================
     C                     Z-ADDBFACSN    #1ACSN           Account sequenc
     C                     Z-ADDBFNSDT    #1NSDT           Next statement
     C                     Z-ADDBFSBDM    #1SBDM           Stat.Base Date
     C                     Z-ADDBFLCD     #1LCD            Last Change Dat
     C                     MOVELBFTYLC    #1TYLC           Type of Last Ch
     C                     Z-ADDBFNTFC    #1NTFC           No. of Trades f
     C                     MOVELBFCUST    #1CUST           Customer Number
     C                     MOVELBFCLAS    #1CLAS           Classification
     C                     MOVELBFPCYC    #1PCYC           Portfolio curre
     C                     MOVELBFCYCD    #1CYCD           Currency Code
     C                     MOVELBFACCD    #1ACCD           Account Code
     C                     MOVELBFSTFQ    #1STFQ           Statement frequ
     C                     MOVELBFADCD    #1ADCD           Address Code
     C                     MOVELBFSRCD    #1SRCD           Statutory retur
     C                     MOVELBFCFIN    #1CFIN           Cedel Fungibili
     C                     MOVELBFPLAG    #1PLAG           Pledge Agreemen
     C                     MOVELBFTCD     #1TCD            Tax Code
     C                     MOVELBFASIN    #1ASIN           Auto-Settle Ind
     C                     MOVELBFSBJF    #1SBJF           Subject to Cust
     C                     MOVELBFTDCG    #1TDCG           Trade Charges G
     C                     MOVELBFCFGC    #1CFGC           Custody Fees Gr
     C                     MOVELBFPSCG    #1PSCG           Position Settl.
     C                     MOVELBFNARR    #1NARR           Narrative
     C                     MOVELBFDRF1    #1DRF1           Depot Reference
     C                     MOVELBFPNP1    #1PNP1           Part./Non-part.
     C                     MOVELBFDRF2    #1DRF2           Depot Reference
     C                     MOVELBFPNP2    #1PNP2           Part./Non-part.
     C                     MOVELBFDRF3    #1DRF3           Depot Reference
     C                     MOVELBFPNP3    #1PNP3           Part./Non-part.
     C                     MOVELBFDRF4    #1DRF4           Depot Reference
     C                     MOVELBFPNP4    #1PNP4           Part./Non-part.
     C                     MOVELBFDRF5    #1DRF5           Depot Reference
     C                     MOVELBFPNP5    #1PNP5           Part./Non-part.
     C                     MOVELBFDRF6    #1DRF6           Depot Reference
     C                     MOVELBFPNP6    #1PNP6           Part./Non-part.
     C                     MOVELBFDRF7    #1DRF7           Depot Reference
     C                     MOVELBFPNP7    #1PNP7           Part./Non-part.
     C                     MOVELBFDRF8    #1DRF8           Depot Reference
     C                     MOVELBFPNP8    #1PNP8           Part./Non-part.
     C                     MOVELBFDRF9    #1DRF9           Depot Reference
     C                     MOVELBFPNP9    #1PNP9           Part./Non-part.
     C                     MOVELBFDRF0    #1DRF0           Depot Reference
     C                     MOVELBFPNP0    #1PNP0           Part./Non-part.
     C/COPY WNCPYSRC,SD0341RC25
      * Hold existing record image
     C                     MOVEL@1DBRC    #1DBRC
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MDIZ#K    BEGSR
      *================================================================
      * Initialize key screen
      *================================================================
     C                     MOVELP1CUST    #1CUST           Customer Number
      * USER: Initialize key screen
      * Start of SAR S01212
      * 00/Copy Member SD0341RIKS - Securities Clients  *
     C*00/Copy Member SD0341R   Initialise Key Screen
     C/COPY WNCPYSRC,SD0341RIKS
      * End of SAR S01212
      *================================================================
     CSR         MDEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Retrieve for other screen - Client Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           BBCUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1CUST    BBCUST           Customer Number
     C           KRSSA     CHAIN@BBREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0081' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SAEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBBCSSN    #DCSST           Customer Shortn
     C                     MOVELBBCRTN    #DRTFF           Customer Report
     C                     MOVELBBCRNM    #DRNFF           Customer Report
     C                     END
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Retrieve depots - Securities Trading Data  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           BVSCTR           Securities Trad
      * Move fields to key list
     C                     MOVE *BLANK    BVSCTR           Securities Trad
     C                     MOVEL'STRD'    BVSCTR           Securities Trad
     C           KRSSB     CHAIN@BVREFF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0239' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * Setup message data for message
     C                     MOVEL'SDSTRDPD'ZA0001           Filename
      * Send message 'Database Error (ICD)'
     C                     MOVEL'USR0377' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO SBEXIT                     *QUIT
     C                     GOTO SBEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBVDR1     WUDR1            Depot 1 (EUROCL
     C                     MOVELBVDR3     WUDR3            Depot Ref 3, Ka
     C                     MOVELBVDR10    WUDR10           Depot Reference
     C                     MOVELBVDR2     WUDR2            Depot Reference
     C                     MOVELBVDR4     WUDR4            Depot Reference
     C                     MOVELBVDR5     WUDR5            Depot Reference
     C                     MOVELBVDR6     WUDR6            Depot Reference
     C                     MOVELBVDR7     WUDR7            Depot Reference
     C                     MOVELBVDR8     WUDR8            Depot Reference
     C                     MOVELBVDR9     WUDR9            Depot Reference
     C                     END
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Retrieve shortname - Client Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           BBCUST           Customer Number
      * Move fields to key list
     C                     MOVELWUDR1     BBCUST           Customer Number
     C           KRSSC     CHAIN@BBREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0081' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBBCSSN    #DDP01           Customer Shortn
     C                     END
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Retrieve shortname - Client Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           BBCUST           Customer Number
      * Move fields to key list
     C                     MOVELWUDR2     BBCUST           Customer Number
     C           KRSSD     CHAIN@BBREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0081' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBBCSSN    #DDP02           Customer Shortn
     C                     END
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Retrieve shortname - Client Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           BBCUST           Customer Number
      * Move fields to key list
     C                     MOVELWUDR3     BBCUST           Customer Number
     C           KRSSE     CHAIN@BBREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0081' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SEEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBBCSSN    #DDP03           Customer Shortn
     C                     END
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Retrieve shortname - Client Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           BBCUST           Customer Number
      * Move fields to key list
     C                     MOVELWUDR4     BBCUST           Customer Number
     C           KRSSF     CHAIN@BBREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0081' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SFEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBBCSSN    #DDP04           Customer Shortn
     C                     END
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Retrieve shortname - Client Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           BBCUST           Customer Number
      * Move fields to key list
     C                     MOVELWUDR5     BBCUST           Customer Number
     C           KRSSG     CHAIN@BBREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0081' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBBCSSN    #DDP05           Customer Shortn
     C                     END
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Retrieve shortname - Client Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           BBCUST           Customer Number
      * Move fields to key list
     C                     MOVELWUDR6     BBCUST           Customer Number
     C           KRSSH     CHAIN@BBREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0081' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SHEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBBCSSN    #DDP06           Customer Shortn
     C                     END
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Retrieve shortname - Client Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           BBCUST           Customer Number
      * Move fields to key list
     C                     MOVELWUDR7     BBCUST           Customer Number
     C           KRSSI     CHAIN@BBREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0081' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SIEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBBCSSN    #DDP07           Customer Shortn
     C                     END
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Retrieve shortname - Client Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           BBCUST           Customer Number
      * Move fields to key list
     C                     MOVELWUDR8     BBCUST           Customer Number
     C           KRSSJ     CHAIN@BBREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0081' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SJEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBBCSSN    #DDP08           Customer Shortn
     C                     END
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Retrieve shortname - Client Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           BBCUST           Customer Number
      * Move fields to key list
     C                     MOVELWUDR9     BBCUST           Customer Number
     C           KRSSK     CHAIN@BBREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0081' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SKEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBBCSSN    #DDP09           Customer Shortn
     C                     END
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Retrieve shortname - Client Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           BBCUST           Customer Number
      * Move fields to key list
     C                     MOVELWUDR10    BBCUST           Customer Number
     C           KRSSL     CHAIN@BBREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0081' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SLEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBBCSSN    #DDP10           Customer Shortn
     C                     END
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Retrieve for other screen - Client Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           BBCUST           Customer Number
      * Move fields to key list
     C                     MOVELBFCUST    BBCUST           Customer Number
     C           KRSSM     CHAIN@BBREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0081' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SMEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBBCSSN    #DCSST           Customer Shortn
     C                     MOVELBBCRTN    #DRTFF           Customer Report
     C                     MOVELBBCRNM    #DRNFF           Customer Report
     C                     END
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Retrieve depots - Securities Trading Data  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           BVSCTR           Securities Trad
      * Move fields to key list
     C                     MOVE *BLANK    BVSCTR           Securities Trad
     C                     MOVEL'STRD'    BVSCTR           Securities Trad
     C           KRSSN     CHAIN@BVREFF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0239' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * Setup message data for message
     C                     MOVEL'SDSTRDPD'ZA0002           Filename
      * Send message 'Database Error (ICD)'
     C                     MOVEL'USR0377' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO SNEXIT                     *QUIT
     C                     GOTO SNEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBVDR1     WUDR1            Depot 1 (EUROCL
     C                     MOVELBVDR3     WUDR3            Depot Ref 3, Ka
     C                     MOVELBVDR10    WUDR10           Depot Reference
     C                     MOVELBVDR2     WUDR2            Depot Reference
     C                     MOVELBVDR4     WUDR4            Depot Reference
     C                     MOVELBVDR5     WUDR5            Depot Reference
     C                     MOVELBVDR6     WUDR6            Depot Reference
     C                     MOVELBVDR7     WUDR7            Depot Reference
     C                     MOVELBVDR8     WUDR8            Depot Reference
     C                     MOVELBVDR9     WUDR9            Depot Reference
     C                     END
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Retrieve shortname - Client Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           BBCUST           Customer Number
      * Move fields to key list
     C                     MOVELWUDR1     BBCUST           Customer Number
     C           KRSSO     CHAIN@BBREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0081' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SOEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBBCSSN    #DDP01           Customer Shortn
     C                     END
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Retrieve shortname - Client Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           BBCUST           Customer Number
      * Move fields to key list
     C                     MOVELWUDR2     BBCUST           Customer Number
     C           KRSSP     CHAIN@BBREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0081' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SPEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBBCSSN    #DDP02           Customer Shortn
     C                     END
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Retrieve shortname - Client Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           BBCUST           Customer Number
      * Move fields to key list
     C                     MOVELWUDR3     BBCUST           Customer Number
     C           KRSSQ     CHAIN@BBREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0081' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SQEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBBCSSN    #DDP03           Customer Shortn
     C                     END
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Retrieve shortname - Client Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           BBCUST           Customer Number
      * Move fields to key list
     C                     MOVELWUDR4     BBCUST           Customer Number
     C           KRSSR     CHAIN@BBREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0081' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SREXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBBCSSN    #DDP04           Customer Shortn
     C                     END
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Retrieve shortname - Client Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           BBCUST           Customer Number
      * Move fields to key list
     C                     MOVELWUDR5     BBCUST           Customer Number
     C           KRSSS     CHAIN@BBREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0081' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SSEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBBCSSN    #DDP05           Customer Shortn
     C                     END
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Retrieve shortname - Client Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           BBCUST           Customer Number
      * Move fields to key list
     C                     MOVELWUDR6     BBCUST           Customer Number
     C           KRSST     CHAIN@BBREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0081' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO STEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBBCSSN    #DDP06           Customer Shortn
     C                     END
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Retrieve shortname - Client Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           BBCUST           Customer Number
      * Move fields to key list
     C                     MOVELWUDR7     BBCUST           Customer Number
     C           KRSSU     CHAIN@BBREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0081' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SUEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBBCSSN    #DDP07           Customer Shortn
     C                     END
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Retrieve shortname - Client Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           BBCUST           Customer Number
      * Move fields to key list
     C                     MOVELWUDR8     BBCUST           Customer Number
     C           KRSSV     CHAIN@BBREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0081' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SVEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBBCSSN    #DDP08           Customer Shortn
     C                     END
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Retrieve shortname - Client Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           BBCUST           Customer Number
      * Move fields to key list
     C                     MOVELWUDR9     BBCUST           Customer Number
     C           KRSSW     CHAIN@BBREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0081' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SWEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBBCSSN    #DDP09           Customer Shortn
     C                     END
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * Retrieve shortname - Client Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           BBCUST           Customer Number
      * Move fields to key list
     C                     MOVELWUDR10    BBCUST           Customer Number
     C           KRSSX     CHAIN@BBREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0081' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SXEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBBCSSN    #DDP10           Customer Shortn
     C                     END
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * Get Base Currency - Bank Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           BJBANK           Bank
      * Move fields to key list
     C                     MOVE *BLANK    BJBANK           Bank
     C                     MOVEL'BANK'    BJBANK           Bank
     C           KRSSY     CHAIN@BJREEF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0197' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * Setup message data for message
     C                     MOVEL'SDBANKPD'ZA0025           Filename
      * Send message 'Database Error (ICD)'
     C                     MOVEL'USR0377' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO SYEXIT                     *QUIT
     C                     GOTO SYEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBJCYCD    WUCYCD           Currency Code
     C                     END
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * Get dealing indicator - Currency Codes  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           A6CYCD           Currency Code
      * Move fields to key list
     C                     MOVEL#1CYCD    A6CYCD           Currency Code
     C           KRSSZ     CHAIN@A6REA3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0071' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SZEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELA6DLCI    WUDLCI           Dealing Currenc
     C                     END
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * retrieve type as well - Account Codes  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           A5ACCD           Account Code
      * Move fields to key list
     C                     MOVEL#1ACCD    A5ACCD           Account Code
     C           KRSTA     CHAIN@A5REA6              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0069' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TAEXIT
     C                     END
      *
      * USER: Exit processing
      * PAR = DB1 By name
     C                     MOVELA5ACTY    WUACTY           Account type
     C                     MOVELA5TOIN    WUTOIN           Title Only Indi
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * Get Alt.Name & Address - Alternate Names & Address  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           BCCUST           Customer Number
     C                     KFLD           BCADCD           Address Code
      * Move fields to key list
     C                     MOVEL#1CUST    BCCUST           Customer Number
     C                     MOVEL#1ADCD    BCADCD           Address Code
     C           KRSTB     CHAIN@BCREDE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0083' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TBEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     END
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * Get Charge Code - Charge Types Detail Physi  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BWCCOM    WQTC01           Charge/Commissi
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WQTC01           Charge/Commissi
      * Move fields to key list
     C                     MOVELWUCCOM    WQTC01           Charge/Commissi
     C           KRSTC     SETLL@CGTDFI                    *
     C           KRSTC     READE@CGTDFI                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0271' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TCEXIT
     C                     END
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C           KRSTC     READE@CGTDFI                  90*
     C                     END
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * Retrieve classification - Securities Clients  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           BFCUST           Customer Number
      * Move fields to key list
     C                     MOVELWUWCUS    BFCUST           Customer Number
     C           KRSTD     CHAIN@BFREDQ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0094' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TDEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBFCLAS    WUCLAS           Classification
     C                     END
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * Retrieve classification - Securities Clients  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           BFCUST           Customer Number
      * Move fields to key list
     C                     MOVELWUWCUS    BFCUST           Customer Number
     C           KRSTE     CHAIN@BFREDQ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0094' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TEEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBFCLAS    WUCLAS           Classification
     C                     END
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * Retrieve classification - Securities Clients  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           BFCUST           Customer Number
      * Move fields to key list
     C                     MOVELWUWCUS    BFCUST           Customer Number
     C           KRSTF     CHAIN@BFREDQ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0094' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TFEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBFCLAS    WUCLAS           Classification
     C                     END
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * Retrieve classification - Securities Clients  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           BFCUST           Customer Number
      * Move fields to key list
     C                     MOVELWUWCUS    BFCUST           Customer Number
     C           KRSTG     CHAIN@BFREDQ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0094' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TGEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBFCLAS    WUCLAS           Classification
     C                     END
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * Retrieve classification - Securities Clients  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           BFCUST           Customer Number
      * Move fields to key list
     C                     MOVELWUWCUS    BFCUST           Customer Number
     C           KRSTH     CHAIN@BFREDQ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0094' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO THEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBFCLAS    WUCLAS           Classification
     C                     END
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * Retrieve classification - Securities Clients  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTI     KLIST
     C                     KFLD           BFCUST           Customer Number
      * Move fields to key list
     C                     MOVELWUWCUS    BFCUST           Customer Number
     C           KRSTI     CHAIN@BFREDQ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0094' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TIEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBFCLAS    WUCLAS           Classification
     C                     END
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * Retrieve classification - Securities Clients  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           BFCUST           Customer Number
      * Move fields to key list
     C                     MOVELWUWCUS    BFCUST           Customer Number
     C           KRSTJ     CHAIN@BFREDQ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0094' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TJEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBFCLAS    WUCLAS           Classification
     C                     END
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKRVGN    BEGSR
      *================================================================
      * Retrieve classification - Securities Clients  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTK     KLIST
     C                     KFLD           BFCUST           Customer Number
      * Move fields to key list
     C                     MOVELWUWCUS    BFCUST           Customer Number
     C           KRSTK     CHAIN@BFREDQ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0094' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TKEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBFCLAS    WUCLAS           Classification
     C                     END
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLRVGN    BEGSR
      *================================================================
      * Retrieve classification - Securities Clients  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTL     KLIST
     C                     KFLD           BFCUST           Customer Number
      * Move fields to key list
     C                     MOVELWUWCUS    BFCUST           Customer Number
     C           KRSTL     CHAIN@BFREDQ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0094' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TLEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBFCLAS    WUCLAS           Classification
     C                     END
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMRVGN    BEGSR
      *================================================================
      * Retrieve classification - Securities Clients  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTM     KLIST
     C                     KFLD           BFCUST           Customer Number
      * Move fields to key list
     C                     MOVELWUWCUS    BFCUST           Customer Number
     C           KRSTM     CHAIN@BFREDQ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0094' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TMEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBFCLAS    WUCLAS           Classification
     C                     END
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNCRRC    BEGSR
      *================================================================
      * Create Securities Clients - Securities Clients  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BFREDP
     C                     MOVEL#1CUST    BFCUST           Customer Number
     C                     MOVEL#1ACCD    BFACCD           Account Code
     C                     MOVEL#1PCYC    BFPCYC           Portfolio curre
     C                     MOVEL#1CYCD    BFCYCD           Currency Code
     C                     MOVEL#1ADCD    BFADCD           Address Code
     C                     Z-ADDWURDNB    BFLCD            Last Change Dat
     C                     MOVEL'I'       BFTYLC           Type of Last Ch
     C                     Z-ADD#1ACSN    BFACSN           Account sequenc
     C                     MOVEL#1CLAS    BFCLAS           Classification
     C                     MOVEL#1DRF1    BFDRF1           Depot Reference
     C                     MOVEL#1DRF2    BFDRF2           Depot Reference
     C                     MOVEL#1DRF3    BFDRF3           Depot Reference
     C                     MOVEL#1DRF4    BFDRF4           Depot Reference
     C                     MOVEL#1DRF5    BFDRF5           Depot Reference
     C                     MOVEL#1DRF6    BFDRF6           Depot Reference
     C                     MOVEL#1DRF7    BFDRF7           Depot Reference
     C                     MOVEL#1DRF8    BFDRF8           Depot Reference
     C                     MOVEL#1DRF9    BFDRF9           Depot Reference
     C                     MOVEL#1DRF0    BFDRF0           Depot Reference
     C                     MOVEL#1PNP1    BFPNP1           Part./Non-part.
     C                     MOVEL#1PNP2    BFPNP2           Part./Non-part.
     C                     MOVEL#1PNP3    BFPNP3           Part./Non-part.
     C                     MOVEL#1PNP4    BFPNP4           Part./Non-part.
     C                     MOVEL#1PNP5    BFPNP5           Part./Non-part.
     C                     MOVEL#1PNP6    BFPNP6           Part./Non-part.
     C                     MOVEL#1PNP7    BFPNP7           Part./Non-part.
     C                     MOVEL#1PNP8    BFPNP8           Part./Non-part.
     C                     MOVEL#1PNP9    BFPNP9           Part./Non-part.
     C                     MOVEL#1PNP0    BFPNP0           Part./Non-part.
     C                     MOVEL#1CFIN    BFCFIN           Cedel Fungibili
     C                     MOVEL#1STFQ    BFSTFQ           Statement frequ
     C                     Z-ADD#1NSDT    BFNSDT           Next statement
     C                     Z-ADD#1SBDM    BFSBDM           Stat.Base Date
     C                     MOVEL#1PLAG    BFPLAG           Pledge Agreemen
     C                     MOVEL#1NARR    BFNARR           Narrative
     C                     Z-ADD#1NTFC    BFNTFC           No. of Trades f
     C                     MOVEL#1SRCD    BFSRCD           Statutory retur
     C                     MOVEL#1TCD     BFTCD            Tax Code
     C                     MOVEL#1ASIN    BFASIN           Auto-Settle Ind
     C                     MOVEL#1SBJF    BFSBJF           Subject to Cust
     C                     MOVEL#1CFGC    BFCFGC           Custody Fees Gr
     C                     MOVEL#1TDCG    BFTDCG           Trade Charges G
     C                     MOVEL#1PSCG    BFPSCG           Position Settl.
      *
      * USER: Processing before Data update
      * Start of SAR S01212
      * CASE: WRK.Window processing requir. is Yes
     C           WUWDPR    IFEQ 'Y'                        *IF
      * 00/Copy Member SD0341RCBW - Securities Clients  *
     C*00/Copy Member SD0341R   Proc Before Create - WN
     C/COPY WNCPYSRC,SD0341RCBW
     C                     END                             *FI
      * 00/Copy Member SD0341RCBU - Securities Clients  *
     C*00/Copy Member SD0341R   Processing Before Create
     C/COPY WNCPYSRC,SD0341RCBU
      * End of SAR S01212
     C           KLCRTN    KLIST
     C                     KFLD           BFCUST           Customer Number
      * Check for duplicate primary key
     C           KLCRTN    SETLL@BFREDP                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0095' W0RTN   7
      * Send message 'Securities Clients     EX'
     C                     MOVEL'USR0095' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TNEXIT
     C                     END
      *
     C           BFTMST    IFEQ *BLANKS                                                       204139
     C                     MOVE TIMEST    BFTMST                                              204139
     C                     ENDIF                                                              204139
      *                                                                                       204139
     C                     WRITE@BFREDP                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
     C                     Z-ADD1         WUNORC           No. of Records
     C                     Z-ADD*ZERO     WUNOAM           No. of Amends
     C                     Z-ADD*ZERO     WUNODL           No. of Deletes
     C                     Z-ADD1         WUNOIN           No. of Inserts
      * Change Standing Data Cont - Standing Data Controls  *
     C                     EXSR TOCHRC
      * Update CLINTSE - Securities Clients  *
     C                     CALL 'CLINTSE'              90  Update CLINTSE
     C           W0RTN     PARM *BLANK    WQ0046  7        *Return code
     C                     PARM BFCUST    WQ0047  6        Customer Number
     C**********           PARM BFACCD    WQ0048  4        Account Code                       CGL029
     C                     PARM BFACCD    WQ0048 10                                           CGL029
     C                     PARM BFPCYC    WQ0049  3        Portfolio curre
     C                     PARM BFCYCD    WQ0050  3        Currency Code
     C                     PARM BFADCD    WQ0051  1        Address Code
     C                     PARM BFACSN    WQ0052  20       Account sequenc
     C                     PARM BFCLAS    WQ0053  1        Classification
     C                     PARM BFDRF1    WQ0054  6        Depot Reference
     C                     PARM BFDRF2    WQ0055  6        Depot Reference
     C                     PARM BFDRF3    WQ0056  6        Depot Reference
     C                     PARM BFDRF4    WQ0057  6        Depot Reference
     C                     PARM BFDRF5    WQ0058  6        Depot Reference
     C                     PARM BFDRF6    WQ0059  6        Depot Reference
     C                     PARM BFDRF7    WQ0060  6        Depot Reference
     C                     PARM BFDRF8    WQ0061  6        Depot Reference
     C                     PARM BFDRF9    WQ0062  6        Depot Reference
     C                     PARM BFDRF0    WQ0063  6        Depot Reference
     C                     PARM BFPNP1    WQ0064  2        Part./Non-part.
     C                     PARM BFPNP2    WQ0065  2        Part./Non-part.
     C                     PARM BFPNP3    WQ0066  2        Part./Non-part.
     C                     PARM BFPNP4    WQ0067  2        Part./Non-part.
     C                     PARM BFPNP5    WQ0068  2        Part./Non-part.
     C                     PARM BFPNP6    WQ0069  2        Part./Non-part.
     C                     PARM BFPNP7    WQ0070  2        Part./Non-part.
     C                     PARM BFPNP8    WQ0071  2        Part./Non-part.
     C                     PARM BFPNP9    WQ0072  2        Part./Non-part.
     C                     PARM BFPNP0    WQ0073  2        Part./Non-part.
     C                     PARM BFCFIN    WQ0074  1        Cedel Fungibili
     C                     PARM BFSTFQ    WQ0075  1        Statement frequ
     C                     PARM BFNSDT    WQ0076  50       Next statement
     C                     PARM BFSBDM    WQ0077  20       Stat.Base Date
     C                     PARM BFPLAG    WQ0078  1        Pledge Agreemen
     C                     PARM BFNARR    WQ0079 35        Narrative
     C                     PARM BFNTFC    WQ0080  50       No. of Trades f
     C                     PARM BFSRCD    WQ0081  5        Statutory retur
     C                     PARM BFTCD     WQ0082  2        Tax Code
     C                     PARM BFASIN    WQ0083  1        Auto-Settle Ind
     C                     PARM WURDNB    WQ0084  50       Run day number
     C                     PARM BFTYLC    WQ0085  1        Type of Last Ch
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CLINTSE' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
      * Send message 'Unable to update'
     C                     MOVEL'USR0015' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * Start of SAR S01212
      * 00/Copy Member SD0341RCAU - Securities Clients  *
     C*00/Copy Member SD0341R   Processing After Create
     C/COPY WNCPYSRC,SD0341RCAU
      * End of SAR S01212
     C                     END
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TOCHRC    BEGSR
      *================================================================
      * Change Standing Data Cont - Standing Data Controls  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE 'N'       YARDC   1
      *
      * Move key fields to @AHREAU
     C                     MOVE *BLANK    AHFLNM           Filename
     C                     MOVEL'SDSECSPD'AHFLNM           Filename
      *
     C           KLCHTO    KLIST
     C                     KFLD           AHFLNM           Filename
     C********** KLCHTO    CHAIN@AHREAU              9091  *                                MD061008
     C                     CALL 'SD000119'                                                  MD061008
     C                     PARM '*RTV'    ZMODE   4                                         MD061008
     C                     PARM           AHFLNM 10                                         MD061008
     C                     PARM 0         AHNORC  50                                        MD061008
     C                     PARM 0         AHNOIN  50                                        MD061008
     C                     PARM 0         AHNOAM  50                                        MD061008
     C                     PARM 0         AHNODL  50                                        MD061008
     C                     PARM *BLANKS   ZRETRN 10                                         MD061008
      *                                                                                     MD061008
     C                     SETOF                     9091                                   MD061008
     C           ZRETRN    IFEQ '*NRF'                                                      MD061008
     C                     SETON                     90                                     MD061008
     C                     ENDIF                                                            MD061008
     C           ZRETRN    IFEQ '*ERROR'                                                    MD061008
     C                     SETON                     91                                     MD061008
     C                     ENDIF                                                            MD061008
      *                                                                                     MD061008
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TOEXIT
     C                     END
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     GOTO TOEXIT
     C                     END
      *
      * Store record data for null update check
     C                     MOVE QSDFC1    YARDCS
      * USER: Processing after Data read
     C                     ADD  AHNORC    WUNORC           No. of Records
     C                     ADD  AHNOIN    WUNOIN           No. of Inserts
     C                     ADD  AHNOAM    WUNOAM           No. of Amends
     C                     ADD  AHNODL    WUNODL           No. of Deletes
      * Move non-key fields to @AHREAU
     C                     Z-ADDWUNORC    AHNORC           No. of Records
     C                     Z-ADDWUNOIN    AHNOIN           No. of Inserts
     C                     Z-ADDWUNOAM    AHNOAM           No. of Amends
     C                     Z-ADDWUNODL    AHNODL           No. of Deletes
      *
      * Set PGM.*Record Data Changed flag
     C           QSDFC1    IFNE YARDCS
     C                     MOVE 'Y'       YARDC
     C                     END
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C**********           UPDAT@AHREAU                91  *                                MD061008
     C                     CALL 'SD000119'                                                  MD061008
     C                     PARM '*UPD'    ZMODE                                             MD061008
     C                     PARM           AHFLNM                                            MD061008
     C                     PARM           AHNORC                                            MD061008
     C                     PARM           AHNOIN                                            MD061008
     C                     PARM           AHNOAM                                            MD061008
     C                     PARM           AHNODL                                            MD061008
     C                     PARM *BLANKS   ZRETRN                                            MD061008
      *                                                                                     MD061008
     C                     SETOF                     91                                     MD061008
     C           ZRETRN    IFNE *BLANKS                                                     MD061008
     C                     SETON                     91                                     MD061008
     C                     ENDIF                                                            MD061008
      *                                                                                     MD061008
     C                     ELSE
      * Release record lock
     C**********           UNLCKSDFCTLL0               91  *                                MD061008
     C                     END
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     END
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPDLRC    BEGSR
      *================================================================
      * Delete Securities Clients - Securities Clients  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data update
      * CASE: PAR.Action Code is Delete
     C           P3ANCD    IFEQ 'D'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Function key not allowed'
     C                     MOVEL'USR0533' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     MOVEL'Y2U0004' W0RTN            *Return code
     C                     GOTO TPEXIT                     *QUIT
     C                     END                             *FI
      **Start*of*Fix*E16464********************************************                     AR906833
      **Check*for*Depot*Position*-*Securities*Clients******************                     AR906833
     C**********           MOVEL#1CUST    CUSTNO  60                                   E16464 CSD027
     C**********           MOVEL#1CUST    CUSTNO  6                                  CSD027 AR906833
     C********** CUSTNO    CHAINCDEPC                90                              E16464 AR906833
     C********** *IN90     IFEQ '0'                                                  E16464 AR906833
     C**Customer*has*a*positon.****************************************              E16464 AR906833
     C**********           MOVE 'Y'       WUPOSN                                     E16464 AR906833
     C**********           ELSE                                                      E16464 AR906833
     C**********           MOVE 'N'       WUPOSN                                     E16464 AR906833
     C/COPY WNCPYSRC,SD0341RC07
     C**********           END                                                       E16464 AR906833
      *                                                                   E16464
      **CASE:*WRK.Position*is*Position*Present*************************                     AR906833
     C********** WUPOSN    IFEQ 'Y'                        *IF                              AR906833
      **Send*message*'Position*Present*no*Delet'***********************                     AR906833
     C**********           MOVEL'USR1515' ZAMSID                                            AR906833
     C**********           EXSR ZASNMS                                                      AR906833
     C**********           SETON                     99    *                                AR906833
      *
     C**********           MOVEL'Y2U0004' W0RTN            *Return code                     AR906833
     C**********           GOTO TPEXIT                     *QUIT                            AR906833
     C**********           END                             *FI                              AR906833
      **End*of*Fix*E16464**********************************************                     AR906833
      *                                                                                     AR906833
     C                     CALL 'SD0340U'              90                                   AR906833
     C                     PARM           #1CUST                                            AR906833
     C           @0RTN     PARM *BLANK    @0RTN   7                                         AR906833
     C           @UCDS2    PARM *BLANK    @UD200200                                         AR906833
     C           @UCDS3    PARM *BLANK    @UD400200                                         AR906833
     C                     PARM 'N'       @QUIT   1                                         AR906833
     C                     PARM 'C'       @ACTN   1                                         AR906833
      *                                                                                     AR906833
     C           *IN90     IFEQ '1'                                                         AR906833
      *                                                                                     AR906833
      ** Call to program ended in error                                                     AR906833
      *                                                                                     AR906833
     C                     MOVEL'Y2U0032' W0RTN                                             AR906833
     C                     MOVEL*BLANKS   W0CLPG                                            AR906833
     C                     MOVEL'SD0340U' W0CLPG                                            AR906833
      *                                                                                     AR906833
      ** Send message '*Error occured on CALL...'                                           AR906833
      *                                                                                     AR906833
     C                     MOVEL'Y2U0032' ZAMSID                                            AR906833
     C                     MOVEL'Y2USRMSG'ZAMSGF                                            AR906833
     C                     MOVELW0CLPG    ZAMSDA                                            AR906833
     C                     EXSR ZASNMS                                                      AR906833
     C                     SETON                     99                                     AR906833
     C                     GOTO TPEXIT                                                      AR906833
     C                     ENDIF                                                            AR906833
      *                                                                                     AR906833
     C           @0RTN     IFEQ 'REJECT'                                                    AR906833
      *                                                                                     AR906833
     C           @UD213    IFEQ 'F'                                                         AR906833
     C                     MOVEL'USR1515' W0RTN                                             AR906833
     C                     MOVEL'USR1515' ZAMSID                                            AR906833
     C                     MOVEL'SDUSRMSG'ZAMSGF                                            AR906833
     C                     EXSR ZASNMS                                                      AR906833
     C                     SETON                     99                                     AR906833
     C                     GOTO TPEXIT                                                      AR906833
     C                     ENDIF                                                            AR906833
      *                                                                                     AR906833
     C           @UD214    IFEQ 'F'                                                         AR906833
     C                     MOVEL'USR2225' W0RTN                                             AR906833
     C                     MOVEL'USR2225' ZAMSID                                            AR906833
     C                     MOVEL'SDUSRMSG'ZAMSGF                                            AR906833
     C                     EXSR ZASNMS                                                      AR906833
     C                     SETON                     99                                     AR906833
     C                     GOTO TPEXIT                                                      AR906833
     C                     ENDIF                                                            AR906833
      *                                                                                     AR906833
     C           @UD215    IFEQ 'F'                                                         AR906833
     C                     MOVEL'USR2225' W0RTN                                             AR906833
     C                     MOVEL'USR2225' ZAMSID                                            AR906833
     C                     MOVEL'SDUSRMSG'ZAMSGF                                            AR906833
     C                     EXSR ZASNMS                                                      AR906833
     C                     SETON                     99                                     AR906833
     C                     GOTO TPEXIT                                                      AR906833
     C                     ENDIF                                                            AR906833
      *                                                                                     AR906833
     C           @UD216    IFEQ 'F'                                                         AR906833
     C                     MOVEL'USR2227' W0RTN                                             AR906833
     C                     MOVEL'USR2227' ZAMSID                                            AR906833
     C                     MOVEL'SDUSRMSG'ZAMSGF                                            AR906833
     C                     EXSR ZASNMS                                                      AR906833
     C                     SETON                     99                                     AR906833
     C                     GOTO TPEXIT                                                      AR906833
     C                     ENDIF                                                            AR906833
      *                                                                                     AR906833
     C           @UD217    IFEQ 'F'                                                         AR906833
     C                     MOVEL'USR2227' W0RTN                                             AR906833
     C                     MOVEL'USR2227' ZAMSID                                            AR906833
     C                     MOVEL'SDUSRMSG'ZAMSGF                                            AR906833
     C                     EXSR ZASNMS                                                      AR906833
     C                     SETON                     99                                     AR906833
     C                     GOTO TPEXIT                                                      AR906833
     C                     ENDIF                                                            AR906833
      *                                                                                     AR906833
     C           @UD219    IFEQ 'F'                                                         AR906833
     C                     MOVEL'USR2228' W0RTN                                             AR906833
     C                     MOVEL'USR2228' ZAMSID                                            AR906833
     C                     MOVEL'SDUSRMSG'ZAMSGF                                            AR906833
     C                     EXSR ZASNMS                                                      AR906833
     C                     SETON                     99                                     AR906833
     C                     GOTO TPEXIT                                                      AR906833
     C                     ENDIF                                                            AR906833
      *                                                                                     AR906833
     C           @UD220    IFEQ 'F'                                                         AR906833
     C                     MOVEL'USR2228' W0RTN                                             AR906833
     C                     MOVEL'USR2228' ZAMSID                                            AR906833
     C                     MOVEL'SDUSRMSG'ZAMSGF                                            AR906833
     C                     EXSR ZASNMS                                                      AR906833
     C                     SETON                     99                                     AR906833
     C                     GOTO TPEXIT                                                      AR906833
     C                     ENDIF                                                            AR906833
      *                                                                                     AR906833
     C           @UD221    IFEQ 'F'                                                         AR906833
     C                     MOVEL'USR2076' W0RTN                                             AR906833
     C                     MOVEL'USR2076' ZAMSID                                            AR906833
     C                     MOVEL'SDUSRMSG'ZAMSGF                                            AR906833
     C                     EXSR ZASNMS                                                      AR906833
     C                     SETON                     99                                     AR906833
     C                     GOTO TPEXIT                                                      AR906833
     C                     ENDIF                                                            AR906833
      *                                                                                     AR906833
     C           @UD222    IFEQ 'F'                                                         AR906833
     C                     MOVEL'USR2076' W0RTN                                             AR906833
     C                     MOVEL'USR2076' ZAMSID                                            AR906833
     C                     MOVEL'SDUSRMSG'ZAMSGF                                            AR906833
     C                     EXSR ZASNMS                                                      AR906833
     C                     SETON                     99                                     AR906833
     C                     GOTO TPEXIT                                                      AR906833
     C                     ENDIF                                                            AR906833
      *                                                                                     AR906833
     C           @UD223    IFEQ 'F'                                                         AR906833
     C                     MOVEL'USR2230' W0RTN                                             AR906833
     C                     MOVEL'USR2230' ZAMSID                                            AR906833
     C                     MOVEL'SDUSRMSG'ZAMSGF                                            AR906833
     C                     EXSR ZASNMS                                                      AR906833
     C                     SETON                     99                                     AR906833
     C                     GOTO TPEXIT                                                      AR906833
     C                     ENDIF                                                            AR906833
      *                                                                                     AR906833
     C           @UD224    IFEQ 'F'                                                         AR906833
     C                     MOVEL'USR2231' W0RTN                                             AR906833
     C                     MOVEL'USR2231' ZAMSID                                            AR906833
     C                     MOVEL'SDUSRMSG'ZAMSGF                                            AR906833
     C                     EXSR ZASNMS                                                      AR906833
     C                     SETON                     99                                     AR906833
     C                     GOTO TPEXIT                                                      AR906833
     C                     ENDIF                                                            AR906833
      *                                                                                     AR906833
     C           @UD225    IFEQ 'F'                                                         AR906833
     C                     MOVEL'USR2077' W0RTN                                             AR906833
     C                     MOVEL'USR2077' ZAMSID                                            AR906833
     C                     MOVEL'SDUSRMSG'ZAMSGF                                            AR906833
     C                     EXSR ZASNMS                                                      AR906833
     C                     SETON                     99                                     AR906833
     C                     GOTO TPEXIT                                                      AR906833
     C                     ENDIF                                                            AR906833
      *                                                                                     AR906833
     C           @UD226    IFEQ 'F'                                                         AR906833
     C                     MOVEL'USR2232' W0RTN                                             AR906833
     C                     MOVEL'USR2232' ZAMSID                                            AR906833
     C                     MOVEL'SDUSRMSG'ZAMSGF                                            AR906833
     C                     EXSR ZASNMS                                                      AR906833
     C                     SETON                     99                                     AR906833
     C                     GOTO TPEXIT                                                      AR906833
     C                     ENDIF                                                            AR906833
      *                                                                                     AR906833
     C           @UD227    IFEQ 'F'                                                         AR906833
     C                     MOVEL'USR2233' W0RTN                                             AR906833
     C                     MOVEL'USR2233' ZAMSID                                            AR906833
     C                     MOVEL'SDUSRMSG'ZAMSGF                                            AR906833
     C                     EXSR ZASNMS                                                      AR906833
     C                     SETON                     99                                     AR906833
     C                     GOTO TPEXIT                                                      AR906833
     C                     ENDIF                                                            AR906833
      *                                                                                     AR906833
     C           @UD228    IFEQ 'F'                                                         AR906833
     C                     MOVEL'USR2233' W0RTN                                             AR906833
     C                     MOVEL'USR2233' ZAMSID                                            AR906833
     C                     MOVEL'SDUSRMSG'ZAMSGF                                            AR906833
     C                     EXSR ZASNMS                                                      AR906833
     C                     SETON                     99                                     AR906833
     C                     GOTO TPEXIT                                                      AR906833
     C                     ENDIF                                                            AR906833
      *                                                                                     AR906833
     C           @UD229    IFEQ 'F'                                                         AR906833
     C                     MOVEL'USR2235' W0RTN                                             AR906833
     C                     MOVEL'USR2235' ZAMSID                                            AR906833
     C                     MOVEL'SDUSRMSG'ZAMSGF                                            AR906833
     C                     EXSR ZASNMS                                                      AR906833
     C                     SETON                     99                                     AR906833
     C                     GOTO TPEXIT                                                      AR906833
     C                     ENDIF                                                            AR906833
      *                                                                                     AR906833
     C                     ENDIF                                                            AR906833
      * Start of SAR S01212
      * CASE: WRK.Window processing requir. is Yes
     C           WUWDPR    IFEQ 'Y'                        *IF
      * 00/Copy Member SD0341RDBW - Securities Clients  *
     C*00/Copy Member SD0341R   Proc Before Delete - WN
     C/COPY WNCPYSRC,SD0341RDBW
     C                     END                             *FI
      * 00/Copy Member SD0341RDBU - Securities Clients  *
     C*00/Copy Member SD0341R   Processing Before Delete
     C/COPY WNCPYSRC,SD0341RDBU
      * End of SAR S01212
      * Move key fields to @BFREDP
     C                     MOVEL#1CUST    BFCUST           Customer Number
      *
     C           KLDLTP    KLIST
     C                     KFLD           BFCUST           Customer Number
     C           KLDLTP    CHAIN@BFREDP              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TPEXIT
     C                     END
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TPEXIT
     C                     END
      *
      * Check for changed record
     C           #1DBRC    IFNE @1DBRC                     IF
     C                     MOVEL'Y2U0007' W0RTN   7
      * Send message '*Update not accepted'
     C                     MOVEL'Y2U0007' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
      * Release record lock
     C           KLDLTP    SETLL@BFREDP              9091  *
     C                     GOTO TPEXIT
     C                     END                             FI #1DBRC
      *................................................................
     C                     DELET@BFREDP                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * DBF delete successful
      * USER: Processing after Data update
      * Start of change 122096
      * WUDELR Data Structure - SD Deleted Records File  *
     C                     MOVEL@1DBRC    WUDELR
      * Write Deleted Record - SD Deleted Records File  *
     C                     CLEARPBRC
     C                     MOVEL'SDSECSPD'PBFNME           File name
     C                     MOVEL#1CUST    PBLKEY           Long Key
     C                     MOVELWUDR01    PBDR01           Deleted Data Re
     C                     MOVELWUDR02    PBDR02           Deleted Data Re
     C                     MOVELWUDR03    PBDR03           Deleted Data Re
     C                     MOVELWUDR04    PBDR04           Deleted Data Re
     C                     MOVELWUDR05    PBDR05           Deleted Data Re
     C                     MOVELWUDR06    PBDR06           Deleted Data Re
     C                     MOVELWUDR07    PBDR07           Deleted Data Re
     C                     MOVELWUDR08    PBDR08           Deleted Data Re
     C                     MOVELWUDR09    PBDR09           Deleted Data Re
     C                     MOVELWUDR00    PBDR00           Deleted Data Re
     C                     MOVELWUDR11    PBDR11           Deleted Data Re
     C                     MOVELWUDR12    PBDR12           Deleted Data Re
     C                     Z-ADDWURDNB    PBLCD            Last Change Dat
     C                     MOVEL'D'       PBTYLC           Type of Last Ch
      *
     C                     CALL 'SD0520X'              90  Write Deleted R
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: SD Deleted
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0520X' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * End of change 122096
     C                     Z-ADD-1        WUNORC           No. of Records
     C                     Z-ADD1         WUNODL           No. of Deletes
     C                     Z-ADD*ZERO     WUNOIN           No. of Inserts
     C                     Z-ADD*ZERO     WUNOAM           No. of Amends
      * Change Standing Data Cont - Standing Data Controls  *
     C                     EXSR TQCHRC
     C                     MOVEL'D'       WUTYLC           Type of Last Ch
      * Update CLINTSE - Securities Clients  *
     C                     CALL 'CLINTSE'              90  Update CLINTSE
     C           W0RTN     PARM *BLANK    WQ0086  7        *Return code
     C                     PARM BFCUST    WQ0087  6        Customer Number
     C**********           PARM BFACCD    WQ0088  4        Account Code                       CGL029
     C                     PARM BFACCD    WQ0088 10                                           CGL029
     C                     PARM BFPCYC    WQ0089  3        Portfolio curre
     C                     PARM BFCYCD    WQ0090  3        Currency Code
     C                     PARM BFADCD    WQ0091  1        Address Code
     C                     PARM BFACSN    WQ0092  20       Account sequenc
     C                     PARM BFCLAS    WQ0093  1        Classification
     C                     PARM BFDRF1    WQ0094  6        Depot Reference
     C                     PARM BFDRF2    WQ0095  6        Depot Reference
     C                     PARM BFDRF3    WQ0096  6        Depot Reference
     C                     PARM BFDRF4    WQ0097  6        Depot Reference
     C                     PARM BFDRF5    WQ0098  6        Depot Reference
     C                     PARM BFDRF6    WQ0099  6        Depot Reference
     C                     PARM BFDRF7    WQ0100  6        Depot Reference
     C                     PARM BFDRF8    WQ0101  6        Depot Reference
     C                     PARM BFDRF9    WQ0102  6        Depot Reference
     C                     PARM BFDRF0    WQ0103  6        Depot Reference
     C                     PARM BFPNP1    WQ0104  2        Part./Non-part.
     C                     PARM BFPNP2    WQ0105  2        Part./Non-part.
     C                     PARM BFPNP3    WQ0106  2        Part./Non-part.
     C                     PARM BFPNP4    WQ0107  2        Part./Non-part.
     C                     PARM BFPNP5    WQ0108  2        Part./Non-part.
     C                     PARM BFPNP6    WQ0109  2        Part./Non-part.
     C                     PARM BFPNP7    WQ0110  2        Part./Non-part.
     C                     PARM BFPNP8    WQ0111  2        Part./Non-part.
     C                     PARM BFPNP9    WQ0112  2        Part./Non-part.
     C                     PARM BFPNP0    WQ0113  2        Part./Non-part.
     C                     PARM BFCFIN    WQ0114  1        Cedel Fungibili
     C                     PARM BFSTFQ    WQ0115  1        Statement frequ
     C                     PARM BFNSDT    WQ0116  50       Next statement
     C                     PARM BFSBDM    WQ0117  20       Stat.Base Date
     C                     PARM BFPLAG    WQ0118  1        Pledge Agreemen
     C                     PARM BFNARR    WQ0119 35        Narrative
     C                     PARM BFNTFC    WQ0120  50       No. of Trades f
     C                     PARM BFSRCD    WQ0121  5        Statutory retur
     C                     PARM BFTCD     WQ0122  2        Tax Code
     C                     PARM BFASIN    WQ0123  1        Auto-Settle Ind
     C                     PARM WURDNB    WQ0124  50       Run day number
     C                     PARM WUTYLC    WQ0125  1        Type of Last Ch
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CLINTSE' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Start of SAR S01117
      * CASE: PAR.mode is From midas menu
     C           P4MODE    IFEQ 'M'                        *IF
     C                     MOVEL'N'       WUF3PR           F3 Pressed
     C                     END                             *FI
      * End of SAR S01117
      * Start of SAR S01212
      * 00/Copy Member SD0341RDAU - Securities Clients  *
     C*00/Copy Member SD0341R   Processing After Delete
     C/COPY WNCPYSRC,SD0341RDAU
      * End of SAR S01212
     C                     END
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQCHRC    BEGSR
      *================================================================
      * Change Standing Data Cont - Standing Data Controls  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE 'N'       YBRDC   1
      *
      * Move key fields to @AHREAU
     C                     MOVE *BLANK    AHFLNM           Filename
     C                     MOVEL'SDSECSPD'AHFLNM           Filename
      *
     C           KLCHTQ    KLIST
     C                     KFLD           AHFLNM           Filename
     C********** KLCHTQ    CHAIN@AHREAU              9091  *                                MD061008
     C                     CALL 'SD000119'                                                  MD061008
     C                     PARM '*RTV'    ZMODE   4                                         MD061008
     C                     PARM           AHFLNM 10                                         MD061008
     C                     PARM 0         AHNORC  50                                        MD061008
     C                     PARM 0         AHNOIN  50                                        MD061008
     C                     PARM 0         AHNOAM  50                                        MD061008
     C                     PARM 0         AHNODL  50                                        MD061008
     C                     PARM *BLANKS   ZRETRN 10                                         MD061008
      *                                                                                     MD061008
     C                     SETOF                     9091                                   MD061008
     C           ZRETRN    IFEQ '*NRF'                                                      MD061008
     C                     SETON                     90                                     MD061008
     C                     ENDIF                                                            MD061008
     C           ZRETRN    IFEQ '*ERROR'                                                    MD061008
     C                     SETON                     91                                     MD061008
     C                     ENDIF                                                            MD061008
      *                                                                                     MD061008
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TQEXIT
     C                     END
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     GOTO TQEXIT
     C                     END
      *
      * Store record data for null update check
     C                     MOVE QSDFC1    YBRDCS
      * USER: Processing after Data read
     C                     ADD  AHNORC    WUNORC           No. of Records
     C                     ADD  AHNOIN    WUNOIN           No. of Inserts
     C                     ADD  AHNOAM    WUNOAM           No. of Amends
     C                     ADD  AHNODL    WUNODL           No. of Deletes
      * Move non-key fields to @AHREAU
     C                     Z-ADDWUNORC    AHNORC           No. of Records
     C                     Z-ADDWUNOIN    AHNOIN           No. of Inserts
     C                     Z-ADDWUNOAM    AHNOAM           No. of Amends
     C                     Z-ADDWUNODL    AHNODL           No. of Deletes
      *
      * Set PGM.*Record Data Changed flag
     C           QSDFC1    IFNE YBRDCS
     C                     MOVE 'Y'       YBRDC
     C                     END
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C**********           UPDAT@AHREAU                91  *                                MD061008
     C                     CALL 'SD000119'                                                  MD061008
     C                     PARM '*UPD'    ZMODE                                             MD061008
     C                     PARM           AHFLNM                                            MD061008
     C                     PARM           AHNORC                                            MD061008
     C                     PARM           AHNOIN                                            MD061008
     C                     PARM           AHNOAM                                            MD061008
     C                     PARM           AHNODL                                            MD061008
     C                     PARM *BLANKS   ZRETRN                                            MD061008
      *                                                                                     MD061008
     C                     SETOF                     91                                     MD061008
     C           ZRETRN    IFNE *BLANKS                                                     MD061008
     C                     SETON                     91                                     MD061008
     C                     ENDIF                                                            MD061008
      *                                                                                     MD061008
     C                     ELSE
      * Release record lock
     C**********           UNLCKSDFCTLL0               91  *                                MD061008
     C                     END
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     END
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         TRCHRC    BEGSR
      *================================================================
      * Change Securities Clients - Securities Clients  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE 'N'       YCRDC   1
      *
      * Move key fields to @BFREDP
     C                     MOVEL#1CUST    BFCUST           Customer Number
      *
     C           KLCHTR    KLIST
     C                     KFLD           BFCUST           Customer Number
     C           KLCHTR    CHAIN@BFREDP              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TREXIT
     C                     END
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     GOTO TREXIT
     C                     END
      *
      * Check for changed record
     C           #1DBRC    IFNE @1DBRC                     IF
     C                     MOVEL'Y2U0007' W0RTN   7
      * Send message '*Update not accepted'
     C                     MOVEL'Y2U0007' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
      * Release record lock
     C                     UNLCKSDSECSL0               91  *
     C                     GOTO TREXIT
     C                     END                             FI #1DBRC
      * Store record data for null update check
     C                     MOVE @1DBRC    YCRDCS
      * Move non-key fields to @BFREDP
     C                     MOVEL#1ACCD    BFACCD           Account Code
     C                     MOVEL#1PCYC    BFPCYC           Portfolio curre
     C                     MOVEL#1CYCD    BFCYCD           Currency Code
     C                     MOVEL#1ADCD    BFADCD           Address Code
     C                     Z-ADDWURDNB    BFLCD            Last Change Dat
     C                     MOVEL'A'       BFTYLC           Type of Last Ch
     C                     Z-ADD#1ACSN    BFACSN           Account sequenc
     C                     MOVEL#1CLAS    BFCLAS           Classification
     C                     MOVEL#1DRF1    BFDRF1           Depot Reference
     C                     MOVEL#1DRF2    BFDRF2           Depot Reference
     C                     MOVEL#1DRF3    BFDRF3           Depot Reference
     C                     MOVEL#1DRF4    BFDRF4           Depot Reference
     C                     MOVEL#1DRF5    BFDRF5           Depot Reference
     C                     MOVEL#1DRF6    BFDRF6           Depot Reference
     C                     MOVEL#1DRF7    BFDRF7           Depot Reference
     C                     MOVEL#1DRF8    BFDRF8           Depot Reference
     C                     MOVEL#1DRF9    BFDRF9           Depot Reference
     C                     MOVEL#1DRF0    BFDRF0           Depot Reference
     C                     MOVEL#1PNP1    BFPNP1           Part./Non-part.
     C                     MOVEL#1PNP2    BFPNP2           Part./Non-part.
     C                     MOVEL#1PNP3    BFPNP3           Part./Non-part.
     C                     MOVEL#1PNP4    BFPNP4           Part./Non-part.
     C                     MOVEL#1PNP5    BFPNP5           Part./Non-part.
     C                     MOVEL#1PNP6    BFPNP6           Part./Non-part.
     C                     MOVEL#1PNP7    BFPNP7           Part./Non-part.
     C                     MOVEL#1PNP8    BFPNP8           Part./Non-part.
     C                     MOVEL#1PNP9    BFPNP9           Part./Non-part.
     C                     MOVEL#1PNP0    BFPNP0           Part./Non-part.
     C                     MOVEL#1CFIN    BFCFIN           Cedel Fungibili
     C                     MOVEL#1STFQ    BFSTFQ           Statement frequ
     C                     Z-ADD#1NSDT    BFNSDT           Next statement
     C                     Z-ADD#1SBDM    BFSBDM           Stat.Base Date
     C                     MOVEL#1PLAG    BFPLAG           Pledge Agreemen
     C                     MOVEL#1NARR    BFNARR           Narrative
     C                     Z-ADD#1NTFC    BFNTFC           No. of Trades f
     C                     MOVEL#1SRCD    BFSRCD           Statutory retur
     C                     MOVEL#1TCD     BFTCD            Tax Code
     C                     MOVEL#1ASIN    BFASIN           Auto-Settle Ind
     C                     MOVEL#1SBJF    BFSBJF           Subject to Cust
     C                     MOVEL#1CFGC    BFCFGC           Custody Fees Gr
     C                     MOVEL#1TDCG    BFTDCG           Trade Charges G
     C                     MOVEL#1PSCG    BFPSCG           Position Settl.
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YCRDCS
     C                     MOVE 'Y'       YCRDC
     C                     END
      * USER: Processing before Data update
      * Start of SAR S01212
      * CASE: WRK.Window processing requir. is Yes
     C           WUWDPR    IFEQ 'Y'                        *IF
      * 00/Copy Member SD0341RBUW - Securities Clients  *
     C*00/Copy Member SD0341R   Before Update, Window on
     C/COPY WNCPYSRC,SD0341RBUW
     C                     END                             *FI
      * 00/Copy Member SD0341RBDU - Securities Clients  *
     C*00/Copy Member SD0341R   Processing Before Update
     C/COPY WNCPYSRC,SD0341RBDU
      * End of SAR S01212
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YCRDCS
     C                     MOVE 'Y'       YCRDC
     C                     END
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
      *                                                                                       204139
     C           BFTMST    IFEQ *BLANKS                                                       204139
     C                     MOVE TIMEST    BFTMST                                              204139
     C                     ENDIF                                                              204139
      *                                                                                       204139
     C                     UPDAT@BFREDP                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKSDSECSL0               91  *
     C                     END
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * Update saved record image
     C                     MOVEL@1DBRC    #1DBRC
      * DBF change successful
      * USER: Processing after Data update
     C                     Z-ADD*ZERO     WUNORC           No. of Records
     C                     Z-ADD*ZERO     WUNOIN           No. of Inserts
     C                     Z-ADD*ZERO     WUNODL           No. of Deletes
     C                     Z-ADD1         WUNOAM           No. of Amends
      * Change Standing Data Cont - Standing Data Controls  *
     C                     EXSR TSCHRC
      * Update CLINTSE - Securities Clients  *
     C                     CALL 'CLINTSE'              90  Update CLINTSE
     C           W0RTN     PARM *BLANK    WQ0126  7        *Return code
     C                     PARM BFCUST    WQ0127  6        Customer Number
     C**********           PARM BFACCD    WQ0128  4        Account Code                       CGL029
     C                     PARM BFACCD    WQ0128 10                                           CGL029
     C                     PARM BFPCYC    WQ0129  3        Portfolio curre
     C                     PARM BFCYCD    WQ0130  3        Currency Code
     C                     PARM BFADCD    WQ0131  1        Address Code
     C                     PARM BFACSN    WQ0132  20       Account sequenc
     C                     PARM BFCLAS    WQ0133  1        Classification
     C                     PARM BFDRF1    WQ0134  6        Depot Reference
     C                     PARM BFDRF2    WQ0135  6        Depot Reference
     C                     PARM BFDRF3    WQ0136  6        Depot Reference
     C                     PARM BFDRF4    WQ0137  6        Depot Reference
     C                     PARM BFDRF5    WQ0138  6        Depot Reference
     C                     PARM BFDRF6    WQ0139  6        Depot Reference
     C                     PARM BFDRF7    WQ0140  6        Depot Reference
     C                     PARM BFDRF8    WQ0141  6        Depot Reference
     C                     PARM BFDRF9    WQ0142  6        Depot Reference
     C                     PARM BFDRF0    WQ0143  6        Depot Reference
     C                     PARM BFPNP1    WQ0144  2        Part./Non-part.
     C                     PARM BFPNP2    WQ0145  2        Part./Non-part.
     C                     PARM BFPNP3    WQ0146  2        Part./Non-part.
     C                     PARM BFPNP4    WQ0147  2        Part./Non-part.
     C                     PARM BFPNP5    WQ0148  2        Part./Non-part.
     C                     PARM BFPNP6    WQ0149  2        Part./Non-part.
     C                     PARM BFPNP7    WQ0150  2        Part./Non-part.
     C                     PARM BFPNP8    WQ0151  2        Part./Non-part.
     C                     PARM BFPNP9    WQ0152  2        Part./Non-part.
     C                     PARM BFPNP0    WQ0153  2        Part./Non-part.
     C                     PARM BFCFIN    WQ0154  1        Cedel Fungibili
     C                     PARM BFSTFQ    WQ0155  1        Statement frequ
     C                     PARM BFNSDT    WQ0156  50       Next statement
     C                     PARM BFSBDM    WQ0157  20       Stat.Base Date
     C                     PARM BFPLAG    WQ0158  1        Pledge Agreemen
     C                     PARM BFNARR    WQ0159 35        Narrative
     C                     PARM BFNTFC    WQ0160  50       No. of Trades f
     C                     PARM BFSRCD    WQ0161  5        Statutory retur
     C                     PARM BFTCD     WQ0162  2        Tax Code
     C                     PARM BFASIN    WQ0163  1        Auto-Settle Ind
     C                     PARM WURDNB    WQ0164  50       Run day number
     C                     PARM BFTYLC    WQ0165  1        Type of Last Ch
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CLINTSE' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
      * Send message 'Unable to update'
     C                     MOVEL'USR0015' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * Start of SAR S01212
      * 00/Copy Member SD0341RADU - Securities Clients  *
     C*00/Copy Member SD0341R   Processing After Update
     C/COPY WNCPYSRC,SD0341RADU
      * End of SAR S01212
     C                     END
      *================================================================
     CSR         TREXIT    ENDSR
      /EJECT
     CSR         TSCHRC    BEGSR
      *================================================================
      * Change Standing Data Cont - Standing Data Controls  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE 'N'       YDRDC   1
      *
      * Move key fields to @AHREAU
     C                     MOVE *BLANK    AHFLNM           Filename
     C                     MOVEL'SDSECSPD'AHFLNM           Filename
      *
     C           KLCHTS    KLIST
     C                     KFLD           AHFLNM           Filename
     C********** KLCHTS    CHAIN@AHREAU              9091  *                                MD061008
     C                     CALL 'SD000119'                                                  MD061008
     C                     PARM '*RTV'    ZMODE   4                                         MD061008
     C                     PARM           AHFLNM 10                                         MD061008
     C                     PARM 0         AHNORC  50                                        MD061008
     C                     PARM 0         AHNOIN  50                                        MD061008
     C                     PARM 0         AHNOAM  50                                        MD061008
     C                     PARM 0         AHNODL  50                                        MD061008
     C                     PARM *BLANKS   ZRETRN 10                                         MD061008
      *                                                                                     MD061008
     C                     SETOF                     9091                                   MD061008
     C           ZRETRN    IFEQ '*NRF'                                                      MD061008
     C                     SETON                     90                                     MD061008
     C                     ENDIF                                                            MD061008
     C           ZRETRN    IFEQ '*ERROR'                                                    MD061008
     C                     SETON                     91                                     MD061008
     C                     ENDIF                                                            MD061008
      *                                                                                     MD061008
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TSEXIT
     C                     END
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     GOTO TSEXIT
     C                     END
      *
      * Store record data for null update check
     C                     MOVE QSDFC1    YDRDCS
      * USER: Processing after Data read
     C                     ADD  AHNORC    WUNORC           No. of Records
     C                     ADD  AHNOIN    WUNOIN           No. of Inserts
     C                     ADD  AHNOAM    WUNOAM           No. of Amends
     C                     ADD  AHNODL    WUNODL           No. of Deletes
      * Move non-key fields to @AHREAU
     C                     Z-ADDWUNORC    AHNORC           No. of Records
     C                     Z-ADDWUNOIN    AHNOIN           No. of Inserts
     C                     Z-ADDWUNOAM    AHNOAM           No. of Amends
     C                     Z-ADDWUNODL    AHNODL           No. of Deletes
      *
      * Set PGM.*Record Data Changed flag
     C           QSDFC1    IFNE YDRDCS
     C                     MOVE 'Y'       YDRDC
     C                     END
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C**********           UPDAT@AHREAU                91  *                                MD061008
     C                     CALL 'SD000119'                                                  MD061008
     C                     PARM '*UPD'    ZMODE                                             MD061008
     C                     PARM           AHFLNM                                            MD061008
     C                     PARM           AHNORC                                            MD061008
     C                     PARM           AHNOIN                                            MD061008
     C                     PARM           AHNOAM                                            MD061008
     C                     PARM           AHNODL                                            MD061008
     C                     PARM *BLANKS   ZRETRN                                            MD061008
      *                                                                                     MD061008
     C                     SETOF                     91                                     MD061008
     C           ZRETRN    IFNE *BLANKS                                                     MD061008
     C                     SETON                     91                                     MD061008
     C                     ENDIF                                                            MD061008
      *                                                                                     MD061008
     C                     ELSE
      * Release record lock
     C**********           UNLCKSDFCTLL0               91  *                                MD061008
     C                     END
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     END
      *================================================================
     CSR         TSEXIT    ENDSR
      /EJECT
     CSR         TTRVGN    BEGSR
      *================================================================
      * Retrieve Autocharges - Securities Trading Data  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTT     KLIST
     C                     KFLD           BVSCTR           Securities Trad
      * Move fields to key list
     C                     MOVE *BLANK    BVSCTR           Securities Trad
     C                     MOVEL'STRD'    BVSCTR           Securities Trad
     C           KRSTT     CHAIN@BVREFF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0239' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * Setup message data for message
     C                     MOVEL'SDSTRDPD'ZA0130           Filename
      * Send message 'Database Error (ICD)'
     C                     MOVEL'USR0377' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO TTEXIT                     *QUIT
     C                     GOTO TTEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBVACOP    WUACOP           Autocharge Opti
     C                     END
      *================================================================
     CSR         TTEXIT    ENDSR
      /EJECT
     CSR         TURVGN    BEGSR
      *================================================================
      * Retrieve Safe Custody Ind - Securities Trading Data  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTU     KLIST
     C                     KFLD           BVSCTR           Securities Trad
      * Move fields to key list
     C                     MOVE *BLANK    BVSCTR           Securities Trad
     C                     MOVEL'STRD'    BVSCTR           Securities Trad
     C           KRSTU     CHAIN@BVREFF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0239' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * Setup message data for message
     C                     MOVEL'SDSTRDPD'ZA0131           Filename
      * Send message 'Database Error (ICD)'
     C                     MOVEL'USR0377' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO TUEXIT                     *QUIT
     C                     GOTO TUEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBVCUIN    WUCUIN           Safe Custody Fe
     C                     END
      *================================================================
     CSR         TUEXIT    ENDSR
      /EJECT
     CSR         TVRVGN    BEGSR
      *================================================================
      * retrieve client - Securities Clients  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTV     KLIST
     C                     KFLD           BFCUST           Customer Number
      * Move fields to key list
     C                     MOVELP1CUST    BFCUST           Customer Number
     C           KRSTV     CHAIN@BFREDQ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0094' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TVEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     END
      *================================================================
     CSR         TVEXIT    ENDSR
      /EJECT
     CSR         TWRVGN    BEGSR
      *================================================================
      * Get 'Window required' ind - MIDAS Modules  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTW     KLIST
     C                     KFLD           BGMODS           Modules
      * Move fields to key list
     C                     MOVE *BLANK    BGMODS           Modules
     C                     MOVEL'MMOD'    BGMODS           Modules
     C           KRSTW     CHAIN@BGREC8              90    *
      * Data record not found
     C   90                MOVEL'USR0096' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Window processing requir. is Yes
     C           BGWDPR    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUWDPR           Window processi
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         TWEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * S01219 -  SE customer details enhancements
      *================================================================
      * Start of SAR S01219
      * Access *DTAARA SESTAT - Standard Functions  * S01219
     C                     CALL 'SDC0521U'             90  Access *DTAARA
     C           WUPPLC    PARM *BLANK    WQ0020  1        Portfolio Proc'
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SDC0521U'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * CASE: WRK.Portfolio Proc'g Licensed is Not Allowed
     C           WUPPLC    IFEQ *BLANK                     *IF
     C           WUPPLC    OREQ 'N'
      * CASE: DTL.Classification is Equal to S or D
     C           #1CLAS    IFEQ 'D'                        *IF
     C           #1CLAS    OREQ 'S'
      * Setup message data for message
     C                     MOVEL#1CLAS    ZA0018           Classification
      * Send message 'Invalid Classification...'
     C                     MOVEL'USR0575' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * start E25679
      * Allow statement frequency, next statement date and statement
      * base date for classification I as well as S, D or M
      * CASE: DTL.Classification is Not S, D, I or M
     C           #1CLAS    IFEQ 'C'                        *IF
     C           #1CLAS    OREQ 'X'
     C           #1CLAS    OREQ 'E'
     C********** #1CLAS    OREQ 'K'                                                           CSE022
      * end E25679
      * CASE: DTL.Statement frequency is not blank
     C           #1STFQ    IFEQ 'T'                        *IF
     C           #1STFQ    OREQ 'D'
     C           #1STFQ    OREQ 'F'
     C           #1STFQ    OREQ 'L'
     C           #1STFQ    OREQ 'B'
     C           #1STFQ    OREQ 'M'
     C           #1STFQ    OREQ 'A'
     C           #1STFQ    OREQ 'Z'
     C           #1STFQ    OREQ 'H'
     C           #1STFQ    OREQ 'P'
     C           #1STFQ    OREQ 'K'
     C           #1STFQ    OREQ 'G'
     C           #1STFQ    OREQ 'Q'
     C           #1STFQ    OREQ 'S'
     C           #1STFQ    OREQ 'X'
     C           #1STFQ    OREQ 'W'
     C           #1STFQ    OREQ 'Y'
     C           #1STFQ    OREQ 'R'
      * Setup message data for message
     C                     MOVEL#1STFQ    ZA0019           Statement frequ
     C                     MOVEL#1CLAS    ZA0020           Classification
      * Send message 'Stat. Freq. must be blank'
     C                     MOVEL'USR0599' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993631*
      *
     C                     END                             *FI
      * CASE: DTL.ST next statement date is Not Blank
     C           #DSNSD    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DSNSD    ZA0021           ST next stateme
     C                     MOVEL#1CLAS    ZA0022           Classification
      * Send message 'Next Stat. must be blank'
     C                     MOVEL'USR0600' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993731*
      *
     C                     END                             *FI
      * CASE: DTL.Stat.Base Date in Month is Not Blank
     C           #1SBDM    IFNE *ZERO                      *IF
      * Setup message data for message
     C                     MOVEL#1CLAS    ZA0023           Classification
     C                     Z-ADD#1SBDM    ZA0024           Stat.Base Date
      * Send message 'Stat. B.D. must be blank'
     C                     MOVEL'USR0625' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * End of SAR S01219
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Select existing record
      *================================================================
      * Name search required?
     C                     MOVEL#1CUST    WK1X01  1
     C           WK1X01    IFEQ '?'                        Customer Number
     C                     CALL 'SD0340S'              90  Select Securiti
     C                     PARM *BLANK    W0RTN   7
     C           #1CUST    PARM #1CUST    WQ0009  6        Customer Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0340S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9931  *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to Client Details
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1CUST    WK1X01  1
     C           WK1X01    IFEQ '?'                        Customer Number
     C                     CALL 'SD0010S'              90  Select Client D
     C                     PARM *BLANK    W0RTN   7
     C           #1CUST    PARM #1CUST    WQ0010  6        Customer Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0010S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9931  *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VBEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1CUST    IFEQ *BLANK                     Customer Number
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBBB    KLIST
     C                     KFLD           BBCUST           Customer Number
      * Setup key
     C                     MOVEL#1CUST    BBCUST           Customer Number
     C           KLVBBB    CHAIN@BBREBF              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
      * Send message 'Client Details         NF'
     C                     MOVEL'USR0081' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0081' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Account Codes
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1ACCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Account Code
     C                     CALL 'SD0031S'              90  Select Account
     C                     PARM *BLANK    W0RTN   7
     C********** #1ACCD    PARM #1ACCD    WQ0015  4        Account Code                       CGL029
     C           #1ACCD    PARM #1ACCD    WQ0015 10                                           CGL029
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0031S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9934  *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1ACCD    IFEQ *BLANK                     Account Code
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCA5    KLIST
     C                     KFLD           A5ACCD           Account Code
      * Setup key
     C                     MOVEL#1ACCD    A5ACCD           Account Code
     C           KLVCA5    CHAIN@A5REA6              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Account Codes          NF'
     C                     MOVEL'USR0069' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0069' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check reference to Currency Codes
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1PCYC    WK1X01  1
     C           WK1X01    IFEQ '?'                        Currency Code
     C                     CALL 'SD0020S'              90  Select Currency
     C                     PARM *BLANK    W0RTN   7
     C           #1PCYC    PARM #1PCYC    WQ0016  3        Currency Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0020S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9932  *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VDEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1PCYC    IFEQ *BLANK                     Currency Code
     C                     GOTO VDEXIT
     C                     END
      *
     C           KLVDA6    KLIST
     C                     KFLD           A6CYCD           Currency Code
      * Setup key
     C                     MOVEL#1PCYC    A6CYCD           Currency Code
     C           KLVDA6    CHAIN@A6REA3              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VDEXIT
     C                     END
      * Send message 'Currency Codes         NF'
     C                     MOVEL'USR0071' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0071' W0RTN
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         VECKRL    BEGSR
      *================================================================
      * Check reference to Currency Codes
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1CYCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Currency Code
     C                     CALL 'SD0020S'              90  Select Currency
     C                     PARM *BLANK    W0RTN   7
     C           #1CYCD    PARM #1CYCD    WQ0017  3        Currency Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0020S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9933  *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VEEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1CYCD    IFEQ *BLANK                     Currency Code
     C                     GOTO VEEXIT
     C                     END
      *
     C           KLVEA6    KLIST
     C                     KFLD           A6CYCD           Currency Code
      * Setup key
     C                     MOVEL#1CYCD    A6CYCD           Currency Code
     C           KLVEA6    CHAIN@A6REA3              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VEEXIT
     C                     END
      * Send message 'Currency Codes         NF'
     C                     MOVEL'USR0071' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0071' W0RTN
      *================================================================
     CSR         VEEXIT    ENDSR
      /EJECT
     CSR         VFCKRL    BEGSR
      *================================================================
      * Check reference to Alternate Names & Address
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1CUST    WK1X01  1
     C                     MOVEL#1ADCD    WK1X02  1
     C           WK1X01    IFEQ '?'                        Customer Number
     C           WK1X02    OREQ '?'                        Address Code
     C                     CALL 'SD0300S'              90  Select Alt Name
     C                     PARM *BLANK    W0RTN   7
     C           #1CUST    PARM #1CUST    WQ0018  6        Customer Number
     C           #1ADCD    PARM #1ADCD    WQ0019  1        Address Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0300S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9939  *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VFEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1ADCD    IFEQ *BLANK                     Address Code
     C                     GOTO VFEXIT
     C                     END
      *
     C           KLVFBC    KLIST
     C                     KFLD           BCCUST           Customer Number
     C                     KFLD           BCADCD           Address Code
      * Setup key
     C                     MOVEL#1CUST    BCCUST           Customer Number
     C                     MOVEL#1ADCD    BCADCD           Address Code
     C           KLVFBC    CHAIN@BCREDE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VFEXIT
     C                     END
      * Send message 'Alternate Names & Addr NF'
     C                     MOVEL'USR0083' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0083' W0RTN
      *================================================================
     CSR         VFEXIT    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y1SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y1EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C           @#DFMT    IFEQ '#RCDKEY'
      * KEY Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     END
     C           @#DFMT    IFEQ '#RCDDTL1'
      * DETAIL Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     END
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM 1         YYLGCT  50       # of grps
     C                     PARM W0GRP     YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel and exit from key screen
      *================================================================
      * USER: Exit program processing
      * Start of SAR S01212
      * 00/Copy Member SD0341REPP - Securities Clients  *
     C*00/Copy Member SD0341R   Exit Program Processing
     C/COPY WNCPYSRC,SD0341REPP
      * End of SAR S01212
      * CASE: WRK.F3 Pressed is No
     C           WUF3PR    IFEQ 'N'                        *IF
      * Start of SAR S01117
      * If enter is pressed ensure that the return code is blank
     C                     MOVEL*BLANK    W0RTN            *Return code
      * End of SAR S01117
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y2U9999' W0RTN            *Return code
     C                     END                             *FI
      * Exit Program - No ROLBK - Standard Functions  *
     C                     MOVE W0RTN     P0RTN
     C                     SETON                     LR
     C                     RETRN
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * ROLLBACK any uncommitted DBF changes
     C           CSC022    IFEQ 'N'                                                           CSC022
     C                     ROLBK                       90
     C                     ELSE                                                               CSC022
     C           WSKIP     IFNE 'Y'                                                           CSC022
     C                     ROLBK                       90                                     CSC022
     C                     ELSE                                                               CSC022
     C                     SETON                     U7U8                                     CSC022
     C                     ENDIF                                                              CSC022
     C                     ENDIF                                                              CSC022
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
      *                                                                                       CSC022
      ** Access SAR details file to determine if CSC022 is on.                                CSC022
     C                     MOVE 'N'       CSC022  1                                           CSC022
     C                     MOVE 'N'       WSKIP   1                                           CSC022
      *                                                                                       CSC022
     C                     CALL 'AOSARDR0'                                                    CSC022
     C                     PARM *BLANKS   @RTCD   7                                           CSC022
     C                     PARM '*VERIFY' @OPTN   7                                           CSC022
     C                     PARM 'CSC022'  @SARD   6                                           CSC022
     C           SCSARD    PARM SCSARD    DSFDY                                               CSC022
      *                                                                                       CSC022
     C           @RTCD     IFNE *BLANKS                                                       CSC022
     C           @RTCD     ANDNE'*NRF   '                                                     CSC022
     C                     MOVEL'SCSARDPD'DBFILE                                              CSC022
     C                     Z-ADD1         DBASE                                               CSC022
     C                     MOVEL'CSC022'  DBKEY                                               CSC022
     C                     EXSR *PSSR                                                         CSC022
     C                     ENDIF                                                              CSC022
      *                                                                                       CSC022
     C           @RTCD     IFEQ *BLANKS                                                       CSC022
     C                     MOVE 'Y'       CSC022                                              CSC022
     C           *NAMVAR   DEFN SCCMTJOB  SCCMT                                               CSC022
     C                     IN   SCCMT                                                         CSC022
      *                                                                                       CSC022
     C           WCMTNO    IFGT 0                                                             CSC022
     C                     MOVEAWCMTJB    WCMTAR                                              CSC022
     C           ##JOB     LOKUPWCMTAR                   10                                   CSC022
     C           *IN10     IFEQ *ON                                                           CSC022
     C                     MOVE 'Y'       WSKIP                                               CSC022
     C                     ENDIF                                                              CSC022
     C                     ENDIF                                                              CSC022
     C                     ENDIF                                                              CSC022
      *                                                                                       CSC022
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C/COPY WNCPYSRC,SD0341RC04
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Setup job date/time
      *
     C                     Z-ADDUDATE     ##JDT
      * Set century digit (If YY prior to 1940 treat as 20YY)
     C           ##JYY     IFLT 40
     C                     Z-ADD1         ##JCC
     C                     ELSE
     C                     Z-ADD0         ##JCC
     C                     END
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Depot 1 (EUROCLEAR)
     C                     MOVEL*BLANK    WUDR1   6
      **Define*work*field*Depot*Ref*3,*Kassenverein********************                       CSE022
      *                                                                                       CSE022
      ** Define work field Depot Ref 3                                                        CSE022
      *                                                                                       CSE022
     C                     MOVEL*BLANK    WUDR3   6
      * Define work field Depot Reference 10 Custom
     C                     MOVEL*BLANK    WUDR10  6
      * Define work field Depot Reference 2 - Cedel
     C                     MOVEL*BLANK    WUDR2   6
      * Define work field Depot Reference 4 Custome
     C                     MOVEL*BLANK    WUDR4   6
      * Define work field Depot Reference 5 Custome
     C                     MOVEL*BLANK    WUDR5   6
      * Define work field Depot Reference 6 Custome
     C                     MOVEL*BLANK    WUDR6   6
      * Define work field Depot Reference 7 Custome
     C                     MOVEL*BLANK    WUDR7   6
      * Define work field Depot Reference 8 Custome
     C                     MOVEL*BLANK    WUDR8   6
      * Define work field Depot Reference 9 Custome
     C                     MOVEL*BLANK    WUDR9   6
      * Obtain default message file
     C           *NAMVAR   DEFN Y2MGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Deletion Allowed
     C                     MOVEL*BLANK    WUDELA  1
      * Define work field Date format flag
     C                     MOVEL*BLANK    WUDFF   1
      * Define work field Work Converted Date
     C                     Z-ADD*ZERO     WUWCDT  60
      * Define work field Work Alpha Date
     C                     MOVEL*BLANK    WUWADT  7
      * Define work field ZALIGN Screen Fun Field
     C                     MOVEL*BLANK    WUZASF 16
      * Define work field F3 Pressed
     C                     MOVEL*BLANK    WUF3PR  1
      * Define work field Safe Custody Fees Flag
     C                     MOVEL*BLANK    WUCUIN  1
      * Define work field SAR S01496
     C                     MOVEL*BLANK    WUJYSK  1
      * Define work field Test ? in Key Field
     C                     MOVEL*BLANK    WUTQKF  1
      * Define work field Work Charge Group
     C                     MOVEL*BLANK    WUCUGR  2
      * Define work field Access Pgm Return Code
     C                     MOVEL*BLANK    WUAPRC  7
      * Define work field Access Object Fmt (200)
     C                     MOVEL*BLANK    WUAOF2200
      * Define work field Portfolio Proc'g Licensed
     C                     MOVEL*BLANK    WUPPLC  1
      * Define work field Currency Code
     C                     MOVEL*BLANK    WUCYCD  3
      * Define work field Dealing Currency Ind.
     C                     MOVEL*BLANK    WUDLCI  1
      * Define work field Account type
     C                     MOVEL*BLANK    WUACTY  1
      * Define work field Title Only Indicator
     C                     MOVEL*BLANK    WUTOIN  1
      * Define work field ZALIGN File Field
     C                     MOVEL*BLANK    WUZAFF 16
      * Define work field Err Code
     C                     MOVEL*BLANK    WUERCD  1
      * Define work field Work Screen Date
     C                     Z-ADD*ZERO     WUWSDT  60
      * Define work field Run day number
     C                     Z-ADD*ZERO     WURDNB  50
      * Define work field Midas Run Date
     C                     MOVEL*BLANK    WUMRDT  7
      * Define work field save date format flag
     C                     MOVEL*BLANK    WUSDFF  1
      * Define work field Charge/Commission Code
     C                     MOVEL*BLANK    WUCCOM  2
      * Define work field Valid Range
     C                     MOVEL*BLANK    WUVLRG  1
      * Define work field Within Range 00001-99999
     C                     MOVEL*BLANK    WUWTRG  1
      * Define work field Workfield on customer
     C                     MOVEL*BLANK    WUWCUS  6
      * Define work field Classification
     C                     MOVEL*BLANK    WUCLAS  1
      * Define work field Window processing requir.
     C                     MOVEL*BLANK    WUWDPR  1
      * Define work field No. of Records
     C                     Z-ADD*ZERO     WUNORC  50
      * Define work field No. of Amends
     C                     Z-ADD*ZERO     WUNOAM  50
      * Define work field No. of Deletes
     C                     Z-ADD*ZERO     WUNODL  50
      * Define work field No. of Inserts
     C                     Z-ADD*ZERO     WUNOIN  50
      * Define work field Position
     C**********           MOVEL*BLANK    WUPOSN  1                                         AR906833
      * Define work field Deleted Data Record Pt1
     C                     MOVEL*BLANK    WUDR01250
      * Define work field Deleted Data Record Pt2
     C                     MOVEL*BLANK    WUDR02250
      * Define work field Deleted Data Record Pt3
     C                     MOVEL*BLANK    WUDR03250
      * Define work field Deleted Data Record Pt4
     C                     MOVEL*BLANK    WUDR04250
      * Define work field Deleted Data Record Pt5
     C                     MOVEL*BLANK    WUDR05250
      * Define work field Deleted Data Record Pt6
     C                     MOVEL*BLANK    WUDR06250
      * Define work field Deleted Data Record Pt7
     C                     MOVEL*BLANK    WUDR07250
      * Define work field Deleted Data Record Pt8
     C                     MOVEL*BLANK    WUDR08250
      * Define work field Deleted Data Record Pt9
     C                     MOVEL*BLANK    WUDR09250
      * Define work field Deleted Data Record Pt10
     C                     MOVEL*BLANK    WUDR00250
      * Define work field Deleted Data Record Pt11
     C                     MOVEL*BLANK    WUDR11250
      * Define work field Deleted Data Record Pt12
     C                     MOVEL*BLANK    WUDR12250
      * Define work field Type of Last Change
     C                     MOVEL*BLANK    WUTYLC  1
      * Define work field Autocharge Option
     C                     MOVEL*BLANK    WUACOP  1
      * Define work field Set Up Complete
     C                     MOVEL*BLANK    WUSUC   1
      * Define work field Multi-branching Indicator
     C                     MOVEL*BLANK    WUMBIN  1
      * Define work field SAR number field
     C                     MOVEL*BLANK    WUSARN  6
      * Define work field Access obj dummy DS (76)
     C                     MOVEL*BLANK    WUFDY  76
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Open files
      * Begin commit control
     C                     CALL 'Y2BGCMC'
     C                     PARM           W0RTN   7
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'CPF8351'
     C                     EXSR ZYEXPG
     C                     END
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C/COPY WNCPYSRC,SD0341RC21
     C                     OPEN SD0341R#
     C/COPY WNCPYSRC,SD0341RC22
     C                     OPEN SDSECSL1
     C                     OPEN SDCUSTL1
     C                     OPEN SDSTRDL1
     C                     OPEN SDACODL1
     C                     OPEN SDCURRL1
     C                     OPEN SDALTNL1
     C                     OPEN SDBANKL1
     C                     OPEN SECGTDL2
     C                     OPEN SDMMODL1
     C                     OPEN SDSECSL0
     C**********           OPEN SDFCTLL0                                                    MD061008
     C                     MOVEL'N'       W0PMT   1
      * Select initial mode
     C           @1NROP    IFEQ *ZERO
      * Add mode
     C                     MOVEL'ADD'     W0PMD   3
     C                     ELSE
      * Change mode
     C                     MOVEL'CHG'     W0PMD
     C                     END
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * Start of S01459
      * Remove last amend box user source
      * Remove creation parameter user source
      * SD0341R precompiler - Securities Clients  *
      * End of S01459
      * Get Rundate - Rundate  *
     C           *NAMVAR   DEFN           RUNDAT
     C                     IN   RUNDAT
     C                     MOVE MRDT      ##MRDT  7        RUN DATE
     C                     MOVE MRDT      WUMRDT
     C                     MOVE RDNB      WURDNB           RUNDAY NO.
     C                     MOVE SUC       WUSUC            SET UP COMPLT
     C                     MOVE DFF       WUDFF            DTE FMT FLAG
     C                     MOVE MBIN      WUMBIN           MULTI BR. IND
      * Copyright Statement 1988 - Standard Functions  * copyright
     C                     MOVELWUDFF     WUSDFF           save date forma
      * Retrieve Autocharges - Securities Trading Data  *
     C                     EXSR TTRVGN
      * Clients DTL Screen Footer - Standard Functions  *
     C*
     C                     MOVEL'SDUSRMSG'WUMSGF 10
     C                     MOVE *BLANKS   WUMTXT 80
     C*
     C           P3ANCD    IFEQ 'D'                                       S01229
     C           P4MODE    IFEQ 'M'                                       S01229
     C* Setup footer text:
     C* F3=Main Menu   F10=Delete   F12=Previous
     C                     MOVEL'USR3350' WUMSID  7        Message Identifier
     C                     CALL 'SDRTVTXT'             90  Retrieve MSGF message
     C           WUMSID    PARM WUMSID    WQ0286  7        Message Identifier
     C           WUMSGF    PARM WUMSGF    WQ0287 10        Message File Name
     C           WUMTXT    PARM WUMTXT    WQ0288 80        Message Text
     C                     MOVELWUMTXT    ##CTX1
     C*
     C           *IN90     IFEQ '1'
     C* Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SDRTVTXT'W0CLPG
     C* Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
     C                     ELSE
     C* Setup footer text:
     C* F3=Client Details   F10=Delete   F12=Previous
     C                     MOVEL'USR3339' WUMSID           Message Identifier
     C                     CALL 'SDRTVTXT'             90  Retrieve MSGF message
     C           WUMSID    PARM WUMSID    WQ0286  7        Message Identifier
     C           WUMSGF    PARM WUMSGF    WQ0287 10        Message File Name
     C           WUMTXT    PARM WUMTXT    WQ0288 80        Message Text
     C                     MOVELWUMTXT    ##CTX1
     C*
     C           *IN90     IFEQ '1'
     C* Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SDRTVTXT'W0CLPG
     C* Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
     C                     END
     C                     END
     C           P3ANCD    IFEQ 'A'                                       S01229
     C           P4MODE    IFEQ 'M'                                       S01229
     C* Setup footer text:
     C* F3=Main Menu   F12=Previous
     C                     MOVEL'USR3346' WUMSID           Message Identifier
     C                     CALL 'SDRTVTXT'             90  Retrieve MSGF message
     C           WUMSID    PARM WUMSID    WQ0286  7        Message Identifier
     C           WUMSGF    PARM WUMSGF    WQ0287 10        Message File Name
     C           WUMTXT    PARM WUMTXT    WQ0288 80        Message Text
     C                     MOVELWUMTXT    ##CTX1
     C*
     C           *IN90     IFEQ '1'
     C* Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SDRTVTXT'W0CLPG
     C* Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
     C                     ELSE
     C* Setup footer text:
     C* F3=Client Details   F12=Previous
     C**********           MOVEL'USR3339' WUMSID           Message Identifier                 207057
     C                     MOVEL'USR3340' WUMSID           Message Identifier                 207057
     C                     CALL 'SDRTVTXT'             90  Retrieve MSGF message
     C           WUMSID    PARM WUMSID    WQ0286  7        Message Identifier
     C           WUMSGF    PARM WUMSGF    WQ0287 10        Message File Name
     C           WUMTXT    PARM WUMTXT    WQ0288 80        Message Text
     C                     MOVELWUMTXT    ##CTX1
     C*
     C           *IN90     IFEQ '1'
     C* Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SDRTVTXT'W0CLPG
     C* Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
     C                     END
     C                     END
     C           P3ANCD    IFEQ 'I'                                       S01229
     C           P4MODE    IFEQ 'M'                                       S01229
     C* Setup footer text:
     C* F3=Main Menu   F12=Previous
     C                     MOVEL'USR3346' WUMSID           Message Identifier
     C                     CALL 'SDRTVTXT'             90  Retrieve MSGF message
     C           WUMSID    PARM WUMSID    WQ0286  7        Message Identifier
     C           WUMSGF    PARM WUMSGF    WQ0287 10        Message File Name
     C           WUMTXT    PARM WUMTXT    WQ0288 80        Message Text
     C                     MOVELWUMTXT    ##CTX1
     C*
     C           *IN90     IFEQ '1'
     C* Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SDRTVTXT'W0CLPG
     C* Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
     C                     ELSE
     C* Setup footer text:
     C* F3=Client Details   F12=Previous
     C**********           MOVEL'USR3339' WUMSID           Message Identifier                 207057
     C                     MOVEL'USR3340' WUMSID           Message Identifier                 207057
     C                     CALL 'SDRTVTXT'             90  Retrieve MSGF message
     C           WUMSID    PARM WUMSID    WQ0286  7        Message Identifier
     C           WUMSGF    PARM WUMSGF    WQ0287 10        Message File Name
     C           WUMTXT    PARM WUMTXT    WQ0288 80        Message Text
     C                     MOVELWUMTXT    ##CTX1
     C*
     C           *IN90     IFEQ '1'
     C* Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SDRTVTXT'W0CLPG
     C* Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
     C                     END
     C                     END
     C*
      * Start of change S01464.
      * Check to see if Safe Custody Fees flag is 'Y'.
      * Retrieve Safe Custody Ind - Securities Trading Data  *
     C                     EXSR TURVGN
      * End of change S01464.
      * Start of S01496
      * Define SECUGRPD - Standard Functions  *
      * Check if the Jyske Enhancements feature is present.
     C                     MOVEL'S01496'  WUSARN           SAR number fiel
      * SAR switched on check - Standard Functions  *
     C                     CALL 'AOSARDR0'             90  SAR switched on
     C           WUAPRC    PARM WUAPRC    WQ0166  7        Access Pgm Retu
     C                     PARM '*VERIFY' WQ0167  7        Option for ACCO
     C           WUSARN    PARM WUSARN    WQ0168  6        SAR number fiel
     C                     PARM WUFDY     WQ0169 76        Access obj dumm
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'AOSARDR0'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Check return code.
      * CASE: WRK.Access Pgm Return Code is *Normal
     C           WUAPRC    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       WUJYSK           SAR S01496
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUJYSK           SAR S01496
     C                     END                             *FI
      * End of S01496
     C/COPY WNCPYSRC,SD0341RC06
      *                                                                                       CER001
      ** Check if the Customer Extended details Defautl (SE & PL)                             CER001
      ** is active                                                                            CER001
      *                                                                                       CER001
     C                     MOVEL'PB3610'  WUSARN                                              CER001
      *                                                                                       CER001
      ** SAR switched on check - Standard Functions                                           CER001
      *                                                                                       CER001
     C                     CALL 'AOSARDR0'             90                                     CER001
     C           WUAPRC    PARM WUAPRC    WQ0166  7                                           CER001
     C                     PARM '*VERIFY' WQ0167  7                                           CER001
     C           WUSARN    PARM WUSARN    WQ0168  6                                           CER001
     C                     PARM WUFDY     WQ0169 76                                           CER001
      *                                                                                       CER001
     C           *IN90     IFEQ '1'                                                           CER001
      *                                                                                       CER001
      ** Call to program ended in error                                                       CER001
      *                                                                                       CER001
     C                     MOVEL'Y2U0032' W0RTN                                               CER001
     C                     MOVEL*BLANKS   W0CLPG 10                                           CER001
     C                     MOVEL'AOSARDR0'W0CLPG                                              CER001
      *                                                                                       CER001
      ** Send message '*Error occured on CALL...'                                             CER001
      *                                                                                       CER001
     C                     MOVEL'Y2U0032' ZAMSID                                              CER001
     C                     MOVEL'Y2USRMSG'ZAMSGF                                              CER001
     C                     MOVELW0CLPG    ZAMSDA                                              CER001
     C                     EXSR ZASNMS                                                        CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
      ** Check return code                                                                    CER001
      ** Case: WRK.Access Pgm Return Code is *Normal                                          CER001
      *                                                                                       CER001
     C           WUAPRC    IFEQ *BLANK                                                        CER001
     C                     MOVEL'Y'       PB3610  1                                           CER001
     C                     OPEN SDICEXL1                                                      CER001
     C                     ELSE                                                               CER001
      *                                                                                       CER001
      ** Case: *Otherwise                                                                     CER001
      *                                                                                       CER001
     C                     MOVEL'N'       PB3610                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C                     MOVEL'Y'       WUF3PR           F3 Pressed
      * CASE: PAR.Action Code is Insert
     C           P3ANCD    IFEQ 'I'                        *IF
     C                     MOVEL'ADD'     W0PMD            *Program mode
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'CHG'     W0PMD            *Program mode
     C                     END                             *FI
      * CASE: PAR.mode is From special clients
     C           P4MODE    IFEQ 'S'                        *IF
     C                     ELSE
      * CASE: PAR.Action Code is Amend
     C           P3ANCD    IFEQ 'A'                        *IF
      * retrieve client - Securities Clients  *
     C                     EXSR TVRVGN
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ 'Y2U0003'                  *IF
     C                     MOVEL'CHG'     W0PMD            *Program mode
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'ADD'     W0PMD            *Program mode
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Start of SAR S01212
      * Get 'Window required' ind - MIDAS Modules  *
     C                     EXSR TWRVGN
      * DATA definition for SECS - Securities Clients  *
      * 00/Copy Member SD0341RIPG - Securities Clients  *
     C/COPY WNCPYSRC,SD0341RCPG
      * End of SAR S01212
      *================================================================
     CSR         ZZEXIT    ENDSR
      /EJECT
     CSR         *PSSR     BEGSR
      *****************************************************************
      *                                                               *
      * *PSSR  - Program exception error routine                      *
      *          Called automatically if a program error occurs,      *
      *          or directly by the program code using EXSR.          *
      *          This subroutine DUMPs the program just once.         *
      *                                                               *
      *****************************************************************
      *
      * Core function specific processing.
      *
     C/COPY WNCPYSRC,SD0341RPSC
      *
      * Start of PSSR user point.
      *
     C/COPY WNCPYSRC,SD0341RPS1
      *
      * Standard Midas PSSR processing.
      *
     C/COPY SDCPYSRC,SDPSSRINT
      *
      * End of PSSR user point.
      *
     C/COPY WNCPYSRC,SD0341RPS2
      *
      *================================================================
     CSR                   ENDSR
      *================================================================
     O/COPY WNCPYSRC,SD0341ROPG
** ZMNM
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** CPY@     : Copyright notice for inclusion in all programs
(c) Finastra International Limited 2001
