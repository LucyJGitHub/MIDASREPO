     H            Y
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas SD Extended settle aud/req rpt prt file')        *
     H/TITLE Extended Settle Aud/Req   Print file
     F*****************************************************************
     F*                                                               *
     F*  Midas - STANDING DATA MODULES
     F*                                                               *
     F*  SD0400P - EXTENDED SETTLEMENTS Aud/Req Report                *
     F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
     F*                                                               *
      *  Last Amend No. CDL094             Date 30May14               *
      *  Prev Amend No. CSD095             Date 08Apr14               *
      *                 AR993239A          Date 27Jun12               *
      *                 AR993366           Date 21Jun12               *
      *                 AR993257           Date 21Jun12               *
      *                 AR992080           Date 19Jun12               *
      *                 CSW212             Date 03May12               *
      *                 AR787620           Date 10Jun11               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSW037A            Date 02May05               *
      *                 BUG6198            Date 04Apr05               *
      *                 CSD025             Date 11Jan05               *
      *                 CDL031             Date 05Dec04               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 165608             Date 10Nov00               *
      * Midas DBA 3.04 -----------------------------------------------*
      * Midas DBA 3.03 -----------------------------------------------*
      *                 CSW200             Date 21Aug00               *
      * Midas DBA 3.02 -----------------------------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*                 CEU003             Date 05Nov97               *
     F*                 CSW005             Date 01Aug96               *
     F*                 101810             DATE 23May96               *
     F*                 060053             DATE 07Jan94               *
     F*                 057135             DATE 05AUG93               *
     F*                 E26786             DATE 30JUL91               *
     F*                 S01117             DATE 03MAY90               *
     F*                 S01117             DATE 20APR90               *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  CDL094 - Enhance  Receive Settlement Instructions            *
      *  CSD095 - Allow Deal Sub-Type and Branch for MM FX SSI's      *
      *  AR993239A - Incorrect Sender to Receiver and Condition field *
      *              names                                            *
      *  AR993366 - Incorrect value for ISDA Agreement Version        *
      *  AR993257 - Incorrect mapping for Sender to Receiver Cover    *
      *             message                                           *
      *  AR992080 - Remove FX from the descriptions of Sender to      *
      *             Receiver cover and confirmation fields            *
      *  CSW212 - SWIFT 2012 Changes                                  *
      *  AR787620 - Hooks Incorporation                               *
      *             WNCPYSRC,SDH00092                                 *
      *             WNCPYSRC,SDH00093                                 *
      *             WNCPYSRC,SDH00094                                 *
      *             WNCPYSRC,SDH00095                                 *
      *             WNCPYSRC,SDH00096                                 *
      *             WNCPYSRC,SDH00097                                 *
      *             WNCPYSRC,SDH00098                                 *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  BUG6198- Cannot save new Details for CUSD (Recompile)        *
      *  CSD025 - Customer De-Activation                              *
     F*  CDL031 - Effective Date on Extended SSI (Recompile)          *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
     F*  165608 - Incorrect page alignment in SD0400P.  Fix is to     *
     F*           set indicator L0 to 'Y' to print the header whenever*
     F*           there is a change in Currency Code/Customer Number/ *
     F*           Transaction Type.  Partially applied 121204.        *
     F*  CSW200 - SWIFT 2000 Changes                                  *
     F*  CEU003 - EMU Dealing Settlement Ccy Conversion               *
     F*  CSW005 - MG34n and MG36n message generation                  *
     F*  101810 - Only retrieve "Customer Shortname" if "Customer     *
     F*           Number" is not blank.                               *
     F*  060053 - Print '* Customer Not Found *' on report if cust.   *
     F*           number not on file.                                 *
     F*  057135 - Recompile for changes in printer file SD0400PM.     *
     F*           (Customer Report Name changed to 20A, Customer      *
     F*           Town changed to 10A, same as length on file)        *
     F*  E26786 - Add Customer Short Name, Report Name, Report        *
     F*           Town and Cover MT202 flag to report.                *
     F*  S01117 - Include Dummy Parameter                             *
     F*  S01117 - Rel 10 Multi-branching changes                      *
     F*                                                               *
     F*****************************************************************
     Z* CRTRPGPGM
      *
     H* SYNOPSIS :
     H* - Print report of file contents.
     H* Generated by  : Synon/2  Version:  8646
     H* Function type : Print file  Version:   0.1
      *
     H* Company    : Midas Standing Data
     H* System     : Midas Standing Data
     H* User name  : C7602SYN
     H* Date       : 17/01/90 time: 18:30:16
      *  (c) Misys International Banking Systems Ltd. 2001            *
     H*
      *================================================================
     M* Maintenance   :
     F*****************************************************************
     F/COPY WNCPYSRC,SDH00173
     FSDEXSTL1IF  E           K        DISK
      * RTV: Extended Settlements      Retrieval index
      *
     F/COPY WNCPYSRC,SDH00174
     FSDFCTLL1IF  E           K        DISK
      * RTV: Standing Data Controls    Retrieval index
      *
     FSDBANKL1IF  E           K        DISK
      * RTV: Bank Details              Retrieval index
      *
     FSDFCTLL0UF  E           K        DISK
      * UPD: Standing Data Controls    Update index
      *
     FSDCNSTL1IF  E           K        DISK                               E26786
      * RTV: Counterparty Nostros      Retrieval index                    E26786
      *                                                                   E26786
     FSDCUSTL1IF  E           K        DISK                               E26786
      * RTV: Customer details          Retrieval index                    E26786
      *                                                                   E26786
     F*SD0400P$O   E             97     PRINTER                           S01117
     FSD0400PMO   E             97     PRINTER                            S01117
     F                                              KINFDS INFDS$
     F/COPY WNCPYSRC,SD0400PF01
      * PRT: Extended Settle Aud/Req   Print file
      *
     E                    UAR        53  1
     E                    ULN        53  1
     E                    UARRAY  1   2 26
      *
      ** SAVE INDICATOR *IN 99
      *
     E                    @CN     1  11 25               Long constants.
     E                    @CZ     1  14 25               Long constants.  E26786
     E                    ERRNAR  1   1 22               Error Narrative  060053
      *                                                                                       CSW212
      ** SWIFT 2012 Changes                                                                   CSW212
      *                                                                                       CSW212
     E**********          CONF1   1   2 30                                          CSW212 AR993239A
     E                    CONF1   1   3 30                                                 AR993239A
     E                    CONF2   1   2 30                                                    CSW212
     E                    CONF3   1   2 30                                                    CSW212
      /EJECT
      * Data structures:-
     IPGMDS     ESDSY2PGDSP
      * Program data structure.
     IJBDTTM      DS
      * Job date/time.
     I                                        1   60##JDT
     I                                        1   20##JYY
     I                                        3   40##JMM
     I                                        5   60##JDD
     I                                        7  120##JTM
     I                                        7   80##JHH
     I                                        9  100##JNN
     I                                       11  120##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure.
      *
     IRUNDAT      DS
     I                                        1   7 MRDT
     I                                    P   8  100RDNB
     I                                       11  11 SUC
     I                                       12  12 DFF
     I                                       13  13 MBIN
      /EJECT
      * Parameter declarations.
     IP1PARM      DS
      * I:    Audit/Request Status Ind
     I                                        1   1 P1ARSI
     I*                                                                   S01117
     IP2PARM      DS                                                      S01117
     I* I:    Sequence number                                             S01117
     I                                        1   5 P2RSQN                S01117
     I*                                                                   S01117
     IP3PARM      DS                                                      S01117
     I* I:    Entity                                                      S01117
     I                                        1   3 P3ENTY                S01117
     I*                                                                   S01117
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Database Error (ICD)'
      * Filename
     I                                        1  10 ZA0001
     I/COPY WNCPYSRC,SD0400PI01
     I*                                                                   CSW005
     ISCSARD    E DSSCSARDPD                                              CSW005
     I** EXTERNAL DS FOR SAR DETAILS                                      CSW005
     I*                                                                   CSW005
     IDSFDY     E DSDSFDY                                                 CSW005
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                CSW005
     IDSSDY     E DSDSSDY                                                 CEU003
      **  Second data structure for Access Programs, long DS              CEU003
      *                                                                   CSW005
     I              'SSIBranch'           C         P@BRCA                                    CSD095
     I              'SSIDealSubtype_Trans'C         P@STYP                                    CSD095
      /EJECT
      *****************************************************************
     C           *ENTRY    PLIST                           Entry parameter
     C                     PARM           P0RTN   7        Return code
     C           P1ARSI    PARM           WP0001  1        Audit/Request S
     C           P2RSQN    PARM           WP0002  5        Sequence numberS01117
     C                     PARM           @@PARM  1        Dummy Parm     S01117
     C           P3ENTY    PARM           WP0003  3        Entity         S01117
      *****************************************************************
      * Initialise
     C/COPY WNCPYSRC,SD0400PC17
     C                     EXSR ZZINIT
      *
      * Clear overflow indicator.
     C                     SETOF                     97
      * Establish starting position.
     C/COPY WNCPYSRC,SDH00092
     C           *LOVAL    SETLL@BYREFY                    *
     C/COPY WNCPYSRC,SDH00093
      * Read first record.
     C/COPY WNCPYSRC,SDH00094
     C                     READ @BYREFY                  90*
     C/COPY WNCPYSRC,SD0400PC18
     C                     MOVEL*IN90     W0EOF   1
      * Print null report headings.
     C           W0EOF     IFEQ '1'
     C                     WRITEZZPAGHDR
     C                     WRITEZZENDRPT
     C                     ELSE
      * Request all headings.
     C                     MOVEL'Y'       L0      1        Page headings
     C                     MOVEL'Y'       L1      1        Currency Code
     C                     MOVEL'Y'       L2      1        Customer Number
      * Initialise final totals.
     C                     MOVEL*BLANK    ZTCON            *CON (Screen co
     C                     Z-ADD*ZERO     ZTNCRC           No of Calculate
      * Print report body.
     C           W0EOF     DOWEQ'0'
      **Print headings.************************************************   165608
     C**********           EXSR BAPRHD                                    165608
     C/COPY WNCPYSRC,SD0400PC27
      * Print report detail line.
     C                     EXSR CAPRDT
      * Hold current values.
     C           *LIKE     DEFN BYCYCD    WZCYCD           Currency Code
     C                     MOVELBYCYCD    WZCYCD
     C           *LIKE     DEFN BYCUST    WZCUST           Customer Number
     C                     MOVELBYCUST    WZCUST
     C           *LIKE     DEFN BYTRTY    WZTRTY           Transaction Typ165608
     C                     MOVELBYTRTY    WZTRTY                          165608
     C           *LIKE     DEFN BYBRCA    WZBRCA                                              CSD095
     C                     MOVELBYBRCA    WZBRCA                                              CSD095
     C           *LIKE     DEFN BYSTYP    WZSTYP                                              CSD095
     C                     MOVELBYSTYP    WZSTYP                                              CSD095
      * Read next record.
     C/COPY WNCPYSRC,SDH00095
     C                     READ @BYREFY                  90*
     C/COPY WNCPYSRC,SD0400PC19
     C           CSW005    IFEQ 'Y'                                       CSW005
     C           CSW011    OREQ 'Y'                                       CSW200
     C           CSW200    ANDEQ'Y'                                       CSW200
     C           CSW212    OREQ 'Y'                                                           CSW212
     C                     MOVEL'Y'       L0      1        Page headings  CSW005
     C                     ENDIF                                          CSW005
     C                     MOVEL*IN90     W0EOF
      * Determine level changes.
     C                     EXSR DALVCH
      * Print totals.
     C/COPY WNCPYSRC,SDH00096
     C                     EXSR EAPRTT
     C/COPY WNCPYSRC,SDH00097
      * Process necessary heading requests
     C                     EXSR FASGHD
     C                     END
     C                     WRITEZZENDRPT
     C                     END
      * Exit program.
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *****************************************************************
      /EJECT
     CSR         BAPRHD    BEGSR
      *================================================================
      * Print report Headers.
      *================================================================
      * Clear column headings control flag.
     C                     MOVEL*BLANK    BAPR    1
      *
     C           L0        IFEQ 'Y'
     C                     WRITEZZPAGHDR
     C                     MOVEL'Y'       BAPR
     C                     END
      *
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         CAPRDT    BEGSR
      *================================================================
      * Print report detail line.
      *================================================================
     C*                                                                   E26786
      * Define Keylist.                                                   E26786
     C           KRSSB     KLIST                                          E26786
     C                     KFLD           BBCUST           Customer NumberE26786
     C*                                                                   E26786
     C           KRSSE     KLIST                                          E26786
     C                     KFLD           AWCPNC           Counterparty NoE26786
     C/COPY WNCPYSRC,SD0400PC26
     C*                                                                   E26786
      * Load detail line.
      *                                                                   CEU003
      ** If CEU003 is supported                                           CEU003
      *                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C                     MOVELBYSTCY    RSTCY   3        Settlement Ccy CEU003
     C                     MOVELBYIERI    RIERI   1        ERI Indicator  CEU003
     C                     ENDIF                                          CEU003
     C/COPY WNCPYSRC,SDH00098
      *                                                                   CEU003
     C                     Z-ADDBYLCD     XRLCD            Last Change Dat
     C                     MOVELBYTYLC    XRTYLC           Type of Last Ch
     C                     MOVELBYBRCA    XRBRCA                                              CSD095
     C                     MOVELBYCYCD    XRCYCD           Currency Code
     C                     MOVEL*BLANK    XRACDT           alpha change da
     C                     MOVEL*BLANK    XRALCH           alpha of last c
     C/COPY WNCPYSRC,SD0400PC01
     C                     MOVELBYCUST    XRCUST           Customer Number
     C/COPY WNCPYSRC,SD0400PC02
     C                     MOVELBYCSSN    XRCSSN           Shortname      E26786
     C                     MOVELBYCRTN    XRCRTN           Report Town    E26786
     C                     MOVELBYCRNM    XRCRNM           Report Name    E26786
     C                     MOVELBYCVMR    XRCVMR           Cover MT202?   E26786
     C                     MOVELBYTRTY    XRTRTY           Transaction Typ
     C                     MOVELBYSTYP    XRSTYP                                              CSD095
     C                     MOVELBYRSTY    XRRSTY           Receipt - Settl
     C                     MOVELBYPSTY    XRPSTY           Pay - Settlemen
     C                     MOVELBYRONO    XRRONO           Receipt - Our N
     C                     MOVELBYPONO    XRPONO           Pay - Our Nostr
     C*****                MOVELBYROBN    XRROBN           Rcpt - Orderin E26786
     C*****                MOVELBYPOBN    XRPOBN           Pay - Ordering E26786
     C*****                MOVELBYROCS    XRROCS           Rcpt - Orderin E26786
     C*****                MOVELBYPOCS    XRPOCS           Pay - Ordering E26786
     C*****                MOVELBYRIBN    XRRIBN           Rcpt - Interme E26786
     C*****                MOVELBYPIBN    XRPIBN           Pay - Intermed E26786
     C/COPY WNCPYSRC,SD0400PC03
     C                     MOVEL*BLANKS   XRROBN           Rcpt - Orderin E26786
     C                     MOVEL*BLANKS   XRPOBN           Pay - Ordering E26786
     C/COPY WNCPYSRC,SD0400PC04
     C                     MOVEL*BLANKS   XRROCS           Rcpt - Orderin E26786
     C                     MOVEL*BLANKS   XRPOCS           Pay - Ordering E26786
     C                     MOVEL*BLANKS   XRRIBN           Rcpt - Interme E26786
     C                     MOVEL*BLANKS   XRPIBN           Pay - Intermed E26786
     C                     MOVELBYRIBL    XRRIBL           Rcpt - I/m Bank
     C                     MOVELBYPIBA    XRPIBA           Pay - I/m Bank
     C*****                MOVELBYRCNO    XRRCNO           Receiver Corre E26786
     C                     MOVEL*BLANKS   XRRCNO           Receiver Corre E26786
     C                     MOVELBYRCAL    XRRCAL           Receiver Corr.
     C*****                MOVELBYRCNB    XRRCNB           Receiver Numbe E26786
     C*****                MOVELBYACBN    XRACBN           A/c With Bank  E26786
     C/COPY WNCPYSRC,SD0400PC05
     C                     MOVEL*BLANKS   XRRCNB           Receiver Numbe E26786
     C                     MOVEL*BLANKS   XRACBN           A/c With Bank  E26786
     C                     MOVELBYACBL    XRACBL           A/c With Bank L
     C*****                MOVELBYBYNB    XRBYNB           Beneficiary Nu E26786
     C/COPY WNCPYSRC,SD0400PC06
     C                     MOVEL*BLANKS   XRBYNB           Beneficiary Nu E26786
     C/COPY WNCPYSRC,SD0400PC07
     C                     MOVELBYBACL    XRBACL           Beneficiary A/c
     C                     MOVELBYDPY1    XRDPY1           Details of Paym
     C                     MOVELBYBBI1    XRBBI1           Bank to Bank In
     C                     MOVELBYDPY2    XRDPY2           Details of Paym
     C                     MOVELBYBBI2    XRBBI2           Bank to Bank In
     C                     MOVELBYDPY3    XRDPY3           Details of Paym
     C                     MOVELBYBBI3    XRBBI3           Bank to Bank In
     C                     MOVELBYDPY4    XRDPY4           Details of Paym
     C                     MOVELBYBBI4    XRBBI4           Bank to Bank In
     C                     MOVELBYDECG    XRDECG           Details of char
     C                     MOVELBYBBI5    XRBBI5           Bank to Bank In
     C                     MOVELBYBBI6    XRBBI6           Bank to Bank In
     C                     MOVE *BLANKS   XRRBB1                                              CDL094
     C                     MOVE *BLANKS   XRRBB2                                              CDL094
     C                     MOVE *BLANKS   XRRBB3                                              CDL094
     C                     MOVE *BLANKS   XRRBB4                                              CDL094
     C                     MOVE *BLANKS   XRRBB5                                              CDL094
     C                     MOVE *BLANKS   XRRBB6                                              CDL094
     C           CDL094    IFEQ 'Y'                                                           CDL094
     C           BYTRTY    IFEQ 'MM'                                                          CDL094
     C           BYTRTY    OREQ 'FX'                                                          CDL094
     C                     MOVELBYRBB1    XRRBB1                                              CDL094
     C                     MOVELBYRBB2    XRRBB2                                              CDL094
     C                     MOVELBYRBB3    XRRBB3                                              CDL094
     C                     MOVELBYRBB4    XRRBB4                                              CDL094
     C                     MOVELBYRBB5    XRRBB5                                              CDL094
     C                     MOVELBYRBB6    XRRBB6                                              CDL094
     C                     ENDIF                                                              CDL094
     C                     ENDIF                                                              CDL094
      *                                                                   CSW005
     C                     MOVELBYDSR1    XDSR1                           CSW005
     C                     MOVELBYDSR2    XDSR2                           CSW005
     C**********           MOVELBYDSR3    XDSR2                                      CSW005 AR993257
     C**********           MOVELBYDSR4    XDSR3                                      CSW005 AR993257
     C**********           MOVELBYDSR5    XDSR4                                      CSW005 AR993257
     C**********           MOVELBYDSR6    XDSR5                                      CSW005 AR993257
     C                     MOVELBYDSR3    XDSR3                                             AR993257
     C                     MOVELBYDSR4    XDSR4                                             AR993257
     C                     MOVELBYDSR5    XDSR5                                             AR993257
     C                     MOVELBYDSR6    XDSR6                                             AR993257
      *                                                                   CSW005
     C                     MOVELBYSSR1    XSSR1                           CSW005
     C                     MOVELBYSSR2    XSSR2                           CSW005
     C                     MOVELBYSSR3    XSSR3                           CSW005
     C                     MOVELBYSSR4    XSSR4                           CSW005
     C                     MOVELBYSSR5    XSSR5                           CSW005
     C                     MOVELBYSSR6    XSSR6                           CSW005
      *                                                                   CSW005
     C                     MOVELBYCND1    XCND1                           CSW005
     C                     MOVELBYCND2    XCND2                           CSW005
     C                     MOVELBYCND3    XCND3                           CSW005
     C                     MOVELBYCND4    XCND4                           CSW005
     C                     MOVELBYCND5    XCND5                           CSW005
     C                     MOVELBYCND6    XCND6                           CSW005
      *                                                                   CSW005
     C                     MOVELBYISDA    XISDA                           CSW005
     C                     MOVELBYAGTY    XAGTY                           CSW005
     C                     MOVELBYAGDT    XAGDT                           CSW005
     C**********           MOVELBYAGVV    XAGVV                                      CSW005 AR993366
     C                     MOVE BYAGVV    XAGVV                                             AR993366
     C                     MOVELBYAGVC    XAGVV                                             AR993366
      *                                                                   CSW005
     C                     MOVEL'Y'       W0PFM
     C*                                                                   E26786
     C** Retrieve shortname - RECEIPT ORDERING BANK                       E26786
     C*                                                                   E26786
     C           BYROBN    IFNE *BLANKS                                   101810
     C                     MOVELBYROBN    BBCUST           Customer NumberE26786
     C                     EXSR SBRVGN                                    E26786
     C** Record found                                                     E26786
     C           *IN90     IFEQ '0'                                       E26786
     C                     MOVEL*BLANK    W0RTN            *Return code   E26786
     C                     MOVE *BLANKS   XRROBN                          060053
     C                     MOVELBBCSSN    XRROBN                          E26786
     C                     ELSE                                           060053
     C                     MOVE *BLANKS   W0RTN                           060053
     C                     MOVE ERRNAR,1  XRROBN                          060053
     C                     MOVELBBCUST    XRROBN                          060053
     C                     END                                            E26786
     C                     END                                            101810
     C*                                                                   E26786
     C** Retrieve shortname - RECEIPT ORDERING CUSTOMER                   E26786
     C*                                                                   E26786
     C           BYROCS    IFNE *BLANKS                                   101810
     C                     MOVELBYROCS    BBCUST           Customer NumberE26786
     C                     EXSR SBRVGN                                    E26786
     C** Record found                                                     E26786
     C           *IN90     IFEQ '0'                                       E26786
     C                     MOVEL*BLANK    W0RTN            *Return code   E26786
     C                     MOVE *BLANKS   XRROCS                          060053
     C                     MOVELBBCSSN    XRROCS                          E26786
     C                     ELSE                                           060053
     C                     MOVE *BLANKS   W0RTN                           060053
     C                     MOVE ERRNAR,1  XRROCS                          060053
     C                     MOVELBBCUST    XRROCS                          060053
     C                     END                                            E26786
     C                     END                                            101810
     C*                                                                   E26786
     C** Retrieve shortname - PAY ORDERING BANK                           E26786
     C*                                                                   E26786
     C           BYPOBN    IFNE *BLANKS                                   101810
     C                     MOVELBYPOBN    BBCUST           Customer NumberE26786
     C                     EXSR SBRVGN                                    E26786
     C** Record found                                                     E26786
     C           *IN90     IFEQ '0'                                       E26786
     C                     MOVEL*BLANK    W0RTN            *Return code   E26786
     C                     MOVE *BLANKS   XRPOBN                          060053
     C                     MOVELBBCSSN    XRPOBN                          E26786
     C                     ELSE                                           060053
     C                     MOVE *BLANKS   W0RTN                           060053
     C                     MOVE ERRNAR,1  XRPOBN                          060053
     C                     MOVELBBCUST    XRPOBN                          060053
     C                     END                                            E26786
     C                     END                                            101810
     C*                                                                   E26786
     C** Retrieve shortname - PAY ORDERING CUSTOMER                       E26786
     C*                                                                   E26786
     C           BYPOCS    IFNE *BLANKS                                   101810
     C                     MOVELBYPOCS    BBCUST           Customer NumberE26786
     C                     EXSR SBRVGN                                    E26786
     C** Record found                                                     E26786
     C           *IN90     IFEQ '0'                                       E26786
     C                     MOVEL*BLANK    W0RTN            *Return code   E26786
     C                     MOVE *BLANKS   XRPOCS                          060053
     C                     MOVELBBCSSN    XRPOCS                          E26786
     C                     ELSE                                           060053
     C                     MOVE *BLANKS   W0RTN                           060053
     C                     MOVE ERRNAR,1  XRPOCS                          060053
     C                     MOVELBBCUST    XRPOCS                          060053
     C                     END                                            E26786
     C                     END                                            101810
     C*                                                                   E26786
     C** Retrieve shortname - RECEIPT INTERMEDIARY BANK                   E26786
     C*                                                                   E26786
      *CASE:     DB1.Rcpt - Intermed Bank No. is Non-Zero                 E26786
     C           BYRIBN    IFNE @CZ,06                     *IF            E26786
      *CASE:     DB1.Rcpt - Intermed Bank No. is Not Blank                E26786
     C           BYRIBN    IFNE *BLANK                     *IF            E26786
      * Rtv C/Pnostro/cust name                                           E26786
     C                     MOVELBYRIBN    AWCPNC           Counterparty NoE26786
      * Retrieve Nostro S/name - Counterparty Nostros  *                  E26786
     C                     EXSR SERVGN                                    E26786
      *CASE:     PGM.*Return code is *Record does not exist               E26786
     C           W0RTN     IFEQ @CZ,05                     *IF            E26786
     C                     MOVELBYRIBN    BBCUST           Customer NumberE26786
      * Retrieve shortname - Client Details  *                            E26786
     C                     EXSR SBRVGN                                    E26786
      *CASE:     PGM.*Return code is *Record does not exist               E26786
     C           W0RTN     IFEQ @CZ,05                     *IF            E26786
      * database error processing                                         E26786
     C***********          MOVEL@CZ,07    WUTRPA  1 Termination ParE26786 060053
     C***********          MOVEL@CZ,08    WUDBEF  5 Database error E26786 060053
     C***********          MOVEL'01'      WUDBEN  2 Database error E26786 060053
     C***********          MOVEL'SD0400P' WUPGNM  8 program name   E26786 060053
     C***********          MOVEL*BLANK    WUDBEK 29 Database error E26786 060053
     C***********          MOVELBYRIBN    WUDBEK    Database error E26786 060053
     C***********          MOVELW0RTN     P0RTN     *Return code   E26786 060053
     C***********          EXSR ZYEXPG                             E26786 060053
     C                     MOVE *BLANKS   W0RTN                           060053
     C                     MOVE ERRNAR,1  XRRIBN                          060053
     C                     MOVELBBCUST    XRRIBN                          060053
     C                     ELSE                                           E26786
     C                     MOVEL*BLANK    XRRIBN           Customer ShortnE26786
     C                     MOVELBBCSSN    XRRIBN           Customer ShortnE26786
     C                     END                             *FI            E26786
     C                     ELSE                                           E26786
      *CASE:     *OTHERWISE                                               E26786
     C                     MOVEL*BLANK    XRRIBN           Customer ShortnE26786
     C                     MOVELBYRIBN    XRRIBN           Customer ShortnE26786
     C                     END                             *FI            E26786
     C                     END                             *FI            E26786
     C                     END                             *FI            E26786
     C*                                                                   E26786
     C** Retrieve shortname - PAY INTERMEDIARY BANK                       E26786
     C*                                                                   E26786
      *CASE:     DB1.Pay - Intermed Bank No. is Non-Zero                  E26786
     C           BYPIBN    IFNE @CZ,06                     *IF            E26786
      *CASE:     DB1.Pay - Intermed Bank No. is Not Blank                 E26786
     C           BYPIBN    IFNE *BLANK                     *IF            E26786
      * Rtv C/Pnostro/cust name                                           E26786
     C                     MOVELBYPIBN    AWCPNC           Counterparty NoE26786
      * Retrieve Nostro S/name - Counterparty Nostros  *                  E26786
     C                     EXSR SERVGN                                    E26786
      *CASE:     PGM.*Return code is *Record does not exist               E26786
     C           W0RTN     IFEQ @CZ,05                     *IF            E26786
     C                     MOVELBYPIBN    BBCUST           Customer NumberE26786
      * Retrieve shortname - Client Details  *                            E26786
     C                     EXSR SBRVGN                                    E26786
      *CASE:     PGM.*Return code is *Record does not exist               E26786
     C           W0RTN     IFEQ @CZ,05                     *IF            E26786
      * database error processing                                         E26786
     C***********          MOVEL@CZ,07    WUTRPA    Termination ParE26786 060053
     C***********          MOVEL@CZ,08    WUDBEF    Database error E26786 060053
     C***********          MOVEL'02'      WUDBEN    Database error E26786 060053
     C***********          MOVEL'SD0400P' WUPGNM    program name   E26786 060053
     C***********          MOVEL*BLANK    WUDBEK    Database error E26786 060053
     C***********          MOVELBYPIBN    WUDBEK    Database error E26786 060053
     C***********          MOVELW0RTN     P0RTN     *Return code   E26786 060053
     C***********          EXSR ZYEXPG                             E26786 060053
     C                     MOVE *BLANKS   W0RTN                           060053
     C                     MOVE ERRNAR,1  XRPIBN                          060053
     C                     MOVELBBCUST    XRPIBN                          060053
     C                     ELSE                                           E26786
     C                     MOVEL*BLANK    XRPIBN           Customer ShortnE26786
     C                     MOVELBBCSSN    XRPIBN           Customer ShortnE26786
     C                     END                             *FI            E26786
     C                     ELSE                                           E26786
      *CASE:     *OTHERWISE                                               E26786
     C                     MOVEL*BLANK    XRPIBN           Customer ShortnE26786
     C                     MOVELBYPIBN    XRPIBN           Customer ShortnE26786
     C                     END                             *FI            E26786
     C                     END                             *FI            E26786
     C                     END                             *FI            E26786
     C*                                                                   E26786
     C** Retrieve shortname - RECEIVER NUMBER                             E26786
     C*                                                                   E26786
      *CASE:     DB1.Receiver Number is Non-Zero                          E26786
     C           BYRCNB    IFNE @CZ,06                     *IF            E26786
      *CASE:     DB1.Receiver Number is Not Blank                         E26786
     C           BYRCNB    IFNE *BLANK                     *IF            E26786
      * Rtv C/Pnostro/cust name                                           E26786
     C                     MOVELBYRCNB    AWCPNC           Counterparty NoE26786
      * Retrieve Nostro S/name - Counterparty Nostros  *                  E26786
     C                     EXSR SERVGN                                    E26786
      *CASE:     PGM.*Return code is *Record does not exist               E26786
     C           W0RTN     IFEQ @CZ,05                     *IF            E26786
     C                     MOVELBYRCNB    BBCUST           Customer NumberE26786
      * Retrieve shortname - Client Details  *                            E26786
     C                     EXSR SBRVGN                                    E26786
      *CASE:     PGM.*Return code is *Record does not exist               E26786
     C           W0RTN     IFEQ @CZ,05                     *IF            E26786
      * database error processing                                         E26786
     C***********          MOVEL@CZ,07    WUTRPA    Termination ParE26786 060053
     C***********          MOVEL@CZ,08    WUDBEF    Database error E26786 060053
     C***********          MOVEL'03'      WUDBEN    Database error E26786 060053
     C***********          MOVEL'SD0400P' WUPGNM    program name   E26786 060053
     C***********          MOVEL*BLANK    WUDBEK    Database error E26786 060053
     C***********          MOVELBYRCNB    WUDBEK    Database error E26786 060053
     C***********          MOVELW0RTN     P0RTN     *Return code   E26786 060053
     C***********          EXSR ZYEXPG                             E26786 060053
     C                     MOVE *BLANKS   W0RTN                           060053
     C                     MOVE ERRNAR,1  XRRCNB                          060053
     C                     MOVELBBCUST    XRRCNB                          060053
     C                     ELSE                                           E26786
     C                     MOVEL*BLANK    XRRCNB           Customer ShortnE26786
     C                     MOVELBBCSSN    XRRCNB           Customer ShortnE26786
     C                     END                             *FI            E26786
     C                     ELSE                                           E26786
      *CASE:     *OTHERWISE                                               E26786
     C                     MOVEL*BLANK    XRRCNB           Customer ShortnE26786
     C                     MOVELBYRCNB    XRRCNB           Customer ShortnE26786
     C                     END                             *FI            E26786
     C                     END                             *FI            E26786
     C                     END                             *FI            E26786
     C*                                                                   E26786
     C** Retrieve shortname - ACCOUNT WITH BANK                           E26786
     C*                                                                   E26786
      *CASE:     DB1.A/c With Bank No. is Non-Zero                        E26786
     C           BYACBN    IFNE @CZ,06                     *IF            E26786
      *CASE:     DB1.A/c With Bank No. is Not Blank                       E26786
     C           BYACBN    IFNE *BLANK                     *IF            E26786
      * Rtv C/Pnostro/cust name                                           E26786
     C                     MOVELBYACBN    AWCPNC           Counterparty NoE26786
      * Retrieve Nostro S/name - Counterparty Nostros  *                  E26786
     C                     EXSR SERVGN                                    E26786
      *CASE:     PGM.*Return code is *Record does not exist               E26786
     C           W0RTN     IFEQ @CZ,05                     *IF            E26786
     C                     MOVELBYACBN    BBCUST           Customer NumberE26786
      * Retrieve shortname - Client Details  *                            E26786
     C                     EXSR SBRVGN                                    E26786
      *CASE:     PGM.*Return code is *Record does not exist               E26786
     C           W0RTN     IFEQ @CZ,05                     *IF            E26786
      * database error processing                                         E26786
     C***********          MOVEL@CZ,07    WUTRPA    Termination ParE26786 060053
     C***********          MOVEL@CZ,08    WUDBEF    Database error E26786 060053
     C***********          MOVEL'04'      WUDBEN    Database error E26786 060053
     C***********          MOVEL'SD0400P' WUPGNM    program name   E26786 060053
     C***********          MOVEL*BLANK    WUDBEK    Database error E26786 060053
     C***********          MOVELBYACBN    WUDBEK    Database error E26786 060053
     C***********          MOVELW0RTN     P0RTN     *Return code   E26786 060053
     C***********          EXSR ZYEXPG                             E26786 060053
     C                     MOVE *BLANKS   W0RTN                           060053
     C                     MOVE ERRNAR,1  XRACBN                          060053
     C                     MOVELBBCUST    XRACBN                          060053
     C                     ELSE                                           E26786
     C                     MOVEL*BLANK    XRACBN           Customer ShortnE26786
     C                     MOVELBBCSSN    XRACBN           Customer ShortnE26786
     C***********          MOVELBBCUST    XRACBN                    060053101810
     C                     END                             *FI            E26786
     C                     ELSE                                           E26786
      *CASE:     *OTHERWISE                                               E26786
     C                     MOVEL*BLANK    XRACBN           Customer ShortnE26786
     C                     MOVELBYACBN    XRACBN           Customer ShortnE26786
     C                     END                             *FI            E26786
     C                     END                             *FI            E26786
     C                     END                             *FI            E26786
     C*                                                                   E26786
     C** Retrieve shortname - BENEFICIARY                                 E26786
     C*                                                                   E26786
      *CASE:     DB1.Beneficiary Number is Non-Zero                       E26786
     C           BYBYNB    IFNE @CZ,06                     *IF            E26786
      *CASE:     DB1.Beneficiary Number is Not Blank                      E26786
     C           BYBYNB    IFNE *BLANK                     *IF            E26786
      * Rtv C/Pnostro/cust name                                           E26786
     C                     MOVELBYBYNB    AWCPNC           Counterparty NoE26786
      * Retrieve Nostro S/name - Counterparty Nostros  *                  E26786
     C                     EXSR SERVGN                                    E26786
      *CASE:     PGM.*Return code is *Record does not exist               E26786
     C           W0RTN     IFEQ @CZ,05                     *IF            E26786
     C                     MOVELBYBYNB    BBCUST           Customer NumberE26786
      * Retrieve shortname - Client Details  *                            E26786
     C                     EXSR SBRVGN                                    E26786
      *CASE:     PGM.*Return code is *Record does not exist               E26786
     C           W0RTN     IFEQ @CZ,05                     *IF            E26786
      * database error processing                                         E26786
     C***********          MOVEL@CZ,07    WUTRPA    Termination ParE26786 060053
     C***********          MOVEL@CZ,08    WUDBEF    Database error E26786 060053
     C***********          MOVEL'05'      WUDBEN    Database error E26786 060053
     C***********          MOVEL'SD0400P' WUPGNM    program name   E26786 060053
     C***********          MOVEL*BLANK    WUDBEK    Database error E26786 060053
     C***********          MOVELBYBYNB    WUDBEK    Database error E26786 060053
     C***********          MOVELW0RTN     P0RTN     *Return code   E26786 060053
     C***********          EXSR ZYEXPG                             E26786 060053
     C                     MOVE *BLANKS   W0RTN                           060053
     C                     MOVE ERRNAR,1  XRBYNB                          060053
     C                     MOVELBBCUST    XRBYNB                          060053
     C                     ELSE                                           E26786
     C                     MOVEL*BLANK    XRBYNB           Customer ShortnE26786
     C                     MOVELBBCSSN    XRBYNB           Customer ShortnE26786
     C                     END                             *FI            E26786
     C                     ELSE                                           E26786
      *CASE:     *OTHERWISE                                               E26786
     C                     MOVEL*BLANK    XRBYNB           Customer ShortnE26786
     C                     MOVELBYBYNB    XRBYNB           Customer ShortnE26786
     C                     END                             *FI            E26786
     C                     END                             *FI            E26786
     C                     END                             *FI            E26786
     C*                                                                   E26786
     C** Retrieve shortname - RECEIVER CORRESPONDENT                      E26786
     C*                                                                   E26786
      *CASE:     DB1.Receiver Correspondent No is Non-Zero                E26786
     C           BYRCNO    IFNE @CZ,06                     *IF            E26786
      *CASE:     DB1.Receiver Correspondent No is Not Blank               E26786
     C           BYRCNO    IFNE *BLANK                     *IF            E26786
      * Rtv C/Pnostro/cust name                                           E26786
     C                     MOVELBYRCNO    AWCPNC           Counterparty NoE26786
      * Retrieve Nostro S/name - Counterparty Nostros  *                  E26786
     C                     EXSR SERVGN                                    E26786
      *CASE:     PGM.*Return code is *Record does not exist               E26786
     C           W0RTN     IFEQ @CZ,05                     *IF            E26786
     C                     MOVELBYRCNO    BBCUST           Customer NumberE26786
      * Retrieve shortname - Client Details  *                            E26786
     C                     EXSR SBRVGN                                    E26786
      *CASE:     PGM.*Return code is *Record does not exist               E26786
     C           W0RTN     IFEQ @CZ,05                     *IF            E26786
      * database error processing                                         E26786
     C***********          MOVEL@CZ,07    WUTRPA    Termination ParE26786 060053
     C***********          MOVEL@CZ,08    WUDBEF    Database error E26786 060053
     C***********          MOVEL'06'      WUDBEN    Database error E26786 060053
     C***********          MOVEL'SD0400P' WUPGNM    program name   E26786 060053
     C***********          MOVEL*BLANK    WUDBEK    Database error E26786 060053
     C***********          MOVELBYRCNO    WUDBEK    Database error E26786 060053
     C***********          MOVELW0RTN     P0RTN     *Return code   E26786 060053
     C***********          EXSR ZYEXPG                             E26786 060053
     C                     MOVE *BLANKS   W0RTN                           060053
     C                     MOVE ERRNAR,1  XRRCNO                          060053
     C                     MOVELBBCUST    XRRCNO                          060053
     C                     ELSE                                           E26786
     C                     MOVEL*BLANK    XRRCNO           Customer ShortnE26786
     C                     MOVELBBCSSN    XRRCNO           Customer ShortnE26786
     C                     END                             *FI            E26786
     C                     ELSE                                           E26786
      *CASE:     *OTHERWISE                                               E26786
     C                     MOVEL*BLANK    XRRCNO           Customer ShortnE26786
     C                     MOVELBYRCNO    XRRCNO           Customer ShortnE26786
     C                     END                             *FI            E26786
     C                     END                             *FI            E26786
     C                     END                             *FI            E26786
     C/COPY WNCPYSRC,SD0400PC09
      *                                                                   E26786
      * USER: Process detail record
     C                     MOVELP1ARSI    WUARSI           Audit/Request S
      * Process Detail Rec PRTFIL
     C                     ADD  1         WUWKNB           work number
      *CASE:     PAR.Audit/Request Status Ind is Audit Mode
     C           WUARSI    IFEQ @CN,01                     *IF
      *CASE:     PAR.Last Change Date NE WRK.run day number
     C           XRLCD     IFNE WURDNB                     *IF
     C                     MOVEL@CN,02    W0PFM            *Print format
     C                     MOVEL*BLANKS   BYBRCA                                              CSD095
     C                     MOVEL*BLANKS   BYCYCD                          165608
     C                     MOVEL*BLANKS   BYCUST                          165608
     C                     MOVEL*BLANKS   BYTRTY                          165608
     C                     MOVEL*BLANKS   BYSTYP                                              CSD095
     C                     END                             *FI
     C                     END                             *FI
      *CASE:     PGM.*Print format is Print format
     C           W0PFM     IFEQ @CN,03                     *IF
     C/COPY WNCPYSRC,SD0400PC20
     C                     ADD  1         ZTNCRC           No of Calculate
     C/COPY WNCPYSRC,SD0400PC21
      *CASE:     PAR.No of Calculated Recs is Equal 1
     C           ZTNCRC    IFEQ 1                          *IF
      * Change Print Control to Y - Standing Data Controls  *
     C*
     C* Set Print Control To Y To Enable Column Headers To Be
     C*             Printed On First Record..
     C*
     C                     MOVEL'Y'       BAPR    1
     C                     END                             *FI
     C                     END                             *FI
      * Check File Date - Rundate  *
     C                     CALL 'ZDATE2'               90  Check File Date
     C                     PARM XRLCD     WQ0001  50       Work Midas Date
     C                     PARM WUDFF     WQ0002  1        date format fla
     C           WUWCDT    PARM *ZERO     WQ0003  60       Work Converted
     C           XRACDT    PARM *BLANK    WQ0004  7        Work Alpha Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * PAR.alpha of last change = Condition name of PAR.Type of Last Change
     C                     CALL 'Y2RVCNR'              90  *
     C                     PARM           W0RTN   7        Return code
     C                     PARM 1100584   Y2LSNO  70       List number
     C                     PARM XRTYLC    W0INVL 20        Type of Last Ch
     C                     PARM ' '       W0VLMP  1        Value mapped?
     C           XRALCH    PARM           W0CNNM 25        alpha of last c
      *
     C           W0PFM     IFEQ 'Y'
      *                                                                   165608
      ** Print headings.                                                  165608
      *                                                                   165608
     C                     EXSR BAPRHD                                    165608
      * Print column headings if required.
     C           BAPR      IFEQ 'Y'
     C/COPY WNCPYSRC,SD0400PC22
     C                     WRITEZZCOLHDG
     C                     MOVEL*BLANK    BAPR
     C/COPY WNCPYSRC,SD0400PC23
     C                     END
      * Convert fields to external form.
      * Print detail line.
     C/COPY WNCPYSRC,SD0400PC24
      *                                                                                       CSW212
      ** AT and FX                                                                            CSW212
      *                                                                                       CSW212
     C           *IN81     IFEQ *ON                                                           CSW212
     C                     MOVEL*BLANKS   XCON1                                               CSW212
     C                     MOVEL*BLANKS   XCON2                                               CSW212
     C                     MOVEL*BLANKS   XCON3                                               CSW212
     C                     MOVEL*BLANKS   XCON4                                               CSW212
     C                     MOVEL*BLANKS   XCON5                                               CSW212
     C                     MOVEL*BLANKS   XCON6                                               CSW212
      *                                                                                       CSW212
     C                     MOVEL'N'       FRA     1                                           CSW212
     C                     MOVEL'N'       FX      1                                           CSW212
      *                                                                                       CSW212
     C                     SELEC                                                              CSW212
     C           XRTRTY    WHEQ 'AT'                                                          CSW212
     C           CSW005    IFEQ 'Y'                                                           CSW212
     C           CSW011    OREQ 'Y'                                                           CSW212
     C                     MOVEL'Y'       FRA                                                 CSW212
     C                     ENDIF                                                              CSW212
     C           CSW212    IFEQ 'Y'                                                           CSW212
     C                     MOVEL'Y'       FX                                                  CSW212
     C                     ENDIF                                                              CSW212
      *                                                                                       CSW212
     C           XRTRTY    WHEQ 'FX'                                                          CSW212
     C           XRTRTY    OREQ 'OP'                                                          CSW212
     C           XRTRTY    OREQ 'FF'                                                          CSW212
     C           XRTRTY    OREQ 'CL'                                                          CSW212
     C           CDL008    ANDEQ'Y'                                                           CSW212
     C           CSW212    IFEQ 'Y'                                                           CSW212
     C                     MOVEL'Y'       FX                                                  CSW212
     C                     ELSE                                                               CSW212
     C                     MOVEL'Y'       FRA                                                 CSW212
     C                     ENDIF                                                              CSW212
     C                     OTHER                                                              CSW212
     C                     MOVEL'Y'       FRA                                                 CSW212
     C                     ENDSL                                                              CSW212
      *                                                                                       CSW212
     C                     Z-ADD0         X       10                                          CSW212
     C           FRA       IFEQ 'Y'                                                           CSW212
      *                                                                                       CSW212
      ** First line                                                                           CSW212
      *                                                                                       CSW212
     C                     MOVELCONF1,1   XCON1                                               CSW212
     C                     MOVELCONF2,1   XCON3                                               CSW212
     C                     MOVELCONF3,1   XCON5                                               CSW212
     C                     ADD  1         X                                                   CSW212
     C                     ENDIF                                                              CSW212
      *                                                                                       CSW212
     C           FX        IFEQ 'Y'                                                           CSW212
     C           X         IFEQ 0                                                             CSW212
      *                                                                                       CSW212
      ** First line                                                                           CSW212
      *                                                                                       CSW212
     C                     MOVELCONF1,2   XCON1                                               CSW212
     C                     MOVELCONF1,3   XCON2                                            AR993239A
     C                     MOVELCONF2,2   XCON3                                               CSW212
     C**********           MOVELCONF3,2   XCON5                                     CSW212 AR993239A
     C                     ELSE                                                               CSW212
      *                                                                                       CSW212
      ** Second line                                                                          CSW212
      *                                                                                       CSW212
     C                     MOVELCONF1,2   XCON2                                               CSW212
     C                     MOVELCONF1,3   XCON6                                            AR993239A
     C                     MOVELCONF2,2   XCON4                                               CSW212
     C**********           MOVELCONF3,2   XCON6                                     CSW212 AR993239A
     C                     ENDIF                                                              CSW212
     C                     MOVELCONF3,2   XCON5                                            AR993239A
     C                     ENDIF                                                              CSW212
      *                                                                                       CSW212
     C                     ENDIF                                                              CSW212
     C                     WRITEZZDTLRCD
     C/COPY WNCPYSRC,SD0400PC25
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR                                          E26786
      *================================================================   E26786
      * Retrieve shortname - Client Details  *                            E26786
      *================================================================   E26786
     C                     MOVEL*BLANK    W0RTN   7                       E26786
     C                     SETOF                     90                   060053
     C           BBCUST    IFNE *BLANKS                                   060053
     C*                                                                   E26786
     C           KRSSB     CHAIN@BBREBF              90    *              E26786
      * DBF Record not found.                                             E26786
     C           *IN90     IFEQ '1'                                       E26786
     C                     MOVEL@CZ,05    W0RTN   7        *Return code   E26786
     C                     END                                            E26786
     C                     END                                            060053
      *                                                                   E26786
      *================================================================   E26786
     CSR         SBEXT     ENDSR                                          E26786
      /EJECT
     CSR         SERVGN    BEGSR                                          E26786
      *================================================================   E26786
      * Retrieve Nostro S/name - Counterparty Nostros  *                  E26786
      *================================================================   E26786
     C                     MOVEL*BLANK    W0RTN   7                       E26786
     C*                                                                   E26786
     C           KRSSE     CHAIN@AWREDN              90    *              E26786
      * DBF Record not found.                                             E26786
     C           *IN90     IFEQ '1'                                       E26786
     C                     MOVEL@CZ,05    W0RTN            *Return code   E26786
     C                     END                                            E26786
      *                                                                   E26786
      *================================================================   E26786
     CSR         SEEXIT    ENDSR                                          E26786
      /EJECT
     CSR         DALVCH    BEGSR
      *================================================================
      * Detect level changes.
      *================================================================
      * Clear all level breaks.
     C                     MOVEL*BLANK    L0               Page headings
     C                     MOVEL*BLANK    L1               Currency Code
     C                     MOVEL*BLANK    L2               Customer Number
      * Clear heading length to print.
     C                     Z-ADD*ZERO     @$HDL
      *
      * End of file - Signal all level breaks.
     C           W0EOF     IFEQ '1'
     C                     MOVEL'Y'       L1
     C                     MOVEL'Y'       L2
     C                     ELSE
     C           BYCYCD    IFNE WZCYCD                     Currency Code
     C           BYTRTY    ORNE WZTRTY                     Transaction Typ165608
      * Set on level break indicator.
     C                     MOVEL'Y'       L1
     C                     MOVEL'Y'       L0                              165608
     C                     END
     C           BYCUST    IFNE WZCUST                     Customer Number
     C           L1        OREQ 'Y'
      * Set on level break indicator.
     C                     MOVEL'Y'       L2
     C                     MOVEL'Y'       L0                              165608
     C                     END
      * Adjust for column headings.
     C           @$HDL     IFGT *ZERO
     C                     ADD  4         @$HDL
     C                     END
      *
     C                     END
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         EAPRTT    BEGSR
      *================================================================
      * Print report Totals.
      *================================================================
      * Print level break totals as required
      * End of file - Print final totals.
     C           W0EOF     IFEQ '1'
     C                     MOVEL'Y'       W0PFM
      * USER: Process End of Report
      *CASE:     CUR.No of Calculated Recs is Compare to Zero
     C           ZTNCRC    IFEQ *ZERO                      *IF
     C                     MOVEL@CN,04    WUALZR           Alpha Zero
     C                     END                             *FI
     C/COPY WNCPYSRC,SD0400PC10
      *CASE:     PAR.Audit/Request Status Ind is Audit Mode
     C           P1ARSI    IFEQ @CN,01                     *IF
     C/COPY WNCPYSRC,SD0400PC11
      * Audit/On-Req RTV on FCTL - Standing Data Controls  *
     C                     EXSR SARVGN
      *CASE:     WRK.work number NE WRK.No of Records on file
     C           WUWKNB    IFNE WUNORF                     *IF
     C                     MOVEL@CN,02    WUWFLG           work flag
     C                     END                             *FI
      * Audit printfile override - Standing Data Controls  *
     C                     CALL 'SDC540P'              90  Audit printfile
     C                     PARM @CN,07    WQ0005 10        *PROGRAM
     C                     PARM WUWFLG    WQ0006  1        work flag
     C                     PARM WUNORI    WQ0007  50       No of Records I
     C                     PARM WUNORA    WQ0008  50       No of Records A
     C                     PARM WUNORD    WQ0009  50       No of records D
     C                     PARM WUWKNB    WQ0010  50       work number
     C                     PARM WUNORF    WQ0011  50       No of Records o
     C                     PARM WUARTL    WQ0012 53        Audit/Request T
     C                     PARM WUUNDL    WQ0013 53        Underline
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      *CASE:     PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,06                     *IF
      * Database Error U7 U8 - Standing Data Controls  *
     C*
     C** DATABASE ERROR, SET ON SWITHES U7 AND U8
     C*
     C                     SETON                     U7U8
     C*
     C                     ELSE
      *CASE:     WRK.work flag is Incorrect
     C           WUWFLG    IFEQ @CN,02                     *IF
      * File Control Error U8 - Standing Data Controls  *
     C*
     C** FILE CONTROLS OUT OF BALANCE SETON U8
     C*
     C                     SETON                         U8
     C*
     C                     ELSE
      *CASE:     PGM.*Return code is *Field attribute types EX
     C           W0RTN     IFEQ @CN,08                     *IF
     C                     ELSE
      *CASE:     *OTHERWISE
      * Change Standing Data Cont - Standing Data Controls  *
     C                     EXSR SBCHRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:-
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 4
      * Signal artificial overflow.
     C                     SETON                     97
      * Print page headers.
     C                     WRITEZZPAGHDR
     C                     END
     C                     MOVEL'0'       *IN79
     C           WUALZR    IFEQ @CN,04                     *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print format.
     C/COPY WNCPYSRC,SD0400PC12
     C                     WRITEZZFINTTL
     C                     END
     C                     END
      *
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         FASGHD    BEGSR
      *================================================================
      * Signal required header formats.
      *================================================================
      * Cascade skip to new page requests upwards.
      *
     C           *IN97     IFNE '1'
     C           L0        ANDNE'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line.
     C           W0OFL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE @$HDL
     C                     SETON                     97
     C                     ELSE
      * Signal overflow if requested headings would cause
      * detail format to be printed past end of page
     C/COPY WNCPYSRC,SD0400PC13
     C                     ADD  24        @$HDL
     C/COPY WNCPYSRC,SD0400PC14
     C           W0PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE @$HDL
     C                     SETON                     97
     C                     END
     C                     END
     C                     END
      * Overflow detected.
     C           *IN97     IFEQ '1'
      * Request page headings.
     C                     MOVEL'Y'       L0
      * Request all formats which print on overflow.
     C                     SETOF                     97
     C                     END
      *================================================================
     CSR         FAEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Audit/On-Req RTV on FCTL - Standing Data Controls  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define Keylist.
     C           KRSSA     KLIST
     C                     KFLD           AHFLNM           Filename
      * Move fields to key list.
     C/COPY WNCPYSRC,SDH00175
     C                     MOVEL@CN,05    AHFLNM           Filename
     C/COPY WNCPYSRC,SDH00176
     C           KRSSA     CHAIN@AHREAV              90    *
     C           *IN90     IFEQ '1'
      * DBF Record not found.
     C                     MOVEL'USR0020' W0RTN   7
      * USER: Processing if DBF record not found
     C                     MOVEL@CN,06    W0RTN            *Return code
     C                     GOTO SAEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process DBF record
      * PAR = DB1 By name
     C                     Z-ADDAHNORC    WUNORF           No. of Records
     C                     Z-ADDAHNOIN    WUNORI           No. of Inserts
     C                     Z-ADDAHNOAM    WUNORA           No. of Amends
     C                     Z-ADDAHNODL    WUNORD           No. of Deletes
     C                     END
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBCHRC    BEGSR
      *================================================================
      * Change Standing Data Cont - Standing Data Controls  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @AHREAU
     C/COPY WNCPYSRC,SDH00177
     C                     MOVEL@CN,05    AHFLNM           Filename
     C/COPY WNCPYSRC,SDH00178
      *
     C           KLCHSB    KLIST
     C                     KFLD           AHFLNM           Filename
     C           KLCHSB    CHAIN@AHREAU              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found.
     C                     MOVEL'Y2U0009' W0RTN   7
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID           Message id.
     C                     MOVEL'Y2USRMSG'ZAMSGF           Message file.
     C                     EXSR ZASNMS                     Send message
     C                     GOTO SBEXIT
     C                     END
      *
     C           *IN91     IFEQ '1'
      * Record locked.
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     GOTO SBEXIT
     C                     END
      *
      * USER: Processing after DBF read
     C                     ADD  AHNORC    WUNORC           No. of Records
     C                     ADD  AHNOIN    WUNOIN           No. of Inserts
     C                     ADD  AHNOAM    WUNOAM           No. of Amends
     C                     ADD  AHNODL    WUNODL           No. of Deletes
      * Move Non-key fields to @AHREAU
     C                     Z-ADDWUNORC    AHNORC           No. of Records
     C                     Z-ADD*ZERO     AHNOIN           No. of Inserts
     C                     Z-ADD*ZERO     AHNOAM           No. of Amends
     C                     Z-ADD*ZERO     AHNODL           No. of Deletes
      *
     C                     UPDAT@AHREAU                91  *
     C           *IN91     IFEQ '1'
      * Change error detected.
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * DBF Change successful.
     C                     END
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Get Bank Title - Bank Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define Keylist.
     C           KRSSC     KLIST
     C                     KFLD           BJBANK           Bank
      * Move fields to key list.
     C                     MOVEL@CN,09    BJBANK           Bank
     C           KRSSC     CHAIN@BJREEF              90    *
     C           *IN90     IFEQ '1'
      * DBF Record not found.
     C                     MOVEL'USR0197' W0RTN   7
      * USER: Processing if DBF record not found
     C                     MOVEL@CN,06    W0RTN            *Return code
      * Setup message data for message.
     C                     MOVEL@CN,10    ZA0001           Filename
      * Send message 'Database Error (ICD)'
     C                     MOVEL'USR0377' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     99    *
      *
     C                     GOTO SCEXIT                     *QUIT
     C                     GOTO SCEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process DBF record
      * PAR = DB1 By name
     C                     MOVELBJURPT    WUURPT           User Report Tit
     C                     END
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue.
      *================================================================
     C           ZAPGM     IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGM
     C                     END
      * If no message file specified use default.
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGM  10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message Id.
     C                     PARM           ZAMSGF 10        Message file.
     C                     PARM           ZAMSDA132        Message data.
     C                     PARM           ZAMSTP  7        Message type.
      * Clear all fields for default mechanism next time.
     C                     MOVEL*BLANK    ZAPGM            Program queue
     C                     MOVEL*BLANK    ZAPGRL           Rel queue
     C                     MOVEL*BLANK    ZAMSID           Message Id.
     C                     MOVEL*BLANK    ZAMSGF           Message file.
     C                     MOVEL*BLANK    ZAMSDA           Message data.
     C                     MOVEL*BLANK    ZAMSTP           Message type.
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct.
      *================================================================
      * Terminate program.
     C/COPY WNCPYSRC,SD0400PC15
     C                     SETON                     LR
      *
      * Exit program.
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation.
      *================================================================
      *                                                                   CSW005
      ** Check if CSW005 is a valid record in SCSARDPD                    CSW005
      *                                                                   CSW005
     C                     CALL 'AOSARDR0'                                CSW005
     C                     PARM '       ' @RTCD   7                       CSW005
     C                     PARM '*VERIFY' @OPTN   7                       CSW005
     C                     PARM 'CSW005'  @SARD   6                       CSW005
     C           SCSARD    PARM SCSARD    DSFDY                           CSW005
     C*                                                                   CSW005
     C                     MOVE 'N'       CSW005  1                       CSW005
     C***********          MOVE '0'       *IN81                    CSW005 CSW200
     C           @RTCD     IFEQ *BLANKS                                   CSW005
     C                     MOVE 'Y'       CSW005  1                       CSW005
     C***********          MOVE '1'       *IN81                    CSW005 CSW200
     C                     ENDIF                                          CSW005
      *                                                                   CSW200
      ** Check if CSW011 is a valid record in SCSARDPD                    CSW200
      *                                                                   CSW200
     C                     CALL 'AOSARDR0'                                CSW200
     C                     PARM '       ' @RTCD                           CSW200
     C                     PARM '*VERIFY' @OPTN                           CSW200
     C                     PARM 'CSW011'  @SARD                           CSW200
     C           SCSARD    PARM SCSARD    DSFDY                           CSW200
     C*                                                                   CSW200
     C                     MOVE 'N'       CSW011  1                       CSW200
     C           @RTCD     IFEQ *BLANKS                                   CSW200
     C                     MOVE 'Y'       CSW011                          CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
     C** Check if SWIFT 2000 Changes is on.                               CSW200
      *                                                                   CSW200
     C                     CALL 'SWIF2000'                                CSW200
     C                     PARM *BLANKS   @RTCD                           CSW200
      *                                                                   CSW200
     C                     MOVEL'N'       CSW200  1                       CSW200
     C           @RTCD     IFEQ 'CSW200'                                  CSW200
     C                     MOVEL'Y'       CSW200                          CSW200
     C                     ENDIF                                          CSW200
      *                                                                                       CSW212
      ** Check if SWIFT 2012 Changes is on.                                                   CSW212
      *                                                                                       CSW212
     C                     CALL 'SWIF2012'                                                    CSW212
     C                     PARM *BLANKS   @RTCD                                               CSW212
      *                                                                                       CSW212
     C           @RTCD     IFEQ 'CSW2012'                                                     CSW212
     C                     MOVEL'Y'       CSW212  1                                           CSW212
     C                     ELSE                                                               CSW212
     C                     MOVEL'N'       CSW212                                              CSW212
     C                     ENDIF                                                              CSW212
      *                                                                                       CSW212
      ** Check if CDL008 is a valid record in SCSARDPD                                        CSW212
      *                                                                                       CSW212
     C                     CALL 'AOSARDR0'                                                    CSW212
     C                     PARM '       ' @RTCD                                               CSW212
     C                     PARM '*VERIFY' @OPTN                                               CSW212
     C                     PARM 'CDL008'  @SARD                                               CSW212
     C           SCSARD    PARM SCSARD    DSFDY                                               CSW212
      *                                                                                       CSW212
     C                     MOVE 'N'       CDL008  1                                           CSW212
     C           @RTCD     IFEQ *BLANKS                                                       CSW212
     C                     MOVE 'Y'       CDL008                                              CSW212
     C                     ENDIF                                                              CSW212
      ** Check if CDL094 is a valid record in SCSARDPD                                        CDL094
      *                                                                                       CDL094
     C                     CALL 'AOSARDR0'                                                    CDL094
     C                     PARM '       ' @RTCD                                               CDL094
     C                     PARM '*VERIFY' @OPTN                                               CDL094
     C                     PARM 'CDL094'  @SARD                                               CDL094
     C           SCSARD    PARM SCSARD    DSFDY                                               CDL094
      *                                                                                       CDL094
     C                     MOVE 'N'       CDL094  1                                           CDL094
     C                     MOVE *OFF      *IN82                                               CDL094
     C           @RTCD     IFEQ *BLANKS                                                       CDL094
     C                     MOVE 'Y'       CDL094                                              CDL094
     C                     MOVE *ON       *IN82                                               CDL094
     C                     ENDIF                                                              CDL094
      *                                                                   CSW200
     C* Determine whether Swift confirmation fields should be printed     CSW200
     C*                                                                   CSW200
     C           CSW005    IFEQ 'Y'                                       CSW200
     C           CSW011    OREQ 'Y'                                       CSW200
     C           CSW200    ANDEQ'Y'                                       CSW200
     C           CSW212    OREQ 'Y'                                                           CSW212
     C                     MOVE *ON       *IN81                           CSW200
     C                     ENDIF                                          CSW200
     C*                                                                   CSW200
     C/COPY WNCPYSRC,SD0400PC16
      *                                                                   CSW005
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
      * Setup job date/time.
     C                     Z-ADDUDATE     ##JDT            Job date.
     C                     TIME           ##JTM            Job time.
     C                     TIME           ##TME   60       Screen time.
      * Define work field Audit/Request Status Ind
     C                     MOVEL*BLANK    WUARSI  1
      * Define work field work number
     C                     Z-ADD*ZERO     WUWKNB  50
      * Define work field run day number
     C                     Z-ADD*ZERO     WURDNB  50
      * Define work field date format flag
     C                     MOVEL*BLANK    WUDFF   1
      * Define work field Work Converted Date
     C                     Z-ADD*ZERO     WUWCDT  60
      * Define work field Alpha Zero
     C                     MOVEL*BLANK    WUALZR  1
      * Define work field No of Records on file
     C                     Z-ADD*ZERO     WUNORF  50
      * Define work field No of Records Inserted
     C                     Z-ADD*ZERO     WUNORI  50
      * Define work field No of Records Amended
     C                     Z-ADD*ZERO     WUNORA  50
      * Define work field No of records Deleted
     C                     Z-ADD*ZERO     WUNORD  50
      * Define work field work flag
     C                     MOVEL*BLANK    WUWFLG  1
      * Define work field Audit/Request Title
     C                     MOVEL*BLANK    WUARTL 53
      * Define work field Underline
     C                     MOVEL*BLANK    WUUNDL 53
      * Define work field No. of Records
     C                     Z-ADD*ZERO     WUNORC  50
      * Define work field No. of Inserts
     C                     Z-ADD*ZERO     WUNOIN  50
      * Define work field No. of Amends
     C                     Z-ADD*ZERO     WUNOAM  50
      * Define work field No. of Deletes
     C                     Z-ADD*ZERO     WUNODL  50
      * Define work field midas rundate
     C                     MOVEL*BLANK    WUMRDT  7
      * Define work field Set Up Complete
     C                     MOVEL*BLANK    WUSUC   1
      * Define work field Multi-branching Indicator
     C                     MOVEL*BLANK    WUMBIN  1
      * Define work field User Report Title
     C                     MOVEL*BLANK    WUURPT 53
     C* Define work field ZSFILE error                                    S01117
     C                     MOVEL*BLANK    WUZSER  1                       S01117
      * Obtain default message file.
     C           *NAMVAR   DEFN Y2MGFLA   ZADFMF 10
     C                     IN   ZADFMF
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
      * Adjust page length and overflow as necessary.
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * USER: Initialise program
      * Standard RPG Creation PAR - Standard Functions  *
      * Get Rundate - Rundate  *
     C           *NAMVAR   DEFN           RUNDAT
     C                     IN   RUNDAT
     C                     MOVE MRDT      ##MRDT
     C                     MOVE MRDT      WUMRDT
     C                     MOVE RDNB      WURDNB
     C                     MOVE SUC       WUSUC
     C                     MOVE DFF       WUDFF
     C                     MOVE MBIN      WUMBIN
      * Get Title
      * Get Bank Title - Bank Details  *
     C                     EXSR SCRVGN
      * Move title to header - *Standard header/footer  *
     C* 7.10.89 Missing Source - Inserted During Incorporation            S01216
     C* Move User Report Title into Header Field in DDS for PRTF          S01216
     C*                                                                   S01216
     C                     MOVE WUURPT    ##URPT                          S01216
      * Get Narrative Title - Narrative Codes  *
     C           *IN99     IFEQ '1'
     C                     MOVE 1         UIND    10
     C                     SETOF                         99
     C                     ELSE
     C                     MOVE 0         UIND
     C                     END
      *
      ** CALCULATE END OF TEXT POINT
     C                     Z-ADD1         U       20
     C                     MOVEA@CN,11    UAR,U
     C*
     C           *IN99     DOWEQ'0'
     C           ' '       LOKUPUAR,U                    99
     C                     ADD  1         U
     C           UAR,U     COMP ' '                      99
     C                     END
      *
     C**
     C*
     C*          P1LSST    IFEQ 'A'                                       S01216
     C           P1ARSI    IFEQ 'A'                                       S01216
     C                     MOVELUARRAY,1  UTEMP  26
     C                     MOVEAUTEMP     UAR,U
     C                     ADD  26        U
     C                     ELSE
      *
     C                     MOVEAUARRAY,2  UAR,U            * IF A THIRD
     C                     ADD  7         U                OPTION TO ARRAY
     C                     END                             IS ADDED A
      *                                                    TEMP STORAGE
      *                                                    * IS REQUIRED.
      **  STORE  TEXT IN USTORE FIELD
      *
     C                     MOVEAUAR       USTORE 53
     C                     MOVE *BLANKS   UAR
      *
      *
      *
     C           53        SUB  U         UB      20
     C           UB        DIV  2         UB
     C                     MVR            UR      10
     C           UB        ADD  U         U
     C           U         SUB  1         U
      *
      *
      **  INSERT UNDERLINE TO ARRAY
      **
     C                     MOVEA*ALL'-'   ULN,UB
     C                     MOVEA*BLANKS   ULN,U
      *
      *
     C           UB        IFGT 0
     C                     MOVEAUSTORE    UAR,UB
     C                     ELSE
     C                     MOVEAUSTORE    UAR
     C                     END
      *
      **  MOVE ARRAY VALUE  TO SCREEN TEXT FIELD
      *
     C*                    MOVEAUAR       ##EYTX                          S01216
     C                     MOVEAUAR       ##ARTL 53                       S01216
     C*                    MOVEAUAR       WUEYTX
     C                     MOVEAUAR       WUARTL
     C*                    MOVEAULN       ##BJNA                          S01216
     C                     MOVEAULN       ##UNDL 53                       S01216
     C                     MOVEAULN       WUUNDL
      *
      *
      ** RESET INDICATOR *IN 99
      *
     C           UIND      IFEQ 1
     C                     SETON                         99
     C                     ELSE
     C                     SETOF                         99
     C                     END
     C*
     C** Set up spool file number - Standard functions *                  S01117
     C*                                                                   S01117
     C                     Z-ADD@$FNB     WUSFNB  60                      S01117
     C*                                                                   S01117
     C** ZSFILE - write report rqs - Standard functions *                 S01117
     C*                                                                   S01117
     C                     CALL 'ZSFILE'               90                 S01117
     C                     PARM P2RSQN    UURSQN  5        RCF seq no.    S01117
     C                     PARM P3ENTY    UUENTY  3        Entity         S01117
     C                     PARM @$FVN     UUSFNM 10        Spool file nameS01117
     C                     PARM WUSFNB    UUSFNB  60       Spool file no. S01117
     C           WUZSER    PARM *BLANK    UUZSER  1        ZSFILE error   S01117
     C*                                                                   S01117
     C** Call to program ended in error                                   S01117
     C*                                                                   S01117
     C           *IN90     IFEQ '1'                                       S01117
     C                     MOVEL'Y2U0021' W0RTN   7                       S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C** CASE: WRK.ZSFILE is error occurred                               S01117
     C*                                                                   S01117
     C           WUZSER    IFEQ 'Y'                                       S01117
     C                     MOVEL'Y2U0004' P0RTN                           S01117
     C                     EXSR ZYEXPG                                    S01117
     C                     END                                            S01117
     C*                                                                   S01117
      ** Access Switchable Feature Details                                CEU003
      *                                                                   CEU003
     C                     CALL 'AOSARDR0'                                CEU003
     C                     PARM *BLANKS   PRTCD   7                       CEU003
     C                     PARM '*VERIFY 'POPTN   7                       CEU003
     C                     PARM 'CEU003'  PSARD   6                       CEU003
     C           SCSARD    PARM SCSARD    DSSDY                           CEU003
      *                                                                   CEU003
     C           PRTCD     IFEQ *BLANKS                                   CEU003
     C                     MOVE 'Y'       CEU003  1                       CEU003
     C                     MOVE '1'       *IN01                           CEU003
     C                     ELSE                                           CEU003
     C                     MOVE 'N'       CEU003                          CEU003
     C                     MOVE '0'       *IN01                           CEU003
     C                     ENDIF                                          CEU003
      *                                                                   CEU003
     C/COPY WNCPYSRC,SDH00179
      *
     C                     CALL 'AOSVALR0'                                                    CSD095
     C                     PARM *BLANKS   P@RTCD  7                                           CSD095
     C                     PARM P@BRCA    P@OP01 20                                           CSD095
     C                     PARM           P@VL01200                                           CSD095
     C                     PARM P@STYP    P@OP02 20                                           CSD095
     C                     PARM           P@VL02200                                           CSD095
     C                     PARM           P@OP03 20                                           CSD095
     C                     PARM           P@VL03200                                           CSD095
     C                     PARM           P@OP04 20                                           CSD095
     C                     PARM           P@VL04200                                           CSD095
     C                     PARM           P@OP05 20                                           CSD095
     C                     PARM           P@VL05200                                           CSD095
     C                     PARM           P@OP06 20                                           CSD095
     C                     PARM           P@VL06200                                           CSD095
     C                     PARM           P@OP07 20                                           CSD095
     C                     PARM           P@VL07200                                           CSD095
     C                     PARM           P@OP08 20                                           CSD095
     C                     PARM           P@VL08200                                           CSD095
     C                     PARM           P@OP09 20                                           CSD095
     C                     PARM           P@VL09200                                           CSD095
     C                     PARM           P@OP10 20                                           CSD095
     C                     PARM           P@VL10200                                           CSD095
      *                                                                                       CSD095
     C                     SETOF                     3839                                     CSD095
     C           P@RTCD    IFEQ *BLANKS                                                       CSD095
     C                     MOVELP@VL01    WUSEBR  1                                           CSD095
     C                     MOVELP@VL02    WUSEST 20                                           CSD095
     C           WUSEBR    IFEQ 'Y'                                                           CSD095
     C                     MOVE '1'       *IN38                                               CSD095
     C                     ENDIF                                                              CSD095
     C           WUSEST    IFNE *BLANKS                                                       CSD095
     C                     MOVE '1'       *IN39                                               CSD095
     C                     ENDIF                                                              CSD095
     C                     ENDIF                                                              CSD095
      *================================================================
     CSR         ZZEXIT    ENDSR
     C/COPY WNCPYSRC,SD0400PC08
      *                                                                                     AR992080
      ** Remove 'FX' in CONF1, CONF2, CONF3 element descriptions                            AR992080
      ** Include 'Information' for Sender-to-receiver (Cover) label                        AR993239A
      *                                                                                     AR992080
**   ARRAY ENTRIES FOR REPORT TITLE
MAINTENANCE - AUDIT REPORT
LISTING
** @CN Long constants used in program.
A
N
Y
0
SDEXSTPD                                                                  S01117
Y2U0005
SD0400AU                                                                  S01117
Y2U0021
BANK
SDBANKPD
EXTENDED SETTLEMENTS
** @CZ Long constants used in program.
Y
N
Our Nostro
Our Branch/Nostro
Y2U0005
000000
T
CUST
USR0790
E
Y2U9999
USR0563
Y2U0004
MMOD
** ERRNAR Error Narrative
* Customer Not Found *
** CONF1                                                                                      CSW212
Def. Conf. Snd. to Rec. Info.                                                                 CSW212
Sender-to-receiver Information                                                    AR992080 AR993239A
(Cover)                                                                                    AR993239A
** CONF2                                                                                      CSW212
Settlement/Reset Confirmation                                                                 CSW212
Confirmation                                                                         CSW212 AR992080
** CONF3                                                                                      CSW212
FRA/IRS Confirmation Condition                                                                CSW212
Confirmation Condition                                                               CSW212 AR992080
