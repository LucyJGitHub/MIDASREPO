     H        1   Y
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas SD Client limits maintenance')
      *****************************************************************
      *                                                               *
      *  Midas - Standing Data Module                                 *
      *                                                               *
      *  SD0451R - Client limits edt rec.                             *
      *                                                               *
      *  Function:  This program maintains Client limits details      *
      *             (1st screen) - FX, MM, FRA, IRS.                  *
      *                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. 250708             Date 07Mar22               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSW037A            Date 02May05               *
      *                 BUG6198            Date 04Apr05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      * Midas Release 4.01 -------------------------------------------*
      *                 192740             Date 28Aug01               *
      *                 192785             Date 14Aug01               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 185612             Date 22May01               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 184665             Date 13Nov00               *
      * Midas DBA 3.03 -----------------------------------------------*
      * Midas DBA 3.02 -----------------------------------------------*
      *                 CGL011             Date 20Sep99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *               . CSD003             Date 02Jan98               *
      *                 122096             Date 22Aug97               *
      *                 088472             DATE 27NOV95               *
      *                 077893             DATE 21JUN95               *
      *                 063959             DATE 02MAR94               *
      *                 063211             DATE 12NOV93               *
      *                 S01459             DATE 12NOV93               *
      *                 S01433             DATE 10OCT93               *
      *                 RT0040             DATE 22MAY91               *
      *                 LN1104             DATE 20FEB91               *
      *                 BHF931             DATE 18JAN91               *
      *                 BHF898             DATE 18JAN91               *
      *                 BHF329             DATE 08AUG90               *
      *                 LN0554             DATE 03AUG90               *
      *                 S01117             DATE 03AUG90               *
      *                 S01212             DATE 14SEP89               *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  250708 - Recompile over changes to SD0451R#.                 *
      *  MD046248 - Finastra Rebranding                               *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  BUG6198- Cannot save new Details for CUSD (Recompile)        *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  192740 - Error message encountered when trying to amend      *
      *           Client Limits type.  Fix is to put FX limit type    *
      *           validation on first screen.                         *
      *  192785 - The field #1FLRD (FX Limit Review Date) was         *
      *           wrongly zeroised instead of #1FRRD (FRA Review      *
      *           Date).                                              *
      *  185612 - Recompiled due to changes in display file.          *
      *  184665 - Recompile due to changes in SD0451R# resulting from *
      *           mistakes in CGL011.                                 *
      *  CGL011 - Collateral Processing for Midas DBA                 *
      *  CSD003 - Synon Closedown Project (SD):                       *
      *           - Program removed from SD model.                    *
      *  122096 - Addition of call to SD0520X to save deleted         *
      *           records for audit during COB.                       *
      *  088472 - Condition display of Lending fields (2nd screen)    *
      *           on presence of MM dealing or Lending Modules.       *
      *  077893 - Allow FX screen to have no input and then proceed   *
      *           to the next screen. Display all FX obligatory       *
      *           fields at the one time.                             *
      *  063959 - Q,M,T,X and Y are the only valid values             *
      *           for FX and MM limit Frequency and FRA and IRS       *
      *           Preview Frequency.                                  *
      *  063211 - Program used to force the user to enter both        *
      *           Spot and Forward limit amounts for FX.              *
      *  S01459 - Addition of headerbox and PSSR processing.          *
      *  S01433 - ENHANCED DEALING LIMITS:                            *
      *           SHOW MONEY MARKET INSTEAD OF LENDING.               *
      *           CALL NEW PROGRAM TO VALIDATE                        *
      *           * LENDING (WHICH HAS BEEN MOVED FROM THIS PROGRAM). *
      *           * PRECIOUS METAL.                                   *
      *  RT0040 - INCORPORATE BHF931: DISPLAY 0 FOR MDDR IF FX LIMIT  *
      *           NOT BLANK.                                          *
      *  LN1104 - RECOMPILED DUE TO CHANGE TO SDCUSTPD                *
      *  BHF931 - ALLOW MDDR TO BE 0                                  *
      *  BHF898 - ALLOW MDDR TO BE LIMIT AMOUNT                       *
      *  BHF329 - ADDITION OF CUSTOMER FIELDS FOR REFERENCE           *
      *  LN0554 - RECOMPILE OVER NEW DISPLAY FILE                     *
      *  S01117 - RELEASE 10 ENHANCEMENTS                             *
      *  S01212 - /COPY AND WINDOW PROCESSING                         *
      *                                                               *
      *****************************************************************
     F/COPY WNCPYSRC,SD0451RFPG
     FSD0451R#CF  E                    WORKSTN                        UC
     F                                              KINFDS INFDS#
     F                                              KINFSR *PSSR
      * DSP: Midas SD Client limits maintenance (1st screen)
      *
     FSDCLLML1IF  E           K        DISK                           UC
     F                                              KINFDS INFDS1
     F                                              KINFSR *PSSR
      * RTV : Midas SD Customer limits retrieval
      *
     FSDCUSTL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0001
     F                                              KINFSR *PSSR
      * RTV : Midas SD Customer details retrieval
      *
     FSDLIMTL0IF  E           K        DISK                           UC
     F                                              KINFDS ID0002
     F                                              KINFSR *PSSR
      * RTV : Limit types               Retrieval index
      *
     FSDMMODL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0003
     F                                              KINFSR *PSSR
      * RTV : Midas SD Midas module flags retrieval
      *
     FSDCLLML0UF  E           K        DISK                      A    UC
     F                                              KCOMIT
     F                                              KINFDS ID0004
     F                                              KINFSR *PSSR
      * UPD : Midas SD Customer limits update
      *
     FSDFCTLL0UF  E           K        DISK                           UC
     F                                              KCOMIT
     F                                              KINFDS ID0005
     F                                              KINFSR *PSSR
      * UPD : Midas SD Standing data controls update
      *
     E* Description     : Copyright notice for inclusion in all programs
     E*
     E********************************************************************
     E                    CPY@    1   1 80               Copyright array
     E/COPY WNCPYSRC,SD0451REPG
      * Long constants
     E                    @CN#    1   1  6   @CN    25
     I*
     I* Description     : Copyright notice for inclusion in all programs
     I*
     I/COPY QWINDSRC,SD0450GDTA
     I/COPY WNCPYSRC,SD0451RIPG
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      *                                                                   CGL011
     ILDA         DS                            256                       CGL011
      ** Local Data Area for Database Error Details                       CGL011
      *                                                                   CGL011
     I                                      134 141 DBFILE                CGL011
     I                                      142 170 DBKEY                 CGL011
     I                                      171 180 DBPGM                 CGL011
     I                                      181 1830DBASE                 CGL011
      *                                                                   CGL011
     IDSFDY     E DSDSFDY                                                 CGL011
      ** Short Data Structure for Access Programs                         CGL011
      *                                                                   CGL011
     ISCSARD    E DSSCSARDPD                                              CGL011
      ** Data structure for Switchable Features file                      CGL011
      *                                                                   CGL011
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     I@1DBRC    E DSSDCLLML0
      * UPD : Midas SD Customer limits update
      * Current/previous master file format fields for change control
      *
     I***#1DBRC**    DS                            140                    CGL011
     I#1DBRC      DS                            149                       CGL011
      * Stored master file format fields
     I                                        1   1 #1DB1
      *
      * Outward parameters
     I***PARC****    DS                            140                    CGL011
     IPARC        DS                            149                       CGL011
      * RCD : Midas SD Customer limits retrieval
      * I : MAP Customer Number
     I                                        1   6 PACUST
      * I : MAP Level
     I                                        7   7 PALEVL
      * I : MAP Branch/Company Code
     I                                        8  10 PABCCD
      * I : MAP Last Change Date
     I                                    P  11  130PALCD
      * I : MAP Type of Last Change
     I                                       14  14 PATYLC
      * I : MAP FX Limit Type
     I                                       15  17 PAFXLT
      * I : MAP FX Limit Amount
     I                                    P  18  220PAFLAM
      * I : MAP FX Limit Expiry Date
     I                                    P  23  250PAFLED
      * I : MAP FX Limit Review Date
     I                                    P  26  280PAFLRD
      * I : MAP FX Limit Frequency
     I                                       29  29 PAFLFQ
      * I : MAP FX Frequency Day No.
     I                                       30  310PAFFDN
      * I : MAP MDDR Amount
     I                                    P  32  360PAMDDR
      * I : MAP Lending Limit Type
     I                                       37  39 PALLTY
      * I : MAP Lending Limit Amount
     I                                    P  40  440PALLAM
      * I : MAP Lending Limit Expiry Date
     I                                    P  45  470PALLED
      * I : MAP Lending Limit Review Date
     I                                    P  48  500PALLRD
      * I : MAP Lending Limit Frequency
     I                                       51  51 PALLFR
      * I : MAP Lending Frequency Day No.
     I                                       52  530PALFDN
      * I : MAP Secured
     I                                       54  54 PASECD
      * I : MAP FRA Limit Amount
     I                                    P  55  590PAFRLA
      * I : MAP FRA Expiry Date
     I                                    P  60  620PAFRED
      * I : MAP FRA Review Date
     I                                    P  63  650PAFRRD
      * I : MAP FRA Review Frequency
     I                                       66  66 PAFRFQ
      * I : MAP FRA Frequency Day No.
     I                                       67  680PAFRAD
      * I : MAP IRS Limit Amount
     I                                    P  69  730PAIRLM
      * I : MAP IRS Expiry Date
     I                                    P  74  760PAIRED
      * I : MAP IRS Review Date
     I                                    P  77  790PAIRDT
      * I : MAP IRS Review Frequency
     I                                       80  80 PAIRFQ
      * I : MAP IRS Frequency Day No.
     I                                       81  820PAIFDN
      * I : MAP Money market limit type
     I                                       83  85 PAMMTY
      * I : MAP Money market limit amount
     I                                    P  86  900PAMMAM
      * I : MAP Money market expiry date
     I                                    P  91  930PAMMED
      * I : MAP Money market review date
     I                                    P  94  960PAMMRD
      * I : MAP Money market limit Freq.
     I                                       97  97 PAMMFR
      * I : MAP Money market Freq. day no
     I                                       98  990PAMFDN
      * I : MAP Money market secured
     I                                      100 100 PAMSEC
      * I : MAP Money market Line amount
     I                                    P 101 1050PAMLAM
      * I : MAP FX line amount
     I                                    P 106 1100PAFXLA
      * I : MAP FX Forward limit amount
     I                                    P 111 1150PAFXFA
      * I : MAP Prec metals limit type
     I                                      116 118 PAPLTY
      * I : MAP Prec metals frwd lim amt
     I                                    P 119 1230PAPFAM
      * I : MAP Prec metal Spot limit amt
     I                                    P 124 1280PAPSAM
      * I : MAP Prec metals expiry date
     I                                    P 129 1310PAPLED
      * I : MAP Prec metals review date
     I                                    P 132 1340PAPLVD
      * I : MAP Prec metals review freq
     I                                      135 135 PAPLRF
      * I : MAP Prec metals line amount
     I                                    P 136 1400PAPLAM
      * I : MAP FX Limit Secured                                          CGL011
     I                                      149 149 PAFLSC                CGL011
      *
     IQSDFC1    E DSSDFCTLL0
      * UPD : Midas SD Standing data controls update
     IYARDCS      DS                             22
     IWUDELR      DS
     I                                        1 250 WUDR01
     I                                      251 500 WUDR02
     I                                      501 750 WUDR03
     I                                      7511000 WUDR04
     I                                     10011250 WUDR05
     I                                     12511500 WUDR06
     I                                     15011750 WUDR07
     I                                     17512000 WUDR08
     I                                     20012250 WUDR09
     I                                     22512500 WUDR00
     I                                     25012750 WUDR11
     I                                     27513000 WUDR12
      * Outward parameters
     IPBRC        DS                           3064
      * RCD : Midas SD Deleted records file retrieval
      * I :  File name
     I                                        1  10 PBFNME
      * I :  Long Key
     I                                       11  60 PBLKEY
      * I :  Deleted Data Record Pt1
     I                                       61 310 PBDR01
      * I :  Deleted Data Record Pt2
     I                                      311 560 PBDR02
      * I :  Deleted Data Record Pt3
     I                                      561 810 PBDR03
      * I :  Deleted Data Record Pt4
     I                                      8111060 PBDR04
      * I :  Deleted Data Record Pt5
     I                                     10611310 PBDR05
      * I :  Deleted Data Record Pt6
     I                                     13111560 PBDR06
      * I :  Deleted Data Record Pt7
     I                                     15611810 PBDR07
      * I :  Deleted Data Record Pt8
     I                                     18112060 PBDR08
      * I :  Deleted Data Record Pt9
     I                                     20612310 PBDR09
      * I :  Deleted Data Record Pt10
     I                                     23112560 PBDR00
      * I :  Deleted Data Record Pt11
     I                                     25612810 PBDR11
      * I :  Deleted Data Record Pt12
     I                                     28113060 PBDR12
      * I :  Last Change Date
     I                                    P306130630PBLCD
      * I :  Type of Last Change
     I                                     30643064 PBTYLC
      *
     IYBRDCS      DS                             22
     I***YCRDCS**    DS                            140                    CGL011
     IYCRDCS      DS                            149                       CGL011
     IYDRDCS      DS                             22
     IA@CPY       DS
     I* Copyright array
     I                                        1  80 CPY@
     IRUNDAT      DS
     I                                        1   7 MRDT
     I                                    P   8  100RDNB
     I                                       11  11 SUC
     I                                       12  12 DFF
     I                                       13  13 MBIN
     IYRSW0A      DS                           9999
     IYRSW0B      DS                           9999
     IYRSW0C      DS                           9999
     IYRSW0D      DS                           9999
     IID0001      DS                            528
      * File information data structure
      *
     IID0002      DS                            528
      * File information data structure
      *
     IID0003      DS                            528
      * File information data structure
      *
     IID0004      DS                            528
      * File information data structure
      *
     IID0005      DS                            528
      * File information data structure
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I : MAP Customer Number
     I                                        1   6 P1CUST
     IP2PARM      DS
      * I : MAP Level
     I                                        1   1 P2LEVL
     IP3PARM      DS
      * I : MAP Branch/Company Code
     I                                        1   3 P3BCCD
     IP4PARM      DS
      * I : MAP Action Code
     I                                        1   1 P4ANCD
     IP5PARM      DS
      * O : MAP Duplicate Return Code
     I                                        1   7 P5DRTC
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Spot limit amount'
      * Message data for 'Limit Amount(000's)'
      * Message data for 'Spot limit amount'
      * Message data for 'Limit Amount(000's)'
      * Message data for 'FX Limit Type Required'
      * FX Limit Type
     I                                        1   3 ZA0001
      * Message data for 'FX Limit Type Required'
      * FX Limit Type
     I                                        1   3 ZA0002
      * Message data for 'FX Limit Type Required'
      * FX Limit Type
     I                                        1   3 ZA0003
      * Message data for 'FX Limit Type Required'
      * FX Limit Type
     I                                        1   3 ZA0004
      * Message data for 'FX Limit Type Required'
      * FX Limit Type
     I                                        1   3 ZA0005
      * Message data for 'FX Limit Type Required'
      * FX Limit Type
     I                                        1   3 ZA0006
      * Message data for 'FX Limit Type Required'
      * FX Limit Type
     I                                        1   3 ZA0007
      * Message data for 'FX Limit Type Required'
      * FX Limit Type
     I                                        1   3 ZA0008
      * Message data for 'MM Limit type req'
      * Money market limit type
     I                                        1   3 ZA0009
      * Message data for 'MM Limit type req'
      * Money market limit type
     I                                        1   3 ZA0010
      * Message data for 'MM Limit type req'
      * Money market limit type
     I                                        1   3 ZA0011
      * Message data for 'MM Limit type req'
      * Money market limit type
     I                                        1   3 ZA0012
      * Message data for 'MM Limit type req'
      * Money market limit type
     I                                        1   3 ZA0013
      * Message data for 'MM Limit type req'
      * Money market limit type
     I                                        1   3 ZA0014
      * Message data for 'MM Limit type req'
      * Money market limit type
     I                                        1   3 ZA0015
      * Message data for 'MM Limit Type not found'
      * Money market limit type
     I                                        1   3 ZA0016
      * Message data for 'FRA Limit Amount Required'
      * FRA Limit Amount Scrn DS
     I                                        1   9 ZA0017
      * Message data for 'FRA Limit Amount Required'
      * FRA Limit Amount Scrn DS
     I                                        1   9 ZA0018
      * Message data for 'FRA Limit Amount Required'
      * FRA Limit Amount Scrn DS
     I                                        1   9 ZA0019
      * Message data for 'FRA Limit Amount Required'
      * FRA Limit Amount Scrn DS
     I                                        1   9 ZA0020
      * Message data for 'IRS Limit Amount Required'
      * IRS Limit Amount Scrn DS
     I                                        1   9 ZA0021
      * Message data for 'IRS Limit Amount Required'
      * IRS Limit Amount Scrn DS
     I                                        1   9 ZA0022
      * Message data for 'IRS Limit Amount Required'
      * IRS Limit Amount Scrn DS
     I                                        1   9 ZA0023
      * Message data for 'IRS Limit Amount Required'
      * IRS Limit Amount Scrn DS
     I                                        1   9 ZA0024
      * Message data for 'Limit Amount Not Numeric'
      * Fx Limit Amount Screen
     I                                        1   9 ZA0025
      * Message data for 'FX Limit Amount GT Zero'
      * FX Limit Amount Screen DS
     I                                        1   9 ZA0026
      * Message data for 'Expiry Date Numeric'
      * MM expiry date screen DS
     I                                        1   6 ZA0027
      * Message data for 'FX Expiry Date is Invalid'
      * FX Expiry Date Screen
     I                                        1   6 ZA0028
      * Message data for 'Forex Expiry Date must be'
      * FX Expiry Date Screen DS
     I                                        1   6 ZA0029
      * Midas Run Date
     I                                        7  13 ZA0030
      * Message data for 'Review Date Numeric'
      * FX Review Date Screen DS
     I                                        1   6 ZA0031
      * Message data for 'FX Review Date is Invalid'
      * FX Review Date Screen
     I                                        1   6 ZA0032
      * Message data for 'FX Rev Date after Rundat'
      * FX Review Date Screen DS
     I                                        1   6 ZA0033
      * Midas Run Date
     I                                        7  13 ZA0034
      * Message data for 'FX Expiry Date Required'
      * FX Expiry Date Screen DS
     I                                        1   6 ZA0035
      * Message data for 'Fx Rev Date Aft Exp Date'
      * FX Review Date Screen
     I                                        1   6 ZA0036
      * Message data for 'FX Limit Freq Required'
      * FX Limit Frequency
     I                                        1   1 ZA0037
      * Message data for 'FX Limit Freq Blank'
      * FX Limit Frequency
     I                                        1   1 ZA0038
      * Message data for 'FX Limit Frequency inval'
      * FX Limit Frequency
     I                                        1   1 ZA0039
      * Message data for 'Freq Day Num Must Numeric'
      * FX Freq Day Number DS
     I                                        1   2 ZA0040
      * Message data for 'Frequency Day No. Req'
      * FX Freq Day Number DS
     I                                        1   2 ZA0041
      * Message data for 'FX Frequency Day No. Inv'
      * FX Freq Day Number DS
     I                                        1   2 ZA0042
      * Message data for 'FX Frequency Day No. Inv'
      * FX Freq Day Number DS
     I                                        1   2 ZA0043
      * Message data for 'FX Freq Day no - Blank'
      * FX Freq Day Number DS
     I                                        1   2 ZA0044
      * Message data for 'MDDR Amount must Numeric'
      * MDDR Amount Screen
     I                                        1   9 ZA0045
      * Message data for 'FX MDDR Amount invalid'
      * MDDR Amount Screen
     I                                        1   9 ZA0046
      * Message data for 'MDDR amount is required'
      * MDDR Amount Screen
     I                                        1   9 ZA0047
      * Message data for 'FX line amount is req'
      * FX Line amount screen DS
     I                                        1   9 ZA0048
      * Message data for 'Line Amount not numeric'
      * MM Line Amount screen
     I                                        1   9 ZA0049
      * Message data for 'FX line amount GT zero'
      * FX Line amount screen DS
     I                                        1   9 ZA0050
      * Message data for 'FX Forwrd lmt amt numeric'
      * FX Forward limt screen DS
     I                                        1   9 ZA0051
      * Message data for 'FX Frwrd lmt amt GT zero'
      * FX Forward limt screen DS
     I                                        1   9 ZA0052
      * Message data for 'Either Spot/Frwd amt req'
      * FX Limit Amount Screen DS
     I                                        1   9 ZA0053
      * FX Forward limt screen DS
     I                                       10  18 ZA0054
      * Message data for 'FX Limit Amount is req'
      * FX Limit Amount Screen DS
     I                                        1   9 ZA0055
      * Message data for 'Either Spot/Frwd amt req'
      * FX Limit Amount Screen DS
     I                                        1   9 ZA0056
      * FX Forward limt screen DS
     I                                       10  18 ZA0057
      * Message data for 'FX Limit Amount is req'
      * FX Limit Amount Screen DS
     I                                        1   9 ZA0058
      * Message data for 'MM limit amount is Req'
      * MM Limit Amount sceen DS
     I                                        1   9 ZA0059
      * Message data for 'Limit Amount Not Numeric'
      * Fx Limit Amount Screen
     I                                        1   9 ZA0060
      * Message data for 'MM limit amount GT Zero'
      * MM Limit Amount sceen DS
     I                                        1   9 ZA0061
      * Message data for 'Expiry Date Numeric'
      * MM expiry date screen DS
     I                                        1   6 ZA0062
      * Message data for 'MM Expiry date is invalid'
      * MM expiry date screen
     I                                        1   6 ZA0063
      * Message data for 'MM EXP date after rundate'
      * MM expiry date screen
     I                                        1   6 ZA0064
      * Midas Run Date
     I                                        7  13 ZA0065
      * Message data for 'Review Date Numeric'
      * FX Review Date Screen DS
     I                                        1   6 ZA0066
      * Message data for 'MM Review date is invalid'
      * MM review date screen
     I                                        1   6 ZA0067
      * Message data for 'MM REV date after rundate'
      * MM Review date screen DS
     I                                        1   6 ZA0068
      * Midas Run Date
     I                                        7  13 ZA0069
      * Message data for 'MM Expiry date required'
      * MM expiry date screen DS
     I                                        1   6 ZA0070
      * Message data for 'MM Rev date bef exp date'
      * MM Review date screen DS
     I                                        1   6 ZA0071
      * Message data for 'MM limit freq is req'
      * Money market limit Freq.
     I                                        1   1 ZA0072
      * Message data for 'MM limt frq must be blank'
      * Money market limit Freq.
     I                                        1   1 ZA0073
      * Message data for 'MM limit freq is invalid'
      * Money market limit Freq.
     I                                        1   1 ZA0074
      * Message data for 'Freq Day Num Must Numeric'
      * FX Freq Day Number DS
     I                                        1   2 ZA0075
      * Message data for 'MM Freq day no is req'
      * MM Freq Day Number DS
     I                                        1   2 ZA0076
      * Message data for 'MM Freq day no invalid'
      * MM Freq Day Number DS
     I                                        1   2 ZA0077
      * Message data for 'MM Freq day no invalid'
      * MM Freq Day Number DS
     I                                        1   2 ZA0078
      * Message data for 'MM Freq day no - Blank'
      * MM Freq Day Number DS
     I                                        1   2 ZA0079
      * Message data for 'MM Secured blank or yes'
      * Money market secured
     I                                        1   1 ZA0080
      * Message data for 'MM Line amount is req'
      * MM Line amount screen DS
     I                                        1   9 ZA0081
      * Message data for 'Line Amount not numeric'
      * MM Line Amount screen
     I                                        1   9 ZA0082
      * Message data for 'MM line amount GT zero'
      * MM Line amount screen DS
     I                                        1   9 ZA0083
      * Message data for 'Limit Amount Not Numeric'
      * Fx Limit Amount Screen
     I                                        1   9 ZA0084
      * Message data for 'FRA Limit Amount GT Zero'
      * FRA Limit Amount Scrn DS
     I                                        1   9 ZA0085
      * Message data for 'Expiry Date Numeric'
      * MM expiry date screen DS
     I                                        1   6 ZA0086
      * Message data for 'FRA Expiry Date invalid'
      * FRA Expiry Date Screen DS
     I                                        1   6 ZA0087
      * Message data for 'FRA Exp Date not gt rundt'
      * FRA Expiry Date Screen DS
     I                                        1   6 ZA0088
      * Midas Run Date
     I                                        7  13 ZA0089
      * Message data for 'Review Date Numeric'
      * FX Review Date Screen DS
     I                                        1   6 ZA0090
      * Message data for 'FRA Review date invalid'
      * FRA Review Date Screen DS
     I                                        1   6 ZA0091
      * Message data for 'FRA Rev Date after Rundat'
      * FRA Review Date Screen DS
     I                                        1   6 ZA0092
      * Midas Run Date
     I                                        7  13 ZA0093
      * Message data for 'FRA Expiry Date Required'
      * FRA Expiry Date Screen DS
     I                                        1   6 ZA0094
      * Message data for 'fra r dat GT fra ex dat'
      * FRA Review Date Screen DS
     I                                        1   6 ZA0095
      * Message data for 'FRA Review Freq Required'
      * FRA Review Frequency
     I                                        1   1 ZA0096
      * Message data for 'FRA Rev Freq Should Blank'
      * FRA Review Frequency
     I                                        1   1 ZA0097
      * Message data for 'FRA Review Freq Invalid'
      * FRA Review Frequency
     I                                        1   1 ZA0098
      * Message data for 'Freq Day Num Must Numeric'
      * FX Freq Day Number DS
     I                                        1   2 ZA0099
      * Message data for 'FRA Freq Day Num Required'
      * FRA Freq Day Number DS
     I                                        1   2 ZA0100
      * Message data for 'FRA Freq Day No Invalid'
      * FRA Freq Day Number DS
     I                                        1   2 ZA0101
      * Message data for 'FRA Freq Day No Invalid'
      * FRA Freq Day Number DS
     I                                        1   2 ZA0102
      * Message data for 'FRA Freq Day No Blank'
      * FRA Freq Day Number DS
     I                                        1   2 ZA0103
      * Message data for 'Limit Amount Not Numeric'
      * Fx Limit Amount Screen
     I                                        1   9 ZA0104
      * Message data for 'IRS Limit Amount GT Zero'
      * IRS Limit Amount Scrn DS
     I                                        1   9 ZA0105
      * Message data for 'Expiry Date Numeric'
      * MM expiry date screen DS
     I                                        1   6 ZA0106
      * Message data for 'IRS Expiry Date Invalid'
      * IRS Expiry Date Screen
     I                                        1   6 ZA0107
      * Message data for 'IRS Exp dat LE rundat'
      * IRS Expiry Date Screen DS
     I                                        1   6 ZA0108
      * Midas Run Date
     I                                        7  13 ZA0109
      * Message data for 'Review Date Numeric'
      * FX Review Date Screen DS
     I                                        1   6 ZA0110
      * Message data for 'IRS Review Date Invalid'
      * IRS Review Date Screen DS
     I                                        1   6 ZA0111
      * Message data for 'IRS Rev Date after Rundat'
      * IRS Review Date Screen DS
     I                                        1   6 ZA0112
      * Midas Run Date
     I                                        7  13 ZA0113
      * Message data for 'IRS Expiry Date Required'
      * IRS Expiry Date Screen DS
     I                                        1   6 ZA0114
      * Message data for 'IRS Rev dat GT IRS Ex Dat'
      * IRS Review Date Screen DS
     I                                        1   6 ZA0115
      * Message data for 'IRS Review Freq Required'
      * IRS Review Frequency
     I                                        1   1 ZA0116
      * Message data for 'IRS Rev Frq must be Blank'
      * IRS Review Frequency
     I                                        1   1 ZA0117
      * Message data for 'IRS Review Freq Invalid'
      * IRS Review Frequency
     I                                        1   1 ZA0118
      * Message data for 'Freq Day Num Must Numeric'
      * FX Freq Day Number DS
     I                                        1   2 ZA0119
      * Message data for 'IRS Freq Day no Required'
      * IRS Freq Day Number DS
     I                                        1   2 ZA0120
      * Message data for 'IRS Freq Day No Invalid'
      * IRS Freq Day Number DS
     I                                        1   2 ZA0121
      * Message data for 'IRS Freq Day No Invalid'
      * IRS Freq Day Number DS
     I                                        1   2 ZA0122
      * Message data for 'IRS Freq Day no must blnk'
      * IRS Freq Day Number DS
     I                                        1   2 ZA0123
      * Message data for 'Database Error (ICD)'
      * Filename
     I                                        1  10 ZA0124
      * Message data for 'FX Limit Type Required'                         CGL011
      * FX Limit Type                                                     CGL011
     I                                        1   1 ZA0125                CGL011
      * Message data for 'FX Secured must be 'Y' or blank'                CGL011
      * FX Limit Secured                                                  CGL011
     I                                        1   1 ZA0126                CGL011
      *                                                                   CGL011
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1CUST    PARM           WP0001  6        Customer Number
     C           P2LEVL    PARM           WP0002  1        Level
     C           P3BCCD    PARM           WP0003  3        Branch/Company
     C           P4ANCD    PARM           WP0004  1        Action Code
     C           P5DRTC    PARM P5DRTC    WP0005  7        Duplicate Retur
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
     C/COPY WNCPYSRC,SD0451RC29
      *
      * Check passed parameters
     C                     EXSR FACKPM
      * Perform once if all passed, else repeat
     C           W0RPT     DOUEQ'N'
      * Display and process key screen
     C                     EXSR BADSKY
     C                     END
      * Terminate program
     C                     EXSR ZXEXPG
      *****************************************************************
      /EJECT
     CSR         BADSKY    BEGSR
      *================================================================
      * Display and process key screen
      *================================================================
      * Initialize key screen
     C                     EXSR MDIZ#K
      * Bypass first display of key screen is possible
     C                     MOVEL'Y'       W0BYP   1
      * Signal start of transaction
     C                     MOVEL'Y'       W0TRN   1
     C           W0TRN     DOWEQ'Y'
     C           W0TRN     OREQ 'K'
      * Ensure transaction continues (if reset)
     C                     MOVEL'Y'       W0TRN   1
      * Conduct screen conversation
     C           W0TRN     DOWEQ'Y'
      * Is bypass key screen still viable?
     C           W0BYP     IFEQ 'Y'
     C           #1CUST    IFEQ *BLANK                     Customer Number
     C           #1LEVL    OREQ *BLANK                     Level
     C           #1BCCD    OREQ *BLANK                     Branch/Company
      * One or more key fields is blank
     C           *IN05     OREQ '1'
      * HOME: Reset screen fields
     C                     MOVEL'N'       W0BYP
     C                     END
     C                     END
      * Bypass key screen
     C           W0BYP     IFNE 'Y'
      * Display key screen
     C                     EXSR BBEXFM
     C                     END
      * Cancel key screen bypass
     C                     MOVEL'N'       W0BYP
      * Process response to key screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * Switch between *ADD/*CHANGE modes
     C   09                CAS            BCCHMD
      * HOME: Reset screen fields
     C   05                CAS            BDHMKY
      * Process key screen input
     C                     CAS            BEPRKY
     C                     END
     C           W0TRN     DOWEQ'R'
     C                     MOVEL'Y'       W0TRN
     C                     EXSR BEPRKY
     C                     END
      *
     C                     END
     C                     END
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBEXFM    BEGSR
      *================================================================
      * Display key screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSAK
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE HELP25    *IN25
      * PUTOVR unless conditioned fields change
     C                     SETON                         86*
     C           *IN89     IFNE BBIN89
     C                     SETOF                         86*
     C                     END
     C                     MOVE *IN89     BBIN89  1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDKEY
      * Test cursor
     C                     EXSR Y8TST
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1
      * Reset global error indicator
     C                     SETOF                         99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         BCCHMD    BEGSR
      *================================================================
      * Switch between *ADD/*CHANGE modes
      *================================================================
     C           W0PMD     IFEQ 'ADD'
     C                     MOVEL'CHG'     W0PMD   3
     C                     ELSE
     C                     MOVEL'ADD'     W0PMD
     C                     END
      *================================================================
     CSR         BCEXIT    ENDSR
      /EJECT
     CSR         BDHMKY    BEGSR
      *================================================================
      * Process HOME key
      *================================================================
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         BDEXIT    ENDSR
      /EJECT
     CSR         BEPRKY    BEGSR
      *================================================================
      * Process key screen input
      *================================================================
      * Initialise detail screen
     C                     EXSR MAIZ#1
      * Validate key fields
     C                     EXSR BFVLKY
     C           *IN99     CABEQ'1'       BEEXIT
      * Check for existing record
     C           KRTV      KLIST
     C                     KFLD           DZCUST           Customer Number
     C                     KFLD           DZLEVL           Level
     C                     KFLD           DZBCCD           Branch/Company
      * Setup key
     C                     MOVEL#1CUST    DZCUST           Customer Number
     C                     MOVEL#1LEVL    DZLEVL           Level
     C                     MOVEL#1BCCD    DZBCCD           Branch/Company
     C           KRTV      CHAIN@DZREHT              9091  *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     SETON                     993132*
     C                     SETON                     33    *
     C                     GOTO BEEXIT
     C                     END                             FI 91
      *
      * Verify record existence against program mode
     C           W0PMD     IFNE 'ADD'
      * If record does not exist, error
     C           *IN90     IFEQ '1'
     C                     SETON                     993132*
     C                     SETON                     33    *
      * Send message 'Client Limits          NF'
     C                     MOVEL'USR0665' ZAMSID
     C                     EXSR ZASNMS
     C                     ELSE
     C                     EXSR MBFL#1
      * CALC: Detail screen function fields
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy Member SD0451RSFF - Client Limits  *
     C/COPY WNCPYSRC,SD0451RSFF
     C                     END                             *FI
      * USER: Initialize detail screen (existing record)
      * Set-up DTL Screen Footer - Standard Functions  *
     C*
     C*  DETAIL LINE COMMAND KEY TEXT
     C*
     C                     MOVEL'SDUSRMSG'WUMSGF 10
     C                     MOVE *BLANKS   WUMTXT 80
     C*
     C*  If Action Code is Delete :
     C*
     C           #PANCD    IFEQ 'D'                                       S01229
     C* Setup footer text:
     C* F3=Main Menu   F10=Delete   F12=Previous
     C                     MOVEL'USR3350' WUMSID  7        Message Identifier
     C                     CALL 'SDRTVTXT'             90  Retrieve MSGF message
     C           WUMSID    PARM WUMSID    KE0286  7        Message Identifier
     C           WUMSGF    PARM WUMSGF    KE0287 10        Message File Name
     C           WUMTXT    PARM WUMTXT    KE0288 80        Message Text
     C                     MOVELWUMTXT    ##CTX1
     C*
     C           *IN90     IFEQ '1'
     C* Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SDRTVTXT'W0CLPG
     C* Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
     C                     END
     C*
     C*  If Action Code is Insert :
     C*
     C           #PANCD    IFEQ 'I'                                       S01229
     C* Setup footer text:
     C* F3=Exit   F12=Previous
     C                     MOVEL'USR3351' WUMSID           Message Identifier
     C                     CALL 'SDRTVTXT'             90  Retrieve MSGF message
     C           WUMSID    PARM WUMSID    KE0286  7        Message Identifier
     C           WUMSGF    PARM WUMSGF    KE0287 10        Message File Name
     C           WUMTXT    PARM WUMTXT    KE0288 80        Message Text
     C                     MOVELWUMTXT    ##CTX1
     C*
     C           *IN90     IFEQ '1'
     C* Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SDRTVTXT'W0CLPG
     C* Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
     C                     END
     C*
     C*  If Action Code is Amend :
     C*
     C           #PANCD    IFEQ 'A'                                       S01229
     C* Setup footer text:
     C* F3=Main Menu   F12=Previous
     C                     MOVEL'USR3346' WUMSID           Message Identifier
     C                     CALL 'SDRTVTXT'             90  Retrieve MSGF message
     C           WUMSID    PARM WUMSID    KE0286  7        Message Identifier
     C           WUMSGF    PARM WUMSGF    KE0287 10        Message File Name
     C           WUMTXT    PARM WUMTXT    KE0288 80        Message Text
     C                     MOVELWUMTXT    ##CTX1
     C*
     C           *IN90     IFEQ '1'
     C* Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SDRTVTXT'W0CLPG
     C* Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
     C                     END
     C*
      * Start of S01433
      * Display the correct field text depending on
      * whether S01433 is switched ON or OFF.
      * CASE: WRK.SAR S01433 is Present
     C           WUSARF    IFEQ 'Y'                        *IF
      * Setup message data for message
      * Retrieve message Spot limit amount
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR2129' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C           #DLMAS    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
     C                     ELSE
      * CASE: WRK.SAR S01433 is Not present
     C           WUSARF    IFEQ 'N'                        *IF
      * Setup message data for message
      * Retrieve message Limit Amount(000's)
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR2130' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C           #DLMAS    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
     C                     END                             *FI
     C                     END                             *FI
      * End of S01433
      * Display Level and Branch/company Code?
      * CASE: WRK.Multi-branching Indicator is Multi-branched
     C           WUMBIN    IFEQ 'Y'                        *IF
      * Only if Level is Not System
      * CASE: DTL.Branch/Company Code is Is System
     C           #1BCCD    IFEQ 'SYS'                      *IF
     C                     MOVEL'N'       WUDLBC           Display Level &
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUDLBC           Display Level &
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUDLBC           Display Level &
     C                     END                             *FI
      * Convert All File Dates To Screen Dates
     C                     EXSR UASUBR                     Convert All Fil
      * Convert File amounts to function fields
     C                     EXSR UBSUBR                     Convert File am
      * Start of Fix BHF329
      * Addition of customer shortname, name and town on the screen
      * for reference purposes
      * RTV Shortname,name + town - Client Details  *
     C                     EXSR SARVGN
     C                     MOVELWUCSSN    #DCUSN           Customer  Scree
     C                     MOVELWUCRNM    #DSRNM           Screen Report N
     C                     MOVELWUCRTN    #DSRTN           Screen Report T
      * End of Fix BHF329
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy Member SD0451RISE - Client Limits  *
     C/COPY WNCPYSRC,SD0451RISE
     C                     END                             *FI
     C                     END
      *
     C                     ELSE
      * If record already exists, error
     C           *IN90     IFEQ '0'
     C                     SETON                     993132*
     C                     SETON                     33    *
      * Send message 'Client Limits          EX'
     C                     MOVEL'USR0666' ZAMSID
     C                     EXSR ZASNMS
     C                     ELSE
      * USER: Initialize detail screen (new record)
      * Set-up DTL Screen Footer - Standard Functions  *
     C*
     C*  DETAIL LINE COMMAND KEY TEXT
     C*
     C                     MOVEL'SDUSRMSG'WUMSGF 10
     C                     MOVE *BLANKS   WUMTXT 80
     C*
     C*  If Action Code is Delete :
     C*
     C           #PANCD    IFEQ 'D'                                       S01229
     C* Setup footer text:
     C* F3=Main Menu   F10=Delete   F12=Previous
     C                     MOVEL'USR3350' WUMSID  7        Message Identifier
     C                     CALL 'SDRTVTXT'             90  Retrieve MSGF message
     C           WUMSID    PARM WUMSID    KE0286  7        Message Identifier
     C           WUMSGF    PARM WUMSGF    KE0287 10        Message File Name
     C           WUMTXT    PARM WUMTXT    KE0288 80        Message Text
     C                     MOVELWUMTXT    ##CTX1
     C*
     C           *IN90     IFEQ '1'
     C* Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SDRTVTXT'W0CLPG
     C* Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
     C                     END
     C*
     C*  If Action Code is Insert :
     C*
     C           #PANCD    IFEQ 'I'                                       S01229
     C* Setup footer text:
     C* F3=Exit   F12=Previous
     C                     MOVEL'USR3351' WUMSID           Message Identifier
     C                     CALL 'SDRTVTXT'             90  Retrieve MSGF message
     C           WUMSID    PARM WUMSID    KE0286  7        Message Identifier
     C           WUMSGF    PARM WUMSGF    KE0287 10        Message File Name
     C           WUMTXT    PARM WUMTXT    KE0288 80        Message Text
     C                     MOVELWUMTXT    ##CTX1
     C*
     C           *IN90     IFEQ '1'
     C* Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SDRTVTXT'W0CLPG
     C* Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
     C                     END
     C*
     C*  If Action Code is Amend :
     C*
     C           #PANCD    IFEQ 'A'                                       S01229
     C* Setup footer text:
     C* F3=Main Menu   F12=Previous
     C                     MOVEL'USR3346' WUMSID           Message Identifier
     C                     CALL 'SDRTVTXT'             90  Retrieve MSGF message
     C           WUMSID    PARM WUMSID    KE0286  7        Message Identifier
     C           WUMSGF    PARM WUMSGF    KE0287 10        Message File Name
     C           WUMTXT    PARM WUMTXT    KE0288 80        Message Text
     C                     MOVELWUMTXT    ##CTX1
     C*
     C           *IN90     IFEQ '1'
     C* Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SDRTVTXT'W0CLPG
     C* Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
     C                     END
     C*
      * Start of S01433
      * Display the correct field text depending on
      * whether S01433 is switched ON or OFF.
      * CASE: WRK.SAR S01433 is Present
     C           WUSARF    IFEQ 'Y'                        *IF
      * Setup message data for message
      * Retrieve message Spot limit amount
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR2129' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C           #DLMAS    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
     C                     ELSE
      * CASE: WRK.SAR S01433 is Not present
     C           WUSARF    IFEQ 'N'                        *IF
      * Setup message data for message
      * Retrieve message Limit Amount(000's)
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR2130' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C           #DLMAS    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
     C                     END                             *FI
     C                     END                             *FI
      * End of S01433
      * Display Level and Branch/company Code?
      * CASE: WRK.Multi-branching Indicator is Multi-branched
     C           WUMBIN    IFEQ 'Y'                        *IF
      * Only if Level is Not System
      * CASE: DTL.Branch/Company Code is Is System
     C           #1BCCD    IFEQ 'SYS'                      *IF
     C                     MOVEL'N'       WUDLBC           Display Level &
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUDLBC           Display Level &
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUDLBC           Display Level &
     C                     END                             *FI
      * Start of Fix BHF329
      * Addition of customer shortname, name and town on the screen
      * for reference purposes
      * RTV Shortname,name + town - Client Details  *
     C                     EXSR SBRVGN
     C                     MOVELWUCSSN    #DCUSN           Customer  Scree
     C                     MOVELWUCRNM    #DSRNM           Screen Report N
     C                     MOVELWUCRTN    #DSRTN           Screen Report T
      * End of Fix BHF329
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy Member SD0451RISN - Client Limits  *
     C/COPY WNCPYSRC,SD0451RISN
     C                     END                             *FI
     C                     END
     C                     END
      *..................................................
     C   99                GOTO BEEXIT
      * No error: Display and process details
     C                     EXSR CADSDA
      *
      *================================================================
     CSR         BEEXIT    ENDSR
      /EJECT
     CSR         BFVLKY    BEGSR
      *================================================================
      * Validate key fields
      *================================================================
     C           W0PMD     IFNE 'ADD'
      * Select existing record
     C                     EXSR VACKRL
     C                     END
      * Check relations
      * Check reference to Client Details
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * USER: Validate key screen
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy Member SD0451RVKS - Client Limits  *
     C/COPY WNCPYSRC,SD0451RVKS
     C                     END                             *FI
      * Customer Number required
     C           #1CUST    IFEQ *BLANK                     IF
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Level required
     C           #1LEVL    IFEQ *BLANK                     IF
     C                     SETON                     9932  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Branch/Company Code required
     C           #1BCCD    IFEQ *BLANK                     IF
     C                     SETON                     9933  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         BFEXIT    ENDSR
      /EJECT
     CSR         CADSDA    BEGSR
      *================================================================
      * Display and process detail screen
      *================================================================
      * Conduct detail screen conversation
      * - repeat until screen control flag is reset:
     C           W0TRN     DOWEQ'Y'
      * Display detail screen
     C                     EXSR CBEXFM
      * Process response to detail screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * Redisplay previous screen
     C   12                CAS            CCDSPV
      * HOME: Reset screen fields
     C   05                CAS            CCDSPV
      * Process detail screen input
     C                     CAS            CFPRSC
     C                     END
     C           W0TRN     IFEQ 'R'
     C           W0PMD     IFEQ 'ADD'
     C                     EXSR MAIZ#1
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         CBEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE HELP25    *IN25
      * PUTOVR unless conditioned fields change
     C                     SETON                         86*
     C           *IN89     IFNE CBIN89
     C                     SETOF                         86*
     C                     END
     C                     MOVE *IN89     CBIN89  1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y1SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT2
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1
      * Reset global error indicator
     C                     SETOF                         99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CBEXIT    ENDSR
      /EJECT
     CSR         CCDSPV    BEGSR
      *================================================================
      * Redisplay previous screen
      *================================================================
      * USER: Process key screen request
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy Member SD0451RPKR - Client Limits  *
     C/COPY WNCPYSRC,SD0451RPKR
     C                     END                             *FI
     C                     MOVEL'USR0790' P5DRTC           Duplicate Retur
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C   05                MOVEL'R'       W0TRN
     C   12                MOVEL'K'       W0TRN
      *================================================================
     CSR         CCEXIT    ENDSR
      /EJECT
     CSR         CFPRSC    BEGSR
      *================================================================
      * Validate record
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * If delete is not pending....
      * Validate details
     C  N10                CAS            DCVLDL
     C                     END
      * QUIT if error:
     C   99                GOTO CFEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       CFEXIT
      * No error: update record
     C                     EXSR EBPR##
      *================================================================
     CSR         CFEXIT    ENDSR
      /EJECT
     CSR         DCVLDL    BEGSR
      *================================================================
      * Validate details
      *================================================================
      *                                                                   192740
      ** Check reference to Limit types                                   192740
      *                                                                   192740
     C                     EXSR VCCKRL                                    192740
     C           W0RTN     IFNE *BLANK                                    192740
     C                     SETON                     9931                 192740
     C                     END                                            192740
      *                                                                   192740
      * Validate FX Limit Frequency
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1FLFQ    W0NSRQ  1        FX Limit Freque
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1177888   Y2LSNO  70
     C           #1FLFQ    PARM #1FLFQ    W0EXVL 20        FX Limit Freque
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
      * Validate Money market limit Freq.
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1MMFR    W0NSRQ  1        Money market li
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1174218   Y2LSNO  70
     C           #1MMFR    PARM #1MMFR    W0EXVL 20        Money market li
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
      * Validate Money market secured
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1MSEC    W0NSRQ  1        Money market se
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1174778   Y2LSNO  70
     C           #1MSEC    PARM #1MSEC    W0EXVL 20        Money market se
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
      * Validate FRA Review Frequency
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1FRFQ    W0NSRQ  1        FRA Review Freq
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1177895   Y2LSNO  70
     C           #1FRFQ    PARM #1FRFQ    W0EXVL 20        FRA Review Freq
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
      * Validate IRS Review Frequency
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1IRFQ    W0NSRQ  1        IRS Review Freq
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1177902   Y2LSNO  70
     C           #1IRFQ    PARM #1IRFQ    W0EXVL 20        IRS Review Freq
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
      * USER: Validate detail screen fields
      * Disable ENTER in Delete Mode
      * CASE: PAR.Action Code is Delete
     C           P4ANCD    IFEQ 'D'                        *IF
      * Send message 'F3/F10/F12 only valid opt'
     C                     MOVEL'USR0536' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
      * Start of S01433
      * Validate Limits fields
      * Set Details Entered to Details  Entered
     C                     EXSR UCSUBR                     Set Details Ent
      * Test for Blanks in Status fields
     C                     EXSR UDSUBR                     Test for Blanks
      * If FX Limit Type is Blank, all other fields must be Blank
      * CASE: PAR.FX Limit Type is equal blank
     C           #1FXLT    IFEQ *BLANK                     *IF
      * CASE: PAR.FX Limit Amount Screen DS is Not Equal Blank
     C           #DFLAS    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1FXLT    ZA0001           FX Limit Type
      * Send message 'FX Limit Type Required'
     C                     MOVEL'USR0728' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     ELSE
      * CASE: PAR.FX Expiry Date Screen DS is Not Equal Blank
     C           #DSFED    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1FXLT    ZA0002           FX Limit Type
      * Send message 'FX Limit Type Required'
     C                     MOVEL'USR0728' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     ELSE
      * CASE: PAR.FX Review Date Screen DS is Not Equal Blank
     C           #DSFRD    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1FXLT    ZA0003           FX Limit Type
      * Send message 'FX Limit Type Required'
     C                     MOVEL'USR0728' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     ELSE
      * CASE: WRK.Blank in Frequency Field is Blank not in Field
     C           WUBIFF    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#1FXLT    ZA0004           FX Limit Type
      * Send message 'FX Limit Type Required'
     C                     MOVEL'USR0728' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     ELSE
      * CASE: PAR.FX Freq Day Number DS is Not Equal Blank
     C           #DFFDS    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1FXLT    ZA0005           FX Limit Type
      * Send message 'FX Limit Type Required'
     C                     MOVEL'USR0728' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     ELSE
      * CASE: PAR.MDDR Amount Screen is Not Equal Blank
     C           #DMDAS    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1FXLT    ZA0006           FX Limit Type
      * Send message 'FX Limit Type Required'
     C                     MOVEL'USR0728' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *                                                                   CGL011
      ** If CGL011 is installed, check if FX Limit Secured                CGL011
      ** screen field is not blank                                        CGL011
      *                                                                   CGL011
     C                     ELSE                                           CGL011
      *                                                                   CGL011
     C           CGL011    IFEQ 'Y'                                       CGL011
     C           #1FLSC    ANDNE*BLANK                                    CGL011
     C                     MOVEL#1FXLT    ZA0125                          CGL011
     C                     MOVEL'USR0728' ZAMSID                          CGL011
     C                     EXSR ZASNMS                                    CGL011
     C                     MOVE *ON       *IN99                           CGL011
     C                     MOVE *ON       *IN31                           CGL011
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'0'       WUDTEN           Details Entered
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF                                          CGL011
      *                                                                   CGL011
      * Start of S01433
      * FX line amount and FX forward limit amount
      * CASE: WRK.SAR S01433 is Present
     C           WUSARF    IFEQ 'Y'                        *IF
      * CASE: PAR.FX Limit Type is equal blank
     C           #1FXLT    IFEQ *BLANK                     *IF
      * CASE: PAR.FX Line amount screen DS is Not equal blank
     C           #DFXLS    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1FXLT    ZA0007           FX Limit Type
      * Send message 'FX Limit Type Required'
     C                     MOVEL'USR0728' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
      * Start of 077893
     C                     MOVEL'Y'       WUEFLD           Error field
     C                     MOVEL'1'       WUDTEN           Details Entered
      * End of 077893
     C                     ELSE
      * CASE: PAR.FX Forward limt screen DS is Not equal blank
     C           #DFFLA    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1FXLT    ZA0008           FX Limit Type
      * Send message 'FX Limit Type Required'
     C                     MOVEL'USR0728' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
      * Start of 077893
     C                     MOVEL'Y'       WUEFLD           Error field
     C                     MOVEL'1'       WUDTEN           Details Entered
      * End of 077893
     C                     ELSE
      * CASE: *OTHERWISE
      * Start of 077893
      * CASE: WRK.Error field is Not error
     C           WUEFLD    IFEQ 'N'                        *IF
     C                     MOVEL'0'       WUDTEN           Details Entered
     C                     END                             *FI
      * End of 077893
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * End of S01433
      * FX - Blank out file dates and numerics
     C                     EXSR UESUBR                     FX - Blank out
      * Start of 063211
     C                     MOVEL'N'       WUSLAF           Spot Limit Amou
     C                     MOVEL'N'       WUFLAF           Forward Limit A
      * End of 063211
      * Start of S01433
      * CASE: WRK.SAR S01433 is Present
     C           WUSARF    IFEQ 'Y'                        *IF
      * Test for Blanks in Status fields
     C                     EXSR UFSUBR                     Test for Blanks
      * If MM Limit Type is Blank, all other fields must be Blank
      * CASE: PAR.Money market limit type is Blank
     C           #1MMTY    IFEQ *BLANK                     *IF
      * CASE: PAR.MM Limit Amount sceen DS is Not equal blank
     C           #DMLAS    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1MMTY    ZA0009           Money market li
      * Send message 'MM Limit type req'
     C                     MOVEL'USR2143' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     ELSE
      * CASE: PAR.MM expiry date screen DS is Not equal blank
     C           #DMEDS    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1MMTY    ZA0010           Money market li
      * Send message 'MM Limit type req'
     C                     MOVEL'USR2143' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     ELSE
      * CASE: PAR.MM Review date screen DS is Not equal blank
     C           #DMRDS    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1MMTY    ZA0011           Money market li
      * Send message 'MM Limit type req'
     C                     MOVEL'USR2143' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     ELSE
      * CASE: WRK.Blank in Frequency Field is Blank not in Field
     C           WUBIFF    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#1MMTY    ZA0012           Money market li
      * Send message 'MM Limit type req'
     C                     MOVEL'USR2143' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     ELSE
      * CASE: PAR.MM Freq Day Number DS is Not equal blank
     C           #DMFDS    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1MMTY    ZA0013           Money market li
      * Send message 'MM Limit type req'
     C                     MOVEL'USR2143' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     ELSE
      * CASE: WRK.Blank in Secured Field is Blank not in Field
     C           WUBISF    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#1MMTY    ZA0014           Money market li
      * Send message 'MM Limit type req'
     C                     MOVEL'USR2143' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     ELSE
      * CASE: PAR.MM Line amount screen DS is not equal blank
     C           #DMLSC    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1MMTY    ZA0015           Money market li
      * Send message 'MM Limit type req'
     C                     MOVEL'USR2143' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'0'       WUDTLE           Details entered
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#1MMTY    WUTQKF           Test ? in Key F
      * CASE: WRK.Test ? in Key Field is Question Mark
     C           WUTQKF    IFEQ '?'                        *IF
     C                     MOVEL#1MMTY    WULMTY           Limit Type
      * Select Limits - Limit types  *
     C                     CALL 'SD0141S'              90  Select Limits
     C                     PARM *BLANK    W0RTN   7
     C           WULMTY    PARM WULMTY    WQ0121  3        Limit Type
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0141S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELWULMTY    #1MMTY           Money market li
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: *OTHERWISE
      * Money Market limit type is NOT '?'.
     C                     MOVEL#1MMTY    WULMTY           Limit Type
      * Does Limit Type exist? - Limit types  *
     C                     EXSR SCRVGN
      * check the return code
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#1MMTY    ZA0016           Money market li
      * Send message 'MM Limit Type not found'
     C                     MOVEL'USR2190' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * MM - Blank out file dates and numerics
     C                     EXSR UGSUBR                     MM - Blank out
     C                     END                             *FI
      * End of S01433
      * Test for Blanks in Status fields
     C                     EXSR UHSUBR                     Test for Blanks
      * If FRA Limit Amount is Blank, all other fields must be Blank
      * CASE: PAR.FRA Limit Amount Scrn DS is Equal Blank
     C           #DRLAS    IFEQ *BLANK                     *IF
      * CASE: PAR.FRA Expiry Date Screen DS is Not Equal Blank
     C           #DSRED    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DRLAS    ZA0017           FRA Limit Amoun
      * Send message 'FRA Limit Amount Required'
     C                     MOVEL'USR0692' ZAMSID
     C/COPY WNCPYSRC,SD0451RC03
     C                     EXSR ZASNMS
     C                     SETON                     9948  *
      *
     C                     ELSE
      * CASE: PAR.FRA Review Date Screen DS is Not Equal Blank
     C           #DSRRD    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DRLAS    ZA0018           FRA Limit Amoun
      * Send message 'FRA Limit Amount Required'
     C                     MOVEL'USR0692' ZAMSID
     C/COPY WNCPYSRC,SD0451RC04
     C                     EXSR ZASNMS
     C                     SETON                     9948  *
      *
     C                     ELSE
      * CASE: WRK.Blank in Frequency Field is Blank not in Field
     C           WUBIFF    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#DRLAS    ZA0019           FRA Limit Amoun
      * Send message 'FRA Limit Amount Required'
     C                     MOVEL'USR0692' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9948  *
      *
     C                     ELSE
      * CASE: PAR.FRA Freq Day Number DS is Not Equal Blank
     C           #DRFDS    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DRLAS    ZA0020           FRA Limit Amoun
      * Send message 'FRA Limit Amount Required'
     C                     MOVEL'USR0692' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9948  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'0'       WUDEFR           Details Entered
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * FRA - Blank out file dates and numerics
     C                     EXSR UISUBR                     FRA - Blank out
      * Test for Blanks in Status fields
     C                     EXSR UJSUBR                     Test for Blanks
      * If IRS Limit Amount is Blank, all other fields must be Blank
      * CASE: PAR.IRS Limit Amount Scrn DS is Equal Blank
     C           #DILAS    IFEQ *BLANK                     *IF
      * CASE: PAR.IRS Expiry Date Screen DS is Not Equal Blank
     C           #DSIED    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DILAS    ZA0021           IRS Limit Amoun
      * Send message 'IRS Limit Amount Required'
     C                     MOVEL'USR0693' ZAMSID
     C/COPY WNCPYSRC,SD0451RC05
     C                     EXSR ZASNMS
     C                     SETON                     9949  *
      *
     C                     ELSE
      * CASE: PAR.IRS Review Date Screen DS is Not Equal Blank
     C           #DSIRD    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DILAS    ZA0022           IRS Limit Amoun
      * Send message 'IRS Limit Amount Required'
     C                     MOVEL'USR0693' ZAMSID
     C/COPY WNCPYSRC,SD0451RC06
     C                     EXSR ZASNMS
     C                     SETON                     9949  *
      *
     C                     ELSE
      * CASE: WRK.Blank in Frequency Field is Blank not in Field
     C           WUBIFF    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#DILAS    ZA0023           IRS Limit Amoun
      * Send message 'IRS Limit Amount Required'
     C                     MOVEL'USR0693' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9949  *
      *
     C                     ELSE
      * CASE: PAR.IRS Freq Day Number DS is Not Equal Blank
     C           #DIFDS    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DILAS    ZA0024           IRS Limit Amoun
      * Send message 'IRS Limit Amount Required'
     C                     MOVEL'USR0693' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9949  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'0'       WUDEIR           Details Entered
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * IRS - blank out file dates and numerics
     C                     EXSR UKSUBR                     IRS - blank out
      * Start of 077893
     C                     MOVEL*BLANK    WUINPT           Input field
      * End of 077893
      * If No Details Entered, Send error message
      * CASE: WRK.Details Entered is Details Not Entered
     C           WUDTEN    IFEQ '0'                        *IF
      * CASE: WRK.Detalis entered - MM is Details not entered
     C           WUDTLE    IFEQ '0'                        *IF
      * CASE: WRK.Details Entered - FRA is Details Not Entered
     C           WUDEFR    IFEQ '0'                        *IF
      * CASE: WRK.Details Entered - IRS is Details Not Entered
     C           WUDEIR    IFEQ '0'                        *IF
      * Start of 077893
      * Do not send the error message
     C                     MOVEL'N'       WUEFLD           Error field
     C                     MOVEL'N'       WUINPT           Input field
      * End of 077893
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate FX Fields
     C                     EXSR ULSUBR                     Validate FX Fie
      * Start of 077893
      * If the Limit Type, the MDDR or the Line amount have a value, then
      * check the spot & forward limit amounts are equal to blank.
      * CASE:
      *  - c1 OR c2 OR c3
      *   |- c1    : PAR.FX Limit Type is not equal blank
      *   |- c2    : PAR.MDDR Amount Screen is Not Equal Blank
      *   |- c3    : PAR.FX Line Amount screen is Not equal blank
      *   '-
     C           #1FXLT    IFNE *BLANK                     *IF
     C           #DMDAS    ORNE *BLANK                     *OR
     C           #DFXLS    ORNE *BLANK                     *OR
      * Start of 063211
      * FX Spot and Forward limit amounts (cannot both be blank)
      * CASE: WRK.Spot Limit Amount Flag is Blank
     C           WUSLAF    IFEQ 'N'                        *IF
      * CASE: WRK.Forward Limit Amount Flag is Blank
     C           WUFLAF    IFEQ 'N'                        *IF
      * CASE: WRK.SAR S01433 is Present
     C           WUSARF    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DFLAS    ZA0053           FX Limit Amount
     C                     MOVEL#DFFLA    ZA0054           FX Forward limt
      * Send message 'Either Spot/Frwd amt req'
     C                     MOVEL'USR2202' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993347*
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DFLAS    ZA0055           FX Limit Amount
      * Send message 'FX Limit Amount is req'
     C                     MOVEL'USR2203' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * End of 063211
     C                     ELSE
      * CASE: *OTHERWISE
      * If the Limit Type, the MDDR or the Line amount are blank but
      * another field has been input validate the spot & forward limit
      * amounts.
      * CASE: WRK.Error field is Error
     C           WUEFLD    IFEQ 'Y'                        *IF
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Spot Limit Amount Flag is Blank
      *   |- c2    : WRK.Forward Limit Amount Flag is Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUSLAF    IFEQ 'N'                        *IF
     C           WUFLAF    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: WRK.SAR S01433 is Present
     C           WUSARF    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DFLAS    ZA0056           FX Limit Amount
     C                     MOVEL#DFFLA    ZA0057           FX Forward limt
      * Send message 'Either Spot/Frwd amt req'
     C                     MOVEL'USR2202' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993347*
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DFLAS    ZA0058           FX Limit Amount
      * Send message 'FX Limit Amount is req'
     C                     MOVEL'USR2203' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * End of 077893
      * Start of S01433
      * CASE: WRK.SAR S01433 is Present
     C           WUSARF    IFEQ 'Y'                        *IF
      * Validate MM Fields
     C                     EXSR UPSUBR                     Validate MM Fie
     C                     END                             *FI
      * End of S01433
      * Convert FRA Limit Amount
     C                     EXSR USSUBR                     Convert FRA Lim
      * Validate FRA Fields
     C                     EXSR UTSUBR                     Validate FRA Fi
      * Convert IRS Limit Amount
     C                     EXSR UWSUBR                     Convert IRS Lim
      * Validate IRS Fields
     C                     EXSR UXSUBR                     Validate IRS Fi
     C/COPY WNCPYSRC,SD0451RC01
      * Display second screen ?
      * CASE: WRK.Display second screen is YES
     C           WUDSCR    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    WUDRTC           Duplicate Retur
      * Check for Error - Client Limits  *
     C*
     C* IF INDICATOR 99 IS ON, THERE HAS BEEN AN ERROR, IN THAT CASE
     C* SET 'ERROR FOUND' FIELD TO 'Y'.
     C* CALL THE SECOND SCREEN ONLY IF 'ERROR FOUND' IS 'N'.
     C*
     C                     MOVE 'N'       WUERFD
     C*
     C           *IN99     IFEQ '1'
     C                     MOVE 'Y'       WUERFD
     C                     END
      * CASE: PGM.*Defer confirm is Proceed to confirm
     C           W0DCF     IFEQ 'N'                        *IF
      * CASE: WRK.Error found is Error not found
     C           WUERFD    IFEQ 'N'                        *IF
      * Client Limits Edt 2nd scr - Client Limits  *
     C                     CLEARPARC
     C                     MOVEL#1CUST    PACUST           Customer Number
     C                     MOVEL#1LEVL    PALEVL           Level
     C                     MOVEL#1BCCD    PABCCD           Branch/Company
     C                     Z-ADD#1LCD     PALCD            Last Change Dat
     C                     MOVEL#1TYLC    PATYLC           Type of Last Ch
     C                     MOVEL#1FXLT    PAFXLT           FX Limit Type
     C                     Z-ADD#1FLAM    PAFLAM           FX Limit Amount
     C                     Z-ADD#1FLED    PAFLED           FX Limit Expiry
     C                     Z-ADD#1FLRD    PAFLRD           FX Limit Review
     C                     MOVEL#1FLFQ    PAFLFQ           FX Limit Freque
     C                     Z-ADD#1FFDN    PAFFDN           FX Frequency Da
     C                     Z-ADD#1MDDR    PAMDDR           MDDR Amount
     C                     MOVEL#1LLTY    PALLTY           Lending Limit T
     C                     Z-ADD#1LLAM    PALLAM           Lending Limit A
     C                     Z-ADD#1LLED    PALLED           Lending Limit E
     C                     Z-ADD#1LLRD    PALLRD           Lending Limit R
     C                     MOVEL#1LLFR    PALLFR           Lending Limit F
     C                     Z-ADD#1LFDN    PALFDN           Lending Frequen
     C                     MOVEL#1SECD    PASECD           Secured
     C                     Z-ADD#1FRLA    PAFRLA           FRA Limit Amoun
     C                     Z-ADD#1FRED    PAFRED           FRA Expiry Date
     C                     Z-ADD#1FRRD    PAFRRD           FRA Review Date
     C                     MOVEL#1FRFQ    PAFRFQ           FRA Review Freq
     C                     Z-ADD#1FRAD    PAFRAD           FRA Frequency D
     C                     Z-ADD#1IRLM    PAIRLM           IRS Limit Amoun
     C                     Z-ADD#1IRED    PAIRED           IRS Expiry Date
     C                     Z-ADD#1IRDT    PAIRDT           IRS Review Date
     C                     MOVEL#1IRFQ    PAIRFQ           IRS Review Freq
     C                     Z-ADD#1IFDN    PAIFDN           IRS Frequency D
     C                     MOVEL#1MMTY    PAMMTY           Money market li
     C                     Z-ADD#1MMAM    PAMMAM           Money market li
     C                     Z-ADD#1MMED    PAMMED           Money market ex
     C                     Z-ADD#1MMRD    PAMMRD           Money market re
     C                     MOVEL#1MMFR    PAMMFR           Money market li
     C                     Z-ADD#1MFDN    PAMFDN           Money market Fr
     C                     MOVEL#1MSEC    PAMSEC           Money market se
     C                     Z-ADD#1MLAM    PAMLAM           Money market Li
     C                     Z-ADD#1FXLA    PAFXLA           FX line amount
     C                     Z-ADD#1FXFA    PAFXFA           FX Forward limi
     C                     MOVEL#1PLTY    PAPLTY           Prec metals lim
     C                     Z-ADD#1PFAM    PAPFAM           Prec metals frw
     C                     Z-ADD#1PSAM    PAPSAM           Prec metal Spot
     C                     Z-ADD#1PLED    PAPLED           Prec metals exp
     C                     Z-ADD#1PLVD    PAPLVD           Prec metals rev
     C                     MOVEL#1PLRF    PAPLRF           Prec metals rev
     C                     Z-ADD#1PLAM    PAPLAM           Prec metals lin
      *                                                                   CGL011
      ** FX Limit Secured field                                           CGL011
      *                                                                   CGL011
     C           CGL011    IFEQ 'Y'                                       CGL011
     C                     MOVEL#1FLSC    PAFLSC                          CGL011
     C                     ENDIF                                          CGL011
      *
     C                     CALL 'SD0452R'              90  Client Limits E
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Client Lim
     C                     PARM #PANCD    WQ0294  1        Action Code
     C           WUDRTC    PARM *BLANK    WQ0295  7        Duplicate Retur
     C                     PARM WUINPT    WQ0296  1        Input field
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0452R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993139*
     C                     SETON                     545532*
     C                     SETON                     4044  *
     C                     END
      * Check the return code.
      * CASE: WRK.Duplicate Return Code is *User QUIT requested
     C           WUDRTC    IFEQ 'Y2U9999'                  *IF
     C                     MOVELWUDRTC    P5DRTC           Duplicate Retur
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: WRK.Duplicate Return Code is *Previous Screen
     C           WUDRTC    IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Start of S01433
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy Member SD0451RVSF - Client Limits  *
     C/COPY WNCPYSRC,SD0451RVSF
     C                     END                             *FI
      * Check relations
      **Check*reference to Limit types                                                        192740
     C**********           EXSR VCCKRL                                                        192740
     C********** W0RTN     IFNE *BLANK                                                        192740
     C**********           SETON                     9931  *                                  192740
     C**********           END                                                                192740
      * Check reference to Limit types
     C                     EXSR VDCKRL
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CALC: Detail screen function fields
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy Member SD0451RSFF - Client Limits  *
     C/COPY WNCPYSRC,SD0451RSFF
     C                     END                             *FI
      * USER: Validate detail screen relations
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy Member SD0451RVSR - Client Limits  *
     C/COPY WNCPYSRC,SD0451RVSR
     C                     END                             *FI
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         EBPR##    BEGSR
      *================================================================
      * Process record:
      *================================================================
      * Process delete request
     C   10                CAS            EDDLRQ
      * Process add request
     C           W0PMD     CASEQ'ADD'     ECADRQ
      * Process update request
     C           W0PMD     CASNE'ADD'     EECHRQ
     C                     END
     C           W0RTN     IFNE *BLANK
      * Error: ROLLBACK any DBF changes
     C                     ROLBK
     C                     GOTO EBEXIT
     C                     ELSE
      * Otherwise COMMIT any DBF changes
     C                     COMIT
     C/COPY WNCPYSRC,SD0451RC30
     C                     END
     C           W0RTN     IFEQ *BLANK
      * USER: Process command keys
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy Member SD0451RPCK - Client Limits  *
     C/COPY WNCPYSRC,SD0451RPCK
     C                     END                             *FI
     C           W0PMD     IFEQ 'ADD'
      * Exit after successful add
     C                     MOVEL'N'       W0RPT
     C                     END
      * Restart program for next record
     C                     MOVEL'N'       W0TRN
     C                     END
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         ECADRQ    BEGSR
      *================================================================
      * Process add request
      *================================================================
      * USER: Create DBF record
      * Create Client Limits - Client Limits  *
     C                     EXSR SDCRRC
     C           W0RTN     IFEQ *BLANK
      * Send message '*Record added'
     C                     MOVEL'Y2U0011' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
      *================================================================
     CSR         ECEXIT    ENDSR
      /EJECT
     CSR         EDDLRQ    BEGSR
      *================================================================
      * Process delete request
      *================================================================
      * USER: Delete DBF record
      * Delete Client Limits - Client Limits  *
     C                     EXSR SFDLRC
     C           W0RTN     IFEQ *BLANK
      * Send message '*Record deleted'
     C                     MOVEL'Y2U0013' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
      *================================================================
     CSR         EDEXIT    ENDSR
      /EJECT
     CSR         EECHRQ    BEGSR
      *================================================================
      * Process update request
      *================================================================
      * USER: Change DBF record
      * Change Client Limits - Client Limits  *
     C                     EXSR SHCHRC
     C           W0RTN     IFNE *BLANK
      * Data update error
      * Reset screen fields if changed record
     C           W0RTN     CASEQ'Y2U0007' MBFL#1
     C                     END
     C                     ELSE
      * Send message '*Record changed'
     C                     MOVEL'Y2U0012' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
      *================================================================
     CSR         EEEXIT    ENDSR
      /EJECT
     CSR         FACKPM    BEGSR
      *================================================================
      * Check passed parameters
      *================================================================
      * Is full key present?
     C           P1CUST    IFEQ *BLANK                     Customer Number
     C           P2LEVL    OREQ *BLANK                     Level
     C           P3BCCD    OREQ *BLANK                     Branch/Company
      * Not every key field passed - loop program
     C                     MOVEL'Y'       W0RPT   1
     C                     ELSE
      * Full key passed, so single shot program
     C                     MOVEL'N'       W0RPT
     C                     END
      *================================================================
     CSR         FAEXIT    ENDSR
      /EJECT
     CSR         GADSAK    BEGSR
      *================================================================
      * Set key screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
     C                     MOVEL'0'       *IN79
     C           WUMBIN    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSAD    BEGSR
      *================================================================
      * Set detail screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      * Protect key fields on detail screen
     C                     SETON                     88    *
     C                     MOVEL'0'       *IN79
     C           WUDLBC    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C                     MOVEL'0'       *IN78
     C           WUDSAR    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN77
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
      * Enable key screen
     C                     SETON                     87    *
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise record - except for key fields and "neither" paramete
      *================================================================
     C                     MOVEL*BLANK    #PDRTC           Duplicate Retur
     C                     MOVELP4ANCD    #PANCD           Action Code
     C                     Z-ADD*ZERO     #1LCD            Last Change Dat
     C                     MOVEL*BLANK    #1TYLC           Type of Last Ch
     C                     MOVEL*BLANK    #1LLTY           Lending Limit T
     C                     Z-ADD*ZERO     #1FLAM           FX Limit Amount
     C                     MOVEL*BLANK    #DLLAS           LN Limit Amount
     C                     Z-ADD*ZERO     #1LLAM           Lending Limit A
     C                     MOVEL*BLANK    #DSLED           LN Expiry Date
     C                     MOVEL*BLANK    #DSLRD           LN Review Date
     C                     Z-ADD*ZERO     #1FLED           FX Limit Expiry
     C                     Z-ADD*ZERO     #1FLRD           FX Limit Review
     C                     MOVEL*BLANK    #1LLFR           Lending Limit F
     C                     Z-ADD*ZERO     #1FFDN           FX Frequency Da
     C                     MOVEL*BLANK    #DLFDS           LN Freq Day No
     C                     Z-ADD*ZERO     #1LFDN           Lending Frequen
     C                     Z-ADD*ZERO     #1MDDR           MDDR Amount
     C                     MOVEL*BLANK    #1SECD           Secured
     C                     Z-ADD*ZERO     #1LLED           Lending Limit E
     C                     Z-ADD*ZERO     #1LLRD           Lending Limit R
     C                     Z-ADD*ZERO     #1FRLA           FRA Limit Amoun
     C                     Z-ADD*ZERO     #1IRLM           IRS Limit Amoun
     C                     Z-ADD*ZERO     #1FRED           FRA Expiry Date
     C                     Z-ADD*ZERO     #1FRRD           FRA Review Date
     C                     Z-ADD*ZERO     #1FRAD           FRA Frequency D
     C                     Z-ADD*ZERO     #1IRED           IRS Expiry Date
     C                     Z-ADD*ZERO     #1IRDT           IRS Review Date
     C                     Z-ADD*ZERO     #1IFDN           IRS Frequency D
     C                     Z-ADD*ZERO     #1MMAM           Money market li
     C                     Z-ADD*ZERO     #1MMED           Money market ex
     C                     Z-ADD*ZERO     #1MMRD           Money market re
     C                     Z-ADD*ZERO     #1MFDN           Money market Fr
     C                     Z-ADD*ZERO     #1MLAM           Money market Li
     C                     Z-ADD*ZERO     #1FXLA           FX line amount
     C                     Z-ADD*ZERO     #1FXFA           FX Forward limi
     C                     MOVEL*BLANK    #1PLTY           Prec metals lim
     C                     Z-ADD*ZERO     #1PFAM           Prec metals frw
     C                     Z-ADD*ZERO     #1PSAM           Prec metal Spot
     C                     Z-ADD*ZERO     #1PLED           Prec metals exp
     C                     Z-ADD*ZERO     #1PLVD           Prec metals rev
     C                     MOVEL*BLANK    #1PLRF           Prec metals rev
     C                     Z-ADD*ZERO     #1PLAM           Prec metals lin
     C                     MOVEL*BLANK    #DCUSN           Customer  Scree
     C                     MOVEL*BLANK    #DSRNM           Screen Report N
     C                     MOVEL*BLANK    #DSRTN           Screen Report T
     C                     MOVEL*BLANK    #1FXLT           FX Limit Type
     C                     MOVEL*BLANK    #1MMTY           Money market li
     C                     MOVEL*BLANK    #DLMAS           Limit amount :
     C                     MOVEL*BLANK    #DFLAS           Fx Limit Amount
     C                     MOVEL*BLANK    #DMLAS           MM Limit Amount
     C                     MOVEL*BLANK    #DSFED           FX Expiry Date
     C                     MOVEL*BLANK    #DMEDS           MM expiry date
     C                     MOVEL*BLANK    #DSFRD           FX Review Date
     C                     MOVEL*BLANK    #DMRDS           MM review date
     C                     MOVEL*BLANK    #1FLFQ           FX Limit Freque
     C                     MOVEL*BLANK    #1MMFR           Money market li
     C                     MOVEL*BLANK    #DFFDS           FX Freq Day No
     C                     MOVEL*BLANK    #DMFDS           MM Freq day No
     C                     MOVEL*BLANK    #DMDAS           MDDR Amount Scr
     C                     MOVEL*BLANK    #1MSEC           Money market se
     C                     MOVEL*BLANK    #DFXLS           FX Line Amount
     C                     MOVEL*BLANK    #DMLSC           MM Line Amount
     C                     MOVEL*BLANK    #DFFLA           FX forward lmt
     C                     MOVEL*BLANK    #DRLAS           FRA Limit Amoun
     C                     MOVEL*BLANK    #DILAS           IRS Limit Amoun
     C                     MOVEL*BLANK    #DSRED           FRA Expiry Date
     C                     MOVEL*BLANK    #DSIED           IRS Expiry Date
     C                     MOVEL*BLANK    #DSRRD           FRA Review Date
     C                     MOVEL*BLANK    #DSIRD           IRS Review Date
     C                     MOVEL*BLANK    #1FRFQ           FRA Review Freq
     C                     MOVEL*BLANK    #1IRFQ           IRS Review Freq
     C                     MOVEL*BLANK    #DRFDS           FRA Freq Day no
     C                     MOVEL*BLANK    #DIFDS           IRS Freq Day no
      *                                                                   CGL011
      ** If CGL011 is installed, initialize FX Limit Secured              CGL011
      ** screen field using data from PARC data structure.                CGL011
      *                                                                   CGL011
     C           CGL011    IFEQ 'Y'                                       CGL011
     C                     MOVE PAFLSC    #1FLSC                          CGL011
     C                     ENDIF                                          CGL011
      *                                                                   CGL011
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @DZREHT fields to screen
      *================================================================
     C                     Z-ADDDZLCD     #1LCD            Last Change Dat
     C                     MOVELDZTYLC    #1TYLC           Type of Last Ch
     C                     MOVELDZLLTY    #1LLTY           Lending Limit T
     C                     Z-ADDDZFLAM    #1FLAM           FX Limit Amount
     C                     Z-ADDDZLLAM    #1LLAM           Lending Limit A
     C                     Z-ADDDZFLED    #1FLED           FX Limit Expiry
     C                     Z-ADDDZFLRD    #1FLRD           FX Limit Review
     C                     MOVELDZLLFR    #1LLFR           Lending Limit F
     C                     Z-ADDDZFFDN    #1FFDN           FX Frequency Da
     C                     Z-ADDDZLFDN    #1LFDN           Lending Frequen
     C                     Z-ADDDZMDDR    #1MDDR           MDDR Amount
     C                     MOVELDZSECD    #1SECD           Secured
     C                     Z-ADDDZLLED    #1LLED           Lending Limit E
     C                     Z-ADDDZLLRD    #1LLRD           Lending Limit R
     C                     Z-ADDDZFRLA    #1FRLA           FRA Limit Amoun
     C                     Z-ADDDZIRLM    #1IRLM           IRS Limit Amoun
     C                     Z-ADDDZFRED    #1FRED           FRA Expiry Date
     C                     Z-ADDDZFRRD    #1FRRD           FRA Review Date
     C                     Z-ADDDZFRAD    #1FRAD           FRA Frequency D
     C                     Z-ADDDZIRED    #1IRED           IRS Expiry Date
     C                     Z-ADDDZIRDT    #1IRDT           IRS Review Date
     C                     Z-ADDDZIFDN    #1IFDN           IRS Frequency D
     C                     Z-ADDDZMMAM    #1MMAM           Money market li
     C                     Z-ADDDZMMED    #1MMED           Money market ex
     C                     Z-ADDDZMMRD    #1MMRD           Money market re
     C                     Z-ADDDZMFDN    #1MFDN           Money market Fr
     C                     Z-ADDDZMLAM    #1MLAM           Money market Li
     C                     Z-ADDDZFXLA    #1FXLA           FX line amount
     C                     Z-ADDDZFXFA    #1FXFA           FX Forward limi
     C                     MOVELDZPLTY    #1PLTY           Prec metals lim
     C                     Z-ADDDZPFAM    #1PFAM           Prec metals frw
     C                     Z-ADDDZPSAM    #1PSAM           Prec metal Spot
     C                     Z-ADDDZPLED    #1PLED           Prec metals exp
     C                     Z-ADDDZPLVD    #1PLVD           Prec metals rev
     C                     MOVELDZPLRF    #1PLRF           Prec metals rev
     C                     Z-ADDDZPLAM    #1PLAM           Prec metals lin
     C                     MOVELDZCUST    #1CUST           Customer Number
     C                     MOVELDZLEVL    #1LEVL           Level
     C                     MOVELDZBCCD    #1BCCD           Branch/Company
     C                     MOVELDZFXLT    #1FXLT           FX Limit Type
     C                     MOVELDZMMTY    #1MMTY           Money market li
     C                     MOVELDZFLFQ    #1FLFQ           FX Limit Freque
     C                     MOVELDZMMFR    #1MMFR           Money market li
     C                     MOVELDZMSEC    #1MSEC           Money market se
     C                     MOVELDZFRFQ    #1FRFQ           FRA Review Freq
     C                     MOVELDZIRFQ    #1IRFQ           IRS Review Freq
      *                                                                   CGL011
      ** If CGL011 is installed, move FX Limit Secured                    CGL011
      ** file field to its designated screen field.                       CGL011
      *                                                                   CGL011
     C           CGL011    IFEQ 'Y'                                       CGL011
     C                     MOVE DZFLSC    #1FLSC                          CGL011
     C                     ENDIF                                          CGL011
      *                                                                   CGL011
      * Hold existing record image
     C                     MOVEL@1DBRC    #1DBRC
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MDIZ#K    BEGSR
      *================================================================
      * Initialize key screen
      *================================================================
     C                     MOVEL*BLANK    #PDRTC           Duplicate Retur
     C                     MOVELP4ANCD    #PANCD           Action Code
     C                     MOVELP1CUST    #1CUST           Customer Number
     C                     MOVELP2LEVL    #1LEVL           Level
     C                     MOVELP3BCCD    #1BCCD           Branch/Company
      * USER: Initialize key screen
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy Member SD0451RIKS - Client Limits  *
     C/COPY WNCPYSRC,SD0451RIKS
     C                     END                             *FI
      *================================================================
     CSR         MDEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Shortname,name + town - Client Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           BBCUST           Customer Number
      * Move fields to key list
     C                     MOVELP1CUST    BBCUST           Customer Number
     C           KRSSA     CHAIN@BBREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0081' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SAEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBBCSSN    WUCSSN           Customer Shortn
     C                     MOVELBBCRTN    WUCRTN           Customer Report
     C                     MOVELBBCRNM    WUCRNM           Customer Report
     C                     END
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Shortname,name + town - Client Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           BBCUST           Customer Number
      * Move fields to key list
     C                     MOVELP1CUST    BBCUST           Customer Number
     C           KRSSB     CHAIN@BBREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0081' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBBCSSN    WUCSSN           Customer Shortn
     C                     MOVELBBCRTN    WUCRTN           Customer Report
     C                     MOVELBBCRNM    WUCRNM           Customer Report
     C                     END
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Does Limit Type exist? - Limit types  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           A2LMTY           Limit Type
      * Move fields to key list
     C                     MOVELWULMTY    A2LMTY           Limit Type
     C           KRSSC     CHAIN@A2REBU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0063' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     END
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCRRC    BEGSR
      *================================================================
      * Create Client Limits - Client Limits  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DZREHS
     C                     MOVEL#1CUST    DZCUST           Customer Number
     C                     MOVEL#1LEVL    DZLEVL           Level
     C                     MOVEL#1BCCD    DZBCCD           Branch/Company
     C                     Z-ADDWURDNB    DZLCD            Last Change Dat
     C                     MOVEL'I'       DZTYLC           Type of Last Ch
     C                     MOVEL#1FXLT    DZFXLT           FX Limit Type
     C                     Z-ADD#1FLAM    DZFLAM           FX Limit Amount
     C                     Z-ADD#1FLED    DZFLED           FX Limit Expiry
     C                     Z-ADD#1FLRD    DZFLRD           FX Limit Review
     C                     MOVEL#1FLFQ    DZFLFQ           FX Limit Freque
     C                     Z-ADD#1FFDN    DZFFDN           FX Frequency Da
     C                     Z-ADD#1MDDR    DZMDDR           MDDR Amount
     C                     MOVEL#1LLTY    DZLLTY           Lending Limit T
     C                     Z-ADD#1LLAM    DZLLAM           Lending Limit A
     C                     Z-ADD#1LLED    DZLLED           Lending Limit E
     C                     Z-ADD#1LLRD    DZLLRD           Lending Limit R
     C                     MOVEL#1LLFR    DZLLFR           Lending Limit F
     C                     Z-ADD#1LFDN    DZLFDN           Lending Frequen
     C                     MOVEL#1SECD    DZSECD           Secured
     C                     Z-ADD#1FRLA    DZFRLA           FRA Limit Amoun
     C                     Z-ADD#1FRED    DZFRED           FRA Expiry Date
     C                     Z-ADD#1FRRD    DZFRRD           FRA Review Date
     C                     MOVEL#1FRFQ    DZFRFQ           FRA Review Freq
     C                     Z-ADD#1FRAD    DZFRAD           FRA Frequency D
     C                     Z-ADD#1IRLM    DZIRLM           IRS Limit Amoun
     C                     Z-ADD#1IRED    DZIRED           IRS Expiry Date
     C                     Z-ADD#1IRDT    DZIRDT           IRS Review Date
     C                     MOVEL#1IRFQ    DZIRFQ           IRS Review Freq
     C                     Z-ADD#1IFDN    DZIFDN           IRS Frequency D
     C                     MOVEL#1MMTY    DZMMTY           Money market li
     C                     Z-ADD#1MMAM    DZMMAM           Money market li
     C                     Z-ADD#1MMED    DZMMED           Money market ex
     C                     Z-ADD#1MMRD    DZMMRD           Money market re
     C                     MOVEL#1MMFR    DZMMFR           Money market li
     C                     Z-ADD#1MFDN    DZMFDN           Money market Fr
     C                     MOVEL#1MSEC    DZMSEC           Money market se
     C                     Z-ADD#1MLAM    DZMLAM           Money market Li
     C                     Z-ADD#1FXLA    DZFXLA           FX line amount
     C                     Z-ADD#1FXFA    DZFXFA           FX Forward limi
     C                     MOVEL#1PLTY    DZPLTY           Prec metals lim
     C                     Z-ADD#1PFAM    DZPFAM           Prec metals frw
     C                     Z-ADD#1PSAM    DZPSAM           Prec metal Spot
     C                     Z-ADD#1PLED    DZPLED           Prec metals exp
     C                     Z-ADD#1PLVD    DZPLVD           Prec metals rev
     C                     MOVEL#1PLRF    DZPLRF           Prec metals rev
     C                     Z-ADD#1PLAM    DZPLAM           Prec metals lin
      *                                                                   CGL011
      ** If CGL011 is installed, move FX Limit Secured screen field       CGL011
      ** to the file field.                                               CGL011
      *                                                                   CGL011
     C           CGL011    IFEQ 'Y'                                       CGL011
     C                     MOVEL#1FLSC    DZFLSC                          CGL011
     C                     ENDIF                                          CGL011
      *
      * USER: Processing before Data update
      * Start of S01433
      * If the second screen is to be displayed, do NOT update the file
      * at this stage.
      * CASE: PAR.Display second screen is YES
     C           WUDSCR    IFEQ 'Y'                        *IF
     C                     GOTO SDEXIT                     *QUIT
     C                     END                             *FI
      * End of S01433
      * CASE: WRK.Window processing requir. is Yes
     C           WUWDPR    IFEQ 'Y'                        *IF
      * WM call Window Manager - Window manager  *
     C/COPY WNCPYSRC,WN0481CCP1                                           S01408
     C***********          CALL 'WIND01'                                  S01212
     C                     CALL 'WN0010'                                  S01212
     C*********************PARM           ##PGM            Program        S01212
     C                     PARM ##PGM     UPGM   10        Program        S01212
     C*********************PARM *BLANK    FKEY    2        Function Key   S01212
     C                     PARM *BLANK    UFKEY   2        Function Key   S01212
     C*********************PARM           WUMEST           Action  S01212 S01229
     C*********************PARM           WUWMAC           Action  S01212 S01229
     C                     PARM 'I'       UACTCD  1        Action  S01212 S01229
     C                     PARM           DATA             Trans Data     S01212
     C                     PARM *BLANK    W0RTN            Return Code    S01212
     C                     PARM           SPARE 256        Spare Field    LN0355
      * WM Check Return
      * CASE: PAR.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: PAR.*Return code is WN Window Error
     C           W0RTN     IFEQ 'USR0563'                  *IF
      * Send message 'WN Window Error'
     C                     MOVEL'USR0563' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO SDEXIT                     *QUIT
     C                     ELSE
      * CASE: PAR.*Return code is *DBF update error
     C           W0RTN     IFEQ 'Y2U0004'                  *IF
      * Send message 'WN Database Error'
     C                     MOVEL'USR0567' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO SDEXIT                     *QUIT
     C                     ELSE
      * CASE: PAR.*Return code is *Previous Screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO SDEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 00/Copy Member SD0451RCBW - Client Limits  *
     C/COPY WNCPYSRC,SD0451RCBW
     C                     END                             *FI
      * 00/Copy Member SD0451RCBU - Client Limits  *
     C/COPY WNCPYSRC,SD0451RCBU
     C           KLCRSD    KLIST
     C                     KFLD           DZCUST           Customer Number
     C                     KFLD           DZLEVL           Level
     C                     KFLD           DZBCCD           Branch/Company
      * Check for duplicate primary key
     C           KLCRSD    SETLL@DZREHS                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0666' W0RTN   7
      * Send message 'Client Limits          EX'
     C                     MOVEL'USR0666' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     END
      *
     C                     WRITE@DZREHS                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
     C                     Z-ADD1         WUNORC           No. of Records
     C                     Z-ADD1         WUNOIN           No. of Inserts
     C                     Z-ADD*ZERO     WUNOAM           No. of Amends
     C                     Z-ADD*ZERO     WUNODL           No. of Deletes
      * Change Standing Data Cont - Standing Data Controls  *
     C                     EXSR SECHRC
      * 00/Copy Member SD0451RCAU - Client Limits  *
     C/COPY WNCPYSRC,SD0451RCAU
     C                     END
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECHRC    BEGSR
      *================================================================
      * Change Standing Data Cont - Standing Data Controls  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE 'N'       YARDC   1
      *
      * Move key fields to @AHREAU
     C                     MOVE *BLANK    AHFLNM           Filename
     C                     MOVEL'SDCLLMPD'AHFLNM           Filename
      *
     C           KLCHSE    KLIST
     C                     KFLD           AHFLNM           Filename
     C           KLCHSE    CHAIN@AHREAU              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     END
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     GOTO SEEXIT
     C                     END
      *
      * Store record data for null update check
     C                     MOVE QSDFC1    YARDCS
      * USER: Processing after Data read
     C                     ADD  AHNORC    WUNORC           No. of Records
     C                     ADD  AHNOIN    WUNOIN           No. of Inserts
     C                     ADD  AHNOAM    WUNOAM           No. of Amends
     C                     ADD  AHNODL    WUNODL           No. of Deletes
      * Move non-key fields to @AHREAU
     C                     Z-ADDWUNORC    AHNORC           No. of Records
     C                     Z-ADDWUNOIN    AHNOIN           No. of Inserts
     C                     Z-ADDWUNOAM    AHNOAM           No. of Amends
     C                     Z-ADDWUNODL    AHNODL           No. of Deletes
      *
      * Set PGM.*Record Data Changed flag
     C           QSDFC1    IFNE YARDCS
     C                     MOVE 'Y'       YARDC
     C                     END
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@AHREAU                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKSDFCTLL0               91  *
     C                     END
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     END
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFDLRC    BEGSR
      *================================================================
      * Delete Client Limits - Client Limits  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data update
      * CASE: PAR.Action Code is Delete
     C           P4ANCD    IFEQ 'D'                        *IF
      * CASE: WRK.Window processing requir. is Yes
     C           WUWDPR    IFEQ 'Y'                        *IF
      * WM call Window Manager - Window manager  *
     C/COPY WNCPYSRC,WN0481CCP1                                           S01408
     C***********          CALL 'WIND01'                                  S01212
     C                     CALL 'WN0010'                                  S01212
     C*********************PARM           ##PGM            Program        S01212
     C                     PARM ##PGM     UPGM   10        Program        S01212
     C*********************PARM *BLANK    FKEY    2        Function Key   S01212
     C                     PARM *BLANK    UFKEY   2        Function Key   S01212
     C*********************PARM           WUMEST           Action  S01212 S01229
     C*********************PARM           WUWMAC           Action  S01212 S01229
     C                     PARM 'D'       UACTCD  1        Action  S01212 S01229
     C                     PARM           DATA             Trans Data     S01212
     C                     PARM *BLANK    W0RTN            Return Code    S01212
     C                     PARM           SPARE 256        Spare Field    LN0355
      * 00/Copy Member SD0451RDBW - Client Limits  *
     C/COPY WNCPYSRC,SD0451RDBW
     C                     END                             *FI
      * 00/Copy Member SD0451RDBU - Client Limits  *
     C/COPY WNCPYSRC,SD0451RDBU
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Function key not allowed'
     C                     MOVEL'USR0533' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'Y2U0004' W0RTN            *Return code
     C                     GOTO SFEXIT                     *QUIT
     C                     END                             *FI
      * Move key fields to @DZREHS
     C                     MOVEL#1CUST    DZCUST           Customer Number
     C                     MOVEL#1LEVL    DZLEVL           Level
     C                     MOVEL#1BCCD    DZBCCD           Branch/Company
      *
     C           KLDLSF    KLIST
     C                     KFLD           DZCUST           Customer Number
     C                     KFLD           DZLEVL           Level
     C                     KFLD           DZBCCD           Branch/Company
     C           KLDLSF    CHAIN@DZREHS              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     END
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     END
      *
      * Check for changed record
     C           #1DBRC    IFNE @1DBRC                     IF
     C                     MOVEL'Y2U0007' W0RTN   7
      * Send message '*Update not accepted'
     C                     MOVEL'Y2U0007' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
      * Release record lock
     C           KLDLSF    SETLL@DZREHS              9091  *
     C                     GOTO SFEXIT
     C                     END                             FI #1DBRC
      *................................................................
     C/COPY WNCPYSRC,SD0451RC31
     C                     DELET@DZREHS                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * DBF delete successful
      * USER: Processing after Data update
      * Start of change 122096
      * WUDELR Data Structure - SD Deleted Records File  *
     C                     MOVEL@1DBRC    WUDELR
      * Concat the three part key into one field
     C           #1CUST    CAT  #1LEVL    WULKEY    P      Long Key
     C           WULKEY    CAT  #1BCCD    WULKEY    P      Long Key
      * Write Deleted Record - SD Deleted Records File  *
     C                     CLEARPBRC
     C                     MOVEL'SDCLLMPD'PBFNME           File name
     C                     MOVELWULKEY    PBLKEY           Long Key
     C                     MOVELWUDR01    PBDR01           Deleted Data Re
     C                     MOVELWUDR02    PBDR02           Deleted Data Re
     C                     MOVELWUDR03    PBDR03           Deleted Data Re
     C                     MOVELWUDR04    PBDR04           Deleted Data Re
     C                     MOVELWUDR05    PBDR05           Deleted Data Re
     C                     MOVELWUDR06    PBDR06           Deleted Data Re
     C                     MOVELWUDR07    PBDR07           Deleted Data Re
     C                     MOVELWUDR08    PBDR08           Deleted Data Re
     C                     MOVELWUDR09    PBDR09           Deleted Data Re
     C                     MOVELWUDR00    PBDR00           Deleted Data Re
     C                     MOVELWUDR11    PBDR11           Deleted Data Re
     C                     MOVELWUDR12    PBDR12           Deleted Data Re
     C                     Z-ADDWURDNB    PBLCD            Last Change Dat
     C                     MOVEL'D'       PBTYLC           Type of Last Ch
      *
     C                     CALL 'SD0520X'              90  Write Deleted R
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: SD Deleted
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0520X' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * End of change 122096
     C                     Z-ADD-1        WUNORC           No. of Records
     C                     Z-ADD*ZERO     WUNOIN           No. of Inserts
     C                     Z-ADD*ZERO     WUNOAM           No. of Amends
     C                     Z-ADD1         WUNODL           No. of Deletes
      * Change Standing Data Cont - Standing Data Controls  *
     C                     EXSR SGCHRC
      * 00/Copy Member SD0451RDAU - Client Limits  *
     C/COPY WNCPYSRC,SD0451RDAU
     C                     END
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCHRC    BEGSR
      *================================================================
      * Change Standing Data Cont - Standing Data Controls  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE 'N'       YBRDC   1
      *
      * Move key fields to @AHREAU
     C                     MOVE *BLANK    AHFLNM           Filename
     C                     MOVEL'SDCLLMPD'AHFLNM           Filename
      *
     C           KLCHSG    KLIST
     C                     KFLD           AHFLNM           Filename
     C           KLCHSG    CHAIN@AHREAU              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     END
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     GOTO SGEXIT
     C                     END
      *
      * Store record data for null update check
     C                     MOVE QSDFC1    YBRDCS
      * USER: Processing after Data read
     C                     ADD  AHNORC    WUNORC           No. of Records
     C                     ADD  AHNOIN    WUNOIN           No. of Inserts
     C                     ADD  AHNOAM    WUNOAM           No. of Amends
     C                     ADD  AHNODL    WUNODL           No. of Deletes
      * Move non-key fields to @AHREAU
     C                     Z-ADDWUNORC    AHNORC           No. of Records
     C                     Z-ADDWUNOIN    AHNOIN           No. of Inserts
     C                     Z-ADDWUNOAM    AHNOAM           No. of Amends
     C                     Z-ADDWUNODL    AHNODL           No. of Deletes
      *
      * Set PGM.*Record Data Changed flag
     C           QSDFC1    IFNE YBRDCS
     C                     MOVE 'Y'       YBRDC
     C                     END
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@AHREAU                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKSDFCTLL0               91  *
     C                     END
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     END
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCHRC    BEGSR
      *================================================================
      * Change Client Limits - Client Limits  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data read
      * Start of S01433
      * If the second screen is to be displayed, do NOT update the file
      * at this stage.
      * CASE: PAR.Display second screen is YES
     C           WUDSCR    IFEQ 'Y'                        *IF
     C                     GOTO SHEXIT                     *QUIT
     C                     END                             *FI
      * End of S01433
      * Set PGM.*Record Data Changed flag
     C                     MOVE 'N'       YCRDC   1
      *
      * Move key fields to @DZREHS
     C                     MOVEL#1CUST    DZCUST           Customer Number
     C                     MOVEL#1LEVL    DZLEVL           Level
     C                     MOVEL#1BCCD    DZBCCD           Branch/Company
      *
     C           KLCHSH    KLIST
     C                     KFLD           DZCUST           Customer Number
     C                     KFLD           DZLEVL           Level
     C                     KFLD           DZBCCD           Branch/Company
     C           KLCHSH    CHAIN@DZREHS              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     END
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     GOTO SHEXIT
     C                     END
      *
      * Check for changed record
     C           #1DBRC    IFNE @1DBRC                     IF
     C                     MOVEL'Y2U0007' W0RTN   7
      * Send message '*Update not accepted'
     C                     MOVEL'Y2U0007' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
      * Release record lock
     C                     UNLCKSDCLLML0               91  *
     C                     GOTO SHEXIT
     C                     END                             FI #1DBRC
      * Store record data for null update check
     C                     MOVE @1DBRC    YCRDCS
      * Move non-key fields to @DZREHS
     C                     Z-ADDWURDNB    DZLCD            Last Change Dat
     C                     MOVEL'A'       DZTYLC           Type of Last Ch
     C                     MOVEL#1FXLT    DZFXLT           FX Limit Type
     C                     Z-ADD#1FLAM    DZFLAM           FX Limit Amount
     C                     Z-ADD#1FLED    DZFLED           FX Limit Expiry
     C                     Z-ADD#1FLRD    DZFLRD           FX Limit Review
     C                     MOVEL#1FLFQ    DZFLFQ           FX Limit Freque
     C                     Z-ADD#1FFDN    DZFFDN           FX Frequency Da
     C                     Z-ADD#1MDDR    DZMDDR           MDDR Amount
     C                     MOVEL#1LLTY    DZLLTY           Lending Limit T
     C                     Z-ADD#1LLAM    DZLLAM           Lending Limit A
     C                     Z-ADD#1LLED    DZLLED           Lending Limit E
     C                     Z-ADD#1LLRD    DZLLRD           Lending Limit R
     C                     MOVEL#1LLFR    DZLLFR           Lending Limit F
     C                     Z-ADD#1LFDN    DZLFDN           Lending Frequen
     C                     MOVEL#1SECD    DZSECD           Secured
     C                     Z-ADD#1FRLA    DZFRLA           FRA Limit Amoun
     C                     Z-ADD#1FRED    DZFRED           FRA Expiry Date
     C                     Z-ADD#1FRRD    DZFRRD           FRA Review Date
     C                     MOVEL#1FRFQ    DZFRFQ           FRA Review Freq
     C                     Z-ADD#1FRAD    DZFRAD           FRA Frequency D
     C                     Z-ADD#1IRLM    DZIRLM           IRS Limit Amoun
     C                     Z-ADD#1IRED    DZIRED           IRS Expiry Date
     C                     Z-ADD#1IRDT    DZIRDT           IRS Review Date
     C                     MOVEL#1IRFQ    DZIRFQ           IRS Review Freq
     C                     Z-ADD#1IFDN    DZIFDN           IRS Frequency D
     C                     MOVEL#1MMTY    DZMMTY           Money market li
     C                     Z-ADD#1MMAM    DZMMAM           Money market li
     C                     Z-ADD#1MMED    DZMMED           Money market ex
     C                     Z-ADD#1MMRD    DZMMRD           Money market re
     C                     MOVEL#1MMFR    DZMMFR           Money market li
     C                     Z-ADD#1MFDN    DZMFDN           Money market Fr
     C                     MOVEL#1MSEC    DZMSEC           Money market se
     C                     Z-ADD#1MLAM    DZMLAM           Money market Li
     C                     Z-ADD#1FXLA    DZFXLA           FX line amount
     C                     Z-ADD#1FXFA    DZFXFA           FX Forward limi
     C                     MOVEL#1PLTY    DZPLTY           Prec metals lim
     C                     Z-ADD#1PFAM    DZPFAM           Prec metals frw
     C                     Z-ADD#1PSAM    DZPSAM           Prec metal Spot
     C                     Z-ADD#1PLED    DZPLED           Prec metals exp
     C                     Z-ADD#1PLVD    DZPLVD           Prec metals rev
     C                     MOVEL#1PLRF    DZPLRF           Prec metals rev
     C                     Z-ADD#1PLAM    DZPLAM           Prec metals lin
      *                                                                   CGL011
      ** IF CGL011 is installed, move FX Limit Secured screen field       CGL011
      ** to the file field.                                               CGL011
      *                                                                   CGL011
     C           CGL011    IFEQ 'Y'                                       CGL011
     C                     MOVEL#1FLSC    DZFLSC                          CGL011
     C                     ENDIF                                          CGL011
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YCRDCS
     C                     MOVE 'Y'       YCRDC
     C                     END
      * USER: Processing before Data update
      * CASE: WRK.Window processing requir. is Yes
     C           WUWDPR    IFEQ 'Y'                        *IF
      * WM call Window Manager - Window manager  *
     C/COPY WNCPYSRC,WN0481CCP1                                           S01408
     C***********          CALL 'WIND01'                                  S01212
     C                     CALL 'WN0010'                                  S01212
     C*********************PARM           ##PGM            Program        S01212
     C                     PARM ##PGM     UPGM   10        Program        S01212
     C*********************PARM *BLANK    FKEY    2        Function Key   S01212
     C                     PARM *BLANK    UFKEY   2        Function Key   S01212
     C*********************PARM           WUMEST           Action  S01212 S01229
     C*********************PARM           WUWMAC           Action  S01212 S01229
     C                     PARM 'A'       UACTCD  1        Action  S01212 S01229
     C                     PARM           DATA             Trans Data     S01212
     C                     PARM *BLANK    W0RTN            Return Code    S01212
     C                     PARM           SPARE 256        Spare Field    LN0355
      * WM Check Return
      * CASE: PAR.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: PAR.*Return code is WN Window Error
     C           W0RTN     IFEQ 'USR0563'                  *IF
      * Send message 'WN Window Error'
     C                     MOVEL'USR0563' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO SHEXIT                     *QUIT
     C                     ELSE
      * CASE: PAR.*Return code is *DBF update error
     C           W0RTN     IFEQ 'Y2U0004'                  *IF
      * Send message 'WN Database Error'
     C                     MOVEL'USR0567' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO SHEXIT                     *QUIT
     C                     ELSE
      * CASE: PAR.*Return code is *Previous Screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO SHEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 00/Copy Member SD0451RBUW - Client Limits  *
     C/COPY WNCPYSRC,SD0451RBUW
     C                     END                             *FI
      * 00/Copy Member SD0451RBDU - Client Limits  *
     C/COPY WNCPYSRC,SD0451RBDU
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YCRDCS
     C                     MOVE 'Y'       YCRDC
     C                     END
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@DZREHS                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKSDCLLML0               91  *
     C                     END
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * Update saved record image
     C                     MOVEL@1DBRC    #1DBRC
      * DBF change successful
      * USER: Processing after Data update
     C                     Z-ADD*ZERO     WUNORC           No. of Records
     C                     Z-ADD*ZERO     WUNOIN           No. of Inserts
     C                     Z-ADD1         WUNOAM           No. of Amends
     C                     Z-ADD*ZERO     WUNODL           No. of Deletes
      * Change Standing Data Cont - Standing Data Controls  *
     C                     EXSR SICHRC
      * 00/Copy Member SD0451RADU - Client Limits  *
     C/COPY WNCPYSRC,SD0451RADU
     C                     END
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICHRC    BEGSR
      *================================================================
      * Change Standing Data Cont - Standing Data Controls  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE 'N'       YDRDC   1
      *
      * Move key fields to @AHREAU
     C                     MOVE *BLANK    AHFLNM           Filename
     C                     MOVEL'SDCLLMPD'AHFLNM           Filename
      *
     C           KLCHSI    KLIST
     C                     KFLD           AHFLNM           Filename
     C           KLCHSI    CHAIN@AHREAU              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     END
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     GOTO SIEXIT
     C                     END
      *
      * Store record data for null update check
     C                     MOVE QSDFC1    YDRDCS
      * USER: Processing after Data read
     C                     ADD  AHNORC    WUNORC           No. of Records
     C                     ADD  AHNOIN    WUNOIN           No. of Inserts
     C                     ADD  AHNOAM    WUNOAM           No. of Amends
     C                     ADD  AHNODL    WUNODL           No. of Deletes
      * Move non-key fields to @AHREAU
     C                     Z-ADDWUNORC    AHNORC           No. of Records
     C                     Z-ADDWUNOIN    AHNOIN           No. of Inserts
     C                     Z-ADDWUNOAM    AHNOAM           No. of Amends
     C                     Z-ADDWUNODL    AHNODL           No. of Deletes
      *
      * Set PGM.*Record Data Changed flag
     C           QSDFC1    IFNE YDRDCS
     C                     MOVE 'Y'       YDRDC
     C                     END
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@AHREAU                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKSDFCTLL0               91  *
     C                     END
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     END
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * get practically everythin - MIDAS Modules  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           BGMODS           Modules
      * Move fields to key list
     C                     MOVE *BLANK    BGMODS           Modules
     C                     MOVEL'MMOD'    BGMODS           Modules
     C           KRSSJ     CHAIN@BGREC8              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0096' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * Setup message data for message
     C                     MOVEL'SDMMODPD'ZA0124           Filename
      * Send message 'Database Error (ICD)'
     C                     MOVEL'USR0377' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO SJEXIT                     *QUIT
     C                     GOTO SJEXIT
     C                     END
      *
      * USER: Exit processing
      * PAR = DB1 By name
     C                     MOVELBGSDGL    WUSDGL           Standing data/G
     C                     MOVELBGDLFX    WUDLFX           Dealing: FX
     C                     MOVELBGSYLN    WUSYLN           Syndicated Loan
     C                     MOVELBGEXMG    WUEXMG           Exposure Manage
     C                     MOVELBGCSLN    WUCSLN           Customer Lendin
     C                     MOVELBGRTBN    WURTBN           Retail Banking
     C                     MOVELBGMSDL    WUMSDL           Midas/Swift dir
     C                     MOVELBGSECS    WUSECS           Securities
     C                     MOVELBGAURC    WUAURC           Auto-reconcilia
     C                     MOVELBGFDTR    WUFDTR           Funds Transfer
     C                     MOVELBGFUOP    WUFUOP           Futures & Optio
     C                     MOVELBGNWMI    WUNWMI           Message Managem
     C                     MOVELBGFIIN    WUFIIN           FRA/IRS Indicat
     C                     MOVELBGDLMM    WUDLMM           Dealing: MM
     C                     MOVELBGTRMG    WUTRMG           Treasury Manage
     C                     MOVELBGRKMG    WURKMG           Interest Risk M
     C                     MOVELBGMFIC    WUMFIC           Microfiche
     C                     MOVELBGIOAC    WUIOAC           Interest on acc
     C                     MOVELBGCFMT    WUCFMT           Confirmation Ma
     C                     MOVELBGRCFI    WURCFI           Report Control
     C                     MOVELBGOPDK    WUOPDK           Optical Disk
     C                     MOVELBGNUST    WUNUST           History & Audit
     C                     MOVELBGNZST    WUNZST           Midas Export Da
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Get 'Window required' ind - MIDAS Modules  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           BGMODS           Modules
      * Move fields to key list
     C                     MOVE *BLANK    BGMODS           Modules
     C                     MOVEL'MMOD'    BGMODS           Modules
     C           KRSSK     CHAIN@BGREC8              90    *
      * Data record not found
     C   90                MOVEL'USR0096' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Window processing requir. is Yes
     C           BGWDPR    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUWDPR           Window processi
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Convert All File Dates To Screen Dates
      *================================================================
      * Check File Date - Rundate  *
     C                     CALL 'ZDATE2'               90  Check File Date
     C                     PARM DZFLED    WQ0001  50       Work Midas Date
     C                     PARM WUDFF     WQ0002  1        Date format fla
     C           WUWCDT    PARM *ZERO     WQ0003  60       Work Converted
     C           WUWADT    PARM *BLANK    WQ0004  7        Work Alpha Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZDATE2'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Set FX Expiry date
      * CASE: WRK.Work Converted Date is not equal zero
     C           WUWCDT    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    #DSFED           FX Expiry Date
     C                     MOVELWUWCDT    #DSFED           FX Expiry Date
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #DSFED           FX Expiry Date
     C                     END                             *FI
      * Check File Date - Rundate  *
     C                     CALL 'ZDATE2'               90  Check File Date
     C                     PARM DZFLRD    WQ0005  50       Work Midas Date
     C                     PARM WUDFF     WQ0006  1        Date format fla
     C           WUWCDT    PARM *ZERO     WQ0007  60       Work Converted
     C           WUWADT    PARM *BLANK    WQ0008  7        Work Alpha Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZDATE2'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Set FX Review Date
      * CASE: WRK.Work Converted Date is not equal zero
     C           WUWCDT    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    #DSFRD           FX Review Date
     C                     MOVELWUWCDT    #DSFRD           FX Review Date
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #DSFRD           FX Review Date
     C                     END                             *FI
      * Start of S01433
      * Money Market Expiry and review dates
      * CASE: WRK.SAR S01433 is Present
     C           WUSARF    IFEQ 'Y'                        *IF
      * MM Expiry date
     C                     Z-ADDDZMMED    WUWMDT           Work Midas Date
      * Check File Date - Rundate  *
     C                     CALL 'ZDATE2'               90  Check File Date
     C                     PARM WUWMDT    WQ0009  50       Work Midas Date
     C                     PARM WUDFF     WQ0010  1        Date format fla
     C           WUWCDT    PARM *ZERO     WQ0011  60       Work Converted
     C           WUWADT    PARM *BLANK    WQ0012  7        Work Alpha Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZDATE2'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Set MM Expiry Date
      * CASE: WRK.Work Converted Date is not equal zero
     C           WUWCDT    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    #DMEDS           MM expiry date
     C                     MOVELWUWCDT    #DMEDS           MM expiry date
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #DMEDS           MM expiry date
     C                     END                             *FI
      * MM Review date
     C                     Z-ADDDZMMRD    WUWMDT           Work Midas Date
      * Check File Date - Rundate  *
     C                     CALL 'ZDATE2'               90  Check File Date
     C                     PARM WUWMDT    WQ0013  50       Work Midas Date
     C                     PARM WUDFF     WQ0014  1        Date format fla
     C           WUWCDT    PARM *ZERO     WQ0015  60       Work Converted
     C           WUWADT    PARM *BLANK    WQ0016  7        Work Alpha Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZDATE2'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Set LN Review Date
      * CASE: WRK.Work Converted Date is not equal zero
     C           WUWCDT    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    #DMRDS           MM review date
     C                     MOVELWUWCDT    #DMRDS           MM review date
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #DMRDS           MM review date
     C                     END                             *FI
     C                     END                             *FI
      * End of S01433
      * Check File Date - Rundate  *
     C                     CALL 'ZDATE2'               90  Check File Date
     C                     PARM DZFRED    WQ0017  50       Work Midas Date
     C                     PARM WUDFF     WQ0018  1        Date format fla
     C           WUWCDT    PARM *ZERO     WQ0019  60       Work Converted
     C           WUWADT    PARM *BLANK    WQ0020  7        Work Alpha Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZDATE2'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Set FRA Expiry Date
      * CASE: WRK.Work Converted Date is not equal zero
     C           WUWCDT    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    #DSRED           FRA Expiry Date
     C                     MOVELWUWCDT    #DSRED           FRA Expiry Date
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #DSRED           FRA Expiry Date
     C                     END                             *FI
      * Check File Date - Rundate  *
     C                     CALL 'ZDATE2'               90  Check File Date
     C                     PARM DZFRRD    WQ0021  50       Work Midas Date
     C                     PARM WUDFF     WQ0022  1        Date format fla
     C           WUWCDT    PARM *ZERO     WQ0023  60       Work Converted
     C           WUWADT    PARM *BLANK    WQ0024  7        Work Alpha Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZDATE2'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Set FRA Review Date
      * CASE: WRK.Work Converted Date is not equal zero
     C           WUWCDT    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    #DSRRD           FRA Review Date
     C                     MOVELWUWCDT    #DSRRD           FRA Review Date
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #DSRRD           FRA Review Date
     C                     END                             *FI
      * Check File Date - Rundate  *
     C                     CALL 'ZDATE2'               90  Check File Date
     C                     PARM DZIRED    WQ0025  50       Work Midas Date
     C                     PARM WUDFF     WQ0026  1        Date format fla
     C           WUWCDT    PARM *ZERO     WQ0027  60       Work Converted
     C           WUWADT    PARM *BLANK    WQ0028  7        Work Alpha Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZDATE2'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Set IRS Expiry Date
      * CASE: WRK.Work Converted Date is not equal zero
     C           WUWCDT    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    #DSIED           IRS Expiry Date
     C                     MOVELWUWCDT    #DSIED           IRS Expiry Date
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #DSIED           IRS Expiry Date
     C                     END                             *FI
      * Check File Date - Rundate  *
     C                     CALL 'ZDATE2'               90  Check File Date
     C                     PARM DZIRDT    WQ0029  50       Work Midas Date
     C                     PARM WUDFF     WQ0030  1        Date format fla
     C           WUWCDT    PARM *ZERO     WQ0031  60       Work Converted
     C           WUWADT    PARM *BLANK    WQ0032  7        Work Alpha Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZDATE2'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Set IRS Review Date
      * CASE: WRK.Work Converted Date is not equal zero
     C           WUWCDT    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    #DSIRD           IRS Review Date
     C                     MOVELWUWCDT    #DSIRD           IRS Review Date
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #DSIRD           IRS Review Date
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Convert File amounts to function fields
      *================================================================
      * FX Limit Amount
      * CASE: DB1.FX Limit Amount is not equal zero
     C           DZFLAM    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVELDZFLAM    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0033  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0034 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0035  10       ZALIGN No Of De
     C                     PARM 9         WQ0036  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0037 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUERCD           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUERCD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0038 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0039  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * ZALIGN FX Limit Amount - Region Limits  *
     C*
     C* MOVE ZALIGN SCREEN FUNCTION FIELD INTO FX LIMIT AMOUNT
     C* SCREEN FUNCTION FIELD
     C                     MOVE WUZASF    #DFLAS
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #DFLAS           Fx Limit Amount
     C                     END                             *FI
      * Start of S01433
      * CASE: WRK.SAR S01433 is Present
     C           WUSARF    IFEQ 'Y'                        *IF
      * FX Line Amount
      * CASE: DB1.FX line amount is Not equal zero
     C           DZFXLA    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVELDZFXLA    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0040  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0041 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0042  10       ZALIGN No Of De
     C                     PARM 9         WQ0043  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0044 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUERCD           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUERCD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0045 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0046  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * Zalign FX line amount - Region Limits  *
     C*
     C* MOVE ZALIGN SCREEN FUNCTION FIELD INTO FX LINE AMOUNT
     C* SCREEN FUNCTION FIELD
     C                     MOVE WUZASF    #DFXLS
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #DFXLS           FX Line Amount
     C                     END                             *FI
      * FX Limit Amount
      * CASE: DB1.FX Forward limit amount is not equal zero
     C           DZFXFA    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVELDZFXFA    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0047  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0048 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0049  10       ZALIGN No Of De
     C                     PARM 9         WQ0050  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0051 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUERCD           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUERCD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0052 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0053  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * Zalign FX frwrd lmt amt - Region Limits  *
     C*
     C* MOVE ZALIGN SCREEN FUNCTION FIELD INTO FX FORWARD LIMIT AMOUNT
     C* SCREEN FUNCTION FIELD
     C                     MOVE WUZASF    #DFFLA
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #DFFLA           FX forward lmt
     C                     END                             *FI
      * MM Limit Amount
      * CASE: DB1.Money market limit amount is Not equal zero
     C           DZMMAM    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVELDZMMAM    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0054  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0055 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0056  10       ZALIGN No Of De
     C                     PARM 9         WQ0057  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0058 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUERCD           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUERCD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0059 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0060  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * ZALIGN MM Limit Amount - Region Limits  *
     C*
     C* MOVE ZALIGN SCREEN FUNCTION FIELD INTO MM LIMIT AMOUNT
     C* SCREEN FUNCTION FIELD
     C                     MOVE WUZASF    #DMLAS
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #DMLAS           MM Limit Amount
     C                     END                             *FI
      * MM Line Amount
      * CASE: DB1.Money market Line amount is Not equal zero
     C           DZMLAM    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVELDZMLAM    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0061  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0062 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0063  10       ZALIGN No Of De
     C                     PARM 9         WQ0064  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0065 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUERCD           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUERCD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0066 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0067  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * Zalign MM line amount - Region Limits  *
     C*
     C* MOVE ZALIGN SCREEN FUNCTION FIELD INTO MM LINE AMOUNT
     C* SCREEN FUNCTION FIELD
     C                     MOVE WUZASF    #DMLSC
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #DMLSC           MM Line Amount
     C                     END                             *FI
     C                     END                             *FI
      * End of S01433
      * FRA Limit Amount
      * CASE: DB1.FRA Limit Amount is not equal zero
     C           DZFRLA    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVELDZFRLA    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0068  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0069 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0070  10       ZALIGN No Of De
     C                     PARM 9         WQ0071  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0072 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUERCD           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUERCD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0073 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0074  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * ZALIGN FRA Limit Amount - Region Limits  *
     C*
     C* MOVE ZALIGN SCREEN FUNCTION FIELD INTO FRA LIMIT AMOUNT
     C* SCREEN FUNCTION FIELD
     C                     MOVE WUZASF    #DRLAS
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #DRLAS           FRA Limit Amoun
     C                     END                             *FI
      * IRS Limit Amount
      * CASE: DB1.IRS Limit Amount is not equal zero
     C           DZIRLM    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVELDZIRLM    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0075  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0076 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0077  10       ZALIGN No Of De
     C                     PARM 9         WQ0078  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0079 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUERCD           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUERCD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0080 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0081  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * ZALIGN IRS Limit Amount - Region Limits  *
     C*
     C* MOVE ZALIGN SCREEN FUNCTION FIELD INTO IRS LIMIT AMOUNT
     C* SCREEN FUNCTION FIELD
     C                     MOVE WUZASF    #DILAS
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #DILAS           IRS Limit Amoun
     C                     END                             *FI
      * FX Frequency Day Number
      * CASE: DB1.FX Frequency Day No. is Not Zero
     C           DZFFDN    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVELDZFFDN    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0082  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0083 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0084  10       ZALIGN No Of De
     C                     PARM 2         WQ0085  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0086 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUERCD           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUERCD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0087 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0088  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * ZALIGN FX Freq Day No - Region Limits  *
     C*
     C* MOVE ZALIGN SCREEN FUNCTION FIELD INTO FX FREQUENCY DAY NO
     C* SCREEN FUNCTION FIELD
     C                     MOVE WUZASF    #DFFDS
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #DFFDS           FX Freq Day No
     C                     END                             *FI
      * Start of S01433
      * CASE: WRK.SAR S01433 is Present
     C           WUSARF    IFEQ 'Y'                        *IF
      * MM Frequency Day Number
      * CASE: DB1.Money market Freq. day no is Not zero
     C           DZMFDN    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVELDZMFDN    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0089  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0090 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0091  10       ZALIGN No Of De
     C                     PARM 2         WQ0092  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0093 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUERCD           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUERCD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0094 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0095  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * Zalign MM Freq Day No - Region Limits  *
     C*
     C* MOVE ZALIGN SCREEN FUNCTION FIELD INTO MM FREQUENCY DAY NO
     C* SCREEN FUNCTION FIELD
     C                     MOVE WUZASF    #DMFDS
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #DMFDS           MM Freq day No
     C                     END                             *FI
     C                     END                             *FI
      * End of S01433
      * FRA Frequency Day Number
      * CASE: DB1.FRA Frequency Day No. is Not Zero
     C           DZFRAD    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVELDZFRAD    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0096  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0097 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0098  10       ZALIGN No Of De
     C                     PARM 2         WQ0099  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0100 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUERCD           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUERCD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0101 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0102  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * ZALIGN FRA Freq Day No - Region Limits  *
     C*
     C* MOVE ZALIGN SCREEN FUNCTION FIELD INTO FRA FREQUENCY DAY NO
     C* SCREEN FUNCTION FIELD
     C                     MOVE WUZASF    #DRFDS
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #DRFDS           FRA Freq Day no
     C                     END                             *FI
      * IRS Frequency Day Number
      * CASE: DB1.IRS Frequency Day No. is Not Zero
     C           DZIFDN    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVELDZIFDN    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0103  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0104 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0105  10       ZALIGN No Of De
     C                     PARM 2         WQ0106  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0107 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUERCD           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUERCD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0108 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0109  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * ZALIGN IRS Freq Day No - Region Limits  *
     C*
     C* MOVE ZALIGN SCREEN FUNCTION FIELD INTO IRS FREQUENCY DAY NO
     C* SCREEN FUNCTION FIELD
     C                     MOVE WUZASF    #DIFDS
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #DIFDS           IRS Freq Day no
     C                     END                             *FI
      * MDDR Amount
      * CASE: DB1.MDDR Amount is Not Zero
     C           DZMDDR    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVELDZMDDR    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0110  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0111 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0112  10       ZALIGN No Of De
     C                     PARM 9         WQ0113  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0114 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUERCD           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUERCD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0115 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0116  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * ZALIGN MDDR Amount - Region Limits  *
     C*
     C* MOVE ZALIGN SCREEN FUNCTION FIELD INTO FX MDDR AMOUNT
     C* SCREEN FUNCTION FIELD
     C                     MOVE WUZASF    #DMDAS
     C                     ELSE
      * CASE: *OTHERWISE
      * start RT0040
      * If FX limit not blank and MDDR = 0, display MDDR = 0
      * CASE: DTL.Fx Limit Amount Screen is Not Equal Blank
     C           #DFLAS    IFNE *BLANK                     *IF
     C                     MOVEL@CN,01    #DMDAS           MDDR Amount Scr
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #DMDAS           MDDR Amount Scr
     C                     END                             *FI
      * end RT0040
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Set Details Entered to Details  Entered
      *================================================================
     C                     MOVEL'1'       WUDTEN           Details Entered
      * Start of S01433
      * CASE: WRK.SAR S01433 is Present
     C           WUSARF    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       WUDTLE           Details entered
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'0'       WUDTLE           Details entered
     C                     END                             *FI
      * End of S01433
     C                     MOVEL'1'       WUDEFR           Details Entered
     C                     MOVEL'1'       WUDEIR           Details Entered
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Test for Blanks in Status fields
      *================================================================
      * CASE: PAR.FX Limit Frequency is equal blank
     C           #1FLFQ    IFEQ *BLANK                     *IF
     C                     MOVEL'0'       WUBIFF           Blank in Freque
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'1'       WUBIFF           Blank in Freque
     C                     END                             *FI
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * FX - Blank out file dates and numerics
      *================================================================
     C                     Z-ADD*ZERO     #1FLED           FX Limit Expiry
     C                     Z-ADD*ZERO     #1FLRD           FX Limit Review
     C                     Z-ADD*ZERO     #1FFDN           FX Frequency Da
     C                     Z-ADD*ZERO     #1FLAM           FX Limit Amount
     C                     Z-ADD*ZERO     #1MDDR           MDDR Amount
      * Start of S01433
      * CASE: WRK.SAR S01433 is Present
     C           WUSARF    IFEQ 'Y'                        *IF
     C                     Z-ADD*ZERO     #1FXLA           FX line amount
     C                     Z-ADD*ZERO     #1FXFA           FX Forward limi
     C                     END                             *FI
      * End of S01433
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Test for Blanks in Status fields
      *================================================================
      * CASE: PAR.Money market secured is Blank
     C           #1MSEC    IFEQ *BLANK                     *IF
     C                     MOVEL'0'       WUBISF           Blank in Secure
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'1'       WUBISF           Blank in Secure
     C                     END                             *FI
      * CASE: PAR.Money market limit Freq. is equal blank
     C           #1MMFR    IFEQ *BLANK                     *IF
     C                     MOVEL'0'       WUBIFF           Blank in Freque
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'1'       WUBIFF           Blank in Freque
     C                     END                             *FI
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * MM - Blank out file dates and numerics
      *================================================================
     C                     Z-ADD*ZERO     #1MMED           Money market ex
     C                     Z-ADD*ZERO     #1MMRD           Money market re
     C                     Z-ADD*ZERO     #1MFDN           Money market Fr
     C                     Z-ADD*ZERO     #1MMAM           Money market li
     C                     Z-ADD*ZERO     #1MLAM           Money market Li
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * Test for Blanks in Status fields
      *================================================================
      * CASE: PAR.FRA Review Frequency is equal blank
     C           #1FRFQ    IFEQ *BLANK                     *IF
     C                     MOVEL'0'       WUBIFF           Blank in Freque
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'1'       WUBIFF           Blank in Freque
     C                     END                             *FI
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * FRA - Blank out file dates and numerics
      *================================================================
     C                     Z-ADD*ZERO     #1FRED           FRA Expiry Date
     C                     Z-ADD*ZERO     #1FRRD           FRA Review Date
     C                     Z-ADD*ZERO     #1FRAD           FRA Frequency D
     C                     Z-ADD*ZERO     #1FRLA           FRA Limit Amoun
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         UJSUBR    BEGSR
      *================================================================
      * Test for Blanks in Status fields
      *================================================================
      * CASE: PAR.IRS Review Frequency is equal blank
     C           #1IRFQ    IFEQ *BLANK                     *IF
     C                     MOVEL'0'       WUBIFF           Blank in Freque
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'1'       WUBIFF           Blank in Freque
     C                     END                             *FI
      *================================================================
     CSR         UJEXIT    ENDSR
      /EJECT
     CSR         UKSUBR    BEGSR
      *================================================================
      * IRS - blank out file dates and numerics
      *================================================================
     C                     Z-ADD*ZERO     #1IRED           IRS Expiry Date
     C                     Z-ADD*ZERO     #1IRDT           IRS Review Date
     C                     Z-ADD*ZERO     #1IFDN           IRS Frequency D
     C                     Z-ADD*ZERO     #1IRLM           IRS Limit Amoun
      *================================================================
     CSR         UKEXIT    ENDSR
      /EJECT
     CSR         ULSUBR    BEGSR
      *================================================================
      * Validate FX Fields
      *================================================================
      * CASE: WRK.Details Entered is Details Entered
     C           WUDTEN    IFEQ '1'                        *IF
      * Reset Error Fields
     C                     EXSR UMSUBR                     Reset Error Fie
      * FX Limit Amount must be greater than zero
     C                     EXSR UNSUBR                     FX Limit Amount
      * Validate FX Expiry Date
      * CASE: PAR.FX Expiry Date Screen DS is Not Equal Blank
     C           #DSFED    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DSFED    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0129  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0130 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0131  10       ZALIGN No Of De
     C                     PARM 6         WQ0132  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0133 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUIEDT           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUIEDT           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0134 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0135  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * CASE: WRK.Invalid Expiry Date is Error Found
     C           WUIEDT    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DSFED    ZA0027           FX Expiry Date
      * Send message 'Expiry Date Numeric'
     C                     MOVEL'USR0808' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUZAFF    WUWSDT           Work Screen Dat
      * Check Screen Date - Rundate  *
     C                     CALL 'ZDATE1'               90  Check Screen Da
     C           W0RTN     PARM W0RTN     WQ0136  7        *Return code
     C           WUWSDT    PARM WUWSDT    WQ0137  60       Work Screen Dat
     C           WUDFF     PARM WUDFF     WQ0138  1        Date format fla
     C           #1FLED    PARM *ZERO     WQ0139  50       Work File Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZDATE1'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Test for an Invalid Date
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
      * Setup message data for message
     C                     MOVEL#DSFED    ZA0028           FX Expiry Date
      * Send message 'FX Expiry Date is Invalid'
     C                     MOVEL'USR0730' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
      *
     C                     MOVEL'Y'       WUIEDT           Invalid Expiry
     C                     ELSE
      * CASE: *OTHERWISE
      * Test for date less than rundat
      * CASE: PAR.FX Limit Expiry Date LE PAR.Run day number
     C           #1FLED    IFLE WURDNB                     *IF
      * Setup message data for message
     C                     MOVEL#DSFED    ZA0029           FX Expiry Date
     C                     MOVELWUMRDT    ZA0030           Midas Run Date
      * Send message 'Forex Expiry Date must be'
     C                     MOVEL'USR0160' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     #1FLED           FX Limit Expiry
     C                     END                             *FI
      * Validate FX Review Date
      * CASE: PAR.FX Review Date Screen DS is Not Equal Blank
     C           #DSFRD    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DSFRD    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0140  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0141 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0142  10       ZALIGN No Of De
     C                     PARM 6         WQ0143  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0144 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUINRD           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUINRD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0145 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0146  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * CASE: WRK.Invalid Review Date is Error Found
     C           WUINRD    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DSFRD    ZA0031           FX Review Date
      * Send message 'Review Date Numeric'
     C                     MOVEL'USR0809' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUZAFF    WUWSDT           Work Screen Dat
      * Check Screen Date - Rundate  *
     C                     CALL 'ZDATE1'               90  Check Screen Da
     C           W0RTN     PARM W0RTN     WQ0147  7        *Return code
     C           WUWSDT    PARM WUWSDT    WQ0148  60       Work Screen Dat
     C           WUDFF     PARM WUDFF     WQ0149  1        Date format fla
     C           #1FLRD    PARM *ZERO     WQ0150  50       Work File Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZDATE1'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Test for an Invalid Date
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
      * Setup message data for message
     C                     MOVEL#DSFRD    ZA0032           FX Review Date
      * Send message 'FX Review Date is Invalid'
     C                     MOVEL'USR0733' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     MOVEL'Y'       WUINRD           Invalid Review
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.FX Limit Review Date LE PAR.Run day number
     C           #1FLRD    IFLE WURDNB                     *IF
      * Setup message data for message
     C                     MOVEL#DSFRD    ZA0033           FX Review Date
     C                     MOVELWUMRDT    ZA0034           Midas Run Date
      * Send message 'FX Rev Date after Rundat'
     C                     MOVEL'USR0816' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     #1FLRD           FX Limit Review
     C                     END                             *FI
      * Cross Validate Expiry and Review Dates
      * CASE: PAR.FX Review Date Screen DS is Not Equal Blank
     C           #DSFRD    IFNE *BLANK                     *IF
      * CASE: PAR.FX Expiry Date Screen DS is Equal Blank
     C           #DSFED    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DSFED    ZA0035           FX Expiry Date
      * Send message 'FX Expiry Date Required'
     C                     MOVEL'USR0796' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.Invalid Review Date is Error Not Found
     C           WUINRD    IFEQ 'N'                        *IF
      * CASE: WRK.Invalid Expiry Date is Error Not Found
     C           WUIEDT    IFEQ 'N'                        *IF
      * FX Review date LT Expiry Date
      * CASE: PAR.FX Limit Review Date GE PAR.FX Limit Expiry Date
     C           #1FLRD    IFGE #1FLED                     *IF
      * Setup message data for message
     C                     MOVEL#DSFRD    ZA0036           FX Review Date
      * Send message 'Fx Rev Date Aft Exp Date'
     C                     MOVEL'USR0678' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate FX Review Frequency
      * CASE: PAR.FX Review Date Screen DS is Not Equal Blank
     C           #DSFRD    IFNE *BLANK                     *IF
      * Frequency Code must be entered
      * CASE: PAR.FX Limit Frequency is equal blank
     C           #1FLFQ    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1FLFQ    ZA0037           FX Limit Freque
      * Send message 'FX Limit Freq Required'
     C                     MOVEL'USR0679' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Frequency Code must be left blank
      * CASE: PAR.FX Limit Frequency is equal blank
     C           #1FLFQ    IFEQ *BLANK                     *IF
      * No action required
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1FLFQ    ZA0038           FX Limit Freque
      * Send message 'FX Limit Freq Blank'
     C                     MOVEL'USR0739' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate FX Review Frequency Type
      * CASE: PAR.FX Limit Frequency is M,T,Q,X,Y,*BLANK
     C           #1FLFQ    IFEQ 'T'                        *IF
     C           #1FLFQ    OREQ *BLANK
     C           #1FLFQ    OREQ 'M'
     C           #1FLFQ    OREQ 'Q'
     C           #1FLFQ    OREQ 'X'
     C           #1FLFQ    OREQ 'Y'
      * Valid Limit Frequency.  No action Required
     C                     ELSE
      * CASE: *OTHERWISE
      * Invalid Frequency Code
      * Setup message data for message
     C                     MOVEL#1FLFQ    ZA0039           FX Limit Freque
      * Send message 'FX Limit Frequency inval'
     C                     MOVEL'USR0680' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     END                             *FI
      * Convert Frequency Day Number
     C                     EXSR UOSUBR                     Convert Frequen
      * If Freq is M,T,Q or X then Freq Day No must be 00-31, otherwise b
      * CASE: PAR.FX Limit Frequency is M,T,X,Q
     C           #1FLFQ    IFEQ 'T'                        *IF
     C           #1FLFQ    OREQ 'M'
     C           #1FLFQ    OREQ 'Q'
     C           #1FLFQ    OREQ 'X'
      * CASE: WRK.Invalid Frequency Day No is Error Not Found
     C           WUIFQD    IFEQ 'N'                        *IF
      * Frequency Day Number must be between 00-31
      * CASE: PAR.FX Freq Day Number DS is Equal Blank
     C           #DFFDS    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DFFDS    ZA0041           FX Freq Day Num
      * Send message 'Frequency Day No. Req'
     C                     MOVEL'USR0681' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9941  *
      *
     C                     ELSE
      * CASE: PAR.FX Frequency Day No. is Greater than 31
     C           #1FFDN    IFGT 31                         *IF
      * Setup message data for message
     C                     MOVEL#DFFDS    ZA0042           FX Freq Day Num
      * Send message 'FX Frequency Day No. Inv'
     C                     MOVEL'USR0682' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9941  *
      *
     C                     ELSE
      * CASE: PAR.FX Frequency Day No. is Less than or EQ Zero
     C           #1FFDN    IFLE *ZERO                      *IF
      * Setup message data for message
     C                     MOVEL#DFFDS    ZA0043           FX Freq Day Num
      * Send message 'FX Frequency Day No. Inv'
     C                     MOVEL'USR0682' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9941  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Frequency Day Number must be blank
      * CASE: PAR.FX Freq Day Number DS is Not Equal Blank
     C           #DFFDS    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DFFDS    ZA0044           FX Freq Day Num
      * Send message 'FX Freq Day no - Blank'
     C                     MOVEL'USR0683' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9941  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate MDDR Amount
      * CASE: JOB.*PROGRAM is Country or Region Limits
     C           ##PGM     IFEQ 'SD0461R'                  *IF
     C           ##PGM     OREQ 'SD0471R'
      * MDDR Amount Not used for this function.
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.MDDR Amount Screen is Not Equal Blank
     C           #DMDAS    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DMDAS    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0158  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0159 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0160  10       ZALIGN No Of De
     C                     PARM 9         WQ0161  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0162 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUIMDA           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUIMDA           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0163 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0164  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * CASE: WRK.Invalid MDDR Amount is Error Found
     C           WUIMDA    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DMDAS    ZA0045           MDDR Amount Scr
      * Send message 'MDDR Amount must Numeric'
     C                     MOVEL'USR0792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9943  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * ZALIGN MDDR Amount - Region Limits  *
     C*
     C* MOVE ZALIGN SCREEN FUNCTION FIELD INTO FX MDDR AMOUNT
     C* SCREEN FUNCTION FIELD
     C                     MOVE WUZASF    #DMDAS
     C                     MOVE WUZAFF    #1MDDR           MDDR Amount
      * Start of Fixes BHF898 and BHF931
      * The MDDR can now be equal to 0 or to equal the Limit
      * amount
      * Validate MDDR amount against Limit Amount
      * CASE: WRK.Invalid Limit Amount is Error Not Found
     C           WUILAM    IFEQ 'N'                        *IF
      * CASE: PAR.FX Limit Amount Screen DS is Equal Blank
     C           #DFLAS    IFEQ *BLANK                     *IF
      * Cannot validate against limit amount.
     C                     ELSE
     C/COPY WNCPYSRC,SD0451RC33
      * CASE: PAR.MDDR Amount GT PAR.FX Limit Amount
     C           #1MDDR    IFGT #1FLAM                     *IF
      * Setup message data for message
     C                     MOVEL#DMDAS    ZA0046           MDDR Amount Scr
      * Send message 'FX MDDR Amount invalid'
     C                     MOVEL'USR0684' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9943  *
      *
     C                     END                             *FI
     C/COPY WNCPYSRC,SD0451RC34
     C                     END                             *FI
     C                     END                             *FI
      * End of Fixes BHF898 and BHF931
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DMDAS    ZA0047           MDDR Amount Scr
      * Send message 'MDDR amount is required'
     C                     MOVEL'USR0815' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9943  *
      *
     C                     END                             *FI
     C                     END                             *FI
      *                                                                   CGL011
      ** If CGL011 is installed, validate FX Limit Secured                CGL011
      ** screen field. It must be 'Y' or blank.                           CGL011
      *                                                                   CGL011
     C           CGL011    IFEQ 'Y'                                       CGL011
     C           #1FLSC    ANDNE'Y'                                       CGL011
     C           #1FLSC    ANDNE*BLANK                                    CGL011
     C                     MOVEL#1FLSC    ZA0126                          CGL011
     C                     MOVEL'USR8614' ZAMSID                          CGL011
     C                     EXSR ZASNMS                                    CGL011
     C                     MOVE *ON       *IN99                           CGL011
     C                     MOVE *ON       *IN58                           CGL011
     C                     ENDIF                                          CGL011
      *                                                                   CGL011
      * Start of S01433
      * FX Line amount and FX Forward limit amount
      * CASE: WRK.SAR S01433 is Present
     C           WUSARF    IFEQ 'Y'                        *IF
      * FX Line Amount must be greater than zero
      * CASE: PAR.FX Line amount screen DS is equal blank
     C           #DFXLS    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DFXLS    ZA0048           FX Line amount
      * Send message 'FX line amount is req'
     C                     MOVEL'USR2162' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9945  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DFXLS    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0165  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0166 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0167  10       ZALIGN No Of De
     C                     PARM 9         WQ0168  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0169 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUERCD           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUERCD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0170 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0171  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * CASE: WRK.Err Code is Error Found
     C           WUERCD    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DFXLS    ZA0049           FX Line amount
      * Send message 'Line Amount not numeric'
     C                     MOVEL'USR2160' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9945  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Zalign FX line amount - Region Limits  *
     C*
     C* MOVE ZALIGN SCREEN FUNCTION FIELD INTO FX LINE AMOUNT
     C* SCREEN FUNCTION FIELD
     C                     MOVE WUZASF    #DFXLS
     C                     MOVE WUZAFF    #1FXLA           FX line amount
      * CASE: PAR.FX line amount is equal zero
     C           #1FXLA    IFEQ *ZERO                      *IF
      * Setup message data for message
     C                     MOVEL#DFXLS    ZA0050           FX Line amount
      * Send message 'FX line amount GT zero'
     C                     MOVEL'USR2163' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9945  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * FX Forward Limit Amount must be greater than zero
      * CASE: PAR.FX Forward limt screen DS is equal blank
     C           #DFFLA    IFEQ *BLANK                     *IF
      * Start of 063211
     C                     MOVEL'N'       WUFLAF           Forward Limit A
      * End of 063211
     C                     ELSE
      * CASE: *OTHERWISE
      * Start of 063211
     C                     MOVEL'Y'       WUFLAF           Forward Limit A
      * End of 063211
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DFFLA    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0172  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0173 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0174  10       ZALIGN No Of De
     C                     PARM 9         WQ0175  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0176 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUERCD           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUERCD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0177 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0178  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * CASE: WRK.Err Code is Error Found
     C           WUERCD    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DFFLA    ZA0051           FX Forward limt
      * Send message 'FX Forwrd lmt amt numeric'
     C                     MOVEL'USR2166' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9947  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Zalign FX frwrd lmt amt - Region Limits  *
     C*
     C* MOVE ZALIGN SCREEN FUNCTION FIELD INTO FX FORWARD LIMIT AMOUNT
     C* SCREEN FUNCTION FIELD
     C                     MOVE WUZASF    #DFFLA
     C                     MOVE WUZAFF    #1FXFA           FX Forward limi
      * CASE: PAR.FX Forward limit amount is equal zero
     C           #1FXFA    IFEQ *ZERO                      *IF
      * Setup message data for message
     C                     MOVEL#DFFLA    ZA0052           FX Forward limt
      * Send message 'FX Frwrd lmt amt GT zero'
     C                     MOVEL'USR2167' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9947  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * End of S01433
     C                     END                             *FI
      *================================================================
     CSR         ULEXIT    ENDSR
      /EJECT
     CSR         UMSUBR    BEGSR
      *================================================================
      * Reset Error Fields
      *================================================================
     C                     MOVEL'N'       WUERCD           Err Code
     C                     MOVEL'N'       WUILAM           Invalid Limit A
     C                     MOVEL'N'       WUIFQD           Invalid Frequen
      *================================================================
     CSR         UMEXIT    ENDSR
      /EJECT
     CSR         UNSUBR    BEGSR
      *================================================================
      * FX Limit Amount must be greater than zero
      *================================================================
      * CASE: PAR.FX Limit Amount Screen DS is Equal Blank
     C           #DFLAS    IFEQ *BLANK                     *IF
      * Start of 063211
     C                     MOVEL'N'       WUSLAF           Spot Limit Amou
      * End of 063211
     C                     ELSE
      * CASE: *OTHERWISE
      * Start of 063211
     C                     MOVEL'Y'       WUSLAF           Spot Limit Amou
      * End of 063211
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DFLAS    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0122  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0123 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0124  10       ZALIGN No Of De
     C                     PARM 9         WQ0125  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0126 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUILAM           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUILAM           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0127 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0128  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * CASE: WRK.Invalid Limit Amount is Error Found
     C           WUILAM    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DFLAS    ZA0025           FX Limit Amount
      * Send message 'Limit Amount Not Numeric'
     C                     MOVEL'USR0788' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * ZALIGN FX Limit Amount - Region Limits  *
     C*
     C* MOVE ZALIGN SCREEN FUNCTION FIELD INTO FX LIMIT AMOUNT
     C* SCREEN FUNCTION FIELD
     C                     MOVE WUZASF    #DFLAS
     C                     MOVE WUZAFF    #1FLAM           FX Limit Amount
      * CASE: PAR.FX Limit Amount is equal zero
     C           #1FLAM    IFEQ *ZERO                      *IF
      * Setup message data for message
     C                     MOVEL#DFLAS    ZA0026           FX Limit Amount
      * Send message 'FX Limit Amount GT Zero'
     C                     MOVEL'USR0834' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UNEXIT    ENDSR
      /EJECT
     CSR         UOSUBR    BEGSR
      *================================================================
      * Convert Frequency Day Number
      *================================================================
      * CASE: PAR.FX Freq Day Number DS is Not Equal Blank
     C           #DFFDS    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DFFDS    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0151  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0152 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0153  10       ZALIGN No Of De
     C                     PARM 9         WQ0154  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0155 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUIFQD           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUIFQD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0156 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0157  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * CASE: WRK.Invalid Frequency Day No is Error Found
     C           WUIFQD    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DFFDS    ZA0040           FX Freq Day Num
      * Send message 'Freq Day Num Must Numeric'
     C                     MOVEL'USR0793' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9941  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * ZALIGN FX Freq Day No - Region Limits  *
     C*
     C* MOVE ZALIGN SCREEN FUNCTION FIELD INTO FX FREQUENCY DAY NO
     C* SCREEN FUNCTION FIELD
     C                     MOVE WUZASF    #DFFDS
     C                     MOVE WUZAFF    #1FFDN           FX Frequency Da
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UOEXIT    ENDSR
      /EJECT
     CSR         UPSUBR    BEGSR
      *================================================================
      * Validate MM Fields
      *================================================================
      * CASE: WRK.Details entered - MM is Details entered
     C           WUDTLE    IFEQ '1'                        *IF
      * Reset Error Fields
     C                     EXSR UQSUBR                     Reset Error Fie
      * MM Limit Amount must be greater than zero
      * CASE: PAR.MM Limit Amount sceen DS is Equal blank
     C           #DMLAS    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DMLAS    ZA0059           MM Limit Amount
      * Send message 'MM limit amount is Req'
     C                     MOVEL'USR2144' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9934  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DMLAS    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0179  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0180 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0181  10       ZALIGN No Of De
     C                     PARM 9         WQ0182  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0183 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUILAM           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUILAM           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0184 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0185  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * CASE: WRK.Invalid Limit Amount is Error Found
     C           WUILAM    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DMLAS    ZA0060           MM Limit Amount
      * Send message 'Limit Amount Not Numeric'
     C                     MOVEL'USR0788' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9934  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * ZALIGN MM Limit Amount - Region Limits  *
     C*
     C* MOVE ZALIGN SCREEN FUNCTION FIELD INTO MM LIMIT AMOUNT
     C* SCREEN FUNCTION FIELD
     C                     MOVE WUZASF    #DMLAS
     C                     MOVE WUZAFF    #1MMAM           Money market li
      * CASE: PAR.Money market limit amount is Equal zero
     C           #1MMAM    IFEQ *ZERO                      *IF
      * Setup message data for message
     C                     MOVEL#DMLAS    ZA0061           MM Limit Amount
      * Send message 'MM limit amount GT Zero'
     C                     MOVEL'USR2145' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9934  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate MM Expiry Date
      * CASE: PAR.MM expiry date screen DS is Not equal blank
     C           #DMEDS    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DMEDS    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0186  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0187 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0188  10       ZALIGN No Of De
     C                     PARM 6         WQ0189  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0190 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUIEDT           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUIEDT           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0191 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0192  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * CASE: WRK.Invalid Expiry Date is Error Found
     C           WUIEDT    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DMEDS    ZA0062           MM expiry date
      * Send message 'Expiry Date Numeric'
     C                     MOVEL'USR0808' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9936  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUZAFF    WUWSDT           Work Screen Dat
      * Check Screen Date - Rundate  *
     C                     CALL 'ZDATE1'               90  Check Screen Da
     C           W0RTN     PARM W0RTN     WQ0193  7        *Return code
     C           WUWSDT    PARM WUWSDT    WQ0194  60       Work Screen Dat
     C           WUDFF     PARM WUDFF     WQ0195  1        Date format fla
     C           WUWFDT    PARM *ZERO     WQ0196  50       Work File Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZDATE1'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Test for an Invalid Date
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
      * Setup message data for message
     C                     MOVEL#DMEDS    ZA0063           MM expiry date
      * Send message 'MM Expiry date is invalid'
     C                     MOVEL'USR2146' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9936  *
      *
     C                     MOVEL'Y'       WUIEDT           Invalid Expiry
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWUWFDT    #1MMED           Money market ex
      * Test for date less than rundat
      * CASE: PAR.Money market expiry date LE PAR.Run day number
     C           #1MMED    IFLE WURDNB                     *IF
      * Setup message data for message
     C                     MOVEL#DMEDS    ZA0064           MM expiry date
     C                     MOVELWUMRDT    ZA0065           Midas Run Date
      * Send message 'MM EXP date after rundate'
     C                     MOVEL'USR2147' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9936  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     #1MMED           Money market ex
     C                     END                             *FI
      * Validate MM Review Date
      * CASE: PAR.MM Review date screen DS is Not equal blank
     C           #DMRDS    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DMRDS    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0197  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0198 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0199  10       ZALIGN No Of De
     C                     PARM 6         WQ0200  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0201 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUINRD           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUINRD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0202 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0203  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * CASE: WRK.Invalid Review Date is Error Found
     C           WUINRD    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DMRDS    ZA0066           MM Review date
      * Send message 'Review Date Numeric'
     C                     MOVEL'USR0809' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9938  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUZAFF    WUWSDT           Work Screen Dat
      * Check Screen Date - Rundate  *
     C                     CALL 'ZDATE1'               90  Check Screen Da
     C           W0RTN     PARM W0RTN     WQ0204  7        *Return code
     C           WUWSDT    PARM WUWSDT    WQ0205  60       Work Screen Dat
     C           WUDFF     PARM WUDFF     WQ0206  1        Date format fla
     C           WUWFDT    PARM *ZERO     WQ0207  50       Work File Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZDATE1'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Test for an Invalid Date
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
      * Setup message data for message
     C                     MOVEL#DMRDS    ZA0067           MM Review date
      * Send message 'MM Review date is invalid'
     C                     MOVEL'USR2148' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9938  *
      *
     C                     MOVEL'Y'       WUINRD           Invalid Review
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWUWFDT    #1MMRD           Money market re
      * CASE: PAR.Money market review date LE PAR.Run day number
     C           #1MMRD    IFLE WURDNB                     *IF
      * Setup message data for message
     C                     MOVEL#DMRDS    ZA0068           MM Review date
     C                     MOVELWUMRDT    ZA0069           Midas Run Date
      * Send message 'MM REV date after rundate'
     C                     MOVEL'USR2149' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9938  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     #1MMRD           Money market re
     C                     END                             *FI
      * Cross Validate Expiry and Review dates
      * CASE: PAR.MM Review date screen DS is Not equal blank
     C           #DMRDS    IFNE *BLANK                     *IF
      * CASE: PAR.MM expiry date screen DS is equal blank
     C           #DMEDS    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DMEDS    ZA0070           MM expiry date
      * Send message 'MM Expiry date required'
     C                     MOVEL'USR2150' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9936  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.Invalid Review Date is Error Not Found
     C           WUINRD    IFEQ 'N'                        *IF
      * CASE: WRK.Invalid Expiry Date is Error Not Found
     C           WUIEDT    IFEQ 'N'                        *IF
      * MM Review date LT Expiry Date
      * CASE: PAR.Money market review date GE PAR.Money market expiry dat
     C           #1MMRD    IFGE #1MMED                     *IF
      * Setup message data for message
     C                     MOVEL#DMRDS    ZA0071           MM Review date
      * Send message 'MM Rev date bef exp date'
     C                     MOVEL'USR2151' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9938  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate MM Review Frequency
      * CASE: PAR.MM Review date screen DS is Not equal blank
     C           #DMRDS    IFNE *BLANK                     *IF
      * Frequency Code must be entered
      * CASE: PAR.Money market limit Freq. is equal blank
     C           #1MMFR    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1MMFR    ZA0072           Money market li
      * Send message 'MM limit freq is req'
     C                     MOVEL'USR2152' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9940  *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Frequency Code must be left blank
      * CASE: PAR.Money market limit Freq. is equal blank
     C           #1MMFR    IFEQ *BLANK                     *IF
      * No action required
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1MMFR    ZA0073           Money market li
      * Send message 'MM limt frq must be blank'
     C                     MOVEL'USR2153' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9940  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate MM Limit Frequency Type
      * CASE: PAR.Money market limit Freq. is M,T,Q,X,Y,*BLANK
     C           #1MMFR    IFEQ 'T'                        *IF
     C           #1MMFR    OREQ *BLANK
     C           #1MMFR    OREQ 'M'
     C           #1MMFR    OREQ 'Q'
     C           #1MMFR    OREQ 'X'
     C           #1MMFR    OREQ 'Y'
      * Valid Limit Frequency.  No action Required
     C                     ELSE
      * CASE: *OTHERWISE
      * Invalid Frequency Code
      * Setup message data for message
     C                     MOVEL#1MMFR    ZA0074           Money market li
      * Send message 'MM limit freq is invalid'
     C                     MOVEL'USR2154' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9940  *
      *
     C                     END                             *FI
      * Convert Frequency Day Number
     C                     EXSR URSUBR                     Convert Frequen
      * If Freq is M,T,Q or X then Freq Day No must be 01-31, otherwise b
      * CASE: PAR.Money market limit Freq. is M,T,X,Q
     C           #1MMFR    IFEQ 'T'                        *IF
     C           #1MMFR    OREQ 'M'
     C           #1MMFR    OREQ 'Q'
     C           #1MMFR    OREQ 'X'
      * CASE: WRK.Invalid Frequency Day No is Error Not Found
     C           WUIFQD    IFEQ 'N'                        *IF
      * Frequency Day Number must be between 01-31
      * CASE: PAR.MM Freq Day Number DS is Equal blank
     C           #DMFDS    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DMFDS    ZA0076           MM Freq Day Num
      * Send message 'MM Freq day no is req'
     C                     MOVEL'USR2155' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9942  *
      *
     C                     ELSE
      * CASE: PAR.Money market Freq. day no is Greter that 31
     C           #1MFDN    IFGT 31                         *IF
      * Setup message data for message
     C                     MOVEL#DMFDS    ZA0077           MM Freq Day Num
      * Send message 'MM Freq day no invalid'
     C                     MOVEL'USR2156' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9942  *
      *
     C                     ELSE
      * CASE: PAR.Money market Freq. day no is Less than or equal Zero
     C           #1MFDN    IFLE *ZERO                      *IF
      * Setup message data for message
     C                     MOVEL#DMFDS    ZA0078           MM Freq Day Num
      * Send message 'MM Freq day no invalid'
     C                     MOVEL'USR2156' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9942  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Frequency Day Number must be blank
      * CASE: PAR.MM Freq Day Number DS is Not equal blank
     C           #DMFDS    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DMFDS    ZA0079           MM Freq Day Num
      * Send message 'MM Freq day no - Blank'
     C                     MOVEL'USR2157' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9942  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate Secured if used
      * CASE: JOB.*PROGRAM is Country or Region Limits
     C           ##PGM     IFEQ 'SD0461R'                  *IF
     C           ##PGM     OREQ 'SD0471R'
      * Secured Not Used in this function
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Money market secured is Yes or Blank
     C           #1MSEC    IFEQ *BLANK                     *IF
     C           #1MSEC    OREQ 'Y'
      * Valid Value. No action reuired
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1MSEC    ZA0080           Money market se
      * Send message 'MM Secured blank or yes'
     C                     MOVEL'USR2158' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9944  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * MM Line Amount must be greater than zero
      * CASE: PAR.MM Line amount screen DS is Equal Blank
     C           #DMLSC    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DMLSC    ZA0081           MM Line amount
      * Send message 'MM Line amount is req'
     C                     MOVEL'USR2159' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9946  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DMLSC    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0215  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0216 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0217  10       ZALIGN No Of De
     C                     PARM 9         WQ0218  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0219 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUERCD           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUERCD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0220 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0221  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * CASE: WRK.Err Code is Error Found
     C           WUERCD    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DMLSC    ZA0082           MM Line amount
      * Send message 'Line Amount not numeric'
     C                     MOVEL'USR2160' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9946  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Zalign MM line amount - Region Limits  *
     C*
     C* MOVE ZALIGN SCREEN FUNCTION FIELD INTO MM LINE AMOUNT
     C* SCREEN FUNCTION FIELD
     C                     MOVE WUZASF    #DMLSC
     C                     MOVE WUZAFF    #1MLAM           Money market Li
      * CASE: PAR.Money market Line amount is equal zero
     C           #1MLAM    IFEQ *ZERO                      *IF
      * Setup message data for message
     C                     MOVEL#DMLSC    ZA0083           MM Line amount
      * Send message 'MM line amount GT zero'
     C                     MOVEL'USR2161' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9946  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UPEXIT    ENDSR
      /EJECT
     CSR         UQSUBR    BEGSR
      *================================================================
      * Reset Error Fields
      *================================================================
     C                     MOVEL'N'       WUERCD           Err Code
     C                     MOVEL'N'       WUILAM           Invalid Limit A
     C                     MOVEL'N'       WUIFQD           Invalid Frequen
      *================================================================
     CSR         UQEXIT    ENDSR
      /EJECT
     CSR         URSUBR    BEGSR
      *================================================================
      * Convert Frequency Day Number
      *================================================================
      * CASE: PAR.MM Freq Day Number DS is Not equal blank
     C           #DMFDS    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DMFDS    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0208  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0209 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0210  10       ZALIGN No Of De
     C                     PARM 9         WQ0211  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0212 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUIFQD           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUIFQD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0213 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0214  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * CASE: WRK.Invalid Frequency Day No is Error Found
     C           WUIFQD    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DMFDS    ZA0075           MM Freq Day Num
      * Send message 'Freq Day Num Must Numeric'
     C                     MOVEL'USR0793' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9942  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Zalign MM Freq Day No - Region Limits  *
     C*
     C* MOVE ZALIGN SCREEN FUNCTION FIELD INTO MM FREQUENCY DAY NO
     C* SCREEN FUNCTION FIELD
     C                     MOVE WUZASF    #DMFDS
     C                     MOVE WUZAFF    #1MFDN           Money market Fr
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UREXIT    ENDSR
      /EJECT
     CSR         USSUBR    BEGSR
      *================================================================
      * Convert FRA Limit Amount
      *================================================================
      * CASE: PAR.FRA Limit Amount Scrn DS is Not Equal Blank
     C           #DRLAS    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DRLAS    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0222  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0223 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0224  10       ZALIGN No Of De
     C                     PARM 9         WQ0225  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0226 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUILAM           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUILAM           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0227 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0228  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * CASE: WRK.Invalid Limit Amount is Error Found
     C           WUILAM    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DRLAS    ZA0084           FRA Limit Amoun
      * Send message 'Limit Amount Not Numeric'
     C                     MOVEL'USR0788' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9948  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * ZALIGN FRA Limit Amount - Region Limits  *
     C*
     C* MOVE ZALIGN SCREEN FUNCTION FIELD INTO FRA LIMIT AMOUNT
     C* SCREEN FUNCTION FIELD
     C                     MOVE WUZASF    #DRLAS
     C                     MOVE WUZAFF    #1FRLA           FRA Limit Amoun
     C/COPY WNCPYSRC,SD0451RC07
      * CASE: PAR.FRA Limit Amount is equal zero
     C           #1FRLA    IFEQ *ZERO                      *IF
      * Setup message data for message
     C                     MOVEL#DRLAS    ZA0085           FRA Limit Amoun
      * Send message 'FRA Limit Amount GT Zero'
     C                     MOVEL'USR0836' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9948  *
      *
     C                     END                             *FI
     C/COPY WNCPYSRC,SD0451RC08
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         USEXIT    ENDSR
      /EJECT
     CSR         UTSUBR    BEGSR
      *================================================================
      * Validate FRA Fields
      *================================================================
      * CASE: WRK.Details Entered - FRA is Details Entered
     C           WUDEFR    IFEQ '1'                        *IF
      * Reset Error Fields
     C                     EXSR UUSUBR                     Reset Error Fie
      * Validate FRA Expiry Date
      * CASE: PAR.FRA Expiry Date Screen DS is Not Equal Blank
     C           #DSRED    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DSRED    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0229  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0230 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0231  10       ZALIGN No Of De
     C                     PARM 6         WQ0232  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0233 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUIEDT           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUIEDT           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0234 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0235  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * CASE: WRK.Invalid Expiry Date is Error Found
     C           WUIEDT    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DSRED    ZA0086           FRA Expiry Date
      * Send message 'Expiry Date Numeric'
     C                     MOVEL'USR0808' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9950  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUZAFF    WUWSDT           Work Screen Dat
      * Check Screen Date - Rundate  *
     C                     CALL 'ZDATE1'               90  Check Screen Da
     C           W0RTN     PARM W0RTN     WQ0236  7        *Return code
     C           WUWSDT    PARM WUWSDT    WQ0237  60       Work Screen Dat
     C           WUDFF     PARM WUDFF     WQ0238  1        Date format fla
     C           #1FRED    PARM *ZERO     WQ0239  50       Work File Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZDATE1'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Test for an Invalid Date
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
      * Setup message data for message
     C                     MOVEL#DSRED    ZA0087           FRA Expiry Date
      * Send message 'FRA Expiry Date invalid'
     C                     MOVEL'USR4119' ZAMSID
     C/COPY WNCPYSRC,SD0451RC09
     C                     EXSR ZASNMS
     C                     SETON                     9950  *
      *
     C                     MOVEL'Y'       WUIEDT           Invalid Expiry
     C                     ELSE
      * CASE: *OTHERWISE
      * Test for date less than rundat
      * CASE: PAR.FRA Expiry Date LE PAR.Run day number
     C           #1FRED    IFLE WURDNB                     *IF
      * Setup message data for message
     C                     MOVEL#DSRED    ZA0088           FRA Expiry Date
     C                     MOVELWUMRDT    ZA0089           Midas Run Date
      * Send message 'FRA Exp Date not gt rundt'
     C                     MOVEL'USR4120' ZAMSID
     C/COPY WNCPYSRC,SD0451RC10
     C                     EXSR ZASNMS
     C                     SETON                     9950  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     #1FRED           FRA Expiry Date
     C                     END                             *FI
      * Validate FRA Review Date
      * CASE: PAR.FRA Review Date Screen DS is Not Equal Blank
     C           #DSRRD    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DSRRD    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0240  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0241 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0242  10       ZALIGN No Of De
     C                     PARM 6         WQ0243  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0244 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUINRD           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUINRD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0245 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0246  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * CASE: WRK.Invalid Review Date is Error Found
     C           WUINRD    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DSRRD    ZA0090           FRA Review Date
      * Send message 'Review Date Numeric'
     C                     MOVEL'USR0809' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9952  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUZAFF    WUWSDT           Work Screen Dat
      * Check Screen Date - Rundate  *
     C                     CALL 'ZDATE1'               90  Check Screen Da
     C           W0RTN     PARM W0RTN     WQ0247  7        *Return code
     C           WUWSDT    PARM WUWSDT    WQ0248  60       Work Screen Dat
     C           WUDFF     PARM WUDFF     WQ0249  1        Date format fla
     C           #1FRRD    PARM *ZERO     WQ0250  50       Work File Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZDATE1'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Test for an Invalid Date
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
      * Setup message data for message
     C                     MOVEL#DSRRD    ZA0091           FRA Review Date
      * Send message 'FRA Review date invalid'
     C                     MOVEL'USR4121' ZAMSID
     C/COPY WNCPYSRC,SD0451RC11
     C                     EXSR ZASNMS
     C                     SETON                     9952  *
      *
     C                     MOVEL'Y'       WUINRD           Invalid Review
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.FRA Review Date LE PAR.Run day number
     C           #1FRRD    IFLE WURDNB                     *IF
      * Setup message data for message
     C                     MOVEL#DSRRD    ZA0092           FRA Review Date
     C                     MOVELWUMRDT    ZA0093           Midas Run Date
      * Send message 'FRA Rev Date after Rundat'
     C                     MOVEL'USR0818' ZAMSID
     C/COPY WNCPYSRC,SD0451RC12
     C                     EXSR ZASNMS
     C                     SETON                     9952  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C/COPY WNCPYSRC,SD0451RC13
     C**********           Z-ADD*ZERO     #1FLRD           FX Limit Review                    192785
     C                     Z-ADD*ZERO     #1FRRD           FX Limit Review                    192785
     C/COPY WNCPYSRC,SD0451RC14
     C                     END                             *FI
      * Cross validate expiry and review dates
      * CASE: PAR.FRA Review Date Screen DS is Not Equal Blank
     C           #DSRRD    IFNE *BLANK                     *IF
      * CASE: PAR.FRA Expiry Date Screen DS is Equal Blank
     C           #DSRED    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DSRED    ZA0094           FRA Expiry Date
      * Send message 'FRA Expiry Date Required'
     C                     MOVEL'USR0799' ZAMSID
     C/COPY WNCPYSRC,SD0451RC15
     C                     EXSR ZASNMS
     C                     SETON                     9950  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.Invalid Review Date is Error Not Found
     C           WUINRD    IFEQ 'N'                        *IF
      * CASE: WRK.Invalid Expiry Date is Error Not Found
     C           WUIEDT    IFEQ 'N'                        *IF
      * FRA Review date LT Expiry Date
      * CASE: PAR.FRA Review Date GE PAR.FRA Expiry Date
     C           #1FRRD    IFGE #1FRED                     *IF
      * Setup message data for message
     C                     MOVEL#DSRRD    ZA0095           FRA Review Date
      * Send message 'fra r dat GT fra ex dat'
     C                     MOVEL'USR4123' ZAMSID
     C/COPY WNCPYSRC,SD0451RC16
     C                     EXSR ZASNMS
     C                     SETON                     9952  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate FRA Review Frequency
      * CASE: PAR.FRA Review Date Screen DS is Not Equal Blank
     C/COPY WNCPYSRC,SD0451RC17
     C           #DSRRD    IFNE *BLANK                     *IF
      * Frequency Code must be entered
      * CASE: PAR.FRA Review Frequency is equal blank
     C           #1FRFQ    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1FRFQ    ZA0096           FRA Review Freq
      * Send message 'FRA Review Freq Required'
     C                     MOVEL'USR0694' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9954  *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Frequency Code must be left blank
      * CASE: PAR.FRA Review Frequency is equal blank
     C           #1FRFQ    IFEQ *BLANK                     *IF
      * No action required
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1FRFQ    ZA0097           FRA Review Freq
      * Send message 'FRA Rev Freq Should Blank'
     C                     MOVEL'USR0696' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9954  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C/COPY WNCPYSRC,SD0451RC18
      * Validate FRA Review Frequency Type
      * CASE: PAR.FRA Review Frequency is M,T,Q,X,Y,*BLANK
     C           #1FRFQ    IFEQ 'T'                        *IF
     C           #1FRFQ    OREQ *BLANK
     C           #1FRFQ    OREQ 'M'
     C           #1FRFQ    OREQ 'Q'
     C           #1FRFQ    OREQ 'X'
     C           #1FRFQ    OREQ 'Y'
      * Valid Limit Frequency.  No action Required
     C                     ELSE
      * CASE: *OTHERWISE
      * Invalid Frequency Code
      * Setup message data for message
     C                     MOVEL#1FRFQ    ZA0098           FRA Review Freq
      * Send message 'FRA Review Freq Invalid'
     C                     MOVEL'USR0695' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9954  *
      *
     C                     END                             *FI
      * Convert Frequency Day Number
     C                     EXSR UVSUBR                     Convert Frequen
      * If Freq is M,T,Q or X then Freq Day No must be 01-31, otherwise b
      * CASE: PAR.FRA Review Frequency is M,T,X,Q
     C           #1FRFQ    IFEQ 'T'                        *IF
     C           #1FRFQ    OREQ 'M'
     C           #1FRFQ    OREQ 'Q'
     C           #1FRFQ    OREQ 'X'
      * CASE: WRK.Invalid Frequency Day No is Error Not Found
     C           WUIFQD    IFEQ 'N'                        *IF
      * Frequency Day Number must be between 01-31
      * CASE: PAR.FRA Freq Day Number DS is Equal Blank
     C           #DRFDS    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DRFDS    ZA0100           FRA Freq Day Nu
      * Send message 'FRA Freq Day Num Required'
     C                     MOVEL'USR0697' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9956  *
      *
     C                     ELSE
      * CASE: PAR.FRA Frequency Day No. is Greater Than 31
     C           #1FRAD    IFGT 31                         *IF
      * Setup message data for message
     C                     MOVEL#DRFDS    ZA0101           FRA Freq Day Nu
      * Send message 'FRA Freq Day No Invalid'
     C                     MOVEL'USR0698' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9956  *
      *
     C                     ELSE
      * CASE: PAR.FRA Frequency Day No. is Less or EQ Zero
     C           #1FRAD    IFLE *ZERO                      *IF
      * Setup message data for message
     C                     MOVEL#DRFDS    ZA0102           FRA Freq Day Nu
      * Send message 'FRA Freq Day No Invalid'
     C                     MOVEL'USR0698' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9956  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Frequency Day Number must be blank
      * CASE: PAR.FRA Freq Day Number DS is Not Equal Blank
     C           #DRFDS    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DRFDS    ZA0103           FRA Freq Day Nu
      * Send message 'FRA Freq Day No Blank'
     C                     MOVEL'USR0699' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9956  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UTEXIT    ENDSR
      /EJECT
     CSR         UUSUBR    BEGSR
      *================================================================
      * Reset Error Fields
      *================================================================
     C                     MOVEL'N'       WUERCD           Err Code
     C                     MOVEL'N'       WUIFQD           Invalid Frequen
      *================================================================
     CSR         UUEXIT    ENDSR
      /EJECT
     CSR         UVSUBR    BEGSR
      *================================================================
      * Convert Frequency Day Number
      *================================================================
      * CASE: PAR.FRA Freq Day Number DS is Not Equal Blank
     C           #DRFDS    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DRFDS    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0251  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0252 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0253  10       ZALIGN No Of De
     C                     PARM 9         WQ0254  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0255 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUIFQD           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUIFQD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0256 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0257  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * CASE: WRK.Invalid Frequency Day No is Error Found
     C           WUIFQD    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DRFDS    ZA0099           FRA Freq Day Nu
      * Send message 'Freq Day Num Must Numeric'
     C                     MOVEL'USR0793' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9956  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * ZALIGN FRA Freq Day No - Region Limits  *
     C*
     C* MOVE ZALIGN SCREEN FUNCTION FIELD INTO FRA FREQUENCY DAY NO
     C* SCREEN FUNCTION FIELD
     C                     MOVE WUZASF    #DRFDS
     C                     MOVE WUZAFF    #1FRAD           FRA Frequency D
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UVEXIT    ENDSR
      /EJECT
     CSR         UWSUBR    BEGSR
      *================================================================
      * Convert IRS Limit Amount
      *================================================================
      * CASE: PAR.IRS Limit Amount Scrn DS is Not Equal Blank
     C           #DILAS    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DILAS    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0258  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0259 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0260  10       ZALIGN No Of De
     C                     PARM 9         WQ0261  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0262 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUILAM           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUILAM           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0263 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0264  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * CASE: WRK.Invalid Limit Amount is Error Found
     C           WUILAM    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DILAS    ZA0104           IRS Limit Amoun
      * Send message 'Limit Amount Not Numeric'
     C                     MOVEL'USR0788' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9949  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * ZALIGN IRS Limit Amount - Region Limits  *
     C*
     C* MOVE ZALIGN SCREEN FUNCTION FIELD INTO IRS LIMIT AMOUNT
     C* SCREEN FUNCTION FIELD
     C                     MOVE WUZASF    #DILAS
     C                     MOVE WUZAFF    #1IRLM           IRS Limit Amoun
     C/COPY WNCPYSRC,SD0451RC19
      * CASE: PAR.IRS Limit Amount is equal zero
     C           #1IRLM    IFEQ *ZERO                      *IF
      * Setup message data for message
     C                     MOVEL#DILAS    ZA0105           IRS Limit Amoun
      * Send message 'IRS Limit Amount GT Zero'
     C                     MOVEL'USR0837' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9949  *
      *
     C                     END                             *FI
     C/COPY WNCPYSRC,SD0451RC20
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UWEXIT    ENDSR
      /EJECT
     CSR         UXSUBR    BEGSR
      *================================================================
      * Validate IRS Fields
      *================================================================
      * CASE: WRK.Details Entered - IRS is Details Entered
     C           WUDEIR    IFEQ '1'                        *IF
      * Reset Error Fields
     C                     EXSR UYSUBR                     Reset Error Fie
      * Validate IRS Expiry Date
      * CASE: PAR.IRS Expiry Date Screen DS is Not Equal Blank
     C           #DSIED    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DSIED    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0265  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0266 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0267  10       ZALIGN No Of De
     C                     PARM 6         WQ0268  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0269 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUIEDT           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUIEDT           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0270 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0271  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * CASE: WRK.Invalid Expiry Date is Error Found
     C           WUIEDT    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DSIED    ZA0106           IRS Expiry Date
      * Send message 'Expiry Date Numeric'
     C                     MOVEL'USR0808' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9951  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUZAFF    WUWSDT           Work Screen Dat
      * Check Screen Date - Rundate  *
     C                     CALL 'ZDATE1'               90  Check Screen Da
     C           W0RTN     PARM W0RTN     WQ0272  7        *Return code
     C           WUWSDT    PARM WUWSDT    WQ0273  60       Work Screen Dat
     C           WUDFF     PARM WUDFF     WQ0274  1        Date format fla
     C           #1IRED    PARM *ZERO     WQ0275  50       Work File Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZDATE1'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Test for an Invalid Date
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
      * Setup message data for message
     C                     MOVEL#DSIED    ZA0107           IRS Expiry Date
      * Send message 'IRS Expiry Date Invalid'
     C                     MOVEL'USR0735' ZAMSID
     C/COPY WNCPYSRC,SD0451RC21
     C                     EXSR ZASNMS
     C                     SETON                     9951  *
      *
     C                     MOVEL'Y'       WUIEDT           Invalid Expiry
     C                     ELSE
      * CASE: *OTHERWISE
      * Test for date less than rundat
      * CASE: PAR.IRS Expiry Date LE PAR.Run day number
     C           #1IRED    IFLE WURDNB                     *IF
      * Setup message data for message
     C                     MOVEL#DSIED    ZA0108           IRS Expiry Date
     C                     MOVELWUMRDT    ZA0109           Midas Run Date
      * Send message 'IRS Exp dat LE rundat'
     C                     MOVEL'USR4126' ZAMSID
     C/COPY WNCPYSRC,SD0451RC22
     C                     EXSR ZASNMS
     C                     SETON                     9951  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     #1IRED           IRS Expiry Date
     C                     END                             *FI
      * Validate IRS Review Date
      * CASE: PAR.IRS Review Date Screen DS is Not Equal Blank
     C           #DSIRD    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DSIRD    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0276  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0277 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0278  10       ZALIGN No Of De
     C                     PARM 6         WQ0279  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0280 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUINRD           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUINRD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0281 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0282  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * CASE: WRK.Invalid Review Date is Error Found
     C           WUINRD    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DSIRD    ZA0110           IRS Review Date
      * Send message 'Review Date Numeric'
     C                     MOVEL'USR0809' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9953  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUZAFF    WUWSDT           Work Screen Dat
      * Check Screen Date - Rundate  *
     C                     CALL 'ZDATE1'               90  Check Screen Da
     C           W0RTN     PARM W0RTN     WQ0283  7        *Return code
     C           WUWSDT    PARM WUWSDT    WQ0284  60       Work Screen Dat
     C           WUDFF     PARM WUDFF     WQ0285  1        Date format fla
     C           #1IRDT    PARM *ZERO     WQ0286  50       Work File Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZDATE1'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Test for an Invalid Date
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
      * Setup message data for message
     C                     MOVEL#DSIRD    ZA0111           IRS Review Date
      * Send message 'IRS Review Date Invalid'
     C                     MOVEL'USR0736' ZAMSID
     C/COPY WNCPYSRC,SD0451RC23
     C                     EXSR ZASNMS
     C                     SETON                     9953  *
      *
     C                     MOVEL'Y'       WUINRD           Invalid Review
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.IRS Review Date LE PAR.Run day number
     C           #1IRDT    IFLE WURDNB                     *IF
      * Setup message data for message
     C                     MOVEL#DSIRD    ZA0112           IRS Review Date
     C                     MOVELWUMRDT    ZA0113           Midas Run Date
      * Send message 'IRS Rev Date after Rundat'
     C                     MOVEL'USR0819' ZAMSID
     C/COPY WNCPYSRC,SD0451RC24
     C                     EXSR ZASNMS
     C                     SETON                     9953  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     #1IRDT           IRS Review Date
     C                     END                             *FI
      * Cross validate expiry and review dates
      * CASE: PAR.IRS Review Date Screen DS is Not Equal Blank
     C           #DSIRD    IFNE *BLANK                     *IF
      * CASE: PAR.IRS Expiry Date Screen DS is Equal Blank
     C           #DSIED    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DSIED    ZA0114           IRS Expiry Date
      * Send message 'IRS Expiry Date Required'
     C                     MOVEL'USR0800' ZAMSID
     C/COPY WNCPYSRC,SD0451RC25
     C                     EXSR ZASNMS
     C                     SETON                     9951  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.Invalid Review Date is Error Not Found
     C           WUINRD    IFEQ 'N'                        *IF
      * CASE: WRK.Invalid Expiry Date is Error Not Found
     C           WUIEDT    IFEQ 'N'                        *IF
      * IRS Review date GT Rundate and LT Expiry Date
      * CASE: PAR.IRS Review Date GE PAR.IRS Expiry Date
     C           #1IRDT    IFGE #1IRED                     *IF
      * Setup message data for message
     C                     MOVEL#DSIRD    ZA0115           IRS Review Date
      * Send message 'IRS Rev dat GT IRS Ex Dat'
     C                     MOVEL'USR4129' ZAMSID
     C/COPY WNCPYSRC,SD0451RC26
     C                     EXSR ZASNMS
     C                     SETON                     9953  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate IRS Review Frequency
      * CASE: PAR.IRS Review Date Screen DS is Not Equal Blank
     C/COPY WNCPYSRC,SD0451RC27
     C           #DSIRD    IFNE *BLANK                     *IF
      * Frequency Code must be entered
      * CASE: PAR.IRS Review Frequency is equal blank
     C           #1IRFQ    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1IRFQ    ZA0116           IRS Review Freq
      * Send message 'IRS Review Freq Required'
     C                     MOVEL'USR0701' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9955  *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Frequency Code must be left blank
      * CASE: PAR.IRS Review Frequency is equal blank
     C           #1IRFQ    IFEQ *BLANK                     *IF
      * No action required
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1IRFQ    ZA0117           IRS Review Freq
      * Send message 'IRS Rev Frq must be Blank'
     C                     MOVEL'USR0704' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9955  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C/COPY WNCPYSRC,SD0451RC28
      * Validate IRS Review Frequency Type
      * CASE: PAR.IRS Review Frequency is Q,M,T,X,Y,*BLANK
     C           #1IRFQ    IFEQ 'T'                        *IF
     C           #1IRFQ    OREQ *BLANK
     C           #1IRFQ    OREQ 'M'
     C           #1IRFQ    OREQ 'Q'
     C           #1IRFQ    OREQ 'X'
     C           #1IRFQ    OREQ 'Y'
      * Valid Limit Frequency.  No action Required
     C                     ELSE
      * CASE: *OTHERWISE
      * Invalid Frequency Code
      * Setup message data for message
     C                     MOVEL#1IRFQ    ZA0118           IRS Review Freq
      * Send message 'IRS Review Freq Invalid'
     C                     MOVEL'USR0702' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9955  *
      *
     C                     END                             *FI
      * Convert Frequency Day Number
     C                     EXSR UZSUBR                     Convert Frequen
      * If Freq is M,T,Q or X then Freq Day No must be 01-31, otherwise b
      * CASE: PAR.IRS Review Frequency is M,T,X,Q
     C           #1IRFQ    IFEQ 'T'                        *IF
     C           #1IRFQ    OREQ 'M'
     C           #1IRFQ    OREQ 'Q'
     C           #1IRFQ    OREQ 'X'
      * CASE: WRK.Invalid Frequency Day No is Error Not Found
     C           WUIFQD    IFEQ 'N'                        *IF
      * Frequency Day Number must be between 01-31
      * CASE: PAR.IRS Freq Day Number DS is Equal Blank
     C           #DIFDS    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DIFDS    ZA0120           IRS Freq Day Nu
      * Send message 'IRS Freq Day no Required'
     C                     MOVEL'USR0705' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9957  *
      *
     C                     ELSE
      * CASE: PAR.IRS Frequency Day No. is Greater Than 31
     C           #1IFDN    IFGT 31                         *IF
      * Setup message data for message
     C                     MOVEL#DIFDS    ZA0121           IRS Freq Day Nu
      * Send message 'IRS Freq Day No Invalid'
     C                     MOVEL'USR0706' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9957  *
      *
     C                     ELSE
      * CASE: PAR.IRS Frequency Day No. is Equal or LT ZERO
     C           #1IFDN    IFLE *ZERO                      *IF
      * Setup message data for message
     C                     MOVEL#DIFDS    ZA0122           IRS Freq Day Nu
      * Send message 'IRS Freq Day No Invalid'
     C                     MOVEL'USR0706' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9957  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Frequency Day Number must be blank
      * CASE: PAR.IRS Freq Day Number DS is Not Equal Blank
     C           #DIFDS    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DIFDS    ZA0123           IRS Freq Day Nu
      * Send message 'IRS Freq Day no must blnk'
     C                     MOVEL'USR0707' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9957  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UXEXIT    ENDSR
      /EJECT
     CSR         UYSUBR    BEGSR
      *================================================================
      * Reset Error Fields
      *================================================================
     C                     MOVEL'N'       WUERCD           Err Code
     C                     MOVEL'N'       WUIFQD           Invalid Frequen
      *================================================================
     CSR         UYEXIT    ENDSR
      /EJECT
     CSR         UZSUBR    BEGSR
      *================================================================
      * Convert Frequency Day Number
      *================================================================
      * CASE: PAR.IRS Freq Day Number DS is Not Equal Blank
     C           #DIFDS    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DIFDS    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0287  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0288 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0289  10       ZALIGN No Of De
     C                     PARM 9         WQ0290  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0291 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUIFQD           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUIFQD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0292 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0293  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * CASE: WRK.Invalid Frequency Day No is Error Found
     C           WUIFQD    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DIFDS    ZA0119           IRS Freq Day Nu
      * Send message 'Freq Day Num Must Numeric'
     C                     MOVEL'USR0793' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9957  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * ZALIGN IRS Freq Day No - Region Limits  *
     C*
     C* MOVE ZALIGN SCREEN FUNCTION FIELD INTO IRS FREQUENCY DAY NO
     C* SCREEN FUNCTION FIELD
     C                     MOVE WUZASF    #DIFDS
     C                     MOVE WUZAFF    #1IFDN           IRS Frequency D
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UZEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Select existing record
      *================================================================
      * Name search required?
     C                     MOVEL#1CUST    WK1X01  1
     C                     MOVEL#1LEVL    WK1X02  1
     C                     MOVEL#1BCCD    WK1X03  1
     C           WK1X01    IFEQ '?'                        Customer Number
     C           WK1X02    OREQ '?'                        Level
     C           WK1X03    OREQ '?'                        Branch/Company
     C                     CALL 'SD0450S'              90  Select Client L
     C                     PARM *BLANK    W0RTN   7
     C           #1CUST    PARM #1CUST    WQ0117  6        Customer Number
     C           #1LEVL    PARM #1LEVL    WQ0118  1        Level
     C           #1BCCD    PARM #1BCCD    WQ0119  3        Branch/Company
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0450S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     993132*
     C                     SETON                     33    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to Client Details
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1CUST    WK1X01  1
     C           WK1X01    IFEQ '?'                        Customer Number
     C                     CALL 'SD0010S'              90  Select Client D
     C                     PARM *BLANK    W0RTN   7
     C           #1CUST    PARM #1CUST    WQ0120  6        Customer Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0010S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9931  *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VBEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1CUST    IFEQ *BLANK                     Customer Number
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBBB    KLIST
     C                     KFLD           BBCUST           Customer Number
      * Setup key
     C                     MOVEL#1CUST    BBCUST           Customer Number
     C           KLVBBB    CHAIN@BBREBF              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
      * Send message 'Client Details         NF'
     C                     MOVEL'USR0081' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0081' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Limit types
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1FXLT    WK1X01  1
     C           WK1X01    IFEQ '?'                        Limit Type
     C                     CALL 'SD0141S'              90  Select Limits
     C                     PARM *BLANK    W0RTN   7
     C           #1FXLT    PARM #1FXLT    WQ0297  3        Limit Type
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0141S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9931  *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1FXLT    IFEQ *BLANK                     Limit Type
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCA2    KLIST
     C                     KFLD           A2LMTY           Limit Type
      * Setup key
     C                     MOVEL#1FXLT    A2LMTY           Limit Type
     C           KLVCA2    CHAIN@A2REBU              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Limit types            NF'
     C                     MOVEL'USR0063' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0063' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check reference to Limit types
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1LLTY    WK1X01  1
     C           WK1X01    IFEQ '?'                        Limit Type
     C                     CALL 'SD0141S'              90  Select Limits
     C                     PARM *BLANK    W0RTN   7
     C           #1LLTY    PARM #1LLTY    WQ0298  3        Limit Type
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0141S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VDEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1LLTY    IFEQ *BLANK                     Limit Type
     C                     GOTO VDEXIT
     C                     END
      *
     C           KLVDA2    KLIST
     C                     KFLD           A2LMTY           Limit Type
      * Setup key
     C                     MOVEL#1LLTY    A2LMTY           Limit Type
     C           KLVDA2    CHAIN@A2REBU              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VDEXIT
     C                     END
      * Send message 'Limit types            NF'
     C                     MOVEL'USR0063' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0063' W0RTN
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y1SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y1EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C           @#DFMT    IFEQ '#RCDKEY'
      * KEY Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     END
     C           @#DFMT    IFEQ '#RCDDTL1'
      * DETAIL Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     END
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C/COPY WNCPYSRC,SD0451RC02
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM 1         YYLGCT  50       # of grps
     C                     PARM W0GRP     YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel and exit from key screen
      *================================================================
      * USER: Exit program processing
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy Member SD0451REPP - Client Limits  *
     C/COPY WNCPYSRC,SD0451REPP
     C                     END                             *FI
      * CASE: KEY.*CMD key is *Exit
     C           *IN03     IFEQ '1'                        *IF
     C                     MOVEL'Y2U9999' P5DRTC           Duplicate Retur
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * ROLLBACK any uncommitted DBF changes
     C                     ROLBK                       90
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *                                                                   CGL011
      ** Define Local Data Area and Program name                          CGL011
      *                                                                   CGL011
     C           *NAMVAR   DEFN           LDA                             CGL011
     C           *LOCK     IN   LDA                                       CGL011
     C                     MOVEL'SD0451R' DBPGM                           CGL011
     C                     OUT  LDA                                       CGL011
      *                                                                   CGL011
      * Setup job date/time
      *
     C                     Z-ADDUDATE     ##JDT
      * Set century digit (If YY prior to 1940 treat as 20YY)
     C           ##JYY     IFLT 40
     C                     Z-ADD1         ##JCC
     C                     ELSE
     C                     Z-ADD0         ##JCC
     C                     END
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Obtain default message file
     C           *NAMVAR   DEFN Y2MGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field S01212
     C                     MOVEL*BLANK    WUMFTS  1
      * Define work field SAR S01433
     C                     MOVEL*BLANK    WUSARF  1
      * Define work field Multi-branching Indicator
     C                     MOVEL*BLANK    WUMBIN  1
      * Define work field Display Level & Brch/Comp
     C                     MOVEL*BLANK    WUDLBC  1
      * Define work field Date format flag
     C                     MOVEL*BLANK    WUDFF   1
      * Define work field Work Converted Date
     C                     Z-ADD*ZERO     WUWCDT  60
      * Define work field Work Alpha Date
     C                     MOVEL*BLANK    WUWADT  7
      * Define work field Work Midas Date
     C                     Z-ADD*ZERO     WUWMDT  50
      * Define work field ZALIGN Screen Fun Field
     C                     MOVEL*BLANK    WUZASF 16
      * Define work field ZALIGN File Field
     C                     MOVEL*BLANK    WUZAFF 16
      * Define work field Err Code
     C                     MOVEL*BLANK    WUERCD  1
      * Define work field Customer Shortname
     C                     MOVEL*BLANK    WUCSSN 10
      * Define work field Customer Report Town
     C                     MOVEL*BLANK    WUCRTN 10
      * Define work field Customer Report Name
     C                     MOVEL*BLANK    WUCRNM 20
      * Define work field Run day number
     C                     Z-ADD*ZERO     WURDNB  50
      * Define work field Midas Run Date
     C                     MOVEL*BLANK    WUMRDT  7
      * Define work field Details Entered
     C                     MOVEL*BLANK    WUDTEN  1
      * Define work field Details entered - MM
     C                     MOVEL*BLANK    WUDTLE  1
      * Define work field Details Entered - FRA
     C                     MOVEL*BLANK    WUDEFR  1
      * Define work field Details Entered - IRS
     C                     MOVEL*BLANK    WUDEIR  1
      * Define work field Blank in Frequency Field
     C                     MOVEL*BLANK    WUBIFF  1
      * Define work field Error field
     C                     MOVEL*BLANK    WUEFLD  1
      * Define work field Spot Limit Amount Flag
     C                     MOVEL*BLANK    WUSLAF  1
      * Define work field Forward Limit Amount Flag
     C                     MOVEL*BLANK    WUFLAF  1
      * Define work field Blank in Secured Field
     C                     MOVEL*BLANK    WUBISF  1
      * Define work field Test ? in Key Field
     C                     MOVEL*BLANK    WUTQKF  1
      * Define work field Limit Type
     C                     MOVEL*BLANK    WULMTY  3
      * Define work field Input field
     C                     MOVEL*BLANK    WUINPT  1
      * Define work field Invalid Limit Amount
     C                     MOVEL*BLANK    WUILAM  1
      * Define work field Invalid Frequency Day No
     C                     MOVEL*BLANK    WUIFQD  1
      * Define work field Invalid Expiry Date
     C                     MOVEL*BLANK    WUIEDT  1
      * Define work field Work Screen Date
     C                     Z-ADD*ZERO     WUWSDT  60
      * Define work field Invalid Review Date
     C                     MOVEL*BLANK    WUINRD  1
      * Define work field Invalid MDDR Amount
     C                     MOVEL*BLANK    WUIMDA  1
      * Define work field Work File Date
     C                     Z-ADD*ZERO     WUWFDT  50
      * Define work field Display second screen
     C                     MOVEL*BLANK    WUDSCR  1
      * Define work field Duplicate Return Code
     C                     MOVEL*BLANK    WUDRTC  7
      * Define work field Error found
     C                     MOVEL*BLANK    WUERFD  1
      * Define work field Window processing requir.
     C                     MOVEL*BLANK    WUWDPR  1
      * Define work field No. of Records
     C                     Z-ADD*ZERO     WUNORC  50
      * Define work field No. of Inserts
     C                     Z-ADD*ZERO     WUNOIN  50
      * Define work field No. of Amends
     C                     Z-ADD*ZERO     WUNOAM  50
      * Define work field No. of Deletes
     C                     Z-ADD*ZERO     WUNODL  50
      * Define work field Long Key
     C                     MOVEL*BLANK    WULKEY 50
      * Define work field Deleted Data Record Pt1
     C                     MOVEL*BLANK    WUDR01250
      * Define work field Deleted Data Record Pt2
     C                     MOVEL*BLANK    WUDR02250
      * Define work field Deleted Data Record Pt3
     C                     MOVEL*BLANK    WUDR03250
      * Define work field Deleted Data Record Pt4
     C                     MOVEL*BLANK    WUDR04250
      * Define work field Deleted Data Record Pt5
     C                     MOVEL*BLANK    WUDR05250
      * Define work field Deleted Data Record Pt6
     C                     MOVEL*BLANK    WUDR06250
      * Define work field Deleted Data Record Pt7
     C                     MOVEL*BLANK    WUDR07250
      * Define work field Deleted Data Record Pt8
     C                     MOVEL*BLANK    WUDR08250
      * Define work field Deleted Data Record Pt9
     C                     MOVEL*BLANK    WUDR09250
      * Define work field Deleted Data Record Pt10
     C                     MOVEL*BLANK    WUDR00250
      * Define work field Deleted Data Record Pt11
     C                     MOVEL*BLANK    WUDR11250
      * Define work field Deleted Data Record Pt12
     C                     MOVEL*BLANK    WUDR12250
      * Define work field Display S01433
     C                     MOVEL*BLANK    WUDSAR  1
      * Define work field Set Up Complete
     C                     MOVEL*BLANK    WUSUC   1
      * Define work field Standing data/Gen.Ledger
     C                     MOVEL*BLANK    WUSDGL  1
      * Define work field Dealing: FX
     C                     MOVEL*BLANK    WUDLFX  1
      * Define work field Syndicated Loans (REDUN)
     C                     MOVEL*BLANK    WUSYLN  1
      * Define work field Exposure Management
     C                     MOVEL*BLANK    WUEXMG  1
      * Define work field Customer Lending
     C                     MOVEL*BLANK    WUCSLN  1
      * Define work field Retail Banking
     C                     MOVEL*BLANK    WURTBN  1
      * Define work field Midas/Swift direct link
     C                     MOVEL*BLANK    WUMSDL  1
      * Define work field Securities
     C                     MOVEL*BLANK    WUSECS  1
      * Define work field Auto-reconciliations
     C                     MOVEL*BLANK    WUAURC  1
      * Define work field Funds Transfer
     C                     MOVEL*BLANK    WUFDTR  1
      * Define work field Futures & Options
     C                     MOVEL*BLANK    WUFUOP  1
      * Define work field Message Management
     C                     MOVEL*BLANK    WUNWMI  1
      * Define work field FRA/IRS Indicator
     C                     MOVEL*BLANK    WUFIIN  1
      * Define work field Dealing: MM
     C                     MOVEL*BLANK    WUDLMM  1
      * Define work field Treasury Management
     C                     MOVEL*BLANK    WUTRMG  1
      * Define work field Interest Risk Management
     C                     MOVEL*BLANK    WURKMG  1
      * Define work field Microfiche
     C                     MOVEL*BLANK    WUMFIC  1
      * Define work field Interest on accounts
     C                     MOVEL*BLANK    WUIOAC  1
      * Define work field Confirmation Matching
     C                     MOVEL*BLANK    WUCFMT  1
      * Define work field Report Control Facility
     C                     MOVEL*BLANK    WURCFI  1
      * Define work field Optical Disk
     C                     MOVEL*BLANK    WUOPDK  1
      * Define work field History & Audit Facility
     C                     MOVEL*BLANK    WUNUST  1
      * Define work field Midas Export Data Module
     C                     MOVEL*BLANK    WUNZST  1
      * Define work field SAR number field
     C                     MOVEL*BLANK    WUSARN  6
      * Define work field Access Pgm Return Code
     C                     MOVEL*BLANK    WUAPRC  7
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Open files
      * Begin commit control
     C                     CALL 'Y2BGCMC'
     C                     PARM           W0RTN   7
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'CPF8351'
     C                     EXSR ZYEXPG
     C                     END
      *                                                                   CGL011
      ** Access Switchable Features file and check if CGL011 is           CGL011
      ** switched on or not.                                              CGL011
      *                                                                   CGL011
     C                     CALL 'AOSARDR0'                                CGL011
     C                     PARM *BLANKS   PRTCD   7                       CGL011
     C                     PARM '*VERIFY' POTPN   7                       CGL011
     C                     PARM 'CGL011'  PSARD   6                       CGL011
     C           SCSARD    PARM SCSARD    DSFDY                           CGL011
      *                                                                   CGL011
      ** If CGL011 is installed, seton Indicator 70 to display            CGL011
      ** FX Limit Secured field on screen.                                CGL011
      *                                                                   CGL011
     C           PRTCD     IFEQ *BLANKS                                   CGL011
     C                     MOVE 'Y'       CGL011  1                       CGL011
     C                     MOVE *OFF      *IN70                           CGL011
     C                     ELSE                                           CGL011
     C                     MOVE 'N'       CGL011                          CGL011
     C                     MOVE *ON       *IN70                           CGL011
      *                                                                   CGL011
      ** Database Error, if Return Code is not blanks or *NRF             CGL011
      *                                                                   CGL011
     C           PRTCD     IFNE '*NRF   '                                 CGL011
     C           *LOCK     IN   LDA                                       CGL011
     C                     MOVEL'001'     DBASE            ***************CGL011
     C                     MOVEL'SCSARDPD'DBFILE           * DB ERROR 001*CGL011
     C                     MOVEL'CGL011'  DBKEY            ***************CGL011
     C                     OUT  LDA                                       CGL011
     C                     EXSR *PSSR                                     CGL011
     C                     ENDIF                                          CGL011
     C                     ENDIF                                          CGL011
      *                                                                   CGL011
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW02  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW03  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW04  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW05  50       *Synon (5,0) wo
     C                     MOVEL*BLANKS   YRSW06  1        *String work fi
     C                     MOVEL*BLANKS   YRSW07  1        *String work fi
     C                     MOVEL*BLANKS   YRSW08  7        *Return code
     C                     MOVEL*BLANKS   YRSW09  1        *String work fi
      * *Synon (9999) work field
     C                     MOVEL*BLANKS   YRSW0A           *Synon (9999) w
      * *Synon (9999) work field
     C                     MOVEL*BLANKS   YRSW0B           *Synon (9999) w
      * *Synon (9999) work field
     C                     MOVEL*BLANKS   YRSW0C           *Synon (9999) w
      * *Synon (9999) work field
     C                     MOVEL*BLANKS   YRSW0D           *Synon (9999) w
     C                     MOVEL*BLANKS   YRSW0E  1        *String work fi
     C                     MOVEL*BLANKS   YRSW0F  1        *String work fi
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C/COPY WNCPYSRC,SD0451RC32
     C                     OPEN SD0451R#
     C                     OPEN SDCLLML1
     C                     OPEN SDCUSTL1
     C                     OPEN SDLIMTL0
     C                     OPEN SDMMODL1
     C                     OPEN SDCLLML0
     C                     OPEN SDFCTLL0
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
     C                     MOVEL'CHG'     W0PMD   3
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * Start of S01459
      * Remove creation parameters user source.
      * Remove last amend box user source.
      * SD0451R precompiler - Client Limits  *
      * End of S01459
      * Copyright Statement 1988 - Standard Functions  *
      * Get Rundate - Rundate  *
     C           *NAMVAR   DEFN           RUNDAT
     C                     IN   RUNDAT
     C                     MOVE MRDT      ##MRDT  7        RUN DATE
     C                     MOVE MRDT      WUMRDT
     C                     MOVE RDNB      WURDNB           RUNDAY NO.
     C                     MOVE SUC       WUSUC            SET UP COMPLT
     C                     MOVE DFF       WUDFF            DTE FMT FLAG
     C                     MOVE MBIN      WUMBIN           MULTI BR. IND
      * Start of S01433
      * Displaying the second screen depends on
      * Customer lending module and /or
      * Precious Metal (switchable feature) is ON.
     C                     MOVEL'N'       WUDSCR           Display second
      * Check Customer lending
      * get practically everythin - MIDAS Modules  *
     C                     EXSR SJRVGN
      * Check SAR S01433 exists
     C                     MOVEL'N'       WUSARF           SAR S01433
     C                     MOVEL'N'       WUDSAR           Display S01433
     C                     MOVEL'S01433'  WUSARN           SAR number fiel
     C                     MOVEL*BLANK    WUAPRC           Access Pgm Retu
      * SAR switched on check - Standard Functions  *
     C                     CALL 'AOSARDR0'             90  SAR switched on
     C           WUAPRC    PARM WUAPRC    WQ0299  7        Access Pgm Retu
     C                     PARM '*VERIFY' WQ0300  7        Option for ACCO
     C           WUSARN    PARM WUSARN    WQ0301  6        SAR number fiel
     C                     PARM *BLANK    WQ0302 76        Access obj dumm
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'AOSARDR0'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Check return code
      * CASE: WRK.Access Pgm Return Code is AP No Record Found
     C           WUAPRC    IFEQ '*NRF'                     *IF
     C                     MOVEL'N'       WUSARF           SAR S01433
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUSARF           SAR S01433
     C                     END                             *FI
      * Start of 107583
      * Displaying the second screen shouldn't depend on 'Customer Lendin
      * Display second screen?
      * CASE: WRK.SAR S01433 is Present
     C           WUSARF    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUDSCR           Display second
     C                     MOVEL'Y'       WUDSAR           Display S01433
     C                     ELSE
      * CASE: WRK.Dealing: MM is Yes
     C           WUDLMM    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUDSCR           Display second
     C                     END                             *FI
     C                     END                             *FI
      * End of 107583
      * End of S01433
      * CASE: PAR.Action Code is Insert
     C           P4ANCD    IFEQ 'I'                        *IF
     C                     MOVEL'ADD'     W0PMD            *Program mode
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'CHG'     W0PMD            *Program mode
     C                     END                             *FI
     C                     MOVEL'Y'       WUMFTS           S01212
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * Get 'Window required' ind - MIDAS Modules  *
     C                     EXSR SKRVGN
      * SDCLLM Data Structure - Client Limits  *
      * 00/Copy Member SD0451RIPG - Client Limits  *
     C/COPY WNCPYSRC,SD0451RCPG
     C                     END                             *FI
     C/COPY WNCPYSRC,SD0451RC35
      *================================================================
     CSR         ZZEXIT    ENDSR
      /EJECT
     CSR         *PSSR     BEGSR
      *****************************************************************
      *                                                               *
      * *PSSR  - Program exception error routine                      *
      *          Called automatically if a program error occurs,      *
      *          or directly by the program code using EXSR.          *
      *          This subroutine DUMPs the program just once.         *
      *                                                               *
      *****************************************************************
      *
      * Core function specific processing.
      *
     C/COPY WNCPYSRC,SD0451RPSC
      *
      * Start of PSSR user point.
      *
     C/COPY WNCPYSRC,SD0451RPS1
      *
      * Standard Midas PSSR processing.
      *
     C/COPY SDCPYSRC,SDPSSRINT
      *
      * End of PSSR user point.
      *
     C/COPY WNCPYSRC,SD0451RPS2
      *
      *================================================================
     CSR                   ENDSR
      *================================================================
     O/COPY WNCPYSRC,SD0451ROPG
** CPY@     : Copyright notice for inclusion in all programs
(c) Finastra International Limited 2001
** @CN
00001         0
