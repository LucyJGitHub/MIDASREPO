     H            Y
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas Edit Country Limits  Edit record')               *
     H/TITLE Midas SD Edit Country Limits
     Z* CRTRPGPGM
      *
     H* SYNOPSIS :
     H* - Maintain DBF file records, one at a time.
     H* - Existing records may be updated or deleted.
     H* - New records may be added.
     H* - Key changes are not allowed.
     H* Generated by  : Synon/2  Version:  8646
     H* Function type : Edit record(1 screen)  Version:   0.1
      *
     H*  Company :
     H*  System  : Midas Standing Data
     H* User name  : F7387SY
     H* Date       : 02/10/90 time: 09:55:01
      *  (c) Misys International Banking Systems Ltd. 2001            *
     H*
      *================================================================
     M* Maintenance   :
      *================================================================
     F********************************************************************
     F*  P R O G R A M     C R E A T I O N     P A R A M E T E R S    *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     F********************************************************************
     F*                                                                  *
      *  Last Amend No. CER059             Date 19Jul10               *
      *  Prev Amend No. CER045             Date 20Jul09               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 BHF718             Date 01Oct90               *
     F*                   LN0554               DATE 03AUG90              *
     F*                   S01117               DATE 03AUG90              *
     F*                   S01212               DATE 14SEP89              *
     F*                                                                  *
     F********************************************************************
     F*                                                                  *
      *  CER059 - German Feature Upgrade to Delhi                     *
     F*    CER045 - German Features - Reporting Bundesbank (Recompile)   *
     F*    BHF718 - ADD COUNTRY NAME TO SCREEN                           *
     F*    LN0554 - RECOMPILE OVER NEW DISPLAY FILE                      *
     F*    S01117 - RELEASE 10 ENHANCEMENTS                              *
     F*    S01212 - /COPY AND WINDOW PROCESSING                          *
     F*                                                                  *
     F********************************************************************
     F/COPY WNCPYSRC,SD0471RFPG
     FSD0471R#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: Midas SD Edit Country Limits
      *
     FSDCNLML1IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RTV: Country Limits            Retrieval index
      *
     FSDCTRYL1IF  E           K        DISK
      * RTV: Country Codes             Retrieval index
      *
     FSDLIMTL0IF  E           K        DISK
      * RTV: Limit types               Retrieval index
      *
     FSDMMODL1IF  E           K        DISK
      * RTV: MIDAS Modules             Retrieval index
      *
     FSDCNLML0UF  E           K        DISK                      A    UC
     F                                              KCOMIT
      * UPD: Country Limits            Update index
      *
     FSDFCTLL0UF  E           K        DISK                           UC
     F                                              KCOMIT
      * UPD: Standing Data Controls    Update index
      *
     E                    AENA    1   3 78
     E*
     E*  DETAIL LINE COMMAND KEY TEXT
     E*
     E* Description     : Copyright notice for inclusion in all programs
     E*
     E********************************************************************
     E                    CPY@    1   1 80               Copyright     array
     E/COPY WNCPYSRC,SD0471REPG
     E                    @CN     1  34 25               Long constants.
     I*
     I* Description     : Copyright notice for inclusion in all programs
     I*
     I/COPY QWINDSRC,SD0470GDTA
     I*00/Copy Member SD0471R   Initialise Program I-spec
     I/COPY WNCPYSRC,SD0471RIPG
      /EJECT
      * Data structures:-
     IPGMDS     ESDSY2PGDSP
      * Program data structure.
     IJBDTTM      DS
      * Job date/time.
     I                                        1   60##JDT
     I                                        1   20##JYY
     I                                        3   40##JMM
     I                                        5   60##JDD
     I                                        7  120##JTM
     I                                        7   80##JHH
     I                                        9  100##JNN
     I                                       11  120##JSS
     IINFDS#    E DSY2I#DSP
      * Display file data structure.
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure.
      *
     I@1DBRC    E DSSDCNLML0
      * Current/previous master file format fields for change control.
      *
     I#1DBRC      DS                             72
      * Stored master file format fields.
     I                                        1   1 #1DB1
      *
     IA@CPY       DS
     I* Copyright array
     I                                        1  80 CPY@
     IRUNDAT      DS
     I                                        1   7 MRDT
     I                                    P   8  100RDNB
     I                                       11  11 SUC
     I                                       12  12 DFF
     I                                       13  13 MBIN
      /EJECT
      * Parameter declarations.
     IP1PARM      DS
      * I:MAP Country Code
     I                                        1   2 P1CNCD
     IP2PARM      DS
      * I:MAP Level
     I                                        1   1 P2LEVL
     IP3PARM      DS
      * I:MAP Branch/Company Code
     I                                        1   3 P3BCCD
     IP4PARM      DS
      * I:MAP Action Code
     I                                        1   1 P4ANCD
     IP5PARM      DS
      * O:MAP Duplicate Return Code
     I                                        1   7 P5DRTC
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'FX Limit Type Required'
      * FX Limit Type
     I                                        1   3 ZA0001
      * Message data for 'FX Limit Type Required'
      * FX Limit Type
     I                                        1   3 ZA0002
      * Message data for 'FX Limit Type Required'
      * FX Limit Type
     I                                        1   3 ZA0003
      * Message data for 'FX Limit Type Required'
      * FX Limit Type
     I                                        1   3 ZA0004
      * Message data for 'FX Limit Type Required'
      * FX Limit Type
     I                                        1   3 ZA0005
      * Message data for 'FX Limit Type Required'
      * FX Limit Type
     I                                        1   3 ZA0006
      * Message data for 'Lending Limit Type Req'
      * Lending Limit Type
     I                                        1   3 ZA0007
      * Message data for 'Lending Limit Type Req'
      * Lending Limit Type
     I                                        1   3 ZA0008
      * Message data for 'Lending Limit Type Req'
      * Lending Limit Type
     I                                        1   3 ZA0009
      * Message data for 'Lending Limit Type Req'
      * Lending Limit Type
     I                                        1   3 ZA0010
      * Message data for 'Lending Limit Type Req'
      * Lending Limit Type
     I                                        1   3 ZA0011
      * Message data for 'Lending Limit Type Req'
      * Lending Limit Type
     I                                        1   3 ZA0012
      * Message data for 'FRA Limit Amount Required'
      * FRA Limit Amount Scrn DS
     I                                        1   9 ZA0013
      * Message data for 'FRA Limit Amount Required'
      * FRA Limit Amount Scrn DS
     I                                        1   9 ZA0014
      * Message data for 'FRA Limit Amount Required'
      * FRA Limit Amount Scrn DS
     I                                        1   9 ZA0015
      * Message data for 'FRA Limit Amount Required'
      * FRA Limit Amount Scrn DS
     I                                        1   9 ZA0016
      * Message data for 'IRS Limit Amount Required'
      * IRS Limit Amount Scrn DS
     I                                        1   9 ZA0017
      * Message data for 'IRS Limit Amount Required'
      * IRS Limit Amount Scrn DS
     I                                        1   9 ZA0018
      * Message data for 'IRS Limit Amount Required'
      * IRS Limit Amount Scrn DS
     I                                        1   9 ZA0019
      * Message data for 'IRS Limit Amount Required'
      * IRS Limit Amount Scrn DS
     I                                        1   9 ZA0020
      * Message data for 'FX Limit Amount Required'
      * FX Limit Amount Screen DS
     I                                        1   9 ZA0021
      * Message data for 'Limit Amount Not Numeric'
      * FX Limit Amount Screen DS
     I                                        1   9 ZA0022
      * Message data for 'FX Limit Amount GT Zero'
      * FX Limit Amount Screen DS
     I                                        1   9 ZA0023
      * Message data for 'Expiry Date Numeric'
      * FX Expiry Date Screen DS
     I                                        1   6 ZA0024
      * Message data for 'FX Expiry Date is Invalid'
      * FX Expiry Date Screen DS
     I                                        1   6 ZA0025
      * Message data for 'Forex Expiry Date must be'
      * FX Expiry Date Screen DS
     I                                        1   6 ZA0026
      * Midas Run Date
     I                                        7  13 ZA0027
      * Message data for 'Review Date Numeric'
      * FX Review Date Screen DS
     I                                        1   6 ZA0028
      * Message data for 'FX Review Date is Invalid'
      * FX Review Date Screen DS
     I                                        1   6 ZA0029
      * Message data for 'FX Rev Date after Rundat'
      * FX Review Date Screen DS
     I                                        1   6 ZA0030
      * Midas Run Date
     I                                        7  13 ZA0031
      * Message data for 'FX Expiry Date Required'
      * FX Expiry Date Screen DS
     I                                        1   6 ZA0032
      * Message data for 'Fx Rev Date Aft Exp Date'
      * FX Review Date Screen DS
     I                                        1   6 ZA0033
      * Message data for 'FX Limit Freq Required'
      * FX Limit Frequency
     I                                        1   1 ZA0034
      * Message data for 'FX Limit Freq Blank'
      * FX Limit Frequency
     I                                        1   1 ZA0035
      * Message data for 'FX Limit Frequency inval'
      * FX Limit Frequency
     I                                        1   1 ZA0036
      * Message data for 'Freq Day Num Must Numeric'
      * FX Freq Day Number DS
     I                                        1   2 ZA0037
      * Message data for 'Frequency Day No. Req'
      * FX Freq Day Number DS
     I                                        1   2 ZA0038
      * Message data for 'FX Frequency Day No. Inv'
      * FX Freq Day Number DS
     I                                        1   2 ZA0039
      * Message data for 'FX Frequency Day No. Inv'
      * FX Freq Day Number DS
     I                                        1   2 ZA0040
      * Message data for 'FX Freq Day no - Blank'
      * FX Freq Day Number DS
     I                                        1   2 ZA0041
      * Message data for 'MDDR Amount must Numeric'
      * MDDR Amount Screen
     I                                        1   9 ZA0042
      * Message data for 'FX MDDR Amount invalid'
      * MDDR Amount Screen
     I                                        1   9 ZA0043
      * Message data for 'FX MDDR Amount invalid'
      * MDDR Amount Screen
     I                                        1   9 ZA0044
      * Message data for 'MDDR amount is required'
      * MDDR Amount Screen
     I                                        1   9 ZA0045
      * Message data for 'Lending Limit Amt Req'
      * LN Limit Amount Screen DS
     I                                        1   9 ZA0046
      * Message data for 'Limit Amount Not Numeric'
      * LN Limit Amount Screen DS
     I                                        1   9 ZA0047
      * Message data for 'LN Limit Amount GT Zero'
      * LN Limit Amount Screen DS
     I                                        1   9 ZA0048
      * Message data for 'Expiry Date Numeric'
      * LN Expiry Date Screen DS
     I                                        1   6 ZA0049
      * Message data for 'LN Expiry Date is Invalid'
      * LN Expiry Date Screen DS
     I                                        1   6 ZA0050
      * Message data for 'LN Exp Date After Rundat'
      * LN Expiry Date Screen DS
     I                                        1   6 ZA0051
      * Midas Run Date
     I                                        7  13 ZA0052
      * Message data for 'Review Date Numeric'
      * LN Review Date Screen DS
     I                                        1   6 ZA0053
      * Message data for 'LN Review Date is Invalid'
      * LN Review Date Screen DS
     I                                        1   6 ZA0054
      * Message data for 'LN Rev Date after Rundat'
      * LN Review Date Screen DS
     I                                        1   6 ZA0055
      * Midas Run Date
     I                                        7  13 ZA0056
      * Message data for 'LN Expiry Date Required'
      * LN Expiry Date Screen DS
     I                                        1   6 ZA0057
      * Message data for 'LN Rev Date bef Exp Date'
      * LN Review Date Screen DS
     I                                        1   6 ZA0058
      * Message data for 'LN Limit Freq Required'
      * Lending Limit Frequency
     I                                        1   1 ZA0059
      * Message data for 'LN Limit Freq Blank'
      * Lending Limit Frequency
     I                                        1   1 ZA0060
      * Message data for 'LN Limit Freq Invalid'
      * Lending Limit Frequency
     I                                        1   1 ZA0061
      * Message data for 'Freq Day Num Must Numeric'
      * LN Freq Day Number DS
     I                                        1   2 ZA0062
      * Message data for 'LN Freq Day No Required'
      * LN Freq Day Number DS
     I                                        1   2 ZA0063
      * Message data for 'LN Freq Day No Invalid'
      * LN Freq Day Number DS
     I                                        1   2 ZA0064
      * Message data for 'LN Freq Day No Invalid'
      * LN Freq Day Number DS
     I                                        1   2 ZA0065
      * Message data for 'LN Freq Day No - Blank'
      * LN Freq Day Number DS
     I                                        1   2 ZA0066
      * Message data for 'LN Secured is Invalid'
      * Secured
     I                                        1   1 ZA0067
      * Message data for 'Limit Amount Not Numeric'
      * FRA Limit Amount Scrn DS
     I                                        1   9 ZA0068
      * Message data for 'FRA Limit Amount GT Zero'
      * FRA Limit Amount Scrn DS
     I                                        1   9 ZA0069
      * Message data for 'Expiry Date Numeric'
      * FRA Expiry Date Screen DS
     I                                        1   6 ZA0070
      * Message data for 'FRA Expiry Date invalid'
      * FRA Expiry Date Screen DS
     I                                        1   6 ZA0071
      * Message data for 'FRA Exp Date not gt rundt'
      * FRA Expiry Date Screen DS
     I                                        1   6 ZA0072
      * Midas Run Date
     I                                        7  13 ZA0073
      * Message data for 'Review Date Numeric'
      * FRA Review Date Screen DS
     I                                        1   6 ZA0074
      * Message data for 'FRA Review date invalid'
      * FRA Review Date Screen DS
     I                                        1   6 ZA0075
      * Message data for 'FRA Rev Date after Rundat'
      * FRA Review Date Screen DS
     I                                        1   6 ZA0076
      * Midas Run Date
     I                                        7  13 ZA0077
      * Message data for 'FRA Expiry Date Required'
      * FRA Expiry Date Screen DS
     I                                        1   6 ZA0078
      * Message data for 'fra r dat GT fra ex dat'
      * FRA Review Date Screen DS
     I                                        1   6 ZA0079
      * Message data for 'FRA Review Freq Required'
      * FRA Review Frequency
     I                                        1   1 ZA0080
      * Message data for 'FRA Rev Freq Should Blank'
      * FRA Review Frequency
     I                                        1   1 ZA0081
      * Message data for 'FRA Review Freq Invalid'
      * FRA Review Frequency
     I                                        1   1 ZA0082
      * Message data for 'Freq Day Num Must Numeric'
      * FRA Freq Day Number DS
     I                                        1   2 ZA0083
      * Message data for 'FRA Freq Day Num Required'
      * FRA Freq Day Number DS
     I                                        1   2 ZA0084
      * Message data for 'FRA Freq Day No Invalid'
      * FRA Freq Day Number DS
     I                                        1   2 ZA0085
      * Message data for 'FRA Freq Day No Invalid'
      * FRA Freq Day Number DS
     I                                        1   2 ZA0086
      * Message data for 'FRA Freq Day No Blank'
      * FRA Freq Day Number DS
     I                                        1   2 ZA0087
      * Message data for 'Limit Amount Not Numeric'
      * IRS Limit Amount Scrn DS
     I                                        1   9 ZA0088
      * Message data for 'IRS Limit Amount GT Zero'
      * IRS Limit Amount Scrn DS
     I                                        1   9 ZA0089
      * Message data for 'Expiry Date Numeric'
      * IRS Expiry Date Screen DS
     I                                        1   6 ZA0090
      * Message data for 'IRS Expiry Date Invalid'
      * IRS Expiry Date Screen DS
     I                                        1   6 ZA0091
      * Message data for 'IRS Exp dat LE rundat'
      * IRS Expiry Date Screen DS
     I                                        1   6 ZA0092
      * Midas Run Date
     I                                        7  13 ZA0093
      * Message data for 'Review Date Numeric'
      * IRS Review Date Screen DS
     I                                        1   6 ZA0094
      * Message data for 'IRS Review Date Invalid'
      * IRS Review Date Screen DS
     I                                        1   6 ZA0095
      * Message data for 'IRS Rev Date after Rundat'
      * IRS Review Date Screen DS
     I                                        1   6 ZA0096
      * Midas Run Date
     I                                        7  13 ZA0097
      * Message data for 'IRS Expiry Date Required'
      * IRS Expiry Date Screen DS
     I                                        1   6 ZA0098
      * Message data for 'IRS Rev dat GT IRS Ex Dat'
      * IRS Review Date Screen DS
     I                                        1   6 ZA0099
      * Message data for 'IRS Review Freq Required'
      * IRS Review Frequency
     I                                        1   1 ZA0100
      * Message data for 'IRS Rev Frq must be Blank'
      * IRS Review Frequency
     I                                        1   1 ZA0101
      * Message data for 'IRS Review Freq Invalid'
      * IRS Review Frequency
     I                                        1   1 ZA0102
      * Message data for 'Freq Day Num Must Numeric'
      * IRS Freq Day Number DS
     I                                        1   2 ZA0103
      * Message data for 'IRS Freq Day no Required'
      * IRS Freq Day Number DS
     I                                        1   2 ZA0104
      * Message data for 'IRS Freq Day No Invalid'
      * IRS Freq Day Number DS
     I                                        1   2 ZA0105
      * Message data for 'IRS Freq Day No Invalid'
      * IRS Freq Day Number DS
     I                                        1   2 ZA0106
      * Message data for 'IRS Freq Day no must blnk'
      * IRS Freq Day Number DS
     I                                        1   2 ZA0107
      /EJECT
      *****************************************************************
     C           *ENTRY    PLIST                           Entry parameter
     C                     PARM           P0RTN   7        Return code
     C           P1CNCD    PARM           WP0001  2        Country Code
     C           P2LEVL    PARM           WP0002  1        Level
     C           P3BCCD    PARM           WP0003  3        Branch/Company
     C           P4ANCD    PARM           WP0004  1        Action Code
     C           P5DRTC    PARM P5DRTC    WP0005  7        Duplicate Retur
      *****************************************************************
      * Initialise
     C                     EXSR ZZINIT
      *
      * Check passed parameters.
     C                     EXSR FACKPM
      * Perform once if all passed, else repeat.
     C           W0RPT     DOUEQ'N'
      * Display and process key screen.
     C                     EXSR BADSKY
     C                     END
      * Terminate program.
     C                     EXSR ZXEXPG
      *****************************************************************
      /EJECT
     CSR         BADSKY    BEGSR
      *================================================================
      * Display and process key screen.
      *================================================================
      * Initialise key screen
     C                     EXSR MDIZ#K
      * Bypass first display of key screen is possible.
     C                     MOVEL'Y'       W0BYP   1
      * Signal start of transaction.
     C                     MOVEL'Y'       W0TRN   1
     C           W0TRN     DOWEQ'Y'
     C           W0TRN     OREQ 'R'
      * Ensure transaction continues (if reset).
     C                     MOVEL'Y'       W0TRN   1
      * Initialise detail screen.
     C                     EXSR MAIZ#1
      * Conduct screen conversation:
     C           W0TRN     DOWEQ'Y'
      * Is bypass key screen still viable?
     C           W0BYP     IFEQ 'Y'
     C           #1CNCD    IFEQ *BLANK                     Country Code
     C           #1LEVL    OREQ *BLANK                     Level
     C           #1BCCD    OREQ *BLANK                     Branch/Company
      * One or more key field is blank.
     C                     MOVEL'N'       W0BYP
     C                     END
     C                     END
      * Bypass key screen.
     C           W0BYP     IFNE 'Y'
      * Display key screen.
     C                     EXSR BBEXFM
     C                     END
      * Cancel key screen bypass.
     C                     MOVEL'N'       W0BYP
      * Process response to key screen:
      * Cancel & exit program.
     C   03                CAS            ZXEXPG
      * Switch between *ADD/*CHANGE modes.
     C   09                CAS            BCCHMD
      * HOME: Reset screen fields.
     C   05                CAS            BDHMKY
      * Process key screen input.
     C                     CAS            BEPRKY
     C                     END
      *
     C                     END
     C                     END
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBEXFM    BEGSR
      *================================================================
      * Display key screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators.
     C                     EXSR GADSAK
      * Update screen time.
     C                     TIME           ##TME            Screen time.
     C           W0HLP     DOUEQ'N'
      * PUTOVR unless conditioned fields change.
     C                     SETON                         86*
     C           *IN89     IFNE BBIN89
     C                     SETOF                         86*
     C                     END
     C                     MOVE *IN89     BBIN89  1
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDKEY
     C                     MOVEL'N'       W0HLP   1        Reset help requ
      * If help requested, display help text.
     C   25                EXSR ZHHPKY                     Display help te
     C                     END
      * Update job time.
     C                     TIME           ##JTM            Job time.
      * Clear messages from program message queue.
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGM  10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag.
     C                     MOVEL'Y'       ZAFSMS  1
      * Reset global error indicator.
     C                     SETOF                         99*
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         BCCHMD    BEGSR
      *================================================================
      * Switch between ADD and CHANGE modes.
      *================================================================
     C           W0PMD     IFEQ 'ADD'
     C                     MOVEL'CHG'     W0PMD   3
     C                     ELSE
     C                     MOVEL'ADD'     W0PMD
     C                     END
      *================================================================
     CSR         BCEXIT    ENDSR
      /EJECT
     CSR         BDHMKY    BEGSR
      *================================================================
      * Process HOME key
      *================================================================
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         BDEXIT    ENDSR
      /EJECT
     CSR         BEPRKY    BEGSR
      *================================================================
      * Process key screen.
      *================================================================
      * Validate key fields.
     C                     EXSR BFVLKY
     C           *IN99     CABEQ'1'       BEEXIT
      * Check for existing record.
     C           KRTV      KLIST
     C                     KFLD           DXCNCD           Country Code
     C                     KFLD           DXLEVL           Level
     C                     KFLD           DXBCCD           Branch/Company
      * Setup key.
     C                     MOVEL#1CNCD    DXCNCD           Country Code
     C                     MOVEL#1LEVL    DXLEVL           Level
     C                     MOVEL#1BCCD    DXBCCD           Branch/Company
     C           KRTV      CHAIN@DXREHN              9091  *
     C           *IN91     IFEQ '1'
      * Record locked.
     C                     SETON                     993132*
     C                     SETON                     33    *
     C                     GOTO BEEXIT
     C                     END                             FI 91
      *
      * Verify record existance against program mode
     C           W0PMD     IFNE 'ADD'
      * If record does not exist, error
     C           *IN90     IFEQ '1'
     C                     SETON                     993132*
     C                     SETON                     33    *
      * Send message 'Country Limits         NF'
     C                     MOVEL'USR0661' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     ELSE
     C                     EXSR MBFL#1
      * CALC: Detail screen function fields
      *CASE:     WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ @CN,01                     *IF
      * 00/Copy Member SD0471RSFF - Country Limits  *
     C*00/Copy Member SD0471R   Calc Detail Function Flds
     C/COPY WNCPYSRC,SD0471RSFF
     C                     END                             *FI
      * USER: Initialise detail screen (existing record)
      * Start of Fix BHF718
      * Get Country Code Name - Country Codes  *
     C                     EXSR SARVGN
     C                     MOVELWUCNNM    #DFLDT           Field Text
      * End of Fix BHF718
      * Set-up DTL Screen Footer - Standard Functions  *
     C*
     C*  If Action Code is Delete :
     C*
     C           P4ANCD    IFEQ 'D'                                       S01229
     C                     MOVEAAENA,1    ##CTX1                          S01229
     C                     END
     C*
     C*  If Action Code is Insert :
     C*
     C           P4ANCD    IFEQ 'I'                                       S01229
     C                     MOVEAAENA,2    ##CTX1                          S01229
     C                     END
     C*
     C*  If Action Code is Amend :
     C*
     C           P4ANCD    IFEQ 'A'                                       S01229
     C                     MOVEAAENA,3    ##CTX1                          S01229
     C                     END
     C*
      * Display Level and Branch/Company Code ?
      *CASE:     WRK.Multi-branching Indicator is Multi-branched
     C           WUMBIN    IFEQ @CN,01                     *IF
      * Only if level is not system
      *CASE:     DTL.Branch/Company Code is Is System
     C           #1BCCD    IFEQ @CN,02                     *IF
     C                     MOVEL@CN,03    WUDLBC           Display Level &
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL@CN,01    WUDLBC           Display Level &
     C                     END                             *FI
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL@CN,03    WUDLBC           Display Level &
     C                     END                             *FI
      * Convert all file dates to screen dates
     C                     EXSR UASUBR                     Convert all fil
      * Convert all file amounts to function fields
     C                     EXSR UBSUBR                     Convert all fil
      *CASE:     WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ @CN,01                     *IF
      * 00/Copy Member SD0471RISE - Country Limits  *
     C*00/Copy Member SD0471R   Initialise Dtl Exist Rcd
     C/COPY WNCPYSRC,SD0471RISE
     C                     END                             *FI
     C                     END
      *
     C                     ELSE
      * If record already exists, error
     C           *IN90     IFEQ '0'
     C                     SETON                     993132*
     C                     SETON                     33    *
      * Send message 'Country Limits         EX'
     C                     MOVEL'USR0662' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     ELSE
      * USER: Initialise detail screen (new record)
      * Start of Fix BHF718
      * Get Country Code Name - Country Codes  *
     C                     EXSR SBRVGN
     C                     MOVELWUCNNM    #DFLDT           Field Text
      * End of Fix BHF718
      * Set-up DTL Screen Footer - Standard Functions  *
     C*
     C*  If Action Code is Delete :
     C*
     C           P4ANCD    IFEQ 'D'                                       S01229
     C                     MOVEAAENA,1    ##CTX1                          S01229
     C                     END
     C*
     C*  If Action Code is Insert :
     C*
     C           P4ANCD    IFEQ 'I'                                       S01229
     C                     MOVEAAENA,2    ##CTX1                          S01229
     C                     END
     C*
     C*  If Action Code is Amend :
     C*
     C           P4ANCD    IFEQ 'A'                                       S01229
     C                     MOVEAAENA,3    ##CTX1                          S01229
     C                     END
     C*
      * Display Level and Branch/Company Code ?
      *CASE:     WRK.Multi-branching Indicator is Multi-branched
     C           WUMBIN    IFEQ @CN,01                     *IF
      * Only if level is not system
      *CASE:     DTL.Branch/Company Code is Is System
     C           #1BCCD    IFEQ @CN,02                     *IF
     C                     MOVEL@CN,03    WUDLBC           Display Level &
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL@CN,01    WUDLBC           Display Level &
     C                     END                             *FI
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL@CN,03    WUDLBC           Display Level &
     C                     END                             *FI
      *CASE:     WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ @CN,01                     *IF
      * 00/Copy Member SD0471RISN - Country Limits  *
     C*00/Copy Member SD0471R   Initialise Dtl New Rcd
     C/COPY WNCPYSRC,SD0471RISN
     C                     END                             *FI
     C                     END
     C                     END
      *.................................................
     C   99                GOTO BEEXIT
      * No errors: Display and process details
     C                     EXSR CADSDA
      *
      *================================================================
     CSR         BEEXIT    ENDSR
      /EJECT
     CSR         BFVLKY    BEGSR
      *================================================================
      * Validate key fields.
      *================================================================
     C           W0PMD     IFNE 'ADD'
      * Select existing record.
     C                     EXSR VACKRL
     C                     END
      * Check relations.
      * Check reference to Country Codes.
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * USER: Validate key screen
      *CASE:     WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ @CN,01                     *IF
      * 00/Copy Member SD0471RVKS - Country Limits  *
     C*00/Copy Member SD0471R   Validate Key Screen
     C/COPY WNCPYSRC,SD0471RVKS
     C                     END                             *FI
      * Country Code required.
     C           #1CNCD    IFEQ *BLANK                     IF
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID           Message id.
     C                     MOVEL'Y2USRMSG'ZAMSGF           Message file.
     C                     EXSR ZASNMS                     Send message
     C                     END                             FI
      * Level required.
     C           #1LEVL    IFEQ *BLANK                     IF
     C                     SETON                     9932  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID           Message id.
     C                     MOVEL'Y2USRMSG'ZAMSGF           Message file.
     C                     EXSR ZASNMS                     Send message
     C                     END                             FI
      * Branch/Company Code required.
     C           #1BCCD    IFEQ *BLANK                     IF
     C                     SETON                     9933  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID           Message id.
     C                     MOVEL'Y2USRMSG'ZAMSGF           Message file.
     C                     EXSR ZASNMS                     Send message
     C                     END                             FI
      *================================================================
     CSR         BFEXIT    ENDSR
      /EJECT
     CSR         CADSDA    BEGSR
      *================================================================
      * Display and process details.
      *================================================================
      * Conduct detail screen conversation:
      * - repeat until screen control flag is reset:
     C           W0TRN     DOWEQ'Y'
      * Display detail screen.
     C                     EXSR CBEXFM
      * Process response to detail screen:
      * Cancel & exit program.
     C   03                CAS            ZXEXPG
      * Redisplay previous screen
     C   12                CAS            CCDSPV
      * Process detail screen input.
     C                     CAS            CFPRSC
     C                     END
      *
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         CBEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests.
      *================================================================
      * Set screen conditioning indicators.
     C                     EXSR GBDSAD
      * Update screen time.
     C                     TIME           ##TME            Screen time.
     C           W0HLP     DOUEQ'N'
      * PUTOVR unless conditioned fields change.
     C                     SETON                         86*
     C           *IN89     IFNE CBIN89
     C                     SETOF                         86*
     C                     END
     C                     MOVE *IN89     CBIN89  1
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT2
     C                     EXFMT#RCDDTL1
     C                     MOVEL'N'       W0HLP   1        Reset help requ
      * If help requested, display help text.
     C   25                EXSR ZHHPKY                     Display help te
     C                     END
      * Update job time.
     C                     TIME           ##JTM            Job time.
      * Clear messages from program message queue.
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGM  10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag.
     C                     MOVEL'Y'       ZAFSMS  1
      * Reset global error indicator.
     C                     SETOF                         99*
      *================================================================
     CSR         CBEXIT    ENDSR
      /EJECT
     CSR         CCDSPV    BEGSR
      *================================================================
      * Redisplay previous screen.
      *================================================================
      * USER: Process key screen request
      *CASE:     WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ @CN,01                     *IF
      * 00/Copy Member SD0471RPKR - Country Limits  *
     C*00/Copy Member SD0471R   Process Key Screen Rqst
     C/COPY WNCPYSRC,SD0471RPKR
     C                     END                             *FI
     C                     MOVEL@CN,05    P5DRTC           Duplicate Retur
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     MOVEL'R'       W0TRN
      *================================================================
     CSR         CCEXIT    ENDSR
      /EJECT
     CSR         CFPRSC    BEGSR
      *================================================================
      * Validate record.
      *================================================================
      * Confirm/update is not defered.
     C                     MOVEL'N'       W0DCF   1
      * If delete is not pending....
      * Validate details.
     C  N10                CAS            DCVLDL
     C                     END
      * Quit if error:
     C   99                GOTO CFEXIT
      * Defer confirm/update requested:
     C           W0DCF     CABEQ'Y'       CFEXIT
      * No error: Update record:
     C                     EXSR EBPR##
      *================================================================
     CSR         CFEXIT    ENDSR
      /EJECT
     CSR         DCVLDL    BEGSR
      *================================================================
      * Validate details.
      *================================================================
      * Validate FX Limit Frequency
      * Name search required ?
     C                     MOVEL#1FLFQ    W0NSRQ  1        FX Limit Freque
     C           W0NSRQ    IFEQ '?'                        Search required
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7        Return code
     C                     PARM 1101038   Y2LSNO  70       List number.
     C           #1FLFQ    PARM #1FLFQ    W0EXVL 20        FX Limit Freque
     C                     MOVEL'Y'       W0DCF   1        Defer confirm
     C                     END
      * Validate Lending Limit Frequency
      * Name search required ?
     C                     MOVEL#1LLFR    W0NSRQ  1        Lending Limit F
     C           W0NSRQ    IFEQ '?'                        Search required
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7        Return code
     C                     PARM 1101038   Y2LSNO  70       List number.
     C           #1LLFR    PARM #1LLFR    W0EXVL 20        Lending Limit F
     C                     MOVEL'Y'       W0DCF   1        Defer confirm
     C                     END
      * Validate FRA Review Frequency
      * Name search required ?
     C                     MOVEL#1FRFQ    W0NSRQ  1        FRA Review Freq
     C           W0NSRQ    IFEQ '?'                        Search required
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7        Return code
     C                     PARM 1101038   Y2LSNO  70       List number.
     C           #1FRFQ    PARM #1FRFQ    W0EXVL 20        FRA Review Freq
     C                     MOVEL'Y'       W0DCF   1        Defer confirm
     C                     END
      * Validate IRS Review Frequency
      * Name search required ?
     C                     MOVEL#1IRFQ    W0NSRQ  1        IRS Review Freq
     C           W0NSRQ    IFEQ '?'                        Search required
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7        Return code
     C                     PARM 1101038   Y2LSNO  70       List number.
     C           #1IRFQ    PARM #1IRFQ    W0EXVL 20        IRS Review Freq
     C                     MOVEL'Y'       W0DCF   1        Defer confirm
     C                     END
      * USER: Validate detail screen fields
      * Disable ENTER in Delete Mode
      *CASE:     PAR.Action Code is Delete
     C           P4ANCD    IFEQ @CN,06                     *IF
      * Send message 'F3/F10/F12 only valid opt'
     C                     MOVEL'USR0536' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     99    *
      *
     C                     MOVEL@CN,01    W0DCF            *Defer confirm
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
      * Set values for field not used in country limits
     C                     EXSR UCSUBR                     Set values for
      * All Validation is done in External Function - Validate Limit Fields
      * Validate Limit Fields
      * Set Details Entered to Details  Entered
     C                     EXSR UDSUBR                     Set Details Ent
      * Test for Blanks in Status fields
     C                     EXSR UESUBR                     Test for Blanks
      * If FX Limit Type is Blank, all other fields must be Blank
      *CASE:     PAR.FX Limit Type is equal blank
     C           #1FXLT    IFEQ *BLANK                     *IF
      *CASE:     PAR.FX Limit Amount Screen DS is Not Equal Blank
     C           #DFLAS    IFNE *BLANK                     *IF
      * Setup message data for message.
     C                     MOVEL#1FXLT    ZA0001           FX Limit Type
      * Send message 'FX Limit Type Required'
     C                     MOVEL'USR0728' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9931  *
      *
     C                     ELSE
      *CASE:     PAR.FX Expiry Date Screen DS is Not Equal Blank
     C           #DSFED    IFNE *BLANK                     *IF
      * Setup message data for message.
     C                     MOVEL#1FXLT    ZA0002           FX Limit Type
      * Send message 'FX Limit Type Required'
     C                     MOVEL'USR0728' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9931  *
      *
     C                     ELSE
      *CASE:     PAR.FX Review Date Screen DS is Not Equal Blank
     C           #DSFRD    IFNE *BLANK                     *IF
      * Setup message data for message.
     C                     MOVEL#1FXLT    ZA0003           FX Limit Type
      * Send message 'FX Limit Type Required'
     C                     MOVEL'USR0728' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9931  *
      *
     C                     ELSE
      *CASE:     WRK.Blank in Frequency Field is Blank not in Field
     C           WUBIFF    IFEQ @CN,07                     *IF
      * Setup message data for message.
     C                     MOVEL#1FXLT    ZA0004           FX Limit Type
      * Send message 'FX Limit Type Required'
     C                     MOVEL'USR0728' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9931  *
      *
     C                     ELSE
      *CASE:     PAR.FX Freq Day Number DS is Not Equal Blank
     C           #DFFDS    IFNE *BLANK                     *IF
      * Setup message data for message.
     C                     MOVEL#1FXLT    ZA0005           FX Limit Type
      * Send message 'FX Limit Type Required'
     C                     MOVEL'USR0728' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9931  *
      *
     C                     ELSE
      *CASE:     PAR.MDDR Amount Screen is Not Equal Blank
     C           WUMDAS    IFNE *BLANK                     *IF
      * Setup message data for message.
     C                     MOVEL#1FXLT    ZA0006           FX Limit Type
      * Send message 'FX Limit Type Required'
     C                     MOVEL'USR0728' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9931  *
      *
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL@CN,08    WUDTEN           Details Entered
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * FX - Blank out file dates and numerics
     C                     EXSR UFSUBR                     FX - Blank out
      * Test for Blanks in Status fields
     C                     EXSR UGSUBR                     Test for Blanks
      * If Lending Limit Type is Blank, all other fields must be Blank
      *CASE:     PAR.Lending Limit Type is equal blank
     C           #1LLTY    IFEQ *BLANK                     *IF
      *CASE:     PAR.LN Limit Amount Screen DS is Not Equal Blank
     C           #DLLAS    IFNE *BLANK                     *IF
      * Setup message data for message.
     C                     MOVEL#1LLTY    ZA0007           Lending Limit T
      * Send message 'Lending Limit Type Req'
     C                     MOVEL'USR0686' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9932  *
      *
     C                     ELSE
      *CASE:     PAR.LN Expiry Date Screen DS is Not Equal Blank
     C           #DSLED    IFNE *BLANK                     *IF
      * Setup message data for message.
     C                     MOVEL#1LLTY    ZA0008           Lending Limit T
      * Send message 'Lending Limit Type Req'
     C                     MOVEL'USR0686' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9932  *
      *
     C                     ELSE
      *CASE:     PAR.LN Review Date Screen DS is Not Equal Blank
     C           #DSLRD    IFNE *BLANK                     *IF
      * Setup message data for message.
     C                     MOVEL#1LLTY    ZA0009           Lending Limit T
      * Send message 'Lending Limit Type Req'
     C                     MOVEL'USR0686' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9932  *
      *
     C                     ELSE
      *CASE:     WRK.Blank in Frequency Field is Blank not in Field
     C           WUBIFF    IFEQ @CN,07                     *IF
      * Setup message data for message.
     C                     MOVEL#1LLTY    ZA0010           Lending Limit T
      * Send message 'Lending Limit Type Req'
     C                     MOVEL'USR0686' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9932  *
      *
     C                     ELSE
      *CASE:     PAR.LN Freq Day Number DS is Not Equal Blank
     C           #DLFDS    IFNE *BLANK                     *IF
      * Setup message data for message.
     C                     MOVEL#1LLTY    ZA0011           Lending Limit T
      * Send message 'Lending Limit Type Req'
     C                     MOVEL'USR0686' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9932  *
      *
     C                     ELSE
      *CASE:     WRK.Blank in Secured Field is Blank not in Field
     C           WUBISF    IFEQ @CN,07                     *IF
      * Setup message data for message.
     C                     MOVEL#1LLTY    ZA0012           Lending Limit T
      * Send message 'Lending Limit Type Req'
     C                     MOVEL'USR0686' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9932  *
      *
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL@CN,08    WUDELN           Details Entered
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * LN - Blank out file dates and numerics
     C                     EXSR UHSUBR                     LN - Blank out
      * Test for Blanks in Status fields
     C                     EXSR UISUBR                     Test for Blanks
      * If FRA Limit Amount is Blank, all other fields must be Blank
      *CASE:     PAR.FRA Limit Amount Scrn DS is Equal Blank
     C           #DRLAS    IFEQ *BLANK                     *IF
      *CASE:     PAR.FRA Expiry Date Screen DS is Not Equal Blank
     C           #DSRED    IFNE *BLANK                     *IF
      * Setup message data for message.
     C                     MOVEL#DRLAS    ZA0013           FRA Limit Amoun
      * Send message 'FRA Limit Amount Required'
     C                     MOVEL'USR0692' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9943  *
      *
     C                     ELSE
      *CASE:     PAR.FRA Review Date Screen DS is Not Equal Blank
     C           #DSRRD    IFNE *BLANK                     *IF
      * Setup message data for message.
     C                     MOVEL#DRLAS    ZA0014           FRA Limit Amoun
      * Send message 'FRA Limit Amount Required'
     C                     MOVEL'USR0692' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9943  *
      *
     C                     ELSE
      *CASE:     WRK.Blank in Frequency Field is Blank not in Field
     C           WUBIFF    IFEQ @CN,07                     *IF
      * Setup message data for message.
     C                     MOVEL#DRLAS    ZA0015           FRA Limit Amoun
      * Send message 'FRA Limit Amount Required'
     C                     MOVEL'USR0692' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9943  *
      *
     C                     ELSE
      *CASE:     PAR.FRA Freq Day Number DS is Not Equal Blank
     C           #DRFDS    IFNE *BLANK                     *IF
      * Setup message data for message.
     C                     MOVEL#DRLAS    ZA0016           FRA Limit Amoun
      * Send message 'FRA Limit Amount Required'
     C                     MOVEL'USR0692' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9943  *
      *
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL@CN,08    WUDEFR           Details Entered
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * FRA - Blank out file dates and numerics
     C                     EXSR UJSUBR                     FRA - Blank out
      * Test for Blanks in Status fields
     C                     EXSR UKSUBR                     Test for Blanks
      * If IRS Limit Amount is Blank, all other fields must be Blank
      *CASE:     PAR.IRS Limit Amount Scrn DS is Equal Blank
     C           #DILAS    IFEQ *BLANK                     *IF
      *CASE:     PAR.IRS Expiry Date Screen DS is Not Equal Blank
     C           #DSIED    IFNE *BLANK                     *IF
      * Setup message data for message.
     C                     MOVEL#DILAS    ZA0017           IRS Limit Amoun
      * Send message 'IRS Limit Amount Required'
     C                     MOVEL'USR0693' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9944  *
      *
     C                     ELSE
      *CASE:     PAR.IRS Review Date Screen DS is Not Equal Blank
     C           #DSIRD    IFNE *BLANK                     *IF
      * Setup message data for message.
     C                     MOVEL#DILAS    ZA0018           IRS Limit Amoun
      * Send message 'IRS Limit Amount Required'
     C                     MOVEL'USR0693' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9944  *
      *
     C                     ELSE
      *CASE:     WRK.Blank in Frequency Field is Blank not in Field
     C           WUBIFF    IFEQ @CN,07                     *IF
      * Setup message data for message.
     C                     MOVEL#DILAS    ZA0019           IRS Limit Amoun
      * Send message 'IRS Limit Amount Required'
     C                     MOVEL'USR0693' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9944  *
      *
     C                     ELSE
      *CASE:     PAR.IRS Freq Day Number DS is Not Equal Blank
     C           #DIFDS    IFNE *BLANK                     *IF
      * Setup message data for message.
     C                     MOVEL#DILAS    ZA0020           IRS Limit Amoun
      * Send message 'IRS Limit Amount Required'
     C                     MOVEL'USR0693' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9944  *
      *
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL@CN,08    WUDEIR           Details Entered
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * IRS - blank out file dates and numerics
     C                     EXSR ULSUBR                     IRS - blank out
      * If No Details Entered, Send error message
      *CASE:     WRK.Details Entered is Details Not Entered
     C           WUDTEN    IFEQ @CN,08                     *IF
      *CASE:     WRK.Details Entered - LN is Details Not Entered
     C           WUDELN    IFEQ @CN,08                     *IF
      *CASE:     WRK.Details Entered - FRA is Details Not Entered
     C           WUDEFR    IFEQ @CN,08                     *IF
      *CASE:     WRK.Details Entered - IRS is Details Not Entered
     C           WUDEIR    IFEQ @CN,08                     *IF
      * Send message 'No Details Entered'
     C                     MOVEL'USR0708' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate FX Fields
     C                     EXSR UMSUBR                     Validate FX Fie
      * Validate LN Fields
     C                     EXSR UQSUBR                     Validate LN Fie
      * Convert FRA Limit Amount
     C                     EXSR UTSUBR                     Convert FRA Lim
      * Validate FRA Fields
     C                     EXSR UUSUBR                     Validate FRA Fi
      * Convert IRS Limit Amount
     C                     EXSR UXSUBR                     Convert IRS Lim
      * Validate IRS Fields
     C                     EXSR UYSUBR                     Validate IRS Fi
      *CASE:     WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ @CN,01                     *IF
      * 00/Copy Member SD0471RVSF - Country Limits  *
     C*00/Copy Member SD0471R   Validate Detail Screen
     C/COPY WNCPYSRC,SD0471RVSF
     C                     END                             *FI
      * Check relations.
      * Check reference to Limit types.
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * Check reference to Limit types.
     C                     EXSR VDCKRL
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
      * CALC: Detail screen function fields
      *CASE:     WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ @CN,01                     *IF
      * 00/Copy Member SD0471RSFF - Country Limits  *
     C*00/Copy Member SD0471R   Calc Detail Function Flds
     C/COPY WNCPYSRC,SD0471RSFF
     C                     END                             *FI
      * USER: Validate detail screen relations
      *CASE:     WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ @CN,01                     *IF
      * 00/Copy Member SD0471RVSR - Country Limits  *
     C*00/Copy Member SD0471R   Validate Screen Relns
     C/COPY WNCPYSRC,SD0471RVSR
     C                     END                             *FI
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         EBPR##    BEGSR
      *================================================================
      * Process record.
      *================================================================
      * Process delete request.
     C   10                CAS            EDDLRQ
      * Process add request.
     C           W0PMD     CASEQ'ADD'     ECADRQ
      * Process update request.
     C           W0PMD     CASNE'ADD'     EECHRQ
     C                     END
     C           W0RTN     IFNE *BLANK
      * Error: ROLLBACK any DBF changes.
     C                     ROLBK
     C                     GOTO EBEXIT
     C                     ELSE
      * Otherwise COMMIT any DBF changes.
     C                     COMIT
     C                     END
     C           W0RTN     IFEQ *BLANK
      * USER: Process command keys
      *CASE:     WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ @CN,01                     *IF
      * 00/Copy Member SD0471RPCK - Country Limits  *
     C*00/Copy Member SD0471R   Process Command Keys
     C/COPY WNCPYSRC,SD0471RPCK
     C                     END                             *FI
      * Restart program for next record.
     C                     MOVEL'N'       W0TRN
     C                     END
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         ECADRQ    BEGSR
      *================================================================
      * Process add request.
      *================================================================
      * USER: Create DBF record
      * Create Country Limits - Country Limits  *
     C                     EXSR SCCRRC
     C           W0RTN     IFEQ *BLANK
      * Send message '*Record added'
     C                     MOVEL'Y2U0011' ZAMSID           Message id.
     C                     MOVEL'Y2USRMSG'ZAMSGF           Message file.
     C                     EXSR ZASNMS                     Send message
     C                     END
      *================================================================
     CSR         ECEXIT    ENDSR
      /EJECT
     CSR         EDDLRQ    BEGSR
      *================================================================
      * Process delete request.
      *================================================================
      * USER: Delete DBF record
      * Delete Country Limits - Country Limits  *
     C                     EXSR SEDLRC
     C           W0RTN     IFEQ *BLANK
      * Send message '*Record deleted'
     C                     MOVEL'Y2U0013' ZAMSID           Message id.
     C                     MOVEL'Y2USRMSG'ZAMSGF           Message file.
     C                     EXSR ZASNMS                     Send message
     C                     END
      *================================================================
     CSR         EDEXIT    ENDSR
      /EJECT
     CSR         EECHRQ    BEGSR
      *================================================================
      * Process update request.
      *================================================================
      * USER: Change DBF record
      * Change Country Limits - Country Limits  *
     C                     EXSR SGCHRC
     C           W0RTN     IFNE *BLANK
      * DBF Update error detected.
      * Reset screen fields if changed record.
     C           W0RTN     CASEQ'Y2U0007' MBFL#1
     C                     END
     C                     ELSE
      * Send message '*Record changed'
     C                     MOVEL'Y2U0012' ZAMSID           Message id.
     C                     MOVEL'Y2USRMSG'ZAMSGF           Message file.
     C                     EXSR ZASNMS                     Send message
     C                     END
      *================================================================
     CSR         EEEXIT    ENDSR
      /EJECT
     CSR         FACKPM    BEGSR
      *================================================================
      * Check passed parameters.
      *================================================================
      * Is full key present?
     C           P1CNCD    IFEQ *BLANK                     Country Code
     C           P2LEVL    OREQ *BLANK                     Level
     C           P3BCCD    OREQ *BLANK                     Branch/Company
      * Not every key field passed - loop program.
     C                     MOVEL'Y'       W0RPT   1
     C                     ELSE
      * Full key passed, so single shot program.
     C                     MOVEL'N'       W0RPT
     C                     END
      *================================================================
     CSR         FAEXIT    ENDSR
      /EJECT
     CSR         GADSAK    BEGSR
      *================================================================
      * Set key screen conditioning indicators.
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSAD    BEGSR
      *================================================================
      * Set detail screen conditioning indicators.
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      * Protect key fields on detail screen.
     C                     SETON                     88    *
     C                     MOVEL'0'       *IN79
     C           WUDLBC    IFEQ @CN,03                     *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Enable key screen.
     C                     SETON                     87    *
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise record - except for key fields.
      *================================================================
     C                     MOVEL*BLANK    #PDRTC           Duplicate Retur
     C                     MOVELP4ANCD    #PANCD           Action Code
     C                     Z-ADD*ZERO     #1LCD            Last Change Dat
     C                     MOVEL*BLANK    #1TYLC           Type of Last Ch
     C                     Z-ADD*ZERO     #1FLAM           FX Limit Amount
     C                     Z-ADD*ZERO     #1LLAM           Lending Limit A
     C                     Z-ADD*ZERO     #1FLED           FX Limit Expiry
     C                     Z-ADD*ZERO     #1FLRD           FX Limit Review
     C                     Z-ADD*ZERO     #1FFDN           FX Frequency Da
     C                     Z-ADD*ZERO     #1LLED           Lending Limit E
     C                     Z-ADD*ZERO     #1LLRD           Lending Limit R
     C                     Z-ADD*ZERO     #1LFDN           Lending Frequen
     C                     Z-ADD*ZERO     #1FRLA           FRA Limit Amoun
     C                     Z-ADD*ZERO     #1IRLM           IRS Limit Amoun
     C                     Z-ADD*ZERO     #1FRED           FRA Expiry Date
     C                     Z-ADD*ZERO     #1FRRD           FRA Review Date
     C                     Z-ADD*ZERO     #1FRAD           FRA Frequency D
     C                     Z-ADD*ZERO     #1IRED           IRS Expiry Date
     C                     Z-ADD*ZERO     #1IRDT           IRS Review Date
     C                     Z-ADD*ZERO     #1IFDN           IRS Frequency D
     C                     MOVEL*BLANK    #DFLDT           Field Text
     C                     MOVEL*BLANK    #1FXLT           FX Limit Type
     C                     MOVEL*BLANK    #1LLTY           Lending Limit T
     C                     MOVEL*BLANK    #DFLAS           Fx Limit Amount
     C                     MOVEL*BLANK    #DLLAS           LN Limit Amount
     C                     MOVEL*BLANK    #DSFED           FX Expiry Date
     C                     MOVEL*BLANK    #DSLED           LN Expiry Date
     C                     MOVEL*BLANK    #DSFRD           FX Review Date
     C                     MOVEL*BLANK    #DSLRD           LN Review Date
     C                     MOVEL*BLANK    #1FLFQ           FX Limit Freque
     C                     MOVEL*BLANK    #1LLFR           Lending Limit F
     C                     MOVEL*BLANK    #DFFDS           FX Freq Day No
     C                     MOVEL*BLANK    #DLFDS           LN Freq Day No
     C                     MOVEL*BLANK    #DRLAS           FRA Limit Amoun
     C                     MOVEL*BLANK    #DILAS           IRS Limit Amoun
     C                     MOVEL*BLANK    #DSRED           FRA Expiry Date
     C                     MOVEL*BLANK    #DSIED           IRS Expiry Date
     C                     MOVEL*BLANK    #DSRRD           FRA Review Date
     C                     MOVEL*BLANK    #DSIRD           IRS Review Date
     C                     MOVEL*BLANK    #1FRFQ           FRA Review Freq
     C                     MOVEL*BLANK    #1IRFQ           IRS Review Freq
     C                     MOVEL*BLANK    #DRFDS           FRA Freq Day no
     C                     MOVEL*BLANK    #DIFDS           IRS Freq Day no
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @DXREHN fields to screen.
      *================================================================
     C                     Z-ADDDXLCD     #1LCD            Last Change Dat
     C                     MOVELDXTYLC    #1TYLC           Type of Last Ch
     C                     Z-ADDDXFLAM    #1FLAM           FX Limit Amount
     C                     Z-ADDDXLLAM    #1LLAM           Lending Limit A
     C                     Z-ADDDXFLED    #1FLED           FX Limit Expiry
     C                     Z-ADDDXFLRD    #1FLRD           FX Limit Review
     C                     Z-ADDDXFFDN    #1FFDN           FX Frequency Da
     C                     Z-ADDDXLLED    #1LLED           Lending Limit E
     C                     Z-ADDDXLLRD    #1LLRD           Lending Limit R
     C                     Z-ADDDXLFDN    #1LFDN           Lending Frequen
     C                     Z-ADDDXFRLA    #1FRLA           FRA Limit Amoun
     C                     Z-ADDDXIRLM    #1IRLM           IRS Limit Amoun
     C                     Z-ADDDXFRED    #1FRED           FRA Expiry Date
     C                     Z-ADDDXFRRD    #1FRRD           FRA Review Date
     C                     Z-ADDDXFRAD    #1FRAD           FRA Frequency D
     C                     Z-ADDDXIRED    #1IRED           IRS Expiry Date
     C                     Z-ADDDXIRDT    #1IRDT           IRS Review Date
     C                     Z-ADDDXIFDN    #1IFDN           IRS Frequency D
     C                     MOVELDXCNCD    #1CNCD           Country Code
     C                     MOVELDXLEVL    #1LEVL           Level
     C                     MOVELDXBCCD    #1BCCD           Branch/Company
     C                     MOVELDXFXLT    #1FXLT           FX Limit Type
     C                     MOVELDXLLTY    #1LLTY           Lending Limit T
     C                     MOVELDXFLFQ    #1FLFQ           FX Limit Freque
     C                     MOVELDXLLFR    #1LLFR           Lending Limit F
     C                     MOVELDXFRFQ    #1FRFQ           FRA Review Freq
     C                     MOVELDXIRFQ    #1IRFQ           IRS Review Freq
      * Hold existing record image.
     C                     MOVEL@1DBRC    #1DBRC
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MDIZ#K    BEGSR
      *================================================================
      * Initialise key screen.
      *================================================================
     C                     MOVEL*BLANK    #PDRTC           Duplicate Retur
     C                     MOVELP4ANCD    #PANCD           Action Code
     C                     MOVELP1CNCD    #1CNCD           Country Code
     C                     MOVELP2LEVL    #1LEVL           Level
     C                     MOVELP3BCCD    #1BCCD           Branch/Company
      * USER: Initialise key screen
      *CASE:     WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ @CN,01                     *IF
      * 00/Copy Member SD0471RIKS - Country Limits  *
     C*00/Copy Member SD0471R   Initialise Key Screen
     C/COPY WNCPYSRC,SD0471RIKS
     C                     END                             *FI
      *================================================================
     CSR         MDEXIT    ENDSR
      /EJECT
     CSR         NASUBR    BEGSR
      *================================================================
      * Convert Frequency Day Number
      *================================================================
      *CASE:     PAR.IRS Freq Day Number DS is Not Equal Blank
     C           #DIFDS    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DIFDS    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0237  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0238 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0239  10       ZALIGN No Of De
     C                     PARM 9         WQ0240  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0241 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Error detected ?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *CASE:     PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ @CN,04                     *IF
     C                     MOVEL@CN,01    WUIFQD           Err Code
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL@CN,03    WUIFQD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0242 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0243  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
     C                     END                             *FI
      *CASE:     WRK.Invalid Frequency Day No is Error Found
     C           WUIFQD    IFEQ @CN,01                     *IF
      * Setup message data for message.
     C                     MOVEL#DIFDS    ZA0103           IRS Freq Day Nu
      * Send message 'Freq Day Num Must Numeric'
     C                     MOVEL'USR0793' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9952  *
      *
     C                     ELSE
      *CASE:     *OTHERWISE
      * ZALIGN IRS Freq Day No - Region Limits  *
     C*
     C* MOVE ZALIGN SCREEN FUNCTION FIELD INTO IRS FREQUENCY DAY NO
     C* SCREEN FUNCTION FIELD
     C                     MOVE WUZASF    #DIFDS
     C                     MOVE WUZAFF    #1IFDN           IRS Frequency D
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         NAEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Get Country Code Name - Country Codes  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define Keylist.
     C           KRSSA     KLIST
     C                     KFLD           A4CNCD           Country Code
      * Move fields to key list.
     C                     MOVELDXCNCD    A4CNCD           Country Code
     C           KRSSA     CHAIN@A4REBR              90    *
      * DBF Record not found.
     C   90                MOVEL'USR0067' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process DBF record
      * PAR = DB1 By name
     C                     MOVELA4CNNM    WUCNNM           Country Name
     C                     END
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Get Country Code Name - Country Codes  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define Keylist.
     C           KRSSB     KLIST
     C                     KFLD           A4CNCD           Country Code
      * Move fields to key list.
     C                     MOVEL#1CNCD    A4CNCD           Country Code
     C           KRSSB     CHAIN@A4REBR              90    *
      * DBF Record not found.
     C   90                MOVEL'USR0067' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process DBF record
      * PAR = DB1 By name
     C                     MOVELA4CNNM    WUCNNM           Country Name
     C                     END
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCRRC    BEGSR
      *================================================================
      * Create Country Limits - Country Limits  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DXREHM
     C                     MOVEL#1CNCD    DXCNCD           Country Code
     C                     MOVEL#1LEVL    DXLEVL           Level
     C                     MOVEL#1BCCD    DXBCCD           Branch/Company
     C                     Z-ADDWURDNB    DXLCD            Last Change Dat
     C                     MOVEL@CN,27    DXTYLC           Type of Last Ch
     C                     MOVEL#1FXLT    DXFXLT           FX Limit Type
     C                     Z-ADD#1FLAM    DXFLAM           FX Limit Amount
     C                     Z-ADD#1FLED    DXFLED           FX Limit Expiry
     C                     Z-ADD#1FLRD    DXFLRD           FX Limit Review
     C                     MOVEL#1FLFQ    DXFLFQ           FX Limit Freque
     C                     Z-ADD#1FFDN    DXFFDN           FX Frequency Da
     C                     MOVEL#1LLTY    DXLLTY           Lending Limit T
     C                     Z-ADD#1LLAM    DXLLAM           Lending Limit A
     C                     Z-ADD#1LLED    DXLLED           Lending Limit E
     C                     Z-ADD#1LLRD    DXLLRD           Lending Limit R
     C                     MOVEL#1LLFR    DXLLFR           Lending Limit F
     C                     Z-ADD#1LFDN    DXLFDN           Lending Frequen
     C                     Z-ADD#1FRLA    DXFRLA           FRA Limit Amoun
     C                     Z-ADD#1FRED    DXFRED           FRA Expiry Date
     C                     Z-ADD#1FRRD    DXFRRD           FRA Review Date
     C                     MOVEL#1FRFQ    DXFRFQ           FRA Review Freq
     C                     Z-ADD#1FRAD    DXFRAD           FRA Frequency D
     C                     Z-ADD#1IRLM    DXIRLM           IRS Limit Amoun
     C                     Z-ADD#1IRED    DXIRED           IRS Expiry Date
     C                     MOVEL#1IRFQ    DXIRFQ           IRS Review Freq
     C                     Z-ADD#1IRDT    DXIRDT           IRS Review Date
     C                     Z-ADD#1IFDN    DXIFDN           IRS Frequency D
      *
      * USER: Processing before DBF update
      *CASE:     WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ @CN,01                     *IF
      *CASE:     WRK.Window processing requir. is Yes
     C           WUWDPR    IFEQ @CN,01                     *IF
      * WM call Window Manager - Window manager  *
     C***********          CALL 'WIND01'                                  S01212
     C                     CALL 'WN0010'                                  S01212
     C*********************PARM           ##PGM            Program        S01212
     C                     PARM ##PGM     UPGM   10        Program        S01212
     C*********************PARM *BLANK    FKEY    2        Function Key   S01212
     C                     PARM *BLANK    UFKEY   2        Function Key   S01212
     C*********************PARM           WUMEST           Action  S01212 S01229
     C*********************PARM           WUWMAC           Action  S01212 S01229
     C                     PARM @CN,27    UACTCD  1        Action  S01212 S01229
     C                     PARM           DATA             Trans Data     S01212
     C                     PARM *BLANK    W0RTN            Return Code    S01212
     C                     PARM           SPARE 256        Spare Field    LN0355
      * WM Check Return
      *CASE:     PAR.*Return code is *User QUIT requested
     C           W0RTN     IFEQ @CN,28                     *IF
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      *CASE:     PAR.*Return code is WN Window Error
     C           W0RTN     IFEQ @CN,29                     *IF
      * Send message 'WN Window Error'
     C                     MOVEL'USR0563' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     99    *
      *
     C                     MOVEL@CN,01    W0DCF            *Defer confirm
     C                     GOTO SCEXIT                     *QUIT
     C                     ELSE
      *CASE:     PAR.*Return code is *DBF update error
     C           W0RTN     IFEQ @CN,30                     *IF
      * Send message 'WN Database Error'
     C                     MOVEL'USR0567' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     99    *
      *
     C                     MOVEL@CN,01    W0DCF            *Defer confirm
     C                     GOTO SCEXIT                     *QUIT
     C                     ELSE
      *CASE:     PAR.*Return code is *Previous Screen
     C           W0RTN     IFEQ @CN,05                     *IF
     C                     MOVEL@CN,01    W0DCF            *Defer confirm
     C                     GOTO SCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 00/Copy Member SD0471RCBW - Country Limits  *
     C*00/Copy Member SD0471R   Proc Before Create - WN
     C/COPY WNCPYSRC,SD0471RCBW
     C                     END                             *FI
      * 00/Copy Member SD0471RCBU - Country Limits  *
     C*00/Copy Member SD0471R   Processing Before Create
     C/COPY WNCPYSRC,SD0471RCBU
     C                     END                             *FI
     C           KLCRSC    KLIST
     C                     KFLD           DXCNCD           Country Code
     C                     KFLD           DXLEVL           Level
     C                     KFLD           DXBCCD           Branch/Company
      * Check for duplicate primary key.
     C           KLCRSC    SETLL@DXREHM                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0662' W0RTN   7
      * Send message 'Country Limits         EX'
     C                     MOVEL'USR0662' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     GOTO SCEXIT
     C                     END
      *
     C                     WRITE@DXREHM                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected.
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * DBF Write successful.
      * USER: Processing after DBF update
     C                     Z-ADD1         WUNORC           No. of Records
     C                     Z-ADD1         WUNOIN           No. of Inserts
     C                     Z-ADD*ZERO     WUNODL           No. of Deletes
     C                     Z-ADD*ZERO     WUNOAM           No. of Amends
      * Change Standing Data Cont - Standing Data Controls  *
     C                     EXSR SDCHRC
      *CASE:     WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ @CN,01                     *IF
      * 00/Copy Member SD0471RCAU - Country Limits  *
     C*00/Copy Member SD0471R   Processing After Create
     C/COPY WNCPYSRC,SD0471RCAU
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCHRC    BEGSR
      *================================================================
      * Change Standing Data Cont - Standing Data Controls  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @AHREAU
     C                     MOVEL@CN,31    AHFLNM           Filename
      *
     C           KLCHSD    KLIST
     C                     KFLD           AHFLNM           Filename
     C           KLCHSD    CHAIN@AHREAU              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found.
     C                     MOVEL'Y2U0009' W0RTN   7
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID           Message id.
     C                     MOVEL'Y2USRMSG'ZAMSGF           Message file.
     C                     EXSR ZASNMS                     Send message
     C                     GOTO SDEXIT
     C                     END
      *
     C           *IN91     IFEQ '1'
      * Record locked.
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     GOTO SDEXIT
     C                     END
      *
      * USER: Processing after DBF read
     C                     ADD  AHNORC    WUNORC           No. of Records
     C                     ADD  AHNOIN    WUNOIN           No. of Inserts
     C                     ADD  AHNOAM    WUNOAM           No. of Amends
     C                     ADD  AHNODL    WUNODL           No. of Deletes
      * Move Non-key fields to @AHREAU
     C                     Z-ADDWUNORC    AHNORC           No. of Records
     C                     Z-ADDWUNOIN    AHNOIN           No. of Inserts
     C                     Z-ADDWUNOAM    AHNOAM           No. of Amends
     C                     Z-ADDWUNODL    AHNODL           No. of Deletes
      *
     C                     UPDAT@AHREAU                91  *
     C           *IN91     IFEQ '1'
      * Change error detected.
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * DBF Change successful.
     C                     END
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SEDLRC    BEGSR
      *================================================================
      * Delete Country Limits - Country Limits  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before DBF update
      *CASE:     PAR.Action Code is Delete
     C           P4ANCD    IFEQ @CN,06                     *IF
      *CASE:     WRK.Window processing requir. is Yes
     C           WUWDPR    IFEQ @CN,01                     *IF
      * WM call Window Manager - Window manager  *
     C***********          CALL 'WIND01'                                  S01212
     C                     CALL 'WN0010'                                  S01212
     C*********************PARM           ##PGM            Program        S01212
     C                     PARM ##PGM     UPGM   10        Program        S01212
     C*********************PARM *BLANK    FKEY    2        Function Key   S01212
     C                     PARM *BLANK    UFKEY   2        Function Key   S01212
     C*********************PARM           WUMEST           Action  S01212 S01229
     C*********************PARM           WUWMAC           Action  S01212 S01229
     C                     PARM @CN,06    UACTCD  1        Action  S01212 S01229
     C                     PARM           DATA             Trans Data     S01212
     C                     PARM *BLANK    W0RTN            Return Code    S01212
     C                     PARM           SPARE 256        Spare Field    LN0355
      * WM Check Return
      *CASE:     PAR.*Return code is *User QUIT requested
     C           W0RTN     IFEQ @CN,28                     *IF
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      *CASE:     PAR.*Return code is WN Window Error
     C           W0RTN     IFEQ @CN,29                     *IF
      * Send message 'WN Window Error'
     C                     MOVEL'USR0563' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     99    *
      *
     C                     MOVEL@CN,01    W0DCF            *Defer confirm
     C                     GOTO SEEXIT                     *QUIT
     C                     ELSE
      *CASE:     PAR.*Return code is *DBF update error
     C           W0RTN     IFEQ @CN,30                     *IF
      * Send message 'WN Database Error'
     C                     MOVEL'USR0567' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     99    *
      *
     C                     MOVEL@CN,01    W0DCF            *Defer confirm
     C                     GOTO SEEXIT                     *QUIT
     C                     ELSE
      *CASE:     PAR.*Return code is *Previous Screen
     C           W0RTN     IFEQ @CN,05                     *IF
     C                     MOVEL@CN,01    W0DCF            *Defer confirm
     C                     GOTO SEEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 00/Copy Member SD0471RDBW - Country Limits  *
     C*00/Copy Member SD0471R   Proc Before Delete - WN
     C/COPY WNCPYSRC,SD0471RDBW
     C                     END                             *FI
     C                     ELSE
      *CASE:     *OTHERWISE
      * Send message 'Function key not allowed'
     C                     MOVEL'USR0533' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     99    *
      *
     C                     MOVEL@CN,30    W0RTN            *Return code
     C                     GOTO SEEXIT                     *QUIT
     C                     END                             *FI
      *CASE:     WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ @CN,01                     *IF
      * 00/Copy Member SD0471RDBU - Country Limits  *
     C*00/Copy Member SD0471R   Processing Before Delete
     C/COPY WNCPYSRC,SD0471RDBU
     C                     END                             *FI
      * Move key fields to @DXREHM
     C                     MOVEL#1CNCD    DXCNCD           Country Code
     C                     MOVEL#1LEVL    DXLEVL           Level
     C                     MOVEL#1BCCD    DXBCCD           Branch/Company
      *
     C           KLDLSE    KLIST
     C                     KFLD           DXCNCD           Country Code
     C                     KFLD           DXLEVL           Level
     C                     KFLD           DXBCCD           Branch/Company
     C           KLDLSE    CHAIN@DXREHM              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted.
     C                     MOVEL'Y2U0009' W0RTN   7
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID           Message id.
     C                     MOVEL'Y2USRMSG'ZAMSGF           Message file.
     C                     EXSR ZASNMS                     Send message
     C                     GOTO SEEXIT
     C                     END
      *
     C           *IN91     IFEQ '1'
      * Record locked.
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     GOTO SEEXIT
     C                     END
      *
      * Check for changed record.
     C           #1DBRC    IFNE @1DBRC                     IF
     C                     MOVEL'Y2U0007' W0RTN   7
      * Send message '*Update not accepted'
     C                     MOVEL'Y2U0007' ZAMSID           Message id.
     C                     MOVEL'Y2USRMSG'ZAMSGF           Message file.
     C                     EXSR ZASNMS                     Send message
      * Use SETLL to release record lock.
     C           KLDLSE    SETLL@DXREHM              9091  *
     C                     GOTO SEEXIT
     C                     END                             FI #1DBRC
      *................................................................
     C                     DELET@DXREHM                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected.
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * DBF Delete successful.
      * USER: Processing after DBF update
     C                     Z-ADD-1        WUNORC           No. of Records
     C                     Z-ADD*ZERO     WUNOIN           No. of Inserts
     C                     Z-ADD1         WUNODL           No. of Deletes
     C                     Z-ADD*ZERO     WUNOAM           No. of Amends
      * Change Standing Data Cont - Standing Data Controls  *
     C                     EXSR SFCHRC
      *CASE:     WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ @CN,01                     *IF
      * 00/Copy Member SD0471RDAU - Country Limits  *
     C*00/Copy Member SD0471R   Processing After Delete
     C/COPY WNCPYSRC,SD0471RDAU
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCHRC    BEGSR
      *================================================================
      * Change Standing Data Cont - Standing Data Controls  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @AHREAU
     C                     MOVEL@CN,31    AHFLNM           Filename
      *
     C           KLCHSF    KLIST
     C                     KFLD           AHFLNM           Filename
     C           KLCHSF    CHAIN@AHREAU              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found.
     C                     MOVEL'Y2U0009' W0RTN   7
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID           Message id.
     C                     MOVEL'Y2USRMSG'ZAMSGF           Message file.
     C                     EXSR ZASNMS                     Send message
     C                     GOTO SFEXIT
     C                     END
      *
     C           *IN91     IFEQ '1'
      * Record locked.
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     GOTO SFEXIT
     C                     END
      *
      * USER: Processing after DBF read
     C                     ADD  AHNORC    WUNORC           No. of Records
     C                     ADD  AHNOIN    WUNOIN           No. of Inserts
     C                     ADD  AHNOAM    WUNOAM           No. of Amends
     C                     ADD  AHNODL    WUNODL           No. of Deletes
      * Move Non-key fields to @AHREAU
     C                     Z-ADDWUNORC    AHNORC           No. of Records
     C                     Z-ADDWUNOIN    AHNOIN           No. of Inserts
     C                     Z-ADDWUNOAM    AHNOAM           No. of Amends
     C                     Z-ADDWUNODL    AHNODL           No. of Deletes
      *
     C                     UPDAT@AHREAU                91  *
     C           *IN91     IFEQ '1'
      * Change error detected.
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * DBF Change successful.
     C                     END
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCHRC    BEGSR
      *================================================================
      * Change Country Limits - Country Limits  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @DXREHM
     C                     MOVEL#1CNCD    DXCNCD           Country Code
     C                     MOVEL#1LEVL    DXLEVL           Level
     C                     MOVEL#1BCCD    DXBCCD           Branch/Company
      *
     C           KLCHSG    KLIST
     C                     KFLD           DXCNCD           Country Code
     C                     KFLD           DXLEVL           Level
     C                     KFLD           DXBCCD           Branch/Company
     C           KLCHSG    CHAIN@DXREHM              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found.
     C                     MOVEL'Y2U0009' W0RTN   7
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID           Message id.
     C                     MOVEL'Y2USRMSG'ZAMSGF           Message file.
     C                     EXSR ZASNMS                     Send message
     C                     GOTO SGEXIT
     C                     END
      *
     C           *IN91     IFEQ '1'
      * Record locked.
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     GOTO SGEXIT
     C                     END
      *
      * Check for changed record.
     C           #1DBRC    IFNE @1DBRC                     IF
     C                     MOVEL'Y2U0007' W0RTN   7
      * Send message '*Update not accepted'
     C                     MOVEL'Y2U0007' ZAMSID           Message id.
     C                     MOVEL'Y2USRMSG'ZAMSGF           Message file.
     C                     EXSR ZASNMS                     Send message
      * Use SETLL to release record lock.
     C           KLCHSG    SETLL@DXREHM              9091  *
     C                     GOTO SGEXIT
     C                     END                             FI #1DBRC
      * Move Non-key fields to @DXREHM
     C                     Z-ADDWURDNB    DXLCD            Last Change Dat
     C                     MOVEL@CN,15    DXTYLC           Type of Last Ch
     C                     MOVEL#1FXLT    DXFXLT           FX Limit Type
     C                     Z-ADD#1FLAM    DXFLAM           FX Limit Amount
     C                     Z-ADD#1FLED    DXFLED           FX Limit Expiry
     C                     Z-ADD#1FLRD    DXFLRD           FX Limit Review
     C                     MOVEL#1FLFQ    DXFLFQ           FX Limit Freque
     C                     Z-ADD#1FFDN    DXFFDN           FX Frequency Da
     C                     MOVEL#1LLTY    DXLLTY           Lending Limit T
     C                     Z-ADD#1LLAM    DXLLAM           Lending Limit A
     C                     Z-ADD#1LLED    DXLLED           Lending Limit E
     C                     Z-ADD#1LLRD    DXLLRD           Lending Limit R
     C                     MOVEL#1LLFR    DXLLFR           Lending Limit F
     C                     Z-ADD#1LFDN    DXLFDN           Lending Frequen
     C                     Z-ADD#1FRLA    DXFRLA           FRA Limit Amoun
     C                     Z-ADD#1FRED    DXFRED           FRA Expiry Date
     C                     Z-ADD#1FRRD    DXFRRD           FRA Review Date
     C                     MOVEL#1FRFQ    DXFRFQ           FRA Review Freq
     C                     Z-ADD#1FRAD    DXFRAD           FRA Frequency D
     C                     Z-ADD#1IRLM    DXIRLM           IRS Limit Amoun
     C                     Z-ADD#1IRED    DXIRED           IRS Expiry Date
     C                     MOVEL#1IRFQ    DXIRFQ           IRS Review Freq
     C                     Z-ADD#1IRDT    DXIRDT           IRS Review Date
     C                     Z-ADD#1IFDN    DXIFDN           IRS Frequency D
      *
      * USER: Processing before DBF update
      *CASE:     WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ @CN,01                     *IF
      *CASE:     WRK.Window processing requir. is Yes
     C           WUWDPR    IFEQ @CN,01                     *IF
      * WM call Window Manager - Window manager  *
     C***********          CALL 'WIND01'                                  S01212
     C                     CALL 'WN0010'                                  S01212
     C*********************PARM           ##PGM            Program        S01212
     C                     PARM ##PGM     UPGM   10        Program        S01212
     C*********************PARM *BLANK    FKEY    2        Function Key   S01212
     C                     PARM *BLANK    UFKEY   2        Function Key   S01212
     C*********************PARM           WUMEST           Action  S01212 S01229
     C*********************PARM           WUWMAC           Action  S01212 S01229
     C                     PARM @CN,15    UACTCD  1        Action  S01212 S01229
     C                     PARM           DATA             Trans Data     S01212
     C                     PARM *BLANK    W0RTN            Return Code    S01212
     C                     PARM           SPARE 256        Spare Field    LN0355
      * WM Check Return
      *CASE:     PAR.*Return code is *User QUIT requested
     C           W0RTN     IFEQ @CN,28                     *IF
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      *CASE:     PAR.*Return code is WN Window Error
     C           W0RTN     IFEQ @CN,29                     *IF
      * Send message 'WN Window Error'
     C                     MOVEL'USR0563' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     99    *
      *
     C                     MOVEL@CN,01    W0DCF            *Defer confirm
     C                     GOTO SGEXIT                     *QUIT
     C                     ELSE
      *CASE:     PAR.*Return code is *DBF update error
     C           W0RTN     IFEQ @CN,30                     *IF
      * Send message 'WN Database Error'
     C                     MOVEL'USR0567' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     99    *
      *
     C                     MOVEL@CN,01    W0DCF            *Defer confirm
     C                     GOTO SGEXIT                     *QUIT
     C                     ELSE
      *CASE:     PAR.*Return code is *Previous Screen
     C           W0RTN     IFEQ @CN,05                     *IF
     C                     MOVEL@CN,01    W0DCF            *Defer confirm
     C                     GOTO SGEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 00/Copy Member SD0471RBUW - Country Limits  *
     C*00/Copy Member SD0471R   Before Update, Window on
     C/COPY WNCPYSRC,SD0471RBUW
     C                     END                             *FI
      * 00/Copy Member SD0471RBDU - Country Limits  *
     C*00/Copy Member SD0471R   Processing Before Update
     C/COPY WNCPYSRC,SD0471RBDU
     C                     END                             *FI
     C                     UPDAT@DXREHM                91  *
     C           *IN91     IFEQ '1'
      * Change error detected.
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * DBF Change successful.
      * Update saved record image.
     C                     MOVEL@1DBRC    #1DBRC
      * USER: Processing after DBF update
     C                     Z-ADD*ZERO     WUNORC           No. of Records
     C                     Z-ADD*ZERO     WUNOIN           No. of Inserts
     C                     Z-ADD*ZERO     WUNODL           No. of Deletes
     C                     Z-ADD1         WUNOAM           No. of Amends
      * Change Standing Data Cont - Standing Data Controls  *
     C                     EXSR SHCHRC
      *CASE:     WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ @CN,01                     *IF
      * 00/Copy Member SD0471RADU - Country Limits  *
     C*00/Copy Member SD0471R   Processing After Update
     C/COPY WNCPYSRC,SD0471RADU
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCHRC    BEGSR
      *================================================================
      * Change Standing Data Cont - Standing Data Controls  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @AHREAU
     C                     MOVEL@CN,31    AHFLNM           Filename
      *
     C           KLCHSH    KLIST
     C                     KFLD           AHFLNM           Filename
     C           KLCHSH    CHAIN@AHREAU              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found.
     C                     MOVEL'Y2U0009' W0RTN   7
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID           Message id.
     C                     MOVEL'Y2USRMSG'ZAMSGF           Message file.
     C                     EXSR ZASNMS                     Send message
     C                     GOTO SHEXIT
     C                     END
      *
     C           *IN91     IFEQ '1'
      * Record locked.
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     GOTO SHEXIT
     C                     END
      *
      * USER: Processing after DBF read
     C                     ADD  AHNORC    WUNORC           No. of Records
     C                     ADD  AHNOIN    WUNOIN           No. of Inserts
     C                     ADD  AHNOAM    WUNOAM           No. of Amends
     C                     ADD  AHNODL    WUNODL           No. of Deletes
      * Move Non-key fields to @AHREAU
     C                     Z-ADDWUNORC    AHNORC           No. of Records
     C                     Z-ADDWUNOIN    AHNOIN           No. of Inserts
     C                     Z-ADDWUNOAM    AHNOAM           No. of Amends
     C                     Z-ADDWUNODL    AHNODL           No. of Deletes
      *
     C                     UPDAT@AHREAU                91  *
     C           *IN91     IFEQ '1'
      * Change error detected.
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * DBF Change successful.
     C                     END
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Get 'Window required' ind - MIDAS Modules  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define Keylist.
     C           KRSSI     KLIST
     C                     KFLD           BGMODS           Modules
      * Move fields to key list.
     C                     MOVEL@CN,34    BGMODS           Modules
     C           KRSSI     CHAIN@BGREC8              90    *
      * DBF Record not found.
     C   90                MOVEL'USR0096' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process DBF record
      *CASE:     DB1.Window processing requir. is Yes
     C           BGWDPR    IFEQ @CN,01                     *IF
     C                     MOVEL@CN,01    WUWDPR           Window processi
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Convert all file dates to screen dates
      *================================================================
      * Check File Date - Rundate  *
     C                     CALL 'ZDATE2'               90  Check File Date
     C                     PARM DXFLED    WQ0001  50       Work Midas Date
     C                     PARM WUDFF     WQ0002  1        Date format fla
     C           WUWCDT    PARM *ZERO     WQ0003  60       Work Converted
     C           WUWADT    PARM *BLANK    WQ0004  7        Work Alpha Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Set FX Expiry Date
      *CASE:     WRK.Work Converted Date is not equal zero
     C           WUWCDT    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    #DSFED           FX Expiry Date
     C                     MOVELWUWCDT    #DSFED           FX Expiry Date
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL*BLANK    #DSFED           FX Expiry Date
     C                     END                             *FI
      * Check File Date - Rundate  *
     C                     CALL 'ZDATE2'               90  Check File Date
     C                     PARM DXFLRD    WQ0005  50       Work Midas Date
     C                     PARM WUDFF     WQ0006  1        Date format fla
     C           WUWCDT    PARM *ZERO     WQ0007  60       Work Converted
     C           WUWADT    PARM *BLANK    WQ0008  7        Work Alpha Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Set FX Review Date
      *CASE:     WRK.Work Converted Date is not equal zero
     C           WUWCDT    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    #DSFRD           FX Review Date
     C                     MOVELWUWCDT    #DSFRD           FX Review Date
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL*BLANK    #DSFRD           FX Review Date
     C                     END                             *FI
      * Check File Date - Rundate  *
     C                     CALL 'ZDATE2'               90  Check File Date
     C                     PARM DXLLED    WQ0009  50       Work Midas Date
     C                     PARM WUDFF     WQ0010  1        Date format fla
     C           WUWCDT    PARM *ZERO     WQ0011  60       Work Converted
     C           WUWADT    PARM *BLANK    WQ0012  7        Work Alpha Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Set LN Expiry Date
      *CASE:     WRK.Work Converted Date is not equal zero
     C           WUWCDT    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    #DSLED           LN Expiry Date
     C                     MOVELWUWCDT    #DSLED           LN Expiry Date
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL*BLANK    #DSLED           LN Expiry Date
     C                     END                             *FI
      * Check File Date - Rundate  *
     C                     CALL 'ZDATE2'               90  Check File Date
     C                     PARM DXLLRD    WQ0013  50       Work Midas Date
     C                     PARM WUDFF     WQ0014  1        Date format fla
     C           WUWCDT    PARM *ZERO     WQ0015  60       Work Converted
     C           WUWADT    PARM *BLANK    WQ0016  7        Work Alpha Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Set LN Review Date
      *CASE:     WRK.Work Converted Date is not equal zero
     C           WUWCDT    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    #DSLRD           LN Review Date
     C                     MOVELWUWCDT    #DSLRD           LN Review Date
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL*BLANK    #DSLRD           LN Review Date
     C                     END                             *FI
      * Check File Date - Rundate  *
     C                     CALL 'ZDATE2'               90  Check File Date
     C                     PARM DXFRED    WQ0017  50       Work Midas Date
     C                     PARM WUDFF     WQ0018  1        Date format fla
     C           WUWCDT    PARM *ZERO     WQ0019  60       Work Converted
     C           WUWADT    PARM *BLANK    WQ0020  7        Work Alpha Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Set FRA Expiry Date
      *CASE:     WRK.Work Converted Date is not equal zero
     C           WUWCDT    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    #DSRED           FRA Expiry Date
     C                     MOVELWUWCDT    #DSRED           FRA Expiry Date
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL*BLANK    #DSRED           FRA Expiry Date
     C                     END                             *FI
      * Check File Date - Rundate  *
     C                     CALL 'ZDATE2'               90  Check File Date
     C                     PARM DXFRRD    WQ0021  50       Work Midas Date
     C                     PARM WUDFF     WQ0022  1        Date format fla
     C           WUWCDT    PARM *ZERO     WQ0023  60       Work Converted
     C           WUWADT    PARM *BLANK    WQ0024  7        Work Alpha Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Set FRA Review Date
      *CASE:     WRK.Work Converted Date is not equal zero
     C           WUWCDT    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    #DSRRD           FRA Review Date
     C                     MOVELWUWCDT    #DSRRD           FRA Review Date
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL*BLANK    #DSRRD           FRA Review Date
     C                     END                             *FI
      * Check File Date - Rundate  *
     C                     CALL 'ZDATE2'               90  Check File Date
     C                     PARM DXIRED    WQ0025  50       Work Midas Date
     C                     PARM WUDFF     WQ0026  1        Date format fla
     C           WUWCDT    PARM *ZERO     WQ0027  60       Work Converted
     C           WUWADT    PARM *BLANK    WQ0028  7        Work Alpha Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Set IRS Expiry Date
      *CASE:     WRK.Work Converted Date is not equal zero
     C           WUWCDT    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    #DSIED           IRS Expiry Date
     C                     MOVELWUWCDT    #DSIED           IRS Expiry Date
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL*BLANK    #DSIED           IRS Expiry Date
     C                     END                             *FI
      * Check File Date - Rundate  *
     C                     CALL 'ZDATE2'               90  Check File Date
     C                     PARM DXIRDT    WQ0029  50       Work Midas Date
     C                     PARM WUDFF     WQ0030  1        Date format fla
     C           WUWCDT    PARM *ZERO     WQ0031  60       Work Converted
     C           WUWADT    PARM *BLANK    WQ0032  7        Work Alpha Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Set IRS Review Date
      *CASE:     WRK.Work Converted Date is not equal zero
     C           WUWCDT    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    #DSIRD           IRS Review Date
     C                     MOVELWUWCDT    #DSIRD           IRS Review Date
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL*BLANK    #DSIRD           IRS Review Date
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Convert all file amounts to function fields
      *================================================================
      * FX Limit Amount
      *CASE:     DB1.FX Limit Amount is not equal zero
     C           DXFLAM    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVELDXFLAM    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0033  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0034 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0035  10       ZALIGN No Of De
     C                     PARM 9         WQ0036  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0037 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Error detected ?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *CASE:     PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ @CN,04                     *IF
     C                     MOVEL@CN,01    WUERCD           Err Code
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL@CN,03    WUERCD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0038 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0039  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
     C                     END                             *FI
      * ZALIGN FX Limit Amount - Region Limits  *
     C*
     C* MOVE ZALIGN SCREEN FUNCTION FIELD INTO FX LIMIT AMOUNT
     C* SCREEN FUNCTION FIELD
     C                     MOVE WUZASF    #DFLAS
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL*BLANK    #DFLAS           Fx Limit Amount
     C                     END                             *FI
      * LN Limit Amount
      *CASE:     DB1.Lending Limit Amount is not equal zero
     C           DXLLAM    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVELDXLLAM    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0040  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0041 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0042  10       ZALIGN No Of De
     C                     PARM 9         WQ0043  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0044 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Error detected ?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *CASE:     PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ @CN,04                     *IF
     C                     MOVEL@CN,01    WUERCD           Err Code
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL@CN,03    WUERCD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0045 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0046  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
     C                     END                             *FI
      * ZALIGN LN Limit Amount - Region Limits  *
     C*
     C* MOVE ZALIGN SCREEN FUNCTION FIELD INTO LN LIMIT AMOUNT
     C* SCREEN FUNCTION FIELD
     C                     MOVE WUZASF    #DLLAS
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL*BLANK    #DLLAS           LN Limit Amount
     C                     END                             *FI
      * FRA Limit Amount
      *CASE:     DB1.FRA Limit Amount is not equal zero
     C           DXFRLA    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVELDXFRLA    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0047  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0048 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0049  10       ZALIGN No Of De
     C                     PARM 9         WQ0050  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0051 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Error detected ?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *CASE:     PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ @CN,04                     *IF
     C                     MOVEL@CN,01    WUERCD           Err Code
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL@CN,03    WUERCD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0052 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0053  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
     C                     END                             *FI
      * ZALIGN FRA Limit Amount - Region Limits  *
     C*
     C* MOVE ZALIGN SCREEN FUNCTION FIELD INTO FRA LIMIT AMOUNT
     C* SCREEN FUNCTION FIELD
     C                     MOVE WUZASF    #DRLAS
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL*BLANK    #DRLAS           FRA Limit Amoun
     C                     END                             *FI
      * IRS Limit Amount
      *CASE:     DB1.IRS Limit Amount is not equal zero
     C           DXIRLM    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVELDXIRLM    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0054  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0055 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0056  10       ZALIGN No Of De
     C                     PARM 9         WQ0057  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0058 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Error detected ?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *CASE:     PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ @CN,04                     *IF
     C                     MOVEL@CN,01    WUERCD           Err Code
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL@CN,03    WUERCD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0059 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0060  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
     C                     END                             *FI
      * ZALIGN IRS Limit Amount - Region Limits  *
     C*
     C* MOVE ZALIGN SCREEN FUNCTION FIELD INTO IRS LIMIT AMOUNT
     C* SCREEN FUNCTION FIELD
     C                     MOVE WUZASF    #DILAS
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL*BLANK    #DILAS           IRS Limit Amoun
     C                     END                             *FI
      * FX Frequency Day Number
      *CASE:     DB1.FX Frequency Day No. is Not Zero
     C           DXFFDN    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVELDXFFDN    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0061  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0062 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0063  10       ZALIGN No Of De
     C                     PARM 2         WQ0064  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0065 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Error detected ?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *CASE:     PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ @CN,04                     *IF
     C                     MOVEL@CN,01    WUERCD           Err Code
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL@CN,03    WUERCD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0066 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0067  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
     C                     END                             *FI
      * ZALIGN FX Freq Day No - Region Limits  *
     C*
     C* MOVE ZALIGN SCREEN FUNCTION FIELD INTO FX FREQUENCY DAY NO
     C* SCREEN FUNCTION FIELD
     C                     MOVE WUZASF    #DFFDS
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL*BLANK    #DFFDS           FX Freq Day No
     C                     END                             *FI
      * LN Frequency Day Number
      *CASE:     DB1.Lending Frequency Day No. is Not Zero
     C           DXLFDN    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVELDXLFDN    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0068  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0069 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0070  10       ZALIGN No Of De
     C                     PARM 2         WQ0071  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0072 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Error detected ?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *CASE:     PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ @CN,04                     *IF
     C                     MOVEL@CN,01    WUERCD           Err Code
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL@CN,03    WUERCD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0073 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0074  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
     C                     END                             *FI
      * ZALIGN LN Freq Day No - Region Limits  *
     C*
     C* MOVE ZALIGN SCREEN FUNCTION FIELD INTO LN FREQUENCY DAY NO
     C* SCREEN FUNCTION FIELD
     C                     MOVE WUZASF    #DLFDS
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL*BLANK    #DLFDS           LN Freq Day No
     C                     END                             *FI
      * FRA Frequency Day Number
      *CASE:     DB1.FRA Frequency Day No. is Not Zero
     C           DXFRAD    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVELDXFRAD    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0075  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0076 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0077  10       ZALIGN No Of De
     C                     PARM 2         WQ0078  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0079 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Error detected ?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *CASE:     PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ @CN,04                     *IF
     C                     MOVEL@CN,01    WUERCD           Err Code
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL@CN,03    WUERCD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0080 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0081  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
     C                     END                             *FI
      * ZALIGN FRA Freq Day No - Region Limits  *
     C*
     C* MOVE ZALIGN SCREEN FUNCTION FIELD INTO FRA FREQUENCY DAY NO
     C* SCREEN FUNCTION FIELD
     C                     MOVE WUZASF    #DRFDS
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL*BLANK    #DRFDS           FRA Freq Day no
     C                     END                             *FI
      * IRS Frequency Day Number
      *CASE:     DB1.IRS Frequency Day No. is Not Zero
     C           DXIFDN    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVELDXIFDN    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0082  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0083 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0084  10       ZALIGN No Of De
     C                     PARM 2         WQ0085  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0086 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Error detected ?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *CASE:     PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ @CN,04                     *IF
     C                     MOVEL@CN,01    WUERCD           Err Code
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL@CN,03    WUERCD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0087 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0088  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
     C                     END                             *FI
      * ZALIGN IRS Freq Day No - Region Limits  *
     C*
     C* MOVE ZALIGN SCREEN FUNCTION FIELD INTO IRS FREQUENCY DAY NO
     C* SCREEN FUNCTION FIELD
     C                     MOVE WUZASF    #DIFDS
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL*BLANK    #DIFDS           IRS Freq Day no
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Set values for field not used in country limits
      *================================================================
     C                     MOVEL*BLANK    WUSECD           Secured
     C                     MOVEL*BLANK    WUMDAS           MDDR Amount Scr
     C                     Z-ADD*ZERO     WUMDDR           MDDR Amount
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Set Details Entered to Details  Entered
      *================================================================
     C                     MOVEL@CN,07    WUDTEN           Details Entered
     C                     MOVEL@CN,07    WUDELN           Details Entered
     C                     MOVEL@CN,07    WUDEFR           Details Entered
     C                     MOVEL@CN,07    WUDEIR           Details Entered
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Test for Blanks in Status fields
      *================================================================
      *CASE:     PAR.FX Limit Frequency is equal blank
     C           #1FLFQ    IFEQ *BLANK                     *IF
     C                     MOVEL@CN,08    WUBIFF           Blank in Freque
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL@CN,07    WUBIFF           Blank in Freque
     C                     END                             *FI
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * FX - Blank out file dates and numerics
      *================================================================
     C                     Z-ADD*ZERO     #1FLED           FX Limit Expiry
     C                     Z-ADD*ZERO     #1FLRD           FX Limit Review
     C                     Z-ADD*ZERO     #1FFDN           FX Frequency Da
     C                     Z-ADD*ZERO     #1FLAM           FX Limit Amount
     C                     Z-ADD*ZERO     WUMDDR           MDDR Amount
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Test for Blanks in Status fields
      *================================================================
      *CASE:     PAR.Secured is Blank
     C           WUSECD    IFEQ *BLANK                     *IF
     C                     MOVEL@CN,08    WUBISF           Blank in Secure
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL@CN,07    WUBISF           Blank in Secure
     C                     END                             *FI
      *CASE:     PAR.Lending Limit Frequency is equal blank
     C           #1LLFR    IFEQ *BLANK                     *IF
     C                     MOVEL@CN,08    WUBIFF           Blank in Freque
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL@CN,07    WUBIFF           Blank in Freque
     C                     END                             *FI
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * LN - Blank out file dates and numerics
      *================================================================
     C                     Z-ADD*ZERO     #1LLED           Lending Limit E
     C                     Z-ADD*ZERO     #1LLRD           Lending Limit R
     C                     Z-ADD*ZERO     #1LFDN           Lending Frequen
     C                     Z-ADD*ZERO     #1LLAM           Lending Limit A
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * Test for Blanks in Status fields
      *================================================================
      *CASE:     PAR.FRA Review Frequency is equal blank
     C           #1FRFQ    IFEQ *BLANK                     *IF
     C                     MOVEL@CN,08    WUBIFF           Blank in Freque
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL@CN,07    WUBIFF           Blank in Freque
     C                     END                             *FI
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         UJSUBR    BEGSR
      *================================================================
      * FRA - Blank out file dates and numerics
      *================================================================
     C                     Z-ADD*ZERO     #1FRED           FRA Expiry Date
     C                     Z-ADD*ZERO     #1FRRD           FRA Review Date
     C                     Z-ADD*ZERO     #1FRAD           FRA Frequency D
     C                     Z-ADD*ZERO     #1FRLA           FRA Limit Amoun
      *================================================================
     CSR         UJEXIT    ENDSR
      /EJECT
     CSR         UKSUBR    BEGSR
      *================================================================
      * Test for Blanks in Status fields
      *================================================================
      *CASE:     PAR.IRS Review Frequency is equal blank
     C           #1IRFQ    IFEQ *BLANK                     *IF
     C                     MOVEL@CN,08    WUBIFF           Blank in Freque
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL@CN,07    WUBIFF           Blank in Freque
     C                     END                             *FI
      *================================================================
     CSR         UKEXIT    ENDSR
      /EJECT
     CSR         ULSUBR    BEGSR
      *================================================================
      * IRS - blank out file dates and numerics
      *================================================================
     C                     Z-ADD*ZERO     #1IRED           IRS Expiry Date
     C                     Z-ADD*ZERO     #1IRDT           IRS Review Date
     C                     Z-ADD*ZERO     #1IFDN           IRS Frequency D
     C                     Z-ADD*ZERO     #1IRLM           IRS Limit Amoun
      *================================================================
     CSR         ULEXIT    ENDSR
      /EJECT
     CSR         UMSUBR    BEGSR
      *================================================================
      * Validate FX Fields
      *================================================================
      *CASE:     WRK.Details Entered is Details Entered
     C           WUDTEN    IFEQ @CN,07                     *IF
      * Reset Error Fields
     C                     EXSR UNSUBR                     Reset Error Fie
      * FX Limit Amount must be greater than zero
     C                     EXSR UOSUBR                     FX Limit Amount
      * Validate FX Expiry Date
      *CASE:     PAR.FX Expiry Date Screen DS is Not Equal Blank
     C           #DSFED    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DSFED    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0100  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0101 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0102  10       ZALIGN No Of De
     C                     PARM 6         WQ0103  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0104 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Error detected ?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *CASE:     PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ @CN,04                     *IF
     C                     MOVEL@CN,01    WUIEDT           Err Code
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL@CN,03    WUIEDT           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0105 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0106  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
     C                     END                             *FI
      *CASE:     WRK.Invalid Expiry Date is Error Found
     C           WUIEDT    IFEQ @CN,01                     *IF
      * Setup message data for message.
     C                     MOVEL#DSFED    ZA0024           FX Expiry Date
      * Send message 'Expiry Date Numeric'
     C                     MOVEL'USR0808' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9935  *
      *
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVE WUZAFF    WUWSDT           Work Screen Dat
      * Check Screen Date - Rundate  *
     C                     CALL 'ZDATE1'               90  Check Screen Da
     C           W0RTN     PARM W0RTN     WQ0107  7        *Return code
     C           WUWSDT    PARM WUWSDT    WQ0108  60       Work Screen Dat
     C           WUDFF     PARM WUDFF     WQ0109  1        Date format fla
     C           #1FLED    PARM *ZERO     WQ0110  50       Work File Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Error detected ?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Test for an Invalid Date
      *CASE:     PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ @CN,04                     *IF
      * Setup message data for message.
     C                     MOVEL#DSFED    ZA0025           FX Expiry Date
      * Send message 'FX Expiry Date is Invalid'
     C                     MOVEL'USR0730' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9935  *
      *
     C                     MOVEL@CN,01    WUIEDT           Invalid Expiry
     C                     ELSE
      *CASE:     *OTHERWISE
      * Test for date less than rundat
      *CASE:     PAR.FX Limit Expiry Date LE PAR.Run day number
     C           #1FLED    IFLE WURDNB                     *IF
      * Setup message data for message.
     C                     MOVEL#DSFED    ZA0026           FX Expiry Date
     C                     MOVELWUMRDT    ZA0027           Midas Run Date
      * Send message 'Forex Expiry Date must be'
     C                     MOVEL'USR0160' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9935  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     Z-ADD*ZERO     #1FLED           FX Limit Expiry
     C                     END                             *FI
      * Validate FX Review Date
      *CASE:     PAR.FX Review Date Screen DS is Not Equal Blank
     C           #DSFRD    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DSFRD    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0111  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0112 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0113  10       ZALIGN No Of De
     C                     PARM 6         WQ0114  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0115 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Error detected ?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *CASE:     PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ @CN,04                     *IF
     C                     MOVEL@CN,01    WUINRD           Err Code
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL@CN,03    WUINRD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0116 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0117  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
     C                     END                             *FI
      *CASE:     WRK.Invalid Review Date is Error Found
     C           WUINRD    IFEQ @CN,01                     *IF
      * Setup message data for message.
     C                     MOVEL#DSFRD    ZA0028           FX Review Date
      * Send message 'Review Date Numeric'
     C                     MOVEL'USR0809' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9937  *
      *
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVE WUZAFF    WUWSDT           Work Screen Dat
      * Check Screen Date - Rundate  *
     C                     CALL 'ZDATE1'               90  Check Screen Da
     C           W0RTN     PARM W0RTN     WQ0118  7        *Return code
     C           WUWSDT    PARM WUWSDT    WQ0119  60       Work Screen Dat
     C           WUDFF     PARM WUDFF     WQ0120  1        Date format fla
     C           #1FLRD    PARM *ZERO     WQ0121  50       Work File Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Error detected ?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Test for an Invalid Date
      *CASE:     PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ @CN,04                     *IF
      * Setup message data for message.
     C                     MOVEL#DSFRD    ZA0029           FX Review Date
      * Send message 'FX Review Date is Invalid'
     C                     MOVEL'USR0733' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9937  *
      *
     C                     MOVEL@CN,01    WUINRD           Invalid Review
     C                     ELSE
      *CASE:     *OTHERWISE
      *CASE:     PAR.FX Limit Review Date LE PAR.Run day number
     C           #1FLRD    IFLE WURDNB                     *IF
      * Setup message data for message.
     C                     MOVEL#DSFRD    ZA0030           FX Review Date
     C                     MOVELWUMRDT    ZA0031           Midas Run Date
      * Send message 'FX Rev Date after Rundat'
     C                     MOVEL'USR0816' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9937  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     Z-ADD*ZERO     #1FLRD           FX Limit Review
     C                     END                             *FI
      * Cross Validate Expiry and Review Dates
      *CASE:     PAR.FX Review Date Screen DS is Not Equal Blank
     C           #DSFRD    IFNE *BLANK                     *IF
      *CASE:     PAR.FX Expiry Date Screen DS is Equal Blank
     C           #DSFED    IFEQ *BLANK                     *IF
      * Setup message data for message.
     C                     MOVEL#DSFED    ZA0032           FX Expiry Date
      * Send message 'FX Expiry Date Required'
     C                     MOVEL'USR0796' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9935  *
      *
     C                     ELSE
      *CASE:     *OTHERWISE
      *CASE:     WRK.Invalid Review Date is Error Not Found
     C           WUINRD    IFEQ @CN,03                     *IF
      *CASE:     WRK.Invalid Expiry Date is Error Not Found
     C           WUIEDT    IFEQ @CN,03                     *IF
      * FX Review date LT Expiry Date
      *CASE:     PAR.FX Limit Review Date GE PAR.FX Limit Expiry Date
     C           #1FLRD    IFGE #1FLED                     *IF
      * Setup message data for message.
     C                     MOVEL#DSFRD    ZA0033           FX Review Date
      * Send message 'Fx Rev Date Aft Exp Date'
     C                     MOVEL'USR0678' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9937  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate FX Review Frequency
      *CASE:     PAR.FX Review Date Screen DS is Not Equal Blank
     C           #DSFRD    IFNE *BLANK                     *IF
      * Frequency Code must be entered
      *CASE:     PAR.FX Limit Frequency is equal blank
     C           #1FLFQ    IFEQ *BLANK                     *IF
      * Setup message data for message.
     C                     MOVEL#1FLFQ    ZA0034           FX Limit Freque
      * Send message 'FX Limit Freq Required'
     C                     MOVEL'USR0679' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9939  *
      *
     C                     END                             *FI
     C                     ELSE
      *CASE:     *OTHERWISE
      * Frequency Code must be left blank
      *CASE:     PAR.FX Limit Frequency is equal blank
     C           #1FLFQ    IFEQ *BLANK                     *IF
      * No action required
     C                     ELSE
      *CASE:     *OTHERWISE
      * Setup message data for message.
     C                     MOVEL#1FLFQ    ZA0035           FX Limit Freque
      * Send message 'FX Limit Freq Blank'
     C                     MOVEL'USR0739' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9939  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate FX Review Frequency Type
      *CASE:     PAR.FX Limit Frequency is *ALL values
     C           #1FLFQ    IFEQ @CN,09                     *IF
     C           #1FLFQ    OREQ @CN,10
     C           #1FLFQ    OREQ @CN,11
     C           #1FLFQ    OREQ @CN,12
     C           #1FLFQ    OREQ @CN,13
     C           #1FLFQ    OREQ @CN,14
     C           #1FLFQ    OREQ @CN,15
     C           #1FLFQ    OREQ @CN,16
     C           #1FLFQ    OREQ @CN,17
     C           #1FLFQ    OREQ @CN,01
     C           #1FLFQ    OREQ @CN,18
     C           #1FLFQ    OREQ @CN,06
     C           #1FLFQ    OREQ @CN,19
     C           #1FLFQ    OREQ @CN,20
     C           #1FLFQ    OREQ @CN,21
     C           #1FLFQ    OREQ @CN,22
     C           #1FLFQ    OREQ @CN,23
     C           #1FLFQ    OREQ @CN,24
     C           #1FLFQ    OREQ *BLANK
      * Valid Limit Frequency.  No action Required
     C                     ELSE
      *CASE:     *OTHERWISE
      * Invalid Frequency Code
      * Setup message data for message.
     C                     MOVEL#1FLFQ    ZA0036           FX Limit Freque
      * Send message 'FX Limit Frequency inval'
     C                     MOVEL'USR0680' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9939  *
      *
     C                     END                             *FI
      * Convert Frequency Day Number
     C                     EXSR UPSUBR                     Convert Frequen
      * If Freq is M,T,Q,X,or Y then Freq Day No must be 00-31, otherwise blank
      *CASE:     PAR.FX Limit Frequency is M,T,Q,X,Y
     C           #1FLFQ    IFEQ @CN,11                     *IF
     C           #1FLFQ    OREQ @CN,09
     C           #1FLFQ    OREQ @CN,16
     C           #1FLFQ    OREQ @CN,17
     C           #1FLFQ    OREQ @CN,01
      *CASE:     WRK.Invalid Frequency Day No is Error Not Found
     C           WUIFQD    IFEQ @CN,03                     *IF
      * Frequency Day Number must be between 00-31
      *CASE:     PAR.FX Freq Day Number DS is Equal Blank
     C           #DFFDS    IFEQ *BLANK                     *IF
      * Setup message data for message.
     C                     MOVEL#DFFDS    ZA0038           FX Freq Day Num
      * Send message 'Frequency Day No. Req'
     C                     MOVEL'USR0681' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9941  *
      *
     C                     ELSE
      *CASE:     PAR.FX Frequency Day No. is Greater than 31
     C           #1FFDN    IFGT 31                         *IF
      * Setup message data for message.
     C                     MOVEL#DFFDS    ZA0039           FX Freq Day Num
      * Send message 'FX Frequency Day No. Inv'
     C                     MOVEL'USR0682' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9941  *
      *
     C                     ELSE
      *CASE:     PAR.FX Frequency Day No. is Less than or EQ Zero
     C           #1FFDN    IFLE *ZERO                      *IF
      * Setup message data for message.
     C                     MOVEL#DFFDS    ZA0040           FX Freq Day Num
      * Send message 'FX Frequency Day No. Inv'
     C                     MOVEL'USR0682' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9941  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      *CASE:     *OTHERWISE
      * Frequency Day Number must be blank
      *CASE:     PAR.FX Freq Day Number DS is Not Equal Blank
     C           #DFFDS    IFNE *BLANK                     *IF
      * Setup message data for message.
     C                     MOVEL#DFFDS    ZA0041           FX Freq Day Num
      * Send message 'FX Freq Day no - Blank'
     C                     MOVEL'USR0683' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9941  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate MDDR Amount
      *CASE:     JOB.*PROGRAM is Country or Region Limits
     C           ##PGM     IFEQ @CN,25                     *IF
     C           ##PGM     OREQ @CN,26
      * MDDR Amount Not used for this function.
     C                     ELSE
      *CASE:     *OTHERWISE
      *CASE:     PAR.MDDR Amount Screen is Not Equal Blank
     C           WUMDAS    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVELWUMDAS    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0129  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0130 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0131  10       ZALIGN No Of De
     C                     PARM 9         WQ0132  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0133 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Error detected ?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *CASE:     PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ @CN,04                     *IF
     C                     MOVEL@CN,01    WUIMDA           Err Code
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL@CN,03    WUIMDA           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0134 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0135  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
     C                     END                             *FI
      *CASE:     WRK.Invalid MDDR Amount is Error Found
     C           WUIMDA    IFEQ @CN,01                     *IF
      * Setup message data for message.
     C                     MOVELWUMDAS    ZA0042           MDDR Amount Scr
      * Send message 'MDDR Amount must Numeric'
     C                     MOVEL'USR0792' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     99    *
      *
     C                     ELSE
      *CASE:     *OTHERWISE
      * ZALIGN MDDR Amount - Region Limits  *
     C*
     C* MOVE ZALIGN SCREEN FUNCTION FIELD INTO FX MDDR AMOUNT
     C* SCREEN FUNCTION FIELD
     C                     MOVE WUZASF    WUMDAS
     C                     MOVE WUZAFF    WUMDDR           MDDR Amount
      *CASE:     PAR.MDDR Amount is Zero
     C           WUMDDR    IFEQ *ZERO                      *IF
      * Setup message data for message.
     C                     MOVELWUMDAS    ZA0043           MDDR Amount Scr
      * Send message 'FX MDDR Amount invalid'
     C                     MOVEL'USR0684' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     99    *
      *
     C                     ELSE
      *CASE:     *OTHERWISE
      * Validate MDDR amount against Limit Amount
      *CASE:     WRK.Invalid Limit Amount is Error Not Found
     C           WUILAM    IFEQ @CN,03                     *IF
      *CASE:     PAR.FX Limit Amount Screen DS is Equal Blank
     C           #DFLAS    IFEQ *BLANK                     *IF
      * Cannot validate against limit amount.
     C                     ELSE
      *CASE:     PAR.MDDR Amount GE PAR.FX Limit Amount
     C           WUMDDR    IFGE #1FLAM                     *IF
      * Setup message data for message.
     C                     MOVELWUMDAS    ZA0044           MDDR Amount Scr
      * Send message 'FX MDDR Amount invalid'
     C                     MOVEL'USR0684' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      *CASE:     *OTHERWISE
      * Setup message data for message.
     C                     MOVELWUMDAS    ZA0045           MDDR Amount Scr
      * Send message 'MDDR amount is required'
     C                     MOVEL'USR0815' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UMEXIT    ENDSR
      /EJECT
     CSR         UNSUBR    BEGSR
      *================================================================
      * Reset Error Fields
      *================================================================
     C                     MOVEL@CN,03    WUERCD           Err Code
     C                     MOVEL@CN,03    WUILAM           Invalid Limit A
     C                     MOVEL@CN,03    WUIFQD           Invalid Frequen
      *================================================================
     CSR         UNEXIT    ENDSR
      /EJECT
     CSR         UOSUBR    BEGSR
      *================================================================
      * FX Limit Amount must be greater than zero
      *================================================================
      *CASE:     PAR.FX Limit Amount Screen DS is Equal Blank
     C           #DFLAS    IFEQ *BLANK                     *IF
      * Setup message data for message.
     C                     MOVEL#DFLAS    ZA0021           FX Limit Amount
      * Send message 'FX Limit Amount Required'
     C                     MOVEL'USR0729' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9933  *
      *
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DFLAS    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0093  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0094 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0095  10       ZALIGN No Of De
     C                     PARM 9         WQ0096  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0097 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Error detected ?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *CASE:     PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ @CN,04                     *IF
     C                     MOVEL@CN,01    WUILAM           Err Code
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL@CN,03    WUILAM           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0098 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0099  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
     C                     END                             *FI
      *CASE:     WRK.Invalid Limit Amount is Error Found
     C           WUILAM    IFEQ @CN,01                     *IF
      * Setup message data for message.
     C                     MOVEL#DFLAS    ZA0022           FX Limit Amount
      * Send message 'Limit Amount Not Numeric'
     C                     MOVEL'USR0788' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9933  *
      *
     C                     ELSE
      *CASE:     *OTHERWISE
      * ZALIGN FX Limit Amount - Region Limits  *
     C*
     C* MOVE ZALIGN SCREEN FUNCTION FIELD INTO FX LIMIT AMOUNT
     C* SCREEN FUNCTION FIELD
     C                     MOVE WUZASF    #DFLAS
     C                     MOVE WUZAFF    #1FLAM           FX Limit Amount
      *CASE:     PAR.FX Limit Amount is equal zero
     C           #1FLAM    IFEQ *ZERO                      *IF
      * Setup message data for message.
     C                     MOVEL#DFLAS    ZA0023           FX Limit Amount
      * Send message 'FX Limit Amount GT Zero'
     C                     MOVEL'USR0834' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9933  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UOEXIT    ENDSR
      /EJECT
     CSR         UPSUBR    BEGSR
      *================================================================
      * Convert Frequency Day Number
      *================================================================
      *CASE:     PAR.FX Freq Day Number DS is Not Equal Blank
     C           #DFFDS    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DFFDS    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0122  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0123 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0124  10       ZALIGN No Of De
     C                     PARM 9         WQ0125  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0126 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Error detected ?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *CASE:     PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ @CN,04                     *IF
     C                     MOVEL@CN,01    WUIFQD           Err Code
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL@CN,03    WUIFQD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0127 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0128  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
     C                     END                             *FI
      *CASE:     WRK.Invalid Frequency Day No is Error Found
     C           WUIFQD    IFEQ @CN,01                     *IF
      * Setup message data for message.
     C                     MOVEL#DFFDS    ZA0037           FX Freq Day Num
      * Send message 'Freq Day Num Must Numeric'
     C                     MOVEL'USR0793' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9941  *
      *
     C                     ELSE
      *CASE:     *OTHERWISE
      * ZALIGN FX Freq Day No - Region Limits  *
     C*
     C* MOVE ZALIGN SCREEN FUNCTION FIELD INTO FX FREQUENCY DAY NO
     C* SCREEN FUNCTION FIELD
     C                     MOVE WUZASF    #DFFDS
     C                     MOVE WUZAFF    #1FFDN           FX Frequency Da
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UPEXIT    ENDSR
      /EJECT
     CSR         UQSUBR    BEGSR
      *================================================================
      * Validate LN Fields
      *================================================================
      *CASE:     WRK.Details Entered - LN is Details Entered
     C           WUDELN    IFEQ @CN,07                     *IF
      * Reset Error Fields
     C                     EXSR URSUBR                     Reset Error Fie
      * LN Limit Amount must be greater than zero
      *CASE:     PAR.LN Limit Amount Screen DS is Equal Blank
     C           #DLLAS    IFEQ *BLANK                     *IF
      * Setup message data for message.
     C                     MOVEL#DLLAS    ZA0046           LN Limit Amount
      * Send message 'Lending Limit Amt Req'
     C                     MOVEL'USR0687' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9934  *
      *
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DLLAS    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0136  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0137 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0138  10       ZALIGN No Of De
     C                     PARM 9         WQ0139  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0140 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Error detected ?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *CASE:     PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ @CN,04                     *IF
     C                     MOVEL@CN,01    WUILAM           Err Code
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL@CN,03    WUILAM           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0141 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0142  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
     C                     END                             *FI
      *CASE:     WRK.Invalid Limit Amount is Error Found
     C           WUILAM    IFEQ @CN,01                     *IF
      * Setup message data for message.
     C                     MOVEL#DLLAS    ZA0047           LN Limit Amount
      * Send message 'Limit Amount Not Numeric'
     C                     MOVEL'USR0788' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9934  *
      *
     C                     ELSE
      *CASE:     *OTHERWISE
      * ZALIGN LN Limit Amount - Region Limits  *
     C*
     C* MOVE ZALIGN SCREEN FUNCTION FIELD INTO LN LIMIT AMOUNT
     C* SCREEN FUNCTION FIELD
     C                     MOVE WUZASF    #DLLAS
     C                     MOVE WUZAFF    #1LLAM           Lending Limit A
      *CASE:     PAR.Lending Limit Amount is Equal Zero
     C           #1LLAM    IFEQ *ZERO                      *IF
      * Setup message data for message.
     C                     MOVEL#DLLAS    ZA0048           LN Limit Amount
      * Send message 'LN Limit Amount GT Zero'
     C                     MOVEL'USR0835' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9934  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate LN Expiry Date
      *CASE:     PAR.LN Expiry Date Screen DS is Not Equal Blank
     C           #DSLED    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DSLED    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0143  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0144 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0145  10       ZALIGN No Of De
     C                     PARM 6         WQ0146  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0147 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Error detected ?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *CASE:     PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ @CN,04                     *IF
     C                     MOVEL@CN,01    WUIEDT           Err Code
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL@CN,03    WUIEDT           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0148 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0149  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
     C                     END                             *FI
      *CASE:     WRK.Invalid Expiry Date is Error Found
     C           WUIEDT    IFEQ @CN,01                     *IF
      * Setup message data for message.
     C                     MOVEL#DSLED    ZA0049           LN Expiry Date
      * Send message 'Expiry Date Numeric'
     C                     MOVEL'USR0808' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9936  *
      *
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVE WUZAFF    WUWSDT           Work Screen Dat
      * Check Screen Date - Rundate  *
     C                     CALL 'ZDATE1'               90  Check Screen Da
     C           W0RTN     PARM W0RTN     WQ0150  7        *Return code
     C           WUWSDT    PARM WUWSDT    WQ0151  60       Work Screen Dat
     C           WUDFF     PARM WUDFF     WQ0152  1        Date format fla
     C           #1LLED    PARM *ZERO     WQ0153  50       Work File Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Error detected ?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Test for an Invalid Date
      *CASE:     PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ @CN,04                     *IF
      * Setup message data for message.
     C                     MOVEL#DSLED    ZA0050           LN Expiry Date
      * Send message 'LN Expiry Date is Invalid'
     C                     MOVEL'USR0731' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9936  *
      *
     C                     MOVEL@CN,01    WUIEDT           Invalid Expiry
     C                     ELSE
      *CASE:     *OTHERWISE
      * Test for date less than rundat
      *CASE:     PAR.Lending Limit Expiry Date LE PAR.Run day number
     C           #1LLED    IFLE WURDNB                     *IF
      * Setup message data for message.
     C                     MOVEL#DSLED    ZA0051           LN Expiry Date
     C                     MOVELWUMRDT    ZA0052           Midas Run Date
      * Send message 'LN Exp Date After Rundat'
     C                     MOVEL'USR0689' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9936  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     Z-ADD*ZERO     #1LLED           Lending Limit E
     C                     END                             *FI
      * Validate LN Review Date
      *CASE:     PAR.LN Review Date Screen DS is Not Equal Blank
     C           #DSLRD    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DSLRD    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0154  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0155 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0156  10       ZALIGN No Of De
     C                     PARM 6         WQ0157  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0158 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Error detected ?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *CASE:     PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ @CN,04                     *IF
     C                     MOVEL@CN,01    WUINRD           Err Code
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL@CN,03    WUINRD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0159 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0160  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
     C                     END                             *FI
      *CASE:     WRK.Invalid Review Date is Error Found
     C           WUINRD    IFEQ @CN,01                     *IF
      * Setup message data for message.
     C                     MOVEL#DSLRD    ZA0053           LN Review Date
      * Send message 'Review Date Numeric'
     C                     MOVEL'USR0809' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9938  *
      *
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVE WUZAFF    WUWSDT           Work Screen Dat
      * Check Screen Date - Rundate  *
     C                     CALL 'ZDATE1'               90  Check Screen Da
     C           W0RTN     PARM W0RTN     WQ0161  7        *Return code
     C           WUWSDT    PARM WUWSDT    WQ0162  60       Work Screen Dat
     C           WUDFF     PARM WUDFF     WQ0163  1        Date format fla
     C           #1LLRD    PARM *ZERO     WQ0164  50       Work File Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Error detected ?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Test for an Invalid Date
      *CASE:     PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ @CN,04                     *IF
      * Setup message data for message.
     C                     MOVEL#DSLRD    ZA0054           LN Review Date
      * Send message 'LN Review Date is Invalid'
     C                     MOVEL'USR0732' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9938  *
      *
     C                     MOVEL@CN,01    WUINRD           Invalid Review
     C                     ELSE
      *CASE:     *OTHERWISE
      *CASE:     PAR.Lending Limit Review Date LE PAR.Run day number
     C           #1LLRD    IFLE WURDNB                     *IF
      * Setup message data for message.
     C                     MOVEL#DSLRD    ZA0055           LN Review Date
     C                     MOVELWUMRDT    ZA0056           Midas Run Date
      * Send message 'LN Rev Date after Rundat'
     C                     MOVEL'USR0817' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9938  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     Z-ADD*ZERO     #1LLRD           Lending Limit R
     C                     END                             *FI
      * Cross Validate Expiry and Review dates
      *CASE:     PAR.LN Review Date Screen DS is Not Equal Blank
     C           #DSLRD    IFNE *BLANK                     *IF
      *CASE:     PAR.LN Expiry Date Screen DS is Equal Blank
     C           #DSLED    IFEQ *BLANK                     *IF
      * Setup message data for message.
     C                     MOVEL#DSLED    ZA0057           LN Expiry Date
      * Send message 'LN Expiry Date Required'
     C                     MOVEL'USR0797' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9936  *
      *
     C                     ELSE
      *CASE:     *OTHERWISE
      *CASE:     WRK.Invalid Review Date is Error Not Found
     C           WUINRD    IFEQ @CN,03                     *IF
      *CASE:     WRK.Invalid Expiry Date is Error Not Found
     C           WUIEDT    IFEQ @CN,03                     *IF
      * LN Review date LT Expiry Date
      *CASE:     PAR.Lending Limit Review Date GE PAR.Lending Limit Expiry Date
     C           #1LLRD    IFGE #1LLED                     *IF
      * Setup message data for message.
     C                     MOVEL#DSLRD    ZA0058           LN Review Date
      * Send message 'LN Rev Date bef Exp Date'
     C                     MOVEL'USR0690' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9938  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate LN Review Frequency
      *CASE:     PAR.LN Review Date Screen DS is Not Equal Blank
     C           #DSLRD    IFNE *BLANK                     *IF
      * Frequency Code must be entered
      *CASE:     PAR.Lending Limit Frequency is equal blank
     C           #1LLFR    IFEQ *BLANK                     *IF
      * Setup message data for message.
     C                     MOVEL#1LLFR    ZA0059           Lending Limit F
      * Send message 'LN Limit Freq Required'
     C                     MOVEL'USR0712' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9940  *
      *
     C                     END                             *FI
     C                     ELSE
      *CASE:     *OTHERWISE
      * Frequency Code must be left blank
      *CASE:     PAR.Lending Limit Frequency is equal blank
     C           #1LLFR    IFEQ *BLANK                     *IF
      * No action required
     C                     ELSE
      *CASE:     *OTHERWISE
      * Setup message data for message.
     C                     MOVEL#1LLFR    ZA0060           Lending Limit F
      * Send message 'LN Limit Freq Blank'
     C                     MOVEL'USR0714' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9940  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate LN Limit Frequency Type
      *CASE:     PAR.Lending Limit Frequency is *ALL values
     C           #1LLFR    IFEQ @CN,09                     *IF
     C           #1LLFR    OREQ @CN,10
     C           #1LLFR    OREQ @CN,11
     C           #1LLFR    OREQ @CN,12
     C           #1LLFR    OREQ @CN,13
     C           #1LLFR    OREQ @CN,14
     C           #1LLFR    OREQ @CN,15
     C           #1LLFR    OREQ @CN,16
     C           #1LLFR    OREQ @CN,17
     C           #1LLFR    OREQ @CN,01
     C           #1LLFR    OREQ @CN,18
     C           #1LLFR    OREQ @CN,06
     C           #1LLFR    OREQ @CN,19
     C           #1LLFR    OREQ @CN,20
     C           #1LLFR    OREQ @CN,21
     C           #1LLFR    OREQ @CN,22
     C           #1LLFR    OREQ @CN,23
     C           #1LLFR    OREQ @CN,24
     C           #1LLFR    OREQ *BLANK
      * Valid Limit Frequency.  No action Required
     C                     ELSE
      *CASE:     *OTHERWISE
      * Invalid Frequency Code
      * Setup message data for message.
     C                     MOVEL#1LLFR    ZA0061           Lending Limit F
      * Send message 'LN Limit Freq Invalid'
     C                     MOVEL'USR0713' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9940  *
      *
     C                     END                             *FI
      * Convert Frequency Day Number
     C                     EXSR USSUBR                     Convert Frequen
      * If Freq is M,T,Q,X,or Y then Freq Day No must be 01-31, otherwise blank
      *CASE:     PAR.Lending Limit Frequency is M,T,Q,X,Y
     C           #1LLFR    IFEQ @CN,11                     *IF
     C           #1LLFR    OREQ @CN,09
     C           #1LLFR    OREQ @CN,16
     C           #1LLFR    OREQ @CN,17
     C           #1LLFR    OREQ @CN,01
      *CASE:     WRK.Invalid Frequency Day No is Error Not Found
     C           WUIFQD    IFEQ @CN,03                     *IF
      * Frequency Day Number must be between 01-31
      *CASE:     PAR.LN Freq Day Number DS is Equal Blank
     C           #DLFDS    IFEQ *BLANK                     *IF
      * Setup message data for message.
     C                     MOVEL#DLFDS    ZA0063           LN Freq Day Num
      * Send message 'LN Freq Day No Required'
     C                     MOVEL'USR0715' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9942  *
      *
     C                     ELSE
      *CASE:     PAR.Lending Frequency Day No. is Greater Than 31
     C           #1LFDN    IFGT 31                         *IF
      * Setup message data for message.
     C                     MOVEL#DLFDS    ZA0064           LN Freq Day Num
      * Send message 'LN Freq Day No Invalid'
     C                     MOVEL'USR0716' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9942  *
      *
     C                     ELSE
      *CASE:     PAR.Lending Frequency Day No. is Less Than or EQ Zero
     C           #1LFDN    IFLE *ZERO                      *IF
      * Setup message data for message.
     C                     MOVEL#DLFDS    ZA0065           LN Freq Day Num
      * Send message 'LN Freq Day No Invalid'
     C                     MOVEL'USR0716' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9942  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      *CASE:     *OTHERWISE
      * Frequency Day Number must be blank
      *CASE:     PAR.LN Freq Day Number DS is Not Equal Blank
     C           #DLFDS    IFNE *BLANK                     *IF
      * Setup message data for message.
     C                     MOVEL#DLFDS    ZA0066           LN Freq Day Num
      * Send message 'LN Freq Day No - Blank'
     C                     MOVEL'USR0717' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9942  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate Secured if used
      *CASE:     JOB.*PROGRAM is Country or Region Limits
     C           ##PGM     IFEQ @CN,25                     *IF
     C           ##PGM     OREQ @CN,26
      * Secured Not Used in this function
     C                     ELSE
      *CASE:     *OTHERWISE
      *CASE:     PAR.Secured is Yes or Blank
     C           WUSECD    IFEQ *BLANK                     *IF
     C           WUSECD    OREQ @CN,01
      * Valid Value. No action reuired
     C                     ELSE
      *CASE:     *OTHERWISE
      * Setup message data for message.
     C                     MOVELWUSECD    ZA0067           Secured
      * Send message 'LN Secured is Invalid'
     C                     MOVEL'USR0718' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UQEXIT    ENDSR
      /EJECT
     CSR         URSUBR    BEGSR
      *================================================================
      * Reset Error Fields
      *================================================================
     C                     MOVEL@CN,03    WUERCD           Err Code
     C                     MOVEL@CN,03    WUILAM           Invalid Limit A
     C                     MOVEL@CN,03    WUIFQD           Invalid Frequen
      *================================================================
     CSR         UREXIT    ENDSR
      /EJECT
     CSR         USSUBR    BEGSR
      *================================================================
      * Convert Frequency Day Number
      *================================================================
      *CASE:     PAR.LN Freq Day Number DS is Not Equal Blank
     C           #DLFDS    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DLFDS    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0165  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0166 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0167  10       ZALIGN No Of De
     C                     PARM 9         WQ0168  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0169 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Error detected ?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *CASE:     PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ @CN,04                     *IF
     C                     MOVEL@CN,01    WUIFQD           Err Code
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL@CN,03    WUIFQD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0170 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0171  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
     C                     END                             *FI
      *CASE:     WRK.Invalid Frequency Day No is Error Found
     C           WUIFQD    IFEQ @CN,01                     *IF
      * Setup message data for message.
     C                     MOVEL#DLFDS    ZA0062           LN Freq Day Num
      * Send message 'Freq Day Num Must Numeric'
     C                     MOVEL'USR0793' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9942  *
      *
     C                     ELSE
      *CASE:     *OTHERWISE
      * ZALIGN LN Freq Day No - Region Limits  *
     C*
     C* MOVE ZALIGN SCREEN FUNCTION FIELD INTO LN FREQUENCY DAY NO
     C* SCREEN FUNCTION FIELD
     C                     MOVE WUZASF    #DLFDS
     C                     MOVE WUZAFF    #1LFDN           Lending Frequen
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         USEXIT    ENDSR
      /EJECT
     CSR         UTSUBR    BEGSR
      *================================================================
      * Convert FRA Limit Amount
      *================================================================
      *CASE:     PAR.FRA Limit Amount Scrn DS is Not Equal Blank
     C           #DRLAS    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DRLAS    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0172  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0173 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0174  10       ZALIGN No Of De
     C                     PARM 9         WQ0175  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0176 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Error detected ?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *CASE:     PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ @CN,04                     *IF
     C                     MOVEL@CN,01    WUILAM           Err Code
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL@CN,03    WUILAM           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0177 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0178  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
     C                     END                             *FI
      *CASE:     WRK.Invalid Limit Amount is Error Found
     C           WUILAM    IFEQ @CN,01                     *IF
      * Setup message data for message.
     C                     MOVEL#DRLAS    ZA0068           FRA Limit Amoun
      * Send message 'Limit Amount Not Numeric'
     C                     MOVEL'USR0788' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9943  *
      *
     C                     ELSE
      *CASE:     *OTHERWISE
      * ZALIGN FRA Limit Amount - Region Limits  *
     C*
     C* MOVE ZALIGN SCREEN FUNCTION FIELD INTO FRA LIMIT AMOUNT
     C* SCREEN FUNCTION FIELD
     C                     MOVE WUZASF    #DRLAS
     C                     MOVE WUZAFF    #1FRLA           FRA Limit Amoun
      *CASE:     PAR.FRA Limit Amount is equal zero
     C           #1FRLA    IFEQ *ZERO                      *IF
      * Setup message data for message.
     C                     MOVEL#DRLAS    ZA0069           FRA Limit Amoun
      * Send message 'FRA Limit Amount GT Zero'
     C                     MOVEL'USR0836' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9943  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UTEXIT    ENDSR
      /EJECT
     CSR         UUSUBR    BEGSR
      *================================================================
      * Validate FRA Fields
      *================================================================
      *CASE:     WRK.Details Entered - FRA is Details Entered
     C           WUDEFR    IFEQ @CN,07                     *IF
      * Reset Error Fields
     C                     EXSR UVSUBR                     Reset Error Fie
      * Validate FRA Expiry Date
      *CASE:     PAR.FRA Expiry Date Screen DS is Not Equal Blank
     C           #DSRED    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DSRED    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0179  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0180 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0181  10       ZALIGN No Of De
     C                     PARM 6         WQ0182  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0183 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Error detected ?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *CASE:     PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ @CN,04                     *IF
     C                     MOVEL@CN,01    WUIEDT           Err Code
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL@CN,03    WUIEDT           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0184 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0185  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
     C                     END                             *FI
      *CASE:     WRK.Invalid Expiry Date is Error Found
     C           WUIEDT    IFEQ @CN,01                     *IF
      * Setup message data for message.
     C                     MOVEL#DSRED    ZA0070           FRA Expiry Date
      * Send message 'Expiry Date Numeric'
     C                     MOVEL'USR0808' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9945  *
      *
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVE WUZAFF    WUWSDT           Work Screen Dat
      * Check Screen Date - Rundate  *
     C                     CALL 'ZDATE1'               90  Check Screen Da
     C           W0RTN     PARM W0RTN     WQ0186  7        *Return code
     C           WUWSDT    PARM WUWSDT    WQ0187  60       Work Screen Dat
     C           WUDFF     PARM WUDFF     WQ0188  1        Date format fla
     C           #1FRED    PARM *ZERO     WQ0189  50       Work File Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Error detected ?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Test for an Invalid Date
      *CASE:     PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ @CN,04                     *IF
      * Setup message data for message.
     C                     MOVEL#DSRED    ZA0071           FRA Expiry Date
      * Send message 'FRA Expiry Date invalid'
     C                     MOVEL'USR4119' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9945  *
      *
     C                     MOVEL@CN,01    WUIEDT           Invalid Expiry
     C                     ELSE
      *CASE:     *OTHERWISE
      * Test for date less than rundat
      *CASE:     PAR.FRA Expiry Date LE PAR.Run day number
     C           #1FRED    IFLE WURDNB                     *IF
      * Setup message data for message.
     C                     MOVEL#DSRED    ZA0072           FRA Expiry Date
     C                     MOVELWUMRDT    ZA0073           Midas Run Date
      * Send message 'FRA Exp Date not gt rundt'
     C                     MOVEL'USR4120' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9945  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     Z-ADD*ZERO     #1FRED           FRA Expiry Date
     C                     END                             *FI
      * Validate FRA Review Date
      *CASE:     PAR.FRA Review Date Screen DS is Not Equal Blank
     C           #DSRRD    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DSRRD    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0190  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0191 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0192  10       ZALIGN No Of De
     C                     PARM 6         WQ0193  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0194 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Error detected ?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *CASE:     PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ @CN,04                     *IF
     C                     MOVEL@CN,01    WUINRD           Err Code
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL@CN,03    WUINRD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0195 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0196  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
     C                     END                             *FI
      *CASE:     WRK.Invalid Review Date is Error Found
     C           WUINRD    IFEQ @CN,01                     *IF
      * Setup message data for message.
     C                     MOVEL#DSRRD    ZA0074           FRA Review Date
      * Send message 'Review Date Numeric'
     C                     MOVEL'USR0809' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9947  *
      *
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVE WUZAFF    WUWSDT           Work Screen Dat
      * Check Screen Date - Rundate  *
     C                     CALL 'ZDATE1'               90  Check Screen Da
     C           W0RTN     PARM W0RTN     WQ0197  7        *Return code
     C           WUWSDT    PARM WUWSDT    WQ0198  60       Work Screen Dat
     C           WUDFF     PARM WUDFF     WQ0199  1        Date format fla
     C           #1FRRD    PARM *ZERO     WQ0200  50       Work File Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Error detected ?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Test for an Invalid Date
      *CASE:     PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ @CN,04                     *IF
      * Setup message data for message.
     C                     MOVEL#DSRRD    ZA0075           FRA Review Date
      * Send message 'FRA Review date invalid'
     C                     MOVEL'USR4121' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9947  *
      *
     C                     MOVEL@CN,01    WUINRD           Invalid Review
     C                     ELSE
      *CASE:     *OTHERWISE
      *CASE:     PAR.FRA Review Date LE PAR.Run day number
     C           #1FRRD    IFLE WURDNB                     *IF
      * Setup message data for message.
     C                     MOVEL#DSRRD    ZA0076           FRA Review Date
     C                     MOVELWUMRDT    ZA0077           Midas Run Date
      * Send message 'FRA Rev Date after Rundat'
     C                     MOVEL'USR0818' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9947  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     Z-ADD*ZERO     #1FLRD           FX Limit Review
     C                     END                             *FI
      * Cross validate expiry and review dates
      *CASE:     PAR.FRA Review Date Screen DS is Not Equal Blank
     C           #DSRRD    IFNE *BLANK                     *IF
      *CASE:     PAR.FRA Expiry Date Screen DS is Equal Blank
     C           #DSRED    IFEQ *BLANK                     *IF
      * Setup message data for message.
     C                     MOVEL#DSRED    ZA0078           FRA Expiry Date
      * Send message 'FRA Expiry Date Required'
     C                     MOVEL'USR0799' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9945  *
      *
     C                     ELSE
      *CASE:     *OTHERWISE
      *CASE:     WRK.Invalid Review Date is Error Not Found
     C           WUINRD    IFEQ @CN,03                     *IF
      *CASE:     WRK.Invalid Expiry Date is Error Not Found
     C           WUIEDT    IFEQ @CN,03                     *IF
      * FRA Review date LT Expiry Date
      *CASE:     PAR.FRA Review Date GE PAR.FRA Expiry Date
     C           #1FRRD    IFGE #1FRED                     *IF
      * Setup message data for message.
     C                     MOVEL#DSRRD    ZA0079           FRA Review Date
      * Send message 'fra r dat GT fra ex dat'
     C                     MOVEL'USR4123' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9947  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate FRA Review Frequency
      *CASE:     PAR.FRA Review Date Screen DS is Not Equal Blank
     C           #DSRRD    IFNE *BLANK                     *IF
      * Frequency Code must be entered
      *CASE:     PAR.FRA Review Frequency is equal blank
     C           #1FRFQ    IFEQ *BLANK                     *IF
      * Setup message data for message.
     C                     MOVEL#1FRFQ    ZA0080           FRA Review Freq
      * Send message 'FRA Review Freq Required'
     C                     MOVEL'USR0694' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9949  *
      *
     C                     END                             *FI
     C                     ELSE
      *CASE:     *OTHERWISE
      * Frequency Code must be left blank
      *CASE:     PAR.FRA Review Frequency is equal blank
     C           #1FRFQ    IFEQ *BLANK                     *IF
      * No action required
     C                     ELSE
      *CASE:     *OTHERWISE
      * Setup message data for message.
     C                     MOVEL#1FRFQ    ZA0081           FRA Review Freq
      * Send message 'FRA Rev Freq Should Blank'
     C                     MOVEL'USR0696' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9949  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate FRA Review Frequency Type
      *CASE:     PAR.FRA Review Frequency is *ALL values
     C           #1FRFQ    IFEQ @CN,09                     *IF
     C           #1FRFQ    OREQ @CN,10
     C           #1FRFQ    OREQ @CN,11
     C           #1FRFQ    OREQ @CN,12
     C           #1FRFQ    OREQ @CN,13
     C           #1FRFQ    OREQ @CN,14
     C           #1FRFQ    OREQ @CN,15
     C           #1FRFQ    OREQ @CN,16
     C           #1FRFQ    OREQ @CN,17
     C           #1FRFQ    OREQ @CN,01
     C           #1FRFQ    OREQ @CN,18
     C           #1FRFQ    OREQ @CN,06
     C           #1FRFQ    OREQ @CN,19
     C           #1FRFQ    OREQ @CN,20
     C           #1FRFQ    OREQ @CN,21
     C           #1FRFQ    OREQ @CN,22
     C           #1FRFQ    OREQ @CN,23
     C           #1FRFQ    OREQ @CN,24
     C           #1FRFQ    OREQ *BLANK
      * Valid Limit Frequency.  No action Required
     C                     ELSE
      *CASE:     *OTHERWISE
      * Invalid Frequency Code
      * Setup message data for message.
     C                     MOVEL#1FRFQ    ZA0082           FRA Review Freq
      * Send message 'FRA Review Freq Invalid'
     C                     MOVEL'USR0695' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9949  *
      *
     C                     END                             *FI
      * Convert Frequency Day Number
     C                     EXSR UWSUBR                     Convert Frequen
      * If Freq is M,T,Q,X,or Y then Freq Day No must be 01-31, otherwise blank
      *CASE:     PAR.FRA Review Frequency is M,T,Q,X,Y
     C           #1FRFQ    IFEQ @CN,11                     *IF
     C           #1FRFQ    OREQ @CN,09
     C           #1FRFQ    OREQ @CN,16
     C           #1FRFQ    OREQ @CN,17
     C           #1FRFQ    OREQ @CN,01
      *CASE:     WRK.Invalid Frequency Day No is Error Not Found
     C           WUIFQD    IFEQ @CN,03                     *IF
      * Frequency Day Number must be between 01-31
      *CASE:     PAR.FRA Freq Day Number DS is Equal Blank
     C           #DRFDS    IFEQ *BLANK                     *IF
      * Setup message data for message.
     C                     MOVEL#DRFDS    ZA0084           FRA Freq Day Nu
      * Send message 'FRA Freq Day Num Required'
     C                     MOVEL'USR0697' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9951  *
      *
     C                     ELSE
      *CASE:     PAR.FRA Frequency Day No. is Greater Than 31
     C           #1FRAD    IFGT 31                         *IF
      * Setup message data for message.
     C                     MOVEL#DRFDS    ZA0085           FRA Freq Day Nu
      * Send message 'FRA Freq Day No Invalid'
     C                     MOVEL'USR0698' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9951  *
      *
     C                     ELSE
      *CASE:     PAR.FRA Frequency Day No. is Less or EQ Zero
     C           #1FRAD    IFLE *ZERO                      *IF
      * Setup message data for message.
     C                     MOVEL#DRFDS    ZA0086           FRA Freq Day Nu
      * Send message 'FRA Freq Day No Invalid'
     C                     MOVEL'USR0698' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9951  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      *CASE:     *OTHERWISE
      * Frequency Day Number must be blank
      *CASE:     PAR.FRA Freq Day Number DS is Not Equal Blank
     C           #DRFDS    IFNE *BLANK                     *IF
      * Setup message data for message.
     C                     MOVEL#DRFDS    ZA0087           FRA Freq Day Nu
      * Send message 'FRA Freq Day No Blank'
     C                     MOVEL'USR0699' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9951  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UUEXIT    ENDSR
      /EJECT
     CSR         UVSUBR    BEGSR
      *================================================================
      * Reset Error Fields
      *================================================================
     C                     MOVEL@CN,03    WUERCD           Err Code
     C                     MOVEL@CN,03    WUIFQD           Invalid Frequen
      *================================================================
     CSR         UVEXIT    ENDSR
      /EJECT
     CSR         UWSUBR    BEGSR
      *================================================================
      * Convert Frequency Day Number
      *================================================================
      *CASE:     PAR.FRA Freq Day Number DS is Not Equal Blank
     C           #DRFDS    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DRFDS    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0201  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0202 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0203  10       ZALIGN No Of De
     C                     PARM 9         WQ0204  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0205 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Error detected ?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *CASE:     PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ @CN,04                     *IF
     C                     MOVEL@CN,01    WUIFQD           Err Code
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL@CN,03    WUIFQD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0206 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0207  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
     C                     END                             *FI
      *CASE:     WRK.Invalid Frequency Day No is Error Found
     C           WUIFQD    IFEQ @CN,01                     *IF
      * Setup message data for message.
     C                     MOVEL#DRFDS    ZA0083           FRA Freq Day Nu
      * Send message 'Freq Day Num Must Numeric'
     C                     MOVEL'USR0793' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9951  *
      *
     C                     ELSE
      *CASE:     *OTHERWISE
      * ZALIGN FRA Freq Day No - Region Limits  *
     C*
     C* MOVE ZALIGN SCREEN FUNCTION FIELD INTO FRA FREQUENCY DAY NO
     C* SCREEN FUNCTION FIELD
     C                     MOVE WUZASF    #DRFDS
     C                     MOVE WUZAFF    #1FRAD           FRA Frequency D
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UWEXIT    ENDSR
      /EJECT
     CSR         UXSUBR    BEGSR
      *================================================================
      * Convert IRS Limit Amount
      *================================================================
      *CASE:     PAR.IRS Limit Amount Scrn DS is Not Equal Blank
     C           #DILAS    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DILAS    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0208  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0209 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0210  10       ZALIGN No Of De
     C                     PARM 9         WQ0211  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0212 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Error detected ?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *CASE:     PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ @CN,04                     *IF
     C                     MOVEL@CN,01    WUILAM           Err Code
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL@CN,03    WUILAM           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0213 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0214  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
     C                     END                             *FI
      *CASE:     WRK.Invalid Limit Amount is Error Found
     C           WUILAM    IFEQ @CN,01                     *IF
      * Setup message data for message.
     C                     MOVEL#DILAS    ZA0088           IRS Limit Amoun
      * Send message 'Limit Amount Not Numeric'
     C                     MOVEL'USR0788' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9944  *
      *
     C                     ELSE
      *CASE:     *OTHERWISE
      * ZALIGN IRS Limit Amount - Region Limits  *
     C*
     C* MOVE ZALIGN SCREEN FUNCTION FIELD INTO IRS LIMIT AMOUNT
     C* SCREEN FUNCTION FIELD
     C                     MOVE WUZASF    #DILAS
     C                     MOVE WUZAFF    #1IRLM           IRS Limit Amoun
      *CASE:     PAR.IRS Limit Amount is equal zero
     C           #1IRLM    IFEQ *ZERO                      *IF
      * Setup message data for message.
     C                     MOVEL#DILAS    ZA0089           IRS Limit Amoun
      * Send message 'IRS Limit Amount GT Zero'
     C                     MOVEL'USR0837' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9944  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UXEXIT    ENDSR
      /EJECT
     CSR         UYSUBR    BEGSR
      *================================================================
      * Validate IRS Fields
      *================================================================
      *CASE:     WRK.Details Entered - IRS is Details Entered
     C           WUDEIR    IFEQ @CN,07                     *IF
      * Reset Error Fields
     C                     EXSR UZSUBR                     Reset Error Fie
      * Validate IRS Expiry Date
      *CASE:     PAR.IRS Expiry Date Screen DS is Not Equal Blank
     C           #DSIED    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DSIED    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0215  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0216 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0217  10       ZALIGN No Of De
     C                     PARM 6         WQ0218  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0219 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Error detected ?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *CASE:     PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ @CN,04                     *IF
     C                     MOVEL@CN,01    WUIEDT           Err Code
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL@CN,03    WUIEDT           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0220 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0221  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
     C                     END                             *FI
      *CASE:     WRK.Invalid Expiry Date is Error Found
     C           WUIEDT    IFEQ @CN,01                     *IF
      * Setup message data for message.
     C                     MOVEL#DSIED    ZA0090           IRS Expiry Date
      * Send message 'Expiry Date Numeric'
     C                     MOVEL'USR0808' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9946  *
      *
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVE WUZAFF    WUWSDT           Work Screen Dat
      * Check Screen Date - Rundate  *
     C                     CALL 'ZDATE1'               90  Check Screen Da
     C           W0RTN     PARM W0RTN     WQ0222  7        *Return code
     C           WUWSDT    PARM WUWSDT    WQ0223  60       Work Screen Dat
     C           WUDFF     PARM WUDFF     WQ0224  1        Date format fla
     C           #1IRED    PARM *ZERO     WQ0225  50       Work File Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Error detected ?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Test for an Invalid Date
      *CASE:     PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ @CN,04                     *IF
      * Setup message data for message.
     C                     MOVEL#DSIED    ZA0091           IRS Expiry Date
      * Send message 'IRS Expiry Date Invalid'
     C                     MOVEL'USR0735' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9946  *
      *
     C                     MOVEL@CN,01    WUIEDT           Invalid Expiry
     C                     ELSE
      *CASE:     *OTHERWISE
      * Test for date less than rundat
      *CASE:     PAR.IRS Expiry Date LE PAR.Run day number
     C           #1IRED    IFLE WURDNB                     *IF
      * Setup message data for message.
     C                     MOVEL#DSIED    ZA0092           IRS Expiry Date
     C                     MOVELWUMRDT    ZA0093           Midas Run Date
      * Send message 'IRS Exp dat LE rundat'
     C                     MOVEL'USR4126' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9946  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     Z-ADD*ZERO     #1IRED           IRS Expiry Date
     C                     END                             *FI
      * Validate IRS Review Date
      *CASE:     PAR.IRS Review Date Screen DS is Not Equal Blank
     C           #DSIRD    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DSIRD    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0226  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0227 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0228  10       ZALIGN No Of De
     C                     PARM 6         WQ0229  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0230 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Error detected ?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *CASE:     PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ @CN,04                     *IF
     C                     MOVEL@CN,01    WUINRD           Err Code
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL@CN,03    WUINRD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0231 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0232  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
     C                     END                             *FI
      *CASE:     WRK.Invalid Review Date is Error Found
     C           WUINRD    IFEQ @CN,01                     *IF
      * Setup message data for message.
     C                     MOVEL#DSIRD    ZA0094           IRS Review Date
      * Send message 'Review Date Numeric'
     C                     MOVEL'USR0809' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9948  *
      *
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVE WUZAFF    WUWSDT           Work Screen Dat
      * Check Screen Date - Rundate  *
     C                     CALL 'ZDATE1'               90  Check Screen Da
     C           W0RTN     PARM W0RTN     WQ0233  7        *Return code
     C           WUWSDT    PARM WUWSDT    WQ0234  60       Work Screen Dat
     C           WUDFF     PARM WUDFF     WQ0235  1        Date format fla
     C           #1IRDT    PARM *ZERO     WQ0236  50       Work File Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
      * Error detected ?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Test for an Invalid Date
      *CASE:     PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ @CN,04                     *IF
      * Setup message data for message.
     C                     MOVEL#DSIRD    ZA0095           IRS Review Date
      * Send message 'IRS Review Date Invalid'
     C                     MOVEL'USR0736' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9948  *
      *
     C                     MOVEL@CN,01    WUINRD           Invalid Review
     C                     ELSE
      *CASE:     *OTHERWISE
      *CASE:     PAR.IRS Review Date LE PAR.Run day number
     C           #1IRDT    IFLE WURDNB                     *IF
      * Setup message data for message.
     C                     MOVEL#DSIRD    ZA0096           IRS Review Date
     C                     MOVELWUMRDT    ZA0097           Midas Run Date
      * Send message 'IRS Rev Date after Rundat'
     C                     MOVEL'USR0819' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9948  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     Z-ADD*ZERO     #1IRDT           IRS Review Date
     C                     END                             *FI
      * Cross validate expiry and review dates
      *CASE:     PAR.IRS Review Date Screen DS is Not Equal Blank
     C           #DSIRD    IFNE *BLANK                     *IF
      *CASE:     PAR.IRS Expiry Date Screen DS is Equal Blank
     C           #DSIED    IFEQ *BLANK                     *IF
      * Setup message data for message.
     C                     MOVEL#DSIED    ZA0098           IRS Expiry Date
      * Send message 'IRS Expiry Date Required'
     C                     MOVEL'USR0800' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9946  *
      *
     C                     ELSE
      *CASE:     *OTHERWISE
      *CASE:     WRK.Invalid Review Date is Error Not Found
     C           WUINRD    IFEQ @CN,03                     *IF
      *CASE:     WRK.Invalid Expiry Date is Error Not Found
     C           WUIEDT    IFEQ @CN,03                     *IF
      * IRS Review date GT Rundate and LT Expiry Date
      *CASE:     PAR.IRS Review Date GE PAR.IRS Expiry Date
     C           #1IRDT    IFGE #1IRED                     *IF
      * Setup message data for message.
     C                     MOVEL#DSIRD    ZA0099           IRS Review Date
      * Send message 'IRS Rev dat GT IRS Ex Dat'
     C                     MOVEL'USR4129' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9948  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate IRS Review Frequency
      *CASE:     PAR.IRS Review Date Screen DS is Not Equal Blank
     C           #DSIRD    IFNE *BLANK                     *IF
      * Frequency Code must be entered
      *CASE:     PAR.IRS Review Frequency is equal blank
     C           #1IRFQ    IFEQ *BLANK                     *IF
      * Setup message data for message.
     C                     MOVEL#1IRFQ    ZA0100           IRS Review Freq
      * Send message 'IRS Review Freq Required'
     C                     MOVEL'USR0701' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9950  *
      *
     C                     END                             *FI
     C                     ELSE
      *CASE:     *OTHERWISE
      * Frequency Code must be left blank
      *CASE:     PAR.IRS Review Frequency is equal blank
     C           #1IRFQ    IFEQ *BLANK                     *IF
      * No action required
     C                     ELSE
      *CASE:     *OTHERWISE
      * Setup message data for message.
     C                     MOVEL#1IRFQ    ZA0101           IRS Review Freq
      * Send message 'IRS Rev Frq must be Blank'
     C                     MOVEL'USR0704' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9950  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate IRS Review Frequency Type
      *CASE:     PAR.IRS Review Frequency is *ALL values
     C           #1IRFQ    IFEQ @CN,09                     *IF
     C           #1IRFQ    OREQ @CN,10
     C           #1IRFQ    OREQ @CN,11
     C           #1IRFQ    OREQ @CN,12
     C           #1IRFQ    OREQ @CN,13
     C           #1IRFQ    OREQ @CN,14
     C           #1IRFQ    OREQ @CN,15
     C           #1IRFQ    OREQ @CN,16
     C           #1IRFQ    OREQ @CN,17
     C           #1IRFQ    OREQ @CN,01
     C           #1IRFQ    OREQ @CN,18
     C           #1IRFQ    OREQ @CN,06
     C           #1IRFQ    OREQ @CN,19
     C           #1IRFQ    OREQ @CN,20
     C           #1IRFQ    OREQ @CN,21
     C           #1IRFQ    OREQ @CN,22
     C           #1IRFQ    OREQ @CN,23
     C           #1IRFQ    OREQ @CN,24
     C           #1IRFQ    OREQ *BLANK
      * Valid Limit Frequency.  No action Required
     C                     ELSE
      *CASE:     *OTHERWISE
      * Invalid Frequency Code
      * Setup message data for message.
     C                     MOVEL#1IRFQ    ZA0102           IRS Review Freq
      * Send message 'IRS Review Freq Invalid'
     C                     MOVEL'USR0702' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9950  *
      *
     C                     END                             *FI
      * Convert Frequency Day Number
     C                     EXSR NASUBR                     Convert Frequen
      * If Freq is M,T,Q,X,or Y then Freq Day No must be 01-31, otherwise blank
      *CASE:     PAR.IRS Review Frequency is M,T,Q,X,Y
     C           #1IRFQ    IFEQ @CN,11                     *IF
     C           #1IRFQ    OREQ @CN,09
     C           #1IRFQ    OREQ @CN,16
     C           #1IRFQ    OREQ @CN,17
     C           #1IRFQ    OREQ @CN,01
      *CASE:     WRK.Invalid Frequency Day No is Error Not Found
     C           WUIFQD    IFEQ @CN,03                     *IF
      * Frequency Day Number must be between 01-31
      *CASE:     PAR.IRS Freq Day Number DS is Equal Blank
     C           #DIFDS    IFEQ *BLANK                     *IF
      * Setup message data for message.
     C                     MOVEL#DIFDS    ZA0104           IRS Freq Day Nu
      * Send message 'IRS Freq Day no Required'
     C                     MOVEL'USR0705' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9952  *
      *
     C                     ELSE
      *CASE:     PAR.IRS Frequency Day No. is Greater Than 31
     C           #1IFDN    IFGT 31                         *IF
      * Setup message data for message.
     C                     MOVEL#DIFDS    ZA0105           IRS Freq Day Nu
      * Send message 'IRS Freq Day No Invalid'
     C                     MOVEL'USR0706' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9952  *
      *
     C                     ELSE
      *CASE:     PAR.IRS Frequency Day No. is Equal or LT ZERO
     C           #1IFDN    IFLE *ZERO                      *IF
      * Setup message data for message.
     C                     MOVEL#DIFDS    ZA0106           IRS Freq Day Nu
      * Send message 'IRS Freq Day No Invalid'
     C                     MOVEL'USR0706' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9952  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      *CASE:     *OTHERWISE
      * Frequency Day Number must be blank
      *CASE:     PAR.IRS Freq Day Number DS is Not Equal Blank
     C           #DIFDS    IFNE *BLANK                     *IF
      * Setup message data for message.
     C                     MOVEL#DIFDS    ZA0107           IRS Freq Day Nu
      * Send message 'IRS Freq Day no must blnk'
     C                     MOVEL'USR0707' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     9952  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UYEXIT    ENDSR
      /EJECT
     CSR         UZSUBR    BEGSR
      *================================================================
      * Reset Error Fields
      *================================================================
     C                     MOVEL@CN,03    WUERCD           Err Code
     C                     MOVEL@CN,03    WUIFQD           Invalid Frequen
      *================================================================
     CSR         UZEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Select existing record.
      *================================================================
      * Name search required ?
     C                     MOVEL#1CNCD    WK1X01  1        Country Code
     C                     MOVEL#1LEVL    WK1X02  1        Level
     C                     MOVEL#1BCCD    WK1X03  1        Branch/Company
     C           WK1X01    IFEQ '?'                        Country Code
     C           WK1X02    OREQ '?'                        Level
     C           WK1X03    OREQ '?'                        Branch/Company
     C                     CALL 'SD0470S'              90  *
     C                     PARM           W0RTN   7        Return code
     C           #1CNCD    PARM #1CNCD    WQ0089  2        Country Code
     C           #1LEVL    PARM #1LEVL    WQ0090  1        Level
     C           #1BCCD    PARM #1BCCD    WQ0091  3        Branch/Company
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
     C                     MOVEL'Y'       W0DCF   1        Defer confirm
     C                     END
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to Country Codes.
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required ?
     C                     MOVEL#1CNCD    WK1X01  1        Country Code
     C           WK1X01    IFEQ '?'                        Country Code
     C                     CALL 'SD0180S'              90  *
     C                     PARM           W0RTN   7        Return code
     C           #1CNCD    PARM #1CNCD    WQ0092  2        Country Code
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
     C                     MOVEL'Y'       W0DCF   1        Defer confirm
      * No value selected exit.
     C           W0RTN     CABNE*BLANK    VBEXIT
     C                     END
      *................................................................
      * If all low order keys not entered, exit.
     C           #1CNCD    IFEQ *BLANK                     Country Code
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBA4    KLIST
     C                     KFLD           A4CNCD           Country Code
      * Setup key.
     C                     MOVEL#1CNCD    A4CNCD           Country Code
     C           KLVBA4    CHAIN@A4REBR              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals.
     C                     GOTO VBEXIT
     C                     END
      * Send message 'Country Codes          NF'
     C                     MOVEL'USR0067' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     MOVEL'USR0067' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Limit types.
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required ?
     C                     MOVEL#1FXLT    WK1X01  1        Limit Type
     C           WK1X01    IFEQ '?'                        Limit Type
     C                     CALL 'SD0141S'              90  *
     C                     PARM           W0RTN   7        Return code
     C           #1FXLT    PARM #1FXLT    WQ0244  3        Limit Type
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
     C                     MOVEL'Y'       W0DCF   1        Defer confirm
      * No value selected exit.
     C           W0RTN     CABNE*BLANK    VCEXIT
     C                     END
      *................................................................
      * If all low order keys not entered, exit.
     C           #1FXLT    IFEQ *BLANK                     Limit Type
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCA2    KLIST
     C                     KFLD           A2LMTY           Limit Type
      * Setup key.
     C                     MOVEL#1FXLT    A2LMTY           Limit Type
     C           KLVCA2    CHAIN@A2REBU              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals.
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Limit types            NF'
     C                     MOVEL'USR0063' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     MOVEL'USR0063' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check reference to Limit types.
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required ?
     C                     MOVEL#1LLTY    WK1X01  1        Limit Type
     C           WK1X01    IFEQ '?'                        Limit Type
     C                     CALL 'SD0141S'              90  *
     C                     PARM           W0RTN   7        Return code
     C           #1LLTY    PARM #1LLTY    WQ0245  3        Limit Type
     C           *IN90     IFEQ '1'
      * Call to program ended in error.
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
     C                     MOVEL'Y'       W0DCF   1        Defer confirm
      * No value selected exit.
     C           W0RTN     CABNE*BLANK    VDEXIT
     C                     END
      *................................................................
      * If all low order keys not entered, exit.
     C           #1LLTY    IFEQ *BLANK                     Limit Type
     C                     GOTO VDEXIT
     C                     END
      *
     C           KLVDA2    KLIST
     C                     KFLD           A2LMTY           Limit Type
      * Setup key.
     C                     MOVEL#1LLTY    A2LMTY           Limit Type
     C           KLVDA2    CHAIN@A2REBU              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals.
     C                     GOTO VDEXIT
     C                     END
      * Send message 'Limit types            NF'
     C                     MOVEL'USR0063' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     MOVEL'USR0063' W0RTN
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue.
      *================================================================
     C           ZAPGM     IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGM
     C                     END
      * If no message file specified use default.
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGM  10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message Id.
     C                     PARM           ZAMSGF 10        Message file.
     C                     PARM           ZAMSDA132        Message data.
     C                     PARM           ZAMSTP  7        Message type.
      * Clear all fields for default mechanism next time.
     C                     MOVEL*BLANK    ZAPGM            Program queue
     C                     MOVEL*BLANK    ZAPGRL           Rel queue
     C                     MOVEL*BLANK    ZAMSID           Message Id.
     C                     MOVEL*BLANK    ZAMSGF           Message file.
     C                     MOVEL*BLANK    ZAMSDA           Message data.
     C                     MOVEL*BLANK    ZAMSTP           Message type.
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text.
      *================================================================
     C                     MOVEL'Y'       W0HLP   1        Signal help req
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Member name.
     C                     PARM *BLANK    YYHPFL 10        *DFT text file.
     C                     PARM *BLANK    YYHPLB 10        Help text lib.
     C                     PARM           W0RTN   7        Return Code.
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel and exit from key screen.
      *================================================================
      * USER: Exit program processing
      *CASE:     WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ @CN,01                     *IF
      * 00/Copy Member SD0471REPP - Country Limits  *
     C*00/Copy Member SD0471R   Exit Program Processing
     C/COPY WNCPYSRC,SD0471REPP
     C                     END                             *FI
      *CASE:     KEY.*CMD key is *Exit
     C           *IN03     IFEQ '1'                        *IF
     C                     MOVEL@CN,28    P5DRTC           Duplicate Retur
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct.
      *================================================================
      * ROLLBACK any uncommitted DBF changes.
     C                     ROLBK                       90
      *
      * Terminate program.
     C                     SETON                     LR
      *
      * Exit program.
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation.
      *================================================================
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
      * Setup job date/time.
     C                     Z-ADDUDATE     ##JDT            Job date.
     C                     TIME           ##JTM            Job time.
     C                     TIME           ##TME   60       Screen time.
      * Obtain default message file.
     C           *NAMVAR   DEFN Y2MGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field S01212
     C                     MOVEL*BLANK    WUMFTS  1
      * Define work field Country Name
     C                     MOVEL*BLANK    WUCNNM 30
      * Define work field Multi-branching Indicator
     C                     MOVEL*BLANK    WUMBIN  1
      * Define work field Display Level & Brch/Comp
     C                     MOVEL*BLANK    WUDLBC  1
      * Define work field Date format flag
     C                     MOVEL*BLANK    WUDFF   1
      * Define work field Work Converted Date
     C                     Z-ADD*ZERO     WUWCDT  60
      * Define work field Work Alpha Date
     C                     MOVEL*BLANK    WUWADT  7
      * Define work field ZALIGN Screen Fun Field
     C                     MOVEL*BLANK    WUZASF 16
      * Define work field ZALIGN File Field
     C                     MOVEL*BLANK    WUZAFF 16
      * Define work field Err Code
     C                     MOVEL*BLANK    WUERCD  1
      * Define work field Secured
     C                     MOVEL*BLANK    WUSECD  1
      * Define work field MDDR Amount Screen
     C                     MOVEL*BLANK    WUMDAS  9
      * Define work field MDDR Amount
     C                     Z-ADD*ZERO     WUMDDR  90
      * Define work field Region Code
     C                     MOVEL*BLANK    WURGCD  2
      * Define work field Run day number
     C                     Z-ADD*ZERO     WURDNB  50
      * Define work field Midas Run Date
     C                     MOVEL*BLANK    WUMRDT  7
      * Define work field Details Entered
     C                     MOVEL*BLANK    WUDTEN  1
      * Define work field Details Entered - LN
     C                     MOVEL*BLANK    WUDELN  1
      * Define work field Details Entered - FRA
     C                     MOVEL*BLANK    WUDEFR  1
      * Define work field Details Entered - IRS
     C                     MOVEL*BLANK    WUDEIR  1
      * Define work field Blank in Frequency Field
     C                     MOVEL*BLANK    WUBIFF  1
      * Define work field Blank in Secured Field
     C                     MOVEL*BLANK    WUBISF  1
      * Define work field Invalid Limit Amount
     C                     MOVEL*BLANK    WUILAM  1
      * Define work field Invalid Frequency Day No
     C                     MOVEL*BLANK    WUIFQD  1
      * Define work field Invalid Expiry Date
     C                     MOVEL*BLANK    WUIEDT  1
      * Define work field Work Screen Date
     C                     Z-ADD*ZERO     WUWSDT  60
      * Define work field Invalid Review Date
     C                     MOVEL*BLANK    WUINRD  1
      * Define work field Invalid MDDR Amount
     C                     MOVEL*BLANK    WUIMDA  1
      * Define work field Window processing requir.
     C                     MOVEL*BLANK    WUWDPR  1
      * Define work field No. of Records
     C                     Z-ADD*ZERO     WUNORC  50
      * Define work field No. of Inserts
     C                     Z-ADD*ZERO     WUNOIN  50
      * Define work field No. of Deletes
     C                     Z-ADD*ZERO     WUNODL  50
      * Define work field No. of Amends
     C                     Z-ADD*ZERO     WUNOAM  50
      * Define work field Set Up Complete
     C                     MOVEL*BLANK    WUSUC   1
      * Open files.
      * Begin commit control.
     C                     CALL 'Y2BGCMC'
     C                     PARM           W0RTN   7
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'CPF8351'
     C                     EXSR ZYEXPG
     C                     END
     C                     OPEN SDCNLML0
     C                     OPEN SDFCTLL0
      * Select initial mode.
     C           @1NROP    IFEQ *ZERO
     C                     MOVEL'ADD'     W0PMD   3        Add mode
     C                     ELSE
     C                     MOVEL'CHG'     W0PMD            Change mode
     C                     END
      * USER: Initialise program
      * Standard RPG Creation PAR - Standard Functions  *
      * Copyright Statement - Standard Functions  *
      * Start of SAR S01117
      * Last Amend Box SD0471R - Country Limits  *
      * End of SAR S01117
      * Get Rundate - Rundate  *
     C           *NAMVAR   DEFN           RUNDAT
     C                     IN   RUNDAT
     C                     MOVE MRDT      ##MRDT           RUN DATE
     C                     MOVE MRDT      WUMRDT
     C                     MOVE RDNB      WURDNB           RUNDAY NO.
     C                     MOVE SUC       WUSUC            SET UP COMPLT
     C                     MOVE DFF       WUDFF            DTE FMT FLAG
     C                     MOVE MBIN      WUMBIN           MULTI BR. IND
      * Set up Program Mode
      *CASE:     PAR.Action Code is Insert
     C           P4ANCD    IFEQ @CN,27                     *IF
     C                     MOVEL@CN,32    W0PMD            *Program mode
     C                     ELSE
      *CASE:     *OTHERWISE
     C                     MOVEL@CN,33    W0PMD            *Program mode
     C                     END                             *FI
     C                     MOVEL@CN,01    WUMFTS           S01212
      *CASE:     WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ @CN,01                     *IF
      * Get 'Window required' ind - MIDAS Modules  *
     C                     EXSR SIRVGN
      * DS Country Limits - Country Limits  *
      * 00/Copy Member SD0471RIPG - Country Limits  *
     C/COPY WNCPYSRC,SD0471RCPG
     C                     END                             *FI
      *================================================================
     CSR         ZZEXIT    ENDSR
     O/COPY WNCPYSRC,SD0471ROPG
** DETAIL LINE COMMAND KEY TEXT
F3=Main Menu   F10=Delete   F12=Previous
F3=Exit   F12=Previous
F3=Main Menu   F12=Previous
** CPY@     : Copyright notice for inclusion in all programs
(c) Misys International Banking Systems Ltd. 2001
** @CN Long constants used in program.
Y
SYS
N
*ERROR*
USR0790
D
1
0
M
S
T
R
B
L
A
Q
X
Z
W
F
P
K
H
G
SD0461R
SD0471R
I
Y2U9999
USR0563
Y2U0004
SDCNLMPD
ADD
CHG
MMOD
