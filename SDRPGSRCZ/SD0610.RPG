0001 H
     F********************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas List of Customer Names')
0002 F********************************************************************
     F*  Midas  STANDING DATA MODULE
0004 F*                                                                  *
0005 F*    SD0610 - CUSTOMER NAMES LIST                                  *
0006 F*                                                                  *
      *  (c) Finastra International Limited 2001                      *
0008 F*                                                                  *
      *  Last Amend No. MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Prev Amend No. CSD027             Date 09Dec05               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.04 -----------------------------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 S01319             Date 05Nov91               *
     F*                 E23462             Date 02OCT90               *
     F*                    LN0159     DATE  13JLY90
0009 F*                    E12291     DATE  29/02/88                     *
0009 F*                    S01141     DATE  29/07/87                     *
0010 F*                                                                  *
     F*-----------------------------------------------------------------**S01141
     F*                                                                 **S01141
      *  MD046248 - Finastra Rebranding                               *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
     F*    S01319  -  REMOVE REFERENCES TO TRADER SUPPORT, (TS).        **
     F*                                                                 **
     F*    E23462  -  REPLACE DRS WITH TRADER SUPPORT, (TS).            **
     F*                                                                 **S01141
     F*    LN0159  -  CONVERTING TO THE NEW SYNON FILE AND INCORPORATING
     F*               RCF
     F*
     F*    E12291  -  AMENDMENT TO INCLUDE DRS SHORT NAME WHEN DRS      **E12291
     F*               INSTALLED IN SYSTEM.                              **E12291
     F*                                                                 **E12291
     F*    S01141  -  NETWORK MIDAS AMENDMENT TO INCLUDE GLOBAL         **S01141
     F*               REFERENCE FIELD.                                  **S01141
     F*                                                                 **S01141
0011 F********************************************************************
     F/COPY WNCPYSRC,SD0610F001
0013 FSCLIN   IP  F     256  8AI    49 DISK
0014 F*ABLE***IF  F      96 12AI     2 DISK                               LN0159
0015 F*D0610P1O*  F     132     OF     PRINTER                      S01124LN0159
0015 FSD0610P1O   F     132     OF     PRINTER      KINFDS SPOOL          LN0159
0016 F* 01            SCLIN LIVE DETAIL RECORD
0017 F* 02            CATCH ALL FOR DELETED RECORDS
     F**03******      TABLE - ICDR 1                                      LN0159
     F**04******            - CATCHALL                                    LN0159
0018 F*    20         FIRST CYCLE INDICATOR
0019 F*    21         FIRST PAGE OUTPUT
0019 F*    22         NETWORK MIDAS INDICATOR                             S01141
0019 F*    23         DRS INSTALLED INDICATOR                             E12291
0020 F*    99         I.C.D. NOT FOUND
0021 F*       90-99   USED IN ZSYSTM
0022 F*          U8   DATABASE IN ERROR
0023 F*             OFOVERFLOW ON SD0610
     E                    CPY@    1   1 80                                LN0159
0024 I*
0025 I*    CLIENT MASTER FILE
0026 I*
0027 ISCLIN   NS  01   1 CD
0034 I*
0064 I**********                              2   70CNUM                                      CSD027
0064 I                                        2   7 CNUM                                      CSD027
0066 I                                        9  28 CRNM
0067 I                                       29  38 CTWN
0068 I                                       39  48 CSNM
0069 I                                       49  56 CASK
0071 I                                       69  80 CSID
     I/COPY WNCPYSRC,SD0610I002
     I                                      151 160 DRSN                  E12291
0019 I                                      174 185 GREF                  S01141
0035 I*    CATCHALL FOR DELETED RECORDS
0036 I        NS  02
0037 I                                        1   1 RECI
0038 I*****TABLE*FILE - INSTALLATION CONTROL RECORD 1                     LN0159
0039 I**********                                                          LN0159
0040 I*ABLE***NS  03   1 CD   2 C0   3 C1                                 LN0159
0041 I*******AND      12 C1  13 C0                                        LN0159
0042 I**********                              1   1 RECI                  LN0159
0043 I**********                              2   30RECT                  LN0159
0044 I**********                             12  13 RCDE                  LN0159
0045 I**********                             14  66 TITL                  LN0159
0046 I**********                             67  67 DATF                  LN0159
0047 I**********                             68  730DFBR                  LN0159
0048 I**********                             74  74 MODI1                 LN0159
0049 I**********                             75  75 MODI2                 LN0159
0050 I**********                             76  76 MODI3                 LN0159
0051 I**********                          P  77  790RUND                  LN0159
0052 I**********                             80  86 RUNA                  LN0159
0053 I**********                             87  870SFLG                  LN0159
0019 I**********                             88  88 MODI4           E12291LN0159
0019 I**********                             89  89 MODI5           S01141LN0159
0054 I**********                          P  90  920LCD                   LN0159
0055 I**********                             93  93 CHTP                  LN0159
0056 I**********                          P  94  960TNLU                  LN0159
0057 I**********                              1  96 LOT                   LN0159
0058 I**********                                                          LN0159
0059 I*****CATCHALL FOR DELETED RECORDS                                   LN0159
0060 I********NS  04                                                      LN0159
     I**********                              1   1 RECI                  LN0159
0061 I**
0062 I**
     I/COPY WNCPYSRC,SD0610I001
0213 ILDA         DS                            256                       LN0159
0214 I                                      134 141 DBFILE                LN0159
0215 I                                      142 170 DBKEY                 LN0159
0216 I                                      171 180 DBPGM                 LN0159
0217 I                                      181 1830DBASE                 LN0159
     I*                                                                   LN0159
     ISPOOL       DS                                                      LN0159
     I                                       83  92 SFILE                 LN0159
     I                                    B 123 1240SFNUM                 LN0159
     ISDMMOD    E DSSDMMODPD                                              LN0159
      ** MIDAS MODULE DETAILS                                             LN0159
     ISDBANK    E DSSDBANKPD                                              LN0159
     I              BJURPT                          TITL                  LN0159
     I              BJMRDT                          RUNA                  LN0159
     I              BJRDNB                          RUND                  LN0159
     I**                                                                  LN0159
     IDSFDY     E DSDSFDY                                                 LN0159
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                LN0159
     I*                                                                   LN0159
     C*                                                                   LN0159
     C           *ENTRY    PLIST                                          LN0159
     C                     PARM           @SEQ    5                       LN0159
0063 C                     SETOF                     21
0064 C   20                GOTO DETAIL
0065 C*    FIRST CYCLE CALCULATIONS
     C*    DEFINE LDA                                                     LN0159
     C           *NAMVAR   DEFN           LDA                             LN0159
      ** ENSURE REPORT SPOOL FILE RECORDED BY RCF                         LN0159
     C                     Z-ADDSFNUM     ZSNUM   60                      LN0159
     C                     CALL 'ZSFILE'                                  LN0159
     C                     PARM           @SEQ                            LN0159
     C                     PARM           SENTY   3                       LN0159
     C                     PARM           SFILE                           LN0159
     C                     PARM           ZSNUM                           LN0159
     C                     PARM           ZSERR   1                       LN0159
      **                                                                  LN0159
      *                                                                   LN0159
     C           ZSERR     IFEQ 'Y'                                       LN0159
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       LN0159
     C                     SETON                     U7U8LR               LN0159
     C                     RETRN                                          LN0159
     C                     END                                            LN0159
0066 C*    CHAIN TO I.C.D. RECORD                                         LN0159
     C                     MOVEACPY@      BIS@   80                       LN0159
0067 C                     EXSR ZSYSTM
0068 C*
0069 C*    ERROR IF NOT FOUND
0070 C   99                GOTO ERROR
     C/COPY WNCPYSRC,SD0610C003
0071 C*
0072 C*    SET ON FIRST PAGE HEADING INDICATOR,FIRST CYCLE INDICATOR
0073 C                     SETON                     2120
0074 C*
0075 C*   DETAIL CALCULATIONS
0076 C           DETAIL    TAG                             ** DETAIL TAG *
     C/COPY WNCPYSRC,SD0610C001
0077 C*
0078 C*    IF DELETE,READ NEXT RECORD
0079 C   02                GOTO END
0080 C*
0081 C*    INCREMENT LIVE RECORD COUNT
0082 C           NROF      ADD  1         NROF    50
0083 C                     GOTO END
0084 C*
0085 C*    ERROR - SET ON LR INDICATOR
0086 C           ERROR     TAG                             ** ERROR TAG **
0087 C                     SETON                     LRU8
0088 C*
0089 C           END       TAG                             ** END TAG **
     C/COPY WNCPYSRC,SD0610C004
0090 C********************************************************************
0091 C**
0092 C**   ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.
0093 C**
0094 C           ZSYSTM    BEGSR                           *** ZSYSTM ***
0095 C**********                                                          LN0159
0096 C*****SET UP KEY FOR INSTALLATION CONTROL RECORD.                    LN0159
0097 C**********           MOVEL'01      'ZTABKY 12                       LN0159
0098 C**********           MOVE '  10'    ZTABKY                          LN0159
0099 C**********                                                          LN0159
0100 C********** ZTABKY    CHAINTABLE                99    ON NOT THERE   LN0159
0101 C**N99***** RECI      COMP 'D'                  9999  ON, IS DELETED LN0159
     C**                                                                  LN0159
     C**   ACCESS BANK DETAILS                                            LN0159
     C**                                                                  LN0159
     C                     CALL 'AOBANKR0'                                LN0159
     C                     PARM '*MSG   ' @RTCD   7                       LN0159
     C                     PARM '*FIRST ' @OPTN   7                       LN0159
     C           SDBANK    PARM SDBANK    DSFDY                           LN0159
     C*                                                                   LN0159
     C           @RTCD     IFNE *BLANK                                    LN0159
     C                     SETON                     U7U8LR               LN0159
     C                     SETON                     99                   LN0159
     C           *LOCK     IN   LDA                        ***************LN0159
     C                     MOVEL'SDBANKPD'DBFILE           * DBERROR 01  *LN0159
     C                     Z-ADD1         DBASE            ***************LN0159
     C                     OUT  LDA                                       LN0159
     C                     END                                            LN0159
      ** ACCESS MIDAS MODULE DETAILS                                      LN0159
     C                     CALL 'AOMMODR0'                                LN0159
     C                     PARM '*MSG   ' @RTCD   7                       LN0159
     C                     PARM '*FIRST ' @OPTN   7                       LN0159
     C           SDMMOD    PARM SDMMOD    DSFDY                           LN0159
     C           @RTCD     IFNE *BLANK                                    LN0159
     C                     SETON                     U7U8LR               LN0159
     C                     SETON                     99                   LN0159
     C           *LOCK     IN   LDA                        ***************LN0159
     C                     MOVEL'SDMMODPD'DBFILE           * DBERROR 02  *LN0159
     C                     Z-ADD2         DBASE            ***************LN0159
     C                     OUT  LDA                                       LN0159
     C                     END                                            LN0159
     C*                                                                   LN0159
0102 C**                                                                  LN0159
0019 C**   CHECK FOR NETWORK MIDAS                                        S01141
0019 C**********           TESTB'7'       MODI5          22         S01141LN0159
     C           BGNWMI    COMP '1'                      22               LN0159
0019 C**                                                                  S01141
0019 C**   CHECK TO SEE IF DRS INSTALLED                                  E12291
0019 C**********           TESTB'0'       MODI4          23         E12291LN0159
     C***********BGDRCM****COMP '1'                      23         LN0159S01319
0019 C**                                                                  E12291
0103 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.
0104 C********** DATF      COMP 'M'                      98MMDDYY, 98 ON  LN0159
0846 C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON  LN0159
0105 C**
     C/COPY WNCPYSRC,SD0610C002
0106 C                     ENDSR
0107 C**
0108 C**
0109 C********************************************************************
0110 OSD0610P1D   03   21                                                 S01124
0111 O       OR   03   OF
0112 O**********                         22 'REFERENCE SD0610'            LN0159
0112 O                                   22 'REFERENCE SD0610P1'          LN0159
0113 O                         TITL      89
0114 O                                  104 'DATE'
0115 O                         RUNA     112
0116 O                                  122 'PAGE'
0117 O                         PAGE  3  127
0118 O        D   05   21
0119 O       OR   05   OF
0120 O                                   73 'CUSTOMER NAMES LIST'
0121 O        D   06   21
0122 O       OR   06   OF
0123 O                                   73 '-------------------'
0124 O        D  207   21
0125 O       OR  207   OF
0126 O******                             10 'SORT CODE '                  S01141
0127 O******                             22 'SHORT NAME  '                S01141
0128 O******                             33 'REPORT NAME'                 S01141
0129 O******                             48 'TOWN'                        S01141
0130 O******                             62 'NUMBER'                      S01141
0131 O******                             75 'SWIFT CODE'                  S01141
0131 O*                                                                   S01141
0019 O                 22                11 'GLOBAL REF '                 S01141
0126 O                                   24 'SORT CODE '                  E12291
0127 O                                   41 'MIDAS SHORT NAME'            E12291
0128 O                                   53 'REPORT NAME'                 E12291
0129 O                                   68 'TOWN'                        E12291
0130 O                                   81 'NUMBER'                      E12291
0131 O                                   93 'SWIFT CODE'                  E12291
     O*****************23               110 'DRS SHORT NAME'        E12291E23462
     O*****************23               110 ' TS SHORT NAME'        E23462S01319
     O/COPY WNCPYSRC,SD0610O001
0132 O        D  1     01
     O/COPY WNCPYSRC,SD0610O003
0133 O******                   CASK       8                               S01141
0134 O******                   CSNM      20                               S01141
0135 O******                   CRNM      43                               S01141
0136 O******                   CTWN      54                               S01141
0137 O******                   CNUM      62                               S01141
0138 O******                   CSID      76                               S01141
0138 O*                                                                   S01141
0133 O                 22      GREF      12                               S01141
0133 O                         CASK      22                               E12291
0134 O                         CSNM      38                               E12291
0135 O                         CRNM      62                               E12291
0136 O                         CTWN      74                               E12291
0137 O                         CNUM      81                               E12291
0138 O                         CSID      95                               E12291
     O*****************23      DRSN     106                         E12291S01319
     O/COPY WNCPYSRC,SD0610O002
0139 O        T 3      LRN99
0140 O                                   33 'TOTAL NUMBER OF CUSTOMER'
0141 O                                   36 'S -'
0142 O                         NROF  3   42
0143 O        T 3      LRN99
0144 O                                   77 '*** END OF REPORT ***'
0145 O        T 3      LR 99
0146 O                                   22 'REFERENCE SD0610'
0147 O                                   62 'PRINT TERMINATED,'
0148 O                                   80 'DATABASE IN ERROR.'
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
