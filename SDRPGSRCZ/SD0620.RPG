0001 H                                                                    SD0620
0002 F********************************************************************SD0620
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas SD List of customers by parent')                 *
0002 F********************************************************************SD0620
0004 F*                                                                  *SD0620
     F*  Midas  STANDING DATA MODULE
0004 F*                                                                  *SD0620
0005 F**    SD0620 - CUSTOMER BY PARENT LIST                             *SD0620
0006 F*                                                                  *SD0620
      *  (c) Finastra International Limited 2001                      *
0008 F*                                                                  *SD0620
      *  Last Amend No. MD046248           Date 27Oct17               *
      *  Prev Amend No. CER059             Date 19Jul10               *
      *                 BUG23967           Date 13May09               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 BUG11618           Date 27Jun06               *
      *                 CSD027             Date 09Dec05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.04 -----------------------------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 S01314             Date 02Apr91               *
      *                 LN0159             Date 13Jly90               *
0009 F*                    S01141     DATE 29/07/87                      *SD0620
0010 F*                                                                  *SD0620
     F*-----------------------------------------------------------------**
      *  MD046248 - Finastra Rebranding                               *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  BUG23967 - Add Local Industry Code Field.                    *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  BUG11618 - SDC0604A 10002 failed ; error due to              *
      *             CPAR = "000000"                                   *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
     F*    S01314  -  CHANGES FOR R10 PTF INCORPORATION                 **
     F*            -  FIELD BBGCRF DROPPED FROM SDCUSTPD                **
     F*    LN0159  -  CONVERTING TO THE NEW SYNON FILE AND INCORPORATING
     F*               RCF
     F*    S01141  -  NETWORK MIDAS AMENDMENT TO INCLUDE GLOBAL         **S01141
     F*               REFERENCE FIELD.                                  **S01141
     F*                                                                 **
0011 F********************************************************************SD0620
     F/COPY WNCPYSRC,SD0620F001
0013 F***PACUS** IF  F     256  6AI    88 DISK                                       SD0620 BUG23967
0013 FPACUS   IF  F     264  6AI    88 DISK                                                 BUG23967
0014 F*LINT***IF* F     256  7AI     2 DISK                               LN0159
0015 F*ABLE***IF* F      96 12AI     2 DISK                               LN0159
0016 F*D0620P1O** F     132     OF     PRINTER                      S01124LN0159
0015 FSD0620P1O   F     132     OF     PRINTER      KINFDS SPOOL          LN0159
0018 F* 02            PARENT CUSTOMER DETAIL                              SD0620
0019 F* 03            PARENT CUSTOMER CATCHALL                            SD0620
0020 F**04******      CLIENT TYPE A RECORD                                LN0159
0021 F**05******      CLIENT CATCHALL                                     LN0159
     F**06******      DUMMY RECORD ID INDICATOR                           LN0159
0022 F*       20      FIRST CYCLE CALCS. DONE                             SD0620
     F*       21      EOF ON READ
     F********22******NETWORK MIDAS INDICATOR                      S01141 S01314
0024 F*       24      FIRST CHILD FOR PARENT                              SD0620
0025 F*       25      EXCEPTION PRINT OF DETAIL LINE                      SD0620
0026 F*       26      EXCEPTION PRINT ON HEADINGS                         SD0620
0028 F*       U8      DATABASE ERROR                                      SD0620
     E                    CPY@    1   1 80                                LN0159
0042 I**                                                                  SD0620
0043 I**   PARENT/CUSTOMER FILE - DETAIL RECORD                           SD0620
0044 I**                                                                  SD0620
0045 IPACUS   NS  02   1 CD                                               SD0620
0072 I                                        1   1 RECI                  SD0620
0073 I**********                              2   70CNUM                               SD0620 CSD027
0073 I                                        2   7 CNUM                                      CSD027
0074 I                                        8   8 RCDT                  SD0620
0075 I                                        9  28 CRNM                  SD0620
0076 I                                       29  38 CTWN                  SD0620
0077 I                                       39  48 CSNM                  SD0620
0078 I                                       49  56 CASK                  SD0620
0079 I                                       57  68 TELX                  SD0620
0080 I                                       69  80 CSID                  SD0620
0081 I                                       81  82 ACOC                  SD0620
0082 I                                       83  83 CBSI                  SD0620
0083 I                                       84  85 CCTZ                  SD0620
0084 I                                       86  87 CLOC                  SD0620
0085 I**********                             88  930CPAR                               SD0620 CSD027
0085 I                                       88  93 CPAR                                      CSD027
0086 I                                       94  960BRCD                  SD0620
0087 I                                       97  98 LINS                  SD0620
0088 I                                       99 101 LIND                  SD0620
0089 I                                    P 102 1040DASUS                 SD0620
0090 I                                    P 105 1070CDIC                  SD0620
0091 I                                    P 108 1100DADE                  SD0620
0092 I                                      111 111 CMIN                  SD0620
0093 I                                      112 112 CTYP                  SD0620
0094 I                                      113 124 TELF                  SD0620
     I                                      174 185 GREF                  S01141
0095 I                                    P 250 2520LCD                   SD0620
0096 I                                      253 253 CHTP                  SD0620
0097 I                                    P 254 2560TNLU                  SD0620
     I                                      262 264 LOIC                                    BUG23967
0066 I**                                                                  SD0620
0067 I**   CATCHALL FOR DELETED RECORDS                                   SD0620
0068 I        NS  03                                                      SD0620
0069 I**********                                                          LN0159
0070 I*****CLIENT FILE - CUSTOMER STANDING DATA RECORD                    LN0159
0071 I*LINT***NS  04   1 CD   8 CA                                        LN0159
0075 I**********                              9  28 CRNMCB                LN0159
0076 I**********                             29  38 CTWNCB                LN0159
     I**********                            174 185 GREFP           S01141LN0159
0099 I**********                                                          LN0159
0100 I*****CATCHALL FOR DELETED RECORDS                                   LN0159
0101 I********NS  05                                                      LN0159
0102 I**********                                                          LN0159
0103 I*****TABLE FILE - INSTALLATION CONTROL RECORD 1                     LN0159
0104 I**********                                                          LN0159
0105 I*ABLE***NS  06   2 C0   3 C1  12 C1                                 LN0159
0106 I*******AND      13 C0                                               LN0159
0107 I**********                              1   1 RECI                  LN0159
0108 I**********                              2   30RECT                  LN0159
0109 I**********                             12  13 RCDE                  LN0159
0110 I**********                             14  66 TITL                  LN0159
0111 I**********                             67  67 DATF                  LN0159
0112 I**********                             68  700DFBR                  LN0159
0113 I**********                             74  74 MODI1                 LN0159
0114 I**********                             75  75 MODI2                 LN0159
0115 I**********                             76  76 MODI3                 LN0159
0116 I**********                          P  77  790RUND                  LN0159
0117 I**********                             80  86 RUNA                  LN0159
0118 I**********                             87  870SFLG                  LN0159
     I**********                             89  89 MODI5           S01141LN0159
0119 I**********                          P  90  920LCD                   LN0159
0120 I**********                             93  93 CHTP                  LN0159
0121 I**********                          P  94  960TNLU                  LN0159
0123 I**********                                                          LN0159
0124 I*****CATCHALL FOR DELETED RECORDS                                   LN0159
0125 I********NS  06                                                      LN0159
0126 I**********                                                          LN0159
     I**                                                                  LN0159
0213 ILDA         DS                            256                       LN0159
0214 I                                      134 141 DBFILE                LN0159
0215 I                                      142 170 DBKEY                 LN0159
0216 I                                      171 180 DBPGM                 LN0159
0217 I                                      181 1830DBASE                 LN0159
     ISPOOL       DS                                                      LN0159
     I                                       83  92 SFILE                 LN0159
     I                                    B 123 1240SFNUM                 LN0159
     I**                                                                  LN0159
     I*                                                                   LN0159
     ISDCUST    E DSSDCUSTPD                                              LN0159
     I              BBCRNM                          CRNMCB                LN0159
     I              BBCRTN                          CTWNCB                LN0159
     I**************BBGCRF******                    GREFP          LN0159 S01314
     I**  EXTERNAL DS FOR CUSTOMER DETAILS                                LN0159
     I*                                                                   LN0159
     ISDMMOD    E DSSDMMODPD                                              LN0159
      ** MIDAS MODULE DETAILS                                             LN0159
     ISDBANK    E DSSDBANKPD                                              LN0159
     I              BJURPT                          TITL                  LN0159
     I              BJMRDT                          RUNA                  LN0159
     I              BJRDNB                          RUND                  LN0159
     IDSFDY     E DSDSFDY                                                 LN0159
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                LN0159
     I*                                                                   LN0159
     IDSSDY     E DSDSSDY                                                 LN0159
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                LN0159
     I*                                                                   LN0159
     C           *ENTRY    PLIST                                          LN0159
     C                     PARM           @SEQ    5                       LN0159
0127 C*    FIRST CYCLE CALCULATIONS                                       SD0620
0128 C   20                GOTO NOTFC                                     SD0620
0129 C*    SET ON FIRST CYCLE INDICATOR                                   SD0620
0130 C                     SETON                     20                   SD0620
     C                     MOVEACPY@      BIS@   80                       LN0159
     C*    DEFINE LDA                                                     LN0159
     C           *NAMVAR   DEFN           LDA                             LN0159
      ** ENSURE REPORT SPOOL FILE RECORDED BY RCF                         LN0159
     C                     Z-ADDSFNUM     ZSNUM   60                      LN0159
     C                     CALL 'ZSFILE'                                  LN0159
     C                     PARM           @SEQ                            LN0159
     C                     PARM           SENTY   3                       LN0159
     C                     PARM           SFILE                           LN0159
     C                     PARM           ZSNUM                           LN0159
     C                     PARM           ZSERR   1                       LN0159
      **                                                                  LN0159
      *                                                                   LN0159
     C           ZSERR     IFEQ 'Y'                                       LN0159
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       LN0159
     C                     SETON                     U7U8LR               LN0159
     C                     RETRN                                          LN0159
     C                     END                                            LN0159
     C/COPY WNCPYSRC,SD0620C003
0131 C*                                                                   SD0620
0132 C*    EXECUTE SR. TO CHAIN TO I.C.D.                                 SD0620
0133 C                     EXSR ZSYSTM                                    SD0620
0134 C*                                                                   SD0620
0135 C*    ERROR IF I.C.D. NOT FOUND                                      SD0620
0136 C   99                GOTO ERROR                                     SD0620
0137 C*    PRINT HEADING LINES                                            SD0620
0138 C                     SETON                     26                   SD0620
0139 C                     EXCPT                                          SD0620
0140 C                     SETOF                     26                   SD0620
0141 C**********                                                          LN0159
0142 C*****SET*UP KEY FOR CUSTOMER MASTER FILE                            LN0159
0143 C**********           MOVE 'A'       CLTKEY  7                       LN0159
0144 C*                                                                   SD0620
0145 C*    DETAIL CALCULATIONS                                            SD0620
0146 C           NOTFC     TAG                             ** NOTFC TAG **SD0620
     C                     SETOF                     0203
     C                     READ PACUS                    21
     C   21                GOTO END                        END OF FILE
0147 C*                                                                   SD0620
0148 C*    IF NOT LIVE DETAIL RECORD,READ NEXT RECORD                     SD0620
0149 C  N02                GOTO NOTFC                                     SD0620
0150 C*                                                                   SD0620
     C*    IF NEW PARENT, GET DETAILS
     C           CPAR      IFEQ '000000'                                                    BUG11618
     C                     GOTO LOOP                                                        BUG11618
     C                     ENDIF                                                            BUG11618
     C           CPAR      COMP SCPAR                2424
0166 C***24*****           Z-ADDCPAR      SCPAR   60                                   SD0620 CSD027
0166 C   24                MOVE CPAR      SCPAR   6                                           CSD027
     C/COPY WNCPYSRC,SD0620C004
     C  N24                GOTO LOOP
0150 C*                                                                   SD0620
0151 C*    SET OF ERROR AND RECORD INDICATORS                             SD0620
0152 C                     SETOF                     0405                 SD0620
0153 C*    GET DETAILS OF PARENT FROM CUSTOMER MASTER FILE                SD0620
0154 C**********           MOVELCPAR      CLTKEY                          LN0159
0154 C                     MOVELCPAR      KEYC                            LN0159
0155 C********** CLTKEY    CHAINCLINT                05                   LN0159
     C                     CALL 'AOCUSTR0'                                LN0159
     C                     PARM '*BLANKS' @RTCD                           LN0159
     C                     PARM '*KEY    '@OPTN                           LN0159
     C                     PARM           KEYC   10                       LN0159
     C                     PARM           KEYSTS  7                       LN0159
     C           SDCUST    PARM SDCUST    DSSDY                           LN0159
     C*                                                                   LN0159
     C           @RTCD     IFNE *BLANKS                                   LN0159
     C           *LOCK     IN   LDA                                       LN0159
     C                     MOVEL'SDCUSTPD'DBFILE                          LN0159
     C                     MOVELKEYC      DBKEY                           LN0159
     C                     Z-ADD2         DBASE                           LN0159
     C                     OUT  LDA                                       LN0159
     C                     SETON                     05                   LN0159
     C                     SETON                     U7                   LN0159
0156 C*                                                                   SD0620
0157 C*    ERROR IF NOT FOUND                                             SD0620
0158 C**N04*****           GOTO ERROR                                     LN0159
0158 C                     GOTO ERROR                                     LN0159
0159 C*                                                                   SD0620
     C                     END                                            LN0159
0160 C*                                                                   SD0620
     C/COPY WNCPYSRC,SD0620C001
0165 C*    LOOP TO PRINT DETAILS OF CHILDREN                              SD0620
0168 C           LOOP      TAG                             ** LOOP TAG ** SD0620
0184 C*                                                                   SD0620
0188 C*    INCREMENT COUNT OF CHILDREN                                    SD0620
0190 C           NCHLD     ADD  1         NCHLD   40                      SD0620
0191 C*                                                                   SD0620
0195 C*    IF OVERFLOW PRINT HEADING LINES                                SD0620
0196 C   OF                SETON                     2627                 SD0620
0197 C   OF                EXCPT                                          SD0620
0198 C                     SETOF                     26OF                 SD0620
0199 C*                                                                   SD0620
0200 C*    EXCEPTION PRINT OF CHILD DETAILS                               SD0620
0201 C                     SETON                     25                   SD0620
0202 C                     EXCPT                                          SD0620
0203 C                     SETOF                     2527                 SD0620
0204 C*                                                                   SD0620
0205 C*    READ NEXT RECORD                                               SD0620
0206 C                     GOTO NOTFC                                     SD0620
0208 C*                                                                   SD0620
0209 C*    SET ON ERROR INDICATOR & END JOB                               SD0620
0210 C           ERROR     TAG                             ** ERROR TAG **SD0620
0211 C                     SETON                     U8LR                 SD0620
0212 C*                                                                   SD0620
0213 C           END       TAG                             ** END TAG **  SD0620
     C/COPY WNCPYSRC,SD0620C005
     C                     SETON                     LR
0214 C********************************************************************SD0620
0215 C**                                                                  SD0620
0216 C**   ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   SD0620
0217 C**                                                                  SD0620
0218 C           ZSYSTM    BEGSR                           *** ZSYSTM *** SD0620
0219 C**********                                                          LN0159
0220 C*****SET*UP KEY FOR INSTALLATION CONTROL RECORD.                    LN0159
0221 C**********           MOVEL'01      'ZTABKY 12                       LN0159
0222 C**********           MOVE '  10'    ZTABKY                          LN0159
0223 C**********                                                          LN0159
0224 C********** ZTABKY    CHAINTABLE                99    ON NOT THERE   LN0159
0225 C**N99***** RECI      COMP 'D'                  9999  ON, IS DELETED LN0159
0226 C**********                                                          LN0159
     C**                                                                  LN0159
     C**   ACCESS BANK DETAILS                                            LN0159
     C**                                                                  LN0159
     C                     CALL 'AOBANKR0'                                LN0159
     C                     PARM '*MSG   ' @RTCD   7                       LN0159
     C                     PARM '*FIRST ' @OPTN   7                       LN0159
     C           SDBANK    PARM SDBANK    DSFDY                           LN0159
     C*                                                                   LN0159
     C           @RTCD     IFNE *BLANK                                    LN0159
     C                     SETON                     99                   LN0159
     C           *LOCK     IN   LDA                        ***************LN0159
     C                     MOVEL'SDBANKPD'DBFILE           * DBERROR 01  *LN0159
     C                     Z-ADD1         DBASE            ***************LN0159
     C                     OUT  LDA                                       LN0159
     C                     END                                            LN0159
      ** ACCESS MIDAS MODULE DETAILS                                      LN0159
     C                     CALL 'AOMMODR0'                                LN0159
     C                     PARM '*MSG   ' @RTCD   7                       LN0159
     C                     PARM '*FIRST ' @OPTN   7                       LN0159
     C           SDMMOD    PARM SDMMOD    DSFDY                           LN0159
     C           @RTCD     IFNE *BLANK                                    LN0159
     C                     SETON                     99                   LN0159
     C           *LOCK     IN   LDA                        ***************LN0159
     C                     MOVEL'SDMMODPD'DBFILE           * DBERROR 02  *LN0159
     C                     Z-ADD2         DBASE            ***************LN0159
     C                     OUT  LDA                                       LN0159
     C                     END                                            LN0159
     C**********                                                          LN0159
0019 C*****CHECK FOR NETWORK MIDAS                                        S01141
0019 C**********           TESTB'7'       MODI5          22         S01141LN0159
     C           BGNWMI    COMP '1'                      22               LN0159
0019 C**                                                                  S01141
0227 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    SD0620
0228 C********** DATF      COMP 'M'                      98MMDDYY, 98 ON  LN0159
0228 C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON  LN0159
0229 C**                                                                  SD0620
     C/COPY WNCPYSRC,SD0620C002
0230 C                     ENDSR                                          SD0620
0231 C**                                                                  SD0620
0232 C**                                                                  SD0620
0233 C********************************************************************SD0620
0234 OSD0620P1E   03   26                                                 S01124
0235 O**********                         22 'REFERENCE SD0620P1'    SD0620LN0159
0235 O                                   22 'REFERENCE SD0620'            LN0159
0236 O                         TITL      89                               SD0620
0237 O                                  104 'DATE'                        SD0620
0238 O                         RUNA     112                               SD0620
0239 O                                  122 'PAGE'                        SD0620
0240 O                         PAGE  3  127                               SD0620
0241 O        E   05   26                                                 SD0620
0242 O                                   59 'CUSTOMER BY PARENT'          SD0620
0243 O        E   06   26                                                 SD0620
0244 O                                   59 '------------------'          SD0620
0245 O        E   08   26                                                 SD0620
0246 O*****                               6 'PARENT'                      S01141
0247 O*****                              54 'CUST'                        S01141
0246 O                                   19 'PARENT'                      S01141
0247 O                                   79 'CUST'                        S01141
0248 O        E  209   26                                                 SD0620
0249 O*****                               4 'NO'                          S01141
0250 O*****                              22 'PARENT NAME'                 S01141
0251 O*****                              35 'TOWN'                        S01141
0252 O*****                              53 'NO'                          S01141
0253 O*****                              74 'CUSTOMER NAME'               S01141
0254 O*****                              85 'TOWN'                        S01141
0249 O*****************22                11 'GLOBAL REF '          S01141 S01314
0249 O                                   17 'NO'                          S01141
0250 O                                   35 'PARENT NAME'                 S01141
0251 O                                   48 'TOWN'                        S01141
0249 O*****************22                72 'GLOBAL REF '          S01141 S01314
0252 O                                   78 'NO'                          S01141
0253 O                                   99 'CUSTOMER NAME'               S01141
0254 O                                  110 'TOWN'                        S01141
     O/COPY WNCPYSRC,SD0620O001
0255 O        E 01     25                                                 SD0620
0256 O*****               24   CPAR       6                               S01141
0257 O*****               24   CRNMCB    28                               S01141
0258 O*****               24   CTWNCB    41                               S01141
0259 O*****            27N24             25 'CONTINUED'                   S01141
0260 O*****                    CNUM      55                               S01141
0261 O*****                    CRNM      79                               S01141
0262 O*****                    CTWN      91                               S01141
0262 O*                                                                   S01141
0256 O*****************22*24   GREFP     12                        S01141 S01314
0256 O                    24   CPAR      19                               S01141
0257 O                    24   CRNMCB    41                               S01141
0258 O                    24   CTWNCB    54                               S01141
0259 O                 27N24             38 'CONTINUED'                   S01141
0256 O*****************22***   GREF      73                        S01141 S01314
0260 O                         CNUM      80                               S01141
0261 O                         CRNM     104                               S01141
0262 O                         CTWN     116                               S01141
     O/COPY WNCPYSRC,SD0620O002
0263 O        T 2      LRNU8                                              SD0620
0264 O                                   33 'TOTAL NUMBER OF CUSTOMER'    SD0620
0265 O                                   36 'S -'                         SD0620
0266 O                         NCHLD 3   41                               SD0620
0267 O        T 1      LRNU8                                              SD0620
0268 O                                   76 '*** END OF REPORT ***'       SD0620
0269 O        T 3      LR U8                                              SD0620
0270 O                                   22 'REFERENCE SD0620'            SD0620
0271 O                                   62 'PRINT TERMINATED, '          SD0620
0272 O                                   80 'DATABASE IN ERROR'           SD0620
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
