0001 H
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas SD Select account keys list')
0002 F********************************************************************
     F*  Midas  Standing Data Module
0004 F*                                                                  *
0005 F*    SD0702 - SELECT ACCOUNT KEYS LIST FOR PRINTING                *
0006 F*                                                                  *
      *  (c) Finastra International Limited 2001                      *
0008 F*                                                                  *
      *  Last Amend No. MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Prev Amend No. CDL038             Date 10May05               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 E26958             Date 03Oct91               *
0010 F*                                                                  *
     F********************************************************************
     F*                                                                  *
      *  MD046248 - Finastra Rebranding                               *
      *  CDL038 - Extended Deal Sub Type  (Recompile)                 *
     F*     E26958  -  ACCOUNT KEYS LIST NOT PRINTED WHEN CHANGES MADE   *
     F*                TO ACCOUNT KEY.                                   *
     F*                                                                  *
0011 F********************************************************************
0012 F*
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0014 FACKEYAK IF  F      96 12AI     2 DISK
0016 F*
0017 F* ID F  C  H  L    FUNCTION OF INDICATORS
0019 F* 02          ACKEYAK FILE - FILE HEADER RECORD
0020 F*    20                    - NUMBER OF INSERTS IS POSITIVE
0021 F*    21                    - NUMBER OF DELETIONS IS POSITIVE
0022 F*    22                    - NUMBER OF AMENDMENTS IS POSITIVE
0023 F*       39      UNSUCCESSFUL READ OF ACKEYAK FILE
0030 F*            LR SETON IN CALCULATIONS TO END PROGRAM AFTER 1ST RCD.
0031 F*          U8   DATABASE ERROR, REQUIRED RECORD NOT FOUND.
0032 F*
0076 I**
0077 I**   ACCOUNT KEYS FILE - HEADER RECORD.
0078 I**
0079 IACKEYAK NS  02   1 CH
0080 I                                        1   1 RECI
0081 I                                        2  11 AKEY
0082 I                                       14  170NREC
0083 I                                       18  210NINS        20
0084 I                                       22  250NDEL        21
0085 I                                       26  290NAMD        22
0086 I                                        1  96 LOT
0087 I**
0088 I**   CATCHALL.
0089 I        NS  03
0090 I**
     I           UDS
     I*
     I**  LOCAL DATA AREA FOR DATA BASE ERROR
     I                                      134 141 DBFILE
     I                                      142 170 DBKEY
     I                                      171 180 DBPROG
     I                                      181 183 DBASE
     C*****************************************************************
     C           *ENTRY    PLIST
     C                     PARM           RUNRPT  1
     C*****************************************************************
     C**
     C**    READ ACCOUNT KEYS HEADER RECORD,
     C**   DATABASE ERROR IF NOT FOUND.
     C                     READ ACKEYAK                  39
     C  N02                SETON                     U7U8
     C   U8                GOTO ENDD
     C*
      *
     C   20
     COR 21
     COR 22                MOVE 'Y'       RUNRPT
     C           ENDD      TAG                             ** ENDD TAG **
     C                     SETON                     LR
     C                     RETRN
      *
