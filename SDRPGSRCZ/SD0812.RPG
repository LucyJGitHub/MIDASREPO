     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas SD Check minimum length of field')
      *****************************************************************
      *                                                               *
      *  Midas - Standing Data Module                                 *
      *                                                               *
      *  SD0812 - Check minimum length of field                       *
      *                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *****************************************************************
      *                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *  Prev Amend No. S01431             Date 26Aug93               *
      *                                                               *
      *****************************************************************
      *                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  S01431 - Created for Merva/2 Direct Link                     *
      *                                                               *
      *****************************************************************
      *  P R O G R A M     C R E A T I O N     P A R A M E T E R S    *
      *                                                               *
      *****************************************************************
      *
      ** Copyright notice.
      *
     E                    CPY@    1   1 80               Copyright     arr
      *
      ** Array to break down incoming string.
      *
     E                    ARR       256  1
      *
      ** Copyright array.
      *
     IA@CPY       DS
     I                                        1  80 CPY@
      *
      ** Define entry parameter list.
      *
     C           *ENTRY    PLIST
     C                     PARM           STRING256        Field
     C                     PARM           LENGTH  30       Field length
     C                     PARM           RTNCD   5        RetUrn code
      *
      ** Initialise array and fields.
      *
     C                     MOVEASTRING    ARR
     C                     Z-ADD1         X       30
      *
      ** Count the number of non-blank characters until specified
      ** minimum required length has been reached
      *
     C           X         DOWLELENGTH                     B001
      *
     C           ARR,X     IFNE *BLANKS
     C                     ADD  1         COUNT   30
     C                     END
     C                     ADD  1         X
      *
     C                     END                             E001
      *
      ** If the number of characters (non-blank) in string is less
      ** than the specified minimum required length
      *
     C           COUNT     IFLT LENGTH
     C                     MOVE 'SHORT'   RTNCD
     C                     END
      *
     C                     SETON                     LR
     C                     RETRN
      *
      ********************************************************************
** CPY@     : Copyright notice for inclusion in all programs
(c) Finastra International Limited 2001
