     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas SD Update SDSTRDPD, TABTB36')
     F*****************************************************************
     F*                                                               *
     F*  Midas - (Standing Data)
     F*                                                               *
     F*  Program name: SD0951                                         *
     F*                                                               *
     F*  Function:  This program initialises:                         *
     F*                                                               *
     F*             Default Agency Trade (BVDEAT), Review Bulk Trades *
     F*             Default (BVRVBT), and 'Allow Trades Portfolio     *
     F*             Clients (BVATPC) on Securities Trading I.C.D.     *
     F*             PF/SDSTRDPD                                       *
     F*                                                               *
     F*             Default Agency Trade (DEAT), Review Bulk Trades   *
     F*             Default (RVBT), and 'Allow Trades Portfolio       *
     F*             Clients (ATPC) on Securities Trading I.C.D.       *
     F*             PF/TABTB36                                        *
     F*                                                               *
     F*  Called by: SDC0951 - Default Field Values on SE I.C.D.       *
     F*                                                               *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
     F*                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Prev Amend No. CSD027             Date 09Dec05               *
      *                 CAS006             Date 21Jan03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 S01448             Date 19Nov93               *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CAS006 - Hedge Accounting Phase B (Recompile)                *
     F*  S01448 - BLI DEVELOPMENT STEP 2.                             *
     F*           Created for switchable feature S01448 - Bulk Input  *
     F*           Enhancements                                        *
     F*                                                               *
     F*****************************************************************
     F*
     FSDSTRDPDUF  E           K        DISK
     FTABTB36 UF  E           K        DISK
      /EJECT
     E                    CPY@    1   1 80
     E*
     E** Array containing Copyright statement
     E*
      ***************** FIRST COMPILE TIME ARRAY *********************
      /SPACE 3
      *
      ** Data Area giving Installation Control Details
      *
     IPSDS       SDS
      *
      ** Program Status Data Structure - gives Job/Workstation name and
      ** User ID
      *
     I                                      244 253 JOB
     I                                      244 246 WSID
     I                                      254 263 USER
      *
      *****************************************************************
      *
      *** MAIN
      *****************************************************************
      *
     C           *ENTRY    PLIST
     C                     PARM           RETCDE  7
     C                     PARM           PMODE   1
      *
      *** Set up copyright parameter
      *
     C                     MOVEACPY@      BIS@   80
      *
     C                     EXSR PROC1
     C                     EXSR PROC2
      *
     C                     SETON                         LR
      *
     C                     RETRN
      *
      *****************************************************************
      *
      *** This program can be called with a parameter of '2' when the
      *** switchable feature is being reset on or '3' if being set off
      *** or '1' when the feature is switched on for the first time.
      *
      *****************************************************************
      *
      *****************************************************************
      *
     C           PROC1     BEGSR
     C                     READ SDSTRDPD                 05
     C           *IN05     IFEQ '0'
      *
      *** If the Bulk Input Indictator (BVBIOP) is 'Y', then set
      *** 'Default Agency Trade' (BVDEAT) to 'N', 'Review Bulk Trades
      *** Default' (BVRVBT) to 'N' and 'Allow Trades Portfolio
      *** Clients' (BVATPC) to 'N'
      *
     C           PMODE     IFEQ '1'
     C           BVBIOP    ANDEQ'Y'
     C           PMODE     OREQ '2'
     C           BVBIOP    ANDEQ'Y'
     C                     MOVE 'N'       BVDEAT
     C                     MOVE 'N'       BVRVBT
     C                     MOVE 'N'       BVATPC
     C                     END
      *
     C           PMODE     IFEQ '3'
     C           BVBIOP    ORNE 'Y'
     C                     MOVE *BLANK    BVDEAT
     C                     MOVE *BLANK    BVRVBT
     C                     MOVE *BLANK    BVATPC
     C                     END
     C*
     C                     UPDATSDSTRDD0
     C                     ELSE
     C                     EXSR *PSSR
     C                     END
     C                     ENDSR
      *****************************************************************
      *****************************************************************
      *
     C           PROC2     BEGSR
     C                     READ TABTB36                  06
     C           *IN06     IFEQ '0'
      *
      *** If the Bulk Input Indictator (BIMO) is 'Y', then set
      *** 'Default Agency Trade' (DEAT) to 'N', 'Review Bulk Trades
      *** Default' (RVBT) to 'N' and 'Allow Trades Portfolio
      *** Clients' (ATPC) to 'N'
      *
     C           PMODE     IFEQ '1'
     C           BIMO      ANDEQ'Y'
     C           PMODE     OREQ '2'
     C           BIMO      ANDEQ'Y'
     C                     MOVE 'N'       DEAT
     C                     MOVE 'N'       RVBT
     C                     MOVE 'N'       ATPC
     C                     END
      *
     C           PMODE     IFEQ '3'
     C           BVBIOP    ORNE 'Y'
     C                     MOVE *BLANK    DEAT
     C                     MOVE *BLANK    RVBT
     C                     MOVE *BLANK    ATPC
     C                     END
      *
     C                     UPDATTABTB36F
     C                     ELSE
     C                     EXSR *PSSR
     C                     END
     C                     ENDSR
     C*
      *****************************************************************
      *
      *****************************************************************
      *                                                               *
      * *PSSR  - Program exception error routine                      *
      *          Called automatically if a program error occurs,      *
      *          or directly by the program code using EXSR.          *
      *          This subroutine DUMPs the program just once.         *
      *                                                               *
      * Called by: (**calling routines**)                             *
      *                                                               *
      * Calls: None                                                   *
      *                                                               *
      *                                                               *
      *****************************************************************
      *
     C           *PSSR     BEGSR                           ** *PSSR SR **
      *
     C           @RUN      IFEQ *BLANK
     C                     MOVE 'Y'       @RUN    1
     C                     DUMP
     C                     END
      *
     C                     SETON                     U7U8LR
     C                     MOVEL'FAILURE' RETCDE
     C                     RETRN
      ********************************************************************
      *
     C                     ENDSR
      *
      ********************************************************************
**  CPY@
(c) Finastra International Limited 2001
