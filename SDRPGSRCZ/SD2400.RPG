     H        1
     F*****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas SD Extended settlements')                        *
     F*****************************************************************
     F*                                                               *
     F*  Midas Extended Settlement Screen Handler                     *
     F*                                                               *
     F*     This program will be made redundant at DBA R4.00          *
     F*     In the interim please check the new ILE RPG versions      *
     F*     and apply any new fixes if they are appropriate.          *
     F*                                                               *
     F*  SD2400 - Handle Screen Inputs of Extended Settlements        *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
     F*                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      *  Prev Amend No. CSD095             Date 08Apr14               *
      *                 253922             Date 26Jul13               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 260577             Date 04Jun09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSW037A            Date 02May05               *
      *                 BUG6198            Date 04Apr05               *
      *                 CSD025             Date 11Jan05               *
      *                 CDL025             Date 17Jan05               *
      *                 CDL031             Date 05Dec04               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CGL029             Date 01Sep03               *
      *                 CLE033             Date 09Apr03               *
      *                 CLE031             Date 11Feb03               *
      *                 219241             Date 01Jul03               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CAP056             Date 13Mar02               *
      *                 CIR008             Date 13Mar02               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 194656             Date 21Jun01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CIR003             Date 12Sep00               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 CDL008             Date 02May00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 CSW200             Date 21Aug00               *
      *                 182348             Date 07Aug00               *
      * Midas DBA 3.02 -----------------------------------------------*
      *                 CSW097             DATE 02DEC99               *
      *                 169210             DATE 14Oct99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 135152             DATE 14May98               *
      *                 145144             DATE 29OCT98               *
      *                 141734             DATE 10JUN98               *
      *                 136728             Date 10Jun98               *
      *                 135356             Date 18May98               *
      *                 134935             Date 10May98               *
     F*                 133866             DATE 21APR98               *
     F*                 CEU003             DATE 29MAR98               *
     F*                 117870             DATE 20FEB98               *
     F*                 108517             DATE 17FEB98               *
     F*                 100757             DATE 23APR98               *
     F*                 113832             Date 05Feb97               *
     F*                 CLE003             Date 10Dec96               *
     F*                 CSW011             Date 21MAR97               *
     F*                 CSW005             Date 01Aug96               *
      *                 107086             DATE 06MAR97               *
     F*                 S01408             DATE 27SEP96               *
     F*                 CSW096             DATE 31JUL96               *
     F*                 105708             DATE 11JUL96               *
     F*                 082386             DATE 22APR96               *
     F*                 087755             DATE 08JUN95               *
     F*                 S01408             DATE 30NOV95               *
     F*                 057119             DATE 11OCT95               *
     F*                 088221             DATE 31MAY95               *
     F*                 CSW095             DATE 02MAY95               *
     F*                 S01408             DATE 20JUL95               *
     F*                 S01408             DATE 10MAY95               *
     F*                 S01408             DATE 08MAR95               *
     F*                 S01408             DATE 11NOV94               *
     F*                 060036             DATE 06APR94               *
     F*                 066875             DATE 15MAR94               *
     F*                 056887             DATE 29SEP93               *
     F*                 S01408             DATE 30JUL93               *
     F*                 S01429             DATE 14JUL93               *
     F*                 S01412             DATE 13MAY93               *
     F*                 E45796             DATE 15APR93               *
     F*                 049518             DATE 19MAR93               *
     F*                 E45815             DATE 29JAN93               *
     F*                 E26903             DATE 12DEC92               *
     F*                 E31589             DATE 29NOV92               *
     F*                 E24039             DATE 16AUG91               *
     F*                 E30473             DATE 25NOV91               *
     F*                 BH3113             DATE 12AUG91               *
     F*                 BHF882             DATE 24MAY91               *
     F*                 BHF799             DATE 24MAY91               *
     F*                 S90237             DATE 12OCT90               *
     F*                 S01267             DATE 18SEP90               *
     F*                 E21618             DATE 05MAY90               *
     F*                 S01199             DATE 04MAY90               *
     F*                 S01251             DATE 03FEB90               *
     F*                 BHF751             DATE 02OCT90               *
     F*                 LN0810             DATE 01OCT90               *
     F*                 LN0801             DATE 27SEP90               *
     F*                 LN0798             DATE 27SEP90               *
     F*                 LN0787             DATE 25SEP90               *
     F*                 LN0789             DATE 25SEP90               *
     F*                 LN0757             DATE 14SEP90               *
     F*                 BHF586             DATE 14SEP90               *
     F*                 BHF488             DATE 12SEP90               *
     F*                 BHF558             DATE 03SEP90               *
     F*                 BHF505             DATE 30AUG90               *
     F*                 BHF366             DATE 02AUG90               *
     F*                 S01297             DATE 20AUG90               *
     F*                 E22405             DATE 16AUG90               *
     F*                 LN0569             DATE  1AUG90               *
     F*                 E338               DATE 23APR90               *
     F*                 S01227             DATE 18JAN90               *
     F*                 E00036             DATE 15NOV89               *
     F*                 S01117             DATE 27OCT1989             *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  CSD095 - Allow Deal Sub-Type and Branch for MM and FX SSIs   *
      *           (Recompile)                                         *
      *  253922 - Return blank parameter when the user cancelled the  *
      *           settlement details when confirming fx netting deals *
      *         - Applied for AR1082975 (Child: AR1082976)            *
      *  260577 - Unable to amend loan Maturity Date via API (MQU).   *
      *           Validate pay/receive settlement details if value    *
      *           date of deal inserted is beyond back-value period.  *
      *           Applied R4 fix 120800.                              *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  BUG6198- Cannot save new Details for CUSD (Recompile)        *
      *  CSD025 - Customer De-Activation                              *
      *  CDL025 - FX Netting Payment Generation                       *
      *  CDL031 - Effective Date on Extended SSI (Recompile)          *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CLE033 - Settlement method 09                                *
      *  CLE031 - Lending Enhancements                                *
      *  219241 - Defaulting of "Details of Charges" assign a         *
      *           system value                                        *
      *  CAP056 - Automatic Authorisation of Interface deals          *
      *           (Recompile)                                         *
      *  CIR008 - FRA/IRS Deals Authorisation (Recompile)             *
     F*  194656 - Settlements should not be cleared on amend.         *
     F*           Condition on CDL008.                                *
      *  CIR003 - Principal Exchange on Cross Currencies IRS          *
      *  CDL008 - Continuous Linked Settlement                        *
     F*  CSW200 - SWIFT 2000 Changes                                  *
     F*  182348 - 'ROLLUP' text not appearing for FRA deals on DSPF   *
     F*  CSW097 - SWIFT97 changes to MT340s and MT360s                *
     F*           Allow ISDA fields for FR type transactions          *
     F*  169210 - Requested hooks are duplicates                      *
     F*           Renamed SD2400C033 to SD2400CX33                    *
     F*           Renamed SD2400C034 to SD2400CX34                    *
     F*           Renamed SD2400C035 to SD2400CX35                    *
     F*           Renamed SD2400C036 to SD2400CX36                    *
     F*  135152 - Use SI type 'LE' for Customer Lending instead of    *
     F*           'MM'.                                               *
     F*  145144 - Program should default the 'In' Currency in         *
     F*           field 72, if 'Include ERI in field 72' is a 'Y'.    *
     F*  141734 - F10 doesn't work in amend mode if extended settl.   *
     F*           for transaction type 'AT' not defined               *
     F*  136728 - Receipt Settlement Ccy is not shown on Enquiry and  *
     F*           and Authorisation Screen                            *
     F*  135356 - EMU - Settlement currency is amendable while other  *
     F*           details are not.                                    *
     F*  134935 - Settlement currency not shown/amendable if          *
     F*           transition starts before value date                 *
     F*  133866 - Fix added as F10 to redefault fields did not clear  *
     F*           out and reset settlement fields properly.           *
     F*  CEU003 - EMU Dealing Settlement Ccy Conversion               *
     F*  117870 - Back value period not being checked on insert.      *
     F*           Complete 057119.                                    *
     F*           Apply fix 110122                                    *
     F*  108517 - Allow '?' processing in 'Receipts' and 'Payments' - *
     F*           'Our Nostro'.  Write values back to the screen.     *
     F*  100757 - When the value date is earlier than the date the    *
     F*           retail account was opened, display error message.   *
     F*           Note - for settlement method 04,  the settlement    *
     F*           account is not input, so the settlement method      *
     F*           should be highlighted instead.                      *
     F*  113832 - Fix parameter miss match when extended settements   *
     F*           is  called.                                         *
     F*  CLE003 - Backvaluation in Customer Lending Enhancements      *
      *  CSW011 - FRA MT34n only Message Generation                   *
      *  CSW005 - FRA/IRS MG34n and MG36n Msg Generation              *
      *  107086 - Payments BRANCH and NOSTRO not set up correctly     *
      *           for Payments Settlement Type '05'.                  *
      *  S01408 - Addition of core hook SD2400CP18                    *
      *         - Addition of core hook SD2400CP17                    *
      *         - Addition of core hook SD2400CP16                    *
      *         - Addition of core hook SD2400CP15                    *
      *         - Addition of core hook SD2400CP14                    *
      *         - Addition of core hook SD2400CP13                    *
      *         - Addition of core hook SD2400CP12                    *
      *         - Addition of core hook SD2400CP11                    *
      *         - Addition of core hook SD2400CP10                    *
      *         - Addition of core hook SD2400CCP9                    *
      *         - Addition of core hook SD2400CCP8                    *
      *         - Addition of core hook SD2400OOP1                    *
      *  CSW096 - SWIFT November 96 Changes                           *
      *           Correct fill of bank to bank                        *
     F*  105708 - Remove duplicate code from fix 049518.              *
      *  082386 - Allows entry of field 56 (Intermediary Bank)        *
      *              without a value being entered into field 57      *
      *              (Account With Bank)                              *
      *               Added array entry for new error code            *
     F*  087755 - Settlement details are reset whenever SD2400 is     *
     F*           called (Applied 070586).                            *
     F*  S01408 - Core hook SD2400C014 added                          *
     F*           Core hook SD2400C001 added                          *
     F*  057119 - FIX 31589 SLIGHTLY WRONG - SHOULD NOT PROTECT       *
     F*           PAY/RECEIVE FIELDS IF INSERT                        *
     F*  088221 - System acccepted ? as valid settlement methods      *
     F*           However, the system should call the valid list pgm  *
     F*           if question mark is entered in settlement methods.  *
     F*  CSW095 - S.W.I.F.T 1995 Message Changes.                     *
     F*           Account With Bank highlighted incorrectly.          *
     F*           Change array entry 976 46 to 976 47.                *
     F*  S01408 - Core hook SD2400FFPG added                          *
     F*           Core hook SD2400FFP1 added                          *
     F*           Core hook SD2400IIP1 added                          *
     F*           Core hook SD2400CSFI added                          *
     F*           Core hook SD2400CSF1 added                          *
     F*           Core hook SD2400CCP6 added                          *
     F*           Core hook SD2400CCP7 added                          *
     F*  S01408 - Core hook SD2400EEPG added                          *
     F*           Core hook SD2400CCP5 added                          *
     F*           Core hook SD2400OOPG added                          *
     F*           Core hook SD2400CER1 added                          *
     F*           Core hook SD2400CER2 added                          *
     F*  S01408 - Core hook SD2400IIPG added                          *
     F*           Core hook SD2400CPK1 added                          *
     F*           Core hook SD2400CPG1 added                          *
     F*           Core hook SD2400CPG2 added                          *
     F*           Core hook SD2400CEP1 added                          *
     F*           Core hook SD2400CVDS added                          *
     F*           Core hook SD2400CLDS added                          *
     F*           Core hook SD2400CLD1 added                          *
     F*           Core hook SD2400CCBU added                          *
     F*           Core hook SD2400CLD2 added                          *
     F*           Core hook SD2400CIS1 added                          *
     F*           Core hook SD2400CVS1 added                          *
     F*           Core hook SD2400CCP1 added                          *
     F*           Core hook SD2400CCP2 added                          *
     F*           Core hook SD2400CVS2 added                          *
     F*           Core hook SD2400CCP3 added                          *
     F*           Core hook SD2400CCP4 added                          *
     F*  S01408 - Core hook SD2400CISE added                          *
     F*           Core hook SD2400CCPG added                          *
     F*           Core hook SD2400CEPP added                          *
     F*  060036 - No validation check for incorrect input on A/C      *
     F*           line (e.g. '/A/C'). Add new error codes ESM0200     *
     F*           (RIBA), ESM0201 (RCRA), ESM0202 (PIBA), ESM0203     *
     F*           (AWBA), ESM0204 (BENA).                             *
     F*  066875 - For Settlement Type '05', validation pgm updates    *
     F*           the account seq no if it is blanks/zeros -          *
     F*           display the amended details on the screen.          *
     F*  056887 - For NA sold, do not default payment instructions as *
     F*           they are not relevant for NA sold.                  *
     F*  S01408 - Core hook SD2400CPCK added                          *
     F*         - Core hook SD2400CPKR added                          *
     F*         - Core hook SD2400CVSF added                          *
     F*         - Core hook SD2400CISN added                          *
     F*  S01429 - CHIPS ABA DEFAULTING NOT DISPLAYING ON SCREEN       *
     F*  S01412 - SWIFT September '93 Message Changes.                *
     F*            o add new error code (ESM0153) to be issued for    *
     F*              72: lines which do not begin '//' or '/8a/'      *
     F*  E45796 - If settlement method 14 (Retail Account) is used    *
     F*           and account is blocked, no warning is given.        *
     F*  049518 - SCREEN FIELDS NOT BEING UPDATED IF PARAMETERS       *
     F*           HAVE CHANGED FROM CALLING PROGRAM (MM0028).         *
     F*           ALSO PUT FIX LN0787 INTO INSERT PROCESSING SO       *
     F*           THAT BENEFICIARY FIELD WILL DEFAULT IF THE          *
     F*           SETTLEMENT METHOD IS CHANGED DURING INSERT.         *
     F*                                                               *
     F*  E45815 - Settlement details not updated when deal            *
     F*           details are changed                                 *
     F*  E26903 - The ordering customer/bank on settlement            *
     F*           instructions should default (as applicable) to      *
     F*           counterparty if left blank. Also add error          *
     F*           codes 803 & 804 for ordering customer.              *
     F*  E31589 - Protect settle instructions for pay/receive if      *
     F*           outside back value period                           *
     F*  E24039 - DOES NOT ALLOW AMENDMENT OF MATURITY SIDE OF        *
     F*           EXTENDED SETTLEMENTS IF DEAL VALUED BEFORE THE      *
     F*           BACK VALUED PERIOD                                  *
     F*  E30473 - POBR AND ROBR BEING BLANKED OUT WHEN DEAL AMENDED   *
     F*           AMENDED AFTER VALUE DATE.                           *
     F*  BH3113 - DEFAULTING FOR RECEIVE SETTLEMENT METHOD            *
     F*           DEFAULTING INCORRECTLY                              *
     F*  BHF882 - DO NOT MOVE RECEIVE INFO IN FIELD 70 OR 72          *
     F*  BHF799 - IF FED. FUND = 'Y' AND BUY CCY IS NOT 'USD'         *
     F*           FIELD DTYPE SHOULD BE 'FX' INSTEAD OF 'FF'          *
     F*  S90237 - 1. IF SETTLEMENT METHOD IS '08'                     *
     F*           2. AND PAYMENT CURRENCY IS 'USD'                    *
     F*           3. AND THE DEAL CUSTOMER OR THE BENEFICIARY         *
     F*              (OR BOTH) IS A NON-BANK.                         *
     F*              THEN DETAILS OF CHARGES MUST BE 'OUR'.           *
     F*              ADD ERROR CODE '750'.                            *
     F*  S01267 - RECOMPILED FOR MIS RELEASE 2.2 CHANGES.             *
     F*  E21618 - THIS HAS BEEN PUT IN BY LN0789                      *
     F*           IF CHAIN TO STANDARD SETTLEMENT(SDEXSTL1) FAILS     *
     F*           CHAIN AGAIN WITH TYPE 'AT' - IN SSIB SR.            *
     F*  S01199 - RECOMPILED FOR CURSOR SENSITIVE HELP                *
     F*  S01251 - SYNON FIELD/PROGRAM NAME CHANGES                    *
     F*  BHF751 - NO DEFAULTING IS OCCURING ON INSERT.                *
     F*  LN0810 - DO NOT BLANK OUT RECEIVE SIDE SETTLEMENT TYPE       *
     F*           IF NO RECEIVE SIDE SETTLEMENT INSTRUCTIONS.         *
     F*  LN0801 - ADD MESSAGE ESM0879 TO COMPILE TIME ARRAY.ALSO      *
     F*           CHANGE ESM0919.                                     *
     F*  LN0798 - ADD MESSAGE ESM0699 TO COMPILE TIME ARRAY WITH      *
     F*           ASSOCIATED INDICATORS                               *
     F*  LN0787 - DEFAULT SETTLEMENT INSTRUCTIONS TO BE DISPLAYED     *
     F*           ON AN AMEND                                         *
     F*  N.B.  FIX NOS. LN0789, LN0757 & BHF586 ARE R10 FIXES         *
     F*        MADE TO CORE ERRORS                                    *
     F*  LN0789 - FX DEAL INPUT; WHEN SETTING UP STANDARD             *
     F*           SETTLEMENTS FOR BUY CURRENCY, IF CHAIN TO           *
     F*           SDEXSTL1 FAILS ON DEAL TYPE THE PROGRAM DOES        *
     F*           NOT CHECK FOR AN 'ALL TRANSACTIONS' RECORD          *
     F*  LN0757 - FOR FX DEALS, IF NO STANDARD INSTRUCTIONS FOR       *
     F*           SELL CURRENCY, NO CHECK IS MADE TO SEE IF           *
     F*           STANDARD INSTRUCTIONS EXIST FOR BUY CURRENCY        *
     F*  BHF586 - FOR FX DEALS, IF NO STANDARD SETTLEMENTS FOR        *
     F*           BUY CURRENCY RECEIVE DETAILS DEFAULT TO THOSE       *
     F*           FOR THE SELL CURRENCY                               *
     F*  BHF488 - SHOW DEAL NUMBER IF CALLED FROM TRADES MAINT.       *
     F*           AND A DEAL NUMBER IS AVAILABLE                      *
     F*  BHF558 - NO DEFAULTS SHOULD BE DISPLAYED ON FIRST            *
     F*           DISPLAY OF SCREEN.                                  *
     F*  BHF505 - CHANGE COMPILE TIME ARRAY SO THAT WHEN ERROR        *
     F*           MESSAGE 705 IS DISPLAYED FIELD 57 IS                *
     F*           HIGHLIGHTED                                         *
     F*  BHF366 - DB ERR AFTER MM0089 PASSED A CUSTOMER SHORTNAME     *
     F*  S01297 - RELEASE TEN EXTENDED SETTLEMENTS CHANGES.           *
     F*  E22405 - ALLOW COVER MT202 TO BE GENERATED FOR AN MT202      *
     F*  LN0569 - REPLACE ? WITH BRANCH ON SCREEN                     *
     F*  E338   - PASS BACK DETAILS FROM ACCESS PROGRAM SUBFILE       *
     F*           SELECT SCREEN                                       *
     F*  S01227 - EXTENDED SETTLEMENTS INCORPORATION - CHANGE         *
     F*           OF PROGRAM NAME SDKTPVR TO SD2400.                  *
     F*           REMOVE RESTORE OF PMVALO (REMOVE FIELD #PJZST)      *
     F*           IF CHAIN TO STANDARD SETTLEMENT(SDEXSTL1) CHAIN     *
     F*           AGAIN WITH TYPE 'AT'                                *
     F*           AMEND KEY TO CORRECT LENGTH                         *
     F*           CHANGE 'DETAILS OF CHARGES' ERROR MSG/ERR MSG 935   *
     F*           /'BANK TO BANK INFORMATION' HIGHLIGHTING            *
     F*  S01117 - RELEASE 10, MULTIBRANCHING                          *
     F*                                                               *
     F*****************************************************************
     F*SDKTPVR#CF  E                    WORKSTN                           S01227
     F/COPY WNCPYSRC,SD2400F001
     FSD2400DFCF  E                    WORKSTN                            S01227
     F/COPY WNCPYSRC,SD2400F002
     F*  Extended Settlements detail screen
     FSDCUSTL1IF  E           K        DISK
     F*  Client Details
     FSDCUSTL2IF  E           K        DISK
     F*  Client Details
     FSDEXSTL1IF  E           K        DISK
     F*                                                                   S01408
     F/COPY WNCPYSRC,SD2400FFPG                                           S01408
     F*                                                                   S01408
     F*  Standard settlement instructions for extended settlements
     FSDCNSTL1IF  E           K        DISK
     F*  Counterparty Nostros
     F*                                                                   S01408
     F/COPY WNCPYSRC,SD2400FFP1                                           S01408
     F*                                                                   S01408
      /EJECT
     F*****************************************************************
     F*                                                               *
     F* ID F  C  H  L    FUNCTION OF INDICATORS                       *
     F*                                                               *
     F*       01  Enable F10                                          *   CEU003
     F*       02  Non-display and protect of Receipt Settlement Ccy   *   CEU003
     F*           screen field                                        *   CEU003
     F*       03  Exit from program                                   *
     F*       07  Protect new screen fields                           *   CEU003
     F*       08  Error in Receipt Settlement Ccy                     *   CEU003
     F*       09  Non-display and protect of Payment Settlement Ccy   *   CEU003
     F*           and 'In' Currency screen field                      *   CEU003
     F*       11  Error in Payment Settlement Ccy                     *   CEU003
     F*       12  Return to first screen                              *
     F*       14  Error in 'In' Ccy in Field 72                       *   CEU003
     F*       28  Error - Definition Sender to Receiver 1             *   CSW005
     F*       29                                                      *
     F*       31  Error - Receipt Settlement Type                     *
     F*       32  Error - Payment Settlement Type                     *
     F*       33  Error - Receipt Our Nostro                          *
     F*       34  Error - Payment Our Nostro                          *
     F*       35  Error - Receipt of MT100                            *
     F*       36  Error - Ordering Customer                           *
     F*       37  Error - Ordering Customer                           *
     F*       38  Error - Ordering Bank                               *
     F*       39  Error - Ordering Bank                               *
     F*       40  Error - Recipient's Correspondent                   *
     F*       41  Error - Repipient's Correspondent Account Line      *
     F*       42  Error - Intermediary Bank                           *
     F*       43  Error - Intermediary Bank                           *
     F*       44  Error - Intermediary Bank Account Line              *
     F*       45  Error - Intermediary Bank Account Line              *
     F*       46  Error - "Account With" Bank                         *
     F*       47  Error - "Account With" Bank Account Line            *
     F*       48  Error - Beneficiary                                 *
     F*       49  Error - Beneficiary Account Line                    *
     F*       50  Error - Payment Details 1                           *
     F*       51  Error - Payment Details 2                           *
     F*       52  Error - Payment Details 3                           *
     F*       53  Error - Payment Details 4                           *
     F*       54  Error - Details of Charges                          *
     F*       55  Error - Bank to Bank Information 1                  *
     F*       56  Error - Bank to Bank Information 2                  *
     F*       57  Error - Bank to Bank Information 3                  *
     F*       58  Error - Bank to Bank Information 4                  *
     F*       59  Error - Bank to Bank Information 5                  *
     F*       60  Error - Bank to Bank Information 6                  *
     F*       61  Error - Cover MT202 required                        *   E22405
     F*       62  Error - Definition Sender to Receiver 2             *   CSW005
     F*       63  Error - Definition Sender to Receiver 3             *   CSW005
     F*       64  Error - Definition Sender to Receiver 4             *   CSW005
     F*       65  Error code found in @ERR table                      *
     F*       66  Error - Definition Sender to Receiver 5             *   CSW005
     F*       67  Error - Definition Sender to Receiver 6             *   CSW005
     F*       68  Error - Settlement Sender to Receiver 1             *   CSW005
     F*       69  Error - Settlement Sender to Receiver 2             *   CSW005
     F*       70  Error - Settlement Sender to Receiver 3             *   CSW005
     F*       71  Error - Settlement Sender to Receiver 4             *   CSW005
     F*       72  Error - Settlement Sender to Receiver 5             *   CSW005
     F*       73  Error - Settlement Sender to Receiver 6             *   CSW005
     F*       74  Error - Condition 1                                 *   CSW005
     F*       75  Error - Condition 2                                 *   CSW005
     F*       76  Error - Condition 3                                 *   CSW005
     F*       77  Error - Condition 4                                 *   CSW005
     F*       78  Protect payment fields                              *
     F*       79  Protect receipt fields                              *
     F*       80  System has multibranching flag set on               *
     F*       81  Error - Condition 5                                 *   CSW005
     F*       82  Error - Condition 6                                 *   CSW005
     F*       83  Error - ISDA rules version                          *   CSW005
     F*       84  Error - Agreement Type                              *   CSW005
     F*       85  Error - Agreement date                              *   CSW005
     F*       86                                                      *
     F*       87  VALIDATION TO BE DONE YET ? FLAG                    *
     F*       88  Error - Agreement version                           *   CSW005
     F*       90  Chain fail on SDCUSTPD, SDCNSTPD, SDEXSTPD          *
     F*       95  On after first entry into program                   *
     F*       98                                                      *
     F*       99                                                      *
     F/COPY WNCPYSRC,SD2400F003
     F*   NOCHG1  Receipt details - Our Nostro - not amended          *   E24039
     F*   NOCHG2  Payment details - Our Nostro - not amended          *   E24039
     F*       U7  Database error                                      *
     F*       U8  Database error                                      *
     F*       LR  Database error, end of program                      *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
     F*            INDEX TO SUBROUTINES                               *
     F*            --------------------                               *
     F*   #A     - Initial processing                                 *
     F*   AMD    - Amend processing                                   *
     F*   AUT    - Authorisation processing                           *
     F*   #B     - Main processin                                     *
     F*   #C     - Termination processing                             *
     F*   CONV   - Convert customer numbers to shortnames             *
     F*   CVTA   - Convert customer number to shortname               *
     F*   CVTB   - Convert counterparty to shortname                  *
     F*   DEL    - Delete processing                                  *
     F*   ENQ    - Enquiry processing                                 *
     F*   INS    - Insert processing                                  *
     F*   PARMA  - Load screen from passed parameters                 *
     F*   PARMB  - Load parameters from screen fields                 *
     F*   RESET  - Clear screen                                       *
     F*   RTV    - Retrieve standard instructions                     *
     F*   CUST   - Retrieve Customer name from SDCUSTL1               *
     F*   NOST   - Retrieve Counterparty Nostro name                  *
     F*   ERROR  - Output error messages                              *
     F*   SSIA   - Obtain customer number for chaining to SSI file    *
     F*   SSIB   - Retrieve Receipt Settlement Instructions for FX    *
     F*   SSIC   - Retrieve Pay/Receive Instructions for Prime ccy    *
     F*   VAL    - Validate screen input                              *
     F*  SRREDF  - Re-access Default Settlement Instructions          *   CEU003
     F*   ZA0240 - Display error message                              *
     F*   ZA0250 - Clear error messages                               *
     F*****************************************************************
      /EJECT
     E/COPY WNCPYSRC,SD2400EEPG                                           S01408
     E                    UER        50  3
     E/COPY WNCPYSRC,SD2400E001
     E**  TO HOLD ERROR CODES RETURNED BY SD2410  (50 *3)
     E******************* @ERR    1 104  4   @IND   12                    S01117
     E*****               @ERR    1 113  4   @IND   12             S01117 S01227
     E**********          @ERR    1 115  4   @IND   12             S01227 E22405
     E**********          @ERR    1 117  4   @IND   12              E22405S01297
     E**********          @ERR    1 123  4   @IND   12              S01297LN0798
     E**********          @ERR    1 124  4   @IND   12              LN0798LN0801
     E**********          @ERR    1 125  4   @IND   12              LN0801S90237
     E********************@ERR    1 126  4   @IND   12              S90237E26903
     E********************@ERR    1 128  4   @IND   12              E26903E45796
     E********************@ERR    1 130  4   @IND   12              E45796S01412
     E********************@ERR    1 131  4   @IND   12             S01412 060036
     E********************@ERR    1 136  4   @IND   12             060036 082386
     E********************@ERR    1 137  4   @IND   12             082386 CSW005
     E********************@ERR    1 150  4   @IND   12             CSW005 CLE003
     E***********         @ERR    1 152  4   @IND   12             CLE003 CEU003
     E********************@ERR    1 164  4   @IND   12             CEU003 CSW097
     E***********         @ERR    1 170  4   @IND   12             CSW097 CSW200
     E***********         @ERR    1 171  4   @IND   12             CSW200 CDL008
     E**********          @ERR    1 178  4   @IND   12                                 CDL008 219241
     E**********          @ERR    1 179  4   @IND   12                                 219241 CLE031
     E                    @ERR    1 193  4   @IND   12                                        CLE031
     E/COPY WNCPYSRC,SD2400E002
     E**  ERROR CODES WITH ASSOCIATED INDICATORS TABLE
     E                    @INDA       6  2
     E/COPY WNCPYSRC,SD2400E003
     E**  HOLDS ONE ERROR CODE'S INDICATORS
     E                    CPY@    1   1 80
     E/COPY WNCPYSRC,SD2400E004
     I*********************************************************************
      /EJECT
     I*********************************************************************
     I*                                                                   CSW005
     IWSCRN2      DS                                                      CSW005
     I                                        1  35 RDSR1                 CSW005
     I                                       36  70 RDSR2                 CSW005
     I                                       71 105 RDSR3                 CSW005
     I                                      106 140 RDSR4                 CSW005
     I                                      141 175 RDSR5                 CSW005
     I                                      176 210 RDSR6                 CSW005
     I                                      211 245 RSSR1                 CSW005
     I                                      246 280 RSSR2                 CSW005
     I                                      281 315 RSSR3                 CSW005
     I                                      316 350 RSSR4                 CSW005
     I                                      351 385 RSSR5                 CSW005
     I                                      386 420 RSSR6                 CSW005
     I                                      421 455 RCND1                 CSW005
     I                                      456 490 RCND2                 CSW005
     I                                      491 525 RCND3                 CSW005
     I                                      526 560 RCND4                 CSW005
     I                                      561 595 RCND5                 CSW005
     I                                      596 630 RCND6                 CSW005
     I                                      631 634 RISDA                 CSW005
     I                                      635 640 RAGTY                 CSW005
     I                                      641 646 RAGDT                 CSW005
     I**************************************647 648 RAGVV           CSW005CSW097
     I                                      647 650 RAGVV                 CSW097
     I*                                                                   CSW005
     I*WPARM3*****DS************************    648                 CSW005CSW097
     IWPARM3      DS                            650                       CSW097
     I** data structure for passing parameter to/from calling             CSW005
     I** program SD2410 (Note: length of DS must equal length             CSW005
     I** of PF/SDSETLPD)                                                  CSW005
     I*
     I@PARM1    E DSSETLIAB
     I*
     I** data structure for passing parameters to/from calling program
     I*
     I@PARM2    E DSSETLIAZ
     I*
     I** data structure for passing parameters to/from calling program
     I*                                                                   CSW005
     I/COPY WNCPYSRC,SD2400I001
     I@PARM3    E DSSDSETLPD                                              CSW005
     I*                                                                   CSW005
     I** data structure for passing parameters to/from calling program    CSW005
     I*                                                                   CSW005
     ISCSARD    E DSSCSARDPD                                              CSW005
     I*                                                                   CSW005
     I** SAR details                                                      CSW005
     I*                                                                   CSW005
     ISDFAIS    E DSSDFAISPD                                              CSW005
     I*                                                                   CSW005
     I** FRA/IRS ICD Details                                              CSW005
     I*                                                                   CSW005
     ISDNOST    E DSSDNOSTPD                                              CDL008
      ** Nostro Details                                                   CDL008
      *                                                                   CDL008
     IDSFDY     E DSDSFDY                                                 CSW005
     I*                                                                   CSW005
     I** Short data structure for use by access programs                  CSW005
     I*
     I* Data structures:-
     I*
     I/COPY WNCPYSRC,SD2400C001                                           S01408
     I*                                                                   S01408
     IPSDS       SDS
     I                                     *PARMS   @PARMS                BHF488
     I                                      244 253 @JOB
     I/COPY WNCPYSRC,SD2400I002
     I**  Program status data structure.
     IRUNDAT      DS                             13
     I                                        1   7 @RUND
     I                                       13  13 @MBIN                 S01117
     I*   RUN DATE DATA AREA - Run Date
     I@WRK15      DS                                                      S01117
     I                                        1   3 @WRK3                 S01117
     I**********                              4  15 @WRK12                             S01117 CGL029
     I                                        4  21 @WRK12                                    CGL029
     I*                                                                   S01408
     I/COPY WNCPYSRC,SD2400IIP1                                           S01408
     I*                                                                   S01408
     I**  Working ds to split branch from rest of settlement details      S01117
     I*                                                                   E24039
     ILDA         DS                            256                       E24039
     I                                      200 200 NOCHG1                E24039
     I                                      202 202 NOCHG2                E24039
     I**  LOCAL DATA AREA                                                 E24039
     I/COPY WNCPYSRC,SD2400I004
     ISDCURR    E DSSDCURRPD                                              CEU003
      ***  External data structures for Currency Details                  CEU003
     ISDGELR    E DSSDGELRPD                                              CEU003
     I              QQACCD                          QQACC1                                    CGL029
      ***  External data structures for General Ledger Details            CEU003
     IDSSDY     E DSDSSDY                                                 CEU003
      **  Second data structure for Access Programs, long DS              CEU003
     I/COPY WNCPYSRC,SD2400I003
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C                     MOVEACPY@      BIS@   80
     C*                                                               *
     C* CONTROL                                                       *
     C*                                                               *
     C* CALLS    #A       - Initial processing                        *
     C*          #B       - Main processing handles screen processing *
     C*          #C       - Termination processing                    *
     C*          PARMA    - Load screen from passed parameters        *
     C*                                                               *
     C* CALLED BY         -                                           *
     C*                                                               *
     C*****************************************************************
     C*                                                               *
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,SD2400CISN                                           S01408
     C*                                                               *
     C*  Initial Processing (if first entry into program)
     C*
     C*  FIRST ENTRY INTO PROGRAM
     C                     Z-ADD1         COUNT   10                      CLE003
     C                     Z-ADD1         COUNT1  10                      CLE003
     C           *IN95     IFEQ '0'
     C                     EXSR #A
     C*************************************************************045815 087755
     C***Reset*fields*on*subsequent*entries*to*program*************045815 087755
     C******************************************************************* 087755
     C***********          ELSE                                    045815 087755
     C***********          MOVE *BLANKS   #1JPST                   045815 087755
     C***********          MOVE *BLANKS   #1JQST                   045815 087755
     C***********          MOVE *BLANKS   #1DTTX                   045815 087755
     C***********          MOVE *BLANKS   #1DTT2                   045815 087755
     C***********          MOVE *BLANKS   #1DWTX                   045815 087755
     C***********          MOVE *BLANKS   #1DWT2                   045815 087755
     C***********          MOVE *BLANKS   #DEPTX                   045815 087755
     C***********          MOVE *BLANKS   #DEJTX                   045815 087755
     C***********          MOVE *BLANKS   #DEITX                   045815 087755
     C***********          MOVE *BLANKS   #DEHTX                   045815 087755
     C***********          MOVE *BLANKS   #DEGTX                   045815 087755
     C***********          MOVE *BLANKS   #DESTX                   045815 087755
     C***********          MOVE *BLANKS   #1D8TX                   045815 087755
     C***********          MOVE *BLANKS   #DETTX                   045815 087755
     C***********          MOVE *BLANKS   #DEUTX                   045815 087755
     C***********          MOVE *BLANKS   #1DVTX                   045815 087755
     C***********          MOVE *BLANKS   #1D7TX                   045815 087755
     C***********          MOVE *BLANKS   #DEQTX                   045815 087755
     C***********          MOVE *BLANKS   #1D9TX                   045815 087755
     C***********          MOVE *BLANKS   #DERTX                   045815 087755
     C***********          MOVE *BLANKS   #1EATX                   045815 087755
     C***********          MOVE *BLANKS   #1D2TX                   045815 087755
     C***********          MOVE *BLANKS   #1D3TX                   045815 087755
     C***********          MOVE *BLANKS   #1D4TX                   045815 087755
     C***********          MOVE *BLANKS   #1D5TX                   045815 087755
     C***********          MOVE *BLANKS   #1C9CD                   045815 087755
     C***********          MOVE *BLANKS   #1D6TX                   045815 087755
     C***********          MOVE *BLANKS   #1EBTX                   045815 087755
     C***********          MOVE *BLANKS   #1ECTX                   045815 087755
     C***********          MOVE *BLANKS   #1EDTX                   045815 087755
     C***********          MOVE *BLANKS   #1EETX                   045815 087755
     C***********          MOVE *BLANKS   #1EFTX                   045815 087755
     C***********          MOVE 'Y'       PMFRST                   045815 087755
     C***********          MOVE 'Y'       #PK7ST                   045815 087755
     C                     END
     C*
     C*  Termination Parameter is Terminate
     C           PMTERM    IFEQ 'T'
     C*
     C*  closedown program - Rundate
     C                     SETON                     LR
     C                     RETRN
     C                     END
     C*
     C*  Move control parameters to screen
     C                     EXSR PARMA
     C*
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,SD2400CPKR                                           S01408
     C*
     C*  Main Processing
     C           *IN03     DOWNE'1'
     C           *IN12     ANDNE'1'
     C           *INKH     ANDNE'1'                                       CIR003
     C/COPY WNCPYSRC,SD2400C028
     C           CIR003    IFEQ 'Y'                                       CIR003
     C           PMTTYP    ANDEQ'RX'                                      CIR003
     C           PMCPGM    IFEQ 'VAL*'                                    CIR003
     C           PMCPGM    OREQ 'INT*'                                    CIR003
     C           PMCPGM    OREQ 'MAT*'                                    CIR003
     C                     MOVE *ON       *IN25                           CIR003
     C                     MOVE 'Y'       WEXST   1                       CIR003
     C                     ENDIF                                          CIR003
     C                     ELSE                                           CIR003
     C                     MOVE *OFF      *IN25                           CIR003
     C                     MOVE 'N'       WEXST                           CIR003
     C                     ENDIF                                          CIR003
     C                     EXSR #B
     C                     END
     C*
     C*                                                                   S01408
     C/COPY WNCPYSRC,SD2400CPK1                                           S01408
     C*                                                                   S01408
     C*  Termination Processing
     C                     EXSR #C
     C*C*PY*WN*PYSRC*SD2400C033                                           169210
     C/COPY WNCPYSRC,SD2400CX33                                           169210
     C*
     C           ENDPGM    TAG
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C* #A       - Initial processing                                 *
     C*                                                               *
     C* CALLS       RESET - Clear screen                              *
     C*                                                               *
     C* CALLED BY   CONTROL                                           *
     C*                                                               *
     C*****************************************************************
     C           #A        BEGSR
     C*                                                                   S01408
     C/COPY WNCPYSRC,SD2400CPG1                                           S01408
     C*                                                                   S01408
     C*
     C*****                MOVEL'SDKTPVR' PMDPGM                          S01227
     C                     MOVEL'SD2400'  PMDPGM                          S01227
     C*
     C**  Run date in DDMMMYY
     C           *NAMVAR   DEFN           RUNDAT
     C                     IN   RUNDAT
     C/COPY WNCPYSRC,SD2400C011
     c*                                                                   S01117
     C** If system is multibranched set on *in for display file use       S01117
     C           @MBIN     COMP 'Y'                      80               S01117
     c**
     C                     MOVEL@JOB      #WID    3
     C**
     C                     Z-ADD0         DBNUM   20
     C                     MOVEL*BLANKS   ZAMSID 10
     C                     MOVE *BLANK    @RCODE  7
     C*****                MOVEL'SDKTPVR' ##PGM  10                       S01227
     C                     MOVEL'SD2400'  ##PGM  10                       S01227
     C                     MOVEL*BLANKS   MSGKEY  4
      *                                                                   CIR003
      **  Access SAR details file to see if CIR003 is installed           CIR003
      *                                                                   CIR003
     C                     CALL 'AOSARDR0'                                CIR003
     C                     PARM '       ' @RTCD   7                       CIR003
     C                     PARM '*VERIFY' @OPTN   7                       CIR003
     C                     PARM 'CIR003'  @SARD   6                       CIR003
      *                                                                   CIR003
     C           @RTCD     IFNE *BLANK                                    CIR003
     C           @RTCD     ANDNE'*NRF   '                                 CIR003
     C                     MOVEL'SCSARDPD'PMDBFL                          CIR003
     C                     MOVEL'SD2400'  PMDPGM                          CIR003
     C                     Z-ADD03        PMDBSE                          CIR003
     C                     MOVE *ON       *INU7                           CIR003
     C                     MOVE *ON       *INU8                           CIR003
     C                     MOVE *ON       *INLR                           CIR003
     C                     ELSE                                           CIR003
     C           @RTCD     IFEQ *BLANK                                    CIR003
     C                     MOVE 'Y'       CIR003  1                       CIR003
     C                     ELSE                                           CIR003
     C                     MOVE 'N'       CIR003                          CIR003
     C                     ENDIF                                          CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C*                                                                   CLE033
     C** Access Switchable Feature Details                                CLE033
     C*                                                                   CLE033
     C                     CALL 'AOSARDR0'                                CLE033
     C                     PARM *BLANKS   PRTCD   7                       CLE033
     C                     PARM '*VERIFY 'POPTN   7                       CLE033
     C                     PARM 'CLE033'  PSARD   6                       CLE033
     C*                                                                   CLE033
     C           PRTCD     IFEQ *BLANKS                                   CLE033
     C                     MOVE 'Y'       CLE033  1                       CLE033
     C                     ELSE                                           CLE033
     C                     MOVE 'N'       CLE033                          CLE033
     C                     ENDIF                                          CLE033
      *                                                                                       CLE031
      ** Check if switchable feature CSW005 is switched on.                                   CLE031
      *                                                                                       CLE031
     C                     CALL 'AOSARDR0'                                                    CLE031
     C                     PARM *BLANKS   P@RTCD  7                                           CLE031
     C                     PARM '*VERIFY' P@OPTN  7                                           CLE031
     C                     PARM 'CLE031'  P@SARD  6                                           CLE031
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE031
     C*                                                                                       CLE031
     C                     MOVE 'N'       CLE031  1                                           CLE031
     C           P@RTCD    IFEQ *BLANK                                                        CLE031
     C                     MOVE 'Y'       CLE031  1                                           CLE031
     C                     MOVE '0'       *IN09                                               CLE031
     C                     MOVE '0'       *IN02                                               CLE031
     C                     ELSE                                                               CLE031
     C           P@RTCD    IFNE '*NRF   '                                                     CLE031
     C                     MOVEL'SCSARDPD'PMDBFL           **************                     CLE031
     C                     MOVEL'SD2400'  PMDPGM           ** DBASE 01 **                     CLE031
     C                     Z-ADD01        PMDBSE           **************                     CLE031
     C                     MOVE *ON       *INU7                                               CLE031
     C                     MOVE *ON       *INU7                                               CLE031
     C                     MOVE *ON       *INLR                                               CLE031
     C                     MOVE 'T'       PMTERM                                              CLE031
     C                     MOVE '1'       *IN09                                               CLE031
     C                     MOVE '1'       *IN02                                               CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
     C*                                                                   CLE003
     C**  Access SAR details file to see if CLE003 is installed           CLE003
     C*                                                                   CLE003
     C                     CALL 'AOSARDR0'                                CLE003
     C                     PARM '       ' @RTCD   7                       CLE003
     C                     PARM '*VERIFY' @OPTN   7                       CLE003
     C                     PARM 'CLE003'  @SARD   6                       CLE003
      *                                                                   CLE003
     C           @RTCD     IFEQ *BLANK                                    CLE003
     C                     MOVE 'Y'       CLE003  1                       CLE003
     C                     ELSE                                           CLE003
     C                     MOVE 'N'       CLE003                          CLE003
     C                     ENDIF                                          CLE003
     C*                                                                   CSW005
     C                     MOVEL*BLANKS   CSW005  1                       CSW005
     C                     MOVEL*BLANKS   CSW011  1                       CSW011
     C*                                                                   CSW005
     C** Check if switchable feature CSW005 is switched on.               CSW005
     C*                                                                   CSW005
     C                     CALL 'AOSARDR0'                                CSW005
     C                     PARM *BLANKS   P@RTCD  7                       CSW005
     C                     PARM '*VERIFY' P@OPTN  7                       CSW005
     C                     PARM 'CSW005'  P@SARD  6                       CSW005
     C           SCSARD    PARM SCSARD    DSFDY                           CSW005
     C*                                                                   CSW005
     C           P@RTCD    IFNE *BLANK                                    CSW005
     C           P@RTCD    ANDNE'*NRF   '                                 CSW005
     C                     MOVEL'SCSARDPD'PMDBFL           ************** CSW005
     C                     MOVEL'SD2400'  PMDPGM           ** DBASE 01 ** CSW005
     C                     Z-ADD01        PMDBSE           ************** CSW005
     C                     MOVE *ON       *INU7                           CSW005
     C                     MOVE *ON       *INU7                           CSW005
     C                     MOVE *ON       *INLR                           CSW005
     C                     MOVE 'T'       PMTERM                          CSW005
     C                     END                                            CSW005
     C*                                                                   CSW005
     C           P@RTCD    IFEQ *BLANKS                                   CSW005
     C                     MOVEL'Y'       CSW005                          CSW005
     C*                                                                   CSW005
     C** Retrieve FRA/IRS ICD details:                                    CSW005
     C                     CALL 'AOFAISR0'                                CSW005
     C                     PARM '*DBERR'  P@RTCD  7                       CSW005
     C                     PARM '*FIRST'  P@OPTN  7                       CSW005
     C           SDFAIS    PARM SDFAIS    DSFDY                           CSW005
     C*                                                                   CSW005
     C           P@RTCD    IFNE *BLANKS                                   CSW005
     C                     MOVEL'SDFAISPD'PMDBFL           ************** CSW005
     C                     MOVEL'SD2400'  PMDPGM           ** DBASE 02 ** CSW005
     C                     Z-ADD02        PMDBSE           ************** CSW005
     C                     MOVE *ON       *INU7                           CSW005
     C                     MOVE *ON       *INU8                           CSW005
     C                     MOVE *ON       *INLR                           CSW005
     C                     MOVE 'T'       PMTERM                          CSW005
     C                     ENDIF                                          CSW005
     C*                                                                   CSW005
     C                     ENDIF                                          CSW005
     C*                                                                   CSW011
     C                     CALL 'AOSARDR0'                                CSW011
     C                     PARM *BLANKS   P@RTCD  7                       CSW011
     C                     PARM '*VERIFY' P@OPTN  7                       CSW011
     C                     PARM 'CSW011'  P@SARD  6                       CSW011
     C*                                                                   CSW011
     C           P@RTCD    IFEQ *BLANKS                                   CSW011
     C                     MOVEL'Y'       CSW011                          CSW011
     C                     ENDIF                                          CSW011
     C*                                                                   CSW200
     C** Check if SWIFT 2000 Changes is on.                               CSW200
      *                                                                   CSW200
     C                     CALL 'SWIF2000'                                CSW200
     C                     PARM *BLANKS   P@RTCD                          CSW200
      *                                                                   CSW200
     C           P@RTCD    IFEQ 'CSW200'                                  CSW200
     C                     MOVEL'Y'       CSW200  1                       CSW200
     C                     ENDIF                                          CSW200
     C*                                                                   CSW200
     C*C*PY*WN*PYSRC*SD2400C034                                           169210
     C/COPY WNCPYSRC,SD2400CX34                                           169210
     C*
      * Clear Screen fields
     C                     EXSR RESET
     C/COPY WNCPYSRC,SD2400C029
     C*
     C*
     C* Prevent calling this sub-routine after
     C* first entry
     C                     SETON                     95
     C/COPY WNCPYSRC,SD2400C002
     C*                                                                   CEU003
     C**  Access General Ledger Details                                   CEU003
     C*                                                                   CEU003
     C**********           CALL 'AOGELRR0'                                             CEU003 CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*DBERR  'PRTCD                           CEU003
     C                     PARM '*FIRST  'POPTN                           CEU003
     C********** SDGELR    PARM SDGELR    DSFDY                                        CEU003 CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C*                                                                   CEU003
     C** Access Switchable Feature Details                                CEU003
     C*                                                                   CEU003
     C                     CALL 'AOSARDR0'                                CEU003
     C                     PARM *BLANKS   PRTCD   7                       CEU003
     C                     PARM '*VERIFY 'POPTN   7                       CEU003
     C                     PARM 'CEU003'  PSARD   6                       CEU003
     C           SCSARD    PARM SCSARD    DSSDY                           CEU003
     C*                                                                   CEU003
     C           PRTCD     IFEQ *BLANKS                                   CEU003
     C                     MOVE 'Y'       CEU003  1                       CEU003
     C                     MOVE '0'       *IN02                           CEU003
     C                     MOVE '0'       *IN09                           CEU003
     C                     ELSE                                           CEU003
     C                     MOVE 'N'       CEU003                          CEU003
     C                     MOVE '1'       *IN02                           CEU003
     C                     MOVE '1'       *IN09                           CEU003
     C                     ENDIF                                          CEU003
      *                                                                   CDL008
      ** Check if switchable feature CDL008 is switched on                CDL008
      *                                                                   CDL008
     C                     CALL 'AOSARDR0'                                CDL008
     C                     PARM *BLANKS   P@RTCD                          CDL008
     C                     PARM '*VERIFY' P@OPTN                          CDL008
     C                     PARM 'CDL008'  P@SARD                          CDL008
     C           SCSARD    PARM SCSARD    DSFDY                           CDL008
      *                                                                   CDL008
     C           P@RTCD    IFNE *BLANK                                    CDL008
     C           P@RTCD    ANDNE'*NRF   '                                 CDL008
     C                     MOVEL'SCSARDPD'PMDBFL           ************   CDL008
     C                     MOVEL'SD2400'  PMDPGM           * DBASE 23 *   CDL008
     C                     Z-ADD23        PMDBSE           ************   CDL008
     C                     MOVE *ON       *INU7                           CDL008
     C                     MOVE *ON       *INU8                           CDL008
     C                     MOVE *ON       *INLR                           CDL008
     C                     MOVE 'T'       PMTERM                          CDL008
     C                     ENDIF                                          CDL008
      *                                                                   CDL008
     C           P@RTCD    IFEQ *BLANKS                                   CDL008
     C                     MOVEL'Y'       CDL008  1                       CDL008
     C                     ELSE                                           CDL008
     C                     MOVEL'N'       CDL008                          CDL008
     C                     ENDIF                                          CDL008
      *                                                                   CDL008
     C                     MOVE *OFF      WWARN   1                       CDL008
     C*
     C                     ENDSR
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*                                                               *
     C* #B       -   Main processing                                  *
     C*                                                               *
     C* CALLS    INS      - Insert processing                         *
     C*          AMD      - Amend Processing                          *
     C*          AUTH     - Authorisation Processing                  *
     C*          DEL      - Delete Processing                         *
     C*          ENQ      - Enquiry Processing                        *
     C*          FMT      - Write screen                              *
     C*                                                               *
     C* CALLED BY      CONTROL                                        *
     C*                                                               *
     C*****************************************************************
     C*
     C           #B        BEGSR
     C*
     C**  Parameters passed into the program
     C           *ENTRY    PLIST
     C                     PARM           @RCODE
     C                     PARM           @PARM1
     C                     PARM           @PARM2
     C                     PARM           @DLNUM  6                       BHF488
     C                     PARM           @PARM3                          CSW005
     C/COPY WNCPYSRC,SD2400C025
      *                                                                                       253922
     C           PMFRST    IFEQ 'Y'                                                           253922
     C           PMACTC    ANDEQ'I'                                                           253922
     C                     MOVE 'N'       @VAL    1                                           253922
     C                     ELSE                                                               253922
     C                     MOVE 'Y'       @VAL                                                253922
     C                     ENDIF                                                              253922
     C*                                                                   CSW005
     C**  Use IND 10 to simplify checking if CSW005 is supported          CSW005
     C**  and Deal Type is any of 'FR', 'RS' or 'RX'                      CSW005
     C*                                                                   CSW005
     C           CSW005    IFEQ 'Y'                                       CSW005
     C*                                                                   CSW005
     C           PMTTYP    IFEQ 'FR'                                      CSW005
     C           PMTTYP    OREQ 'RS'                                      CSW005
     C           PMTTYP    OREQ 'RX'                                      CSW005
     C                     MOVE *ON       *IN10                           CSW005
     C                     ENDIF                                          CSW005
     C*                                                                   CSW005
     C                     ENDIF                                          CSW005
     C*                                                                   CSW005
     C           CSW011    IFEQ 'Y'                                       CSW011
     C           PMTTYP    ANDEQ'FR'                                      CSW011
     C                     MOVE *ON       *IN10                           CSW011
     C                     ENDIF                                          CSW011
     C*                                                                   S01408
     C/COPY WNCPYSRC,SD2400CSFI                                           S01408
     C*                                                                   S01408
     C*                                                                   S01408
     C/COPY WNCPYSRC,SD2400CPG2                                           S01408
     C*                                                                   S01408
     C** Set Screen Display Indicator                                     CDL025
     C           PMCPGM    IFEQ 'FXFX'                                    CDL025
     C                     SETON                     26                   CDL025
     C                     ENDIF                                          CDL025
     C*
     C*  If Action code is Insert
     C           PMACTC    IFEQ 'I'
     C                     EXSR INS
     C                     END
     C*
     C*  If action code is Amend
     C           PMACTC    IFEQ 'A'
     C                     EXSR AMD
     C                     END
     C*
     C*  If action code is Delete
     C           PMACTC    IFEQ 'D'
     C                     EXSR DEL
     C                     END
     C*
     C*  If action code is Enquiry
     C           PMACTC    IFEQ 'E'
     C                     EXSR ENQ
     C                     END
     C*
     C*  If action code is Authorisation
     C           PMACTC    IFEQ 'X'
     C                     EXSR AUT
     C                     END
     C*
     C*  Write screen
      *                                                                   S01408
     C/COPY WNCPYSRC,SD2400CISE                                           S01408
      *                                                                   S01408
     C                     EXSR FMT
      *                                                                   S01408
     C/COPY WNCPYSRC,SD2400CCPG                                           S01408
      *                                                                   S01408
     C*
     C                     ENDSR
     C*********************************************************************
      /EJECT
     C*****************************************************************
     C*                                                               *
     C* #C       - Termination processing                             *
     C*                                                               *
     C* CALLS             NONE                                        *
     C*                                                               *
     C* CALLED BY         CONTROL                                     *
     C*                   CVTA - Convert customer number to shortname *
     C*                                                               *
     C*****************************************************************
     C*
     C           #C        BEGSR
     C*                                                                   S01408
     C/COPY WNCPYSRC,SD2400CEP1                                           S01408
     C*                                                                   S01408
     C*
     C**  Database error detected - terminate program
     C           @RCODE    IFNE *BLANKS
     C                     MOVEL'T'       PMTERM
     C                     MOVELDBNUM     PMDBSE
     C*                    SETON                     LRU7U8
     C                     END
     C*
     C**
     C*  F3 - Exit from Program, having terminated validation program
     C           *IN03     IFEQ '1'
     C                     MOVE 'T'       #PJ1ST
     C                     MOVE '03'      #PJYST
     C/COPY WNCPYSRC,SD2400C018
     C                     MOVE 'T'       PMTERM
     C/COPY WNCPYSRC,SD2400C019
     C                     MOVE '03'      PMCMDP
     C                     MOVEL'0'       *IN12
     C                     MOVEL'1'       *INLR
     C                     END
     C*
     C*  F12 - Return to Previous screen
     C           *IN12     IFEQ '1'
     C                     MOVEL'12'      #PJYST
     C                     MOVEL'12'      PMCMDP
      *                                                                                       253922
      ** Clear values of @PARM1 upon pressing F12 (cancel)                                    253922
      *                                                                                       253922
     C           @VAL      IFEQ 'N'                                                           253922
     C           PMACTC    ANDEQ'I'                                                           253922
     C                     CLEAR@PARM1                                                        253922
     C                     ENDIF                                                              253922
      *                                                                                       253922
     C                     SETOF                     12
     C                     SETOF                     30                   E24039
     C/COPY WNCPYSRC,SD2400C030
     C                     END
      *                                                                   CIR003
     C           *INKH     IFEQ '1'                                       CIR003
     C           WEXST     ANDEQ'Y'                                       CIR003
     C                     MOVEL'08'      #PJYST                          CIR003
     C                     MOVEL'08'      PMCMDP                          CIR003
     C                     MOVE *OFF      *INKH                           CIR003
     C                     ENDIF                                          CIR003
     C*
     C*  SET OFF VALIDATION TO BE DONE YET FLAG
     C                     SETOF                     87
      *                                                                   S01408
     C/COPY WNCPYSRC,SD2400CEPP                                           S01408
      *                                                                   S01408
     C                     RETRN
     C*
     C                     ENDSR                           **#C9**
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*                                                               *
     C* AMD      -   Amend Processing                                 *
     C*                                                               *
     C* CALLS       CONV  - Convert Customer numbers to shortnames    *
     C*             VAL   - Validate screen input                     *
     C*                                                               *
     C* CALLED BY         #B - Main processing                        *
     C*                                                               *
     C*****************************************************************
     C*
     C           AMD       BEGSR
      *                                                                   CDL008
     C           #1JPST    IFEQ '01'                                      CDL008
     C           #1JPST    OREQ '07'                                      CDL008
     C           #1JPST    OREQ '08'                                      CDL008
     C           #1JPST    OREQ '02'                                      CDL008
     C           #1JPST    OREQ '12'                                      CDL008
      *                                                                   CDL008
     C           #1JQST    IFEQ '01'                                      CDL008
     C           #1JQST    OREQ '07'                                      CDL008
     C           #1JQST    OREQ '08'                                      CDL008
     C           #1JQST    OREQ '02'                                      CDL008
     C           #1JQST    OREQ '12'                                      CDL008
      *                                                                   CDL008
      ** Access SDNOSTPD to get CLS Dummy Nostro Ind. of Receipt Nostro   CDL008
      *                                                                   CDL008
     C           PMRSCY    IFEQ *BLANKS                                   CDL008
     C                     MOVE PMRCCY    WCCY    3                       CDL008
     C                     ELSE                                           CDL008
     C                     MOVE PMRSCY    WCCY                            CDL008
     C                     ENDIF                                          CDL008
      *                                                                   CDL008
     C           *IN80     IFEQ *ON                                       CDL008
     C                     MOVEL#1DTT2    WNOST   2                       CDL008
     C                     ELSE                                           CDL008
     C                     MOVEL#1DTTX    WNOST                           CDL008
     C                     ENDIF                                          CDL008
      *                                                                   CDL008
     C                     CALL 'AONOSTR0'                                CDL008
     C                     PARM '*VERIFY' P@RTCD                          CDL008
     C                     PARM '*KEY   ' P@OPTN                          CDL008
     C                     PARM *BLANK    @CUST   6                       CDL008
     C                     PARM WCCY      @CCY    3                       CDL008
     C**********           PARM *BLANKS   @ACCD   4                                    CDL008 CGL029
     C                     PARM *BLANKS   @ACCD  10                                           CGL029
     C                     PARM *BLANKS   @ACSN   2                       CDL008
     C                     PARM WNOST     @NOST   2                       CDL008
     C                     PARM *BLANKS   @BRCD   3                       CDL008
     C                     PARM *BLANKS   @CSSN  10                       CDL008
     C                     PARM *BLANKS   @PNOI   1                       CDL008
     C           SDNOST    PARM SDNOST    DSFDY                           CDL008
      *                                                                   CDL008
     C                     MOVE A7CLSD    WCLSD1  1                       CDL008
      *                                                                   CDL008
      ** Access SDNOSTPD to get CLS Dummy Nostro Ind. of Payment Nostro   CDL008
      *                                                                   CDL008
     C           PMPSCY    IFEQ *BLANKS                                   CDL008
     C                     MOVE PMPCCY    WCCY                            CDL008
     C                     ELSE                                           CDL008
     C                     MOVE PMPSCY    WCCY                            CDL008
     C                     ENDIF                                          CDL008
      *                                                                   CDL008
     C           *IN80     IFEQ *ON                                       CDL008
     C                     MOVEL#1DWT2    WNOST                           CDL008
     C                     ELSE                                           CDL008
     C                     MOVEL#1DWTX    WNOST                           CDL008
     C                     ENDIF                                          CDL008
      *                                                                   CDL008
     C                     CALL 'AONOSTR0'                                CDL008
     C                     PARM '*VERIFY' P@RTCD                          CDL008
     C                     PARM '*KEY   ' P@OPTN                          CDL008
     C                     PARM *BLANK    @CUST                           CDL008
     C                     PARM WCCY      @CCY                            CDL008
     C                     PARM *BLANKS   @ACCD                           CDL008
     C                     PARM *BLANKS   @ACSN                           CDL008
     C                     PARM WNOST     @NOST                           CDL008
     C                     PARM *BLANKS   @BRCD                           CDL008
     C                     PARM *BLANKS   @CSSN                           CDL008
     C                     PARM *BLANKS   @PNOI                           CDL008
     C           SDNOST    PARM SDNOST    DSFDY                           CDL008
      *                                                                   CDL008
     C                     MOVE A7CLSD    WCLSD2  1                       CDL008
      *                                                                   CDL008
     C           WCLSD1    IFEQ 'Y'                                       CDL008
     C           WCLSD2    ANDEQ'Y'                                       CDL008
     C                     MOVE 'Y'       A7CLSD                          CDL008
     C                     ELSE                                           CDL008
     C                     MOVE 'N'       A7CLSD                          CDL008
     C                     ENDIF                                          CDL008
      *                                                                   CDL008
     C                     ELSE                                           CDL008
     C                     MOVE 'N'       A7CLSD                          CDL008
     C                     ENDIF                                          CDL008
      *                                                                   CDL008
     C                     ELSE                                           CDL008
     C                     MOVE 'N'       A7CLSD                          CDL008
     C                     ENDIF                                          CDL008
      *                                                                   CDL008
      *** Settlements should not be cleared on amend.                     194656
     C           CDL008    IFEQ 'Y'                                       194656
     C           PMTTYP    IFEQ 'CL'                                      CDL008
     C           A7CLSD    ANDEQ'N'                                       CDL008
     C           PMTTYP    ORNE 'CL'                                      CDL008
     C           A7CLSD    ANDEQ'Y'                                       CDL008
     C                     EXSR RTV                                       CDL008
     C                     ENDIF                                          CDL008
     C                     ENDIF                                          194656
     C*
     C* if first call, not to validate
     C           PMVALO    IFEQ 'N'
     C/COPY WNCPYSRC,SD2400C036
     C                     EXSR CONV
     C                     MOVE 'Y'       PMVALO
     C*C*PY*WN*PYSRC*SD2400C035                                           169210
     C/COPY WNCPYSRC,SD2400CX35                                           169210
     C*                                                                   CSW005
     C           *IN10     IFEQ *ON                                       CSW005
     C                     MOVEL'Y'       WSVAL   1                       CSW005
     C                     EXSR PARMB                                     CSW005
     C                     ELSE                                           CSW005
     C                     MOVEL*BLANKS   WSVAL                           CSW005
     C                     ENDIF                                          CSW005
     C*
     C                     ELSE
     C*
     C*  VALIDATE IF NOT FIRST DISPLAY OF SCREEN 2 FROM SCREEN 1
     C*  (I.E. USER SHOULD PRESS ENTER ON SCREEN 2 TO VALIDATE)
     C*  IF ERRORS EXIST FROM PREVIOUS VALIDATION, DISPLAY THEM
     C           *IN87     IFEQ '1'
     C           PMERCD    ORNE *BLANKS
      *                                                                   049518
     C                     MOVE #1JPST    #1JPSN  20                      049518
     C                     MOVE #1JQST    #1JQSN  20                      049518
      *                                                                   049518
      *  IF RECEIPT SETTLEMENT METHOD HAS CHANGED, DEFAULT THE            049518
      *  RECEIPT SETTLEMENT INSTRUCTIONS                                  049518
      *                                                                   049518
     C           PMRSTM    IFNE #1JPSN                                    049518
     C                     MOVE 'Y'       PMDEFR                          049518
     C                     END                                            049518
      *                                                                   049518
      *  IF PAY SETTLEMENT METHOD HAS CHANGED OR IT IS 07, DEFAULT THE    049518
      *  PAY SETTLEMENT INSTRUCTIONS                                      049518
      *                                                                   049518
     C           PMPSTM    IFNE #1JQSN                                    049518
     C           #1JQSN    OREQ 07                                        049518
     C                     MOVE 'Y'       PMDEFT                          049518
     C                     END                                            049518
      *                                                                   049518
     C***********                                                   049518105708
     C***********          MOVE #1JPST    #1JPSN  20                049518105708
     C***********          MOVE #1JQST    #1JQSN  20                049518105708
     C***********                                                   049518105708
     C***IF*RECEIPT*SETTLEMENT*METHOD*HAS*CHANGED,*DEFAULT*THE*     049518105708
     C***RECEIPT*SETTLEMENT*INSTRUCTIONS****                        049518105708
     C***********                                                   049518105708
     C***********PMRSTM    IFNE #1JPSN                              049518105708
     C***********          MOVE 'Y'       PMDEFR                    049518105708
     C***********          END                                      049518105708
     C************                                                  049518105708
     C***IF*PAY*SETTLEMENT*METHOD*HAS*CHANGED*OR*IT*IS*07,*DEFAULT* 049518105708
     C***THE*PAY*SETTLEMENT*INSTRUCTIONS****                        049518105708
     C**********                                                    049518105708
     C***********PMPSTM    IFNE #1JQSN                              049518105708
     C***********#1JQSN    OREQ 07                                  049518105708
     C***********          MOVE 'Y'       PMDEFT                    049518105708
     C***********          END                                      049518105708
     C***********                                                   049518105708
     C** Validation for FRAIRS will be done in SR/FMT                     CSW005
     C           *IN10     IFEQ *OFF                                      CSW005
     C                     EXSR VAL
     C                     ENDIF                                          CSW005
     C*C*PY*WN*PYSRC*SD2400C036                                           169210
     C/COPY WNCPYSRC,SD2400CX36                                           169210
     C                     END
     C*
     C                     END
     C*
     C*
     C                     SETON                     87
     C*                                                                   S01408
     C/COPY WNCPYSRC,SD2400CVDS                                           S01408
     C*                                                                   S01408
     C*
     C                     ENDSR
     C*
     C*********************************************************************
      /EJECT
     C*****************************************************************
     C*                                                               *
     C* AUTH     -   Authorisation Processing                         *
     C*                                                               *
     C* CALLS       CONV  - Convert Customer numbers to shortnames    *
     C*             VAL   - Validate screen input                     *
     C*                                                               *
     C* CALLED BY         #B - Main processing                        *
     C*                                                               *
     C*****************************************************************
     C*
     C           AUT       BEGSR
     C*
     C                     EXSR CONV
     C/COPY WNCPYSRC,SD2400C003
     C*
     C           PMVALO    IFEQ 'Y'
     C                     EXSR VAL
     C                     END
     C*
     C                     ENDSR
     C*
     C*********************************************************************
      /EJECT
     C*****************************************************************
     C*                                                               *
     C* CONV     -   Convert customer/counterparty numbers to names   *
     C*                                                               *
     C* CALLS    CVTA  -  Convert customer number to shortname        *
     C*          CVTB  -  Convert counterparty number to shortname    *
     C*                                                               *
     C* CALLED BY      INS     -  Insert processing                   *
     C*                AMD     -  Amend processing                    *
     C*                AUTH    -  Authorize processing                *
     C*                DEL     -  Delete processing                   *
     C*                ENQ     -  Enquire processing                  *
     C*                                                               *
     C*****************************************************************
     C*
     C           CONV      BEGSR
     C*
     C*  RECEIPT ORDERING CUSTOMER
     C                     MOVEL#1DBCD    @FLD6   6
     C                     EXSR CVTA
     C                     MOVEL@FLD10    #DEJTX
     C*
     C*  RECEIPT ORDERING BANK
     C                     MOVEL#1DACD    @FLD6
     C                     EXSR CVTA
     C                     MOVEL@FLD10    #DEHTX
     C*
     C*  PAYMENT ORDERING CUSTOMER
     C                     MOVEL#1DDCD    @FLD6   6
     C                     EXSR CVTA
     C                     MOVEL@FLD10    #DEITX
     C*
     C*  PAYMENT ORDERING BANK
     C                     MOVEL#1DCCD    @FLD6
     C                     EXSR CVTA
     C                     MOVEL@FLD10    #DEGTX
     C*
     C*  RECEIPT INTERMEDIARY BANK
     C                     MOVEL#1DUTX    @FLD8   8
     C                     EXSR CVTB
     C                     MOVEL@FLD10    #DETTX
     C*
     C*  PAYMENT INTERMEDIARY BANK
     C                     MOVEL#1DXTX    @FLD8
     C                     EXSR CVTB
     C                     MOVEL@FLD10    #DEUTX
     C*
     C*  PAYMENT RECIPIENT'S CORRESPONDENT
     C                     MOVEL#1DYTX    @FLD8
     C                     EXSR CVTB
     C                     MOVEL@FLD10    #DESTX
     C*
     C***RECIPIENT*OF*MT100                                               E22405
     C*  RECIPIENT OF PAYMENT INSTRUCTION                                 E22405
     C                     MOVEL#1DZTX    @FLD8
     C                     EXSR CVTB
     C                     MOVEL@FLD10    #DEPTX
     C*
     C*  ACCOUNT WITH BANK
     C                     MOVEL#1D0TX    @FLD8
     C                     EXSR CVTB
     C                     MOVEL@FLD10    #DEQTX
     C*
     C*  BENNEFICIARY
     C                     MOVEL#1D1TX    @FLD8
     C                     EXSR CVTB
     C                     MOVEL@FLD10    #DERTX
     C*
     C                     ENDSR
     C*********************************************************************
      /EJECT
     C*****************************************************************
     C*                                                               *
     C* CVTA - Convert customer number to shortname                   *
     C*                                                               *
     C* CALLS        CUST  -  Retrieve customer name from SDCUSTL1    *
     C*              #C    -  Termination processing                  *
     C*                                                               *
     C* CALLED BY  CONV   -  Convert customer numbers to shortnames   *
     C*                                                               *
     C*****************************************************************
     C*
     C           CVTA      BEGSR
     C*
     C                     MOVEL*BLANKS   @FLD10 10
     C           @FLD6     IFNE *ZEROS
     C           @FLD6     ANDNE*BLANKS
     C                     EXSR CUST
     C*
     C           *IN90     IFEQ '1'
     C                     ADD  1         DBNUM
     C                     MOVEL@FLD6     PMDBKY
     C                     EXSR #C
     C                     END
     C*
     C                     MOVELBBCSSN    @FLD10
     C                     END
     C*
     C                     ENDSR
     C*********************************************************************
      /EJECT
     C*****************************************************************
     C*                                                               *
     C* CVTB  -  Convert counterparty number to shortname (by         *
     C*          chaining to Counterparty NOSTRO file)                *
     C*                                                               *
     C* CALLS        NOST  - Retrieve Counterparty Nostro name        *
     C*              CVTA  -  Convert customer number to shortname    *
     C*                                                               *
     C* CALLED BY  CONV   -                                           *
     C*                                                               *
     C*****************************************************************
     C*
     C           CVTB      BEGSR
     C*
     C                     MOVEL*BLANKS   @FLD10 10
     C*
     C           @FLD8     IFNE *ZEROS
     C           @FLD8     ANDNE*BLANKS
     C                     EXSR NOST
     C*
     C           *IN90     IFEQ '0'
     C*********************MOVEL@CNAME    @FLD10                         S01227
     C                     MOVEL@FLD8     @FLD10                         S01227
     C                     ELSE
     C                     MOVEL@FLD8     @FLD6
     C                     EXSR CVTA
     C                     END
     C*
     C                     END
     C*                                                                ****
     C                     ENDSR
     C*********************************************************************
      /EJECT
     C*****************************************************************
     C*                                                               *
     C* DEL      -   Delete Processing                                *
     C*                                                               *
     C* CALLS        CONV - Convert Customer numbers to shortnames    *
     C*                                                               *
     C* CALLED BY    #B   -  MAIN processing                          *
     C*                                                               *
     C*****************************************************************
     C*
     C           DEL       BEGSR
     C*
     C                     EXSR CONV
     C*
     C                     ENDSR
     C*
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*                                                               *
     C* ENQ      -   Enquiry Processing                               *
     C*                                                               *
     C* CALLS        CONV - Convert customer names to shortnames      *
     C*                                                               *
     C* CALLED BY    #B   - MAIN processing                           *
     C*                                                               *
     C*****************************************************************
     C*
     C           ENQ       BEGSR
     C*
     C                     EXSR CONV
     C*
     C                     ENDSR
     C*
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*                                                               *
     C* FMT      -   WRITE Screen                                     *
     C*                                                               *
     C* CALLS             NONE                                        *
     C*                                                               *
     C* CALLED BY         #B - MAIN processing                        *
     C*                                                               *
     C*****************************************************************
     C*
     C           FMT       BEGSR
     C*                                                                   E31589
     C           PMACTC    IFNE 'I'                                       057119
     C           PMACTC    ANDNE'A'                                       CLE003
     C           PMRUND    SUB  PMBVPD    STARTD  50                      E31589
     C           PMDTPY    IFLT STARTD                                    E31589
     C           PMDTPY    ANDNE0                                         E31589
     C           WPPAY     ANDEQ'Y'                                       135356
     C                     MOVE 'Y'       PMPPAY                          E31589
     C                     END                                            E31589
     C           PMDTRC    IFLT STARTD                                    E31589
     C           PMDTRC    ANDNE0                                         E31589
     C           WPRCV     ANDEQ'Y'                                       135356
     C                     MOVE 'Y'       PMPRCV                          E31589
     C                     END                                            E31589
     C                     END                                            057119
     C*
     C*  Set indicator to protect receipt instruction
     C/COPY WNCPYSRC,SD2400C012
     C                     MOVEA'00'      *IN,78
     C/COPY WNCPYSRC,SD2400C013
     C*
     C           PMPRCV    IFEQ 'Y'
     C                     MOVEL'1'       *IN79
     C                     END
     C*
     C*  Set indicator to protect payment instruction
     C           PMPPAY    IFEQ 'Y'
     C                     MOVEL'1'       *IN78
     C                     END
     C/COPY WNCPYSRC,SD2400C004
     C*                                                                   BHF488
     C*  Only show deal number if it is passed, this saves having to      BHF488
     C*  change the SD maintenance program.                               BHF488
     C           @PARMS    IFGT 3                                         BHF488
     C                     MOVE @DLNUM    #DLNO                           BHF488
     C                     END                                            BHF488
      *                                                                   CSW005
     C                     MOVE '0'       *IN01                           CEU003
     C                     MOVE '0'       *IN07                           CEU003
     C*                                                                   CEU003
     C** If CEU003 is supported                                           CEU003
     C*                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C                     MOVE '0'       *IN02                           CEU003
     C                     MOVE '0'       *IN09                           CEU003
     C*                                                                   CEU003
     C**  Fields are only amendable during Insert and Amend modes         CEU003
     C*                                                                   CEU003
     C           PMACTC    IFEQ 'I'                                       CEU003
     C           PMACTC    OREQ 'A'                                       CEU003
     C                     MOVE '1'       *IN01                           CEU003
     C                     ELSE                                           CEU003
     C                     MOVE '1'       *IN07                           CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C**  Payment Settlement Side Only                                    CEU003
     C*                                                                   CEU003
     C           WPRCV     IFEQ 'Y'                                       CEU003
     C           *IN01     ANDEQ'1'                                       CEU003
     C                     MOVE '1'       *IN02                           CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C**  Receipt Settlement Side Only                                    CEU003
     C*                                                                   CEU003
     C           WPPAY     IFEQ 'Y'                                       CEU003
     C           *IN01     ANDEQ'1'                                       CEU003
     C                     MOVE '1'       *IN09                           CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C           *IN02     IFEQ '0'                                       CEU003
     C************IN01     ANDEQ'1'                                       CEU003
     C*                                                                   CEU003
     C**  Access Currency Details                                         CEU003
     C*                                                                   CEU003
     C                     CALL 'AOCURRR0'                                CEU003
     C                     PARM '*DBERR  'PRTCD                           CEU003
     C                     PARM '*KEY    'POPTN                           CEU003
     C                     PARM PMRCCY    PCURR   3                       CEU003
     C           SDCURR    PARM SDCURR    DSSDY                           CEU003
     C*                                                                   CEU003
     C           A6INCY    IFNE 'Y'                                       CEU003
     C*                                                                   CEU003
     C           PMRCCY    IFNE BKEURO                                    CEU003
     C                     MOVE '1'       *IN02                           CEU003
     C                     ENDIF                                          CEU003
      *                                                                                       CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
     C           PMCPGM    ANDEQ'LEND'                                                        CLE031
     C                     MOVE '0'       *IN02                                               CLE031
     C                     ENDIF                                                              CLE031
     C*                                                                   CEU003
     C                     ELSE                                           CEU003
     C*                                                                   CEU003
     C***********WDTRP     IFLT A6TPSD                             CEU003 134935
     C************IN07     ANDEQ*OFF                               CEU003 134935
     C***********          MOVE '1'       *IN02                    CEU003 134935
     C***********          ENDIF                                   CEU003 134935
     C*                                                                   CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C           *IN09     IFEQ '0'                                       CEU003
     C************IN01     ANDEQ'1'                                       CEU003
     C*                                                                   CEU003
     C**  Access Currency Details                                         CEU003
     C*                                                                   CEU003
     C                     CALL 'AOCURRR0'                                CEU003
     C                     PARM '*DBERR  'PRTCD                           CEU003
     C                     PARM '*KEY    'POPTN                           CEU003
     C                     PARM PMPCCY    PCURR                           CEU003
     C           SDCURR    PARM SDCURR    DSSDY                           CEU003
     C*                                                                   CEU003
     C           A6INCY    IFNE 'Y'                                       CEU003
     C*                                                                   CEU003
     C           PMPCCY    IFNE BKEURO                                    CEU003
     C                     MOVE '1'       *IN09                           CEU003
     C                     ENDIF                                          CEU003
      *                                                                                       CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
     C           PMCPGM    ANDEQ'LEND'                                                        CLE031
     C                     MOVE '0'       *IN09                                               CLE031
     C                     ENDIF                                                              CLE031
     C*                                                                   CEU003
     C                     ELSE                                           CEU003
     C*                                                                   CEU003
     C***********WDTRP     IFLT A6TPSD                             CEU003 134935
     C************IN07     ANDEQ*OFF                               CEU003 134935
     C***********          MOVE '1'       *IN09                    CEU003 134935
     C***********          ENDIF                                   CEU003 134935
     C*                                                                   CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C           *IN02     IFEQ '1'                                       CEU003
     C           *IN09     ANDEQ'1'                                       CEU003
     C                     MOVE '0'       *IN01                           CEU003
     C                     ENDIF                                          CEU003
     C/COPY WNCPYSRC,SD2400C033
     C*                                                                   CEU003
     C***If*Enquire*and*Deal*Type*=*'FX'/'RX',*do*not*display******CEU003 136728
     C***Receipt*Settlement*Currency*******************************CEU003 136728
     C************IN07     IFEQ '1'                                CEU003 136728
     C***********PMTTYP    ANDNE'FX'                               CEU003 136728
     C***********PMTTYP    ANDNE'RX'                               CEU003 136728
     C***********          MOVE '1'       *IN02                    CEU003 136728
     C***********          ENDIF                                   CEU003 136728
     C*                                                                   CEU003
     C                     ENDIF                                          CEU003
      *                                                                   CEU003
      ** If FRA/IRS (*IN10=*ON) and Roll Down (*N16=*ON)                  CSW005
      ** perform validation routine to highlight fields in error          CSW005
      ** and set off *IN16 to display second screen upon Roll Up          CSW005
      *                                                                   CSW005
     C           *IN10     IFEQ *ON                                       CSW005
     C           *IN16     ANDEQ*ON                                       CSW005
     C                     MOVE *OFF      *IN16                           CSW005
     C           PMACTC    IFNE 'E'                                       CSW005
     C                     EXSR VAL                                       CSW005
     C                     ENDIF                                          CSW005
     C                     ENDIF                                          CSW005
      *                                                                   CIR003
     C           WEXST     IFEQ 'Y'                                       CIR003
      *                                                                   CIR003
     C           PMCPGM    IFEQ 'VAL*'                                    CIR003
     C                     MOVEL'VALUE   'SEDAT                           CIR003
     C                     MOVE *OFF      *IN17                           CIR003
     C                     ENDIF                                          CIR003
     C           PMCPGM    IFEQ 'INT*'                                    CIR003
     C                     MOVEL'INTEREST'SEDAT                           CIR003
     C                     MOVE *ON       *IN17                           CIR003
     C                     ENDIF                                          CIR003
     C           PMCPGM    IFEQ 'MAT*'                                    CIR003
     C                     MOVEL'MATURITY'SEDAT                           CIR003
     C                     MOVE *OFF      *IN17                           CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C                     ELSE                                           CIR003
     C                     MOVE *BLANKS   SEDAT                           CIR003
     C                     MOVE *ON       *IN17                           CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CSW005
     C           *IN13     DOUEQ'0'                                       CEU003
      *                                                                   CEU003
     C                     TIME           #TIME   60
      *
     C*                                                                   S01408
     C/COPY WNCPYSRC,SD2400CLDS                                           S01408
     C*                                                                   S01408
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C***********          EXFMT#RCDDTL1                                  E24039
     C                     WRITE#RCDDTL1                                  E24039
     C*                                                                   E24039
     C           *IN30     IFEQ '0'                                       E24039
     C                     MOVE *BLANKS   SAV1   12                       E24039
     C                     MOVE #1DTTX    SAV1                            E24039
     C                     MOVE *BLANKS   SAV2   12                       E24039
     C                     MOVE #1DWTX    SAV2                            E24039
     C                     SETON                     30                   E24039
     C                     END                                            E24039
     C*                                                                   E24039
     C           *NAMVAR   DEFN           LDA                             E24039
     C************LOCK     IN   LDA                                E24039 CEU003
     C*                                                                   E24039
     C                     READ #RCDDTL1                 99               E24039
     C*                                                                   CEU003
     C                     MOVE '0'       *IN08                           CEU003
     C                     MOVE '0'       *IN11                           CEU003
     C                     MOVE '0'       *IN14                           CEU003
     C*                                                                   CEU003
     C**  Re-defaulting                                                   CEU003
     C*                                                                   CEU003
     C           *IN13     IFEQ '1'                                       CEU003
     C           CEU003    ANDEQ'Y'                                       CEU003
     C*                                                                   CEU003
     C           #PJUST    IFNE 'FXFX'                                    CEU003
     C           WPRCV     ANDEQ'N'                                       CEU003
     C           WPPAY     ANDEQ'N'                                       CEU003
     C           SRSCY     ANDNESPSCY                                     CEU003
     C           WTTYP     ANDNE'RX'                                      CEU003
     C                     CALL 'ZA0250'                                  CEU003
     C                     SETON                     7375                 CEU003
     C                     MOVEL'ESM0847' ZAMSID                          CEU003
     C                     CALL 'ZA0240'                                  CEU003
     C                     PARM           ZAMSID                          CEU003
     C                     MOVEL*BLANK    ZAMSID                          CEU003
     C                     ELSE                                           CEU003
     C                     EXSR SRREDF                                    CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   S01408
      *                                                                   CSW005
      ** If Deal Type is 'FR' or 'RS' or 'RX'                             CSW005
      *                                                                   CSW005
     C           *LOCK     IN   LDA                                       CEU003
     C           *IN10     IFEQ *ON                                       CSW005
      *                                                                   CSW005
      ** If <ENTER> is taken from the first settlement screen             CSW005
      ** then validate the screen values                                  CSW005
      *                                                                   CSW005
     C           *IN03     IFEQ *OFF                                      CSW005
     C           *IN12     ANDEQ*OFF                                      CSW005
     C           *IN15     ANDEQ*OFF                                      CSW005
     C           PMACTC    ANDEQ'A'                                       CSW005
      *                                                                   CSW005
     C           *IN03     OREQ *OFF                                      CSW005
     C           *IN12     ANDEQ*OFF                                      CSW005
     C           *IN15     ANDEQ*OFF                                      CSW005
     C           PMACTC    ANDEQ'I'                                       CSW005
      *                                                                   CSW005
     C                     OUT  LDA                                       CSW005
     C                     EXSR VAL                                       CSW005
     C           *LOCK     IN   LDA                                       CSW005
     C*                                                                   CSW005
     C                     ELSE                                           CSW005
     C*                                                                   CSW005
     C                     SELEC                                          CSW005
     C           PMACTC    WHEQ 'A'                                       CSW005
     C           WSVAL     ANDNE*BLANKS                                   CSW005
     C                     MOVEL*BLANKS   WSVAL                           CSW005
     C           PMACTC    WHEQ 'I'                                       CSW005
     C           WNVAL     ANDNE*BLANKS                                   CSW005
     C                     MOVEL*BLANKS   WNVAL                           CSW005
     C                     ENDSL                                          CSW005
      *                                                                   CSW005
      ** If <ROLL UP> is taken from first settlement screen               CSW005
      ** then display the second settlement screen until                  CSW005
      ** <F3> or <F12> or <ROLL DOWN> is taken                            CSW005
      *                                                                   CSW005
     C           *IN15     IFEQ *ON                                       CSW005
     C*                                                                   CSW005
     C                     MOVE *OFF      *IN15                           CSW005
     C*                                                                   CSW005
     C           *IN03     DOWEQ*OFF                                      CSW005
     C           *IN12     ANDEQ*OFF                                      CSW005
     C           *INKH     ANDEQ*OFF                                      CIR003
     C           *IN16     ANDEQ*OFF                                      CSW005
      *                                                                   CSW005
     C                     SELEC                                          CSW005
     C           PMTTYP    WHEQ 'RX'                                      CSW005
     C                     MOVEA'00'      *IN,04                          CSW005
     C           PMTTYP    WHEQ 'RS'                                      CSW005
     C                     MOVEA'01'      *IN,04                          CSW005
     C           PMTTYP    WHEQ 'FR'                                      CSW005
      *                                                                   CSW097
      ** ISDA fields will only be displayed if CSW005 is ON               CSW097
      ** OR CSW011 and CSW200 are ON                                      CSW200
      *                                                                   CSW200
     C           CSW005    IFEQ 'Y'                                       CSW097
     C           CSW011    OREQ 'Y'                                       CSW200
     C           CSW200    ANDEQ'Y'                                       CSW200
     C                     MOVEA'01'      *IN,04                          CSW097
     C                     ELSE                                           CSW097
     C                     MOVEA'11'      *IN,04                          CSW005
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C                     ENDSL                                          CSW005
     C*                                                                   CSW005
     C**  Protect fields on Enquiry or Reversal                           CSW005
     C*                                                                   CSW005
     C           PMACTC    IFEQ 'E'                                       CSW005
     C           PMACTC    OREQ 'D'                                       CSW005
     C                     MOVE *ON       *IN06                           CSW005
     C                     ELSE                                           CSW005
     C                     MOVE *OFF      *IN06                           CSW005
     C                     ENDIF                                          CSW005
     C/COPY WNCPYSRC,SD2400C024
     C*                                                                   CSW005
     C                     WRITE#MSGCTL                                   CSW005
     C                     WRITE#CMDTXT1                                  CSW005
     C                     WRITE#HEAD2                                    CSW005
     C                     EXFMT#RCDDTL2                                  CSW005
      *                                                                   CSW005
      ** If <ENTER> is taken from the second settlement screen            CSW005
      ** then validate the screen values                                  CSW005
      *                                                                   CSW005
     C           *IN03     IFEQ *OFF                                      CSW005
     C           *IN12     ANDEQ*OFF                                      CSW005
     C           *IN16     ANDEQ*OFF                                      CSW005
     C           WSVAL     ANDNE'Y'                                       CSW005
     C           PMACTC    ANDEQ'A'                                       CSW005
     C           *IN03     OREQ *OFF                                      CSW005
     C           *IN12     ANDEQ*OFF                                      CSW005
     C           *IN16     ANDEQ*OFF                                      CSW005
     C           WNVAL     ANDNE'Y'                                       CSW005
     C           PMACTC    ANDEQ'I'                                       CSW005
     C*                                                                   CSW005
     C                     OUT  LDA                                       CSW005
     C                     EXSR VAL                                       CSW005
     C           *LOCK     IN   LDA                                       CSW005
     C*                                                                   CSW005
     C                     ELSE                                           CSW005
     C*                                                                   CSW005
     C                     SELEC                                          CSW005
     C           PMACTC    WHEQ 'A'                                       CSW005
     C           WSVAL     ANDNE*BLANKS                                   CSW005
     C                     MOVEL*BLANKS   WSVAL                           CSW005
     C           PMACTC    WHEQ 'I'                                       CSW005
     C           WNVAL     ANDNE*BLANKS                                   CSW005
     C                     MOVEL*BLANKS   WNVAL                           CSW005
     C                     ENDSL                                          CSW005
     C*                                                                   CSW005
     C                     ENDIF                                          CSW005
     C                     ENDDO                                          CSW005
     C                     ENDIF                                          CSW005
     C                     ENDIF                                          CSW005
     C                     ENDIF                                          CSW005
     C*                                                                   CSW005
     C/COPY WNCPYSRC,SD2400CCP4                                           S01408
     C*                                                                   S01408
     C                     MOVE '0'       NOCHG1                          E24039
     C                     MOVE '0'       NOCHG2                          E24039
     C           #1DTTX    IFEQ SAV1                                      E24039
     C                     MOVE '1'       NOCHG1                          E24039
     C                     END                                            E24039
     C           #1DWTX    IFEQ SAV2                                      E24039
     C                     MOVE '1'       NOCHG2                          E24039
     C                     END                                            E24039
     C                     OUT  LDA                                       E24039
     C*                                                                   S01408
     C/COPY WNCPYSRC,SD2400CLD1                                           S01408
     C*                                                                   S01408
     C*                                                                   E24039
     C                     ENDDO                                          CEU003
     C*
     C                     ENDSR
     C*********************************************************************
      /EJECT
     C*****************************************************************
     C*                                                               *
     C* INS      -   Insert Processing                                *
     C*                                                               *
     C* CALLS        RTV   -                                          *
     C*              CONV  -  Convert customer numbers to shortnames  *
     C*              PARMB -                                          *
     C*              VAL   - Validate screen input                    *
     C*                                                               *
     C* CALLED BY    #B    -                                          *
     C*                                                               *
     C*****************************************************************
     C*
     C           INS       BEGSR
     C*
     C/COPY WNCPYSRC,SD2400C031
     C           PMFRST    IFEQ 'Y'
     C           CUSNOF    ORNE PMCSNM                                    087755
     C           PRCCYF    ORNE PMRCCY                                    087755
     C           PPCCYF    ORNE PMPCCY                                    087755
     C*                                                                   CSW005
     C           *IN10     IFEQ *ON                                       CSW005
     C                     MOVEL'Y'       WNVAL   1                       CSW005
     C                     ELSE                                           CSW005
     C                     MOVEL'N'       WNVAL                           CSW005
     C                     ENDIF                                          CSW005
     C*                                                                   087755
     C**  STORE PREVIOUS VALUE OF CUST. NO. (#PDVCD) FOR COMPARE          087755
     C**  IF FIELD HAS BEEN CHANGED AND IF YES, PROCESS LIKE              087755
     C**  IT IS FIRST DISPLAY OF SCREEN                                   087755
     C*                                                                   087755
     C                     MOVEL#PDVCD    CUSNOF 10                       087755
     C                     MOVEL#1AJCD    PRCCYF  3                       087755
     C                     MOVEL#PABAL    PPCCYF  3                       087755
     C*
     C                     EXSR RTV
     C/COPY WNCPYSRC,SD2400C026
     C                     EXSR CONV
     C                     MOVEL'N'       PMFRST
     C*********************MOVEL'Y'       PMDEFT                    S01297LN0787
     C                     MOVEL'Y'       PMDEFT                          BHF751
     C                     MOVEL'Y'       PMDEFR                          BHF751
     C                     EXSR PARMB
     C*
     C                     ELSE
     C*
     C*  VALIDATE IF NOT FIRST DISPLAY OF SCREEN 2 FROM SCREEN 1
     C*  (I.E. USER SHOULD PRESS ENTER ON SCREEN 2 TO VALIDATE)
     C*  IF ERRORS EXIST FROM PREVIOUS VALIDATION, DISPLAY THEM
     C           *IN87     IFEQ '1'
     C           PMERCD    ORNE *BLANKS
     C           *IN10     OREQ *OFF                                      CSW005
     C                     EXSR VAL
     C                     END
     C*
     C                     END
     C/COPY WNCPYSRC,SD2400C032
     C*
     C                     SETON                     87
     C*                                                                   S01408
     C/COPY WNCPYSRC,SD2400CCBU                                           S01408
     C*                                                                   S01408
     C*
     C                     ENDSR
     C*********************************************************************
      /EJECT
     C*****************************************************************
     C*                                                               *
     C* PARMA    -   Load screen from passed parameters               *
     C*              (FIELDS REQUIRING CONVERSION ARE MOVED INTO      *
     C*              WORK FIELDS FIRST)                               *
     C*                                                               *
     C* CALLS             NONE                                        *
     C*                                                               *
     C* CALLED BY         #B                                          *
     C*                                                               *
     C*****************************************************************
     C*
     C           PARMA     BEGSR
     C*
     C***************      MOVELPMBRCD    #PDSNB                          S01117
     C                     MOVELPMBRCA    #PDSNB                          S01117
     C                     MOVELPMPCYA    #PAFNB
     C                     MOVELPMDPGM    #PAGTX
     C                     MOVELPMRUND    #PAKTX
     C                     Z-ADDPMBVPD    #PJANB
     C                     MOVELPMFRST    #PK7ST
     C                     MOVELPMRETP    #PK8ST
     C                     MOVELPMCSNM    #PDVCD
     C                     MOVELPMRETS    #PK9ST
     C                     MOVELPMCHIM    #PLAST
     C                     MOVELPMDBFL    #PDWCD
     C                     MOVELPMDBKY    #PAXNA
     C                     MOVELPMDBSE    #PM0NB
     C                     MOVELPMERCD    #PAYNA
     C                     MOVELPMPCCY    #PABAL
     C                     MOVELPMFFND    #PGGST
     C                     MOVELPMACTC    #PJTST
     C                     MOVELPMCPGM    #PJUST
     C                     MOVELPMTTYP    #PJVST
     C                     Z-ADDPMDTRC    #PKXNB
     C                     Z-ADDPMDTPY    #PKYNB
     C                     MOVELPMPRCV    #PJWST
     C                     MOVELPMPPAY    #PJXST
     C                     MOVELPMCMDP    #PJYST
     C**********           MOVELPMVALO    #PJZST                          S01227
     C                     MOVELPMSDTV    #PJ0ST
     C                     MOVELPMTERM    #PJ1ST
     C                     MOVELPMRCCY    #1AJCD
     C**
     C                     MOVELPMRSTM    #1JPST
     C/COPY WNCPYSRC,SD2400C040
     C                     MOVELPMPSTM    #1JQST
     C/COPY WNCPYSRC,SD2400C041
     C*******************  MOVELPMRONS    #1DTTX                          S01117
     C  N80                MOVELPMRONS    #1DTTX                          S01117
     C*                                                                   S01117
     C** ONLY PROCESS SETTLMNT BRNCH IF METHOD 05 (AND MBIN IS SET ON)    S01117
     C           *IN80     IFEQ '1'                        B1             S01117
     C           CLE033    OREQ 'Y'                                       CLE033
     C           PMRSTM    ANDEQ09                                        CLE033
     C                     MOVE *BLANKS   #1DTT2           **2            E00036
     C           PMRSTM    IFEQ 05                         B*2            S01117
     C           PMRSTM    OREQ 09                                        CLE033
     C           CLE033    ANDEQ'Y'                                       CLE033
      *                                                                   S01408
     C/COPY WNCPYSRC,SD2400CP17                                           S01408
      *                                                                   S01408
     C***********          MOVE PMROBR    #1DTT2           **2      S01117CSW011
     C                     MOVELPMROBR    #1DTT2           **2            CSW011
     C                     MOVE PMRONS    #1DTT2           **2            S01117
     C                     ELSE                            X*2            S01117
     C                     MOVELPMRONS    #1DTT2           **2            S01117
     C                     END                             E*2            S01117
     C                     END                             E1             S01117
      *                                                                   S01117
     C*******************  MOVELPMPONS    #1DWTX                          S01117
     C  N80                MOVELPMPONS    #1DWTX                          S01117
     C*                                                                   S01117
     C** ONLY PROCESS SETTLMNT BRNCH IF METHOD 05 (AND MBIN IS SET ON)    S01117
     C           *IN80     IFEQ '1'                        B1             S01117
     C           CLE033    OREQ 'Y'                                       CLE033
     C           PMPSTM    ANDEQ09                                        CLE033
     C                     MOVE *BLANKS   #1DWT2           **2            E00036
     C           PMPSTM    IFEQ 05                         B*2            S01117
     C           PMPSTM    OREQ 09                                        CLE033
     C           CLE033    ANDEQ'Y'                                       CLE033
      *                                                                   S01408
     C/COPY WNCPYSRC,SD2400CP12                                           S01408
      *                                                                   S01408
     C                     MOVELPMPOBR    #1DWT2           **2            S01117
     C                     MOVE PMPONS    #1DWT2           **2            S01117
     C                     ELSE                            X*2            S01117
     C                     MOVELPMPONS    #1DWT2           **2            S01117
     C                     END                             E*2            S01117
     C                     END                             E1             S01117
     C                     MOVELPARVNO    #1DZTX
     C                     MOVELPAROCN    #1DBCD
     C                     MOVELPAPOCN    #1DDCD
     C                     MOVELPAROBN    #1DACD
     C                     MOVELPAPOBN    #1DCCD
     C                     MOVELPARCRN    #1DYTX
     C                     MOVELPMRCRA    #1D8TX
     C                     MOVELPARIBN    #1DUTX
     C                     MOVELPAPIBN    #1DXTX
     C                     MOVELPMRIBA    #1DVTX
     C                     MOVELPMPIBA    #1D7TX
     C                     MOVELPAAWBN    #1D0TX
     C                     MOVELPMAWBA    #1D9TX
     C                     MOVELPABENN    #1D1TX
     C                     MOVELPMBENA    #1EATX
     C                     MOVELPMDTP1    #1D2TX
     C                     MOVELPMDTP2    #1D3TX
     C                     MOVELPMDTP3    #1D4TX
     C                     MOVELPMDTP4    #1D5TX
     C                     MOVELPMDCHG    #1C9CD
     C                     MOVELPMBTB1    #1D6TX
     C                     MOVELPMBTB2    #1EBTX
     C                     MOVELPMBTB3    #1ECTX
     C                     MOVELPMBTB4    #1EDTX
     C                     MOVELPMBTB5    #1EETX
     C                     MOVELPMBTB6    #1EFTX
     C                     MOVELPMCVMR    #1CVMR                          E22405
     C*                                                                   049518
     C                     MOVELPMRIBN    #DETTX                          049518
     C                     MOVELPMROBN    #DEHTX                          049518
     C                     MOVELPMROCN    #DEJTX                          049518
     C                     MOVELPMPIBN    #DEUTX                          049518
     C                     MOVELPMPOBN    #DEGTX                          049518
     C                     MOVELPMPOCN    #DEITX                          049518
     C                     MOVELPMRCRN    #DESTX                          049518
     C                     MOVELPMRVNO    #DEPTX                          049518
     C                     MOVELPMAWBN    #DEQTX                          049518
     C                     MOVELPMBENN    #DERTX                          049518
     C*                                                                   CSW005
     C*                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C                     MOVELPMPRCV    WPRCV   1                       CEU003
     C                     MOVELPMPPAY    WPPAY   1                       CEU003
     C                     MOVELPMRSCY    SRSCY   3                       CEU003
     C                     MOVELPMPSCY    SPSCY   3                       CEU003
     C                     MOVELPMIC72    SIC72   3                       CEU003
     C                     MOVELPMTTYP    WTTYP   2                       CEU003
     C*                                                                   CEU003
     C           PMDTPY    IFLT PMDTRC                                    CEU003
     C           PMDTPY    ANDGT0                                         CEU003
     C           PMDTRC    OREQ 0                                         CEU003
     C                     Z-ADDPMDTPY    WDTRP   50                      CEU003
     C                     ELSE                                           CEU003
     C                     Z-ADDPMDTRC    WDTRP                           CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     ENDIF                                          CEU003
      *
     C           CLE031    IFEQ 'Y'                                                           CLE031
     C           PMCPGM    ANDEQ'LEND'                                                        CLE031
     C                     MOVELPMRSCY    SRSCY   3                                           CLE031
     C                     MOVELPMPSCY    SPSCY   3                                           CLE031
     C                     MOVELPMREXR    SRRTE                                               CLE031
     C                     MOVELPMPEXR    SPRTE                                               CLE031
     C                     MOVELPMREXI    SRCEI                                               CLE031
     C                     MOVELPMPEXI    SPCEI                                               CLE031
     C                     ENDIF                                                              CLE031
     C** FRA/IRS specific fields:                                         CSW005
     C*                                                                   CSW005
     C           CSW005    IFEQ 'Y'                                       CSW005
     C           CSW011    OREQ 'Y'                                       CSW011
     C           PMTTYP    IFEQ 'FR'                                      CSW005
     C           PMTTYP    OREQ 'RS'                                      CSW005
     C           CSW005    ANDEQ'Y'                                       CSW011
     C           PMTTYP    OREQ 'RX'                                      CSW005
     C           CSW005    ANDEQ'Y'                                       CSW011
     C                     MOVEL@PARM3    WSCRN2                          CSW005
     C           RISDA     IFEQ *ZEROS                                    CSW097
     C                     MOVE *BLANKS   RISDA                           CSW097
     C                     ENDIF                                          CSW097
     C           RAGDT     IFEQ '000000'                                  CSW005
     C                     MOVEL*BLANKS   RAGDT                           CSW005
     C                     ENDIF                                          CSW005
     C***********RAGVV     IFEQ '00'                                CSW005CSW097
     C           RAGVV     IFEQ *ZEROS                                    CSW097
     C                     MOVEL*BLANKS   RAGVV                           CSW005
     C                     ENDIF                                          CSW005
     C                     ENDIF                                          CSW005
     C                     ENDIF                                          CSW005
     C*                                                                   S01408
     C/COPY WNCPYSRC,SD2400CLD2                                           S01408
     C*                                                                   S01408
     C*
     C                     ENDSR
     C*********************************************************************
      /EJECT
     C*****************************************************************
     C*                                                               *
     C* PARMB  -  Load screen fields into parameters for validation   *
     C*                                                               *
     C* CALLS             NONE                                        *
     C*                                                               *
     C* CALLED BY         INS -  Insert processing                    *
     C*                   VAL -  Validate screen input                *
     C*****************************************************************
     C*
     C           PARMB     BEGSR
     C**                                                                  088221
     C** If question mark is entered in the settlement method field,      088221
     C** call the Valid list pgm for Receipt Settlement method Y2VLLWR    088221
     C**                                                                  088221
     C           #1JPST    IFEQ '? '                                      088221
     C*                                                                   088221
     C                     CALL 'Y2VLLWR'              90                 088221
     C                     PARM           W0RTN   7                       088221
     C                     PARM 1123203   Y2LSNO  70                      088221
     C           #1JPST    PARM #1JPST    W0EXVL 20        Receipt - Settl088221
     C*                                                                   088221
     C           *IN90     IFEQ '1'                                       088221
     C                     MOVEL'Y2VLLWR' PMDBFL           ************** 088221
     C                     MOVEL'SD2400'  PMDPGM           ** DBASE 21 ** 088221
     C                     Z-ADD21        PMDBSE           ************** 088221
     C                     SETON                     U7U8LR               088221
     C                     MOVE 'T'       PMTERM                          088221
     C                     END                                            088221
     C*                                                                   088221
     C                     END                                            088221
     C*
     C                     MOVEL#1JPST    PMRSTM
     C******************** MOVEL#1DTTX    PMRONS                          S01117
     C  N80                MOVEL#1DTTX    PMRONS                          S01117
     C*                                                                   S01117
     C** ONLY PROCESS SETTLMNT BRNCH IF METHOD 05 (AND MBIN IS SET ON)    S01117
     C           *IN80     IFEQ '1'                        B1             S01117
     C           #1JPST    OREQ '09'                                      CLE033
     C           CLE033    ANDEQ'Y'                                       CLE033
     C           #1JPST    IFEQ '05'                       B*2            S01117
     C           #1JPST    OREQ '09'                                      CLE033
     C           CLE033    ANDEQ'Y'                                       CLE033
      *                                                                   S01408
     C/COPY WNCPYSRC,SD2400CCP8                                           S01408
      *                                                                   S01408
     C                     MOVEL#1DTT2    @WRK15           **2            S01117
     C                     MOVE @WRK3     PMROBR           **2            S01117
     C                     MOVEL@WRK12    PMRONS           **2            S01117
     C                     ELSE                            X*2            S01117
     C*
     C           PMPRCV    IFEQ 'Y'                                       E30473
     C           PMACTC    ANDEQ'A'                                       E30473
     C                     ELSE                                           E30473
     C                     MOVE *BLANKS   PMROBR           **2            S01117
     C                     END                                            E30473
     C                     MOVEL#1DTT2    PMRONS           **2            S01117
     C                     END                             E*2            S01117
     C                     END                             E1             S01117
     C                     MOVEL#1DACD    PAROBN
     C                     MOVEL#1DBCD    PAROCN
     C                     MOVEL#1DUTX    PARIBN
     C                     MOVEL#1DVTX    PMRIBA
     C**                                                                  088221
     C** If question mark is entered in the settlement method field,      088221
     C** call the Valid list pgm for Pay Settlement method Y2VLLWR        088221
     C**                                                                  088221
     C           #1JQST    IFEQ '? '                                      088221
     C*                                                                   088221
     C                     CALL 'Y2VLLWR'              90                 088221
     C                     PARM           W0RTN   7                       088221
     C                     PARM 1123203   Y2LSNO  70                      088221
     C           #1JQST    PARM #1JQST    W0EXVL 20        Pay - Settle   088221
     C*                                                                   088221
     C           *IN90     IFEQ '1'                                       088221
     C                     MOVEL'Y2VLLWR' PMDBFL           ************** 088221
     C                     MOVEL'SD2400'  PMDPGM           ** DBASE 22 ** 088221
     C                     Z-ADD22        PMDBSE           ************** 088221
     C                     SETON                     U7U8LR               088221
     C                     MOVE 'T'       PMTERM                          088221
     C                     END                                            088221
     C*                                                                   088221
     C                     END                                            088221
     C*                                                                   088221
     C/COPY WNCPYSRC,SD2400C005
     C                     MOVEL#1JQST    PMPSTM
     C******************** MOVEL#1DWTX    PMPONS                          S01117
     C  N80                MOVEL#1DWTX    PMPONS                          S01117
     C*                                                                   S01117
     C** ONLY PROCESS SETTLMNT BRNCH IF METHOD 05 (AND MBIN IS SET ON)    S01117
     C           *IN80     IFEQ '1'                        B1             S01117
     C           #1JQST    OREQ '09'                                      CLE033
     C           CLE033    ANDEQ'Y'                                       CLE033
     C           #1JQST    IFEQ '05'                       B*2            S01117
     C           #1JQST    OREQ '09'                                      CLE033
     C           CLE033    ANDEQ'Y'                                       CLE033
      *                                                                   S01408
     C/COPY WNCPYSRC,SD2400CCP9                                           S01408
      *                                                                   S01408
     C                     MOVEL#1DWT2    @WRK15           **2            S01117
     C                     MOVE @WRK3     PMPOBR           **2            S01117
     C                     MOVEL@WRK12    PMPONS           **2            S01117
     C                     ELSE                            X*2            S01117
     C           PMPPAY    IFEQ 'Y'                                       E30473
     C           PMACTC    ANDEQ'A'                                       E30473
     C                     ELSE                                           E30473
     C                     MOVE *BLANKS   PMPOBR           **2            S01117
     C                     END                                            E30473
     C                     MOVEL#1DWT2    PMPONS           **2            S01117
     C                     END                             E*2            S01117
     C                     END                             E1             S01117
     C                     MOVEL#1DCCD    PAPOBN
     C                     MOVEL#1DDCD    PAPOCN
     C                     MOVEL#1DXTX    PAPIBN
     C                     MOVEL#1D7TX    PMPIBA
     C                     MOVEL#1DYTX    PARCRN
     C                     MOVEL#1D8TX    PMRCRA
     C                     MOVEL#1DZTX    PARVNO
     C                     MOVEL#1D0TX    PAAWBN
     C                     MOVEL#1D9TX    PMAWBA
     C                     MOVEL#1D1TX    PABENN
     C                     MOVEL#1EATX    PMBENA
     C                     MOVEL#1D2TX    PMDTP1
     C                     MOVEL#1D3TX    PMDTP2
     C                     MOVEL#1D4TX    PMDTP3
     C                     MOVEL#1D5TX    PMDTP4
     C                     MOVEL#1C9CD    PMDCHG
     C                     MOVEL#1D6TX    PMBTB1
     C                     MOVEL#1EBTX    PMBTB2
     C                     MOVEL#1ECTX    PMBTB3
     C                     MOVEL#1EDTX    PMBTB4
     C                     MOVEL#1EETX    PMBTB5
     C                     MOVEL#1EFTX    PMBTB6
     C                     MOVEL#1CVMR    PMCVMR                          E22405
     C                     MOVEL#PJTST    PMACTC
     C                     MOVEL#PJUST    PMCPGM
     C                     MOVEL#PJVST    PMTTYP
     C                     MOVEL#PDVCD    PMCSNM
     C                     Z-ADD#PKXNB    PMDTRC
     C                     Z-ADD#PKYNB    PMDTPY
     C                     MOVEL#PABAL    PMPCCY
     C                     MOVEL#1AJCD    PMRCCY
     C                     MOVEL#PGGST    PMFFND
     C*****************    MOVEL#PDSNB    PMBRCD                          S01117
     C                     MOVEL#PDSNB    PMBRCA                          S01117
     C                     MOVEL#PJWST    PMPRCV
     C                     MOVEL#PJXST    PMPPAY
     C                     MOVEL#PJYST    PMCMDP
     C*****                MOVEL#PJZST    PMVALO                          S01227
     C                     MOVEL#PJ0ST    PMSDTV
     C                     MOVEL#PJ1ST    PMTERM
     C                     MOVEL#PK7ST    PMFRST
     C                     MOVEL#PK8ST    PMRETP
     C                     MOVEL#PK9ST    PMRETS
     C                     MOVEL#PAFNB    PMPCYA
     C                     MOVEL#PLAST    PMCHIM
     C                     Z-ADD#PJANB    PMBVPD
     C                     Z-ADD#PAKTX    PMRUND
     C                     MOVEL#PDWCD    PMDBFL
     C                     MOVEL#PAXNA    PMDBKY
     C                     MOVEL#PAGTX    PMDPGM
     C                     MOVEL#PM0NB    PMDBSE
     C                     MOVEL#PAYNA    PMERCD
     C                     MOVEL#DETTX    PMRIBN
     C                     MOVEL#DEHTX    PMROBN
     C                     MOVEL#DEJTX    PMROCN
     C                     MOVEL#DEUTX    PMPIBN
     C                     MOVEL#DEGTX    PMPOBN
     C                     MOVEL#DEITX    PMPOCN
     C                     MOVEL#DESTX    PMRCRN
     C                     MOVEL#DEPTX    PMRVNO
     C                     MOVEL#DEQTX    PMAWBN
      *                                                                   S01408
     C/COPY WNCPYSRC,SD2400CP18                                           S01408
      *                                                                   S01408
     C                     MOVEL#DERTX    PMBENN
     C*                                                                   CEU003
     C** If CEU003 is supported                                           CEU003
     C*                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C                     MOVELSRSCY     PMRSCY                          CEU003
     C                     MOVELSPSCY     PMPSCY                          CEU003
     C                     MOVELSIC72     PMIC72                          CEU003
     C                     ENDIF                                          CEU003
      *                                                                                       CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
     C           PMCPGM    ANDEQ'LEND'                                                        CLE031
     C                     MOVELSRSCY     PMRSCY                                              CLE031
     C                     MOVELSPSCY     PMPSCY                                              CLE031
     C                     MOVELSRRTE     PMREXR                                              CLE031
     C                     MOVELSPRTE     PMPEXR                                              CLE031
     C                     MOVELSRCEI     PMREXI                                              CLE031
     C                     MOVELSPCEI     PMPEXI                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C*                                                                   CSW005
     C           *IN10     IFEQ *ON                                       CSW005
     C                     MOVELWSCRN2    @PARM3                          CSW005
     C                     ENDIF                                          CSW005
     C*
     C/COPY WNCPYSRC,SD2400CCP5                                           S01408
     C*
     C                     ENDSR
     C*********************************************************************
      /EJECT
     C*****************************************************************
     C*                                                               *
     C* RESET    -   Clear screen fields                              *
     C*                                                               *
     C* CALLS             NONE                                        *
     C*                                                               *
     C* CALLED BY         #A - Initial processing                     *
     C*                                                               *
     C*****************************************************************
     C*
     C           RESET     BEGSR
     C*
     C                     MOVEL*BLANKS   #PDSNB  3
     C**********           MOVEL*BLANKS   #PAFNB  4                                           CGL029
     C                     MOVEL*BLANKS   #PAFNB 10                                           CGL029
     C                     MOVEL*BLANKS   #PAGTX  8
     C                     Z-ADD0         #PAKTX  50
     C                     Z-ADD0         #PJANB  30
     C                     MOVEL*BLANKS   #PK7ST  1
     C                     MOVEL*BLANKS   #PK8ST  1
     C                     MOVEL*BLANKS   #PDVCD 10
     C                     MOVEL*BLANKS   #PK9ST  1
     C                     MOVEL*BLANKS   #PLAST  1
     C                     MOVEL*BLANKS   #PDWCD  5
     C                     MOVEL*BLANKS   #PAXNA 29
     C                     MOVEL*BLANKS   #PM0NB  2
     C                     MOVEL*BLANKS   #PAYNA150
     C                     MOVEL*BLANKS   #PABAL  3
     C                     MOVEL*BLANKS   #PGGST  1
     C                     MOVEL*BLANKS   #PJTST  1
     C                     MOVEL*BLANKS   #PJUST  4
     C                     MOVEL*BLANKS   #PJVST  2
     C                     Z-ADD0         #PKXNB  50
     C                     Z-ADD0         #PKYNB  50
     C                     MOVEL*BLANKS   #PJWST  1
     C                     MOVEL*BLANKS   #PJXST  1
     C                     MOVEL*BLANKS   #PJYST  2
     C*****                MOVEL*BLANKS   #PJZST  1                       S01227
     C                     MOVEL*BLANKS   #PJ0ST  1
     C                     MOVEL*BLANKS   #PJ1ST  1
     C                     MOVEL*BLANKS   #1AJCD  3
     C**
     C                     MOVEL*BLANKS   #1JPST
     C                     MOVEL*BLANKS   #1JQST
     C                     MOVEL*BLANKS   #1DTTX
     C                     MOVEL*BLANKS   #1DWTX
     C                     MOVEL*BLANKS   #1DZTX  8
     C                     MOVEL*BLANKS   #1CVMR  1                       E22405
     C                     MOVEL*BLANKS   #1DBCD  6
     C                     MOVEL*BLANKS   #1DDCD  6
     C                     MOVEL*BLANKS   #1DACD  6
     C                     MOVEL*BLANKS   #1DCCD  6
     C                     MOVEL*BLANKS   #1DYTX  8
     C                     MOVEL*BLANKS   #1D8TX
     C                     MOVEL*BLANKS   #1DUTX  8
     C                     MOVEL*BLANKS   #1DXTX  8
     C                     MOVEL*BLANKS   #1DVTX
     C                     MOVEL*BLANKS   #1D7TX
     C                     MOVEL*BLANKS   #1D0TX  8
     C                     MOVEL*BLANKS   #1D9TX
     C                     MOVEL*BLANKS   #1D1TX  8
     C                     MOVEL*BLANKS   #1EATX
     C                     MOVEL*BLANKS   #1D2TX
     C                     MOVEL*BLANKS   #1D3TX
     C                     MOVEL*BLANKS   #1D4TX
     C                     MOVEL*BLANKS   #1D5TX
     C                     MOVEL*BLANKS   #1C9CD
     C                     MOVEL*BLANKS   #1D6TX
     C                     MOVEL*BLANKS   #1EBTX
     C***********          MOVELPMBTB3    #1ECTX                          CSW096
     C***********          MOVELPMBTB4    #1EDTX                          CSW096
     C***********          MOVELPMBTB5    #1EETX                          CSW096
     C***********          MOVELPMBTB6    #1EFTX                          CSW096
     C                     MOVEL*BLANKS   #1ECTX                          CSW096
     C                     MOVEL*BLANKS   #1EDTX                          CSW096
     C                     MOVEL*BLANKS   #1EETX                          CSW096
     C                     MOVEL*BLANKS   #1EFTX                          CSW096
     C                     MOVELPMCVMR    #1CVMR                          E22405
     C                     MOVEL*BLANKS   #1DWT2                          S01117
     C                     MOVEL*BLANKS   #1DTT2                          S01117
     C*                                                                   CEU003
     C** Clear all 3 new screen fields                                    CEU003
     C*                                                                   CEU003
     C                     MOVEL*BLANKS   SRSCY                           CEU003
     C                     MOVEL*BLANKS   SPSCY                           CEU003
     C                     MOVEL*BLANKS   SIC72                           CEU003
     C                     MOVEL*BLANKS   SPRTE                                               CLE031
     C                     MOVEL*BLANKS   SRRTE                                               CLE031
     C                     MOVEL*BLANKS   SPCEI                                               CLE031
     C                     MOVEL*BLANKS   SRCEI                                               CLE031
     C*                                                                   CSW005
     C** For FRA/IRS, initialise screen 2 fields:                         CSW005
     C*                                                                   CSW005
     C           CSW005    IFEQ 'Y'                                       CSW005
     C           CSW011    OREQ 'Y'                                       CSW011
     C                     CLEARWSCRN2                                    CSW005
     C                     ENDIF                                          CSW005
     C*                                                                   S01408
     C/COPY WNCPYSRC,SD2400CIS1                                           S01408
     C*                                                                   S01408
     C*
     C                     ENDSR
     C*********************************************************************
      /EJECT
     C*****************************************************************
     C*                                                               *
     C* RTV      -   Retrieve standard settlement instructions        *
     C*                                                               *
     C* CALLS  SSIA - Obtain customer number for chaining to SSI file *
     C*        SSIB - Retrieve Receipt Settlement Instructions for FX *
     C*                                                               *
     C* CALLED BY     INS - Insert processing                         *
     C*                                                               *
     C*****************************************************************
     C*
     C           RTV       BEGSR
     C*
     C*  Calling program is FX Deal Input (FX0820)
     C           #PJUST    IFEQ 'FXFX'
     C*
     C*  Federal Funds ?
     C           #PGGST    IFEQ 'Y'
     C                     MOVEL'FF'      DTYPE   2
     C                     ELSE
     C*
     C                     MOVEL'FX'      DTYPE
     C                     END
     C                     END
     C*
     C*  Calling program is Loan/Deposit Deal Input (MM0028)
     C           #PJUST    IFEQ 'MMLD'
     C*
     C*  Federal Funds ?
     C           #PGGST    IFEQ 'Y'
     C                     MOVEL'MF'      DTYPE
     C                     ELSE
     C*
     C                     MOVEL'MM'      DTYPE
     C                     END
     C                     END
     C/COPY WNCPYSRC,SD2400C034
     C*
     C*  Calling program is NA's Bought Deal Input (MM0026)
     C           #PJUST    IFEQ 'MMNB'
     C*
     C*  Federal Funds ?
     C           #PGGST    IFEQ 'Y'
     C                     MOVEL'FP'      DTYPE
     C                     ELSE
     C*
     C                     MOVEL'NP'      DTYPE
     C                     END
     C                     END
     C*
     C*  Calling program is NA's Sold Deal Input (MM0027)
     C           #PJUST    IFEQ 'MMNS'
     C*
     C*  Federal Funds ?
     C           #PGGST    IFEQ 'Y'
     C                     MOVEL'FS'      DTYPE
     C                     ELSE
     C*
     C                     MOVEL'NS'      DTYPE
     C                     END
     C                     END
      *                                                                   135152
      *  Calling program is any of the Customer Lending input programs    135152
      *                                                                   135152
     C           #PJUST    IFEQ 'LEND'                                    135152
     C                     MOVEL'LE'      DTYPE                           135152
     C                     ENDIF                                          135152
     C*                                                                   CSW005
     C                     MOVEL#PABAL    WSTCY   3                       CEU003
     C*  FRA/IRS?                                                         CSW005
     C           *IN10     IFEQ *ON                                       CSW005
     C                     MOVELPMTTYP    DTYPE                           CSW005
     C                     ENDIF                                          CSW005
     C*
     C*  Load Payment and Receipt instructions for Prime currency
     C                     EXSR SSIA
     C*
     C*  IF FX, overwrite Receipt instructions with Buy currency's
     C*  receipt instructions
     C*  Do also for Cross Currency IRSs                                  CSW005
     C           #PJUST    IFEQ 'FXFX'
     C********** *IN90     IFEQ '0'                                       LN0757
     C           CSW005    OREQ 'Y'                                       CSW005
     C           PMTTYP    ANDEQ'RX'                                      CSW005
     C                     MOVELPMRCCY    WSTCY                           CEU003
     C                     EXSR SSIB
     C**********           END                                            LN0757
     C                     END
     C*
     C*  Set off the first entry flag
     C                     MOVEL'N'       #PK7ST
     C*
     C********** PMBENN    IFEQ *BLANK                              BHFXXXBHF558
     C**********                                                    BHF366BHF558
     C***If*PMCSNM*is*a*shortname,*need*customer*number*for*6-digi  BHF366BHF558
     C********** PMCSNM    CHAINSDCUSTL2             90             BHF366BHF558
     C********** *IN90     IFEQ '0'                                 BHF366BHF558
     C**********           MOVELBBCUST    #1DDCD                    BHF366BHF558
     C**********           MOVELBBCUST    #1DBCD                    BHF366BHF558
     C**********           MOVELBBCUST    #1D1TX                    BHF366BHF558
     C**********           ELSE                                     BHF366BHF558
     C**********           MOVELPMCSNM    #1DDCD                    BHFXXXBHF558
     C**********           MOVELPMCSNM    #1DBCD                    BHFXXXBHF558
     C**********           MOVELPMCSNM    #1D1TX                    BHFXXXBHF558
     C**********           END                                      BHF366BHF558
     C**********           END                                      BHFXXXBHF558
      *                                                             BHFXXXBHF558
     C                     ENDSR
     C*********************************************************************
      /EJECT
     C*****************************************************************
     C*                                                               *
     C* CUST     -  Retrieve Customer name from SDCUSTL1              *
     C*                                                               *
     C* CALLS             NONE                                        *
     C*                                                               *
     C* CALLED BY        CVTA - Convert customer number to shortname  *
     C*                                                               *
     C*****************************************************************
     C*
     C           CUST      BEGSR
     C*
     C           @FLD6     CHAINSDCUSTL1             90
     C*
     C* IF no record found
     C           *IN90     IFEQ '1'
     C                     MOVEL'Y2U0005' @RCODE
     C                     MOVEL'SDCUS'   PMDBFL
     C                     END
     C*
     C                     ENDSR
     C*********************************************************************
      /EJECT
     C*****************************************************************
     C*                                                               *
     C* NOST     -  Retrieve Counterparty Nostro Name                 *
     C*                                                               *
     C* CALLS            NONE                                         *
     C*                                                               *
     C* CALLED BY  CVTB  -  Convert counterparty number to shortname  *
     C*                                                               *
     C*****************************************************************
     C*
     C           NOST      BEGSR
     C*
     C                     MOVEL*BLANKS   @CNAME
     C           @FLD8     CHAINSDCNSTL1             90
     C*
     C*  record found
     C           *IN90     IFEQ '0'
     C                     MOVE AWCSN2    @CNAME 10
     C                     MOVELAWCSN1    @CNAME
     C                     END
     C*
     C                     ENDSR
     C*********************************************************************
      /EJECT
     C*****************************************************************
     C*                                                               *
     C* ERROR    - CALL PROGRAM ZA0240 TO OUTPUT ERROR MESSAGES       *
     C*                                                               *
     C* CALLS             NONE                                        *
     C*                                                               *
     C* CALLED BY         INS - Insert processing                     *
     C*                                                               *
     C*****************************************************************
     C*
     C           ERROR     BEGSR
     C*
     C/COPY WNCPYSRC,SD2400C016
     C                     MOVELERR       ERRCDE  4
     C*
     C*  Search for error code and it's indicators in array
     C                     Z-ADD1         W       30
     C           ERRCDE    LOKUP@ERR,W                   65
     C*
     C*  Set on the error's related indicators to highlight fields
     C           *IN65     IFEQ '1'
     C                     MOVEA@IND,W    @INDA
     C                     Z-ADD1         X       10
     C           X         DOWLT7
     C           @INDA,X   ANDNE*BLANKS
     C                     MOVE @INDA,X   Y       20
     C                     MOVE '1'       *IN,Y
     C                     ADD  1         X
     C                     END
     C                     END
      ** If the retail account is in error and the settlement method      100757
      ** is 04, highlight the settlement method field instead of the      100757
      ** settlement account, which will be blank.                         100757
      *                                                                   100757
     C           PMRSTM    IFEQ 04                                        100757
     C           ERRCDE    ANDEQ'912'                                     100757
     C           PMRSTM    OREQ 04                                        100757
     C           ERRCDE    ANDEQ'913'                                     100757
     C                     MOVE '0'       *IN33                           100757
     C                     MOVE '1'       *IN31                           100757
     C                     END                                            100757
      *                                                                   100757
      ** Do the same for the pay side                                     100757
      *                                                                   100757
     C           PMPSTM    IFEQ 04                                        100757
     C           ERRCDE    ANDEQ'942'                                     100757
     C           PMPSTM    OREQ 04                                        100757
     C           ERRCDE    ANDEQ'943'                                     100757
     C                     MOVE '0'       *IN34                           100757
     C                     MOVE '1'       *IN32                           100757
     C                     END                                            100757
     C*
     C/COPY WNCPYSRC,SD2400CER1                                           S01408
     C*
     C*                                                                   CSW005
     C                     MOVELERR       @WRK1   1                       CSW005
     C*                                                                   CSW005
     C** Error codes starting with 'X' have been sent already in          CSW005
     C** the program message queue.                                       CSW005
     C*                                                                   CSW005
     C           @WRK1     IFNE 'X'                                       CSW005
     C/COPY WNCPYSRC,SD2400C035
     C*
     C*  Display error message
     C                     MOVEL'ESM0'    @WRK7   7
     C                     MOVE ERR       @WRK7
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL@WRK7     ZAMSID
     C                     CALL 'ZA0240'
     C                     PARM           ZAMSID
     C*                                                                   CSW005
     C/COPY WNCPYSRC,SD2400CP19                                           S01408
     C*                                                                   S01408
     C                     ENDIF                                          CSW005
     C*
     C/COPY WNCPYSRC,SD2400CER2                                           S01408
     C*
     C*
     C                     ENDSR
     C/COPY WNCPYSRC,SD2400C017
     C*********************************************************************
      /EJECT
     C*****************************************************************
     C*                                                               *
     C* SSIA     - Obtain customer number for chaining to SSI file    *
     C*                                                               *
     C* CALLS  SSIC - Retrieve Pay/Receive Instructions for Prime ccy *
     C*                                                               *
     C* CALLED BY         INS - Insert processing                     *
     C*                                                               *
     C*****************************************************************
     C*
     C           SSIA      BEGSR
     C*
     C*  Retrieve Customer Number from Customer details file (key is
     C*  SHORTNAME)
     C           #PDVCD    CHAINSDCUSTL2             90
     C           *IN90     IFEQ '0'
     C                     MOVELBBCUST    @CUST   6
     C                     EXSR SSIC
     C                     ELSE
     C*
     C/COPY WNCPYSRC,SD2400C043
     C*  Shortname not found => 6 digit number
     C*
     C                     MOVE #PDVCD    @WRK4   4
     C*
     C           @WRK4     IFEQ *BLANKS
     C                     MOVEL#PDVCD    @CUST
     C*
     C*  Retrieve pay/receive instructions for Prime currency
     C                     EXSR SSIC
     C                     END
     C/COPY WNCPYSRC,SD2400C044
     C*
     C                     END
     C*
     C                     ENDSR
     C*********************************************************************
      /EJECT
     C*****************************************************************
     C*                                                               *
     C* SSIB -  Retrieve Receipt Settlement Instructions for Buy      *
     C*         currency (only called if deal type is 'FXFX')         *
     C*                                                               *
     C* CALLS             NONE                                        *
     C*                                                               *
     C* CALLED BY         INS - Insert processing                     *
     C*                                                               *
     C*****************************************************************
     C*
     C           SSIB      BEGSR
     C*                                                                   045815
     C** Move blanks into the settlement fields to ensure that if         045815
     C** a customer is changed the old fields do not remain and if        045815
     C** the deal is an FX that the receipt instructions are the BUY      045815
     C** currency's not the SELL currency.                                045815
     C*                                                                   045815
     C***********          MOVE *BLANKS   #1JPST                   045815 087755
     C***********          MOVEL'00'      #1JPST                   045815 087755
     C***********          MOVE *BLANKS   #1DTTX                   045815 087755
     C***********          MOVE *BLANKS   #1DTT2                   045815 087755
     C***********          MOVE *BLANKS   #1DACD                   045815 087755
     C***********          MOVE *BLANKS   #1DBCD                   045815 087755
     C***********          MOVE *BLANKS   #1DUTX                   045815 087755
     C***********          MOVE *BLANKS   #1DVTX                   045815 087755
     C*
     C           PMRCCY    IFNE 'USD'                                  BHF799
     C           #PJUST    ANDEQ'FXFX'                                    CEU003
     C                     MOVEL'FX'      DTYPE                        BHF799
     C                     END                                         BHF799
     C*                                                                BHF799
     C                     MOVEL*BLANK    W0RTN   7
     C***********          MOVELPMRCCY    BYCYCD                          CEU003
     C                     MOVELWSTCY     BYCYCD                          CEU003
     C                     MOVEL@CUST     BYCUST
     C                     MOVELDTYPE     BYTRTY
      *                                                                   CDL008
     C           CDL008    IFEQ 'Y'                                       CDL008
     C           PMTTYP    ANDEQ'CL'                                      CDL008
     C           #PJUST    ANDEQ'FXFX'                                    CDL008
     C                     MOVEL'CL'      BYTRTY                          CDL008
     C                     ENDIF                                          CDL008
     C*
     C           USKEY     CHAINSDEXSTL1             90
     C*
     C*IF CHAIN FAILS ATTEMPT CHAIN USING 'ALL TYPES' (AT).               LN0789
     C           *IN90     IFEQ '1'                                       LN0789
      *                                                                   CDL008
     C           CDL008    IFEQ 'Y'                                       CDL008
     C           #PJUST    ANDEQ'FXFX'                                    CDL008
     C           BYTRTY    ANDEQ'CL'                                      CDL008
      *                                                                   CDL008
      ** Display warning message                                          CDL008
      *                                                                   CDL008
     C           WWARN     IFEQ *OFF                                      CDL008
     C                     MOVE *ON       WWARN                           CDL008
     C                     MOVEL*BLANK    ZAMSID                          CDL008
     C                     MOVEL'ESM0300' ZAMSID                          CDL008
     C                     CALL 'ZA0240'                                  CDL008
     C                     PARM           ZAMSID                          CDL008
     C                     ENDIF                                          CDL008
      *                                                                   CDL008
     C                     ELSE                                           CDL008
     C                     MOVEL'AT'      BYTRTY                          LN0789
     C           USKEY     CHAINSDEXSTL1             90                   LN0789
     C                     ENDIF                                          CDL008
      *                                                                   CDL008
     C                     END                                            LN0789
     C*                                                                   CEU003
     C** If CEU003 is supported                                           CEU003
     C*                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C           *IN90     ANDEQ'0'                                       CEU003
     C*                                                                   CEU003
     C           BYSTCY    IFNE *BLANKS                                   CEU003
     C           *IN13     ANDEQ'0'                                       CEU003
     C*                                                                   CEU003
     C                     CALL 'AOCURRR0'                                CEU003
     C                     PARM '*DBERR  'PRTCD                           CEU003
     C                     PARM '*KEY    'POPTN                           CEU003
     C                     PARM WSTCY     PCURR                           CEU003
     C           SDCURR    PARM SDCURR    DSSDY                           CEU003
     C*                                                                   CEU003
     C           A6INCY    IFEQ 'Y'                                       CEU003
     C           WDTRP     ANDGEA6TPSD                                    CEU003
     C           WSTCY     OREQ BKEURO                                    CEU003
     C*                                                                   CEU003
     C                     MOVELBYSTCY    SRSCY                           CEU003
     C*                                                                   CEU003
     C**  Access Currency Details                                         CEU003
     C*                                                                   CEU003
     C                     CALL 'AOCURRR0'                                CEU003
     C                     PARM *BLANKS   PRTCD                           CEU003
     C                     PARM '*KEY    'POPTN                           CEU003
     C                     PARM BYSTCY    PCURR                           CEU003
     C           SDCURR    PARM SDCURR    DSSDY                           CEU003
     C*                                                                   CEU003
     C           PRTCD     IFNE *BLANKS                                   CEU003
     C                     MOVE '1'       *IN90                           CEU003
     C                     ELSE                                           CEU003
     C*                                                                   CEU003
     C           A6INCY    IFEQ 'Y'                                       CEU003
     C           WDTRP     ANDGEA6TPSD                                    CEU003
     C           BYSTCY    OREQ BKEURO                                    CEU003
     C                     MOVELBYSTCY    WSTCY                           CEU003
     C                     MOVELWSTCY     BYCYCD                          CEU003
     C                     MOVEL@CUST     BYCUST                          CEU003
     C                     MOVELDTYPE     BYTRTY                          CEU003
     C*                                                                   CEU003
     C           USKEY     CHAINSDEXSTL1             90                   CEU003
     C*                                                                   CEU003
     C** Use 'AT' as transaction type when record not found               CEU003
     C*                                                                   CEU003
     C           *IN90     IFEQ '1'                                       CEU003
     C                     MOVEL'AT'      BYTRTY                          CEU003
     C           USKEY     CHAINSDEXSTL1             90                   CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     ELSE                                           CEU003
     C                     MOVEL*BLANKS   SRSCY                           CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     ELSE                                           CEU003
     C                     MOVEL*BLANKS   SRSCY                           CEU003
     C*                                                                   CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   S01408
     C/COPY WNCPYSRC,SD2400CCP6                                           S01408
     C*                                                                   S01408
     C*
     C           *IN90     IFEQ '0'
     C                     MOVELBYRSTY    #1JPST
      *
     C** FOR A MULTIBRANCHED SYSTEM SET UP BRANCHES IF SETT. METHOD 05    E00036
     C*****                MOVELBYDTTX    #1DTTX                          E00036
     C                     MOVE *BLANKS   #1DTTX                          E00036
     C                     MOVE *BLANKS   #1DTT2                          E00036
     C           BYRSTY    IFEQ '05'                                      E00036
     C           BYRSTY    OREQ '09'                                      CLE033
     C           CLE033    ANDEQ'Y'                                       CLE033
      *                                                                   S01408
     C/COPY WNCPYSRC,SD2400CP10                                           S01408
      *                                                                   S01408
     C  N80                MOVELBYRONO    #1DTTX                          E00036
     C   80                MOVELBYORBR    #1DTT2                          E00036
     C   80                MOVE BYRONO    #1DTT2                          E00036
     C                     ELSE                                           E00036
     C  N80                MOVELBYRONO    #1DTTX                          E00036
     C   80                MOVELBYRONO    #1DTT2                          E00036
     C                     END                                            E00036
      *
     C                     MOVELBYROBN    #1DACD
     C                     MOVELBYROCS    #1DBCD
     C                     MOVELBYRIBN    #1DUTX
     C                     MOVELBYRIBL    #1DVTX
     C*                                                                   BHF586
     C** INSERT BANK TO BANK INFO AND DETAILS OF PAYMENT                  BHF586
     C*                                                                   BHF586
     C***********          MOVELBYBBI1    #1D6TX                    BHF586BHF882
     C***********          MOVELBYBBI3    #1ECTX                    BHF586BHF882
     C***********          MOVELBYBBI5    #1EETX                    BHF586BHF882
     C***********          MOVELBYDPY1    #1D2TX                    BHF586BHF882
     C***********          MOVELBYDPY3    #1D4TX                    BHF586BHF882
      *                                                                   BHF586
      * else if no instructions for Buy Currency, set fields to           BHF586
      * blanks so no default to Sell Currency values                      BHF586
     C                     ELSE                                           BHF586
     C**********           MOVE *BLANKS   #1JPST                    BHF586LN0810
     C                     MOVEL*BLANKS   #1JPST                          BH3113
     C                     MOVEL'00'      #1JPST                          087755
     C                     MOVE *BLANKS   #1DTTX                          BHF586
     C                     MOVE *BLANKS   #1DTT2                          BHF586
     C                     MOVE *BLANKS   #1DACD                          BHF586
     C                     MOVE *BLANKS   #1DBCD                          BHF586
     C                     MOVE *BLANKS   #1DUTX                          BHF586
     C                     MOVE *BLANKS   #1DVTX                          BHF586
     C***********          MOVE *BLANKS   #1D2TX                    BHF586BHF882
     C***********          MOVE *BLANKS   #1D6TX                    BHF586BHF882
     C***********          MOVEL*BLANKS   #1D2TX                    BHF586BHF882
     C***********          MOVEL*BLANKS   #1ECTX                    BHF586BHF882
     C***********          MOVEL*BLANKS   #1EETX                    BHF586BHF882
     C***********          MOVEL*BLANKS   #1D4TX                    BHF586BHF882
     C           CEU003    IFEQ 'Y'                                       CEU003
     C                     MOVEL*BLANKS   #DEJTX                          CEU003
     C                     MOVEL*BLANKS   #DEHTX                          CEU003
     C                     MOVEL*BLANKS   #DETTX                          CEU003
     C                     ENDIF                                          CEU003
     C/COPY WNCPYSRC,SD2400C009
     C                     END
     C*                                                                   S01408
     C/COPY WNCPYSRC,SD2400C014                                           S01408
     C*
     C                     ENDSR
     C*********************************************************************
      /EJECT
     C*****************************************************************
     C*                                                               *
     C* SSIC - Retrieve pay/receive Standard Settlement Instructions  *
     C*       for Prime currency (for FX this will be the Sell ccy)   *
     C*                                                               *
     C* CALLS             NONE                                        *
     C*                                                               *
     C* CALLED BY  SSIA - Obtain customer number for chaining to SSI  *
     C*                                                               *
     C*****************************************************************
     C*
     C           SSIC      BEGSR
     C*
     C*  Define Keylist for SSI file
     C*     CURRENCY + CUSTOMER + DEAL TYPE
     C*
     C           USKEY     KLIST
     C                     KFLD           BYCYCD
     C                     KFLD           BYCUST
     C                     KFLD           BYTRTY
     C*
     C***********          MOVEL#PABAL    BYCYCD                          CEU003
     C                     MOVELWSTCY     BYCYCD                          CEU003
     C                     MOVEL@CUST     BYCUST
     C                     MOVELDTYPE     BYTRTY
      *                                                                   CDL008
     C           CDL008    IFEQ 'Y'                                       CDL008
     C           PMTTYP    ANDEQ'CL'                                      CDL008
     C           #PJUST    ANDEQ'FXFX'                                    CDL008
     C                     MOVEL'CL'      BYTRTY                          CDL008
     C                     ENDIF                                          CDL008
     C*
     C           USKEY     CHAINSDEXSTL1             90
     C/COPY WNCPYSRC,SD2400C010
     C*
     C*IF CHAIN FAILS ATTEMPT CHAIN USING 'ALL TYPES' (AT).              S01227
     C           *IN90     IFEQ '1'                                      S01227
      *                                                                   CDL008
     C           CDL008    IFEQ 'Y'                                       CDL008
     C           #PJUST    ANDEQ'FXFX'                                    CDL008
     C           BYTRTY    ANDEQ'CL'                                      CDL008
      *                                                                   CDL008
      ** Display warning message                                          CDL008
      *                                                                   CDL008
     C           WWARN     IFEQ *OFF                                      CDL008
     C                     MOVE *ON       WWARN                           CDL008
     C                     MOVEL*BLANK    ZAMSID                          CDL008
     C                     MOVEL'ESM0300' ZAMSID                          CDL008
     C                     CALL 'ZA0240'                                  CDL008
     C                     PARM           ZAMSID                          CDL008
     C                     ENDIF                                          CDL008
      *                                                                   CDL008
     C                     ELSE                                           CDL008
     C                     MOVEL'AT'      BYTRTY                         S01227
     C           USKEY     CHAINSDEXSTL1             90                  S01227
     C                     ENDIF                                          CDL008
      *                                                                   CDL008
     C                     END                                           S01227
     C*                                                                   CEU003
     C** If CEU003 is supported                                           CEU003
     C*                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C           *IN90     ANDEQ'0'                                       CEU003
     C*                                                                   CEU003
     C* Save 'Include ERI in field 72' for later use.                     145144
     C*                                                                   145144
     C                     MOVE BYIERI    WUIERI  1                       145144
     C*                                                                   145144
     C           BYSTCY    IFNE *BLANKS                                   CEU003
     C           *IN13     ANDEQ'0'                                       CEU003
     C*                                                                   CEU003
     C                     CALL 'AOCURRR0'                                CEU003
     C                     PARM '*DBERR  'PRTCD                           CEU003
     C                     PARM '*KEY    'POPTN                           CEU003
     C                     PARM WSTCY     PCURR                           CEU003
     C           SDCURR    PARM SDCURR    DSSDY                           CEU003
     C*                                                                   CEU003
     C           A6INCY    IFEQ 'Y'                                       CEU003
     C           WDTRP     ANDGEA6TPSD                                    CEU003
     C           WSTCY     OREQ BKEURO                                    CEU003
     C*                                                                   CEU003
     C                     MOVEL*BLANKS   SRSCY                           CEU003
     C                     MOVEL*BLANKS   SPSCY                           CEU003
     C*                                                                   CEU003
     C           WPPAY     IFEQ 'N'                                       CEU003
     C                     MOVELBYSTCY    SPSCY                           CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C           WPRCV     IFEQ 'N'                                       CEU003
     C           PMCPGM    ANDNE'FXFX'                                    CEU003
     C           WPRCV     OREQ 'N'                                       CEU003
     C           CSW005    ANDEQ'Y'                                       CEU003
     C           WTTYP     ANDNE'RX'                                      CEU003
     C                     MOVELBYSTCY    SRSCY                           CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C**  Access Currency Details                                         CEU003
     C*                                                                   CEU003
     C                     CALL 'AOCURRR0'                                CEU003
     C                     PARM *BLANKS   PRTCD                           CEU003
     C                     PARM '*KEY    'POPTN                           CEU003
     C                     PARM BYSTCY    PCURR                           CEU003
     C           SDCURR    PARM SDCURR    DSSDY                           CEU003
     C*                                                                   CEU003
     C           PRTCD     IFNE *BLANKS                                   CEU003
     C                     MOVE '1'       *IN90                           CEU003
     C                     ELSE                                           CEU003
     C*                                                                   CEU003
     C           A6INCY    IFEQ 'Y'                                       CEU003
     C           WDTRP     ANDGEA6TPSD                                    CEU003
     C           BYSTCY    OREQ BKEURO                                    CEU003
     C                     MOVELBYSTCY    WSTCY                           CEU003
     C                     MOVELWSTCY     BYCYCD                          CEU003
     C                     MOVEL@CUST     BYCUST                          CEU003
     C                     MOVELDTYPE     BYTRTY                          CEU003
     C*                                                                   CEU003
     C           USKEY     CHAINSDEXSTL1             90                   CEU003
     C*                                                                   CEU003
     C** Use 'AT' as transaction type when record not found               CEU003
     C*                                                                   CEU003
     C           *IN90     IFEQ '1'                                       CEU003
     C                     MOVEL'AT'      BYTRTY                          CEU003
     C           USKEY     CHAINSDEXSTL1             90                   CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     ELSE                                           CEU003
     C                     MOVEL*BLANKS   SRSCY                           CEU003
     C                     MOVEL*BLANKS   SPSCY                           CEU003
     C                     MOVEL*BLANKS   SIC72                           CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     ELSE                                           CEU003
     C                     MOVEL*BLANKS   SRSCY                           CEU003
     C                     MOVEL*BLANKS   SPSCY                           CEU003
     C                     MOVEL*BLANKS   SIC72                           CEU003
     C*                                                                   CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     ENDIF                                          CEU003
     C*
     C*                                                                   S01408
     C/COPY WNCPYSRC,SD2400CCP7                                           S01408
     C*                                                                   S01408
     C*
     C           *IN90     IFEQ '0'
     C                     MOVELBYRSTY    #1JPST
     C*                                                                   S01117
     C** FOR A MULTIBRANCHED SYSTEM SET UP BRANCHES FOR SETT METH.05      S01117
     C******************** MOVELBYDTTX    #1DTTX                          S01117
     C                     MOVE *BLANKS   #1DWT2                          E00036
     C                     MOVE *BLANKS   #1DTT2                          E00036
     C           BYRSTY    IFEQ '05'                                      E00036
     C           BYRSTY    OREQ '09'                                      CLE033
     C           CLE033    ANDEQ'Y'                                       CLE033
      *                                                                   S01408
     C/COPY WNCPYSRC,SD2400CP11                                           S01408
      *                                                                   S01408
     C  N80                MOVELBYRONO    #1DTTX                          S01117
     C   80                MOVE BYRONO    #1DTT2                          S01117
     C   80                MOVELBYORBR    #1DTT2                          S01117
     C**N80******          MOVELBYPONO    #1DWTX                   E00036 107086
     C***80******          MOVE BYPONO    #1DWT2                   E00036 107086
     C***80******          MOVELBYOPBR    #1DWT2                   E00036 107086
     C                     ELSE                                           E00036
     C  N80                MOVELBYRONO    #1DTTX                          E00036
     C   80                MOVELBYRONO    #1DTT2                          E00036
     C**N80******          MOVELBYPONO    #1DWTX                   E00036 107086
     C***80******          MOVELBYPONO    #1DWT2                   E00036 107086
     C                     END                                            E00036
      *                                                                   107086
     C           BYPSTY    IFEQ '05'                                      107086
     C           BYPSTY    OREQ '09'                                      CLE033
     C           CLE033    ANDEQ'Y'                                       CLE033
     C/COPY WNCPYSRC,SD2400C037
     C  N80                MOVELBYPONO    #1DWTX                          107086
     C   80                MOVE BYPONO    #1DWT2                          107086
     C   80                MOVELBYOPBR    #1DWT2                          107086
     C                     ELSE                                           107086
     C  N80                MOVELBYPONO    #1DWTX                          107086
     C   80                MOVELBYPONO    #1DWT2                          107086
     C                     END                                            107086
      *
     C                     MOVELBYROBN    #1DACD
     C                     MOVELBYROCS    #1DBCD
     C                     MOVELBYRIBN    #1DUTX
     C                     MOVELBYRIBL    #1DVTX
     C                     MOVELBYPSTY    #1JQST
     C*
     C***FOR*A*MULTIBRANCHED*SYSTEM*SET*UP*BRANCHES                S01117 E00036
     C*****************    MOVELBYDWTX    #1DWTX                   S01117 E00036
     C**N80                MOVELBYDWTX    #1DWTX                   S01117 E00036
     C***80                MOVE BYDWTX    #1DWT2                   S01117 E00036
     C***80                MOVELBYEECD    #1DWT2                   S01117 E00036
     C*                                                                   056887
     C** FOR NA SOLD, PAYMENT INSTRUCTIONS SHOULD BE BLANK                056887
     C*                                                                   056887
     C           DTYPE     IFEQ 'NS'                       NA SOLD        056887
     C*                                                                   CEU003
     C** If CEU003 is supported                                           CEU003
     C*                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C                     MOVEL*BLANKS   SPSCY                           CEU003
     C                     MOVEL*BLANKS   SIC72                           CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     MOVEL'00'      #1JQST                          056887
     C                     MOVE *BLANKS   #1DWT2                          056887
     C                     MOVEL*BLANKS   #1DWTX                          056887
     C                     MOVEL*BLANKS   #1DCCD                          056887
     C                     MOVEL*BLANKS   #1DDCD                          056887
     C                     MOVEL*BLANKS   #1DXTX                          056887
     C                     MOVEL*BLANKS   #1D7TX                          056887
     C                     MOVEL*BLANKS   #1DYTX                          056887
     C                     MOVEL*BLANKS   #1D8TX                          056887
     C                     MOVEL*BLANKS   #1DZTX                          056887
     C                     MOVEL*BLANKS   #1D0TX                          056887
     C                     MOVEL*BLANKS   #1D9TX                          056887
     C                     MOVEL*BLANKS   #1D1TX                          056887
     C                     MOVEL*BLANKS   #1EATX                          056887
     C                     MOVEL*BLANKS   #1D2TX                          056887
     C                     MOVEL*BLANKS   #1D3TX                          056887
     C                     MOVEL*BLANKS   #1D4TX                          056887
     C                     MOVEL*BLANKS   #1D5TX                          056887
     C                     MOVEL*BLANKS   #1C9CD                          056887
     C                     MOVEL*BLANKS   #1D6TX                          056887
     C                     MOVEL*BLANKS   #1EBTX                          056887
     C                     MOVEL*BLANKS   #1ECTX                          056887
     C                     MOVEL*BLANKS   #1EDTX                          056887
     C                     MOVEL*BLANKS   #1EETX                          056887
     C                     MOVEL*BLANKS   #1EFTX                          056887
     C                     MOVEL*BLANKS   #1CVMR                          056887
     C                     ELSE                                           056887
     C*                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C*                                                                   CEU003
     C           PMPCCY    IFNE BKEURO                                    CEU003
     C           SPSCY     ANDEQBKEURO                                    CEU003
     C********** BYIERI    ANDEQ'Y'                                 CEU003145144
     C           WUIERI    ANDEQ'Y'                                       145144
     C                     MOVELPMPCCY    SIC72                           CEU003
     C                     ELSE                                           CEU003
     C                     MOVE *BLANKS   SIC72                           CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     MOVELBYPOBN    #1DCCD
     C                     MOVELBYPOCS    #1DDCD
     C                     MOVELBYPIBN    #1DXTX
     C                     MOVELBYPIBA    #1D7TX
     C                     MOVELBYRCNO    #1DYTX
     C                     MOVELBYRCAL    #1D8TX
     C                     MOVELBYRCNB    #1DZTX
     C                     MOVELBYACBN    #1D0TX
     C                     MOVELBYACBL    #1D9TX
     C                     MOVELBYBYNB    #1D1TX
     C******************** MOVELBYBYBN    #1D1TX
     C                     MOVELBYBACL    #1EATX
     C                     MOVELBYDPY1    #1D2TX
     C                     MOVELBYDPY2    #1D3TX
     C                     MOVELBYDPY3    #1D4TX
     C                     MOVELBYDPY4    #1D5TX
     C                     MOVELBYDECG    #1C9CD
     C                     MOVELBYBBI1    #1D6TX
     C                     MOVELBYBBI2    #1EBTX
     C                     MOVELBYBBI3    #1ECTX
     C                     MOVELBYBBI4    #1EDTX
     C                     MOVELBYBBI5    #1EETX
     C                     MOVELBYBBI6    #1EFTX
     C                     MOVELBYCVMR    #1CVMR                          E22405
     C                     END                                            056887
     C*                                                                   CSW005
     C           *IN10     IFEQ *ON                                       CSW005
     C                     MOVELBYDSR1    RDSR1                           CSW005
     C                     MOVELBYDSR2    RDSR2                           CSW005
     C                     MOVELBYDSR3    RDSR3                           CSW005
     C                     MOVELBYDSR4    RDSR4                           CSW005
     C                     MOVELBYDSR5    RDSR5                           CSW005
     C                     MOVELBYDSR6    RDSR6                           CSW005
     C                     MOVELBYSSR1    RSSR1                           CSW005
     C                     MOVELBYSSR2    RSSR2                           CSW005
     C                     MOVELBYSSR3    RSSR3                           CSW005
     C                     MOVELBYSSR4    RSSR4                           CSW005
     C                     MOVELBYSSR5    RSSR5                           CSW005
     C                     MOVELBYSSR6    RSSR6                           CSW005
     C                     MOVELBYCND1    RCND1                           CSW005
     C                     MOVELBYCND2    RCND2                           CSW005
     C                     MOVELBYCND3    RCND3                           CSW005
     C                     MOVELBYCND4    RCND4                           CSW005
     C                     MOVELBYCND5    RCND5                           CSW005
     C                     MOVELBYCND6    RCND6                           CSW005
     C                     MOVELBYISDA    RISDA                           CSW005
     C                     MOVELBYAGTY    RAGTY                           CSW005
     C                     MOVELBYAGDT    RAGDT                           CSW005
     C***********          MOVELBYAGVV    RAGVV                     CSW005CSW097
     C                     MOVELBYAGVC    RAGVV                           CSW097
     C                     MOVE BYAGVV    RAGVV                           CSW097
     C                     ENDIF                                          CSW005
     C*                                                                   CSW005
     C                     ELSE                                           045815
     C*                                                                   CEU003
     C** If CEU003 is supported                                           CEU003
     C*                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C                     MOVEL*BLANKS   SIC72                           CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C*                                                                   CSW005
     C                     MOVEL'00'      #1JPST                          045815
     C                     MOVEL*BLANKS   #1DTTX                          045815
     C                     MOVEL*BLANKS   #1DTT2                          045815
     C                     MOVEL*BLANKS   #1DACD                          045815
     C                     MOVEL*BLANKS   #1DBCD                          045815
     C                     MOVEL*BLANKS   #1DUTX                          045815
     C                     MOVEL*BLANKS   #1DVTX                          045815
     C                     MOVEL'00'      #1JQST                          045815
     C                     MOVEL*BLANKS   #1DWTX                          045815
     C                     MOVEL*BLANKS   #1DWT2                          045815
     C                     MOVEL*BLANKS   #1DCCD                          045815
     C                     MOVEL*BLANKS   #1DDCD                          045815
     C                     MOVEL*BLANKS   #1DXTX                          045815
     C                     MOVEL*BLANKS   #1D7TX                          045815
     C                     MOVEL*BLANKS   #1DYTX                          045815
     C                     MOVEL*BLANKS   #1D8TX                          045815
     C                     MOVEL*BLANKS   #1DZTX                          045815
     C                     MOVEL*BLANKS   #1D0TX                          045815
     C                     MOVEL*BLANKS   #1D9TX                          045815
     C                     MOVEL*BLANKS   #1D1TX                          045815
     C                     MOVEL*BLANKS   #1EATX                          045815
     C                     MOVEL*BLANKS   #1D2TX                          045815
     C                     MOVEL*BLANKS   #1D3TX                          045815
     C                     MOVEL*BLANKS   #1D4TX                          045815
     C                     MOVEL*BLANKS   #1D5TX                          045815
     C                     MOVEL*BLANKS   #1C9CD                          045815
     C                     MOVEL*BLANKS   #1D6TX                          045815
     C                     MOVEL*BLANKS   #1EBTX                          045815
     C                     MOVEL*BLANKS   #1ECTX                          045815
     C                     MOVEL*BLANKS   #1EDTX                          045815
     C                     MOVEL*BLANKS   #1EETX                          045815
     C                     MOVEL*BLANKS   #1EFTX                          045815
     C                     MOVEL*BLANKS   #1CVMR                          045815
     C           CEU003    IFEQ 'Y'                                       CEU003
     C                     MOVEL*BLANKS   #DEITX                          CEU003
     C                     MOVEL*BLANKS   #DEGTX                          CEU003
     C                     MOVEL*BLANKS   #DESTX                          CEU003
     C                     MOVEL*BLANKS   #DEUTX                          CEU003
     C                     MOVEL*BLANKS   #DEQTX                          CEU003
     C                     MOVEL*BLANKS   #DERTX                          CEU003
     C                     ENDIF                                          CEU003
     C/COPY WNCPYSRC,SD2400C008
     C*                                                                   CSW005
     C                     CLEARWSCRN2                                    CSW005
     C*                                                                   CSW005
     C           PMTTYP    IFEQ 'RS'                                      CSW005
     C           PMTTYP    OREQ 'RX'                                      CSW005
     C*                                                                   CSW005
     C           BQISDA    IFNE *BLANKS                                   CSW005
     C                     MOVELBQISDA    RISDA                           CSW005
     C                     ELSE                                           CSW005
     C                     MOVEL'1991'    RISDA                           CSW005
     C                     ENDIF                                          CSW005
     C*                                                                   CSW005
     C           BQAGTY    IFNE *BLANKS                                   CSW005
     C                     MOVELBQAGTY    RAGTY                           CSW005
     C                     ELSE                                           CSW005
     C                     MOVEL'ISDA'    RAGTY                           CSW005
     C                     ENDIF                                          CSW005
     C*                                                                   CSW005
     C           BQAGDT    IFNE *BLANKS                                   CSW005
     C                     MOVELBQAGDT    RAGDT                           CSW005
     C                     ELSE                                           CSW005
     C                     MOVEL'871012'  RAGDT                           CSW005
     C                     ENDIF                                          CSW005
     C*                                                                   CSW005
     C           BQAGVV    IFNE *BLANKS                                   CSW005
     C***********          MOVELBQAGVV    RAGVV                     CSW005CSW097
     C                     MOVE BQAGVV    RAGVV                           CSW097
     C                     MOVELBQAGVC    RAGVV                           CSW097
     C                     ELSE                                           CSW005
     C***********          MOVEL'87'      RAGVV                     CSW005CSW097
     C                     MOVEL'1987'    RAGVV                           CSW097
     C                     ENDIF                                          CSW005
     C*                                                                   CSW005
     C                     ENDIF                                          CSW005
     C*                                                                   CSW005
     C                     END
     C*                                                                   S01408
     C/COPY WNCPYSRC,SD2400CCP2                                           S01408
     C*                                                                   S01408
     C*
     C                     ENDSR
     C*********************************************************************
      /EJECT
     C*****************************************************************
     C*                                                               *
     C* VAL      - Validate screen input                              *
     C*                                                               *
     C* CALLS             ZA0250 - CLEAR SCREEN MESSAGE QUEUE         *
     C*                   ZA0240 - DISPLAY MESSAGE                    *
     C*                                                               *
     C* CALLED BY         INS - Insert processing                     *
     C*                                                               *
     C*****************************************************************
     C*
     C           VAL       BEGSR
     C/COPY WNCPYSRC,SD2400C027
     C*
     C*  Pass screen inputs to control parameters
     C                     EXSR PARMB
     C*
     C**  Clear screen message queue.
     C/COPY WNCPYSRC,SD2400C020
     C                     CALL 'ZA0250'
     C/COPY WNCPYSRC,SD2400C021
     C*                                                                   E31589
     C           PMACTC    IFNE 'I'                                                           260577
     C           PMRUND    SUB  PMBVPD    STARTD  50                      E31589
     C           CLE003    IFNE 'Y'                                       CLE003
     C           PMACTC    IFNE 'I'                                       110122
     C           PMDTPY    IFLT STARTD                                    E31589
     C           PMDTPY    ANDNE0                                         E31589
     C           WPPAY     ANDEQ'Y'                                       135356
     C                     MOVE 'Y'       PMPPAY                          E31589
     C                     END                                            E31589
     C           PMDTRC    IFLT STARTD                                    E31589
     C           PMDTRC    ANDNE0                                         E31589
     C           WPRCV     ANDEQ'Y'                                       135356
     C                     MOVE 'Y'       PMPRCV                          E31589
     C                     END                                            E31589
     C                     END                                            110122
     C                     ENDIF                                          CLE003
     C                     ENDIF                                                              260577
     C*                                                                   113832
     C* Move initialised fields into data structure to be passed as       113832
     C* @PARM2                                                            113832
     C           CLE003    IFEQ 'Y'                                       113832
     C           PMCPGM    ANDEQ'MMLD'                                    113832
     C                     MOVELCOUNT     PMCMDP                          113832
     C                     MOVE COUNT1    PMCMDP                          113832
     C                     ENDIF                                          113832
     C*                                                                   CSW005
     C           *IN10     IFEQ *ON                                       CSW005
     C                     MOVEL@PARM3    WPARM3                          CSW005
     C                     ENDIF                                          CSW005
     C*
     C*****                CALL 'SDKUUPR'              90                 S01227
     C/COPY WNCPYSRC,SD2400C038
     C                     CALL 'SD2410'               90                 S01227
     C                     PARM           @PARM1
     C                     PARM           @PARM2
     C                     PARM           WPARM3                          CSW005
     C***********          PARM COUNT     @PARM3  10                CLE003113832
     C***********          PARM COUNT1    @PARM4  10                CLE003113832
     C*                                                                   CLE003
     C***********          MOVE @PARM3    COUNT                     CLE003113832
     C***********          MOVE @PARM4    COUNT1                    CLE003113832
     C/COPY WNCPYSRC,SD2400C039
     C           CLE003    IFEQ 'Y'                                       113832
     C           PMCPGM    ANDEQ'MMLD'                                    113832
     C                     MOVELPMCMDP    COUNT                           113832
     C                     MOVE PMCMDP    COUNT1                          113832
     C                     MOVE *BLANKS   PMCMDP                          113832
     C                     ENDIF                                          113832
     C*                                                                   CSW005
     C           *IN10     IFEQ *ON                                       CSW005
     C                     MOVELWPARM3    @PARM3                          CSW005
     C                     ENDIF                                          CSW005
     C*                                                                   S01408
     C/COPY WNCPYSRC,SD2400CSF1                                           S01408
     C*                                                                   S01408
     C*                                                                   E24039
     C           *LOCK     IN   LDA                                       E24039
     C                     MOVE '0'       NOCHG1                          E24039
     C                     MOVE '0'       NOCHG2                          E24039
     C                     OUT  LDA                                       E24039
     C*                                                                   E26903
     C** Move default ordering bank/customer fields set up by SD2410      E26903
     C** onto screen. These will subsequently be written to DEALS file    E26903
     C** and thence to SWIFT message.                                     E26903
     C*                                                                   E26903
     C                     MOVELPMPOCN    #DEITX                          E26903
     C                     MOVELPMPOBN    #DEGTX                          E26903
     C                     MOVELPMROCN    #DEJTX                          E26903
     C                     MOVELPMROBN    #DEHTX                          E26903
     C*                                                                   CEU003
     C** If CEU003 is supported                                           CEU003
     C*                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C                     MOVELPMRSCY    SRSCY                           CEU003
     C                     MOVELPMPSCY    SPSCY                           CEU003
     C                     MOVELPMIC72    SIC72                           CEU003
     C                     ENDIF                                          CEU003
      *                                                                                       CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
     C           PMCPGM    ANDEQ'LEND'                                                        CLE031
     C                     MOVELPMRSCY    SRSCY                                               CLE031
     C                     MOVELPMPSCY    SPSCY                                               CLE031
     C                     MOVE PMREXR    SRRTE                                               CLE031
     C                     MOVELPMREXI    SRCEI                                               CLE031
     C                     MOVE PMPEXR    SPRTE                                               CLE031
     C                     MOVELPMPEXI    SPCEI                                               CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C/COPY WNCPYSRC,SD2400C007
     C*                                                                   066875
     C           PMPSTM    IFEQ 05                         B1             066875
      *                                                                   S01408
     C/COPY WNCPYSRC,SD2400CP13                                           S01408
      *                                                                   S01408
     C           *IN80     IFEQ '1'                        B2             066875
     C                     MOVE *BLANKS   #1DWT2           **2            066875
     C                     MOVELPMPOBR    #1DWT2           **2            066875
     C                     MOVE PMPONS    #1DWT2           **2            066875
     C                     ELSE                            X*2            066875
     C                     MOVELPMPONS    #1DWTX           **2            066875
     C                     END                             X*2            066875
     C                     END                             X*1            066875
     C*                                                                   066875
     C           PMRSTM    IFEQ 05                         B1             066875
      *                                                                   S01408
     C/COPY WNCPYSRC,SD2400CP14                                           S01408
      *                                                                   S01408
     C           *IN80     IFEQ '1'                        B2             066875
     C                     MOVE *BLANKS   #1DTT2           **2            066875
     C                     MOVELPMROBR    #1DTT2           **2            066875
     C                     MOVE PMRONS    #1DTT2           **2            066875
     C                     ELSE                            X*2            066875
     C                     MOVELPMRONS    #1DTTX           **2            066875
     C                     END                             X*2            066875
     C                     END                             X*1            066875
     C*
     C*  Call to program ended in error.
     C           *IN90     IFEQ '1'
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
     C*
     C/COPY WNCPYSRC,SD2400C006
     C                     MOVELPMRIBN    #DETTX                          E338
     C***********          MOVELPMROBN    #DEHTX                    E338  E26903
     C***********          MOVELPMROCN    #DEJTX                    E338  E26903
     C                     MOVELPMPIBN    #DEUTX                          E338
     C***********          MOVELPMPOBN    #DEGTX                    E338  E26903
     C***********          MOVELPMPOCN    #DEITX                    E338  E26903
     C                     MOVELPMRCRN    #DESTX                          E338
     C                     MOVELPMRVNO    #DEPTX                          E338
     C                     MOVELPMAWBN    #DEQTX                          E338
     C                     MOVELPMBENN    #DERTX                          E338
     C                     MOVELPMBTB1    #1D6TX                          S01297
     C                     MOVELPMBTB2    #1EBTX                          CSW096
     C                     MOVELPMBTB3    #1ECTX                          CSW096
     C                     MOVELPMBTB4    #1EDTX                          CSW096
     C                     MOVELPMBTB5    #1EETX                          CSW096
     C                     MOVELPMBTB6    #1EFTX                          CSW096
     C                     MOVELPMPIBA    #1D7TX                          S01297
     C                     MOVELPMAWBA    #1D9TX                          S01297
     C                     MOVELPMDCHG    #1C9CD                          S90237
     C                     MOVELPMBENA    #1EATX                          S01429
     C                     MOVELPMRIBA    #1DVTX                          S01429
     C* FOR SETTLEMENT TYPE 05 IT IS POSSIBLE TO HAVE ? ON BRANCH SO      LN0569
     C* BRANCH MUST BE MOVED BACK INTO FIELD TO OVERWRITE THE ?           LN0569
     C           PMPSTM    IFEQ 05                                        LN0569
      *                                                                   S01408
     C/COPY WNCPYSRC,SD2400CP15                                           S01408
      *                                                                   S01408
     C                     MOVELPMPOBR    #1DWT2                          LN0569
     C                     END                                            LN0569
     C           PMRSTM    IFEQ 05                                        LN0569
      *                                                                   S01408
     C/COPY WNCPYSRC,SD2400CP16                                           S01408
      *                                                                   S01408
     C                     MOVELPMROBR    #1DTT2                          LN0569
     C                     END                                            LN0569
     C*                                                                   108517
     C* For Settlement Types 01, 02, 07, 08 and 12 return values to       108517
     C* the screen after ? processing.                                    108517
     C*                                                                   108517
     C           PMPSTM    IFEQ 01                                        108517
     C           PMPSTM    OREQ 02                                        108517
     C           PMPSTM    OREQ 07                                        108517
     C           PMPSTM    OREQ 08                                        108517
     C           PMPSTM    OREQ 12                                        108517
     C                     MOVELPMPONS    #1DWT2                          108517
     C                     END                                            108517
     C*                                                                   108517
     C           PMRSTM    IFEQ 01                                        108517
     C           PMRSTM    OREQ 02                                        108517
     C           PMRSTM    OREQ 07                                        108517
     C           PMRSTM    OREQ 08                                        108517
     C           PMRSTM    OREQ 12                                        108517
     C                     MOVELPMRONS    #1DTT2                          108517
     C                     END                                            108517
     C*
     C*  If settlement details not valid output error message and
     C*  highlight fields in error
     C           PMSDTV    IFEQ 'N'
     C/COPY WNCPYSRC,SD2400C042
     C                     MOVEAPMERCD    UER
     C                     Z-ADD1         Z       20
     C*
     C*  DO WHILE error codes returned remain to be processed
     C           Z         DOWLT51
     C           UER,Z     ANDNE*BLANKS
     C                     MOVELUER,Z     ERR     3
     C*                                                                   S01408
     C/COPY WNCPYSRC,SD2400CVS1                                           S01408
     C*                                                                   S01408
     C                     EXSR ERROR
     C*                                                                   S01408
     C/COPY WNCPYSRC,SD2400CVS2                                           S01408
     C*                                                                   S01408
     C*
     C*  Increment index
     C                     ADD  1         Z
     C                     END
     C*
     C                     ELSE
     C*  valid
     C*
     C*                                                                   S01408
     C** Core hook for externalisation, VALIDATE COMMAND KEYS             S01408
     C/COPY WNCPYSRC,SD2400CPCK                                           S01408
     C*
     C*  Display message "Validation Complete - Press F12 to Return"
     C*
     C                     MOVEL'ESM0800' ZAMSID
     C/COPY WNCPYSRC,SD2400C022
     C                     CALL 'ZA0240'
     C                     PARM           ZAMSID
     C/COPY WNCPYSRC,SD2400C023
     C                     MOVEL*BLANK    ZAMSID
     C*
     C*                                                                   S01408
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,SD2400CVSF                                           S01408
     C*
     C                     END
     C*
     C/COPY WNCPYSRC,SD2400C015
     C                     ENDSR
     C*********************************************************************
     C*                                                               *   CEU003
     C*  SRREDF - Re-access Default Settlement Instructions           *   CEU003
     C*                                                               *   CEU003
     C*  Called By: FMT - Write Screen                                *   CEU003
     C*                                                               *   CEU003
     C*  Calls    : SSIA - Obtain Customer Number for chaining to SSI *   CEU003
     C*                  File                                         *   CEU003
     C*             SSIB - Retrieve Rec Settlement Instructions for   *   CEU003
     C*                  Prime Currency                               *   CEU003
     C*             VAL - Validate Screen Input                       *   CEU003
     C*                                                               *   CEU003
     C*****************************************************************   CEU003
     C           SRREDF    BEGSR                                          CEU003
     C*                                                                   CEU003
     C                     EXSR RTV                                       141734
     C*                                                                   CEU003
     C           SPSCY     IFNE *BLANKS                                   CEU003
     C                     MOVELSPSCY     WSTCY                           CEU003
     C                     ELSE                                           CEU003
     C                     MOVELPMPCCY    WSTCY                           CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     EXSR SSIA                                      CEU003
     C*                                                                   CEU003
     C           SRSCY     IFNE *BLANKS                                   CEU003
     C                     MOVELSRSCY     WSTCY                           CEU003
     C                     ELSE                                           CEU003
     C                     MOVELPMRCCY    WSTCY                           CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     EXSR SSIB                                      CEU003
     C*                                                                   CEU003
     C                     EXSR CONV                                      133866
      *                                                                   133866
     C                     EXSR VAL                                       CEU003
     C*                                                                   CEU003
     C                     ENDSR                                          CEU003
     C********************************************************************CEU003
      /EJECT
     C*                                                                   S01408
     C/COPY WNCPYSRC,SD2400CCP3                                           S01408
     C*                                                                   S01408
      /EJECT
     C*****************************************************************
     C*CSW200 - ADDED 414, 415 & 416                                      CSW200
     C*CSW097 - ADDED 407, 408, 409                                       CSW097
     C*S01227 - ADDED 920 54 & 961 54
     C*S01227 - AMENDED 935 44 TO 935 32
     C*S01227 - AMENDED 892 49  TO 892 555657585960
     C*S01227 - AMENDED 895 40  TO 895 555657585960
     C*E22405 - ADDED 889 61 & 890 61                                     E22405
     C*S01297 - ADDED 700-705
     C*LN0798 - ADD 699
     C*LN0798 - ADD 879 CHANGE 919
     C*S90237 - ADD 750 54
     C*E26903 - ADDS 803 36 & 804 37                                      E26903
     C*S01412 - Add 153                                                   S01412
     C*060036 - Add 200 201 202 203 & 204                                 060036
     C*CEU003 - Add 850 851 853 854 855 856 857 858                       CEU003
     C*             847 848 849 862                                       CEU003
     C*CLE003 - ADD 805 33 806 34                                         CLE003
     C*
     C/COPY WNCPYSRC,SD2400OOPG                                           S01408
     C*
     O/COPY WNCPYSRC,SD2400OOP1                                           S01408
** Array contains Error message ID & associated indicators
200 44                                                                    060036
201 41                                                                    060036
202 45                                                                    060036
203 47                                                                    060036
204 49                                                                    060036
699 3638
700 43
701 47
702 3739
703 46
704 43
705 46
879 36
750 54
889 61
890 61
891 555657585960
892 555657585960
893 555657585960
894 555657585960
895 555657585960
958 40
962 43
963 43
964 43
965 45
966 45
967 45
968 45
969 45
970 46
971 46
972 46
973 46
974 47
975 47
976 47                                                                    CSW095
977 47
978 48
980 48
981 49
982 49
983 49
984 49
985 49
986 54
987 50515253
988 555657585960
989 555657585960
990 555657585960
993 555657585960
994 555657585960
995 555657585960
997 555657585960
998 555657585960
999 49
895 555657585960
896 44
897 555657585960
898 43
899 41
900 31
901 31
902 31
903 31
904 31
905 31
906 31
907 33
908 33
909 33
910 33
911 33
912 33
913 33
914 33
915 36
917 38
918 38
919 3638
920 54
921 38
922 42
923 42
924 44
925 44
926 42
927 44
928 44
929 32
930 32
931 32
932 44
933 32
934 32
935 32
936 32
937 34
938 34
939 34
940 34
941 34
942 34
943 34
944 34
945 37
946 37
947 39
948 39
949 39
950 39
951 39
952 35
953 35
954 35
955 35
956 40
957 40
959 40
960 41
961 54
881 34                                                                    S01117
882 34                                                                    S01117
883 34                                                                    S01117
884 33                                                                    S01117
885 33                                                                    S01117
886 33                                                                    S01117
887 34                                                                    S01117
888 33                                                                    S01117
889 34                                                                    S01117
890 33                                                                    S01117
803 36                                                                    E26903
804 37                                                                    E26903
991 31                                                                    E45796
992 32                                                                    E45796
153 555657585960
979 43                                                                    082386
847 0811                                                                  CEU003
848 11                                                                    CEU003
849 14                                                                    CEU003
850 08                                                                    CEU003
851 08                                                                    CEU003
853 11                                                                    CEU003
854 11                                                                    CEU003
855 14                                                                    CEU003
856 14                                                                    CEU003
857 14                                                                    CEU003
858 14                                                                    CEU003
862 08                                                                    CEU003
400 74                                                                    CSW005
401 84                                                                    CSW005
402 85                                                                    CSW005
403 85                                                                    CSW005
404 88                                                                    CSW005
405 88                                                                    CSW005
406 83                                                                    CSW005
407 83                                                                    CSW097
408 83                                                                    CSW097
409 84                                                                    CSW097
X01 286263646667                                                          CSW005
X02 686970717273                                                          CSW005
X03 747576778182                                                          CSW005
X04 74                                                                    CSW005
805 33                                                                    CLE003
806 34                                                                    CLE003
414 83
415 85
416 88
300                                                                       CDL008
301 33                                                                    CDL008
302 34                                                                    CDL008
303 31                                                                    CDL008
304 32                                                                    CDL008
305 33                                                                    CDL008
306 34                                                                    CDL008
996 54                                                                                        219241
801 08                                                                                        CLE031
802 08                                                                                        CLE031
808 11                                                                                        CLE031
809 11                                                                                        CLE031
810 08                                                                                        CLE031
811 11                                                                                        CLE031
812 08                                                                                        CLE031
813 11                                                                                        CLE031
814 08                                                                                        CLE031
815 11                                                                                        CLE031
865 08                                                                                        CLE031
866 11                                                                                        CLE031
878 08                                                                                        CLE031
880 11                                                                                        CLE031
748 08                                                                                        CLE031
749 11                                                                                        CLE031
     X/COPY WNCPYSRC,SD2400X002
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
     X/COPY WNCPYSRC,SD2400X001
