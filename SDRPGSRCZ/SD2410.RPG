     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas SD Settlement details validation')               *
     F*****************************************************************
     F*                                                               *
     F*  Midas Standing Data Module                                   *
     F*                                                               *
     F*     This program will be made redundant at DBA R4.00          *
     F*     In the interim please check the new ILE RPG versions      *
     F*     and apply any new fixes if they are appropriate.          *
     F*                                                               *
     F*  SD2410 - Settlement Details Validation                       *
     F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
      *                                                               *
      *  Last Amend No. MD030943           Date 25Nov14               *
      *  Prev Amend No. MD030342           Date 25Nov14               *
      *                 CSW214             Date 25Nov14               *
      *                 CDL094             Date 01Sep14               *
      *                 254023             Date 19Aug14               *
      *                 MD026990           Date 20May14               *
      *                 MD022522           Date 02Oct13               *
      *                 CSW213             Date 03Jun13               *
      *                 CMG003             Date 04Oct12               *
      *                 AR853732           Date 29Oct12               *
      *                 AR995086           Date 26Jun12               *
      *                 AR992011           Date 19Jun12               *
      *                 CSW212             Date 03May12               *
      *                 CRE075             Date 06Dec10               *
      *                 CER059             Date 19Jul10               *
      *                 CER047             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 260577             Date 04Jun09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 246415             Date 14Mar07               *
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 240971             Date 19Oct06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 BUG7139            Date 12May05               *
      *                 CSW037A            Date 02May05               *
      *                 BUG6198            Date 04Apr05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 TDA088             Date 28Mar04               *
      *                 CGL029             Date 01Sep03               *
      *                 222373             Date 24Oct03               *
      *                 221891             Date 10Oct03               *
      *                 219495             Date 08Jul03               *
      *                 218782             Date 20Jun03               *
      *                 218906             Date 18Jun03               *
      *                 221452             Date 27May03               *
      *                 CLE033             Date 20Mar03               *
      *                 CLE031             Date 11Feb03               *
      *                 214110             Date 19Feb03               *
      *                 219241             Date 01Jul03               *
      *                 CSW203             Date 26May03               *
      * Midas Release 4.01.01 ----------------------------------------*
      *                 CSW202             Date 20May02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 181340             Date 16Aug01               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 CSW201             Date 02May01               *
      *                 191152             Date 16Jul01               *
      *                 193584             Date 08Jun01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 162959             Date 18Feb01               *
      *                 178889             Date 13Feb01               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 186433             Date 20Nov00               *
      *                 108195             Date 31Oct00               *
      *                 CDL008             Date 02May00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 CSW200             Date 21Aug00               *
      *                 141865             Date 23Nov99               *
      * Midas DBA 3.02 -----------------------------------------------*
     F*                 CSW097             Date 02DEC99               *
     F*                 169210             DATE 14Oct99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*                 157861             Date 31Mar99               *
     F*                 158192 (BD5288)    DATE 29Mar99               *
      *                 149200             Date 11Dec98               *
      *                 142408             Date 02Oct98               *
      *                 134496             Date 19Jan99               *
     F*                 139921             Date 05OCT98               *
     F*                 137488             Date 02Jul98               *
     F*                 137252             Date 17Jun98               *
     F*                 135303             Date 15May98               *
     F*                 134935             Date 10May98               *
     F*                 CEU003             Date 29Mar98               *
     F*                 108752             DATE 23FEB98               *
     F*                 117870             DATE 20FEB98               *
     F*                 108517             DATE 17FEB98               *
     F*                 118948             DATE 27JAN98               *
     F*                 100757             DATE 23JAN98               *
     F*                 110514             DATE 08JAN98               *
     F*                 099441             DATE 12APR96               *
     F*                 113832             DATE 05FEB97               *
     F*                 CLE003             DATE 20DEC96               *
     F*                 CSW011             DATE 21MAR97               *
     F*                 CSW005             DATE 01AUG96               *
     F*                 101041             DATE 05MAR97               *
     F*                 093565             DATE 01AUG96               *
     F*                 CSW096             DATE 18JUN96               *
     F*                 S01408             DATE 29MAY96               *
     F*                 082376             DATE 22APR96               *
     F*                 082386             DATE 22APR96               *
     F*                 088364             DATE 22APR96               *
     F*                 S01408             DATE 12APR96               *
     F*                 S01408             DATE 06MAR96               *
     F*                 070083             DATE 26FEB96               *
     F*                 S01408             DATE 24JAN96               *
     F*                 096151             DATE 17NOV95               *
     F*                 S01408             DATE 18AUG95               *
     F*                 094100             DATE 04OCT95               *
     F*                 092396             DATE 23AUG95               *
     F*                 CSW095             DATE 20APR95               *
     F*                 S01408             DATE 20JUL95               *
     F*                 S01408             DATE 10MAY95               *
     F*                 S01408             DATE 19AUG94               *
     F*                 S01408             DATE 17MAY94               *
     F*                 060036             DATE 06APR94               *
     F*                 066875             DATE 15MAR94               *
     F*                 060470             DATE 16NOV93               *
     F*                 056847             DATE 29SEP93               *
     F*                 056626             DATE 29SEP93               *
     F*                 058132             DATE 29SEP93               *
     F*                 S01429             DATE 13JUL93               *
     F*                 056873             DATE 01JUL93               *
     F*                 043712             DATE 28JUN93               *
     F*                 052290             DATE 22JUN93               *
     F*                 S01412             DATE 05MAY93               *
     F*                 033351             DATE 20APR93               *
     F*                 E24104             DATE 14APR93               *
     F*                 E45796             DATE 29MAR93               *
     F*                 E30756             DATE 13JAN93               *
     F*                 E26903             DATE 13JAN93               *
     F*                 E31261             DATE 09DEC92               *
     F*                 E31589             DATE 29NOV92               *
     F*                 035701             DATE 27MAY92               *
     F*                 E28710             DATE 11MAR92               *
     F*                 DT0069             DATE 07MAY91               *
     F*                 E26771             DATE 20AUG91               *
     F*                 E24039             DATE 16AUG91               *
     F*                 E26971             DATE 06AUG91               *
     F*                 BHF908             DATE 14NOV90               *
     F*                 BHF810             DATE 11OCT90               *
     F*                 BHF766             DATE 05OCT90               *
     F*                 DT0168             DATE 15MAY91               *
     F*                 BHF764             DATE 04OCT90               *
     F*                 BHF758             DATE 03OCT90               *
     F*                 BHF759             DATE 03OCT90               *
     F*                 LN0830             DATE 03OCT90               *
     F*                 LN0806             DATE 27SEP90               *
     F*                 LN0798             DATE 27SEP90               *
     F*                 LN0787             DATE 21SEP90               *
     F*                 LN0785             DATE 19SEP90               *
     F*                 BHF647             DATE 19SEP90               *
     F*                 LN0783             DATE 19SEP90               *
     F*                 LN0782             DATE 19SEP90               *
     F*                 LN0765             DATE 17SEP90               *
     F*                 LN0759             DATE 14SEP90               *
     F*                 LN0749             DATE 13SEP90               *
     F*                 LN0748             DATE 13SEP90               *
     F*                 BHF352             DATE 11SEP90               *
     F*                 BHF564             DATE 06SEP90               *
     F*                 BHF596             DATE 06SEP90               *
     F*                 BHF595             DATE 06SEP90               *
     F*                 BHF585             DATE 05SEP90               *
     F*                 BHF572             DATE 05SEP90               *
     F*                 BHF582             DATE 03SEP90               *
     F*                 BHF569             DATE 03SEP90               *
     F*                 BHF553             DATE 02SEP90               *
     F*                 BHF552             DATE 02SEP90               *
     F*                 BHF547             DATE 02SEP90               *
     F*                 BHF465             DATE 31AUG90               *
     F*                 BHF519             DATE 31AUG90               *
     F*                 BHF517             DATE 31AUG90               *
     F*                 BHF506             DATE 30AUG90               *
     F*                 BHF504             DATE 30AUG90               *
     F*                 BHF503             DATE 29AUG90               *
     F*                 LN0691             DATE 26AUG90               *
     F*                 LN0657             DATE 22AUG90               *
     F*                 S01297             DATE 20AUG90               *
     F*                 E22405             DATE 16AUG90               *
     F*                 E22614             DATE 01AUG90               *
     F*                 E21702             DATE 01AUG90               *
     F*                 E21860             DATE 17JUL90               *
     F*                 LN0455             DATE 02JUL90               *
     F*                 S01117             DATE 21JUN90               *
     F*                 S01117             DATE 15JUN90               *
     F*                 S01117             DATE 07JUN90               *
     F*                 S01117             DATE 05JUN90               *
     F*                 S01117             DATE 01JUN90               *
     F*                 S01117             DATE 31MAY90               *
     F*                 S01117             DATE 30MAY90               *
     F*                 S01117             DATE 17APR90               *
     F*                 S01117             DATE 06APR90               *
     F*                 S01227             DATE 06NOV89               *
     F*                 E83                DATE 20NOV89               *
     F*                 E00033             DATE 07NOV89               *
     F*                 S01117             DATE 13/06/89              *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  MD030943 - Duplicate error message for Agreement Type        *
      *  MD030342 - Valid values for Agreement Type for FX and AT     *
      *             transaction types for MT600                       *
      *  CSW214 - SWIFT Changes 2014                                  *
      *  CDL094 - Enhance  Receive Settlement Instructions            *
      *  254023 - Wrong error code being passed to SD0402R for ISDA.  *
      *           EXSS - ISDA cannot be input as 2006.                *
      *  MD026990 - ISDA fields should not be mandatory when CSW005   *
      *             is switched off                                   *
      *  MD022522 - Invalid bank to Bank field. First character of    *
      *             bank to bank field must be a / followed by a      *
      *             valid codeword                                    *
      *  CSW213 - SWIFT Changes 2013                                  *
      *  CMG003 - SWIFT MT600 Message Generation                      *
      *  AR853732 - Retail account with 11 digits was accepted w/out  *
      *             errors. Additional checking on positions 11-18 of *
      *             received parameter. (Child: AR853733)             *
      *  AR995086 - Agreement types validation not executed           *
      *  AR992011 - Error in AOCREPT program                          *
      *  CSW212 - SWIFT 2012 Changes                                  *
      *  CRE075 - Effective Date for Retail Accounts (Recompile)      *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER047 - German Features LF037-00 Reporting §24c KWG         *
      *           (Recompile)                                         *
      *  260577 - Unable to amend loan Maturity Date via API (MQU).   *
      *           Applied R4 fix 120800 not to validate settlement    *
      *           when pay/receive flag is protected.                 *
      *  246415 - Correct validation of 'Details fo Charges'.         *
      *           Adapt BUG4511 from ZASETINVAL.                      *
      *  240971 - For settlement 04, do not check values of RECI      *
      *           and ACST when subroutine CHKAC is not called.       *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  BUG7139- SSI type DV should be same validation as RS/RX.     *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  BUG6198- Cannot save new Details for CUSD (Recompile)        *
      *  CSD025 - RS or RX De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  TDA088 - Amend to allow input of 10-digit retail account     *
      *           number as valid settlement account.                 *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  222373 - Parameter mismatch.                                 *
      *  221891 - Amendment to CLE033. Do not default exchange rates  *
      *           if settling through 09.                             *
      *  219495 - Amendment to CLE031. Do not validate Settlement Ccy *
      *           Dealing Ind. if settlement details are protected.   *
      *  218782 - Check system value Settlement09Postings to decide   *
      *           whether to use Settlement or Transaction Ccy.       *
      *  218906 - If this program has been called from the Extended   *
      *           Settlements Maintenance screen for Method 09, don't *
      *           validate, as branch code is unavailable.            *
      *  221452 - If CLE033 is on and Swift for Lending is not on     *
      *           then allow free format info in the Swift fields     *
      *           for settlement method 09                            *
      *  CLE033 - Settlement method 09 - Set up of currency for       *
      *           receive method 09 incorrect                         *
      *  CLE033 - Settlement method 09                                *
      *  CLE031 - Lending Enhancements                                *
      *  214110 - Allow 'SHA' code on details of charges field and    *
      *           ensure that allowed values are validated correctly. *
      *  219241 - Defaulting of "Details of Charges" assign a         *
      *           system value                                        *
      *  CSW203 - SWIFT 2003 Standards Update                         *
      *  CSW202 - SWIFT 2002 Standards Update                         *
      *  181340 - If Nostro was inserted on field 57, no validation   *
      *           exist for ESM0971 (acct w/ bank must be SWIFT       *
      *           financial institution).  Add validation.            *
      *  CSW201 - SWIFT 2001 Standards Update                         *
      *  191152 - Check the receipt and pay accounts (if both exist)  *
      *           if both are converted to EURO before the settlement *
      *           currency can be successfully amended to 'EUR'.      *
      *  193584 - When the nostro is a CLS Dummy nostro,              *
      *           entry should not be allowed in :                    *
      *           the Account detail line for fields 56 and 57.       *
      *  162959 - Error message "Beneficiary invalid - see second     *
      *           level text" shown when no beneficiary has been      *
      *           entered. No error message should show if the        *
      *           beneficiary field is left blank.                    *
      *  178889 - Pay side of the FX deal should check if the retail  *
      *           account is active on the system.                    *
     F*  186433 - Missing code from CDL008.                           *
      *  108195 - If an account is closed it should not be a valid    *
      *           settlement account.                                 *
      *  CDL008 - Continuous Linked Settlement                        *
     F*  CSW200 - Swift 2000 Changes                                  *
     F*  141865 - Extend 139921 to include settlement type '04'       *
     F*  CSW097 - Allow ISDA fields for FR type transactions          *
     F*  169210 - Requested hooks are duplicates                      *
     F*           Renamed SD2410C049 to SD2410CX49                    *
     F*           Renamed SD2410C054 to SD2410CX54                    *
      *  157861 - Should not default an ordering customer that is a   *
      *           bank if beneficiary is non bank                     *
     F*  BD5288 - If CHIPS settlement and pay side is protected       *
     F*           then do not validate the payment fields as you      *
     F*           cannot amend them anyway.                           *
      *  149200 - Incorrect nostro error rejects fee                  *
      *  142408 - Should be able to make the beneficiary a bank on    *
      *           part sold.                                          *
      *  134496 - Should not have to input 50 if beneficiary is bank  *
     F*  139921 - Mesg  ESM0886 output in error because field PMROBR  *
     F*           is not blank for settlement other than '05' - field *
     F*           is set up on valid'n, then get error on subsequent  *
     F*           validation as field has data. Fix is to blank PMROBR*
     F*           for settlement types other than '05' and allow field*
     F*           to be set up with the correct branch code, as       *
     F*           happens on first validation run.                    *
     F*           Same applied to Pay Branch PMPOBR.                  *
     F*           Applied associated fix GEMS #136559 .               *
     F*  137488 - Fix on extended settlement instructions. If a       *
     F*           retail a/c is entered, the re a/c ccy is validated  *
     F*           against the settlement currency, whereas it should  *
     F*           be the main currency code.                          *
     F*  137252 - Euro incorporation - beneficiary details not being  *
     F*           defaulted correctly first time in.                  *
     F*  135303 - Deals cannot be authorised due to errors in         *
     F*           settlement details.                                 *
     F*  134935 - Settlement currency not shown/amendable if          *
     F*           transition starts before value date                 *
     F*  CEU003 - EMU Dealing Settlement Ccy Conversion               *
     F*  108752 - ERROR MESSAGE SHOULD ONLY SHOW WHEN LIVE NOSTRO     *
     F*           IS NOT FOUND.                                       *
     F*  117870 - APPLY FIX 110122                                    *
     F*         - VALIDATION BYPASSED IN INSERT MODE                  *
     F*         - BACK VALUE PERIOD AND DATE ACCOUNT OPENED NOT       *
     F*           CHECKED FOR SETTLEMENT METHOD 4                     *
     F*         - Partially apllied by 100757 .                       *
     F*  108517 - Allow '?' processing in 'Receipts' and 'Payments' - *
     F*           'Our Nostro'.                                       *
     F*  118948 - Validate settlement details even if the deal is     *
     F*           back-valued. Errors on accounting have been found   *
     F*           to be caused by skipping this routine.              *
     F*  100757 - If the settlement method is 04, the payment date    *
     F*           still has to be checked if it is less than the      *
     F*           date the retail account was opened.  If it is,      *
     F*           then a corresponding error message should be        *
     F*           generated.                                          *
     F*  110514 - Remove fix 070083 so Account With Bank can be input *
     F*           if it is same as Beneficiary Bank - this is allowed *
     F*           by SWIFT standards.                                 *
     F*  099441 - Replace bank/non-bank flag with financial           *
     F*           institution flag.                                   *
     F*  113832 - Fix parameter miss match when extended settements   *
     F*           is  called.                                         *
     F*  CLE003 - Backvaluation in Customer Lending Enhancements      *
      *  CSW011 - FRA MT34n only Message Generation                   *
     F*  CSW005 - FRAIRS MT34n, MT36n Message Generation              *
     F*  101041 - Do not allow defaulting of field 52 when            *
     F*           it has an original value. Defaulting should only    *
     F*           work when it is blank.                              *
     F*  093565 - Allow user to generate MT202 for counterparty cust  *
     F*           being a private customer. Do no default Ordering    *
     F*           customer if Ordering bank entered                   *
     F*  CSW096 - SWIFT November 96 Changes                           *
     F*           Externalise Currency Clearing Validation            *
     F*  S01408 - Core hook SD2410CP20 added                          *
     F*  082376 - Correct output of error messages.                   *
     F*  082386 - Allows entry of field 56 (Intermediary Bank)        *
     F*           without a value being entered into field 57         *
     F*           (Account With Bank)                                 *
     F*  088364 - Not printing error message on payment settlement    *
     F*  S01408 - Core hook SD2410CP18 added                          *
     F*           Core hook SD2410CP19 added                          *
     F*  S01408 - Core hook SD2410CP16 added                          *
     F*           Core hook SD2410CP17 added                          *
     F*  070083 - Remove NY fix LN0749 as it is not appropriate here. *
     F*  S01408 - Core hook SD2410CP14 added                          *
     F*           Core hook SD2410CP15 added                          *
     F*  096151 - S.W.I.F.T 1995 has been enforced.    Do not         *
     F*           allow bank to bank information to start with "//"   *
     F*           and to be followed by all blank.                    *
     F*           This is the Lux version of the fix which replaces   *
     F*           092396 (for source LE0120 and SD2410 only)          *
     F*  S01408 - Core hook SD2410CP13 added                          *
     F*  094100 - SWIFT have changed their minds and the Swiss        *
     F*           SIC Clearing code is 5 not 6 characters long.       *
     F*  092396 - Sender to Receiver cannot contain '//' followed     *
     F*           by blanks.                                          *
     F*  CSW095 - S.W.I.F.T 1995 Message Changes.                     *
     F*           Add Swiss Clearing system code '//SWnnnnnn'.        *
     F*  S01408 - Core hook SD2410CVS3 added                          *
     F*           Core hook SD2410CVS4 added                          *
     F*           Core hook SD2410ADTA added                          *
     F*  S01408 - Core hook SD2410CCPG added                          *
     F*           Core hook SD2410CVS1 added                          *
     F*           Core hook SD2410CVS2 added                          *
     F*           Core hook SD2410FFPG added                          *
     F*           Core hook SD2410IIPG added                          *
     F*           Core hook SD2410CCP3 added                          *
     F*           Core hook SD2410CCP4 added                          *
     F*           Core hook SD2410CCP5 added                          *
     F*           Core hook SD2410CCP6 added                          *
     F*           Core hook SD2410CCP7 added                          *
     F*           Core hook SD2410CCP8 added                          *
     F*           Core hook SD2410CCP9 added                          *
     F*           Core hook SD2410CP10 added                          *
     F*           Core hook SD2410CEND added                          *
     F*           Core hook SD2410CP11 added                          *
     F*           Core hook SD2410CP12 added                          *
     F*  S01408 - Core hook SD2410CCP1 added                          *
     F*           Core hook SD2410CCP2 added                          *
     F*  S01408 - Core hook SD2410CVSF added                          *
     F*  060036 - No validation check for incorrect account line,     *
     F*           e.g. '/A/C' or A/C after the account number slash   *
     F*           has been entered.  Validate a/c no. line starting   *
     F*           with /n/, where n can only be 'C' or 'D'.           *
     F*  066875 - For Settlement Type '05', after validation of the   *
     F*           settlement account, move this account no to the     *
     F*           field as the system will have defaulted the account *
     F*           seq. number if this was blank/zero - this ensures   *
     F*           that the correct account is written to the file.    *
     F*  060470 - For settlement method 14 (retail accounts),         *
     F*           program should check if account has already         *
     F*           been closed (Account Status ACST is 'C').           *
     F*           The same checking should also be done for           *
     F*           settlement methods 04 and 05.                       *
     F*           (Please note that part of this fix was already      *
     F*           applied by 056626 for settl method '05'.            *
     F*  056847 - Allow input of sort code //CH in field 56 account   *
     F*           line. Also, add codes not applied by fix 056873 in  *
     F*           allowing //SC in field 56 account line.             *
     F*  056626 - If settlement method is '05' system should not      *
     F*           accept closed retail account.                       *
     F*  058132 - Branch Code for Account compared against incorrect  *
     F*           data item when checking for Single Branch Code      *
     F*  S01429 - Chips ABA number modification from 3A to 4A         *
     F*           for Chips II. Also do not allow 0000 ABA numbers.   *
     F*  056873 - To allow intermediary bank to be the same as        *
     F*           our nostro and to allow '//SC' in intermediary      *
     F*           bank a/c line                                       *
     F*  043712 - Deal amendment not using relevant settlement        *
     F*           instructions.                                       *
     F*  052290 - For a deposit , do not validate the opening date    *
     F*           of account against maturity date                    *
     F*  S01412 - SWIFT September '93 Message Changes.                *
     F*           Field :56a: on an MT100 can now use option D,       *
     F*           ie. it is no longer essential for Intermediary      *
     F*           to have a SWIFT address in cases where an MT100     *
     F*           is to be produced. This change makes the /IBK/      *
     F*           codeword in field :72: unnecessary.                 *
     F*            o Remove validation which checks for intermediary  *
     F*              SWIFT address if beneficiary is a non-bank       *
     F*            o Remove processing for /IBK/ codeword             *
     F*            o Add validation to check lines begin '//'         *
     F*              if they do not begin with /8a/                   *
     F*  033351 - ENTRY IN FLD72 SHOULD BE ALLOWED FOR ALL SET        *
     F*           EXCEPT 00.                                          *
     F*  E24104 - Settlements can pass entries on accounts that do    *
     F*           not exist.                                          *
     F*  E45796 - If Settlement Method 14 (Retail Account) is used    *
     F*           and Account is blocked, no warning is given.        *
     F*  E30756 - SWIFT does not require the ordering bank field      *
     F*           to have any information in for pay messages         *
     F*           (MT202/3). Amended program to remove defaulting     *
     F*           to beneficiary for pays.                            *
     F*  E26903 - The ordering customer/bank on settlement            *
     F*           instructions should default (as applicable) to      *
     F*           counterparty if left blank. Data passed back        *
     F*           to SD2400. Also check that ordering customer        *
     F*           is a non-bank - Two new error codes added: 803      *
     F*           & 804.                                              *
     F*  E31261 - Pgm doesn't accept that intermediary bank name      *
     F*           is same as account with bank                        *
     F*  E31589 - Do not validate date of receipt if input fields     *
     F*           were protected.                                     *
     F*  035701 - Correction to E24039 . Validates Pay side when      *
     F*           Receive side changed.                               *
     F*  E28710 - CPBNBI retains data thus invalid error message      *
     F*           flags during authorization. So, fix is done to      *
     F*           reset the default bank indicator (CPBNBI).          *
     F*  DT0069 - Dealing Release 10 System Test error fix:           *
     F*           if 'Account With' is left blank, the system         *
     F*           currently assumes, on confirmations, that the       *
     F*           account is with the nostro; this is not             *
     F*           necessarily so; this program has therefore been     *
     F*           changed to allow the input of a Nostro Number       *
     F*           into 'Account With'; the message generation         *
     F*           programs can then assume 'UNKNOWN' when Account     *
     F*           With is blank.                                      *
     F*  E26771 - INTERMEDIARY, ACCOUNT WITH, AND BENEFICIARY         *
     F*           can be counterparty nostros for settlement          *
     F*           method 08 ie part reversal of BHF810                *
     F*  E24039 - Does not allow amendment of maturity side of        *
     F*           EXTENDED SETTLEMENTS if deal valued before the      *
     F*           back valued period                                  *
     F*  E26971 - If the Beneficiary field is not entered, it         *
     F*           should default to the same value as the             *
     F*           counterparty of the deal.  At present this          *
     F*           happens for Settlement Type 08, but not for 01.     *
     F*  DT0168 - Error on PMPOBR validation                          *
     F*  BHF908 - To restrict to backvalue period to retail accts     *
     F*  BHF810 - PAY SIDE - for settlement methods 07 AND 08         *
     F*           INTERMEDIARY, ACCOUNT WITH, AND BENEFICIARY         *
     F*           can not be counterparty nostros.                    *
     F*  BHF766 - On pay side: If COUNTERPARTY = BENEFICIARY & is     *
     F*           a bank, no default should occur on field 52         *
     F*  BHF764 - Deal counterparty must be a bank for defaulting     *
     F*           field 72 to /INS/.                                  *
     F*  BHF758 - Always validate defaulting when '07'                *
     F*  BHF759 - If settl.method '07' beneficiary is mandatory       *
     F*  LN0830 - Validation errors occur if settlement method        *
     F*           is changed                                          *
     F*  LN0806 - Condition receive side defaulting on receive        *
     F*           side defaulting indicator being 'Y' (SETTLEMENT     *
     F*           METHOD 01).                                         *
     F*  LN0798 - Either ordering customer or ordering branch         *
     F*           must be entered for SETTLEMENT TYPE 01 OR 08        *
     F*           on the receive side.                                *
     F*  LN0787 - Mandatory insertion of ordering customer should     *
     F*           be conditioned properly, also allow defaulting      *
     F*              on ammend.                                       *
     F*  LN0785 - correct error codes.                                *
     F*  BHF647 - fed A/C NO. not mandatory on 'A/C WITH BANK'        *
     F*           line - //FW is sufficient.                          *
     F*  LN0783 - fix to BHF582. validate beneficiary if entered.     *
     F*  LN0782 - If either beneficiary or deal c/party is a          *
     F*           non bank default field 50 should default to the     *
     F*           deal c/party (pay side)                             *
     F*  LN0765 - fix to BHF595.                                      *
     F*  LN0759 - ammend BHF564 to check error array index at         *
     F*           correct point within the program.                   *
     F*  LN0749 - Do not display an error message if the              *
     F*           beneficiary is equal to the 'ACCOUNT WITH' bank     *
     F*  LN0748 - Remove conditioning requiring beneficiary and       *
     F*           deal counterparty to be  non banks for field        *
     F*           50 defaulting.                                      *
     F*  BHF352 - Allow settlement type 14 if 'CI'.                   *
     F*  BHF564 - Redefault if an error is made on the first          *
     F*           enter.                                              *
     F*  BHF596 - Do not default bank to bank information if          *
     F*           interbranch settlement via chips.                   *
     F*  BHF595 - Validate beneficiary if settlement method 01        *
     F*  BHF585 - If deal c/party is a non bank then field 50         *
     F*           should default to the deal c/party.                 *
     F*  BHF572 - Chain to customer file to access bank/non           *
     F*           bank indicator.                                     *
     F*  BHF582 - Beneficiary not mandatory for settlement            *
     F*           method 01                                           *
     F*  BHF569 - Interbranch settlement - default field 52 to        *
     F*           BICN of booking branch.                             *
     F*  BHF553 - Do not default ordering customer if ordering        *
     F*           bank is non blank (and vice versa).                 *
     F*  BHF552 - No need to check whether the receiving bank         *
     F*           has a valid CHIPS ABA.- requested by LINDA          *
     F*           BALLANCE - BHF NEW YORK 02/09/90                    *
     F*  BHF547 - USE RECEIVE SIDE SETTLEMENT INSTRUCTIONS FOR        *
     F*           CONDITIONING RECEIVE SIDE DEFAULTING.               *
     F*  BHF465 - ADD RECEIVE SIDE DEFAULTING                         *
     F*  BHF519 - NO ERROR MESSAGE REQUIRED IF FIELD 50 AND 52        *
     F*           ARE BLANK - SETTLEMENT METHOD 07 : CHIPS            *
     F*  BHF517 - DEFAULT ONLY FOR SETTLEMENT TYPE 08                 *
     F*  BHF506 - DEFAULT FIELD 72 TO CUSTOMER NAME & TOWN, NOT       *
     F*           BENEFICIARY                                         *
     F*  BHF504 - CHECK CORRECT FIELD - FIELD 57                      *
     F*  BHF503 - CHANGE CONDITIONING - FIELDS 56 AND 57              *
     F*  LN0691 - CHANGE LENGTH OF CHECK FIELD TO 4                   *
     F*           CHECKING AGAINST WRONG FIELD                        *
     F*  LN0657 - ONLY CHECK IF RECIPIENT IS A BANK IF IT IS          *
     F*           NON-BLANK                                           *
     F*  S01297 - RELEASE 10 EXTENDED SETTLEMENTS CHANGES             *
     F*         - ADDING DEFAULTING                                   *
     F*  E22405 - ALLOW COVER MT202 TO BE GENERATED FOR AN MT202      *
     F*  E22614 - RECIPIENT OF PAYMENT INSTRUCTIONS MUST BE A         *
     F*           BANK.                                               *
     F*  E21702 - IF SETTLEMENT METHOD IS 03, ALLOW 'OUR NOSTRO'      *
     F*           TO BE EITHER BLANK OR A SIX-DIGIT NUMBER (DEAL      *
     F*           TO COMPENSATE AGAINST) - REMOVE VALIDATION FOR      *
     F*           CUSTOMER NUMBER.                                    *
     F*           (ALSO MAKE APPROPRIATE CHANGES TO ERROR MESSAGES    *
     F*           USR3395 AND USR0570 - CORRESPONDING TO ERROR        *
     F*           CODES 909 AND 939 RESPECTIVELY).                    *
     F*  E21860 - THE ERROR CODES 950 AND 921 ARE NOT VALID           *
     F*           SINCE THE ORDERING CUSTOMER AND ORDERING BANK       *
     F*           SHOULD BE OPTIONAL                                  *
     F*  LN0455 - INTERMEDIARY BANK (RECEIPT) VALIDATED USING         *
     F*           PMRIBN INSTEAD OF PARIBN.                           *
     F*  S01117 - BLANK OUT DATA STRUCTURES AND WORK FIELD @OBR.      *
     F*  S01117 - //FW FOLLOWED BY NINE DIGITS ENTERED BY USER        *
     F*           WHEN CURRENCY IS USD, NOT CHECKED CORRECTLY.        *
     F*           FIELDS WHICH CAN TAKE CUSTOMER OR C/PARTY           *
     F*           NOSTRO NEED TO BE BLANKED OUT BEFORE VALUE          *
     F*           SELECTED PASSED IN.                                 *
     F*  S01117 - REMOVE ERROR FIX E00033 AS INCORRECT.               *
     F*  S01117 - ENSURE WARNING MESSAGE FOR SETTLEMENT METHOD 04     *
     F*           IS ONLY SENT ONCE.                                  *
     F*           BRANCH VALIDATION MOVED AS PREVIOUSLY INSERTED      *
     F*           IN INCORRECT PLACE.                                 *
     F*  S01117 - CHECK BICN OF NOSTRO BRANCH.                        *
     F*  S01117 - CHECK FIELDS FOR DUPLICATE VALUES.                  *
     F*           RECIPIENT'S CORRESPONDENT VALIDATION.               *
     F*  S01117 - NEW ERROR MESSAGES SENT FOR /IBK/ PROCESSING        *
     F*           IN BANK TO BANK INFORMATION.                        *
     F*  S01117 - CHECK ORDERING CUSTOMER (PAY & RECEIVE) NOT         *
     F*           BANK. VALIDATE DETAILS OF CHARGES.                  *
     F*           AOACCTV0 NOT CALLED FOR SETT TYPE 04 (EXT SETT).    *
     F*  S01117 - '?' PROCESSING FOR EXTENDED SETTLEMENTS             *
     F*  S01227 - EXTENDED SETTLEMENTS INCORPORATION - CHANGE         *
     F*           OF PROGRAM NAME SDKUUPR TO SD2410.                  *
     F*                                                               *
     F*           FOR VALIDATION OF INTERMEDIARY BANK THE FIELD       *
     F*              PARIBN SHOULD BE USED NOT PMRIBN AS THIS MIGHT   *
     F*              HOLD A CUSTOMER NUMBER OR A SHORTNAME.           *
     F*                                                               *
     F*              CHANGE MESSAGE PROCESSING  FOR ESM00986.         *
     F*                                                               *
     F*  E83    - Set up Default Branch for Set Meth 05 for Mbin=N    *
     F*  E00033 - OTHER SETTLEMENT METHODS WERE SETTING UP PMPOBR     *
     F*           AND WHEN METHOD CHANGED TO '00' WAS CAUSING ERROR   *
     F*  S01117 - AMENDMENTS FOR MULTIBRANCHING                       *
     F*                                                               *
     F*****************************************************************
     F/SPACE 3
     F*****************************************************************
     F*                                                               *
     F* ID F  C  H  L    FUNCTION OF INDICATORS                       *
     F*                                                               *
     F*  SCREEN VALIDATION - INDICATOR ON WHEN INVALID                *
     F*       08      Reverse image of Receipt Settlement Currency    *   CEU003
     F*       11      Reverse image of Payment Settlement Currency    *   CEU003
     F*       14      Reverse image of In currency in Field 72        *   CEU003
     F*       30      ERROR IN RECEIPT SETTLEMENT INSTRUCTIONS        *   LN0787
     F*       36      RECEIVER OF MT100                               *
     F*       37      RECEIPT - ORDERING CUSTOMER                     *
     F*       38      PAYMENT - ORDERING CUSTOMER                     *
     F*       39      RECEIPT - ORDERING BANK                         *
     F*       40      PAYMENT - ORDERING BANK                         *
     F*       41      RECEIVER'S CORRESPONDENT                        *
     F*       42      RECEIVER'S CORRESPONDENT ACCOUNT LINE           *
     F*       43      RECEIPT - INTERMEDIARY BANK                     *
     F*       44      PAYMENT - INTERMEDIARY BANK                     *
     F*       45      RECEIPT - INTERMEDIARY BANK ACCOUNT LINE        *
     F*       46      PAYMENT - INTERMEDIARY BANK ACCOUNT LINE        *
     F*       47      ACCOUNT WITH BANK                               *
     F*       48      ACCOUNT WITH BANK ACCOUNT LINE                  *
     F*       49      BENEFICIARY                                     *
     F*       50      BENEFICIARY ACCOUNT LINE                        *
     F********51******INTERMEDIARY*BANK*DOES*NOT*HAVE*A*SWIFT*ADDRESS *   S01412
     F*       52      RECEIPT - SETTLEMENT BRANCH                     *
     F*       53      PAYMENT - SETTLEMENT BRANCH                     *
     F*       60      WORK - INDICATOR                                *
     F********61******WORK*-*INDICATOR                                *   E22405
     F*       61      COVER MT202 REQUIRED                            *   E22405
     F*       63      FIRST BANK TO BANK LINE STARTS WITH '/' OR '//' *
     F*       64      SECOND BANK TO BANK LINE STARTS WITH '/' OR '//'*
     F*       65      THIRD BANK TO BANK LINE STARTS WITH '/' OR '//' *
     F*       66      FOURTH BANK TO BANK LINE STARTS WITH '/' OR '//'*
     F*       67      FIFTH BANK TO BANK LINE STARTS WITH '/' OR '//' *
     F*       68      SIXTH BANK TO BANK LINE STARTS WITH '/' OR '//' *
     F*       69      IF ON DATE ACCOUNT OPENED IS NOT VALIDATED      *
     F*       70      CHAIN FAILS                                     *
     F*       71      /INS/ OR /OGB/ ENTERED IN FIELD 72              *
     F********72******/IBK/*WITHOUT*A/C*LINE*ENTERED*IN*FIELD*72*******   S01412
     F********73******/IBK/*WITH*A/C*LINE*ENTERED*IN*FIELD*72**********   S01412
     F********74******/IBK/*ENTERED*IN*FIELD*72************************   S01412
     F*       75      /CABLEIBK/,/PHONIBK/ OR /TELEXIBK/ ENTERED IN   *
     F*               FIELD 72                                        *
     F*       76      /INT/ ENTERED IN FIELD 72                       *
     F*       80      SECOND BANK TO BANK LINE STARTS WITH '//'       *
     F*       81      THIRD BANK TO BANK LINE STARTS WITH  '//'       *
     F*       82      FOURTH BANK TO BANK LINE STARTS WITH '//'       *
     F*       83      FIFTH BANK TO BANK LINE STARTS WITH  '//'       *
     F*       84      SIXTH BANK TO BANK LINE STARTS WITH  '//'       *
     F*                                                               *
     F*****************************************************************
     F/SPACE 3
     F*****************************************************************
     F*                                                               *
     F* SUBROUTINES                                                   *
     F*                                                               *
     F*  FIRSTC - FIRST CYCLE PROCESSING    CALLED BY: MAIN PROCESSING*
     F*                                     CALLS    :                *
     F*  V01    - SCREEN VALIDATION         CALLED BY: MAIN PROCESSING*
     F*                                     CALLS    : CHKFL;BTBVAL   *
     F*  CHKFL  - VALIDATE CUSTOMER FIELDS  CALLED BY: V01            *
     F*                                     CALLS    :                *
     F*  CHKAC  - VALIDATE ACCOUNT NO.      CALLED BY: V01            *
     F*                                     CALLS    :                *
     F*  CHKNO  - VALIDATE NOSTRO           CALLED BY: V01            *
     F*                                     CALLS    :                *
     F*  CHKCY  - VALIDATE CURRENCY         CALLED BY: V01            *
     F*                                     CALLS    :                *
     F*  BTBVAL - VALIDATE BANK TO BANK     CALLED BY: V01            *
     F*           INFORMATION               CALLS    :                *
     F***Z01    - CALL ACCESS OBJECTS TO    CALLED BY: V01            *   S01117
     F*****       CLOSE OPEN FILES          CALLS    :                *   S01117
     F*                                                               *
     F*****************************************************************
      /COPY WNCPYSRC,SD2410FFPG                                           S01408
     E/SPACE 3
     E*
     E**  TABLES AND ARRAYS
     E*
     E/COPY WNCPYSRC,SD2410E001
     E                    CPY@    1   1 80
     E                    ERCD       50  3               ERROR CODES
     E                    BTB         6  9               USED BTB CODES
     E                    NALG       10  1  A                             DT0069
     E                    O#E        50  3               Return Error codeCSW096
     E                    @QM         2  1  A            Test for '?'     108517
     E** Nostro Align: array to left-align contents of Account With field DT0069
     E** for checking whether it contains a Nostro Number.                DT0069
     E*                                                                   DT0069
     E/COPY ZSRSRC,ZDATE1Z1                                               CSW005
     E/COPY ZSRSRC,ZEDITZ1                                                                    CLE031
     E*                                                                   CLE033
     E**  System values array                                             CLE033
     E**********          SVAL    1   3 20                                             CLE033 218782
     E                    SVAL    1   4 20                                                    218782
     E*                                                                   CLE033
     I/SPACE 3
     IPSETL     E DSSETLIAB
     IPSETLZ    E DSSETLIAZ
     IPSDSET    E DSSDSETLPD                                              CSW005
     I*A8RF***** E DSSDBRCHPD                                             S01117
     I*ALRF***** E DSSDCNSTPD                                             S01117
     I*CURF***** E DSSDCUSTPD                                             S01117
     I*A7RF***** E DSSDNOSTPD                                             S01117
     I*DMRF***** E DSSDCCSYPD                                             S01117
     IALRF      E DSSDCNSTPD                                              S01117
     ICURF      E DSSDCUSTPD                                              S01117
     IA7RF      E DSSDNOSTPD                                              S01117
     IACCT      E DSACCNTAB
     IDMRF      E DSSDCCSYPD                                              S01117
     ISDTRAD    E DSSDTRADPD                                              S01297
     I              QQACCD                          QQACC2                                    CGL029
      *                                                                   CLE033
     I*SDSVAL****E*DSSDSVALPD*                                                         CLE033 222373
      *                                                                   CLE033
     ISDACOD    E DSSDACODL1                                              CLE033
     I*
     I*                                                                   S01117
     IRUNDAT      DS                                                      S01117
     I** DATA STRUCTURE FOR MULTIBRANCH INDICATOR USING RUNDAT.           S01117
     I                                       13  13 @MBIN                 S01117
     I*                                                                   S01117
     ISDBANK    E DSSDBANKPD                                              S01117
     I** EXTERNAL DS FOR BANK DETAILS                                     S01117
     I*                                                                   S01117
     ISDBRCH    E DSSDBRCHPD                                              S01117
     I              QQDFAC                          QQDFA1                                    CGL029
     I** EXTERNAL DS FOR BRANCH DETAILS                                   S01117
     I*                                                                   S01117
     ISCSARD    E DSSCSARDPD                                              CEU003
      ***  External data structures for Switchable Features Details       CEU003
     I              LCD                             LCDX                  CEU003
     I*                                                                   CEU003
     ISDCURR    E DSSDCURRPD                                              CEU003
      ***  External data structures for Currency Details                  CEU003
     ISDGELR    E DSSDGELRPD                                              CEU003
     I              QQACCD                          QQACC1                                    CGL029
      ***  External data structures for General Ledger Details            CEU003
      *                                                                                       219241
     ISDMGME    E DSSDMGMEPD                                                                  219241
      **  Data structure for message management data.                                         219241
     ISDMMOD    E DSSDMMODPD                                              221452
      ***  External data structures for Midas Module Details              221452
      *                                                                   S01408
      /COPY WNCPYSRC,SD2410IIPG                                           S01408
      *                                                                   S01408
     IDSSDY     E DSDSSDY
      ** EXTERNAL DS FOR LONG DUMMY DATA STRUCTURE
     I*                                                                   S01117
     IDSFDY     E DSDSFDY
      ** EXTERNAL DS FOR SHORT DUMMY DATA STRUCTURE
     I*                                                                   S01117
     I            DS
     I**********                              1  15 ACKEY                                     CGL029
     I                                        1  21 ACKEY                                     CGL029
     I**********                              1   60CUSKEY                                    CSD027
     I                                        1   6 CUSKEY                                    CSD027
     I                                        7   9 CCYKEY
     I**********                             10  130ACDKE2                                    CGL029
     I**********                             14  150SEQKE2                                    CGL029
     I                                       10  190ACDKE2                                    CGL029
     I                                       20  210SEQKE2                                    CGL029
     I            DS
     I**********                              1  12 NOSTRO                                    CGL029
     I                                        1  18 NOSTRO                                    CGL029
     I                                        1   2 NOST02
     I                                        1   6 NOST06
     I**********                              1  10 NOST10                                    CGL029
     I**********                              7  10 NOSTAC                                    CGL029
     I**********                              7  12 NOSTYY                                    CGL029
     I**********                             11  12 NOSTSQ                                    CGL029
     I**********                              3  12 NOSTXX                                    CGL029
     I**********                              1  16 NOST10                             CGL029 TDA088
     I                                        1  10 NOST10                                    TDA088
     I                                        7  16 NOSTAC                                    CGL029
     I                                        7  18 NOSTYY                                    CGL029
     I                                       17  18 NOSTSQ                                    CGL029
     I                                        3  18 NOSTXX                                    CGL029
     I                                       11  18 WNOST1                                  AR853732
     I            DS
     I                                        1  35 PMXIBA
     I                                        1   1 PMXIB1
     I                                        2   2 PMXIB2
     I                                        3   3 PMXIBE                060036
     I                                        1   4 PMXIB4
     I                                        5  35 PMXIB5
     I                                        5   9 PMXSW5                094100
     I                                        5  10 PMXIB6
     I                                        5  100PNXIB6
     I                                        5  130PMXIB7
     I                                       10  35 PMXSWW                094100
     I                                       11  35 PMXIBW
     I**********                              5   7 PMXIB3                S01429
     I**********                              5   70PNXIB3                S01429
     I**********                              8  35 PMXIBX                S01429
     I                                        5   8 PMXIB3                S01429
     I                                        5   80PNXIB3                S01429
     I                                        9  35 PMXIBX                S01429
     I                                        5  12 PMXIB8
     I                                       13  35 PMXIBY
     I                                        5  13 PMXIB9
     I                                       14  35 PMXIBZ
     I            DS
     I                                        1  10 CHKFLD
     I                                        1   6 CHKFLA
     I                                        1   8 CHKFLC
     I                                        7  10 CHKBL1
     I                                        9  10 CHKBL2
     I            DS
     I                                        1  35 XBTB
     I                                        1   1 SLASH1
     I                                        1   2 SLASH2
     I                                        6   6 SLASH3
     I                                        2   5 CODE1A
     I                                        2   6 CODE1B
     I                                        2   7 CODE1C
     I                                        2   8 CODE1D
     I                                        2   9 CODE1E
     I                                        2  10 CODE1F
     I                                        3  35 BLKCHK                096151
     I                                        6  15 CODE1G
     I                                        7   7 PLUS1A
     I                                        8   8 PLUS1B
     I                                       10  10 PLUS1C
     I                                       11  11 PLUS1D
     I                                        6  35 BLNK1A
     I                                        9  35 BLNK1B
     I                                       11  35 BLNK1C
     I                                        7  18 PHONEA
     I                                        8  19 TELEXA
     I                                       10  21 PHONEB
     I                                       11  22 TELEXB
     I            DS
     I                                        1  12 YBTB
     I                                        3  12 CODE1H
     I            DS
     I                                        1  12 ACKER
     I**********                              1   60CUSKER                                    CSD027
     I                                        1   6 CUSKER                                    CSD027
     I                                        7  100ACDKER
     I                                       11  120SEQKER
     I            DS
     I                                        1  12 ACKEP
     I**********                              1   60CUSKEP                                    CSD027
     I                                        1   6 CUSKEP                                    CSD027
     I                                        7  100ACDKEP
     I                                       11  120SEQKEP
     I/COPY WNCPYSRC,SD2410I001
     I            DS                                                      DT0069
     I** Data structure for use in checking whether Account With field is DT0069
     I** a Nostro Number.                                                 DT0069
     I**                                      Account With field          DT0069
     I                                        1  10 @@AWBN                DT0069
     I**                                      Account With array          DT0069
     I                                        1  10 NALG                  DT0069
     I**                                      Nostro Number               DT0069
     I                                        1   2 @@NONO                DT0069
     I**                                      The rest of the field       DT0069
     I                                        3  10 @@NRST                DT0069
     ICPYR@#      DS
     I* DATA STRUCTURE FOR COMPILATION - COPYRIGHT INSERTION
     I                                        1  80 CPY@
     I/COPY WNCPYSRC,SD2410I003
     I                                        1  20 CPY@##
     I*                                                                   E24039
     ILDA         DS                            256                       E24039
     I                                      200 200 NOCHG1                E24039
     I                                      201 201 RCVSTR                E24039
     I                                      202 202 NOCHG2                E24039
     I**  LOCAL DATA AREA                                                 E24039
     I/COPY WNCPYSRC,SD2410I005
      *                                                                   CSW096
      * Input Parameters                                                  CSW096
      *                                                                   CSW096
     I***I#PARM*     DS                            512                                 CSW096 CGL029
     II#PARM      DS                            514                                           CGL029
      * Field to be validated                                             CSW096
     I                                        1   5 I#VFLD                CSW096
      * Pay/Receive Settlement (PAY/REC)                                  CSW096
     I                                        6   8 I#PR                  CSW096
      * Customer/Counterparty Nostro /BIC indentified type                CSW096
      *    C           X              S  X-> C'party Nostro or Customer   CSW096
      * Customer/Counterparty/BIC indentified                             CSW096
     I                                        9   9 I#PRTT                CSW096
     I                                       10  20 I#PRTY                CSW096
      * Pay Currency                                                      CSW096
     I                                       21  23 I#PCCY                CSW096
      * Receive Currency                                                  CSW096
     I                                       24  26 I#RCCY                CSW096
      * Account Line                                                      CSW096
     I                                       27  61 I#ACLN                CSW096
      * Account Line Character 1                                          CSW096
     I                                       27  27 I#ACC1                CSW096
      * Account Line Character 2                                          CSW096
     I                                       28  28 I#ACC2                CSW096
      * Account Line Character 3                                          CSW096
     I                                       29  29 I#ACC3                CSW096
      * Account Line first 4 characters                                   CSW096
     I                                       27  30 I#ACCL                CSW096
      * Account Line Clearing System                                      CSW096
     I                                       29  30 I#ACCS                CSW096
      * Account Line No account data                                      CSW096
     I                                       31  61 I#SPC1                CSW096
      * Message Type                                                      CSW096
     I                                       62  64 I#MTYP                CSW096
      * Intermediary Institution for Bank to Bank validation              CSW096
     I                                       65  65 I#INBT                CSW096
     I                                       66  76 I#INBK                CSW096
      * Account with Institution for Bank to Bank validation              CSW096
     I                                       77  77 I#AWBT                CSW096
     I                                       78  88 I#AWBK                CSW096
      * Beneficiary for Bank to Bank validation                           CSW096
     I                                       89  89 I#BENT                CSW096
     I                                       90 100 I#BENF                CSW096
      * Pay and Receive Settlement Methods                                CSW096
     I                                      101 102 I#RSTM                CSW096
     I                                      103 104 I#PSTM                CSW096
      * Field 53 and 54 Entered                                           CSW096
     I                                      105 105 I#5354                CSW096
      * Midas Module                                                      CSW096
     I                                      106 107 I#MMOD                CSW096
      * Pay and Receive Settlement Accounts                               CSW096
     I**********                            108 125 I#PYAC                CSW096       CSW096 CGL029
     I**********                            126 143 I#RCAC                CSW096       CSW096 CGL029
     I                                      108 125 QQPYAC                                    CGL029
     I                                      126 143 QQRCAC                                    CGL029
      * Transaction Type                                                  CSW096
     I                                      144 145 I#TTYP                CSW096
      * Cover required                                                    CSW096
     I                                      146 146 I#COVR                CSW096
      * Bank to Bank Information                                          CSW096
     I                                      257 466 I#BTB                 CSW096
     I                                      257 291 I#BTB1                CSW096
     I                                      292 326 I#BTB2                CSW096
     I                                      327 361 I#BTB3                CSW096
     I                                      362 396 I#BTB4                CSW096
     I                                      397 431 I#BTB5                CSW096
     I                                      432 466 I#BTB6                CSW096
      *                                                                                       CGL029
      ** Pay and Receive Settlement Accounts                                                  CGL029
      *                                                                                       CGL029
     I                                      467 490 I#PYAC                                    CGL029
     I                                      491 514 I#RCAC                                    CGL029
      *                                                                   CSW096
      * Output Parameters                                                 CSW096
      *                                                                   CSW096
     I***O#PARM*     DS                            512                                 CSW096 CGL029
     IO#PARM      DS                            514                                           CGL029
      * Account Line modified                                             CSW096
     I                                        1  35 O#ACLN                CSW096
     I/COPY WNCPYSRC,SD2410I004
      * Bank to Bank Information                                          CSW096
     I                                      257 466 O#BTB                 CSW096
     I                                      257 291 O#BTB1                CSW096
     I                                      292 326 O#BTB2                CSW096
     I                                      327 361 O#BTB3                CSW096
     I                                      362 396 O#BTB4                CSW096
     I                                      397 431 O#BTB5                CSW096
     I                                      432 466 O#BTB6                CSW096
      *                                                                   CSW096
      * Error Parameters                                                  CSW096
      *                                                                   CSW096
     IE#PARM      DS                            256                       CSW096
      * Calling Program                                                   CSW096
     I                                        1  10 E#CPGM                CSW096
      * Error message sent                                                CSW096
     I                                       12  12 E#ERRM                CSW096
      * Warning message sent                                              CSW096
     I                                       13  13 E#WARN                CSW096
      * Error index                                                       CSW096
     I                                       14  180E#INDX                CSW096
      * Message text to prefix error message                              CSW096
     I                                       19  25 E#MSGD                CSW096
     I                                       26  35 E#MSGF                CSW096
      * Error codes array                                                 CSW096
     I                                       51 200 E#ERCD                CSW096
     I                                       51 200 O#E                   CSW096
      *                                                                   CSW096
     I            DS                                                      CSW005
     I                                        1   6 W#AGDT                CSW005
     I                                        1   20YY                    CSW005
     I                                        3   40MM                    CSW005
     I                                        5   60DD                    CSW005
     I            DS                                                      CSW005
     I                                        1   6 WWAGDT                CSW005
     I                                        1   20WDD                   CSW005
     I                                        3   40WMM                   CSW005
     I                                        5   60WYY                   CSW005
     I            DS                                                                          CDL094
     I                                        1   3 ERB1                                      CDL094
     I                                        1   2 ER2A                                      CDL094
     I/COPY WNCPYSRC,SD2410I002
     I/EJECT
     C/COPY WNCPYSRC,SD2410C047
     C*********************
     C** MAIN PROCESSING **
     C*********************
     C/COPY WNCPYSRC,SD2410C050
     C*
     C           *ENTRY    PLIST
     C                     PARM           PSETL
     C                     PARM           PSETLZ
     C/COPY WNCPYSRC,SD2410C096
     C                     PARM           PSDSET                          CSW005
     C***********          PARM           CNT     10                CLE003113832
     C***********          PARM           CNT1    10                CLE003113832
     C/COPY WNCPYSRC,SD2410C097
     C*                                                                   CLE003
     C**  Access SAR details file to see if CLE003 is installed           CLE003
     C*                                                                   CLE003
     C                     CALL 'AOSARDR0'                                CLE003
     C                     PARM '       ' @RTCD   7                       CLE003
     C                     PARM '*VERIFY' @OPTN   7                       CLE003
     C                     PARM 'CLE003'  @SARD   6                       CLE003
      *                                                                   CLE003
     C           @RTCD     IFEQ *BLANK                                    CLE003
     C                     MOVE 'Y'       CLE003  1                       CLE003
     C                     ELSE                                           CLE003
     C                     MOVE 'N'       CLE003                          CLE003
     C                     ENDIF                                          CLE003
      *                                                                   CLE033
      ** Access Switchable Feature Details                                CLE033
      *                                                                   CLE033
     C                     MOVE 'N'       CLE033  1                       CLE033
      *                                                                   CLE033
     C                     CALL 'AOSARDR0'                                CLE033
     C                     PARM *BLANKS   @RTCD                           CLE033
     C                     PARM '*VERIFY '@OPTN                           CLE033
     C                     PARM 'CLE033'  @SARD                           CLE033
      *                                                                   CLE033
     C           @RTCD     IFEQ *BLANKS                                   CLE033
      *                                                                   CLE033
     C                     MOVE 'Y'       CLE033                          CLE033
      *                                                                   CLE033
     C                     CALL 'AOSVALR0'                                CLE033
     C                     PARM *BLANKS   @RTCD                           CLE033
     C                     PARM SVAL,1    P@OP01 20                       CLE033
     C                     PARM *BLANKS   P@VL01200                       CLE033
     C                     PARM SVAL,2    P@OP02 20                       CLE033
     C                     PARM *BLANKS   P@VL02200                       CLE033
     C                     PARM SVAL,3    P@OP03 20                       CLE033
     C                     PARM *BLANKS   P@VL03200                       CLE033
     C**********           PARM *BLANKS   P@OP04 20                                    CLE033 218782
     C                     PARM SVAL,4    P@OP04 20                                           218782
     C                     PARM *BLANKS   P@VL04200                       CLE033
     C                     PARM *BLANKS   P@OP05 20                       CLE033
     C                     PARM *BLANKS   P@VL05200                       CLE033
     C                     PARM *BLANKS   P@OP06 20                       CLE033
     C                     PARM *BLANKS   P@VL06200                       CLE033
     C                     PARM *BLANKS   P@OP07 20                       CLE033
     C                     PARM *BLANKS   P@VL07200                       CLE033
     C                     PARM *BLANKS   P@OP08 20                       CLE033
     C                     PARM *BLANKS   P@VL08200                       CLE033
     C                     PARM *BLANKS   P@OP09 20                       CLE033
     C                     PARM *BLANKS   P@VL09200                       CLE033
     C                     PARM *BLANKS   P@OP10 20                       CLE033
     C                     PARM *BLANKS   P@VL10200                       CLE033
     C********** SDSVAL    PARM SDSVAL    DSSDY                                        CLE033 222373
      *                                                                   CLE033
     C           @RTCD     IFNE *BLANK                                    CLE033
     C                     MOVEL'SDSVALPD'PMDBFL           ************** CLE033
     C                     MOVEL'SD2410'  PMDPGM           ** DBASE 12 ** CLE033
     C                     Z-ADD012       PMDBSE           ************** CLE033
     C                     MOVE *ON       *INU7                           CLE033
     C                     MOVE *ON       *INU8                           CLE033
     C                     MOVE *ON       *INLR                           CLE033
     C                     MOVE 'T'       PMTERM                          CLE033
     C                     RETRN                                          CLE033
     C                     ENDIF                                          CLE033
      *                                                                   CLE033
     C**********           MOVELP@VL02    W0ACOD  4                                    CLE033 CGL029
     C                     MOVELP@VL02    W0ACOD 10                                           CGL029
      *                                                                                       218782
      ** Save value of Settlement09Postings in a one character field                          218782
     C                     MOVELP@VL04    SET09   1                                           218782
      *                                                                   CLE033
     C                     CALL 'AOACODR0'                                CLE033
     C                     PARM *BLANKS   @RTCD                           CLE033
     C                     PARM '*KEY    '@OPTN                           CLE033
     C                     PARM W0ACOD    @ACCD                           CLE033
     C           SDACOD    PARM SDACOD    DSSDY                           CLE033
      *                                                                   CLE033
     C           @RTCD     IFNE *BLANK                                    CLE033
     C                     MOVEL'SDACODL1'PMDBFL           ************** CLE033
     C                     MOVEL'SD2410'  PMDPGM           ** DBASE 11 ** CLE033
     C                     Z-ADD011       PMDBSE           ************** CLE033
     C                     MOVE *ON       *INU7                           CLE033
     C                     MOVE *ON       *INU8                           CLE033
     C                     MOVE *ON       *INLR                           CLE033
     C                     MOVE 'T'       PMTERM                          CLE033
     C                     RETRN                                          CLE033
     C                     ENDIF                                          CLE033
      *                                                                   CLE033
     C                     ENDIF                                          CLE033
     C*                                                                   221452
     C**  Access Midas Module Details                                     221452
     C*                                                                   221452
     C                     CALL 'AOMMODR0'                                221452
     C                     PARM '*DBERR ' PRTCD                           221452
     C                     PARM '*FIRST ' POPTN                           221452
     C           SDMMOD    PARM SDMMOD    DSFDY                           221452
     C*                                                                   221452
     C*
     C*                                                                   S01408
     C/COPY WNCPYSRC,SD2410CCPG                                           S01408
     C*                                                                   S01408
     C*                                                                   113832
     C* If warning messages 805/806 have been displayed (flags set        113832
     C* to 2) allow user to return to previous screen                     113832
     C* COUNT - used as a flag for validation of Receipt field            113832
     C* COUNT1 - used as a flag for validation of Payment field           113832
     C*                                                                   113832
     C           CLE003    IFEQ 'Y'                                       CLE003
     C           PMCPGM    ANDEQ'MMLD'                                    113832
     C                     MOVELPMCMDP    COUNT   10                      113832
     C                     MOVE PMCMDP    COUNT1  10                      113832
     C           COUNT     IFEQ 2                                         CLE003
     C           COUNT1    OREQ 2                                         CLE003
     C                     MOVE *OFF      *IN30                           CLE003
     C                     MOVE *OFF      *IN31                           CLE003
     C                     ADD  1         COUNT                           113832
     C                     ADD  1         COUNT1                          113832
     C                     ENDIF                                          CLE003
     C***********          MOVE CNT       COUNT   10                CLE003113832
     C***********          MOVE CNT1      COUNT1  10                CLE003113832
     C                     ENDIF                                          CLE003
     C*                                                                   CLE003
     C                     MOVE *BLANKS   PMERCD
     C**********           MOVE *BLANKS   RBRF    1                 S01117139921
     C**********           MOVE *BLANKS   PBRF    1                 S01117139921
     C                     MOVE *BLANKS   RTCD                            S01117
     C                     MOVE 'N'       @SENT   1                       S01117
     C*                                                                   S01117
     C** READ DATA AREA - RUNDAT                                          S01117
     C           *NAMVAR   DEFN           RUNDAT                          S01117
     C                     IN   RUNDAT                                    S01117
     C*                                                                   CEU003
     C** Access Switchable Feature Details                                CEU003
     C*                                                                   CEU003
     C                     CALL 'AOSARDR0'                                CEU003
     C                     PARM *BLANKS   PRTCD   7                       CEU003
     C                     PARM '*VERIFY 'POPTN   7                       CEU003
     C                     PARM 'CEU003'  PSARD   6                       CEU003
     C           SCSARD    PARM SCSARD    DSSDY                           CEU003
     C*                                                                   CEU003
     C           PRTCD     IFEQ *BLANKS                                   CEU003
     C                     MOVE 'Y'       CEU003  1                       CEU003
     C                     ELSE                                           CEU003
     C                     MOVE 'N'       CEU003                          CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
      *                                                                                       CLE031
      ** Check if switchable feature CLE031 is switched on.                                   CLE031
      *                                                                                       CLE031
     C                     CALL 'AOSARDR0'                                                    CLE031
     C                     PARM *BLANKS   P@RTCD                                              CLE031
     C                     PARM '*VERIFY' P@OPTN                                              CLE031
     C                     PARM 'CLE031'  P@SARD                                              CLE031
     C           SCSARD    PARM SCSARD    DSSDY                                               CLE031
     C*                                                                                       CLE031
     C                     MOVE 'N'       CLE031  1                                           CLE031
     C           P@RTCD    IFEQ *BLANK                                                        CLE031
     C                     MOVE 'Y'       CLE031  1                                           CLE031
     C                     ELSE                                                               CLE031
     C           P@RTCD    IFNE '*NRF   '                                                     CLE031
     C                     MOVEL'SCSARDPD'PMDBFL           **************                     CLE031
     C                     MOVEL'SD2410'  PMDPGM           ** DBASE 11 **                     CLE031
     C                     Z-ADD11        PMDBSE           **************                     CLE031
     C                     MOVE '1'       *INU7                                               CLE031
     C                     MOVE '1'       *INU8                                               CLE031
     C                     MOVE '1'       *INLR                                               CLE031
     C                     MOVE 'T'       PMTERM                                              CLE031
     C                     RETRN                                                              CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                   191152
     C                     CALL 'AOSARDR0'                                191152
     C                     PARM *BLANKS   PRTCD   7                       191152
     C                     PARM '*VERIFY 'POPTN   7                       191152
     C                     PARM 'CEU004'  PSARD   6                       191152
     C           SCSARD    PARM SCSARD    DSSDY                           191152
      *                                                                   191152
     C           PRTCD     IFEQ *BLANKS                                   191152
     C                     MOVE 'Y'       CEU004  1                       191152
     C                     ELSE                                           191152
     C                     MOVE 'N'       CEU004                          191152
     C                     ENDIF                                          191152
      *                                                                   191152
     C**  Access General Ledger Details                                   CEU003
     C*                                                                   CEU003
     C**********           CALL 'AOGELRR0'                                             CEU003 CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*DBERR ' PRTCD                           CEU003
     C                     PARM '*FIRST ' POPTN                           CEU003
     C********** SDGELR    PARM SDGELR    DSFDY                                        CEU003 CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
      *                                                                                       219241
      ** Access SDMGMEPD for message management data.                                         219241
      *                                                                                       219241
     C                     CALL 'AOMGMER1'                                                    219241
     C                     PARM '*MSG   ' PRTCD                                               219241
     C                     PARM '*FIRST ' POPTN                                               219241
     C           SDMGME    PARM SDMGME    DSSDY                                               219241
      *                                                                                       219241
      ** If no record is found on SDMGMEPD, DB Error Processing.                              219241
      *                                                                                       219241
     C           PRTCD     IFNE *BLANKS                                                       219241
     C                     MOVEL'MGME '   PMDBFL                                              219241
     C                     MOVEL'SD2410'  PMDPGM                                              219241
     C                     Z-ADD12        PMDBSE                                              219241
     C                     MOVE *ON       *INU7                                               219241
     C                     MOVE *ON       *INU8                                               219241
     C                     MOVE *ON       *INLR                                               219241
     C                     MOVE 'T'       PMTERM                                              219241
     C                     RETRN                                                              219241
     C                     ENDIF                                                              219241
     C*                                                                   S01117
     C*                                                                   CSW005
     C                     MOVEL*BLANKS   CSW005  1                       CSW005
     C                     MOVEL*BLANKS   CSW011  1                       CSW011
     C*                                                                   CSW005
     C** Check if switchable feature CSW005 is switched on.               CSW005
     C*                                                                   CSW005
     C                     CALL 'AOSARDR0'                                CSW005
     C                     PARM *BLANKS   P@RTCD  7                       CSW005
     C                     PARM '*VERIFY' P@OPTN  7                       CSW005
     C                     PARM 'CSW005'  P@SARD  6                       CSW005
     C*                                                                   CSW005
     C           @RTCD     IFNE *BLANK                                    CSW005
     C           @RTCD     ANDNE'*NRF   '                                 CSW005
     C                     MOVEL'SCSARDPD'PMDBFL           ************** CSW005
     C                     MOVEL'SD2410'  PMDPGM           ** DBASE 09 ** CSW005
     C                     Z-ADD09        PMDBSE           ************** CSW005
     C                     MOVE *ON       *INU7                           CSW005
     C                     MOVE *ON       *INU8                           CSW005
     C                     MOVE *ON       *INLR                           CSW005
     C                     MOVE 'T'       PMTERM                          CSW005
     C                     RETRN                                          CSW005
     C                     END                                            CSW005
     C*                                                                   CSW005
     C           P@RTCD    IFEQ *BLANKS                                   CSW005
     C                     MOVEL'Y'       CSW005                          CSW005
     C                     ENDIF                                          CSW005
     C*                                                                   CSW011
     C                     CALL 'AOSARDR0'                                CSW011
     C                     PARM *BLANKS   P@RTCD  7                       CSW011
     C                     PARM '*VERIFY' P@OPTN  7                       CSW011
     C                     PARM 'CSW011'  P@SARD  6                       CSW011
     C*                                                                   CSW011
     C           P@RTCD    IFEQ *BLANKS                                   CSW011
     C                     MOVEL'Y'       CSW011                          CSW011
     C                     ENDIF                                          CSW011
      *                                                                   CDL008
      ** Check if switchable feature CDL008 is switched on.               CDL008
      *                                                                   CDL008
     C                     CALL 'AOSARDR0'                                CDL008
     C                     PARM *BLANKS   P@RTCD                          CDL008
     C                     PARM '*VERIFY' P@OPTN                          CDL008
     C                     PARM 'CDL008'  P@SARD                          CDL008
     C*                                                                   CDL008
     C           @RTCD     IFNE *BLANK                                    CDL008
     C           @RTCD     ANDNE'*NRF   '                                 CDL008
     C                     MOVEL'SCSARDPD'PMDBFL           ************   CDL008
     C                     MOVEL'SD2410'  PMDPGM           * DBASE 10 *   CDL008
     C                     Z-ADD10        PMDBSE           ************   CDL008
     C                     MOVE *ON       *INU7                           CDL008
     C                     MOVE *ON       *INU8                           CDL008
     C                     MOVE *ON       *INLR                           CDL008
     C                     MOVE 'T'       PMTERM                          CDL008
     C                     RETRN                                          CDL008
     C                     ENDIF                                          CDL008
      *                                                                   CDL008
     C           P@RTCD    IFEQ *BLANKS                                   CDL008
     C                     MOVEL'Y'       CDL008  1                       CDL008
     C                     ELSE                                           CDL008
     C                     MOVEL'N'       CDL008                          CDL008
     C                     ENDIF                                          CDL008
      *                                                                                       219241
      ** Access Switchable Feature Details. Check if STP Phase 2 MT103                        219241
      ** for Non-Funds Transfer (CFT013) is installed.                                        219241
      *                                                                                       219241
     C                     CALL 'AOSARDR0'                                                    219241
     C                     PARM *BLANKS   PRTCD                                               219241
     C                     PARM '*VERIFY 'POPTN                                               219241
     C                     PARM 'CFT013'  PSARD                                               219241
     C           SCSARD    PARM SCSARD    DSFDY                                               219241
      *                                                                                       219241
     C           PRTCD     IFNE *BLANK                                                        219241
     C           PRTCD     ANDNE'*NRF   '                                                     219241
     C                     MOVEL'SARD '   PMDBFL                                              219241
     C                     MOVEL'SD2410'  PMDPGM                                              219241
     C                     Z-ADD11        PMDBSE                                              219241
     C                     MOVE *ON       *INU7                                               219241
     C                     MOVE *ON       *INU8                                               219241
     C                     MOVE *ON       *INLR                                               219241
     C                     MOVE 'T'       PMTERM                                              219241
     C                     RETRN                                                              219241
     C                     ENDIF                                                              219241
      *                                                                                       219241
     C           PRTCD     IFEQ *BLANKS                                                       219241
     C                     MOVE 'Y'       CFT013  1                                           219241
     C                     ELSE                                                               219241
     C                     MOVE 'N'       CFT013                                              219241
     C                     ENDIF                                                              219241
      * Switchable feature CDL031                                                            BUG7139
     C                     CALL 'AOSARDR0'                                                   BUG7139
     C                     PARM *BLANKS   PRTCD                                              BUG7139
     C                     PARM '*VERIFY 'POPTN                                              BUG7139
     C                     PARM 'CDL031'  PSARD                                              BUG7139
     C           SCSARD    PARM SCSARD    DSSDY                                              BUG7139
     C*                                                                                      BUG7139
     C           PRTCD     IFEQ *BLANKS                                                      BUG7139
     C                     MOVE 'Y'       CDL031  1                                          BUG7139
     C                     ELSE                                                              BUG7139
     C                     MOVE 'N'       CDL031                                             BUG7139
     C                     ENDIF                                                             BUG7139
     C*                                                                                      BUG7139
      *                                                                                      BUG7139
      * Switchable feature CDL094                                                             CDL094
     C                     CALL 'AOSARDR0'                                                    CDL094
     C                     PARM *BLANKS   PRTCD                                               CDL094
     C                     PARM '*VERIFY 'POPTN                                               CDL094
     C                     PARM 'CDL094'  PSARD                                               CDL094
     C           SCSARD    PARM SCSARD    DSSDY                                               CDL094
      *                                                                                       CDL094
     C           PRTCD     IFEQ *BLANKS                                                       CDL094
     C                     MOVE 'Y'       CDL094  1                                           CDL094
     C                     ELSE                                                               CDL094
     C                     MOVE 'N'       CDL094                                              CDL094
     C                     ENDIF                                                              CDL094
     C*                                                                                       CDL094
      *                                                                                       CDL094
     C*                                                                   CSW200
     C** Check if SWIFT 2000 Changes is on.                               CSW200
      *                                                                   CSW200
     C                     CALL 'SWIF2000'                                CSW200
     C                     PARM *BLANKS   P@RTCD                          CSW200
      *                                                                   CSW200
     C                     MOVEL'N'       CSW200  1                       CSW200
     C           P@RTCD    IFEQ 'CSW200'                                  CSW200
     C                     MOVEL'Y'       CSW200  1                       CSW200
     C                     ENDIF                                          CSW200
     C*                                                                   CSW200
      ** Call SWIF2001 to check if CSW201 is switched on                                      CSW201
      *                                                                                       CSW201
     C                     CALL 'SWIF2001'                                                    CSW201
     C                     PARM *BLANKS   P@RTCD                                              CSW201
      *                                                                                       CSW201
     C           P@RTCD    IFEQ 'CSW2001'                                                     CSW201
     C                     MOVE 'Y'       CSW201  1                                           CSW201
     C                     ELSE                                                               CSW201
     C                     MOVE 'N'       CSW201                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
      ** Check if SWIFT 2002 Changes is on.                                                   CSW202
      *                                                                                       CSW202
     C                     CALL 'SWIF2002'                                                    CSW202
     C                     PARM *BLANKS   P@RTCD                                              CSW202
      *                                                                                       CSW202
     C           P@RTCD    IFEQ 'CSW2002'                                                     CSW202
     C                     MOVEL'Y'       CSW202  1                                           CSW202
     C                     ELSE                                                               CSW202
     C                     MOVEL'N'       CSW202                                              CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW202
      ** Call SWIF2003 to check if CSW203 is installed                                        CSW203
      *                                                                                       CSW203
     C                     CALL 'SWIF2003'                                                    CSW203
     C                     PARM *BLANKS   PRTCD                                               CSW203
      *                                                                                       CSW203
      ** If ret. code is "CSW2003", set CSW203 flag to "Y", else set it to "N"                CSW203
      *                                                                                       CSW203
     C           PRTCD     IFEQ 'CSW2003'                                                     CSW203
     C                     MOVE 'Y'       CSW203  1                                           CSW203
     C                     ELSE                                                               CSW203
     C                     MOVE 'N'       CSW203                                              CSW203
     C                     ENDIF                                                              CSW203
      *                                                                                       CSW203
     C           *LIKE     DEFN A6SPRT    ARSPRT                                              CLE031
     C           *LIKE     DEFN A6SPRT    APSPRT                                              CLE031
     C           *LIKE     DEFN A6SPRT    AMREXR                                              CLE031
     C           *LIKE     DEFN A6SPRT    AMPEXR                                              CLE031
     C           *LIKE     DEFN A6SPRT    ZRATE1                                              CLE031
     C           *LIKE     DEFN A6SPRT    ZRATE2                                              CLE031
     C           *LIKE     DEFN A6MDIN    ARMDIN                                              CLE031
     C           *LIKE     DEFN A6MDIN    APMDIN                                              CLE031
     C           *LIKE     DEFN A6MDIN    AMREXI                                              CLE031
     C           *LIKE     DEFN A6MDIN    AMPEXI                                              CLE031
     C           *LIKE     DEFN A6MDIN    ZMDI1                                               CLE031
     C           *LIKE     DEFN A6MDIN    ZMDI2                                               CLE031
      *                                                                                       CLE031
      ** Check if SWIFT Changes 2012 (CSW212) is installed                                    CSW212
      *                                                                                       CSW212
     C                     CALL 'SWIF2012'                                                    CSW212
     C                     PARM *BLANKS   P@RTCD                                              CSW212
      *                                                                                       CSW212
     C           P@RTCD    IFEQ 'CSW2012'                                                     CSW212
     C                     MOVE 'Y'       CSW212  1                                           CSW212
     C                     ELSE                                                               CSW212
     C                     MOVE 'N'       CSW212                                              CSW212
     C                     ENDIF                                                              CSW212
      *                                                                                       CSW212
      ** Check if switchable feature CMG003 is switched on.                                   CMG003
      *                                                                                       CMG003
     C                     CALL 'AOSARDR0'                                                    CMG003
     C                     PARM *BLANKS   P@RTCD                                              CMG003
     C                     PARM '*VERIFY' P@OPTN                                              CMG003
     C                     PARM 'CMG003'  P@SARD                                              CMG003
      *                                                                                       CMG003
     C           P@RTCD    IFNE *BLANK                                                        CMG003
     C           P@RTCD    ANDNE'*NRF   '                                                     CMG003
     C                     MOVEL'SCSARDPD'PMDBFL                                              CMG003
     C                     MOVEL'SD2410'  PMDPGM                                              CMG003
     C                     Z-ADD13        PMDBSE                                              CMG003
     C                     MOVE *ON       *INU7                                               CMG003
     C                     MOVE *ON       *INU8                                               CMG003
     C                     MOVE *ON       *INLR                                               CMG003
     C                     MOVE 'T'       PMTERM                                              CMG003
     C                     RETRN                                                              CMG003
     C                     ENDIF                                                              CMG003
      *                                                                                       CMG003
     C           P@RTCD    IFEQ *BLANKS                                                       CMG003
     C                     MOVEL'Y'       CMG003  1                                           CMG003
     C                     ELSE                                                               CMG003
     C                     MOVEL'N'       CMG003                                              CMG003
     C                     ENDIF                                                              CMG003
      *                                                                                       CMG003
      ** Check if SWIFT Changes 2013 (CSW213) is installed                                    CSW213
      *                                                                                       CSW213
     C                     CALL 'SWIF2013'                                                    CSW213
     C                     PARM *BLANKS   P@RTCD                                              CSW213
      *                                                                                       CSW213
     C           P@RTCD    IFEQ 'CSW2013'                                                     CSW213
     C                     MOVE 'Y'       CSW213  1                                           CSW213
     C                     ELSE                                                               CSW213
     C                     MOVE 'N'       CSW213                                              CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
      *                                                                                       CSW214
      ** Check if SWIFT Changes 2014 (CSW214) is installed                                    CSW214
      *                                                                                       CSW214
     C                     CALL 'SWIF2014'                                                    CSW214
     C                     PARM *BLANKS   PRTCD                                               CSW214
      *                                                                                       CSW214
     C           PRTCD     IFEQ 'CSW2014'                                                     CSW214
     C                     MOVE 'Y'       CSW214  1                                           CSW214
     C                     ELSE                                                               CSW214
     C                     MOVE 'N'       CSW214                                              CSW214
     C                     ENDIF                                                              CSW214
      *                                                                                       CSW214
     C/COPY WNCPYSRC,SD2410C001
     C*
     C** PERFORM VALIDATION ROUTINE V01 IF TERMINATION PARAMETER NOT=T
     C*
     C           PMTERM    IFNE 'T'                        B1
     C*                                                                   BHF465
     C                     MOVEL' '       CPBNBI                          E28710
     C*                                                                   E28710
     C** DO RECEIVE SIDE DEFAULTING FOR SETTLEMENT METHOD 01 AND 08       BHF465
     C*                                                                   BHF465
     C********** PMPSTM    IFEQ 01                                  BHF465BHF547
     C********** PMPSTM    OREQ 08                                  BHF465BHF547
     C           PMRSTM    IFEQ 01                                        BHF547
     C********** PMDEFT    ANDEQ'Y'                                 LN0787LN0806
     C           PMDEFR    ANDEQ'Y'                                       LN0806
     C           PMRSTM    OREQ 08                                        BHF547
     C           PMDEFR    ANDEQ'Y'                                       LN0787
     C                     EXSR RECDEF                                    BHF465
     C                     END                                            BHF465
     C*                                                                   S01297
     C********** PMRSTM    IFEQ 01                                  S01297LN0691
     C********** PMRSTM    OREQ 08                                  S01297LN0691
     C********** PMRSTM    OREQ 07                                  S01297LN0691
     C********** PMPSTM    IFEQ 01                                  LN0691BHF517
     C********** PMPSTM    OREQ 08                                  LN0691BHF517
     C           PMPSTM    IFEQ 08                                        BHF517
     C           PMDEFT    ANDEQ'Y'                                       LN0787
     C           PMPSTM    OREQ 07                                        LN0691
     C********** PMDEFT    ANDEQ'Y'                                 LN0787BHF758
     C           PMPSTM    OREQ 01                                        E26971
     C           PMDEFT    ANDEQ'Y'                                       E26971
     C                     EXSR DEFLT                      DEFAULTING     S01297
     C                     ELSE                                           S01297
     C                     MOVEA*BLANK    ERCD                            S01297
     C                     Z-ADD1         S       30                      S01297
     C                     END                                            S01297
     C*                                                                   S01297
     C/COPY WNCPYSRC,SD2410C033
     C                     EXSR V01                        VALIDATION
     C*                                                                   113832
     C* Re-initialise flags to validate settlement fields again if        113832
     C* user changes them after initial validation                        113832
     C*                                                                   113832
     C           CLE003    IFEQ 'Y'                                       113832
     C           COUNT     IFEQ 3                                         113832
     C           COUNT1    OREQ 3                                         113832
     C                     Z-ADD1         COUNT                           113832
     C                     Z-ADD1         COUNT1                          113832
     C                     MOVELCOUNT     PMCMDP                          113832
     C                     MOVE COUNT1    PMCMDP                          113832
     C                     ENDIF                                          113832
     C                     ENDIF                                          113832
      *
      **   IF any errors found, set settlement details valid parameter
      **   to 'N'
      *
     C                     MOVEAERCD      PMERCD           *1
     C           PMERCD    IFNE *BLANKS                    B*2
     C                     MOVE 'N'       PMSDTV           **2
     C*********************MOVE 'Y'       PMDEFT                    LN0759LN0787
     C                     END                             E*2
     C*
     C*   If errors found on an amendment set the appropriate redefault   LN0787
     C*   parameter. (*in30 = receipt error, *in31 = payment error)       LN0787
     C*                                                                   LN0787
     C           PMERCD    IFNE *BLANKS                                   LN0787
     C           PMACTC    ANDEQ'A'                                       LN0787
     C           *IN30     IFEQ '1'                                       LN0787
     C                     MOVE 'Y'       PMDEFR                          LN0787
     C                     END                                            LN0787
     C           *IN31     IFEQ '1'                                       LN0787
     C                     MOVE 'Y'       PMDEFT                          LN0787
     C                     END                                            LN0787
     C                     END                                            LN0787
     C*                                                                   LN0787
     C                     ELSE                            X1
     C*
     C** OTHERWISE TERMINATION PARAMETER = T
     C*
     C***CALL ACCESS OBJECTS TO CLOSE ALL FILES                           S01117
     C*****                EXSR Z01                                       S01117
     C*
     C** TERMINATE PROGRAM WITH LR ON
     C*
     C                     MOVE '1'       *INLR            *1
     C                     END                             E1
     C*
     C                     RETRN
     C/EJECT
     C*****************************************************************
     C** V01    - VALIDATION OF SCREEN DETAILS RECEIVED
     C**
     C** CALLED BY : MAIN
     C** CALLS SR  : CHKFL;BTBVAL
     C**
     C           V01       BEGSR
     C           *NAMVAR   DEFN           LDA                             E24039
     C           *LOCK     IN   LDA                                       E24039
     C                     OUT  LDA                                       E24039
     C                     MOVEA'00000000'*IN,36
     C                     MOVEA'00000000'*IN,44
     C                     MOVE '0'       *IN61                           E22405
     C                     MOVEA'00'      *IN,30                          LN0787
     C*                                                                   CEU003
     C                     MOVE '0'       *IN08                           CEU003
     C                     MOVE '0'       *IN11                           CEU003
     C                     MOVE '0'       *IN14                           CEU003
     C**
     C**********           MOVEA*BLANK    ERCD                            S01297
     C                     MOVE 'Y'       PMSDTV
      *                                                                   DT0168
      ***Set*pay*branch*flag*if*the*settlement*branch*has*been*set*uDT0168139921
      *                                                             DT0168139921
     C********** PMPOBR    IFNE *BLANKS                             DT0168139921
     C**********           MOVE 'Y'       PBRF                      DT0168139921
     C**********           END                                      DT0168139921
     C**
     C*****                MOVE *BLANKS   RTCD    7                       S01117
     C*****                MOVEL'*KEY   ' OPTN    7                       S01117
     C*****                MOVE PMBRCD    DSNB    3                       S01117
     C*****                MOVE *BLANKS   A8RF                            S01117
      *****                                                               S01117
     C*****                CALL 'AOBRCHR0'             90                 S01117
      *****                                                               S01117
     C*****                PARM           RTCD                            S01117
     C*****                PARM           OPTN                            S01117
     C*****                PARM           DSNB                            S01117
     C*****                PARM           A8RF                            S01117
      *****                                                               S01117
     C*****      RTCD      IFNE *BLANKS                                   S01117
     C*****      *IN90     OREQ '1'                                       S01117
      *****                                                               S01117
     C*****                MOVEL'BRCH '   PMDBFL           ************** S01117
     C*****                MOVEL'SDKUUPR' PMDPGM           ** DBASE 01 ** S01117
     C*****                Z-ADD01        PMDBSE           ************** S01117
     C*****                MOVE 'T'       PMTERM                          S01117
     C*****                SETON                     U7U8LR               S01117
     C*****                RETRN                                          S01117
     C*****                END                                            S01117
     C**
     C**********           Z-ADD1         S       30                      S01297
     C*                                                                   S01408
     C/COPY WNCPYSRC,SD2410CP14                                           S01408
     C*                                                                   S01408
     C**  Validation of Receipt Settlement Currency                       CEU003
     C*                                                                   CEU003
     C**  If CEU003 is supported                                          CEU003
     C*                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C           PMDTPY    IFLT PMDTRC                                    CEU003
     C           PMDTPY    ANDGT0                                         CEU003
     C           PMDTRC    OREQ 0                                         CEU003
     C                     Z-ADDPMDTPY    WDTRP   50                      CEU003
     C                     ELSE                                           CEU003
     C                     Z-ADDPMDTRC    WDTRP                           CEU003
     C                     ENDIF                                          CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C           PMACTC    IFEQ 'X'                                       CEU003
     C           PMPRCV    OREQ 'N'                                       CEU003
     C*                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C           PMCPGM    ANDNE'SSI'                                     CEU003
     C           CLE031    OREQ 'Y'                                                           CLE031
     C           PMCPGM    ANDNE'SSI'                                                         CLE031
     C           PMCPGM    ANDEQ'LEND'                                                        CLE031
     C*                                                                   CEU003
     C**  Access Currency Details                                         CEU003
     C*                                                                   CEU003
     C                     CALL 'AOCURRR0'                                CEU003
     C                     PARM '*DBERR ' PRTCD                           CEU003
     C                     PARM '*KEY   ' POPTN                           CEU003
     C                     PARM PMRCCY    PCURR   3                       CEU003
     C           SDCURR    PARM SDCURR    DSSDY                           CEU003
     C*                                                                   CEU003
     C           PMRSCY    IFNE *BLANKS                                   CEU003
     C*                                                                   CEU003
     C**  Access Currency Details                                         CEU003
     C*                                                                   CEU003
     C           CLE031    IFEQ 'Y'                                                           CLE031
     C           PMCPGM    ANDEQ'LEND'                                                        CLE031
     C                     MOVE *BLANKS   ARINCY                                              CLE031
     C                     MOVE *BLANKS   BRINCY                                              CLE031
     C                     MOVE *BLANKS   BRDLCI                                              CLE031
     C                     MOVE *ZEROS    AMREXR                                              CLE031
     C                     MOVE *BLANKS   AMREXI                                              CLE031
     C                     MOVE A6INCY    ARINCY  1                                           CLE031
     C                     MOVE A6SPRT    ARSPRT                                              CLE031
     C                     MOVE A6MDIN    ARMDIN                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     CALL 'AOCURRR0'                                CEU003
     C                     PARM *BLANKS   PRTCD                           CEU003
     C                     PARM '*KEY    'POPTN                           CEU003
     C                     PARM PMRSCY    PCURR   3                       CEU003
     C           SDCURR    PARM SDCURR    DSSDY                           CEU003
     C*                                                                   CEU003
     C**  Receipt settlement currency is invalid                          CEU003
     C*                                                                   CEU003
     C           PRTCD     IFNE *BLANKS                                   CEU003
     C                     MOVE '862'     ERCD,S                          CEU003
     C                     ADD  1         S                               CEU003
     C                     MOVE '1'       *IN08                           CEU003
     C                     ELSE                                           CEU003
     C*                                                                   CEU003
     C                     MOVELA6CYCD    PMRSCY                          CEU003
     C                     MOVELA6NBDP    WRSDP   3                       CEU003
     C*                                                                   CEU003
      *                                                                                       CLE031
      **  CLE031 enhancement allows settlement of In-ccy or Euro currency                     CLE031
      **  against other currencies                                                            CLE031
      *                                                                                       CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
     C           PMCPGM    ANDEQ'LEND'                                                        CLE031
     C           ARINCY    ANDNE'Y'                                                           CLE031
     C           PMRSCY    ANDNE*BLANKS                                                       CLE031
     C                     MOVE A6SPRT    AMREXR                                              CLE031
     C                     MOVE A6MDIN    AMREXI                                              CLE031
     C                     MOVE A6DLCI    BRDLCI  1                                           CLE031
     C                     MOVE A6INCY    BRINCY  1                                           CLE031
     C                     ELSE                                                               CLE031
      *                                                                                       CLE031
     C           PMRCCY    IFEQ BKEURO                                    CEU003
     C*                                                                   CEU003
     C***********WDTRP     IFLT A6TPSD                             CEU003 134935
     C***********          MOVEL'N'       A6INCY                   CEU003 134935
     C***********          ENDIF                                   CEU003 134935
     C*                                                                   CEU003
     C**  Buy Currency is Euro but currency is not an 'In' currency       CEU003
     C**  or settlement ccy is not part of EMU during value date          CEU003
     C*                                                                   CEU003
     C           A6INCY    IFNE 'Y'                                       CEU003
     C                     MOVE '850'     ERCD,S                          CEU003
     C                     ADD  1         S                               CEU003
     C                     MOVE '1'       *IN08                           CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     ELSE                                           CEU003
     C*                                                                   CEU003
     C**  Buy currency is an 'In' currency but the currency is not        CEU003
     C**  equal to the Euro currency code                                 CEU003
     C*                                                                   CEU003
     C           PMRSCY    IFNE BKEURO                                    CEU003
     C                     MOVE '851'     ERCD,S                          CEU003
     C                     ADD  1         S                               CEU003
     C                     MOVE '1'       *IN08                           CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     ENDIF                                          CEU003
      *                                                                                       CLE031
     C                     ENDIF                                                              CLE031
     C*                                                                   CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C**  Validation of Payment Settlement Currency                       CEU003
     C*                                                                   CEU003
     C*                                                                   CEU003
     C           PMACTC    IFEQ 'X'                                       CEU003
     C           PMPPAY    OREQ 'N'                                       CEU003
     C*                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C           CLE031    OREQ 'Y'                                                           CLE031
     C*                                                                   CEU003
     C**  Access Currency Details                                         CEU003
     C*                                                                   CEU003
     C                     CALL 'AOCURRR0'                                CEU003
     C                     PARM '*DBERR ' PRTCD                           CEU003
     C                     PARM '*KEY   ' POPTN                           CEU003
     C                     PARM PMPCCY    PCURR                           CEU003
     C           SDCURR    PARM SDCURR    DSSDY                           CEU003
     C*                                                                   CEU003
     C           CLE031    IFEQ 'Y'                                                           CLE031
     C           PMCPGM    ANDEQ'LEND'                                                        CLE031
     C                     MOVE *BLANKS   APINCY                                              CLE031
     C                     MOVE *BLANKS   BPINCY                                              CLE031
     C                     MOVE *BLANKS   BPDLCI                                              CLE031
     C                     MOVE *ZEROS    AMPEXR                                              CLE031
     C                     MOVE *BLANKS   AMPEXI                                              CLE031
     C                     MOVE A6INCY    APINCY  1                                           CLE031
     C                     MOVE A6SPRT    APSPRT                                              CLE031
     C                     MOVE A6MDIN    APMDIN                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C           A6INCY    IFEQ 'Y'                                       CEU003
     C           PMPCCY    OREQ BKEURO                                    CEU003
     C           CLE031    OREQ 'Y'                                                           CLE031
     C*                                                                   CEU003
     C**  Access Currency Details                                         CEU003
     C*                                                                   CEU003
     C           PMPSCY    IFNE *BLANKS                                   CEU003
     C*                                                                   CEU003
     C                     CALL 'AOCURRR0'                                CEU003
     C                     PARM *BLANKS   PRTCD                           CEU003
     C                     PARM '*KEY    'POPTN                           CEU003
     C                     PARM PMPSCY    PCURR                           CEU003
     C           SDCURR    PARM SDCURR    DSSDY                           CEU003
     C*                                                                   CEU003
     C**  Payment settlement currency is invalid                          CEU003
     C*                                                                   CEU003
     C           PRTCD     IFNE *BLANKS                                   CEU003
     C                     MOVE '848'     ERCD,S                          CEU003
     C                     ADD  1         S                               CEU003
     C                     MOVE '1'       *IN11                           CEU003
     C                     ELSE                                           CEU003
     C*                                                                   CEU003
     C                     MOVELA6CYCD    PMPSCY                          CEU003
     C                     MOVELA6NBDP    WPSDP   3                       CEU003
     C*                                                                   CEU003
      *                                                                                       CLE031
      **  CLE031 enhancement allows settlement of In-ccy or Euro currency                     CLE031
      **  against other currencies                                                            CLE031
      *                                                                                       CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
     C           PMCPGM    ANDEQ'LEND'                                                        CLE031
     C           APINCY    ANDNE'Y'                                                           CLE031
     C           PMPSCY    ANDNE*BLANKS                                                       CLE031
     C                     MOVE A6SPRT    AMPEXR                                              CLE031
     C                     MOVE A6MDIN    AMPEXI                                              CLE031
     C                     MOVE A6DLCI    BPDLCI  1                                           CLE031
     C                     MOVE A6INCY    BPINCY  1                                           CLE031
     C                     ELSE                                                               CLE031
      *                                                                                       CLE031
     C           PMPCCY    IFEQ BKEURO                                    CEU003
     C*                                                                   CEU003
     C***********WDTRP     IFLT A6TPSD                             CEU003 134935
     C***********PMCPGM    ANDNE'SSI'                              CEU003 134935
     C***********          MOVEL'N'       A6INCY                   CEU003 134935
     C***********          ENDIF                                   CEU003 134935
     C*                                                                   CEU003
     C**  Sell currency is Euro but the currency is not an 'In' currency  CEU003
     C**  or settlement ccy is not part of EMU during value date          CEU003
     C*                                                                   CEU003
     C           A6INCY    IFNE 'Y'                                       CEU003
     C                     MOVE '853'     ERCD,S                          CEU003
     C                     ADD  1         S                               CEU003
     C                     MOVE '1'       *IN11                           CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     ELSE                                           CEU003
     C*                                                                   CEU003
     C*                                                                   CEU003
     C**  Sell Currency is an 'In' currency but payment settlement        CEU003
     C**  currency is not equal to Euro currency code                     CEU003
     C*                                                                   CEU003
     C           PMPSCY    IFNE BKEURO                                    CEU003
     C                     MOVE '854'     ERCD,S                          CEU003
     C                     ADD  1         S                               CEU003
     C                     MOVE '1'       *IN11                           CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     ENDIF                                          CEU003
      *                                                                                       CLE031
     C                     ENDIF                                                              CLE031
     C*                                                                   CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C**  Settlement method is 00 and settlement ccy is not               CEU003
     C**  blank                                                           CEU003
     C*                                                                   CEU003
     C           PMCPGM    IFEQ 'SSI'                                     CEU003
     C           PMRSTM    ANDEQ00                                        CEU003
     C           PMPSTM    ANDEQ00                                        CEU003
     C                     MOVE '842'     ERCD,S                          CEU003
     C                     ADD  1         S                               CEU003
     C                     MOVE '1'       *IN11                           CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     ELSE                                           CEU003
     C*                                                                   CEU003
     C**  Transaction currency is an 'Out' currency                       CEU003
     C*                                                                   CEU003
     C           PMPSCY    IFNE *BLANKS                                   CEU003
     C                     MOVE '844'     ERCD,S                          CEU003
     C                     ADD  1         S                               CEU003
     C                     MOVE '1'       *IN11                           CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C           CLE031    IFEQ 'Y'                                                           CLE031
     C           PMCPGM    ANDEQ'LEND'                                                        CLE031
     C                     ELSE                                                               CLE031
      *                                                                                       CLE031
     C           CEU003    IFEQ 'Y'                                       CEU003
     C           PMCPGM    ANDNE'FXFX'                                    CEU003
     C           PMPRCV    ANDEQ'N'                                       CEU003
     C           PMPPAY    ANDEQ'N'                                       CEU003
     C           PMPSCY    ANDNEPMRSCY                                    CEU003
     C           PMTTYP    ANDNE'RX'                                      CEU003
     C                     MOVE '847'     ERCD,S                          CEU003
     C                     ADD  1         S                               CEU003
     C                     MOVE '1'       *IN08                           CEU003
     C                     MOVE '1'       *IN11                           CEU003
     C                     ENDIF                                          CEU003
      *                                                                                       CLE031
     C                     ENDIF                                                              CLE031
     C*                                                                   CEU003
     C**  Effective receipt settlement currency                           CEU003
     C*                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C           PMRSCY    ANDNE*BLANKS                                   CEU003
     C           *IN08     ANDEQ'0'                                       CEU003
     C                     MOVELPMRSCY    WRECY   3                       CEU003
     C                     ELSE                                           CEU003
     C                     MOVELPMRCCY    WRECY                           CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C**  Effective Payment Settlement Currency                           CEU003
     C*                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C           PMPSCY    ANDNE*BLANKS                                   CEU003
     C           *IN11     ANDEQ'0'                                       CEU003
     C                     MOVELPMPSCY    WPECY   3                       CEU003
     C                     ELSE                                           CEU003
     C                     MOVELPMPCCY    WPECY                           CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C********** PMACTC    IFNE 'X'                                       118948
     C********** PMPRCV    CABEQ'Y'       PAYMNT                          118948
     C**********           END                                            118948
      *                                                                                       260577
      ** This part should not be ommitted as to condition whether there                       260577
      ** is a need to validate receipt side or not.  Just change to                           260577
      ** bypass validation even if action code is 'X'                                         260577
      *                                                                                       260577
     C           PMPRCV    CABEQ'Y'       PAYMNT                                              260577
     C*
     C** VALIDATE RECEIPT
     C** ================
      *
     C********** PMROCN    IFEQ '000000'                                                      CSD027
     C**********           MOVE *BLANKS   PMROCN                                              CSD027
     C**********           END                                                                CSD027
     C********** PMROBN    IFEQ '000000'                                                      CSD027
     C**********           MOVE *BLANKS   PMROBN                                              CSD027
     C**********           END                                                                CSD027
     C*                                                                   S01117
     C** BLANK OUT WORK FIELD @OBR & DATA STRUCTURES FOR RECEIPT          S01117
     C** INSTRUCTIONS VALIDATION.                                         S01117
     C                     MOVE *BLANKS   @OBR                            S01117
     C                     MOVE *BLANKS   ALRF                            S01117
     C                     MOVE *BLANKS   CURF                            S01117
     C                     MOVE *BLANKS   A7RF                            S01117
     C                     MOVE *BLANKS   ACCT                            S01117
     C                     MOVE *BLANKS   DMRF                            S01117
     C                     MOVE *BLANKS   SDBRCH                          S01117
     C*
     C** ENTRY IN ALL RECEIPT INSTRUCTIONS PROHIBITED IF RECEIPT
     C** SETTLEMENT METHOD IS 00
     C           PMRSTM    IFEQ 00                         B1
     C*                                                                   E00033
     C***********PMROBR    IFNE *BLANKS                    B*2     E00033 S01117
     C*********************MOVE *BLANKS   PMROBR           **2     E00033 S01117
     C*********************END                             E*2     E00033 S01117
     C*                                                                   E00033
     C           PMRONS    IFNE *BLANKS                    B*2
     C           PMROBN    ORNE *BLANKS                    **2
     C           PMROCN    ORNE *BLANKS                    **2
     C           PMRIBN    ORNE *BLANK                     **2
     C           PMRIBA    ORNE *BLANK                     **2
     C***********PMOPSB    ORNE *BLANKS                    **2            S01117
     C           PMROBR    ORNE *BLANKS                    **2            S01117
     C           PMRBB1    ORNE *BLANKS                                                       CDL094
     C           PMRBB2    ORNE *BLANKS                                                       CDL094
     C           PMRBB3    ORNE *BLANKS                                                       CDL094
     C           PMRBB4    ORNE *BLANKS                                                       CDL094
     C           PMRBB5    ORNE *BLANKS                                                       CDL094
     C           PMRBB6    ORNE *BLANKS                                                       CDL094
     C                     MOVE '900'     ERCD,S           **2
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN30            **2            LN0787
     C                     END                             E*2
     C                     END                             E1
     C*
     C** ENTRY PROHIBITED FOR ORDERING CUSTOMER; ORDERING BANK; INTERM.
     C***BANK*AND*INTERM.*BANK*A/C*LINE*UNLESS*SETTL.TP*IS*01*07*OR*08    CLE033
     C** BANK AND INTERM. BANK A/C LINE UNLESS SETTL.TP IS 01 07 08 OR 09 CLE033
     C           PMRSTM    IFNE 01                         B1
     C           PMRSTM    ANDNE07                         *1
     C           PMRSTM    ANDNE08                         *1
     C           CLE033    ANDNE'Y'                        *1             CLE033
     C           PMRSTM    ORNE 01                         B1             CLE033
     C           PMRSTM    ANDNE07                         *1             CLE033
     C           PMRSTM    ANDNE08                         *1             CLE033
     C           CLE033    ANDEQ'Y'                        *1             CLE033
     C           PMRSTM    ANDNE09                         *1             CLE033
     C           PMROCN    IFNE *BLANKS                    B*2
     C           PMROBN    ORNE *BLANKS                    **2
     C           PMRIBN    ORNE *BLANK                     **2
     C/COPY WNCPYSRC,SD2410C063
     C           PMRIBA    ORNE *BLANK                     **2
     C           PMRBB1    ORNE *BLANKS                                                       CDL094
     C           PMRBB2    ORNE *BLANKS                                                       CDL094
     C           PMRBB3    ORNE *BLANKS                                                       CDL094
     C           PMRBB4    ORNE *BLANKS                                                       CDL094
     C           PMRBB5    ORNE *BLANKS                                                       CDL094
     C           PMRBB6    ORNE *BLANKS                                                       CDL094
     C                     MOVE '901'     ERCD,S           **2
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN30            **2            LN0787
     C           PMROCN    IFNE *BLANKS                    B**3
     C                     MOVE '1'       *IN37            ***3
     C                     END                             E**3
     C           PMROBN    IFNE *BLANKS                    B**3
     C                     MOVE '1'       *IN39            ***3
     C                     END                             E**3
     C           PMRIBN    IFNE *BLANK                     B**3
     C                     MOVE '1'       *IN43            ***3
     C                     END                             E**3
     C           PMRIBA    IFNE *BLANK                     B**3
     C                     MOVE '1'       *IN45            ***3
     C                     END                             E**3
     C                     END                             E*2
     C                     END                             E1
     C*
     C/COPY WNCPYSRC,SD2410C079
     C*
     C** SETTLEMENT METHOD
     C** -----------------
     C*
     C***MUST*BE*00,01,02,03,04,05,06,07,08,12*OR*14***                   CLE033
     C** MUST BE 00,01,02,03,04,05,06,07,08,09,12 OR 14                   CLE033
     C           PMRSTM    IFNE 00                         B1
     C           PMRSTM    ANDNE01                         *1
     C           PMRSTM    ANDNE02                         *1
     C           PMRSTM    ANDNE03                         *1
     C           PMRSTM    ANDNE04                         *1
     C           PMRSTM    ANDNE05                         *1
     C           PMRSTM    ANDNE06                         *1
     C           PMRSTM    ANDNE07                         *1
     C           PMRSTM    ANDNE08                         *1
     C           PMRSTM    ANDNE12                         *1
     C           PMRSTM    ANDNE14                         *1
     C           CLE033    ANDNE'Y'                        *1             CLE033
     C           PMRSTM    ORNE 00                         B1             CLE033
     C           PMRSTM    ANDNE01                         *1             CLE033
     C           PMRSTM    ANDNE02                         *1             CLE033
     C           PMRSTM    ANDNE03                         *1             CLE033
     C           PMRSTM    ANDNE04                         *1             CLE033
     C           PMRSTM    ANDNE05                         *1             CLE033
     C           PMRSTM    ANDNE06                         *1             CLE033
     C           PMRSTM    ANDNE07                         *1             CLE033
     C           PMRSTM    ANDNE08                         *1             CLE033
     C           PMRSTM    ANDNE12                         *1             CLE033
     C           PMRSTM    ANDNE14                         *1             CLE033
     C           CLE033    ANDEQ'Y'                        *1             CLE033
     C           PMRSTM    ANDNE09                         *1             CLE033
     C                     MOVE '902'     ERCD,S           *1
     C                     ADD  1         S                *1
     C                     MOVE '1'       *IN30            **2            LN0787
     C                     END                             E1
      *                                                                   CDL008
     C           CDL008    IFEQ 'Y'                                       CDL008
     C           PMTTYP    ANDEQ'CL'                                      CDL008
     C           PMRSTM    ANDNE00                                        186433
     C           PMRSTM    ANDNE01                                        CDL008
     C           PMRSTM    ANDNE07                                        CDL008
     C           PMRSTM    ANDNE08                                        CDL008
     C           PMRSTM    ANDNE02                                        CDL008
     C           PMRSTM    ANDNE12                                        CDL008
     C                     MOVE '303'     ERCD,S                          CDL008
     C                     ADD  1         S                               CDL008
     C                     MOVE *ON       *IN30                           CDL008
     C                     ENDIF                                          CDL008
     C*
     C** IF SETL TYPE IS 04 OR 14 THE RETAIL MODULE MUST BE PRESENT
     C           PMRSTM    IFEQ 04                         B1
     C           PMRSTM    OREQ 14                         *1
     C           PMRETP    IFNE 'Y'                        B*2
     C                     MOVE '903'     ERCD,S           **2
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN30            **2            LN0787
     C                     END                             E*2
     C                     END                             E1
     C*
     C** IF REC SETL METHOD IS 04 A LIVE RECORD MUST EXIST IN ACCNTAB
     C           PMRSTM    IFEQ 04                         B1
     C                     MOVEL*BLANK    ACID             *1             LN0830
     C                     MOVELPMCSNM    ACID   10        *1
     C***********          MOVE PMRCCY    CUCD    3        *1             CEU003
     C                     MOVE WRECY     CUCD    3                       CEU003
     C                     MOVE '01'      ACSQA   2
     C**********           MOVE PMPCYA    ACCD    4                                           CGL029
     C                     MOVE PMPCYA    ACCD   10                                           CGL029
     C                     MOVE PMBRCA    BRCD             *1             S01117
      *                                                                   S01117
      ** SET UP SETTLEMENT BRANCH FOR FILE UPDATES BY OTHER PGMS          S01117
      ***SET*ON*RECEIVE*BRANCH*FLAG*TO*SIGNIFY*PROGRAM*HAS*SET      S01117139921
      ***THIS*FIELD*UP***                                           S01117139921
     C           PMROBR    IFEQ *BLANKS                    B*2            S01117
     C                     MOVE PMBRCA    PMROBR           **2            S01117
     C**********           MOVE 'Y'       RBRF             **2      S01117139921
     C                     END                             B*2            S01117
      *                                                                   S01117
     **  FOR STANDING DATA - EXTENDED SETTLEMENTS:                        S01117
     **  FOR SETTLEMENT TYPE 04 ONLY PARTIAL CHECKING OF ACCOUNT          S01117
     **  ENTERED CAN BE DONE AS NOT ALL DETAILS ARE AVAILABLE.            S01117
     **  THEREFORE SUBROUTINE CHKAC SHOULD NOT BE CALLED.                 S01117
     C           PMCPGM    IFEQ 'SSI '                     B1             S01117
     C                     MOVE *BLANKS   RTCD             *1             S01117
     C                     MOVE '865'     ERCD,S           *1             S01117
     C                     MOVE 'Y'       @SENT            *1             S01117
     C                     ADD  1         S                *1             S01117
     C                     MOVE '1'       *IN30            **2            LN0787
     C                     ELSE                            X1             S01117
     C                     EXSR CHKAC                      *1             S01117
     C**********           END                             E1                          S01117 240971
      *
     C           RTCD      IFNE *BLANKS                    B*2
     C           RECI      ORNE 'D'                        B*2            E24104
     C           ACST      OREQ 'C'                                       060470
     C                     MOVE '904'     ERCD,S           **2
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN30            **2            LN0787
      *                                                                   S01408
      /COPY WNCPYSRC,SD2410CCP3                                           S01408
      *                                                                   S01408
     C                     ENDIF                                                              240971
     C                     END                             E*2
     C                     END                             E1
     C*
     C** IF SETL TYPE IS 07 THE RECEIPT CURRENCY MUST BE USD
     C           PMRSTM    IFEQ 07                         B1
     C           PMRCCY    ANDNE'USD'                      *1
     C                     MOVE '905'     ERCD,S           *1
     C                     ADD  1         S                *1
     C                     MOVE '1'       *IN30            **2            LN0787
     C                     END                             E1
     C*
     C** IF SETL TYPE IS 14 THE RETAIL ACCOUNT NUMBER MUST BE SUPPORTED
     C           PMRSTM    IFEQ 14                         B1
     C           PMRETS    ANDNE'Y'                        *1
     C                     MOVE '906'     ERCD,S           *1
     C                     ADD  1         S                *1
     C                     MOVE '1'       *IN30            **2            LN0787
     C                     END                             E1
     C*                                                                   CLE033
     C** IF SETTLEMENT 09 ACCOUNT CODE IS RETAIL                          CLE033
     C           A5ACTY    IFEQ 'R'                        B1             CLE033
     C           CLE033    ANDEQ'Y'                                       CLE033
     C           PMRSTM    ANDEQ09                                        CLE033
     C*                                                                   CLE033
     C           PMRSCY    IFNE *BLANKS                    B2             CLE033
     C           SET09     ANDNE'T'                                                           218782
     C                     MOVE PMRSCY    W0RSCY  3                       CLE033
     C                     ENDIF                           E2             CLE033
     C*                                                                   CLE033
     C           PMRSCY    IFEQ *BLANKS                    B2             CLE033
     C           SET09     OREQ 'T'                                                           218782
     C                     MOVE PMRCCY    W0RSCY                          CLE033
     C                     ENDIF                           E2             CLE033
     C*                                                                   CLE033
     C**********           MOVELP@VL02    W0ACCD  4                                    CLE033 CGL029
     C                     MOVELP@VL02    W0ACCD 10                                           CGL029
     C                     MOVELP@VL01    W0CNUM  6                       CLE033
     **  For Standing Data - Extended Settlements:                                            218906
     **  For Settlement Type 09, only partial checking of account                             218906
     **  entered can be done, as not all details are available.                               218906
     **  Therefore subroutine AOACCTR0 should not be called.                                  218906
     C           PMCPGM    IFNE 'SSI '                     If not SSI                         218906
     C*                                                                   CLE033
     C                     CALL 'AOACCTR0'                                CLE033
     C                     PARM *BLANKS   P@RTCD  7                       CLE033
     C                     PARM '*KEY   ' P@OPTN  7                       CLE033
     C                     PARM *BLANKS   P@RETL 10                       CLE033
     C                     PARM W0CNUM    P@CNUM  6                       CLE033
     C                     PARM W0RSCY    P@CUCD  3                       CLE033
     C**********           PARM W0ACCDS   P@ACCD  4                                    CLE033 CGL029
     C                     PARM *BLANKS   P@ACCD 10                                           CGL029
     C                     PARM '01'      P@ACSQ  2                       CLE033
     C                     PARM PMBRCA    P@BRCA  3                       CLE033
     C           ACCT      PARM ACCT      DSSDY                           CLE033
     C*                                                                   CLE033
     C           P@RTCD    IFNE *BLANKS                    B2             CLE033
     C           RECI      ORNE 'D'                                       CLE033
     C           ATYP      ORNE 'R'                                       CLE033
     C                     MOVE '904'     ERCD,S           *1             CLE033
     C                     ADD  1         S                *1             CLE033
     C                     MOVE '1'       *IN30            **2            CLE033
     C                     ENDIF                           E2             CLE033
     C*                                                                   CLE033
     C                     ENDIF                           End not SSI                        218906
      *                                                                                       218906
     C                     ENDIF                           E1             CLE033
     C/COPY WNCPYSRC,SD2410C022
     C**                                                                  S01117
     C** SETTLEMENT BRANCH                                                S01117
     C** -----------------                                                S01117
     C*                                                                   S01117
     C** Only validate Branch in multi-branching environment.             S01117
     C           @MBIN     IFEQ 'Y'                                       S01117
     C*                                                                   S01117
     C***SETTLEMENT*BRANCH*ONLY*ALLOWED*WITH*SETTLEMENT*METHOD*05.  S01117139921
     C** If Settlement Type not '05', blank out Receive Branch -          139921
     C** this will be initialised with the correct branch code.           139921
     C           PMRSTM    IFNE 05                         B1             S01117
     C           PMRSTM    ANDNE04                          1             141865
     C           CLE033    ANDNE'Y'                         1             CLE033
     C           PMRSTM    ORNE 05                          1             CLE033
     C           PMRSTM    ANDNE04                          1             CLE033
     C           CLE033    ANDEQ'Y'                         1             CLE033
     C           PMRSTM    ANDNE09                          1             CLE033
     C*                                                                   S01117
     C                     MOVE *BLANKS   PMROBR           B1             139921
     C*                                                                   139921
     C***If*Receive*Branch*entered*by*user*then*an*error*has*occurreS01117139921
     C********** RBRF      IFEQ *BLANKS                    B*2      S01117139921
     C********** PMROBR    ANDNE*BLANKS                    **2      S01117139921
     C**********           MOVE '886'     ERCD,S           **2      S01117139221
     C**********           ADD  1         S                **2      S01117139921
     C**********           MOVE '1'       *IN30            **2      LN0787139921
     C**********           END                             E*2      S01117139921
     C*                                                                   S01117
     C                     ELSE                            X1             S01117
     C*                                                                   S01117
     C           CLE033    IFEQ 'Y'                                       CLE033
     C           PMRSTM    ANDEQ09                                        CLE033
     C*                                                                   CLE033
     C** No processing for condition, only on ELSE.                       CLE033
     C*                                                                   CLE033
     C                     ELSE                                           CLE033
     C*                                                                   CLE033
     C** SETTLEMENT BRANCH MANDATORY WITH SETTLEMENT METHOD 05.           S01117
     C           PMROBR    IFEQ *BLANKS                    B*2            S01117
     C                     MOVE '885'     ERCD,S           **2            S01117
     C                     ADD  1         S                **2            S01117
     C                     MOVE '1'       *IN30            **2            LN0787
     C*                                                                   S01117
     C                     ELSE                            X*2            S01117
     C*                                                                   S01117
     C** VALIDATE SETTLEMENT BRANCH                                       S01117
     C                     MOVE PMROBR    @OBR    3        **2            S01117
     C                     EXSR CHKBR                      **2            S01117
     C*                                                                   S01117
     C           @RTCD     IFEQ '*NOSEL '                  B**3           S01117
     C                     MOVE '863'     ERCD,S           ***3           S01117
     C                     ADD  1         S                ***3           S01117
     C                     MOVE '1'       *IN30            **2            LN0787
     C                     END                             E**3           S01117
     C*                                                                   S01117
     C           @RTCD     IFNE *BLANKS                    B**3           S01117
     C                     MOVE '884'     ERCD,S           ***3           S01117
     C                     ADD  1         S                ***3           S01117
     C                     MOVE '1'       *IN30            **2            LN0787
     C                     ELSE                            ***3           S01117
     C                     MOVE @DSNB     PMROBR           ***3           S01117
     C                     END                             E**3           S01117
     C                     END                             E*2            S01117
     C                     END                             E1             S01117
     C*                                                                   S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDIF                                          CLE033
     C*
     C** OUR NOSTRO
     C** ----------
     C*
     C                     MOVE *BLANKS   RNOST   6
     C                     MOVE PMRONS    NOSTRO
     C                     MOVE '0'       *IN69
     C/COPY WNCPYSRC,SD2410C023
     C*
     C** MUST BE BLANK IF SETTLEMENT TYPE IS 00,04 OR 06
     C           PMRSTM    IFEQ 00                         B1
     C           PMRSTM    OREQ 04                         *1
     C           PMRSTM    OREQ 06                         *1
     C           PMRONS    IFNE *BLANK                     B*2
     C                     MOVE '907'     ERCD,S           **2
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN30            **2            LN0787
     C                     END                             E*2
     C                     END                             E1
     C/COPY WNCPYSRC,SD2410C024
     C*
     C** IF SETL TYPE IS 01,02,07,08 OR 12 MUST BE A 2 DIGIT NUMBER
     C** AND IDENTIFY A LIVE RECORD ON THE NOSTRO FILE SDNOSTPD
     C           PMRSTM    IFEQ 01                         B1
     C           PMRSTM    OREQ 02                         *1
     C           PMRSTM    OREQ 07                         *1
     C           PMRSTM    OREQ 08                         *1
     C           PMRSTM    OREQ 12                         *1
     C/COPY WNCPYSRC,SD2410C025
     C                     TESTN          NOST02     60    *1
     C                     MOVEANOST02    @QM                             108517
     C           '?'       LOKUP@QM                      62               108517
     C           *IN60     IFNE '1'                        B*2
     C           *IN62     ANDEQ*OFF                                      108517
     C           NOSTXX    ORNE *BLANKS                    **2
     C                     MOVE '908'     ERCD,S           **2
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN30            **2            LN0787
     C                     MOVE '1'       *IN69            **2            108752
     C                     ELSE                            X*2
      *
     C                     MOVEL'*KEY   ' OPTN    7        **2
     C***********          MOVE PMRCCY    @CYCD                           CEU003
     C                     MOVE WRECY     @CYCD                           CEU003
     C                     MOVE NOST02    @NONB
      *
     C                     EXSR CHKNO                      **2
      *
     C           RTCD      IFNE *BLANKS                    B**3
     C           RTCD      ANDNE'*NOSEL '                                 108517
     C                     MOVE '908'     ERCD,S           ***3
     C                     ADD  1         S                ***3
     C                     MOVE '1'       *IN30            **2            LN0787
     C                     MOVE '1'       *IN69            **2            108752
      *
     C                     ELSE                            ***3
      *
     C           RTCD      IFEQ '*NOSEL'                                  108517
     C                     MOVE '867'     ERCD,S                          108517
     C                     ADD  1         S                               108517
     C                     MOVE *ON       *IN30                           108517
     C                     ELSE                                           108517
      *                                                                   CDL008
      ** Send error message if CLS Dummy Nostro is not Y                  CDL008
      *                                                                   CDL008
     C           CDL008    IFEQ 'Y'                                       CDL008
      *                                                                   CDL008
     C           PMTTYP    IFEQ 'CL'                                      CDL008
     C           A7CLSD    ANDNE'Y'                                       CDL008
     C                     MOVE '301'     ERCD,S                          CDL008
     C                     ADD  1         S                               CDL008
     C                     MOVE *ON       *IN30                           CDL008
     C                     ENDIF                                          CDL008
      *                                                                   CDL008
     C           PMTTYP    IFNE 'CL'                                      CDL008
     C           A7CLSD    ANDEQ'Y'                                       CDL008
     C                     MOVE '305'     ERCD,S                          CDL008
     C                     ADD  1         S                               CDL008
     C                     MOVE *ON       *IN30                           CDL008
     C                     ENDIF                                          CDL008
      *                                                                   CDL008
     C                     ENDIF                                          CDL008
      *                                                                   CDL008
     C                     MOVE A7CUST    RNOST            ***3
     C                     MOVELA7NONB    PMRONS           ***3           108517
     C                     MOVEL*BLANK    ACID             ***3           LN0830
     C                     MOVELA7CUST    ACID             ***3
     C***********          MOVE PMRCCY    CUCD             ***3           CEU003
     C                     MOVE WRECY     CUCD                            CEU003
     C                     MOVE A7ACCD    ACCD             ***3
     C                     MOVE A7ACSN    ACSQA            ***3
     C                     MOVE A7BRCD    BRCD             ***3           S01117
     C                     ENDIF                                          108517
      *                                                                   S01117
      ** SET UP SETTLEMENT BRANCH FOR FILE UPDATES BY OTHER PGMS          S01117
      ***SET*ON*RECEIVE*BRANCH*FLAG*TO*SIGNIFY*PROGRAM*HAS*SET      S01117139921
      ***THIS*FIELD*UP                                              S01117139921
     C           PMROBR    IFEQ *BLANKS                    B***4          S01117
     C                     MOVE A7BRCD    PMROBR           ****4          S01117
     C**********           MOVE 'Y'       RBRF             ****4    S01117139921
     C                     END                             B***4          S01117
      *
     C                     EXSR CHKAC                      ***3
      *
     C           RTCD      IFNE *BLANKS                    B***4
     C           RECI      ORNE 'D'                        B***4          E24104
     C                     MOVE '908'     ERCD,S           ****4          108195
     C                     ADD  1         S                ****4          108195
     C                     MOVE '1'       *IN30            ****4          108195
     C                     MOVE '1'       *IN69            ****4
     C*                                                                   S01117
     C                     ELSE                            X***4          S01117
      *                                                                   S01408
      /COPY WNCPYSRC,SD2410CCP4                                           S01408
      *                                                                   S01408
     C*                                                                   S01117
     C**   IF MULTIBRANCH FLAG OFF NOSTRO MUST EQUAL SINGLE BRANCH        S01117
     C** (ERROR SHOULDNT HAPPEN UNLESS BANK SWITCHES OFF M/B INCORRECTY)  S01117
     C           @MBIN     IFEQ 'N'                        B****5         S01117
     C                     EXSR CHKBK                      *****5         S01117
     C*                                                                   S01117
     C           BJSBRC    IFNE A7BRCD                     B*****6        S01117
     C*********************MOVE '890'     ERCD,S           ******6  S01117LN0785
     C                     MOVE '500'     ERCD,S           ******6        LN0785
     C                     ADD  1         S                ******6        S01117
     C                     MOVE '1'       *IN30            **2            LN0787
     C                     MOVE '1'       *IN69            **2            108752
     C                     END                             E*****6        S01117
     C                     END                             E****5         S01117
     C*                                                                   S01117
     C** RETRIEVE BRANCH INTERNAL CUSTOMER NUMBER ASSOCIATED WITH         S01117
     C** NOSTRO BRANCH FOR VALIDATION LATER.                              S01117
     C                     MOVE A7BRCD    @OBR             ****4          S01117
     C                     EXSR CHKBR                      ****4          S01117
     C*                                                                   S01117
     C                     END                             E***4          S01117
     C                     END                             E**3
     C                     END                             E*2
     C                     END                             E1
     C*
     C***IF*SETL*TYPE*IS*03*MUST*BE*CONTAIN*A*SIX*DIGIT*NUMBER*********   E21702
     C***WHICH*IDENTIFIES*A*LIVE*CUSTOMER*RECORD*ON*FILE*SDCUSTPD******   E21702
     C** IF SETTLEMENT TYPE IS 03, 'OUR NOSTRO' MUST EITHER BE BLANK OR   E21702
     C** CONTAIN A SIX DIGIT DEAL NUMBER (TO COMPENSATE AGAINST).         E21702
     C           PMRSTM    IFEQ 03                         B1
     C           NOSTRO    ANDNE*BLANK                     B1             E21702
     C                     TESTN          NOST06     60    *1
     C           *IN60     IFNE '1'                        B*2
     C           NOSTYY    ORNE *BLANK                     **2
     C                     MOVE '909'     ERCD,S           **2
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN30            **2            LN0787
     C**********           ELSE                            X*2            E21702
      *
     C**********           MOVE *BLANKS   CHKFLD           **2            E21702
     C**********           MOVELNOST06    CHKFLD           **2            E21702
      *
     C**********           MOVE 'N'       @CPNA   1        **2      S01117E21702
     C**********           EXSR CHKFL                      **2            E21702
      *
     C********** RESULT    IFNE 'A'                        B**3           E21702
     C**********           MOVE '909'     ERCD,S           ***3           E21702
     C**********           ADD  1         S                ***3           E21702
     C**********           ELSE                            X**3           E21702
     C**********           MOVE BBCUST    RNOST            ***3           E21702
     C**********           END                             E**3           E21702
     C                     END                             E*2
     C                     END                             E1
     C*
     C** IF SETLEMENT TYPE IS 05 MUST IDENTIFY A LIVE RECORD ON ACCNTAB
     C** (IN COMBINATION WITH RECEIPT CURRENCY)
     C           PMRSTM    IFEQ 05                         B1
     C           NOSTSQ    IFEQ *BLANK                     B*2
     C           NOSTSQ    OREQ '00'                       **2
     C                     MOVE '01'      NOSTSQ           **2
     C                     END                             E*2
     C**********           TESTN          NOST06     60    *1                                 CSD027
     C***60*****           TESTN          NOSTAC     60    *1                                 CSD027
     C                     TESTN          NOSTAC     60    *1                                 CSD027
     C   60                TESTN          NOSTSQ     60    *1
     C           *IN60     IFNE '1'                        B*2
     C                     MOVE '910'     ERCD,S           **2
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN30            **2            LN0787
     C                     MOVE '1'       *IN69            **2            108752
     C                     ELSE                            X*2
      *
     C                     MOVEL*BLANK    ACID             **2            LN0830
     C                     MOVELNOST06    ACID             **2
     C***********          MOVE PMRCCY    CUCD             **2
     C                     MOVE WRECY     CUCD                            CEU003
     C                     MOVE NOSTSQ    ACSQA            **2
     C                     MOVE NOSTAC    ACCD             **2
      * Setup default branch for Receive Branches if MBIN=N               E83
     C           @MBIN     IFEQ 'N'                        B**3           E83
     C                     EXSR CHKBK                      ***3           E83
      *
     C                     MOVE BJSBRC    PMROBR           ***3           E83
     C                     END                             E**3           E83
      *
     C                     MOVE PMROBR    BRCD             **2            S01117
      *                                                                   S01117
      ***SET*OFF*RECEIVE*BRANCH*FLAG*TO*SIGNIFY*USER*HAS*SET        S01117139921
      ***THIS*FIELD*UP                                              S01117139921
     C**********           MOVE *BLANKS   RBRF             **2      S01117139921
     C/COPY WNCPYSRC,SD2410C084
      *
     C                     EXSR CHKAC                      **2
      *
     C           RTCD      IFNE *BLANKS                    B*3
     C           TYPE      OREQ '*SHNAME'                  **3                                CSD027
     C           RECI      ORNE 'D'                        B*3            E24104
     C           ACST      OREQ 'C'                        B*3            056626
     C                     MOVE '910'     ERCD,S           **3
     C                     ADD  1         S                **3
     C                     MOVE '1'       *IN30            **2            LN0787
     C                     MOVE '1'       *IN69            **2            108752
     C                     ELSE                            X*3
      *                                                                   S01408
      /COPY WNCPYSRC,SD2410CCP5                                           S01408
      *                                                                   S01408
     C                     MOVE CNUM      RNOST            **3
     C                     MOVE NOSTRO    PMRONS           **3            066875
     C                     END                             E*3
     C/COPY WNCPYSRC,SD2410C085
     C                     END                             E*2
     C                     END                             E1
     C*
     C** IF SETL TYPE IS 14 NOSTRO  MUST CONTAIN A 10 DIGIT NUMBER
     C** WHICH IDENTIFIES A LIVE RECORD ON FILE ACCNTAB
     C           PMRSTM    IFEQ 14                         B1
     C                     TESTN          NOST10     60    *1
     C           *IN60     IFNE '1'                        B*2
     C           NOSTSQ    ORNE *BLANK                     **2
     C           WNOST1    ORNE *BLANKS                                                     AR853732
     C                     MOVE '911'     ERCD,S           **2
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN30            **2            LN0787
     C                     MOVE '1'       *IN69            **2            108752
     C                     ELSE                            X*2
      *
     C                     MOVELNOST10    ACID             **2
     C                     MOVE *BLANKS   CUCD             **2
     C                     MOVE *BLANKS   ACSQA            **2
     C                     MOVE *BLANKS   ACCD             **2
     C                     MOVE *BLANKS   BRCD             **2            S01117
      *
     C                     EXSR CHKAC                      **2
      *
     C           RTCD      IFNE *BLANKS                    B*3
     C           RECI      ORNE 'D'                        B*3            E24104
     C           ACST      OREQ 'C'                                       060470
     C                     MOVE '911'     ERCD,S           **3
     C                     ADD  1         S                **3
     C                     MOVE '1'       *IN30            **2            LN0787
     C                     MOVE '1'       *IN69            **2            108752
     C                     ELSE                            X*3
      *                                                                   S01408
      /COPY WNCPYSRC,SD2410CCP6                                           S01408
      *                                                                   S01408
     C*                                                                   E45796
     C** Ensure account is not blocked for Debit/Credit                   E45796
     C*                                                                   E45796
     C                     TESTB'2'       RETB           34DEBIT          E45796
     C                     TESTB'3'       RETB           35CREDIT         E45796
     C*                                                                   E45796
     C           *IN34     IFEQ '1'                                       E45796
     C           *IN35     OREQ '1'                                       E45796
     C                     MOVE '991'     ERCD,S                          E45796
     C                     ADD  1         S                               E45796
     C                     MOVE '1'       *IN30                           E45796
     C                     MOVE '1'       *IN69            **2            108752
     C                     END                                            E45796
     C*                                                                   S01408
     C/COPY WNCPYSRC,SD2410CP16                                           S01408
     C*                                                                   S01408
     C*                                                                   E45796
     C                     MOVE CNUM      RNOST            **3
      *                                                                   S01117
      ** SET UP SETTLEMENT BRANCH FOR FILE UPDATES BY OTHER PGMS          S01117
      ***SET*ON*RECEIVE*BRANCH*FLAG*TO*SIGNIFY*PROGRAM*HAS*SET      S01117139921
      ***THIS*FIELD*UP                                              S01117139921
     C           PMROBR    IFEQ *BLANKS                    B***4          S01117
     C                     MOVE BRCA      PMROBR           ****4          S01117
     C**********           MOVE 'Y'       RBRF    1        ****4    S01117139921
     C                     END                             E***4          S01117
     C*
     C** IF SETL IS 14 AND NOSTRO IDENTIFIES A LIVE RECORD ON ACCNTAB
     C** RECEIPT CURRENCY MUST BE SAME AS CURRENCY OF ACCOUNT
     C***********PMRCCY    IFNE CCY                        B***4          CEU003
     C           WRECY     IFNE CCY                                       CEU003
     C           PMCPGM    ANDNE'SSI'                                     137488
     C           PMRCCY    ORNE CCY                                       137488
     C           PMCPGM    ANDEQ'SSI'                                     137488
     C                     MOVE '914'     ERCD,S           ****4
     C                     ADD  1         S                ****4
     C                     MOVE '1'       *IN30            **2            LN0787
     C                     MOVE '1'       *IN69            **2            108752
     C*                                                                   S01117
     C                     ELSE                            X***4          S01117
     C*                                                                   S01117
     C**   IF MULTIBRANCH FLAG OFF NOSTRO MUST EQUAL SINGLE BRANCH        S01117
     C           @MBIN     IFEQ 'N'                        B****5         S01117
     C                     EXSR CHKBK                      *****5         S01117
     C*                                                                   S01117
     C***********BRCA      IFNE A7BRCD                     B*****6 S01117 058132
     C           BRCA      IFNE BJSBRC                     B*****6        058132
     C                     MOVE '888'     ERCD,S           ******6        S01117
     C                     ADD  1         S                ******6        S01117
     C                     MOVE '1'       *IN30            **2            LN0787
     C                     MOVE '1'       *IN69            **2            108752
     C/COPY WNCPYSRC,SD2410C048
     C                     END                             E*****6        S01117
     C                     END                             E****5         S01117
     C*                                                                   S01117
     C                     END                             E***4
     C                     END                             E**3
     C                     END                             E*2
     C                     END                             E1
      *                                                                   191152
      ** If Settlement Currency is EURO (created for a sweep of the       191152
      ** 'In' Currency loan), check if receipt sett. account is           191152
      ** also sweep into EURO, otherwise EURO is an invalid settlement    191152
      ** currency.                                                        191152
      *                                                                   191152
     C           CEU004    IFEQ 'Y'                                       191152
     C           PMPSCY    ANDEQBKEURO                                    191152
     C           PMPRCV    ANDEQ'Y'                                       191152
      *                                                                   191152
     C           S         IFGT 1                                         191152
     C           S         SUB  1         Y       30                      191152
     C                     ELSE                                           191152
     C                     Z-ADD1         Y                               191152
     C                     ENDIF                                          191152
     C           ERCD,Y    IFEQ '914'                                     191152
     C           ERCD,Y    OREQ '910'                                     191152
     C                     MOVE *BLANK    ERCD,Y                          191152
     C                     SUB  1         S                               191152
     C                     MOVE '0'       *IN30                           191152
     C                     MOVE '0'       *IN69                           191152
     C                     END                                            191152
      *                                                                   191152
     C                     MOVE PMRONS    NOSTRO                          191152
     C           PMRSTM    IFEQ 05                                        191152
     C                     MOVEL*BLANK    ACID                            191152
     C                     MOVELNOST06    ACID                            191152
     C                     MOVE WPECY     CUCD                            191152
     C                     MOVE NOSTSQ    ACSQA                           191152
     C                     MOVE NOSTAC    ACCD                            191152
     C                     MOVE PMPOBR    BRCD                            191152
     C                     EXSR CHKAC                                     191152
     C                     ENDIF                                          191152
      *                                                                   191152
     C           RTCD      IFNE *BLANKS                                   191152
     C                     MOVE *BLANKS   RTCD                            191152
     C                     MOVE '910'     ERCD,S                          191152
     C                     ADD  1         S                               191152
     C                     MOVE '1'       *IN30                           191152
     C                     ENDIF                                          191152
      *                                                                   191152
     C           PMRSTM    IFEQ 14                                        191152
     C                     MOVEL*BLANK    ACID                            191152
     C                     MOVELNOST10    ACID                            191152
     C                     MOVE WPECY     CUCD                            191152
     C                     MOVE *BLANKS   ACSQA                           191152
     C                     MOVE *BLANKS   ACCD                            191152
     C                     MOVE *BLANKS   BRCD                            191152
     C                     EXSR CHKAC                                     191152
     C                     ENDIF                                          191152
      *                                                                   191152
     C           RTCD      IFNE *BLANKS                                   191152
     C                     MOVE *BLANKS   RTCD                            191152
     C                     MOVE '914'     ERCD,S                          191152
     C                     ADD  1         S                               191152
     C                     MOVE '1'       *IN30                           191152
     C                     ENDIF                                          191152
      *                                                                   191152
     C                     ENDIF                                          191152
     C/COPY WNCPYSRC,SD2410C098
     C*
     C** IF SETL TYPE IS 01,02,05,07,08,12 OR 14 AND FIELD REFERS TO A
     C** RETAIL ACCOUNT THE DATE OF RECEIPT MUST NOT BE BEFORE THE DATE
     C** ACCOUNT OPENED(912)
     C           *IN69     IFEQ '0'                        B1
     C*********  ATYP      ANDEQ'R'                        *1             BHF908
     C           PMRSTM    IFEQ 01                         B*2
     C           PMRSTM    OREQ 02                         **2
     C           PMRSTM    OREQ 04                         **2            100757
     C           PMRSTM    OREQ 05                         **2
     C           PMRSTM    OREQ 07                         **2
     C           PMRSTM    OREQ 08                         **2
     C           PMRSTM    OREQ 12                         **2
     C           PMRSTM    OREQ 14                         **2
     C           PMDTRC    IFLT DACO                       B**3
     C           PMACTC    ANDEQ'I'                                       149200
     C           CEU003    IFNE 'Y'                                       135303
     C           PMACTC    OREQ 'I'                                       135303
     C           PMACTC    OREQ 'A'                                                           178889
     C                     MOVE '912'     ERCD,S           ***3
     C                     ADD  1         S                ***3
     C                     MOVE '1'       *IN30            **2            LN0787
     C/COPY WNCPYSRC,SD2410C064
     C                     ENDIF                                          135303
     C                     END                             E**3
     C                     END                             E*2
     C                     END                             E1
     C*                                                                   E24039
     C** If LHS on settlement has been changed and deal is a deposit      E24039
     C** (receipts side is start side) then do the following back value   E24039
     C** period validation.                                               E24039
     C*                                                                   E24039
     C           *LOCK     IN   LDA                                       E24039
     C           NOCHG1    IFEQ '0'                                       E24039
     C           RCVSTR    ANDEQ'1'                                       E24039
     C           RCVSTR    OREQ *BLANKS                                   E24039
     C           PMACTC    OREQ 'I'                                       110122
     C*
     C** IF SETL TYPE IS 01,02,05,07,08,12 OR 14
     C** THE DATE OF RECEIPT MUST NOT BE
     C** EARLIER THAN BACK-VALUE PERIOD(913)
     C*                                                                   CLE003
     C*  IF DATE OF RECEIPT IS EARLIER THAN BACK VALUE PERIOD             CLE003
     C*  ISSUE A WARNING MESSAGE (805) ONLY WHEN CLE003 IS ON             CLE003
     C*                                                                   CLE003
     C           PMPRCV    IFNE 'Y'                                       E31589
     C*                                                                   E31589
     C           PMRSTM    IFEQ 01                         B1
     C           PMRSTM    OREQ 02                         *1
     C           PMRSTM    OREQ 04                         **2            100757
     C           PMRSTM    OREQ 05                         *1
     C           PMRSTM    OREQ 07                         *1
     C           PMRSTM    OREQ 08                         *1
     C           PMRSTM    OREQ 12                         *1
     C           PMRSTM    OREQ 14                         *1
     C           ATYP      IFEQ 'R'                        *1             BHF908
     C           PMRUND    SUB  PMBVPD    COMPDT  50       *1
     C           PMDTRC    IFLT COMPDT                     B*2
     C           CLE003    IFEQ 'Y'                                       CLE003
     C           COUNT     IFEQ 1                                         CLE003
     C                     MOVE '805'     ERCD,S           **2            CLE003
     C                     ADD  1         S                **2            CLE003
     C                     ADD  1         COUNT                           CLE003
     C                     MOVE '1'       *IN30            **2            CLE003
     C                     MOVELCOUNT     PMCMDP                          113832
     C                     ENDIF                                          CLE003
     C                     ELSE                                           CLE003
     C                     MOVE '913'     ERCD,S           **2
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN30            **2            LN0787
     C                     ENDIF                                          CLE003
     C                     END                             E*2
     C/COPY WNCPYSRC,SD2410C065
     C                     END                             E*2            BHF908
     C                     END                             E1
     C                     END                                            E31589
     C*                                                                   E24039
     C                     END                                            E24039
     C                     OUT  LDA                                       E24039
     C***********          MOVE COUNT     CNT                       CLE003113832
     C*
     C** Defaulting for ordering cust/bank if receive ordering cust.      E26903
     C** and bank are both blank. Move in as appropriate, thence to       E26903
     C** DEALS file and so to SWIFT message.                              E26903
     C*                                                                   E26903
     C           PMRSTM    IFEQ 01                                        E26903
     C           PMRSTM    OREQ 07                                        E26903
     C           PMRSTM    OREQ 08                                        E26903
     C*                                                                   E26903
     C           PMROBN    IFEQ *BLANKS                                   E26903
     C           PMROCN    ANDEQ*BLANKS                                   E26903
     C*                                                                   E26903
     C** Find out what the counterparty is  bank/nonbank                  E26903
     C*                                                                   E26903
     C                     MOVE PMCSNM    CHKFLD                          E26903
     C                     EXSR CHKFL                                     E26903
     C           RESULT    IFNE 'A'                                       E26903
     C           RESULT    ANDNE'B'                                       E26903
     C                     MOVE '872'     ERCD,S                          E26903
     C                     ADD  1         S                               E26903
     C                     ELSE                                           E26903
     C           BANKNB    IFEQ 'B'                                       E26903
     C                     MOVELPMCSNM    PMROBN                          E26903
     C                     ELSE                                           E26903
     C                     MOVELPMCSNM    PMROCN                          E26903
     C                     END                                            E26903
     C                     END                                            E26903
     C*                                                                   E26903
     C                     END                                            E26903
     C*                                                                   E26903
     C                     END                                            E26903
     C*                                                                   221452
     C** No need to validate swift fields if Swift for Lending is not     221452
     C** on and settlement method is 09                                   221452
     C*                                                                   221452
     C           CLE033    IFEQ 'Y'                                       221452
     C           PMRSTM    ANDEQ09                                        221452
     C           BGSWCL    ANDNE'Y'                                       221452
     C                     GOTO PAYMNT                                    221452
     C                     ENDIF                                          221452
     C*
     C** ORDERING CUSTOMER
     C** -----------------
     C                     MOVE *BLANKS   PAROCN
     C           *IN37     CABEQ'1'       EVAL1            ERROR ON FIELD
     C*
     C** MUST BE A 6 DIGIT NUMBER
     C** OR A CUSTOMER SHORTNAME THAT IDENTIFIES A LIVE
     C** RECORD ON FILE SDCUSTPD
     C           PMROCN    IFNE *BLANKS                    B1
     C                     MOVE *BLANKS   PAROCN           *1
     C                     MOVE *BLANKS   CHKFLD           *1             S01117
     C                     MOVE PMROCN    CHKFLD           *1
     C**********           MOVE 'N'       @CPNA            *1       S01117E21702
     C                     MOVE 'N'       @CPNA   1        *1             E21702
     C                     EXSR CHKFL                      *1
     C*                                                                   S01117
     C           RTCD      IFEQ '*NOSEL '                  B*2            S01117
     C                     MOVE '868'     ERCD,S           **2            S01117
     C                     ADD  1         S                **2            S01117
     C                     MOVE '1'       *IN30            **2            LN0787
     C                     END                             E*2            S01117
     C*                                                                   E26903
     C** Check that ordering customer is not a bank                       E26903
     C*                                                                   E26903
     C           BANKNB    IFEQ 'B'                                       E26903
     C                     MOVE '803'     ERCD,S                          E26903
     C                     ADD  1         S                               E26903
     C                     GOTO EVAL1                                     E26903
     C                     END                                            E26903
     C**                                                                  E26903
     C           RESULT    IFNE 'A'                        B*2
     C           RESULT    ANDNE'B'                        **2
     C                     MOVE '915'     ERCD,S           **2
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN30            **2            LN0787
     C                     ELSE                            X*2
     C           BANKNB    IFEQ 'B'                                       S01117
     C                     MOVE '879'     ERCD,S           ***3           S01117
     C                     ADD  1         S                ***3           S01117
     C                     MOVE '1'       *IN30            **2            LN0787
     C                     END                             E**3           S01117
     C                     MOVELBBCUST    PAROCN           **2
     C*                                                                   S01117
     C**   CHECK IF '?' ENTERED, IF SO MOVE VALUE RETRIEVED               S01117
     C**   INTO SCREEN FIELD.                                             S01117
     C*                                                                   S01117
     C                     MOVELPMROCN    @TSTQ   1        **2            S01117
     C           @TSTQ     IFEQ '?'                        B**3           S01117
     C                     MOVELBBCSSN    PMROCN           ***3           S01117
     C                     END                             E**3           S01117
     C                     END                             E*2
     C                     END                             E1
     C           EVAL1     TAG
     C**
     C** ORDERING BANK
     C** -------------
     C                     MOVE *BLANKS   PAROBN
     C           *IN39     CABEQ'1'       EVAL2            ERROR ON FIELD
     C*
     C** MUST BE A 6 DIGIT NUMBER
     C** OR A CUSTOMER SHORTNAME THAT IDENTIFIES A LIVE
     C** RECORD ON FILE SDCUSTPD
     C           PMROBN    IFNE *BLANKS                    B1
     C                     MOVE *BLANKS   CHKFLD           *1             S01117
     C                     MOVE PMROBN    CHKFLD           *1
     C                     MOVE 'N'       @CPNA            *1             S01117
     C                     EXSR CHKFL                      *1
     C*                                                                   S01117
     C           RTCD      IFEQ '*NOSEL '                  B*2            S01117
     C                     MOVE '869'     ERCD,S           **2            S01117
     C                     ADD  1         S                **2            S01117
     C                     MOVE '1'       *IN30            **2            LN0787
     C                     END                             E*2            S01117
     C*                                                                   S01117
     C           RESULT    IFNE 'A'                        B*2
     C           RESULT    ANDNE'B'                        **2
     C                     MOVE '917'     ERCD,S           **2
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN30            **2            LN0787
     C                     ELSE                            X*2
     C           BANKNB    IFNE 'B'                        B**3
     C                     MOVE '918'     ERCD,S           ***3
     C                     ADD  1         S                ***3
     C                     MOVE '1'       *IN30            **2            LN0787
     C                     ELSE                            X**3
     C                     MOVELBBCUST    PAROBN           ***3
     C                     END                             E**3
     C*                                                                   S01117
     C**   CHECK IF '?' ENTERED, IF SO MOVE VALUE RETRIEVED               S01117
     C**   INTO SCREEN FIELD.                                             S01117
     C*                                                                   S01117
     C                     MOVELPMROBN    @TSTQ   1        **2            S01117
     C           @TSTQ     IFEQ '?'                        B**3           S01117
     C                     MOVELBBCSSN    PMROBN           ***3           S01117
     C                     END                             E**3           S01117
     C                     END                             E*2
     C                     END                             E1
     C*                                                                   LN0798
     C** FOR SETTLEMENT TYPE 01 OR 08 EITHER ORDERING BANK OR ORDERING    LN0798
     C** CUSTOMER MUST BE ENTERED                                         LN0798
     C*                                                                   LN0798
     C           PMRSTM    IFEQ 01                                        LN0798
     C           PMRSTM    OREQ 08                                        LN0798
     C           PMROBN    IFEQ *BLANKS                                   LN0798
     C           PMROCN    ANDEQ*BLANKS                                   LN0798
     C                     MOVE '699'     ERCD,S                          LN0798
     C                     ADD  1         S                               LN0798
     C                     MOVE '1'       *IN30                           LN0798
     C                     END                                            LN0798
     C                     END                                            LN0798
     C*
     C** ENTRY IN BOTH RECEIPT ORDERING BANK AND ORDERING CUSTOMER NOT
     C** ALLOWED
     C           PMROBN    IFNE *BLANKS                    B1
     C           PMROCN    ANDNE*BLANKS                    *1
     C                     MOVE '919'     ERCD,S           *1
     C                     ADD  1         S                *1
     C                     MOVE '1'       *IN30            **2            LN0787
     C                     END                             E1
     C*
     C***FOR SETTL.*TYPE*01,07*OR*08*ORDERING*BANK*OR*ORDERING*CUSTOMER***E21860
     C***MUST*BE*ENTERED***                                            ***E21860
     C***********PMRSTM****IFEQ 01                         B1             E21860
     C***********PMRSTM****OREQ 07                         *1             E21860
     C***********PMRSTM****OREQ 08                         *1             E21860
     C***********PMROBN****IFEQ *BLANKS                    B*2            E21860
     C***********PMROCN****ANDEQ*BLANKS                    **2            E21860
     C*********************MOVE '921'     ERCD,S           **2            E21860
     C*********************ADD  1         S                **2            E21860
     C*********************END                             E*2            E21860
     C*********************END                             E1             E21860
     C           EVAL2     TAG
     C** INTERMEDIARY BANK
     C** -----------------
     C                     MOVE *BLANKS   PARIBN
     C           *IN43     CABEQ'1'       EVAL3            ERROR ON FIELD
     C*
     C** MUST BE A 6 DIGIT NUMBER
     C** OR A CUSTOMER SHORTNAME THAT IDENTIFIES A LIVE
     C** RECORD ON FILE SDCUSTPD OR A COUNTERPARTY NOSTRO CODE THAT
     C** IDENTIFIES A LIVE RECORD ON SDCNSTPD
     C           PMRSTM    IFEQ 01                         B1
     C           PMRSTM    OREQ 07                         *1
     C           PMRSTM    OREQ 08                         *1
     C           CLE033    OREQ 'Y'                        *1             CLE033
     C           PMRSTM    ANDEQ09                         *1             CLE033
     C/COPY WNCPYSRC,SD2410C066
     C                     MOVE 'Y'       CPRIBN  1        *1
     C           PMRIBN    IFNE *BLANK                     B*2
     C                     MOVE *BLANKS   CHKFLD           **2            S01117
     C                     MOVE PMRIBN    CHKFLD           **2
     C                     MOVE 'Y'       @CPNA            **2            S01117
     C/COPY WNCPYSRC,SD2410C067
     C                     EXSR CHKFL                      **2
     C*                                                                   S01117
     C           RTCD      IFEQ '*NOSEL '                  B*2            S01117
     C                     MOVE '870'     ERCD,S           **2            S01117
     C                     ADD  1         S                **2            S01117
     C                     MOVE '1'       *IN30            **2            LN0787
     C                     END                             E*2            S01117
     C*                                                                   S01117
     C           RESULT    IFEQ 'E'                        B**3
     C                     MOVE '922'     ERCD,S           ***3
     C                     ADD  1         S                ***3
     C                     MOVE '1'       *IN30            **2            LN0787
     C                     ELSE                            X**3
     C                     MOVELPMRIBN    @TSTQ            ***3           S01117
     C           RESULT    IFEQ 'A'                        B***4
     C           RESULT    OREQ 'B'                        ****4
     C           BANKNB    IFEQ 'B'                        B****5
      *                                                                   S01408
     C/COPY WNCPYSRC,SD2410CP13                                           S01408
      *                                                                   S01408
     C                     MOVE 'N'       CPRIBN           *****5
     C                     MOVELBBCUST    PARIBN           *****5
     C*                                                                   S01117
     C**   CHECK IF '?' ENTERED, IF SO MOVE VALUE RETRIEVED               S01117
     C**   INTO SCREEN FIELD.                                             S01117
     C*                                                                   S01117
     C                     ELSE                            X****5
     C                     MOVE '923'     ERCD,S           *****5
     C                     ADD  1         S                *****5
     C                     MOVE '1'       *IN30            **2            LN0787
     C                     END                             E****5
     C           @TSTQ     IFEQ '?'                        B****5         S01117
     C                     MOVELBBCSSN    PMRIBN           *****5         S01117
     C                     END                             E****5         S01117
     C                     ELSE                            X***4
     C                     MOVE *BLANKS   PARIBN           ****4          S01117
     C                     MOVELAWCPNC    PARIBN           ****4
     C**   CHECK IF '?' ENTERED, IF SO MOVE VALUE RETRIEVED               S01117
     C**   INTO SCREEN FIELD.                                             S01117
     C*                                                                   S01117
     C           @TSTQ     IFEQ '?'                        B****5         S01117
     C                     MOVE *BLANKS   PMRIBN           *****5         S01117
     C                     MOVELAWCPNC    PMRIBN           *****5
     C                     END                             E****5         S01117
     C                     END                             E***4
     C                     END                             E**3
     C                     END                             E*2
     C                     END                             E1
     C           EVAL3     TAG
     C*
     C** ENTRY MUST NOT BE THE SAME AS OUR NOSTRO OR BRANCH INTERNAL
     C** CUSTOMER NUMBER
     C*****      PMRIBN    IFNE *BLANKS                    B1             LN0455
     C           PARIBN    IFNE *BLANKS                    B1             LN0455
     C/COPY WNCPYSRC,SD2410C068
     C*****      PMRIBN    IFEQ RNOST                      B*2            S01227
     C*****      PMRIBN    OREQ A8BICN                     B*2            S01227
     C***********PARIBN    IFEQ RNOST                      B*2      S01227056873
     C***********PARIBN    OREQ A8BICN                     B*2      S01227056873
     C           PARIBN    IFEQ A8BICN                     B*2            056873
     C                     MOVE '926'     ERCD,S           **2
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN30            **2            LN0787
     C                     END                             E*2
     C                     END                             E1
     C*
     C** INTERMEDIARY BANK A/C LINE
     C** --------------------------
     C           *IN45     CABEQ'1'       EVAL4            ERROR ON FIELD
     C*                                                                                       193584
     C           PMRIBA    IFNE *BLANK                                                        193584
     C** Entry is not allowed if the Nostro is a CLS Dummy Nostro.                            193584
     C                     MOVE PMRONS    NOSTRO                                              193584
     C                     MOVE WRECY     @CYCD                                               193584
     C                     MOVE NOST02    @NONB                                               193584
     C*                                                                                       193584
     C** Check the Nostro.                                                                    193584
     C                     EXSR CHKNO                                                         193584
      *                                                                                       193584
     C           A7CLSD    IFEQ 'Y'                                                           193584
     C                     MOVE '711'     ERCD,S                                              193584
     C                     ADD  1         S                                                   193584
     C                     MOVE '1'       *IN30                                               193584
     C                     GOTO EVAL4                                                         193584
     C                     END                                                                193584
     C                     END                                                                193584
     C*
     C           PMRIBA    IFNE *BLANK                     B1
     C                     MOVE PMRIBA    PMXIBA           *1
     C*
     C** ENTRY IS ONLY ALLOWED IF ENTRY HAS BEEN MADE IN INTER. BANK
     C           PMRIBN    IFEQ *BLANK                     B*2
     C                     MOVE '924'     ERCD,S           **2
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN30            **2            LN0787
     C                     GOTO EVAL4                      SKIP VALIDATION
     C                     END                             E*2
      *****************************************************************   CSW096
      *                                                                   CSW096
      * Call Account Line Validation object                               CSW096
      *                                                                   CSW096
      * Set up parameters                                                 CSW096
      *                                                                   CSW096
     C                     MOVEL*BLANKS   W0RTN                           CSW096
     C                     CLEARI#PARM                                    CSW096
     C                     MOVEL'INBK '   I#VFLD                          CSW096
     C                     MOVEL'REC'     I#PR                            CSW096
     C                     MOVEL'X'       I#PRTT                          CSW096
     C                     MOVELPMRIBN    I#PRTY                          CSW096
     C***********          MOVELPMPCCY    I#PCCY                   CSW096 CEU003
     C***********          MOVELPMRCCY    I#RCCY                   CSW096 CEU003
     C                     MOVELWPECY     I#PCCY                          CEU003
     C                     MOVELWRECY     I#RCCY                          CEU003
     C                     MOVELPMRIBA    I#ACLN                          CSW096
     C                     MOVELPMPSTM    I#PSTM                          CSW096
     C                     MOVELPMRSTM    I#RSTM                          CSW096
     C                     MOVEL'210'     I#MTYP                          CSW096
      * Set up receive account information                                CSW096
     C           PMRONS    IFNE *BLANKS                                   CSW096
     C                     SELEC                                          CSW096
     C           PMROBR    WHNE *BLANKS                                   CSW096
     C           PMRONS    CAT  PMROBR    I#RCAC                          CSW096
     C           PMRONS    WHNE *BLANKS                                   CSW096
     C                     MOVELPMRONS    I#RCAC                          CSW096
     C                     ENDSL                                          CSW096
     C                     ENDIF                                          CSW096
      * Set up Pay account information                                    CSW096
     C           PMPONS    IFNE *BLANKS                                   CSW096
     C                     SELEC                                          CSW096
     C           PMPOBR    WHNE *BLANKS                                   CSW096
     C           PMPONS    CAT  PMPOBR    I#PYAC                          CSW096
     C           PMPONS    WHNE *BLANKS                                   CSW096
     C                     MOVELPMPONS    I#PYAC                          CSW096
     C                     ENDSL                                          CSW096
     C                     ENDIF                                          CSW096
      * If extra message and Rec Corr. then set 5354 field                CSW096
     C           PMRVNO    IFNE *BLANKS                                   CSW096
     C           PMRCRN    ANDNE*BLANKS                                   CSW096
     C                     MOVEL'Y'       I#5354                          CSW096
     C                     ENDIF                                          CSW096
      * Transaction Type                                                  CSW096
     C                     MOVELPMTTYP    I#TTYP                          CSW096
      * Set up Cover field                                                CSW096
     C                     MOVELPMCVMR    I#COVR                          CSW096
      *                                                                   CSW096
     C                     CLEARO#PARM                                    CSW096
     C                     CLEARE#PARM                                    CSW096
      *                                                                   CSW096
      * Send messages to correct calling process                          CSW096
      *                                                                   CSW096
     C                     SELEC                                          CSW096
     C           PMCPGM    WHEQ 'FXFX'                                    CSW096
     C                     MOVEL'ME9940'  E#CPGM                          CSW096
     C                     MOVEL'DL'      I#MMOD                          CSW096
     C           PMCPGM    WHEQ 'MMLD'                                    CSW096
     C                     MOVEL'ME9940'  E#CPGM                          CSW096
     C                     MOVEL'LE'      I#MMOD                          CSW096
     C           PMCPGM    WHEQ 'SSI '                                    CSW096
     C                     MOVEL'SD0401R' E#CPGM                          CSW096
     C                     MOVEL'AT'      I#MMOD                          CSW096
     C                     OTHER                                          CSW096
     C                     MOVEL'ME9940'  E#CPGM                          CSW096
     C                     ENDSL                                          CSW096
     C                     MOVEL'MEC0019' E#MSGD                          CSW096
     C                     MOVEL'MEMSG'   E#MSGF                          CSW096
      *                                                                   CSW096
     C                     CALL 'ME9940'                                  CSW096
     C                     PARM           W0RTN   7                       CSW096
     C                     PARM           I#PARM           I Input Parms  CSW096
     C                     PARM           O#PARM           O Output Parms CSW096
     C                     PARM           E#PARM           E Error Inform CSW096
     C                     PARM           Z#PARM256        B User Defined CSW096
      *                                                                   CSW096
      * On return if errors copy into error array                         CSW096
      *                                                                   CSW096
     C                     MOVELO#ACLN    PMRIBA                          CSW096
      *                                                                   CSW096
     C           E#ERRM    IFNE *BLANKS                                   CSW096
      *                                                                   CSW096
     C           1         DO   E#INDX    Q#      50                      CSW096
     C                     MOVEAO#E,Q#    ERCD,S                          CSW096
     C                     ADD  1         S                               CSW096
     C                     ENDDO                                          CSW096
      *                                                                   CSW096
      * Mark receive side as in error                                     CSW096
     C                     MOVEL*ON       *IN30                           CSW096
      *                                                                   CSW096
     C                     ENDIF                                          CSW096
      *                                                                   CSW096
     C                     ENDIF                                          CSW096
      *                                                                   CSW096
      * Validate Bank to Bank Information (Receive Instructions)                              CDL094
     C           CDL094    IFEQ 'Y'                                                           CDL094
     C                     EXSR CHRBTB                                                        CDL094
     C                     ENDIF                                                              CDL094
      *****************************************************************   CSW096
      ***********                                                         CSW096
     C***********                                                         CSW096
     C***FIRST*CHARACTER MUST BE '/'                                      CSW096
     C***********PMXIB1    IFNE '/'                        B*2            CSW096
     C***********          MOVE '925'     ERCD,S           **2            CSW096
     C***********          ADD  1         S                **2            CSW096
     C***********          MOVE '1'       *IN30            **2      LN0787CSW096
     C***********          END                             E*2            CSW096
     C***********                                                   060036CSW096
     C***If*1st*& 3rd character are '/',                            060036CSW096
     C***then*2nd character must be 'C' or 'D'.                     060036CSW096
     C***********                                                   060036CSW096
     C***********PMXIB1    IFEQ '/'                        B*2      060036CSW096
     C***********PMXIBE    ANDEQ'/'                        **2      060036CSW096
     C***********PMXIB2    IFNE 'C'                        B**3     060036CSW096
     C***********PMXIB2    ANDNE'D'                        ***3     060036CSW096
     C***********          MOVE '200'     ERCD,S           ***3     060036CSW096
     C***********          ADD  1         S                ***3     060036CSW096
     C***********          MOVE '1'       *IN30            ***3     060036CSW096
     C***********          END                             E**3     060036CSW096
     C***********          END                             E*2      060036CSW096
     C***********                                                         CSW096
     C***IF*SECOND CHARACTER IS ALSO '/'                                  CSW096
     C***MUST*BE*FOLLOWED BY CP, FW, BL OR SW.                      CSW095CSW096
     C***MUST*BE*FOLLOWED*BY*CP,FW*OR*BL****************************CSW095CSW096
     C***********PMXIB2    IFEQ '/'                        B*2            CSW096
     C***********PMXIB4    IFNE '//CP'                     B**3           CSW096
     C***********PMXIB4    ANDNE'//FW'                     ***3           CSW096
     C***********PMXIB4    ANDNE'//BL'                     ***3           CSW096
     C***********PMXIB4    ANDNE'//SW'                     ***3     CSW095CSW096
     C***********          MOVE '896'     ERCD,S           ***3           CSW096
     C***********          ADD  1         S                ***3           CSW096
     C***********          MOVE '1'       *IN30            **2      LN0787CSW096
     C***********          END                             E**3           CSW096
     C***********          END                             E*2            CSW096
     C***********                                                         CSW096
     C***IF*FOLLOWED BY CP OR FW CURRENCY MUST BE USD                     CSW096
     C***IF*FOLLOWED BY BL CURRENCY MUST BE DEM                           CSW096
     C***If*followed by SW currency must be CHF.                    CSW095CSW096
     C***********PMXIB4    IFEQ '//CP'                     B*2            CSW096
     C***********PMXIB4    OREQ '//FW'                     **2            CSW096
     C***********PMXIB4    OREQ '//BL'                     **2            CSW096
     C***********PMXIB4    OREQ '//SW'                              CSW095CSW096
     C***********          MOVE PMRCCY    KEYY    3        **2            CSW096
     C***********          MOVE PMXIB4    KEYZ    2        **2            CSW096
     C***********          EXSR CHKCY                      **2            CSW096
     C***********RTCD      IFNE *BLANKS                    B*2            CSW096
     C***********          MOVE '927'     ERCD,S           ***3           CSW096
     C***********          ADD  1         S                ***3           CSW096
     C***********          MOVE '1'       *IN30            **2      LN0787CSW096
     C***********          GOTO EVAL4                      ***3           CSW096
     C***********          END                             E**3           CSW096
     C***********          END                             E*2            CSW096
     C***********                                                         CSW096
     C***IF*//CP*AND FOLLOWED BY BLANKS THEN DEFAULT THIS TO THE          CSW096
     C***CUSTOMERS CHIPS PARTICIPANT ONLY IF PMRIBN IS A CUSTOMER         CSW096
     C***********CPRIBN    IFEQ 'N'                        B*2            CSW096
     C***********PMXIB4    IFEQ '//CP'                     B**3           CSW096
     C***********PMXIB5    ANDEQ*BLANK                     ***3           CSW096
     C***********          Z-ADDBBCABA    PNXIB3           ***3     S01429CSW096
     C***********          Z-ADDBBABA2    PNXIB3           ***3     S01429CSW096
     C***********          MOVE PMXIBA    PMRIBA           ***3           CSW096
     C***********          END                             E**3           CSW096
     C***********          END                             E*2            CSW096
     C***********                                                         CSW096
     C***IF*//CP*IT*MUST*BE*FOLLOWED*BY*A*3*DIGIT*NUMBER.THE*NUMBER*S01429CSW096
     C***IF*//CP*IT MUST BE FOLLOWED BY A 4 DIGIT NUMBER.THE NUMBER S01429CSW096
     C***MUST*BE*FOLLOWED BY BLANKS.                                      CSW096
     C***********PMXIB4    IFEQ '//CP'                     B*2            CSW096
     C***********          TESTN          PMXIB3     60    **2            CSW096
     C************IN60     IFNE '1'                        NOT NUMERIC    CSW096
     C***********PMXIBX    ORNE *BLANKS                    NOT FOLL. BY BLCSW096
     C***********          MOVE '928'     ERCD,S           ***3           CSW096
     C***********          ADD  1         S                ***3           CSW096
     C***********          MOVE '1'       *IN30            **2      LN0787CSW096
     C***********          END                             E**3           CSW096
     C***********          END                             E*2            CSW096
     C***********                                                         CSW096
     C***IF*//FW*IT MUST BE FOLLOWED BY A 9 DIGIT NUMBER.IF INTER. BANK   CSW096
     C***HAS*A*SWIFT ADDRESS //FW DOES NOT REQUIRE TO BE FOLLOWED BY      CSW096
     C***A*NUMBER                                                         CSW096
     C***********PMXIB4    IFEQ '//FW'                     B*2            CSW096
     C***********          TESTN          PMXIB9     60    **2            CSW096
     C************IN60     IFNE '1'                        NOT NUMERIC    CSW096
     C***********PMXIBZ    ORNE *BLANKS                    NOT FOLL. BY BLCSW096
     C***********          MOVE '0'       *IN60            ***3           CSW096
     C***********          END                             E**3           CSW096
     C***********CPRIBN    IFEQ 'N'                        B**3           CSW096
     C***********SWFT      ANDNE*BLANKS                    ***3           CSW096
     C***********PMXIB5    ANDEQ*BLANKS                    ***3           CSW096
     C***********          MOVE '1'       *IN60            ***3           CSW096
     C***********          END                             E**3           CSW096
     C***IF*SWIFT ADDRESS IS BLANK BUT THE FEDWIRE ACCOUNT NUMBER IS      CSW096
     C***PRESENT, SET UP THE FEDWIRE ACCOUNT                              CSW096
     C***********PMXIB5    IFEQ *BLANKS                    B**3           CSW096
     C***********SWFT      ANDEQ*BLANKS                    ***3           CSW096
     C***********FEDW      ANDNE*ZEROS                     ***3           CSW096
     C***********          Z-ADDFEDW      PMXIB7           ***3           CSW096
     C***********          END                             E**3           CSW096
     C***********SWFT      IFEQ *BLANKS                    B**3           CSW096
     C***********FEDW      ANDEQ*ZEROS                     ***3     S01117CSW096
     C***********PMXIB9    ANDEQ*BLANKS                    ***3     S01117CSW096
     C***********          MOVE '0'       *IN60            ***3           CSW096
     C***********          END                             E**3           CSW096
     C************IN60     IFNE '1'                        B**3           CSW096
     C***********          MOVE '928'     ERCD,S           ***3           CSW096
     C***********          ADD  1         S                ***3           CSW096
     C***********          MOVE '1'       *IN30            **2      LN0787CSW096
     C***********          END                             E**3           CSW096
     C***********          END                             E*2            CSW096
     C***********                                                         CSW096
     C***IF*//BL*AND FOLLOWED BY BLANKS THEN DEFAULT THIS TO THE          CSW096
     C***BANKLEITZAHL CODE ONLY IF PMRIBN IS A CUSTOMER                   CSW096
     C***********CPRIBN    IFEQ 'N'                        B*2            CSW096
     C***********PMXIB4    IFEQ '//BL'                     B**3           CSW096
     C***********PMXIB8    ANDEQ*BLANK                     ***3           CSW096
     C***********          MOVE BBBLCD    PMXIB8           ***3           CSW096
     C***********          MOVE PMXIBA    PMRIBA           ***3           CSW096
     C***********          END                             E**3           CSW096
     C***********          END                             E*2            CSW096
     C***********                                                         CSW096
     C***IF*//BL*IT MUST BE FOLLOWED BY A 8 DIGIT NUMBER.                 CSW096
     C***********PMXIB4    IFEQ '//BL'                     B*2            CSW096
     C***********          TESTN          PMXIB8     60    **2            CSW096
     C************IN60     IFNE '1'                        NOT NUMERIC    CSW096
     C***********PMXIBY    ORNE *BLANKS                    NOT FOLL. BY BLCSW096
     C***********          MOVE '928'     ERCD,S           ***3           CSW096
     C***********          ADD  1         S                ***3           CSW096
     C***********          MOVE '1'       *IN30            **2      LN0787CSW096
     C***********          END                             E**3           CSW096
     C***********          END                             E*2            CSW096
     C***********                                                   CSW095CSW096
     C***If*//SW*must*be*followed*by*a*6-digit*number.*****  CSW095 094100CSW096
     C***If*//SW*must be followed by a 5-digit number.              094100CSW096
     C***********                                                   CSW095CSW096
     C***********PMXIB4    IFEQ '//SW'                     B*2      CSW095CSW096
     C***********          TESTN          PMXIB6     60    **CSW095 094100CSW096
     C***********          TESTN          PMXSW5     60    **2      094100CSW096
     C************IN60     IFNE '1'                        not numerCSW095CSW096
     C***********PMXIBW    ORNE *BLANKS                    not follC094100CSW096
     C***********PMXSWW    ORNE *BLANKS                    not foll.CSW095CSW096
     C***********          MOVE '928'     ERCD,S           ***3     CSW095CSW096
     C***********          ADD  1         S                ***3     CSW095CSW096
     C***********          MOVE '1'       *IN30                     CSW095CSW096
     C***********          END                             E**3     CSW095CSW096
     C***********          END                             E*2      CSW095CSW096
     C***********                                                   CSW095CSW096
     C***********          END                             E1       CSW095CSW096
     C           EVAL4     TAG
     C**
     C** The following code has been moved further up the program         S01117
     C** as the Branch validation has been done too late.                 S01117
     C**
     C***SETTLEMENT*BRANCH*****************************************       S01117
     C** -----------------                                                S01117
     C**                                                                  S01117
     C***IF*MULTIBRANCHING*FLAG*IS*OFF*SKIP*FURTHER*VALIDATION******      S01117
     C***********@MBIN     IFEQ 'N'                        B1             S01117
     C*********************GOTO EVAL16                     *1             S01117
     C*********************END                             E1             S01117
     C*                                                                   S01117
     C***SETTLEMENT*BRANCH*ONLY*ALLOWED*WITH*SETTLEMENT*METHOD*5****      S01117
      ***ONLY*VALIDATE*IF*USER*SET*UP**********************               S01117
     C***********PMRSTM    IFNE 05                         B1             S01117
     C***********RBRF      ANDEQ*BLANKS                    B1             S01117
     C*                                                                   S01117
     C***Validate*Receive*Branch*if*entered*by*user.****************      S01117
     C***********RBRF      IFEQ *BLANKS                    B*2            S01117
     C***********PMOPSB    IFNE *BLANKS                    B*2            S01117
     C***********PMROBR    IFNE *BLANKS                    B*2            S01117
     C*********************MOVE '886'     ERCD,S           **2            S01117
     C*********************ADD  1         S                **2            S01117
     C*********************END                             E*2            S01117
     C*********************END                             E*2            S01117
     C*                                                                   S01117
     C*********************ELSE                            X1             S01117
     C*                                                                   S01117
     C***SETTLEMENT*BRANCH*MANDATORY*WITH*SETTLEMENT*METHOD*5******       S01117
     C***********PMOPSB    IFEQ *BLANKS                    B*2            S01117
     C***********PMROBR    IFEQ *BLANKS                    B*2            S01117
     C*********************MOVE '885'     ERCD,S           **2            S01117
     C*********************ADD  1         S                **2            S01117
     C*                                                                   S01117
     C*********************ELSE                            X*2            S01117
     C*                                                                   S01117
     C***VALIDATE*SETTLEMENT*BRANCH*******************************        S01117
     C*********************MOVE PMOPSB    @OBR    3        **2            S01117
     C*********************MOVE PMROBR    @OBR    3        **2            S01117
     C*********************EXSR CHKBR                      **2            S01117
     C***********@RTCD     IFNE *BLANKS                    B**3           S01117
     C*********************MOVE '884'     ERCD,S           ***3           S01117
     C*********************ADD  1         S                ***3           S01117
     C*********************ELSE                            ***3           S01117
     C*********************MOVE @DSNB     PMROBR           ***3           S01117
     C*********************END                             E**3           S01117
     C*********************END                             E*2            S01117
     C*********************END                             E1             S01117
     C*                                                                   S01117
     C*                                                                   S01117
     C***********EVAL16    TAG                                            S01117
     C*                                                                   S01117
     C*                                                                   S01408
     C/COPY WNCPYSRC,SD2410CP18                                           S01408
     C*                                                                   S01408
     C           PAYMNT    TAG
     C*
     C********** PMACTC    IFNE 'X'                                       118948
     C********** PMPPAY    CABEQ'Y'       V01END                          118948
     C**********           END                                            118948
      *                                                                                       260577
      ** This part should not be ommitted as to condition whether there                       260577
      ** is a need to validate receipt side or not.  Just change to                           260577
      ** bypass validation even if action code is 'X'                                         260577
      *                                                                                       260577
     C           PMPPAY    CABEQ'Y'       V01END                                              260577
     C*
     C** VALIDATE PAYMENT
     C** ================
      *
     C*                                                                   S01408
     C/COPY WNCPYSRC,SD2410CVS3                                           S01408
     C*                                                                   S01408
     C********** PMPOCN    IFEQ '000000'                                                      CSD027
     C**********           MOVE *BLANKS   PMPOCN                                              CSD027
     C**********           END                                                                CSD027
     C********** PMPOBN    IFEQ '000000'                                                      CSD027
     C**********           MOVE *BLANKS   PMPOBN                                              CSD027
     C**********           END                                                                CSD027
     C*                                                                   S01117
     C** BLANK OUT WORK FIELD @OBR & DATA STRUCTURES FOR PAYMENT          S01117
     C** INSTRUCTIONS VALIDATION.                                         S01117
     C                     MOVE *BLANKS   @OBR                            S01117
     C                     MOVE *BLANKS   ALRF                            S01117
     C                     MOVE *BLANKS   CURF                            S01117
     C                     MOVE *BLANKS   A7RF                            S01117
     C                     MOVE *BLANKS   ACCT                            S01117
     C                     MOVE *BLANKS   DMRF                            S01117
     C                     MOVE *BLANKS   SDBRCH                          S01117
     C*                                                                   S01117
     C*
     C** ENTRY IN ALL PAYMENT INSTRUCTIONS PROHIBITED IF PAYMENT
     C** SETTLEMENT METHOD IS 00
     C           PMPSTM    IFEQ 00                         B1
     C*                                                                   E00033
     C***********PMPOBR    IFNE *BLANKS                    B*2    E00033  S01117
     C*********************MOVE *BLANKS   PMPOBR           **2    E00033  S01117
     C*********************END                             E*2    E00033  S01117
     C*                                                                   E00033
     C           PMPONS    IFNE *BLANKS                    B*2
     C           PMPOBN    ORNE *BLANKS                    **2
     C           PMPOCN    ORNE *BLANKS                    **2
     C           PMPIBN    ORNE *BLANK                     **2
     C           PMPIBA    ORNE *BLANK                     **2
     C           PMRCRN    ORNE *BLANK                     **2
     C           PMRCRA    ORNE *BLANK                     **2
     C           PMRVNO    ORNE *BLANK                     **2
     C           PMCVMR    ORNE *BLANK                     **2            E22405
     C           PMAWBN    ORNE *BLANK                     **2
     C           PMAWBA    ORNE *BLANK                     **2
     C           PMBENN    ORNE *BLANK                     **2
     C           PMBENA    ORNE *BLANK                     **2
     C           PMDTP1    ORNE *BLANK                     **2
     C           PMDTP2    ORNE *BLANK                     **2
     C           PMDTP3    ORNE *BLANK                     **2
     C           PMDTP4    ORNE *BLANK                     **2
     C           PMDCHG    ORNE *BLANK                     **2
     C***********PMOSSB    ORNE *BLANKS                    **2            S01117
     C           PMPOBR    ORNE *BLANKS                    **2            S01117
     C                     MOVE '929'     ERCD,S           **2
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN31            **2            LN0787
     C                     END                             E*2
     C                     END                             E1
     C*C*PY*WN*PYSRC*SD2410C049                                           169210
     C/COPY WNCPYSRC,SD2410CX49                                           169210
     C*
     C** ENTRY IN FOLLOWING FIELDS IS PROHIBITED UNLESS SETL. TYPE
     C***IS*01,07*OR*08.***                                               CLE033
     C** IS 01,07,08 OR 09.                                               CLE033
     C           PMPSTM    IFNE 01                         B1
     C           PMPSTM    ANDNE07                         *1
     C           PMPSTM    ANDNE08                         *1
     C           CLE033    ANDNE'Y'                        *1             CLE033
     C           PMPSTM    ORNE 01                         B1             CLE033
     C           PMPSTM    ANDNE07                         *1             CLE033
     C           PMPSTM    ANDNE08                         *1             CLE033
     C           CLE033    ANDEQ'Y'                        *1             CLE033
     C           PMPSTM    ANDNE09                         *1             CLE033
     C           PMPOCN    IFNE *BLANKS                    B*2
     C           PMPOBN    ORNE *BLANKS                    **2
     C           PMPIBN    ORNE *BLANK                     **2
     C           PMPIBA    ORNE *BLANK                     **2
     C           PMRVNO    ORNE *BLANK                     **2
     C           PMCVMR    ORNE *BLANK                     **2            E22405
     C           PMRCRN    ORNE *BLANK                     **2
     C           PMRCRA    ORNE *BLANK                     **2
     C           PMAWBN    ORNE *BLANK                     **2
     C/COPY WNCPYSRC,SD2410C069
     C           PMAWBA    ORNE *BLANK                     **2
     C           PMBENN    ORNE *BLANK                     **2
     C           PMBENA    ORNE *BLANK                     **2
     C           PMDTP1    ORNE *BLANK                     **2
     C           PMDTP2    ORNE *BLANK                     **2
     C           PMDTP3    ORNE *BLANK                     **2
     C           PMDTP4    ORNE *BLANK                     **2
     C           PMDCHG    ORNE *BLANK                     **2
     C***********PMBTB1    ORNE *BLANK                     **2            033351
     C***********PMBTB2    ORNE *BLANK                     **2            033351
     C***********PMBTB3    ORNE *BLANK                     **2            033351
     C***********PMBTB4    ORNE *BLANK                     **2            033351
     C***********PMBTB5    ORNE *BLANK                     **2            033351
     C***********PMBTB6    ORNE *BLANK                     **2            033351
     C*                                                                   S01408
     C/COPY WNCPYSRC,SD2410CVS1                                           S01408
     C*                                                                   S01408
     C                     MOVE '930'     ERCD,S           **2
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN31            **2            LN0787
     C           PMPOCN    IFNE *BLANKS                    B**3
     C                     MOVE '1'       *IN38            ***3
     C                     END                             E**3
     C           PMPOBN    IFNE *BLANKS                    B**3
     C                     MOVE '1'       *IN40            ***3
     C                     END                             E**3
     C           PMPIBN    IFNE *BLANK                     B**3
     C                     MOVE '1'       *IN44            ***3
     C                     END                             E**3
     C           PMPIBA    IFNE *BLANK                     B**3
     C                     MOVE '1'       *IN46            ***3
     C                     END                             E**3
     C           PMRVNO    IFNE *BLANK                     B**3
     C                     MOVE '1'       *IN36            ***3
     C                     END                             E**3
     C           PMCVMR    IFNE *BLANK                     B**3           E22405
     C                     MOVE '1'       *IN61            ***3           E22405
     C                     END                             E**3           E22405
     C           PMRCRN    IFNE *BLANK                     B**3
     C                     MOVE '1'       *IN41            ***3
     C                     END                             E**3
     C           PMRCRA    IFNE *BLANK                     B**3
     C                     MOVE '1'       *IN42            ***3
     C                     END                             E**3
     C           PMAWBN    IFNE *BLANK                     B**3
     C                     MOVE '1'       *IN47            ***3
     C                     END                             E**3
     C           PMAWBA    IFNE *BLANK                     B**3
     C                     MOVE '1'       *IN48            ***3
     C                     END                             E**3
     C           PMBENN    IFNE *BLANK                     B**3
     C                     MOVE '1'       *IN49            ***3
     C                     END                             E**3
     C           PMBENA    IFNE *BLANK                     B**3
     C                     MOVE '1'       *IN50            ***3
     C                     END                             E**3
     C*                                                                   S01408
     C/COPY WNCPYSRC,SD2410CVS2                                           S01408
     C*                                                                   S01408
     C                     END                             E*2
     C                     END                             E1
     C/COPY WNCPYSRC,SD2410C002
     C*
     C** RECIPIENT OF MT100
     C** ------------------
     C                     MOVE *BLANKS   PARVNO
     C           *IN36     CABEQ'1'       EVAL8            ERROR ON FIELD
     C/COPY WNCPYSRC,SD2410C003
     C*                                                                   221452
     C** No need to validate swift fields if Swift for Lending is not     221452
     C** on and settlement method is 09                                   221452
     C*                                                                   221452
     C           CLE033    IFEQ 'Y'                                       221452
     C           PMRSTM    ANDEQ09                                        221452
     C           BGSWCL    ANDNE'Y'                                       221452
     C                     GOTO EVAL8                                     221452
     C                     ENDIF                                          221452
     C*
     C** MUST BE A 6 DIGIT NUMBER
     C** OR A CUSTOMER SHORTNAME THAT IDENTIFIES A LIVE
     C** RECORD ON FILE SDCUSTPD
     C                     MOVE 'Y'       CPRVNO  1
     C           PMRVNO    IFNE *BLANK                     B1
     C                     MOVE *BLANKS   CHKFLD           *1             S01117
     C                     MOVE PMRVNO    CHKFLD           *1
     C                     MOVE 'N'       @CPNA            *1             S01117
     C                     EXSR CHKFL                      *1
     C*                                                                   S01117
     C           RTCD      IFEQ '*NOSEL '                  B*2            S01117
     C                     MOVE '871'     ERCD,S           **2            S01117
     C                     ADD  1         S                **2            S01117
     C                     MOVE '1'       *IN31            **2            LN0787
     C                     END                             E*2            S01117
     C*                                                                   S01117
     C           RESULT    IFNE 'A'                        B*2
     C           RESULT    ANDNE'B'                        B*2
     C                     MOVE '952'     ERCD,S           **2
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN31            **2            LN0787
     C                     ELSE                            X*2
     C                     MOVELBBCUST    PARVNO           **2
     C*                                                                   S01117
     C**   CHECK IF '?' ENTERED, IF SO MOVE VALUE RETRIEVED               S01117
     C**   INTO SCREEN FIELD.                                             S01117
     C*                                                                   S01117
     C                     MOVELPMRVNO    @TSTQ   1        **2            S01117
     C           @TSTQ     IFEQ '?'                        B**3           S01117
     C                     MOVELBBCSSN    PMRVNO           ***3           S01117
     C                     END                             E**3           S01117
     C                     END                             E*2
     C*
     C** RECEIVER MUST HAVE SWIFT ADDRESS, A STTX ADDRESS OR A TELEX
     C** ADDRESS
     C*
     C           BBCSID    IFEQ *BLANK                     B*2
     C           BBSTAD    ANDEQ*BLANK                     B*2
     C           BBTXA1    ANDEQ*BLANK                     **2
     C                     MOVE '953'     ERCD,S           **2
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN31            **2            LN0787
     C                     END                             E*2
     C*                                                                   E22405
     C**  CHECK COVER-MT202-REQUIRED IS "Y" OR "N"                        E22405
     C           PMCVMR    IFNE 'N'                        B*2            E22405
     C           PMCVMR    ANDNE'Y'                        **2            E22405
     C                     MOVE '889'     ERCD,S           **2            E22405
     C                     ADD  1         S                **2            E22405
     C                     MOVE '1'       *IN31            **2            LN0787
     C                     END                             E*2            E22405
     C*                                                                   E22405
     C                     ELSE                            X1             E22405
     C/COPY WNCPYSRC,SD2410C049
     C*                                                                   E22405
     C**  AS RECIPIENT OF PAYMENT INSTRUCTION HASN'T BEEN ENTERED,        E22405
     C**  COVER-MT202-REQUIRED MUST BE BLANK                              E22405
     C           PMCVMR    IFNE *BLANK                     B*2            E22405
     C/COPY WNCPYSRC,SD2410C054
     C                     MOVE '890'     ERCD,S           **2            E22405
     C                     ADD  1         S                **2            E22405
     C                     MOVE '1'       *IN31            **2            LN0787
     C                     END                             E*2            E22405
     C*                                                                   E22405
     C*                                                                   E22614
     C* IF RECIPIENT NON-BLANK                                            LN0657
     C* CHECK RECIPIENT IS A BANK                                         E22614
     C           PMRVNO    IFNE *BLANK                                    LN0657
     C           BANKNB    IFNE 'B'                                       E22614
     C                     MOVE '955'     ERCD,S                          E22614
     C                     ADD  1         S                               E22614
     C                     MOVE '1'       *IN31                           LN0787
     C                     END                                            E22614
     C                     END                                            LN0657
     C*                                                                   E22614
     C                     END                             E1
     C*
     C           EVAL8     TAG
     C*
     C** SETTLEMENT METHOD
     C** -----------------
     C*
     C***MUST*BE*00,01,02,03,04,05,06,07,08,12*OR*14**                    CLE033
     C** MUST BE 00,01,02,03,04,05,06,07,08,09,12 OR 14                   CLE033
     C           PMPSTM    IFNE 00                         B1
     C           PMPSTM    ANDNE01                         *1
     C           PMPSTM    ANDNE02                         *1
     C           PMPSTM    ANDNE03                         *1
     C           PMPSTM    ANDNE04                         *1
     C           PMPSTM    ANDNE05                         *1
     C           PMPSTM    ANDNE06                         *1
     C           PMPSTM    ANDNE07                         *1
     C           PMPSTM    ANDNE08                         *1
     C           PMPSTM    ANDNE12                         *1
     C           PMPSTM    ANDNE14                         *1
     C           CLE033    ANDNE'Y'                        *1             CLE033
     C           PMPSTM    ORNE 00                         B1             CLE033
     C           PMPSTM    ANDNE01                         *1             CLE033
     C           PMPSTM    ANDNE02                         *1             CLE033
     C           PMPSTM    ANDNE03                         *1             CLE033
     C           PMPSTM    ANDNE04                         *1             CLE033
     C           PMPSTM    ANDNE05                         *1             CLE033
     C           PMPSTM    ANDNE06                         *1             CLE033
     C           PMPSTM    ANDNE07                         *1             CLE033
     C           PMPSTM    ANDNE08                         *1             CLE033
     C           PMPSTM    ANDNE12                         *1             CLE033
     C           PMPSTM    ANDNE14                         *1             CLE033
     C           CLE033    ANDEQ'Y'                        *1             CLE033
     C           PMPSTM    ANDNE09                         *1             CLE033
     C/COPY WNCPYSRC,SD2410C090
     C                     MOVE '931'     ERCD,S           *1
     C                     ADD  1         S                *1
     C                     MOVE '1'       *IN31                           LN0787
     C                     END                             E1
      *                                                                   CDL008
     C           CDL008    IFEQ 'Y'                                       CDL008
     C           PMTTYP    ANDEQ'CL'                                      CDL008
     C           PMPSTM    ANDNE00                                        186433
     C           PMPSTM    ANDNE01                                        CDL008
     C           PMPSTM    ANDNE07                                        CDL008
     C           PMPSTM    ANDNE08                                        CDL008
     C           PMPSTM    ANDNE02                                        CDL008
     C           PMPSTM    ANDNE12                                        CDL008
     C                     MOVE '304'     ERCD,S                          CDL008
     C                     ADD  1         S                               CDL008
     C                     MOVE *ON       *IN31                           CDL008
     C                     ENDIF                                          CDL008
     C*
     C** WHEN TYPE IS 04 OR 14 THE RETAIL MODULE MUST BE PRESENT; THESE
     C** TYPES ARE NOT ALLOWED WHEN CALLING PROGRAM CODE IS 'MMLD' AND
     C/COPY WNCPYSRC,SD2410C051
     C** TRANSACTION TYPE IS 'CI'
     C*
     C           PMPSTM    IFEQ 04                         B1
     C           PMPSTM    OREQ 14                         *1
     C           PMRETP    IFNE 'Y'                        B*2
     C                     MOVE '932'     ERCD,S           **2
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN31                           LN0787
     C/COPY WNCPYSRC,SD2410C052
     C                     END                             E*2
     C                     END
     C           PMPSTM    IFEQ 04                         B1             BHF352
     C           PMCPGM    IFEQ 'MMLD'                     B*2
     C           PMTTYP    ANDEQ'CI'                       **2
     C                     MOVE '933'     ERCD,S           **2
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN31                           LN0787
     C                     END                             E*2
     C                     END                             E1             BHF352
     C*
     C** IF TYPE IS 04 A LIVE RECORD MUST EXIST IN ACCNTAB
     C           PMPSTM    IFEQ 04                         B1
     C                     MOVEL*BLANK    ACID             *1             LN0830
     C                     MOVELPMCSNM    ACID             *1
     C***********          MOVE PMPCCY    CUCD             *1             CEU003
     C                     MOVE WPECY     CUCD                            CEU003
     C                     MOVE '01'      ACSQA            *1
     C                     MOVE PMPCYA    ACCD             *1
     C                     MOVE PMBRCA    BRCD             *1             S01117
      *                                                                   S01117
      ** SET UP SETTLEMENT BRANCH FOR FILE UPDATES BY OTHER PGMS          S01117
      ***SET*ON*PAY*BRANCH*FLAG*TO*SIGNIFY*PROGRAM*HAS*SET          S01117139921
      ***THIS*FIELD*UP                                              S01117139921
     C           PMPOBR    IFEQ *BLANKS                    B*2            S01117
     C                     MOVE PMBRCA    PMPOBR           **2            S01117
     C**********           MOVE 'Y'       PBRF             **2      S01117139921
     C                     END                             E*2            S01117
      *                                                                   S01117
     **  FOR STANDING DATA - EXTENDED SETTLEMENTS:                        S01117
     **  FOR SETTLEMENT TYPE 04 ONLY PARTIAL CHECKING OF ACCOUNT          S01117
     **  ENTERED CAN BE DONE AS NOT ALL DETAILS ARE AVAILABLE.            S01117
     **  THEREFORE SUBROUTINE CHKAC SHOULD NOT BE CALLED.                 S01117
     C           PMCPGM    IFEQ 'SSI '                     B1             S01117
     C                     MOVE *BLANKS   RTCD             *1             S01117
      *                                                                   S01117
     **  IF WARNING MESSAGE FOR SETTLEMENT METHOD 04 HAS BEEN SENT, DO    S01117
     **  NOT SEND A SECOND TIME.                                          S01117
     C           @SENT     IFNE 'Y'                        B*2            S01117
     C                     MOVE '865'     ERCD,S           **2            S01117
     C                     ADD  1         S                **2            S01117
     C                     MOVE '1'       *IN31                           LN0787
     C                     END                             E*2            S01117
     C                     ELSE                            X1             S01117
     C                     EXSR CHKAC                      *1             S01117
     C**********           END                             E1                          S01117 240971
      *
     C           RTCD      IFNE *BLANKS                    B*2
     C           RECI      ORNE 'D'                        B*2            E24104
     C           ACST      OREQ 'C'                                       060470
     C                     MOVE '934'     ERCD,S           **2
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN31                           LN0787
      *                                                                   S01408
      /COPY WNCPYSRC,SD2410CCP7                                           S01408
      *                                                                   S01408
     C                     ENDIF                                                              240971
     C                     END                             E*2
     C                     END                             E1
     C*
     C** IF SETTL. TYPE IS 07 THE PAYMENT CURRENCY MUST BE USD
     C           PMPSTM    IFEQ 07                         B1
     C           PMPCCY    ANDNE'USD'                      *1
     C                     MOVE '935'     ERCD,S           *1
     C                     ADD  1         S                *1
     C                     MOVE '1'       *IN31                           LN0787
     C                     END                             E1
     C*
     C** IF TYPE IS 14 THE RETAIL ACCOUNT NUMBER MUST BE SUPPORTED
     C           PMPSTM    IFEQ 14                         B1
     C           PMRETS    ANDNE'Y'                        *1
     C                     MOVE '936'     ERCD,S           *1
     C                     ADD  1         S                *1
     C                     MOVE '1'       *IN31                           LN0787
     C                     END                             E1
     C*                                                                   CLE033
     C** IF SETTLEMENT 09 ACCOUNT CODE IS RETAIL                          CLE033
     C           A5ACTY    IFEQ 'R'                        B1             CLE033
     C           CLE033    ANDEQ'Y'                                       CLE033
     C           PMPSTM    ANDEQ09                                        CLE033
     C*                                                                   CLE033
     C           PMPSCY    IFNE *BLANKS                    B2             CLE033
     C           SET09     ANDNE'T'                                                           218782
     C                     MOVE PMPSCY    W0PSCY  3                       CLE033
     C                     ENDIF                           E2             CLE033
     C*                                                                   CLE033
     C           PMPSCY    IFEQ *BLANKS                    B2             CLE033
     C           SET09     OREQ 'T'                                                           218782
     C                     MOVE PMPCCY    W0PSCY                          CLE033
     C                     ENDIF                           E2             CLE033
     C*                                                                   CLE033
     C**********           MOVELP@VL02    W0ACCD  4                                    CLE033 CGL029
     C                     MOVELP@VL02    W0ACCD                                              CGL029
     C                     MOVELP@VL01    W0CNUM  6                       CLE033
     **  For Standing Data - Extended Settlements:                                            218906
     **  For Settlement Type 09, only partial checking of account                             218906
     **  entered can be done, as not all details are available.                               218906
     **  Therefore subroutine AOACCTR0 should not be called.                                  218906
     C           PMCPGM    IFNE 'SSI '                     If not SSI                         218906
     C*                                                                   CLE033
     C                     CALL 'AOACCTR0'                                CLE033
     C                     PARM *BLANKS   P@RTCD  7                       CLE033
     C                     PARM '*KEY   ' P@OPTN  7                       CLE033
     C                     PARM *BLANKS   P@RETL 10                       CLE033
     C                     PARM W0CNUM    P@CNUM  6                       CLE033
     C                     PARM W0PSCY    P@CUCD  3                       CLE033
     C**********           PARM W0ACCD    P@ACCD  4                                    CLE033 CGL029
     C                     PARM W0ACCD    P@ACCD                                              CGL029
     C                     PARM '01'      P@ACSQ  2                       CLE033
     C                     PARM PMBRCA    P@BRCA  3                       CLE033
     C           ACCT      PARM ACCT      DSSDY                           CLE033
     C*                                                                   CLE033
     C           P@RTCD    IFNE *BLANKS                    B2             CLE033
     C           RECI      ORNE 'D'                                       CLE033
     C           ATYP      ORNE 'R'                                       CLE033
     C                     MOVE '934'     ERCD,S           *1             CLE033
     C                     ADD  1         S                *1             CLE033
     C                     MOVE '1'       *IN30            **2            CLE033
     C                     ENDIF                           E2             CLE033
     C*                                                                   CLE033
     C                     ENDIF                           End not SSI                        218906
      *                                                                                       218906
     C                     ENDIF                           E1             CLE033
     C/COPY WNCPYSRC,SD2410C026
     C**
     C** SETTLEMENT BRANCH                                                S01117
     C** -----------------                                                S01117
     C*                                                                   S01117
     C*  Validate Branch if in multi-branching environment.               S01117
     C           @MBIN     IFEQ 'Y'                                       S01117
     C*                                                                   S01117
     C***Settlement*branch*only*allowed*with*Settlement*Method*05.  S01117139921
     C** If Settlement type not '05', blank out Pay Branch -              139921
     C** this will be initialised with the correct branch code.           139921
     C           PMPSTM    IFNE 05                         B1             S01117
     C           PMPSTM    ANDNE04                         B1             141865
     C           CLE033    ANDNE'Y'                        B1             CLE033
     C           PMPSTM    ORNE 05                         B1             CLE033
     C           PMPSTM    ANDNE04                         B1             CLE033
     C           CLE033    ANDEQ'Y'                        B1             CLE033
     C           PMPSTM    ANDNE09                         B1             CLE033
     C/COPY WNCPYSRC,SD2410C091
     C*                                                                   S01117
     C                     MOVE *BLANKS   PMPOBR                          139921
     C*                                                                   139921
     C***If*user*has*set*up*Pay*Branch,*then*an*error*has*occurred. S01117139921
     C********** PBRF      IFEQ *BLANKS                    B*2      S01117139921
     C********** PMPOBR    ANDNE*BLANKS                    **2      S01117139921
     C**********           MOVE '883'     ERCD,S           **2      S01117139921
     C**********           ADD  1         S                **2      S01117139921
     C**********           MOVE '1'       *IN31                     LN0787139921
     C**********           END                             E*2      S01117139921
     C*                                                                   S01117
     C                     ELSE                            X1             S01117
     C/COPY WNCPYSRC,SD2410C092
     C*                                                                   S01117
     C           CLE033    IFEQ 'Y'                        B*2            CLE033
     C           PMPSTM    ANDEQ09                                        CLE033
     C*                                                                   CLE033
     C** No processing for condition, only on ELSE.                       CLE033
     C*                                                                   CLE033
     C                     ELSE                                           CLE033
     C*                                                                   CLE033
     C** SETTLEMENT BRANCH MANDATORY WITH SETTLEMENT METHOD 05.           S01117
     C           PMPOBR    IFEQ *BLANKS                    B*2            S01117
     C                     MOVE '882'     ERCD,S           **2            S01117
     C                     ADD  1         S                **2            S01117
     C                     MOVE '1'       *IN31                           LN0787
     C*                                                                   S01117
     C                     ELSE                            X*2            S01117
     C*                                                                   S01117
     C** VALIDATE SETTLEMENT BRANCH                                       S01117
     C                     MOVE PMPOBR    @OBR    3        **2            S01117
     C                     EXSR CHKBR                      **2            S01117
     C*                                                                   S01117
     C           @RTCD     IFEQ '*NOSEL '                  B**3           S01117
     C                     MOVE '864'     ERCD,S           ***3           S01117
     C                     ADD  1         S                ***3           S01117
     C                     MOVE '1'       *IN31                           LN0787
     C                     END                             E**3           S01117
     C*                                                                   S01117
     C           @RTCD     IFNE *BLANKS                    B**3           S01117
     C                     MOVE '881'     ERCD,S           ***3           S01117
     C                     ADD  1         S                ***3           S01117
     C                     MOVE '1'       *IN31                           LN0787
     C                     ELSE                            X**3           S01117
     C                     MOVE @DSNB     PMPOBR           ***3           S01117
     C                     END                             E**3           S01117
     C                     END                             E*2            S01117
     C                     END                             E1             S01117
     C*                                                                   S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDIF                                          CLE033
     C*                                                                   CLE033
     C*                                                                   S01117
     C*
     C** OUR NOSTRO
     C** ----------
     C                     MOVE PMPONS    NOSTRO
     C                     MOVE *BLANKS   PNOST   6
     C                     MOVE '0'       *IN69
     C/COPY WNCPYSRC,SD2410C027
     C*
     C** MUST BE BLANK IF SETTLEMENT TYPE IS 00,04 OR 06
     C           PMPSTM    IFEQ 00                         B1
     C           PMPSTM    OREQ 04                         *1
     C           PMPSTM    OREQ 06                         *1
     C           PMPONS    IFNE *BLANK                     B*2
     C                     MOVE '937'     ERCD,S           **2
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN31                           LN0787
     C                     END                             E*2
     C                     END                             E1
     C/COPY WNCPYSRC,SD2410C028
     C*
     C** IF SETL TYPE IS 01,02,07,08 OR 12 MUST BE A 2 DIGIT NUMBER
     C** AND IDENTIFY A LIVE RECORD ON THE NOSTRO TABLE SDNOSTPD
     C           PMPSTM    IFEQ 01                         B1
     C           PMPSTM    OREQ 02                         *1
     C           PMPSTM    OREQ 07                         *1
     C           PMPSTM    OREQ 08                         *1
     C           PMPSTM    OREQ 12                         *1
     C/COPY WNCPYSRC,SD2410C029
     C                     TESTN          NOST02     60    *1
     C                     MOVEANOST02    @QM                             108517
     C           '?'       LOKUP@QM                      62               108517
     C           *IN60     IFNE '1'                        B*2
     C           *IN62     ANDEQ*OFF                                      108517
     C           NOSTXX    ORNE *BLANKS                    **2
     C                     MOVE '938'     ERCD,S           **2
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN31                           LN0787
     C                     MOVE '1'       *IN69            **2            108752
     C                     ELSE                            X*2
     C                     MOVEL'*KEY   ' OPTN             **2
     C***********          MOVE PMPCCY    @CYCD            **2            CEU003
     C                     MOVE WPECY     @CYCD                           CEU003
     C                     MOVE NOST02    @NONB            **2
     C/COPY WNCPYSRC,SD2410C038
     C                     EXSR CHKNO                      **2
     C           RTCD      IFNE *BLANKS                    B**3
     C           RTCD      ANDNE'*NOSEL '                                 108517
     C                     MOVE '938'     ERCD,S           ***3
     C                     ADD  1         S                ***3
     C                     MOVE '1'       *IN31                           LN0787
     C                     MOVE '1'       *IN69            **2            108752
      *
     C                     ELSE                            ***3
      *
     C           RTCD      IFEQ '*NOSEL'                                  108517
     C                     MOVE '867'     ERCD,S                          108517
     C                     ADD  1         S                               108517
     C                     MOVE *ON       *IN30                           108517
     C                     ELSE                                           108517
      *                                                                   CDL008
      ** Send error message if CLS Dummy Nostro is not Y                  CDL008
      *                                                                   CDL008
     C           CDL008    IFEQ 'Y'                                       CDL008
      *                                                                   CDL008
     C           PMTTYP    IFEQ 'CL'                                      CDL008
     C           A7CLSD    ANDNE'Y'                                       CDL008
     C                     MOVE '302'     ERCD,S                          CDL008
     C                     ADD  1         S                               CDL008
     C                     MOVE *ON       *IN31                           CDL008
     C                     ENDIF                                          CDL008
      *                                                                   CDL008
     C           PMTTYP    IFNE 'CL'                                      CDL008
     C           A7CLSD    ANDEQ'Y'                                       CDL008
     C                     MOVE '306'     ERCD,S                          CDL008
     C                     ADD  1         S                               CDL008
     C                     MOVE *ON       *IN31                           CDL008
     C                     ENDIF                                          CDL008
      *                                                                   CDL008
     C                     ENDIF                                          CDL008
      *                                                                   CDL008
     C                     MOVE A7CUST    PNOST            ***3
     C                     MOVELA7NONB    PMPONS           ***3           108517
     C                     MOVEL*BLANK    ACID             ***3           LN0830
     C                     MOVELA7CUST    ACID             ***3
     C***********          MOVE PMPCCY    CUCD             ***3           CEU003
     C                     MOVE WPECY     CUCD                            CEU003
     C                     MOVE A7ACCD    ACCD             ***3
     C                     MOVE A7ACSN    ACSQA            ***3
     C                     MOVE A7BRCD    BRCD             ***3           S01117
     C/COPY WNCPYSRC,SD2410C075
     C                     ENDIF                                          108517
      *                                                                   S01117
      ** SET UP SETTLEMENT BRANCH FOR FILE UPDATES BY OTHER PGMS          S01117
      ***SET*ON*PAY*BRANCH*FLAG*TO*SIGNIFY*PROGRAM*HAS*SET          S01117139921
      ***THIS*FIELD*UP                                              S01117139921
     C           PMPOBR    IFEQ *BLANKS                    B*2            S01117
     C                     MOVE A7BRCD    PMPOBR           **2            S01117
     C**********           MOVE 'Y'       PBRF             **2      S01117139921
     C                     END                             E*2            S01117
      *
     C                     EXSR CHKAC                      ***3
      *
     C           RTCD      IFNE *BLANKS                    B***4
     C           RECI      ORNE 'D'                        B***4          E24104
     C                     MOVE '938'     ERCD,S           ****4          108195
     C                     ADD  1         S                ****4          108195
     C                     MOVE '1'       *IN31            ****4          108195
     C                     MOVE '1'       *IN69            ****4
     C*                                                                   S01117
     C                     ELSE                            X***4          S01117
      *                                                                   S01408
      /COPY WNCPYSRC,SD2410CCP8                                           S01408
      *                                                                   S01408
     C*                                                                   S01117
     C**   IF MULTIBRANCH FLAG OFF NOSTRO MUST EQUAL SINGLE BRANCH        S01117
     C** (ERROR SHOULDNT HAPPEN UNLESS BANK SWITCHES OFF M/B INCORRECTY)  S01117
     C           @MBIN     IFEQ 'N'                        B****5         S01117
     C                     EXSR CHKBK                      *****5         S01117
     C*                                                                   S01117
     C           BJSBRC    IFNE A7BRCD                     B*****6        S01117
     C*********************MOVE '889'     ERCD,S           ******6  S01117LN0785
     C                     MOVE '501'     ERCD,S           ******6        LN0785
     C                     ADD  1         S                ******6        S01117
     C                     MOVE '1'       *IN31                           LN0787
     C                     MOVE '1'       *IN69            **2            108752
     C                     END                             E*****6        S01117
     C                     END                             E****5         S01117
     C*                                                                   S01117
     C** RETRIEVE BRANCH INTERNAL CUSTOMER NUMBER ASSOCIATED WITH         S01117
     C** NOSTRO BRANCH FOR VALIDATION LATER.                              S01117
     C                     MOVE A7BRCD    @OBR             ****4          S01117
     C                     EXSR CHKBR                      ****4          S01117
     C*                                                                   S01117
     C                     END                             ****4
     C                     END                             E**3
     C                     END                             E*2
     C                     END                             E1
     C*
     C***IF*SETL*TYPE*IS*03*MUST*BE*CONTAIN*A*SIX*DIGIT*NUMBER*********   E21702
     C***WHICH*IDENTIFIES*A*LIVE*CUSTOMER*RECORD*ON*FILE*SDCUSTPD******   E21702
     C** IF SETTLEMENT TYPE IS 03, 'OUR NOSTRO' MUST EITHER BE BLANK OR   E21702
     C** CONTAIN A SIX DIGIT DEAL NUMBER (TO COMPENSATE AGAINST).         E21702
     C           PMPSTM    IFEQ 03                         B1
     C           NOSTRO    ANDNE*BLANK                     B1             E21702
     C                     TESTN          NOST06     60    *1
     C           *IN60     IFNE '1'                        B*2
     C           NOSTYY    ORNE *BLANK                     **2
     C                     MOVE '939'     ERCD,S           **2
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN31                           LN0787
     C**********           ELSE                            X*2            E21702
     C**********           MOVE *BLANKS   CHKFLD           **2            E21702
     C**********           MOVELNOST06    CHKFLD           **2            E21702
     C**********           MOVE 'N'       @CPNA            **2      S01117E21702
     C**********           EXSR CHKFL                                     E21702
     C********** RESULT    IFNE 'A'                        B**3           E21702
     C**********           MOVE '939'     ERCD,S           ***3           E21702
     C**********           ADD  1         S                ***3           E21702
     C**********           ELSE                            X**3           E21702
     C**********           MOVE BBCUST    PNOST            ***3           E21702
     C**********           END                             E**3           E21702
     C                     END                             E*2
     C                     END                             E1
     C*
     C** IF SETLEMENT TYPE IS 05 MUST IDENTIFY A LIVE RECORD ON ACCNTAB
     C** (IN COMBINATION WITH PAYMENT CURRENCY)
     C           PMPSTM    IFEQ 05                         B1
     C           NOSTSQ    IFEQ *BLANK                     B*2
     C           NOSTSQ    OREQ '00'                       **2
     C                     MOVE '01'      NOSTSQ           **2
     C                     END                             E*2
     C**********           TESTN          NOST06     60    *1                                 CSD027
     C***60*****           TESTN          NOSTAC     60    *1                                 CSD027
     C                     TESTN          NOSTAC     60    *1                                 CSD027
     C   60                TESTN          NOSTSQ     60    *1
     C           *IN60     IFNE '1'                        B*2
     C                     MOVE '940'     ERCD,S           **2
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN31                           LN0787
     C                     MOVE '1'       *IN69            **2            108752
     C                     ELSE                            X*2
     C                     MOVEL*BLANK    ACID             **2            LN0830
     C                     MOVELNOST06    ACID             **2
     C***********          MOVE PMPCCY    CUCD             **2            CEU003
     C                     MOVE WPECY     CUCD                            CEU003
     C                     MOVE NOSTSQ    ACSQA            **2
     C                     MOVE NOSTAC    ACCD             **2
      *
      * Setup default branch for Pay method 05 if MBIN=N.                 E83
     C           @MBIN     IFEQ 'N'                        B**3           E83
     C                     EXSR CHKBK                      ***3           E83
     C                     MOVE BJSBRC    PMPOBR           ***3           E83
     C                     END                             E**3           E83
      *                                                                   E83
     C                     MOVE PMPOBR    BRCD             **2            S01117
      *                                                                   S01117
      ***SET*OFF*PAY*BRANCH*FLAG*TO*SIGNIFY*USER*HAS*SET            S01117139921
      ***THIS*FIELD*UP                                              S01117139921
     C**********           MOVE *BLANKS   PBRF             **2      S01117139921
     C/COPY WNCPYSRC,SD2410C086
      *                                                                   S01117
     C                     EXSR CHKAC                      **2
     C           RTCD      IFNE *BLANKS                    B**3
     C           TYPE      OREQ '*SHNAME'                  **3                                CSD027
     C           RECI      ORNE 'D'                        B**3           E24104
     C           ACST      OREQ 'C'                        B**3           056626
     C                     MOVE '940'     ERCD,S           ***3
     C                     ADD  1         S                ***3
     C                     MOVE '1'       *IN31                           LN0787
     C                     MOVE '1'       *IN69            **2            108752
     C                     ELSE                            X*3
      *                                                                   S01408
      /COPY WNCPYSRC,SD2410CCP9                                           S01408
      *                                                                   S01408
     C                     MOVE CNUM      PNOST            **3
     C                     MOVELNOSTRO    PMPONS           **3            066875
     C                     END                             E**3
     C/COPY WNCPYSRC,SD2410C087
     C                     END                             E*2
     C                     END                             E1
     C*
     C/COPY WNCPYSRC,SD2410C093
     C** IF SETL TYPE IS 14 NOSTRO  MUST CONTAIN A 10 DIGIT NUMBER
     C** WHICH IDENTIFIES A LIVE RECORD ON FILE ACCNTAB
     C           PMPSTM    IFEQ 14                         B1
     C                     TESTN          NOST10     60    *1
     C           *IN60     IFNE '1'                        B*2
     C           NOSTSQ    ORNE *BLANK                     **2
     C           WNOST1    ORNE *BLANKS                                                     AR853732
     C                     MOVE '941'     ERCD,S           **2
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN31                           LN0787
     C                     MOVE '1'       *IN69            **2            108752
     C                     ELSE                            X*2
     C                     MOVELNOST10    ACID
     C                     MOVE *BLANKS   CUCD
     C                     MOVE *BLANKS   ACSQA
     C                     MOVE *BLANKS   ACCD
     C                     MOVE *BLANKS   BRCD             **2            S01117
     C                     EXSR CHKAC                      **2
     C           RTCD      IFNE *BLANKS                    B*3
     C           RECI      ORNE 'D'                        B*3            E24104
     C           ACST      OREQ 'C'                                       060470
     C                     MOVE '941'     ERCD,S           **3
     C                     ADD  1         S                **3
     C                     MOVE '1'       *IN31                           LN0787
     C                     MOVE '1'       *IN69            **2            108752
     C                     ELSE                            X**3
      *                                                                   S01408
      /COPY WNCPYSRC,SD2410CP10                                           S01408
      *                                                                   S01408
     C*                                                                   E45796
     C** Ensure account is not blocked for Debit/Credit                   E45796
     C*                                                                   E45796
     C                     TESTB'2'       RETB           34DEBIT          E45796
     C                     TESTB'3'       RETB           35CREDIT         E45796
     C*                                                                   E45796
     C           *IN34     IFEQ '1'                                       E45796
     C           *IN35     OREQ '1'                                       E45796
     C                     MOVE '992'     ERCD,S                          E45796
     C                     ADD  1         S                               E45796
     C                     MOVE '1'       *IN31                           E45796
     C                     MOVE '1'       *IN69            **2            108752
     C                     END                                            E45796
     C*                                                                   S01408
     C/COPY WNCPYSRC,SD2410CP17                                           S01408
     C*                                                                   S01408
     C*                                                                   E45796
     C                     MOVE CNUM      PNOST            **3
      *                                                                   S01117
      ** SET UP SETTLEMENT BRANCH FOR FILE UPDATES BY OTHER PGMS          S01117
      ***SET*ON*PAY*BRANCH*FLAG*TO*SIGNIFY*PROGRAM*HAS*SET          S01117139921
      ***THIS*FIELD*UP                                              S01117139921
     C           PMPOBR    IFEQ *BLANKS                    B*2            S01117
     C                     MOVE BRCA      PMPOBR           **2            S01117
     C**********           MOVE 'Y'       PBRF             **2      S01117139921
     C                     END                             E*2            S01117
     C*
     C** IF SETL IS 14 AND NOSTRO IDENTIFIES A LIVE RECORD ON ACCNTAB
     C** PAYMENT CURRENCY MUST BE SAME AS CURRENCY OF ACCOUNT
     C***********PMPCCY    IFNE CCY                        B***4          CEU003
     C           WPECY     IFNE CCY                                       CEU003
     C           PMCPGM    ANDNE'SSI'                                     137488
     C           PMPCCY    ORNE CCY                                       137488
     C           PMCPGM    ANDEQ'SSI'                                     137488
     C                     MOVE '944'     ERCD,S           ****4
     C                     ADD  1         S                ****4
     C                     MOVE '1'       *IN31                           LN0787
     C                     MOVE '1'       *IN69            **2            108752
     C*                                                                   S01117
     C                     ELSE                            X***4          S01117
     C*                                                                   S01117
     C**   IF MULTIBRANCH FLAG OFF NOSTRO MUST EQUAL SINGLE BRANCH        S01117
     C           @MBIN     IFEQ 'N'                        B****5         S01117
     C                     EXSR CHKBK                      *****5         S01117
     C*                                                                   S01117
     C***********BRCA      IFNE A7BRCD                     B*****6 S01117 058132
     C           BRCA      IFNE BJSBRC                     B*****6        058132
     C                     MOVE '887'     ERCD,S           ******6        S01117
     C                     ADD  1         S                ******6        S01117
     C                     MOVE '1'       *IN31                           LN0787
     C                     MOVE '1'       *IN69            **2            108752
     C                     END                             E*****6        S01117
     C                     END                             E****5         S01117
     C*                                                                   S01117
     C                     END                             E***4
     C                     END                             E**3
     C                     END                             E*2
     C                     END                             E1
      *                                                                   191152
      ** If Settlement Currency is EURO (created for a sweep of the       191152
      ** 'In' Currency loan), check if pay settlement account is          191152
      ** also sweep into EURO, otherwise EURO is an invalid settlement    191152
      ** currency.                                                        191152
      *                                                                   191152
     C           CEU004    IFEQ 'Y'                                       191152
     C           PMRSCY    ANDEQBKEURO                                    191152
     C           PMPPAY    ANDEQ'Y'                                       191152
      *                                                                   191152
     C           S         IFGT 1                                         191152
     C           S         SUB  1         Y                               191152
     C                     ELSE                                           191152
     C                     Z-ADD1         Y                               191152
     C                     ENDIF                                          191152
     C           ERCD,Y    IFEQ '944'                                     191152
     C           ERCD,Y    OREQ '940'                                     191152
     C                     MOVE *BLANK    ERCD,Y                          191152
     C                     SUB  1         S                               191152
     C                     MOVE '0'       *IN31                           191152
     C                     MOVE '0'       *IN69                           191152
     C                     END                                            191152
      *                                                                   191152
     C                     MOVE PMPONS    NOSTRO                          191152
     C           PMPSTM    IFEQ 05                                        191152
     C                     MOVEL*BLANK    ACID                            191152
     C                     MOVELNOST06    ACID                            191152
     C                     MOVE WRECY     CUCD                            191152
     C                     MOVE NOSTSQ    ACSQA                           191152
     C                     MOVE NOSTAC    ACCD                            191152
     C                     MOVE PMPOBR    BRCD                            191152
     C                     EXSR CHKAC                                     191152
     C                     ENDIF                                          191152
      *                                                                   191152
     C           RTCD      IFNE *BLANKS                                   191152
     C                     MOVE *BLANKS   RTCD                            191152
     C                     MOVE '940'     ERCD,S                          191152
     C                     ADD  1         S                               191152
     C                     MOVE '1'       *IN31                           191152
     C                     ENDIF                                          191152
      *                                                                   191152
     C           PMPSTM    IFEQ 14                                        191152
     C                     MOVEL*BLANK    ACID                            191152
     C                     MOVELNOST10    ACID                            191152
     C                     MOVE WRECY     CUCD                            191152
     C                     MOVE *BLANKS   ACSQA                           191152
     C                     MOVE *BLANKS   ACCD                            191152
     C                     MOVE *BLANKS   BRCD                            191152
     C                     EXSR CHKAC                                     191152
     C                     ENDIF                                          191152
      *                                                                   191152
     C           RTCD      IFNE *BLANKS                                   191152
     C                     MOVE *BLANKS   RTCD                            191152
     C                     MOVE '944'     ERCD,S                          191152
     C                     ADD  1         S                               191152
     C                     MOVE '1'       *IN31                           191152
     C                     ENDIF                                          191152
      *                                                                   191152
     C                     ENDIF                                          191152
     C/COPY WNCPYSRC,SD2410C099
     C*
     C** IF SETL TYPE IS 01,02,05,07,08,12 OR 14 AND FIELD REFERS TO A
     C** RETAIL ACCOUNT THE DATE OF PAYMENT MUST NOT BE BEFORE THE DATE
     C** ACCOUNT OPENED(942)
     C*******    PMCPGM    IFEQ 'FXFX'                     B1             088364
     C*******    PMDTPY    ANDEQ*ZEROS                     *1             088364
     C*******              MOVE '1'       *IN69            *1             088364
     C*******              END                             E1             088364
     C           *IN69     IFEQ '0'                        B1
     C********   ATYP      ANDEQ'R'                        *1             BHF908
     C           RCVSTR    IFEQ '0'                                       052290
     C           PMCPGM    OREQ 'FXFX'                                                        178889
     C           RCVSTR    ANDEQ*BLANKS                                                       178889
     C           PMPSTM    IFEQ 01                         B*2
     C           PMPSTM    OREQ 02                         **2
     C           PMPSTM    OREQ 04                         **2            100757
     C           PMPSTM    OREQ 05                         **2
     C           PMPSTM    OREQ 07                         **2
     C           PMPSTM    OREQ 08                         **2
     C           PMPSTM    OREQ 12                         **2
     C           PMPSTM    OREQ 14                         **2
     C/COPY WNCPYSRC,SD2410C094
     C           PMDTPY    IFLT DACO                       B**3
     C           CEU003    IFNE 'Y'                                       135303
     C           PMACTC    OREQ 'I'                                       135303
     C           PMACTC    OREQ 'A'                                                           178889
     C                     MOVE '942'     ERCD,S           ***3
     C                     ADD  1         S                ***3
     C                     MOVE '1'       *IN31                           LN0787
     C/COPY WNCPYSRC,SD2410C070
     C                     ENDIF                                          135303
     C                     END                             E**3
     C                     END                             E*2
     C                     END                                            052290
     C                     END                             E1
     C*                                                                   E24039
     C** If RHS on settlement has been changed and deal is a loan         E24039
     C** (payments side is start side) then do the following back value   E24039
     C** period validation.                                               E24039
     C* NB For 'insert' , validation should never be bypassed.            110122
     C*                                                                   E24039
     C           *LOCK     IN   LDA                                       E24039
     C***********NOCHG1    IFEQ '0'                                 E24039035701
     C           NOCHG2    IFEQ '0'                                       035701
     C           RCVSTR    ANDEQ'0'                                       E24039
     C           RCVSTR    OREQ *BLANKS                                   E24039
     C           PMACTC    OREQ 'I'                                       110122
     C*
     C** IF SETL TYPE IS 01,02,05,07,08,12 OR 14
     C** THE DATE OF PAYMENT MUST NOT BE
     C** EARLIER THAN BACK-VALUE PERIOD(943)
     C*                                                                   CLE003
     C* IF DATE OF PAYMENT IS EARLIER THAN BACK VALUE PERIOD              CLE003
     C* ISSUE A WARNING MESSAGE (806) IF CLE003 IS ON                     CLE003
     C*                                                                   CLE003
     C           PMPPAY    IFNE 'Y'                                       E31589
     C*                                                                   E31589
     C           PMCPGM    IFEQ 'FXFX'                     B1
     C           PMDTPY    ANDEQ*ZEROS                     *1
     C                     MOVE '1'       *IN69            *1
     C                     END                             E1
     C           *IN69     IFEQ '0'                        B1
     C           PMPSTM    IFEQ 01                         B*2
     C           PMPSTM    OREQ 02                         **2
     C           PMPSTM    OREQ 04                         **2            100757
     C           PMPSTM    OREQ 05                         **2
     C           PMPSTM    OREQ 07                         **2
     C           PMPSTM    OREQ 08                         **2
     C           PMPSTM    OREQ 12                         **2
     C           PMPSTM    OREQ 14                         **2
     C/COPY WNCPYSRC,SD2410C095
     C           ATYP      IFEQ 'R'                        *1             BHF908
     C           PMRUND    SUB  PMBVPD    COMPDT  50       **2
     C           PMDTPY    IFLT COMPDT                     B**3
     C           CLE003    IFEQ 'Y'                                       CLE003
     C           COUNT1    IFEQ 1                                         CLE003
     C                     MOVE '806'     ERCD,S           **2            CLE003
     C                     ADD  1         S                **2            CLE003
     C                     ADD  1         COUNT1                          CLE003
     C                     MOVE '1'       *IN31            **2            CLE003
     C                     MOVE COUNT1    PMCMDP                          113832
     C                     ENDIF                                          CLE003
     C                     ELSE                                           CLE003
     C                     MOVE '943'     ERCD,S           ***3
     C                     ADD  1         S                ***3
     C                     MOVE '1'       *IN31                           LN0787
     C                     ENDIF                                          CLE003
     C                     END                             E**3
     C/COPY WNCPYSRC,SD2410C071
     C                     END                             E**3           BHF908
     C                     END                             E*2
     C                     END                             E1
     C                     END                                            E31589
     C*                                                                   E24039
     C                     END                                            E24039
     C                     OUT  LDA                                       E24039
     C***********          MOVE COUNT1    CNT1                      CLE003113832
     C*
     C** Defaulting for pay ordering customer/bank if both are blank.     E26903
     C** This will go onto DEALS and thence to SWIFT message.             E26903
     C*                                                                   E26903
     C           PMPSTM    IFEQ 01                                        E26903
     C           PMPSTM    OREQ 07                                        E26903
     C           PMPSTM    OREQ 08                                        E26903
     C*                                                                   E26903
     C***********PMPOBN    IFEQ *BLANKS                            E26903 E30756
     C***********PMPOCN    ANDEQ*BLANKS                            E26903 E30756
     C** Defaulting for pay ordering customer has to be done only if      093565
     C** both are blanks, if user blanks out PMPOCN and insert a bank     093565
     C** customer number in ordering bank AND overides Beneficiary with   093565
     C** a bank customer number, MT202 will be generated                  093565
     C           PMPOCN    IFEQ *BLANKS                                   E30756
     C           PMPOBN    ANDEQ*BLANKS                                   093565
     C*                                                                   E26903
     C** Find out what the counterparty is  bank/nonbank                  E26903
     C*                                                                   E26903
     C                     MOVE PMCSNM    CHKFLD                          E26903
     C                     EXSR CHKFL                                     E26903
     C***********RESULT    IFNE 'A'                                E26903 E30756
     C***********RESULT    ANDNE'B'                                E26903 E30756
     C***********          MOVE '872'     ERCD,S                   E26903 E30756
     C***********          ADD  1         S                        E26903 E30756
     C***********          ELSE                                    E26903 E30756
     C***********BANKNB    IFEQ 'B'                                E26903 E30756
     C***********          MOVELPMCSNM    PMPOBN                   E26903 E30756
     C***********          ELSE                                    E26903 E30756
     C***********BANKNB    IFEQ 'A'                                E26903 E30756
      *                                                                   134496
      ** Determine if Beneficiary is Bank of Non-bank                     134496
      *                                                                   134496
     C                     MOVEL*BLANKS   BFBNBB  1                       134496
     C                     MOVELPMBENN    CSTKEY                          134496
      *                                                                   134496
     C                     EXSR CUSGET                                    134496
     C           RTCD      IFEQ *BLANK                                    134496
     C                     MOVELBBBNBI    BFBNBB                          134496
     C                     ENDIF                                          134496
      *                                                                   134496
     C           BANKNB    IFEQ 'N'                                E26903 E30756
     C           BFBNBB    ANDNE'Y'                                       134496
     C                     MOVELPMCSNM    PMPOCN                          E26903
     C                     END                                            E26903
     C***********          END                                     E26903 E30756
     C*                                                                   E26903
     C                     END                                            E26903
     C*                                                                   E26903
     C                     END                                            E26903
     C*                                                                   221452
     C** No need to validate swift fields if Swift for Lending is not     221452
     C** on and settlement method is 09                                   221452
     C*                                                                   221452
     C           CLE033    IFEQ 'Y'                                       221452
     C           PMPSTM    ANDEQ09                                        221452
     C           BGSWCL    ANDNE'Y'                                       221452
     C                     GOTO PAYEND                                    221452
     C                     ENDIF                                          221452
     C*
     C** ORDERING CUSTOMER
     C** -----------------
     C/COPY WNCPYSRC,SD2410C004
     C                     MOVE *BLANKS   PAPOCN
     C           *IN38     CABEQ'1'       EVAL6            ERROR ON FIELD
     C/COPY WNCPYSRC,SD2410C005
     C*
     C** MUST BE A 6 DIGIT NUMBER
     C** OR A CUSTOMER SHORTNAME THAT IDENTIFIES A LIVE
     C** RECORD ON FILE SDCUSTPD
     C           PMPOCN    IFNE *BLANKS                    B1
     C                     MOVE *BLANKS   CHKFLD           *1             S01117
     C                     MOVE PMPOCN    CHKFLD           *1
     C                     MOVE 'N'       @CPNA            *1             S01117
     C                     EXSR CHKFL                      *1
     C*                                                                   S01117
     C           RTCD      IFEQ '*NOSEL '                  B*2            S01117
     C                     MOVE '872'     ERCD,S           **2            S01117
     C                     ADD  1         S                **2            S01117
     C                     MOVE '1'       *IN31                           LN0787
     C                     END                             E*2            S01117
     C*                                                                   S01117
     C**  Check that ordering customer is not a bank                      E26903
     C*                                                                   E26903
     C           BANKNB    IFEQ 'B'                                       E26903
     C                     MOVE '804'     ERCD,S                          E26903
     C                     ADD  1         S                               E26903
     C                     GOTO EVAL6                                     E26903
     C                     END                                            E26903
     C**                                                                  E26903
     C           RESULT    IFNE 'A'                        B*2
     C           RESULT    ANDNE'B'                        **2
     C                     MOVE '946'     ERCD,S           **2
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN31                           LN0787
     C                     ELSE                            X*2
     C* ORDERING CUSTOMER, PAYMENT SIDE MAY BE BANK                       S01297
     C********** BANKNB    IFEQ 'B'                        B**3     S01117S01297
     C**********           MOVE '880'     ERCD,S           ***3     S01117S01297
     C**********           ADD  1         S                ***3     S01117S01297
     C**********           END                             E**3     S01117S01297
     C                     MOVELBBCUST    PAPOCN           **2
     C*                                                                   S01117
     C**   CHECK IF '?' ENTERED, IF SO MOVE VALUE RETRIEVED               S01117
     C**   INTO SCREEN FIELD.                                             S01117
     C*                                                                   S01117
     C                     MOVELPMPOCN    @TSTQ   1        **2            S01117
     C           @TSTQ     IFEQ '?'                        B**3           S01117
     C                     MOVELBBCSSN    PMPOCN           ***3           S01117
     C                     END                             E**3           S01117
     C                     MOVE BANKNB    CPPOCN  1        **2
     C/COPY WNCPYSRC,SD2410C006
     C                     END                             E*2
     C                     END                             E1
     C           EVAL6     TAG
     C** ENTRY MANDATORY IF BENEFICIARY IS A NON-BANK
     C** ***VALIDATION DONE AFTER VALIDATION OF BENEFICIARY
     C*
     C** ORDERING BANK
     C** -------------
     C                     MOVE *BLANKS   PAPOBN
     C           *IN40     CABEQ'1'       EVAL7            ERROR ON FIELD
     C/COPY WNCPYSRC,SD2410C007
     C*
     C** MUST BE A 6 DIGIT NUMBER
     C** OR A CUSTOMER SHORTNAME THAT IDENTIFIES A LIVE
     C** RECORD ON FILE SDCUSTPD
     C           PMPOBN    IFNE *BLANKS                    B1
     C                     MOVE *BLANKS   CHKFLD           *1             S01117
     C                     MOVE PMPOBN    CHKFLD           *1
     C                     MOVE 'N'       @CPNA            *1             S01117
     C                     EXSR CHKFL                      *1
     C*                                                                   S01117
     C           RTCD      IFEQ '*NOSEL '                  B*2            S01117
     C                     MOVE '873'     ERCD,S           **2            S01117
     C                     ADD  1         S                **2            S01117
     C                     MOVE '1'       *IN31                           LN0787
     C                     END                             E*2            S01117
     C*                                                                   S01117
     C           RESULT    IFNE 'A'                        B*2
     C           RESULT    ANDNE'B'                        **2
     C                     MOVE '947'     ERCD,S           **2
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN31                           LN0787
     C                     ELSE                            X*2
     C           BANKNB    IFEQ 'B'                        B**3
     C                     MOVE BBCUST    PAPOBN           ***3           S01117
     C                     ELSE                            X**3
     C                     MOVE '948'     ERCD,S           ***3
     C                     ADD  1         S                ***3
     C                     MOVE '1'       *IN31                           LN0787
     C                     END                             E**3
     C*                                                                   S01117
     C**   CHECK IF '?' ENTERED, IF SO MOVE VALUE RETRIEVED               S01117
     C**   INTO SCREEN FIELD.                                             S01117
     C*                                                                   S01117
     C                     MOVELPMPOBN    @TSTQ   1        **2            S01117
     C           @TSTQ     IFEQ '?'                        B**3           S01117
     C                     MOVELBBCSSN    PMPOBN           ***3           S01117
     C                     END                             E**3           S01117
     C                     END                             E*2
     C/COPY WNCPYSRC,SD2410C008
     C                     END                             E1
     C*
     C** MUST NOT BE THE SAME AS ORDERING CUSTOMER
     C           PAPOBN    IFNE *BLANK                     B1
     C           PAPOBN    ANDNE*ZEROS                     B1
     C           PAPOBN    IFEQ PAPOCN                     B*2
     C                     MOVE '949'     ERCD,S           **2
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN31                           LN0787
     C                     END                             E*2
     C                     END                             E1
     C*
     C** FOR SETTL. TYPE 01,07 OR 08 ORDERING BANK OR ORDERING CUSTOMER
     C** MUST BE ENTERED  IF BENEFICIARY IS A NON-BANK
     C** ***VALIDATION DONE AFTER VALIDATION OF BENEFICIARY
     C           EVAL7     TAG
     C*
     C** RECEIVER'S CORRESPONDANT
     C** ------------------------
     C                     MOVE *BLANKS   PARCRN
     C           *IN41     CABEQ'1'       EVAL9            ERROR ON FIELD
     C/COPY WNCPYSRC,SD2410C009
     C*
     C** MUST BE A 6 DIGIT NUMBER
     C** OR A CUSTOMER SHORTNAME THAT IDENTIFIES A LIVE
     C** RECORD ON FILE SDCUSTPD OR A COUNTERPARTY NOSTRO CODE THAT
     C** IDENTIFIES A LIVE RECORD ON SDCNSTPD
     C                     MOVE 'Y'       CPRCRN  1
     C           PMRCRN    IFNE *BLANK                     B1
     C                     MOVE *BLANKS   CHKFLD           *1             S01117
     C                     MOVE PMRCRN    CHKFLD           *1
     C                     MOVE 'Y'       @CPNA            *1             S01117
     C                     EXSR CHKFL                      *1
     C*                                                                   S01117
     C           RTCD      IFEQ '*NOSEL '                  B*2            S01117
     C                     MOVE '874'     ERCD,S           **2            S01117
     C                     ADD  1         S                **2            S01117
     C                     MOVE '1'       *IN31                           LN0787
     C                     END                             E*2            S01117
     C*                                                                   S01117
     C           RESULT    IFEQ 'E'                        B*2
     C                     MOVE '957'     ERCD,S           **2
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN31                           LN0787
     C                     ELSE                            X*2
     C                     MOVELPMRCRN    @TSTQ            **2            S01117
     C           RESULT    IFEQ 'A'                        B**3
     C           RESULT    OREQ 'B'                        ***3
     C           BANKNB    IFEQ 'B'                        B***4
     C                     MOVELBBCUST    PARCRN           ****4
     C                     MOVE 'N'       CPRCRN           ****4
     C                     ELSE                            X***4
     C                     MOVE '958'     ERCD,S           ****4
     C                     ADD  1         S                ****4
     C                     MOVE '1'       *IN31                           LN0787
     C                     END                             E***4
     C*                                                                   S01117
     C**   CHECK IF '?' ENTERED, IF SO MOVE VALUE RETRIEVED               S01117
     C**   INTO SCREEN FIELD.                                             S01117
     C*                                                                   S01117
     C           @TSTQ     IFEQ '?'                        B***4          S01117
     C                     MOVELBBCSSN    PMRCRN           ****4          S01117
     C                     END                             E***4          S01117
     C                     ELSE                            X**3
     C                     MOVE *BLANKS   PARCRN           ***3           S01117
     C                     MOVELAWCPNC    PARCRN           ***3
     C*                                                                   S01117
     C**   CHECK IF '?' ENTERED, IF SO MOVE VALUE RETRIEVED               S01117
     C**   INTO SCREEN FIELD.                                             S01117
     C*                                                                   S01117
     C           @TSTQ     IFEQ '?'                        B****5         S01117
     C                     MOVE *BLANKS   PMRCRN           *****5         S01117
     C                     MOVELAWCPNC    PMRCRN           *****5
     C                     END                             E****5         S01117
     C                     END                             E**3
     C                     END                             E*2
     C                     END                             E1
     C/COPY WNCPYSRC,SD2410C010
     C           EVAL9     TAG
     C*
     C** RECEIVER'S CORRESPONDANT A/C LINE
     C** ---------------------------------
     C           PMRCRA    IFNE *BLANK                     B1
     C*
     C** ENTRY IS ONLY ALLOWED IF ENTRY HAS BEEN MADE IN REC. CORR.
     C           PMRCRN    IFEQ *BLANK                     B*2
     C                     MOVE '899'     ERCD,S           **2
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN31                           LN0787
     C                     END                             E*2
     C/COPY WNCPYSRC,SD2410C072
     C*
     C** FIRST TWO CHARACTERS MAY NOT BE '//'
     C                     MOVELPMRCRA    PMRCR2  2        *1
     C                     MOVE PMRCRA    PMXIBA           *1             060036
     C           PMRCR2    IFEQ '//'                       B*2
     C                     MOVE '960'     ERCD,S           **2
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN31                           LN0787
     C                     END                             E*2
     C/COPY WNCPYSRC,SD2410C073
     C*                                                                   060036
     C** If 1st & 3rd character are '/',                                  060036
     C** then 2nd character must be 'C' or 'D'.                           060036
     C*                                                                   060036
     C           PMXIB1    IFEQ '/'                        B*2            060036
     C           PMXIBE    ANDEQ'/'                        **2            060036
     C           PMXIB2    IFNE 'C'                        B**3           060036
     C           PMXIB2    ANDNE'D'                        ***3           060036
     C                     MOVE '201'     ERCD,S           ***3           060036
     C                     ADD  1         S                ***3           060036
     C                     MOVE '1'       *IN31            ***3           060036
     C                     END                             E**3           060036
     C                     END                             E*2            060036
     C                     END                             E1
     C*
     C** INTERMEDIARY BANK
     C** -----------------
     C                     MOVE 'Y'       CPPIBN  1
     C                     MOVE *BLANKS   PAPIBN
     C           *IN44     CABEQ'1'       EVAL10           ERROR ON FIELD
     C/COPY WNCPYSRC,SD2410C011
     C*
     C** MUST BE A 6 DIGIT NUMBER
     C** OR A CUSTOMER SHORTNAME THAT IDENTIFIES A LIVE
     C** RECORD ON FILE SDCUSTPD OR A COUNTERPARTY NOSTRO CODE THAT
     C** IDENTIFIES A LIVE RECORD ON SDCNSTPD
     C*
     C                     MOVE *BLANK    INPHON 12
     C                     MOVE *BLANK    INTELX 12
     C           PMPIBN    IFNE *BLANK                     B1
     C                     MOVE *BLANKS   CHKFLD           *1             S01117
     C                     MOVE PMPIBN    CHKFLD           *1
     C                     MOVE 'Y'       @CPNA            *1             S01117
     C           PMPSTM    IFEQ 07                         B*2            BHF810
     C***********PMPSTM    OREQ 08                         **2      BHF810E26771
     C                     MOVE 'N'       @CPNA            **2            BHF810
     C                     END                             E*2            BHF810
     C                     EXSR CHKFL                      *1
     C*                                                                   S01117
     C           RTCD      IFEQ '*NOSEL '                  B*2            S01117
     C                     MOVE '875'     ERCD,S           **2            S01117
     C                     ADD  1         S                **2            S01117
     C                     MOVE '1'       *IN31                           LN0787
     C                     END                             E*2            S01117
     C*                                                                   S01117
     C           RESULT    IFEQ 'E'                        B*2
     C                     MOVE '962'     ERCD,S           **2
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN31                           LN0787
     C                     ELSE                            X*2
     C                     MOVELPMPIBN    @TSTQ            **2            S01117
     C********** SWFT      IFEQ *BLANKS                    B**3           S01412
     C**********           MOVE '1'       *IN51            ***3           S01412
     C**********           END                             E**3           S01412
     C           RESULT    IFEQ 'A'                        B**3
     C           RESULT    OREQ 'B'                        ***3
     C                     MOVELBBCUST    PAPIBN
     C*                                                                   S01117
     C**   CHECK IF '?' ENTERED, IF SO MOVE VALUE RETRIEVED               S01117
     C**   INTO SCREEN FIELD.                                             S01117
     C*                                                                   S01117
     C           @TSTQ     IFEQ '?'                        B****5         S01117
     C                     MOVELBBCSSN    PMPIBN           *****5         S01117
     C                     END                             E****5         S01117
     C                     MOVE BBCTNB    INPHON           ***3
     C*********************MOVE BBTXA1    INTELX           ***3           S01117
     C                     MOVELBBTXA1    INTELX           ***3           S01117
     C           BANKNB    IFEQ 'B'                        B***4
     C**********           MOVE CNUM      NUPIBN  60       ****4                              CSD027
     C                     MOVE CNUM      NUPIBN  6        ****4                              CSD027
     C                     MOVE 'N'       CPPIBN           ****4
     C                     ELSE                            X***4
     C                     MOVE '963'     ERCD,S           ****4
     C                     ADD  1         S                ****4
     C                     MOVE '1'       *IN31                           LN0787
     C                     END                             E***4
     C                     ELSE                            X**3
     C                     MOVE *BLANKS   PAPIBN           ***3           S01117
     C                     MOVELAWCPNC    PAPIBN           ***3
     C*                                                                   S01117
     C**   CHECK IF '?' ENTERED, IF SO MOVE VALUE RETRIEVED               S01117
     C**   INTO SCREEN FIELD.                                             S01117
     C*                                                                   S01117
     C           @TSTQ     IFEQ '?'                        B***4          S01117
     C                     MOVE *BLANKS   PMPIBN           ****4          S01117
     C                     MOVELAWCPNC    PMPIBN           ****4
     C                     END                             E***4          S01117
     C                     END                             E**3
     C/COPY WNCPYSRC,SD2410C076
     C                     END                             E*2
     C                     END                             E1
     C/COPY WNCPYSRC,SD2410C058
     C           EVAL10    TAG
     C*
     C** INTERMEDIARY BANK A/C LINE
     C** --------------------------
     C           *IN46     CABEQ'1'       EVAL11           ERROR ON FIELD
     C/COPY WNCPYSRC,SD2410C062
     C*
     C           PMPIBA    IFNE *BLANK                                                        193584
     C*                                                                                       193584
     C** Entry is not allowed if the Nostro is a CLS Dummy Nostro.                            193584
     C                     MOVE PMPONS    NOSTRO                                              193584
     C                     MOVE WPECY     @CYCD                                               193584
     C                     MOVE NOST02    @NONB                                               193584
     C*                                                                                       193584
     C** Check the Nostro.                                                                    193584
     C                     EXSR CHKNO                                                         193584
      *                                                                                       193584
     C           A7CLSD    IFEQ 'Y'                                                           193584
     C                     MOVE '712'     ERCD,S                                              193584
     C                     ADD  1         S                                                   193584
     C                     MOVE '1'       *IN31                                               193584
     C                     GOTO EVAL11                     **2                                193584
     C                     END                                                                193584
     C                     END                                                                193584
      *                                                                                       193584
     C           PMPIBA    IFNE *BLANK                     B1
     C                     MOVE PMPIBA    PMXIBA           *1
     C*
     C** ENTRY IS ONLY ALLOWED IF ENTRY HAS BEEN MADE IN INTER. BANK
     C           PMPIBN    IFEQ *BLANK                     B*2
     C                     MOVE '965'     ERCD,S           **2
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN31                           LN0787
     C                     GOTO EVAL11                     **2
     C                     END                             E*2
     C/COPY WNCPYSRC,SD2410C059
      *****************************************************************   CSW096
      *                                                                   CSW096
      * Call Account Line Validation object                               CSW096
      *                                                                   CSW096
      * Set up parameters                                                 CSW096
      *                                                                   CSW096
     C                     MOVEL*BLANKS   W0RTN                           CSW096
     C                     CLEARI#PARM                                    CSW096
     C                     MOVEL'INBK '   I#VFLD                          CSW096
     C                     MOVEL'PAY'     I#PR                            CSW096
     C                     MOVEL'X'       I#PRTT                          CSW096
     C                     MOVELPMPIBN    I#PRTY                          CSW096
     C***********          MOVELPMPCCY    I#PCCY                   CSW096 CEU003
     C***********          MOVELPMRCCY    I#RCCY                   CSW096 CEU003
     C                     MOVELWPECY     I#PCCY                          CEU003
     C                     MOVELWRECY     I#RCCY                          CEU003
     C                     MOVELPMPIBA    I#ACLN                          CSW096
     C                     MOVELPMPSTM    I#PSTM                          CSW096
     C                     MOVELPMRSTM    I#RSTM                          CSW096
     C           PMPOCN    IFNE *BLANKS                                   CSW096
      *                                                                                       CSW203
      ** Set I#MTYP to "103" instead of "100" if CSW203 is installed                          CSW203
      *                                                                                       CSW203
     C           CSW203    IFEQ 'Y'                                                           CSW203
     C                     MOVEL'103'     I#MTYP                                              CSW203
     C                     ELSE                                                               CSW203
     C                     MOVEL'100'     I#MTYP                          CSW096
     C                     ENDIF                                                              CSW203
     C                     ELSE                                           CSW096
     C                     MOVEL'202'     I#MTYP                          CSW096
     C                     ENDIF                                          CSW096
      * Set up receive account information                                CSW096
     C           PMRONS    IFNE *BLANKS                                   CSW096
     C                     SELEC                                          CSW096
     C           PMROBR    WHNE *BLANKS                                   CSW096
     C           PMRONS    CAT  PMROBR    I#RCAC                          CSW096
     C           PMRONS    WHNE *BLANKS                                   CSW096
     C                     MOVELPMRONS    I#RCAC                          CSW096
     C                     ENDSL                                          CSW096
     C                     ENDIF                                          CSW096
      * Set up Pay account information                                    CSW096
     C           PMPONS    IFNE *BLANKS                                   CSW096
     C                     SELEC                                          CSW096
     C           PMPOBR    WHNE *BLANKS                                   CSW096
     C           PMPONS    CAT  PMPOBR    I#PYAC                          CSW096
     C           PMPONS    WHNE *BLANKS                                   CSW096
     C                     MOVELPMPONS    I#PYAC                          CSW096
     C                     ENDSL                                          CSW096
     C                     ENDIF                                          CSW096
      * If extra message and Rec Corr. then set 5354 field                CSW096
     C           PMRVNO    IFNE *BLANKS                                   CSW096
     C           PMRCRN    ANDNE*BLANKS                                   CSW096
     C                     MOVEL'Y'       I#5354                          CSW096
     C                     ENDIF                                          CSW096
      * Transaction Type                                                  CSW096
     C                     MOVELPMTTYP    I#TTYP                          CSW096
      *                                                                   CSW096
     C                     CLEARO#PARM                                    CSW096
     C                     CLEARE#PARM                                    CSW096
      *                                                                   CSW096
      * Send messages to correct calling process                          CSW096
      *                                                                   CSW096
     C                     SELEC                                          CSW096
     C           PMCPGM    WHEQ 'FXFX'                                    CSW096
     C                     MOVEL'ME9940'  E#CPGM                          CSW096
     C                     MOVEL'DL'      I#MMOD                          CSW096
     C           PMCPGM    WHEQ 'MMLD'                                    CSW096
     C                     MOVEL'ME9940'  E#CPGM                          CSW096
     C                     MOVEL'LE'      I#MMOD                          CSW096
     C           PMCPGM    WHEQ 'SSI '                                    CSW096
     C                     MOVEL'SD0401R' E#CPGM                          CSW096
     C                     OTHER                                          CSW096
     C                     MOVEL'ME9940'  E#CPGM                          CSW096
     C                     ENDSL                                          CSW096
     C                     MOVEL'MEC0016' E#MSGD                          CSW096
     C                     MOVEL'MEMSG'   E#MSGF                          CSW096
      *                                                                   CSW096
     C                     CALL 'ME9940'                                  CSW096
     C                     PARM           W0RTN   7                       CSW096
     C                     PARM           I#PARM           I Input Parms  CSW096
     C                     PARM           O#PARM           O Output Parms CSW096
     C                     PARM           E#PARM           E Error Inform CSW096
     C                     PARM           Z#PARM256        B User Defined CSW096
      *                                                                   CSW096
      * On return if errors copy into error array                         CSW096
      *                                                                   CSW096
     C                     MOVELO#ACLN    PMPIBA                          CSW096
      *                                                                   CSW096
     C           E#ERRM    IFNE *BLANKS                                   CSW096
      *                                                                   CSW096
     C           1         DO   E#INDX    Q#      50                      CSW096
     C                     MOVEAO#E,Q#    ERCD,S                          CSW096
     C                     ADD  1         S                               CSW096
     C                     ENDDO                                          CSW096
      *                                                                   CSW096
      * Mark pay side as ib error                                         CSW096
     C                     MOVEL*ON       *IN31                           CSW096
      *                                                                   CSW096
     C                     ENDIF                                          CSW096
      *                                                                   CSW096
     C                     ENDIF                                          CSW096
      *                                                                   CSW096
      *****************************************************************   CSW096
      ***********                                                         CSW096
     C***********                                                         CSW096
     C***FIRST*CHARACTER MUST BE '/'                                      CSW096
     C***********PMXIB1    IFNE '/'                        B*2            CSW096
     C***********          MOVE '966'     ERCD,S           **2            CSW096
     C***********          ADD  1         S                **2            CSW096
     C***********          MOVE '1'       *IN31                     LN0787CSW096
     C***********          END                             E*2            CSW096
     C***********                                                   060036CSW096
     C***If*1st*& 3rd character are '/',                            060036CSW096
     C***then*2nd character must be 'C' or 'D'.                     060036CSW096
     C***********                                                   060036CSW096
     C***********PMXIB1    IFEQ '/'                        B*2      060036CSW096
     C***********PMXIBE    ANDEQ'/'                        **2      060036CSW096
     C***********PMXIB2    IFNE 'C'                        B**3     060036CSW096
     C***********PMXIB2    ANDNE'D'                        ***3     060036CSW096
     C***********          MOVE '202'     ERCD,S           ***3     060036CSW096
     C***********          ADD  1         S                ***3     060036CSW096
     C***********          MOVE '1'       *IN31            ***3     060036CSW096
     C***********          END                             E**3     060036CSW096
     C***********          END                             E*2      060036CSW096
     C***********                                                         CSW096
     C***IF*SECOND CHARACTER IS ALSO '/'                                  CSW096
     C***MUST*BE*FOLLOWED BY CP, FW, BL or SW.                      CSW095CSW096
     C***MUST*BE*FOLLOWED*BY*CP,FW*OR*BL****************************CSW095CSW096
     C***********PMXIB2    IFEQ '/'                        B*2            CSW096
     C***********PMXIB4    IFNE '//CP'                     B**3           CSW096
     C***********PMXIB4    ANDNE'//FW'                     ***3           CSW096
     C***********PMXIB4    ANDNE'//BL'                     ***3           CSW096
     C***********PMXIB4    ANDNE'//SC'                     ***3     056873CSW096
     C***********PMXIB4    ANDNE'//CH'                     ***3     056847CSW096
     C***********PMXIB4    ANDNE'//SW'                     ***3     CSW095CSW096
     C***********          MOVE '967'     ERCD,S           ***3           CSW096
     C***********          ADD  1         S                ***3           CSW096
     C***********          MOVE '1'       *IN31                     LN0787CSW096
     C***********          END                             E**3           CSW096
     C***********          END                             E*2            CSW096
     C***********                                                         CSW096
     C***IF*FOLLOWED*BY*CP*OR*FW*CURRENCY*MUST*BE*USD***************056847CSW096
     C***If*followed by CP, CH, or FW currency must be USD          056847CSW096
     C***If*followed by SC currency must be GBP                     056847CSW096
     C***IF*FOLLOWED BY BL CURRENCY MUST BE DEM                           CSW096
     C***If*followed by SW currency must be CHF.                    CSW095CSW096
     C***********PMXIB4    IFEQ '//CP'                     B*2            CSW096
     C***********PMXIB4    OREQ '//FW'                     **2            CSW096
     C***********PMXIB4    OREQ '//BL'                     **2            CSW096
     C***********PMXIB4    OREQ '//SC'                     **2      056847CSW096
     C***********PMXIB4    OREQ '//CH'                     **2      056847CSW096
     C***********PMXIB4    OREQ '//SW'                     **2      CSW095CSW096
     C***********          MOVE PMPCCY    KEYY             **2            CSW096
     C***********          MOVE PMXIB4    KEYZ             **2            CSW096
     C***********          EXSR CHKCY                      **2            CSW096
     C***********RTCD      IFNE *BLANKS                    B*2            CSW096
     C***********          MOVE '968'     ERCD,S           ***3           CSW096
     C***********          ADD  1         S                ***3           CSW096
     C***********          MOVE '1'       *IN31                     LN0787CSW096
     C***********          GOTO EVAL11                     ***3           CSW096
     C***********          END                             E**3           CSW096
     C***********          END                             E*2            CSW096
     C***********                                                         CSW096
     C***IF*//CP*AND FOLLOWED BY BLANKS THEN DEFAULT THIS TO THE          CSW096
     C***CUSTOMERS CHIPS PARTICIPANT ONLY IF PMPIBA IS A CUSTOMER         CSW096
     C***********CPPIBN    IFEQ 'N'                        B*2            CSW096
     C***********PMXIB4    IFEQ '//CP'                     B**3           CSW096
     C***********PMXIB5    ANDEQ*BLANK                     ***3           CSW096
     C***********          Z-ADDBBCABA    PNXIB3           ***3     S01429CSW096
     C***********          Z-ADDBBABA2    PNXIB3           ***3     S01429CSW096
     C***********          MOVE PMXIBA    PMPIBA           ***3           CSW096
     C***********          END                             E**3           CSW096
     C***********          END                             E*2            CSW096
     C***********                                                         CSW096
     C***IF*//CP*IT*MUST*BE*FOLLOWED*BY*A*3*DIGIT*NUMBER.THE NUMBER*S01429CSW096
     C***IF*//CP*IT MUST BE FOLLOWED BY A 4 DIGIT NUMBER.THE NUMBER S01429CSW096
     C***MUST*BE*FOLLOWED BY BLANKS.                                      CSW096
     C***********PMXIB4    IFEQ '//CP'                     B*2            CSW096
     C***********          TESTN          PMXIB3     60    **2            CSW096
     C************IN60     IFNE '1'                        NOT NUMERIC    CSW096
     C***********PMXIBX    ORNE *BLANKS                    NOT FOLL. BY BLCSW096
     C***********          MOVE '969'     ERCD,S           ***3           CSW096
     C***********          ADD  1         S                ***3           CSW096
     C***********          MOVE '1'       *IN31                     LN0787CSW096
     C***********          END                             E**3           CSW096
     C***********          END                             E*2            CSW096
     C***********                                                         CSW096
     C***IF*//FW*IT MUST BE FOLLOWED BY A 9 DIGIT NUMBER.IF INTER. BANK   CSW096
     C***HAS*A*SWIFT ADDRESS //FW DOES NOT REQUIRE TO BE FOLLOWED BY      CSW096
     C***A*NUMBER                                                         CSW096
     C***********PMXIB4    IFEQ '//FW'                     B*2            CSW096
     C***********          TESTN          PMXIB9     60    **2            CSW096
     C************IN60     IFNE '1'                        NOT NUMERIC    CSW096
     C***********PMXIBZ    ORNE *BLANKS                    NOT FOLL. BY BLCSW096
     C***********          MOVE '0'       *IN60            ***3           CSW096
     C***********          END                             E**3           CSW096
     C***********CPPIBN    IFEQ 'N'                        B**3           CSW096
     C***********SWFT      ANDNE*BLANKS                    ***3           CSW096
     C***********PMXIB5    ANDEQ*BLANKS                    ***3           CSW096
     C***********          MOVE '1'       *IN60            ***3           CSW096
     C***********          END                             E**3           CSW096
     C***IF*SWIFT ADDRESS IS BLANK BUT THE FEDWIRE ACCOUNT NUMBER IS      CSW096
     C***PRESENT, SET UP THE FEDWIRE ACCOUNT                              CSW096
     C***********PMXIB5    IFEQ *BLANKS                    B**3           CSW096
     C***********SWFT      ANDEQ*BLANKS                    ***3           CSW096
     C***********FEDW      ANDNE*ZEROS                     ***3           CSW096
     C***********          Z-ADDFEDW      PMXIB7           ***3           CSW096
     C***********          END                             E**3           CSW096
     C***********SWFT      IFEQ *BLANKS                    B**3           CSW096
     C***********FEDW      ANDEQ*ZEROS                     ***3     S01117CSW096
     C***********PMXIB9    ANDEQ*BLANKS                    ***3     S01117CSW096
     C***********          MOVE '0'       *IN60            ***3           CSW096
     C***********          END                             E**3           CSW096
     C************IN60     IFNE '1'                        B**3           CSW096
     C***********          MOVE '969'     ERCD,S           ***3           CSW096
     C***********          ADD  1         S                ***3           CSW096
     C***********          MOVE '1'       *IN31                     LN0787CSW096
     C***********          END                             E**3           CSW096
     C***********          END                             E*2            CSW096
     C***********                                                         CSW096
     C***IF*//BL*AND FOLLOWED BY BLANKS THEN DEFAULT THIS TO THE          CSW096
     C***BANKLEITZAHL CODE ONLY IF PMPIBN IS A CUSTOMER                   CSW096
     C***********CPPIBN    IFEQ 'N'                        B*2            CSW096
     C***********PMXIB4    IFEQ '//BL'                     B**3           CSW096
     C***********PMXIB8    ANDEQ*BLANK                     ***3           CSW096
     C***********          MOVE BBBLCD    PMXIB8           ***3           CSW096
     C***********          MOVE PMXIBA    PMPIBA           ***3           CSW096
     C***********          END                             E**3           CSW096
     C***********          END                             E*2            CSW096
     C***********                                                         CSW096
     C***IF*//BL*IT MUST BE FOLLOWED BY A 8 DIGIT NUMBER.                 CSW096
     C***********PMXIB4    IFEQ '//BL'                     B*2            CSW096
     C***********          TESTN          PMXIB8     60    **2            CSW096
     C************IN60     IFNE '1'                        NOT NUMERIC    CSW096
     C***********PMXIBY    ORNE *BLANKS                    NOT FOLL. BY BLCSW096
     C***********          MOVE '969'     ERCD,S           ***3           CSW096
     C***********          ADD  1         S                ***3           CSW096
     C***********          MOVE '1'       *IN31                     LN0787CSW096
     C***********          END                             E**3           CSW096
     C***********          END                             E*2            CSW096
     C***********                                                   056847CSW096
     C***If*//CH*and followed by blanks than default this to the    056847CSW096
     C***customers CHIPS universal id. only if PMPIBN is a customer 056847CSW096
     C***********                                                   056847CSW096
     C***********CPPIBN    IFEQ 'N'                        B*2      056847CSW096
     C***********PMXIB4    IFEQ '//CH'                     B**3     056847CSW096
     C***********PMXIB5    ANDEQ*BLANK                     ***3     056847CSW096
     C***********          Z-ADDBBCHID    PNXIB6           ***3     056847CSW096
     C***********          MOVE PMXIBA    PMPIBA           ***3     056847CSW096
     C***********          END                             E**3     056847CSW096
     C***********          END                             E*2      056847CSW096
     C***********                                                   056847CSW096
     C***If*//SC*and followed by blanks then default this to the    056847CSW096
     C***chaps*sort code only if PMPIBN is a customer               056847CSW096
     C***********                                                   056847CSW096
     C***********CPPIBN    IFEQ 'N'                        B*2      056847CSW096
     C***********PMXIB4    IFEQ '//SC'                     B**3     056847CSW096
     C***********PMXIB5    ANDEQ*BLANK                     ***3     056847CSW096
     C***********          Z-ADDBBCHSC    PNXIB6           ***3     056847CSW096
     C***********          MOVE PMXIBA    PMPIBA           ***3     056847CSW096
     C***********          END                             E**3     056847CSW096
     C***********          END                             E*2      056847CSW096
     C***********                                                   056847CSW096
     C***If*//CH*or //SC it must be followed by a 6-digit number.   056847CSW096
     C***Also*check*//SW.************************************CSW095 094100CSW096
     C***********                                                   056847CSW096
     C***********PMXIB4    IFEQ '//CH'                     B*2      056847CSW096
     C***********PMXIB4    OREQ '//SC'                     **2      056847CSW096
     C***********PMXIB4    OREQ '//SW'                     **CSW095 094100CSW096
     C***********          TESTN          PMXIB6     60    **2      056847CSW096
     C************IN60     IFNE '1'                        not numer056847CSW096
     C***********PMXIBW    ORNE *BLANKS                    not foll.056847CSW096
     C***********          MOVE '969'     ERCD,S           ***3     056847CSW096
     C***********          ADD  1         S                ***3     056847CSW096
     C***********          MOVE '1'       *IN31                     056847CSW096
     C***********          END                             E**3     056847CSW096
     C***********          END                             E*2      056847CSW096
      ***********                                                   094100CSW096
      ***If*//SW*must be followed by a 5-digit number.              094100CSW096
     C***********PMXIB4    IFEQ '//SW'                     B*2      094100CSW096
     C***********          TESTN          PMXSW5     60    **2      094100CSW096
     C************IN60     IFNE '1'                        not numer094100CSW096
     C***********PMXSWW    ORNE *BLANKS                    not foll.094100CSW096
     C***********          MOVE '969'     ERCD,S           ***3     094100CSW096
     C***********          ADD  1         S                ***3     094100CSW096
     C***********          MOVE '1'       *IN31                     094100CSW096
     C***********          ENDIF                           E**3     094100CSW096
     C***********          ENDIF                           E*2      094100CSW096
     C***********          END                             E1             CSW096
     C           EVAL11    TAG
     C*
     C** ACCOUNT WITH BANK
     C** -----------------
     C                     MOVE 'Y'       CPAWBN  1
     C                     MOVE *BLANKS   PAAWBN
     C           *IN47     CABEQ'1'       EVAL12           ERROR ON FIELD
     C/COPY WNCPYSRC,SD2410C012
     C*
     C** MUST BE A 6 DIGIT NUMBER
     C** OR A CUSTOMER SHORTNAME THAT IDENTIFIES A LIVE
     C** RECORD ON FILE SDCUSTPD OR A COUNTERPARTY NOSTRO CODE THAT
     C** IDENTIFIES A LIVE RECORD ON SDCNSTPD
     C** DT0069: A Nostro Number is also now allowed.                     DT0069
     C                     MOVE *BLANK    ACPHON 12
     C                     MOVE *BLANK    ACTELX 12
     C           PMAWBN    IFNE *BLANK                     B1
     C                     MOVE *BLANK    @NOST                           DT0069
     C                     MOVE *BLANKS   CHKFLD           *1             S01117
     C                     MOVE PMAWBN    CHKFLD           *1
     C                     MOVE 'Y'       @CPNA            *1             S01117
     C           PMPSTM    IFEQ 07                         B*2            BHF810
     C***********PMPSTM    OREQ 08                         **2      BHF810E26771
     C/COPY WNCPYSRC,SD2410C074
     C*C*PY*WN*PYSRC*SD2410C054                                           169210
     C/COPY WNCPYSRC,SD2410CX54                                           169210
     C                     MOVE 'N'       @CPNA            **2            BHF810
     C                     END                             E*2            BHF810
     C                     EXSR CHKFL                      *1
     C*                                                                   DT0069
     C** If no record selected from the Customer or Counterparty Nostro   DT0069
     C** screens, or if field was neither of these, and only two          DT0069
     C** characters have been entered into the field, check for a Nostro  DT0069
     C** Number.                                                          DT0069
     C           RTCD      IFEQ '*NOSEL '                  B*2            DT0069
     C           RESULT    OREQ 'E'                        **2            DT0069
     C*                                                                   DT0069
     C** Set up work field for checking Nostro Number                     DT0069
     C                     MOVELPMAWBN    @@AWBN                          DT0069
     C*                                                                   DT0069
     C** Align and check Nostro Number:                                   DT0069
     C                     Z-ADD1         @       20       Set pointer    DT0069
     C           *BLANK    LOKUPNALG,@               97    First non-blankDT0069
     C*                                                                   DT0069
     C** If a non-blank character was found:                              DT0069
     C           *IN97     IFEQ '1'                        B**3           DT0069
      *                                                                   DT0069
     C                     MOVEANALG,@    @ALGN  10        ¦ Align        DT0069
     C                     MOVE @ALGN     @@AWBN           ¦ left         DT0069
     C*                                                                   DT0069
     C** The first two characters of @@AWBN should now contain the Nostro DT0069
     C** Number; check that the remaining characters are blank:           DT0069
     C           @@NRST    IFEQ *BLANKS                    B***4          DT0069
     C*                                                                   DT0069
     C** If they are, check whether the value in the first two characters DT0069
     C** is a valid Nostro Number:                                        DT0069
     C                     MOVE *BLANKS   RTCD             ****4          DT0069
     C                     MOVEL'*KEY'    OPTN             ****4          DT0069
     C***********          MOVE PMPCCY    @CYCD            ****4   DT0069 CEU003
     C                     MOVE WPECY     @CYCD                           CEU003
     C                     MOVEL@@NONO    @NONB            ****4          DT0069
     C                     EXSR CHKNO                      ****4          DT0069
     C                     END                             E***4          DT0069
     C                     END                             E**3           DT0069
     C                     END                             E*2            DT0069
     C*                                                                   S01117
     C           RTCD      IFEQ '*NOSEL '                  B*2            S01117
     C                     MOVE '876'     ERCD,S           **2            S01117
     C                     ADD  1         S                **2            S01117
     C                     MOVE '1'       *IN31                           LN0787
     C                     END                             E*2            S01117
     C*                                                                   S01117
     C***********RESULT****IFEQ 'E'                        B**3           DT0069
     C           RTCD      IFNE *BLANKS                    B*2            DT0069
     C                     MOVE '970'     ERCD,S           **2
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN31                           LN0787
     C                     ELSE                            X*2
     C                     MOVELPMAWBN    @TSTQ            **2            S01117
     C           RESULT    IFEQ 'A'                        B**3
     C           RESULT    OREQ 'B'                        ***3
     C                     MOVELBBCUST    PAAWBN           ***3
     C*                                                                   S01117
     C**   CHECK IF '?' ENTERED, IF SO MOVE VALUE RETRIEVED               S01117
     C**   INTO SCREEN FIELD.                                             S01117
     C*                                                                   S01117
     C           @TSTQ     IFEQ '?'                        B***4          S01117
     C                     MOVELBBCSSN    PMAWBN           ****4          S01117
     C                     END                             E***4          S01117
     C*********************MOVE BBTXA1    ACTELX           ***3           S01117
     C                     MOVELBBTXA1    ACTELX           ***3           S01117
     C                     MOVE BBCTNB    ACPHON           ***3
     C           BANKNB    IFEQ 'B'                        B***4
     C**********           MOVE CNUM      NUAWBN  60       ****4                              CSD027
     C                     MOVE CNUM      NUAWBN  6        ****4                              CSD027
     C                     MOVE 'N'       CPAWBN           ****4
     C                     ELSE                            X***4
     C                     MOVE '971'     ERCD,S           ****4
     C                     ADD  1         S                ****4
     C                     MOVE '1'       *IN31                           LN0787
     C                     END                             E***4
     C                     ELSE                            X**3
     C*                                                                   DT0069
     C** Set details if value entered was a Nostro.                       DT0069
     C           @NOST     IFEQ 'Y'                        B***4          DT0069
     C                     MOVELA7CUST    PAAWBN                          DT0069
     C           @TSTQ     IFEQ '?'                        B****5         DT0069
     C                     MOVE *BLANKS   PMAWBN           *****5         DT0069
     C                     MOVELA7CUST    PMAWBN           *****5         DT0069
     C                     END                             E****5         DT0069
      *                                                                   181340
      ** For Nostro, account with bank must be a SWIFT financial          181340
      ** Institution.                                                     181340
      *                                                                   181340
     C                     MOVELA7CUST    CHKFLD                          181340
     C                     EXSR CHKFL                                     181340
     C           BANKNB    IFNE 'B'                                       181340
     C                     MOVE '971'     ERCD,S                          181340
     C                     ADD  1         S                               181340
     C                     MOVE '1'       *IN31                           181340
     C                     END                                            181340
      *                                                                   181340
     C                     ELSE                            X***4          DT0069
     C                     MOVE *BLANKS   PAAWBN           ****4          S01117
     C                     MOVELAWCPNC    PAAWBN           ****4
     C*                                                                   S01117
     C**   CHECK IF '?' ENTERED, IF SO MOVE VALUE RETRIEVED               S01117
     C**   INTO SCREEN FIELD.                                             S01117
     C*                                                                   S01117
     C           @TSTQ     IFEQ '?'                        B****5         S01117
     C                     MOVE *BLANKS   PMAWBN           *****5         S01117
     C                     MOVELAWCPNC    PMAWBN           *****5
     C                     END                             E****5         DT0069
     C                     END                             E***4          S01117
     C                     END                             E**3
     C/COPY WNCPYSRC,SD2410C077
     C                     END                             E*2
     C                     END                             E1
     C*                                                                   S01408
     C/COPY WNCPYSRC,SD2410CP15                                           S01408
     C*                                                                   S01408
     C           EVAL12    TAG
     C*
     C** ACCOUNT WITH BANK A/C LINE
     C** --------------------------
     C           *IN48     CABEQ'1'       EVAL13           ERROR ON FIELD
     C                     MOVELPMAWBA    AWBA6   6
     C                     MOVE PMAWBA    AWBA29 29
     C*                                                                                       193584
     C           PMAWBA    IFNE *BLANKS                                                       193584
     C** Entry is not allowed if the Nostro is a CLS Dummy Nostro.                            193584
     C                     MOVE PMPONS    NOSTRO                                              193584
     C                     MOVE WPECY     @CYCD                                               193584
     C                     MOVE NOST02    @NONB                                               193584
     C*                                                                                       193584
     C** Check the Nostro.                                                                    193584
     C                     EXSR CHKNO                                                         193584
      *                                                                                       193584
     C           A7CLSD    IFEQ 'Y'                                                           193584
     C                     MOVE '713'     ERCD,S                                              193584
     C                     ADD  1         S                                                   193584
     C                     MOVE '1'       *IN31                                               193584
     C                     END                                                                193584
     C                     END                                                                193584
      *                                                                                       193584
     C*
     C** ACCOUNT WITH MUST BE BLANK IF 'DIRECT' ENTERED IN ACCOUNT WITH
     C** BANK A/C LINE
     C           PMAWBN    IFNE *BLANKS                    B1
     C           AWBA6     ANDEQ'DIRECT'                   *1
     C                     MOVE '973'     ERCD,S           *1
     C                     ADD  1         S                *1
     C                     MOVE '1'       *IN31                           LN0787
     C                     END                             E1
     C*
     C*
     C** AWBA MAY ONLY CONTAIN WORD 'DIRECT' WHEN AWBN BLANK
     C           PMAWBN    IFEQ *BLANKS                    B1
     C           PMAWBA    ANDNE*BLANKS                    *1
     C           AWBA6     ANDNE'DIRECT'                   *1
     C*
     C           PMAWBN    OREQ *BLANKS                    *1
     C           PMAWBA    ANDNE*BLANKS                    *1
     C           AWBA29    ANDNE*BLANKS                    *1
     C*
     C           PMAWBN    OREQ *BLANKS                    *1
     C           AWBA29    ANDNE*BLANKS                    *1
     C*
     C           PMAWBN    ORNE *BLANKS                    *1
     C           AWBA6     ANDEQ'DIRECT'                   *1
     C           AWBA29    ANDEQ*BLANKS                    *1
     C                     MOVE '974'     ERCD,S           *1
     C                     ADD  1         S                *1
     C                     MOVE '1'       *IN31                           LN0787
     C                     MOVE '1'       *IN48            *1
     C                     END                             E1
     C*
     C           *IN48     CABEQ'1'       EVAL13
     C/COPY WNCPYSRC,SD2410C013
     C*
     C           PMAWBA    IFNE *BLANK                     B1
     C           AWBA6     ANDNE'DIRECT'                   *1
     C                     MOVE PMAWBA    PMXIBA           *1
     C*
     C** FIRST CHARACTER MUST BE '/'
     C           PMXIB1    IFNE '/'                        B*2
     C/COPY WNCPYSRC,SD2410C014
     C                     MOVE '974'     ERCD,S           **2
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN31                           LN0787
     C                     END                             E*2
     C/COPY WNCPYSRC,SD2410C015
      *****************************************************************   CSW096
      *                                                                   CSW096
      * Call Account Line Validation object                               CSW096
      *                                                                   CSW096
      * Set up parameters                                                 CSW096
      *                                                                   CSW096
     C                     MOVEL*BLANKS   W0RTN                           CSW096
     C                     CLEARI#PARM                                    CSW096
     C                     MOVEL'AWBK '   I#VFLD                          CSW096
     C                     MOVEL'PAY'     I#PR                            CSW096
     C                     MOVEL'X'       I#PRTT                          CSW096
     C                     MOVELPMAWBN    I#PRTY                          CSW096
     C***********          MOVELPMPCCY    I#PCCY                   CSW096 CEU003
     C***********          MOVELPMRCCY    I#RCCY                   CSW096 CEU003
     C                     MOVELWPECY     I#PCCY                          CEU003
     C                     MOVELWRECY     I#RCCY                          CEU003
     C                     MOVELPMAWBA    I#ACLN                          CSW096
     C                     MOVELPMPSTM    I#PSTM                          CSW096
     C                     MOVELPMRSTM    I#RSTM                          CSW096
     C           PMPOCN    IFNE *BLANKS                                   CSW096
      *                                                                                       CSW203
      ** Set I#MTYP to "103" instead of "100" if CSW203 is installed                          CSW203
      *                                                                                       CSW203
     C           CSW203    IFEQ 'Y'                                                           CSW203
     C                     MOVEL'103'     I#MTYP                                              CSW203
     C                     ELSE                                                               CSW203
     C                     MOVEL'100'     I#MTYP                          CSW096
     C                     ENDIF                                                              CSW203
     C                     ELSE                                           CSW096
     C                     MOVEL'202'     I#MTYP                          CSW096
     C                     ENDIF                                          CSW096
      * Set up receive account information                                CSW096
     C           PMRONS    IFNE *BLANKS                                   CSW096
     C                     SELEC                                          CSW096
     C           PMROBR    WHNE *BLANKS                                   CSW096
     C           PMRONS    CAT  PMROBR    I#RCAC                          CSW096
     C           PMRONS    WHNE *BLANKS                                   CSW096
     C                     MOVELPMRONS    I#RCAC                          CSW096
     C                     ENDSL                                          CSW096
     C                     ENDIF                                          CSW096
      * Set up Pay account information                                    CSW096
     C           PMPONS    IFNE *BLANKS                                   CSW096
     C                     SELEC                                          CSW096
     C           PMPOBR    WHNE *BLANKS                                   CSW096
     C           PMPONS    CAT  PMPOBR    I#PYAC                          CSW096
     C           PMPONS    WHNE *BLANKS                                   CSW096
     C                     MOVELPMPONS    I#PYAC                          CSW096
     C                     ENDSL                                          CSW096
     C                     ENDIF                                          CSW096
      * If extra message and Rec Corr. then set 5354 field                CSW096
     C           PMRVNO    IFNE *BLANKS                                   CSW096
     C           PMRCRN    ANDNE*BLANKS                                   CSW096
     C                     MOVEL'Y'       I#5354                          CSW096
     C                     ENDIF                                          CSW096
      * Transaction Type                                                  CSW096
     C                     MOVELPMTTYP    I#TTYP                          CSW096
      *                                                                   CSW096
     C                     CLEARO#PARM                                    CSW096
     C                     CLEARE#PARM                                    CSW096
      *                                                                   CSW096
      * Send messages to correct calling process                          CSW096
      *                                                                   CSW096
     C                     SELEC                                          CSW096
     C           PMCPGM    WHEQ 'FXFX'                                    CSW096
     C                     MOVEL'ME9940'  E#CPGM                          CSW096
     C                     MOVEL'DL'      I#MMOD                          CSW096
     C           PMCPGM    WHEQ 'MMLD'                                    CSW096
     C                     MOVEL'ME9940'  E#CPGM                          CSW096
     C                     MOVEL'LE'      I#MMOD                          CSW096
     C           PMCPGM    WHEQ 'SSI '                                    CSW096
     C                     MOVEL'SD0401R' E#CPGM                          CSW096
     C                     OTHER                                          CSW096
     C                     MOVEL'ME9940'  E#CPGM                          CSW096
     C                     ENDSL                                          CSW096
     C                     MOVEL'MEC0017' E#MSGD                          CSW096
     C                     MOVEL'MEMSG'   E#MSGF                          CSW096
      *                                                                   CSW096
     C                     CALL 'ME9940'                                  CSW096
     C                     PARM           W0RTN   7                       CSW096
     C                     PARM           I#PARM           I Input Parms  CSW096
     C                     PARM           O#PARM           O Output Parms CSW096
     C                     PARM           E#PARM           E Error Inform CSW096
     C                     PARM           Z#PARM256        B User Defined CSW096
      *                                                                   CSW096
      * On return if errors copy into error array                         CSW096
      *                                                                   CSW096
     C                     MOVELO#ACLN    PMAWBA                          CSW096
      *                                                                   CSW096
     C           E#ERRM    IFNE *BLANKS                                   CSW096
      *                                                                   CSW096
     C           1         DO   E#INDX    Q#      50                      CSW096
     C                     MOVEAO#E,Q#    ERCD,S                          CSW096
     C                     ADD  1         S                               CSW096
     C                     ENDDO                                          CSW096
      *                                                                   CSW096
      * Mark pay side as ib error                                         CSW096
     C                     MOVEL*ON       *IN31                           CSW096
      *                                                                   CSW096
     C                     ENDIF                                          CSW096
      *                                                                   CSW096
     C                     ENDIF                                          CSW096
      *                                                                   CSW096
      ********************************************************************CSW096
      ***********                                                         CSW096
     C***********                                                   060036CSW096
     C***If*1st*& 3rd character are '/',                            060036CSW096
     C***then*2nd character must be 'C' or 'D'.                     060036CSW096
     C***********                                                   060036CSW096
     C***********PMXIB1    IFEQ '/'                        B*2      060036CSW096
     C***********PMXIBE    ANDEQ'/'                        **2      060036CSW096
     C***********PMXIB2    IFNE 'C'                        B**3     060036CSW096
     C***********PMXIB2    ANDNE'D'                        ***3     060036CSW096
     C***********          MOVE '203'     ERCD,S           ***3     060036CSW096
     C***********          ADD  1         S                ***3     060036CSW096
     C***********          MOVE '1'       *IN31            ***3     060036CSW096
     C***********          END                             E**3     060036CSW096
     C***********          END                             E*2      060036CSW096
     C***********                                                         CSW096
     C***IF*SECOND CHARACTER IS ALSO '/'                                  CSW096
     C***Must*be*followed by CP, CH, FW, BL, SC or SW.              CSW095CSW096
     C***MUST*BE*FOLLOWED*BY*CP,CH,FW,BL*OR*SC**********************CSW095CSW096
     C***********PMXIB1    IFEQ '/'                        B*2            CSW096
     C***********PMXIB2    ANDEQ'/'                        **2            CSW096
     C***********PMXIB4    IFNE '//CP'                     B**3           CSW096
     C***********PMXIB4    ANDNE'//CH'                     ***3           CSW096
     C***********PMXIB4    ANDNE'//FW'                     ***3           CSW096
     C***********PMXIB4    ANDNE'//BL'                     ***3           CSW096
     C***********PMXIB4    ANDNE'//SC'                     ***3           CSW096
     C***********PMXIB4    ANDNE'//SW'                     ***3     CSW095CSW096
     C***********          MOVE '975'     ERCD,S           ***3           CSW096
     C***********          ADD  1         S                ***3           CSW096
     C***********          MOVE '1'       *IN31                     LN0787CSW096
     C***********          END                             E**3           CSW096
     C***********          END                             E*2            CSW096
     C***********                                                         CSW096
     C***IF*FOLLOWED BY CP; CH; FW CURRENCY MUST BE USD                   CSW096
     C***IF*FOLLOWED BY BL CURRENCY MUST BE DEM                           CSW096
      ***IF*followed by SW currency must be CHF.                    CSW095CSW096
     C***********PMXIB4    IFEQ '//CP'                     B*2            CSW096
     C***********PMXIB4    OREQ '//CH'                     **2            CSW096
     C***********PMXIB4    OREQ '//FW'                     **2            CSW096
     C***********PMXIB4    OREQ '//SC'                     **2            CSW096
     C***********PMXIB4    OREQ '//BL'                     **2            CSW096
     C***********PMXIB4    OREQ '//SW'                     **2      CSW095CSW096
     C***********          MOVE PMPCCY    KEYY             **2            CSW096
     C***********          MOVE PMXIB4    KEYZ             **2            CSW096
     C***********          EXSR CHKCY                      **2            CSW096
     C***********RTCD      IFNE *BLANKS                    B*2            CSW096
     C***********          MOVE '976'     ERCD,S           ***3           CSW096
     C***********          ADD  1         S                ***3           CSW096
     C***********          MOVE '1'       *IN31                     LN0787CSW096
     C***********          GOTO EVAL13                     ***3           CSW096
     C***********          END                             E**3           CSW096
     C***********          END                             E*2            CSW096
     C***********                                                         CSW096
     C***IF*//CP*AND FOLLOWED BY BLANKS THEN DEFAULT THIS TO THE          CSW096
     C***CUSTOMERS CHIPS PARTICIPANT ONLY IF PMAWBN IS A CUSTOMER         CSW096
     C***********CPAWBN    IFEQ 'N'                        B*2            CSW096
     C***********PMXIB4    IFEQ '//CP'                     B**3           CSW096
     C***********PMXIB5    ANDEQ*BLANK                     ***3           CSW096
     C***********          Z-ADDBBCABA    PNXIB3           ***3     S01429CSW096
     C***********          Z-ADDBBABA2    PNXIB3           ***3     S01429CSW096
     C***********          MOVE PMXIBA    PMAWBA           ***3           CSW096
     C***********          END                             E**3           CSW096
     C***********          END                             E*2            CSW096
     C***********                                                         CSW096
     C***IF*//CP*IT*MUST*BE*FOLLOWED*BY*A*3*DIGIT*NUMBER.*THE*NUMBERS01429CSW096
     C***IF*//CP*IT MUST BE FOLLOWED BY A 4 DIGIT NUMBER. THE NUMBERS01429CSW096
     C***MUST*BE*FOLLOWED BY BLANKS.                                      CSW096
     C***********PMXIB4    IFEQ '//CP'                     B*2            CSW096
     C***********          TESTN          PMXIB3     60    **2            CSW096
     C************IN60     IFNE '1'                        NOT NUMERIC    CSW096
     C***********PMXIBX    ORNE *BLANKS                    NOT FOLL. BY BLCSW096
     C***********          MOVE '977'     ERCD,S           ***3           CSW096
     C***********          ADD  1         S                ***3           CSW096
     C***********          MOVE '1'       *IN31                     LN0787CSW096
     C***********          END                             E**3           CSW096
     C***********          END                             E*2            CSW096
     C***********                                                         CSW096
     C***IF*//FW*IT MUST BE FOLLOWED BY A 9 DIGIT NUMBER.IF A/C WITH      CSW096
     C***BANK*HAS A SWIFT ADDRESS //FW DOES NOT REQUIRE TO BE FOLLOWED    CSW096
     C***BY*A*NUMBER                                                      CSW096
     C***********PMXIB4    IFEQ '//FW'                     B*2            CSW096
     C***********          TESTN          PMXIB9     60    **2            CSW096
     C************IN60     IFNE '1'                        NOT NUMERIC    CSW096
     C***********PMXIBZ    ORNE *BLANKS                    NOT FOLL. BY BLCSW096
     C***********          MOVE '0'       *IN60            ***3           CSW096
     C***********          END                             E**3           CSW096
     C***********CPAWBN    IFEQ 'N'                        B**3           CSW096
     C***********                                                         CSW096
     C***********SWFT      ANDNE*BLANKS                    ***3           CSW096
     C***********PMXIB5    ANDEQ*BLANKS                    ***3           CSW096
     C***********          MOVE '1'       *IN60            ***3           CSW096
     C***********          END                             E**3           CSW096
     C***IF*SWIFT ADDRESS IS BLANK BUT THE FEDWIRE ACCOUNT NUMBER IS      CSW096
     C***PRESENT, SET UP THE FEDWIRE ACCOUNT                              CSW096
     C***********PMXIB5    IFEQ *BLANKS                    B**3           CSW096
     C***********SWFT      ANDEQ*BLANKS                    ***3           CSW096
     C***********FEDW      ANDNE*ZEROS                     ***3           CSW096
     C***********          Z-ADDFEDW      PMXIB7           ***3           CSW096
     C***********          END                             E**3           CSW096
     C***********SWFT      IFEQ *BLANKS                    B**3           CSW096
     C***********FEDW      ANDEQ*ZEROS                     ***3     S01117CSW096
     C***********PMXIB9    ANDEQ*BLANKS                    ***3     S01117CSW096
     C***********          MOVE '0'       *IN60            ***3     BHF647CSW096
     C***********          MOVE '1'       *IN60                     BHF647CSW096
     C***********          END                             E**3           CSW096
     C************IN60     IFNE '1'                        B**3           CSW096
     C***********          MOVE '977'     ERCD,S           ***3           CSW096
     C***********          ADD  1         S                ***3           CSW096
     C***********          MOVE '1'       *IN31                     LN0787CSW096
     C***********          END                             E**3           CSW096
     C***********          END                             E*2            CSW096
     C***********                                                         CSW096
     C***IF*//BL*AND FOLLOWED BY BLANKS THEN DEFAULT THIS TO THE          CSW096
     C***BANKLEITZAHL CODE ONLY IF PMAWBN IS A CUSTOMER                   CSW096
     C***********CPAWBN    IFEQ 'N'                        B*2            CSW096
     C***********PMXIB4    IFEQ '//BL'                     B**3           CSW096
     C***********PMXIB8    ANDEQ*BLANK                     ***3           CSW096
     C***********          MOVE BBBLCD    PMXIB8           ***3           CSW096
     C***********          MOVE PMXIBA    PMAWBA           ***3           CSW096
     C***********          END                             E**3           CSW096
     C***********          END                             E*2            CSW096
     C***********                                                         CSW096
     C***IF*//BL*IT MUST BE FOLLOWED BY A 8 DIGIT NUMBER.                 CSW096
     C***********PMXIB4    IFEQ '//BL'                     B*2            CSW096
     C***********          TESTN          PMXIB8     60    **2            CSW096
     C************IN60     IFNE '1'                        NOT NUMERIC    CSW096
     C***********PMXIBY    ORNE *BLANKS                    NOT FOLL. BY BLCSW096
     C***********          MOVE '977'     ERCD,S           ***3           CSW096
     C***********          ADD  1         S                ***3           CSW096
     C***********          MOVE '1'       *IN31                     LN0787CSW096
     C***********          END                             E**3           CSW096
     C***********          END                             E*2            CSW096
     C***********                                                         CSW096
     C***IF*//CH*AND FOLLOWED BY BLANKS THEN DEFAULT THIS TO THE          CSW096
     C***CUSTOMERS CHIPS UNIVERSAL ID. ONLY IF PMAWBN IS A CUSTOMER       CSW096
     C***********CPAWBN    IFEQ 'N'                        B*2            CSW096
     C***********PMXIB4    IFEQ '//CH'                     B**3           CSW096
     C***********PMXIB5    ANDEQ*BLANK                     ***3           CSW096
     C***********          Z-ADDBBCHID    PNXIB6           ***3           CSW096
     C***********          MOVE PMXIBA    PMAWBA           ***3           CSW096
     C***********          END                             E**3           CSW096
     C***********          END                             E*2            CSW096
     C***********                                                         CSW096
     C***IF*//SC*AND FOLLOWED BY BLANKS THEN DEFAULT THIS TO THE          CSW096
     C***CHAPS*SORT CODE ONLY IF PMAWBN IS A CUSTOMER                     CSW096
     C***********CPAWBN    IFEQ 'N'                        B*2            CSW096
     C***********PMXIB4    IFEQ '//SC'                     B**3           CSW096
     C***********PMXIB5    ANDEQ*BLANK                     ***3           CSW096
     C***********          Z-ADDBBCHSC    PNXIB6           ***3           CSW096
     C***********          MOVE PMXIBA    PMAWBA           ***3           CSW096
     C***********          END                             E**3           CSW096
     C***********          END                             E*2            CSW096
     C***********                                                         CSW096
     C***IF*//CH*OR //SC IT MUST BE FOLLOWED BY A 6 DIGIT NUMBER.         CSW096
      ***Also*check*//SW.************************************CSW095 094100CSW096
     C***********PMXIB4    IFEQ '//CH'                     B*2            CSW096
     C***********PMXIB4    OREQ '//SC'                     **2            CSW096
     C***********PMXIB4    OREQ '//SW'                     **CSW095 094100CSW096
     C***********          TESTN          PMXIB6     60    **2            CSW096
     C************IN60     IFNE '1'                        NOT NUMERIC    CSW096
     C***********PMXIBW    ORNE *BLANKS                    NOT FOLL. BY BLCSW096
     C***********          MOVE '977'     ERCD,S           ***3           CSW096
     C***********          ADD  1         S                ***3           CSW096
     C***********          MOVE '1'       *IN31                     LN0787CSW096
     C***********          END                             E**3           CSW096
     C***********          END                             E*2            CSW096
      ***********                                                   094100CSW096
      ***If*//SW*must be followed by a 5-digit number.              094100CSW096
     C***********PMXIB4    IFEQ '//SW'                     B*2      094100CSW096
     C***********          TESTN          PMXSW5     60    **2      094100CSW096
     C************IN60     IFNE '1'                        not nume 094100CSW096
     C***********PMXSWW    ORNE *BLANKS                    not folll094100CSW096
     C***********          MOVE '977'     ERCD,S           ***3     094100CSW096
     C***********          ADD  1         S                ***3     094100CSW096
     C***********          MOVE '1'       *IN31                     094100CSW096
     C***********          ENDIF                           E**3     094100CSW096
     C***********          ENDIF                           E*2      094100CSW096
     C***********          END                             E1             CSW096
     C           EVAL13    TAG
     C*
     C** BENEFICIARY
     C** -----------
     C                     MOVE 'Y'       CPBENN  1
     C                     MOVE *BLANKS   PABENN
     C           *IN49     CABEQ'1'       EVAL14           ERROR ON FIELD
     C/COPY WNCPYSRC,SD2410C060
     C*
     C** MUST BE A 6 DIGIT NUMBER
     C** OR A CUSTOMER SHORTNAME THAT IDENTIFIES A LIVE
     C** RECORD ON FILE SDCUSTPD OR A COUNTERPARTY NOSTRO CODE THAT
     C** IDENTIFIES A LIVE RECORD ON SDCNSTPD
     C                     MOVE 'N'       BENBNK  1
     C/COPY WNCPYSRC,SD2410C053
     C********** PMPSTM    IFEQ 01                         B1             BHF582
     C********** PMPSTM    OREQ 07                         *1             BHF582
     C********** PMPSTM    IFEQ 07                         *1       BHF582BHF595
     C*                                                                   BHF595
     C** IF SETTLEMENT TYPE 01 OR 07 VALIDATE BENEFICIARY IF              BHF595
     C** PRESENT.HOWEVER BENEFICIARY IS MANDATORY FOR TYPE 08             BHF595
     C** BENEFICIARY IS MANDATORY FOR 07 ALSO.
     C*                                                                   BHF595
     C           PMPSTM    IFEQ 01                                        BHF595
     C           PMBENN    ANDNE*BLANK                                    BHF595
     C           PMPSTM    OREQ 07                                        BHF595
     C********** PMBENN    ANDNE*BLANK                              BHF595BHF759
     C           PMPSTM    OREQ 08                         *1
     C           CLE033    OREQ 'Y'                                       CLE033
     C           PMPSTM    ANDEQ09                                        CLE033
     C           PMBENN    ANDNE*BLANK                                    CLE033
     C/COPY WNCPYSRC,SD2410C080
     C********** PMBENN    ANDNE*BLANK                              BHF582BHF595
     C                     MOVE *BLANK    BEPHON 12        *1
     C                     MOVE *BLANK    BETELX 12        *1
     C                     MOVE *BLANKS   CHKFLD           *1             S01117
     C                     MOVE PMBENN    CHKFLD           *1
     C                     MOVE 'Y'       @CPNA            *1             S01117
     C           PMPSTM    IFEQ 07                         B*2            BHF810
     C***********PMPSTM    OREQ 08                         **2      BHF810E26771
     C                     MOVE 'N'       @CPNA            **2            BHF810
     C                     END                             E*2            BHF810
     C                     EXSR CHKFL                      *1
     C*                                                                   S01117
     C           RTCD      IFEQ '*NOSEL '                  B*2            S01117
     C                     MOVE '877'     ERCD,S           **2            S01117
     C                     ADD  1         S                **2            S01117
     C                     MOVE '1'       *IN31                           LN0787
     C                     END                             E*2            S01117
     C*                                                                   S01117
     C           RESULT    IFEQ 'E'                        B*2
     C********** PMRSTM    ANDNE01                                  BHF582LN0783
     C                     MOVE '978'     ERCD,S           **2
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN31                           LN0787
     C                     ELSE                            X*2
     C                     MOVELPMBENN    @TSTQ            **2            S01117
     C           RESULT    IFEQ 'A'                        B**3
     C           RESULT    OREQ 'B'                        ***3
     C                     MOVELBBCUST    PABENN           ***3
     C*                                                                   S01117
     C**   CHECK IF '?' ENTERED, IF SO MOVE VALUE RETRIEVED               S01117
     C**   INTO SCREEN FIELD.                                             S01117
     C*                                                                   S01117
     C           @TSTQ     IFEQ '?'                        B****5         S01117
     C                     MOVELBBCSSN    PMBENN           *****5         S01117
     C                     END                             E****5         S01117
     C           BANKNB    IFEQ 'B'                        B***4
     C                     MOVE 'Y'       BENBNK           ****4
     C                     END                             E***4
     C                     MOVE BBCTNB    BEPHON           ***3
     C*********************MOVE BBTXA1    BETELX           ***3           S01117
     C                     MOVELBBTXA1    BETELX           ***3           S01117
     C                     MOVE 'N'       CPBENN           ***3
     C                     ELSE                            X**3
     C                     MOVE *BLANKS   PABENN           ***3           S01117
     C                     MOVELAWCPNC    PABENN           ***3
     C*                                                                   S01117
     C**   CHECK IF '?' ENTERED, IF SO MOVE VALUE RETRIEVED               S01117
     C**   INTO SCREEN FIELD.                                             S01117
     C*                                                                   S01117
     C           @TSTQ     IFEQ '?'                        B***4          S01117
     C                     MOVE *BLANKS   PMBENN           ****4          S01117
     C                     MOVELAWCPNC    PMBENN           ****4
     C                     END                             E***4          S01117
     C                     END                             E**3
     C/COPY WNCPYSRC,SD2410C078
     C                     END                             E*2
     C                     END                             E1
     C** MANDATORY ENTRY OF ORDERING CUST. IF BENEFICIARY IS A NON-BANK
     C********** PMPOCN    IFEQ *BLANKS                    B1             BHF595
     C********** PMBENN    ANDNE*BLANKS                    *1             BHF595
     C********** BENBNK    ANDEQ'N'                        *1             BHF595
     C********** PMPSTM    IFEQ 01                         B*2            BHF595
     C********** PMPSTM    OREQ 07                         **2            BHF595
     C********** PMPSTM    OREQ 08                         **2            BHF595
     C           PMPOCN    IFEQ *BLANKS                    B1             BHF595
     C           PMBENN    ANDNE*BLANKS                                   BHF595
     C           PMPSTM    IFEQ 08                                        BHF595
     C           BENBNK    IFEQ 'N'                                       BHF595
     C********** CPBNBI    OREQ 'N'                                 BHF595LN0765
     C***********CPBNBI    OREQ 'N'                                LN0787 142408
     C                     MOVE '945'     ERCD,S           **2
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN31                           LN0787
     C                     END                             E*2
     C                     END                             E1
     C                     END                                            BHF595
     C***FOR*SETTL.*TYPE*01,07*OR*08*ORDERING*BANK*OR*ORDERING*CUSTOMER***E21860
     C***MUST*BE*ENTERED***                                               E21860
     C***********PMPSTM****IFEQ 01                         B1             E21860
     C***********PMPSTM****OREQ 07                         *1             E21860
     C***********PMPSTM****OREQ 08                         *1             E21860
     C***********PMPOBN****IFEQ *BLANKS                    B*2            E21860
     C***********PMPOCN****ANDEQ*BLANKS                    **2            E21860
     C*********************MOVE '950'     ERCD,S           **2            E21860
     C*********************ADD  1         S                **2            E21860
     C*********************END                             E*2            E21860
     C*********************END                             E1             E21860
     C*
     C** IF BENEFICIARY IS A BANK MAY NOT ENTER BOTH ORDERING
     C** CUSTOMER AND ORDERING BANK
     C           BENBNK    IFEQ 'Y'                        B1
     C           PMPOBN    IFNE *BLANKS                    B*2
     C           PMPOCN    ANDNE*BLANKS                    **2
     C                     MOVE '951'     ERCD,S           **2
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN31                           LN0787
     C                     END                             E*2
     C                     END                             E1
     C*
     C**IF*RECIPIENT*OF*MT100*ENTERED*BENEFICIARY*MUST*NOT*BE*A*BANK      E22405
     C***********PMRVNO    IFNE *BLANKS                    B*2            E22405
     C***********BENBNK    ANDEQ'Y'                        B1             E22405
     C*********************MOVE '955'     ERCD,S           **2            E22405
     C*********************ADD  1         S                **2            E22405
     C*********************END                             E*2            E22405
     C/COPY WNCPYSRC,SD2410C016
     C           EVAL14    TAG
     C*
     C           EVAL5     TAG
     C*
     C** BENEFICIARY A/C WITH LINE
     C** --------------------------
     C           *IN50     CABEQ'1'       EVAL15           ERROR ON FIELD
     C/COPY WNCPYSRC,SD2410C061
     C*
     C           PMBENA    IFNE *BLANK                     B1
     C                     MOVE PMBENA    PMXIBA           *1
     C*
     C** ENTRY IS ONLY ALLOWED IF ENTRY HAS BEEN MADE IN BENEFICIARY
     C           PMBENN    IFEQ *BLANK                     B*2
     C                     MOVE '999'     ERCD,S           **2
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN31                           LN0787
     C                     GOTO EVAL15                     **2
     C                     END                             E*2
     C/COPY WNCPYSRC,SD2410C017
      *****************************************************************   CSW096
      *                                                                   CSW096
      * Call Account Line Validation object                               CSW096
      *                                                                   CSW096
      * Set up parameters                                                 CSW096
      *                                                                   CSW096
     C                     MOVEL*BLANKS   W0RTN                           CSW096
     C                     CLEARI#PARM                                    CSW096
     C                     MOVEL'BENF '   I#VFLD                          CSW096
     C                     MOVEL'PAY'     I#PR                            CSW096
     C                     MOVEL'X'       I#PRTT                          CSW096
     C                     MOVELPMBENN    I#PRTY                          CSW096
     C***********          MOVELPMPCCY    I#PCCY                   CSW096 CEU003
     C***********          MOVELPMRCCY    I#RCCY                   CSW096 CEU003
     C                     MOVELWPECY     I#PCCY                          CEU003
     C                     MOVELWRECY     I#RCCY                          CEU003
     C                     MOVELPMBENA    I#ACLN                          CSW096
     C                     MOVELPMPSTM    I#PSTM                          CSW096
     C                     MOVELPMRSTM    I#RSTM                          CSW096
     C           PMPOCN    IFNE *BLANKS                                   CSW096
      *                                                                                       CSW203
      ** Set I#MTYP to "103" instead of "100" if CSW203 is installed                          CSW203
      *                                                                                       CSW203
     C           CSW203    IFEQ 'Y'                                                           CSW203
     C                     MOVEL'103'     I#MTYP                                              CSW203
     C                     ELSE                                                               CSW203
     C                     MOVEL'100'     I#MTYP                          CSW096
     C                     ENDIF                                                              CSW203
     C                     ELSE                                           CSW096
     C                     MOVEL'202'     I#MTYP                          CSW096
     C                     ENDIF                                          CSW096
      * Set up receive account information                                CSW096
     C           PMRONS    IFNE *BLANKS                                   CSW096
     C                     SELEC                                          CSW096
     C           PMROBR    WHNE *BLANKS                                   CSW096
     C           PMRONS    CAT  PMROBR    I#RCAC                          CSW096
     C           PMRONS    WHNE *BLANKS                                   CSW096
     C                     MOVELPMRONS    I#RCAC                          CSW096
     C                     ENDSL                                          CSW096
     C                     ENDIF                                          CSW096
      * Set up Pay account information                                    CSW096
     C           PMPONS    IFNE *BLANKS                                   CSW096
     C                     SELEC                                          CSW096
     C           PMPOBR    WHNE *BLANKS                                   CSW096
     C           PMPONS    CAT  PMPOBR    I#PYAC                          CSW096
     C           PMPONS    WHNE *BLANKS                                   CSW096
     C                     MOVELPMPONS    I#PYAC                          CSW096
     C                     ENDSL                                          CSW096
     C                     ENDIF                                          CSW096
      * If extra message and Rec Corr. then set 5354 field                CSW096
     C           PMRVNO    IFNE *BLANKS                                   CSW096
     C           PMRCRN    ANDNE*BLANKS                                   CSW096
     C                     MOVEL'Y'       I#5354                          CSW096
     C                     ENDIF                                          CSW096
      * Transaction Type                                                  CSW096
     C                     MOVELPMTTYP    I#TTYP                          CSW096
      *                                                                   CSW096
     C                     CLEARO#PARM                                    CSW096
     C                     CLEARE#PARM                                    CSW096
      *                                                                   CSW096
      * Send messages to correct calling process                          CSW096
      *                                                                   CSW096
     C                     SELEC                                          CSW096
     C           PMCPGM    WHEQ 'FXFX'                                    CSW096
     C                     MOVEL'ME9940'  E#CPGM                          CSW096
     C                     MOVEL'DL'      I#MMOD                          CSW096
     C           PMCPGM    WHEQ 'MMLD'                                    CSW096
     C                     MOVEL'ME9940'  E#CPGM                          CSW096
     C                     MOVEL'LE'      I#MMOD                          CSW096
     C           PMCPGM    WHEQ 'SSI '                                    CSW096
     C                     MOVEL'SD0401R' E#CPGM                          CSW096
     C                     OTHER                                          CSW096
     C                     MOVEL'ME9940'  E#CPGM                          CSW096
     C                     ENDSL                                          CSW096
     C                     MOVEL'MEC0018' E#MSGD                          CSW096
     C                     MOVEL'MEMSG'   E#MSGF                          CSW096
      *                                                                   CSW096
     C                     CALL 'ME9940'                                  CSW096
     C                     PARM           W0RTN   7                       CSW096
     C                     PARM           I#PARM           I Input Parms  CSW096
     C                     PARM           O#PARM           O Output Parms CSW096
     C                     PARM           E#PARM           E Error Inform CSW096
     C                     PARM           Z#PARM256        B User Defined CSW096
      *                                                                   CSW096
      * On return if errors copy into error array                         CSW096
      *                                                                   CSW096
     C                     MOVELO#ACLN    PMBENA                          CSW096
      *                                                                   CSW096
     C           E#ERRM    IFNE *BLANKS                                   CSW096
      *                                                                   CSW096
     C           1         DO   E#INDX    Q#      50                      CSW096
     C                     MOVEAO#E,Q#    ERCD,S                          CSW096
     C                     ADD  1         S                               CSW096
     C                     ENDDO                                          CSW096
      *                                                                   CSW096
      * Mark pay side as ib error                                         CSW096
     C                     MOVEL*ON       *IN31                           CSW096
      *                                                                   CSW096
     C                     ENDIF                                          CSW096
      *                                                                   CSW096
     C                     ENDIF                                          CSW096
      *                                                                   CSW096
      ********************************************************************CSW096
      ***********                                                         CSW096
     C***********                                                         CSW096
     C***FIRST*CHARACTER MUST BE '/'                                      CSW096
     C***********PMXIB1    IFNE '/'                        B*2            CSW096
     C***********          MOVE '981'     ERCD,S           **2            CSW096
     C***********          ADD  1         S                **2            CSW096
     C***********          MOVE '1'       *IN31                     LN0787CSW096
     C***********          GOTO EVAL15                     **2            CSW096
     C***********          END                             E*2            CSW096
     C***********                                                   060036CSW096
     C***If*1st*& 3rd character are '/',                            060036CSW096
     C***then*2nd character must be 'C' or 'D'.                     060036CSW096
     C***********                                                   060036CSW096
     C***********PMXIB1    IFEQ '/'                        B*2      060036CSW096
     C***********PMXIBE    ANDEQ'/'                        **2      060036CSW096
     C***********PMXIB2    IFNE 'C'                        B**3     060036CSW096
     C***********PMXIB2    ANDNE'D'                        ***3     060036CSW096
     C***********          MOVE '204'     ERCD,S           ***3     060036CSW096
     C***********          ADD  1         S                ***3     060036CSW096
     C***********          MOVE '1'       *IN31            ***3     060036CSW096
     C***********          END                             E**3     060036CSW096
     C***********          END                             E*2      060036CSW096
     C***********                                                         CSW096
     C***IF*SECOND CHARACTER IS ALSO '/'                                  CSW096
     C***Must*be*followed by CP, CH, FW, BL, SC or SW.              CSW095CSW096
     C***MUST*BE*FOLLOWED*BY*CP,CH,FW,BL*OR*SC**********************CSW095CSW096
     C***ENTRY*OF '//' ONLY ALLOWED WHEN BENEFICIARY IS A BANK            CSW096
     C***********PMXIB2    IFEQ '/'                        B*2            CSW096
     C***********BANKNB    IFNE 'B'                        B**3           CSW096
     C***********          MOVE '982'     ERCD,S           ***3           CSW096
     C***********          ADD  1         S                ***3           CSW096
     C***********          MOVE '1'       *IN31                     LN0787CSW096
     C***********          GOTO EVAL15                     ***3           CSW096
     C***********          ELSE                            X**3           CSW096
     C***********PMXIB4    IFNE '//CP'                     B***4          CSW096
     C***********PMXIB4    ANDNE'//CH'                     ****4          CSW096
     C***********PMXIB4    ANDNE'//FW'                     ****4          CSW096
     C***********PMXIB4    ANDNE'//BL'                     ****4          CSW096
     C***********PMXIB4    ANDNE'//SC'                     ****4          CSW096
     C***********PMXIB4    ANDNE'//SW'                     ****4    CSW095CSW096
     C***********          MOVE '983'     ERCD,S           ****4          CSW096
     C***********          ADD  1         S                ****4          CSW096
     C***********          MOVE '1'       *IN31                     LN0787CSW096
     C***********          END                             E***4          CSW096
     C***********          END                             E**3           CSW096
     C***********                                                         CSW096
     C***IF*FOLLOWED BY CP; CH; FW OR SC CURRENCY MUST BE USD             CSW096
     C***IF*FOLLOWED BY BL CURRENCY MUST BE DEM                           CSW096
      ***If*followed by SW currency must be CHF.                    CSW095CSW096
     C***********PMXIB4    IFEQ '//CP'                     B**3           CSW096
     C***********PMXIB4    OREQ '//CH'                     ***3           CSW096
     C***********PMXIB4    OREQ '//FW'                     ***3           CSW096
     C***********PMXIB4    OREQ '//SC'                     ***3           CSW096
     C***********PMXIB4    OREQ '//BL'                     ***3           CSW096
     C***********PMXIB4    OREQ '//SW'                     ***3     CSW095CSW096
     C***********          MOVE PMPCCY    KEYY             ***3           CSW096
     C***********          MOVE PMXIB4    KEYZ             ***3           CSW096
     C***********          EXSR CHKCY                      ***3           CSW096
     C***********RTCD      IFNE *BLANKS                    B*2            CSW096
     C***********          MOVE '984'     ERCD,S           ****4          CSW096
     C***********          ADD  1         S                ****4          CSW096
     C***********          MOVE '1'       *IN31                     LN0787CSW096
     C***********          GOTO EVAL15                     ****4          CSW096
     C***********          END                             E***4          CSW096
     C***********          END                             E**3           CSW096
     C***********                                                         CSW096
     C***IF*//CP*AND FOLLOWED BY BLANKS THEN DEFAULT THIS TO THE          CSW096
     C***CUSTOMERS CHIPS PARTICIPANT ONLY IF PMBENN IS A CUSTOMER         CSW096
     C***********CPBENN    IFEQ 'N'                        B**3           CSW096
     C***********PMXIB4    IFEQ '//CP'                     B***4          CSW096
     C***********PMXIB5    ANDEQ*BLANK                     ****4          CSW096
     C***********          Z-ADDBBCABA    PNXIB3           ****4    S01429CSW096
     C***********          Z-ADDBBABA2    PNXIB3           ****4    S01429CSW096
     C***********          MOVE PMXIBA    PMBENA           ****4          CSW096
     C***********          END                             E***4          CSW096
     C***********          END                             E**3           CSW096
     C***********                                                         CSW096
     C***IF*//CP*IT*MUST*BE*FOLLOWED*BY*A*3*DIGIT*NUMBER.*THE*NUMBERS01429CSW096
     C***IF*//CP*IT MUST BE FOLLOWED BY A 4 DIGIT NUMBER. THE NUMBERS01429CSW096
     C***MUST*BE*FOLLOWED BY BLANKS.                                      CSW096
     C***********PMXIB4    IFEQ '//CP'                     B**3           CSW096
     C***********          TESTN          PMXIB3     60    ***3           CSW096
     C************IN60     IFNE '1'                        NOT NUMERIC    CSW096
     C***********PMXIBX    ORNE *BLANKS                    NOT FOLL. BY BLCSW096
     C***********          MOVE '985'     ERCD,S           ****4          CSW096
     C***********          ADD  1         S                ****4          CSW096
     C***********          MOVE '1'       *IN31                     LN0787CSW096
     C***********          END                             E***4          CSW096
     C***********          END                             E**3           CSW096
     C***********                                                         CSW096
     C***IF*//FW*IT MUST BE FOLLOWED BY A 9 DIGIT NUMBER.IF BENEFICIARY   CSW096
     C***HAS*A*SWIFT ADDRESS //FW DOES NOT REQUIRE TO BE FOLLOWED BY      CSW096
     C***A*NUMBER                                                         CSW096
     C***********PMXIB4    IFEQ '//FW'                     B**3           CSW096
     C***********          TESTN          PMXIB9     60    ***3           CSW096
     C************IN60     IFNE '1'                        NOT NUMERIC    CSW096
     C***********PMXIBZ    ORNE *BLANKS                    NOT FOLL. BY BLCSW096
     C***********          MOVE '0'       *IN60            ****4          CSW096
     C***********          END                             E***4          CSW096
     C***********CPBENN    IFEQ 'N'                        B***4          CSW096
     C***********SWFT      ANDNE*BLANKS                    ****4          CSW096
     C***********PMXIB5    ANDEQ*BLANKS                    ****4          CSW096
     C***********          MOVE '1'       *IN60            ****4          CSW096
     C***********          END                             E***4          CSW096
     C***IF*SWIFT ADDRESS IS BLANK BUT THE FEDWIRE ACCOUNT NUMBER IS      CSW096
     C***PRESENT, SET UP THE FEDWIRE ACCOUNT                              CSW096
     C***********PMXIB5    IFEQ *BLANKS                    B**3           CSW096
     C***********SWFT      ANDEQ*BLANKS                    ***3           CSW096
     C***********FEDW      ANDNE*ZEROS                     ***3           CSW096
     C***********          Z-ADDFEDW      PMXIB7           ***3           CSW096
     C***********          END                             E**3           CSW096
     C***********SWFT      IFEQ *BLANKS                    B**3           CSW096
     C***********FEDW      ANDEQ*ZEROS                     ***3     S01117CSW096
     C***********PMXIB9    ANDEQ*BLANKS                    ***3     S01117CSW096
     C***********          MOVE '0'       *IN60            ***3           CSW096
     C***********          END                             E**3           CSW096
     C************IN60     IFNE '1'                        B***4          CSW096
     C***********          MOVE '985'     ERCD,S           ****4          CSW096
     C***********          ADD  1         S                ****4          CSW096
     C***********          MOVE '1'       *IN31                     LN0787CSW096
     C***********          END                             E***4          CSW096
     C***********          END                             E**3           CSW096
     C***********                                                         CSW096
     C***IF*//BL*AND FOLLOWED BY BLANKS THEN DEFAULT THIS TO THE          CSW096
     C***BANKLEITZAHL CODE ONLY IF PMBENN IS A CUSTOMER                   CSW096
     C***********CPBENN    IFEQ 'N'                        B**3           CSW096
     C***********PMXIB4    IFEQ '//BL'                     B***4          CSW096
     C***********PMXIB8    ANDEQ*BLANK                     ****4          CSW096
     C***********          MOVE BBBLCD    PMXIB8           ****4          CSW096
     C***********          MOVE PMXIBA    PMBENA           ****4          CSW096
     C***********          END                             E***4          CSW096
     C***********          END                             E**3           CSW096
     C***********                                                         CSW096
     C***IF*//BL*IT MUST BE FOLLOWED BY A 8 DIGIT NUMBER.                 CSW096
     C***********PMXIB4    IFEQ '//BL'                     B**3           CSW096
     C***********          TESTN          PMXIB8     60    ***3           CSW096
     C************IN60     IFNE '1'                        NOT NUMERIC    CSW096
     C***********PMXIBY    ORNE *BLANKS                    NOT FOLL. BY BLCSW096
     C***********          MOVE '985'     ERCD,S           ****4          CSW096
     C***********          ADD  1         S                ****4          CSW096
     C***********          MOVE '1'       *IN31                     LN0787CSW096
     C***********          END                             E***4          CSW096
     C***********          END                             E**3           CSW096
     C***********                                                         CSW096
     C***IF*//CH*AND FOLLOWED BY BLANKS THEN DEFAULT THIS TO THE          CSW096
     C***CUSTOMERS CHIPS UNIVERSAL ID. ONLY IF PMBENN IS A CUSTOMER       CSW096
     C***********CPBENN    IFEQ 'N'                        B**3           CSW096
     C***********PMXIB4    IFEQ '//CH'                     B***4          CSW096
     C***********PMXIB5    ANDEQ*BLANK                     ****4          CSW096
     C***********          Z-ADDBBCHID    PNXIB6           ****4          CSW096
     C***********          MOVE PMXIBA    PMBENA           ****4          CSW096
     C***********          END                             E***4          CSW096
     C***********          END                             E**3           CSW096
     C***********                                                         CSW096
     C***IF*//SC*AND FOLLOWED BY BLANKS THEN DEFAULT THIS TO THE          CSW096
     C***CHAPS*SORT CODE ONLY IF PMBENN IS A CUSTOMER                     CSW096
     C***********CPBENN    IFEQ 'N'                        B**3           CSW096
     C***********PMXIB4    IFEQ '//SC'                     B***4          CSW096
     C***********PMXIB5    ANDEQ*BLANK                     ****4          CSW096
     C***********          Z-ADDBBCHSC    PNXIB6           ****4          CSW096
     C***********          MOVE PMXIBA    PMBENA           ****4          CSW096
     C***********          END                             E***4          CSW096
     C***********          END                             E**3           CSW096
     C***********                                                         CSW096
     C***IF*//CH*OR //SC IT MUST BE FOLLOWED BY A 6 DIGIT NUMBER.         CSW096
      ***Also*check*//SW.************************************CSW095 094100CSW096
     C***********PMXIB4    IFEQ '//CH'                     B**3           CSW096
     C***********PMXIB4    OREQ '//SC'                     ***3           CSW096
     C***********PMXIB4    OREQ '//SW'                     **CSW095 094100CSW096
     C***********          TESTN          PMXIB6     60    ***3           CSW096
     C************IN60     IFNE '1'                        NOT NUMERIC    CSW096
     C***********PMXIBW    ORNE *BLANKS                    NOT FOLL. BY BLCSW096
     C***********          MOVE '985'     ERCD,S           ****4          CSW096
     C***********          ADD  1         S                ****4          CSW096
     C***********          MOVE '1'       *IN31                     LN0787CSW096
     C***********          END                             E***4          CSW096
     C***********          END                             E**3           CSW096
      ***********                                                   094100CSW096
      ***If*//SW*must be followed by a 5-digit number.              094100CSW096
     C***********PMXIB4    IFEQ '//SW'                     B*2      094100CSW096
     C***********          TESTN          PMXSW5     60    **2      094100CSW096
     C************IN60     IFNE '1'                        not numer094100CSW096
     C***********PMXSWW    ORNE *BLANKS                    not foll.094100CSW096
     C***********          MOVE '985'     ERCD,S           ***3     094100CSW096
     C***********          ADD  1         S                ***3     094100CSW096
     C***********          MOVE '1'       *IN31                     094100CSW096
     C***********          ENDIF                           E**3     094100CSW096
     C***********          ENDIF                           E*2      094100CSW096
     C***********          END                             E*2            CSW096
     C***********          END                             E1             CSW096
     C*
     C** VALIDATE INPUTFIELDS IN RELATION WITH OTHER FIELDS
     C*
     C***ERROR*IF*THE*BENEFICIARY*IS*NOT*A*BANK*AND*THE*INTERMEDIARY      S01412
     C***BANK*DOES*NOT*HAVE*A*SWIFT*ADDRESS*************************      S01412
     C***********PMPIBN    IFNE *BLANKS                    B1             S01412
     C********** *IN51     IFEQ '1'                        B*2            S01412
     C********** PMBENN    ANDNE*BLANKS                    **2            S01412
     C********** BENBNK    ANDEQ'N'                        **2            S01412
     C**********           MOVE '898'     ERCD,S           **2            S01412
     C**********           ADD  1         S                **2            S01412
     C**********           MOVE '1'       *IN31                     LN0787S01412
     C**********           END                             E*2            S01412
     C**********           END                             E1             S01412
     C*
     C***ENTRY*IN*RECEIVER'S*CORRESPONDANT*ONLY*ALLOWED*IF*****           S01117
     C***BENEFICIARY*IS*A*NON-BANK*AND*'RECIPIENT*OF*MT100'*IS*           S01117
     C***IS*ENTERED********************************************           S01117
     C***********PMRVNO    IFNE *BLANKS                    B1             S01117
     C***********PMRCRN    ANDNE*BLANK                     *1             S01117
     C***********BENBNK    ANDNE'N'                        B1             S01117
     C*                                                                   S01117
     C***ENTRY*IN*RECIPIENT'S*CORRESPONDENT*IS*ONLY*ALLOWED*IF*********   S01117
     C***MT100*IS*ENTERED*AND*BENEFICIARY*IS*NOT*A*BANK.***************   S01117
     C********** PMRCRN    IFNE *BLANKS                    B1             S01117
     C********** PMRVNO    IFEQ *BLANK                     B*2            S01117
     C********** BENBNK    OREQ 'Y'                        **2            S01117
     C**********           MOVE '956'     ERCD,S           **2            S01117
     C**********           ADD  1         S                **2            S01117
     C**********           END                             E*2            S01117
     C**********           END                             E1
     C*
     C/COPY WNCPYSRC,SD2410C039
     C** RECEIVER
     C           PARVNO    IFNE *BLANK                     B1
     C           PARVNO    IFEQ A8BICN                     B*2
     C           PARVNO    OREQ PNOST                      **2
     C           PARVNO    OREQ PARCRN                     **2
     C           PARVNO    OREQ PAPIBN                     **2            S01117
     C           PARVNO    OREQ PAAWBN                     **2
     C/COPY WNCPYSRC,SD2410C055
     C                     MOVE '954'     ERCD,S           **2
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN31                           LN0787
     C/COPY WNCPYSRC,SD2410C056
     C                     END                             E*2
     C                     END                             E1
     C** RECEIVER'S CORRESPONDANT
     C           PARCRN    IFNE *BLANK                     B1
     C           PARCRN    IFEQ A8BICN                     B*2
     C           PARCRN    OREQ PNOST                      **2            S01117
     C           PARCRN    OREQ PARVNO                     **2            S01117
     C           PARCRN    OREQ PAPIBN                     **2            S01117
     C/COPY WNCPYSRC,SD2410C040
     C           PARCRN    OREQ PAAWBN                     **2
     C/COPY WNCPYSRC,SD2410C041
     C                     MOVE '959'     ERCD,S           **2
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN31                           LN0787
     C                     END                             E*2
     C                     END                             E1
     C** INTERMEDIARY BANK
     C           PAPIBN    IFNE *BLANK                     B1
     C           PAPIBN    IFEQ A8BICN                     **2
     C***********PAPIBN    OREQ PNOST                      B*2            056873
     C           PAPIBN    OREQ PARVNO                     **2
     C           PAPIBN    OREQ PARCRN                     **2            S01117
     C/COPY WNCPYSRC,SD2410C042
     C***********PAPIBN    OREQ PAAWBN                     **2            E31261
     C           PAPIBN    OREQ PABENN                     **2
     C                     MOVE '964'     ERCD,S           **2
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN31                           LN0787
     C                     END                             E*2
     C*                                                                   082386
     C** IF Account With Bank not entered, Intermediary Bank should       082386
     C** also be blank                                                    082386
     C           PAAWBN    IFEQ *BLANK                     B*2            082386
     C                     MOVE '979'     ERCD,S           **2            082386
     C                     ADD  1         S                **2            082386
     C                     MOVE '1'       *IN31                           082386
     C                     END                             E*2            082386
     C                     END                             E1
     C** ACCOUNT WITH BANK
     C           PAAWBN    IFNE *BLANK                     B1
     C           PAAWBN    IFEQ A8BICN                     **2
     C*                                                                   DT0069
     C** Account With Bank can now be the same as Payment Nostro.         DT0069
     C***********PAAWBN****OREQ PNOST                      B*2            DT0069
     C           PAAWBN    OREQ PARVNO                     **2
     C           PAAWBN    OREQ PARCRN                     **2
     C/COPY WNCPYSRC,SD2410C043
     C***********PAAWBN    OREQ PAPIBN                     **2            E31261
     C********** PAAWBN    OREQ PABENN                     **2            LN0749
     C***********PAAWBN    OREQ PABENN                     **2      070083110514
     C                     MOVE '972'     ERCD,S           **2
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN31                           LN0787
     C/COPY WNCPYSRC,SD2410C057
     C                     END                             E*2
     C                     END                             E1
     C** BENEFICIARY
     C           PABENN    IFNE *BLANK                     B1
     C           PABENN    IFEQ PAPIBN                     B*2
     C********** PABENN    OREQ PAAWBN                     **2            LN0749
     C***********PABENN    OREQ PAAWBN                     **2      070083110514
     C                     MOVE '980'     ERCD,S           **2
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN31                           LN0787
     C                     END                             E*2
     C                     END                             E1
     C           EVAL15    TAG
     C*
     C** DETAILS OF PAYMENT
     C** ------------------
     C/COPY WNCPYSRC,SD2410C018
     C*
     C** MUST BE BLANK IF BENEFICIARY IS A BANK
     C           BENBNK    IFEQ 'Y'                        B1
     C           PMDTP1    IFNE *BLANK                     B*2
     C/COPY WNCPYSRC,SD2410C088
     C           PMDTP2    ORNE *BLANK                     **2
     C/COPY WNCPYSRC,SD2410C089
     C           PMDTP3    ORNE *BLANK                     **2
     C           PMDTP4    ORNE *BLANK                     **2
     C                     MOVE '987'     ERCD,S           **2
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN31                           LN0787
     C                     END                             E*2
     C                     END                             E1
     C*
     C** DETAILS OF CHARGES
     C** ------------------
     C/COPY WNCPYSRC,SD2410C019
      *                                                                                       219241
      ** Field 71, Details of Charges.  If STP PHASE 2 MT103 FOR                              219241
      ** NON-FUNDS TRANSFER is installed, Pay Settlement Method                               219241
      ** = 01, 07 or 08, and either Pay-Ordering Customer or                                  219241
      ** Beneficiary is a non-SWIFT FINANCIAL INSTITUTION default                             219241
      ** this field to "Default MT103 Details of Charges" field                               219241
      ** from Message Management ICD.                                                         219241
      *                                                                                       219241
     C           CFT013    IFEQ 'Y'                                                           219241
     C           PMDCHG    ANDEQ*BLANK                                                        219241
     C           PMPSTM    IFEQ 08                                                            219241
     C           PMPSTM    OREQ 07                                                            219241
     C           PMPSTM    OREQ 01                                                            219241
     C           CPPOCN    IFNE 'B'                                                           219241
     C           PAROBN    ANDEQ*BLANK                                                        246415
     C           BENBNK    ORNE 'Y'                                                           219241
     C                     MOVE ENDCHG    PMDCHG                                              219241
     C                     ENDIF                                                              219241
     C                     ENDIF                                                              219241
     C                     ENDIF                                                              219241
      *                                                                                       219241
     C*
     C** MUST BE BLANK IF NO MT100 MESSAGE IS TO BE PRODUCED
     C           PMDCHG    IFNE *BLANK                     B1
      ** Cater for blank CPPOCN due to blank ordering customer            082376
     C****       CPPOCN    ANDNE'N'                        *1             082376
     C********** CPPOCN    ANDEQ'Y'                        *1                          082376 219241
     C           CPPOCN    ANDEQ'B'                                                           219241
     C           BENBNK    ANDEQ'Y'                        *1
      ** Must be blank if Ordering Bank is entered and Beneficary is bank                     246415
     C           PMDCHG    ORNE *BLANK                                                        246415
     C           CPPOCN    ANDEQ' '                                                           246415
     C           PAROBN    ANDNE*BLANK                                                        246415
     C           BENBNK    ANDEQ'Y'                                                           246415
     C*****                MOVE '986'     ERCD,S           *1            S01227
     C                     MOVE '920'     ERCD,S           *1            S01227
     C                     ADD  1         S                *1
     C                     MOVE '1'       *IN31                           LN0787
     C                     END                             E1
     C*
     C** MUST BE BEN,CLM OR OUR
      *                                                                                       219241
      ** If STP Phase 2 MT103 for Non-Funds Transfer (CFT013) is                              219241
      ** installed, Details of Charges must be BEN OUR or SHA.                                219241
      *                                                                                       219241
     C           PMDCHG    IFNE *BLANK                     B1
     C           CPPOCN    ANDNE'B'                        B1
     C           PMDCHG    ORNE *BLANK                     B1
     C           BENBNK    ANDNE'Y'                        B1
     C           PMDCHG    IFNE 'BEN'                      B*2
     C           PMDCHG    ANDNE'OUR'                      **2
     C           PMDCHG    ANDNE'CLM'                      **2
     C           PMDCHG    ANDNE'SHA'                                                         214110
     C           CFT013    ANDNE'Y'                                                           219241
     C           PMDCHG    ORNE 'BEN'                                                         219241
     C           PMDCHG    ANDNE'OUR'                                                         219241
     C           PMDCHG    ANDNE'SHA'                                                         219241
     C           CFT013    ANDEQ'Y'                                                           219241
     C           PMDCHG    OREQ '?  '                                                         214110
     C*********************MOVE '986'     ERCD,S           **2            S01117
     C*********************MOVE '878'     ERCD,S           **2      S01117LN0785
     C********             MOVE '986'     ERCD,S           **2     LN0785 082376
     C**********           MOVE '961'     ERCD,S           *1                          082376 219241
     C           CFT013    IFEQ 'Y'                                                           219241
     C                     MOVE '996'     ERCD,S                                              219241
     C                     ELSE                                                               219241
     C                     MOVE '986'     ERCD,S                                              219241
     C                     ENDIF                                                              219241
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN31                           LN0787
     C                     END                             E*2
     C                     END                             E1
     C** CLM ONLY ALLOWED IF THE BENEFICIARY IS A BANK
     C           PMDCHG    IFEQ 'CLM'                      B1
     C           BENBNK    ANDNE'Y'                        *1
     C**********           MOVE '986'     ERCD,S           *1                                 219241
     C                     MOVE '961'     ERCD,S                                              219241
     C                     ADD  1         S                *1
     C                     ADD  1         S                *1
     C                     MOVE '1'       *IN31                           LN0787
     C                     END                             E1
     C/COPY WNCPYSRC,SD2410C020
     C*                                                                   CEU003
     C**  Validation of 'In' Currency in Field 72                         CEU003
     C*                                                                   CEU003
     C*                                                                   CEU003
     C**  If CEU003 is supported and not called from SD Extended          CEU003
     C**  Settlement Instructions                                         CEU003
     C*                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C           PMCPGM    ANDNE'SSI'                                     CEU003
     C           PMIC72    ANDNE*BLANKS                                   CEU003
     C*                                                                   CEU003
     C           PMPSCY    IFEQ BKEURO                                    CEU003
     C           PMPSCY    OREQ *BLANKS                                   CEU003
     C           PMPCCY    ANDEQBKEURO                                    CEU003
     C*                                                                   CEU003
     C           PMPSTM    IFEQ 01                                        CEU003
     C           PMPSTM    OREQ 08                                        CEU003
     C           CLE033    OREQ 'Y'                                       CLE033
     C           PMPSTM    ANDEQ09                                        CLE033
     C*                                                                   CEU003
     C**  Access Currency Details                                         CEU003
     C*                                                                   CEU003
     C                     CALL 'AOCURRR0'                                CEU003
     C                     PARM *BLANKS   PRTCD                           CEU003
     C                     PARM '*KEY    'POPTN                           CEU003
     C                     PARM PMIC72    PCURR                           CEU003
     C           SDCURR    PARM SDCURR    DSSDY                           CEU003
     C*                                                                   CEU003
     C**  'In' ccy in field 72 is invalid                                 CEU003
     C*                                                                   CEU003
     C           PRTCD     IFNE *BLANKS                                   CEU003
     C                     MOVE '849'     ERCD,S                          CEU003
     C                     ADD  1         S                               CEU003
     C                     MOVE '1'       *IN14                           CEU003
     C                     ELSE                                           CEU003
     C*                                                                   CEU003
     C                     MOVELA6CYCD    PMIC72                          CEU003
     C*                                                                   CEU003
     C           PMPCCY    IFEQ BKEURO                                    CEU003
     C*                                                                   CEU003
     C***********WDTRP     IFLT A6TPSD                             CEU003 134935
     C***********          MOVEL'N'       A6INCY                   CEU003 134935
     C***********          ENDIF                                   CEU003 134935
     C*                                                                   CEU003
     C** Currency in field 72 is not an 'In' currency and In ccy in       CEU003
     C** field 72 is not part of EMU during the value date                CEU003
     C*                                                                   CEU003
     C           A6INCY    IFNE 'Y'                                       CEU003
     C                     MOVE '856'     ERCD,S                          CEU003
     C                     ADD  1         S                               CEU003
     C                     MOVE '1'       *IN14                           CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     ELSE                                           CEU003
     C*                                                                   CEU003
     C**  Transaction currency is an 'In' currency but the currency       CEU003
     C**  entered is not equal to the transaction currency                CEU003
     C*                                                                   CEU003
     C           PMPCCY    IFNE PMIC72                                    CEU003
     C                     MOVE '858'     ERCD,S                          CEU003
     C                     ADD  1         S                               CEU003
     C                     MOVE '1'       *IN14                           CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     ELSE                                           CEU003
     C*                                                                   CEU003
     C**  Pay settlement method is not 01 or 08                           CEU003
     C*                                                                   CEU003
     C                     MOVE '855'     ERCD,S                          CEU003
     C                     ADD  1         S                               CEU003
     C                     MOVE '1'       *IN14                           CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     ELSE                                           CEU003
     C*                                                                   CEU003
     C**  Transaction ccy is Euro but settlement ccy is not blank or      CEU003
     C**  settlement ccy is not Euro                                      CEU003
     C*                                                                   CEU003
     C                     MOVE '857'     ERCD,S                          CEU003
     C                     ADD  1         S                               CEU003
     C                     MOVE '1'       *IN14                           CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C*   Validation of Include ERI                                       CEU003
     C*                                                                   CEU003
     C*                                                                   CEU003
     C**  If CEU003 is supported and  called from SD Extended Settlement  CEU003
     C**  Instructions                                                    CEU003
     C*                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C           PMCPGM    ANDEQ'SSI'                                     CEU003
     C           PMIERI    ANDNE*BLANKS                                   CEU003
     C*                                                                   CEU003
     C           PMPSCY    IFEQ BKEURO                                    CEU003
     C           PMPSCY    OREQ *BLANKS                                   CEU003
     C           PMPCCY    ANDEQBKEURO                                    CEU003
     C*                                                                   CEU003
     C**  Settlement method is not 01 or 08                               CEU003
     C*                                                                   CEU003
     C           PMPSTM    IFNE 01                                        CEU003
     C           PMPSTM    ANDNE08                                        CEU003
     C           CLE033    ANDNE'Y'                                       CLE033
     C           PMPSTM    ORNE 01                                        CLE033
     C           PMPSTM    ANDNE08                                        CLE033
     C           CLE033    ANDEQ'Y'                                       CLE033
     C           PMPSTM    ANDNE09                                        CLE033
     C                     MOVE '859'     ERCD,S                          CEU003
     C                     ADD  1         S                               CEU003
     C                     ELSE                                           CEU003
     C*                                                                   CEU003
     C*                                                                   CEU003
     C**  Value is not 'Y' or 'N'                                         CEU003
     C*                                                                   CEU003
     C           PMIERI    IFNE 'Y'                                       CEU003
     C           PMIERI    ANDNE'N'                                       CEU003
     C                     MOVE '861'     ERCD,S                          CEU003
     C                     ADD  1         S                               CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     ELSE                                           CEU003
     C*                                                                   CEU003
     C**  Pay currency is not Euro                                        CEU003
     C*                                                                   CEU003
     C                     MOVE '860'     ERCD,S                          CEU003
     C                     ADD  1         S                               CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     ENDIF                                          CEU003
     C*
     C** BANK TO BANK INFORMATION
     C** ------------------------
     C                     MOVEA'0000000' *IN,63
     C***********          MOVEA'0000000' *IN,70                          CEU003
     C                     MOVEA'00'      *IN,01                          CEU003
     C                     MOVEA'00'      *IN,08                          CEU003
     C                     MOVEA'00000'   *IN,80
     C                     MOVEA*BLANKS   BTB
     C                     Z-ADD0         X       10
     C*
     C** MUST BE BLANK IF SETTLEMENT TYPE IS '00'
     C           PMPSTM    IFEQ 00                         B1
     C*                                                                   S01408
     C/COPY WNCPYSRC,SD2410CP20                                           S01408
     C*                                                                   S01408
     C           PMBTB1    IFNE *BLANK                     B*2
     C           PMBTB2    ORNE *BLANK                     **2
     C           PMBTB3    ORNE *BLANK                     **2
     C           PMBTB4    ORNE *BLANK                     **2
     C           PMBTB5    ORNE *BLANK                     **2
     C           PMBTB6    ORNE *BLANK                     **2
     C                     MOVE '988'     ERCD,S           **2
     C                     ADD  1         S                **2
     C                     MOVE '1'       *IN31                           LN0787
     C                     END                             E*2
     C                     END                             E1
     C*                                                                   S01408
     C/COPY WNCPYSRC,SD2410CP12                                           S01408
      *****************************************************************   CSW096
      *                                                                   CSW096
      * Call Bank to Bank Validation object                               CSW096
      *                                                                   CSW096
      * Set up parameters                                                 CSW096
      *                                                                   CSW096
     C                     MOVEL*BLANKS   W0RTN                           CSW096
     C                     CLEARI#PARM                                    CSW096
      * Set up Control fields                                             CSW096
     C                     MOVEL':72: '   I#VFLD                          CSW096
     C                     MOVEL'PAY'     I#PR                            CSW096
      * Set up Currency fields                                            CSW096
     C***********          MOVELPMPCCY    I#PCCY                   CSW096 CEU003
     C***********          MOVELPMRCCY    I#RCCY                   CSW096 CEU003
     C                     MOVELWPECY     I#PCCY                          CEU003
     C                     MOVELWRECY     I#RCCY                          CEU003
      * Set up Intermediary                                               CSW096
     C           PMPIBN    IFNE *BLANKS                                   CSW096
     C                     MOVEL'X'       I#INBT                          CSW096
     C                     MOVELPMPIBN    I#INBK                          CSW096
     C                     ENDIF                                          CSW096
      * Set up Account with Bank                                          CSW096
     C           PMAWBN    IFNE *BLANKS                                   CSW096
     C                     MOVEL'X'       I#AWBT                          CSW096
     C                     MOVELPMAWBN    I#AWBK                          CSW096
     C                     ENDIF                                          CSW096
      * Set up Beneficiary                                                CSW096
     C           PMBENN    IFNE *BLANKS                                   CSW096
     C                     MOVEL'X'       I#BENT                          CSW096
     C                     MOVELPMBENN    I#BENF                          CSW096
     C                     ENDIF                                          CSW096
      * Move in Bank to Bank Information                                  CSW096
     C                     MOVELPMBTB1    I#BTB1                          CSW096
     C                     MOVELPMBTB2    I#BTB2                          CSW096
     C                     MOVELPMBTB3    I#BTB3                          CSW096
     C                     MOVELPMBTB4    I#BTB4                          CSW096
     C                     MOVELPMBTB5    I#BTB5                          CSW096
     C                     MOVELPMBTB6    I#BTB6                          CSW096
     C                     MOVELPMPSTM    I#PSTM                          CSW096
     C                     MOVELPMRSTM    I#RSTM                          CSW096
      * Set up receive account information                                CSW096
     C           PMRONS    IFNE *BLANKS                                   CSW096
     C                     SELEC                                          CSW096
     C           PMROBR    WHNE *BLANKS                                   CSW096
     C           PMRONS    CAT  PMROBR    I#RCAC                          CSW096
     C           PMRONS    WHNE *BLANKS                                   CSW096
     C                     MOVELPMRONS    I#RCAC                          CSW096
     C                     ENDSL                                          CSW096
     C                     ENDIF                                          CSW096
      * Set up Pay account information                                    CSW096
     C           PMPONS    IFNE *BLANKS                                   CSW096
     C                     SELEC                                          CSW096
     C           PMPOBR    WHNE *BLANKS                                   CSW096
     C           PMPONS    CAT  PMPOBR    I#PYAC                          CSW096
     C           PMPONS    WHNE *BLANKS                                   CSW096
     C                     MOVELPMPONS    I#PYAC                          CSW096
     C                     ENDSL                                          CSW096
     C                     ENDIF                                          CSW096
      * If extra message and Rec Corr. then set 5354 field                CSW096
     C           PMRVNO    IFNE *BLANKS                                   CSW096
     C           PMRCRN    ANDNE*BLANKS                                   CSW096
     C                     MOVEL'Y'       I#5354                          CSW096
     C                     ENDIF                                          CSW096
      * Set up message type                                               CSW096
     C           PMPOCN    IFNE *BLANKS                                   CSW096
      *                                                                                       CSW203
      ** Set I#MTYP to "103" instead of "100" if CSW203 is installed                          CSW203
      *                                                                                       CSW203
     C           CSW203    IFEQ 'Y'                                                           CSW203
     C                     MOVEL'103'     I#MTYP                                              CSW203
     C                     ELSE                                                               CSW203
     C                     MOVEL'100'     I#MTYP                          CSW096
     C                     ENDIF                                                              CSW203
     C                     ELSE                                           CSW096
     C                     MOVEL'202'     I#MTYP                          CSW096
     C                     ENDIF                                          CSW096
      * Transaction Type                                                  CSW096
     C                     MOVELPMTTYP    I#TTYP                          CSW096
      *                                                                   CSW096
     C                     CLEARO#PARM                                    CSW096
     C                     CLEARE#PARM                                    CSW096
      * Send messages to correct calling process                          CSW096
     C/COPY WNCPYSRC,SD2410C031
     C                     SELEC                                          CSW096
     C           PMCPGM    WHEQ 'FXFX'                                    CSW096
     C                     MOVEL'ME9950'  E#CPGM                          CSW096
     C                     MOVEL'DL'      I#MMOD                          CSW096
     C           PMCPGM    WHEQ 'MMLD'                                    CSW096
     C                     MOVEL'ME9950'  E#CPGM                          CSW096
     C                     MOVEL'LE'      I#MMOD                          CSW096
     C           PMCPGM    WHEQ 'FRIR'                                    CSW005
     C           CSW005    ANDEQ'Y'                                       CSW005
     C           PMCPGM    OREQ 'FRIR'                                    CSW011
     C           CSW011    ANDEQ'Y'                                       CSW011
     C           PMCPGM    OREQ 'FXFX'                                                        CSW212
     C           CSW212    ANDEQ'Y'                                                           CSW212
     C                     MOVEL'ME9950'  E#CPGM                          CSW005
     C                     MOVEL'DL'      I#MMOD                          CSW005
     C           PMCPGM    WHEQ 'SSI '                                    CSW096
     C                     MOVEL'SD0401R' E#CPGM                          CSW096
     C                     MOVEL'AT'      I#MMOD                          CSW096
     C                     OTHER                                          CSW096
     C                     MOVEL'ME9950'  E#CPGM                          CSW096
     C                     ENDSL                                          CSW096
      * Set standard message text                                         CSW096
     C                     MOVEL'MEC0114' E#MSGD                          CSW096
     C                     MOVEL'MEMSG'   E#MSGF                          CSW096
      *                                                                   CSW096
     C/COPY WNCPYSRC,SD2410C101
     C                     CALL 'ME9950'                                  CSW096
     C                     PARM           W0RTN   7                       CSW096
     C                     PARM           I#PARM           I Input Parms  CSW096
     C                     PARM           O#PARM           O Output Parms CSW096
     C                     PARM           E#PARM           E Error Inform CSW096
     C                     PARM           Z#PARM256        B User Defined CSW096
     C/COPY WNCPYSRC,SD2410C032
      *                                                                   CSW096
      * On return if errors copy into error array                         CSW096
      *                                                                   CSW096
     C                     MOVELO#BTB1    PMBTB1                          CSW096
     C                     MOVELO#BTB2    PMBTB2                          CSW096
     C                     MOVELO#BTB3    PMBTB3                          CSW096
     C                     MOVELO#BTB4    PMBTB4                          CSW096
     C                     MOVELO#BTB5    PMBTB5                          CSW096
     C                     MOVELO#BTB6    PMBTB6                          CSW096
     C/COPY WNCPYSRC,SD2410C102
      *                                                                   CSW005
      ** Subtract 1 from error array index                                CSW005
     C                     SUB  1         E#INDX                          CSW005
      *                                                                   CSW096
     C           E#ERRM    IFNE *BLANKS                                   CSW096
      *                                                                   CSW096
     C           1         DO   E#INDX    Q#      50                      CSW096
     C                     MOVEAO#E,Q#    ERCD,S                          CSW096
     C                     ADD  1         S                               CSW096
     C                     ENDDO                                          CSW096
      *                                                                   CSW096
      * Mark pay side as in error                                         CSW096
     C                     MOVEL*ON       *IN31                           CSW096
      *                                                                   CSW096
     C                     ENDIF                                          CSW096
      *                                                                   CSW096
      *****************************************************************   CSW096
      ***********                                                         CSW096
     C***********                                                   S01408CSW096
     C***********                                                         CSW096
     C***FIRST*BANK TO BANK INFORMATION FIELD                             CSW096
     C***********PMBTB1    IFNE *BLANKS                    B1             CSW096
     C***********          Z-ADD1         LINE    10       *1             CSW096
     C***********          MOVE PMBTB1    XBTB             *1             CSW096
     C***********SLASH2    IFEQ '//'                       B*2            CSW096
     C***********          MOVE '989'     ERCD,S           **2            CSW096
     C***********          ADD  1         S                **2            CSW096
     C***********          MOVE '1'       *IN31                     LN0787CSW096
     C***********          ELSE                            X*2            CSW096
     C***********SLASH1    IFEQ '/'                        B**3           CSW096
     C***********          MOVE '1'       *IN63            ***3           CSW096
     C***********          EXSR BTBVAL                     ***3           CSW096
     C***********BTBERR    IFNE 'E'                        B***4          CSW096
     C***********XBTB      ANDNEPMBTB1                     ****4          CSW096
     C***********          MOVE XBTB      PMBTB1           ****4          CSW096
     C***********          END                             E***4          CSW096
      ***********                                                   S01414CSW096
      ****If*entry does not begin '/' or '//', entry is now invalid S01412CSW096
     C***********          ELSE                            X**3     S01412CSW096
     C***********          MOVE '153'     ERCD,S                    S01412CSW096
     C***********          ADD  1         S                         S01412CSW096
     C***********          MOVE '1'       *IN31                     S01412CSW096
     C***********          END                             E**3           CSW096
     C***********          END                             E*2            CSW096
     C***********          END                             E1             CSW096
     C***********                                                         CSW096
     C***SECOND*BANK TO BANK INFORMATION FIELD                            CSW096
     C***********PMBTB2    IFNE *BLANKS                    B1             CSW096
     C***********          Z-ADD2         LINE             *1             CSW096
     C***********          MOVE PMBTB2    XBTB             *1             CSW096
     C***********SLASH2    IFEQ '//'                       B*2            CSW096
     C***********          MOVE '1'       *IN80            **2            CSW096
      ****If*entry begins with "//", it cannot be followed          096151CSW096
      ****by*all*blanks.                                            096151CSW096
     C***********BLKCHK    IFEQ *BLANKS                    B**3     096151CSW096
     C***********          MOVE '153'     ERCD,S           ***3     096151CSW096
     C***********          ADD  1         S                ***3     096151CSW096
     C***********          MOVE '1'       *IN31                     096151CSW096
     C***********          END                             E**3     096151CSW096
     C************IN63     IFNE '1'                        B**3           CSW096
     C***********          MOVE '989'     ERCD,S           ***3           CSW096
     C***********          ADD  1         S                ***3           CSW096
     C*********************                                  092396 096151CSW096
     C*********************ELSE                              092396 096151CSW096
     C*********************MOVE PMBTB2    BLK33  33          092396 096151CSW096
     C***********BLK33*****IFEQ *BLANKS                      092396 096151CSW096
     C*********************MOVE '989'     ERCD,S             092396 096151CSW096
     C*********************ADD  1         S                  092396 096151CSW096
     C*********************END                               092396 096151CSW096
     C*********************                                  092396 096151CSW096
     C***********          MOVE '1'       *IN31                     LN0787CSW096
     C***********          END                             E**3           CSW096
     C***********          ELSE                            X*2            CSW096
     C***********SLASH1    IFEQ '/'                        B**3           CSW096
     C***********          MOVEA'000'     *IN,71           ***3     S01412CSW096
     C***********          EXSR BTBVAL                     ***3           CSW096
     C***********BTBERR    IFNE 'E'                        B***4          CSW096
     C***********XBTB      ANDNEPMBTB2                     ****4          CSW096
     C***********          MOVE XBTB      PMBTB2           ****4          CSW096
     C***********          END                             E***4          CSW096
      ***********                                                   S01414CSW096
      ****If*entry does not begin '/' or '//', entry is now invalid S01412CSW096
     C***********          ELSE                            X**3     S01412CSW096
     C***********          MOVE '153'     ERCD,S                    S01412CSW096
     C***********          ADD  1         S                         S01412CSW096
     C***********          MOVE '1'       *IN31                     S01412CSW096
     C***********          END                             E**3           CSW096
     C***********          END                             E*2            CSW096
     C***********SLASH1    IFEQ '/'                        B*2            CSW096
     C***********          MOVE '1'       *IN64            **2            CSW096
     C***********          END                             E*2            CSW096
     C***********          END                             E1             CSW096
     C***IF*/IBK/*ENTERED*A*MAXIMUM*OF*1*LINE*MAY*BE*USED*OPTIONALLYS01412CSW096
     C***PRECEDED*BY*AN*ACCOUNT*NUMBER*LINE*************************S01412CSW096
     C************IN72     IFEQ '1'                                 S01412CSW096
     C************IN80     ANDEQ'1'                                 S01412CSW096
     C***********          MOVE '998'     ERCD,S                    S01412CSW096
     C***********          ADD  1         S                         S01412CSW096
     C***********          MOVE '1'       *IN31               LN0787S01412CSW096
     C***********          END                                      S01412CSW096
     C***********                                                         CSW096
     C***THIRD*BANK TO BANK INFORMATION FIELD                             CSW096
     C***********PMBTB3    IFNE *BLANKS                    B1             CSW096
     C***********          Z-ADD3         LINE             *1             CSW096
     C***********          MOVE PMBTB3    XBTB             *1             CSW096
     C***********SLASH2    IFEQ '//'                       B*2            CSW096
     C***********          MOVE '1'       *IN81            **2            CSW096
      ****If*entry begins with "//", it cannot be followed          096151CSW096
      ****by*all*blanks.                                            096151CSW096
     C***********BLKCHK    IFEQ *BLANKS                    B**3     096151CSW096
     C***********          MOVE '153'     ERCD,S           ***3     096151CSW096
     C***********          ADD  1         S                ***3     096151CSW096
     C***********          MOVE '1'       *IN31                     096151CSW096
     C***********          END                             E**3     096151CSW096
     C************IN64     IFNE '1'                        B**3           CSW096
     C***********          MOVE '989'     ERCD,S           ***3           CSW096
     C***********          ADD  1         S                ***3           CSW096
     C***********          MOVE '1'       *IN31                     LN0787CSW096
     C***********          END                             E**3           CSW096
     C***********          ELSE                            X*2            CSW096
     C***********SLASH1    IFEQ '/'                        B**3           CSW096
     C***********          MOVEA'000'     *IN,71           ***3     S01412CSW096
     C***********          EXSR BTBVAL                     ***3           CSW096
     C***********BTBERR    IFNE 'E'                        B***4          CSW096
     C***********XBTB      ANDNEPMBTB3                     ****4          CSW096
     C***********          MOVE XBTB      PMBTB3           ****4          CSW096
     C***********          END                             E***4          CSW096
      ***********                                                   S01414CSW096
      ****If*entry does not begin '/' or '//', entry is now invalid S01412CSW096
     C***********          ELSE                            X**3     S01412CSW096
     C***********          MOVE '153'     ERCD,S                    S01412CSW096
     C***********          ADD  1         S                         S01412CSW096
     C***********          MOVE '1'       *IN31                     S01412CSW096
     C***********          END                             E**3           CSW096
     C***********          END                             E*2            CSW096
     C***********SLASH1    IFEQ '/'                        B*2            CSW096
     C***********          MOVE '1'       *IN65            **2            CSW096
     C***********          END                             E*2            CSW096
     C***********          END                             E1             CSW096
     C***********                                                         CSW096
     C***IF*/INS/ OR /OGB/ ENTERED A MAXIMUM OF 2 LINES MAY BE USED       CSW096
     C***IF*/IBK/*ENTERED*A*MAXIMUM*OF*1*LINE*MAY*BE*USED*OPTIONALLYS01412CSW096
     C***PRECEDED BY AN ACCOUNT NUMBER LINE                               CSW096
     C************IN71     IFEQ '1'                                       CSW096
     C************IN73     OREQ '1'                                 S01412CSW096
     C************IN80     IFEQ '1'                                       CSW096
     C************IN81     ANDEQ'1'                                       CSW096
     C***********          MOVE '998'     ERCD,S                          CSW096
     C***********          ADD  1         S                               CSW096
     C***********          MOVE '1'       *IN31                     LN0787CSW096
     C***********          END                                            CSW096
     C***********          END                                            CSW096
     C************IN72     IFEQ '1'                                 S01412CSW096
     C************IN81     ANDEQ'1'                                 S01412CSW096
     C***********          MOVE '998'     ERCD,S                    S01412CSW096
     C***********          ADD  1         S                         S01412CSW096
     C***********          MOVE '1'       *IN31               LN0787S01412CSW096
     C***********          END                                      S01412CSW096
     C***********                                                         CSW096
     C***FOURTH*BANK TO BANK INFORMATION FIELD                            CSW096
     C***********PMBTB4    IFNE *BLANKS                    B1             CSW096
     C***********          Z-ADD4         LINE             *1             CSW096
     C***********          MOVE PMBTB4    XBTB             *1             CSW096
     C***********SLASH2    IFEQ '//'                       B*2            CSW096
     C***********          MOVE '1'       *IN82            **2            CSW096
      ****If*entry begins with "//", it cannot be followed          096151CSW096
      ****by*all*blanks.                                            096151CSW096
     C***********BLKCHK    IFEQ *BLANKS                    B**3     096151CSW096
     C***********          MOVE '153'     ERCD,S           ***3     096151CSW096
     C***********          ADD  1         S                ***3     096151CSW096
     C***********          MOVE '1'       *IN31                     096151CSW096
     C***********          END                             E**3     096151CSW096
     C************IN65     IFNE '1'                        B**3           CSW096
     C***********          MOVE '989'     ERCD,S           ***3           CSW096
     C***********          ADD  1         S                ***3           CSW096
     C***********          MOVE '1'       *IN31                     LN0787CSW096
     C***********          END                             E**3           CSW096
     C***********          ELSE                            X*2            CSW096
     C***********SLASH1    IFEQ '/'                        B**3           CSW096
     C***********          MOVEA'000'     *IN,71           ***3     S01412CSW096
     C***********          EXSR BTBVAL                     ***3           CSW096
     C***********BTBERR    IFNE 'E'                        B***4          CSW096
     C***********XBTB      ANDNEPMBTB4                     ****4          CSW096
     C***********          MOVE XBTB      PMBTB4           ****4          CSW096
     C***********          END                             E***4          CSW096
      ***********                                                   S01414CSW096
      ****If*entry does not begin '/' or '//', entry is now invalid S01412CSW096
     C***********          ELSE                            X**3     S01412CSW096
     C***********          MOVE '153'     ERCD,S                    S01412CSW096
     C***********          ADD  1         S                         S01412CSW096
     C***********          MOVE '1'       *IN31                     S01412CSW096
     C***********          END                             E**3           CSW096
     C***********          END                             E*2            CSW096
     C***********SLASH1    IFEQ '/'                        B*2            CSW096
     C***********          MOVE '1'       *IN66            **2            CSW096
     C***********          END                             E*2            CSW096
     C***********          END                             E1             CSW096
     C***********                                                         CSW096
     C***IF*/INS/ OR /OGB/ ENTERED A MAXIMUM OF 2 LINES MAY BE USED       CSW096
     C***IF*/IBK/*ENTERED*A*MAXIMUM*OF*1*LINE*MAY*BE*USED*OPTIONALLYS01412CSW096
     C***PRECEDED BY AN ACCOUNT NUMBER LINE                               CSW096
     C************IN71     IFEQ '1'                                       CSW096
     C************IN73     OREQ '1'                                 S01412CSW096
     C************IN81     IFEQ '1'                                       CSW096
     C************IN82     ANDEQ'1'                                       CSW096
     C***********          MOVE '998'     ERCD,S                          CSW096
     C***********          ADD  1         S                               CSW096
     C***********          MOVE '1'       *IN31                     LN0787CSW096
     C***********          END                                            CSW096
     C***********          END                                            CSW096
     C************IN72     IFEQ '1'                                 S01412CSW096
     C************IN82     ANDEQ'1'                                 S01412CSW096
     C***********          MOVE '998'     ERCD,S                    S01412CSW096
     C***********          ADD  1         S                         S01412CSW096
     C***********          MOVE '1'       *IN31               LN0787S01412CSW096
     C***********          END                                      S01412CSW096
     C***********                                                         CSW096
     C***FIFTH*BANK TO BANK INFORMATION FIELD                             CSW096
     C***********PMBTB5    IFNE *BLANKS                    B1             CSW096
     C***********          Z-ADD5         LINE             *1             CSW096
     C***********          MOVE PMBTB5    XBTB             *1             CSW096
     C***********SLASH2    IFEQ '//'                       B*2            CSW096
     C***********          MOVE '1'       *IN83            **2            CSW096
      ****If*entry begins with "//", it cannot be followed          096151CSW096
      ****by*all*blanks.                                            096151CSW096
     C***********BLKCHK    IFEQ *BLANKS                    B**3     096151CSW096
     C***********          MOVE '153'     ERCD,S           ***3     096151CSW096
     C***********          ADD  1         S                ***3     096151CSW096
     C***********          MOVE '1'       *IN31                     096151CSW096
     C***********          END                             E**3     096151CSW096
     C************IN66     IFNE '1'                        B**3           CSW096
     C***********          MOVE '989'     ERCD,S           ***3           CSW096
     C***********          ADD  1         S                ***3           CSW096
     C***********          MOVE '1'       *IN31                     LN0787CSW096
     C***********          END                             E**3           CSW096
     C***********          ELSE                            X*2            CSW096
     C***********SLASH1    IFEQ '/'                        B**3           CSW096
     C***********          MOVEA'000'     *IN,71           ***3     S01412CSW096
     C***********          EXSR BTBVAL                     ***3           CSW096
     C***********BTBERR    IFNE 'E'                        B***4          CSW096
     C***********XBTB      ANDNEPMBTB5                     ****4          CSW096
     C***********          MOVE XBTB      PMBTB5           ****4          CSW096
     C***********          END                             E***4          CSW096
      ***********                                                   S01414CSW096
      ****If*entry does not begin '/' or '//', entry is now invalid S01412CSW096
     C***********          ELSE                            X**3     S01412CSW096
     C***********          MOVE '153'     ERCD,S                    S01412CSW096
     C***********          ADD  1         S                         S01412CSW096
     C***********          MOVE '1'       *IN31                     S01412CSW096
     C***********          END                             E**3           CSW096
     C***********          END                             E*2            CSW096
     C***********SLASH1    IFEQ '/'                        B*2            CSW096
     C***********          MOVE '1'       *IN67            **2            CSW096
     C***********          END                             E*2            CSW096
     C***********          END                             E1             CSW096
     C***********                                                         CSW096
     C***IF*/INS/ OR /OGB/ ENTERED A MAXIMUM OF 2 LINES MAY BE USED       CSW096
     C***IF*/IBK/*ENTERED*A*MAXIMUM*OF*1*LINE*MAY*BE*USED.********* S01412CSW096
     C***********                                                         CSW096
     C************IN71     IFEQ '1'                                       CSW096
     C************IN82     IFEQ '1'                                       CSW096
     C************IN83     ANDEQ'1'                                       CSW096
     C***********          MOVE '998'     ERCD,S                          CSW096
     C***********          ADD  1         S                               CSW096
     C***********          MOVE '1'       *IN31                     LN0787CSW096
     C***********          END                                            CSW096
     C***********          END                                            CSW096
     C************IN72     IFEQ '1'                                 S01412CSW096
     C************IN83     ANDEQ'1'                                 S01412CSW096
     C***********          MOVE '998'     ERCD,S                    S01412CSW096
     C***********          ADD  1         S                         S01412CSW096
     C***********          MOVE '1'       *IN31               LN0787S01412CSW096
     C***********          END                                      S01412CSW096
     C***********                                                         CSW096
     C***ERROR*IF*/IBK/*ENTERED*WITH*AN*ACCOUNT*LINE*IN*LINE*5******S01412CSW096
     C***********LINE      IFEQ 5                                   S01412CSW096
     C************IN73     ANDEQ'1'                                 S01412CSW096
     C************IN83     ANDEQ'0'                                 S01412CSW096
     C***********          MOVE '891'     ERCD,S                    S01412CSW096
     C***********          ADD  1         S                         S01412CSW096
     C***********          MOVE '1'       *IN31               LN0787S01412CSW096
     C***********          END                                      S01412CSW096
     C***********                                                         CSW096
     C***SIXTH*BANK TO BANK INFORMATION FIELD                             CSW096
     C***********PMBTB6    IFNE *BLANKS                    B1             CSW096
     C***********          Z-ADD6         LINE             *1             CSW096
     C***********          MOVE PMBTB6    XBTB             *1             CSW096
     C***********SLASH2    IFEQ '//'                       B*2            CSW096
     C***********          MOVE '1'       *IN84            **2            CSW096
      ****If*entry begins with "//", it cannot be followed          096151CSW096
      ****by*all*blanks.                                            096151CSW096
     C***********BLKCHK    IFEQ *BLANKS                    B**3     096151CSW096
     C***********          MOVE '153'     ERCD,S           ***3     096151CSW096
     C***********          ADD  1         S                ***3     096151CSW096
     C***********          MOVE '1'       *IN31                     096151CSW096
     C***********          END                             E**3     096151CSW096
     C************IN67     IFNE '1'                        B**3           CSW096
     C***********          MOVE '989'     ERCD,S           ***3           CSW096
     C***********          ADD  1         S                ***3           CSW096
     C***********          MOVE '1'       *IN31                     LN0787CSW096
     C***********          END                             E**3           CSW096
     C***********          ELSE                            X*2            CSW096
     C***********SLASH1    IFEQ '/'                        B**3           CSW096
     C***********          MOVEA'000'     *IN,71           ***3     S01412CSW096
     C***********          EXSR BTBVAL                     ***3           CSW096
     C***********BTBERR    IFNE 'E'                        B***4          CSW096
     C***********XBTB      ANDNEPMBTB6                     ****4          CSW096
     C***********          MOVE XBTB      PMBTB6           ****4          CSW096
     C***********          END                             E***4          CSW096
      ***********                                                   S01414CSW096
      ****If*entry does not begin '/' or '//', entry is now invalid S01412CSW096
     C***********          ELSE                            X**3     S01412CSW096
     C***********          MOVE '153'     ERCD,S                    S01412CSW096
     C***********          ADD  1         S                         S01412CSW096
     C***********          MOVE '1'       *IN31                     S01412CSW096
     C***********          END                             E**3           CSW096
     C***********          END                             E*2            CSW096
     C***********SLASH1    IFEQ '/'                        B*2            CSW096
     C***********          MOVE '1'       *IN68            **2            CSW096
     C***********          END                             E*2            CSW096
     C***********          END                             E1             CSW096
     C***********                                                         CSW096
     C***IF*/INS/ OR /OGB/ ENTERED A MAXIMUM OF 2 LINES MAY BE USED       CSW096
     C************IN71     IFEQ '1'                                       CSW096
     C************IN83     ANDEQ'1'                                       CSW096
     C************IN84     ANDEQ'1'                                       CSW096
     C***********          MOVE '998'     ERCD,S                          CSW096
     C***********          ADD  1         S                               CSW096
     C***********          MOVE '1'       *IN31                     LN0787CSW096
     C***********          END                                            CSW096
     C***********                                                         CSW096
     C***ERROR*IF*/IBK/*ENTERED*IN*LINE*6************************   S01412CSW096
     C***********LINE      IFEQ 6                                   S01412CSW096
     C************IN73     IFEQ '1'                                 S01412CSW096
     C************IN72     OREQ '1'                                 S01412CSW096
     C***********          MOVE '891'     ERCD,S                    S01412CSW096
     C***********          ADD  1         S                         S01412CSW096
     C***********          MOVE '1'       *IN31               LN0787S01412CSW096
     C***********          ELSE                                     S01412CSW096
     C***********                                                         CSW096
     C***ERROR*IF*/IBK/*ENTERED*AND*ALL*SIX*BANK*TO*BANK*LINES*HAVE*S01412CSW096
     C***BEEN*USED**************************************************S01412CSW096
     C************IN74     IFEQ '1'                                 S01412CSW096
     C***********PMBTB1    ANDNE*BLANKS                             S01412CSW096
     C***********PMBTB2    ANDNE*BLANKS                             S01412CSW096
     C***********PMBTB3    ANDNE*BLANKS                             S01412CSW096
     C***********PMBTB4    ANDNE*BLANKS                             S01412CSW096
     C***********PMBTB5    ANDNE*BLANKS                             S01412CSW096
     C***********PMBTB6    ANDNE*BLANKS                             S01412CSW096
     C***********          MOVE '891'     ERCD,S                    S01412CSW096
     C***********          ADD  1         S                         S01412CSW096
     C***********          MOVE '1'       *IN31               LN0787S01412CSW096
     C***********          END                                      S01412CSW096
     C***********          END                                      S01412CSW096
     C***********          END                                      S01412CSW096
     C***********                                                         CSW096
     C***/INT/*MAY ONLY BE USED IF FIELD 56 INTERMEDIARY BANK IS          CSW096
     C***ENTERED*                                                   S01412CSW096
     C***ENTERED*OR*/IBK/*IN*FIELD*72*IS*ENTERED********************S01412CSW096
     C************IN76     IFEQ '1'                                       CSW096
     C***********PMPIBN    ANDEQ*BLANKS                                   CSW096
     C************IN74     ANDEQ'0'                                 S01412CSW096
     C***********          MOVE '893'     ERCD,S                          CSW096
     C***********          ADD  1         S                               CSW096
     C***********          MOVE '1'       *IN31                     LN0787CSW096
     C***********          END                                            CSW096
     C***********                                                         CSW096
     C***/CABLEIBK/, /PHONIBK/ AND /TELEXIBK/ MAY ONLY BE USED IF         CSW096
     C***FIELD*56 INTERMEDIARY BANK IS ENTERED                      S01412CSW096
     C***FIELD*56*INTERMEDIARY*BANK*IS*ENTERED*OR*/IBK/*IN*FIELD*72*S01412CSW096
     C***ENTERED****************************************************S01412CSW096
     C************IN75     IFEQ '1'                                       CSW096
     C***********PMPIBN    ANDEQ*BLANKS                                   CSW096
     C************IN74     ANDEQ'0'                                 S01412CSW096
     C***********          MOVE '894'     ERCD,S                          CSW096
     C***********          ADD  1         S                               CSW096
     C***********          MOVE '1'       *IN31                     LN0787CSW096
     C***********          END                                            CSW096
     C***********                                                         CSW096
     C***FREE*TEXT MUST BE ENTERED AFTER ALL CODE WORDS AND               CSW096
     C***CONTINUATION LINES                                               CSW096
     C************IN63     IFNE '1'                        B1             CSW096
     C************IN64     IFEQ '1'                        B*2            CSW096
     C************IN65     OREQ '1'                        **2            CSW096
     C************IN66     OREQ '1'                        **2            CSW096
     C************IN67     OREQ '1'                        **2            CSW096
     C************IN68     OREQ '1'                        **2            CSW096
     C***********          MOVE '994'     ERCD,S           **2            CSW096
     C***********          ADD  1         S                **2            CSW096
     C***********          MOVE '1'       *IN31                     LN0787CSW096
     C***********          GOTO V01END                     **2            CSW096
     C***********          END                             E*2            CSW096
     C***********          END                             E1             CSW096
     C************IN64     IFNE '1'                        B1             CSW096
     C************IN65     IFEQ '1'                        B*2            CSW096
     C************IN66     OREQ '1'                        **2            CSW096
     C************IN67     OREQ '1'                        **2            CSW096
     C************IN68     OREQ '1'                        **2            CSW096
     C***********          MOVE '994'     ERCD,S           **2            CSW096
     C***********          ADD  1         S                **2            CSW096
     C***********          MOVE '1'       *IN31                     LN0787CSW096
     C***********          GOTO V01END                     **2            CSW096
     C***********          END                             E*2            CSW096
     C***********          END                             E1             CSW096
     C************IN65     IFNE '1'                        B1             CSW096
     C************IN66     IFEQ '1'                        B*2            CSW096
     C************IN67     OREQ '1'                        **2            CSW096
     C************IN68     OREQ '1'                        **2            CSW096
     C***********          MOVE '994'     ERCD,S           **2            CSW096
     C***********          ADD  1         S                **2            CSW096
     C***********          MOVE '1'       *IN31                     LN0787CSW096
     C***********          GOTO V01END                     **2            CSW096
     C***********          END                             E*2            CSW096
     C***********          END                             E1             CSW096
     C************IN66     IFNE '1'                        B1             CSW096
     C************IN67     IFEQ '1'                        B*2            CSW096
     C************IN68     OREQ '1'                        **2            CSW096
     C***********          MOVE '994'     ERCD,S           **2            CSW096
     C***********          ADD  1         S                *1             CSW096
     C***********          MOVE '1'       *IN31                     LN0787CSW096
     C***********          GOTO V01END                     **2            CSW096
     C***********          END                             E*2            CSW096
     C***********          END                             E1             CSW096
     C************IN67     IFNE '1'                        B1             CSW096
     C************IN68     ANDEQ'1'                        B1             CSW096
     C***********          MOVE '994'     ERCD,S           *1             CSW096
     C***********          ADD  1         S                *1             CSW096
     C***********          MOVE '1'       *IN31                     LN0787CSW096
     C***********          END                             E1             CSW096
     C***********                                                         CSW096
     C*                                                                   S01408
     C/COPY WNCPYSRC,SD2410CP11                                           S01408
     C*                                                                   S01408
     C**                                                                  S01117
     C** The following code has been moved further up the program         S01117
     C** as the Branch validation has been done too late.                 S01117
     C**                                                                  S01117
     C***SETTLEMENT*BRANCH***************************************         S01117
     C** -----------------                                                S01117
     C**                                                                  S01117
     C***IF*MULTIBRANCHING*FLAG*IS*OFF*SKIP*FURTHER*VALIDATION***         S01117
     C***********@MBIN     IFEQ 'N'                        B1             S01117
     C*********************GOTO EVAL17                     *1             S01117
     C*********************END                             E1             S01117
     C*                                                                   S01117
     C***SETTLEMENT*BRANCH*ONLY*ALLOWED*WITH*SETTLEMENT*METHOD*5**        S01117
      ***ONLY*VALIDATE*IF*USER*SET*UP*********************                S01117
     C***********PMPSTM    IFNE 05                         B1             S01117
     C***********PBRF      ANDEQ*BLANKS                    B1             S01117
     C*                                                                   S01117
     C***Validate*Pay*Branch*if*user*set*up.*********************         S01117
     C***********PBRF      IFEQ *BLANKS                    B*2            S01117
     C***********PMOSSB    IFNE *BLANKS                    B*2            S01117
     C***********PMPOBR    IFNE *BLANKS                    B*2            S01117
     C*********************MOVE '883'     ERCD,S           **2            S01117
     C*********************ADD  1         S                **2            S01117
     C*********************END                             E*2            S01117
     C*********************END                             E*2            S01117
     C*                                                                   S01117
     C*********************ELSE                            X1             S01117
     C*                                                                   S01117
     C***SETTLEMENT*BRANCH*MANDATORY*WITH*SETTLEMENT*METHOD*5****         S01117
     C***********PMOSSB    IFEQ *BLANKS                    B*2            S01117
     C***********PMPOBR    IFEQ *BLANKS                    B*2            S01117
     C*********************MOVE '882'     ERCD,S           **2            S01117
     C*********************ADD  1         S                **2            S01117
     C*                                                                   S01117
     C*********************ELSE                            X*2            S01117
     C*                                                                   S01117
     C***VALIDATE*SETTLEMENT*BRANCH******************************         S01117
     C*********************MOVE PMOSSB    @OBR    3        **2            S01117
     C*********************MOVE PMPOBR    @OBR    3        **2            S01117
     C*********************EXSR CHKBR                      **2            S01117
     C***********@RTCD     IFNE *BLANKS                    B**3           S01117
     C*********************MOVE '881'     ERCD,S           ***3           S01117
     C*********************ADD  1         S                ***3           S01117
     C*********************ELSE                            ***3           S01117
     C*********************MOVE @DSNB     PMPOBR           ***3           S01117
     C*********************END                             E**3           S01117
     C*********************END                             E*2            S01117
     C*********************END                             E1             S01117
     C*                                                                   S01117
     C*                                                                   S01117
     C***********EVAL17    TAG                                            S01117
     C*                                                                   CSW005
     C**  Validate new FRA/IRS settlement fields:                         CSW005
     C**  ---------------------------------------                         CSW005
     C*                                                                   CSW005
     C           CSW005    IFEQ 'Y'                                       CSW005
     C           PMCPGM    ANDEQ'FRIR'                                    CSW005
     C           CSW005    OREQ 'Y'                                       CSW005
     C           PMCPGM    ANDEQ'SSI '                                    CSW005
     C           CSW011    OREQ 'Y'                                       CSW011
     C           PMCPGM    ANDEQ'FRIR'                                    CSW011
     C           CSW011    OREQ 'Y'                                       CSW011
     C           PMCPGM    ANDEQ'SSI '                                    CSW011
     C           CSW212    OREQ 'Y'                                                           CSW212
     C           PMCPGM    ANDEQ'FXFX'                                                        CSW212
     C           CSW212    OREQ 'Y'                                                         AR995086
     C           PMCPGM    ANDEQ'SSI '                                                      AR995086
     C*                                                                   CSW005
     C**  First, convert Agreement Type to disregard leading blanks       CSW005
     C*                                                                   CSW005
     C           SDAGTY    IFNE *BLANKS                                   CSW005
     C*                                                                   CSW005
     C           PMTTYP    IFEQ 'RS'                                      CSW005
     C           PMTTYP    OREQ 'RX'                                      CSW005
     C           PMTTYP    OREQ 'DV'                                                         BUG7139
     C           CDL031    ANDEQ'Y'                                                          BUG7139
     C           PMTTYP    OREQ 'FR'                                      CSW097
     C           PMCPGM    OREQ 'SSI '                                    CSW005
     C           PMTTYP    ANDEQ'AT'                                      CSW005
     C           CSW005    ANDEQ'Y'                                       CSW011
     C           PMTTYP    OREQ 'AT'                                                          CSW212
     C           CSW212    ANDEQ'Y'                                                           CSW212
     C           PMTTYP    OREQ 'FX'                                                          CSW212
     C           CSW212    ANDEQ'Y'                                                           CSW212
     C           PMTTYP    OREQ 'OP'                                                          CSW212
     C           CSW212    ANDEQ'Y'                                                           CSW212
     C           PMTTYP    OREQ 'FF'                                                          CSW212
     C           CSW212    ANDEQ'Y'                                                           CSW212
     C           PMTTYP    OREQ 'CL'                                                          CSW212
     C           CDL008    ANDEQ'Y'                                                           CSW212
     C           CSW212    ANDEQ'Y'                                                           CSW212
     C*                                                                   CSW005
     C                     MOVELSDAGTY    ##FLD   6                       CSW005
     C           1         DO   6         X       10                      CSW005
     C           1         SUBSTSDAGTY:X  ##001   1                       CSW005
     C           ##001     IFNE *BLANKS                                   CSW005
     C                     LEAVE                                          CSW005
     C                     ENDIF                                          CSW005
     C                     ENDDO                                          CSW005
     C*                                                                   CSW005
     C                     SUBST##FLD:X   SDAGTY    P                     CSW005
     C*                                                                   CSW005
     C                     ENDIF                                          CSW005
     C                     ENDIF                                          CSW005
     C*                                                                   CSW005
     C**  Definition Confirmation Sender to Receiver                      CSW005
     C*                                                                   CSW005
     C                     CLEARI#PARM                                    CSW005
     C                     CLEARE#PARM                                    CSW005
     C                     CLEARO#PARM                                    CSW005
     C*                                                                   CSW005
     C                     MOVEL':72: '   I#VFLD    P                     CSW005
     C                     MOVELPMTTYP    I#TTYP                          CSW005
     C                     MOVEL'FI'      I#MMOD                          CSW005
     C           PMAWBN    IFNE *BLANKS                                   CSW005
     C                     MOVEL'X'       I#AWBT                          CSW005
     C                     MOVELPMAWBN    I#AWBK                          CSW005
     C                     ENDIF                                          CSW005
     C                     MOVELSDDSR1    I#BTB1                          CSW005
     C                     MOVELSDDSR2    I#BTB2                          CSW005
     C                     MOVELSDDSR3    I#BTB3                          CSW005
     C                     MOVELSDDSR4    I#BTB4                          CSW005
     C                     MOVELSDDSR5    I#BTB5                          CSW005
     C                     MOVELSDDSR6    I#BTB6                          CSW005
      *                                                                   CSW005
     C                     MOVEL*BLANKS   W#MSTX  1                                           CSW212
     C           CSW212    IFEQ 'Y'                                                           CSW212
     C           I#TTYP    IFEQ 'AT'                                                          CSW212
     C           I#TTYP    OREQ 'FX'                                                          CSW212
     C           I#TTYP    OREQ 'OP'                                                          CSW212
     C           I#TTYP    OREQ 'FF'                                                          CSW212
     C           I#TTYP    OREQ 'CL'                                                          CSW212
     C           CDL008    ANDEQ'Y'                                                           CSW212
      *                                                                                       CSW212
      **  Field is allowed if Cover MT202 indicator is Y                                      CSW212
      *                                                                                       CSW212
     C                     MOVELPMCVMR    I#COVR                                              CSW212
     C           I#BTB     IFNE *BLANKS                                                       CSW212
     C           I#COVR    ANDNE'Y'                                                           CSW212
     C                     MOVE '421'     ERCD,S                                              CSW212
     C                     ADD  1         S                                                   CSW212
     C                     ENDIF                                                              CSW212
      *                                                                                       CSW212
     C                     MOVEL'DL'      I#MMOD                                              CSW212
     C                     MOVELPMPSTM    I#PSTM                                              CSW212
      *                                                                                       CSW212
     C           I#TTYP    IFNE 'AT'                                                          CSW212
     C           I#TTYP    OREQ 'AT'                                                          CSW212
     C           CSW005    ANDEQ'N'                                                           CSW212
     C           CSW011    ANDEQ'N'                                                           CSW212
     C                     MOVEL'202'     I#MTYP                                              CSW212
     C                     ENDIF                                                              CSW212
      *                                                                                       CSW212
      ** Map Beneficiary with Receipient of Pay Inst.                                         CSW212
      *                                                                                       CSW212
     C           PARVNO    IFNE *BLANKS                                                       CSW212
     C                     MOVELPARVNO    I#BENF                                              CSW212
     C                     MOVEL'X'       I#BENT                                              CSW212
     C                     ENDIF                                                              CSW212
      *                                                                                       CSW212
      ** Map Intermediary bank with Pay-Our Nostro                                            CSW212
      *                                                                                       CSW212
     C           PMPONS    IFNE *BLANKS                                                       CSW212
     C                     MOVELPMPCCY    @CYCD                                               CSW212
     C                     MOVELPMPONS    @NONB                                               CSW212
     C                     EXSR CHKNO                                                         CSW212
     C                     MOVELA7CUST    I#INBK                                              CSW212
     C                     MOVEL'X'       I#INBT                                              CSW212
     C                     ENDIF                                                              CSW212
      *                                                                                       CSW212
      ** Map Account with Bank with Receiver's Correspondent                                  CSW212
      *                                                                                       CSW212
     C           PARCRN    IFNE *BLANKS                                                       CSW212
     C                     MOVEL'X'       I#AWBT                                              CSW212
     C                     MOVELPARCRN    I#AWBK                                              CSW212
     C                     ENDIF                                                              CSW212
      *                                                                                       CSW212
      ** Set standard message text                                                            CSW212
      *                                                                                       CSW212
     C                     MOVEL'MEC2311' E#MSGD                                              CSW212
     C                     MOVEL'Y'       W#MSTX                                              CSW212
      *                                                                                       CSW212
     C                     ENDIF                                                              CSW212
     C                     ENDIF                                                              CSW212
      *                                                                                       CSW212
     C                     SELEC                                          CSW005
     C           PMCPGM    WHEQ 'FRIR'                                    CSW005
     C           PMCPGM    OREQ 'FXFX'                                                        CSW212
     C           CSW212    ANDEQ'Y'                                                           CSW212
     C                     MOVEL'SD2400'  E#CPGM                          CSW005
     C           PMCPGM    WHEQ 'SSI '                                    CSW005
     C**********           MOVEL'SD0402R' E#CPGM                                     CSW005 AR992011
     C                     MOVELPMDPGM    E#CPGM                                            AR992011
     C           E#CPGM    IFNE 'SD0402R'                                                   AR992011
     C                     MOVEL*BLANKS   I#BTB                                             AR992011
     C                     ENDIF                                                            AR992011
     C                     OTHER                                          CSW005
     C                     MOVEL'ME9950'  E#CPGM                          CSW005
     C                     ENDSL                                          CSW005
      *                                                                   CSW005
      * Set standard message text                                         CSW005
     C           W#MSTX    IFNE 'Y'                                                           CSW212
     C                     MOVEL'MEC0201' E#MSGD                          CSW005
     C                     ENDIF                                                              CSW212
     C                     MOVEL'MEMSG'   E#MSGF                          CSW005
      *                                                                   CSW005
     C                     CALL 'ME9950'                                  CSW005
     C                     PARM           W0RTN   7                       CSW005
     C                     PARM           I#PARM           I Input Parms  CSW005
     C                     PARM           O#PARM           O Output Parms CSW005
     C                     PARM           E#PARM           E Error Inform CSW005
     C                     PARM           Z#PARM256        B User Defined CSW005
      *                                                                   CSW005
      * On return if errors copy into error array                         CSW005
      *                                                                   CSW005
     C                     MOVELO#BTB1    SDDSR1                          CSW005
     C                     MOVELO#BTB2    SDDSR2                          CSW005
     C                     MOVELO#BTB3    SDDSR3                          CSW005
     C                     MOVELO#BTB4    SDDSR4                          CSW005
     C                     MOVELO#BTB5    SDDSR5                          CSW005
     C                     MOVELO#BTB6    SDDSR6                          CSW005
      *                                                                   CSW005
      ** Subtract 1 from error array index                                CSW005
     C                     SUB  1         E#INDX                          CSW005
      *                                                                   CSW005
     C           E#WARN    IFEQ 'Y'                                                           CSW214
     C           CSW214    IFEQ 'Y'                                                           CSW214
     C           O#E,1     IFEQ '899'                                                         CSW214
     C                     MOVE '899'     ERCD,S                                              CSW214
     C                     ADD  1         S                                                   CSW214
     C                     ENDIF                                                              CSW214
     C                     ENDIF                                                              CSW214
     C                     ENDIF                                                              CSW214
      *                                                                                       CSW214
     C           E#ERRM    IFNE *BLANKS                                   CSW005
     C                     MOVE 'X01'     ERCD,S                          CSW005
     C                     ADD  1         S                               CSW005
     C                     ENDIF                                          CSW005
     C*                                                                   CSW005
     C**  Settlement/Reset Confirmation Sender to Receiver                CSW005
     C*                                                                   CSW005
     C                     CLEARI#PARM                                    CSW005
     C                     CLEARE#PARM                                    CSW005
     C                     CLEARO#PARM                                    CSW005
     C*                                                                   CSW005
     C                     MOVEL':72: '   I#VFLD    P                     CSW005
     C                     MOVELPMTTYP    I#TTYP                          CSW005
     C                     MOVEL*BLANKS   W#MSTX                                              CSW212
     C           CSW212    IFEQ 'Y'                                                           CSW212
     C           I#TTYP    IFEQ 'AT'                                                          CSW212
     C           I#TTYP    OREQ 'FX'                                                          CSW212
     C           I#TTYP    OREQ 'OP'                                                          CSW212
     C           I#TTYP    OREQ 'FF'                                                          CSW212
     C           I#TTYP    OREQ 'CL'                                                          CSW212
     C           CDL008    ANDEQ'Y'                                                           CSW212
     C                     MOVEL'DL'      I#MMOD                                              CSW212
     C                     MOVELPMCVMR    I#COVR                                              CSW212
     C                     MOVELPMPSTM    I#PSTM                                              CSW212
     C                     MOVEL'MEC2312' E#MSGD                                              CSW212
     C                     MOVEL'Y'       W#MSTX                                              CSW212
     C           I#TTYP    IFNE 'AT'                                                          CSW212
     C           I#TTYP    OREQ 'AT'                                                          CSW212
     C           CSW005    ANDEQ'N'                                                           CSW212
     C           CSW011    ANDEQ'N'                                                           CSW212
     C                     MOVEL'300'     I#MTYP                                              CSW212
     C                     ENDIF                                                              CSW212
      *                                                                                       CMG003
      ** Set Message Type to '600' if CMG003 is ON                                            CMG003
      ** and Precious Metal Ind of the currency is Y                                          CMG003
      *                                                                                       CMG003
     C           CMG003    IFEQ 'Y'                                                           CMG003
     C                     MOVELPMPCCY    I#PCCY                                              CMG003
     C                     CALL 'AOCURRR0'                                                    CMG003
     C                     PARM *BLANKS   PRTCD                                               CMG003
     C                     PARM '*KEY   ' POPTN                                               CMG003
     C                     PARM I#PCCY    PCURR                                               CMG003
     C           SDCURR    PARM SDCURR    DSSDY                                               CMG003
      *                                                                                       CMG003
     C           PRTCD     IFEQ *BLANKS                                                       CMG003
     C           A6PMRT    ANDEQ'Y'                                                           CMG003
     C                     MOVEL'600'     I#MTYP                                              CMG003
     C                     ENDIF                                                              CMG003
     C                     ENDIF                                                              CMG003
      *                                                                                       CMG003
     C**********           ENDIF                                                     CSW212 MD022522
     C                     ELSE                                                               CSW212
     C                     MOVEL'FI'      I#MMOD                          CSW005
     C                     ENDIF                                                              CSW212
     C                     ENDIF                                                            MD022522
     C           PMAWBN    IFNE *BLANKS                                   CSW005
     C                     MOVEL'X'       I#AWBT                          CSW005
     C                     MOVELPMAWBN    I#AWBK                          CSW005
     C                     ENDIF                                          CSW005
     C                     MOVELSDSSR1    I#BTB1                          CSW005
     C                     MOVELSDSSR2    I#BTB2                          CSW005
     C                     MOVELSDSSR3    I#BTB3                          CSW005
     C                     MOVELSDSSR4    I#BTB4                          CSW005
     C                     MOVELSDSSR5    I#BTB5                          CSW005
     C                     MOVELSDSSR6    I#BTB6                          CSW005
      *                                                                   CSW005
     C                     SELEC                                          CSW005
     C           PMCPGM    WHEQ 'FRIR'                                    CSW005
     C           PMCPGM    OREQ 'FXFX'                                                        CSW212
     C           CSW212    ANDEQ'Y'                                                           CSW212
     C                     MOVEL'SD2400'  E#CPGM                          CSW005
     C           PMCPGM    WHEQ 'SSI '                                    CSW005
     C**********           MOVEL'SD0402R' E#CPGM                                     CSW005 AR992011
     C                     MOVELPMDPGM    E#CPGM                                            AR992011
     C           E#CPGM    IFNE 'SD0402R'                                                   AR992011
     C                     MOVEL*BLANKS   I#BTB                                             AR992011
     C                     ENDIF                                                            AR992011
     C                     OTHER                                          CSW005
     C                     MOVEL'ME9950'  E#CPGM                          CSW005
     C                     ENDSL                                          CSW005
      *                                                                   CSW005
      * Set standard message text                                         CSW005
     C           W#MSTX    IFNE 'Y'                                                           CSW212
     C                     MOVEL'MEC0202' E#MSGD                          CSW005
     C                     ENDIF                                                              CSW212
     C                     MOVEL'MEMSG'   E#MSGF                          CSW005
      *                                                                   CSW005
     C                     CALL 'ME9950'                                  CSW005
     C                     PARM           W0RTN   7                       CSW005
     C                     PARM           I#PARM           I Input Parms  CSW005
     C                     PARM           O#PARM           O Output Parms CSW005
     C                     PARM           E#PARM           E Error Inform CSW005
     C                     PARM           Z#PARM256        B User Defined CSW005
      *                                                                   CSW005
      * On return if errors copy into error array                         CSW005
      *                                                                   CSW005
     C                     MOVELO#BTB1    SDSSR1                          CSW005
     C                     MOVELO#BTB2    SDSSR2                          CSW005
     C                     MOVELO#BTB3    SDSSR3                          CSW005
     C                     MOVELO#BTB4    SDSSR4                          CSW005
     C                     MOVELO#BTB5    SDSSR5                          CSW005
     C                     MOVELO#BTB6    SDSSR6                          CSW005
      *                                                                   CSW005
      ** Subtract 1 from error array index                                CSW005
     C                     SUB  1         E#INDX                          CSW005
      *                                                                   CSW005
     C           E#WARN    IFEQ 'Y'                                                           CSW214
     C           CSW214    IFEQ 'Y'                                                           CSW214
     C           O#E,1     IFEQ '899'                                                         CSW214
     C                     MOVE '899'     ERCD,S                                              CSW214
     C                     ADD  1         S                                                   CSW214
     C                     ENDIF                                                              CSW214
     C                     ENDIF                                                              CSW214
     C                     ENDIF                                                              CSW214
      *                                                                                       CSW214
     C           E#ERRM    IFNE *BLANKS                                   CSW005
     C                     MOVE 'X02'     ERCD,S                          CSW005
     C                     ADD  1         S                               CSW005
     C                     ENDIF                                          CSW005
     C*                                                                   CSW005
     C**  Conditions                                                      CSW005
     C*                                                                   CSW005
     C**     Condition 1 mandatory if Agreement type is 'OTHER'           CSW005
     C*                                                                   CSW005
     C           PMTTYP    IFEQ 'RS'                                      CSW005
     C           PMTTYP    OREQ 'RX'                                      CSW005
     C           PMTTYP    OREQ 'DV'                                                         BUG7139
     C           CDL031    ANDEQ'Y'                                                          BUG7139
     C           PMCPGM    OREQ 'SSI '                                    CSW005
     C           PMTTYP    ANDEQ'AT'                                      CSW005
     C           CSW005    ANDEQ'Y'                                       CSW011
     C           PMTTYP    OREQ 'AT'                                                          CSW212
     C           CSW212    ANDEQ'Y'                                                           CSW212
     C           PMTTYP    OREQ 'FX'                                                          CSW212
     C           CSW212    ANDEQ'Y'                                                           CSW212
     C           PMTTYP    OREQ 'OP'                                                          CSW212
     C           CSW212    ANDEQ'Y'                                                           CSW212
     C           PMTTYP    OREQ 'FF'                                                          CSW212
     C           CSW212    ANDEQ'Y'                                                           CSW212
     C           PMTTYP    OREQ 'CL'                                                          CSW212
     C           CDL008    ANDEQ'Y'                                                           CSW212
     C           CSW212    ANDEQ'Y'                                                           CSW212
     C           SDAGTY    IFEQ 'OTHER'                                   CSW005
     C           SDCND1    ANDEQ*BLANKS                                   CSW005
     C                     MOVE '400'     ERCD,S                          CSW005
     C                     ADD  1         S                               CSW005
     C                     ENDIF                                          CSW005
     C                     ENDIF                                          CSW005
     C*                                                                   CSW005
     C**     Other validation                                             CSW005
     C*                                                                   CSW005
     C                     CLEARI#PARM                                    CSW005
     C                     CLEARE#PARM                                    CSW005
     C                     CLEARO#PARM                                    CSW005
      * Set standard message text                                         CSW005
     C                     MOVEL'MEC0203' E#MSGD                          CSW005
     C                     MOVEL'MEMSG'   E#MSGF                          CSW005
     C*                                                                   CSW005
     C                     MOVEL':77D:'   I#VFLD    P                     CSW005
     C                     MOVELPMTTYP    I#TTYP    P                     CSW005
     C                     MOVEL'FI'      I#MMOD                          CSW005
     C           CSW212    IFEQ 'Y'                                                           CSW212
     C           I#TTYP    IFEQ 'AT'                                                          CSW212
     C           I#TTYP    OREQ 'FX'                                                          CSW212
     C           I#TTYP    OREQ 'OP'                                                          CSW212
     C           I#TTYP    OREQ 'FF'                                                          CSW212
     C           I#TTYP    OREQ 'CL'                                                          CSW212
     C           CDL008    ANDEQ'Y'                                                           CSW212
     C                     MOVEL'DL'      I#MMOD                                              CSW212
     C                     MOVEL'300'     I#MTYP                                              CSW213
     C           CSW213    IFEQ 'Y'                                                           CSW213
     C                     MOVELPMPCCY    I#PCCY                                              CSW213
     C                     CALL 'AOCURRR0'                                                    CSW213
     C                     PARM '       ' PRTCD                                               CSW213
     C                     PARM '*KEY   ' POPTN                                               CSW213
     C                     PARM I#PCCY    PCURR                                               CSW213
     C           SDCURR    PARM SDCURR    DSSDY                                               CSW213
     C           PRTCD     IFEQ *BLANKS                                                       CSW213
     C           A6PMRT    IFEQ 'Y'                                                           CSW213
     C                     MOVEL'600'     I#MTYP                                              CSW213
     C                     ENDIF                                                              CSW213
     C                     ENDIF                                                              CSW213
     C                     ENDIF                                                              CSW213
     C                     ENDIF                                                              CSW212
     C                     ENDIF                                                              CSW212
     C                     MOVELSDCND1    I#BTB1                          CSW005
     C                     MOVELSDCND2    I#BTB2                          CSW005
     C                     MOVELSDCND3    I#BTB3                          CSW005
     C                     MOVELSDCND4    I#BTB4                          CSW005
     C                     MOVELSDCND5    I#BTB5                          CSW005
     C                     MOVELSDCND6    I#BTB6                          CSW005
      *                                                                   CSW005
     C                     SELEC                                          CSW005
     C           PMCPGM    WHEQ 'FRIR'                                    CSW005
     C           PMCPGM    OREQ 'FXFX'                                                        CSW212
     C           CSW212    ANDEQ'Y'                                                           CSW212
     C                     MOVEL'SD2400'  E#CPGM                          CSW005
     C           PMCPGM    WHEQ 'SSI '                                    CSW005
     C**********           MOVEL'SD0402R' E#CPGM                                     CSW005 AR992011
     C                     MOVELPMDPGM    E#CPGM                                            AR992011
     C           E#CPGM    IFNE 'SD0402R'                                                   AR992011
     C                     MOVEL*BLANKS   I#BTB                                             AR992011
     C                     ENDIF                                                            AR992011
     C                     OTHER                                          CSW005
     C                     MOVEL'ME9950'  E#CPGM                          CSW005
     C                     ENDSL                                          CSW005
      *                                                                   CSW005
     C                     CALL 'ME9960'                                  CSW005
     C                     PARM           W0RTN   7                       CSW005
     C                     PARM           I#PARM           I Input Parms  CSW005
     C                     PARM           O#PARM           O Output Parms CSW005
     C                     PARM           E#PARM           E Error Inform CSW005
     C                     PARM           Z#PARM256        B User Defined CSW005
      *                                                                   CSW005
      * On return if errors copy into error array                         CSW005
      *                                                                   CSW005
     C                     MOVELO#BTB1    SDCND1                          CSW005
     C                     MOVELO#BTB2    SDCND2                          CSW005
     C                     MOVELO#BTB3    SDCND3                          CSW005
     C                     MOVELO#BTB4    SDCND4                          CSW005
     C                     MOVELO#BTB5    SDCND5                          CSW005
     C                     MOVELO#BTB6    SDCND6                          CSW005
      *                                                                   CSW005
      ** Subtract 1 from error array index                                CSW005
     C                     SUB  1         E#INDX                          CSW005
      *                                                                   CSW005
     C           E#ERRM    IFNE *BLANKS                                   CSW005
     C           1         DO   E#INDX    Q#      50                      CSW005
     C                     MOVEAO#E,Q#    ERCD,S                          CSW005
     C                     ADD  1         S                               CSW005
     C                     ENDDO                                          CSW005
     C                     ENDIF                                          CSW005
     C*                                                                   CSW005
     C           PMTTYP    IFEQ 'RS'                                      CSW005
     C           PMTTYP    OREQ 'RX'                                      CSW005
     C           PMTTYP    OREQ 'DV'                                                         BUG7139
     C           CDL031    ANDEQ'Y'                                                          BUG7139
     C           PMTTYP    OREQ 'FR'                                      CSW097
     C           PMCPGM    OREQ 'SSI '                                    CSW005
     C           PMTTYP    ANDEQ'AT'                                      CSW005
     C           CSW005    ANDEQ'Y'                                       CSW011
     C           PMCPGM    OREQ 'SSI '                                    CSW200
     C           PMTTYP    ANDEQ'AT'                                      CSW200
     C           CSW011    ANDEQ'Y'                                       CSW200
     C           CSW200    ANDEQ'Y'                                       CSW200
     C           PMTTYP    OREQ 'AT'                                                          CSW212
     C           CSW212    ANDEQ'Y'                                                           CSW212
     C           PMTTYP    OREQ 'FX'                                                          CSW212
     C           CSW212    ANDEQ'Y'                                                           CSW212
     C           PMTTYP    OREQ 'OP'                                                          CSW212
     C           CSW212    ANDEQ'Y'                                                           CSW212
     C           PMTTYP    OREQ 'FF'                                                          CSW212
     C           CSW212    ANDEQ'Y'                                                           CSW212
     C           PMTTYP    OREQ 'CL'                                                          CSW212
     C           CDL008    ANDEQ'Y'                                                           CSW212
     C           CSW212    ANDEQ'Y'                                                           CSW212
      *                                                                                       CSW214
      ** ISDA Agreement Type is mandatory for MT600                                           CSW214
      *                                                                                       CSW214
     C           CSW214    IFEQ 'Y'                                                           CSW214
     C           I#MTYP    ANDEQ'600'                                                         CSW214
     C           SDAGTY    ANDEQ*BLANKS                                                       CSW214
     C                     MOVE '422'     ERCD,S                                              CSW214
     C                     ADD  1         S                                                   CSW214
     C                     ENDIF                                                              CSW214
      **********                                                                   MD030342 MD030943
      ***Valid*values*for*Agreement*type*for*MT600*                                MD030342 MD030943
      **********                                                                   MD030342 MD030943
     C********** I#MTYP    IFEQ '600'                                              MD030342 MD030943
     C********** SDAGTY    ANDNE*BLANKS                                            MD030342 MD030943
     C********** SDAGTY    IFNE 'ISDA'                                             MD030342 MD030943
     C********** SDAGTY    ANDNE'OTHER'                                            MD030342 MD030943
     C**********           MOVE '423'     ERCD,S                                   MD030342 MD030943
     C**********           ADD  1         S                                        MD030342 MD030943
     C**********           ENDIF                                                   MD030342 MD030943
     C**********           ENDIF                                                   MD030342 MD030943
      **********                                                                   MD030342 MD030943
     C*                                                                   CSW005
     C           PMTTYP    IFEQ 'RS'                                      CSW097
     C           PMTTYP    OREQ 'RX'                                      CSW097
     C           PMTTYP    OREQ 'DV'                                                         BUG7139
     C           CDL031    ANDEQ'Y'                                                          BUG7139
     C           PMTTYP    OREQ 'AT'                                      CSW097
     C           CSW005    ANDEQ'Y'                                       CSW200
     C*                                                                   CSW097
     C**  Allow all blank entry for type AT only                          CSW097
     C*                                                                   CSW097
     C           SDISDA    IFNE *BLANKS                                   CSW097
     C           SDAGTY    ORNE *BLANKS                                   CSW097
     C           SDAGDT    ORNE *BLANKS                                   CSW097
     C           SDAGVV    ORNE *BLANKS                                   CSW097
     C           PMTTYP    OREQ 'RS'                                      CSW097
     C           PMTTYP    OREQ 'RX'                                      CSW097
     C           PMTTYP    OREQ 'DV'                                                         BUG7139
     C           CDL031    ANDEQ'Y'                                                          BUG7139
     C*                                                                   CSW097
     C**  ISDA Rules version must be numeric                              CSW005
     C**  RS/RX                                                           CSW097
     C*                                                                   CSW005
     C           SDAGTY    IFNE 'ISDA'                                    CSW097
     C           SDAGTY    ANDNE'OTHER'                                   CSW097
     C           SDISDA    IFNE *BLANKS                                   CSW097
     C           SDISDA    ANDNE'0000'                                    CSW097
     C                     MOVE '407'     ERCD,S                          CSW097
     C                     ADD  1         S                               CSW097
     C                     ENDIF                                          CSW097
     C                     ENDIF                                          CSW097
     C*                                                                   CSW097
     C           SDAGTY    IFEQ 'ISDA'                                    CSW097
     C           SDAGTY    OREQ 'OTHER'                                   CSW097
     C           SDISDA    ANDNE*BLANKS                                   CSW097
     C                     MOVE '0'       WISDA   5                       CSW097
     C                     MOVELSDISDA    WISDA                           CSW097
     C                     TESTN          WISDA      60                   CSW097
     C***********          TESTN          SDISDA     60            CSW005 CSW097
     C*                                                                   CSW097
     C           *IN60     IFEQ *OFF                                      CSW005
     C           SDISDA    OREQ *ZEROS                                    CSW097
     C           SDAGTY    ANDEQ'ISDA'                                    CSW097
     C                     MOVE '406'     ERCD,S                          CSW005
     C                     ADD  1         S                               CSW005
     C                     ENDIF                                          CSW005
     C                     ENDIF                                          CSW097
     C*                                                                   CSW005
      ** If CSW201 is on, SDISDA may accept '2000'.                                           CSW201
      *                                                                                       CSW201
     C           CSW201    IFEQ 'Y'                                                           CSW201
     C           SDISDA    ANDEQ'2000'                                                        CSW201
     C                     MOVE 'Y'       WY2000  1                                           CSW201
     C                     ELSE                                                               CSW201
     C                     MOVE 'N'       WY2000                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C           CSW200    IFEQ 'Y'                                       CSW200
     C           SDAGTY    ANDEQ'ISDA'                                    CSW200
      *                                                                   CSW200
     C           SDISDA    IFNE '1991'                                    CSW200
     C           SDISDA    ANDNE'1998'                                    CSW200
     C           WY2000    ANDNE'Y'                                                           CSW201
     C           SDISDA    ANDNE'2006'                                                        254023
     C***********          MOVE '414'     ERCD,S                                       CSW200 CSW201
     C**********           MOVE '417'     ERCD,S                                       CSW201 254023
     C                     MOVE '414'     ERCD,S                                              254023
     C                     ADD  1         S                               CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
     C**  Agreement Type                                                  CSW005
     C**  RS/RX                                                           CSW097
     C*                                                                   CSW005
     C           SDAGTY    IFNE 'ISDA  '                                  CSW005
     C           SDAGTY    ANDNE'AFB   '                                  CSW005
     C           SDAGTY    ANDNE'BBAIRS'                                  CSW005
     C           SDAGTY    ANDNE'ISDACN'                                                      CSW214
     C           SDAGTY    ANDNE'OTHER '                                  CSW005
     C           SDAGTY    ANDNE'DERV  '                                                      CSW202
     C           SDAGTY    OREQ 'DERV  '                                                      CSW202
     C           CSW202    ANDEQ'N'                                                           CSW202
     C           SDAGTY    OREQ 'ISDACN'                                                      CSW214
     C           CSW214    ANDEQ'N'                                                           CSW214
      *                                                                                      MD26990
     C           CSW005    IFEQ 'Y'                                                          MD26990
     C           CSW005    ORNE 'Y'                                                          MD26990
     C           SDAGTY    ANDNE*BLANK                                                       MD26990
     C                     MOVE '401'     ERCD,S                          CSW005
     C                     ADD  1         S                               CSW005
     C                     ENDIF                                                             MD26990
      *                                                                                      MD26990
     C                     ENDIF                                          CSW005
     C*                                                                   CSW005
     C**  Agreement Date                                                  CSW005
     C**  RS/RX                                                           CSW097
     C*                                                                   CSW005
     C***********SDAGTY    IFEQ 'OTHER'                            CSW005 CSW097
     C           SDAGTY    IFEQ 'BBAIRS'                                  CSW097
     C           SDAGDT    IFNE *BLANKS                                   CSW005
     C                     MOVE '402'     ERCD,S                          CSW005
     C                     ADD  1         S                               CSW005
     C                     ENDIF                                          CSW005
     C*                                                                   CSW005
     C                     ELSE                                           CSW005
     C*                                                                   CSW097
     C           SDAGTY    IFEQ 'OTHER'                                   CSW097
     C           SDAGDT    ANDNE*BLANKS                                   CSW097
     C           SDAGTY    OREQ 'OTHER'                                   CSW097
     C           SDAGVV    ANDNE*BLANKS                                   CSW097
     C           SDAGDT    ANDEQ*BLANKS                                   CSW097
     C           SDAGTY    ORNE 'OTHER'                                   CSW097
     C*                                                                   CSW097
     C**  Input date must be in YYMMDD format                             CSW005
     C**  RS/RX                                                           CSW097
     C                     MOVE '0'       WAGDT   7                       CSW097
     C                     MOVELSDAGDT    WAGDT                           CSW097
     C                     TESTN          WAGDT      60                   CSW097
     C***********          TESTN          SDAGDT     60            CSW005 CSW097
     C*                                                                   CSW005
     C           *IN60     IFEQ *ON                                       CSW005
     C                     MOVE *OFF      *IN98                           CSW005
     C                     MOVE *OFF      *IN99                           CSW005
     C                     MOVELSDAGDT    W#AGDT                          CSW005
     C                     Z-ADDDD        WDD                             CSW005
     C                     Z-ADDMM        WMM                             CSW005
     C                     Z-ADDYY        WYY                             CSW005
     C                     MOVELWWAGDT    ZDATE                           CSW005
     C                     EXSR ZDATE1                                    CSW005
     C                     ENDIF                                          CSW005
     C*********************ENDIF                                   CSW005 CSW097
     C*                                                                   CSW005
     C           *IN60     IFEQ *OFF                                      CSW005
     C           *IN99     OREQ *ON                                       CSW005
      *                                                                                      MD26990
     C           CSW005    IFEQ 'Y'                                                          MD26990
     C           CSW005    ORNE 'Y'                                                          MD26990
     C           SDAGDT    ANDNE*BLANK                                                       MD26990
     C                     MOVE '403'     ERCD,S                          CSW005
     C                     ADD  1         S                               CSW005
     C                     ENDIF                                                             MD26990
      *                                                                                      MD26990
     C                     ENDIF                                          CSW005
     C                     ENDIF                                          CSW097
     C                     ENDIF                                          CSW097
     C*                                                                   CSW005
     C**  Agreement Version                                               CSW005
     C**  RS/RX                                                           CSW097
     C*                                                                   CSW005
     C***********SDAGTY    IFEQ 'OTHER''                            CSW005CSW097
     C           SDAGTY    IFEQ 'BBAIRS'                                  CSW097
     C           SDAGVV    IFNE *BLANKS                                   CSW005
     C                     MOVE '404'     ERCD,S                          CSW005
     C                     ADD  1         S                               CSW005
     C                     ENDIF                                          CSW005
     C*                                                                   CSW097
     C                     ELSE                                           CSW005
     C*                                                                   CSW097
     C           SDAGTY    IFEQ 'OTHER'                                   CSW097
     C           SDAGVV    ANDNE*BLANKS                                   CSW097
     C           SDAGTY    OREQ 'OTHER'                                   CSW097
     C           SDAGDT    ANDNE*BLANKS                                   CSW097
     C           SDAGVV    ANDEQ*BLANKS                                   CSW097
     C           SDAGTY    ORNE 'OTHER'                                   CSW097
     C*                                                                   CSW097
     C                     MOVE '0'       WAGVV   5                       CSW097
     C                     MOVELSDAGVV    WAGVV                           CSW097
     C                     TESTN          WAGVV      60                   CSW097
     C***********          TESTN          SDAGVV     60            CSW005 CSW097
     C           *IN60     IFEQ *OFF                                      CSW005
     C           SDAGVV    OREQ *ZEROS                                    CSW097
      *                                                                                      MD26990
     C           CSW005    IFEQ 'Y'                                                          MD26990
     C           CSW005    ORNE 'Y'                                                          MD26990
     C           SDAGVV    ANDNE*BLANK                                                       MD26990
     C                     MOVE '405'     ERCD,S                          CSW005
     C                     ADD  1         S                               CSW005
     C                     ENDIF                                                             MD26990
      *                                                                                      MD26990
     C                     ENDIF                                          CSW005
     C                     ENDIF                                          CSW005
     C*                                                                   CSW005
     C                     ENDIF                                          CSW005
     C                     ENDIF                                          CSW005
     C***********          ENDIF                                   CSW005 CSW097
     C*                                                                   S01117
     C                     ELSE                                           CSW097
     C*                                                                   CSW097
     C           PMTTYP    IFEQ 'FR'                                      CSW097
     C           PMTTYP    OREQ 'AT'                                      CSW200
     C           CSW011    ANDEQ'Y'                                       CSW200
     C           CSW200    ANDEQ'Y'                                       CSW200
     C           PMTTYP    OREQ 'AT'                                                          CSW212
     C           CSW212    ANDEQ'Y'                                                           CSW212
     C           PMTTYP    OREQ 'FX'                                                          CSW212
     C           CSW212    ANDEQ'Y'                                                           CSW212
     C           PMTTYP    OREQ 'OP'                                                          CSW212
     C           CSW212    ANDEQ'Y'                                                           CSW212
     C           PMTTYP    OREQ 'FF'                                                          CSW212
     C           CSW212    ANDEQ'Y'                                                           CSW212
     C           PMTTYP    OREQ 'CL'                                                          CSW212
     C           CDL008    ANDEQ'Y'                                                           CSW212
     C           CSW212    ANDEQ'Y'                                                           CSW212
     C*                                                                   CSW097
     C**  Validate ISDA fields for FR type agreement                      CSW097
     C*                                                                   CSW097
     C**  Allow all blank entry                                           CSW097
     C*                                                                   CSW097
     C           SDISDA    IFNE *BLANKS                                   CSW097
     C           SDAGTY    ORNE *BLANKS                                   CSW097
     C           SDAGDT    ORNE *BLANKS                                   CSW097
     C           SDAGVV    ORNE *BLANKS                                   CSW097
     C*                                                                   CSW097
     C**  FR ISDA Rules version must be numeric                           CSW097
     C*                                                                   CSW097
     C           SDAGTY    IFNE 'ISDA'                                    CSW097
     C           SDISDA    IFNE *BLANKS                                   CSW097
     C           SDISDA    ANDNE'0000'                                    CSW097
     C                     MOVE '408'     ERCD,S                          CSW097
     C                     ADD  1         S                               CSW097
     C                     ENDIF                                          CSW097
     C                     ENDIF                                          CSW097
     C           SDAGTY    IFEQ 'ISDA'                                    CSW097
     C                     MOVE '0'       WISDA   5                       CSW097
     C                     MOVELSDISDA    WISDA                           CSW097
     C                     TESTN          WISDA      60                   CSW097
     C           *IN60     IFEQ *OFF                                      CSW097
     C           SDISDA    OREQ *ZEROS                                    CSW097
     C                     MOVE '406'     ERCD,S                          CSW097
     C                     ADD  1         S                               CSW097
     C                     ENDIF                                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                                       CSW201
      ** If CSW201 is on, SDISDA may accept '2000'.                                           CSW201
      *                                                                                       CSW201
     C           CSW201    IFEQ 'Y'                                                           CSW201
     C           SDISDA    ANDEQ'2000'                                                        CSW201
     C                     MOVE 'Y'       WY2000                                              CSW201
     C                     ELSE                                                               CSW201
     C                     MOVE 'N'       WY2000                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                   CSW200
     C           CSW200    IFEQ 'Y'                                       CSW200
     C           SDAGTY    ANDEQ'ISDA'                                    CSW200
      *                                                                   CSW200
     C           SDISDA    IFNE '1991'                                    CSW200
     C           SDISDA    ANDNE'1998'                                    CSW200
     C           WY2000    ANDNE'Y'                                                           CSW201
     C           SDISDA    ANDNE'2006'                                                        254023
     C***********          MOVE '414'     ERCD,S                                       CSW200 CSW201
     C**********           MOVE '417'     ERCD,S                                       CSW201 254023
     C                     MOVE '414'     ERCD,S                                              254023
     C                     ADD  1         S                               CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
     C                     ENDIF                                          CSW200
      *                                                                                       CSW212
     C           CSW212    IFEQ 'Y'                                                           CSW212
     C           SDISDA    ANDNE*BLANKS                                                       CSW212
     C           PMTTYP    IFEQ 'AT'                                                          CSW212
     C           PMTTYP    OREQ 'FX'                                                          CSW212
     C           PMTTYP    OREQ 'OP'                                                          CSW212
     C           PMTTYP    OREQ 'FF'                                                          CSW212
     C           PMTTYP    OREQ 'CL'                                                          CSW212
     C           CDL008    ANDEQ'Y'                                                           CSW212
      *                                                                                       CSW212
      ** ISDA rule version must be valid year starting with 199 or 20'                        CSW212
      *                                                                                       CSW212
     C                     MOVELSDISDA    ISDA3   3                                           CSW212
     C                     MOVELSDISDA    ISDA2   2                                           CSW212
     C           ISDA3     IFNE '199'                                                         CSW212
     C           ISDA2     ANDNE'20'                                                          CSW212
     C                     MOVE '418'     ERCD,S                                              CSW212
     C                     ADD  1         S                                                   CSW212
     C                     ENDIF                                                              CSW212
     C                     ENDIF                                                              CSW212
     C                     ENDIF                                                              CSW212
     C*                                                                   CSW097
     C**  FR Agreement Type                                               CSW097
     C*                                                                   CSW097
     C           PMTTYP    IFEQ 'AT'                                                          CSW212
     C           CSW212    ANDEQ'Y'                                                           CSW212
     C           PMTTYP    OREQ 'FX'                                                          CSW212
     C           CSW212    ANDEQ'Y'                                                           CSW212
     C           PMTTYP    OREQ 'OP'                                                          CSW212
     C           CSW212    ANDEQ'Y'                                                           CSW212
     C           PMTTYP    OREQ 'FF'                                                          CSW212
     C           CSW212    ANDEQ'Y'                                                           CSW212
     C           PMTTYP    OREQ 'CL'                                                          CSW212
     C           CDL008    ANDEQ'Y'                                                           CSW212
     C           CSW212    ANDEQ'Y'                                                           CSW212
      *                                                                                       CSW212
      ** Valid Codes for Agreement type                                                       CSW212
      *                                                                                       CSW212
     C           SDAGTY    IFNE *BLANKS                                                       CSW212
     C           I#MTYP    IFEQ '600'                                                       MD030943
     C           SDAGTY    IFNE 'ISDA'                                                      MD030943
     C           SDAGTY    ANDNE'OTHER'                                                     MD030943
     C                     MOVE '423'     ERCD,S                                            MD030943
     C                     ADD  1         S                                                 MD030943
     C                     ENDIF                                                            MD030943
     C                     ELSE                                                             MD030943
     C           SDAGTY    IFNE 'AFB'                                                         CSW212
     C           SDAGTY    ANDNE'DERV'                                                        CSW212
     C           SDAGTY    ANDNE'FBF'                                                         CSW212
     C           SDAGTY    ANDNE'FEOMA'                                                       CSW212
     C           SDAGTY    ANDNE'ICOM'                                                        CSW212
     C           SDAGTY    ANDNE'IFEMA'                                                       CSW212
     C           SDAGTY    ANDNE'ISDA'                                                        CSW212
     C           SDAGTY    ANDNE'ISDACN'                                                      CSW214
     C           SDAGTY    ANDNE'OTHER'                                                       CSW212
     C           SDAGTY    OREQ 'ISDACN'                                                      CSW214
     C           CSW214    ANDEQ'N'                                                           CSW214
     C                     MOVE '419'     ERCD,S                                              CSW212
     C                     ADD  1         S                                                   CSW212
     C                     ENDIF                                                              CSW212
     C                     ENDIF                                                            MD030943
     C                     ELSE                                                               CSW212
      *                                                                                       CSW212
      ***Mandatory*if*ISDA*agreement*date*and*version*is*inserted                    CSW212 AR992011
      ** Mandatory if any of the ISDA agreement date or                                     AR992011
      ** version or ISDA rules version is inserted                                          AR992011
      *                                                                                       CSW212
     C           SDAGDT    IFNE *BLANKS                                                       CSW212
     C********** SDAGVV    ANDNE*BLANKS                                              CSW212 AR992011
     C           SDAGVV    ORNE *BLANKS                                                     AR992011
     C           SDISDA    ORNE *BLANKS                                                     AR992011
     C                     MOVE '420'     ERCD,S                                              CSW212
     C                     ADD  1         S                                                   CSW212
     C                     ENDIF                                                              CSW212
     C                     ENDIF                                                              CSW212
      *                                                                                       CSW212
     C                     ELSE                                                               CSW212
     C           SDAGTY    IFNE 'ISDA'                                    CSW097
     C           SDAGTY    ANDNE'AFB'                                     CSW097
     C           SDAGTY    ANDNE'DERV'                                    CSW200
     C           SDAGTY    ANDNE'EMA'                                                         CSW214
     C           SDAGTY    ANDNE'FRABBA'                                  CSW200
     C           SDAGTY    ANDNE'ISDACN'                                                      CSW214
     C           SDAGTY    ANDNE'OTHER'                                                       CSW214
     C           SDAGTY    OREQ 'DERV'                                    CSW200
     C           CSW200    ANDEQ'N'                                       CSW200
     C           SDAGTY    OREQ 'FRABBA'                                  CSW200
     C           CSW200    ANDEQ'N'                                       CSW200
     C           SDAGTY    OREQ 'ISDACN'                                                      CSW214
     C           CSW214    ANDEQ'N'                                                           CSW214
     C                     MOVE '409'     ERCD,S                          CSW097
     C                     ADD  1         S                               CSW097
     C                     ENDIF                                          CSW097
     C                     ENDIF                                                              CSW212
     C*                                                                   CSW097
     C**  FR Agreement Date                                               CSW097
     C*                                                                   CSW097
     C           CSW212    IFNE 'Y'                                                           CSW212
     C           CSW200    IFEQ 'Y'                                       CSW200
     C           SDAGTY    ANDEQ'FRABBA'                                  CSW200
     C           SDAGDT    ANDNE*BLANKS                                   CSW200
     C                     MOVE '415'     ERCD,S                          CSW200
     C                     ADD  1         S                               CSW200
     C                     ENDIF                                          CSW200
     C                     ENDIF                                                              CSW212
      *                                                                   CSW200
     C           SDAGDT    IFNE *BLANKS                                                       CSW212
     C           CSW200    IFEQ 'Y'                                       CSW200
     C           SDAGDT    ANDNE*BLANKS                                   CSW200
     C           CSW200    OREQ 'N'                                       CSW200
     C           PMTTYP    OREQ 'AT'                                                          CSW212
     C           CSW212    ANDEQ'Y'                                                           CSW212
     C           PMTTYP    OREQ 'FX'                                                          CSW212
     C           CSW212    ANDEQ'Y'                                                           CSW212
     C           PMTTYP    OREQ 'OP'                                                          CSW212
     C           CSW212    ANDEQ'Y'                                                           CSW212
     C           PMTTYP    OREQ 'FF'                                                          CSW212
     C           CSW212    ANDEQ'Y'                                                           CSW212
     C           PMTTYP    OREQ 'CL'                                                          CSW212
     C           CDL008    ANDEQ'Y'                                                           CSW212
     C           CSW212    ANDEQ'Y'                                                           CSW212
      *                                                                   CSW200
     C**  FR Input date, must be in YYMMDD format                         CSW097
     C*                                                                   CSW097
     C                     MOVE '0'       WAGDT   7                       CSW097
     C                     MOVELSDAGDT    WAGDT                           CSW097
     C                     TESTN          WAGDT      60                   CSW097
     C           *IN60     IFEQ *ON                                       CSW097
     C                     MOVE *OFF      *IN98                           CSW097
     C                     MOVE *OFF      *IN99                           CSW097
     C                     MOVELSDAGDT    W#AGDT                          CSW097
     C                     Z-ADDDD        WDD                             CSW097
     C                     Z-ADDMM        WMM                             CSW097
     C                     Z-ADDYY        WYY                             CSW097
     C                     MOVELWWAGDT    ZDATE                           CSW097
     C                     EXSR ZDATE1                                    CSW097
     C                     ENDIF                                          CSW097
     C*                                                                   CSW097
     C           *IN60     IFEQ *OFF                                      CSW097
     C           *IN99     OREQ *ON                                       CSW097
     C                     MOVE '403'     ERCD,S                          CSW097
     C                     ADD  1         S                               CSW097
     C                     ENDIF                                          CSW097
     C                     ENDIF                                          CSW200
     C                     ENDIF                                                              CSW212
     C*                                                                   CSW097
     C**  FR Agreement Version                                            CSW097
     C*                                                                   CSW097
     C           CSW200    IFEQ 'Y'                                       CSW200
     C           SDAGTY    ANDEQ'FRABBA'                                  CSW200
     C           SDAGVV    ANDNE*BLANKS                                   CSW200
     C                     MOVE '416'     ERCD,S                          CSW200
     C                     ADD  1         S                               CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
     C           SDAGVV    IFNE *BLANKS                                                       CSW212
     C           CSW200    IFEQ 'Y'                                       CSW200
     C           SDAGVV    ANDNE*BLANKS                                   CSW200
     C           CSW200    OREQ 'N'                                       CSW200
     C           PMTTYP    OREQ 'AT'                                                          CSW212
     C           CSW212    ANDEQ'Y'                                                           CSW212
     C           PMTTYP    OREQ 'FX'                                                          CSW212
     C           CSW212    ANDEQ'Y'                                                           CSW212
     C           PMTTYP    OREQ 'OP'                                                          CSW212
     C           CSW212    ANDEQ'Y'                                                           CSW212
     C           PMTTYP    OREQ 'FF'                                                          CSW212
     C           CSW212    ANDEQ'Y'                                                           CSW212
     C           PMTTYP    OREQ 'CL'                                                          CSW212
     C           CDL008    ANDEQ'Y'                                                           CSW212
     C           CSW212    ANDEQ'Y'                                                           CSW212
      *                                                                   CSW200
     C                     MOVE '0'       WAGVV   5                       CSW097
     C                     MOVELSDAGVV    WAGVV                           CSW097
     C                     TESTN          WAGVV      60                   CSW097
     C           *IN60     IFEQ *OFF                                      CSW097
     C           SDAGVV    OREQ *ZEROS                                    CSW097
     C                     MOVE '405'     ERCD,S                          CSW097
     C                     ADD  1         S                               CSW097
     C                     ENDIF                                          CSW097
     C*                                                                   CSW097
     C                     ENDIF                                          CSW200
     C                     ENDIF                                                              CSW212
     C*                                                                   CSW200
     C                     ENDIF                                          CSW097
     C*                                                                   CSW097
     C                     ENDIF                                          CSW097
     C*                                                                   CSW097
     C                     ENDIF                                          CSW097
     C*                                                                   CSW097
     C                     ENDIF                                          CSW097
     C*                                                                   CSW097
     C                     ENDIF                                          CSW097
     C*                                                                   S01408
     C/COPY WNCPYSRC,SD2410CVS4                                           S01408
     C*                                                                   S01408
     C*
     C           PAYEND    TAG                                                                221452
      *                                                                                       CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
     C           PMCPGM    ANDEQ'LEND'                                                        CLE031
      *                                                                                       CLE031
     C                     MOVE 'N'       FLDERR                                              CLE031
      *                                                                                       CLE031
     C                     MOVE *BLANKS   ZFIELD                                              CLE031
     C                     MOVE PMREXR    ZFIELD                                              CLE031
     C                     Z-ADD5         ZADIG                                               CLE031
     C                     Z-ADD8         ZADEC                                               CLE031
      *                                                                                       CLE031
     C                     CALL 'ZALIGN'                                                      CLE031
     C                     PARM *BLANK    PRTCD                                               CLE031
     C                     PARM           ZFIELD                                              CLE031
     C                     PARM           ZADEC                                               CLE031
     C                     PARM           ZADIG                                               CLE031
     C                     PARM *BLANKS   ZAVAL                                               CLE031
      *                                                                                       CLE031
     C                     MOVE ZAVAL     WMREXR 140                                          CLE031
      *                                                                                       CLE031
     C                     MOVE *BLANKS   ZFIELD                                              CLE031
     C                     MOVE PMPEXR    ZFIELD                                              CLE031
     C                     Z-ADD5         ZADIG                                               CLE031
     C                     Z-ADD8         ZADEC                                               CLE031
      *                                                                                       CLE031
     C                     CALL 'ZALIGN'                                                      CLE031
     C                     PARM *BLANK    PRTCD                                               CLE031
     C                     PARM           ZFIELD                                              CLE031
     C                     PARM           ZADEC                                               CLE031
     C                     PARM           ZADIG                                               CLE031
     C                     PARM *BLANKS   ZAVAL                                               CLE031
      *                                                                                       CLE031
     C                     MOVE ZAVAL     WMPEXR 140                                          CLE031
      *                                                                                       CLE031
     C           ARINCY    IFNE 'Y'                                                           CLE031
      *                                                                                       CLE031
     C           PMRSCY    IFEQ *BLANKS                                                       CLE031
     C           PMREXR    ANDNE*BLANKS                                                       CLE031
     C           WMREXR    ANDNE*ZEROS                                                        CLE031
     C           PMRSCY    OREQ *BLANKS                                                       CLE031
     C           PMREXI    ANDNE*BLANKS                                                       CLE031
     C                     MOVE '801'     ERCD,S                                              CLE031
     C                     ADD  1         S                                                   CLE031
     C                     MOVE '1'       *IN08                                               CLE031
     C                     MOVE 'Y'       FLDERR  1                                           CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C           PMRCCY    IFEQ BKEURO                                                        CLE031
     C           BRINCY    ANDEQ'Y'                                                           CLE031
     C           PMRCCY    OREQ BKEURO                                                        CLE031
     C           PMRSCY    ANDEQBKEURO                                                        CLE031
      *                                                                                       CLE031
     C           PMREXR    IFNE *BLANKS                                                       CLE031
     C           WMREXR    ANDNE*ZEROS                                                        CLE031
     C           PMREXI    ORNE *BLANKS                                                       CLE031
     C                     MOVE '802'     ERCD,S                                              CLE031
     C                     ADD  1         S                                                   CLE031
     C                     MOVE '1'       *IN08                                               CLE031
     C                     ENDIF                                                              CLE031
     C                     MOVE 'Y'       FLDERR                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C           ARINCY    IFNE 'Y'                                                           CLE031
     C           PMRCCY    ANDNEBKEURO                                                        CLE031
     C           PMRSCY    ANDNE*BLANKS                                                       CLE031
     C           BRINCY    ANDEQ'Y'                                                           CLE031
     C                     MOVE '810'     ERCD,S                                              CLE031
     C                     ADD  1         S                                                   CLE031
     C                     MOVE '1'       *IN08                                               CLE031
     C                     MOVE 'Y'       FLDERR                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C           PMPRCV    IFNE 'Y'                                                           219495
     C           PMACTC    OREQ 'X'                                                           219495
     C           PMRSCY    IFNE *BLANKS                                                       CLE031
     C           BRDLCI    ANDNE'Y'                                                           CLE031
     C                     MOVE '812'     ERCD,S                                              CLE031
     C                     ADD  1         S                                                   CLE031
     C                     MOVE '1'       *IN08                                               CLE031
     C                     MOVE 'Y'       FLDERR                                              CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              219495
      *                                                                                       CLE031
     C           PMRSCY    IFEQ PMRCCY                                                        CLE031
     C           PMRSCY    ANDNE*BLANKS                                                       CLE031
     C                     MOVE '814'     ERCD,S                                              CLE031
     C                     ADD  1         S                                                   CLE031
     C                     MOVE '1'       *IN08                                               CLE031
     C                     MOVE 'Y'       FLDERR                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C           FLDERR    IFEQ 'N'                                                           CLE031
     C                     MOVEL*BLANKS   ZMDIX                                               CLE031
     C           PMREXR    IFEQ *BLANKS                                                       CLE031
     C           WMREXR    OREQ *ZEROS                                                        CLE031
     C           PMRSCY    IFNE *BLANKS                                                       CLE031
     C           CLE033    IFEQ 'Y'                                                           221891
     C           SET09     ANDEQ'T'                                                           221891
     C           PMRSTM    ANDEQ09                                                            221891
      *                                                                                       221891
      ** Do not want exchange rate default in these circumstances                             221891
      *                                                                                       221891
     C                     ELSE                                                               221891
      *                                                                                       CLE031
      ** Calculate cross rate from Receive Ccy to Receive Sett Ccy                            CLE031
      *                                                                                       CLE031
     C                     Z-ADDARSPRT    ZRATE1                                              CLE031
     C                     MOVELARMDIN    ZMDI1                                               CLE031
     C                     Z-ADDAMREXR    ZRATE2                                              CLE031
     C                     MOVELAMREXI    ZMDI2                                               CLE031
     C                     EXSR ZXRATE                                                        CLE031
     C                     MOVE ZRATEX    PMREXC 14                                           CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              221891
      *                                                                                       CLE031
     C                     ELSE                                                               CLE031
      *                                                                                       CLE031
     C                     MOVE *BLANKS   ZFIELD                                              CLE031
     C                     MOVE PMREXR    ZFIELD 16                                           CLE031
     C                     Z-ADD5         ZADIG   20                                          CLE031
     C                     Z-ADD8         ZADEC   10                                          CLE031
      *                                                                                       CLE031
     C                     CALL 'ZALIGN'                                                      CLE031
     C                     PARM *BLANK    PRTCD                                               CLE031
     C                     PARM           ZFIELD                                              CLE031
     C                     PARM           ZADEC                                               CLE031
     C                     PARM           ZADIG                                               CLE031
     C                     PARM *BLANKS   ZAVAL  16                                           CLE031
      *                                                                                       CLE031
     C           PRTCD     IFNE *BLANK                                                        CLE031
     C                     MOVE '865'     ERCD,S                                              CLE031
     C                     ADD  1         S                                                   CLE031
     C                     MOVE '1'       *IN08                                               CLE031
     C                     ELSE                                                               CLE031
     C                     MOVE ZAVAL     PMREXC                                              CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C           PRTCD     IFEQ *BLANKS                                                       CLE031
     C           PMREXC    ANDNE*BLANKS                                                       CLE031
     C           PMRSCY    ANDNE*BLANKS                                                       CLE031
     C                     MOVE *BLANKS   ZFIELD                                              CLE031
     C                     MOVE PMREXC    ZFIELD                                              CLE031
     C                     Z-ADD8         ZADEC                                               CLE031
     C                     EXSR ZEDIT                                                         CLE031
     C                     MOVE ZFIELD    PMREXR                                              CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C           FLDERR    IFEQ 'N'                                                           CLE031
     C           PMREXI    IFNE *BLANKS                                                       CLE031
     C           PMREXI    ANDNE'M'                                                           CLE031
     C           PMREXI    ANDNE'D'                                                           CLE031
     C                     MOVE '878'     ERCD,S                                              CLE031
     C                     ADD  1         S                                                   CLE031
     C                     MOVE '1'       *IN08                                               CLE031
     C                     ELSE                                                               CLE031
      *                                                                                       CLE031
     C           PMREXI    IFEQ *BLANKS                                                       CLE031
     C           CLE033    IFEQ 'Y'                                                           221891
     C           SET09     ANDEQ'T'                                                           221891
     C           PMRSTM    ANDEQ09                                                            221891
      *                                                                                       221891
      ** Do not want multiply/divide ind default in these circumstances                       221891
      *                                                                                       221891
     C                     ELSE                                                               221891
     C           ZMDIX     IFNE *BLANKS                                                       CLE031
     C                     MOVELZMDIX     PMREXI                                              CLE031
     C                     ELSE                                                               CLE031
     C                     MOVE AMREXI    PMREXI                                              CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              221891
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     ELSE                                                               CLE031
     C           PMREXR    IFNE *BLANKS                                                       CLE031
     C           WMREXR    ANDNE*ZEROS                                                        CLE031
     C           PMREXI    ORNE *BLANKS                                                       CLE031
     C                     MOVE '802'     ERCD,S                                              CLE031
     C                     ADD  1         S                                                   CLE031
     C                     MOVE '1'       *IN08                                               CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     MOVE 'N'       FLDERR                                              CLE031
     C           APINCY    IFNE 'Y'                                                           CLE031
      *                                                                                       CLE031
     C           PMPSCY    IFEQ *BLANKS                                                       CLE031
     C           PMPEXR    ANDNE*BLANKS                                                       CLE031
     C           WMPEXR    ANDNE*ZEROS                                                        CLE031
     C           PMPSCY    OREQ *BLANKS                                                       CLE031
     C           PMPEXI    ANDNE*BLANKS                                                       CLE031
     C                     MOVE '808'     ERCD,S                                              CLE031
     C                     ADD  1         S                                                   CLE031
     C                     MOVE '1'       *IN11                                               CLE031
     C                     MOVE 'Y'       FLDERR  1                                           CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C           PMPCCY    IFEQ BKEURO                                                        CLE031
     C           BPINCY    ANDEQ'Y'                                                           CLE031
     C           PMPCCY    OREQ BKEURO                                                        CLE031
     C           PMPSCY    ANDEQBKEURO                                                        CLE031
      *                                                                                       CLE031
     C           PMPEXR    IFNE *BLANKS                                                       CLE031
     C           WMPEXR    ANDNE*ZEROS                                                        CLE031
     C           PMPEXI    ORNE *BLANKS                                                       CLE031
     C                     MOVE '809'     ERCD,S                                              CLE031
     C                     ADD  1         S                                                   CLE031
     C                     MOVE '1'       *IN11                                               CLE031
     C                     ENDIF                                                              CLE031
     C                     MOVE 'Y'       FLDERR                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C           APINCY    IFNE 'Y'                                                           CLE031
     C           PMPCCY    ANDNEBKEURO                                                        CLE031
     C           PMPSCY    ANDNE*BLANKS                                                       CLE031
     C           BPINCY    ANDEQ'Y'                                                           CLE031
     C                     MOVE '811'     ERCD,S                                              CLE031
     C                     ADD  1         S                                                   CLE031
     C                     MOVE '1'       *IN11                                               CLE031
     C                     MOVE 'Y'       FLDERR                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C           PMPPAY    IFNE 'Y'                                                           219495
     C           PMACTC    OREQ 'X'                                                           219495
     C           PMPSCY    IFNE *BLANKS                                                       CLE031
     C           BPDLCI    ANDNE'Y'                                                           CLE031
     C                     MOVE '813'     ERCD,S                                              CLE031
     C                     ADD  1         S                                                   CLE031
     C                     MOVE '1'       *IN11                                               CLE031
     C                     MOVE 'Y'       FLDERR                                              CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              219495
      *                                                                                       CLE031
     C           PMPSCY    IFEQ PMPCCY                                                        CLE031
     C           PMPSCY    ANDNE*BLANKS                                                       CLE031
     C                     MOVE '815'     ERCD,S                                              CLE031
     C                     ADD  1         S                                                   CLE031
     C                     MOVE '1'       *IN11                                               CLE031
     C                     MOVE 'Y'       FLDERR                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C           FLDERR    IFEQ 'N'                                                           CLE031
     C                     MOVEL*BLANKS   ZMDIX                                               CLE031
     C           PMPEXR    IFEQ *BLANKS                                                       CLE031
     C           WMPEXR    OREQ *ZEROS                                                        CLE031
     C           PMPSCY    IFNE *BLANKS                                                       CLE031
     C           CLE033    IFEQ 'Y'                                                           221891
     C           SET09     ANDEQ'T'                                                           221891
     C           PMPSTM    ANDEQ09                                                            221891
      *                                                                                       221891
      ** Do not want exchange rate default in these circumstances                             221891
      *                                                                                       221891
     C                     ELSE                                                               221891
      *                                                                                       CLE031
      ** Calculate cross rate from Pay Ccy to Pay Sett Ccy                                    CLE031
      *                                                                                       CLE031
     C                     Z-ADDAPSPRT    ZRATE1                                              CLE031
     C                     MOVELAPMDIN    ZMDI1                                               CLE031
     C                     Z-ADDAMPEXR    ZRATE2                                              CLE031
     C                     MOVELAMPEXI    ZMDI2                                               CLE031
     C                     EXSR ZXRATE                                                        CLE031
     C                     MOVE ZRATEX    PMPEXC 14                                           CLE031
     C                     ENDIF                                                              221891
     C                     ENDIF
      *
     C                     ELSE                                                               CLE031
      *                                                                                       CLE031
     C                     MOVE *BLANKS   ZFIELD                                              CLE031
     C                     MOVE PMPEXR    ZFIELD                                              CLE031
     C                     Z-ADD5         ZADIG                                               CLE031
     C                     Z-ADD8         ZADEC                                               CLE031
      *                                                                                       CLE031
     C                     CALL 'ZALIGN'                                                      CLE031
     C                     PARM *BLANK    PRTCD                                               CLE031
     C                     PARM           ZFIELD                                              CLE031
     C                     PARM           ZADEC                                               CLE031
     C                     PARM           ZADIG                                               CLE031
     C                     PARM *BLANKS   ZAVAL                                               CLE031
      *                                                                                       CLE031
     C           PRTCD     IFNE *BLANKS                                                       CLE031
     C                     MOVE '866'     ERCD,S                                              CLE031
     C                     ADD  1         S                                                   CLE031
     C                     MOVE '1'       *IN11                                               CLE031
     C                     ELSE                                                               CLE031
     C                     MOVE ZAVAL     PMPEXC                                              CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C           PRTCD     IFEQ *BLANKS                                                       CLE031
     C           PMPEXC    ANDNE*BLANKS                                                       CLE031
     C           PMPSCY    ANDNE*BLANKS                                                       CLE031
     C                     MOVE *BLANKS   ZFIELD                                              CLE031
     C                     MOVE PMPEXC    ZFIELD                                              CLE031
     C                     Z-ADD8         ZADEC                                               CLE031
     C                     EXSR ZEDIT                                                         CLE031
     C                     MOVE ZFIELD    PMPEXR                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C           FLDERR    IFEQ 'N'                                                           CLE031
     C           PMPEXI    IFNE *BLANKS                                                       CLE031
     C           PMPEXI    ANDNE'M'                                                           CLE031
     C           PMPEXI    ANDNE'D'                                                           CLE031
     C                     MOVE '880'     ERCD,S                                              CLE031
     C                     ADD  1         S                                                   CLE031
     C                     MOVE '1'       *IN11                                               CLE031
     C                     ELSE                                                               CLE031
      *                                                                                       CLE031
     C           PMPEXI    IFEQ *BLANKS                                                       CLE031
     C           CLE033    IFEQ 'Y'                                                           221891
     C           SET09     ANDEQ'T'                                                           221891
     C           PMPSTM    ANDEQ09                                                            221891
      *                                                                                       221891
      ** Do not want multiply/divide ind default in these circumstances                       221891
      *                                                                                       221891
     C                     ELSE                                                               221891
     C           ZMDIX     IFNE *BLANKS                                                       CLE031
     C                     MOVELZMDIX     PMPEXI                                              CLE031
     C                     ELSE                                                               CLE031
     C                     MOVE AMPEXI    PMPEXI                                              CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              221891
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     ELSE                                                               CLE031
     C           PMPEXR    IFNE *BLANKS                                                       CLE031
     C           WMPEXR    ANDNE*ZEROS                                                        CLE031
     C           PMPEXI    ORNE *BLANKS                                                       CLE031
     C                     MOVE '809'     ERCD,S                                              CLE031
     C                     ADD  1         S                                                   CLE031
     C                     MOVE '1'       *IN11                                               CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     MOVE *ZEROS    AMPEXR                                              CLE031
     C                     MOVE *BLANKS   AMPEXI                                              CLE031
     C                     MOVE *BLANKS   AMREXI                                              CLE031
     C                     MOVE *ZEROS    AMREXR                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C           V01END    ENDSR
     C/EJECT
      *************************************************************************               CDL094
     C** CHRBTB - Validation of Bank to Bank Information (Receive Instructions)               CDL094
      *************************************************************************               CDL094
     C           CHRBTB    BEGSR                                                              CDL094
      *                                                                                       CDL094
      ** Must be blank if settlement type is '00'                                             CDL094
     C           PMRSTM    IFEQ 00                                                            CDL094
      *                                                                                       CDL094
     C           PMRBB1    IFNE *BLANKS                                                       CDL094
     C           PMRBB2    ORNE *BLANKS                                                       CDL094
     C           PMRBB3    ORNE *BLANKS                                                       CDL094
     C           PMRBB4    ORNE *BLANKS                                                       CDL094
     C           PMRBB5    ORNE *BLANKS                                                       CDL094
     C           PMRBB6    ORNE *BLANKS                                                       CDL094
     C                     MOVE 'R88'     ERCD,S                                              CDL094
     C                     ADD  1         S                                                   CDL094
     C                     MOVE '1'       *IN30                                               CDL094
     C                     ENDIF                                                              CDL094
     C                     ENDIF                                                              CDL094
      *                                                                                       CDL094
      * Call Bank to Bank Validation object
      * Set up parameters                                                                     CDL094
      *                                                                                       CDL094
     C                     MOVE *BLANKS   W0RTN                                               CDL094
     C                     CLEARI#PARM                                                        CDL094
      * Set up Control fields                                                                 CDL094
     C                     MOVEL':72: '   I#VFLD                                              CDL094
     C                     MOVEL'PAY'     I#PR                                                CDL094
      * Set up Currency fields                                                                CDL094
     C                     MOVELWRECY     I#PCCY                                              CDL094
     C                     MOVELWPECY     I#RCCY                                              CDL094
      * Set up Intermediary (From the screen)                                                 CDL094
     C           PMRIBN    IFNE *BLANKS                                                       CDL094
     C                     MOVEL'X'       I#INBT                                              CDL094
     C                     MOVELPMRIBN    I#INBK                                              CDL094
     C                     ENDIF                                                              CDL094
      * Set up Intermediary (If defined for the Receive Nostro)                               CDL094
     C           A7RF56    IFNE *BLANKS                                                       CDL094
     C                     MOVEL'X'       I#INBT                                              CDL094
     C                     MOVELA7RF56    I#INBK                                              CDL094
     C                     ENDIF                                                              CDL094
      * Set up Account with Bank (If defined for the Receive Nostro)                          CDL094
     C           A7RF57    IFNE *BLANKS                                                       CDL094
     C                     MOVEL'X'       I#AWBT                                              CDL094
     C                     MOVELA7RF57    I#AWBK                                              CDL094
     C                     ENDIF                                                              CDL094
      * Set up Beneficiary (If defined for the Receive Nostro and not FX Deal)                CDL094
     C           A7RF58    IFNE *BLANKS                                                       CDL094
     C           PMCPGM    ANDNE'FXDL'                                                        CDL094
     C                     MOVEL'X'       I#BENT                                              CDL094
     C                     MOVELA7RF58    I#BENF                                              CDL094
     C                     ENDIF                                                              CDL094
      * Move in Bank to Bank Information                                                      CDL094
     C                     MOVELPMRBB1    I#BTB1                                              CDL094
     C                     MOVELPMRBB2    I#BTB2                                              CDL094
     C                     MOVELPMRBB3    I#BTB3                                              CDL094
     C                     MOVELPMRBB4    I#BTB4                                              CDL094
     C                     MOVELPMRBB5    I#BTB5                                              CDL094
     C                     MOVELPMRBB6    I#BTB6                                              CDL094
      *                                                                                       CDL094
      * Set up Account Information (As ME9950 validates BTB Info based on                     CDL094
      * Pay side details, switch fields and move receive details to Pay                       CDL094
      * parameters and pay details to Receive parameters)                                     CDL094
      * Set up pay account information in Receipt parameters                                  CDL094
     C           PMPONS    IFNE *BLANKS                                                       CDL094
     C                     SELEC                                                              CDL094
     C           PMPOBR    WHNE *BLANKS                                                       CDL094
     C           PMPONS    CAT  PMPOBR    I#RCAC                                              CDL094
     C           PMPONS    WHNE *BLANKS                                                       CDL094
     C                     MOVELPMPONS    I#RCAC                                              CDL094
     C                     ENDSL                                                              CDL094
     C                     ENDIF                                                              CDL094
      * Set up Receive account information in Pay paremeters                                  CDL094
     C           PMPONS    IFNE *BLANKS                                                       CDL094
     C                     SELEC                                                              CDL094
     C           PMPOBR    WHNE *BLANKS                                                       CDL094
     C           PMPONS    CAT  PMPOBR    I#PYAC                                              CDL094
     C           PMPONS    WHNE *BLANKS                                                       CDL094
     C                     MOVELPMPONS    I#PYAC                                              CDL094
     C                     ENDSL                                                              CDL094
     C                     ENDIF                                                              CDL094
      * If extra message and Rec Corr. then set 5354 field                                    CDL094
     C           PMRVNO    IFNE *BLANKS                                                       CDL094
     C           PMRCRN    ANDNE*BLANKS                                                       CDL094
     C                     MOVEL'Y'       I#5354                                              CDL094
     C                     ENDIF                                                              CDL094
      * Transaction Type                                                                      CDL094
     C                     MOVELPMTTYP    I#TTYP                                              CDL094
     C                     MOVELPMRSTM    I#PSTM                                              CDL094
      *                                                                                       CDL094
     C                     CLEARO#PARM                                                        CDL094
     C                     CLEARE#PARM                                                        CDL094
      * Send messages to correct calling process                                              CDL094
     C                     SELEC                                                              CDL094
     C           PMCPGM    WHEQ 'SSI '                                                        CDL094
     C                     MOVEL'SD0401R' E#CPGM                                              CDL094
     C                     MOVEL'AT'      I#MMOD                                              CDL094
     C                     OTHER                                                              CDL094
     C                     MOVEL'ME9950'  E#CPGM                                              CDL094
     C                     ENDSL                                                              CDL094
      * Set standard message text                                                             CDL094
     C                     MOVEL'MEC0114' E#MSGD                                              CDL094
     C                     MOVEL'MEMSG'   E#MSGF                                              CDL094
      *                                                                                       CDL094
     C                     CALL 'ME9950'                                                      CDL094
     C                     PARM           W0RTN                                               CDL094
     C                     PARM           I#PARM                                              CDL094
     C                     PARM           O#PARM                                              CDL094
     C                     PARM           E#PARM                                              CDL094
     C                     PARM           Z#PARM256                                           CDL094
      *                                                                                       CDL094
      * On return if errors copy into error array                                             CDL094
      *                                                                                       CDL094
     C                     MOVELO#BTB1    PMRBB1                                              CDL094
     C                     MOVELO#BTB2    PMRBB2                                              CDL094
     C                     MOVELO#BTB3    PMRBB3                                              CDL094
     C                     MOVELO#BTB4    PMRBB4                                              CDL094
     C                     MOVELO#BTB5    PMRBB5                                              CDL094
     C                     MOVELO#BTB6    PMRBB6                                              CDL094
      *                                                                                       CDL094
      ** Subtract 1 from error array index                                                    CDL094
     C                     SUB  1         E#INDX                                              CDL094
      *                                                                                       CDL094
     C           E#ERRM    IFNE *BLANKS                                                       CDL094
      *                                                                                       CDL094
     C           1         DO   E#INDX    Q#      50                                          CDL094
     C                     MOVEAO#E,Q#    ERB1                                                CDL094
     C           ER2A      IFEQ '99'                                                          CDL094
     C                     MOVEL'RR'      ERB1                                                CDL094
     C                     ELSE                                                               CDL094
     C                     MOVEL'R'       ERB1                                                CDL094
     C                     ENDIF                                                              CDL094
     C                     MOVE ERB1      ERCD,S                                              CDL094
     C                     ADD  1         S                                                   CDL094
     C                     ENDDO                                                              CDL094
      *                                                                                       CDL094
      * Mark receive side as in error                                                         CDL094
     C                     MOVEL*ON       *IN30                                               CDL094
      *                                                                                       CDL094
     C                     ENDIF                                                              CDL094
     C                     ENDSR                                                              CDL094
     C/EJECT                                                                                  CDL094
     C/COPY WNCPYSRC,SD2410C021
     C*****************************************************************
     C*
     C* SR TO DETERMINE WETHER THE CONTENTS OF THE FIELD CHKFLD IS:
     C*   A: A LIVE RECORD ON SDCUSTPD
     C*   B: A CUSTOMER SHORTNAME
     C*   C: A COUNTERPARTY NOSTRO CODE
     C*
     C* CALLED BY : SR V01
     C* CALLS     :
     C*
     C* PARAMETERS:
     C*      INPUT :CHKFLD(10A)
     C*      OUTPUT:RESULT(1A) CONTENTS: A = CUSTOMER NUMBER
     C*                                  B = CUSTOMER SHORTNAME
     C*                                  C = COUNTERPARTY NOSTRO CODE
     C*                                  E = ERROR (NON OF ABOVE)
     C*              BANKNB(1A)      BLANK = NO LIVE RECORD ON SDCUSTPD
     C*                                  B = BANK
     C*                                  N = NON-BANK
     C           CHKFL     BEGSR
     C/COPY WNCPYSRC,SD2410C036
      *
     C                     MOVE *BLANK    RESULT  1
     C                     MOVE *BLANK    BANKNB  1
     C                     MOVE *BLANKS   RTCD    7
     C                     MOVEL'*KEY   ' OPTN
     C                     MOVE *BLANKS   KEY1   10
     C                     MOVE *BLANKS   KYST    7
     C                     MOVE *BLANKS   CBNB    8
      *
     C** CHECK FOR CUSTOMER NUMBER OR SHORTNAME
     C                     MOVELCHKFLD    KEY1
     C                     CALL 'AOCUSTR0'             90
     C                     PARM           RTCD
     C                     PARM           OPTN
     C                     PARM           KEY1
     C                     PARM           KYST
     C***********CURF      PARM CURF      DSSDY                    S01194 S01117
     C           CURF      PARM *BLANKS   DSSDY                           S01117
     C***********          PARM           CURF                            S01194
      *
     C           *IN90     IFEQ '1'
     C                     MOVEL'CUST '   PMDBFL           **************
     C*****                MOVEL'SDKUUPR' PMDPGM           ** DBASE 02 ** S01227
     C                     MOVEL'SD2410'  PMDPGM           ** DBASE 02 ** S01227
     C                     Z-ADD2         PMDBSE           **************
     C                     SETON                     U7U8LR
     C                     MOVE 'T'       PMTERM
     C                     RETRN
     C                     END
     C           RTCD      IFEQ *BLANKS
     C           KYST      IFEQ '*CNUM  '
     C                     MOVE 'A'       RESULT
     C                     ELSE
     C                     MOVE 'B'       RESULT
     C                     END
     C*                                                                   S01408
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,SD2410CVSF                                           S01408
     C*                                                                   S01408
     C** TEST FOR BANK/NON-BANK WHEN LIVE CUSTOMER FOUND
     C********** BBBNBI    IFNE 'Y'                                       099441
     C           BBSWFI    IFNE 'Y'                                       099441
     C                     MOVE 'N'       BANKNB
     C                     ELSE
     C                     MOVE 'B'       BANKNB
     C                     END
     C                     MOVE BBCSID    SWFT
     C                     Z-ADDBBFWCD    FEDW
     C** ELSE: NO VALID CUSTOMER NUMBER OR SHORTNAME RETURNED
     C**       CHECK FOR NOSTRO
     C                     ELSE
      *                                                                   S01117
      ** Only check for Nostro if result is allowed to be a               S01117
      ** counterparty nostro shortname.                                   S01117
      *                                                                   S01117
     C           @CPNA     IFEQ 'Y'                                       S01117
      *                                                                   S01117
     C                     MOVE *BLANKS   RTCD
     C                     MOVE '*KEY   ' OPTN
     C                     MOVELCHKFLD    CBNB
      *
     C                     CALL 'AOCNSTR0'             90
     C                     PARM           RTCD
     C                     PARM           OPTN
     C                     PARM           CBNB
     C***********ALRF      PARM ALRF      DSFDY                    S01194 S01117
     C           ALRF      PARM *BLANKS   DSFDY                           S01117
     C***********          PARM           ALRF                            S01194
      *
     C           *IN90     IFEQ '1'
     C                     MOVEL'CNST '   PMDBFL           **************
     C*****                MOVEL'SDKUUPR' PMDPGM           ** DBASE 03 ** S01227
     C                     MOVEL'SD2410'  PMDPGM           ** DBASE 03 ** S01227
     C                     Z-ADD3         PMDBSE           **************
     C                     SETON                     U7U8LR
     C                     MOVE 'T'       PMTERM
     C                     RETRN
     C                     END
     C           RTCD      IFEQ *BLANKS
     C                     MOVE 'C'       RESULT
     C                     MOVE AWSWID    SWFT   11
     C                     Z-ADDAWFWCD    FEDW    90
     C** ELSE: NO VALID COUNTERPARTY RETURNED
     C                     ELSE
     C                     MOVE 'E'       RESULT
     C                     END
      *                                                                   S01117
     C** ELSE: NO RECORD FOUND.                                           S01117
     C                     ELSE                                           S01117
     C                     MOVE 'E'       RESULT                          S01117
      *                                                                   S01117
     C                     END                                            S01117
      *                                                                   S01117
     C                     END
     C                     ENDSR
     C/EJECT
     C*****************************************************************
     C*
     C* SR TO ACCESS A RECORD ON THE FILE ACCNTAB
     C*
     C* CALLED BY : SR V01
     C* CALLS     :
     C*
     C* PARAMETERS:
     C*      INPUT :STANDARD FOR ACCESS OBJECT AOACCTV0
     C*      OUTPUT:STANDARD FOR ACCESS OBJECT AOACCTV0
     C           CHKAC     BEGSR
      *
     C                     MOVE *BLANKS   RTCD             *1
      *
     C                     CALL 'AOACCTV0'             90  *1
      *
     C                     PARM           RTCD             *1
     C                     PARM           ACID             *1
     C                     PARM           CUCD             *1
     C                     PARM           ACCD             *1
     C                     PARM           ACSQA            *1
     C                     PARM           BRCD    3        *1             S01117
     C                     PARM           TYPE    7        *1
     C                     PARM           NOSN    2        *1
     C***********ACCT      PARM ACCT      DSSDY            *1      S01194 S01117
     C           ACCT      PARM *BLANKS   DSSDY            *1             S01117
     C***********          PARM           ACCT             *1             S01194
      *
     C           *IN90     IFEQ '1'
     C                     MOVEL'ACCTV'   PMDBFL           **************
     C*****                MOVEL'SDKUUPR' PMDPGM           ** DBASE 04 ** S01227
     C                     MOVEL'SD2410'  PMDPGM           ** DBASE 04 ** S01227
     C                     Z-ADD4         PMDBSE           **************
     C                     MOVE 'T'       PMTERM
     C                     SETON                     U7U8LR
     C                     RETRN
     C                     END
     C                     ENDSR
     C/EJECT
     C*****************************************************************
     C*
     C* SR TO ACCESS A RECORD ON THE FILE SDNOSTPD
     C*
     C* CALLED BY : SR V01
     C* CALLS     :
     C*
     C* PARAMETERS:
     C*      INPUT :STANDARD FOR ACCESS OBJECT AONOSTR0
     C*      OUTPUT:STANDARD FOR ACCESS OBJECT AONOSTR0
     C           CHKNO     BEGSR
      *
     C                     MOVE *BLANKS   RTCD
      *
     C**********           CALL 'AONOSTR0'             90                                     CDL094
     C                     CALL 'AONOSTR1'             90                                     CDL094
      *
     C                     PARM           RTCD
     C                     PARM           OPTN
     C                     PARM *BLANKS   @CUST   6                       S01194
     C                     PARM           @CYCD   3                       S01194
     C**********           PARM *BLANKS   @ACCD   4                                    S01194 CGL029
     C                     PARM *BLANKS   @ACCD  10                                           CGL029
     C                     PARM *BLANKS   @ACSN   2                       S01194
     C                     PARM           @NONB   2                       S01194
     C                     PARM *BLANKS   @BRCD   3                       S01194
     C                     PARM *BLANKS   @CSSN  10                       S01194
     C                     PARM *BLANKS   @PNOI   1                       S01194
     C***********A7RF      PARM A7RF      DSFDY                    S01194 S01117
     C********** A7RF      PARM *BLANKS   DSFDY                                        S01117 CDL094
     C           A7RF      PARM *BLANKS   DSSDY                                               CDL094
     C***********          PARM           A7RF                            S01194
     C*                                                                   DT0069
     C** Set flag to indicate that value came from Nostros file.          DT0069
     C                     MOVE 'Y'       @NOST   1                       DT0069
      *
     C           *IN90     IFEQ '1'
     C                     MOVEL'NOSTR'   PMDBFL           **************
     C*****                MOVEL'SDKUUPR' PMDPGM           ** DBASE 05 ** S01227
     C                     MOVEL'SD2410'  PMDPGM           ** DBASE 05 ** S01227
     C                     Z-ADD5         PMDBSE           **************
     C                     SETON                     U7U8LR
     C                     MOVE 'T'       PMTERM
     C                     RETRN
     C                     END
     C                     ENDSR
     C/EJECT
     C*****************************************************************
     C*
     C* SR TO ACCESS A RECORD ON THE FILE SDCCSYPD
     C*
     C* CALLED BY : SR V01
     C* CALLS     :
     C*
     C* PARAMETERS:
     C*      INPUT :STANDARD FOR ACCESS OBJECT AOCCSYR0
     C*      OUTPUT:STANDARD FOR ACCESS OBJECT AOCCSYR0
     C           CHKCY     BEGSR
      *
     C                     MOVE *BLANKS   RTCD
     C                     MOVE '*VERIFY' OPTN
      *
     C                     CALL 'AOCCSYR0'             90
      *
     C                     PARM           RTCD
     C                     PARM           OPTN
     C                     PARM           KEYY
     C                     PARM           KEYZ
     C***********DMRF      PARM DMRF      DSFDY                    S01194 S01117
     C           DMRF      PARM *BLANKS   DSFDY                           S01117
     C***********          PARM           DMRF                            S01194
      *
     C           *IN90     IFEQ '1'
     C                     MOVEL'CCSY'    PMDBFL           **************
     C*****                MOVEL'SDKUUPR' PMDPGM           ** DBASE 06 ** S01227
     C                     MOVEL'SD2410'  PMDPGM           ** DBASE 06 ** S01227
     C                     Z-ADD6         PMDBSE           **************
     C                     SETON                     U7U8LR
     C                     MOVE 'T'       PMTERM
     C                     RETRN
     C                     END
     C                     MOVE *BLANKS   KEYY    3                       CSW096
     C                     MOVE *BLANKS   KEYZ    2                       CSW096
      *
     C                     ENDSR
     C/EJECT
      *
     C*****************************************************************   S01117
     C*                                                                   S01117
     C* SR TO ACCESS  RECORD ON THE FILE SDBANKPD                         S01117
     C*                                                                   S01117
     C* CALLED BY : SR V01                                                S01117
     C* CALLS     :                                                       S01117
     C*                                                                   S01117
     C* PARAMETERS:                                                       S01117
     C*      INPUT :STANDARD FOR ACCESS OBJECT AOBANKR0                   S01117
     C*      OUTPUT:STANDARD FOR ACCESS OBJECT AOBANKR0                   S01117
     C           CHKBK     BEGSR                                          S01117
      *                                                                   S01117
      ** IF SDBANKPD ALREADY ACCESSED IN THIS PGM NO NEED TO REREAD       S01117
     C           BJRDNB    IFEQ *ZERO                      B1             S01117
     C                     CALL 'AOBANKR0'                 *1             S01117
     C                     PARM '*MSG    '@RTCD   7        *1             S01117
     C                     PARM '*FIRST  '@OPTN   7        *1             S01117
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C***********          PARM           SDBANK           *1             S01194
     C*                                                                   S01117
     C           @RTCD     IFNE *BLANK                     B**2           S01117
     C                     MOVEL'BANK'    PMDBFL           ************** S01117
     C*******************  MOVEL'SDKUUPR' PMDPGM           ** DBASE 07 ** S01117
     C                     MOVEL'SD2410 ' PMDPGM           ** DBASE 07 ** S01117
     C                     Z-ADD7         PMDBSE           ************** S01117
     C                     SETON                     U7U8LR**2            S01117
     C                     MOVE 'T'       PMTERM           **2            S01117
     C                     RETRN                           **2            S01117
     C                     END                             E*2            S01117
     C                     END                             E1             S01117
      *                                                                   S01117
     C                     ENDSR                                          S01117
     C/EJECT                                                              S01117
     C*                                                                   S01117
     C*****************************************************************   S01117
     C*                                                                   S01117
     C* SR TO ACCESS  RECORD ON THE FILE SDBRCHPD                         S01117
     C*                                                                   S01117
     C* CALLED BY : SR V01                                                S01117
     C* CALLS     :                                                       S01117
     C*                                                                   S01117
     C* PARAMETERS:                                                       S01117
     C*      INPUT :STANDARD FOR ACCESS OBJECT AOBRCHR0                   S01117
     C*      OUTPUT:STANDARD FOR ACCESS OBJECT AOBRCHR0                   S01117
     C           CHKBR     BEGSR                                          S01117
      *                                                                   S01117
     C**********           CALL 'AOBRCHR0'             90                              S01117 CGL029
     C                     CALL 'AOBRCHR1'             90                                     CGL029
     C*********************PARM '*BLANKS '@RTCD   7                       S01117
     C                     PARM *BLANKS   @RTCD   7                       S01117
     C*********************PARM '*VERIFY '@OPTN   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM @OBR      @DSNB   3                       S01117
     C***********SDBRCH    PARM SDBRCH    DSFDY                    S01194 S01117
     C********** SDBRCH    PARM *BLANKS   DSFDY                                        S01117 CGL029
     C           SDBRCH    PARM *BLANKS   DSSDY                                               CGL029
     C*************        PARM           SDBRCH                          S01117
     C*                                                                   S01117
     C           *IN90     IFEQ '1'                                       S01117
     C                     MOVEL'BRCH'    PMDBFL           ************** S01117
     C*********************MOVEL'SDKUUPR' PMDPGM           ** DBASE 08 ** S01117
     C                     MOVEL'SD2410'  PMDPGM           ** DBASE 08 ** S01227
     C                     Z-ADD8         PMDBSE           ************** S01117
     C                     SETON                     U7U8LR               S01117
     C                     MOVE 'T'       PMTERM                          S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
      *                                                                   S01117
     C                     ENDSR                                          S01117
     C/EJECT                                                              S01117
     C*                                                                   S01117
      *****************************************************************   CSW096
      *                                                               *   CSW096
      * Removed for SWIFT Changes 96, replaced in program ME9950      *   CSW096
      *                                                               *   CSW096
      *****************************************************************   CSW096
      ***********                                                         CSW096
     C*****************************************************************   CSW096
     C***********                                                         CSW096
     C**SR*TO*VALIDATE BANK TO BANK INFORMATION                           CSW096
     C***********                                                         CSW096
     C**CALLED*BY : SR V01                                                CSW096
     C**CALLS**** :                                                       CSW096
     C***********                                                         CSW096
     C**PARAMETERS:                                                       CSW096
     C********INPUT :XBTB(35A)                                            CSW096
     C********OUTPUT:BTBERR(1A) CONTENTS: BLANK = NO ERROR FOUND          CSW096
     C***********                         E = ERROR; SET ON ERROR IND.    CSW096
     C***********BTBVAL    BEGSR                                          CSW096
     C***********          MOVE *BLANK    BTBERR  1                       CSW096
     C***********          MOVE *BLANK    WORD    9                       CSW096
     C***********          MOVE 'N'       PLUS    1                       CSW096
     C***********                                                         CSW096
     C***********          MOVEL'CABLEBEN'WORD1   9                       CSW096
     C***********          MOVE '/'       WORD1                           CSW096
     C***********          MOVEL'TELEXBEN'WORD2   9                       CSW096
     C***********          MOVE '/'       WORD2                           CSW096
     C***********          MOVEL'CABLEIBK'WORD3   9                       CSW096
     C***********          MOVE '/'       WORD3                           CSW096
     C***********          MOVEL'TELEXIBK'WORD4   9                       CSW096
     C***********          MOVE '/'       WORD4                           CSW096
     C***********                                                         CSW096
     C/COPY WNCPYSRC,SD2410C100
     C***CHECK*DS FOR VALID CODE WORD                                     CSW096
     C***********CODE1A    IFEQ 'REC/'                                    CSW096
     C***********CODE1A    OREQ 'INT/'                                    CSW096
     C***********CODE1A    OREQ 'BNF/'                                    CSW096
     C***********CODE1A    OREQ 'INS/'                                    CSW096
     C***********CODE1A    OREQ 'OGB/'                                    CSW096
     C***********CODE1A    OREQ 'IBK/'                              S01412CSW096
     C***********          MOVELCODE1A    WORD                            CSW096
     C***********          GOTO BVALID                                    CSW096
     C***********          END                                            CSW096
     C***********CODE1A    IFEQ 'ACC/'                                    CSW096
     C***********PMAWBN    IFNE *BLANKS                                   CSW096
     C***********          MOVELCODE1A    WORD                            CSW096
     C***********          GOTO BVALID                                    CSW096
     C***********          ELSE                                           CSW096
     C***********          MOVE '895'     ERCD,S                          CSW096
     C***********          ADD  1         S                               CSW096
     C***********          MOVE '1'       *IN31                     LN0787CSW096
     C***********          MOVE 'E'       BTBERR                          CSW096
     C***********          GOTO EBTBVL                                    CSW096
     C***********          END                                            CSW096
     C***********          END                                            CSW096
     C***********CODE1B    IFEQ 'HOLD/'                                   CSW096
     C***********          MOVELCODE1B    WORD                            CSW096
     C***********          GOTO BVALID                                    CSW096
     C***********          END                                            CSW096
     C***********CODE1B    IFEQ 'PHON/'                                   CSW096
     C***********PMAWBN    IFNE *BLANKS                                   CSW096
     C***********          MOVELCODE1B    WORD                            CSW096
     C***********          GOTO BVALID                                    CSW096
     C***********          ELSE                                           CSW096
     C***********          MOVE '895'     ERCD,S                          CSW096
     C***********          ADD  1         S                               CSW096
     C***********          MOVE '1'       *IN31                     LN0787CSW096
     C***********          MOVE 'E'       BTBERR                          CSW096
     C***********          GOTO EBTBVL                                    CSW096
     C***********          END                                            CSW096
     C***********          END                                            CSW096
     C***********CODE1C    IFEQ 'CABLE/'                                  CSW096
     C***********CODE1C    OREQ 'TELEX/'                                  CSW096
     C***********PMAWBN    IFNE *BLANKS                                   CSW096
     C***********          MOVELCODE1C    WORD                            CSW096
     C***********          GOTO BVALID                                    CSW096
     C***********          ELSE                                           CSW096
     C***********          MOVE '895'     ERCD,S                          CSW096
     C***********          ADD  1         S                               CSW096
     C***********          MOVE '1'       *IN31                     LN0787CSW096
     C***********          MOVE 'E'       BTBERR                          CSW096
     C***********          GOTO EBTBVL                                    CSW096
     C***********          END                                            CSW096
     C***********          END                                            CSW096
     C***********CODE1D    IFEQ 'CHEQUE/'                                 CSW096
     C***********          MOVELCODE1D    WORD                            CSW096
     C***********          GOTO BVALID                                    CSW096
     C***********          END                                            CSW096
     C***********CODE1E    IFEQ 'BENONLY/'                                CSW096
     C***********CODE1E    OREQ 'CONFIRM/'                                CSW096
     C***********CODE1E    OREQ 'RESERVE/'                                CSW096
     C***********CODE1E    OREQ 'PHONBEN/'                                CSW096
     C***********CODE1E    OREQ 'PHONIBK/'                                CSW096
     C***********          MOVELCODE1E    WORD                            CSW096
     C***********          GOTO BVALID                                    CSW096
     C***********          END                                            CSW096
     C***********CODE1F    IFEQ WORD1                                     CSW096
     C***********CODE1F    OREQ WORD2                                     CSW096
     C***********CODE1F    OREQ WORD3                                     CSW096
     C***********CODE1F    OREQ WORD4                                     CSW096
     C***********          MOVELCODE1F    WORD                            CSW096
     C***********          GOTO BVALID                                    CSW096
     C***********          END                                            CSW096
     C***********          MOVE '990'     ERCD,S                          CSW096
     C***********          ADD  1         S                               CSW096
     C***********          MOVE '1'       *IN31                     LN0787CSW096
     C***********          MOVE 'E'       BTBERR                          CSW096
     C***********          GOTO EBTBVL                                    CSW096
     C***********BVALID    TAG                                            CSW096
     C***VALID*CODE WORD; CHECK IF ALREADY USED                           CSW096
     C***********          Z-ADD1         Y       10                      CSW096
     C***********          DO   X                                         CSW096
     C***********WORD      IFEQ BTB,Y                                     CSW096
     C***********          MOVE '997'     ERCD,S                          CSW096
     C***********          ADD  1         S                               CSW096
     C***********          MOVE '1'       *IN31                     LN0787CSW096
     C***********          MOVE 'E'       BTBERR                          CSW096
     C***********          GOTO EBTBVL                                    CSW096
     C***********          END                                            CSW096
     C***********          ADD  1         Y                               CSW096
     C***********          END                                            CSW096
     C***STORE*VALID CODE WORD IN ARRAY                                   CSW096
     C***********          ADD  1         X                               CSW096
     C***********          MOVE WORD      BTB,X                           CSW096
     C***********                                                         CSW096
     C***THE*NEXT CODE WORDS CAN BE FOLLOWED BY '+' IF SO ADD TELEPHONE   CSW096
     C***OR*TELEX NEMBER TO DS.                                           CSW096
     C***********CODE1B    IFEQ 'PHON/'                                   CSW096
     C***********PLUS1A    ANDEQ'+'                                       CSW096
     C***********          MOVE ACPHON    PHONEA                          CSW096
     C***********          MOVE 'Y'       PLUS                            CSW096
     C***********          END                                            CSW096
     C***********CODE1C    IFEQ 'TELEX/'                                  CSW096
     C***********PLUS1B    ANDEQ'+'                                       CSW096
     C***********          MOVE ACTELX    TELEXA                          CSW096
     C***********          MOVE 'Y'       PLUS                            CSW096
     C***********          END                                            CSW096
     C***********CODE1E    IFEQ 'PHONBEN/'                                CSW096
     C***********PLUS1C    ANDEQ'+'                                       CSW096
     C***********          MOVE BEPHON    PHONEB                          CSW096
     C***********          MOVE 'Y'       PLUS                            CSW096
     C***********          END                                            CSW096
     C***********CODE1F    IFEQ WORD2                                     CSW096
     C***********PLUS1D    ANDEQ'+'                                       CSW096
     C***********          MOVE BETELX    TELEXB                          CSW096
     C***********          MOVE 'Y'       PLUS                            CSW096
     C***********          END                                            CSW096
     C***********CODE1E    IFEQ 'PHONIBK/'                                CSW096
     C***********PLUS1C    ANDEQ'+'                                       CSW096
     C***********          MOVE INPHON    PHONEB                          CSW096
     C***********          MOVE 'Y'       PLUS                            CSW096
     C***********          END                                            CSW096
     C***********CODE1F    IFEQ WORD4                                     CSW096
     C***********PLUS1D    ANDEQ'+'                                       CSW096
     C***********          MOVE INTELX    TELEXB                          CSW096
     C***********          MOVE 'Y'       PLUS                            CSW096
     C***********          END                                            CSW096
     C***********                                                         CSW096
     C***THE*FOLLOWING CODE WORDS MUST NOT BE FOLLOWED BY BLANKS          CSW096
     C***********CODE1A    IFEQ 'REC/'                                    CSW096
     C***********CODE1A    OREQ 'INT/'                                    CSW096
     C***********CODE1A    OREQ 'ACC/'                                    CSW096
     C***********CODE1A    OREQ 'BNF/'                                    CSW096
     C***********CODE1A    OREQ 'INS/'                                    CSW096
     C***********CODE1A    OREQ 'OGB/'                                    CSW096
     C***********CODE1A    OREQ 'IBK/'                              S01412CSW096
     C***********BLNK1A    IFEQ *BLANK                                    CSW096
     C***********          MOVE '993'     ERCD,S                          CSW096
     C***********          ADD  1         S                               CSW096
     C***********          MOVE '1'       *IN31                     LN0787CSW096
     C***********          MOVE 'E'       BTBERR                          CSW096
     C***********          GOTO EBTBVL                                    CSW096
     C***********          END                                            CSW096
     C***********          END                                            CSW096
     C***********                                                         CSW096
     C***IF*'/INS/' OR '/OGB/' ENTERED SET INDICATORS TO CHECK NUMBER     CSW096
     C***OF*CONTINUATION LINES                                            CSW096
     C***********CODE1A    IFEQ 'INS/'                                    CSW096
     C***********CODE1A    OREQ 'OGB/'                                    CSW096
     C***********          MOVE '1'       *IN71                           CSW096
     C***********          END                                            CSW096
     C***********                                                         CSW096
     C***IF*'/IBK/'*ENTERED*SET*INDICATORS*TO*CHECK*NUMBER*******   S01412CSW096
     C***OF*CONTINUATION*LINES***********************************   S01412CSW096
     C***********CODE1A    IFEQ 'IBK/'                              S01412CSW096
     C***********          MOVE '1'       *IN74                     S01412CSW096
     C***********SLASH3    IFEQ '/'                                 S01412CSW096
     C***********          MOVE '1'       *IN73                     S01412CSW096
     C***********          ELSE                                     S01412CSW096
     C***********          MOVE '1'       *IN72                     S01412CSW096
     C***********          END                                      S01412CSW096
     C***********          END                                      S01412CSW096
     C***********                                                         CSW096
     C***IF*'/CABLEIBK','/PHONIBK/' OR '/TELEXIBK/' SET INDICATOR TO      CSW096
     C***VALIDATE LATER                                                   CSW096
     C***********CODE1E    IFEQ 'PHONIBK/'                                CSW096
     C***********CODE1F    OREQ WORD3                                     CSW096
     C***********CODE1A    OREQ WORD4                                     CSW096
     C***********          MOVE '1'       *IN75                           CSW096
     C***********          END                                            CSW096
     C***********                                                         CSW096
     C***IF*'/INT/' SET INDICATOR TO VALIDATE LATER                       CSW096
     C***********CODE1A    IFEQ 'INT/'                                    CSW096
     C***********          MOVE '1'       *IN76                           CSW096
     C***********          END                                            CSW096
     C***********                                                         CSW096
     C***'/OGB/'*ONLY ALLOWED IF BENEFICIARY IS A BANK                    CSW096
     C***********CODE1A    IFEQ 'OGB/'                                    CSW096
     C***********CPBENN    ANDEQ'N'                                       CSW096
     C***********BENBNK    ANDEQ'N'                                       CSW096
     C***********          MOVE '995'     ERCD,S                          CSW096
     C***********          ADD  1         S                               CSW096
     C***********          MOVE '1'       *IN31                     LN0787CSW096
     C***********          MOVE 'E'       BTBERR                          CSW096
     C***********          GOTO EBTBVL                                    CSW096
     C***********          END                                            CSW096
      ***********                                                         CSW096
     C*
     C***'/IBK/'*ONLY*ALLOWED*FOR*A*CUSTOMER*TRANSFER*AND*IT*MUST*BE***   S01412
     C***FOLLOWED*BY*THE*CUSTOMER*NUMBER*OR*SHORTNAME*OF*A*BANK********   S01412
     C***********CODE1A    IFEQ 'IBK/'                     B1             S01412
     C***********          MOVE *BLANKS   IBKNO            *1             S01412
     C***********PMBENN    IFEQ *BLANKS                    B*2            S01412
     C***********BENBNK    ORNE 'N'                        **2            S01412
     C***********          MOVE '897'     ERCD,S           **2            S01412
     C***********          ADD  1         S                **2            S01412
     C***********          MOVE '1'       *IN31                     LN0787S01412
     C***********          MOVE 'E'       BTBERR           **2            S01412
     C***********          GOTO EBTBVL                     **2            S01412
     C***********          ELSE                            X*2            S01412
     C************IN72     IFEQ '1'                        B**3           S01412
     C***********          MOVE CODE1G    CHKFLD           ***3           S01412
     C***********          ELSE                            X**3           S01412
     C***********LINE      IFEQ 1                          B***4          S01412
     C***********          MOVELPMBTB2    YBTB             ****4          S01412
     C***********          MOVE CODE1H    CHKFLD           ****4          S01412
     C***********          END                             E***4          S01412
     C***********LINE      IFEQ 2                          B***4          S01412
     C***********          MOVELPMBTB3    YBTB             ****4          S01412
     C***********          MOVE CODE1H    CHKFLD           ****4          S01412
     C***********          END                             E***4          S01412
     C***********LINE      IFEQ 3                          B***4          S01412
     C***********          MOVELPMBTB4    YBTB             ****4          S01412
     C***********          MOVE CODE1H    CHKFLD           ****4          S01412
     C***********          END                             E***4          S01412
     C***********LINE      IFEQ 4                          B***4          S01412
     C***********          MOVELPMBTB5    YBTB             ****4          S01412
     C***********          MOVE CODE1H    CHKFLD           ****4          S01412
     C***********          END                             E***4          S01412
     C***********LINE      IFEQ 5                          B***4          S01412
     C***********          MOVELPMBTB6    YBTB             ****4          S01412
     C***********          MOVE CODE1H    CHKFLD           ****4          S01412
     C***********          END                             E***4          S01412
     C***********          END                             E**3           S01412
     C***********          MOVE 'N'       @CPNA            **2      S01117S01412
     C***********          EXSR CHKFL                      **2            S01412
     C***********RTCD      IFEQ '*NOSEL '                  B**3     S01117S01412
     C***********          MOVE '867'     ERCD,S           ***3     S01117S01412
     C***********          ADD  1         S                ***3     S01117S01412
     C***********          MOVE '1'       *IN31                     LN0787S01412
     C***********          END                             E**3     S01117S01412
     C***********RESULT    IFEQ 'E'                        B**3           S01412
     C*********************MOVE '897'     ERCD,S           ***3
     C*********************MOVE '866'     ERCD,S           ***3           LN0785
     C***********          MOVE '897'     ERCD,S           ***3     LN0785S01412
     C***********          ADD  1         S                ***3           S01412
     C***********          MOVE '1'       *IN31                     LN0787S01412
     C***********          ELSE                            X**3           S01412
     C***********RESULT    IFEQ 'A'                        B***4          S01412
     C***********RESULT    OREQ 'B'                        ****4          S01412
     C***********BANKNB    IFNE 'B'                        B****5         S01412
     C*********************MOVE '897'     ERCD,S           *****5
     C*********************MOVE '866'     ERCD,S           ***3           LN0785
     C***********          MOVE '897'     ERCD,S           ***3     LN0785S01412
     C***********          ADD  1         S                *****5         S01412
     C***********          MOVE '1'       *IN31                     LN0787S01412
     C***********          ELSE                            X****5         S01412
     C***********          MOVELBBCUST    IBKNO   8        *****5         S01412
     C***********          END                             E****5         S01412
     C*********************ELSE                            X***4          S01117
     C*********************MOVELAWCPNC    IBKNO            ****4          S01117
     C***********                                                         S01412
     C***MOVE*CUSTOMER SHORTNAME TO REPLACE '?' ON SCREEN.                S01412
     C************IN72     IFEQ '1'                        B****5   S01117S01412
     C***********          MOVELBBCSSN    CODE1G           *****5   S01117S01412
     C***********          ELSE                            X****5   S01117S01412
     C***********          MOVELBBCSSN    CODE1H           *****5   S01117S01412
     C***********LINE      IFEQ 1                          B*****6  S01117S01412
     C***********          MOVELYBTB      PMBTB2           ******6  S01117S01412
     C***********          END                             E*****6  S01117S01412
     C***********LINE      IFEQ 2                          B*****6  S01117S01412
     C***********          MOVELYBTB      PMBTB3           ******6  S01117S01412
     C***********          END                             E*****6  S01117S01412
     C***********LINE      IFEQ 3                          B*****6  S01117S01412
     C***********          MOVELYBTB      PMBTB4           ******6  S01117S01412
     C***********          END                             E*****6  S01117S01412
     C***********LINE      IFEQ 4                          B*****6  S01117S01412
     C***********          MOVELYBTB      PMBTB5           ******6  S01117S01412
     C***********          END                             E*****6  S01117S01412
     C***********LINE      IFEQ 5                          B*****6  S01117S01412
     C***********          MOVELYBTB      PMBTB6           ******6  S01117S01412
     C***********          END                             E*****6  S01117S01412
     C***********          END                             E****5   S01117S01412
     C***********          END                             E***4          S01412
     C***********          END                             E**3           S01412
     C***********          END                             E*2            S01412
     C***********                                                         S01412
     C***INTERMEDIARY BANK MUST NOT BE THE SAME AS BRANCH INTERNAL        S01412
     C***CUSTOMER, OUR NOSTRO, RECEIVER, ACCOUNT WITH BANK OR             S01412
     C***BENEFICIARY                                                      S01412
     C***********IBKNO     IFNE *BLANKS                    B*2            S01412
     C***********IBKNO     IFEQ A8BICN                     B**3           S01412
     C***********IBKNO     OREQ PNOST                      ***3           S01412
     C***********IBKNO     OREQ PARVNO                     ***3           S01412
     C***********IBKNO     OREQ PAAWBN                     ***3           S01412
     C***********IBKNO     OREQ PABENN                     ***3           S01412
     C***********          MOVE '892'     ERCD,S           ***3           S01412
     C***********          ADD  1         S                ***3           S01412
     C***********          MOVE '1'       *IN31                     LN0787S01412
     C***********          END                             E**3           S01412
     C***********          END                             E*2            S01412
     C***********          END                             E1             S01412
     C***********                                                         CSW096
     C***********EBTBVL    ENDSR                                          CSW096
     C/EJECT
      *
     C*****************************************************************
     C*****                                                               S01117
     C**SR Z01 TO CALL ACCESS OBJECTS TO CLOSE OPEN FILES                 S01117
     C*****                                                               S01117
     C**CALLED BY : SR V01                                                S01117
     C**CALLS     :                                                       S01117
     C*****                                                               S01117
     C*****      Z01       BEGSR                                          S01117
     C*****                                                               S01117
     C*****                MOVE '*FREE'   RTCD                            S01117
     C*****                CALL 'AOACCTV0'                                S01117
     C*****                PARM           RTCD                            S01117
     C*****                PARM           ACID                            S01117
     C*****                PARM           CUCD                            S01117
     C*****                PARM           ACCD                            S01117
     C*****                PARM           ACSQA                           S01117
     C*****                PARM           TYPE                            S01117
     C*****                PARM           NOSN                            S01117
     C*****                PARM           ACCT                            S01117
      *****                                                               S01117
     C*****                MOVE *BLANKS   RTCD                            S01117
     C*****                MOVE '*FREE'   OPTN                            S01117
     C*****                CALL 'AOBRCHR0'                                S01117
     C*****                PARM           RTCD                            S01117
     C*****                PARM           OPTN                            S01117
     C*****                PARM           DSNB                            S01117
     C*****                PARM           A8RF                            S01117
      *****                                                               S01117
     C*****                MOVE *BLANKS   RTCD                            S01117
     C*****                MOVE '*FREE'   OPTN                            S01117
     C*****                CALL 'AOCCSYR0'                                S01117
     C*****                PARM           RTCD                            S01117
     C*****                PARM           OPTN                            S01117
     C*****                PARM           KEYY                            S01117
     C*****                PARM           KEYZ                            S01117
     C*****                PARM           DMRF                            S01117
      *****                                                               S01117
     C*****                MOVE *BLANKS   RTCD                            S01117
     C*****                MOVE '*FREE'   OPTN                            S01117
     C*****                CALL 'AOCNSTR0'                                S01117
     C*****                PARM           RTCD                            S01117
     C*****                PARM           OPTN                            S01117
     C*****                PARM           CBNB                            S01117
     C*****                PARM           ALRF                            S01117
      *****                                                               S01117
     C*****                MOVE *BLANKS   RTCD                            S01117
     C*****                MOVE '*FREE'   OPTN                            S01117
     C*****                CALL 'AOCUSTR0'                                S01117
     C*****                PARM           RTCD                            S01117
     C*****                PARM           OPTN                            S01117
     C*****                PARM           KEY1                            S01117
     C*****                PARM           KYST                            S01117
     C*****                PARM           CURF                            S01117
      *****                                                               S01117
     C*****                MOVE *BLANKS   RTCD                            S01117
     C*****                MOVE '*FREE'   OPTN                            S01117
     C*****                CALL 'AONOSTR0'                                S01117
     C*****                PARM           RTCD                            S01117
     C*****                PARM           OPTN                            S01117
     C*****                PARM           KEYA                            S01117
     C*****                PARM           KEYB                            S01117
     C*****                PARM           KEYC                            S01117
     C*****                PARM           KEYD                            S01117
     C*****                PARM           KEYE                            S01117
     C*****                PARM           A7RF                            S01117
      *****                                                               S01117
     C*****                                                               S01117
     C*****      Z09       ENDSR                                          S01117
      *     S01297 - RELEASE 10 EXTENDED SETTLEMENTS DEFAULTING.     *    S01297
     C*****************************************************************   S01297
     C*                                                               *   S01297
     C* DEFLT    - Defaulting                                         *   S01297
     C*                                                               *   S01297
     C* CALLED BY MAIN                                                *   S01297
     C*                                                               *   S01297
     C* CALLS - DEF18, CUSGET                                         *   S01297
     C*                                                               *   S01297
     C*****************************************************************   S01297
     C*                                                                   S01297
     C           DEFLT     BEGSR                                          S01297
     C*                                                                   S01297
     C                     MOVEA*BLANK    ERCD                            S01297
     C                     Z-ADD1         S       30                      S01297
     C*                                                                   S01297
     C* FIND WHETHER  DEAL COUNTERPARTY IS A BANK AND                     S01297
     C* STORE INFORMATION FOR LATER USE                                   S01297
     C*                                                                   S01297
     C*                                                                   S01297
     C                     MOVELPMCSNM    CSTKEY                          S01297
     C                     EXSR CUSGET                                    S01297
     C           RTCD      IFEQ *BLANK                     *IF1*          S01297
     C*                                                                   S01408
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,SD2410CCP1                                           S01408
     C*                                                                   S01408
     C**********           MOVELBBBNBI    CPBNBI  1                S01297 099441
     C                     MOVELBBSWFI    CPBNBI  1                       099441
     C                     MOVELBBCSID    CPCSID 12                       S01297
     C                     MOVELBBCSSN    CPCSSN 10                       BHF766
     C                     ELSE                                           S01297
     C                     GOTO DFLERR                                    S01297
     C                     END                             *END1*         S01297
     C*                                                                   S01297
     C* FIND OUT WHAT THE SETTLEMENT BRANCH IS                            S01297
     C                     EXSR PBRGET                                    S01297
     C*                                                                   S01297
     C           RTCD      IFEQ *BLANK                                    S01297
     C                     MOVELA7BRCD    PAYBRA  3                       S01297
     C                     ELSE                                           S01297
     C                     GOTO DFLERR                                    S01297
     C                     END                                            S01297
     C*********                                                     BHF564LN0759
     C***IF*THERE*ARE*OUTSTANDING*ERRORS*ON*THE*SCREEN*OR*THE       BHF564LN0759
     C***OR*THE*SETTLEMENT*TYPE*IS*NOT*08*REDEFAULT**********       BHF564LN0759
     C***OTHERWISE*ONLY*DEFAULT*ON*FIRST*ENTER***************       BHF564LN0759
     C*********                                                     BHF564LN0759
     C*********  S         IFEQ 0                                   BHF564LN0759
     C/COPY WNCPYSRC,SD2410C044
     C*********  PMPSTM    ORNE 08                                  BHF564LN0759
     C*********            MOVE 'Y'       PMDEFT                    BHF564LN0759
     C*********            END                                      BHF564LN0759
     C*                                                             S01297BHF564
     C/COPY WNCPYSRC,SD2410C045
     C**ONLY*DO*DEFAULTS*IF*IT*IS*THE*FIRST*ENTER,*OR*IF*THE*SETTLEMS01297BHF564
     C**METHOD*IS*CHIPS*(07)****************************************S01297BHF564
     C**--------------------****************************************S01297BHF564
     C*                                                                   S01297
     C***********PMDEFT****IFEQ 'Y'                        *IF1**   S01297LN0787
     C********** PMPSTM    OREQ 07                                        S01297
     C*                                                                   S01297
     C* FIELD 58, BENEFICIARY                                             S01297
     C* ---------------------                                             S01297
     C* BENEFICIARY DEFAULTS TO THE DEAL COUNTERPARTY                     S01297
     C           PMBENN    IFEQ *BLANK                     *IF2**         S01297
     C/COPY WNCPYSRC,SD2410C081
     C                     MOVELPMCSNM    PMBENN                          S01297
     C/COPY WNCPYSRC,SD2410C046
     C                     END                             *END2*         S01297
     C*                                                                   S01297
     C/COPY WNCPYSRC,SD2410C082
     C* FIND WHETHER BENEFICIARY IS A BANK AND                            S01297
     C* STORE INFORMATION FOR LATER USE                                   S01297
     C*                                                                   S01297
     C                     MOVELPMBENN    CSTKEY                          S01297
     C                     EXSR CUSGET                                    S01297
     C           RTCD      IFEQ *BLANK                     *IF1*          S01297
     C**********           MOVELBBBNBI    BFBNBI  1                S01297 099441
     C                     MOVELBBSWFI    BFBNBI  1                       099441
     C                     ELSE                                           S01297
     C                     GOTO DFLERR                                    S01297
     C                     END                             *END1*         S01297
     C/COPY WNCPYSRC,SD2410C083
     C*                                                                   S01297
     C* FIELD 72, BANK TO BANK INFORMATION                                S01297
     C* ----------------------------------                                S01297
     C* FOR DEALS INPUT ONLY:                                             S01297
     C*                    IF THEN DEAL IS SETTLED VIA SWIFT AND          BHF596
     C* IF THE BENEFICIARY (INPUT OR DEFAULTED) IS A BANK, AND NOT THE    S01297
     C* DEAL COUNTERPARTY, AND DEAL BOOKING BRANCH DIFFERS FROM           S01297
     C* SETTLEMENT BRANCH, DEFAULT FIELD 72.                              S01297
     C* DEAL COUNTERPARTY MUST ALSO BE A BANK.                            BHF764
     C*                                                                   S01297
     C           PMCPGM    IFNE 'SSI '                     **IF2**        S01297
     C           PMBTB1    IFEQ *BLANK                     **IF3**        S01297
     C           BFBNBI    IFEQ 'Y'                        **IF4**        S01297
     C           CPBNBI    ANDEQ'Y'                                       BHF764
     C           PMBENN    ANDNEPMCSNM                                    S01297
     C           PMBRCA    ANDNEPAYBRA                                    S01297
     C           PMPSTM    ANDEQ08                                        BHF596
     C/COPY WNCPYSRC,SD2410C034
     C*                                                                   S01297
     C* USE SWIFT ID IF PRESENT, ELSE USE CUSTOMER REPORT NAME AND TOWN   S01297
     C*                                                                   S01297
     C           CPCSID    IFNE *BLANK                     **IF5**        S01297
     C                     MOVE CPCSID    WRK17  17                       S01297
     C                     MOVELWRK17     PMBTB1                          S01297
     C                     ELSE                            *ELSE5*        S01297
     C*                                                                   BHF506
     C** FIND CUSTOMER REPORT NAME AND TOWN                               BHF506
     C*                                                                   BHF506
     C                     MOVELPMCSNM    CSTKEY                          BHF506
     C                     EXSR CUSGET                                    BHF506
     C           RTCD      IFNE *BLANK                     *IF1*          BHF506
     C                     GOTO DFLERR                                    BHF506
     C                     END                             *END1*         BHF506
     C                     MOVELBBCRNM    WRK30  30                       S01297
     C                     MOVE BBCRTN    WRK30                           S01297
     C                     MOVE WRK30     PMBTB1                          S01297
     C                     END                             **END5*        S01297
     C*                                                                   S01297
     C                     MOVEL'/INS/'   PMBTB1                          S01297
     C/COPY WNCPYSRC,SD2410C035
     C                     END                             **END4*        S01297
     C                     END                             **END3*        S01297
     C                     END                             **END2*        S01297
     C*                                                                   S01297
     C********** PMPSTM    IFEQ 01                                  S01297BHF517
     C********** PMPSTM    OREQ 08                                  S01297BHF517
     C           PMPSTM    IFEQ 08                                        BHF517
     C                     EXSR DEF18                                     S01297
     C                     END                                            S01297
     C*                                                                   S01297
     C           PMPSTM    IFEQ 07                         **IF2**        S01297
     C                     EXSR CHIPS                                     S01297
     C                     END                             **END2*        S01297
     C*********************END                             **END1*  S01297LN0787
     C                     MOVE 'N'       PMDEFT                          S01297
     C*                                                                   S01297
     C           DFLERR    TAG                                            S01297
     C*                                                                   S01297
     C                     ENDSR                                          S01297
     C********************************************************************S01297
      /EJECT                                                              S01297
     C*****************************************************************   S01297
     C*                                                               *   S01297
     C**DEF18****-*01*08**PROCESSING********************************S01297BHF517
     C* DEF18 - 08  PROCESSING                                        *   BHF517
     C*                                                               *   S01297
     C* CALLED BY DEFLT                                               *   S01297
     C*                                                               *   S01297
     C*****************************************************************   S01297
     C*                                                                   S01297
     C           DEF18     BEGSR                                          S01297
     C*                                                                   S01297
     C* FIELD 50, ORDERING CUSTOMER (PAY SIDE)                            S01297
     C* --------------------------------------                            S01297
     C**IF*THE*BENEFICIARY*IS*THE*DEAL*COUNTERPARTY*AND*THE*********S01297BHF585
     C**DEAL*COUNTERPARTY*IS*A*NON-BANK,THEN*DEFAULT*TO*THE*DEAL****BHF569BHF585
     C**COUNTERPARTY.***********************************************S01297BHF585
     C* IF THE DEAL COUNTERPARTY IS A NON-BANK,THEN DEFAULT TO THE        BHF585
     C* DEAL COUNTERPARTY.                                                BHF585
     C*                                                                   S01297
     C*********  PMCSNM    IFEQ PMBENN                     *IF0**         BHF585
     C*********  PMPOCN    IFEQ *BLANK                     *IF1**   S01297LN0782
     C********** PMPOBN    ANDEQ*BLANK                              BHF549LN0782
     C*                                                                   S01297
     C********** BFBNBI    IFNE 'Y'                        *IF3**   S01297LN0748
     C********** CPBNBI    ANDEQ'N'                                 BHF585LN0748
     C**********           MOVELPMCSNM    PMPOCN                    S01297LN0782
     C**********           END                             *END3*   S01297LN0782
     C**********           END                             *END1*   S01297LN0748
     C**********           END                             *END0*         BHF585
     C*                                                                   LN0782
     C** IF THE BENEFICIARY IS A NON BANK OR THE DEAL C/PARTY IS          LN0782
     C** A NON BANK THEN DEFAULT FIELD 50 TO THE DEAL C/PARTY             LN0782
     C*                                                                   LN0782
     C           BFBNBI    IFEQ 'N'                                       LN0782
     C           CPBNBI    OREQ 'N'                                       LN0782
     C           PMPOBN    ANDEQ*BLANKS                                   142408
     C           BFBNBI    ANDEQ'N'                                       134496
      *                                                                   157861
     C                     MOVELPMCSNM    CSTKEY                          157861
     C                     EXSR CUSGET                                    157861
      *                                                                   157861
      ** Default a non bank ordering customer                             157861
      *                                                                   157861
     C           BBBNBI    IFEQ 'N'                                       157861
     C                     MOVELPMCSNM    PMPOCN                          LN0782
     C                     ENDIF                                          157861
     C                     END                                            LN0782
     C*                                                                   S01297
     C* FIELD 52 - ORDERING BANK, PAY SIDE.                               S01297
     C* -----------------------------------                               S01297
     C*                                                                   S01297
     C**IF*ORDERING*BANK*IS*BLANK:*                                 S01297BHF569
     C********** PMPOBN    IFEQ *BLANK                     *IF1**   S01297BHF569
     C********** PMPOCN    ANDEQ*BLANK                              BHF549BHF569
     C**********                                                    S01297BHF569
     C**IF*THE*BENEFICIARY*IS*A*BANK,*                              S01297BHF569
     C**AND*DEAL*COUNTERPARTY*IS*A*BANK*                            S01297BHF569
     C**AND*BENEFICIARY*DIFFERS*FROM*DEAL*COUNTERPARTY              S01297BHF569
     C**********                                                    S01297BHF569
     C********** BFBNBI    IFEQ 'Y'                        *IF2**   S01297BHF569
     C********** CPBNBI    ANDEQ'Y'                                 S01297BHF569
     C********** PMBENN    ANDNEPMCSNM                              S01297BHF569
     C**********                                                    S01297BHF569
     C********** PMBRCA    IFEQ PAYBRA                     *IF3**   S01297BHF569
     C********** PMCPGM    ANDNE'SSI '                              S01297BHF569
     C********** PMCPGM    OREQ 'SSI '                              S01297BHF569
     C**********                                                    S01297BHF569
     C****DEFAULT*TO*DEAL*COUNTERPARTY*                             S01297BHF569
     C**********           MOVELPMCSNM    PMPOBN                    S01297BHF569
     C**********                                                    S01297BHF569
     C**********           END                             *END3*   S01297BHF569
     C**********           END                             *END2*   S01297BHF569
     C**********                                                    S01297BHF569
     C**FOR*DEALS*INPUT*ONLY:*                                      S01297BHF569
     C**IF*DEAL*BOOKING*BRANCH*DIFFERS*FROM*SETTLEMENT*BRANCH*      S01297BHF569
     C**DEFAULT*TO*SWIFT*ADDRESS*OF*BICN*OF*DEAL*BOOKING*BRANCH*    S01297BHF569
     C*********  PMCPGM    IFNE 'SSI '                     *IF2**   S01297BHF569
     C*********  PMBRCA    IFNE PAYBRA                     *IF3**   S01297BHF569
     C*********                                                     S01297BHF569
     C*********            CALL 'AOBRCHR0'                          S01297BHF569
     C*********            PARM           RTCD                      S01297BHF569
     C*********            PARM '*KEY'    OPTN                      S01297BHF569
     C*********            PARM           PMBRCA                    S01297BHF569
     C*********  SDBRCH    PARM SDBRCH    DSFDY                     S01297BHF569
     C**********                                                    S01297BHF569
     C********** RTCD      IFEQ *BLANK                     *IF4**   S01297BHF569
     C**********           MOVELA8BICN    CSTKEY                    S01297BHF569
     C**********           EXSR CUSGET                              S01297BHF569
     C**********                                                    S01297BHF569
     C********** RTCD      IFEQ *BLANK                     *IF5**   S01297BHF569
     C**********           MOVELBBCSSN    PMPOBN                    S01297BHF569
     C**********           MOVELBBCUST    PAPOBN                    S01297BHF569
     C**********           MOVELBBCUST    PMPOBN                    S01297BHF569
     C**********           ELSE                            *ELS5*   S01297BHF569
     C**********           MOVELA8BICN    PAPOBN                    S01297BHF569
     C**********           MOVELA8BICN    PMPOBN                    S01297BHF569
     C**********           END                             *END5*   S01297BHF569
     C**********                                                    S01297BHF569
     C**********           END                             *END4*   S01297BHF569
     C**********                                                    S01297BHF569
     C**********           END                             *END3*   S01297BHF569
     C**********                                                    S01297BHF569
     C**********           END                             *END2*   S01297BHF569
     C**********                                                    S01297BHF569
     C**********                                                    S01297BHF569
     C**********           END                             *END1*   S01297BHF569
     C**********                                                    S01297BHF569
     C*                                                                   BHF569
     C** IF SD INPUT OR BOOKING BRANCH = SETTLEMENT BRANCH                BHF569
     C*                                                                   BHF569
     C           PMCPGM    IFEQ 'SSI '                     *IF1**         BHF569
     C           PMBRCA    OREQ PAYBRA                                    BHF569
     C*                                                                   BHF569
     C* IF BENEFICIARY IS A BANK AND C/PARTY IS A BANK                    BHF569
     C* AND BENEFICIARY IS NOT THE  C/PARTY                               BHF569
     C*                                                                   BHF569
     C           PMBENN    IFNE CPCSSN                                    BHF766
     C           PMBENN    ANDNEPMCSNM                                    BHF766
     C*                                                                   BHF766
     C           BFBNBI    IFEQ 'Y'                         *IF2**        BHF569
     C           CPBNBI    ANDEQ'Y'                                       BHF569
     C*                                                                   043712
     C           PMPOBN    IFEQ *BLANKS                                   043712
     C****       PMBENN    ANDNEPMCSNM                             BHF569 BHF766
     C*                                                                   BHF569
     C**  DEFAULT TO DEAL COUNTERPARTY                                    BHF569
     C*                                                                   BHF569
     C                     MOVELPMCSNM    PMPOBN                          BHF569
     C*                                                                   043712
     C                     END                                            043712
     C*                                                                   BHF569
     C                     END                             *END2*         BHF569
     C*                                                                   BHF766
     C                     END                                            BHF766
     C*                                                                   BHF569
     C                     END                             *END1*         BHF569
     C/COPY WNCPYSRC,SD2410C030
     C*                                                                   BHF569
     C** IF NOT SD INPUT AND BOOKING BRANCH IS NOT = SETTLEMENT BRANCH    BHF569
     C*                                                                   BHF569
     C           PMCPGM    IFNE 'SSI '                     *IF1**         BHF569
     C           PMBRCA    ANDNEPAYBRA                                    BHF569
     C*                                                                   BHF569
     C** GET BOOKING BRANCH BICN                                          BHF569
     C*                                                                   BHF569
     C**********           CALL 'AOBRCHR0'                                             BHF569 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM           RTCD                            BHF569
     C                     PARM '*KEY'    OPTN                            BHF569
     C                     PARM           PMBRCA                          BHF569
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        BHF569 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C*                                                                   BHF569
     C** ACCESS CUSTOMER FOR THIS BICN                                    BHF569
     C*                                                                   BHF569
     C           RTCD      IFEQ *BLANK                      *IF2**        BHF569
     C***********          MOVELA8BICN    CSTKEY                    BHF569CSW096
     C                     MOVELA8BICN    CSTKEY    P                     CSW096
     C                     EXSR CUSGET                                    BHF569
     C*                                                                   BHF569
     C** IF SHORTNAME IS NON BLANK DEFAULT FIELD 52 TO THE SHORTNAME      BHF569
     C*                                                                   BHF569
     C           RTCD      IFEQ *BLANK                      *IF3**        BHF569
     C           PMPOBN    IFEQ *BLANK                      *CES1         101041
     C           BBCSSN    ANDNE*BLANK                                    BHF569
     C                     MOVELBBCSSN    PMPOBN                          BHF569
     C*                                                                   BHF569
     C                     ELSE                             *ELS3*        BHF569
     C*                                                                   BHF569
     C** DEFAULT FIELD 52 TO THE BICN                                     BHF569
     C*                                                                   BHF569
     C           PMPOBN    IFEQ *BLANK                      *CES2         101041
     C           BBCSSN    ANDEQ*BLANK                                    101041
     C                     MOVELA8BICN    PMPOBN                          BHF569
     C*                                                                   BHF569
     C                     END                              *CES2         101041
     C                     END                              *CES1         101041
     C                     END                              *END3*        BHF569
     C                     END                              *END2*        BHF569
     C                     END                              *END1*        BHF569
     C*                                                                   BHF569
     C*                                                                   BHF569
     C* FIELD 57, 'ACCOUNT WITH' BANK (PAY SIDE)                          S01297
     C* ----------------------------------------                          S01297
     C* FOR DEALS INPUT ONLY:                                             S01297
     C*                                                                   S01297
     C           PMCPGM    IFNE 'SSI '                     *IF1**  NOT SD S01297
     C*                                                                   S01297
     C                     CALL 'AOTRADR0'                                S01297
     C                     PARM '*DBERR'  RTCD                            S01297
     C                     PARM '*FIRST'  OPTN                            S01297
     C           SDTRAD    PARM SDTRAD    DSFDY                           S01297
     C*                                                                   S01297
     C* IF THE DEAL IS FOR FEDERAL FUNDS AND THE DEAL (PAY) CURRENCY      S01297
     C* IS US DOLLARS.                                                    S01297
     C*                                                                   S01297
     C           PMFFND    IFEQ 'Y'                        **IF2**        S01297
     C           PMPCCY    ANDEQBLUSCY                                    S01297
     C*                                                                   S01297
     C* IF FIELD 57 IS BLANK THEN DISPLAY ERROR MESSAGE                   S01297
     C********** PMAWBA    IFEQ *BLANK                              S01297LN0691
     C           PMAWBN    IFEQ *BLANK                                    LN0691
     C** Only check if the pay side is not protected                      158192
     C           PMPPAY    ANDNE'Y'                                       158192
     C** ERROR**                                                          S01297
     C                     MOVE '703'     ERCD,S                          S01297
     C                     ADD  1         S                               S01297
     C                     MOVE '1'       *IN31                           LN0787
     C**********           END                             *END1*   S01297LN0691
     C**********           ELSE                            *ELSE1*  LN0691BHF503
     C                     END                             *END1*         BHF503
     C*                                                                   S01297
     C*                                                                   S01297
     C* IF THE INTERMEDIARY BANK IS NOT BLANK:                            S01297
     C********** PAPIBN    IFNE *BLANK                     **IF3**  BHF584S01297
     C           PMPIBN    IFNE *BLANK                     **IF3**        BHF584
     C*                                                                   S01297
     C* IF INTERMEDIARY BANK A/C LINE IS BLANK DEFAULT, ELSE VALIDATE.    S01297
     C           PMPIBA    IFEQ *BLANK                     **IF4**        S01297
     C                     MOVEL'//FW'    PMPIBA                          S01297
     C                     ELSE                            *ELSE4*        S01297
     C**********           MOVELPMPIBA    CHECK3  3                 S01297LN0691
     C                     MOVELPMPIBA    CHECK4  4                       LN0691
     C********** CHECK3    IFNE '//FW'                     **IF5**  S01297LN0691
     C           CHECK4    IFNE '//FW'                     **IF5**        LN0691
     C** ERROR***                                                         S01297
     C                     MOVE '700'     ERCD,S                          S01297
     C                     ADD  1         S                               S01297
     C                     MOVE '1'       *IN31                           LN0787
     C                     END                             **END5*        S01297
     C*                                                                   S01297
     C                     END                             **END4*        S01297
     C*                                                                   S01297
     C* IF INTERMEDIARY BANK (FIELD 56) IS BLANK:                         S01297
     C                     ELSE                            *ELSE3*        S01297
     C*                                                                   S01297
     C* IF ACCOUNT WITH BANK A/C LINE IS BLANK DEFAULT, ELSE VALIDATE.    S01297
     C           PMAWBA    IFEQ *BLANK                     **IF4**        S01297
     C                     MOVEL'//FW'    PMAWBA                          S01297
     C                     ELSE                            *ELSE4*        S01297
     C**********           MOVELPMAWBA    CHECK3                    S01297LN0691
     C                     MOVELPMAWBA    CHECK4                          LN0691
     C********** CHECK3    IFNE '//FW'                     **IF5**  S01297LN0691
     C           CHECK4    IFNE '//FW'                     **IF5**        LN0691
     C** ERROR***                                                         S01297
     C                     MOVE '701'     ERCD,S                          S01297
     C                     ADD  1         S                               S01297
     C                     MOVE '1'       *IN31                           LN0787
     C                     END                             **END5*        S01297
     C                     END                             **END4*        S01297
     C*                                                                   S01297
     C                     END                             **END3*        S01297
     C*                                                                   S01297
     C**********    *      END                             **END2*  S01297BHF503
     C*                                                                   S01297
     C                     END                             **END1*        S01297
     C                     END                                            LN0691
     C*                                                                   S01297
     C*                                                                   S01297
     C                     ENDSR                                          S01297
     C********************************************************************S01297
      /EJECT                                                              S01297
     C*****************************************************************   S01297
     C*                                                               *   S01297
     C* CHIPS    - 07 PROCESSING                                      *   S01297
     C*                                                               *   S01297
     C* CALLED BY                                                     *   S01297
     C*                                                               *   S01297
     C*****************************************************************   S01297
     C*                                                                   S01297
     C           CHIPS     BEGSR                                          S01297
     C*                                                                   S01297
     C* FIELD 50, ORDERING CUSTOMER (PAY SIDE)                            S01297
     C* --------------------------------------                            S01297
     C* IF THE BENEFICIARY DIFFERS FROM THE DEAL COUNTERPARTY AND THE     S01297
     C* DEAL COUNTERPARTY IS A NON-BANK, THEN DEFAULT TO THE DEAL         S01297
     C* COUNTERPARTY.                                                     S01297
     C*                                                                   S01297
     C           PMPOCN    IFEQ *BLANK                     *IF1**         S01297
     C           PMBENN    IFNE PMCSNM                     *IF2**         S01297
     C           CPBNBI    ANDNE'Y'                                       S01297
     C           BFBNBI    ANDEQ'N'                                       134496
     C                     MOVELPMCSNM    PMPOCN                          S01297
     C                     END                             *END2*         S01297
     C*                                                                   S01297
     C                     END                             *END1*         S01297
     C*                                                                   S01297
     C* FIELD 52 - ORDERING BANK, PAY SIDE.                               S01297
     C* -----------------------------------                               S01297
     C* IF THE BENEFICIARY DIFFERS FROM THE DEAL COUNTERPARTY             S01297
     C* AND THE DEAL COUNTERPARTY IS A BANK THEN DEFAULT TO DEAL          S01297
     C* COUNTERPARTY.                                                     S01297
     C*                                                                   S01297
     C           PMPOBN    IFEQ *BLANK                     *IF1**         S01297
     C*                                                                   S01297
     C           PMBENN    IFNE PMCSNM                     *IF2**         S01297
     C           CPBNBI    ANDEQ'Y'                                       S01297
     C                     MOVELPMCSNM    PMPOBN                          S01297
     C                     END                             *END2*         S01297
     C*                                                                   S01297
     C                     END                             *END1*         S01297
     C**********                                                    S01297BHF519
     C**FOR*SETTLEMENT*TYPE*07*IF*BOTH*FIELD*50*AND*FIELD*52*ARE*BLAS01297BHF519
     C**THEN*DISPLAY*ERROR*MESSAGE*                                 S01297BHF519
     C**********                                                    S01297BHF519
     C********** PMPOCN    IFEQ *BLANK                     *IF1**   S01297BHF519
     C********** PMPOBN    ANDEQ*BLANK                              S01297BHF519
     C** ERROR**                                                    S01297BHF519
     C**********           MOVE '702'     ERCD,S                    S01297BHF519
     C**********           ADD  1         S                         S01297BHF519
     C**********           END                             *END1*   S01297BHF519
     C*                                                                   S01297
     C* IF FIELD 57 IS BLANK THEN DISPLAY ERROR MESSAGE                   S01297
     C********** PMAWBA    IFEQ *BLANK                              S01297LN0691
     C           PMAWBN    IFEQ *BLANK                                    LN0691
     C** ERROR**                                                          S01297
     C                     MOVE '703'     ERCD,S                          S01297
     C                     ADD  1         S                               S01297
     C                     MOVE '1'       *IN31                           LN0787
     C                     END                             *END1*         S01297
     C*                                                                   S01297
     C**IF*NO*VALID*CHIPS*ABA*SET*UP*ON*CUSTOMER*DETAILS*           S01297BHF552
     C**FOR*RECEIVING*BANK*THEN*ERROR.*                             S01297BHF552
     C**USE*INTERMEDIARY*BANK*IF*PRESENT*ELSE*USE*'ACCOUNT WITH'*BANS01297BHF552
     C**********                                                    S01297BHF552
     C********** PMPIBN    IFNE *BLANK                     *IF1**   S01297BHF552
     C**********           MOVELPMPIBN    CSTKEY                    S01297BHF552
     C**********           EXSR CUSGET                              S01297BHF552
     C********** BBCABA    IFEQ *ZERO                      *IF2**   S01297BHF552
     C***ERROR**                                                    S01297BHF552
     C**********           MOVE '704'     ERCD,S                    S01297BHF552
     C**********           ADD  1         S                         S01297BHF552
     C**********           END                             *END2*   S01297BHF552
     C*********            ELSE                            *ELS1*   S01297BHF552
     C*                                                             S01297BHF552
     C********** PAAWBN    IFNE *BLANK                     *IF2**   S01297BHF504
     C**********           MOVELPAAWBN    CSTKEY                    S01297BHF504
     C********** PMAWBN    IFNE *BLANK                     *IF2**   BHF504BHF552
     C**********           MOVELPMAWBN    CSTKEY                    BHF504BHF552
     C**********           EXSR CUSGET                              S01297BHF552
     C********** BBCABA    IFEQ *ZERO                      *IF3**   S01297BHF552
     C***ERROR**                                                    S01297BHF552
     C**********           MOVE '705'     ERCD,S                    S01297BHF552
     C**********           ADD  1         S                         S01297BHF552
     C**********           END                             *END3*   S01297BHF552
     C**********           END                             *END2*   S01297BHF552
     C**********           END                             *END1*   S01297BHF552
     C*                                                             S01297BHF552
     C                     ENDSR                                          S01297
     C*                                                                   S01297
     C*****************************************************************   S01297
      /EJECT                                                              S01297
     C*****************************************************************   S01297
     C*                                                               *   S01297
     C* CUSGET   - To Access customer details                         *   S01297
     C*                                                               *   S01297
     C* CALLED BY       DEFLT, CHIPS, DEF18.                          *   S01297
     C*                                                               *   S01297
     C*****************************************************************   S01297
     C*                                                                   S01297
     C           CUSGET    BEGSR                                          S01297
     C*                                                                   S01297
     C/COPY WNCPYSRC,SD2410C037
     C                     MOVE *BLANKS   RTCD                            S01297
     C*                                                                   S01297
     C                     CALL 'AOCUSTR0'                                S01297
     C                     PARM           RTCD    7                       S01297
     C                     PARM '*KEY   ' OPTN    7                       S01297
     C                     PARM           CSTKEY 10                       S01297
     C                     PARM           KEYSTS  7                       S01297
     C           CURF      PARM CURF      DSSDY                           S01297
     C*                                                                   S01297
     C                     ENDSR                                          S01297
     C*********************************************************************
     C*                                                               *   S01297
     C* PBRGET   - To Obtain Pay Settlement Branch fof Validation     *   S01297
     C*                                                               *   S01297
     C* CALLED BY       DEFLT.                                        *   S01297
     C*                                                               *   S01297
     C*****************************************************************   S01297
     C           PBRGET    BEGSR                                          S01297
     C                     MOVE *BLANKS   RTCD                            S01297
      *                                                                   S01297
     C                     MOVELPMPONS    NOSTRO                          S01297
     C                     MOVELNOST02    @NONB                           S01297
      *                                                                   137252
      **  Beneficiary details are not being defaulted on first time       137252
     C           WPECY     IFNE *BLANKS                                   137252
     C***********          MOVELPMPCCY    @CYCD                    S01297 CEU003
     C                     MOVELWPECY     @CYCD                           CEU003
     C                     ELSE                                           137252
     C                     MOVELPMPCCY    @CYCD                           137252
     C                     END                                            137252
      *                                                                                       162959
     C           PMPSCY    IFNE *BLANKS                                                       162959
     C                     MOVELPMPSCY    @CYCD                                               162959
     C                     ELSE                                                               162959
     C                     MOVELPMPCCY    @CYCD                                               162959
     C                     ENDIF                                                              162959
      *                                                                   108517
      ** Test if the Nostro field contains a '?'.  Remove if found.       108517
      *                                                                   108517
     C                     MOVEA@NONB     @QM                             108517
     C           '?'       LOKUP@QM                      62               108517
     C           *IN62     IFEQ *ON                                       108517
     C                     MOVEL*BLANKS   @NONB                           108517
     C                     ENDIF                                          108517
      *                                                                   S01297
     C**********           CALL 'AONOSTR0'                                             S01297 CDL094
     C                     CALL 'AONOSTR1'                                                    CDL094
     C                     PARM           RTCD                            S01297
     C                     PARM '*KEY   ' OPTN                            S01297
     C                     PARM *BLANKS   @CUST   6                       S01297
     C                     PARM           @CYCD   3                       S01297
     C**********           PARM *BLANKS   @ACCD   4                                    S01297 CGL029
     C                     PARM *BLANKS   @ACCD                                               CGL029
     C                     PARM *BLANKS   @ACSN   2                       S01297
     C                     PARM           @NONB   2                       S01297
     C                     PARM *BLANKS   @BRCD   3                       S01297
     C                     PARM *BLANKS   @CSSN  10                       S01297
     C                     PARM *BLANKS   @PNOI   1                       S01297
     C********** A7RF      PARM A7RF      DSFDY                                        S01297 CDL094
     C           A7RF      PARM A7RF      DSSDY                                               CDL094
     C*                                                                   S01297
     C                     ENDSR                                          S01297
     C*****************************************************************   BHF465
     C*                                                               *   BHF465
     C* RECDEF   - Do Receive side Defaulting                         *   BHF465
     C*                                                               *   BHF465
     C* CALLED BY       MAIN                                          *   BHF465
     C*                                                               *   BHF465
     C*****************************************************************   BHF465
     C*                                                                   BHF465
     C           RECDEF    BEGSR                                          BHF465
     C*                                                                   BHF553
     C***ONLY*DO*DEFAULTS IF IT IS THE FIRST ENTER                  BHF553LN0787
     C********************                                          BHF553LN0787
     C***********PMDEFT    IFEQ 'Y'                        *IF1**   BHF553LN0787
     C*                                                                   BHF572
     C* FIND WHETHER  DEAL COUNTERPARTY IS A BANK AND                     BHF572
     C* STORE INFORMATION FOR LATER USE                                   BHF572
     C*                                                                   BHF572
     C*                                                                   BHF572
     C                     MOVELPMCSNM    CSTKEY                          BHF572
     C                     EXSR CUSGET                                    BHF572
     C           RTCD      IFEQ *BLANK                     *IF1*          BHF572
     C*                                                                   S01408
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,SD2410CCP2                                           S01408
     C*                                                                   S01408
     C**********           MOVELBBBNBI    CPBNBI  1                BHF572 099441
     C                     MOVELBBSWFI    CPBNBI  1                       099441
     C                     MOVELBBCSID    CPCSID 12                       BHF572
     C                     ELSE                                           BHF572
     C                     GOTO ERROR                                     BHF572
     C                     END                             *END1*         BHF572
     C*                                                                   BHF553
     C** IF BOTH ORDERING CUSTOMER AND ORDERING BANK ARE BLANK            BHF553
     C** AND THE DEAL COUNTERPARTY IS A BANK DEFAULT ORDERING             BHF553
     C** BANK TO THE CUSTOMER                                             BHF553
     C*                                                                   BHF465
     C           CPBNBI    IFEQ 'Y'                        *IF2**         BHF465
     C           PMROCN    ANDEQ*BLANKS                                   BHF553
     C           PMROBN    ANDEQ*BLANKS                                   BHF553
     C                     MOVE PMCSNM    PMROBN                          BHF465
     C**********           ELSE                                     BHF465BHF553
     C                     END                             *END2*         BHF553
     C*                                                                   BHF553
     C** IF BOTH ORDERING CUSTOMER AND ORDERING BANK ARE BLANK            BHF553
     C** AND THE DEAL COUNTERPARTY IS NOT A BANK DEFAULT ORDERING         BHF553
     C** CUSTOMER TO THE CUSTOMER                                         BHF553
     C*                                                                   BHF553
     C           CPBNBI    IFEQ 'N'                         *IF3**        BHF465
     C           PMROBN    ANDEQ*BLANKS                                   BHF553
     C           PMROCN    ANDEQ*BLANKS                                   BHF55D
     C                     MOVE PMCSNM    PMROCN                          BHF465
     C                     END                              *END3*        BBHF55
     C*********************END                              *END1*  BHF553LN0787
     C                     MOVE 'N'       PMDEFR                          LN0787
     C           ERROR     TAG
     C                     ENDSR                                          BHF465
     C*                                                                   BHF465
     C*****************************************************************   BHF465
     C*                                                                   S01408
     C/COPY ZSRSRC,ZDATE1Z2                                               CSW005
     C/COPY ZSRSRC,ZXRATEZ1                                                                   CLE031
     C/COPY WNCPYSRC,SD2410CP19                                           S01408
     C*                                                                   S01408
      *                                                                   S01408
      /COPY WNCPYSRC,SD2410CEND                                           S01408
      *                                                                   S01408
      /COPY WNCPYSRC,SD2410ADTA                                           S01408
      /EJECT                                                                                  CLE031
     C/COPY ZSRSRC,ZEDITZ2                                                                    CLE031
**  CPY@
(c) Misys International Banking Systems Ltd. 2001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   SVAL  -  SYSTEM VALUES ARRAY                                                             CLE033
Settlement09Customer                                                                          CLE033
Settlement09AccCode                                                                           CLE033
Settlement09Hostpgm                                                                           CLE033
Settlement09Postings                                                                          218782
