000100210712     H        1
000200210712      *****************************************************************
000300210712/*STD *  RPGBASE                                                      *
000400210712/*EXI *  TEXT('Midas SD Settlement details validation')               *
000500210712     F*****************************************************************
000600210712     F*                                                               *
000700210712     F*  Midas Standing Data Module                                   *
000800210712     F*                                                               *
000900210712     F*     This program will be made redundant at DBA R4.00          *
001000210712     F*     In the interim please check the new ILE RPG versions      *
001100210712     F*     and apply any new fixes if they are appropriate.          *
001200210712     F*                                                               *
001300210712     F*  SD2410 - Settlement Details Validation                       *
001400210712     F*                                                               *
001500210712      *  (c) Finastra International Limited 2001                      *
001600210712      *                                                               *
001700210712      *  Last Amend No. CSW221             Date 05Apr21               *
001800210712      *  Prev Amend No. MD056763           Date 26Sep20               *
001900210712      *                 MD051567           Date 26Sep20               *
002000210712      *                 MD027449           Date 06Nov19               *
002100210712      *                 MD046248           Date 27Oct17               *
002200210712      *                 MD031820           Date 06Aug15               *
002300210712      *                 MD030943           Date 25Nov14               *
002400210712      *                 MD030342           Date 25Nov14               *
002500210712      *                 CSW214             Date 25Nov14               *
002600210712      *                 CDL094             Date 01Sep14               *
002700210712      *                 254023             Date 19Aug14               *
002800210712      *                 MD026990           Date 20May14               *
002900210712      *                 MD022522           Date 02Oct13               *
003000210712      *                 CSW213             Date 03Jun13               *
003100210712      *                 CMG003             Date 04Oct12               *
003200210712      *                 AR853732           Date 29Oct12               *
003300210712      *                 AR995086           Date 26Jun12               *
003400210712      *                 AR992011           Date 19Jun12               *
003500210712      *                 CSW212             Date 03May12               *
003600210712      *                 CRE075             Date 06Dec10               *
003700210712      *                 CER059             Date 19Jul10               *
003800210712      *                 CER047             Date 19May08               *
003900210712      * Bank Fusion Midas 1.4 Base -----------------------------------*
004000210712      *                 260577             Date 04Jun09               *
004100210712      * Midas Plus 1.4 Base 04 ---------------------------------------*
004200210712      *                 246415             Date 14Mar07               *
004300210712      * Midas Plus 1.4 Base ------------------------------------------*
004400210712      * Midas Plus 1.3 ----------- Base ------------------------------*
004500210712      *                 240971             Date 19Oct06               *
004600210712      *                 CSD031             Date 10Apr06               *
004700210712      *                 CSD027             Date 09Dec05               *
004800210712      *                 BUG7139            Date 12May05               *
004900210712      *                 CSW037A            Date 02May05               *
005000210712      *                 BUG6198            Date 04Apr05               *
005100210712      *                 CSD025             Date 11Jan05               *
005200210712      *                 CSW037             Date 15Dec04               *
005300210712      *                 CSW036             Date 15Dec04               *
005400210712      *                 CLE025             Date 20Oct03               *
005500210712      *                 TDA088             Date 28Mar04               *
005600210712      *                 CGL029             Date 01Sep03               *
005700210712      *                 222373             Date 24Oct03               *
005800210712      *                 221891             Date 10Oct03               *
005900210712      *                 219495             Date 08Jul03               *
006000210712      *                 218782             Date 20Jun03               *
006100210712      *                 218906             Date 18Jun03               *
006200210712      *                 221452             Date 27May03               *
006300210712      *                 CLE033             Date 20Mar03               *
006400210712      *                 CLE031             Date 11Feb03               *
006500210712      *                 214110             Date 19Feb03               *
006600210712      *                 219241             Date 01Jul03               *
006700210712      *                 CSW203             Date 26May03               *
006800210712      * Midas Release 4.01.01 ----------------------------------------*
006900210712      *                 CSW202             Date 20May02               *
007000210712      * Midas Release 4.01 -------------------------------------------*
007100210712      *                 181340             Date 16Aug01               *
007200210712      * Midas Release 4 --------------- Base -------------------------*
007300210712      *                 CSW201             Date 02May01               *
007400210712      *                 191152             Date 16Jul01               *
007500210712      *                 193584             Date 08Jun01               *
007600210712      * Midas DBA 3.05 -----------------------------------------------*
007700210712      *                 162959             Date 18Feb01               *
007800210712      *                 178889             Date 13Feb01               *
007900210712      * Midas DBA 3.04 -----------------------------------------------*
008000210712      *                 186433             Date 20Nov00               *
008100210712      *                 108195             Date 31Oct00               *
008200210712      *                 CDL008             Date 02May00               *
008300210712      * Midas DBA 3.03 -----------------------------------------------*
008400210712      *                 CSW200             Date 21Aug00               *
008500210712      *                 141865             Date 23Nov99               *
008600210712      * Midas DBA 3.02 -----------------------------------------------*
008700210712     F*                 CSW097             Date 02DEC99               *
008800210712     F*                 169210             DATE 14Oct99               *
008900210712      * Midas DBA 3.00 ---------------- Base -------------------------*
009000210712     F*                 157861             Date 31Mar99               *
009100210712     F*                 158192 (BD5288)    DATE 29Mar99               *
009200210712      *                 149200             Date 11Dec98               *
009300210712      *                 142408             Date 02Oct98               *
009400210712      *                 134496             Date 19Jan99               *
009500210712     F*                 139921             Date 05OCT98               *
009600210712     F*                 137488             Date 02Jul98               *
009700210712     F*                 137252             Date 17Jun98               *
009800210712     F*                 135303             Date 15May98               *
009900210712     F*                 134935             Date 10May98               *
010000210712     F*                 CEU003             Date 29Mar98               *
010100210712     F*                 108752             DATE 23FEB98               *
010200210712     F*                 117870             DATE 20FEB98               *
010300210712     F*                 108517             DATE 17FEB98               *
010400210712     F*                 118948             DATE 27JAN98               *
010500210712     F*                 100757             DATE 23JAN98               *
010600210712     F*                 110514             DATE 08JAN98               *
010700210712     F*                 099441             DATE 12APR96               *
010800210712     F*                 113832             DATE 05FEB97               *
010900210712     F*                 CLE003             DATE 20DEC96               *
011000210712     F*                 CSW011             DATE 21MAR97               *
011100210712     F*                 CSW005             DATE 01AUG96               *
011200210712     F*                 101041             DATE 05MAR97               *
011300210712     F*                 093565             DATE 01AUG96               *
011400210712     F*                 CSW096             DATE 18JUN96               *
011500210712     F*                 S01408             DATE 29MAY96               *
011600210712     F*                 082376             DATE 22APR96               *
011700210712     F*                 082386             DATE 22APR96               *
011800210712     F*                 088364             DATE 22APR96               *
011900210712     F*                 S01408             DATE 12APR96               *
012000210712     F*                 S01408             DATE 06MAR96               *
012100210712     F*                 070083             DATE 26FEB96               *
012200210712     F*                 S01408             DATE 24JAN96               *
012300210712     F*                 096151             DATE 17NOV95               *
012400210712     F*                 S01408             DATE 18AUG95               *
012500210712     F*                 094100             DATE 04OCT95               *
012600210712     F*                 092396             DATE 23AUG95               *
012700210712     F*                 CSW095             DATE 20APR95               *
012800210712     F*                 S01408             DATE 20JUL95               *
012900210712     F*                 S01408             DATE 10MAY95               *
013000210712     F*                 S01408             DATE 19AUG94               *
013100210712     F*                 S01408             DATE 17MAY94               *
013200210712     F*                 060036             DATE 06APR94               *
013300210712     F*                 066875             DATE 15MAR94               *
013400210712     F*                 060470             DATE 16NOV93               *
013500210712     F*                 056847             DATE 29SEP93               *
013600210712     F*                 056626             DATE 29SEP93               *
013700210712     F*                 058132             DATE 29SEP93               *
013800210712     F*                 S01429             DATE 13JUL93               *
013900210712     F*                 056873             DATE 01JUL93               *
014000210712     F*                 043712             DATE 28JUN93               *
014100210712     F*                 052290             DATE 22JUN93               *
014200210712     F*                 S01412             DATE 05MAY93               *
014300210712     F*                 033351             DATE 20APR93               *
014400210712     F*                 E24104             DATE 14APR93               *
014500210712     F*                 E45796             DATE 29MAR93               *
014600210712     F*                 E30756             DATE 13JAN93               *
014700210712     F*                 E26903             DATE 13JAN93               *
014800210712     F*                 E31261             DATE 09DEC92               *
014900210712     F*                 E31589             DATE 29NOV92               *
015000210712     F*                 035701             DATE 27MAY92               *
015100210712     F*                 E28710             DATE 11MAR92               *
015200210712     F*                 DT0069             DATE 07MAY91               *
015300210712     F*                 E26771             DATE 20AUG91               *
015400210712     F*                 E24039             DATE 16AUG91               *
015500210712     F*                 E26971             DATE 06AUG91               *
015600210712     F*                 BHF908             DATE 14NOV90               *
015700210712     F*                 BHF810             DATE 11OCT90               *
015800210712     F*                 BHF766             DATE 05OCT90               *
015900210712     F*                 DT0168             DATE 15MAY91               *
016000210712     F*                 BHF764             DATE 04OCT90               *
016100210712     F*                 BHF758             DATE 03OCT90               *
016200210712     F*                 BHF759             DATE 03OCT90               *
016300210712     F*                 LN0830             DATE 03OCT90               *
016400210712     F*                 LN0806             DATE 27SEP90               *
016500210712     F*                 LN0798             DATE 27SEP90               *
016600210712     F*                 LN0787             DATE 21SEP90               *
016700210712     F*                 LN0785             DATE 19SEP90               *
016800210712     F*                 BHF647             DATE 19SEP90               *
016900210712     F*                 LN0783             DATE 19SEP90               *
017000210712     F*                 LN0782             DATE 19SEP90               *
017100210712     F*                 LN0765             DATE 17SEP90               *
017200210712     F*                 LN0759             DATE 14SEP90               *
017300210712     F*                 LN0749             DATE 13SEP90               *
017400210712     F*                 LN0748             DATE 13SEP90               *
017500210712     F*                 BHF352             DATE 11SEP90               *
017600210712     F*                 BHF564             DATE 06SEP90               *
017700210712     F*                 BHF596             DATE 06SEP90               *
017800210712     F*                 BHF595             DATE 06SEP90               *
017900210712     F*                 BHF585             DATE 05SEP90               *
018000210712     F*                 BHF572             DATE 05SEP90               *
018100210712     F*                 BHF582             DATE 03SEP90               *
018200210712     F*                 BHF569             DATE 03SEP90               *
018300210712     F*                 BHF553             DATE 02SEP90               *
018400210712     F*                 BHF552             DATE 02SEP90               *
018500210712     F*                 BHF547             DATE 02SEP90               *
018600210712     F*                 BHF465             DATE 31AUG90               *
018700210712     F*                 BHF519             DATE 31AUG90               *
018800210712     F*                 BHF517             DATE 31AUG90               *
018900210712     F*                 BHF506             DATE 30AUG90               *
019000210712     F*                 BHF504             DATE 30AUG90               *
019100210712     F*                 BHF503             DATE 29AUG90               *
019200210712     F*                 LN0691             DATE 26AUG90               *
019300210712     F*                 LN0657             DATE 22AUG90               *
019400210712     F*                 S01297             DATE 20AUG90               *
019500210712     F*                 E22405             DATE 16AUG90               *
019600210712     F*                 E22614             DATE 01AUG90               *
019700210712     F*                 E21702             DATE 01AUG90               *
019800210712     F*                 E21860             DATE 17JUL90               *
019900210712     F*                 LN0455             DATE 02JUL90               *
020000210712     F*                 S01117             DATE 21JUN90               *
020100210712     F*                 S01117             DATE 15JUN90               *
020200210712     F*                 S01117             DATE 07JUN90               *
020300210712     F*                 S01117             DATE 05JUN90               *
020400210712     F*                 S01117             DATE 01JUN90               *
020500210712     F*                 S01117             DATE 31MAY90               *
020600210712     F*                 S01117             DATE 30MAY90               *
020700210712     F*                 S01117             DATE 17APR90               *
020800210712     F*                 S01117             DATE 06APR90               *
020900210712     F*                 S01227             DATE 06NOV89               *
021000210712     F*                 E83                DATE 20NOV89               *
021100210712     F*                 E00033             DATE 07NOV89               *
021200210712     F*                 S01117             DATE 13/06/89              *
021300210712     F*                                                               *
021400210712     F*---------------------------------------------------------------*
021500210712     F*                                                               *
021600210712      *  CSW221   - SWIFT Changes 2021                                *
021700210712      *  MD056763 - ISDA Rules version must be a valid year starting  *
021800210712      *             with 199 or 20.                                   *
021900210712      *  MD051567 - ISDA Rules version must be a valid year starting  *
022000210712      *             with 199 or 20.                                   *
022100210712      *           - Applied for MD056763                              *
022200210712      *  MD027449 - Payment Ordering Customer defaulted to customer   *
022300210712      *             of extended settlement. Default payment ordering  *
022400210712      *             customer if field is left blank.                  *
022500210712      *  MD046248 - Finastra Rebranding                               *
022600210712      *  MD031820 - No validation for valid values for Agreement Type *
022700210712      *             for transaction type 'AT' for MT600               *
022800210712      *  MD030943 - Duplicate error message for Agreement Type        *
022900210712      *  MD030342 - Valid values for Agreement Type for FX and AT     *
023000210712      *             transaction types for MT600                       *
023100210712      *  CSW214 - SWIFT Changes 2014                                  *
023200210712      *  CDL094 - Enhance  Receive Settlement Instructions            *
023300210712      *  254023 - Wrong error code being passed to SD0402R for ISDA.  *
023400210712      *           EXSS - ISDA cannot be input as 2006.                *
023500210712      *  MD026990 - ISDA fields should not be mandatory when CSW005   *
023600210712      *             is switched off                                   *
023700210712      *  MD022522 - Invalid bank to Bank field. First character of    *
023800210712      *             bank to bank field must be a / followed by a      *
023900210712      *             valid codeword                                    *
024000210712      *  CSW213 - SWIFT Changes 2013                                  *
024100210712      *  CMG003 - SWIFT MT600 Message Generation                      *
024200210712      *  AR853732 - Retail account with 11 digits was accepted w/out  *
024300210712      *             errors. Additional checking on positions 11-18 of *
024400210712      *             received parameter. (Child: AR853733)             *
024500210712      *  AR995086 - Agreement types validation not executed           *
024600210712      *  AR992011 - Error in AOCREPT program                          *
024700210712      *  CSW212 - SWIFT 2012 Changes                                  *
024800210712      *  CRE075 - Effective Date for Retail Accounts (Recompile)      *
024900210712      *  CER059 - German Feature Upgrade to Delhi                     *
025000210712      *  CER047 - German Features LF037-00 Reporting §24c KWG         *
025100210712      *           (Recompile)                                         *
025200210712      *  260577 - Unable to amend loan Maturity Date via API (MQU).   *
025300210712      *           Applied R4 fix 120800 not to validate settlement    *
025400210712      *           when pay/receive flag is protected.                 *
025500210712      *  246415 - Correct validation of 'Details fo Charges'.         *
025600210712      *           Adapt BUG4511 from ZASETINVAL.                      *
025700210712      *  240971 - For settlement 04, do not check values of RECI      *
025800210712      *           and ACST when subroutine CHKAC is not called.       *
025900210712      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
026000210712      *  CSD027 - Conversion Of Customer Number to Alpha              *
026100210712      *  BUG7139- SSI type DV should be same validation as RS/RX.     *
026200210712      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
026300210712      *  BUG6198- Cannot save new Details for CUSD (Recompile)        *
026400210712      *  CSD025 - RS or RX De-Activation                              *
026500210712      *  CSW037 - Additional Field Data on MT300/MT320                *
026600210712      *  CSW036 - Dual SWIFT BIC held on Client Details               *
026700210712      *  CLE025 - Credit Lines (Recompile)                            *
026800210712      *  TDA088 - Amend to allow input of 10-digit retail account     *
026900210712      *           number as valid settlement account.                 *
027000210712      *  CGL029 - Increase Account Code to 10 digits                  *
027100210712      *  222373 - Parameter mismatch.                                 *
027200210712      *  221891 - Amendment to CLE033. Do not default exchange rates  *
027300210712      *           if settling through 09.                             *
027400210712      *  219495 - Amendment to CLE031. Do not validate Settlement Ccy *
027500210712      *           Dealing Ind. if settlement details are protected.   *
027600210712      *  218782 - Check system value Settlement09Postings to decide   *
027700210712      *           whether to use Settlement or Transaction Ccy.       *
027800210712      *  218906 - If this program has been called from the Extended   *
027900210712      *           Settlements Maintenance screen for Method 09, don't *
028000210712      *           validate, as branch code is unavailable.            *
028100210712      *  221452 - If CLE033 is on and Swift for Lending is not on     *
028200210712      *           then allow free format info in the Swift fields     *
028300210712      *           for settlement method 09                            *
028400210712      *  CLE033 - Settlement method 09 - Set up of currency for       *
028500210712      *           receive method 09 incorrect                         *
028600210712      *  CLE033 - Settlement method 09                                *
028700210712      *  CLE031 - Lending Enhancements                                *
028800210712      *  214110 - Allow 'SHA' code on details of charges field and    *
028900210712      *           ensure that allowed values are validated correctly. *
029000210712      *  219241 - Defaulting of "Details of Charges" assign a         *
029100210712      *           system value                                        *
029200210712      *  CSW203 - SWIFT 2003 Standards Update                         *
029300210712      *  CSW202 - SWIFT 2002 Standards Update                         *
029400210712      *  181340 - If Nostro was inserted on field 57, no validation   *
029500210712      *           exist for ESM0971 (acct w/ bank must be SWIFT       *
029600210712      *           financial institution).  Add validation.            *
029700210712      *  CSW201 - SWIFT 2001 Standards Update                         *
029800210712      *  191152 - Check the receipt and pay accounts (if both exist)  *
029900210712      *           if both are converted to EURO before the settlement *
030000210712      *           currency can be successfully amended to 'EUR'.      *
030100210712      *  193584 - When the nostro is a CLS Dummy nostro,              *
030200210712      *           entry should not be allowed in :                    *
030300210712      *           the Account detail line for fields 56 and 57.       *
030400210712      *  162959 - Error message "Beneficiary invalid - see second     *
030500210712      *           level text" shown when no beneficiary has been      *
030600210712      *           entered. No error message should show if the        *
030700210712      *           beneficiary field is left blank.                    *
030800210712      *  178889 - Pay side of the FX deal should check if the retail  *
030900210712      *           account is active on the system.                    *
031000210712     F*  186433 - Missing code from CDL008.                           *
031100210712      *  108195 - If an account is closed it should not be a valid    *
031200210712      *           settlement account.                                 *
031300210712      *  CDL008 - Continuous Linked Settlement                        *
031400210712     F*  CSW200 - Swift 2000 Changes                                  *
031500210712     F*  141865 - Extend 139921 to include settlement type '04'       *
031600210712     F*  CSW097 - Allow ISDA fields for FR type transactions          *
031700210712     F*  169210 - Requested hooks are duplicates                      *
031800210712     F*           Renamed SD2410C049 to SD2410CX49                    *
031900210712     F*           Renamed SD2410C054 to SD2410CX54                    *
032000210712      *  157861 - Should not default an ordering customer that is a   *
032100210712      *           bank if beneficiary is non bank                     *
032200210712     F*  BD5288 - If CHIPS settlement and pay side is protected       *
032300210712     F*           then do not validate the payment fields as you      *
032400210712     F*           cannot amend them anyway.                           *
032500210712      *  149200 - Incorrect nostro error rejects fee                  *
032600210712      *  142408 - Should be able to make the beneficiary a bank on    *
032700210712      *           part sold.                                          *
032800210712      *  134496 - Should not have to input 50 if beneficiary is bank  *
032900210712     F*  139921 - Mesg  ESM0886 output in error because field PMROBR  *
033000210712     F*           is not blank for settlement other than '05' - field *
033100210712     F*           is set up on valid'n, then get error on subsequent  *
033200210712     F*           validation as field has data. Fix is to blank PMROBR*
033300210712     F*           for settlement types other than '05' and allow field*
033400210712     F*           to be set up with the correct branch code, as       *
033500210712     F*           happens on first validation run.                    *
033600210712     F*           Same applied to Pay Branch PMPOBR.                  *
033700210712     F*           Applied associated fix GEMS #136559 .               *
033800210712     F*  137488 - Fix on extended settlement instructions. If a       *
033900210712     F*           retail a/c is entered, the re a/c ccy is validated  *
034000210712     F*           against the settlement currency, whereas it should  *
034100210712     F*           be the main currency code.                          *
034200210712     F*  137252 - Euro incorporation - beneficiary details not being  *
034300210712     F*           defaulted correctly first time in.                  *
034400210712     F*  135303 - Deals cannot be authorised due to errors in         *
034500210712     F*           settlement details.                                 *
034600210712     F*  134935 - Settlement currency not shown/amendable if          *
034700210712     F*           transition starts before value date                 *
034800210712     F*  CEU003 - EMU Dealing Settlement Ccy Conversion               *
034900210712     F*  108752 - ERROR MESSAGE SHOULD ONLY SHOW WHEN LIVE NOSTRO     *
035000210712     F*           IS NOT FOUND.                                       *
035100210712     F*  117870 - APPLY FIX 110122                                    *
035200210712     F*         - VALIDATION BYPASSED IN INSERT MODE                  *
035300210712     F*         - BACK VALUE PERIOD AND DATE ACCOUNT OPENED NOT       *
035400210712     F*           CHECKED FOR SETTLEMENT METHOD 4                     *
035500210712     F*         - Partially apllied by 100757 .                       *
035600210712     F*  108517 - Allow '?' processing in 'Receipts' and 'Payments' - *
035700210712     F*           'Our Nostro'.                                       *
035800210712     F*  118948 - Validate settlement details even if the deal is     *
035900210712     F*           back-valued. Errors on accounting have been found   *
036000210712     F*           to be caused by skipping this routine.              *
036100210712     F*  100757 - If the settlement method is 04, the payment date    *
036200210712     F*           still has to be checked if it is less than the      *
036300210712     F*           date the retail account was opened.  If it is,      *
036400210712     F*           then a corresponding error message should be        *
036500210712     F*           generated.                                          *
036600210712     F*  110514 - Remove fix 070083 so Account With Bank can be input *
036700210712     F*           if it is same as Beneficiary Bank - this is allowed *
036800210712     F*           by SWIFT standards.                                 *
036900210712     F*  099441 - Replace bank/non-bank flag with financial           *
037000210712     F*           institution flag.                                   *
037100210712     F*  113832 - Fix parameter miss match when extended settements   *
037200210712     F*           is  called.                                         *
037300210712     F*  CLE003 - Backvaluation in Customer Lending Enhancements      *
037400210712      *  CSW011 - FRA MT34n only Message Generation                   *
037500210712     F*  CSW005 - FRAIRS MT34n, MT36n Message Generation              *
037600210712     F*  101041 - Do not allow defaulting of field 52 when            *
037700210712     F*           it has an original value. Defaulting should only    *
037800210712     F*           work when it is blank.                              *
037900210712     F*  093565 - Allow user to generate MT202 for counterparty cust  *
038000210712     F*           being a private customer. Do no default Ordering    *
038100210712     F*           customer if Ordering bank entered                   *
038200210712     F*  CSW096 - SWIFT November 96 Changes                           *
038300210712     F*           Externalise Currency Clearing Validation            *
038400210712     F*  S01408 - Core hook SD2410CP20 added                          *
038500210712     F*  082376 - Correct output of error messages.                   *
038600210712     F*  082386 - Allows entry of field 56 (Intermediary Bank)        *
038700210712     F*           without a value being entered into field 57         *
038800210712     F*           (Account With Bank)                                 *
038900210712     F*  088364 - Not printing error message on payment settlement    *
039000210712     F*  S01408 - Core hook SD2410CP18 added                          *
039100210712     F*           Core hook SD2410CP19 added                          *
039200210712     F*  S01408 - Core hook SD2410CP16 added                          *
039300210712     F*           Core hook SD2410CP17 added                          *
039400210712     F*  070083 - Remove NY fix LN0749 as it is not appropriate here. *
039500210712     F*  S01408 - Core hook SD2410CP14 added                          *
039600210712     F*           Core hook SD2410CP15 added                          *
039700210712     F*  096151 - S.W.I.F.T 1995 has been enforced.    Do not         *
039800210712     F*           allow bank to bank information to start with "//"   *
039900210712     F*           and to be followed by all blank.                    *
040000210712     F*           This is the Lux version of the fix which replaces   *
040100210712     F*           092396 (for source LE0120 and SD2410 only)          *
040200210712     F*  S01408 - Core hook SD2410CP13 added                          *
040300210712     F*  094100 - SWIFT have changed their minds and the Swiss        *
040400210712     F*           SIC Clearing code is 5 not 6 characters long.       *
040500210712     F*  092396 - Sender to Receiver cannot contain '//' followed     *
040600210712     F*           by blanks.                                          *
040700210712     F*  CSW095 - S.W.I.F.T 1995 Message Changes.                     *
040800210712     F*           Add Swiss Clearing system code '//SWnnnnnn'.        *
040900210712     F*  S01408 - Core hook SD2410CVS3 added                          *
041000210712     F*           Core hook SD2410CVS4 added                          *
041100210712     F*           Core hook SD2410ADTA added                          *
041200210712     F*  S01408 - Core hook SD2410CCPG added                          *
041300210712     F*           Core hook SD2410CVS1 added                          *
041400210712     F*           Core hook SD2410CVS2 added                          *
041500210712     F*           Core hook SD2410FFPG added                          *
041600210712     F*           Core hook SD2410IIPG added                          *
041700210712     F*           Core hook SD2410CCP3 added                          *
041800210712     F*           Core hook SD2410CCP4 added                          *
041900210712     F*           Core hook SD2410CCP5 added                          *
042000210712     F*           Core hook SD2410CCP6 added                          *
042100210712     F*           Core hook SD2410CCP7 added                          *
042200210712     F*           Core hook SD2410CCP8 added                          *
042300210712     F*           Core hook SD2410CCP9 added                          *
042400210712     F*           Core hook SD2410CP10 added                          *
042500210712     F*           Core hook SD2410CEND added                          *
042600210712     F*           Core hook SD2410CP11 added                          *
042700210712     F*           Core hook SD2410CP12 added                          *
042800210712     F*  S01408 - Core hook SD2410CCP1 added                          *
042900210712     F*           Core hook SD2410CCP2 added                          *
043000210712     F*  S01408 - Core hook SD2410CVSF added                          *
043100210712     F*  060036 - No validation check for incorrect account line,     *
043200210712     F*           e.g. '/A/C' or A/C after the account number slash   *
043300210712     F*           has been entered.  Validate a/c no. line starting   *
043400210712     F*           with /n/, where n can only be 'C' or 'D'.           *
043500210712     F*  066875 - For Settlement Type '05', after validation of the   *
043600210712     F*           settlement account, move this account no to the     *
043700210712     F*           field as the system will have defaulted the account *
043800210712     F*           seq. number if this was blank/zero - this ensures   *
043900210712     F*           that the correct account is written to the file.    *
044000210712     F*  060470 - For settlement method 14 (retail accounts),         *
044100210712     F*           program should check if account has already         *
044200210712     F*           been closed (Account Status ACST is 'C').           *
044300210712     F*           The same checking should also be done for           *
044400210712     F*           settlement methods 04 and 05.                       *
044500210712     F*           (Please note that part of this fix was already      *
044600210712     F*           applied by 056626 for settl method '05'.            *
044700210712     F*  056847 - Allow input of sort code //CH in field 56 account   *
044800210712     F*           line. Also, add codes not applied by fix 056873 in  *
044900210712     F*           allowing //SC in field 56 account line.             *
045000210712     F*  056626 - If settlement method is '05' system should not      *
045100210712     F*           accept closed retail account.                       *
045200210712     F*  058132 - Branch Code for Account compared against incorrect  *
045300210712     F*           data item when checking for Single Branch Code      *
045400210712     F*  S01429 - Chips ABA number modification from 3A to 4A         *
045500210712     F*           for Chips II. Also do not allow 0000 ABA numbers.   *
045600210712     F*  056873 - To allow intermediary bank to be the same as        *
045700210712     F*           our nostro and to allow '//SC' in intermediary      *
045800210712     F*           bank a/c line                                       *
045900210712     F*  043712 - Deal amendment not using relevant settlement        *
046000210712     F*           instructions.                                       *
046100210712     F*  052290 - For a deposit , do not validate the opening date    *
046200210712     F*           of account against maturity date                    *
046300210712     F*  S01412 - SWIFT September '93 Message Changes.                *
046400210712     F*           Field :56a: on an MT100 can now use option D,       *
046500210712     F*           ie. it is no longer essential for Intermediary      *
046600210712     F*           to have a SWIFT address in cases where an MT100     *
046700210712     F*           is to be produced. This change makes the /IBK/      *
046800210712     F*           codeword in field :72: unnecessary.                 *
046900210712     F*            o Remove validation which checks for intermediary  *
047000210712     F*              SWIFT address if beneficiary is a non-bank       *
047100210712     F*            o Remove processing for /IBK/ codeword             *
047200210712     F*            o Add validation to check lines begin '//'         *
047300210712     F*              if they do not begin with /8a/                   *
047400210712     F*  033351 - ENTRY IN FLD72 SHOULD BE ALLOWED FOR ALL SET        *
047500210712     F*           EXCEPT 00.                                          *
047600210712     F*  E24104 - Settlements can pass entries on accounts that do    *
047700210712     F*           not exist.                                          *
047800210712     F*  E45796 - If Settlement Method 14 (Retail Account) is used    *
047900210712     F*           and Account is blocked, no warning is given.        *
048000210712     F*  E30756 - SWIFT does not require the ordering bank field      *
048100210712     F*           to have any information in for pay messages         *
048200210712     F*           (MT202/3). Amended program to remove defaulting     *
048300210712     F*           to beneficiary for pays.                            *
048400210712     F*  E26903 - The ordering customer/bank on settlement            *
048500210712     F*           instructions should default (as applicable) to      *
048600210712     F*           counterparty if left blank. Data passed back        *
048700210712     F*           to SD2400. Also check that ordering customer        *
048800210712     F*           is a non-bank - Two new error codes added: 803      *
048900210712     F*           & 804.                                              *
049000210712     F*  E31261 - Pgm doesn't accept that intermediary bank name      *
049100210712     F*           is same as account with bank                        *
049200210712     F*  E31589 - Do not validate date of receipt if input fields     *
049300210712     F*           were protected.                                     *
049400210712     F*  035701 - Correction to E24039 . Validates Pay side when      *
049500210712     F*           Receive side changed.                               *
049600210712     F*  E28710 - CPBNBI retains data thus invalid error message      *
049700210712     F*           flags during authorization. So, fix is done to      *
049800210712     F*           reset the default bank indicator (CPBNBI).          *
049900210712     F*  DT0069 - Dealing Release 10 System Test error fix:           *
050000210712     F*           if 'Account With' is left blank, the system         *
050100210712     F*           currently assumes, on confirmations, that the       *
050200210712     F*           account is with the nostro; this is not             *
050300210712     F*           necessarily so; this program has therefore been     *
050400210712     F*           changed to allow the input of a Nostro Number       *
050500210712     F*           into 'Account With'; the message generation         *
050600210712     F*           programs can then assume 'UNKNOWN' when Account     *
050700210712     F*           With is blank.                                      *
050800210712     F*  E26771 - INTERMEDIARY, ACCOUNT WITH, AND BENEFICIARY         *
050900210712     F*           can be counterparty nostros for settlement          *
051000210712     F*           method 08 ie part reversal of BHF810                *
051100210712     F*  E24039 - Does not allow amendment of maturity side of        *
051200210712     F*           EXTENDED SETTLEMENTS if deal valued before the      *
051300210712     F*           back valued period                                  *
051400210712     F*  E26971 - If the Beneficiary field is not entered, it         *
051500210712     F*           should default to the same value as the             *
051600210712     F*           counterparty of the deal.  At present this          *
051700210712     F*           happens for Settlement Type 08, but not for 01.     *
051800210712     F*  DT0168 - Error on PMPOBR validation                          *
051900210712     F*  BHF908 - To restrict to backvalue period to retail accts     *
052000210712     F*  BHF810 - PAY SIDE - for settlement methods 07 AND 08         *
052100210712     F*           INTERMEDIARY, ACCOUNT WITH, AND BENEFICIARY         *
052200210712     F*           can not be counterparty nostros.                    *
052300210712     F*  BHF766 - On pay side: If COUNTERPARTY = BENEFICIARY & is     *
052400210712     F*           a bank, no default should occur on field 52         *
052500210712     F*  BHF764 - Deal counterparty must be a bank for defaulting     *
052600210712     F*           field 72 to /INS/.                                  *
052700210712     F*  BHF758 - Always validate defaulting when '07'                *
052800210712     F*  BHF759 - If settl.method '07' beneficiary is mandatory       *
052900210712     F*  LN0830 - Validation errors occur if settlement method        *
053000210712     F*           is changed                                          *
053100210712     F*  LN0806 - Condition receive side defaulting on receive        *
053200210712     F*           side defaulting indicator being 'Y' (SETTLEMENT     *
053300210712     F*           METHOD 01).                                         *
053400210712     F*  LN0798 - Either ordering customer or ordering branch         *
053500210712     F*           must be entered for SETTLEMENT TYPE 01 OR 08        *
053600210712     F*           on the receive side.                                *
053700210712     F*  LN0787 - Mandatory insertion of ordering customer should     *
053800210712     F*           be conditioned properly, also allow defaulting      *
053900210712     F*              on ammend.                                       *
054000210712     F*  LN0785 - correct error codes.                                *
054100210712     F*  BHF647 - fed A/C NO. not mandatory on 'A/C WITH BANK'        *
054200210712     F*           line - //FW is sufficient.                          *
054300210712     F*  LN0783 - fix to BHF582. validate beneficiary if entered.     *
054400210712     F*  LN0782 - If either beneficiary or deal c/party is a          *
054500210712     F*           non bank default field 50 should default to the     *
054600210712     F*           deal c/party (pay side)                             *
054700210712     F*  LN0765 - fix to BHF595.                                      *
054800210712     F*  LN0759 - ammend BHF564 to check error array index at         *
054900210712     F*           correct point within the program.                   *
055000210712     F*  LN0749 - Do not display an error message if the              *
055100210712     F*           beneficiary is equal to the 'ACCOUNT WITH' bank     *
055200210712     F*  LN0748 - Remove conditioning requiring beneficiary and       *
055300210712     F*           deal counterparty to be  non banks for field        *
055400210712     F*           50 defaulting.                                      *
055500210712     F*  BHF352 - Allow settlement type 14 if 'CI'.                   *
055600210712     F*  BHF564 - Redefault if an error is made on the first          *
055700210712     F*           enter.                                              *
055800210712     F*  BHF596 - Do not default bank to bank information if          *
055900210712     F*           interbranch settlement via chips.                   *
056000210712     F*  BHF595 - Validate beneficiary if settlement method 01        *
056100210712     F*  BHF585 - If deal c/party is a non bank then field 50         *
056200210712     F*           should default to the deal c/party.                 *
056300210712     F*  BHF572 - Chain to customer file to access bank/non           *
056400210712     F*           bank indicator.                                     *
056500210712     F*  BHF582 - Beneficiary not mandatory for settlement            *
056600210712     F*           method 01                                           *
056700210712     F*  BHF569 - Interbranch settlement - default field 52 to        *
056800210712     F*           BICN of booking branch.                             *
056900210712     F*  BHF553 - Do not default ordering customer if ordering        *
057000210712     F*           bank is non blank (and vice versa).                 *
057100210712     F*  BHF552 - No need to check whether the receiving bank         *
057200210712     F*           has a valid CHIPS ABA.- requested by LINDA          *
057300210712     F*           BALLANCE - BHF NEW YORK 02/09/90                    *
057400210712     F*  BHF547 - USE RECEIVE SIDE SETTLEMENT INSTRUCTIONS FOR        *
057500210712     F*           CONDITIONING RECEIVE SIDE DEFAULTING.               *
057600210712     F*  BHF465 - ADD RECEIVE SIDE DEFAULTING                         *
057700210712     F*  BHF519 - NO ERROR MESSAGE REQUIRED IF FIELD 50 AND 52        *
057800210712     F*           ARE BLANK - SETTLEMENT METHOD 07 : CHIPS            *
057900210712     F*  BHF517 - DEFAULT ONLY FOR SETTLEMENT TYPE 08                 *
058000210712     F*  BHF506 - DEFAULT FIELD 72 TO CUSTOMER NAME & TOWN, NOT       *
058100210712     F*           BENEFICIARY                                         *
058200210712     F*  BHF504 - CHECK CORRECT FIELD - FIELD 57                      *
058300210712     F*  BHF503 - CHANGE CONDITIONING - FIELDS 56 AND 57              *
058400210712     F*  LN0691 - CHANGE LENGTH OF CHECK FIELD TO 4                   *
058500210712     F*           CHECKING AGAINST WRONG FIELD                        *
058600210712     F*  LN0657 - ONLY CHECK IF RECIPIENT IS A BANK IF IT IS          *
058700210712     F*           NON-BLANK                                           *
058800210712     F*  S01297 - RELEASE 10 EXTENDED SETTLEMENTS CHANGES             *
058900210712     F*         - ADDING DEFAULTING                                   *
059000210712     F*  E22405 - ALLOW COVER MT202 TO BE GENERATED FOR AN MT202      *
059100210712     F*  E22614 - RECIPIENT OF PAYMENT INSTRUCTIONS MUST BE A         *
059200210712     F*           BANK.                                               *
059300210712     F*  E21702 - IF SETTLEMENT METHOD IS 03, ALLOW 'OUR NOSTRO'      *
059400210712     F*           TO BE EITHER BLANK OR A SIX-DIGIT NUMBER (DEAL      *
059500210712     F*           TO COMPENSATE AGAINST) - REMOVE VALIDATION FOR      *
059600210712     F*           CUSTOMER NUMBER.                                    *
059700210712     F*           (ALSO MAKE APPROPRIATE CHANGES TO ERROR MESSAGES    *
059800210712     F*           USR3395 AND USR0570 - CORRESPONDING TO ERROR        *
059900210712     F*           CODES 909 AND 939 RESPECTIVELY).                    *
060000210712     F*  E21860 - THE ERROR CODES 950 AND 921 ARE NOT VALID           *
060100210712     F*           SINCE THE ORDERING CUSTOMER AND ORDERING BANK       *
060200210712     F*           SHOULD BE OPTIONAL                                  *
060300210712     F*  LN0455 - INTERMEDIARY BANK (RECEIPT) VALIDATED USING         *
060400210712     F*           PMRIBN INSTEAD OF PARIBN.                           *
060500210712     F*  S01117 - BLANK OUT DATA STRUCTURES AND WORK FIELD @OBR.      *
060600210712     F*  S01117 - //FW FOLLOWED BY NINE DIGITS ENTERED BY USER        *
060700210712     F*           WHEN CURRENCY IS USD, NOT CHECKED CORRECTLY.        *
060800210712     F*           FIELDS WHICH CAN TAKE CUSTOMER OR C/PARTY           *
060900210712     F*           NOSTRO NEED TO BE BLANKED OUT BEFORE VALUE          *
061000210712     F*           SELECTED PASSED IN.                                 *
061100210712     F*  S01117 - REMOVE ERROR FIX E00033 AS INCORRECT.               *
061200210712     F*  S01117 - ENSURE WARNING MESSAGE FOR SETTLEMENT METHOD 04     *
061300210712     F*           IS ONLY SENT ONCE.                                  *
061400210712     F*           BRANCH VALIDATION MOVED AS PREVIOUSLY INSERTED      *
061500210712     F*           IN INCORRECT PLACE.                                 *
061600210712     F*  S01117 - CHECK BICN OF NOSTRO BRANCH.                        *
061700210712     F*  S01117 - CHECK FIELDS FOR DUPLICATE VALUES.                  *
061800210712     F*           RECIPIENT'S CORRESPONDENT VALIDATION.               *
061900210712     F*  S01117 - NEW ERROR MESSAGES SENT FOR /IBK/ PROCESSING        *
062000210712     F*           IN BANK TO BANK INFORMATION.                        *
062100210712     F*  S01117 - CHECK ORDERING CUSTOMER (PAY & RECEIVE) NOT         *
062200210712     F*           BANK. VALIDATE DETAILS OF CHARGES.                  *
062300210712     F*           AOACCTV0 NOT CALLED FOR SETT TYPE 04 (EXT SETT).    *
062400210712     F*  S01117 - '?' PROCESSING FOR EXTENDED SETTLEMENTS             *
062500210712     F*  S01227 - EXTENDED SETTLEMENTS INCORPORATION - CHANGE         *
062600210712     F*           OF PROGRAM NAME SDKUUPR TO SD2410.                  *
062700210712     F*                                                               *
062800210712     F*           FOR VALIDATION OF INTERMEDIARY BANK THE FIELD       *
062900210712     F*              PARIBN SHOULD BE USED NOT PMRIBN AS THIS MIGHT   *
063000210712     F*              HOLD A CUSTOMER NUMBER OR A SHORTNAME.           *
063100210712     F*                                                               *
063200210712     F*              CHANGE MESSAGE PROCESSING  FOR ESM00986.         *
063300210712     F*                                                               *
063400210712     F*  E83    - Set up Default Branch for Set Meth 05 for Mbin=N    *
063500210712     F*  E00033 - OTHER SETTLEMENT METHODS WERE SETTING UP PMPOBR     *
063600210712     F*           AND WHEN METHOD CHANGED TO '00' WAS CAUSING ERROR   *
063700210712     F*  S01117 - AMENDMENTS FOR MULTIBRANCHING                       *
063800210712     F*                                                               *
063900210712     F*****************************************************************
064000210712     F/SPACE 3
064100210712     F*****************************************************************
064200210712     F*                                                               *
064300210712     F* ID F  C  H  L    FUNCTION OF INDICATORS                       *
064400210712     F*                                                               *
064500210712     F*  SCREEN VALIDATION - INDICATOR ON WHEN INVALID                *
064600210712     F*       08      Reverse image of Receipt Settlement Currency    *   CEU003
064700210712     F*       11      Reverse image of Payment Settlement Currency    *   CEU003
064800210712     F*       14      Reverse image of In currency in Field 72        *   CEU003
064900210712     F*       30      ERROR IN RECEIPT SETTLEMENT INSTRUCTIONS        *   LN0787
065000210712     F*       36      RECEIVER OF MT100                               *
065100210712     F*       37      RECEIPT - ORDERING CUSTOMER                     *
065200210712     F*       38      PAYMENT - ORDERING CUSTOMER                     *
065300210712     F*       39      RECEIPT - ORDERING BANK                         *
065400210712     F*       40      PAYMENT - ORDERING BANK                         *
065500210712     F*       41      RECEIVER'S CORRESPONDENT                        *
065600210712     F*       42      RECEIVER'S CORRESPONDENT ACCOUNT LINE           *
065700210712     F*       43      RECEIPT - INTERMEDIARY BANK                     *
065800210712     F*       44      PAYMENT - INTERMEDIARY BANK                     *
065900210712     F*       45      RECEIPT - INTERMEDIARY BANK ACCOUNT LINE        *
066000210712     F*       46      PAYMENT - INTERMEDIARY BANK ACCOUNT LINE        *
066100210712     F*       47      ACCOUNT WITH BANK                               *
066200210712     F*       48      ACCOUNT WITH BANK ACCOUNT LINE                  *
066300210712     F*       49      BENEFICIARY                                     *
066400210712     F*       50      BENEFICIARY ACCOUNT LINE                        *
066500210712     F********51******INTERMEDIARY*BANK*DOES*NOT*HAVE*A*SWIFT*ADDRESS *   S01412
066600210712     F*       52      RECEIPT - SETTLEMENT BRANCH                     *
066700210712     F*       53      PAYMENT - SETTLEMENT BRANCH                     *
066800210712     F*       60      WORK - INDICATOR                                *
066900210712     F********61******WORK*-*INDICATOR                                *   E22405
067000210712     F*       61      COVER MT202 REQUIRED                            *   E22405
067100210712     F*       63      FIRST BANK TO BANK LINE STARTS WITH '/' OR '//' *
067200210712     F*       64      SECOND BANK TO BANK LINE STARTS WITH '/' OR '//'*
067300210712     F*       65      THIRD BANK TO BANK LINE STARTS WITH '/' OR '//' *
067400210712     F*       66      FOURTH BANK TO BANK LINE STARTS WITH '/' OR '//'*
067500210712     F*       67      FIFTH BANK TO BANK LINE STARTS WITH '/' OR '//' *
067600210712     F*       68      SIXTH BANK TO BANK LINE STARTS WITH '/' OR '//' *
067700210712     F*       69      IF ON DATE ACCOUNT OPENED IS NOT VALIDATED      *
067800210712     F*       70      CHAIN FAILS                                     *
067900210712     F*       71      /INS/ OR /OGB/ ENTERED IN FIELD 72              *
068000210712     F********72******/IBK/*WITHOUT*A/C*LINE*ENTERED*IN*FIELD*72*******   S01412
068100210712     F********73******/IBK/*WITH*A/C*LINE*ENTERED*IN*FIELD*72**********   S01412
068200210712     F********74******/IBK/*ENTERED*IN*FIELD*72************************   S01412
068300210712     F*       75      /CABLEIBK/,/PHONIBK/ OR /TELEXIBK/ ENTERED IN   *
068400210712     F*               FIELD 72                                        *
068500210712     F*       76      /INT/ ENTERED IN FIELD 72                       *
068600210712     F*       80      SECOND BANK TO BANK LINE STARTS WITH '//'       *
068700210712     F*       81      THIRD BANK TO BANK LINE STARTS WITH  '//'       *
068800210712     F*       82      FOURTH BANK TO BANK LINE STARTS WITH '//'       *
068900210712     F*       83      FIFTH BANK TO BANK LINE STARTS WITH  '//'       *
069000210712     F*       84      SIXTH BANK TO BANK LINE STARTS WITH  '//'       *
069100210712     F*                                                               *
069200210712     F*****************************************************************
069300210712     F/SPACE 3
069400210712     F*****************************************************************
069500210712     F*                                                               *
069600210712     F* SUBROUTINES                                                   *
069700210712     F*                                                               *
069800210712     F*  FIRSTC - FIRST CYCLE PROCESSING    CALLED BY: MAIN PROCESSING*
069900210712     F*                                     CALLS    :                *
070000210712     F*  V01    - SCREEN VALIDATION         CALLED BY: MAIN PROCESSING*
070100210712     F*                                     CALLS    : CHKFL;BTBVAL   *
070200210712     F*  CHKFL  - VALIDATE CUSTOMER FIELDS  CALLED BY: V01            *
070300210712     F*                                     CALLS    :                *
070400210712     F*  CHKAC  - VALIDATE ACCOUNT NO.      CALLED BY: V01            *
070500210712     F*                                     CALLS    :                *
070600210712     F*  CHKNO  - VALIDATE NOSTRO           CALLED BY: V01            *
070700210712     F*                                     CALLS    :                *
070800210712     F*  CHKCY  - VALIDATE CURRENCY         CALLED BY: V01            *
070900210712     F*                                     CALLS    :                *
071000210712     F*  BTBVAL - VALIDATE BANK TO BANK     CALLED BY: V01            *
071100210712     F*           INFORMATION               CALLS    :                *
071200210712     F***Z01    - CALL ACCESS OBJECTS TO    CALLED BY: V01            *   S01117
071300210712     F*****       CLOSE OPEN FILES          CALLS    :                *   S01117
071400210712     F*                                                               *
071500210712     F*****************************************************************
071600210712      /COPY WNCPYSRC,SD2410FFPG                                           S01408
071700210712     E/SPACE 3
071800210712     E*
071900210712     E**  TABLES AND ARRAYS
072000210712     E*
072100210712     E/COPY WNCPYSRC,SD2410E001
072200210712     E                    CPY@    1   1 80
072300210712     E                    ERCD       50  3               ERROR CODES
072400210712     E                    BTB         6  9               USED BTB CODES
072500210712     E                    NALG       10  1  A                             DT0069
072600210712     E                    O#E        50  3               Return Error codeCSW096
072700210712     E                    @QM         2  1  A            Test for '?'     108517
072800210712     E** Nostro Align: array to left-align contents of Account With field DT0069
072900210712     E** for checking whether it contains a Nostro Number.                DT0069
073000210712     E*                                                                   DT0069
073100210712     E/COPY ZSRSRC,ZDATE1Z1                                               CSW005
073200210712     E/COPY ZSRSRC,ZEDITZ1                                                                    CLE031
073300210712     E*                                                                   CLE033
073400210712     E**  System values array                                             CLE033
073500210712     E**********          SVAL    1   3 20                                             CLE033 218782
073600210712     E                    SVAL    1   4 20                                                    218782
073700210712     E*                                                                   CLE033
073800210712     I/SPACE 3
073900210712     IPSETL     E DSSETLIAB
074000210712     IPSETLZ    E DSSETLIAZ
074100210712     IPSDSET    E DSSDSETLPD                                              CSW005
074200210712     I*A8RF***** E DSSDBRCHPD                                             S01117
074300210712     I*ALRF***** E DSSDCNSTPD                                             S01117
074400210712     I*CURF***** E DSSDCUSTPD                                             S01117
074500210712     I*A7RF***** E DSSDNOSTPD                                             S01117
074600210712     I*DMRF***** E DSSDCCSYPD                                             S01117
074700210712     IALRF      E DSSDCNSTPD                                              S01117
074800210712     ICURF      E DSSDCUSTPD                                              S01117
074900210712     IA7RF      E DSSDNOSTPD                                              S01117
075000210712     IACCT      E DSACCNTAB
075100210712     IDMRF      E DSSDCCSYPD                                              S01117
075200210712     ISDTRAD    E DSSDTRADPD                                              S01297
075300210712     I              QQACCD                          QQACC2                                    CGL029
075400210712      *                                                                   CLE033
075500210712     I*SDSVAL****E*DSSDSVALPD*                                                         CLE033 222373
075600210712      *                                                                   CLE033
075700210712     ISDACOD    E DSSDACODL1                                              CLE033
075800210712     I*
075900210712     I*                                                                   S01117
076000210712     IRUNDAT      DS                                                      S01117
076100210712     I** DATA STRUCTURE FOR MULTIBRANCH INDICATOR USING RUNDAT.           S01117
076200210712     I                                       13  13 @MBIN                 S01117
076300210712     I*                                                                   S01117
076400210712     ISDBANK    E DSSDBANKPD                                              S01117
076500210712     I** EXTERNAL DS FOR BANK DETAILS                                     S01117
076600210712     I*                                                                   S01117
076700210712     ISDBRCH    E DSSDBRCHPD                                              S01117
076800210712     I              QQDFAC                          QQDFA1                                    CGL029
076900210712     I** EXTERNAL DS FOR BRANCH DETAILS                                   S01117
077000210712     I*                                                                   S01117
077100210712     ISCSARD    E DSSCSARDPD                                              CEU003
077200210712      ***  External data structures for Switchable Features Details       CEU003
077300210712     I              LCD                             LCDX                  CEU003
077400210712     I*                                                                   CEU003
077500210712     ISDCURR    E DSSDCURRPD                                              CEU003
077600210712      ***  External data structures for Currency Details                  CEU003
077700210712     ISDGELR    E DSSDGELRPD                                              CEU003
077800210712     I              QQACCD                          QQACC1                                    CGL029
077900210712      ***  External data structures for General Ledger Details            CEU003
078000210712      *                                                                                       219241
078100210712     ISDMGME    E DSSDMGMEPD                                                                  219241
078200210712      **  Data structure for message management data.                                         219241
078300210712     ISDMMOD    E DSSDMMODPD                                              221452
078400210712      ***  External data structures for Midas Module Details              221452
078500210712      *                                                                   S01408
078600210712      /COPY WNCPYSRC,SD2410IIPG                                           S01408
078700210712      *                                                                   S01408
078800210712     IDSSDY     E DSDSSDY
078900210712      ** EXTERNAL DS FOR LONG DUMMY DATA STRUCTURE
079000210712     I*                                                                   S01117
079100210712     IDSFDY     E DSDSFDY
079200210712      ** EXTERNAL DS FOR SHORT DUMMY DATA STRUCTURE
079300210712     I*                                                                   S01117
079400210712     I            DS
079500210712     I**********                              1  15 ACKEY                                     CGL029
079600210712     I                                        1  21 ACKEY                                     CGL029
079700210712     I**********                              1   60CUSKEY                                    CSD027
079800210712     I                                        1   6 CUSKEY                                    CSD027
079900210712     I                                        7   9 CCYKEY
080000210712     I**********                             10  130ACDKE2                                    CGL029
080100210712     I**********                             14  150SEQKE2                                    CGL029
080200210712     I                                       10  190ACDKE2                                    CGL029
080300210712     I                                       20  210SEQKE2                                    CGL029
080400210712     I            DS
080500210712     I**********                              1  12 NOSTRO                                    CGL029
080600210712     I                                        1  18 NOSTRO                                    CGL029
080700210712     I                                        1   2 NOST02
080800210712     I                                        1   6 NOST06
080900210712     I**********                              1  10 NOST10                                    CGL029
081000210712     I**********                              7  10 NOSTAC                                    CGL029
081100210712     I**********                              7  12 NOSTYY                                    CGL029
081200210712     I**********                             11  12 NOSTSQ                                    CGL029
081300210712     I**********                              3  12 NOSTXX                                    CGL029
081400210712     I**********                              1  16 NOST10                             CGL029 TDA088
081500210712     I                                        1  10 NOST10                                    TDA088
081600210712     I                                        7  16 NOSTAC                                    CGL029
081700210712     I                                        7  18 NOSTYY                                    CGL029
081800210712     I                                       17  18 NOSTSQ                                    CGL029
081900210712     I                                        3  18 NOSTXX                                    CGL029
082000210712     I                                       11  18 WNOST1                                  AR853732
082100210712     I            DS
082200210712     I                                        1  35 PMXIBA
082300210712     I                                        1   1 PMXIB1
082400210712     I                                        2   2 PMXIB2
082500210712     I                                        3   3 PMXIBE                060036
082600210712     I                                        1   4 PMXIB4
082700210712     I                                        5  35 PMXIB5
082800210712     I                                        5   9 PMXSW5                094100
082900210712     I                                        5  10 PMXIB6
083000210712     I                                        5  100PNXIB6
083100210712     I                                        5  130PMXIB7
083200210712     I                                       10  35 PMXSWW                094100
083300210712     I                                       11  35 PMXIBW
083400210712     I**********                              5   7 PMXIB3                S01429
083500210712     I**********                              5   70PNXIB3                S01429
083600210712     I**********                              8  35 PMXIBX                S01429
083700210712     I                                        5   8 PMXIB3                S01429
083800210712     I                                        5   80PNXIB3                S01429
083900210712     I                                        9  35 PMXIBX                S01429
084000210712     I                                        5  12 PMXIB8
084100210712     I                                       13  35 PMXIBY
084200210712     I                                        5  13 PMXIB9
084300210712     I                                       14  35 PMXIBZ
084400210712     I            DS
084500210712     I                                        1  10 CHKFLD
084600210712     I                                        1   6 CHKFLA
084700210712     I                                        1   8 CHKFLC
084800210712     I                                        7  10 CHKBL1
084900210712     I                                        9  10 CHKBL2
085000210712     I            DS
085100210712     I                                        1  35 XBTB
085200210712     I                                        1   1 SLASH1
085300210712     I                                        1   2 SLASH2
085400210712     I                                        6   6 SLASH3
085500210712     I                                        2   5 CODE1A
085600210712     I                                        2   6 CODE1B
085700210712     I                                        2   7 CODE1C
085800210712     I                                        2   8 CODE1D
085900210712     I                                        2   9 CODE1E
086000210712     I                                        2  10 CODE1F
086100210712     I                                        3  35 BLKCHK                096151
086200210712     I                                        6  15 CODE1G
086300210712     I                                        7   7 PLUS1A
086400210712     I                                        8   8 PLUS1B
086500210712     I                                       10  10 PLUS1C
086600210712     I                                       11  11 PLUS1D
086700210712     I                                        6  35 BLNK1A
086800210712     I                                        9  35 BLNK1B
086900210712     I                                       11  35 BLNK1C
087000210712     I                                        7  18 PHONEA
087100210712     I                                        8  19 TELEXA
087200210712     I                                       10  21 PHONEB
087300210712     I                                       11  22 TELEXB
087400210712     I            DS
087500210712     I                                        1  12 YBTB
087600210712     I                                        3  12 CODE1H
087700210712     I            DS
087800210712     I                                        1  12 ACKER
087900210712     I**********                              1   60CUSKER                                    CSD027
088000210712     I                                        1   6 CUSKER                                    CSD027
088100210712     I                                        7  100ACDKER
088200210712     I                                       11  120SEQKER
088300210712     I            DS
088400210712     I                                        1  12 ACKEP
088500210712     I**********                              1   60CUSKEP                                    CSD027
088600210712     I                                        1   6 CUSKEP                                    CSD027
088700210712     I                                        7  100ACDKEP
088800210712     I                                       11  120SEQKEP
088900210712     I/COPY WNCPYSRC,SD2410I001
089000210712     I            DS                                                      DT0069
089100210712     I** Data structure for use in checking whether Account With field is DT0069
089200210712     I** a Nostro Number.                                                 DT0069
089300210712     I**                                      Account With field          DT0069
089400210712     I                                        1  10 @@AWBN                DT0069
089500210712     I**                                      Account With array          DT0069
089600210712     I                                        1  10 NALG                  DT0069
089700210712     I**                                      Nostro Number               DT0069
089800210712     I                                        1   2 @@NONO                DT0069
089900210712     I**                                      The rest of the field       DT0069
090000210712     I                                        3  10 @@NRST                DT0069
090100210712     ICPYR@#      DS
090200210712     I* DATA STRUCTURE FOR COMPILATION - COPYRIGHT INSERTION
090300210712     I                                        1  80 CPY@
090400210712     I/COPY WNCPYSRC,SD2410I003
090500210712     I                                        1  20 CPY@##
090600210712     I*                                                                   E24039
090700210712     ILDA         DS                            256                       E24039
090800210712     I                                      200 200 NOCHG1                E24039
090900210712     I                                      201 201 RCVSTR                E24039
091000210712     I                                      202 202 NOCHG2                E24039
091100210712     I**  LOCAL DATA AREA                                                 E24039
091200210712     I/COPY WNCPYSRC,SD2410I005
091300210712      ** Declare SWIFTACTV constant                                                           CSW221
091400210712      *                                                                                       CSW221
091500210712     I              'SWIFTACTV'           C         SWIFT                                     CSW221
091600210712      *                                                                   CSW096
091700210712      * Input Parameters                                                  CSW096
091800210712      *                                                                   CSW096
091900210712     I***I#PARM*     DS                            512                                 CSW096 CGL029
092000210712     II#PARM      DS                            514                                           CGL029
092100210712      * Field to be validated                                             CSW096
092200210712     I                                        1   5 I#VFLD                CSW096
092300210712      * Pay/Receive Settlement (PAY/REC)                                  CSW096
092400210712     I                                        6   8 I#PR                  CSW096
092500210712      * Customer/Counterparty Nostro /BIC indentified type                CSW096
092600210712      *    C           X              S  X-> C'party Nostro or Customer   CSW096
092700210712      * Customer/Counterparty/BIC indentified                             CSW096
092800210712     I                                        9   9 I#PRTT                CSW096
092900210712     I                                       10  20 I#PRTY                CSW096
093000210712      * Pay Currency                                                      CSW096
093100210712     I                                       21  23 I#PCCY                CSW096
093200210712      * Receive Currency                                                  CSW096
093300210712     I                                       24  26 I#RCCY                CSW096
093400210712      * Account Line                                                      CSW096
093500210712     I                                       27  61 I#ACLN                CSW096
093600210712      * Account Line Character 1                                          CSW096
093700210712     I                                       27  27 I#ACC1                CSW096
093800210712      * Account Line Character 2                                          CSW096
093900210712     I                                       28  28 I#ACC2                CSW096
094000210712      * Account Line Character 3                                          CSW096
094100210712     I                                       29  29 I#ACC3                CSW096
094200210712      * Account Line first 4 characters                                   CSW096
094300210712     I                                       27  30 I#ACCL                CSW096
094400210712      * Account Line Clearing System                                      CSW096
094500210712     I                                       29  30 I#ACCS                CSW096
094600210712      * Account Line No account data                                      CSW096
094700210712     I                                       31  61 I#SPC1                CSW096
094800210712      * Message Type                                                      CSW096
094900210712     I                                       62  64 I#MTYP                CSW096
095000210712      * Intermediary Institution for Bank to Bank validation              CSW096
095100210712     I                                       65  65 I#INBT                CSW096
095200210712     I                                       66  76 I#INBK                CSW096
095300210712      * Account with Institution for Bank to Bank validation              CSW096
095400210712     I                                       77  77 I#AWBT                CSW096
095500210712     I                                       78  88 I#AWBK                CSW096
095600210712      * Beneficiary for Bank to Bank validation                           CSW096
095700210712     I                                       89  89 I#BENT                CSW096
095800210712     I                                       90 100 I#BENF                CSW096
095900210712      * Pay and Receive Settlement Methods                                CSW096
096000210712     I                                      101 102 I#RSTM                CSW096
096100210712     I                                      103 104 I#PSTM                CSW096
096200210712      * Field 53 and 54 Entered                                           CSW096
096300210712     I                                      105 105 I#5354                CSW096
096400210712      * Midas Module                                                      CSW096
096500210712     I                                      106 107 I#MMOD                CSW096
096600210712      * Pay and Receive Settlement Accounts                               CSW096
096700210712     I**********                            108 125 I#PYAC                CSW096       CSW096 CGL029
096800210712     I**********                            126 143 I#RCAC                CSW096       CSW096 CGL029
096900210712     I                                      108 125 QQPYAC                                    CGL029
097000210712     I                                      126 143 QQRCAC                                    CGL029
097100210712      * Transaction Type                                                  CSW096
097200210712     I                                      144 145 I#TTYP                CSW096
097300210712      * Cover required                                                    CSW096
097400210712     I                                      146 146 I#COVR                CSW096
097500210712      * Bank to Bank Information                                          CSW096
097600210712     I                                      257 466 I#BTB                 CSW096
097700210712     I                                      257 291 I#BTB1                CSW096
097800210712     I                                      292 326 I#BTB2                CSW096
097900210712     I                                      327 361 I#BTB3                CSW096
098000210712     I                                      362 396 I#BTB4                CSW096
098100210712     I                                      397 431 I#BTB5                CSW096
098200210712     I                                      432 466 I#BTB6                CSW096
098300210712      *                                                                                       CGL029
098400210712      ** Pay and Receive Settlement Accounts                                                  CGL029
098500210712      *                                                                                       CGL029
098600210712     I                                      467 490 I#PYAC                                    CGL029
098700210712     I                                      491 514 I#RCAC                                    CGL029
098800210712      *                                                                   CSW096
098900210712      * Output Parameters                                                 CSW096
099000210712      *                                                                   CSW096
099100210712     I***O#PARM*     DS                            512                                 CSW096 CGL029
099200210712     IO#PARM      DS                            514                                           CGL029
099300210712      * Account Line modified                                             CSW096
099400210712     I                                        1  35 O#ACLN                CSW096
099500210712     I/COPY WNCPYSRC,SD2410I004
099600210712      * Bank to Bank Information                                          CSW096
099700210712     I                                      257 466 O#BTB                 CSW096
099800210712     I                                      257 291 O#BTB1                CSW096
099900210712     I                                      292 326 O#BTB2                CSW096
100000210712     I                                      327 361 O#BTB3                CSW096
100100210712     I                                      362 396 O#BTB4                CSW096
100200210712     I                                      397 431 O#BTB5                CSW096
100300210712     I                                      432 466 O#BTB6                CSW096
100400210712      *                                                                   CSW096
100500210712      * Error Parameters                                                  CSW096
100600210712      *                                                                   CSW096
100700210712     IE#PARM      DS                            256                       CSW096
100800210712      * Calling Program                                                   CSW096
100900210712     I                                        1  10 E#CPGM                CSW096
101000210712      * Error message sent                                                CSW096
101100210712     I                                       12  12 E#ERRM                CSW096
101200210712      * Warning message sent                                              CSW096
101300210712     I                                       13  13 E#WARN                CSW096
101400210712      * Error index                                                       CSW096
101500210712     I                                       14  180E#INDX                CSW096
101600210712      * Message text to prefix error message                              CSW096
101700210712     I                                       19  25 E#MSGD                CSW096
101800210712     I                                       26  35 E#MSGF                CSW096
101900210712      * Error codes array                                                 CSW096
102000210712     I                                       51 200 E#ERCD                CSW096
102100210712     I                                       51 200 O#E                   CSW096
102200210712      *                                                                   CSW096
102300210712     I            DS                                                      CSW005
102400210712     I                                        1   6 W#AGDT                CSW005
102500210712     I                                        1   20YY                    CSW005
102600210712     I                                        3   40MM                    CSW005
102700210712     I                                        5   60DD                    CSW005
102800210712     I            DS                                                      CSW005
102900210712     I                                        1   6 WWAGDT                CSW005
103000210712     I                                        1   20WDD                   CSW005
103100210712     I                                        3   40WMM                   CSW005
103200210712     I                                        5   60WYY                   CSW005
103300210712     I            DS                                                                          CDL094
103400210712     I                                        1   3 ERB1                                      CDL094
103500210712     I                                        1   2 ER2A                                      CDL094
103600210712     I/COPY WNCPYSRC,SD2410I002
103700210712     I/EJECT
103800210712     C/COPY WNCPYSRC,SD2410C047
103900210712     C*********************
104000210712     C** MAIN PROCESSING **
104100210712     C*********************
104200210712     C/COPY WNCPYSRC,SD2410C050
104300210712     C*
104400210712     C           *ENTRY    PLIST
104500210712     C                     PARM           PSETL
104600210712     C                     PARM           PSETLZ
104700210712     C/COPY WNCPYSRC,SD2410C096
104800210712     C                     PARM           PSDSET                          CSW005
104900210712     C***********          PARM           CNT     10                CLE003113832
105000210712     C***********          PARM           CNT1    10                CLE003113832
105100210712     C/COPY WNCPYSRC,SD2410C097
105200210712     C*                                                                   CLE003
105300210712     C**  Access SAR details file to see if CLE003 is installed           CLE003
105400210712     C*                                                                   CLE003
105500210712     C                     CALL 'AOSARDR0'                                CLE003
105600210712     C                     PARM '       ' @RTCD   7                       CLE003
105700210712     C                     PARM '*VERIFY' @OPTN   7                       CLE003
105800210712     C                     PARM 'CLE003'  @SARD   6                       CLE003
105900210712      *                                                                   CLE003
106000210712     C           @RTCD     IFEQ *BLANK                                    CLE003
106100210712     C                     MOVE 'Y'       CLE003  1                       CLE003
106200210712     C                     ELSE                                           CLE003
106300210712     C                     MOVE 'N'       CLE003                          CLE003
106400210712     C                     ENDIF                                          CLE003
106500210712      *                                                                   CLE033
106600210712      ** Access Switchable Feature Details                                CLE033
106700210712      *                                                                   CLE033
106800210712     C                     MOVE 'N'       CLE033  1                       CLE033
106900210712      *                                                                   CLE033
107000210712     C                     CALL 'AOSARDR0'                                CLE033
107100210712     C                     PARM *BLANKS   @RTCD                           CLE033
107200210712     C                     PARM '*VERIFY '@OPTN                           CLE033
107300210712     C                     PARM 'CLE033'  @SARD                           CLE033
107400210712      *                                                                   CLE033
107500210712     C           @RTCD     IFEQ *BLANKS                                   CLE033
107600210712      *                                                                   CLE033
107700210712     C                     MOVE 'Y'       CLE033                          CLE033
107800210712      *                                                                   CLE033
107900210712     C                     CALL 'AOSVALR0'                                CLE033
108000210712     C                     PARM *BLANKS   @RTCD                           CLE033
108100210712     C                     PARM SVAL,1    P@OP01 20                       CLE033
108200210712     C                     PARM *BLANKS   P@VL01200                       CLE033
108300210712     C                     PARM SVAL,2    P@OP02 20                       CLE033
108400210712     C                     PARM *BLANKS   P@VL02200                       CLE033
108500210712     C                     PARM SVAL,3    P@OP03 20                       CLE033
108600210712     C                     PARM *BLANKS   P@VL03200                       CLE033
108700210712     C**********           PARM *BLANKS   P@OP04 20                                    CLE033 218782
108800210712     C                     PARM SVAL,4    P@OP04 20                                           218782
108900210712     C                     PARM *BLANKS   P@VL04200                       CLE033
109000210712     C                     PARM *BLANKS   P@OP05 20                       CLE033
109100210712     C                     PARM *BLANKS   P@VL05200                       CLE033
109200210712     C                     PARM *BLANKS   P@OP06 20                       CLE033
109300210712     C                     PARM *BLANKS   P@VL06200                       CLE033
109400210712     C                     PARM *BLANKS   P@OP07 20                       CLE033
109500210712     C                     PARM *BLANKS   P@VL07200                       CLE033
109600210712     C                     PARM *BLANKS   P@OP08 20                       CLE033
109700210712     C                     PARM *BLANKS   P@VL08200                       CLE033
109800210712     C                     PARM *BLANKS   P@OP09 20                       CLE033
109900210712     C                     PARM *BLANKS   P@VL09200                       CLE033
110000210712     C                     PARM *BLANKS   P@OP10 20                       CLE033
110100210712     C                     PARM *BLANKS   P@VL10200                       CLE033
110200210712     C********** SDSVAL    PARM SDSVAL    DSSDY                                        CLE033 222373
110300210712      *                                                                   CLE033
110400210712     C           @RTCD     IFNE *BLANK                                    CLE033
110500210712     C                     MOVEL'SDSVALPD'PMDBFL           ************** CLE033
110600210712     C                     MOVEL'SD2410'  PMDPGM           ** DBASE 12 ** CLE033
110700210712     C                     Z-ADD012       PMDBSE           ************** CLE033
110800210712     C                     MOVE *ON       *INU7                           CLE033
110900210712     C                     MOVE *ON       *INU8                           CLE033
111000210712     C                     MOVE *ON       *INLR                           CLE033
111100210712     C                     MOVE 'T'       PMTERM                          CLE033
111200210712     C                     RETRN                                          CLE033
111300210712     C                     ENDIF                                          CLE033
111400210712      *                                                                   CLE033
111500210712     C**********           MOVELP@VL02    W0ACOD  4                                    CLE033 CGL029
111600210712     C                     MOVELP@VL02    W0ACOD 10                                           CGL029
111700210712      *                                                                                       218782
111800210712      ** Save value of Settlement09Postings in a one character field                          218782
111900210712     C                     MOVELP@VL04    SET09   1                                           218782
112000210712      *                                                                   CLE033
112100210712     C                     CALL 'AOACODR0'                                CLE033
112200210712     C                     PARM *BLANKS   @RTCD                           CLE033
112300210712     C                     PARM '*KEY    '@OPTN                           CLE033
112400210712     C                     PARM W0ACOD    @ACCD                           CLE033
112500210712     C           SDACOD    PARM SDACOD    DSSDY                           CLE033
112600210712      *                                                                   CLE033
112700210712     C           @RTCD     IFNE *BLANK                                    CLE033
112800210712     C                     MOVEL'SDACODL1'PMDBFL           ************** CLE033
112900210712     C                     MOVEL'SD2410'  PMDPGM           ** DBASE 11 ** CLE033
113000210712     C                     Z-ADD011       PMDBSE           ************** CLE033
113100210712     C                     MOVE *ON       *INU7                           CLE033
113200210712     C                     MOVE *ON       *INU8                           CLE033
113300210712     C                     MOVE *ON       *INLR                           CLE033
113400210712     C                     MOVE 'T'       PMTERM                          CLE033
113500210712     C                     RETRN                                          CLE033
113600210712     C                     ENDIF                                          CLE033
113700210712      *                                                                   CLE033
113800210712     C                     ENDIF                                          CLE033
113900210712     C*                                                                   221452
114000210712     C**  Access Midas Module Details                                     221452
114100210712     C*                                                                   221452
114200210712     C                     CALL 'AOMMODR0'                                221452
114300210712     C                     PARM '*DBERR ' PRTCD                           221452
114400210712     C                     PARM '*FIRST ' POPTN                           221452
114500210712     C           SDMMOD    PARM SDMMOD    DSFDY                           221452
114600210712     C*                                                                   221452
114700210712     C*
114800210712     C*                                                                   S01408
114900210712     C/COPY WNCPYSRC,SD2410CCPG                                           S01408
115000210712     C*                                                                   S01408
115100210712     C*                                                                   113832
115200210712     C* If warning messages 805/806 have been displayed (flags set        113832
115300210712     C* to 2) allow user to return to previous screen                     113832
115400210712     C* COUNT - used as a flag for validation of Receipt field            113832
115500210712     C* COUNT1 - used as a flag for validation of Payment field           113832
115600210712     C*                                                                   113832
115700210712     C           CLE003    IFEQ 'Y'                                       CLE003
115800210712     C           PMCPGM    ANDEQ'MMLD'                                    113832
115900210712     C                     MOVELPMCMDP    COUNT   10                      113832
116000210712     C                     MOVE PMCMDP    COUNT1  10                      113832
116100210712     C           COUNT     IFEQ 2                                         CLE003
116200210712     C           COUNT1    OREQ 2                                         CLE003
116300210712     C                     MOVE *OFF      *IN30                           CLE003
116400210712     C                     MOVE *OFF      *IN31                           CLE003
116500210712     C                     ADD  1         COUNT                           113832
116600210712     C                     ADD  1         COUNT1                          113832
116700210712     C                     ENDIF                                          CLE003
116800210712     C***********          MOVE CNT       COUNT   10                CLE003113832
116900210712     C***********          MOVE CNT1      COUNT1  10                CLE003113832
117000210712     C                     ENDIF                                          CLE003
117100210712     C*                                                                   CLE003
117200210712     C                     MOVE *BLANKS   PMERCD
117300210712     C**********           MOVE *BLANKS   RBRF    1                 S01117139921
117400210712     C**********           MOVE *BLANKS   PBRF    1                 S01117139921
117500210712     C                     MOVE *BLANKS   RTCD                            S01117
117600210712     C                     MOVE 'N'       @SENT   1                       S01117
117700210712     C*                                                                   S01117
117800210712     C** READ DATA AREA - RUNDAT                                          S01117
117900210712     C           *NAMVAR   DEFN           RUNDAT                          S01117
118000210712     C                     IN   RUNDAT                                    S01117
118100210712     C*                                                                   CEU003
118200210712     C** Access Switchable Feature Details                                CEU003
118300210712     C*                                                                   CEU003
118400210712     C                     CALL 'AOSARDR0'                                CEU003
118500210712     C                     PARM *BLANKS   PRTCD   7                       CEU003
118600210712     C                     PARM '*VERIFY 'POPTN   7                       CEU003
118700210712     C                     PARM 'CEU003'  PSARD   6                       CEU003
118800210712     C           SCSARD    PARM SCSARD    DSSDY                           CEU003
118900210712     C*                                                                   CEU003
119000210712     C           PRTCD     IFEQ *BLANKS                                   CEU003
119100210712     C                     MOVE 'Y'       CEU003  1                       CEU003
119200210712     C                     ELSE                                           CEU003
119300210712     C                     MOVE 'N'       CEU003                          CEU003
119400210712     C                     ENDIF                                          CEU003
119500210712     C*                                                                   CEU003
119600210712      *                                                                                       CLE031
119700210712      ** Check if switchable feature CLE031 is switched on.                                   CLE031
119800210712      *                                                                                       CLE031
119900210712     C                     CALL 'AOSARDR0'                                                    CLE031
120000210712     C                     PARM *BLANKS   P@RTCD                                              CLE031
120100210712     C                     PARM '*VERIFY' P@OPTN                                              CLE031
120200210712     C                     PARM 'CLE031'  P@SARD                                              CLE031
120300210712     C           SCSARD    PARM SCSARD    DSSDY                                               CLE031
120400210712     C*                                                                                       CLE031
120500210712     C                     MOVE 'N'       CLE031  1                                           CLE031
120600210712     C           P@RTCD    IFEQ *BLANK                                                        CLE031
120700210712     C                     MOVE 'Y'       CLE031  1                                           CLE031
120800210712     C                     ELSE                                                               CLE031
120900210712     C           P@RTCD    IFNE '*NRF   '                                                     CLE031
121000210712     C                     MOVEL'SCSARDPD'PMDBFL           **************                     CLE031
121100210712     C                     MOVEL'SD2410'  PMDPGM           ** DBASE 11 **                     CLE031
121200210712     C                     Z-ADD11        PMDBSE           **************                     CLE031
121300210712     C                     MOVE '1'       *INU7                                               CLE031
121400210712     C                     MOVE '1'       *INU8                                               CLE031
121500210712     C                     MOVE '1'       *INLR                                               CLE031
121600210712     C                     MOVE 'T'       PMTERM                                              CLE031
121700210712     C                     RETRN                                                              CLE031
121800210712     C                     ENDIF                                                              CLE031
121900210712     C                     ENDIF                                                              CLE031
122000210712      *                                                                   191152
122100210712     C                     CALL 'AOSARDR0'                                191152
122200210712     C                     PARM *BLANKS   PRTCD   7                       191152
122300210712     C                     PARM '*VERIFY 'POPTN   7                       191152
122400210712     C                     PARM 'CEU004'  PSARD   6                       191152
122500210712     C           SCSARD    PARM SCSARD    DSSDY                           191152
122600210712      *                                                                   191152
122700210712     C           PRTCD     IFEQ *BLANKS                                   191152
122800210712     C                     MOVE 'Y'       CEU004  1                       191152
122900210712     C                     ELSE                                           191152
123000210712     C                     MOVE 'N'       CEU004                          191152
123100210712     C                     ENDIF                                          191152
123200210712      *                                                                   191152
123300210712     C**  Access General Ledger Details                                   CEU003
123400210712     C*                                                                   CEU003
123500210712     C**********           CALL 'AOGELRR0'                                             CEU003 CGL029
123600210712     C                     CALL 'AOGELRR1'                                                    CGL029
123700210712     C                     PARM '*DBERR ' PRTCD                           CEU003
123800210712     C                     PARM '*FIRST ' POPTN                           CEU003
123900210712     C********** SDGELR    PARM SDGELR    DSFDY                                        CEU003 CGL029
124000210712     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
124100210712      *                                                                                       219241
124200210712      ** Access SDMGMEPD for message management data.                                         219241
124300210712      *                                                                                       219241
124400210712     C                     CALL 'AOMGMER1'                                                    219241
124500210712     C                     PARM '*MSG   ' PRTCD                                               219241
124600210712     C                     PARM '*FIRST ' POPTN                                               219241
124700210712     C           SDMGME    PARM SDMGME    DSSDY                                               219241
124800210712      *                                                                                       219241
124900210712      ** If no record is found on SDMGMEPD, DB Error Processing.                              219241
125000210712      *                                                                                       219241
125100210712     C           PRTCD     IFNE *BLANKS                                                       219241
125200210712     C                     MOVEL'MGME '   PMDBFL                                              219241
125300210712     C                     MOVEL'SD2410'  PMDPGM                                              219241
125400210712     C                     Z-ADD12        PMDBSE                                              219241
125500210712     C                     MOVE *ON       *INU7                                               219241
125600210712     C                     MOVE *ON       *INU8                                               219241
125700210712     C                     MOVE *ON       *INLR                                               219241
125800210712     C                     MOVE 'T'       PMTERM                                              219241
125900210712     C                     RETRN                                                              219241
126000210712     C                     ENDIF                                                              219241
126100210712     C*                                                                   S01117
126200210712     C*                                                                   CSW005
126300210712     C                     MOVEL*BLANKS   CSW005  1                       CSW005
126400210712     C                     MOVEL*BLANKS   CSW011  1                       CSW011
126500210712     C*                                                                   CSW005
126600210712     C** Check if switchable feature CSW005 is switched on.               CSW005
126700210712     C*                                                                   CSW005
126800210712     C                     CALL 'AOSARDR0'                                CSW005
126900210712     C                     PARM *BLANKS   P@RTCD  7                       CSW005
127000210712     C                     PARM '*VERIFY' P@OPTN  7                       CSW005
127100210712     C                     PARM 'CSW005'  P@SARD  6                       CSW005
127200210712     C*                                                                   CSW005
127300210712     C           @RTCD     IFNE *BLANK                                    CSW005
127400210712     C           @RTCD     ANDNE'*NRF   '                                 CSW005
127500210712     C                     MOVEL'SCSARDPD'PMDBFL           ************** CSW005
127600210712     C                     MOVEL'SD2410'  PMDPGM           ** DBASE 09 ** CSW005
127700210712     C                     Z-ADD09        PMDBSE           ************** CSW005
127800210712     C                     MOVE *ON       *INU7                           CSW005
127900210712     C                     MOVE *ON       *INU8                           CSW005
128000210712     C                     MOVE *ON       *INLR                           CSW005
128100210712     C                     MOVE 'T'       PMTERM                          CSW005
128200210712     C                     RETRN                                          CSW005
128300210712     C                     END                                            CSW005
128400210712     C*                                                                   CSW005
128500210712     C           P@RTCD    IFEQ *BLANKS                                   CSW005
128600210712     C                     MOVEL'Y'       CSW005                          CSW005
128700210712     C                     ENDIF                                          CSW005
128800210712     C*                                                                   CSW011
128900210712     C                     CALL 'AOSARDR0'                                CSW011
129000210712     C                     PARM *BLANKS   P@RTCD  7                       CSW011
129100210712     C                     PARM '*VERIFY' P@OPTN  7                       CSW011
129200210712     C                     PARM 'CSW011'  P@SARD  6                       CSW011
129300210712     C*                                                                   CSW011
129400210712     C           P@RTCD    IFEQ *BLANKS                                   CSW011
129500210712     C                     MOVEL'Y'       CSW011                          CSW011
129600210712     C                     ENDIF                                          CSW011
129700210712      *                                                                   CDL008
129800210712      ** Check if switchable feature CDL008 is switched on.               CDL008
129900210712      *                                                                   CDL008
130000210712     C                     CALL 'AOSARDR0'                                CDL008
130100210712     C                     PARM *BLANKS   P@RTCD                          CDL008
130200210712     C                     PARM '*VERIFY' P@OPTN                          CDL008
130300210712     C                     PARM 'CDL008'  P@SARD                          CDL008
130400210712     C*                                                                   CDL008
130500210712     C           @RTCD     IFNE *BLANK                                    CDL008
130600210712     C           @RTCD     ANDNE'*NRF   '                                 CDL008
130700210712     C                     MOVEL'SCSARDPD'PMDBFL           ************   CDL008
130800210712     C                     MOVEL'SD2410'  PMDPGM           * DBASE 10 *   CDL008
130900210712     C                     Z-ADD10        PMDBSE           ************   CDL008
131000210712     C                     MOVE *ON       *INU7                           CDL008
131100210712     C                     MOVE *ON       *INU8                           CDL008
131200210712     C                     MOVE *ON       *INLR                           CDL008
131300210712     C                     MOVE 'T'       PMTERM                          CDL008
131400210712     C                     RETRN                                          CDL008
131500210712     C                     ENDIF                                          CDL008
131600210712      *                                                                   CDL008
131700210712     C           P@RTCD    IFEQ *BLANKS                                   CDL008
131800210712     C                     MOVEL'Y'       CDL008  1                       CDL008
131900210712     C                     ELSE                                           CDL008
132000210712     C                     MOVEL'N'       CDL008                          CDL008
132100210712     C                     ENDIF                                          CDL008
132200210712      *                                                                                       219241
132300210712      ** Access Switchable Feature Details. Check if STP Phase 2 MT103                        219241
132400210712      ** for Non-Funds Transfer (CFT013) is installed.                                        219241
132500210712      *                                                                                       219241
132600210712     C                     CALL 'AOSARDR0'                                                    219241
132700210712     C                     PARM *BLANKS   PRTCD                                               219241
132800210712     C                     PARM '*VERIFY 'POPTN                                               219241
132900210712     C                     PARM 'CFT013'  PSARD                                               219241
133000210712     C           SCSARD    PARM SCSARD    DSFDY                                               219241
133100210712      *                                                                                       219241
133200210712     C           PRTCD     IFNE *BLANK                                                        219241
133300210712     C           PRTCD     ANDNE'*NRF   '                                                     219241
133400210712     C                     MOVEL'SARD '   PMDBFL                                              219241
133500210712     C                     MOVEL'SD2410'  PMDPGM                                              219241
133600210712     C                     Z-ADD11        PMDBSE                                              219241
133700210712     C                     MOVE *ON       *INU7                                               219241
133800210712     C                     MOVE *ON       *INU8                                               219241
133900210712     C                     MOVE *ON       *INLR                                               219241
134000210712     C                     MOVE 'T'       PMTERM                                              219241
134100210712     C                     RETRN                                                              219241
134200210712     C                     ENDIF                                                              219241
134300210712      *                                                                                       219241
134400210712     C           PRTCD     IFEQ *BLANKS                                                       219241
134500210712     C                     MOVE 'Y'       CFT013  1                                           219241
134600210712     C                     ELSE                                                               219241
134700210712     C                     MOVE 'N'       CFT013                                              219241
134800210712     C                     ENDIF                                                              219241
134900210712      * Switchable feature CDL031                                                            BUG7139
135000210712     C                     CALL 'AOSARDR0'                                                   BUG7139
135100210712     C                     PARM *BLANKS   PRTCD                                              BUG7139
135200210712     C                     PARM '*VERIFY 'POPTN                                              BUG7139
135300210712     C                     PARM 'CDL031'  PSARD                                              BUG7139
135400210712     C           SCSARD    PARM SCSARD    DSSDY                                              BUG7139
135500210712     C*                                                                                      BUG7139
135600210712     C           PRTCD     IFEQ *BLANKS                                                      BUG7139
135700210712     C                     MOVE 'Y'       CDL031  1                                          BUG7139
135800210712     C                     ELSE                                                              BUG7139
135900210712     C                     MOVE 'N'       CDL031                                             BUG7139
136000210712     C                     ENDIF                                                             BUG7139
136100210712     C*                                                                                      BUG7139
136200210712      *                                                                                      BUG7139
136300210712      * Switchable feature CDL094                                                             CDL094
136400210712     C                     CALL 'AOSARDR0'                                                    CDL094
136500210712     C                     PARM *BLANKS   PRTCD                                               CDL094
136600210712     C                     PARM '*VERIFY 'POPTN                                               CDL094
136700210712     C                     PARM 'CDL094'  PSARD                                               CDL094
136800210712     C           SCSARD    PARM SCSARD    DSSDY                                               CDL094
136900210712      *                                                                                       CDL094
137000210712     C           PRTCD     IFEQ *BLANKS                                                       CDL094
137100210712     C                     MOVE 'Y'       CDL094  1                                           CDL094
137200210712     C                     ELSE                                                               CDL094
137300210712     C                     MOVE 'N'       CDL094                                              CDL094
137400210712     C                     ENDIF                                                              CDL094
137500210712     C*                                                                                       CDL094
137600210712      *                                                                                       CDL094
137700210712     C*                                                                   CSW200
137800210712     C** Check if SWIFT 2000 Changes is on.                               CSW200
137900210712      *                                                                   CSW200
138000210712     C                     CALL 'SWIF2000'                                CSW200
138100210712     C                     PARM *BLANKS   P@RTCD                          CSW200
138200210712      *                                                                   CSW200
138300210712     C                     MOVEL'N'       CSW200  1                       CSW200
138400210712     C           P@RTCD    IFEQ 'CSW200'                                  CSW200
138500210712     C                     MOVEL'Y'       CSW200  1                       CSW200
138600210712     C                     ENDIF                                          CSW200
138700210712     C*                                                                   CSW200
138800210712      ** Call SWIF2001 to check if CSW201 is switched on                                      CSW201
138900210712      *                                                                                       CSW201
139000210712     C                     CALL 'SWIF2001'                                                    CSW201
139100210712     C                     PARM *BLANKS   P@RTCD                                              CSW201
139200210712      *                                                                                       CSW201
139300210712     C           P@RTCD    IFEQ 'CSW2001'                                                     CSW201
139400210712     C                     MOVE 'Y'       CSW201  1                                           CSW201
139500210712     C                     ELSE                                                               CSW201
139600210712     C                     MOVE 'N'       CSW201                                              CSW201
139700210712     C                     ENDIF                                                              CSW201
139800210712      *                                                                                       CSW201
139900210712      ** Check if SWIFT 2002 Changes is on.                                                   CSW202
140000210712      *                                                                                       CSW202
140100210712     C                     CALL 'SWIF2002'                                                    CSW202
140200210712     C                     PARM *BLANKS   P@RTCD                                              CSW202
140300210712      *                                                                                       CSW202
140400210712     C           P@RTCD    IFEQ 'CSW2002'                                                     CSW202
140500210712     C                     MOVEL'Y'       CSW202  1                                           CSW202
140600210712     C                     ELSE                                                               CSW202
140700210712     C                     MOVEL'N'       CSW202                                              CSW202
140800210712     C                     ENDIF                                                              CSW202
140900210712      *                                                                                       CSW202
141000210712      ** Call SWIF2003 to check if CSW203 is installed                                        CSW203
141100210712      *                                                                                       CSW203
141200210712     C                     CALL 'SWIF2003'                                                    CSW203
141300210712     C                     PARM *BLANKS   PRTCD                                               CSW203
141400210712      *                                                                                       CSW203
141500210712      ** If ret. code is "CSW2003", set CSW203 flag to "Y", else set it to "N"                CSW203
141600210712      *                                                                                       CSW203
141700210712     C           PRTCD     IFEQ 'CSW2003'                                                     CSW203
141800210712     C                     MOVE 'Y'       CSW203  1                                           CSW203
141900210712     C                     ELSE                                                               CSW203
142000210712     C                     MOVE 'N'       CSW203                                              CSW203
142100210712     C                     ENDIF                                                              CSW203
142200210712      *                                                                                       CSW203
142300210712     C           *LIKE     DEFN A6SPRT    ARSPRT                                              CLE031
142400210712     C           *LIKE     DEFN A6SPRT    APSPRT                                              CLE031
142500210712     C           *LIKE     DEFN A6SPRT    AMREXR                                              CLE031
142600210712     C           *LIKE     DEFN A6SPRT    AMPEXR                                              CLE031
142700210712     C           *LIKE     DEFN A6SPRT    ZRATE1                                              CLE031
142800210712     C           *LIKE     DEFN A6SPRT    ZRATE2                                              CLE031
142900210712     C           *LIKE     DEFN A6MDIN    ARMDIN                                              CLE031
143000210712     C           *LIKE     DEFN A6MDIN    APMDIN                                              CLE031
143100210712     C           *LIKE     DEFN A6MDIN    AMREXI                                              CLE031
143200210712     C           *LIKE     DEFN A6MDIN    AMPEXI                                              CLE031
143300210712     C           *LIKE     DEFN A6MDIN    ZMDI1                                               CLE031
143400210712     C           *LIKE     DEFN A6MDIN    ZMDI2                                               CLE031
143500210712      *                                                                                       CLE031
143600210712      ** Check if SWIFT Changes 2012 (CSW212) is installed                                    CSW212
143700210712      *                                                                                       CSW212
143800210712     C                     CALL 'SWIF2012'                                                    CSW212
143900210712     C                     PARM *BLANKS   P@RTCD                                              CSW212
144000210712      *                                                                                       CSW212
144100210712     C           P@RTCD    IFEQ 'CSW2012'                                                     CSW212
144200210712     C                     MOVE 'Y'       CSW212  1                                           CSW212
144300210712     C                     ELSE                                                               CSW212
144400210712     C                     MOVE 'N'       CSW212                                              CSW212
144500210712     C                     ENDIF                                                              CSW212
144600210712      *                                                                                       CSW212
144700210712      ** Check if switchable feature CMG003 is switched on.                                   CMG003
144800210712      *                                                                                       CMG003
144900210712     C                     CALL 'AOSARDR0'                                                    CMG003
145000210712     C                     PARM *BLANKS   P@RTCD                                              CMG003
145100210712     C                     PARM '*VERIFY' P@OPTN                                              CMG003
145200210712     C                     PARM 'CMG003'  P@SARD                                              CMG003
145300210712      *                                                                                       CMG003
145400210712     C           P@RTCD    IFNE *BLANK                                                        CMG003
145500210712     C           P@RTCD    ANDNE'*NRF   '                                                     CMG003
145600210712     C                     MOVEL'SCSARDPD'PMDBFL                                              CMG003
145700210712     C                     MOVEL'SD2410'  PMDPGM                                              CMG003
145800210712     C                     Z-ADD13        PMDBSE                                              CMG003
145900210712     C                     MOVE *ON       *INU7                                               CMG003
146000210712     C                     MOVE *ON       *INU8                                               CMG003
146100210712     C                     MOVE *ON       *INLR                                               CMG003
146200210712     C                     MOVE 'T'       PMTERM                                              CMG003
146300210712     C                     RETRN                                                              CMG003
146400210712     C                     ENDIF                                                              CMG003
146500210712      *                                                                                       CMG003
146600210712     C           P@RTCD    IFEQ *BLANKS                                                       CMG003
146700210712     C                     MOVEL'Y'       CMG003  1                                           CMG003
146800210712     C                     ELSE                                                               CMG003
146900210712     C                     MOVEL'N'       CMG003                                              CMG003
147000210712     C                     ENDIF                                                              CMG003
147100210712      *                                                                                       CMG003
147200210712      ** Check if SWIFT Changes 2013 (CSW213) is installed                                    CSW213
147300210712      *                                                                                       CSW213
147400210712     C                     CALL 'SWIF2013'                                                    CSW213
147500210712     C                     PARM *BLANKS   P@RTCD                                              CSW213
147600210712      *                                                                                       CSW213
147700210712     C           P@RTCD    IFEQ 'CSW2013'                                                     CSW213
147800210712     C                     MOVE 'Y'       CSW213  1                                           CSW213
147900210712     C                     ELSE                                                               CSW213
148000210712     C                     MOVE 'N'       CSW213                                              CSW213
148100210712     C                     ENDIF                                                              CSW213
148200210712      *                                                                                       CSW213
148300210712      *                                                                                       CSW214
148400210712      ** Check if SWIFT Changes 2014 (CSW214) is installed                                    CSW214
148500210712      *                                                                                       CSW214
148600210712     C                     CALL 'SWIF2014'                                                    CSW214
148700210712     C                     PARM *BLANKS   PRTCD                                               CSW214
148800210712      *                                                                                       CSW214
148900210712     C           PRTCD     IFEQ 'CSW2014'                                                     CSW214
149000210712     C                     MOVE 'Y'       CSW214  1                                           CSW214
149100210712     C                     ELSE                                                               CSW214
149200210712     C                     MOVE 'N'       CSW214                                              CSW214
149300210712     C                     ENDIF                                                              CSW214
149400210712      *                                                                                       CSW214
149500210712      *                                                                                       CSW221
149600210712      ** Check if SWIFT Changes 2021 (CSW221) is installed                                    CSW221
149700210712      *                                                                                       CSW221
149800210712     C                     CALL SWIFT                                                         CSW221
149900210712     C                     PARM 'CSW221'  PSWIFT  6                                           CSW221
150000210712     C                     PARM *BLANKS   PRTCD   7                                           CSW221
150100210712      *                                                                                       CSW221
150200210712     C           PRTCD     IFEQ 'CSWACTV'                                                     CSW221
150300210712     C                     MOVE 'Y'       CSW221  1                                           CSW221
150400210712     C                     ELSE                                                               CSW221
150500210712     C                     MOVE 'N'       CSW221                                              CSW221
150600210712     C                     ENDIF                                                              CSW221
150700210712      *                                                                                       CSW221
150800210712     C/COPY WNCPYSRC,SD2410C001
150900210712     C*
151000210712     C** PERFORM VALIDATION ROUTINE V01 IF TERMINATION PARAMETER NOT=T
151100210712     C*
151200210712     C           PMTERM    IFNE 'T'                        B1
151300210712     C*                                                                   BHF465
151400210712     C                     MOVEL' '       CPBNBI                          E28710
151500210712     C*                                                                   E28710
151600210712     C** DO RECEIVE SIDE DEFAULTING FOR SETTLEMENT METHOD 01 AND 08       BHF465
151700210712     C*                                                                   BHF465
151800210712     C********** PMPSTM    IFEQ 01                                  BHF465BHF547
151900210712     C********** PMPSTM    OREQ 08                                  BHF465BHF547
152000210712     C           PMRSTM    IFEQ 01                                        BHF547
152100210712     C********** PMDEFT    ANDEQ'Y'                                 LN0787LN0806
152200210712     C           PMDEFR    ANDEQ'Y'                                       LN0806
152300210712     C           PMRSTM    OREQ 08                                        BHF547
152400210712     C           PMDEFR    ANDEQ'Y'                                       LN0787
152500210712     C                     EXSR RECDEF                                    BHF465
152600210712     C                     END                                            BHF465
152700210712     C*                                                                   S01297
152800210712     C********** PMRSTM    IFEQ 01                                  S01297LN0691
152900210712     C********** PMRSTM    OREQ 08                                  S01297LN0691
153000210712     C********** PMRSTM    OREQ 07                                  S01297LN0691
153100210712     C********** PMPSTM    IFEQ 01                                  LN0691BHF517
153200210712     C********** PMPSTM    OREQ 08                                  LN0691BHF517
153300210712     C           PMPSTM    IFEQ 08                                        BHF517
153400210712     C           PMDEFT    ANDEQ'Y'                                       LN0787
153500210712     C           PMPSTM    OREQ 07                                        LN0691
153600210712     C********** PMDEFT    ANDEQ'Y'                                 LN0787BHF758
153700210712     C           PMPSTM    OREQ 01                                        E26971
153800210712     C           PMDEFT    ANDEQ'Y'                                       E26971
153900210712     C                     EXSR DEFLT                      DEFAULTING     S01297
154000210712     C                     ELSE                                           S01297
154100210712     C                     MOVEA*BLANK    ERCD                            S01297
154200210712     C                     Z-ADD1         S       30                      S01297
154300210712     C                     END                                            S01297
154400210712     C*                                                                   S01297
154500210712     C/COPY WNCPYSRC,SD2410C033
154600210712     C                     EXSR V01                        VALIDATION
154700210712     C*                                                                   113832
154800210712     C* Re-initialise flags to validate settlement fields again if        113832
154900210712     C* user changes them after initial validation                        113832
155000210712     C*                                                                   113832
155100210712     C           CLE003    IFEQ 'Y'                                       113832
155200210712     C           COUNT     IFEQ 3                                         113832
155300210712     C           COUNT1    OREQ 3                                         113832
155400210712     C                     Z-ADD1         COUNT                           113832
155500210712     C                     Z-ADD1         COUNT1                          113832
155600210712     C                     MOVELCOUNT     PMCMDP                          113832
155700210712     C                     MOVE COUNT1    PMCMDP                          113832
155800210712     C                     ENDIF                                          113832
155900210712     C                     ENDIF                                          113832
156000210712      *
156100210712      **   IF any errors found, set settlement details valid parameter
156200210712      **   to 'N'
156300210712      *
156400210712     C                     MOVEAERCD      PMERCD           *1
156500210712     C           PMERCD    IFNE *BLANKS                    B*2
156600210712     C                     MOVE 'N'       PMSDTV           **2
156700210712     C*********************MOVE 'Y'       PMDEFT                    LN0759LN0787
156800210712     C                     END                             E*2
156900210712     C*
157000210712     C*   If errors found on an amendment set the appropriate redefault   LN0787
157100210712     C*   parameter. (*in30 = receipt error, *in31 = payment error)       LN0787
157200210712     C*                                                                   LN0787
157300210712     C           PMERCD    IFNE *BLANKS                                   LN0787
157400210712     C           PMACTC    ANDEQ'A'                                       LN0787
157500210712     C           *IN30     IFEQ '1'                                       LN0787
157600210712     C                     MOVE 'Y'       PMDEFR                          LN0787
157700210712     C                     END                                            LN0787
157800210712     C           *IN31     IFEQ '1'                                       LN0787
157900210712     C                     MOVE 'Y'       PMDEFT                          LN0787
158000210712     C                     END                                            LN0787
158100210712     C                     END                                            LN0787
158200210712     C*                                                                   LN0787
158300210712     C                     ELSE                            X1
158400210712     C*
158500210712     C** OTHERWISE TERMINATION PARAMETER = T
158600210712     C*
158700210712     C***CALL ACCESS OBJECTS TO CLOSE ALL FILES                           S01117
158800210712     C*****                EXSR Z01                                       S01117
158900210712     C*
159000210712     C** TERMINATE PROGRAM WITH LR ON
159100210712     C*
159200210712     C                     MOVE '1'       *INLR            *1
159300210712     C                     END                             E1
159400210712     C*
159500210712     C                     RETRN
159600210712     C/EJECT
159700210712     C*****************************************************************
159800210712     C** V01    - VALIDATION OF SCREEN DETAILS RECEIVED
159900210712     C**
160000210712     C** CALLED BY : MAIN
160100210712     C** CALLS SR  : CHKFL;BTBVAL
160200210712     C**
160300210712     C           V01       BEGSR
160400210712     C           *NAMVAR   DEFN           LDA                             E24039
160500210712     C           *LOCK     IN   LDA                                       E24039
160600210712     C                     OUT  LDA                                       E24039
160700210712     C                     MOVEA'00000000'*IN,36
160800210712     C                     MOVEA'00000000'*IN,44
160900210712     C                     MOVE '0'       *IN61                           E22405
161000210712     C                     MOVEA'00'      *IN,30                          LN0787
161100210712     C*                                                                   CEU003
161200210712     C                     MOVE '0'       *IN08                           CEU003
161300210712     C                     MOVE '0'       *IN11                           CEU003
161400210712     C                     MOVE '0'       *IN14                           CEU003
161500210712     C**
161600210712     C**********           MOVEA*BLANK    ERCD                            S01297
161700210712     C                     MOVE 'Y'       PMSDTV
161800210712      *                                                                   DT0168
161900210712      ***Set*pay*branch*flag*if*the*settlement*branch*has*been*set*uDT0168139921
162000210712      *                                                             DT0168139921
162100210712     C********** PMPOBR    IFNE *BLANKS                             DT0168139921
162200210712     C**********           MOVE 'Y'       PBRF                      DT0168139921
162300210712     C**********           END                                      DT0168139921
162400210712     C**
162500210712     C*****                MOVE *BLANKS   RTCD    7                       S01117
162600210712     C*****                MOVEL'*KEY   ' OPTN    7                       S01117
162700210712     C*****                MOVE PMBRCD    DSNB    3                       S01117
162800210712     C*****                MOVE *BLANKS   A8RF                            S01117
162900210712      *****                                                               S01117
163000210712     C*****                CALL 'AOBRCHR0'             90                 S01117
163100210712      *****                                                               S01117
163200210712     C*****                PARM           RTCD                            S01117
163300210712     C*****                PARM           OPTN                            S01117
163400210712     C*****                PARM           DSNB                            S01117
163500210712     C*****                PARM           A8RF                            S01117
163600210712      *****                                                               S01117
163700210712     C*****      RTCD      IFNE *BLANKS                                   S01117
163800210712     C*****      *IN90     OREQ '1'                                       S01117
163900210712      *****                                                               S01117
164000210712     C*****                MOVEL'BRCH '   PMDBFL           ************** S01117
164100210712     C*****                MOVEL'SDKUUPR' PMDPGM           ** DBASE 01 ** S01117
164200210712     C*****                Z-ADD01        PMDBSE           ************** S01117
164300210712     C*****                MOVE 'T'       PMTERM                          S01117
164400210712     C*****                SETON                     U7U8LR               S01117
164500210712     C*****                RETRN                                          S01117
164600210712     C*****                END                                            S01117
164700210712     C**
164800210712     C**********           Z-ADD1         S       30                      S01297
164900210712     C*                                                                   S01408
165000210712     C/COPY WNCPYSRC,SD2410CP14                                           S01408
165100210712     C*                                                                   S01408
165200210712     C**  Validation of Receipt Settlement Currency                       CEU003
165300210712     C*                                                                   CEU003
165400210712     C**  If CEU003 is supported                                          CEU003
165500210712     C*                                                                   CEU003
165600210712     C           CEU003    IFEQ 'Y'                                       CEU003
165700210712     C           PMDTPY    IFLT PMDTRC                                    CEU003
165800210712     C           PMDTPY    ANDGT0                                         CEU003
165900210712     C           PMDTRC    OREQ 0                                         CEU003
166000210712     C                     Z-ADDPMDTPY    WDTRP   50                      CEU003
166100210712     C                     ELSE                                           CEU003
166200210712     C                     Z-ADDPMDTRC    WDTRP                           CEU003
166300210712     C                     ENDIF                                          CEU003
166400210712     C                     ENDIF                                          CEU003
166500210712     C*                                                                   CEU003
166600210712     C           PMACTC    IFEQ 'X'                                       CEU003
166700210712     C           PMPRCV    OREQ 'N'                                       CEU003
166800210712     C*                                                                   CEU003
166900210712     C           CEU003    IFEQ 'Y'                                       CEU003
167000210712     C           PMCPGM    ANDNE'SSI'                                     CEU003
167100210712     C           CLE031    OREQ 'Y'                                                           CLE031
167200210712     C           PMCPGM    ANDNE'SSI'                                                         CLE031
167300210712     C           PMCPGM    ANDEQ'LEND'                                                        CLE031
167400210712     C*                                                                   CEU003
167500210712     C**  Access Currency Details                                         CEU003
167600210712     C*                                                                   CEU003
167700210712     C                     CALL 'AOCURRR0'                                CEU003
167800210712     C                     PARM '*DBERR ' PRTCD                           CEU003
167900210712     C                     PARM '*KEY   ' POPTN                           CEU003
168000210712     C                     PARM PMRCCY    PCURR   3                       CEU003
168100210712     C           SDCURR    PARM SDCURR    DSSDY                           CEU003
168200210712     C*                                                                   CEU003
168300210712     C           PMRSCY    IFNE *BLANKS                                   CEU003
168400210712     C*                                                                   CEU003
168500210712     C**  Access Currency Details                                         CEU003
168600210712     C*                                                                   CEU003
168700210712     C           CLE031    IFEQ 'Y'                                                           CLE031
168800210712     C           PMCPGM    ANDEQ'LEND'                                                        CLE031
168900210712     C                     MOVE *BLANKS   ARINCY                                              CLE031
169000210712     C                     MOVE *BLANKS   BRINCY                                              CLE031
169100210712     C                     MOVE *BLANKS   BRDLCI                                              CLE031
169200210712     C                     MOVE *ZEROS    AMREXR                                              CLE031
169300210712     C                     MOVE *BLANKS   AMREXI                                              CLE031
169400210712     C                     MOVE A6INCY    ARINCY  1                                           CLE031
169500210712     C                     MOVE A6SPRT    ARSPRT                                              CLE031
169600210712     C                     MOVE A6MDIN    ARMDIN                                              CLE031
169700210712     C                     ENDIF                                                              CLE031
169800210712      *                                                                                       CLE031
169900210712     C                     CALL 'AOCURRR0'                                CEU003
170000210712     C                     PARM *BLANKS   PRTCD                           CEU003
170100210712     C                     PARM '*KEY    'POPTN                           CEU003
170200210712     C                     PARM PMRSCY    PCURR   3                       CEU003
170300210712     C           SDCURR    PARM SDCURR    DSSDY                           CEU003
170400210712     C*                                                                   CEU003
170500210712     C**  Receipt settlement currency is invalid                          CEU003
170600210712     C*                                                                   CEU003
170700210712     C           PRTCD     IFNE *BLANKS                                   CEU003
170800210712     C                     MOVE '862'     ERCD,S                          CEU003
170900210712     C                     ADD  1         S                               CEU003
171000210712     C                     MOVE '1'       *IN08                           CEU003
171100210712     C                     ELSE                                           CEU003
171200210712     C*                                                                   CEU003
171300210712     C                     MOVELA6CYCD    PMRSCY                          CEU003
171400210712     C                     MOVELA6NBDP    WRSDP   3                       CEU003
171500210712     C*                                                                   CEU003
171600210712      *                                                                                       CLE031
171700210712      **  CLE031 enhancement allows settlement of In-ccy or Euro currency                     CLE031
171800210712      **  against other currencies                                                            CLE031
171900210712      *                                                                                       CLE031
172000210712     C           CLE031    IFEQ 'Y'                                                           CLE031
172100210712     C           PMCPGM    ANDEQ'LEND'                                                        CLE031
172200210712     C           ARINCY    ANDNE'Y'                                                           CLE031
172300210712     C           PMRSCY    ANDNE*BLANKS                                                       CLE031
172400210712     C                     MOVE A6SPRT    AMREXR                                              CLE031
172500210712     C                     MOVE A6MDIN    AMREXI                                              CLE031
172600210712     C                     MOVE A6DLCI    BRDLCI  1                                           CLE031
172700210712     C                     MOVE A6INCY    BRINCY  1                                           CLE031
172800210712     C                     ELSE                                                               CLE031
172900210712      *                                                                                       CLE031
173000210712     C           PMRCCY    IFEQ BKEURO                                    CEU003
173100210712     C*                                                                   CEU003
173200210712     C***********WDTRP     IFLT A6TPSD                             CEU003 134935
173300210712     C***********          MOVEL'N'       A6INCY                   CEU003 134935
173400210712     C***********          ENDIF                                   CEU003 134935
173500210712     C*                                                                   CEU003
173600210712     C**  Buy Currency is Euro but currency is not an 'In' currency       CEU003
173700210712     C**  or settlement ccy is not part of EMU during value date          CEU003
173800210712     C*                                                                   CEU003
173900210712     C           A6INCY    IFNE 'Y'                                       CEU003
174000210712     C                     MOVE '850'     ERCD,S                          CEU003
174100210712     C                     ADD  1         S                               CEU003
174200210712     C                     MOVE '1'       *IN08                           CEU003
174300210712     C                     ENDIF                                          CEU003
174400210712     C*                                                                   CEU003
174500210712     C                     ELSE                                           CEU003
174600210712     C*                                                                   CEU003
174700210712     C**  Buy currency is an 'In' currency but the currency is not        CEU003
174800210712     C**  equal to the Euro currency code                                 CEU003
174900210712     C*                                                                   CEU003
175000210712     C           PMRSCY    IFNE BKEURO                                    CEU003
175100210712     C                     MOVE '851'     ERCD,S                          CEU003
175200210712     C                     ADD  1         S                               CEU003
175300210712     C                     MOVE '1'       *IN08                           CEU003
175400210712     C                     ENDIF                                          CEU003
175500210712     C*                                                                   CEU003
175600210712     C                     ENDIF                                          CEU003
175700210712      *                                                                                       CLE031
175800210712     C                     ENDIF                                                              CLE031
175900210712     C*                                                                   CEU003
176000210712     C                     ENDIF                                          CEU003
176100210712     C*                                                                   CEU003
176200210712     C                     ENDIF                                          CEU003
176300210712     C*                                                                   CEU003
176400210712     C                     ENDIF                                          CEU003
176500210712     C*                                                                   CEU003
176600210712     C                     ENDIF                                          CEU003
176700210712     C*                                                                   CEU003
176800210712     C**  Validation of Payment Settlement Currency                       CEU003
176900210712     C*                                                                   CEU003
177000210712     C*                                                                   CEU003
177100210712     C           PMACTC    IFEQ 'X'                                       CEU003
177200210712     C           PMPPAY    OREQ 'N'                                       CEU003
177300210712     C*                                                                   CEU003
177400210712     C           CEU003    IFEQ 'Y'                                       CEU003
177500210712     C           CLE031    OREQ 'Y'                                                           CLE031
177600210712     C*                                                                   CEU003
177700210712     C**  Access Currency Details                                         CEU003
177800210712     C*                                                                   CEU003
177900210712     C                     CALL 'AOCURRR0'                                CEU003
178000210712     C                     PARM '*DBERR ' PRTCD                           CEU003
178100210712     C                     PARM '*KEY   ' POPTN                           CEU003
178200210712     C                     PARM PMPCCY    PCURR                           CEU003
178300210712     C           SDCURR    PARM SDCURR    DSSDY                           CEU003
178400210712     C*                                                                   CEU003
178500210712     C           CLE031    IFEQ 'Y'                                                           CLE031
178600210712     C           PMCPGM    ANDEQ'LEND'                                                        CLE031
178700210712     C                     MOVE *BLANKS   APINCY                                              CLE031
178800210712     C                     MOVE *BLANKS   BPINCY                                              CLE031
178900210712     C                     MOVE *BLANKS   BPDLCI                                              CLE031
179000210712     C                     MOVE *ZEROS    AMPEXR                                              CLE031
179100210712     C                     MOVE *BLANKS   AMPEXI                                              CLE031
179200210712     C                     MOVE A6INCY    APINCY  1                                           CLE031
179300210712     C                     MOVE A6SPRT    APSPRT                                              CLE031
179400210712     C                     MOVE A6MDIN    APMDIN                                              CLE031
179500210712     C                     ENDIF                                                              CLE031
179600210712      *                                                                                       CLE031
179700210712     C           A6INCY    IFEQ 'Y'                                       CEU003
179800210712     C           PMPCCY    OREQ BKEURO                                    CEU003
179900210712     C           CLE031    OREQ 'Y'                                                           CLE031
180000210712     C*                                                                   CEU003
180100210712     C**  Access Currency Details                                         CEU003
180200210712     C*                                                                   CEU003
180300210712     C           PMPSCY    IFNE *BLANKS                                   CEU003
180400210712     C*                                                                   CEU003
180500210712     C                     CALL 'AOCURRR0'                                CEU003
180600210712     C                     PARM *BLANKS   PRTCD                           CEU003
180700210712     C                     PARM '*KEY    'POPTN                           CEU003
180800210712     C                     PARM PMPSCY    PCURR                           CEU003
180900210712     C           SDCURR    PARM SDCURR    DSSDY                           CEU003
181000210712     C*                                                                   CEU003
181100210712     C**  Payment settlement currency is invalid                          CEU003
181200210712     C*                                                                   CEU003
181300210712     C           PRTCD     IFNE *BLANKS                                   CEU003
181400210712     C                     MOVE '848'     ERCD,S                          CEU003
181500210712     C                     ADD  1         S                               CEU003
181600210712     C                     MOVE '1'       *IN11                           CEU003
181700210712     C                     ELSE                                           CEU003
181800210712     C*                                                                   CEU003
181900210712     C                     MOVELA6CYCD    PMPSCY                          CEU003
182000210712     C                     MOVELA6NBDP    WPSDP   3                       CEU003
182100210712     C*                                                                   CEU003
182200210712      *                                                                                       CLE031
182300210712      **  CLE031 enhancement allows settlement of In-ccy or Euro currency                     CLE031
182400210712      **  against other currencies                                                            CLE031
182500210712      *                                                                                       CLE031
182600210712     C           CLE031    IFEQ 'Y'                                                           CLE031
182700210712     C           PMCPGM    ANDEQ'LEND'                                                        CLE031
182800210712     C           APINCY    ANDNE'Y'                                                           CLE031
182900210712     C           PMPSCY    ANDNE*BLANKS                                                       CLE031
183000210712     C                     MOVE A6SPRT    AMPEXR                                              CLE031
183100210712     C                     MOVE A6MDIN    AMPEXI                                              CLE031
183200210712     C                     MOVE A6DLCI    BPDLCI  1                                           CLE031
183300210712     C                     MOVE A6INCY    BPINCY  1                                           CLE031
183400210712     C                     ELSE                                                               CLE031
183500210712      *                                                                                       CLE031
183600210712     C           PMPCCY    IFEQ BKEURO                                    CEU003
183700210712     C*                                                                   CEU003
183800210712     C***********WDTRP     IFLT A6TPSD                             CEU003 134935
183900210712     C***********PMCPGM    ANDNE'SSI'                              CEU003 134935
184000210712     C***********          MOVEL'N'       A6INCY                   CEU003 134935
184100210712     C***********          ENDIF                                   CEU003 134935
184200210712     C*                                                                   CEU003
184300210712     C**  Sell currency is Euro but the currency is not an 'In' currency  CEU003
184400210712     C**  or settlement ccy is not part of EMU during value date          CEU003
184500210712     C*                                                                   CEU003
184600210712     C           A6INCY    IFNE 'Y'                                       CEU003
184700210712     C                     MOVE '853'     ERCD,S                          CEU003
184800210712     C                     ADD  1         S                               CEU003
184900210712     C                     MOVE '1'       *IN11                           CEU003
185000210712     C                     ENDIF                                          CEU003
185100210712     C*                                                                   CEU003
185200210712     C                     ELSE                                           CEU003
185300210712     C*                                                                   CEU003
185400210712     C*                                                                   CEU003
185500210712     C**  Sell Currency is an 'In' currency but payment settlement        CEU003
185600210712     C**  currency is not equal to Euro currency code                     CEU003
185700210712     C*                                                                   CEU003
185800210712     C           PMPSCY    IFNE BKEURO                                    CEU003
185900210712     C                     MOVE '854'     ERCD,S                          CEU003
186000210712     C                     ADD  1         S                               CEU003
186100210712     C                     MOVE '1'       *IN11                           CEU003
186200210712     C                     ENDIF                                          CEU003
186300210712     C*                                                                   CEU003
186400210712     C                     ENDIF                                          CEU003
186500210712      *                                                                                       CLE031
186600210712     C                     ENDIF                                                              CLE031
186700210712     C*                                                                   CEU003
186800210712     C                     ENDIF                                          CEU003
186900210712     C*                                                                   CEU003
187000210712     C**  Settlement method is 00 and settlement ccy is not               CEU003
187100210712     C**  blank                                                           CEU003
187200210712     C*                                                                   CEU003
187300210712     C           PMCPGM    IFEQ 'SSI'                                     CEU003
187400210712     C           PMRSTM    ANDEQ00                                        CEU003
187500210712     C           PMPSTM    ANDEQ00                                        CEU003
187600210712     C                     MOVE '842'     ERCD,S                          CEU003
187700210712     C                     ADD  1         S                               CEU003
187800210712     C                     MOVE '1'       *IN11                           CEU003
187900210712     C                     ENDIF                                          CEU003
188000210712     C*                                                                   CEU003
188100210712     C                     ENDIF                                          CEU003
188200210712     C*                                                                   CEU003
188300210712     C                     ELSE                                           CEU003
188400210712     C*                                                                   CEU003
188500210712     C**  Transaction currency is an 'Out' currency                       CEU003
188600210712     C*                                                                   CEU003
188700210712     C           PMPSCY    IFNE *BLANKS                                   CEU003
188800210712     C                     MOVE '844'     ERCD,S                          CEU003
188900210712     C                     ADD  1         S                               CEU003
189000210712     C                     MOVE '1'       *IN11                           CEU003
189100210712     C                     ENDIF                                          CEU003
189200210712     C*                                                                   CEU003
189300210712     C                     ENDIF                                          CEU003
189400210712     C*                                                                   CEU003
189500210712     C                     ENDIF                                          CEU003
189600210712     C*                                                                   CEU003
189700210712     C                     ENDIF                                          CEU003
189800210712     C*                                                                   CEU003
189900210712     C           CLE031    IFEQ 'Y'                                                           CLE031
190000210712     C           PMCPGM    ANDEQ'LEND'                                                        CLE031
190100210712     C                     ELSE                                                               CLE031
190200210712      *                                                                                       CLE031
190300210712     C           CEU003    IFEQ 'Y'                                       CEU003
190400210712     C           PMCPGM    ANDNE'FXFX'                                    CEU003
190500210712     C           PMPRCV    ANDEQ'N'                                       CEU003
190600210712     C           PMPPAY    ANDEQ'N'                                       CEU003
190700210712     C           PMPSCY    ANDNEPMRSCY                                    CEU003
190800210712     C           PMTTYP    ANDNE'RX'                                      CEU003
190900210712     C                     MOVE '847'     ERCD,S                          CEU003
191000210712     C                     ADD  1         S                               CEU003
191100210712     C                     MOVE '1'       *IN08                           CEU003
191200210712     C                     MOVE '1'       *IN11                           CEU003
191300210712     C                     ENDIF                                          CEU003
191400210712      *                                                                                       CLE031
191500210712     C                     ENDIF                                                              CLE031
191600210712     C*                                                                   CEU003
191700210712     C**  Effective receipt settlement currency                           CEU003
191800210712     C*                                                                   CEU003
191900210712     C           CEU003    IFEQ 'Y'                                       CEU003
192000210712     C           PMRSCY    ANDNE*BLANKS                                   CEU003
192100210712     C           *IN08     ANDEQ'0'                                       CEU003
192200210712     C                     MOVELPMRSCY    WRECY   3                       CEU003
192300210712     C                     ELSE                                           CEU003
192400210712     C                     MOVELPMRCCY    WRECY                           CEU003
192500210712     C                     ENDIF                                          CEU003
192600210712     C*                                                                   CEU003
192700210712     C**  Effective Payment Settlement Currency                           CEU003
192800210712     C*                                                                   CEU003
192900210712     C           CEU003    IFEQ 'Y'                                       CEU003
193000210712     C           PMPSCY    ANDNE*BLANKS                                   CEU003
193100210712     C           *IN11     ANDEQ'0'                                       CEU003
193200210712     C                     MOVELPMPSCY    WPECY   3                       CEU003
193300210712     C                     ELSE                                           CEU003
193400210712     C                     MOVELPMPCCY    WPECY                           CEU003
193500210712     C                     ENDIF                                          CEU003
193600210712     C*                                                                   CEU003
193700210712     C********** PMACTC    IFNE 'X'                                       118948
193800210712     C********** PMPRCV    CABEQ'Y'       PAYMNT                          118948
193900210712     C**********           END                                            118948
194000210712      *                                                                                       260577
194100210712      ** This part should not be ommitted as to condition whether there                       260577
194200210712      ** is a need to validate receipt side or not.  Just change to                           260577
194300210712      ** bypass validation even if action code is 'X'                                         260577
194400210712      *                                                                                       260577
194500210712     C           PMPRCV    CABEQ'Y'       PAYMNT                                              260577
194600210712     C*
194700210712     C** VALIDATE RECEIPT
194800210712     C** ================
194900210712      *
195000210712     C********** PMROCN    IFEQ '000000'                                                      CSD027
195100210712     C**********           MOVE *BLANKS   PMROCN                                              CSD027
195200210712     C**********           END                                                                CSD027
195300210712     C********** PMROBN    IFEQ '000000'                                                      CSD027
195400210712     C**********           MOVE *BLANKS   PMROBN                                              CSD027
195500210712     C**********           END                                                                CSD027
195600210712     C*                                                                   S01117
195700210712     C** BLANK OUT WORK FIELD @OBR & DATA STRUCTURES FOR RECEIPT          S01117
195800210712     C** INSTRUCTIONS VALIDATION.                                         S01117
195900210712     C                     MOVE *BLANKS   @OBR                            S01117
196000210712     C                     MOVE *BLANKS   ALRF                            S01117
196100210712     C                     MOVE *BLANKS   CURF                            S01117
196200210712     C                     MOVE *BLANKS   A7RF                            S01117
196300210712     C                     MOVE *BLANKS   ACCT                            S01117
196400210712     C                     MOVE *BLANKS   DMRF                            S01117
196500210712     C                     MOVE *BLANKS   SDBRCH                          S01117
196600210712     C*
196700210712     C** ENTRY IN ALL RECEIPT INSTRUCTIONS PROHIBITED IF RECEIPT
196800210712     C** SETTLEMENT METHOD IS 00
196900210712     C           PMRSTM    IFEQ 00                         B1
197000210712     C*                                                                   E00033
197100210712     C***********PMROBR    IFNE *BLANKS                    B*2     E00033 S01117
197200210712     C*********************MOVE *BLANKS   PMROBR           **2     E00033 S01117
197300210712     C*********************END                             E*2     E00033 S01117
197400210712     C*                                                                   E00033
197500210712     C           PMRONS    IFNE *BLANKS                    B*2
197600210712     C           PMROBN    ORNE *BLANKS                    **2
197700210712     C           PMROCN    ORNE *BLANKS                    **2
197800210712     C           PMRIBN    ORNE *BLANK                     **2
197900210712     C           PMRIBA    ORNE *BLANK                     **2
198000210712     C***********PMOPSB    ORNE *BLANKS                    **2            S01117
198100210712     C           PMROBR    ORNE *BLANKS                    **2            S01117
198200210712     C           PMRBB1    ORNE *BLANKS                                                       CDL094
198300210712     C           PMRBB2    ORNE *BLANKS                                                       CDL094
198400210712     C           PMRBB3    ORNE *BLANKS                                                       CDL094
198500210712     C           PMRBB4    ORNE *BLANKS                                                       CDL094
198600210712     C           PMRBB5    ORNE *BLANKS                                                       CDL094
198700210712     C           PMRBB6    ORNE *BLANKS                                                       CDL094
198800210712     C                     MOVE '900'     ERCD,S           **2
198900210712     C                     ADD  1         S                **2
199000210712     C                     MOVE '1'       *IN30            **2            LN0787
199100210712     C                     END                             E*2
199200210712     C                     END                             E1
199300210712     C*
199400210712     C** ENTRY PROHIBITED FOR ORDERING CUSTOMER; ORDERING BANK; INTERM.
199500210712     C***BANK*AND*INTERM.*BANK*A/C*LINE*UNLESS*SETTL.TP*IS*01*07*OR*08    CLE033
199600210712     C** BANK AND INTERM. BANK A/C LINE UNLESS SETTL.TP IS 01 07 08 OR 09 CLE033
199700210712     C           PMRSTM    IFNE 01                         B1
199800210712     C           PMRSTM    ANDNE07                         *1
199900210712     C           PMRSTM    ANDNE08                         *1
200000210712     C           CLE033    ANDNE'Y'                        *1             CLE033
200100210712     C           PMRSTM    ORNE 01                         B1             CLE033
200200210712     C           PMRSTM    ANDNE07                         *1             CLE033
200300210712     C           PMRSTM    ANDNE08                         *1             CLE033
200400210712     C           CLE033    ANDEQ'Y'                        *1             CLE033
200500210712     C           PMRSTM    ANDNE09                         *1             CLE033
200600210712     C           PMROCN    IFNE *BLANKS                    B*2
200700210712     C           PMROBN    ORNE *BLANKS                    **2
200800210712     C           PMRIBN    ORNE *BLANK                     **2
200900210712     C/COPY WNCPYSRC,SD2410C063
201000210712     C           PMRIBA    ORNE *BLANK                     **2
201100210712     C           PMRBB1    ORNE *BLANKS                                                       CDL094
201200210712     C           PMRBB2    ORNE *BLANKS                                                       CDL094
201300210712     C           PMRBB3    ORNE *BLANKS                                                       CDL094
201400210712     C           PMRBB4    ORNE *BLANKS                                                       CDL094
201500210712     C           PMRBB5    ORNE *BLANKS                                                       CDL094
201600210712     C           PMRBB6    ORNE *BLANKS                                                       CDL094
201700210712     C                     MOVE '901'     ERCD,S           **2
201800210712     C                     ADD  1         S                **2
201900210712     C                     MOVE '1'       *IN30            **2            LN0787
202000210712     C           PMROCN    IFNE *BLANKS                    B**3
202100210712     C                     MOVE '1'       *IN37            ***3
202200210712     C                     END                             E**3
202300210712     C           PMROBN    IFNE *BLANKS                    B**3
202400210712     C                     MOVE '1'       *IN39            ***3
202500210712     C                     END                             E**3
202600210712     C           PMRIBN    IFNE *BLANK                     B**3
202700210712     C                     MOVE '1'       *IN43            ***3
202800210712     C                     END                             E**3
202900210712     C           PMRIBA    IFNE *BLANK                     B**3
203000210712     C                     MOVE '1'       *IN45            ***3
203100210712     C                     END                             E**3
203200210712     C                     END                             E*2
203300210712     C                     END                             E1
203400210712     C*
203500210712     C/COPY WNCPYSRC,SD2410C079
203600210712     C*
203700210712     C** SETTLEMENT METHOD
203800210712     C** -----------------
203900210712     C*
204000210712     C***MUST*BE*00,01,02,03,04,05,06,07,08,12*OR*14***                   CLE033
204100210712     C** MUST BE 00,01,02,03,04,05,06,07,08,09,12 OR 14                   CLE033
204200210712     C           PMRSTM    IFNE 00                         B1
204300210712     C           PMRSTM    ANDNE01                         *1
204400210712     C           PMRSTM    ANDNE02                         *1
204500210712     C           PMRSTM    ANDNE03                         *1
204600210712     C           PMRSTM    ANDNE04                         *1
204700210712     C           PMRSTM    ANDNE05                         *1
204800210712     C           PMRSTM    ANDNE06                         *1
204900210712     C           PMRSTM    ANDNE07                         *1
205000210712     C           PMRSTM    ANDNE08                         *1
205100210712     C           PMRSTM    ANDNE12                         *1
205200210712     C           PMRSTM    ANDNE14                         *1
205300210712     C           CLE033    ANDNE'Y'                        *1             CLE033
205400210712     C           PMRSTM    ORNE 00                         B1             CLE033
205500210712     C           PMRSTM    ANDNE01                         *1             CLE033
205600210712     C           PMRSTM    ANDNE02                         *1             CLE033
205700210712     C           PMRSTM    ANDNE03                         *1             CLE033
205800210712     C           PMRSTM    ANDNE04                         *1             CLE033
205900210712     C           PMRSTM    ANDNE05                         *1             CLE033
206000210712     C           PMRSTM    ANDNE06                         *1             CLE033
206100210712     C           PMRSTM    ANDNE07                         *1             CLE033
206200210712     C           PMRSTM    ANDNE08                         *1             CLE033
206300210712     C           PMRSTM    ANDNE12                         *1             CLE033
206400210712     C           PMRSTM    ANDNE14                         *1             CLE033
206500210712     C           CLE033    ANDEQ'Y'                        *1             CLE033
206600210712     C           PMRSTM    ANDNE09                         *1             CLE033
206700210712     C                     MOVE '902'     ERCD,S           *1
206800210712     C                     ADD  1         S                *1
206900210712     C                     MOVE '1'       *IN30            **2            LN0787
207000210712     C                     END                             E1
207100210712      *                                                                   CDL008
207200210712     C           CDL008    IFEQ 'Y'                                       CDL008
207300210712     C           PMTTYP    ANDEQ'CL'                                      CDL008
207400210712     C           PMRSTM    ANDNE00                                        186433
207500210712     C           PMRSTM    ANDNE01                                        CDL008
207600210712     C           PMRSTM    ANDNE07                                        CDL008
207700210712     C           PMRSTM    ANDNE08                                        CDL008
207800210712     C           PMRSTM    ANDNE02                                        CDL008
207900210712     C           PMRSTM    ANDNE12                                        CDL008
208000210712     C                     MOVE '303'     ERCD,S                          CDL008
208100210712     C                     ADD  1         S                               CDL008
208200210712     C                     MOVE *ON       *IN30                           CDL008
208300210712     C                     ENDIF                                          CDL008
208400210712     C*
208500210712     C** IF SETL TYPE IS 04 OR 14 THE RETAIL MODULE MUST BE PRESENT
208600210712     C           PMRSTM    IFEQ 04                         B1
208700210712     C           PMRSTM    OREQ 14                         *1
208800210712     C           PMRETP    IFNE 'Y'                        B*2
208900210712     C                     MOVE '903'     ERCD,S           **2
209000210712     C                     ADD  1         S                **2
209100210712     C                     MOVE '1'       *IN30            **2            LN0787
209200210712     C                     END                             E*2
209300210712     C                     END                             E1
209400210712     C*
209500210712     C** IF REC SETL METHOD IS 04 A LIVE RECORD MUST EXIST IN ACCNTAB
209600210712     C           PMRSTM    IFEQ 04                         B1
209700210712     C                     MOVEL*BLANK    ACID             *1             LN0830
209800210712     C                     MOVELPMCSNM    ACID   10        *1
209900210712     C***********          MOVE PMRCCY    CUCD    3        *1             CEU003
210000210712     C                     MOVE WRECY     CUCD    3                       CEU003
210100210712     C                     MOVE '01'      ACSQA   2
210200210712     C**********           MOVE PMPCYA    ACCD    4                                           CGL029
210300210712     C                     MOVE PMPCYA    ACCD   10                                           CGL029
210400210712     C                     MOVE PMBRCA    BRCD             *1             S01117
210500210712      *                                                                   S01117
210600210712      ** SET UP SETTLEMENT BRANCH FOR FILE UPDATES BY OTHER PGMS          S01117
210700210712      ***SET*ON*RECEIVE*BRANCH*FLAG*TO*SIGNIFY*PROGRAM*HAS*SET      S01117139921
210800210712      ***THIS*FIELD*UP***                                           S01117139921
210900210712     C           PMROBR    IFEQ *BLANKS                    B*2            S01117
211000210712     C                     MOVE PMBRCA    PMROBR           **2            S01117
211100210712     C**********           MOVE 'Y'       RBRF             **2      S01117139921
211200210712     C                     END                             B*2            S01117
211300210712      *                                                                   S01117
211400210712     **  FOR STANDING DATA - EXTENDED SETTLEMENTS:                        S01117
211500210712     **  FOR SETTLEMENT TYPE 04 ONLY PARTIAL CHECKING OF ACCOUNT          S01117
211600210712     **  ENTERED CAN BE DONE AS NOT ALL DETAILS ARE AVAILABLE.            S01117
211700210712     **  THEREFORE SUBROUTINE CHKAC SHOULD NOT BE CALLED.                 S01117
211800210712     C           PMCPGM    IFEQ 'SSI '                     B1             S01117
211900210712     C                     MOVE *BLANKS   RTCD             *1             S01117
212000210712     C                     MOVE '865'     ERCD,S           *1             S01117
212100210712     C                     MOVE 'Y'       @SENT            *1             S01117
212200210712     C                     ADD  1         S                *1             S01117
212300210712     C                     MOVE '1'       *IN30            **2            LN0787
212400210712     C                     ELSE                            X1             S01117
212500210712     C                     EXSR CHKAC                      *1             S01117
212600210712     C**********           END                             E1                          S01117 240971
212700210712      *
212800210712     C           RTCD      IFNE *BLANKS                    B*2
212900210712     C           RECI      ORNE 'D'                        B*2            E24104
213000210712     C           ACST      OREQ 'C'                                       060470
213100210712     C                     MOVE '904'     ERCD,S           **2
213200210712     C                     ADD  1         S                **2
213300210712     C                     MOVE '1'       *IN30            **2            LN0787
213400210712      *                                                                   S01408
213500210712      /COPY WNCPYSRC,SD2410CCP3                                           S01408
213600210712      *                                                                   S01408
213700210712     C                     ENDIF                                                              240971
213800210712     C                     END                             E*2
213900210712     C                     END                             E1
214000210712     C*
214100210712     C** IF SETL TYPE IS 07 THE RECEIPT CURRENCY MUST BE USD
214200210712     C           PMRSTM    IFEQ 07                         B1
214300210712     C           PMRCCY    ANDNE'USD'                      *1
214400210712     C                     MOVE '905'     ERCD,S           *1
214500210712     C                     ADD  1         S                *1
214600210712     C                     MOVE '1'       *IN30            **2            LN0787
214700210712     C                     END                             E1
214800210712     C*
214900210712     C** IF SETL TYPE IS 14 THE RETAIL ACCOUNT NUMBER MUST BE SUPPORTED
215000210712     C           PMRSTM    IFEQ 14                         B1
215100210712     C           PMRETS    ANDNE'Y'                        *1
215200210712     C                     MOVE '906'     ERCD,S           *1
215300210712     C                     ADD  1         S                *1
215400210712     C                     MOVE '1'       *IN30            **2            LN0787
215500210712     C                     END                             E1
215600210712     C*                                                                   CLE033
215700210712     C** IF SETTLEMENT 09 ACCOUNT CODE IS RETAIL                          CLE033
215800210712     C           A5ACTY    IFEQ 'R'                        B1             CLE033
215900210712     C           CLE033    ANDEQ'Y'                                       CLE033
216000210712     C           PMRSTM    ANDEQ09                                        CLE033
216100210712     C*                                                                   CLE033
216200210712     C           PMRSCY    IFNE *BLANKS                    B2             CLE033
216300210712     C           SET09     ANDNE'T'                                                           218782
216400210712     C                     MOVE PMRSCY    W0RSCY  3                       CLE033
216500210712     C                     ENDIF                           E2             CLE033
216600210712     C*                                                                   CLE033
216700210712     C           PMRSCY    IFEQ *BLANKS                    B2             CLE033
216800210712     C           SET09     OREQ 'T'                                                           218782
216900210712     C                     MOVE PMRCCY    W0RSCY                          CLE033
217000210712     C                     ENDIF                           E2             CLE033
217100210712     C*                                                                   CLE033
217200210712     C**********           MOVELP@VL02    W0ACCD  4                                    CLE033 CGL029
217300210712     C                     MOVELP@VL02    W0ACCD 10                                           CGL029
217400210712     C                     MOVELP@VL01    W0CNUM  6                       CLE033
217500210712     **  For Standing Data - Extended Settlements:                                            218906
217600210712     **  For Settlement Type 09, only partial checking of account                             218906
217700210712     **  entered can be done, as not all details are available.                               218906
217800210712     **  Therefore subroutine AOACCTR0 should not be called.                                  218906
217900210712     C           PMCPGM    IFNE 'SSI '                     If not SSI                         218906
218000210712     C*                                                                   CLE033
218100210712     C                     CALL 'AOACCTR0'                                CLE033
218200210712     C                     PARM *BLANKS   P@RTCD  7                       CLE033
218300210712     C                     PARM '*KEY   ' P@OPTN  7                       CLE033
218400210712     C                     PARM *BLANKS   P@RETL 10                       CLE033
218500210712     C                     PARM W0CNUM    P@CNUM  6                       CLE033
218600210712     C                     PARM W0RSCY    P@CUCD  3                       CLE033
218700210712     C**********           PARM W0ACCDS   P@ACCD  4                                    CLE033 CGL029
218800210712     C                     PARM *BLANKS   P@ACCD 10                                           CGL029
218900210712     C                     PARM '01'      P@ACSQ  2                       CLE033
219000210712     C                     PARM PMBRCA    P@BRCA  3                       CLE033
219100210712     C           ACCT      PARM ACCT      DSSDY                           CLE033
219200210712     C*                                                                   CLE033
219300210712     C           P@RTCD    IFNE *BLANKS                    B2             CLE033
219400210712     C           RECI      ORNE 'D'                                       CLE033
219500210712     C           ATYP      ORNE 'R'                                       CLE033
219600210712     C                     MOVE '904'     ERCD,S           *1             CLE033
219700210712     C                     ADD  1         S                *1             CLE033
219800210712     C                     MOVE '1'       *IN30            **2            CLE033
219900210712     C                     ENDIF                           E2             CLE033
220000210712     C*                                                                   CLE033
220100210712     C                     ENDIF                           End not SSI                        218906
220200210712      *                                                                                       218906
220300210712     C                     ENDIF                           E1             CLE033
220400210712     C/COPY WNCPYSRC,SD2410C022
220500210712     C**                                                                  S01117
220600210712     C** SETTLEMENT BRANCH                                                S01117
220700210712     C** -----------------                                                S01117
220800210712     C*                                                                   S01117
220900210712     C** Only validate Branch in multi-branching environment.             S01117
221000210712     C           @MBIN     IFEQ 'Y'                                       S01117
221100210712     C*                                                                   S01117
221200210712     C***SETTLEMENT*BRANCH*ONLY*ALLOWED*WITH*SETTLEMENT*METHOD*05.  S01117139921
221300210712     C** If Settlement Type not '05', blank out Receive Branch -          139921
221400210712     C** this will be initialised with the correct branch code.           139921
221500210712     C           PMRSTM    IFNE 05                         B1             S01117
221600210712     C           PMRSTM    ANDNE04                          1             141865
221700210712     C           CLE033    ANDNE'Y'                         1             CLE033
221800210712     C           PMRSTM    ORNE 05                          1             CLE033
221900210712     C           PMRSTM    ANDNE04                          1             CLE033
222000210712     C           CLE033    ANDEQ'Y'                         1             CLE033
222100210712     C           PMRSTM    ANDNE09                          1             CLE033
222200210712     C*                                                                   S01117
222300210712     C                     MOVE *BLANKS   PMROBR           B1             139921
222400210712     C*                                                                   139921
222500210712     C***If*Receive*Branch*entered*by*user*then*an*error*has*occurreS01117139921
222600210712     C********** RBRF      IFEQ *BLANKS                    B*2      S01117139921
222700210712     C********** PMROBR    ANDNE*BLANKS                    **2      S01117139921
222800210712     C**********           MOVE '886'     ERCD,S           **2      S01117139221
222900210712     C**********           ADD  1         S                **2      S01117139921
223000210712     C**********           MOVE '1'       *IN30            **2      LN0787139921
223100210712     C**********           END                             E*2      S01117139921
223200210712     C*                                                                   S01117
223300210712     C                     ELSE                            X1             S01117
223400210712     C*                                                                   S01117
223500210712     C           CLE033    IFEQ 'Y'                                       CLE033
223600210712     C           PMRSTM    ANDEQ09                                        CLE033
223700210712     C*                                                                   CLE033
223800210712     C** No processing for condition, only on ELSE.                       CLE033
223900210712     C*                                                                   CLE033
224000210712     C                     ELSE                                           CLE033
224100210712     C*                                                                   CLE033
224200210712     C** SETTLEMENT BRANCH MANDATORY WITH SETTLEMENT METHOD 05.           S01117
224300210712     C           PMROBR    IFEQ *BLANKS                    B*2            S01117
224400210712     C                     MOVE '885'     ERCD,S           **2            S01117
224500210712     C                     ADD  1         S                **2            S01117
224600210712     C                     MOVE '1'       *IN30            **2            LN0787
224700210712     C*                                                                   S01117
224800210712     C                     ELSE                            X*2            S01117
224900210712     C*                                                                   S01117
225000210712     C** VALIDATE SETTLEMENT BRANCH                                       S01117
225100210712     C                     MOVE PMROBR    @OBR    3        **2            S01117
225200210712     C                     EXSR CHKBR                      **2            S01117
225300210712     C*                                                                   S01117
225400210712     C           @RTCD     IFEQ '*NOSEL '                  B**3           S01117
225500210712     C                     MOVE '863'     ERCD,S           ***3           S01117
225600210712     C                     ADD  1         S                ***3           S01117
225700210712     C                     MOVE '1'       *IN30            **2            LN0787
225800210712     C                     END                             E**3           S01117
225900210712     C*                                                                   S01117
226000210712     C           @RTCD     IFNE *BLANKS                    B**3           S01117
226100210712     C                     MOVE '884'     ERCD,S           ***3           S01117
226200210712     C                     ADD  1         S                ***3           S01117
226300210712     C                     MOVE '1'       *IN30            **2            LN0787
226400210712     C                     ELSE                            ***3           S01117
226500210712     C                     MOVE @DSNB     PMROBR           ***3           S01117
226600210712     C                     END                             E**3           S01117
226700210712     C                     END                             E*2            S01117
226800210712     C                     END                             E1             S01117
226900210712     C*                                                                   S01117
227000210712     C                     END                                            S01117
227100210712     C*                                                                   S01117
227200210712     C                     ENDIF                                          CLE033
227300210712     C*
227400210712     C** OUR NOSTRO
227500210712     C** ----------
227600210712     C*
227700210712     C                     MOVE *BLANKS   RNOST   6
227800210712     C                     MOVE PMRONS    NOSTRO
227900210712     C                     MOVE '0'       *IN69
228000210712     C/COPY WNCPYSRC,SD2410C023
228100210712     C*
228200210712     C** MUST BE BLANK IF SETTLEMENT TYPE IS 00,04 OR 06
228300210712     C           PMRSTM    IFEQ 00                         B1
228400210712     C           PMRSTM    OREQ 04                         *1
228500210712     C           PMRSTM    OREQ 06                         *1
228600210712     C           PMRONS    IFNE *BLANK                     B*2
228700210712     C                     MOVE '907'     ERCD,S           **2
228800210712     C                     ADD  1         S                **2
228900210712     C                     MOVE '1'       *IN30            **2            LN0787
229000210712     C                     END                             E*2
229100210712     C                     END                             E1
229200210712     C/COPY WNCPYSRC,SD2410C024
229300210712     C*
229400210712     C** IF SETL TYPE IS 01,02,07,08 OR 12 MUST BE A 2 DIGIT NUMBER
229500210712     C** AND IDENTIFY A LIVE RECORD ON THE NOSTRO FILE SDNOSTPD
229600210712     C           PMRSTM    IFEQ 01                         B1
229700210712     C           PMRSTM    OREQ 02                         *1
229800210712     C           PMRSTM    OREQ 07                         *1
229900210712     C           PMRSTM    OREQ 08                         *1
230000210712     C           PMRSTM    OREQ 12                         *1
230100210712     C/COPY WNCPYSRC,SD2410C025
230200210712     C                     TESTN          NOST02     60    *1
230300210712     C                     MOVEANOST02    @QM                             108517
230400210712     C           '?'       LOKUP@QM                      62               108517
230500210712     C           *IN60     IFNE '1'                        B*2
230600210712     C           *IN62     ANDEQ*OFF                                      108517
230700210712     C           NOSTXX    ORNE *BLANKS                    **2
230800210712     C                     MOVE '908'     ERCD,S           **2
230900210712     C                     ADD  1         S                **2
231000210712     C                     MOVE '1'       *IN30            **2            LN0787
231100210712     C                     MOVE '1'       *IN69            **2            108752
231200210712     C                     ELSE                            X*2
231300210712      *
231400210712     C                     MOVEL'*KEY   ' OPTN    7        **2
231500210712     C***********          MOVE PMRCCY    @CYCD                           CEU003
231600210712     C                     MOVE WRECY     @CYCD                           CEU003
231700210712     C                     MOVE NOST02    @NONB
231800210712      *
231900210712     C                     EXSR CHKNO                      **2
232000210712      *
232100210712     C           RTCD      IFNE *BLANKS                    B**3
232200210712     C           RTCD      ANDNE'*NOSEL '                                 108517
232300210712     C                     MOVE '908'     ERCD,S           ***3
232400210712     C                     ADD  1         S                ***3
232500210712     C                     MOVE '1'       *IN30            **2            LN0787
232600210712     C                     MOVE '1'       *IN69            **2            108752
232700210712      *
232800210712     C                     ELSE                            ***3
232900210712      *
233000210712     C           RTCD      IFEQ '*NOSEL'                                  108517
233100210712     C                     MOVE '867'     ERCD,S                          108517
233200210712     C                     ADD  1         S                               108517
233300210712     C                     MOVE *ON       *IN30                           108517
233400210712     C                     ELSE                                           108517
233500210712      *                                                                   CDL008
233600210712      ** Send error message if CLS Dummy Nostro is not Y                  CDL008
233700210712      *                                                                   CDL008
233800210712     C           CDL008    IFEQ 'Y'                                       CDL008
233900210712      *                                                                   CDL008
234000210712     C           PMTTYP    IFEQ 'CL'                                      CDL008
234100210712     C           A7CLSD    ANDNE'Y'                                       CDL008
234200210712     C                     MOVE '301'     ERCD,S                          CDL008
234300210712     C                     ADD  1         S                               CDL008
234400210712     C                     MOVE *ON       *IN30                           CDL008
234500210712     C                     ENDIF                                          CDL008
234600210712      *                                                                   CDL008
234700210712     C           PMTTYP    IFNE 'CL'                                      CDL008
234800210712     C           A7CLSD    ANDEQ'Y'                                       CDL008
234900210712     C                     MOVE '305'     ERCD,S                          CDL008
235000210712     C                     ADD  1         S                               CDL008
235100210712     C                     MOVE *ON       *IN30                           CDL008
235200210712     C                     ENDIF                                          CDL008
235300210712      *                                                                   CDL008
235400210712     C                     ENDIF                                          CDL008
235500210712      *                                                                   CDL008
235600210712     C                     MOVE A7CUST    RNOST            ***3
235700210712     C                     MOVELA7NONB    PMRONS           ***3           108517
235800210712     C                     MOVEL*BLANK    ACID             ***3           LN0830
235900210712     C                     MOVELA7CUST    ACID             ***3
236000210712     C***********          MOVE PMRCCY    CUCD             ***3           CEU003
236100210712     C                     MOVE WRECY     CUCD                            CEU003
236200210712     C                     MOVE A7ACCD    ACCD             ***3
236300210712     C                     MOVE A7ACSN    ACSQA            ***3
236400210712     C                     MOVE A7BRCD    BRCD             ***3           S01117
236500210712     C                     ENDIF                                          108517
236600210712      *                                                                   S01117
236700210712      ** SET UP SETTLEMENT BRANCH FOR FILE UPDATES BY OTHER PGMS          S01117
236800210712      ***SET*ON*RECEIVE*BRANCH*FLAG*TO*SIGNIFY*PROGRAM*HAS*SET      S01117139921
236900210712      ***THIS*FIELD*UP                                              S01117139921
237000210712     C           PMROBR    IFEQ *BLANKS                    B***4          S01117
237100210712     C                     MOVE A7BRCD    PMROBR           ****4          S01117
237200210712     C**********           MOVE 'Y'       RBRF             ****4    S01117139921
237300210712     C                     END                             B***4          S01117
237400210712      *
237500210712     C                     EXSR CHKAC                      ***3
237600210712      *
237700210712     C           RTCD      IFNE *BLANKS                    B***4
237800210712     C           RECI      ORNE 'D'                        B***4          E24104
237900210712     C                     MOVE '908'     ERCD,S           ****4          108195
238000210712     C                     ADD  1         S                ****4          108195
238100210712     C                     MOVE '1'       *IN30            ****4          108195
238200210712     C                     MOVE '1'       *IN69            ****4
238300210712     C*                                                                   S01117
238400210712     C                     ELSE                            X***4          S01117
238500210712      *                                                                   S01408
238600210712      /COPY WNCPYSRC,SD2410CCP4                                           S01408
238700210712      *                                                                   S01408
238800210712     C*                                                                   S01117
238900210712     C**   IF MULTIBRANCH FLAG OFF NOSTRO MUST EQUAL SINGLE BRANCH        S01117
239000210712     C** (ERROR SHOULDNT HAPPEN UNLESS BANK SWITCHES OFF M/B INCORRECTY)  S01117
239100210712     C           @MBIN     IFEQ 'N'                        B****5         S01117
239200210712     C                     EXSR CHKBK                      *****5         S01117
239300210712     C*                                                                   S01117
239400210712     C           BJSBRC    IFNE A7BRCD                     B*****6        S01117
239500210712     C*********************MOVE '890'     ERCD,S           ******6  S01117LN0785
239600210712     C                     MOVE '500'     ERCD,S           ******6        LN0785
239700210712     C                     ADD  1         S                ******6        S01117
239800210712     C                     MOVE '1'       *IN30            **2            LN0787
239900210712     C                     MOVE '1'       *IN69            **2            108752
240000210712     C                     END                             E*****6        S01117
240100210712     C                     END                             E****5         S01117
240200210712     C*                                                                   S01117
240300210712     C** RETRIEVE BRANCH INTERNAL CUSTOMER NUMBER ASSOCIATED WITH         S01117
240400210712     C** NOSTRO BRANCH FOR VALIDATION LATER.                              S01117
240500210712     C                     MOVE A7BRCD    @OBR             ****4          S01117
240600210712     C                     EXSR CHKBR                      ****4          S01117
240700210712     C*                                                                   S01117
240800210712     C                     END                             E***4          S01117
240900210712     C                     END                             E**3
241000210712     C                     END                             E*2
241100210712     C                     END                             E1
241200210712     C*
241300210712     C***IF*SETL*TYPE*IS*03*MUST*BE*CONTAIN*A*SIX*DIGIT*NUMBER*********   E21702
241400210712     C***WHICH*IDENTIFIES*A*LIVE*CUSTOMER*RECORD*ON*FILE*SDCUSTPD******   E21702
241500210712     C** IF SETTLEMENT TYPE IS 03, 'OUR NOSTRO' MUST EITHER BE BLANK OR   E21702
241600210712     C** CONTAIN A SIX DIGIT DEAL NUMBER (TO COMPENSATE AGAINST).         E21702
241700210712     C           PMRSTM    IFEQ 03                         B1
241800210712     C           NOSTRO    ANDNE*BLANK                     B1             E21702
241900210712     C                     TESTN          NOST06     60    *1
242000210712     C           *IN60     IFNE '1'                        B*2
242100210712     C           NOSTYY    ORNE *BLANK                     **2
242200210712     C                     MOVE '909'     ERCD,S           **2
242300210712     C                     ADD  1         S                **2
242400210712     C                     MOVE '1'       *IN30            **2            LN0787
242500210712     C**********           ELSE                            X*2            E21702
242600210712      *
242700210712     C**********           MOVE *BLANKS   CHKFLD           **2            E21702
242800210712     C**********           MOVELNOST06    CHKFLD           **2            E21702
242900210712      *
243000210712     C**********           MOVE 'N'       @CPNA   1        **2      S01117E21702
243100210712     C**********           EXSR CHKFL                      **2            E21702
243200210712      *
243300210712     C********** RESULT    IFNE 'A'                        B**3           E21702
243400210712     C**********           MOVE '909'     ERCD,S           ***3           E21702
243500210712     C**********           ADD  1         S                ***3           E21702
243600210712     C**********           ELSE                            X**3           E21702
243700210712     C**********           MOVE BBCUST    RNOST            ***3           E21702
243800210712     C**********           END                             E**3           E21702
243900210712     C                     END                             E*2
244000210712     C                     END                             E1
244100210712     C*
244200210712     C** IF SETLEMENT TYPE IS 05 MUST IDENTIFY A LIVE RECORD ON ACCNTAB
244300210712     C** (IN COMBINATION WITH RECEIPT CURRENCY)
244400210712     C           PMRSTM    IFEQ 05                         B1
244500210712     C           NOSTSQ    IFEQ *BLANK                     B*2
244600210712     C           NOSTSQ    OREQ '00'                       **2
244700210712     C                     MOVE '01'      NOSTSQ           **2
244800210712     C                     END                             E*2
244900210712     C**********           TESTN          NOST06     60    *1                                 CSD027
245000210712     C***60*****           TESTN          NOSTAC     60    *1                                 CSD027
245100210712     C                     TESTN          NOSTAC     60    *1                                 CSD027
245200210712     C   60                TESTN          NOSTSQ     60    *1
245300210712     C           *IN60     IFNE '1'                        B*2
245400210712     C                     MOVE '910'     ERCD,S           **2
245500210712     C                     ADD  1         S                **2
245600210712     C                     MOVE '1'       *IN30            **2            LN0787
245700210712     C                     MOVE '1'       *IN69            **2            108752
245800210712     C                     ELSE                            X*2
245900210712      *
246000210712     C                     MOVEL*BLANK    ACID             **2            LN0830
246100210712     C                     MOVELNOST06    ACID             **2
246200210712     C***********          MOVE PMRCCY    CUCD             **2
246300210712     C                     MOVE WRECY     CUCD                            CEU003
246400210712     C                     MOVE NOSTSQ    ACSQA            **2
246500210712     C                     MOVE NOSTAC    ACCD             **2
246600210712      * Setup default branch for Receive Branches if MBIN=N               E83
246700210712     C           @MBIN     IFEQ 'N'                        B**3           E83
246800210712     C                     EXSR CHKBK                      ***3           E83
246900210712      *
247000210712     C                     MOVE BJSBRC    PMROBR           ***3           E83
247100210712     C                     END                             E**3           E83
247200210712      *
247300210712     C                     MOVE PMROBR    BRCD             **2            S01117
247400210712      *                                                                   S01117
247500210712      ***SET*OFF*RECEIVE*BRANCH*FLAG*TO*SIGNIFY*USER*HAS*SET        S01117139921
247600210712      ***THIS*FIELD*UP                                              S01117139921
247700210712     C**********           MOVE *BLANKS   RBRF             **2      S01117139921
247800210712     C/COPY WNCPYSRC,SD2410C084
247900210712      *
248000210712     C                     EXSR CHKAC                      **2
248100210712      *
248200210712     C           RTCD      IFNE *BLANKS                    B*3
248300210712     C           TYPE      OREQ '*SHNAME'                  **3                                CSD027
248400210712     C           RECI      ORNE 'D'                        B*3            E24104
248500210712     C           ACST      OREQ 'C'                        B*3            056626
248600210712     C                     MOVE '910'     ERCD,S           **3
248700210712     C                     ADD  1         S                **3
248800210712     C                     MOVE '1'       *IN30            **2            LN0787
248900210712     C                     MOVE '1'       *IN69            **2            108752
249000210712     C                     ELSE                            X*3
249100210712      *                                                                   S01408
249200210712      /COPY WNCPYSRC,SD2410CCP5                                           S01408
249300210712      *                                                                   S01408
249400210712     C                     MOVE CNUM      RNOST            **3
249500210712     C                     MOVE NOSTRO    PMRONS           **3            066875
249600210712     C                     END                             E*3
249700210712     C/COPY WNCPYSRC,SD2410C085
249800210712     C                     END                             E*2
249900210712     C                     END                             E1
250000210712     C*
250100210712     C** IF SETL TYPE IS 14 NOSTRO  MUST CONTAIN A 10 DIGIT NUMBER
250200210712     C** WHICH IDENTIFIES A LIVE RECORD ON FILE ACCNTAB
250300210712     C           PMRSTM    IFEQ 14                         B1
250400210712     C                     TESTN          NOST10     60    *1
250500210712     C           *IN60     IFNE '1'                        B*2
250600210712     C           NOSTSQ    ORNE *BLANK                     **2
250700210712     C           WNOST1    ORNE *BLANKS                                                     AR853732
250800210712     C                     MOVE '911'     ERCD,S           **2
250900210712     C                     ADD  1         S                **2
251000210712     C                     MOVE '1'       *IN30            **2            LN0787
251100210712     C                     MOVE '1'       *IN69            **2            108752
251200210712     C                     ELSE                            X*2
251300210712      *
251400210712     C                     MOVELNOST10    ACID             **2
251500210712     C                     MOVE *BLANKS   CUCD             **2
251600210712     C                     MOVE *BLANKS   ACSQA            **2
251700210712     C                     MOVE *BLANKS   ACCD             **2
251800210712     C                     MOVE *BLANKS   BRCD             **2            S01117
251900210712      *
252000210712     C                     EXSR CHKAC                      **2
252100210712      *
252200210712     C           RTCD      IFNE *BLANKS                    B*3
252300210712     C           RECI      ORNE 'D'                        B*3            E24104
252400210712     C           ACST      OREQ 'C'                                       060470
252500210712     C                     MOVE '911'     ERCD,S           **3
252600210712     C                     ADD  1         S                **3
252700210712     C                     MOVE '1'       *IN30            **2            LN0787
252800210712     C                     MOVE '1'       *IN69            **2            108752
252900210712     C                     ELSE                            X*3
253000210712      *                                                                   S01408
253100210712      /COPY WNCPYSRC,SD2410CCP6                                           S01408
253200210712      *                                                                   S01408
253300210712     C*                                                                   E45796
253400210712     C** Ensure account is not blocked for Debit/Credit                   E45796
253500210712     C*                                                                   E45796
253600210712     C                     TESTB'2'       RETB           34DEBIT          E45796
253700210712     C                     TESTB'3'       RETB           35CREDIT         E45796
253800210712     C*                                                                   E45796
253900210712     C           *IN34     IFEQ '1'                                       E45796
254000210712     C           *IN35     OREQ '1'                                       E45796
254100210712     C                     MOVE '991'     ERCD,S                          E45796
254200210712     C                     ADD  1         S                               E45796
254300210712     C                     MOVE '1'       *IN30                           E45796
254400210712     C                     MOVE '1'       *IN69            **2            108752
254500210712     C                     END                                            E45796
254600210712     C*                                                                   S01408
254700210712     C/COPY WNCPYSRC,SD2410CP16                                           S01408
254800210712     C*                                                                   S01408
254900210712     C*                                                                   E45796
255000210712     C                     MOVE CNUM      RNOST            **3
255100210712      *                                                                   S01117
255200210712      ** SET UP SETTLEMENT BRANCH FOR FILE UPDATES BY OTHER PGMS          S01117
255300210712      ***SET*ON*RECEIVE*BRANCH*FLAG*TO*SIGNIFY*PROGRAM*HAS*SET      S01117139921
255400210712      ***THIS*FIELD*UP                                              S01117139921
255500210712     C           PMROBR    IFEQ *BLANKS                    B***4          S01117
255600210712     C                     MOVE BRCA      PMROBR           ****4          S01117
255700210712     C**********           MOVE 'Y'       RBRF    1        ****4    S01117139921
255800210712     C                     END                             E***4          S01117
255900210712     C*
256000210712     C** IF SETL IS 14 AND NOSTRO IDENTIFIES A LIVE RECORD ON ACCNTAB
256100210712     C** RECEIPT CURRENCY MUST BE SAME AS CURRENCY OF ACCOUNT
256200210712     C***********PMRCCY    IFNE CCY                        B***4          CEU003
256300210712     C           WRECY     IFNE CCY                                       CEU003
256400210712     C           PMCPGM    ANDNE'SSI'                                     137488
256500210712     C           PMRCCY    ORNE CCY                                       137488
256600210712     C           PMCPGM    ANDEQ'SSI'                                     137488
256700210712     C                     MOVE '914'     ERCD,S           ****4
256800210712     C                     ADD  1         S                ****4
256900210712     C                     MOVE '1'       *IN30            **2            LN0787
257000210712     C                     MOVE '1'       *IN69            **2            108752
257100210712     C*                                                                   S01117
257200210712     C                     ELSE                            X***4          S01117
257300210712     C*                                                                   S01117
257400210712     C**   IF MULTIBRANCH FLAG OFF NOSTRO MUST EQUAL SINGLE BRANCH        S01117
257500210712     C           @MBIN     IFEQ 'N'                        B****5         S01117
257600210712     C                     EXSR CHKBK                      *****5         S01117
257700210712     C*                                                                   S01117
257800210712     C***********BRCA      IFNE A7BRCD                     B*****6 S01117 058132
257900210712     C           BRCA      IFNE BJSBRC                     B*****6        058132
258000210712     C                     MOVE '888'     ERCD,S           ******6        S01117
258100210712     C                     ADD  1         S                ******6        S01117
258200210712     C                     MOVE '1'       *IN30            **2            LN0787
258300210712     C                     MOVE '1'       *IN69            **2            108752
258400210712     C/COPY WNCPYSRC,SD2410C048
258500210712     C                     END                             E*****6        S01117
258600210712     C                     END                             E****5         S01117
258700210712     C*                                                                   S01117
258800210712     C                     END                             E***4
258900210712     C                     END                             E**3
259000210712     C                     END                             E*2
259100210712     C                     END                             E1
259200210712      *                                                                   191152
259300210712      ** If Settlement Currency is EURO (created for a sweep of the       191152
259400210712      ** 'In' Currency loan), check if receipt sett. account is           191152
259500210712      ** also sweep into EURO, otherwise EURO is an invalid settlement    191152
259600210712      ** currency.                                                        191152
259700210712      *                                                                   191152
259800210712     C           CEU004    IFEQ 'Y'                                       191152
259900210712     C           PMPSCY    ANDEQBKEURO                                    191152
260000210712     C           PMPRCV    ANDEQ'Y'                                       191152
260100210712      *                                                                   191152
260200210712     C           S         IFGT 1                                         191152
260300210712     C           S         SUB  1         Y       30                      191152
260400210712     C                     ELSE                                           191152
260500210712     C                     Z-ADD1         Y                               191152
260600210712     C                     ENDIF                                          191152
260700210712     C           ERCD,Y    IFEQ '914'                                     191152
260800210712     C           ERCD,Y    OREQ '910'                                     191152
260900210712     C                     MOVE *BLANK    ERCD,Y                          191152
261000210712     C                     SUB  1         S                               191152
261100210712     C                     MOVE '0'       *IN30                           191152
261200210712     C                     MOVE '0'       *IN69                           191152
261300210712     C                     END                                            191152
261400210712      *                                                                   191152
261500210712     C                     MOVE PMRONS    NOSTRO                          191152
261600210712     C           PMRSTM    IFEQ 05                                        191152
261700210712     C                     MOVEL*BLANK    ACID                            191152
261800210712     C                     MOVELNOST06    ACID                            191152
261900210712     C                     MOVE WPECY     CUCD                            191152
262000210712     C                     MOVE NOSTSQ    ACSQA                           191152
262100210712     C                     MOVE NOSTAC    ACCD                            191152
262200210712     C                     MOVE PMPOBR    BRCD                            191152
262300210712     C                     EXSR CHKAC                                     191152
262400210712     C                     ENDIF                                          191152
262500210712      *                                                                   191152
262600210712     C           RTCD      IFNE *BLANKS                                   191152
262700210712     C                     MOVE *BLANKS   RTCD                            191152
262800210712     C                     MOVE '910'     ERCD,S                          191152
262900210712     C                     ADD  1         S                               191152
263000210712     C                     MOVE '1'       *IN30                           191152
263100210712     C                     ENDIF                                          191152
263200210712      *                                                                   191152
263300210712     C           PMRSTM    IFEQ 14                                        191152
263400210712     C                     MOVEL*BLANK    ACID                            191152
263500210712     C                     MOVELNOST10    ACID                            191152
263600210712     C                     MOVE WPECY     CUCD                            191152
263700210712     C                     MOVE *BLANKS   ACSQA                           191152
263800210712     C                     MOVE *BLANKS   ACCD                            191152
263900210712     C                     MOVE *BLANKS   BRCD                            191152
264000210712     C                     EXSR CHKAC                                     191152
264100210712     C                     ENDIF                                          191152
264200210712      *                                                                   191152
264300210712     C           RTCD      IFNE *BLANKS                                   191152
264400210712     C                     MOVE *BLANKS   RTCD                            191152
264500210712     C                     MOVE '914'     ERCD,S                          191152
264600210712     C                     ADD  1         S                               191152
264700210712     C                     MOVE '1'       *IN30                           191152
264800210712     C                     ENDIF                                          191152
264900210712      *                                                                   191152
265000210712     C                     ENDIF                                          191152
265100210712     C/COPY WNCPYSRC,SD2410C098
265200210712     C*
265300210712     C** IF SETL TYPE IS 01,02,05,07,08,12 OR 14 AND FIELD REFERS TO A
265400210712     C** RETAIL ACCOUNT THE DATE OF RECEIPT MUST NOT BE BEFORE THE DATE
265500210712     C** ACCOUNT OPENED(912)
265600210712     C           *IN69     IFEQ '0'                        B1
265700210712     C*********  ATYP      ANDEQ'R'                        *1             BHF908
265800210712     C           PMRSTM    IFEQ 01                         B*2
265900210712     C           PMRSTM    OREQ 02                         **2
266000210712     C           PMRSTM    OREQ 04                         **2            100757
266100210712     C           PMRSTM    OREQ 05                         **2
266200210712     C           PMRSTM    OREQ 07                         **2
266300210712     C           PMRSTM    OREQ 08                         **2
266400210712     C           PMRSTM    OREQ 12                         **2
266500210712     C           PMRSTM    OREQ 14                         **2
266600210712     C           PMDTRC    IFLT DACO                       B**3
266700210712     C           PMACTC    ANDEQ'I'                                       149200
266800210712     C           CEU003    IFNE 'Y'                                       135303
266900210712     C           PMACTC    OREQ 'I'                                       135303
267000210712     C           PMACTC    OREQ 'A'                                                           178889
267100210712     C                     MOVE '912'     ERCD,S           ***3
267200210712     C                     ADD  1         S                ***3
267300210712     C                     MOVE '1'       *IN30            **2            LN0787
267400210712     C/COPY WNCPYSRC,SD2410C064
267500210712     C                     ENDIF                                          135303
267600210712     C                     END                             E**3
267700210712     C                     END                             E*2
267800210712     C                     END                             E1
267900210712     C*                                                                   E24039
268000210712     C** If LHS on settlement has been changed and deal is a deposit      E24039
268100210712     C** (receipts side is start side) then do the following back value   E24039
268200210712     C** period validation.                                               E24039
268300210712     C*                                                                   E24039
268400210712     C           *LOCK     IN   LDA                                       E24039
268500210712     C           NOCHG1    IFEQ '0'                                       E24039
268600210712     C           RCVSTR    ANDEQ'1'                                       E24039
268700210712     C           RCVSTR    OREQ *BLANKS                                   E24039
268800210712     C           PMACTC    OREQ 'I'                                       110122
268900210712     C*
269000210712     C** IF SETL TYPE IS 01,02,05,07,08,12 OR 14
269100210712     C** THE DATE OF RECEIPT MUST NOT BE
269200210712     C** EARLIER THAN BACK-VALUE PERIOD(913)
269300210712     C*                                                                   CLE003
269400210712     C*  IF DATE OF RECEIPT IS EARLIER THAN BACK VALUE PERIOD             CLE003
269500210712     C*  ISSUE A WARNING MESSAGE (805) ONLY WHEN CLE003 IS ON             CLE003
269600210712     C*                                                                   CLE003
269700210712     C           PMPRCV    IFNE 'Y'                                       E31589
269800210712     C*                                                                   E31589
269900210712     C           PMRSTM    IFEQ 01                         B1
270000210712     C           PMRSTM    OREQ 02                         *1
270100210712     C           PMRSTM    OREQ 04                         **2            100757
270200210712     C           PMRSTM    OREQ 05                         *1
270300210712     C           PMRSTM    OREQ 07                         *1
270400210712     C           PMRSTM    OREQ 08                         *1
270500210712     C           PMRSTM    OREQ 12                         *1
270600210712     C           PMRSTM    OREQ 14                         *1
270700210712     C           ATYP      IFEQ 'R'                        *1             BHF908
270800210712     C           PMRUND    SUB  PMBVPD    COMPDT  50       *1
270900210712     C           PMDTRC    IFLT COMPDT                     B*2
271000210712     C           CLE003    IFEQ 'Y'                                       CLE003
271100210712     C           COUNT     IFEQ 1                                         CLE003
271200210712     C                     MOVE '805'     ERCD,S           **2            CLE003
271300210712     C                     ADD  1         S                **2            CLE003
271400210712     C                     ADD  1         COUNT                           CLE003
271500210712     C                     MOVE '1'       *IN30            **2            CLE003
271600210712     C                     MOVELCOUNT     PMCMDP                          113832
271700210712     C                     ENDIF                                          CLE003
271800210712     C                     ELSE                                           CLE003
271900210712     C                     MOVE '913'     ERCD,S           **2
272000210712     C                     ADD  1         S                **2
272100210712     C                     MOVE '1'       *IN30            **2            LN0787
272200210712     C                     ENDIF                                          CLE003
272300210712     C                     END                             E*2
272400210712     C/COPY WNCPYSRC,SD2410C065
272500210712     C                     END                             E*2            BHF908
272600210712     C                     END                             E1
272700210712     C                     END                                            E31589
272800210712     C*                                                                   E24039
272900210712     C                     END                                            E24039
273000210712     C                     OUT  LDA                                       E24039
273100210712     C***********          MOVE COUNT     CNT                       CLE003113832
273200210712     C*
273300210712     C** Defaulting for ordering cust/bank if receive ordering cust.      E26903
273400210712     C** and bank are both blank. Move in as appropriate, thence to       E26903
273500210712     C** DEALS file and so to SWIFT message.                              E26903
273600210712     C*                                                                   E26903
273700210712     C           PMRSTM    IFEQ 01                                        E26903
273800210712     C           PMRSTM    OREQ 07                                        E26903
273900210712     C           PMRSTM    OREQ 08                                        E26903
274000210712     C*                                                                   E26903
274100210712     C           PMROBN    IFEQ *BLANKS                                   E26903
274200210712     C           PMROCN    ANDEQ*BLANKS                                   E26903
274300210712     C*                                                                   E26903
274400210712     C** Find out what the counterparty is  bank/nonbank                  E26903
274500210712     C*                                                                   E26903
274600210712     C                     MOVE PMCSNM    CHKFLD                          E26903
274700210712     C                     EXSR CHKFL                                     E26903
274800210712     C           RESULT    IFNE 'A'                                       E26903
274900210712     C           RESULT    ANDNE'B'                                       E26903
275000210712     C                     MOVE '872'     ERCD,S                          E26903
275100210712     C                     ADD  1         S                               E26903
275200210712     C                     ELSE                                           E26903
275300210712     C           BANKNB    IFEQ 'B'                                       E26903
275400210712     C                     MOVELPMCSNM    PMROBN                          E26903
275500210712     C                     ELSE                                           E26903
275600210712     C                     MOVELPMCSNM    PMROCN                          E26903
275700210712     C                     END                                            E26903
275800210712     C                     END                                            E26903
275900210712     C*                                                                   E26903
276000210712     C                     END                                            E26903
276100210712     C*                                                                   E26903
276200210712     C                     END                                            E26903
276300210712     C*                                                                   221452
276400210712     C** No need to validate swift fields if Swift for Lending is not     221452
276500210712     C** on and settlement method is 09                                   221452
276600210712     C*                                                                   221452
276700210712     C           CLE033    IFEQ 'Y'                                       221452
276800210712     C           PMRSTM    ANDEQ09                                        221452
276900210712     C           BGSWCL    ANDNE'Y'                                       221452
277000210712     C                     GOTO PAYMNT                                    221452
277100210712     C                     ENDIF                                          221452
277200210712     C*
277300210712     C** ORDERING CUSTOMER
277400210712     C** -----------------
277500210712     C                     MOVE *BLANKS   PAROCN
277600210712     C           *IN37     CABEQ'1'       EVAL1            ERROR ON FIELD
277700210712     C*
277800210712     C** MUST BE A 6 DIGIT NUMBER
277900210712     C** OR A CUSTOMER SHORTNAME THAT IDENTIFIES A LIVE
278000210712     C** RECORD ON FILE SDCUSTPD
278100210712     C           PMROCN    IFNE *BLANKS                    B1
278200210712     C                     MOVE *BLANKS   PAROCN           *1
278300210712     C                     MOVE *BLANKS   CHKFLD           *1             S01117
278400210712     C                     MOVE PMROCN    CHKFLD           *1
278500210712     C**********           MOVE 'N'       @CPNA            *1       S01117E21702
278600210712     C                     MOVE 'N'       @CPNA   1        *1             E21702
278700210712     C                     EXSR CHKFL                      *1
278800210712     C*                                                                   S01117
278900210712     C           RTCD      IFEQ '*NOSEL '                  B*2            S01117
279000210712     C                     MOVE '868'     ERCD,S           **2            S01117
279100210712     C                     ADD  1         S                **2            S01117
279200210712     C                     MOVE '1'       *IN30            **2            LN0787
279300210712     C                     END                             E*2            S01117
279400210712     C*                                                                   E26903
279500210712     C** Check that ordering customer is not a bank                       E26903
279600210712     C*                                                                   E26903
279700210712     C           BANKNB    IFEQ 'B'                                       E26903
279800210712     C                     MOVE '803'     ERCD,S                          E26903
279900210712     C                     ADD  1         S                               E26903
280000210712     C                     GOTO EVAL1                                     E26903
280100210712     C                     END                                            E26903
280200210712     C**                                                                  E26903
280300210712     C           RESULT    IFNE 'A'                        B*2
280400210712     C           RESULT    ANDNE'B'                        **2
280500210712     C                     MOVE '915'     ERCD,S           **2
280600210712     C                     ADD  1         S                **2
280700210712     C                     MOVE '1'       *IN30            **2            LN0787
280800210712     C                     ELSE                            X*2
280900210712     C           BANKNB    IFEQ 'B'                                       S01117
281000210712     C                     MOVE '879'     ERCD,S           ***3           S01117
281100210712     C                     ADD  1         S                ***3           S01117
281200210712     C                     MOVE '1'       *IN30            **2            LN0787
281300210712     C                     END                             E**3           S01117
281400210712     C                     MOVELBBCUST    PAROCN           **2
281500210712     C*                                                                   S01117
281600210712     C**   CHECK IF '?' ENTERED, IF SO MOVE VALUE RETRIEVED               S01117
281700210712     C**   INTO SCREEN FIELD.                                             S01117
281800210712     C*                                                                   S01117
281900210712     C                     MOVELPMROCN    @TSTQ   1        **2            S01117
282000210712     C           @TSTQ     IFEQ '?'                        B**3           S01117
282100210712     C                     MOVELBBCSSN    PMROCN           ***3           S01117
282200210712     C                     END                             E**3           S01117
282300210712     C                     END                             E*2
282400210712     C                     END                             E1
282500210712     C           EVAL1     TAG
282600210712     C**
282700210712     C** ORDERING BANK
282800210712     C** -------------
282900210712     C                     MOVE *BLANKS   PAROBN
283000210712     C           *IN39     CABEQ'1'       EVAL2            ERROR ON FIELD
283100210712     C*
283200210712     C** MUST BE A 6 DIGIT NUMBER
283300210712     C** OR A CUSTOMER SHORTNAME THAT IDENTIFIES A LIVE
283400210712     C** RECORD ON FILE SDCUSTPD
283500210712     C           PMROBN    IFNE *BLANKS                    B1
283600210712     C                     MOVE *BLANKS   CHKFLD           *1             S01117
283700210712     C                     MOVE PMROBN    CHKFLD           *1
283800210712     C                     MOVE 'N'       @CPNA            *1             S01117
283900210712     C                     EXSR CHKFL                      *1
284000210712     C*                                                                   S01117
284100210712     C           RTCD      IFEQ '*NOSEL '                  B*2            S01117
284200210712     C                     MOVE '869'     ERCD,S           **2            S01117
284300210712     C                     ADD  1         S                **2            S01117
284400210712     C                     MOVE '1'       *IN30            **2            LN0787
284500210712     C                     END                             E*2            S01117
284600210712     C*                                                                   S01117
284700210712     C           RESULT    IFNE 'A'                        B*2
284800210712     C           RESULT    ANDNE'B'                        **2
284900210712     C                     MOVE '917'     ERCD,S           **2
285000210712     C                     ADD  1         S                **2
285100210712     C                     MOVE '1'       *IN30            **2            LN0787
285200210712     C                     ELSE                            X*2
285300210712     C           BANKNB    IFNE 'B'                        B**3
285400210712     C                     MOVE '918'     ERCD,S           ***3
285500210712     C                     ADD  1         S                ***3
285600210712     C                     MOVE '1'       *IN30            **2            LN0787
285700210712     C                     ELSE                            X**3
285800210712     C                     MOVELBBCUST    PAROBN           ***3
285900210712     C                     END                             E**3
286000210712     C*                                                                   S01117
286100210712     C**   CHECK IF '?' ENTERED, IF SO MOVE VALUE RETRIEVED               S01117
286200210712     C**   INTO SCREEN FIELD.                                             S01117
286300210712     C*                                                                   S01117
286400210712     C                     MOVELPMROBN    @TSTQ   1        **2            S01117
286500210712     C           @TSTQ     IFEQ '?'                        B**3           S01117
286600210712     C                     MOVELBBCSSN    PMROBN           ***3           S01117
286700210712     C                     END                             E**3           S01117
286800210712     C                     END                             E*2
286900210712     C                     END                             E1
287000210712     C*                                                                   LN0798
287100210712     C** FOR SETTLEMENT TYPE 01 OR 08 EITHER ORDERING BANK OR ORDERING    LN0798
287200210712     C** CUSTOMER MUST BE ENTERED                                         LN0798
287300210712     C*                                                                   LN0798
287400210712     C           PMRSTM    IFEQ 01                                        LN0798
287500210712     C           PMRSTM    OREQ 08                                        LN0798
287600210712     C           PMROBN    IFEQ *BLANKS                                   LN0798
287700210712     C           PMROCN    ANDEQ*BLANKS                                   LN0798
287800210712     C                     MOVE '699'     ERCD,S                          LN0798
287900210712     C                     ADD  1         S                               LN0798
288000210712     C                     MOVE '1'       *IN30                           LN0798
288100210712     C                     END                                            LN0798
288200210712     C                     END                                            LN0798
288300210712     C*
288400210712     C** ENTRY IN BOTH RECEIPT ORDERING BANK AND ORDERING CUSTOMER NOT
288500210712     C** ALLOWED
288600210712     C           PMROBN    IFNE *BLANKS                    B1
288700210712     C           PMROCN    ANDNE*BLANKS                    *1
288800210712     C                     MOVE '919'     ERCD,S           *1
288900210712     C                     ADD  1         S                *1
289000210712     C                     MOVE '1'       *IN30            **2            LN0787
289100210712     C                     END                             E1
289200210712     C*
289300210712     C***FOR SETTL.*TYPE*01,07*OR*08*ORDERING*BANK*OR*ORDERING*CUSTOMER***E21860
289400210712     C***MUST*BE*ENTERED***                                            ***E21860
289500210712     C***********PMRSTM****IFEQ 01                         B1             E21860
289600210712     C***********PMRSTM****OREQ 07                         *1             E21860
289700210712     C***********PMRSTM****OREQ 08                         *1             E21860
289800210712     C***********PMROBN****IFEQ *BLANKS                    B*2            E21860
289900210712     C***********PMROCN****ANDEQ*BLANKS                    **2            E21860
290000210712     C*********************MOVE '921'     ERCD,S           **2            E21860
290100210712     C*********************ADD  1         S                **2            E21860
290200210712     C*********************END                             E*2            E21860
290300210712     C*********************END                             E1             E21860
290400210712     C           EVAL2     TAG
290500210712     C** INTERMEDIARY BANK
290600210712     C** -----------------
290700210712     C                     MOVE *BLANKS   PARIBN
290800210712     C           *IN43     CABEQ'1'       EVAL3            ERROR ON FIELD
290900210712     C*
291000210712     C** MUST BE A 6 DIGIT NUMBER
291100210712     C** OR A CUSTOMER SHORTNAME THAT IDENTIFIES A LIVE
291200210712     C** RECORD ON FILE SDCUSTPD OR A COUNTERPARTY NOSTRO CODE THAT
291300210712     C** IDENTIFIES A LIVE RECORD ON SDCNSTPD
291400210712     C           PMRSTM    IFEQ 01                         B1
291500210712     C           PMRSTM    OREQ 07                         *1
291600210712     C           PMRSTM    OREQ 08                         *1
291700210712     C           CLE033    OREQ 'Y'                        *1             CLE033
291800210712     C           PMRSTM    ANDEQ09                         *1             CLE033
291900210712     C/COPY WNCPYSRC,SD2410C066
292000210712     C                     MOVE 'Y'       CPRIBN  1        *1
292100210712     C           PMRIBN    IFNE *BLANK                     B*2
292200210712     C                     MOVE *BLANKS   CHKFLD           **2            S01117
292300210712     C                     MOVE PMRIBN    CHKFLD           **2
292400210712     C                     MOVE 'Y'       @CPNA            **2            S01117
292500210712     C/COPY WNCPYSRC,SD2410C067
292600210712     C                     EXSR CHKFL                      **2
292700210712     C*                                                                   S01117
292800210712     C           RTCD      IFEQ '*NOSEL '                  B*2            S01117
292900210712     C                     MOVE '870'     ERCD,S           **2            S01117
293000210712     C                     ADD  1         S                **2            S01117
293100210712     C                     MOVE '1'       *IN30            **2            LN0787
293200210712     C                     END                             E*2            S01117
293300210712     C*                                                                   S01117
293400210712     C           RESULT    IFEQ 'E'                        B**3
293500210712     C                     MOVE '922'     ERCD,S           ***3
293600210712     C                     ADD  1         S                ***3
293700210712     C                     MOVE '1'       *IN30            **2            LN0787
293800210712     C                     ELSE                            X**3
293900210712     C                     MOVELPMRIBN    @TSTQ            ***3           S01117
294000210712     C           RESULT    IFEQ 'A'                        B***4
294100210712     C           RESULT    OREQ 'B'                        ****4
294200210712     C           BANKNB    IFEQ 'B'                        B****5
294300210712      *                                                                   S01408
294400210712     C/COPY WNCPYSRC,SD2410CP13                                           S01408
294500210712      *                                                                   S01408
294600210712     C                     MOVE 'N'       CPRIBN           *****5
294700210712     C                     MOVELBBCUST    PARIBN           *****5
294800210712     C*                                                                   S01117
294900210712     C**   CHECK IF '?' ENTERED, IF SO MOVE VALUE RETRIEVED               S01117
295000210712     C**   INTO SCREEN FIELD.                                             S01117
295100210712     C*                                                                   S01117
295200210712     C                     ELSE                            X****5
295300210712     C                     MOVE '923'     ERCD,S           *****5
295400210712     C                     ADD  1         S                *****5
295500210712     C                     MOVE '1'       *IN30            **2            LN0787
295600210712     C                     END                             E****5
295700210712     C           @TSTQ     IFEQ '?'                        B****5         S01117
295800210712     C                     MOVELBBCSSN    PMRIBN           *****5         S01117
295900210712     C                     END                             E****5         S01117
296000210712     C                     ELSE                            X***4
296100210712     C                     MOVE *BLANKS   PARIBN           ****4          S01117
296200210712     C                     MOVELAWCPNC    PARIBN           ****4
296300210712     C**   CHECK IF '?' ENTERED, IF SO MOVE VALUE RETRIEVED               S01117
296400210712     C**   INTO SCREEN FIELD.                                             S01117
296500210712     C*                                                                   S01117
296600210712     C           @TSTQ     IFEQ '?'                        B****5         S01117
296700210712     C                     MOVE *BLANKS   PMRIBN           *****5         S01117
296800210712     C                     MOVELAWCPNC    PMRIBN           *****5
296900210712     C                     END                             E****5         S01117
297000210712     C                     END                             E***4
297100210712     C                     END                             E**3
297200210712     C                     END                             E*2
297300210712     C                     END                             E1
297400210712     C           EVAL3     TAG
297500210712     C*
297600210712     C** ENTRY MUST NOT BE THE SAME AS OUR NOSTRO OR BRANCH INTERNAL
297700210712     C** CUSTOMER NUMBER
297800210712     C*****      PMRIBN    IFNE *BLANKS                    B1             LN0455
297900210712     C           PARIBN    IFNE *BLANKS                    B1             LN0455
298000210712     C/COPY WNCPYSRC,SD2410C068
298100210712     C*****      PMRIBN    IFEQ RNOST                      B*2            S01227
298200210712     C*****      PMRIBN    OREQ A8BICN                     B*2            S01227
298300210712     C***********PARIBN    IFEQ RNOST                      B*2      S01227056873
298400210712     C***********PARIBN    OREQ A8BICN                     B*2      S01227056873
298500210712     C           PARIBN    IFEQ A8BICN                     B*2            056873
298600210712     C                     MOVE '926'     ERCD,S           **2
298700210712     C                     ADD  1         S                **2
298800210712     C                     MOVE '1'       *IN30            **2            LN0787
298900210712     C                     END                             E*2
299000210712     C                     END                             E1
299100210712     C*
299200210712     C** INTERMEDIARY BANK A/C LINE
299300210712     C** --------------------------
299400210712     C           *IN45     CABEQ'1'       EVAL4            ERROR ON FIELD
299500210712     C*                                                                                       193584
299600210712     C           PMRIBA    IFNE *BLANK                                                        193584
299700210712     C** Entry is not allowed if the Nostro is a CLS Dummy Nostro.                            193584
299800210712     C                     MOVE PMRONS    NOSTRO                                              193584
299900210712     C                     MOVE WRECY     @CYCD                                               193584
300000210712     C                     MOVE NOST02    @NONB                                               193584
300100210712     C*                                                                                       193584
300200210712     C** Check the Nostro.                                                                    193584
300300210712     C                     EXSR CHKNO                                                         193584
300400210712      *                                                                                       193584
300500210712     C           A7CLSD    IFEQ 'Y'                                                           193584
300600210712     C                     MOVE '711'     ERCD,S                                              193584
300700210712     C                     ADD  1         S                                                   193584
300800210712     C                     MOVE '1'       *IN30                                               193584
300900210712     C                     GOTO EVAL4                                                         193584
301000210712     C                     END                                                                193584
301100210712     C                     END                                                                193584
301200210712     C*
301300210712     C           PMRIBA    IFNE *BLANK                     B1
301400210712     C                     MOVE PMRIBA    PMXIBA           *1
301500210712     C*
301600210712     C** ENTRY IS ONLY ALLOWED IF ENTRY HAS BEEN MADE IN INTER. BANK
301700210712     C           PMRIBN    IFEQ *BLANK                     B*2
301800210712     C                     MOVE '924'     ERCD,S           **2
301900210712     C                     ADD  1         S                **2
302000210712     C                     MOVE '1'       *IN30            **2            LN0787
302100210712     C                     GOTO EVAL4                      SKIP VALIDATION
302200210712     C                     END                             E*2
302300210712      *****************************************************************   CSW096
302400210712      *                                                                   CSW096
302500210712      * Call Account Line Validation object                               CSW096
302600210712      *                                                                   CSW096
302700210712      * Set up parameters                                                 CSW096
302800210712      *                                                                   CSW096
302900210712     C                     MOVEL*BLANKS   W0RTN                           CSW096
303000210712     C                     CLEARI#PARM                                    CSW096
303100210712     C                     MOVEL'INBK '   I#VFLD                          CSW096
303200210712     C                     MOVEL'REC'     I#PR                            CSW096
303300210712     C                     MOVEL'X'       I#PRTT                          CSW096
303400210712     C                     MOVELPMRIBN    I#PRTY                          CSW096
303500210712     C***********          MOVELPMPCCY    I#PCCY                   CSW096 CEU003
303600210712     C***********          MOVELPMRCCY    I#RCCY                   CSW096 CEU003
303700210712     C                     MOVELWPECY     I#PCCY                          CEU003
303800210712     C                     MOVELWRECY     I#RCCY                          CEU003
303900210712     C                     MOVELPMRIBA    I#ACLN                          CSW096
304000210712     C                     MOVELPMPSTM    I#PSTM                          CSW096
304100210712     C                     MOVELPMRSTM    I#RSTM                          CSW096
304200210712     C                     MOVEL'210'     I#MTYP                          CSW096
304300210712      * Set up receive account information                                CSW096
304400210712     C           PMRONS    IFNE *BLANKS                                   CSW096
304500210712     C                     SELEC                                          CSW096
304600210712     C           PMROBR    WHNE *BLANKS                                   CSW096
304700210712     C           PMRONS    CAT  PMROBR    I#RCAC                          CSW096
304800210712     C           PMRONS    WHNE *BLANKS                                   CSW096
304900210712     C                     MOVELPMRONS    I#RCAC                          CSW096
305000210712     C                     ENDSL                                          CSW096
305100210712     C                     ENDIF                                          CSW096
305200210712      * Set up Pay account information                                    CSW096
305300210712     C           PMPONS    IFNE *BLANKS                                   CSW096
305400210712     C                     SELEC                                          CSW096
305500210712     C           PMPOBR    WHNE *BLANKS                                   CSW096
305600210712     C           PMPONS    CAT  PMPOBR    I#PYAC                          CSW096
305700210712     C           PMPONS    WHNE *BLANKS                                   CSW096
305800210712     C                     MOVELPMPONS    I#PYAC                          CSW096
305900210712     C                     ENDSL                                          CSW096
306000210712     C                     ENDIF                                          CSW096
306100210712      * If extra message and Rec Corr. then set 5354 field                CSW096
306200210712     C           PMRVNO    IFNE *BLANKS                                   CSW096
306300210712     C           PMRCRN    ANDNE*BLANKS                                   CSW096
306400210712     C                     MOVEL'Y'       I#5354                          CSW096
306500210712     C                     ENDIF                                          CSW096
306600210712      * Transaction Type                                                  CSW096
306700210712     C                     MOVELPMTTYP    I#TTYP                          CSW096
306800210712      * Set up Cover field                                                CSW096
306900210712     C                     MOVELPMCVMR    I#COVR                          CSW096
307000210712      *                                                                   CSW096
307100210712     C                     CLEARO#PARM                                    CSW096
307200210712     C                     CLEARE#PARM                                    CSW096
307300210712      *                                                                   CSW096
307400210712      * Send messages to correct calling process                          CSW096
307500210712      *                                                                   CSW096
307600210712     C                     SELEC                                          CSW096
307700210712     C           PMCPGM    WHEQ 'FXFX'                                    CSW096
307800210712     C                     MOVEL'ME9940'  E#CPGM                          CSW096
307900210712     C                     MOVEL'DL'      I#MMOD                          CSW096
308000210712     C           PMCPGM    WHEQ 'MMLD'                                    CSW096
308100210712     C                     MOVEL'ME9940'  E#CPGM                          CSW096
308200210712     C                     MOVEL'LE'      I#MMOD                          CSW096
308300210712     C           PMCPGM    WHEQ 'SSI '                                    CSW096
308400210712     C                     MOVEL'SD0401R' E#CPGM                          CSW096
308500210712     C                     MOVEL'AT'      I#MMOD                          CSW096
308600210712     C                     OTHER                                          CSW096
308700210712     C                     MOVEL'ME9940'  E#CPGM                          CSW096
308800210712     C                     ENDSL                                          CSW096
308900210712     C                     MOVEL'MEC0019' E#MSGD                          CSW096
309000210712     C                     MOVEL'MEMSG'   E#MSGF                          CSW096
309100210712      *                                                                   CSW096
309200210712     C                     CALL 'ME9940'                                  CSW096
309300210712     C                     PARM           W0RTN   7                       CSW096
309400210712     C                     PARM           I#PARM           I Input Parms  CSW096
309500210712     C                     PARM           O#PARM           O Output Parms CSW096
309600210712     C                     PARM           E#PARM           E Error Inform CSW096
309700210712     C                     PARM           Z#PARM256        B User Defined CSW096
309800210712      *                                                                   CSW096
309900210712      * On return if errors copy into error array                         CSW096
310000210712      *                                                                   CSW096
310100210712     C                     MOVELO#ACLN    PMRIBA                          CSW096
310200210712      *                                                                   CSW096
310300210712     C           E#ERRM    IFNE *BLANKS                                   CSW096
310400210712      *                                                                   CSW096
310500210712     C           1         DO   E#INDX    Q#      50                      CSW096
310600210712     C                     MOVEAO#E,Q#    ERCD,S                          CSW096
310700210712     C                     ADD  1         S                               CSW096
310800210712     C                     ENDDO                                          CSW096
310900210712      *                                                                   CSW096
311000210712      * Mark receive side as in error                                     CSW096
311100210712     C                     MOVEL*ON       *IN30                           CSW096
311200210712      *                                                                   CSW096
311300210712     C                     ENDIF                                          CSW096
311400210712      *                                                                   CSW096
311500210712     C                     ENDIF                                          CSW096
311600210712      *                                                                   CSW096
311700210712      * Validate Bank to Bank Information (Receive Instructions)                              CDL094
311800210712     C           CDL094    IFEQ 'Y'                                                           CDL094
311900210712     C                     EXSR CHRBTB                                                        CDL094
312000210712     C                     ENDIF                                                              CDL094
312100210712      *****************************************************************   CSW096
312200210712      ***********                                                         CSW096
312300210712     C***********                                                         CSW096
312400210712     C***FIRST*CHARACTER MUST BE '/'                                      CSW096
312500210712     C***********PMXIB1    IFNE '/'                        B*2            CSW096
312600210712     C***********          MOVE '925'     ERCD,S           **2            CSW096
312700210712     C***********          ADD  1         S                **2            CSW096
312800210712     C***********          MOVE '1'       *IN30            **2      LN0787CSW096
312900210712     C***********          END                             E*2            CSW096
313000210712     C***********                                                   060036CSW096
313100210712     C***If*1st*& 3rd character are '/',                            060036CSW096
313200210712     C***then*2nd character must be 'C' or 'D'.                     060036CSW096
313300210712     C***********                                                   060036CSW096
313400210712     C***********PMXIB1    IFEQ '/'                        B*2      060036CSW096
313500210712     C***********PMXIBE    ANDEQ'/'                        **2      060036CSW096
313600210712     C***********PMXIB2    IFNE 'C'                        B**3     060036CSW096
313700210712     C***********PMXIB2    ANDNE'D'                        ***3     060036CSW096
313800210712     C***********          MOVE '200'     ERCD,S           ***3     060036CSW096
313900210712     C***********          ADD  1         S                ***3     060036CSW096
314000210712     C***********          MOVE '1'       *IN30            ***3     060036CSW096
314100210712     C***********          END                             E**3     060036CSW096
314200210712     C***********          END                             E*2      060036CSW096
314300210712     C***********                                                         CSW096
314400210712     C***IF*SECOND CHARACTER IS ALSO '/'                                  CSW096
314500210712     C***MUST*BE*FOLLOWED BY CP, FW, BL OR SW.                      CSW095CSW096
314600210712     C***MUST*BE*FOLLOWED*BY*CP,FW*OR*BL****************************CSW095CSW096
314700210712     C***********PMXIB2    IFEQ '/'                        B*2            CSW096
314800210712     C***********PMXIB4    IFNE '//CP'                     B**3           CSW096
314900210712     C***********PMXIB4    ANDNE'//FW'                     ***3           CSW096
315000210712     C***********PMXIB4    ANDNE'//BL'                     ***3           CSW096
315100210712     C***********PMXIB4    ANDNE'//SW'                     ***3     CSW095CSW096
315200210712     C***********          MOVE '896'     ERCD,S           ***3           CSW096
315300210712     C***********          ADD  1         S                ***3           CSW096
315400210712     C***********          MOVE '1'       *IN30            **2      LN0787CSW096
315500210712     C***********          END                             E**3           CSW096
315600210712     C***********          END                             E*2            CSW096
315700210712     C***********                                                         CSW096
315800210712     C***IF*FOLLOWED BY CP OR FW CURRENCY MUST BE USD                     CSW096
315900210712     C***IF*FOLLOWED BY BL CURRENCY MUST BE DEM                           CSW096
316000210712     C***If*followed by SW currency must be CHF.                    CSW095CSW096
316100210712     C***********PMXIB4    IFEQ '//CP'                     B*2            CSW096
316200210712     C***********PMXIB4    OREQ '//FW'                     **2            CSW096
316300210712     C***********PMXIB4    OREQ '//BL'                     **2            CSW096
316400210712     C***********PMXIB4    OREQ '//SW'                              CSW095CSW096
316500210712     C***********          MOVE PMRCCY    KEYY    3        **2            CSW096
316600210712     C***********          MOVE PMXIB4    KEYZ    2        **2            CSW096
316700210712     C***********          EXSR CHKCY                      **2            CSW096
316800210712     C***********RTCD      IFNE *BLANKS                    B*2            CSW096
316900210712     C***********          MOVE '927'     ERCD,S           ***3           CSW096
317000210712     C***********          ADD  1         S                ***3           CSW096
317100210712     C***********          MOVE '1'       *IN30            **2      LN0787CSW096
317200210712     C***********          GOTO EVAL4                      ***3           CSW096
317300210712     C***********          END                             E**3           CSW096
317400210712     C***********          END                             E*2            CSW096
317500210712     C***********                                                         CSW096
317600210712     C***IF*//CP*AND FOLLOWED BY BLANKS THEN DEFAULT THIS TO THE          CSW096
317700210712     C***CUSTOMERS CHIPS PARTICIPANT ONLY IF PMRIBN IS A CUSTOMER         CSW096
317800210712     C***********CPRIBN    IFEQ 'N'                        B*2            CSW096
317900210712     C***********PMXIB4    IFEQ '//CP'                     B**3           CSW096
318000210712     C***********PMXIB5    ANDEQ*BLANK                     ***3           CSW096
318100210712     C***********          Z-ADDBBCABA    PNXIB3           ***3     S01429CSW096
318200210712     C***********          Z-ADDBBABA2    PNXIB3           ***3     S01429CSW096
318300210712     C***********          MOVE PMXIBA    PMRIBA           ***3           CSW096
318400210712     C***********          END                             E**3           CSW096
318500210712     C***********          END                             E*2            CSW096
318600210712     C***********                                                         CSW096
318700210712     C***IF*//CP*IT*MUST*BE*FOLLOWED*BY*A*3*DIGIT*NUMBER.THE*NUMBER*S01429CSW096
318800210712     C***IF*//CP*IT MUST BE FOLLOWED BY A 4 DIGIT NUMBER.THE NUMBER S01429CSW096
318900210712     C***MUST*BE*FOLLOWED BY BLANKS.                                      CSW096
319000210712     C***********PMXIB4    IFEQ '//CP'                     B*2            CSW096
319100210712     C***********          TESTN          PMXIB3     60    **2            CSW096
319200210712     C************IN60     IFNE '1'                        NOT NUMERIC    CSW096
319300210712     C***********PMXIBX    ORNE *BLANKS                    NOT FOLL. BY BLCSW096
319400210712     C***********          MOVE '928'     ERCD,S           ***3           CSW096
319500210712     C***********          ADD  1         S                ***3           CSW096
319600210712     C***********          MOVE '1'       *IN30            **2      LN0787CSW096
319700210712     C***********          END                             E**3           CSW096
319800210712     C***********          END                             E*2            CSW096
319900210712     C***********                                                         CSW096
320000210712     C***IF*//FW*IT MUST BE FOLLOWED BY A 9 DIGIT NUMBER.IF INTER. BANK   CSW096
320100210712     C***HAS*A*SWIFT ADDRESS //FW DOES NOT REQUIRE TO BE FOLLOWED BY      CSW096
320200210712     C***A*NUMBER                                                         CSW096
320300210712     C***********PMXIB4    IFEQ '//FW'                     B*2            CSW096
320400210712     C***********          TESTN          PMXIB9     60    **2            CSW096
320500210712     C************IN60     IFNE '1'                        NOT NUMERIC    CSW096
320600210712     C***********PMXIBZ    ORNE *BLANKS                    NOT FOLL. BY BLCSW096
320700210712     C***********          MOVE '0'       *IN60            ***3           CSW096
320800210712     C***********          END                             E**3           CSW096
320900210712     C***********CPRIBN    IFEQ 'N'                        B**3           CSW096
321000210712     C***********SWFT      ANDNE*BLANKS                    ***3           CSW096
321100210712     C***********PMXIB5    ANDEQ*BLANKS                    ***3           CSW096
321200210712     C***********          MOVE '1'       *IN60            ***3           CSW096
321300210712     C***********          END                             E**3           CSW096
321400210712     C***IF*SWIFT ADDRESS IS BLANK BUT THE FEDWIRE ACCOUNT NUMBER IS      CSW096
321500210712     C***PRESENT, SET UP THE FEDWIRE ACCOUNT                              CSW096
321600210712     C***********PMXIB5    IFEQ *BLANKS                    B**3           CSW096
321700210712     C***********SWFT      ANDEQ*BLANKS                    ***3           CSW096
321800210712     C***********FEDW      ANDNE*ZEROS                     ***3           CSW096
321900210712     C***********          Z-ADDFEDW      PMXIB7           ***3           CSW096
322000210712     C***********          END                             E**3           CSW096
322100210712     C***********SWFT      IFEQ *BLANKS                    B**3           CSW096
322200210712     C***********FEDW      ANDEQ*ZEROS                     ***3     S01117CSW096
322300210712     C***********PMXIB9    ANDEQ*BLANKS                    ***3     S01117CSW096
322400210712     C***********          MOVE '0'       *IN60            ***3           CSW096
322500210712     C***********          END                             E**3           CSW096
322600210712     C************IN60     IFNE '1'                        B**3           CSW096
322700210712     C***********          MOVE '928'     ERCD,S           ***3           CSW096
322800210712     C***********          ADD  1         S                ***3           CSW096
322900210712     C***********          MOVE '1'       *IN30            **2      LN0787CSW096
323000210712     C***********          END                             E**3           CSW096
323100210712     C***********          END                             E*2            CSW096
323200210712     C***********                                                         CSW096
323300210712     C***IF*//BL*AND FOLLOWED BY BLANKS THEN DEFAULT THIS TO THE          CSW096
323400210712     C***BANKLEITZAHL CODE ONLY IF PMRIBN IS A CUSTOMER                   CSW096
323500210712     C***********CPRIBN    IFEQ 'N'                        B*2            CSW096
323600210712     C***********PMXIB4    IFEQ '//BL'                     B**3           CSW096
323700210712     C***********PMXIB8    ANDEQ*BLANK                     ***3           CSW096
323800210712     C***********          MOVE BBBLCD    PMXIB8           ***3           CSW096
323900210712     C***********          MOVE PMXIBA    PMRIBA           ***3           CSW096
324000210712     C***********          END                             E**3           CSW096
324100210712     C***********          END                             E*2            CSW096
324200210712     C***********                                                         CSW096
324300210712     C***IF*//BL*IT MUST BE FOLLOWED BY A 8 DIGIT NUMBER.                 CSW096
324400210712     C***********PMXIB4    IFEQ '//BL'                     B*2            CSW096
324500210712     C***********          TESTN          PMXIB8     60    **2            CSW096
324600210712     C************IN60     IFNE '1'                        NOT NUMERIC    CSW096
324700210712     C***********PMXIBY    ORNE *BLANKS                    NOT FOLL. BY BLCSW096
324800210712     C***********          MOVE '928'     ERCD,S           ***3           CSW096
324900210712     C***********          ADD  1         S                ***3           CSW096
325000210712     C***********          MOVE '1'       *IN30            **2      LN0787CSW096
325100210712     C***********          END                             E**3           CSW096
325200210712     C***********          END                             E*2            CSW096
325300210712     C***********                                                   CSW095CSW096
325400210712     C***If*//SW*must*be*followed*by*a*6-digit*number.*****  CSW095 094100CSW096
325500210712     C***If*//SW*must be followed by a 5-digit number.              094100CSW096
325600210712     C***********                                                   CSW095CSW096
325700210712     C***********PMXIB4    IFEQ '//SW'                     B*2      CSW095CSW096
325800210712     C***********          TESTN          PMXIB6     60    **CSW095 094100CSW096
325900210712     C***********          TESTN          PMXSW5     60    **2      094100CSW096
326000210712     C************IN60     IFNE '1'                        not numerCSW095CSW096
326100210712     C***********PMXIBW    ORNE *BLANKS                    not follC094100CSW096
326200210712     C***********PMXSWW    ORNE *BLANKS                    not foll.CSW095CSW096
326300210712     C***********          MOVE '928'     ERCD,S           ***3     CSW095CSW096
326400210712     C***********          ADD  1         S                ***3     CSW095CSW096
326500210712     C***********          MOVE '1'       *IN30                     CSW095CSW096
326600210712     C***********          END                             E**3     CSW095CSW096
326700210712     C***********          END                             E*2      CSW095CSW096
326800210712     C***********                                                   CSW095CSW096
326900210712     C***********          END                             E1       CSW095CSW096
327000210712     C           EVAL4     TAG
327100210712     C**
327200210712     C** The following code has been moved further up the program         S01117
327300210712     C** as the Branch validation has been done too late.                 S01117
327400210712     C**
327500210712     C***SETTLEMENT*BRANCH*****************************************       S01117
327600210712     C** -----------------                                                S01117
327700210712     C**                                                                  S01117
327800210712     C***IF*MULTIBRANCHING*FLAG*IS*OFF*SKIP*FURTHER*VALIDATION******      S01117
327900210712     C***********@MBIN     IFEQ 'N'                        B1             S01117
328000210712     C*********************GOTO EVAL16                     *1             S01117
328100210712     C*********************END                             E1             S01117
328200210712     C*                                                                   S01117
328300210712     C***SETTLEMENT*BRANCH*ONLY*ALLOWED*WITH*SETTLEMENT*METHOD*5****      S01117
328400210712      ***ONLY*VALIDATE*IF*USER*SET*UP**********************               S01117
328500210712     C***********PMRSTM    IFNE 05                         B1             S01117
328600210712     C***********RBRF      ANDEQ*BLANKS                    B1             S01117
328700210712     C*                                                                   S01117
328800210712     C***Validate*Receive*Branch*if*entered*by*user.****************      S01117
328900210712     C***********RBRF      IFEQ *BLANKS                    B*2            S01117
329000210712     C***********PMOPSB    IFNE *BLANKS                    B*2            S01117
329100210712     C***********PMROBR    IFNE *BLANKS                    B*2            S01117
329200210712     C*********************MOVE '886'     ERCD,S           **2            S01117
329300210712     C*********************ADD  1         S                **2            S01117
329400210712     C*********************END                             E*2            S01117
329500210712     C*********************END                             E*2            S01117
329600210712     C*                                                                   S01117
329700210712     C*********************ELSE                            X1             S01117
329800210712     C*                                                                   S01117
329900210712     C***SETTLEMENT*BRANCH*MANDATORY*WITH*SETTLEMENT*METHOD*5******       S01117
330000210712     C***********PMOPSB    IFEQ *BLANKS                    B*2            S01117
330100210712     C***********PMROBR    IFEQ *BLANKS                    B*2            S01117
330200210712     C*********************MOVE '885'     ERCD,S           **2            S01117
330300210712     C*********************ADD  1         S                **2            S01117
330400210712     C*                                                                   S01117
330500210712     C*********************ELSE                            X*2            S01117
330600210712     C*                                                                   S01117
330700210712     C***VALIDATE*SETTLEMENT*BRANCH*******************************        S01117
330800210712     C*********************MOVE PMOPSB    @OBR    3        **2            S01117
330900210712     C*********************MOVE PMROBR    @OBR    3        **2            S01117
331000210712     C*********************EXSR CHKBR                      **2            S01117
331100210712     C***********@RTCD     IFNE *BLANKS                    B**3           S01117
331200210712     C*********************MOVE '884'     ERCD,S           ***3           S01117
331300210712     C*********************ADD  1         S                ***3           S01117
331400210712     C*********************ELSE                            ***3           S01117
331500210712     C*********************MOVE @DSNB     PMROBR           ***3           S01117
331600210712     C*********************END                             E**3           S01117
331700210712     C*********************END                             E*2            S01117
331800210712     C*********************END                             E1             S01117
331900210712     C*                                                                   S01117
332000210712     C*                                                                   S01117
332100210712     C***********EVAL16    TAG                                            S01117
332200210712     C*                                                                   S01117
332300210712     C*                                                                   S01408
332400210712     C/COPY WNCPYSRC,SD2410CP18                                           S01408
332500210712     C*                                                                   S01408
332600210712     C           PAYMNT    TAG
332700210712     C*
332800210712     C********** PMACTC    IFNE 'X'                                       118948
332900210712     C********** PMPPAY    CABEQ'Y'       V01END                          118948
333000210712     C**********           END                                            118948
333100210712      *                                                                                       260577
333200210712      ** This part should not be ommitted as to condition whether there                       260577
333300210712      ** is a need to validate receipt side or not.  Just change to                           260577
333400210712      ** bypass validation even if action code is 'X'                                         260577
333500210712      *                                                                                       260577
333600210712     C           PMPPAY    CABEQ'Y'       V01END                                              260577
333700210712     C*
333800210712     C** VALIDATE PAYMENT
333900210712     C** ================
334000210712      *
334100210712     C*                                                                   S01408
334200210712     C/COPY WNCPYSRC,SD2410CVS3                                           S01408
334300210712     C*                                                                   S01408
334400210712     C********** PMPOCN    IFEQ '000000'                                                      CSD027
334500210712     C**********           MOVE *BLANKS   PMPOCN                                              CSD027
334600210712     C**********           END                                                                CSD027
334700210712     C********** PMPOBN    IFEQ '000000'                                                      CSD027
334800210712     C**********           MOVE *BLANKS   PMPOBN                                              CSD027
334900210712     C**********           END                                                                CSD027
335000210712     C*                                                                   S01117
335100210712     C** BLANK OUT WORK FIELD @OBR & DATA STRUCTURES FOR PAYMENT          S01117
335200210712     C** INSTRUCTIONS VALIDATION.                                         S01117
335300210712     C                     MOVE *BLANKS   @OBR                            S01117
335400210712     C                     MOVE *BLANKS   ALRF                            S01117
335500210712     C                     MOVE *BLANKS   CURF                            S01117
335600210712     C                     MOVE *BLANKS   A7RF                            S01117
335700210712     C                     MOVE *BLANKS   ACCT                            S01117
335800210712     C                     MOVE *BLANKS   DMRF                            S01117
335900210712     C                     MOVE *BLANKS   SDBRCH                          S01117
336000210712     C*                                                                   S01117
336100210712     C*
336200210712     C** ENTRY IN ALL PAYMENT INSTRUCTIONS PROHIBITED IF PAYMENT
336300210712     C** SETTLEMENT METHOD IS 00
336400210712     C           PMPSTM    IFEQ 00                         B1
336500210712     C*                                                                   E00033
336600210712     C***********PMPOBR    IFNE *BLANKS                    B*2    E00033  S01117
336700210712     C*********************MOVE *BLANKS   PMPOBR           **2    E00033  S01117
336800210712     C*********************END                             E*2    E00033  S01117
336900210712     C*                                                                   E00033
337000210712     C           PMPONS    IFNE *BLANKS                    B*2
337100210712     C           PMPOBN    ORNE *BLANKS                    **2
337200210712     C           PMPOCN    ORNE *BLANKS                    **2
337300210712     C           PMPIBN    ORNE *BLANK                     **2
337400210712     C           PMPIBA    ORNE *BLANK                     **2
337500210712     C           PMRCRN    ORNE *BLANK                     **2
337600210712     C           PMRCRA    ORNE *BLANK                     **2
337700210712     C           PMRVNO    ORNE *BLANK                     **2
337800210712     C           PMCVMR    ORNE *BLANK                     **2            E22405
337900210712     C           PMAWBN    ORNE *BLANK                     **2
338000210712     C           PMAWBA    ORNE *BLANK                     **2
338100210712     C           PMBENN    ORNE *BLANK                     **2
338200210712     C           PMBENA    ORNE *BLANK                     **2
338300210712     C           PMDTP1    ORNE *BLANK                     **2
338400210712     C           PMDTP2    ORNE *BLANK                     **2
338500210712     C           PMDTP3    ORNE *BLANK                     **2
338600210712     C           PMDTP4    ORNE *BLANK                     **2
338700210712     C           PMDCHG    ORNE *BLANK                     **2
338800210712     C***********PMOSSB    ORNE *BLANKS                    **2            S01117
338900210712     C           PMPOBR    ORNE *BLANKS                    **2            S01117
339000210712     C                     MOVE '929'     ERCD,S           **2
339100210712     C                     ADD  1         S                **2
339200210712     C                     MOVE '1'       *IN31            **2            LN0787
339300210712     C                     END                             E*2
339400210712     C                     END                             E1
339500210712     C*C*PY*WN*PYSRC*SD2410C049                                           169210
339600210712     C/COPY WNCPYSRC,SD2410CX49                                           169210
339700210712     C*
339800210712     C** ENTRY IN FOLLOWING FIELDS IS PROHIBITED UNLESS SETL. TYPE
339900210712     C***IS*01,07*OR*08.***                                               CLE033
340000210712     C** IS 01,07,08 OR 09.                                               CLE033
340100210712     C           PMPSTM    IFNE 01                         B1
340200210712     C           PMPSTM    ANDNE07                         *1
340300210712     C           PMPSTM    ANDNE08                         *1
340400210712     C           CLE033    ANDNE'Y'                        *1             CLE033
340500210712     C           PMPSTM    ORNE 01                         B1             CLE033
340600210712     C           PMPSTM    ANDNE07                         *1             CLE033
340700210712     C           PMPSTM    ANDNE08                         *1             CLE033
340800210712     C           CLE033    ANDEQ'Y'                        *1             CLE033
340900210712     C           PMPSTM    ANDNE09                         *1             CLE033
341000210712     C           PMPOCN    IFNE *BLANKS                    B*2
341100210712     C           PMPOBN    ORNE *BLANKS                    **2
341200210712     C           PMPIBN    ORNE *BLANK                     **2
341300210712     C           PMPIBA    ORNE *BLANK                     **2
341400210712     C           PMRVNO    ORNE *BLANK                     **2
341500210712     C           PMCVMR    ORNE *BLANK                     **2            E22405
341600210712     C           PMRCRN    ORNE *BLANK                     **2
341700210712     C           PMRCRA    ORNE *BLANK                     **2
341800210712     C           PMAWBN    ORNE *BLANK                     **2
341900210712     C/COPY WNCPYSRC,SD2410C069
342000210712     C           PMAWBA    ORNE *BLANK                     **2
342100210712     C           PMBENN    ORNE *BLANK                     **2
342200210712     C           PMBENA    ORNE *BLANK                     **2
342300210712     C           PMDTP1    ORNE *BLANK                     **2
342400210712     C           PMDTP2    ORNE *BLANK                     **2
342500210712     C           PMDTP3    ORNE *BLANK                     **2
342600210712     C           PMDTP4    ORNE *BLANK                     **2
342700210712     C           PMDCHG    ORNE *BLANK                     **2
342800210712     C***********PMBTB1    ORNE *BLANK                     **2            033351
342900210712     C***********PMBTB2    ORNE *BLANK                     **2            033351
343000210712     C***********PMBTB3    ORNE *BLANK                     **2            033351
343100210712     C***********PMBTB4    ORNE *BLANK                     **2            033351
343200210712     C***********PMBTB5    ORNE *BLANK                     **2            033351
343300210712     C***********PMBTB6    ORNE *BLANK                     **2            033351
343400210712     C*                                                                   S01408
343500210712     C/COPY WNCPYSRC,SD2410CVS1                                           S01408
343600210712     C*                                                                   S01408
343700210712     C                     MOVE '930'     ERCD,S           **2
343800210712     C                     ADD  1         S                **2
343900210712     C                     MOVE '1'       *IN31            **2            LN0787
344000210712     C           PMPOCN    IFNE *BLANKS                    B**3
344100210712     C                     MOVE '1'       *IN38            ***3
344200210712     C                     END                             E**3
344300210712     C           PMPOBN    IFNE *BLANKS                    B**3
344400210712     C                     MOVE '1'       *IN40            ***3
344500210712     C                     END                             E**3
344600210712     C           PMPIBN    IFNE *BLANK                     B**3
344700210712     C                     MOVE '1'       *IN44            ***3
344800210712     C                     END                             E**3
344900210712     C           PMPIBA    IFNE *BLANK                     B**3
345000210712     C                     MOVE '1'       *IN46            ***3
345100210712     C                     END                             E**3
345200210712     C           PMRVNO    IFNE *BLANK                     B**3
345300210712     C                     MOVE '1'       *IN36            ***3
345400210712     C                     END                             E**3
345500210712     C           PMCVMR    IFNE *BLANK                     B**3           E22405
345600210712     C                     MOVE '1'       *IN61            ***3           E22405
345700210712     C                     END                             E**3           E22405
345800210712     C           PMRCRN    IFNE *BLANK                     B**3
345900210712     C                     MOVE '1'       *IN41            ***3
346000210712     C                     END                             E**3
346100210712     C           PMRCRA    IFNE *BLANK                     B**3
346200210712     C                     MOVE '1'       *IN42            ***3
346300210712     C                     END                             E**3
346400210712     C           PMAWBN    IFNE *BLANK                     B**3
346500210712     C                     MOVE '1'       *IN47            ***3
346600210712     C                     END                             E**3
346700210712     C           PMAWBA    IFNE *BLANK                     B**3
346800210712     C                     MOVE '1'       *IN48            ***3
346900210712     C                     END                             E**3
347000210712     C           PMBENN    IFNE *BLANK                     B**3
347100210712     C                     MOVE '1'       *IN49            ***3
347200210712     C                     END                             E**3
347300210712     C           PMBENA    IFNE *BLANK                     B**3
347400210712     C                     MOVE '1'       *IN50            ***3
347500210712     C                     END                             E**3
347600210712     C*                                                                   S01408
347700210712     C/COPY WNCPYSRC,SD2410CVS2                                           S01408
347800210712     C*                                                                   S01408
347900210712     C                     END                             E*2
348000210712     C                     END                             E1
348100210712     C/COPY WNCPYSRC,SD2410C002
348200210712     C*
348300210712     C** RECIPIENT OF MT100
348400210712     C** ------------------
348500210712     C                     MOVE *BLANKS   PARVNO
348600210712     C           *IN36     CABEQ'1'       EVAL8            ERROR ON FIELD
348700210712     C/COPY WNCPYSRC,SD2410C003
348800210712     C*                                                                   221452
348900210712     C** No need to validate swift fields if Swift for Lending is not     221452
349000210712     C** on and settlement method is 09                                   221452
349100210712     C*                                                                   221452
349200210712     C           CLE033    IFEQ 'Y'                                       221452
349300210712     C           PMRSTM    ANDEQ09                                        221452
349400210712     C           BGSWCL    ANDNE'Y'                                       221452
349500210712     C                     GOTO EVAL8                                     221452
349600210712     C                     ENDIF                                          221452
349700210712     C*
349800210712     C** MUST BE A 6 DIGIT NUMBER
349900210712     C** OR A CUSTOMER SHORTNAME THAT IDENTIFIES A LIVE
350000210712     C** RECORD ON FILE SDCUSTPD
350100210712     C                     MOVE 'Y'       CPRVNO  1
350200210712     C           PMRVNO    IFNE *BLANK                     B1
350300210712     C                     MOVE *BLANKS   CHKFLD           *1             S01117
350400210712     C                     MOVE PMRVNO    CHKFLD           *1
350500210712     C                     MOVE 'N'       @CPNA            *1             S01117
350600210712     C                     EXSR CHKFL                      *1
350700210712     C*                                                                   S01117
350800210712     C           RTCD      IFEQ '*NOSEL '                  B*2            S01117
350900210712     C                     MOVE '871'     ERCD,S           **2            S01117
351000210712     C                     ADD  1         S                **2            S01117
351100210712     C                     MOVE '1'       *IN31            **2            LN0787
351200210712     C                     END                             E*2            S01117
351300210712     C*                                                                   S01117
351400210712     C           RESULT    IFNE 'A'                        B*2
351500210712     C           RESULT    ANDNE'B'                        B*2
351600210712     C                     MOVE '952'     ERCD,S           **2
351700210712     C                     ADD  1         S                **2
351800210712     C                     MOVE '1'       *IN31            **2            LN0787
351900210712     C                     ELSE                            X*2
352000210712     C                     MOVELBBCUST    PARVNO           **2
352100210712     C*                                                                   S01117
352200210712     C**   CHECK IF '?' ENTERED, IF SO MOVE VALUE RETRIEVED               S01117
352300210712     C**   INTO SCREEN FIELD.                                             S01117
352400210712     C*                                                                   S01117
352500210712     C                     MOVELPMRVNO    @TSTQ   1        **2            S01117
352600210712     C           @TSTQ     IFEQ '?'                        B**3           S01117
352700210712     C                     MOVELBBCSSN    PMRVNO           ***3           S01117
352800210712     C                     END                             E**3           S01117
352900210712     C                     END                             E*2
353000210712     C*
353100210712     C** RECEIVER MUST HAVE SWIFT ADDRESS, A STTX ADDRESS OR A TELEX
353200210712     C** ADDRESS
353300210712     C*
353400210712     C           BBCSID    IFEQ *BLANK                     B*2
353500210712     C           BBSTAD    ANDEQ*BLANK                     B*2
353600210712     C           BBTXA1    ANDEQ*BLANK                     **2
353700210712     C                     MOVE '953'     ERCD,S           **2
353800210712     C                     ADD  1         S                **2
353900210712     C                     MOVE '1'       *IN31            **2            LN0787
354000210712     C                     END                             E*2
354100210712     C*                                                                   E22405
354200210712     C**  CHECK COVER-MT202-REQUIRED IS "Y" OR "N"                        E22405
354300210712     C           PMCVMR    IFNE 'N'                        B*2            E22405
354400210712     C           PMCVMR    ANDNE'Y'                        **2            E22405
354500210712     C                     MOVE '889'     ERCD,S           **2            E22405
354600210712     C                     ADD  1         S                **2            E22405
354700210712     C                     MOVE '1'       *IN31            **2            LN0787
354800210712     C                     END                             E*2            E22405
354900210712     C*                                                                   E22405
355000210712     C                     ELSE                            X1             E22405
355100210712     C/COPY WNCPYSRC,SD2410C049
355200210712     C*                                                                   E22405
355300210712     C**  AS RECIPIENT OF PAYMENT INSTRUCTION HASN'T BEEN ENTERED,        E22405
355400210712     C**  COVER-MT202-REQUIRED MUST BE BLANK                              E22405
355500210712     C           PMCVMR    IFNE *BLANK                     B*2            E22405
355600210712     C/COPY WNCPYSRC,SD2410C054
355700210712     C                     MOVE '890'     ERCD,S           **2            E22405
355800210712     C                     ADD  1         S                **2            E22405
355900210712     C                     MOVE '1'       *IN31            **2            LN0787
356000210712     C                     END                             E*2            E22405
356100210712     C*                                                                   E22405
356200210712     C*                                                                   E22614
356300210712     C* IF RECIPIENT NON-BLANK                                            LN0657
356400210712     C* CHECK RECIPIENT IS A BANK                                         E22614
356500210712     C           PMRVNO    IFNE *BLANK                                    LN0657
356600210712     C           BANKNB    IFNE 'B'                                       E22614
356700210712     C                     MOVE '955'     ERCD,S                          E22614
356800210712     C                     ADD  1         S                               E22614
356900210712     C                     MOVE '1'       *IN31                           LN0787
357000210712     C                     END                                            E22614
357100210712     C                     END                                            LN0657
357200210712     C*                                                                   E22614
357300210712     C                     END                             E1
357400210712     C*
357500210712     C           EVAL8     TAG
357600210712     C*
357700210712     C** SETTLEMENT METHOD
357800210712     C** -----------------
357900210712     C*
358000210712     C***MUST*BE*00,01,02,03,04,05,06,07,08,12*OR*14**                    CLE033
358100210712     C** MUST BE 00,01,02,03,04,05,06,07,08,09,12 OR 14                   CLE033
358200210712     C           PMPSTM    IFNE 00                         B1
358300210712     C           PMPSTM    ANDNE01                         *1
358400210712     C           PMPSTM    ANDNE02                         *1
358500210712     C           PMPSTM    ANDNE03                         *1
358600210712     C           PMPSTM    ANDNE04                         *1
358700210712     C           PMPSTM    ANDNE05                         *1
358800210712     C           PMPSTM    ANDNE06                         *1
358900210712     C           PMPSTM    ANDNE07                         *1
359000210712     C           PMPSTM    ANDNE08                         *1
359100210712     C           PMPSTM    ANDNE12                         *1
359200210712     C           PMPSTM    ANDNE14                         *1
359300210712     C           CLE033    ANDNE'Y'                        *1             CLE033
359400210712     C           PMPSTM    ORNE 00                         B1             CLE033
359500210712     C           PMPSTM    ANDNE01                         *1             CLE033
359600210712     C           PMPSTM    ANDNE02                         *1             CLE033
359700210712     C           PMPSTM    ANDNE03                         *1             CLE033
359800210712     C           PMPSTM    ANDNE04                         *1             CLE033
359900210712     C           PMPSTM    ANDNE05                         *1             CLE033
360000210712     C           PMPSTM    ANDNE06                         *1             CLE033
360100210712     C           PMPSTM    ANDNE07                         *1             CLE033
360200210712     C           PMPSTM    ANDNE08                         *1             CLE033
360300210712     C           PMPSTM    ANDNE12                         *1             CLE033
360400210712     C           PMPSTM    ANDNE14                         *1             CLE033
360500210712     C           CLE033    ANDEQ'Y'                        *1             CLE033
360600210712     C           PMPSTM    ANDNE09                         *1             CLE033
360700210712     C/COPY WNCPYSRC,SD2410C090
360800210712     C                     MOVE '931'     ERCD,S           *1
360900210712     C                     ADD  1         S                *1
361000210712     C                     MOVE '1'       *IN31                           LN0787
361100210712     C                     END                             E1
361200210712      *                                                                   CDL008
361300210712     C           CDL008    IFEQ 'Y'                                       CDL008
361400210712     C           PMTTYP    ANDEQ'CL'                                      CDL008
361500210712     C           PMPSTM    ANDNE00                                        186433
361600210712     C           PMPSTM    ANDNE01                                        CDL008
361700210712     C           PMPSTM    ANDNE07                                        CDL008
361800210712     C           PMPSTM    ANDNE08                                        CDL008
361900210712     C           PMPSTM    ANDNE02                                        CDL008
362000210712     C           PMPSTM    ANDNE12                                        CDL008
362100210712     C                     MOVE '304'     ERCD,S                          CDL008
362200210712     C                     ADD  1         S                               CDL008
362300210712     C                     MOVE *ON       *IN31                           CDL008
362400210712     C                     ENDIF                                          CDL008
362500210712     C*
362600210712     C** WHEN TYPE IS 04 OR 14 THE RETAIL MODULE MUST BE PRESENT; THESE
362700210712     C** TYPES ARE NOT ALLOWED WHEN CALLING PROGRAM CODE IS 'MMLD' AND
362800210712     C/COPY WNCPYSRC,SD2410C051
362900210712     C** TRANSACTION TYPE IS 'CI'
363000210712     C*
363100210712     C           PMPSTM    IFEQ 04                         B1
363200210712     C           PMPSTM    OREQ 14                         *1
363300210712     C           PMRETP    IFNE 'Y'                        B*2
363400210712     C                     MOVE '932'     ERCD,S           **2
363500210712     C                     ADD  1         S                **2
363600210712     C                     MOVE '1'       *IN31                           LN0787
363700210712     C/COPY WNCPYSRC,SD2410C052
363800210712     C                     END                             E*2
363900210712     C                     END
364000210712     C           PMPSTM    IFEQ 04                         B1             BHF352
364100210712     C           PMCPGM    IFEQ 'MMLD'                     B*2
364200210712     C           PMTTYP    ANDEQ'CI'                       **2
364300210712     C                     MOVE '933'     ERCD,S           **2
364400210712     C                     ADD  1         S                **2
364500210712     C                     MOVE '1'       *IN31                           LN0787
364600210712     C                     END                             E*2
364700210712     C                     END                             E1             BHF352
364800210712     C*
364900210712     C** IF TYPE IS 04 A LIVE RECORD MUST EXIST IN ACCNTAB
365000210712     C           PMPSTM    IFEQ 04                         B1
365100210712     C                     MOVEL*BLANK    ACID             *1             LN0830
365200210712     C                     MOVELPMCSNM    ACID             *1
365300210712     C***********          MOVE PMPCCY    CUCD             *1             CEU003
365400210712     C                     MOVE WPECY     CUCD                            CEU003
365500210712     C                     MOVE '01'      ACSQA            *1
365600210712     C                     MOVE PMPCYA    ACCD             *1
365700210712     C                     MOVE PMBRCA    BRCD             *1             S01117
365800210712      *                                                                   S01117
365900210712      ** SET UP SETTLEMENT BRANCH FOR FILE UPDATES BY OTHER PGMS          S01117
366000210712      ***SET*ON*PAY*BRANCH*FLAG*TO*SIGNIFY*PROGRAM*HAS*SET          S01117139921
366100210712      ***THIS*FIELD*UP                                              S01117139921
366200210712     C           PMPOBR    IFEQ *BLANKS                    B*2            S01117
366300210712     C                     MOVE PMBRCA    PMPOBR           **2            S01117
366400210712     C**********           MOVE 'Y'       PBRF             **2      S01117139921
366500210712     C                     END                             E*2            S01117
366600210712      *                                                                   S01117
366700210712     **  FOR STANDING DATA - EXTENDED SETTLEMENTS:                        S01117
366800210712     **  FOR SETTLEMENT TYPE 04 ONLY PARTIAL CHECKING OF ACCOUNT          S01117
366900210712     **  ENTERED CAN BE DONE AS NOT ALL DETAILS ARE AVAILABLE.            S01117
367000210712     **  THEREFORE SUBROUTINE CHKAC SHOULD NOT BE CALLED.                 S01117
367100210712     C           PMCPGM    IFEQ 'SSI '                     B1             S01117
367200210712     C                     MOVE *BLANKS   RTCD             *1             S01117
367300210712      *                                                                   S01117
367400210712     **  IF WARNING MESSAGE FOR SETTLEMENT METHOD 04 HAS BEEN SENT, DO    S01117
367500210712     **  NOT SEND A SECOND TIME.                                          S01117
367600210712     C           @SENT     IFNE 'Y'                        B*2            S01117
367700210712     C                     MOVE '865'     ERCD,S           **2            S01117
367800210712     C                     ADD  1         S                **2            S01117
367900210712     C                     MOVE '1'       *IN31                           LN0787
368000210712     C                     END                             E*2            S01117
368100210712     C                     ELSE                            X1             S01117
368200210712     C                     EXSR CHKAC                      *1             S01117
368300210712     C**********           END                             E1                          S01117 240971
368400210712      *
368500210712     C           RTCD      IFNE *BLANKS                    B*2
368600210712     C           RECI      ORNE 'D'                        B*2            E24104
368700210712     C           ACST      OREQ 'C'                                       060470
368800210712     C                     MOVE '934'     ERCD,S           **2
368900210712     C                     ADD  1         S                **2
369000210712     C                     MOVE '1'       *IN31                           LN0787
369100210712      *                                                                   S01408
369200210712      /COPY WNCPYSRC,SD2410CCP7                                           S01408
369300210712      *                                                                   S01408
369400210712     C                     ENDIF                                                              240971
369500210712     C                     END                             E*2
369600210712     C                     END                             E1
369700210712     C*
369800210712     C** IF SETTL. TYPE IS 07 THE PAYMENT CURRENCY MUST BE USD
369900210712     C           PMPSTM    IFEQ 07                         B1
370000210712     C           PMPCCY    ANDNE'USD'                      *1
370100210712     C                     MOVE '935'     ERCD,S           *1
370200210712     C                     ADD  1         S                *1
370300210712     C                     MOVE '1'       *IN31                           LN0787
370400210712     C                     END                             E1
370500210712     C*
370600210712     C** IF TYPE IS 14 THE RETAIL ACCOUNT NUMBER MUST BE SUPPORTED
370700210712     C           PMPSTM    IFEQ 14                         B1
370800210712     C           PMRETS    ANDNE'Y'                        *1
370900210712     C                     MOVE '936'     ERCD,S           *1
371000210712     C                     ADD  1         S                *1
371100210712     C                     MOVE '1'       *IN31                           LN0787
371200210712     C                     END                             E1
371300210712     C*                                                                   CLE033
371400210712     C** IF SETTLEMENT 09 ACCOUNT CODE IS RETAIL                          CLE033
371500210712     C           A5ACTY    IFEQ 'R'                        B1             CLE033
371600210712     C           CLE033    ANDEQ'Y'                                       CLE033
371700210712     C           PMPSTM    ANDEQ09                                        CLE033
371800210712     C*                                                                   CLE033
371900210712     C           PMPSCY    IFNE *BLANKS                    B2             CLE033
372000210712     C           SET09     ANDNE'T'                                                           218782
372100210712     C                     MOVE PMPSCY    W0PSCY  3                       CLE033
372200210712     C                     ENDIF                           E2             CLE033
372300210712     C*                                                                   CLE033
372400210712     C           PMPSCY    IFEQ *BLANKS                    B2             CLE033
372500210712     C           SET09     OREQ 'T'                                                           218782
372600210712     C                     MOVE PMPCCY    W0PSCY                          CLE033
372700210712     C                     ENDIF                           E2             CLE033
372800210712     C*                                                                   CLE033
372900210712     C**********           MOVELP@VL02    W0ACCD  4                                    CLE033 CGL029
373000210712     C                     MOVELP@VL02    W0ACCD                                              CGL029
373100210712     C                     MOVELP@VL01    W0CNUM  6                       CLE033
373200210712     **  For Standing Data - Extended Settlements:                                            218906
373300210712     **  For Settlement Type 09, only partial checking of account                             218906
373400210712     **  entered can be done, as not all details are available.                               218906
373500210712     **  Therefore subroutine AOACCTR0 should not be called.                                  218906
373600210712     C           PMCPGM    IFNE 'SSI '                     If not SSI                         218906
373700210712     C*                                                                   CLE033
373800210712     C                     CALL 'AOACCTR0'                                CLE033
373900210712     C                     PARM *BLANKS   P@RTCD  7                       CLE033
374000210712     C                     PARM '*KEY   ' P@OPTN  7                       CLE033
374100210712     C                     PARM *BLANKS   P@RETL 10                       CLE033
374200210712     C                     PARM W0CNUM    P@CNUM  6                       CLE033
374300210712     C                     PARM W0PSCY    P@CUCD  3                       CLE033
374400210712     C**********           PARM W0ACCD    P@ACCD  4                                    CLE033 CGL029
374500210712     C                     PARM W0ACCD    P@ACCD                                              CGL029
374600210712     C                     PARM '01'      P@ACSQ  2                       CLE033
374700210712     C                     PARM PMBRCA    P@BRCA  3                       CLE033
374800210712     C           ACCT      PARM ACCT      DSSDY                           CLE033
374900210712     C*                                                                   CLE033
375000210712     C           P@RTCD    IFNE *BLANKS                    B2             CLE033
375100210712     C           RECI      ORNE 'D'                                       CLE033
375200210712     C           ATYP      ORNE 'R'                                       CLE033
375300210712     C                     MOVE '934'     ERCD,S           *1             CLE033
375400210712     C                     ADD  1         S                *1             CLE033
375500210712     C                     MOVE '1'       *IN30            **2            CLE033
375600210712     C                     ENDIF                           E2             CLE033
375700210712     C*                                                                   CLE033
375800210712     C                     ENDIF                           End not SSI                        218906
375900210712      *                                                                                       218906
376000210712     C                     ENDIF                           E1             CLE033
376100210712     C/COPY WNCPYSRC,SD2410C026
376200210712     C**
376300210712     C** SETTLEMENT BRANCH                                                S01117
376400210712     C** -----------------                                                S01117
376500210712     C*                                                                   S01117
376600210712     C*  Validate Branch if in multi-branching environment.               S01117
376700210712     C           @MBIN     IFEQ 'Y'                                       S01117
376800210712     C*                                                                   S01117
376900210712     C***Settlement*branch*only*allowed*with*Settlement*Method*05.  S01117139921
377000210712     C** If Settlement type not '05', blank out Pay Branch -              139921
377100210712     C** this will be initialised with the correct branch code.           139921
377200210712     C           PMPSTM    IFNE 05                         B1             S01117
377300210712     C           PMPSTM    ANDNE04                         B1             141865
377400210712     C           CLE033    ANDNE'Y'                        B1             CLE033
377500210712     C           PMPSTM    ORNE 05                         B1             CLE033
377600210712     C           PMPSTM    ANDNE04                         B1             CLE033
377700210712     C           CLE033    ANDEQ'Y'                        B1             CLE033
377800210712     C           PMPSTM    ANDNE09                         B1             CLE033
377900210712     C/COPY WNCPYSRC,SD2410C091
378000210712     C*                                                                   S01117
378100210712     C                     MOVE *BLANKS   PMPOBR                          139921
378200210712     C*                                                                   139921
378300210712     C***If*user*has*set*up*Pay*Branch,*then*an*error*has*occurred. S01117139921
378400210712     C********** PBRF      IFEQ *BLANKS                    B*2      S01117139921
378500210712     C********** PMPOBR    ANDNE*BLANKS                    **2      S01117139921
378600210712     C**********           MOVE '883'     ERCD,S           **2      S01117139921
378700210712     C**********           ADD  1         S                **2      S01117139921
378800210712     C**********           MOVE '1'       *IN31                     LN0787139921
378900210712     C**********           END                             E*2      S01117139921
379000210712     C*                                                                   S01117
379100210712     C                     ELSE                            X1             S01117
379200210712     C/COPY WNCPYSRC,SD2410C092
379300210712     C*                                                                   S01117
379400210712     C           CLE033    IFEQ 'Y'                        B*2            CLE033
379500210712     C           PMPSTM    ANDEQ09                                        CLE033
379600210712     C*                                                                   CLE033
379700210712     C** No processing for condition, only on ELSE.                       CLE033
379800210712     C*                                                                   CLE033
379900210712     C                     ELSE                                           CLE033
380000210712     C*                                                                   CLE033
380100210712     C** SETTLEMENT BRANCH MANDATORY WITH SETTLEMENT METHOD 05.           S01117
380200210712     C           PMPOBR    IFEQ *BLANKS                    B*2            S01117
380300210712     C                     MOVE '882'     ERCD,S           **2            S01117
380400210712     C                     ADD  1         S                **2            S01117
380500210712     C                     MOVE '1'       *IN31                           LN0787
380600210712     C*                                                                   S01117
380700210712     C                     ELSE                            X*2            S01117
380800210712     C*                                                                   S01117
380900210712     C** VALIDATE SETTLEMENT BRANCH                                       S01117
381000210712     C                     MOVE PMPOBR    @OBR    3        **2            S01117
381100210712     C                     EXSR CHKBR                      **2            S01117
381200210712     C*                                                                   S01117
381300210712     C           @RTCD     IFEQ '*NOSEL '                  B**3           S01117
381400210712     C                     MOVE '864'     ERCD,S           ***3           S01117
381500210712     C                     ADD  1         S                ***3           S01117
381600210712     C                     MOVE '1'       *IN31                           LN0787
381700210712     C                     END                             E**3           S01117
381800210712     C*                                                                   S01117
381900210712     C           @RTCD     IFNE *BLANKS                    B**3           S01117
382000210712     C                     MOVE '881'     ERCD,S           ***3           S01117
382100210712     C                     ADD  1         S                ***3           S01117
382200210712     C                     MOVE '1'       *IN31                           LN0787
382300210712     C                     ELSE                            X**3           S01117
382400210712     C                     MOVE @DSNB     PMPOBR           ***3           S01117
382500210712     C                     END                             E**3           S01117
382600210712     C                     END                             E*2            S01117
382700210712     C                     END                             E1             S01117
382800210712     C*                                                                   S01117
382900210712     C                     END                                            S01117
383000210712     C*                                                                   S01117
383100210712     C                     ENDIF                                          CLE033
383200210712     C*                                                                   CLE033
383300210712     C*                                                                   S01117
383400210712     C*
383500210712     C** OUR NOSTRO
383600210712     C** ----------
383700210712     C                     MOVE PMPONS    NOSTRO
383800210712     C                     MOVE *BLANKS   PNOST   6
383900210712     C                     MOVE '0'       *IN69
384000210712     C/COPY WNCPYSRC,SD2410C027
384100210712     C*
384200210712     C** MUST BE BLANK IF SETTLEMENT TYPE IS 00,04 OR 06
384300210712     C           PMPSTM    IFEQ 00                         B1
384400210712     C           PMPSTM    OREQ 04                         *1
384500210712     C           PMPSTM    OREQ 06                         *1
384600210712     C           PMPONS    IFNE *BLANK                     B*2
384700210712     C                     MOVE '937'     ERCD,S           **2
384800210712     C                     ADD  1         S                **2
384900210712     C                     MOVE '1'       *IN31                           LN0787
385000210712     C                     END                             E*2
385100210712     C                     END                             E1
385200210712     C/COPY WNCPYSRC,SD2410C028
385300210712     C*
385400210712     C** IF SETL TYPE IS 01,02,07,08 OR 12 MUST BE A 2 DIGIT NUMBER
385500210712     C** AND IDENTIFY A LIVE RECORD ON THE NOSTRO TABLE SDNOSTPD
385600210712     C           PMPSTM    IFEQ 01                         B1
385700210712     C           PMPSTM    OREQ 02                         *1
385800210712     C           PMPSTM    OREQ 07                         *1
385900210712     C           PMPSTM    OREQ 08                         *1
386000210712     C           PMPSTM    OREQ 12                         *1
386100210712     C/COPY WNCPYSRC,SD2410C029
386200210712     C                     TESTN          NOST02     60    *1
386300210712     C                     MOVEANOST02    @QM                             108517
386400210712     C           '?'       LOKUP@QM                      62               108517
386500210712     C           *IN60     IFNE '1'                        B*2
386600210712     C           *IN62     ANDEQ*OFF                                      108517
386700210712     C           NOSTXX    ORNE *BLANKS                    **2
386800210712     C                     MOVE '938'     ERCD,S           **2
386900210712     C                     ADD  1         S                **2
387000210712     C                     MOVE '1'       *IN31                           LN0787
387100210712     C                     MOVE '1'       *IN69            **2            108752
387200210712     C                     ELSE                            X*2
387300210712     C                     MOVEL'*KEY   ' OPTN             **2
387400210712     C***********          MOVE PMPCCY    @CYCD            **2            CEU003
387500210712     C                     MOVE WPECY     @CYCD                           CEU003
387600210712     C                     MOVE NOST02    @NONB            **2
387700210712     C/COPY WNCPYSRC,SD2410C038
387800210712     C                     EXSR CHKNO                      **2
387900210712     C           RTCD      IFNE *BLANKS                    B**3
388000210712     C           RTCD      ANDNE'*NOSEL '                                 108517
388100210712     C                     MOVE '938'     ERCD,S           ***3
388200210712     C                     ADD  1         S                ***3
388300210712     C                     MOVE '1'       *IN31                           LN0787
388400210712     C                     MOVE '1'       *IN69            **2            108752
388500210712      *
388600210712     C                     ELSE                            ***3
388700210712      *
388800210712     C           RTCD      IFEQ '*NOSEL'                                  108517
388900210712     C                     MOVE '867'     ERCD,S                          108517
389000210712     C                     ADD  1         S                               108517
389100210712     C                     MOVE *ON       *IN30                           108517
389200210712     C                     ELSE                                           108517
389300210712      *                                                                   CDL008
389400210712      ** Send error message if CLS Dummy Nostro is not Y                  CDL008
389500210712      *                                                                   CDL008
389600210712     C           CDL008    IFEQ 'Y'                                       CDL008
389700210712      *                                                                   CDL008
389800210712     C           PMTTYP    IFEQ 'CL'                                      CDL008
389900210712     C           A7CLSD    ANDNE'Y'                                       CDL008
390000210712     C                     MOVE '302'     ERCD,S                          CDL008
390100210712     C                     ADD  1         S                               CDL008
390200210712     C                     MOVE *ON       *IN31                           CDL008
390300210712     C                     ENDIF                                          CDL008
390400210712      *                                                                   CDL008
390500210712     C           PMTTYP    IFNE 'CL'                                      CDL008
390600210712     C           A7CLSD    ANDEQ'Y'                                       CDL008
390700210712     C                     MOVE '306'     ERCD,S                          CDL008
390800210712     C                     ADD  1         S                               CDL008
390900210712     C                     MOVE *ON       *IN31                           CDL008
391000210712     C                     ENDIF                                          CDL008
391100210712      *                                                                   CDL008
391200210712     C                     ENDIF                                          CDL008
391300210712      *                                                                   CDL008
391400210712     C                     MOVE A7CUST    PNOST            ***3
391500210712     C                     MOVELA7NONB    PMPONS           ***3           108517
391600210712     C                     MOVEL*BLANK    ACID             ***3           LN0830
391700210712     C                     MOVELA7CUST    ACID             ***3
391800210712     C***********          MOVE PMPCCY    CUCD             ***3           CEU003
391900210712     C                     MOVE WPECY     CUCD                            CEU003
392000210712     C                     MOVE A7ACCD    ACCD             ***3
392100210712     C                     MOVE A7ACSN    ACSQA            ***3
392200210712     C                     MOVE A7BRCD    BRCD             ***3           S01117
392300210712     C/COPY WNCPYSRC,SD2410C075
392400210712     C                     ENDIF                                          108517
392500210712      *                                                                   S01117
392600210712      ** SET UP SETTLEMENT BRANCH FOR FILE UPDATES BY OTHER PGMS          S01117
392700210712      ***SET*ON*PAY*BRANCH*FLAG*TO*SIGNIFY*PROGRAM*HAS*SET          S01117139921
392800210712      ***THIS*FIELD*UP                                              S01117139921
392900210712     C           PMPOBR    IFEQ *BLANKS                    B*2            S01117
393000210712     C                     MOVE A7BRCD    PMPOBR           **2            S01117
393100210712     C**********           MOVE 'Y'       PBRF             **2      S01117139921
393200210712     C                     END                             E*2            S01117
393300210712      *
393400210712     C                     EXSR CHKAC                      ***3
393500210712      *
393600210712     C           RTCD      IFNE *BLANKS                    B***4
393700210712     C           RECI      ORNE 'D'                        B***4          E24104
393800210712     C                     MOVE '938'     ERCD,S           ****4          108195
393900210712     C                     ADD  1         S                ****4          108195
394000210712     C                     MOVE '1'       *IN31            ****4          108195
394100210712     C                     MOVE '1'       *IN69            ****4
394200210712     C*                                                                   S01117
394300210712     C                     ELSE                            X***4          S01117
394400210712      *                                                                   S01408
394500210712      /COPY WNCPYSRC,SD2410CCP8                                           S01408
394600210712      *                                                                   S01408
394700210712     C*                                                                   S01117
394800210712     C**   IF MULTIBRANCH FLAG OFF NOSTRO MUST EQUAL SINGLE BRANCH        S01117
394900210712     C** (ERROR SHOULDNT HAPPEN UNLESS BANK SWITCHES OFF M/B INCORRECTY)  S01117
395000210712     C           @MBIN     IFEQ 'N'                        B****5         S01117
395100210712     C                     EXSR CHKBK                      *****5         S01117
395200210712     C*                                                                   S01117
395300210712     C           BJSBRC    IFNE A7BRCD                     B*****6        S01117
395400210712     C*********************MOVE '889'     ERCD,S           ******6  S01117LN0785
395500210712     C                     MOVE '501'     ERCD,S           ******6        LN0785
395600210712     C                     ADD  1         S                ******6        S01117
395700210712     C                     MOVE '1'       *IN31                           LN0787
395800210712     C                     MOVE '1'       *IN69            **2            108752
395900210712     C                     END                             E*****6        S01117
396000210712     C                     END                             E****5         S01117
396100210712     C*                                                                   S01117
396200210712     C** RETRIEVE BRANCH INTERNAL CUSTOMER NUMBER ASSOCIATED WITH         S01117
396300210712     C** NOSTRO BRANCH FOR VALIDATION LATER.                              S01117
396400210712     C                     MOVE A7BRCD    @OBR             ****4          S01117
396500210712     C                     EXSR CHKBR                      ****4          S01117
396600210712     C*                                                                   S01117
396700210712     C                     END                             ****4
396800210712     C                     END                             E**3
396900210712     C                     END                             E*2
397000210712     C                     END                             E1
397100210712     C*
397200210712     C***IF*SETL*TYPE*IS*03*MUST*BE*CONTAIN*A*SIX*DIGIT*NUMBER*********   E21702
397300210712     C***WHICH*IDENTIFIES*A*LIVE*CUSTOMER*RECORD*ON*FILE*SDCUSTPD******   E21702
397400210712     C** IF SETTLEMENT TYPE IS 03, 'OUR NOSTRO' MUST EITHER BE BLANK OR   E21702
397500210712     C** CONTAIN A SIX DIGIT DEAL NUMBER (TO COMPENSATE AGAINST).         E21702
397600210712     C           PMPSTM    IFEQ 03                         B1
397700210712     C           NOSTRO    ANDNE*BLANK                     B1             E21702
397800210712     C                     TESTN          NOST06     60    *1
397900210712     C           *IN60     IFNE '1'                        B*2
398000210712     C           NOSTYY    ORNE *BLANK                     **2
398100210712     C                     MOVE '939'     ERCD,S           **2
398200210712     C                     ADD  1         S                **2
398300210712     C                     MOVE '1'       *IN31                           LN0787
398400210712     C**********           ELSE                            X*2            E21702
398500210712     C**********           MOVE *BLANKS   CHKFLD           **2            E21702
398600210712     C**********           MOVELNOST06    CHKFLD           **2            E21702
398700210712     C**********           MOVE 'N'       @CPNA            **2      S01117E21702
398800210712     C**********           EXSR CHKFL                                     E21702
398900210712     C********** RESULT    IFNE 'A'                        B**3           E21702
399000210712     C**********           MOVE '939'     ERCD,S           ***3           E21702
399100210712     C**********           ADD  1         S                ***3           E21702
399200210712     C**********           ELSE                            X**3           E21702
399300210712     C**********           MOVE BBCUST    PNOST            ***3           E21702
399400210712     C**********           END                             E**3           E21702
399500210712     C                     END                             E*2
399600210712     C                     END                             E1
399700210712     C*
399800210712     C** IF SETLEMENT TYPE IS 05 MUST IDENTIFY A LIVE RECORD ON ACCNTAB
399900210712     C** (IN COMBINATION WITH PAYMENT CURRENCY)
400000210712     C           PMPSTM    IFEQ 05                         B1
400100210712     C           NOSTSQ    IFEQ *BLANK                     B*2
400200210712     C           NOSTSQ    OREQ '00'                       **2
400300210712     C                     MOVE '01'      NOSTSQ           **2
400400210712     C                     END                             E*2
400500210712     C**********           TESTN          NOST06     60    *1                                 CSD027
400600210712     C***60*****           TESTN          NOSTAC     60    *1                                 CSD027
400700210712     C                     TESTN          NOSTAC     60    *1                                 CSD027
400800210712     C   60                TESTN          NOSTSQ     60    *1
400900210712     C           *IN60     IFNE '1'                        B*2
401000210712     C                     MOVE '940'     ERCD,S           **2
401100210712     C                     ADD  1         S                **2
401200210712     C                     MOVE '1'       *IN31                           LN0787
401300210712     C                     MOVE '1'       *IN69            **2            108752
401400210712     C                     ELSE                            X*2
401500210712     C                     MOVEL*BLANK    ACID             **2            LN0830
401600210712     C                     MOVELNOST06    ACID             **2
401700210712     C***********          MOVE PMPCCY    CUCD             **2            CEU003
401800210712     C                     MOVE WPECY     CUCD                            CEU003
401900210712     C                     MOVE NOSTSQ    ACSQA            **2
402000210712     C                     MOVE NOSTAC    ACCD             **2
402100210712      *
402200210712      * Setup default branch for Pay method 05 if MBIN=N.                 E83
402300210712     C           @MBIN     IFEQ 'N'                        B**3           E83
402400210712     C                     EXSR CHKBK                      ***3           E83
402500210712     C                     MOVE BJSBRC    PMPOBR           ***3           E83
402600210712     C                     END                             E**3           E83
402700210712      *                                                                   E83
402800210712     C                     MOVE PMPOBR    BRCD             **2            S01117
402900210712      *                                                                   S01117
403000210712      ***SET*OFF*PAY*BRANCH*FLAG*TO*SIGNIFY*USER*HAS*SET            S01117139921
403100210712      ***THIS*FIELD*UP                                              S01117139921
403200210712     C**********           MOVE *BLANKS   PBRF             **2      S01117139921
403300210712     C/COPY WNCPYSRC,SD2410C086
403400210712      *                                                                   S01117
403500210712     C                     EXSR CHKAC                      **2
403600210712     C           RTCD      IFNE *BLANKS                    B**3
403700210712     C           TYPE      OREQ '*SHNAME'                  **3                                CSD027
403800210712     C           RECI      ORNE 'D'                        B**3           E24104
403900210712     C           ACST      OREQ 'C'                        B**3           056626
404000210712     C                     MOVE '940'     ERCD,S           ***3
404100210712     C                     ADD  1         S                ***3
404200210712     C                     MOVE '1'       *IN31                           LN0787
404300210712     C                     MOVE '1'       *IN69            **2            108752
404400210712     C                     ELSE                            X*3
404500210712      *                                                                   S01408
404600210712      /COPY WNCPYSRC,SD2410CCP9                                           S01408
404700210712      *                                                                   S01408
404800210712     C                     MOVE CNUM      PNOST            **3
404900210712     C                     MOVELNOSTRO    PMPONS           **3            066875
405000210712     C                     END                             E**3
405100210712     C/COPY WNCPYSRC,SD2410C087
405200210712     C                     END                             E*2
405300210712     C                     END                             E1
405400210712     C*
405500210712     C/COPY WNCPYSRC,SD2410C093
405600210712     C** IF SETL TYPE IS 14 NOSTRO  MUST CONTAIN A 10 DIGIT NUMBER
405700210712     C** WHICH IDENTIFIES A LIVE RECORD ON FILE ACCNTAB
405800210712     C           PMPSTM    IFEQ 14                         B1
405900210712     C                     TESTN          NOST10     60    *1
406000210712     C           *IN60     IFNE '1'                        B*2
406100210712     C           NOSTSQ    ORNE *BLANK                     **2
406200210712     C           WNOST1    ORNE *BLANKS                                                     AR853732
406300210712     C                     MOVE '941'     ERCD,S           **2
406400210712     C                     ADD  1         S                **2
406500210712     C                     MOVE '1'       *IN31                           LN0787
406600210712     C                     MOVE '1'       *IN69            **2            108752
406700210712     C                     ELSE                            X*2
406800210712     C                     MOVELNOST10    ACID
406900210712     C                     MOVE *BLANKS   CUCD
407000210712     C                     MOVE *BLANKS   ACSQA
407100210712     C                     MOVE *BLANKS   ACCD
407200210712     C                     MOVE *BLANKS   BRCD             **2            S01117
407300210712     C                     EXSR CHKAC                      **2
407400210712     C           RTCD      IFNE *BLANKS                    B*3
407500210712     C           RECI      ORNE 'D'                        B*3            E24104
407600210712     C           ACST      OREQ 'C'                                       060470
407700210712     C                     MOVE '941'     ERCD,S           **3
407800210712     C                     ADD  1         S                **3
407900210712     C                     MOVE '1'       *IN31                           LN0787
408000210712     C                     MOVE '1'       *IN69            **2            108752
408100210712     C                     ELSE                            X**3
408200210712      *                                                                   S01408
408300210712      /COPY WNCPYSRC,SD2410CP10                                           S01408
408400210712      *                                                                   S01408
408500210712     C*                                                                   E45796
408600210712     C** Ensure account is not blocked for Debit/Credit                   E45796
408700210712     C*                                                                   E45796
408800210712     C                     TESTB'2'       RETB           34DEBIT          E45796
408900210712     C                     TESTB'3'       RETB           35CREDIT         E45796
409000210712     C*                                                                   E45796
409100210712     C           *IN34     IFEQ '1'                                       E45796
409200210712     C           *IN35     OREQ '1'                                       E45796
409300210712     C                     MOVE '992'     ERCD,S                          E45796
409400210712     C                     ADD  1         S                               E45796
409500210712     C                     MOVE '1'       *IN31                           E45796
409600210712     C                     MOVE '1'       *IN69            **2            108752
409700210712     C                     END                                            E45796
409800210712     C*                                                                   S01408
409900210712     C/COPY WNCPYSRC,SD2410CP17                                           S01408
410000210712     C*                                                                   S01408
410100210712     C*                                                                   E45796
410200210712     C                     MOVE CNUM      PNOST            **3
410300210712      *                                                                   S01117
410400210712      ** SET UP SETTLEMENT BRANCH FOR FILE UPDATES BY OTHER PGMS          S01117
410500210712      ***SET*ON*PAY*BRANCH*FLAG*TO*SIGNIFY*PROGRAM*HAS*SET          S01117139921
410600210712      ***THIS*FIELD*UP                                              S01117139921
410700210712     C           PMPOBR    IFEQ *BLANKS                    B*2            S01117
410800210712     C                     MOVE BRCA      PMPOBR           **2            S01117
410900210712     C**********           MOVE 'Y'       PBRF             **2      S01117139921
411000210712     C                     END                             E*2            S01117
411100210712     C*
411200210712     C** IF SETL IS 14 AND NOSTRO IDENTIFIES A LIVE RECORD ON ACCNTAB
411300210712     C** PAYMENT CURRENCY MUST BE SAME AS CURRENCY OF ACCOUNT
411400210712     C***********PMPCCY    IFNE CCY                        B***4          CEU003
411500210712     C           WPECY     IFNE CCY                                       CEU003
411600210712     C           PMCPGM    ANDNE'SSI'                                     137488
411700210712     C           PMPCCY    ORNE CCY                                       137488
411800210712     C           PMCPGM    ANDEQ'SSI'                                     137488
411900210712     C                     MOVE '944'     ERCD,S           ****4
412000210712     C                     ADD  1         S                ****4
412100210712     C                     MOVE '1'       *IN31                           LN0787
412200210712     C                     MOVE '1'       *IN69            **2            108752
412300210712     C*                                                                   S01117
412400210712     C                     ELSE                            X***4          S01117
412500210712     C*                                                                   S01117
412600210712     C**   IF MULTIBRANCH FLAG OFF NOSTRO MUST EQUAL SINGLE BRANCH        S01117
412700210712     C           @MBIN     IFEQ 'N'                        B****5         S01117
412800210712     C                     EXSR CHKBK                      *****5         S01117
412900210712     C*                                                                   S01117
413000210712     C***********BRCA      IFNE A7BRCD                     B*****6 S01117 058132
413100210712     C           BRCA      IFNE BJSBRC                     B*****6        058132
413200210712     C                     MOVE '887'     ERCD,S           ******6        S01117
413300210712     C                     ADD  1         S                ******6        S01117
413400210712     C                     MOVE '1'       *IN31                           LN0787
413500210712     C                     MOVE '1'       *IN69            **2            108752
413600210712     C                     END                             E*****6        S01117
413700210712     C                     END                             E****5         S01117
413800210712     C*                                                                   S01117
413900210712     C                     END                             E***4
414000210712     C                     END                             E**3
414100210712     C                     END                             E*2
414200210712     C                     END                             E1
414300210712      *                                                                   191152
414400210712      ** If Settlement Currency is EURO (created for a sweep of the       191152
414500210712      ** 'In' Currency loan), check if pay settlement account is          191152
414600210712      ** also sweep into EURO, otherwise EURO is an invalid settlement    191152
414700210712      ** currency.                                                        191152
414800210712      *                                                                   191152
414900210712     C           CEU004    IFEQ 'Y'                                       191152
415000210712     C           PMRSCY    ANDEQBKEURO                                    191152
415100210712     C           PMPPAY    ANDEQ'Y'                                       191152
415200210712      *                                                                   191152
415300210712     C           S         IFGT 1                                         191152
415400210712     C           S         SUB  1         Y                               191152
415500210712     C                     ELSE                                           191152
415600210712     C                     Z-ADD1         Y                               191152
415700210712     C                     ENDIF                                          191152
415800210712     C           ERCD,Y    IFEQ '944'                                     191152
415900210712     C           ERCD,Y    OREQ '940'                                     191152
416000210712     C                     MOVE *BLANK    ERCD,Y                          191152
416100210712     C                     SUB  1         S                               191152
416200210712     C                     MOVE '0'       *IN31                           191152
416300210712     C                     MOVE '0'       *IN69                           191152
416400210712     C                     END                                            191152
416500210712      *                                                                   191152
416600210712     C                     MOVE PMPONS    NOSTRO                          191152
416700210712     C           PMPSTM    IFEQ 05                                        191152
416800210712     C                     MOVEL*BLANK    ACID                            191152
416900210712     C                     MOVELNOST06    ACID                            191152
417000210712     C                     MOVE WRECY     CUCD                            191152
417100210712     C                     MOVE NOSTSQ    ACSQA                           191152
417200210712     C                     MOVE NOSTAC    ACCD                            191152
417300210712     C                     MOVE PMPOBR    BRCD                            191152
417400210712     C                     EXSR CHKAC                                     191152
417500210712     C                     ENDIF                                          191152
417600210712      *                                                                   191152
417700210712     C           RTCD      IFNE *BLANKS                                   191152
417800210712     C                     MOVE *BLANKS   RTCD                            191152
417900210712     C                     MOVE '940'     ERCD,S                          191152
418000210712     C                     ADD  1         S                               191152
418100210712     C                     MOVE '1'       *IN31                           191152
418200210712     C                     ENDIF                                          191152
418300210712      *                                                                   191152
418400210712     C           PMPSTM    IFEQ 14                                        191152
418500210712     C                     MOVEL*BLANK    ACID                            191152
418600210712     C                     MOVELNOST10    ACID                            191152
418700210712     C                     MOVE WRECY     CUCD                            191152
418800210712     C                     MOVE *BLANKS   ACSQA                           191152
418900210712     C                     MOVE *BLANKS   ACCD                            191152
419000210712     C                     MOVE *BLANKS   BRCD                            191152
419100210712     C                     EXSR CHKAC                                     191152
419200210712     C                     ENDIF                                          191152
419300210712      *                                                                   191152
419400210712     C           RTCD      IFNE *BLANKS                                   191152
419500210712     C                     MOVE *BLANKS   RTCD                            191152
419600210712     C                     MOVE '944'     ERCD,S                          191152
419700210712     C                     ADD  1         S                               191152
419800210712     C                     MOVE '1'       *IN31                           191152
419900210712     C                     ENDIF                                          191152
420000210712      *                                                                   191152
420100210712     C                     ENDIF                                          191152
420200210712     C/COPY WNCPYSRC,SD2410C099
420300210712     C*
420400210712     C** IF SETL TYPE IS 01,02,05,07,08,12 OR 14 AND FIELD REFERS TO A
420500210712     C** RETAIL ACCOUNT THE DATE OF PAYMENT MUST NOT BE BEFORE THE DATE
420600210712     C** ACCOUNT OPENED(942)
420700210712     C*******    PMCPGM    IFEQ 'FXFX'                     B1             088364
420800210712     C*******    PMDTPY    ANDEQ*ZEROS                     *1             088364
420900210712     C*******              MOVE '1'       *IN69            *1             088364
421000210712     C*******              END                             E1             088364
421100210712     C           *IN69     IFEQ '0'                        B1
421200210712     C********   ATYP      ANDEQ'R'                        *1             BHF908
421300210712     C           RCVSTR    IFEQ '0'                                       052290
421400210712     C           PMCPGM    OREQ 'FXFX'                                                        178889
421500210712     C           RCVSTR    ANDEQ*BLANKS                                                       178889
421600210712     C           PMPSTM    IFEQ 01                         B*2
421700210712     C           PMPSTM    OREQ 02                         **2
421800210712     C           PMPSTM    OREQ 04                         **2            100757
421900210712     C           PMPSTM    OREQ 05                         **2
422000210712     C           PMPSTM    OREQ 07                         **2
422100210712     C           PMPSTM    OREQ 08                         **2
422200210712     C           PMPSTM    OREQ 12                         **2
422300210712     C           PMPSTM    OREQ 14                         **2
422400210712     C/COPY WNCPYSRC,SD2410C094
422500210712     C           PMDTPY    IFLT DACO                       B**3
422600210712     C           CEU003    IFNE 'Y'                                       135303
422700210712     C           PMACTC    OREQ 'I'                                       135303
422800210712     C           PMACTC    OREQ 'A'                                                           178889
422900210712     C                     MOVE '942'     ERCD,S           ***3
423000210712     C                     ADD  1         S                ***3
423100210712     C                     MOVE '1'       *IN31                           LN0787
423200210712     C/COPY WNCPYSRC,SD2410C070
423300210712     C                     ENDIF                                          135303
423400210712     C                     END                             E**3
423500210712     C                     END                             E*2
423600210712     C                     END                                            052290
423700210712     C                     END                             E1
423800210712     C*                                                                   E24039
423900210712     C** If RHS on settlement has been changed and deal is a loan         E24039
424000210712     C** (payments side is start side) then do the following back value   E24039
424100210712     C** period validation.                                               E24039
424200210712     C* NB For 'insert' , validation should never be bypassed.            110122
424300210712     C*                                                                   E24039
424400210712     C           *LOCK     IN   LDA                                       E24039
424500210712     C***********NOCHG1    IFEQ '0'                                 E24039035701
424600210712     C           NOCHG2    IFEQ '0'                                       035701
424700210712     C           RCVSTR    ANDEQ'0'                                       E24039
424800210712     C           RCVSTR    OREQ *BLANKS                                   E24039
424900210712     C           PMACTC    OREQ 'I'                                       110122
425000210712     C*
425100210712     C** IF SETL TYPE IS 01,02,05,07,08,12 OR 14
425200210712     C** THE DATE OF PAYMENT MUST NOT BE
425300210712     C** EARLIER THAN BACK-VALUE PERIOD(943)
425400210712     C*                                                                   CLE003
425500210712     C* IF DATE OF PAYMENT IS EARLIER THAN BACK VALUE PERIOD              CLE003
425600210712     C* ISSUE A WARNING MESSAGE (806) IF CLE003 IS ON                     CLE003
425700210712     C*                                                                   CLE003
425800210712     C           PMPPAY    IFNE 'Y'                                       E31589
425900210712     C*                                                                   E31589
426000210712     C           PMCPGM    IFEQ 'FXFX'                     B1
426100210712     C           PMDTPY    ANDEQ*ZEROS                     *1
426200210712     C                     MOVE '1'       *IN69            *1
426300210712     C                     END                             E1
426400210712     C           *IN69     IFEQ '0'                        B1
426500210712     C           PMPSTM    IFEQ 01                         B*2
426600210712     C           PMPSTM    OREQ 02                         **2
426700210712     C           PMPSTM    OREQ 04                         **2            100757
426800210712     C           PMPSTM    OREQ 05                         **2
426900210712     C           PMPSTM    OREQ 07                         **2
427000210712     C           PMPSTM    OREQ 08                         **2
427100210712     C           PMPSTM    OREQ 12                         **2
427200210712     C           PMPSTM    OREQ 14                         **2
427300210712     C/COPY WNCPYSRC,SD2410C095
427400210712     C           ATYP      IFEQ 'R'                        *1             BHF908
427500210712     C           PMRUND    SUB  PMBVPD    COMPDT  50       **2
427600210712     C           PMDTPY    IFLT COMPDT                     B**3
427700210712     C           CLE003    IFEQ 'Y'                                       CLE003
427800210712     C           COUNT1    IFEQ 1                                         CLE003
427900210712     C                     MOVE '806'     ERCD,S           **2            CLE003
428000210712     C                     ADD  1         S                **2            CLE003
428100210712     C                     ADD  1         COUNT1                          CLE003
428200210712     C                     MOVE '1'       *IN31            **2            CLE003
428300210712     C                     MOVE COUNT1    PMCMDP                          113832
428400210712     C                     ENDIF                                          CLE003
428500210712     C                     ELSE                                           CLE003
428600210712     C                     MOVE '943'     ERCD,S           ***3
428700210712     C                     ADD  1         S                ***3
428800210712     C                     MOVE '1'       *IN31                           LN0787
428900210712     C                     ENDIF                                          CLE003
429000210712     C                     END                             E**3
429100210712     C/COPY WNCPYSRC,SD2410C071
429200210712     C                     END                             E**3           BHF908
429300210712     C                     END                             E*2
429400210712     C                     END                             E1
429500210712     C                     END                                            E31589
429600210712     C*                                                                   E24039
429700210712     C                     END                                            E24039
429800210712     C                     OUT  LDA                                       E24039
429900210712     C***********          MOVE COUNT1    CNT1                      CLE003113832
430000210712     C*
430100210712     C** Defaulting for pay ordering customer/bank if both are blank.     E26903
430200210712     C** This will go onto DEALS and thence to SWIFT message.             E26903
430300210712     C*                                                                   E26903
430400210712     C           PMPSTM    IFEQ 01                                        E26903
430500210712     C           PMPSTM    OREQ 07                                        E26903
430600210712     C           PMPSTM    OREQ 08                                        E26903
430700210712     C*                                                                   E26903
430800210712     C***********PMPOBN    IFEQ *BLANKS                            E26903 E30756
430900210712     C***********PMPOCN    ANDEQ*BLANKS                            E26903 E30756
431000210712     C** Defaulting for pay ordering customer has to be done only if      093565
431100210712     C** both are blanks, if user blanks out PMPOCN and insert a bank     093565
431200210712     C** customer number in ordering bank AND overides Beneficiary with   093565
431300210712     C** a bank customer number, MT202 will be generated                  093565
431400210712     C           PMPOCN    IFEQ *BLANKS                                   E30756
431500210712     C           PMPOBN    ANDEQ*BLANKS                                   093565
431600210712     C*                                                                   E26903
431700210712     C** Find out what the counterparty is  bank/nonbank                  E26903
431800210712     C*                                                                   E26903
431900210712     C                     MOVE PMCSNM    CHKFLD                          E26903
432000210712     C                     EXSR CHKFL                                     E26903
432100210712     C***********RESULT    IFNE 'A'                                E26903 E30756
432200210712     C***********RESULT    ANDNE'B'                                E26903 E30756
432300210712     C***********          MOVE '872'     ERCD,S                   E26903 E30756
432400210712     C***********          ADD  1         S                        E26903 E30756
432500210712     C***********          ELSE                                    E26903 E30756
432600210712     C***********BANKNB    IFEQ 'B'                                E26903 E30756
432700210712     C***********          MOVELPMCSNM    PMPOBN                   E26903 E30756
432800210712     C***********          ELSE                                    E26903 E30756
432900210712     C***********BANKNB    IFEQ 'A'                                E26903 E30756
433000210712      *                                                                   134496
433100210712      ** Determine if Beneficiary is Bank of Non-bank                     134496
433200210712      *                                                                   134496
433300210712     C                     MOVEL*BLANKS   BFBNBB  1                       134496
433400210712     C                     MOVELPMBENN    CSTKEY                          134496
433500210712      *                                                                   134496
433600210712     C                     EXSR CUSGET                                    134496
433700210712     C           RTCD      IFEQ *BLANK                                    134496
433800210712     C                     MOVELBBBNBI    BFBNBB                          134496
433900210712     C                     ENDIF                                          134496
434000210712      *                                                                   134496
434100210712     C           BANKNB    IFEQ 'N'                                E26903 E30756
434200210712     C           BFBNBB    ANDNE'Y'                                       134496
434300210712     C                     MOVELPMCSNM    PMPOCN                          E26903
434400210712     C                     END                                            E26903
434500210712     C***********          END                                     E26903 E30756
434600210712     C*                                                                   E26903
434700210712     C                     END                                            E26903
434800210712     C*                                                                   E26903
434900210712     C                     END                                            E26903
435000210712     C*                                                                   221452
435100210712     C** No need to validate swift fields if Swift for Lending is not     221452
435200210712     C** on and settlement method is 09                                   221452
435300210712     C*                                                                   221452
435400210712     C           CLE033    IFEQ 'Y'                                       221452
435500210712     C           PMPSTM    ANDEQ09                                        221452
435600210712     C           BGSWCL    ANDNE'Y'                                       221452
435700210712     C                     GOTO PAYEND                                    221452
435800210712     C                     ENDIF                                          221452
435900210712     C*
436000210712     C** ORDERING CUSTOMER
436100210712     C** -----------------
436200210712     C/COPY WNCPYSRC,SD2410C004
436300210712     C                     MOVE *BLANKS   PAPOCN
436400210712     C           *IN38     CABEQ'1'       EVAL6            ERROR ON FIELD
436500210712     C/COPY WNCPYSRC,SD2410C005
436600210712     C*
436700210712     C** MUST BE A 6 DIGIT NUMBER
436800210712     C** OR A CUSTOMER SHORTNAME THAT IDENTIFIES A LIVE
436900210712     C** RECORD ON FILE SDCUSTPD
437000210712     C           PMPOCN    IFNE *BLANKS                    B1
437100210712     C                     MOVE *BLANKS   CHKFLD           *1             S01117
437200210712     C                     MOVE PMPOCN    CHKFLD           *1
437300210712     C                     MOVE 'N'       @CPNA            *1             S01117
437400210712     C                     EXSR CHKFL                      *1
437500210712     C*                                                                   S01117
437600210712     C           RTCD      IFEQ '*NOSEL '                  B*2            S01117
437700210712     C                     MOVE '872'     ERCD,S           **2            S01117
437800210712     C                     ADD  1         S                **2            S01117
437900210712     C                     MOVE '1'       *IN31                           LN0787
438000210712     C                     END                             E*2            S01117
438100210712     C*                                                                   S01117
438200210712     C**  Check that ordering customer is not a bank                      E26903
438300210712     C*                                                                   E26903
438400210712     C           BANKNB    IFEQ 'B'                                       E26903
438500210712     C                     MOVE '804'     ERCD,S                          E26903
438600210712     C                     ADD  1         S                               E26903
438700210712     C                     GOTO EVAL6                                     E26903
438800210712     C                     END                                            E26903
438900210712     C**                                                                  E26903
439000210712     C           RESULT    IFNE 'A'                        B*2
439100210712     C           RESULT    ANDNE'B'                        **2
439200210712     C                     MOVE '946'     ERCD,S           **2
439300210712     C                     ADD  1         S                **2
439400210712     C                     MOVE '1'       *IN31                           LN0787
439500210712     C                     ELSE                            X*2
439600210712     C* ORDERING CUSTOMER, PAYMENT SIDE MAY BE BANK                       S01297
439700210712     C********** BANKNB    IFEQ 'B'                        B**3     S01117S01297
439800210712     C**********           MOVE '880'     ERCD,S           ***3     S01117S01297
439900210712     C**********           ADD  1         S                ***3     S01117S01297
440000210712     C**********           END                             E**3     S01117S01297
440100210712     C                     MOVELBBCUST    PAPOCN           **2
440200210712     C*                                                                   S01117
440300210712     C**   CHECK IF '?' ENTERED, IF SO MOVE VALUE RETRIEVED               S01117
440400210712     C**   INTO SCREEN FIELD.                                             S01117
440500210712     C*                                                                   S01117
440600210712     C                     MOVELPMPOCN    @TSTQ   1        **2            S01117
440700210712     C           @TSTQ     IFEQ '?'                        B**3           S01117
440800210712     C                     MOVELBBCSSN    PMPOCN           ***3           S01117
440900210712     C                     END                             E**3           S01117
441000210712     C                     MOVE BANKNB    CPPOCN  1        **2
441100210712     C/COPY WNCPYSRC,SD2410C006
441200210712     C                     END                             E*2
441300210712     C                     END                             E1
441400210712     C           EVAL6     TAG
441500210712     C** ENTRY MANDATORY IF BENEFICIARY IS A NON-BANK
441600210712     C** ***VALIDATION DONE AFTER VALIDATION OF BENEFICIARY
441700210712     C*
441800210712     C** ORDERING BANK
441900210712     C** -------------
442000210712     C                     MOVE *BLANKS   PAPOBN
442100210712     C           *IN40     CABEQ'1'       EVAL7            ERROR ON FIELD
442200210712     C/COPY WNCPYSRC,SD2410C007
442300210712     C*
442400210712     C** MUST BE A 6 DIGIT NUMBER
442500210712     C** OR A CUSTOMER SHORTNAME THAT IDENTIFIES A LIVE
442600210712     C** RECORD ON FILE SDCUSTPD
442700210712     C           PMPOBN    IFNE *BLANKS                    B1
442800210712     C                     MOVE *BLANKS   CHKFLD           *1             S01117
442900210712     C                     MOVE PMPOBN    CHKFLD           *1
443000210712     C                     MOVE 'N'       @CPNA            *1             S01117
443100210712     C                     EXSR CHKFL                      *1
443200210712     C*                                                                   S01117
443300210712     C           RTCD      IFEQ '*NOSEL '                  B*2            S01117
443400210712     C                     MOVE '873'     ERCD,S           **2            S01117
443500210712     C                     ADD  1         S                **2            S01117
443600210712     C                     MOVE '1'       *IN31                           LN0787
443700210712     C                     END                             E*2            S01117
443800210712     C*                                                                   S01117
443900210712     C           RESULT    IFNE 'A'                        B*2
444000210712     C           RESULT    ANDNE'B'                        **2
444100210712     C                     MOVE '947'     ERCD,S           **2
444200210712     C                     ADD  1         S                **2
444300210712     C                     MOVE '1'       *IN31                           LN0787
444400210712     C                     ELSE                            X*2
444500210712     C           BANKNB    IFEQ 'B'                        B**3
444600210712     C                     MOVE BBCUST    PAPOBN           ***3           S01117
444700210712     C                     ELSE                            X**3
444800210712     C                     MOVE '948'     ERCD,S           ***3
444900210712     C                     ADD  1         S                ***3
445000210712     C                     MOVE '1'       *IN31                           LN0787
445100210712     C                     END                             E**3
445200210712     C*                                                                   S01117
445300210712     C**   CHECK IF '?' ENTERED, IF SO MOVE VALUE RETRIEVED               S01117
445400210712     C**   INTO SCREEN FIELD.                                             S01117
445500210712     C*                                                                   S01117
445600210712     C                     MOVELPMPOBN    @TSTQ   1        **2            S01117
445700210712     C           @TSTQ     IFEQ '?'                        B**3           S01117
445800210712     C                     MOVELBBCSSN    PMPOBN           ***3           S01117
445900210712     C                     END                             E**3           S01117
446000210712     C                     END                             E*2
446100210712     C/COPY WNCPYSRC,SD2410C008
446200210712     C                     END                             E1
446300210712     C*
446400210712     C** MUST NOT BE THE SAME AS ORDERING CUSTOMER
446500210712     C           PAPOBN    IFNE *BLANK                     B1
446600210712     C           PAPOBN    ANDNE*ZEROS                     B1
446700210712     C           PAPOBN    IFEQ PAPOCN                     B*2
446800210712     C                     MOVE '949'     ERCD,S           **2
446900210712     C                     ADD  1         S                **2
447000210712     C                     MOVE '1'       *IN31                           LN0787
447100210712     C                     END                             E*2
447200210712     C                     END                             E1
447300210712     C*
447400210712     C** FOR SETTL. TYPE 01,07 OR 08 ORDERING BANK OR ORDERING CUSTOMER
447500210712     C** MUST BE ENTERED  IF BENEFICIARY IS A NON-BANK
447600210712     C** ***VALIDATION DONE AFTER VALIDATION OF BENEFICIARY
447700210712     C           EVAL7     TAG
447800210712     C*
447900210712     C** RECEIVER'S CORRESPONDANT
448000210712     C** ------------------------
448100210712     C                     MOVE *BLANKS   PARCRN
448200210712     C           *IN41     CABEQ'1'       EVAL9            ERROR ON FIELD
448300210712     C/COPY WNCPYSRC,SD2410C009
448400210712     C*
448500210712     C** MUST BE A 6 DIGIT NUMBER
448600210712     C** OR A CUSTOMER SHORTNAME THAT IDENTIFIES A LIVE
448700210712     C** RECORD ON FILE SDCUSTPD OR A COUNTERPARTY NOSTRO CODE THAT
448800210712     C** IDENTIFIES A LIVE RECORD ON SDCNSTPD
448900210712     C                     MOVE 'Y'       CPRCRN  1
449000210712     C           PMRCRN    IFNE *BLANK                     B1
449100210712     C                     MOVE *BLANKS   CHKFLD           *1             S01117
449200210712     C                     MOVE PMRCRN    CHKFLD           *1
449300210712     C                     MOVE 'Y'       @CPNA            *1             S01117
449400210712     C                     EXSR CHKFL                      *1
449500210712     C*                                                                   S01117
449600210712     C           RTCD      IFEQ '*NOSEL '                  B*2            S01117
449700210712     C                     MOVE '874'     ERCD,S           **2            S01117
449800210712     C                     ADD  1         S                **2            S01117
449900210712     C                     MOVE '1'       *IN31                           LN0787
450000210712     C                     END                             E*2            S01117
450100210712     C*                                                                   S01117
450200210712     C           RESULT    IFEQ 'E'                        B*2
450300210712     C                     MOVE '957'     ERCD,S           **2
450400210712     C                     ADD  1         S                **2
450500210712     C                     MOVE '1'       *IN31                           LN0787
450600210712     C                     ELSE                            X*2
450700210712     C                     MOVELPMRCRN    @TSTQ            **2            S01117
450800210712     C           RESULT    IFEQ 'A'                        B**3
450900210712     C           RESULT    OREQ 'B'                        ***3
451000210712     C           BANKNB    IFEQ 'B'                        B***4
451100210712     C                     MOVELBBCUST    PARCRN           ****4
451200210712     C                     MOVE 'N'       CPRCRN           ****4
451300210712     C                     ELSE                            X***4
451400210712     C                     MOVE '958'     ERCD,S           ****4
451500210712     C                     ADD  1         S                ****4
451600210712     C                     MOVE '1'       *IN31                           LN0787
451700210712     C                     END                             E***4
451800210712     C*                                                                   S01117
451900210712     C**   CHECK IF '?' ENTERED, IF SO MOVE VALUE RETRIEVED               S01117
452000210712     C**   INTO SCREEN FIELD.                                             S01117
452100210712     C*                                                                   S01117
452200210712     C           @TSTQ     IFEQ '?'                        B***4          S01117
452300210712     C                     MOVELBBCSSN    PMRCRN           ****4          S01117
452400210712     C                     END                             E***4          S01117
452500210712     C                     ELSE                            X**3
452600210712     C                     MOVE *BLANKS   PARCRN           ***3           S01117
452700210712     C                     MOVELAWCPNC    PARCRN           ***3
452800210712     C*                                                                   S01117
452900210712     C**   CHECK IF '?' ENTERED, IF SO MOVE VALUE RETRIEVED               S01117
453000210712     C**   INTO SCREEN FIELD.                                             S01117
453100210712     C*                                                                   S01117
453200210712     C           @TSTQ     IFEQ '?'                        B****5         S01117
453300210712     C                     MOVE *BLANKS   PMRCRN           *****5         S01117
453400210712     C                     MOVELAWCPNC    PMRCRN           *****5
453500210712     C                     END                             E****5         S01117
453600210712     C                     END                             E**3
453700210712     C                     END                             E*2
453800210712     C                     END                             E1
453900210712     C/COPY WNCPYSRC,SD2410C010
454000210712     C           EVAL9     TAG
454100210712     C*
454200210712     C** RECEIVER'S CORRESPONDANT A/C LINE
454300210712     C** ---------------------------------
454400210712     C           PMRCRA    IFNE *BLANK                     B1
454500210712     C*
454600210712     C** ENTRY IS ONLY ALLOWED IF ENTRY HAS BEEN MADE IN REC. CORR.
454700210712     C           PMRCRN    IFEQ *BLANK                     B*2
454800210712     C                     MOVE '899'     ERCD,S           **2
454900210712     C                     ADD  1         S                **2
455000210712     C                     MOVE '1'       *IN31                           LN0787
455100210712     C                     END                             E*2
455200210712     C/COPY WNCPYSRC,SD2410C072
455300210712     C*
455400210712     C** FIRST TWO CHARACTERS MAY NOT BE '//'
455500210712     C                     MOVELPMRCRA    PMRCR2  2        *1
455600210712     C                     MOVE PMRCRA    PMXIBA           *1             060036
455700210712     C           PMRCR2    IFEQ '//'                       B*2
455800210712     C                     MOVE '960'     ERCD,S           **2
455900210712     C                     ADD  1         S                **2
456000210712     C                     MOVE '1'       *IN31                           LN0787
456100210712     C                     END                             E*2
456200210712     C/COPY WNCPYSRC,SD2410C073
456300210712     C*                                                                   060036
456400210712     C** If 1st & 3rd character are '/',                                  060036
456500210712     C** then 2nd character must be 'C' or 'D'.                           060036
456600210712     C*                                                                   060036
456700210712     C           PMXIB1    IFEQ '/'                        B*2            060036
456800210712     C           PMXIBE    ANDEQ'/'                        **2            060036
456900210712     C           PMXIB2    IFNE 'C'                        B**3           060036
457000210712     C           PMXIB2    ANDNE'D'                        ***3           060036
457100210712     C                     MOVE '201'     ERCD,S           ***3           060036
457200210712     C                     ADD  1         S                ***3           060036
457300210712     C                     MOVE '1'       *IN31            ***3           060036
457400210712     C                     END                             E**3           060036
457500210712     C                     END                             E*2            060036
457600210712     C                     END                             E1
457700210712     C*
457800210712     C** INTERMEDIARY BANK
457900210712     C** -----------------
458000210712     C                     MOVE 'Y'       CPPIBN  1
458100210712     C                     MOVE *BLANKS   PAPIBN
458200210712     C           *IN44     CABEQ'1'       EVAL10           ERROR ON FIELD
458300210712     C/COPY WNCPYSRC,SD2410C011
458400210712     C*
458500210712     C** MUST BE A 6 DIGIT NUMBER
458600210712     C** OR A CUSTOMER SHORTNAME THAT IDENTIFIES A LIVE
458700210712     C** RECORD ON FILE SDCUSTPD OR A COUNTERPARTY NOSTRO CODE THAT
458800210712     C** IDENTIFIES A LIVE RECORD ON SDCNSTPD
458900210712     C*
459000210712     C                     MOVE *BLANK    INPHON 12
459100210712     C                     MOVE *BLANK    INTELX 12
459200210712     C           PMPIBN    IFNE *BLANK                     B1
459300210712     C                     MOVE *BLANKS   CHKFLD           *1             S01117
459400210712     C                     MOVE PMPIBN    CHKFLD           *1
459500210712     C                     MOVE 'Y'       @CPNA            *1             S01117
459600210712     C           PMPSTM    IFEQ 07                         B*2            BHF810
459700210712     C***********PMPSTM    OREQ 08                         **2      BHF810E26771
459800210712     C                     MOVE 'N'       @CPNA            **2            BHF810
459900210712     C                     END                             E*2            BHF810
460000210712     C                     EXSR CHKFL                      *1
460100210712     C*                                                                   S01117
460200210712     C           RTCD      IFEQ '*NOSEL '                  B*2            S01117
460300210712     C                     MOVE '875'     ERCD,S           **2            S01117
460400210712     C                     ADD  1         S                **2            S01117
460500210712     C                     MOVE '1'       *IN31                           LN0787
460600210712     C                     END                             E*2            S01117
460700210712     C*                                                                   S01117
460800210712     C           RESULT    IFEQ 'E'                        B*2
460900210712     C                     MOVE '962'     ERCD,S           **2
461000210712     C                     ADD  1         S                **2
461100210712     C                     MOVE '1'       *IN31                           LN0787
461200210712     C                     ELSE                            X*2
461300210712     C                     MOVELPMPIBN    @TSTQ            **2            S01117
461400210712     C********** SWFT      IFEQ *BLANKS                    B**3           S01412
461500210712     C**********           MOVE '1'       *IN51            ***3           S01412
461600210712     C**********           END                             E**3           S01412
461700210712     C           RESULT    IFEQ 'A'                        B**3
461800210712     C           RESULT    OREQ 'B'                        ***3
461900210712     C                     MOVELBBCUST    PAPIBN
462000210712     C*                                                                   S01117
462100210712     C**   CHECK IF '?' ENTERED, IF SO MOVE VALUE RETRIEVED               S01117
462200210712     C**   INTO SCREEN FIELD.                                             S01117
462300210712     C*                                                                   S01117
462400210712     C           @TSTQ     IFEQ '?'                        B****5         S01117
462500210712     C                     MOVELBBCSSN    PMPIBN           *****5         S01117
462600210712     C                     END                             E****5         S01117
462700210712     C                     MOVE BBCTNB    INPHON           ***3
462800210712     C*********************MOVE BBTXA1    INTELX           ***3           S01117
462900210712     C                     MOVELBBTXA1    INTELX           ***3           S01117
463000210712     C           BANKNB    IFEQ 'B'                        B***4
463100210712     C**********           MOVE CNUM      NUPIBN  60       ****4                              CSD027
463200210712     C                     MOVE CNUM      NUPIBN  6        ****4                              CSD027
463300210712     C                     MOVE 'N'       CPPIBN           ****4
463400210712     C                     ELSE                            X***4
463500210712     C                     MOVE '963'     ERCD,S           ****4
463600210712     C                     ADD  1         S                ****4
463700210712     C                     MOVE '1'       *IN31                           LN0787
463800210712     C                     END                             E***4
463900210712     C                     ELSE                            X**3
464000210712     C                     MOVE *BLANKS   PAPIBN           ***3           S01117
464100210712     C                     MOVELAWCPNC    PAPIBN           ***3
464200210712     C*                                                                   S01117
464300210712     C**   CHECK IF '?' ENTERED, IF SO MOVE VALUE RETRIEVED               S01117
464400210712     C**   INTO SCREEN FIELD.                                             S01117
464500210712     C*                                                                   S01117
464600210712     C           @TSTQ     IFEQ '?'                        B***4          S01117
464700210712     C                     MOVE *BLANKS   PMPIBN           ****4          S01117
464800210712     C                     MOVELAWCPNC    PMPIBN           ****4
464900210712     C                     END                             E***4          S01117
465000210712     C                     END                             E**3
465100210712     C/COPY WNCPYSRC,SD2410C076
465200210712     C                     END                             E*2
465300210712     C                     END                             E1
465400210712     C/COPY WNCPYSRC,SD2410C058
465500210712     C           EVAL10    TAG
465600210712     C*
465700210712     C** INTERMEDIARY BANK A/C LINE
465800210712     C** --------------------------
465900210712     C           *IN46     CABEQ'1'       EVAL11           ERROR ON FIELD
466000210712     C/COPY WNCPYSRC,SD2410C062
466100210712     C*
466200210712     C           PMPIBA    IFNE *BLANK                                                        193584
466300210712     C*                                                                                       193584
466400210712     C** Entry is not allowed if the Nostro is a CLS Dummy Nostro.                            193584
466500210712     C                     MOVE PMPONS    NOSTRO                                              193584
466600210712     C                     MOVE WPECY     @CYCD                                               193584
466700210712     C                     MOVE NOST02    @NONB                                               193584
466800210712     C*                                                                                       193584
466900210712     C** Check the Nostro.                                                                    193584
467000210712     C                     EXSR CHKNO                                                         193584
467100210712      *                                                                                       193584
467200210712     C           A7CLSD    IFEQ 'Y'                                                           193584
467300210712     C                     MOVE '712'     ERCD,S                                              193584
467400210712     C                     ADD  1         S                                                   193584
467500210712     C                     MOVE '1'       *IN31                                               193584
467600210712     C                     GOTO EVAL11                     **2                                193584
467700210712     C                     END                                                                193584
467800210712     C                     END                                                                193584
467900210712      *                                                                                       193584
468000210712     C           PMPIBA    IFNE *BLANK                     B1
468100210712     C                     MOVE PMPIBA    PMXIBA           *1
468200210712     C*
468300210712     C** ENTRY IS ONLY ALLOWED IF ENTRY HAS BEEN MADE IN INTER. BANK
468400210712     C           PMPIBN    IFEQ *BLANK                     B*2
468500210712     C                     MOVE '965'     ERCD,S           **2
468600210712     C                     ADD  1         S                **2
468700210712     C                     MOVE '1'       *IN31                           LN0787
468800210712     C                     GOTO EVAL11                     **2
468900210712     C                     END                             E*2
469000210712     C/COPY WNCPYSRC,SD2410C059
469100210712      *****************************************************************   CSW096
469200210712      *                                                                   CSW096
469300210712      * Call Account Line Validation object                               CSW096
469400210712      *                                                                   CSW096
469500210712      * Set up parameters                                                 CSW096
469600210712      *                                                                   CSW096
469700210712     C                     MOVEL*BLANKS   W0RTN                           CSW096
469800210712     C                     CLEARI#PARM                                    CSW096
469900210712     C                     MOVEL'INBK '   I#VFLD                          CSW096
470000210712     C                     MOVEL'PAY'     I#PR                            CSW096
470100210712     C                     MOVEL'X'       I#PRTT                          CSW096
470200210712     C                     MOVELPMPIBN    I#PRTY                          CSW096
470300210712     C***********          MOVELPMPCCY    I#PCCY                   CSW096 CEU003
470400210712     C***********          MOVELPMRCCY    I#RCCY                   CSW096 CEU003
470500210712     C                     MOVELWPECY     I#PCCY                          CEU003
470600210712     C                     MOVELWRECY     I#RCCY                          CEU003
470700210712     C                     MOVELPMPIBA    I#ACLN                          CSW096
470800210712     C                     MOVELPMPSTM    I#PSTM                          CSW096
470900210712     C                     MOVELPMRSTM    I#RSTM                          CSW096
471000210712     C           PMPOCN    IFNE *BLANKS                                   CSW096
471100210712      *                                                                                       CSW203
471200210712      ** Set I#MTYP to "103" instead of "100" if CSW203 is installed                          CSW203
471300210712      *                                                                                       CSW203
471400210712     C           CSW203    IFEQ 'Y'                                                           CSW203
471500210712     C                     MOVEL'103'     I#MTYP                                              CSW203
471600210712     C                     ELSE                                                               CSW203
471700210712     C                     MOVEL'100'     I#MTYP                          CSW096
471800210712     C                     ENDIF                                                              CSW203
471900210712     C                     ELSE                                           CSW096
472000210712     C                     MOVEL'202'     I#MTYP                          CSW096
472100210712     C                     ENDIF                                          CSW096
472200210712      * Set up receive account information                                CSW096
472300210712     C           PMRONS    IFNE *BLANKS                                   CSW096
472400210712     C                     SELEC                                          CSW096
472500210712     C           PMROBR    WHNE *BLANKS                                   CSW096
472600210712     C           PMRONS    CAT  PMROBR    I#RCAC                          CSW096
472700210712     C           PMRONS    WHNE *BLANKS                                   CSW096
472800210712     C                     MOVELPMRONS    I#RCAC                          CSW096
472900210712     C                     ENDSL                                          CSW096
473000210712     C                     ENDIF                                          CSW096
473100210712      * Set up Pay account information                                    CSW096
473200210712     C           PMPONS    IFNE *BLANKS                                   CSW096
473300210712     C                     SELEC                                          CSW096
473400210712     C           PMPOBR    WHNE *BLANKS                                   CSW096
473500210712     C           PMPONS    CAT  PMPOBR    I#PYAC                          CSW096
473600210712     C           PMPONS    WHNE *BLANKS                                   CSW096
473700210712     C                     MOVELPMPONS    I#PYAC                          CSW096
473800210712     C                     ENDSL                                          CSW096
473900210712     C                     ENDIF                                          CSW096
474000210712      * If extra message and Rec Corr. then set 5354 field                CSW096
474100210712     C           PMRVNO    IFNE *BLANKS                                   CSW096
474200210712     C           PMRCRN    ANDNE*BLANKS                                   CSW096
474300210712     C                     MOVEL'Y'       I#5354                          CSW096
474400210712     C                     ENDIF                                          CSW096
474500210712      * Transaction Type                                                  CSW096
474600210712     C                     MOVELPMTTYP    I#TTYP                          CSW096
474700210712      *                                                                   CSW096
474800210712     C                     CLEARO#PARM                                    CSW096
474900210712     C                     CLEARE#PARM                                    CSW096
475000210712      *                                                                   CSW096
475100210712      * Send messages to correct calling process                          CSW096
475200210712      *                                                                   CSW096
475300210712     C                     SELEC                                          CSW096
475400210712     C           PMCPGM    WHEQ 'FXFX'                                    CSW096
475500210712     C                     MOVEL'ME9940'  E#CPGM                          CSW096
475600210712     C                     MOVEL'DL'      I#MMOD                          CSW096
475700210712     C           PMCPGM    WHEQ 'MMLD'                                    CSW096
475800210712     C                     MOVEL'ME9940'  E#CPGM                          CSW096
475900210712     C                     MOVEL'LE'      I#MMOD                          CSW096
476000210712     C           PMCPGM    WHEQ 'SSI '                                    CSW096
476100210712     C                     MOVEL'SD0401R' E#CPGM                          CSW096
476200210712     C                     OTHER                                          CSW096
476300210712     C                     MOVEL'ME9940'  E#CPGM                          CSW096
476400210712     C                     ENDSL                                          CSW096
476500210712     C                     MOVEL'MEC0016' E#MSGD                          CSW096
476600210712     C                     MOVEL'MEMSG'   E#MSGF                          CSW096
476700210712      *                                                                   CSW096
476800210712     C                     CALL 'ME9940'                                  CSW096
476900210712     C                     PARM           W0RTN   7                       CSW096
477000210712     C                     PARM           I#PARM           I Input Parms  CSW096
477100210712     C                     PARM           O#PARM           O Output Parms CSW096
477200210712     C                     PARM           E#PARM           E Error Inform CSW096
477300210712     C                     PARM           Z#PARM256        B User Defined CSW096
477400210712      *                                                                   CSW096
477500210712      * On return if errors copy into error array                         CSW096
477600210712      *                                                                   CSW096
477700210712     C                     MOVELO#ACLN    PMPIBA                          CSW096
477800210712      *                                                                   CSW096
477900210712     C           E#ERRM    IFNE *BLANKS                                   CSW096
478000210712      *                                                                   CSW096
478100210712     C           1         DO   E#INDX    Q#      50                      CSW096
478200210712     C                     MOVEAO#E,Q#    ERCD,S                          CSW096
478300210712     C                     ADD  1         S                               CSW096
478400210712     C                     ENDDO                                          CSW096
478500210712      *                                                                   CSW096
478600210712      * Mark pay side as ib error                                         CSW096
478700210712     C                     MOVEL*ON       *IN31                           CSW096
478800210712      *                                                                   CSW096
478900210712     C                     ENDIF                                          CSW096
479000210712      *                                                                   CSW096
479100210712     C                     ENDIF                                          CSW096
479200210712      *                                                                   CSW096
479300210712      *****************************************************************   CSW096
479400210712      ***********                                                         CSW096
479500210712     C***********                                                         CSW096
479600210712     C***FIRST*CHARACTER MUST BE '/'                                      CSW096
479700210712     C***********PMXIB1    IFNE '/'                        B*2            CSW096
479800210712     C***********          MOVE '966'     ERCD,S           **2            CSW096
479900210712     C***********          ADD  1         S                **2            CSW096
480000210712     C***********          MOVE '1'       *IN31                     LN0787CSW096
480100210712     C***********          END                             E*2            CSW096
480200210712     C***********                                                   060036CSW096
480300210712     C***If*1st*& 3rd character are '/',                            060036CSW096
480400210712     C***then*2nd character must be 'C' or 'D'.                     060036CSW096
480500210712     C***********                                                   060036CSW096
480600210712     C***********PMXIB1    IFEQ '/'                        B*2      060036CSW096
480700210712     C***********PMXIBE    ANDEQ'/'                        **2      060036CSW096
480800210712     C***********PMXIB2    IFNE 'C'                        B**3     060036CSW096
480900210712     C***********PMXIB2    ANDNE'D'                        ***3     060036CSW096
481000210712     C***********          MOVE '202'     ERCD,S           ***3     060036CSW096
481100210712     C***********          ADD  1         S                ***3     060036CSW096
481200210712     C***********          MOVE '1'       *IN31            ***3     060036CSW096
481300210712     C***********          END                             E**3     060036CSW096
481400210712     C***********          END                             E*2      060036CSW096
481500210712     C***********                                                         CSW096
481600210712     C***IF*SECOND CHARACTER IS ALSO '/'                                  CSW096
481700210712     C***MUST*BE*FOLLOWED BY CP, FW, BL or SW.                      CSW095CSW096
481800210712     C***MUST*BE*FOLLOWED*BY*CP,FW*OR*BL****************************CSW095CSW096
481900210712     C***********PMXIB2    IFEQ '/'                        B*2            CSW096
482000210712     C***********PMXIB4    IFNE '//CP'                     B**3           CSW096
482100210712     C***********PMXIB4    ANDNE'//FW'                     ***3           CSW096
482200210712     C***********PMXIB4    ANDNE'//BL'                     ***3           CSW096
482300210712     C***********PMXIB4    ANDNE'//SC'                     ***3     056873CSW096
482400210712     C***********PMXIB4    ANDNE'//CH'                     ***3     056847CSW096
482500210712     C***********PMXIB4    ANDNE'//SW'                     ***3     CSW095CSW096
482600210712     C***********          MOVE '967'     ERCD,S           ***3           CSW096
482700210712     C***********          ADD  1         S                ***3           CSW096
482800210712     C***********          MOVE '1'       *IN31                     LN0787CSW096
482900210712     C***********          END                             E**3           CSW096
483000210712     C***********          END                             E*2            CSW096
483100210712     C***********                                                         CSW096
483200210712     C***IF*FOLLOWED*BY*CP*OR*FW*CURRENCY*MUST*BE*USD***************056847CSW096
483300210712     C***If*followed by CP, CH, or FW currency must be USD          056847CSW096
483400210712     C***If*followed by SC currency must be GBP                     056847CSW096
483500210712     C***IF*FOLLOWED BY BL CURRENCY MUST BE DEM                           CSW096
483600210712     C***If*followed by SW currency must be CHF.                    CSW095CSW096
483700210712     C***********PMXIB4    IFEQ '//CP'                     B*2            CSW096
483800210712     C***********PMXIB4    OREQ '//FW'                     **2            CSW096
483900210712     C***********PMXIB4    OREQ '//BL'                     **2            CSW096
484000210712     C***********PMXIB4    OREQ '//SC'                     **2      056847CSW096
484100210712     C***********PMXIB4    OREQ '//CH'                     **2      056847CSW096
484200210712     C***********PMXIB4    OREQ '//SW'                     **2      CSW095CSW096
484300210712     C***********          MOVE PMPCCY    KEYY             **2            CSW096
484400210712     C***********          MOVE PMXIB4    KEYZ             **2            CSW096
484500210712     C***********          EXSR CHKCY                      **2            CSW096
484600210712     C***********RTCD      IFNE *BLANKS                    B*2            CSW096
484700210712     C***********          MOVE '968'     ERCD,S           ***3           CSW096
484800210712     C***********          ADD  1         S                ***3           CSW096
484900210712     C***********          MOVE '1'       *IN31                     LN0787CSW096
485000210712     C***********          GOTO EVAL11                     ***3           CSW096
485100210712     C***********          END                             E**3           CSW096
485200210712     C***********          END                             E*2            CSW096
485300210712     C***********                                                         CSW096
485400210712     C***IF*//CP*AND FOLLOWED BY BLANKS THEN DEFAULT THIS TO THE          CSW096
485500210712     C***CUSTOMERS CHIPS PARTICIPANT ONLY IF PMPIBA IS A CUSTOMER         CSW096
485600210712     C***********CPPIBN    IFEQ 'N'                        B*2            CSW096
485700210712     C***********PMXIB4    IFEQ '//CP'                     B**3           CSW096
485800210712     C***********PMXIB5    ANDEQ*BLANK                     ***3           CSW096
485900210712     C***********          Z-ADDBBCABA    PNXIB3           ***3     S01429CSW096
486000210712     C***********          Z-ADDBBABA2    PNXIB3           ***3     S01429CSW096
486100210712     C***********          MOVE PMXIBA    PMPIBA           ***3           CSW096
486200210712     C***********          END                             E**3           CSW096
486300210712     C***********          END                             E*2            CSW096
486400210712     C***********                                                         CSW096
486500210712     C***IF*//CP*IT*MUST*BE*FOLLOWED*BY*A*3*DIGIT*NUMBER.THE NUMBER*S01429CSW096
486600210712     C***IF*//CP*IT MUST BE FOLLOWED BY A 4 DIGIT NUMBER.THE NUMBER S01429CSW096
486700210712     C***MUST*BE*FOLLOWED BY BLANKS.                                      CSW096
486800210712     C***********PMXIB4    IFEQ '//CP'                     B*2            CSW096
486900210712     C***********          TESTN          PMXIB3     60    **2            CSW096
487000210712     C************IN60     IFNE '1'                        NOT NUMERIC    CSW096
487100210712     C***********PMXIBX    ORNE *BLANKS                    NOT FOLL. BY BLCSW096
487200210712     C***********          MOVE '969'     ERCD,S           ***3           CSW096
487300210712     C***********          ADD  1         S                ***3           CSW096
487400210712     C***********          MOVE '1'       *IN31                     LN0787CSW096
487500210712     C***********          END                             E**3           CSW096
487600210712     C***********          END                             E*2            CSW096
487700210712     C***********                                                         CSW096
487800210712     C***IF*//FW*IT MUST BE FOLLOWED BY A 9 DIGIT NUMBER.IF INTER. BANK   CSW096
487900210712     C***HAS*A*SWIFT ADDRESS //FW DOES NOT REQUIRE TO BE FOLLOWED BY      CSW096
488000210712     C***A*NUMBER                                                         CSW096
488100210712     C***********PMXIB4    IFEQ '//FW'                     B*2            CSW096
488200210712     C***********          TESTN          PMXIB9     60    **2            CSW096
488300210712     C************IN60     IFNE '1'                        NOT NUMERIC    CSW096
488400210712     C***********PMXIBZ    ORNE *BLANKS                    NOT FOLL. BY BLCSW096
488500210712     C***********          MOVE '0'       *IN60            ***3           CSW096
488600210712     C***********          END                             E**3           CSW096
488700210712     C***********CPPIBN    IFEQ 'N'                        B**3           CSW096
488800210712     C***********SWFT      ANDNE*BLANKS                    ***3           CSW096
488900210712     C***********PMXIB5    ANDEQ*BLANKS                    ***3           CSW096
489000210712     C***********          MOVE '1'       *IN60            ***3           CSW096
489100210712     C***********          END                             E**3           CSW096
489200210712     C***IF*SWIFT ADDRESS IS BLANK BUT THE FEDWIRE ACCOUNT NUMBER IS      CSW096
489300210712     C***PRESENT, SET UP THE FEDWIRE ACCOUNT                              CSW096
489400210712     C***********PMXIB5    IFEQ *BLANKS                    B**3           CSW096
489500210712     C***********SWFT      ANDEQ*BLANKS                    ***3           CSW096
489600210712     C***********FEDW      ANDNE*ZEROS                     ***3           CSW096
489700210712     C***********          Z-ADDFEDW      PMXIB7           ***3           CSW096
489800210712     C***********          END                             E**3           CSW096
489900210712     C***********SWFT      IFEQ *BLANKS                    B**3           CSW096
490000210712     C***********FEDW      ANDEQ*ZEROS                     ***3     S01117CSW096
490100210712     C***********PMXIB9    ANDEQ*BLANKS                    ***3     S01117CSW096
490200210712     C***********          MOVE '0'       *IN60            ***3           CSW096
490300210712     C***********          END                             E**3           CSW096
490400210712     C************IN60     IFNE '1'                        B**3           CSW096
490500210712     C***********          MOVE '969'     ERCD,S           ***3           CSW096
490600210712     C***********          ADD  1         S                ***3           CSW096
490700210712     C***********          MOVE '1'       *IN31                     LN0787CSW096
490800210712     C***********          END                             E**3           CSW096
490900210712     C***********          END                             E*2            CSW096
491000210712     C***********                                                         CSW096
491100210712     C***IF*//BL*AND FOLLOWED BY BLANKS THEN DEFAULT THIS TO THE          CSW096
491200210712     C***BANKLEITZAHL CODE ONLY IF PMPIBN IS A CUSTOMER                   CSW096
491300210712     C***********CPPIBN    IFEQ 'N'                        B*2            CSW096
491400210712     C***********PMXIB4    IFEQ '//BL'                     B**3           CSW096
491500210712     C***********PMXIB8    ANDEQ*BLANK                     ***3           CSW096
491600210712     C***********          MOVE BBBLCD    PMXIB8           ***3           CSW096
491700210712     C***********          MOVE PMXIBA    PMPIBA           ***3           CSW096
491800210712     C***********          END                             E**3           CSW096
491900210712     C***********          END                             E*2            CSW096
492000210712     C***********                                                         CSW096
492100210712     C***IF*//BL*IT MUST BE FOLLOWED BY A 8 DIGIT NUMBER.                 CSW096
492200210712     C***********PMXIB4    IFEQ '//BL'                     B*2            CSW096
492300210712     C***********          TESTN          PMXIB8     60    **2            CSW096
492400210712     C************IN60     IFNE '1'                        NOT NUMERIC    CSW096
492500210712     C***********PMXIBY    ORNE *BLANKS                    NOT FOLL. BY BLCSW096
492600210712     C***********          MOVE '969'     ERCD,S           ***3           CSW096
492700210712     C***********          ADD  1         S                ***3           CSW096
492800210712     C***********          MOVE '1'       *IN31                     LN0787CSW096
492900210712     C***********          END                             E**3           CSW096
493000210712     C***********          END                             E*2            CSW096
493100210712     C***********                                                   056847CSW096
493200210712     C***If*//CH*and followed by blanks than default this to the    056847CSW096
493300210712     C***customers CHIPS universal id. only if PMPIBN is a customer 056847CSW096
493400210712     C***********                                                   056847CSW096
493500210712     C***********CPPIBN    IFEQ 'N'                        B*2      056847CSW096
493600210712     C***********PMXIB4    IFEQ '//CH'                     B**3     056847CSW096
493700210712     C***********PMXIB5    ANDEQ*BLANK                     ***3     056847CSW096
493800210712     C***********          Z-ADDBBCHID    PNXIB6           ***3     056847CSW096
493900210712     C***********          MOVE PMXIBA    PMPIBA           ***3     056847CSW096
494000210712     C***********          END                             E**3     056847CSW096
494100210712     C***********          END                             E*2      056847CSW096
494200210712     C***********                                                   056847CSW096
494300210712     C***If*//SC*and followed by blanks then default this to the    056847CSW096
494400210712     C***chaps*sort code only if PMPIBN is a customer               056847CSW096
494500210712     C***********                                                   056847CSW096
494600210712     C***********CPPIBN    IFEQ 'N'                        B*2      056847CSW096
494700210712     C***********PMXIB4    IFEQ '//SC'                     B**3     056847CSW096
494800210712     C***********PMXIB5    ANDEQ*BLANK                     ***3     056847CSW096
494900210712     C***********          Z-ADDBBCHSC    PNXIB6           ***3     056847CSW096
495000210712     C***********          MOVE PMXIBA    PMPIBA           ***3     056847CSW096
495100210712     C***********          END                             E**3     056847CSW096
495200210712     C***********          END                             E*2      056847CSW096
495300210712     C***********                                                   056847CSW096
495400210712     C***If*//CH*or //SC it must be followed by a 6-digit number.   056847CSW096
495500210712     C***Also*check*//SW.************************************CSW095 094100CSW096
495600210712     C***********                                                   056847CSW096
495700210712     C***********PMXIB4    IFEQ '//CH'                     B*2      056847CSW096
495800210712     C***********PMXIB4    OREQ '//SC'                     **2      056847CSW096
495900210712     C***********PMXIB4    OREQ '//SW'                     **CSW095 094100CSW096
496000210712     C***********          TESTN          PMXIB6     60    **2      056847CSW096
496100210712     C************IN60     IFNE '1'                        not numer056847CSW096
496200210712     C***********PMXIBW    ORNE *BLANKS                    not foll.056847CSW096
496300210712     C***********          MOVE '969'     ERCD,S           ***3     056847CSW096
496400210712     C***********          ADD  1         S                ***3     056847CSW096
496500210712     C***********          MOVE '1'       *IN31                     056847CSW096
496600210712     C***********          END                             E**3     056847CSW096
496700210712     C***********          END                             E*2      056847CSW096
496800210712      ***********                                                   094100CSW096
496900210712      ***If*//SW*must be followed by a 5-digit number.              094100CSW096
497000210712     C***********PMXIB4    IFEQ '//SW'                     B*2      094100CSW096
497100210712     C***********          TESTN          PMXSW5     60    **2      094100CSW096
497200210712     C************IN60     IFNE '1'                        not numer094100CSW096
497300210712     C***********PMXSWW    ORNE *BLANKS                    not foll.094100CSW096
497400210712     C***********          MOVE '969'     ERCD,S           ***3     094100CSW096
497500210712     C***********          ADD  1         S                ***3     094100CSW096
497600210712     C***********          MOVE '1'       *IN31                     094100CSW096
497700210712     C***********          ENDIF                           E**3     094100CSW096
497800210712     C***********          ENDIF                           E*2      094100CSW096
497900210712     C***********          END                             E1             CSW096
498000210712     C           EVAL11    TAG
498100210712     C*
498200210712     C** ACCOUNT WITH BANK
498300210712     C** -----------------
498400210712     C                     MOVE 'Y'       CPAWBN  1
498500210712     C                     MOVE *BLANKS   PAAWBN
498600210712     C           *IN47     CABEQ'1'       EVAL12           ERROR ON FIELD
498700210712     C/COPY WNCPYSRC,SD2410C012
498800210712     C*
498900210712     C** MUST BE A 6 DIGIT NUMBER
499000210712     C** OR A CUSTOMER SHORTNAME THAT IDENTIFIES A LIVE
499100210712     C** RECORD ON FILE SDCUSTPD OR A COUNTERPARTY NOSTRO CODE THAT
499200210712     C** IDENTIFIES A LIVE RECORD ON SDCNSTPD
499300210712     C** DT0069: A Nostro Number is also now allowed.                     DT0069
499400210712     C                     MOVE *BLANK    ACPHON 12
499500210712     C                     MOVE *BLANK    ACTELX 12
499600210712     C           PMAWBN    IFNE *BLANK                     B1
499700210712     C                     MOVE *BLANK    @NOST                           DT0069
499800210712     C                     MOVE *BLANKS   CHKFLD           *1             S01117
499900210712     C                     MOVE PMAWBN    CHKFLD           *1
500000210712     C                     MOVE 'Y'       @CPNA            *1             S01117
500100210712     C           PMPSTM    IFEQ 07                         B*2            BHF810
500200210712     C***********PMPSTM    OREQ 08                         **2      BHF810E26771
500300210712     C/COPY WNCPYSRC,SD2410C074
500400210712     C*C*PY*WN*PYSRC*SD2410C054                                           169210
500500210712     C/COPY WNCPYSRC,SD2410CX54                                           169210
500600210712     C                     MOVE 'N'       @CPNA            **2            BHF810
500700210712     C                     END                             E*2            BHF810
500800210712     C                     EXSR CHKFL                      *1
500900210712     C*                                                                   DT0069
501000210712     C** If no record selected from the Customer or Counterparty Nostro   DT0069
501100210712     C** screens, or if field was neither of these, and only two          DT0069
501200210712     C** characters have been entered into the field, check for a Nostro  DT0069
501300210712     C** Number.                                                          DT0069
501400210712     C           RTCD      IFEQ '*NOSEL '                  B*2            DT0069
501500210712     C           RESULT    OREQ 'E'                        **2            DT0069
501600210712     C*                                                                   DT0069
501700210712     C** Set up work field for checking Nostro Number                     DT0069
501800210712     C                     MOVELPMAWBN    @@AWBN                          DT0069
501900210712     C*                                                                   DT0069
502000210712     C** Align and check Nostro Number:                                   DT0069
502100210712     C                     Z-ADD1         @       20       Set pointer    DT0069
502200210712     C           *BLANK    LOKUPNALG,@               97    First non-blankDT0069
502300210712     C*                                                                   DT0069
502400210712     C** If a non-blank character was found:                              DT0069
502500210712     C           *IN97     IFEQ '1'                        B**3           DT0069
502600210712      *                                                                   DT0069
502700210712     C                     MOVEANALG,@    @ALGN  10        ¦ Align        DT0069
502800210712     C                     MOVE @ALGN     @@AWBN           ¦ left         DT0069
502900210712     C*                                                                   DT0069
503000210712     C** The first two characters of @@AWBN should now contain the Nostro DT0069
503100210712     C** Number; check that the remaining characters are blank:           DT0069
503200210712     C           @@NRST    IFEQ *BLANKS                    B***4          DT0069
503300210712     C*                                                                   DT0069
503400210712     C** If they are, check whether the value in the first two characters DT0069
503500210712     C** is a valid Nostro Number:                                        DT0069
503600210712     C                     MOVE *BLANKS   RTCD             ****4          DT0069
503700210712     C                     MOVEL'*KEY'    OPTN             ****4          DT0069
503800210712     C***********          MOVE PMPCCY    @CYCD            ****4   DT0069 CEU003
503900210712     C                     MOVE WPECY     @CYCD                           CEU003
504000210712     C                     MOVEL@@NONO    @NONB            ****4          DT0069
504100210712     C                     EXSR CHKNO                      ****4          DT0069
504200210712     C                     END                             E***4          DT0069
504300210712     C                     END                             E**3           DT0069
504400210712     C                     END                             E*2            DT0069
504500210712     C*                                                                   S01117
504600210712     C           RTCD      IFEQ '*NOSEL '                  B*2            S01117
504700210712     C                     MOVE '876'     ERCD,S           **2            S01117
504800210712     C                     ADD  1         S                **2            S01117
504900210712     C                     MOVE '1'       *IN31                           LN0787
505000210712     C                     END                             E*2            S01117
505100210712     C*                                                                   S01117
505200210712     C***********RESULT****IFEQ 'E'                        B**3           DT0069
505300210712     C           RTCD      IFNE *BLANKS                    B*2            DT0069
505400210712     C                     MOVE '970'     ERCD,S           **2
505500210712     C                     ADD  1         S                **2
505600210712     C                     MOVE '1'       *IN31                           LN0787
505700210712     C                     ELSE                            X*2
505800210712     C                     MOVELPMAWBN    @TSTQ            **2            S01117
505900210712     C           RESULT    IFEQ 'A'                        B**3
506000210712     C           RESULT    OREQ 'B'                        ***3
506100210712     C                     MOVELBBCUST    PAAWBN           ***3
506200210712     C*                                                                   S01117
506300210712     C**   CHECK IF '?' ENTERED, IF SO MOVE VALUE RETRIEVED               S01117
506400210712     C**   INTO SCREEN FIELD.                                             S01117
506500210712     C*                                                                   S01117
506600210712     C           @TSTQ     IFEQ '?'                        B***4          S01117
506700210712     C                     MOVELBBCSSN    PMAWBN           ****4          S01117
506800210712     C                     END                             E***4          S01117
506900210712     C*********************MOVE BBTXA1    ACTELX           ***3           S01117
507000210712     C                     MOVELBBTXA1    ACTELX           ***3           S01117
507100210712     C                     MOVE BBCTNB    ACPHON           ***3
507200210712     C           BANKNB    IFEQ 'B'                        B***4
507300210712     C**********           MOVE CNUM      NUAWBN  60       ****4                              CSD027
507400210712     C                     MOVE CNUM      NUAWBN  6        ****4                              CSD027
507500210712     C                     MOVE 'N'       CPAWBN           ****4
507600210712     C                     ELSE                            X***4
507700210712     C                     MOVE '971'     ERCD,S           ****4
507800210712     C                     ADD  1         S                ****4
507900210712     C                     MOVE '1'       *IN31                           LN0787
508000210712     C                     END                             E***4
508100210712     C                     ELSE                            X**3
508200210712     C*                                                                   DT0069
508300210712     C** Set details if value entered was a Nostro.                       DT0069
508400210712     C           @NOST     IFEQ 'Y'                        B***4          DT0069
508500210712     C                     MOVELA7CUST    PAAWBN                          DT0069
508600210712     C           @TSTQ     IFEQ '?'                        B****5         DT0069
508700210712     C                     MOVE *BLANKS   PMAWBN           *****5         DT0069
508800210712     C                     MOVELA7CUST    PMAWBN           *****5         DT0069
508900210712     C                     END                             E****5         DT0069
509000210712      *                                                                   181340
509100210712      ** For Nostro, account with bank must be a SWIFT financial          181340
509200210712      ** Institution.                                                     181340
509300210712      *                                                                   181340
509400210712     C                     MOVELA7CUST    CHKFLD                          181340
509500210712     C                     EXSR CHKFL                                     181340
509600210712     C           BANKNB    IFNE 'B'                                       181340
509700210712     C                     MOVE '971'     ERCD,S                          181340
509800210712     C                     ADD  1         S                               181340
509900210712     C                     MOVE '1'       *IN31                           181340
510000210712     C                     END                                            181340
510100210712      *                                                                   181340
510200210712     C                     ELSE                            X***4          DT0069
510300210712     C                     MOVE *BLANKS   PAAWBN           ****4          S01117
510400210712     C                     MOVELAWCPNC    PAAWBN           ****4
510500210712     C*                                                                   S01117
510600210712     C**   CHECK IF '?' ENTERED, IF SO MOVE VALUE RETRIEVED               S01117
510700210712     C**   INTO SCREEN FIELD.                                             S01117
510800210712     C*                                                                   S01117
510900210712     C           @TSTQ     IFEQ '?'                        B****5         S01117
511000210712     C                     MOVE *BLANKS   PMAWBN           *****5         S01117
511100210712     C                     MOVELAWCPNC    PMAWBN           *****5
511200210712     C                     END                             E****5         DT0069
511300210712     C                     END                             E***4          S01117
511400210712     C                     END                             E**3
511500210712     C/COPY WNCPYSRC,SD2410C077
511600210712     C                     END                             E*2
511700210712     C                     END                             E1
511800210712     C*                                                                   S01408
511900210712     C/COPY WNCPYSRC,SD2410CP15                                           S01408
512000210712     C*                                                                   S01408
512100210712     C           EVAL12    TAG
512200210712     C*
512300210712     C** ACCOUNT WITH BANK A/C LINE
512400210712     C** --------------------------
512500210712     C           *IN48     CABEQ'1'       EVAL13           ERROR ON FIELD
512600210712     C                     MOVELPMAWBA    AWBA6   6
512700210712     C                     MOVE PMAWBA    AWBA29 29
512800210712     C*                                                                                       193584
512900210712     C           PMAWBA    IFNE *BLANKS                                                       193584
513000210712     C** Entry is not allowed if the Nostro is a CLS Dummy Nostro.                            193584
513100210712     C                     MOVE PMPONS    NOSTRO                                              193584
513200210712     C                     MOVE WPECY     @CYCD                                               193584
513300210712     C                     MOVE NOST02    @NONB                                               193584
513400210712     C*                                                                                       193584
513500210712     C** Check the Nostro.                                                                    193584
513600210712     C                     EXSR CHKNO                                                         193584
513700210712      *                                                                                       193584
513800210712     C           A7CLSD    IFEQ 'Y'                                                           193584
513900210712     C                     MOVE '713'     ERCD,S                                              193584
514000210712     C                     ADD  1         S                                                   193584
514100210712     C                     MOVE '1'       *IN31                                               193584
514200210712     C                     END                                                                193584
514300210712     C                     END                                                                193584
514400210712      *                                                                                       193584
514500210712     C*
514600210712     C** ACCOUNT WITH MUST BE BLANK IF 'DIRECT' ENTERED IN ACCOUNT WITH
514700210712     C** BANK A/C LINE
514800210712     C           PMAWBN    IFNE *BLANKS                    B1
514900210712     C           AWBA6     ANDEQ'DIRECT'                   *1
515000210712     C                     MOVE '973'     ERCD,S           *1
515100210712     C                     ADD  1         S                *1
515200210712     C                     MOVE '1'       *IN31                           LN0787
515300210712     C                     END                             E1
515400210712     C*
515500210712     C*
515600210712     C** AWBA MAY ONLY CONTAIN WORD 'DIRECT' WHEN AWBN BLANK
515700210712     C           PMAWBN    IFEQ *BLANKS                    B1
515800210712     C           PMAWBA    ANDNE*BLANKS                    *1
515900210712     C           AWBA6     ANDNE'DIRECT'                   *1
516000210712     C*
516100210712     C           PMAWBN    OREQ *BLANKS                    *1
516200210712     C           PMAWBA    ANDNE*BLANKS                    *1
516300210712     C           AWBA29    ANDNE*BLANKS                    *1
516400210712     C*
516500210712     C           PMAWBN    OREQ *BLANKS                    *1
516600210712     C           AWBA29    ANDNE*BLANKS                    *1
516700210712     C*
516800210712     C           PMAWBN    ORNE *BLANKS                    *1
516900210712     C           AWBA6     ANDEQ'DIRECT'                   *1
517000210712     C           AWBA29    ANDEQ*BLANKS                    *1
517100210712     C                     MOVE '974'     ERCD,S           *1
517200210712     C                     ADD  1         S                *1
517300210712     C                     MOVE '1'       *IN31                           LN0787
517400210712     C                     MOVE '1'       *IN48            *1
517500210712     C                     END                             E1
517600210712     C*
517700210712     C           *IN48     CABEQ'1'       EVAL13
517800210712     C/COPY WNCPYSRC,SD2410C013
517900210712     C*
518000210712     C           PMAWBA    IFNE *BLANK                     B1
518100210712     C           AWBA6     ANDNE'DIRECT'                   *1
518200210712     C                     MOVE PMAWBA    PMXIBA           *1
518300210712     C*
518400210712     C** FIRST CHARACTER MUST BE '/'
518500210712     C           PMXIB1    IFNE '/'                        B*2
518600210712     C/COPY WNCPYSRC,SD2410C014
518700210712     C                     MOVE '974'     ERCD,S           **2
518800210712     C                     ADD  1         S                **2
518900210712     C                     MOVE '1'       *IN31                           LN0787
519000210712     C                     END                             E*2
519100210712     C/COPY WNCPYSRC,SD2410C015
519200210712      *****************************************************************   CSW096
519300210712      *                                                                   CSW096
519400210712      * Call Account Line Validation object                               CSW096
519500210712      *                                                                   CSW096
519600210712      * Set up parameters                                                 CSW096
519700210712      *                                                                   CSW096
519800210712     C                     MOVEL*BLANKS   W0RTN                           CSW096
519900210712     C                     CLEARI#PARM                                    CSW096
520000210712     C                     MOVEL'AWBK '   I#VFLD                          CSW096
520100210712     C                     MOVEL'PAY'     I#PR                            CSW096
520200210712     C                     MOVEL'X'       I#PRTT                          CSW096
520300210712     C                     MOVELPMAWBN    I#PRTY                          CSW096
520400210712     C***********          MOVELPMPCCY    I#PCCY                   CSW096 CEU003
520500210712     C***********          MOVELPMRCCY    I#RCCY                   CSW096 CEU003
520600210712     C                     MOVELWPECY     I#PCCY                          CEU003
520700210712     C                     MOVELWRECY     I#RCCY                          CEU003
520800210712     C                     MOVELPMAWBA    I#ACLN                          CSW096
520900210712     C                     MOVELPMPSTM    I#PSTM                          CSW096
521000210712     C                     MOVELPMRSTM    I#RSTM                          CSW096
521100210712     C           PMPOCN    IFNE *BLANKS                                   CSW096
521200210712      *                                                                                       CSW203
521300210712      ** Set I#MTYP to "103" instead of "100" if CSW203 is installed                          CSW203
521400210712      *                                                                                       CSW203
521500210712     C           CSW203    IFEQ 'Y'                                                           CSW203
521600210712     C                     MOVEL'103'     I#MTYP                                              CSW203
521700210712     C                     ELSE                                                               CSW203
521800210712     C                     MOVEL'100'     I#MTYP                          CSW096
521900210712     C                     ENDIF                                                              CSW203
522000210712     C                     ELSE                                           CSW096
522100210712     C                     MOVEL'202'     I#MTYP                          CSW096
522200210712     C                     ENDIF                                          CSW096
522300210712      * Set up receive account information                                CSW096
522400210712     C           PMRONS    IFNE *BLANKS                                   CSW096
522500210712     C                     SELEC                                          CSW096
522600210712     C           PMROBR    WHNE *BLANKS                                   CSW096
522700210712     C           PMRONS    CAT  PMROBR    I#RCAC                          CSW096
522800210712     C           PMRONS    WHNE *BLANKS                                   CSW096
522900210712     C                     MOVELPMRONS    I#RCAC                          CSW096
523000210712     C                     ENDSL                                          CSW096
523100210712     C                     ENDIF                                          CSW096
523200210712      * Set up Pay account information                                    CSW096
523300210712     C           PMPONS    IFNE *BLANKS                                   CSW096
523400210712     C                     SELEC                                          CSW096
523500210712     C           PMPOBR    WHNE *BLANKS                                   CSW096
523600210712     C           PMPONS    CAT  PMPOBR    I#PYAC                          CSW096
523700210712     C           PMPONS    WHNE *BLANKS                                   CSW096
523800210712     C                     MOVELPMPONS    I#PYAC                          CSW096
523900210712     C                     ENDSL                                          CSW096
524000210712     C                     ENDIF                                          CSW096
524100210712      * If extra message and Rec Corr. then set 5354 field                CSW096
524200210712     C           PMRVNO    IFNE *BLANKS                                   CSW096
524300210712     C           PMRCRN    ANDNE*BLANKS                                   CSW096
524400210712     C                     MOVEL'Y'       I#5354                          CSW096
524500210712     C                     ENDIF                                          CSW096
524600210712      * Transaction Type                                                  CSW096
524700210712     C                     MOVELPMTTYP    I#TTYP                          CSW096
524800210712      *                                                                   CSW096
524900210712     C                     CLEARO#PARM                                    CSW096
525000210712     C                     CLEARE#PARM                                    CSW096
525100210712      *                                                                   CSW096
525200210712      * Send messages to correct calling process                          CSW096
525300210712      *                                                                   CSW096
525400210712     C                     SELEC                                          CSW096
525500210712     C           PMCPGM    WHEQ 'FXFX'                                    CSW096
525600210712     C                     MOVEL'ME9940'  E#CPGM                          CSW096
525700210712     C                     MOVEL'DL'      I#MMOD                          CSW096
525800210712     C           PMCPGM    WHEQ 'MMLD'                                    CSW096
525900210712     C                     MOVEL'ME9940'  E#CPGM                          CSW096
526000210712     C                     MOVEL'LE'      I#MMOD                          CSW096
526100210712     C           PMCPGM    WHEQ 'SSI '                                    CSW096
526200210712     C                     MOVEL'SD0401R' E#CPGM                          CSW096
526300210712     C                     OTHER                                          CSW096
526400210712     C                     MOVEL'ME9940'  E#CPGM                          CSW096
526500210712     C                     ENDSL                                          CSW096
526600210712     C                     MOVEL'MEC0017' E#MSGD                          CSW096
526700210712     C                     MOVEL'MEMSG'   E#MSGF                          CSW096
526800210712      *                                                                   CSW096
526900210712     C                     CALL 'ME9940'                                  CSW096
527000210712     C                     PARM           W0RTN   7                       CSW096
527100210712     C                     PARM           I#PARM           I Input Parms  CSW096
527200210712     C                     PARM           O#PARM           O Output Parms CSW096
527300210712     C                     PARM           E#PARM           E Error Inform CSW096
527400210712     C                     PARM           Z#PARM256        B User Defined CSW096
527500210712      *                                                                   CSW096
527600210712      * On return if errors copy into error array                         CSW096
527700210712      *                                                                   CSW096
527800210712     C                     MOVELO#ACLN    PMAWBA                          CSW096
527900210712      *                                                                   CSW096
528000210712     C           E#ERRM    IFNE *BLANKS                                   CSW096
528100210712      *                                                                   CSW096
528200210712     C           1         DO   E#INDX    Q#      50                      CSW096
528300210712     C                     MOVEAO#E,Q#    ERCD,S                          CSW096
528400210712     C                     ADD  1         S                               CSW096
528500210712     C                     ENDDO                                          CSW096
528600210712      *                                                                   CSW096
528700210712      * Mark pay side as ib error                                         CSW096
528800210712     C                     MOVEL*ON       *IN31                           CSW096
528900210712      *                                                                   CSW096
529000210712     C                     ENDIF                                          CSW096
529100210712      *                                                                   CSW096
529200210712     C                     ENDIF                                          CSW096
529300210712      *                                                                   CSW096
529400210712      ********************************************************************CSW096
529500210712      ***********                                                         CSW096
529600210712     C***********                                                   060036CSW096
529700210712     C***If*1st*& 3rd character are '/',                            060036CSW096
529800210712     C***then*2nd character must be 'C' or 'D'.                     060036CSW096
529900210712     C***********                                                   060036CSW096
530000210712     C***********PMXIB1    IFEQ '/'                        B*2      060036CSW096
530100210712     C***********PMXIBE    ANDEQ'/'                        **2      060036CSW096
530200210712     C***********PMXIB2    IFNE 'C'                        B**3     060036CSW096
530300210712     C***********PMXIB2    ANDNE'D'                        ***3     060036CSW096
530400210712     C***********          MOVE '203'     ERCD,S           ***3     060036CSW096
530500210712     C***********          ADD  1         S                ***3     060036CSW096
530600210712     C***********          MOVE '1'       *IN31            ***3     060036CSW096
530700210712     C***********          END                             E**3     060036CSW096
530800210712     C***********          END                             E*2      060036CSW096
530900210712     C***********                                                         CSW096
531000210712     C***IF*SECOND CHARACTER IS ALSO '/'                                  CSW096
531100210712     C***Must*be*followed by CP, CH, FW, BL, SC or SW.              CSW095CSW096
531200210712     C***MUST*BE*FOLLOWED*BY*CP,CH,FW,BL*OR*SC**********************CSW095CSW096
531300210712     C***********PMXIB1    IFEQ '/'                        B*2            CSW096
531400210712     C***********PMXIB2    ANDEQ'/'                        **2            CSW096
531500210712     C***********PMXIB4    IFNE '//CP'                     B**3           CSW096
531600210712     C***********PMXIB4    ANDNE'//CH'                     ***3           CSW096
531700210712     C***********PMXIB4    ANDNE'//FW'                     ***3           CSW096
531800210712     C***********PMXIB4    ANDNE'//BL'                     ***3           CSW096
531900210712     C***********PMXIB4    ANDNE'//SC'                     ***3           CSW096
532000210712     C***********PMXIB4    ANDNE'//SW'                     ***3     CSW095CSW096
532100210712     C***********          MOVE '975'     ERCD,S           ***3           CSW096
532200210712     C***********          ADD  1         S                ***3           CSW096
532300210712     C***********          MOVE '1'       *IN31                     LN0787CSW096
532400210712     C***********          END                             E**3           CSW096
532500210712     C***********          END                             E*2            CSW096
532600210712     C***********                                                         CSW096
532700210712     C***IF*FOLLOWED BY CP; CH; FW CURRENCY MUST BE USD                   CSW096
532800210712     C***IF*FOLLOWED BY BL CURRENCY MUST BE DEM                           CSW096
532900210712      ***IF*followed by SW currency must be CHF.                    CSW095CSW096
533000210712     C***********PMXIB4    IFEQ '//CP'                     B*2            CSW096
533100210712     C***********PMXIB4    OREQ '//CH'                     **2            CSW096
533200210712     C***********PMXIB4    OREQ '//FW'                     **2            CSW096
533300210712     C***********PMXIB4    OREQ '//SC'                     **2            CSW096
533400210712     C***********PMXIB4    OREQ '//BL'                     **2            CSW096
533500210712     C***********PMXIB4    OREQ '//SW'                     **2      CSW095CSW096
533600210712     C***********          MOVE PMPCCY    KEYY             **2            CSW096
533700210712     C***********          MOVE PMXIB4    KEYZ             **2            CSW096
533800210712     C***********          EXSR CHKCY                      **2            CSW096
533900210712     C***********RTCD      IFNE *BLANKS                    B*2            CSW096
534000210712     C***********          MOVE '976'     ERCD,S           ***3           CSW096
534100210712     C***********          ADD  1         S                ***3           CSW096
534200210712     C***********          MOVE '1'       *IN31                     LN0787CSW096
534300210712     C***********          GOTO EVAL13                     ***3           CSW096
534400210712     C***********          END                             E**3           CSW096
534500210712     C***********          END                             E*2            CSW096
534600210712     C***********                                                         CSW096
534700210712     C***IF*//CP*AND FOLLOWED BY BLANKS THEN DEFAULT THIS TO THE          CSW096
534800210712     C***CUSTOMERS CHIPS PARTICIPANT ONLY IF PMAWBN IS A CUSTOMER         CSW096
534900210712     C***********CPAWBN    IFEQ 'N'                        B*2            CSW096
535000210712     C***********PMXIB4    IFEQ '//CP'                     B**3           CSW096
535100210712     C***********PMXIB5    ANDEQ*BLANK                     ***3           CSW096
535200210712     C***********          Z-ADDBBCABA    PNXIB3           ***3     S01429CSW096
535300210712     C***********          Z-ADDBBABA2    PNXIB3           ***3     S01429CSW096
535400210712     C***********          MOVE PMXIBA    PMAWBA           ***3           CSW096
535500210712     C***********          END                             E**3           CSW096
535600210712     C***********          END                             E*2            CSW096
535700210712     C***********                                                         CSW096
535800210712     C***IF*//CP*IT*MUST*BE*FOLLOWED*BY*A*3*DIGIT*NUMBER.*THE*NUMBERS01429CSW096
535900210712     C***IF*//CP*IT MUST BE FOLLOWED BY A 4 DIGIT NUMBER. THE NUMBERS01429CSW096
536000210712     C***MUST*BE*FOLLOWED BY BLANKS.                                      CSW096
536100210712     C***********PMXIB4    IFEQ '//CP'                     B*2            CSW096
536200210712     C***********          TESTN          PMXIB3     60    **2            CSW096
536300210712     C************IN60     IFNE '1'                        NOT NUMERIC    CSW096
536400210712     C***********PMXIBX    ORNE *BLANKS                    NOT FOLL. BY BLCSW096
536500210712     C***********          MOVE '977'     ERCD,S           ***3           CSW096
536600210712     C***********          ADD  1         S                ***3           CSW096
536700210712     C***********          MOVE '1'       *IN31                     LN0787CSW096
536800210712     C***********          END                             E**3           CSW096
536900210712     C***********          END                             E*2            CSW096
537000210712     C***********                                                         CSW096
537100210712     C***IF*//FW*IT MUST BE FOLLOWED BY A 9 DIGIT NUMBER.IF A/C WITH      CSW096
537200210712     C***BANK*HAS A SWIFT ADDRESS //FW DOES NOT REQUIRE TO BE FOLLOWED    CSW096
537300210712     C***BY*A*NUMBER                                                      CSW096
537400210712     C***********PMXIB4    IFEQ '//FW'                     B*2            CSW096
537500210712     C***********          TESTN          PMXIB9     60    **2            CSW096
537600210712     C************IN60     IFNE '1'                        NOT NUMERIC    CSW096
537700210712     C***********PMXIBZ    ORNE *BLANKS                    NOT FOLL. BY BLCSW096
537800210712     C***********          MOVE '0'       *IN60            ***3           CSW096
537900210712     C***********          END                             E**3           CSW096
538000210712     C***********CPAWBN    IFEQ 'N'                        B**3           CSW096
538100210712     C***********                                                         CSW096
538200210712     C***********SWFT      ANDNE*BLANKS                    ***3           CSW096
538300210712     C***********PMXIB5    ANDEQ*BLANKS                    ***3           CSW096
538400210712     C***********          MOVE '1'       *IN60            ***3           CSW096
538500210712     C***********          END                             E**3           CSW096
538600210712     C***IF*SWIFT ADDRESS IS BLANK BUT THE FEDWIRE ACCOUNT NUMBER IS      CSW096
538700210712     C***PRESENT, SET UP THE FEDWIRE ACCOUNT                              CSW096
538800210712     C***********PMXIB5    IFEQ *BLANKS                    B**3           CSW096
538900210712     C***********SWFT      ANDEQ*BLANKS                    ***3           CSW096
539000210712     C***********FEDW      ANDNE*ZEROS                     ***3           CSW096
539100210712     C***********          Z-ADDFEDW      PMXIB7           ***3           CSW096
539200210712     C***********          END                             E**3           CSW096
539300210712     C***********SWFT      IFEQ *BLANKS                    B**3           CSW096
539400210712     C***********FEDW      ANDEQ*ZEROS                     ***3     S01117CSW096
539500210712     C***********PMXIB9    ANDEQ*BLANKS                    ***3     S01117CSW096
539600210712     C***********          MOVE '0'       *IN60            ***3     BHF647CSW096
539700210712     C***********          MOVE '1'       *IN60                     BHF647CSW096
539800210712     C***********          END                             E**3           CSW096
539900210712     C************IN60     IFNE '1'                        B**3           CSW096
540000210712     C***********          MOVE '977'     ERCD,S           ***3           CSW096
540100210712     C***********          ADD  1         S                ***3           CSW096
540200210712     C***********          MOVE '1'       *IN31                     LN0787CSW096
540300210712     C***********          END                             E**3           CSW096
540400210712     C***********          END                             E*2            CSW096
540500210712     C***********                                                         CSW096
540600210712     C***IF*//BL*AND FOLLOWED BY BLANKS THEN DEFAULT THIS TO THE          CSW096
540700210712     C***BANKLEITZAHL CODE ONLY IF PMAWBN IS A CUSTOMER                   CSW096
540800210712     C***********CPAWBN    IFEQ 'N'                        B*2            CSW096
540900210712     C***********PMXIB4    IFEQ '//BL'                     B**3           CSW096
541000210712     C***********PMXIB8    ANDEQ*BLANK                     ***3           CSW096
541100210712     C***********          MOVE BBBLCD    PMXIB8           ***3           CSW096
541200210712     C***********          MOVE PMXIBA    PMAWBA           ***3           CSW096
541300210712     C***********          END                             E**3           CSW096
541400210712     C***********          END                             E*2            CSW096
541500210712     C***********                                                         CSW096
541600210712     C***IF*//BL*IT MUST BE FOLLOWED BY A 8 DIGIT NUMBER.                 CSW096
541700210712     C***********PMXIB4    IFEQ '//BL'                     B*2            CSW096
541800210712     C***********          TESTN          PMXIB8     60    **2            CSW096
541900210712     C************IN60     IFNE '1'                        NOT NUMERIC    CSW096
542000210712     C***********PMXIBY    ORNE *BLANKS                    NOT FOLL. BY BLCSW096
542100210712     C***********          MOVE '977'     ERCD,S           ***3           CSW096
542200210712     C***********          ADD  1         S                ***3           CSW096
542300210712     C***********          MOVE '1'       *IN31                     LN0787CSW096
542400210712     C***********          END                             E**3           CSW096
542500210712     C***********          END                             E*2            CSW096
542600210712     C***********                                                         CSW096
542700210712     C***IF*//CH*AND FOLLOWED BY BLANKS THEN DEFAULT THIS TO THE          CSW096
542800210712     C***CUSTOMERS CHIPS UNIVERSAL ID. ONLY IF PMAWBN IS A CUSTOMER       CSW096
542900210712     C***********CPAWBN    IFEQ 'N'                        B*2            CSW096
543000210712     C***********PMXIB4    IFEQ '//CH'                     B**3           CSW096
543100210712     C***********PMXIB5    ANDEQ*BLANK                     ***3           CSW096
543200210712     C***********          Z-ADDBBCHID    PNXIB6           ***3           CSW096
543300210712     C***********          MOVE PMXIBA    PMAWBA           ***3           CSW096
543400210712     C***********          END                             E**3           CSW096
543500210712     C***********          END                             E*2            CSW096
543600210712     C***********                                                         CSW096
543700210712     C***IF*//SC*AND FOLLOWED BY BLANKS THEN DEFAULT THIS TO THE          CSW096
543800210712     C***CHAPS*SORT CODE ONLY IF PMAWBN IS A CUSTOMER                     CSW096
543900210712     C***********CPAWBN    IFEQ 'N'                        B*2            CSW096
544000210712     C***********PMXIB4    IFEQ '//SC'                     B**3           CSW096
544100210712     C***********PMXIB5    ANDEQ*BLANK                     ***3           CSW096
544200210712     C***********          Z-ADDBBCHSC    PNXIB6           ***3           CSW096
544300210712     C***********          MOVE PMXIBA    PMAWBA           ***3           CSW096
544400210712     C***********          END                             E**3           CSW096
544500210712     C***********          END                             E*2            CSW096
544600210712     C***********                                                         CSW096
544700210712     C***IF*//CH*OR //SC IT MUST BE FOLLOWED BY A 6 DIGIT NUMBER.         CSW096
544800210712      ***Also*check*//SW.************************************CSW095 094100CSW096
544900210712     C***********PMXIB4    IFEQ '//CH'                     B*2            CSW096
545000210712     C***********PMXIB4    OREQ '//SC'                     **2            CSW096
545100210712     C***********PMXIB4    OREQ '//SW'                     **CSW095 094100CSW096
545200210712     C***********          TESTN          PMXIB6     60    **2            CSW096
545300210712     C************IN60     IFNE '1'                        NOT NUMERIC    CSW096
545400210712     C***********PMXIBW    ORNE *BLANKS                    NOT FOLL. BY BLCSW096
545500210712     C***********          MOVE '977'     ERCD,S           ***3           CSW096
545600210712     C***********          ADD  1         S                ***3           CSW096
545700210712     C***********          MOVE '1'       *IN31                     LN0787CSW096
545800210712     C***********          END                             E**3           CSW096
545900210712     C***********          END                             E*2            CSW096
546000210712      ***********                                                   094100CSW096
546100210712      ***If*//SW*must be followed by a 5-digit number.              094100CSW096
546200210712     C***********PMXIB4    IFEQ '//SW'                     B*2      094100CSW096
546300210712     C***********          TESTN          PMXSW5     60    **2      094100CSW096
546400210712     C************IN60     IFNE '1'                        not nume 094100CSW096
546500210712     C***********PMXSWW    ORNE *BLANKS                    not folll094100CSW096
546600210712     C***********          MOVE '977'     ERCD,S           ***3     094100CSW096
546700210712     C***********          ADD  1         S                ***3     094100CSW096
546800210712     C***********          MOVE '1'       *IN31                     094100CSW096
546900210712     C***********          ENDIF                           E**3     094100CSW096
547000210712     C***********          ENDIF                           E*2      094100CSW096
547100210712     C***********          END                             E1             CSW096
547200210712     C           EVAL13    TAG
547300210712     C*
547400210712     C** BENEFICIARY
547500210712     C** -----------
547600210712     C                     MOVE 'Y'       CPBENN  1
547700210712     C                     MOVE *BLANKS   PABENN
547800210712     C           *IN49     CABEQ'1'       EVAL14           ERROR ON FIELD
547900210712     C/COPY WNCPYSRC,SD2410C060
548000210712     C*
548100210712     C** MUST BE A 6 DIGIT NUMBER
548200210712     C** OR A CUSTOMER SHORTNAME THAT IDENTIFIES A LIVE
548300210712     C** RECORD ON FILE SDCUSTPD OR A COUNTERPARTY NOSTRO CODE THAT
548400210712     C** IDENTIFIES A LIVE RECORD ON SDCNSTPD
548500210712     C                     MOVE 'N'       BENBNK  1
548600210712     C/COPY WNCPYSRC,SD2410C053
548700210712     C********** PMPSTM    IFEQ 01                         B1             BHF582
548800210712     C********** PMPSTM    OREQ 07                         *1             BHF582
548900210712     C********** PMPSTM    IFEQ 07                         *1       BHF582BHF595
549000210712     C*                                                                   BHF595
549100210712     C** IF SETTLEMENT TYPE 01 OR 07 VALIDATE BENEFICIARY IF              BHF595
549200210712     C** PRESENT.HOWEVER BENEFICIARY IS MANDATORY FOR TYPE 08             BHF595
549300210712     C** BENEFICIARY IS MANDATORY FOR 07 ALSO.
549400210712     C*                                                                   BHF595
549500210712     C           PMPSTM    IFEQ 01                                        BHF595
549600210712     C           PMBENN    ANDNE*BLANK                                    BHF595
549700210712     C           PMPSTM    OREQ 07                                        BHF595
549800210712     C********** PMBENN    ANDNE*BLANK                              BHF595BHF759
549900210712     C           PMPSTM    OREQ 08                         *1
550000210712     C           CLE033    OREQ 'Y'                                       CLE033
550100210712     C           PMPSTM    ANDEQ09                                        CLE033
550200210712     C           PMBENN    ANDNE*BLANK                                    CLE033
550300210712     C/COPY WNCPYSRC,SD2410C080
550400210712     C********** PMBENN    ANDNE*BLANK                              BHF582BHF595
550500210712     C                     MOVE *BLANK    BEPHON 12        *1
550600210712     C                     MOVE *BLANK    BETELX 12        *1
550700210712     C                     MOVE *BLANKS   CHKFLD           *1             S01117
550800210712     C                     MOVE PMBENN    CHKFLD           *1
550900210712     C                     MOVE 'Y'       @CPNA            *1             S01117
551000210712     C           PMPSTM    IFEQ 07                         B*2            BHF810
551100210712     C***********PMPSTM    OREQ 08                         **2      BHF810E26771
551200210712     C                     MOVE 'N'       @CPNA            **2            BHF810
551300210712     C                     END                             E*2            BHF810
551400210712     C                     EXSR CHKFL                      *1
551500210712     C*                                                                   S01117
551600210712     C           RTCD      IFEQ '*NOSEL '                  B*2            S01117
551700210712     C                     MOVE '877'     ERCD,S           **2            S01117
551800210712     C                     ADD  1         S                **2            S01117
551900210712     C                     MOVE '1'       *IN31                           LN0787
552000210712     C                     END                             E*2            S01117
552100210712     C*                                                                   S01117
552200210712     C           RESULT    IFEQ 'E'                        B*2
552300210712     C********** PMRSTM    ANDNE01                                  BHF582LN0783
552400210712     C                     MOVE '978'     ERCD,S           **2
552500210712     C                     ADD  1         S                **2
552600210712     C                     MOVE '1'       *IN31                           LN0787
552700210712     C                     ELSE                            X*2
552800210712     C                     MOVELPMBENN    @TSTQ            **2            S01117
552900210712     C           RESULT    IFEQ 'A'                        B**3
553000210712     C           RESULT    OREQ 'B'                        ***3
553100210712     C                     MOVELBBCUST    PABENN           ***3
553200210712     C*                                                                   S01117
553300210712     C**   CHECK IF '?' ENTERED, IF SO MOVE VALUE RETRIEVED               S01117
553400210712     C**   INTO SCREEN FIELD.                                             S01117
553500210712     C*                                                                   S01117
553600210712     C           @TSTQ     IFEQ '?'                        B****5         S01117
553700210712     C                     MOVELBBCSSN    PMBENN           *****5         S01117
553800210712     C                     END                             E****5         S01117
553900210712     C           BANKNB    IFEQ 'B'                        B***4
554000210712     C                     MOVE 'Y'       BENBNK           ****4
554100210712     C                     END                             E***4
554200210712     C                     MOVE BBCTNB    BEPHON           ***3
554300210712     C*********************MOVE BBTXA1    BETELX           ***3           S01117
554400210712     C                     MOVELBBTXA1    BETELX           ***3           S01117
554500210712     C                     MOVE 'N'       CPBENN           ***3
554600210712     C                     ELSE                            X**3
554700210712     C                     MOVE *BLANKS   PABENN           ***3           S01117
554800210712     C                     MOVELAWCPNC    PABENN           ***3
554900210712     C*                                                                   S01117
555000210712     C**   CHECK IF '?' ENTERED, IF SO MOVE VALUE RETRIEVED               S01117
555100210712     C**   INTO SCREEN FIELD.                                             S01117
555200210712     C*                                                                   S01117
555300210712     C           @TSTQ     IFEQ '?'                        B***4          S01117
555400210712     C                     MOVE *BLANKS   PMBENN           ****4          S01117
555500210712     C                     MOVELAWCPNC    PMBENN           ****4
555600210712     C                     END                             E***4          S01117
555700210712     C                     END                             E**3
555800210712     C/COPY WNCPYSRC,SD2410C078
555900210712     C                     END                             E*2
556000210712     C                     END                             E1
556100210712     C** MANDATORY ENTRY OF ORDERING CUST. IF BENEFICIARY IS A NON-BANK
556200210712     C********** PMPOCN    IFEQ *BLANKS                    B1             BHF595
556300210712     C********** PMBENN    ANDNE*BLANKS                    *1             BHF595
556400210712     C********** BENBNK    ANDEQ'N'                        *1             BHF595
556500210712     C********** PMPSTM    IFEQ 01                         B*2            BHF595
556600210712     C********** PMPSTM    OREQ 07                         **2            BHF595
556700210712     C********** PMPSTM    OREQ 08                         **2            BHF595
556800210712     C           PMPOCN    IFEQ *BLANKS                    B1             BHF595
556900210712     C           PMBENN    ANDNE*BLANKS                                   BHF595
557000210712     C           PMPSTM    IFEQ 08                                        BHF595
557100210712     C           BENBNK    IFEQ 'N'                                       BHF595
557200210712     C********** CPBNBI    OREQ 'N'                                 BHF595LN0765
557300210712     C***********CPBNBI    OREQ 'N'                                LN0787 142408
557400210712     C                     MOVE '945'     ERCD,S           **2
557500210712     C                     ADD  1         S                **2
557600210712     C                     MOVE '1'       *IN31                           LN0787
557700210712     C                     END                             E*2
557800210712     C                     END                             E1
557900210712     C                     END                                            BHF595
558000210712     C***FOR*SETTL.*TYPE*01,07*OR*08*ORDERING*BANK*OR*ORDERING*CUSTOMER***E21860
558100210712     C***MUST*BE*ENTERED***                                               E21860
558200210712     C***********PMPSTM****IFEQ 01                         B1             E21860
558300210712     C***********PMPSTM****OREQ 07                         *1             E21860
558400210712     C***********PMPSTM****OREQ 08                         *1             E21860
558500210712     C***********PMPOBN****IFEQ *BLANKS                    B*2            E21860
558600210712     C***********PMPOCN****ANDEQ*BLANKS                    **2            E21860
558700210712     C*********************MOVE '950'     ERCD,S           **2            E21860
558800210712     C*********************ADD  1         S                **2            E21860
558900210712     C*********************END                             E*2            E21860
559000210712     C*********************END                             E1             E21860
559100210712     C*
559200210712     C** IF BENEFICIARY IS A BANK MAY NOT ENTER BOTH ORDERING
559300210712     C** CUSTOMER AND ORDERING BANK
559400210712     C           BENBNK    IFEQ 'Y'                        B1
559500210712     C           PMPOBN    IFNE *BLANKS                    B*2
559600210712     C           PMPOCN    ANDNE*BLANKS                    **2
559700210712     C                     MOVE '951'     ERCD,S           **2
559800210712     C                     ADD  1         S                **2
559900210712     C                     MOVE '1'       *IN31                           LN0787
560000210712     C                     END                             E*2
560100210712     C                     END                             E1
560200210712     C*
560300210712     C**IF*RECIPIENT*OF*MT100*ENTERED*BENEFICIARY*MUST*NOT*BE*A*BANK      E22405
560400210712     C***********PMRVNO    IFNE *BLANKS                    B*2            E22405
560500210712     C***********BENBNK    ANDEQ'Y'                        B1             E22405
560600210712     C*********************MOVE '955'     ERCD,S           **2            E22405
560700210712     C*********************ADD  1         S                **2            E22405
560800210712     C*********************END                             E*2            E22405
560900210712     C/COPY WNCPYSRC,SD2410C016
561000210712     C           EVAL14    TAG
561100210712     C*
561200210712     C           EVAL5     TAG
561300210712     C*
561400210712     C** BENEFICIARY A/C WITH LINE
561500210712     C** --------------------------
561600210712     C           *IN50     CABEQ'1'       EVAL15           ERROR ON FIELD
561700210712     C/COPY WNCPYSRC,SD2410C061
561800210712     C*
561900210712     C           PMBENA    IFNE *BLANK                     B1
562000210712     C                     MOVE PMBENA    PMXIBA           *1
562100210712     C*
562200210712     C** ENTRY IS ONLY ALLOWED IF ENTRY HAS BEEN MADE IN BENEFICIARY
562300210712     C           PMBENN    IFEQ *BLANK                     B*2
562400210712     C                     MOVE '999'     ERCD,S           **2
562500210712     C                     ADD  1         S                **2
562600210712     C                     MOVE '1'       *IN31                           LN0787
562700210712     C                     GOTO EVAL15                     **2
562800210712     C                     END                             E*2
562900210712     C/COPY WNCPYSRC,SD2410C017
563000210712      *****************************************************************   CSW096
563100210712      *                                                                   CSW096
563200210712      * Call Account Line Validation object                               CSW096
563300210712      *                                                                   CSW096
563400210712      * Set up parameters                                                 CSW096
563500210712      *                                                                   CSW096
563600210712     C                     MOVEL*BLANKS   W0RTN                           CSW096
563700210712     C                     CLEARI#PARM                                    CSW096
563800210712     C                     MOVEL'BENF '   I#VFLD                          CSW096
563900210712     C                     MOVEL'PAY'     I#PR                            CSW096
564000210712     C                     MOVEL'X'       I#PRTT                          CSW096
564100210712     C                     MOVELPMBENN    I#PRTY                          CSW096
564200210712     C***********          MOVELPMPCCY    I#PCCY                   CSW096 CEU003
564300210712     C***********          MOVELPMRCCY    I#RCCY                   CSW096 CEU003
564400210712     C                     MOVELWPECY     I#PCCY                          CEU003
564500210712     C                     MOVELWRECY     I#RCCY                          CEU003
564600210712     C                     MOVELPMBENA    I#ACLN                          CSW096
564700210712     C                     MOVELPMPSTM    I#PSTM                          CSW096
564800210712     C                     MOVELPMRSTM    I#RSTM                          CSW096
564900210712     C           PMPOCN    IFNE *BLANKS                                   CSW096
565000210712      *                                                                                       CSW203
565100210712      ** Set I#MTYP to "103" instead of "100" if CSW203 is installed                          CSW203
565200210712      *                                                                                       CSW203
565300210712     C           CSW203    IFEQ 'Y'                                                           CSW203
565400210712     C                     MOVEL'103'     I#MTYP                                              CSW203
565500210712     C                     ELSE                                                               CSW203
565600210712     C                     MOVEL'100'     I#MTYP                          CSW096
565700210712     C                     ENDIF                                                              CSW203
565800210712     C                     ELSE                                           CSW096
565900210712     C                     MOVEL'202'     I#MTYP                          CSW096
566000210712     C                     ENDIF                                          CSW096
566100210712      * Set up receive account information                                CSW096
566200210712     C           PMRONS    IFNE *BLANKS                                   CSW096
566300210712     C                     SELEC                                          CSW096
566400210712     C           PMROBR    WHNE *BLANKS                                   CSW096
566500210712     C           PMRONS    CAT  PMROBR    I#RCAC                          CSW096
566600210712     C           PMRONS    WHNE *BLANKS                                   CSW096
566700210712     C                     MOVELPMRONS    I#RCAC                          CSW096
566800210712     C                     ENDSL                                          CSW096
566900210712     C                     ENDIF                                          CSW096
567000210712      * Set up Pay account information                                    CSW096
567100210712     C           PMPONS    IFNE *BLANKS                                   CSW096
567200210712     C                     SELEC                                          CSW096
567300210712     C           PMPOBR    WHNE *BLANKS                                   CSW096
567400210712     C           PMPONS    CAT  PMPOBR    I#PYAC                          CSW096
567500210712     C           PMPONS    WHNE *BLANKS                                   CSW096
567600210712     C                     MOVELPMPONS    I#PYAC                          CSW096
567700210712     C                     ENDSL                                          CSW096
567800210712     C                     ENDIF                                          CSW096
567900210712      * If extra message and Rec Corr. then set 5354 field                CSW096
568000210712     C           PMRVNO    IFNE *BLANKS                                   CSW096
568100210712     C           PMRCRN    ANDNE*BLANKS                                   CSW096
568200210712     C                     MOVEL'Y'       I#5354                          CSW096
568300210712     C                     ENDIF                                          CSW096
568400210712      * Transaction Type                                                  CSW096
568500210712     C                     MOVELPMTTYP    I#TTYP                          CSW096
568600210712      *                                                                   CSW096
568700210712     C                     CLEARO#PARM                                    CSW096
568800210712     C                     CLEARE#PARM                                    CSW096
568900210712      *                                                                   CSW096
569000210712      * Send messages to correct calling process                          CSW096
569100210712      *                                                                   CSW096
569200210712     C                     SELEC                                          CSW096
569300210712     C           PMCPGM    WHEQ 'FXFX'                                    CSW096
569400210712     C                     MOVEL'ME9940'  E#CPGM                          CSW096
569500210712     C                     MOVEL'DL'      I#MMOD                          CSW096
569600210712     C           PMCPGM    WHEQ 'MMLD'                                    CSW096
569700210712     C                     MOVEL'ME9940'  E#CPGM                          CSW096
569800210712     C                     MOVEL'LE'      I#MMOD                          CSW096
569900210712     C           PMCPGM    WHEQ 'SSI '                                    CSW096
570000210712     C                     MOVEL'SD0401R' E#CPGM                          CSW096
570100210712     C                     OTHER                                          CSW096
570200210712     C                     MOVEL'ME9940'  E#CPGM                          CSW096
570300210712     C                     ENDSL                                          CSW096
570400210712     C                     MOVEL'MEC0018' E#MSGD                          CSW096
570500210712     C                     MOVEL'MEMSG'   E#MSGF                          CSW096
570600210712      *                                                                   CSW096
570700210712     C                     CALL 'ME9940'                                  CSW096
570800210712     C                     PARM           W0RTN   7                       CSW096
570900210712     C                     PARM           I#PARM           I Input Parms  CSW096
571000210712     C                     PARM           O#PARM           O Output Parms CSW096
571100210712     C                     PARM           E#PARM           E Error Inform CSW096
571200210712     C                     PARM           Z#PARM256        B User Defined CSW096
571300210712      *                                                                   CSW096
571400210712      * On return if errors copy into error array                         CSW096
571500210712      *                                                                   CSW096
571600210712     C                     MOVELO#ACLN    PMBENA                          CSW096
571700210712      *                                                                   CSW096
571800210712     C           E#ERRM    IFNE *BLANKS                                   CSW096
571900210712      *                                                                   CSW096
572000210712     C           1         DO   E#INDX    Q#      50                      CSW096
572100210712     C                     MOVEAO#E,Q#    ERCD,S                          CSW096
572200210712     C                     ADD  1         S                               CSW096
572300210712     C                     ENDDO                                          CSW096
572400210712      *                                                                   CSW096
572500210712      * Mark pay side as ib error                                         CSW096
572600210712     C                     MOVEL*ON       *IN31                           CSW096
572700210712      *                                                                   CSW096
572800210712     C                     ENDIF                                          CSW096
572900210712      *                                                                   CSW096
573000210712     C                     ENDIF                                          CSW096
573100210712      *                                                                   CSW096
573200210712      ********************************************************************CSW096
573300210712      ***********                                                         CSW096
573400210712     C***********                                                         CSW096
573500210712     C***FIRST*CHARACTER MUST BE '/'                                      CSW096
573600210712     C***********PMXIB1    IFNE '/'                        B*2            CSW096
573700210712     C***********          MOVE '981'     ERCD,S           **2            CSW096
573800210712     C***********          ADD  1         S                **2            CSW096
573900210712     C***********          MOVE '1'       *IN31                     LN0787CSW096
574000210712     C***********          GOTO EVAL15                     **2            CSW096
574100210712     C***********          END                             E*2            CSW096
574200210712     C***********                                                   060036CSW096
574300210712     C***If*1st*& 3rd character are '/',                            060036CSW096
574400210712     C***then*2nd character must be 'C' or 'D'.                     060036CSW096
574500210712     C***********                                                   060036CSW096
574600210712     C***********PMXIB1    IFEQ '/'                        B*2      060036CSW096
574700210712     C***********PMXIBE    ANDEQ'/'                        **2      060036CSW096
574800210712     C***********PMXIB2    IFNE 'C'                        B**3     060036CSW096
574900210712     C***********PMXIB2    ANDNE'D'                        ***3     060036CSW096
575000210712     C***********          MOVE '204'     ERCD,S           ***3     060036CSW096
575100210712     C***********          ADD  1         S                ***3     060036CSW096
575200210712     C***********          MOVE '1'       *IN31            ***3     060036CSW096
575300210712     C***********          END                             E**3     060036CSW096
575400210712     C***********          END                             E*2      060036CSW096
575500210712     C***********                                                         CSW096
575600210712     C***IF*SECOND CHARACTER IS ALSO '/'                                  CSW096
575700210712     C***Must*be*followed by CP, CH, FW, BL, SC or SW.              CSW095CSW096
575800210712     C***MUST*BE*FOLLOWED*BY*CP,CH,FW,BL*OR*SC**********************CSW095CSW096
575900210712     C***ENTRY*OF '//' ONLY ALLOWED WHEN BENEFICIARY IS A BANK            CSW096
576000210712     C***********PMXIB2    IFEQ '/'                        B*2            CSW096
576100210712     C***********BANKNB    IFNE 'B'                        B**3           CSW096
576200210712     C***********          MOVE '982'     ERCD,S           ***3           CSW096
576300210712     C***********          ADD  1         S                ***3           CSW096
576400210712     C***********          MOVE '1'       *IN31                     LN0787CSW096
576500210712     C***********          GOTO EVAL15                     ***3           CSW096
576600210712     C***********          ELSE                            X**3           CSW096
576700210712     C***********PMXIB4    IFNE '//CP'                     B***4          CSW096
576800210712     C***********PMXIB4    ANDNE'//CH'                     ****4          CSW096
576900210712     C***********PMXIB4    ANDNE'//FW'                     ****4          CSW096
577000210712     C***********PMXIB4    ANDNE'//BL'                     ****4          CSW096
577100210712     C***********PMXIB4    ANDNE'//SC'                     ****4          CSW096
577200210712     C***********PMXIB4    ANDNE'//SW'                     ****4    CSW095CSW096
577300210712     C***********          MOVE '983'     ERCD,S           ****4          CSW096
577400210712     C***********          ADD  1         S                ****4          CSW096
577500210712     C***********          MOVE '1'       *IN31                     LN0787CSW096
577600210712     C***********          END                             E***4          CSW096
577700210712     C***********          END                             E**3           CSW096
577800210712     C***********                                                         CSW096
577900210712     C***IF*FOLLOWED BY CP; CH; FW OR SC CURRENCY MUST BE USD             CSW096
578000210712     C***IF*FOLLOWED BY BL CURRENCY MUST BE DEM                           CSW096
578100210712      ***If*followed by SW currency must be CHF.                    CSW095CSW096
578200210712     C***********PMXIB4    IFEQ '//CP'                     B**3           CSW096
578300210712     C***********PMXIB4    OREQ '//CH'                     ***3           CSW096
578400210712     C***********PMXIB4    OREQ '//FW'                     ***3           CSW096
578500210712     C***********PMXIB4    OREQ '//SC'                     ***3           CSW096
578600210712     C***********PMXIB4    OREQ '//BL'                     ***3           CSW096
578700210712     C***********PMXIB4    OREQ '//SW'                     ***3     CSW095CSW096
578800210712     C***********          MOVE PMPCCY    KEYY             ***3           CSW096
578900210712     C***********          MOVE PMXIB4    KEYZ             ***3           CSW096
579000210712     C***********          EXSR CHKCY                      ***3           CSW096
579100210712     C***********RTCD      IFNE *BLANKS                    B*2            CSW096
579200210712     C***********          MOVE '984'     ERCD,S           ****4          CSW096
579300210712     C***********          ADD  1         S                ****4          CSW096
579400210712     C***********          MOVE '1'       *IN31                     LN0787CSW096
579500210712     C***********          GOTO EVAL15                     ****4          CSW096
579600210712     C***********          END                             E***4          CSW096
579700210712     C***********          END                             E**3           CSW096
579800210712     C***********                                                         CSW096
579900210712     C***IF*//CP*AND FOLLOWED BY BLANKS THEN DEFAULT THIS TO THE          CSW096
580000210712     C***CUSTOMERS CHIPS PARTICIPANT ONLY IF PMBENN IS A CUSTOMER         CSW096
580100210712     C***********CPBENN    IFEQ 'N'                        B**3           CSW096
580200210712     C***********PMXIB4    IFEQ '//CP'                     B***4          CSW096
580300210712     C***********PMXIB5    ANDEQ*BLANK                     ****4          CSW096
580400210712     C***********          Z-ADDBBCABA    PNXIB3           ****4    S01429CSW096
580500210712     C***********          Z-ADDBBABA2    PNXIB3           ****4    S01429CSW096
580600210712     C***********          MOVE PMXIBA    PMBENA           ****4          CSW096
580700210712     C***********          END                             E***4          CSW096
580800210712     C***********          END                             E**3           CSW096
580900210712     C***********                                                         CSW096
581000210712     C***IF*//CP*IT*MUST*BE*FOLLOWED*BY*A*3*DIGIT*NUMBER.*THE*NUMBERS01429CSW096
581100210712     C***IF*//CP*IT MUST BE FOLLOWED BY A 4 DIGIT NUMBER. THE NUMBERS01429CSW096
581200210712     C***MUST*BE*FOLLOWED BY BLANKS.                                      CSW096
581300210712     C***********PMXIB4    IFEQ '//CP'                     B**3           CSW096
581400210712     C***********          TESTN          PMXIB3     60    ***3           CSW096
581500210712     C************IN60     IFNE '1'                        NOT NUMERIC    CSW096
581600210712     C***********PMXIBX    ORNE *BLANKS                    NOT FOLL. BY BLCSW096
581700210712     C***********          MOVE '985'     ERCD,S           ****4          CSW096
581800210712     C***********          ADD  1         S                ****4          CSW096
581900210712     C***********          MOVE '1'       *IN31                     LN0787CSW096
582000210712     C***********          END                             E***4          CSW096
582100210712     C***********          END                             E**3           CSW096
582200210712     C***********                                                         CSW096
582300210712     C***IF*//FW*IT MUST BE FOLLOWED BY A 9 DIGIT NUMBER.IF BENEFICIARY   CSW096
582400210712     C***HAS*A*SWIFT ADDRESS //FW DOES NOT REQUIRE TO BE FOLLOWED BY      CSW096
582500210712     C***A*NUMBER                                                         CSW096
582600210712     C***********PMXIB4    IFEQ '//FW'                     B**3           CSW096
582700210712     C***********          TESTN          PMXIB9     60    ***3           CSW096
582800210712     C************IN60     IFNE '1'                        NOT NUMERIC    CSW096
582900210712     C***********PMXIBZ    ORNE *BLANKS                    NOT FOLL. BY BLCSW096
583000210712     C***********          MOVE '0'       *IN60            ****4          CSW096
583100210712     C***********          END                             E***4          CSW096
583200210712     C***********CPBENN    IFEQ 'N'                        B***4          CSW096
583300210712     C***********SWFT      ANDNE*BLANKS                    ****4          CSW096
583400210712     C***********PMXIB5    ANDEQ*BLANKS                    ****4          CSW096
583500210712     C***********          MOVE '1'       *IN60            ****4          CSW096
583600210712     C***********          END                             E***4          CSW096
583700210712     C***IF*SWIFT ADDRESS IS BLANK BUT THE FEDWIRE ACCOUNT NUMBER IS      CSW096
583800210712     C***PRESENT, SET UP THE FEDWIRE ACCOUNT                              CSW096
583900210712     C***********PMXIB5    IFEQ *BLANKS                    B**3           CSW096
584000210712     C***********SWFT      ANDEQ*BLANKS                    ***3           CSW096
584100210712     C***********FEDW      ANDNE*ZEROS                     ***3           CSW096
584200210712     C***********          Z-ADDFEDW      PMXIB7           ***3           CSW096
584300210712     C***********          END                             E**3           CSW096
584400210712     C***********SWFT      IFEQ *BLANKS                    B**3           CSW096
584500210712     C***********FEDW      ANDEQ*ZEROS                     ***3     S01117CSW096
584600210712     C***********PMXIB9    ANDEQ*BLANKS                    ***3     S01117CSW096
584700210712     C***********          MOVE '0'       *IN60            ***3           CSW096
584800210712     C***********          END                             E**3           CSW096
584900210712     C************IN60     IFNE '1'                        B***4          CSW096
585000210712     C***********          MOVE '985'     ERCD,S           ****4          CSW096
585100210712     C***********          ADD  1         S                ****4          CSW096
585200210712     C***********          MOVE '1'       *IN31                     LN0787CSW096
585300210712     C***********          END                             E***4          CSW096
585400210712     C***********          END                             E**3           CSW096
585500210712     C***********                                                         CSW096
585600210712     C***IF*//BL*AND FOLLOWED BY BLANKS THEN DEFAULT THIS TO THE          CSW096
585700210712     C***BANKLEITZAHL CODE ONLY IF PMBENN IS A CUSTOMER                   CSW096
585800210712     C***********CPBENN    IFEQ 'N'                        B**3           CSW096
585900210712     C***********PMXIB4    IFEQ '//BL'                     B***4          CSW096
586000210712     C***********PMXIB8    ANDEQ*BLANK                     ****4          CSW096
586100210712     C***********          MOVE BBBLCD    PMXIB8           ****4          CSW096
586200210712     C***********          MOVE PMXIBA    PMBENA           ****4          CSW096
586300210712     C***********          END                             E***4          CSW096
586400210712     C***********          END                             E**3           CSW096
586500210712     C***********                                                         CSW096
586600210712     C***IF*//BL*IT MUST BE FOLLOWED BY A 8 DIGIT NUMBER.                 CSW096
586700210712     C***********PMXIB4    IFEQ '//BL'                     B**3           CSW096
586800210712     C***********          TESTN          PMXIB8     60    ***3           CSW096
586900210712     C************IN60     IFNE '1'                        NOT NUMERIC    CSW096
587000210712     C***********PMXIBY    ORNE *BLANKS                    NOT FOLL. BY BLCSW096
587100210712     C***********          MOVE '985'     ERCD,S           ****4          CSW096
587200210712     C***********          ADD  1         S                ****4          CSW096
587300210712     C***********          MOVE '1'       *IN31                     LN0787CSW096
587400210712     C***********          END                             E***4          CSW096
587500210712     C***********          END                             E**3           CSW096
587600210712     C***********                                                         CSW096
587700210712     C***IF*//CH*AND FOLLOWED BY BLANKS THEN DEFAULT THIS TO THE          CSW096
587800210712     C***CUSTOMERS CHIPS UNIVERSAL ID. ONLY IF PMBENN IS A CUSTOMER       CSW096
587900210712     C***********CPBENN    IFEQ 'N'                        B**3           CSW096
588000210712     C***********PMXIB4    IFEQ '//CH'                     B***4          CSW096
588100210712     C***********PMXIB5    ANDEQ*BLANK                     ****4          CSW096
588200210712     C***********          Z-ADDBBCHID    PNXIB6           ****4          CSW096
588300210712     C***********          MOVE PMXIBA    PMBENA           ****4          CSW096
588400210712     C***********          END                             E***4          CSW096
588500210712     C***********          END                             E**3           CSW096
588600210712     C***********                                                         CSW096
588700210712     C***IF*//SC*AND FOLLOWED BY BLANKS THEN DEFAULT THIS TO THE          CSW096
588800210712     C***CHAPS*SORT CODE ONLY IF PMBENN IS A CUSTOMER                     CSW096
588900210712     C***********CPBENN    IFEQ 'N'                        B**3           CSW096
589000210712     C***********PMXIB4    IFEQ '//SC'                     B***4          CSW096
589100210712     C***********PMXIB5    ANDEQ*BLANK                     ****4          CSW096
589200210712     C***********          Z-ADDBBCHSC    PNXIB6           ****4          CSW096
589300210712     C***********          MOVE PMXIBA    PMBENA           ****4          CSW096
589400210712     C***********          END                             E***4          CSW096
589500210712     C***********          END                             E**3           CSW096
589600210712     C***********                                                         CSW096
589700210712     C***IF*//CH*OR //SC IT MUST BE FOLLOWED BY A 6 DIGIT NUMBER.         CSW096
589800210712      ***Also*check*//SW.************************************CSW095 094100CSW096
589900210712     C***********PMXIB4    IFEQ '//CH'                     B**3           CSW096
590000210712     C***********PMXIB4    OREQ '//SC'                     ***3           CSW096
590100210712     C***********PMXIB4    OREQ '//SW'                     **CSW095 094100CSW096
590200210712     C***********          TESTN          PMXIB6     60    ***3           CSW096
590300210712     C************IN60     IFNE '1'                        NOT NUMERIC    CSW096
590400210712     C***********PMXIBW    ORNE *BLANKS                    NOT FOLL. BY BLCSW096
590500210712     C***********          MOVE '985'     ERCD,S           ****4          CSW096
590600210712     C***********          ADD  1         S                ****4          CSW096
590700210712     C***********          MOVE '1'       *IN31                     LN0787CSW096
590800210712     C***********          END                             E***4          CSW096
590900210712     C***********          END                             E**3           CSW096
591000210712      ***********                                                   094100CSW096
591100210712      ***If*//SW*must be followed by a 5-digit number.              094100CSW096
591200210712     C***********PMXIB4    IFEQ '//SW'                     B*2      094100CSW096
591300210712     C***********          TESTN          PMXSW5     60    **2      094100CSW096
591400210712     C************IN60     IFNE '1'                        not numer094100CSW096
591500210712     C***********PMXSWW    ORNE *BLANKS                    not foll.094100CSW096
591600210712     C***********          MOVE '985'     ERCD,S           ***3     094100CSW096
591700210712     C***********          ADD  1         S                ***3     094100CSW096
591800210712     C***********          MOVE '1'       *IN31                     094100CSW096
591900210712     C***********          ENDIF                           E**3     094100CSW096
592000210712     C***********          ENDIF                           E*2      094100CSW096
592100210712     C***********          END                             E*2            CSW096
592200210712     C***********          END                             E1             CSW096
592300210712     C*
592400210712     C** VALIDATE INPUTFIELDS IN RELATION WITH OTHER FIELDS
592500210712     C*
592600210712     C***ERROR*IF*THE*BENEFICIARY*IS*NOT*A*BANK*AND*THE*INTERMEDIARY      S01412
592700210712     C***BANK*DOES*NOT*HAVE*A*SWIFT*ADDRESS*************************      S01412
592800210712     C***********PMPIBN    IFNE *BLANKS                    B1             S01412
592900210712     C********** *IN51     IFEQ '1'                        B*2            S01412
593000210712     C********** PMBENN    ANDNE*BLANKS                    **2            S01412
593100210712     C********** BENBNK    ANDEQ'N'                        **2            S01412
593200210712     C**********           MOVE '898'     ERCD,S           **2            S01412
593300210712     C**********           ADD  1         S                **2            S01412
593400210712     C**********           MOVE '1'       *IN31                     LN0787S01412
593500210712     C**********           END                             E*2            S01412
593600210712     C**********           END                             E1             S01412
593700210712     C*
593800210712     C***ENTRY*IN*RECEIVER'S*CORRESPONDANT*ONLY*ALLOWED*IF*****           S01117
593900210712     C***BENEFICIARY*IS*A*NON-BANK*AND*'RECIPIENT*OF*MT100'*IS*           S01117
594000210712     C***IS*ENTERED********************************************           S01117
594100210712     C***********PMRVNO    IFNE *BLANKS                    B1             S01117
594200210712     C***********PMRCRN    ANDNE*BLANK                     *1             S01117
594300210712     C***********BENBNK    ANDNE'N'                        B1             S01117
594400210712     C*                                                                   S01117
594500210712     C***ENTRY*IN*RECIPIENT'S*CORRESPONDENT*IS*ONLY*ALLOWED*IF*********   S01117
594600210712     C***MT100*IS*ENTERED*AND*BENEFICIARY*IS*NOT*A*BANK.***************   S01117
594700210712     C********** PMRCRN    IFNE *BLANKS                    B1             S01117
594800210712     C********** PMRVNO    IFEQ *BLANK                     B*2            S01117
594900210712     C********** BENBNK    OREQ 'Y'                        **2            S01117
595000210712     C**********           MOVE '956'     ERCD,S           **2            S01117
595100210712     C**********           ADD  1         S                **2            S01117
595200210712     C**********           END                             E*2            S01117
595300210712     C**********           END                             E1
595400210712     C*
595500210712     C/COPY WNCPYSRC,SD2410C039
595600210712     C** RECEIVER
595700210712     C           PARVNO    IFNE *BLANK                     B1
595800210712     C           PARVNO    IFEQ A8BICN                     B*2
595900210712     C           PARVNO    OREQ PNOST                      **2
596000210712     C           PARVNO    OREQ PARCRN                     **2
596100210712     C           PARVNO    OREQ PAPIBN                     **2            S01117
596200210712     C           PARVNO    OREQ PAAWBN                     **2
596300210712     C/COPY WNCPYSRC,SD2410C055
596400210712     C                     MOVE '954'     ERCD,S           **2
596500210712     C                     ADD  1         S                **2
596600210712     C                     MOVE '1'       *IN31                           LN0787
596700210712     C/COPY WNCPYSRC,SD2410C056
596800210712     C                     END                             E*2
596900210712     C                     END                             E1
597000210712     C** RECEIVER'S CORRESPONDANT
597100210712     C           PARCRN    IFNE *BLANK                     B1
597200210712     C           PARCRN    IFEQ A8BICN                     B*2
597300210712     C           PARCRN    OREQ PNOST                      **2            S01117
597400210712     C           PARCRN    OREQ PARVNO                     **2            S01117
597500210712     C           PARCRN    OREQ PAPIBN                     **2            S01117
597600210712     C/COPY WNCPYSRC,SD2410C040
597700210712     C           PARCRN    OREQ PAAWBN                     **2
597800210712     C/COPY WNCPYSRC,SD2410C041
597900210712     C                     MOVE '959'     ERCD,S           **2
598000210712     C                     ADD  1         S                **2
598100210712     C                     MOVE '1'       *IN31                           LN0787
598200210712     C                     END                             E*2
598300210712     C                     END                             E1
598400210712     C** INTERMEDIARY BANK
598500210712     C           PAPIBN    IFNE *BLANK                     B1
598600210712     C           PAPIBN    IFEQ A8BICN                     **2
598700210712     C***********PAPIBN    OREQ PNOST                      B*2            056873
598800210712     C           PAPIBN    OREQ PARVNO                     **2
598900210712     C           PAPIBN    OREQ PARCRN                     **2            S01117
599000210712     C/COPY WNCPYSRC,SD2410C042
599100210712     C***********PAPIBN    OREQ PAAWBN                     **2            E31261
599200210712     C           PAPIBN    OREQ PABENN                     **2
599300210712     C                     MOVE '964'     ERCD,S           **2
599400210712     C                     ADD  1         S                **2
599500210712     C                     MOVE '1'       *IN31                           LN0787
599600210712     C                     END                             E*2
599700210712     C*                                                                   082386
599800210712     C** IF Account With Bank not entered, Intermediary Bank should       082386
599900210712     C** also be blank                                                    082386
600000210712     C           PAAWBN    IFEQ *BLANK                     B*2            082386
600100210712     C                     MOVE '979'     ERCD,S           **2            082386
600200210712     C                     ADD  1         S                **2            082386
600300210712     C                     MOVE '1'       *IN31                           082386
600400210712     C                     END                             E*2            082386
600500210712     C                     END                             E1
600600210712     C** ACCOUNT WITH BANK
600700210712     C           PAAWBN    IFNE *BLANK                     B1
600800210712     C           PAAWBN    IFEQ A8BICN                     **2
600900210712     C*                                                                   DT0069
601000210712     C** Account With Bank can now be the same as Payment Nostro.         DT0069
601100210712     C***********PAAWBN****OREQ PNOST                      B*2            DT0069
601200210712     C           PAAWBN    OREQ PARVNO                     **2
601300210712     C           PAAWBN    OREQ PARCRN                     **2
601400210712     C/COPY WNCPYSRC,SD2410C043
601500210712     C***********PAAWBN    OREQ PAPIBN                     **2            E31261
601600210712     C********** PAAWBN    OREQ PABENN                     **2            LN0749
601700210712     C***********PAAWBN    OREQ PABENN                     **2      070083110514
601800210712     C                     MOVE '972'     ERCD,S           **2
601900210712     C                     ADD  1         S                **2
602000210712     C                     MOVE '1'       *IN31                           LN0787
602100210712     C/COPY WNCPYSRC,SD2410C057
602200210712     C                     END                             E*2
602300210712     C                     END                             E1
602400210712     C** BENEFICIARY
602500210712     C           PABENN    IFNE *BLANK                     B1
602600210712     C           PABENN    IFEQ PAPIBN                     B*2
602700210712     C********** PABENN    OREQ PAAWBN                     **2            LN0749
602800210712     C***********PABENN    OREQ PAAWBN                     **2      070083110514
602900210712     C                     MOVE '980'     ERCD,S           **2
603000210712     C                     ADD  1         S                **2
603100210712     C                     MOVE '1'       *IN31                           LN0787
603200210712     C                     END                             E*2
603300210712     C                     END                             E1
603400210712     C           EVAL15    TAG
603500210712     C*
603600210712     C** DETAILS OF PAYMENT
603700210712     C** ------------------
603800210712     C/COPY WNCPYSRC,SD2410C018
603900210712     C*
604000210712     C** MUST BE BLANK IF BENEFICIARY IS A BANK
604100210712     C           BENBNK    IFEQ 'Y'                        B1
604200210712     C           PMDTP1    IFNE *BLANK                     B*2
604300210712     C/COPY WNCPYSRC,SD2410C088
604400210712     C           PMDTP2    ORNE *BLANK                     **2
604500210712     C/COPY WNCPYSRC,SD2410C089
604600210712     C           PMDTP3    ORNE *BLANK                     **2
604700210712     C           PMDTP4    ORNE *BLANK                     **2
604800210712     C                     MOVE '987'     ERCD,S           **2
604900210712     C                     ADD  1         S                **2
605000210712     C                     MOVE '1'       *IN31                           LN0787
605100210712     C                     END                             E*2
605200210712     C                     END                             E1
605300210712     C*
605400210712     C** DETAILS OF CHARGES
605500210712     C** ------------------
605600210712     C/COPY WNCPYSRC,SD2410C019
605700210712      *                                                                                       219241
605800210712      ** Field 71, Details of Charges.  If STP PHASE 2 MT103 FOR                              219241
605900210712      ** NON-FUNDS TRANSFER is installed, Pay Settlement Method                               219241
606000210712      ** = 01, 07 or 08, and either Pay-Ordering Customer or                                  219241
606100210712      ** Beneficiary is a non-SWIFT FINANCIAL INSTITUTION default                             219241
606200210712      ** this field to "Default MT103 Details of Charges" field                               219241
606300210712      ** from Message Management ICD.                                                         219241
606400210712      *                                                                                       219241
606500210712     C           CFT013    IFEQ 'Y'                                                           219241
606600210712     C           PMDCHG    ANDEQ*BLANK                                                        219241
606700210712     C           PMPSTM    IFEQ 08                                                            219241
606800210712     C           PMPSTM    OREQ 07                                                            219241
606900210712     C           PMPSTM    OREQ 01                                                            219241
607000210712     C           CPPOCN    IFNE 'B'                                                           219241
607100210712     C           PAROBN    ANDEQ*BLANK                                                        246415
607200210712     C           BENBNK    ORNE 'Y'                                                           219241
607300210712     C                     MOVE ENDCHG    PMDCHG                                              219241
607400210712     C                     ENDIF                                                              219241
607500210712     C                     ENDIF                                                              219241
607600210712     C                     ENDIF                                                              219241
607700210712      *                                                                                       219241
607800210712     C*
607900210712     C** MUST BE BLANK IF NO MT100 MESSAGE IS TO BE PRODUCED
608000210712     C           PMDCHG    IFNE *BLANK                     B1
608100210712      ** Cater for blank CPPOCN due to blank ordering customer            082376
608200210712     C****       CPPOCN    ANDNE'N'                        *1             082376
608300210712     C********** CPPOCN    ANDEQ'Y'                        *1                          082376 219241
608400210712     C           CPPOCN    ANDEQ'B'                                                           219241
608500210712     C           BENBNK    ANDEQ'Y'                        *1
608600210712      ** Must be blank if Ordering Bank is entered and Beneficary is bank                     246415
608700210712     C           PMDCHG    ORNE *BLANK                                                        246415
608800210712     C           CPPOCN    ANDEQ' '                                                           246415
608900210712     C           PAROBN    ANDNE*BLANK                                                        246415
609000210712     C           BENBNK    ANDEQ'Y'                                                           246415
609100210712     C*****                MOVE '986'     ERCD,S           *1            S01227
609200210712     C                     MOVE '920'     ERCD,S           *1            S01227
609300210712     C                     ADD  1         S                *1
609400210712     C                     MOVE '1'       *IN31                           LN0787
609500210712     C                     END                             E1
609600210712     C*
609700210712     C** MUST BE BEN,CLM OR OUR
609800210712      *                                                                                       219241
609900210712      ** If STP Phase 2 MT103 for Non-Funds Transfer (CFT013) is                              219241
610000210712      ** installed, Details of Charges must be BEN OUR or SHA.                                219241
610100210712      *                                                                                       219241
610200210712     C           PMDCHG    IFNE *BLANK                     B1
610300210712     C           CPPOCN    ANDNE'B'                        B1
610400210712     C           PMDCHG    ORNE *BLANK                     B1
610500210712     C           BENBNK    ANDNE'Y'                        B1
610600210712     C           PMDCHG    IFNE 'BEN'                      B*2
610700210712     C           PMDCHG    ANDNE'OUR'                      **2
610800210712     C           PMDCHG    ANDNE'CLM'                      **2
610900210712     C           PMDCHG    ANDNE'SHA'                                                         214110
611000210712     C           CFT013    ANDNE'Y'                                                           219241
611100210712     C           PMDCHG    ORNE 'BEN'                                                         219241
611200210712     C           PMDCHG    ANDNE'OUR'                                                         219241
611300210712     C           PMDCHG    ANDNE'SHA'                                                         219241
611400210712     C           CFT013    ANDEQ'Y'                                                           219241
611500210712     C           PMDCHG    OREQ '?  '                                                         214110
611600210712     C*********************MOVE '986'     ERCD,S           **2            S01117
611700210712     C*********************MOVE '878'     ERCD,S           **2      S01117LN0785
611800210712     C********             MOVE '986'     ERCD,S           **2     LN0785 082376
611900210712     C**********           MOVE '961'     ERCD,S           *1                          082376 219241
612000210712     C           CFT013    IFEQ 'Y'                                                           219241
612100210712     C                     MOVE '996'     ERCD,S                                              219241
612200210712     C                     ELSE                                                               219241
612300210712     C                     MOVE '986'     ERCD,S                                              219241
612400210712     C                     ENDIF                                                              219241
612500210712     C                     ADD  1         S                **2
612600210712     C                     MOVE '1'       *IN31                           LN0787
612700210712     C                     END                             E*2
612800210712     C                     END                             E1
612900210712     C** CLM ONLY ALLOWED IF THE BENEFICIARY IS A BANK
613000210712     C           PMDCHG    IFEQ 'CLM'                      B1
613100210712     C           BENBNK    ANDNE'Y'                        *1
613200210712     C**********           MOVE '986'     ERCD,S           *1                                 219241
613300210712     C                     MOVE '961'     ERCD,S                                              219241
613400210712     C                     ADD  1         S                *1
613500210712     C                     ADD  1         S                *1
613600210712     C                     MOVE '1'       *IN31                           LN0787
613700210712     C                     END                             E1
613800210712     C/COPY WNCPYSRC,SD2410C020
613900210712     C*                                                                   CEU003
614000210712     C**  Validation of 'In' Currency in Field 72                         CEU003
614100210712     C*                                                                   CEU003
614200210712     C*                                                                   CEU003
614300210712     C**  If CEU003 is supported and not called from SD Extended          CEU003
614400210712     C**  Settlement Instructions                                         CEU003
614500210712     C*                                                                   CEU003
614600210712     C           CEU003    IFEQ 'Y'                                       CEU003
614700210712     C           PMCPGM    ANDNE'SSI'                                     CEU003
614800210712     C           PMIC72    ANDNE*BLANKS                                   CEU003
614900210712     C*                                                                   CEU003
615000210712     C           PMPSCY    IFEQ BKEURO                                    CEU003
615100210712     C           PMPSCY    OREQ *BLANKS                                   CEU003
615200210712     C           PMPCCY    ANDEQBKEURO                                    CEU003
615300210712     C*                                                                   CEU003
615400210712     C           PMPSTM    IFEQ 01                                        CEU003
615500210712     C           PMPSTM    OREQ 08                                        CEU003
615600210712     C           CLE033    OREQ 'Y'                                       CLE033
615700210712     C           PMPSTM    ANDEQ09                                        CLE033
615800210712     C*                                                                   CEU003
615900210712     C**  Access Currency Details                                         CEU003
616000210712     C*                                                                   CEU003
616100210712     C                     CALL 'AOCURRR0'                                CEU003
616200210712     C                     PARM *BLANKS   PRTCD                           CEU003
616300210712     C                     PARM '*KEY    'POPTN                           CEU003
616400210712     C                     PARM PMIC72    PCURR                           CEU003
616500210712     C           SDCURR    PARM SDCURR    DSSDY                           CEU003
616600210712     C*                                                                   CEU003
616700210712     C**  'In' ccy in field 72 is invalid                                 CEU003
616800210712     C*                                                                   CEU003
616900210712     C           PRTCD     IFNE *BLANKS                                   CEU003
617000210712     C                     MOVE '849'     ERCD,S                          CEU003
617100210712     C                     ADD  1         S                               CEU003
617200210712     C                     MOVE '1'       *IN14                           CEU003
617300210712     C                     ELSE                                           CEU003
617400210712     C*                                                                   CEU003
617500210712     C                     MOVELA6CYCD    PMIC72                          CEU003
617600210712     C*                                                                   CEU003
617700210712     C           PMPCCY    IFEQ BKEURO                                    CEU003
617800210712     C*                                                                   CEU003
617900210712     C***********WDTRP     IFLT A6TPSD                             CEU003 134935
618000210712     C***********          MOVEL'N'       A6INCY                   CEU003 134935
618100210712     C***********          ENDIF                                   CEU003 134935
618200210712     C*                                                                   CEU003
618300210712     C** Currency in field 72 is not an 'In' currency and In ccy in       CEU003
618400210712     C** field 72 is not part of EMU during the value date                CEU003
618500210712     C*                                                                   CEU003
618600210712     C           A6INCY    IFNE 'Y'                                       CEU003
618700210712     C                     MOVE '856'     ERCD,S                          CEU003
618800210712     C                     ADD  1         S                               CEU003
618900210712     C                     MOVE '1'       *IN14                           CEU003
619000210712     C                     ENDIF                                          CEU003
619100210712     C*                                                                   CEU003
619200210712     C                     ELSE                                           CEU003
619300210712     C*                                                                   CEU003
619400210712     C**  Transaction currency is an 'In' currency but the currency       CEU003
619500210712     C**  entered is not equal to the transaction currency                CEU003
619600210712     C*                                                                   CEU003
619700210712     C           PMPCCY    IFNE PMIC72                                    CEU003
619800210712     C                     MOVE '858'     ERCD,S                          CEU003
619900210712     C                     ADD  1         S                               CEU003
620000210712     C                     MOVE '1'       *IN14                           CEU003
620100210712     C                     ENDIF                                          CEU003
620200210712     C*                                                                   CEU003
620300210712     C                     ENDIF                                          CEU003
620400210712     C*                                                                   CEU003
620500210712     C                     ENDIF                                          CEU003
620600210712     C*                                                                   CEU003
620700210712     C                     ELSE                                           CEU003
620800210712     C*                                                                   CEU003
620900210712     C**  Pay settlement method is not 01 or 08                           CEU003
621000210712     C*                                                                   CEU003
621100210712     C                     MOVE '855'     ERCD,S                          CEU003
621200210712     C                     ADD  1         S                               CEU003
621300210712     C                     MOVE '1'       *IN14                           CEU003
621400210712     C                     ENDIF                                          CEU003
621500210712     C*                                                                   CEU003
621600210712     C                     ELSE                                           CEU003
621700210712     C*                                                                   CEU003
621800210712     C**  Transaction ccy is Euro but settlement ccy is not blank or      CEU003
621900210712     C**  settlement ccy is not Euro                                      CEU003
622000210712     C*                                                                   CEU003
622100210712     C                     MOVE '857'     ERCD,S                          CEU003
622200210712     C                     ADD  1         S                               CEU003
622300210712     C                     MOVE '1'       *IN14                           CEU003
622400210712     C                     ENDIF                                          CEU003
622500210712     C*                                                                   CEU003
622600210712     C                     ENDIF                                          CEU003
622700210712     C*                                                                   CEU003
622800210712     C*   Validation of Include ERI                                       CEU003
622900210712     C*                                                                   CEU003
623000210712     C*                                                                   CEU003
623100210712     C**  If CEU003 is supported and  called from SD Extended Settlement  CEU003
623200210712     C**  Instructions                                                    CEU003
623300210712     C*                                                                   CEU003
623400210712     C           CEU003    IFEQ 'Y'                                       CEU003
623500210712     C           PMCPGM    ANDEQ'SSI'                                     CEU003
623600210712     C           PMIERI    ANDNE*BLANKS                                   CEU003
623700210712     C*                                                                   CEU003
623800210712     C           PMPSCY    IFEQ BKEURO                                    CEU003
623900210712     C           PMPSCY    OREQ *BLANKS                                   CEU003
624000210712     C           PMPCCY    ANDEQBKEURO                                    CEU003
624100210712     C*                                                                   CEU003
624200210712     C**  Settlement method is not 01 or 08                               CEU003
624300210712     C*                                                                   CEU003
624400210712     C           PMPSTM    IFNE 01                                        CEU003
624500210712     C           PMPSTM    ANDNE08                                        CEU003
624600210712     C           CLE033    ANDNE'Y'                                       CLE033
624700210712     C           PMPSTM    ORNE 01                                        CLE033
624800210712     C           PMPSTM    ANDNE08                                        CLE033
624900210712     C           CLE033    ANDEQ'Y'                                       CLE033
625000210712     C           PMPSTM    ANDNE09                                        CLE033
625100210712     C                     MOVE '859'     ERCD,S                          CEU003
625200210712     C                     ADD  1         S                               CEU003
625300210712     C                     ELSE                                           CEU003
625400210712     C*                                                                   CEU003
625500210712     C*                                                                   CEU003
625600210712     C**  Value is not 'Y' or 'N'                                         CEU003
625700210712     C*                                                                   CEU003
625800210712     C           PMIERI    IFNE 'Y'                                       CEU003
625900210712     C           PMIERI    ANDNE'N'                                       CEU003
626000210712     C                     MOVE '861'     ERCD,S                          CEU003
626100210712     C                     ADD  1         S                               CEU003
626200210712     C                     ENDIF                                          CEU003
626300210712     C*                                                                   CEU003
626400210712     C                     ENDIF                                          CEU003
626500210712     C*                                                                   CEU003
626600210712     C                     ELSE                                           CEU003
626700210712     C*                                                                   CEU003
626800210712     C**  Pay currency is not Euro                                        CEU003
626900210712     C*                                                                   CEU003
627000210712     C                     MOVE '860'     ERCD,S                          CEU003
627100210712     C                     ADD  1         S                               CEU003
627200210712     C                     ENDIF                                          CEU003
627300210712     C*                                                                   CEU003
627400210712     C                     ENDIF                                          CEU003
627500210712     C*
627600210712     C** BANK TO BANK INFORMATION
627700210712     C** ------------------------
627800210712     C                     MOVEA'0000000' *IN,63
627900210712     C***********          MOVEA'0000000' *IN,70                          CEU003
628000210712     C                     MOVEA'00'      *IN,01                          CEU003
628100210712     C                     MOVEA'00'      *IN,08                          CEU003
628200210712     C                     MOVEA'00000'   *IN,80
628300210712     C                     MOVEA*BLANKS   BTB
628400210712     C                     Z-ADD0         X       10
628500210712     C*
628600210712     C** MUST BE BLANK IF SETTLEMENT TYPE IS '00'
628700210712     C           PMPSTM    IFEQ 00                         B1
628800210712     C*                                                                   S01408
628900210712     C/COPY WNCPYSRC,SD2410CP20                                           S01408
629000210712     C*                                                                   S01408
629100210712     C           PMBTB1    IFNE *BLANK                     B*2
629200210712     C           PMBTB2    ORNE *BLANK                     **2
629300210712     C           PMBTB3    ORNE *BLANK                     **2
629400210712     C           PMBTB4    ORNE *BLANK                     **2
629500210712     C           PMBTB5    ORNE *BLANK                     **2
629600210712     C           PMBTB6    ORNE *BLANK                     **2
629700210712     C                     MOVE '988'     ERCD,S           **2
629800210712     C                     ADD  1         S                **2
629900210712     C                     MOVE '1'       *IN31                           LN0787
630000210712     C                     END                             E*2
630100210712     C                     END                             E1
630200210712     C*                                                                   S01408
630300210712     C/COPY WNCPYSRC,SD2410CP12                                           S01408
630400210712      *****************************************************************   CSW096
630500210712      *                                                                   CSW096
630600210712      * Call Bank to Bank Validation object                               CSW096
630700210712      *                                                                   CSW096
630800210712      * Set up parameters                                                 CSW096
630900210712      *                                                                   CSW096
631000210712     C                     MOVEL*BLANKS   W0RTN                           CSW096
631100210712     C                     CLEARI#PARM                                    CSW096
631200210712      * Set up Control fields                                             CSW096
631300210712     C                     MOVEL':72: '   I#VFLD                          CSW096
631400210712     C                     MOVEL'PAY'     I#PR                            CSW096
631500210712      * Set up Currency fields                                            CSW096
631600210712     C***********          MOVELPMPCCY    I#PCCY                   CSW096 CEU003
631700210712     C***********          MOVELPMRCCY    I#RCCY                   CSW096 CEU003
631800210712     C                     MOVELWPECY     I#PCCY                          CEU003
631900210712     C                     MOVELWRECY     I#RCCY                          CEU003
632000210712      * Set up Intermediary                                               CSW096
632100210712     C           PMPIBN    IFNE *BLANKS                                   CSW096
632200210712     C                     MOVEL'X'       I#INBT                          CSW096
632300210712     C                     MOVELPMPIBN    I#INBK                          CSW096
632400210712     C                     ENDIF                                          CSW096
632500210712      * Set up Account with Bank                                          CSW096
632600210712     C           PMAWBN    IFNE *BLANKS                                   CSW096
632700210712     C                     MOVEL'X'       I#AWBT                          CSW096
632800210712     C                     MOVELPMAWBN    I#AWBK                          CSW096
632900210712     C                     ENDIF                                          CSW096
633000210712      * Set up Beneficiary                                                CSW096
633100210712     C           PMBENN    IFNE *BLANKS                                   CSW096
633200210712     C                     MOVEL'X'       I#BENT                          CSW096
633300210712     C                     MOVELPMBENN    I#BENF                          CSW096
633400210712     C                     ENDIF                                          CSW096
633500210712      * Move in Bank to Bank Information                                  CSW096
633600210712     C                     MOVELPMBTB1    I#BTB1                          CSW096
633700210712     C                     MOVELPMBTB2    I#BTB2                          CSW096
633800210712     C                     MOVELPMBTB3    I#BTB3                          CSW096
633900210712     C                     MOVELPMBTB4    I#BTB4                          CSW096
634000210712     C                     MOVELPMBTB5    I#BTB5                          CSW096
634100210712     C                     MOVELPMBTB6    I#BTB6                          CSW096
634200210712     C                     MOVELPMPSTM    I#PSTM                          CSW096
634300210712     C                     MOVELPMRSTM    I#RSTM                          CSW096
634400210712      * Set up receive account information                                CSW096
634500210712     C           PMRONS    IFNE *BLANKS                                   CSW096
634600210712     C                     SELEC                                          CSW096
634700210712     C           PMROBR    WHNE *BLANKS                                   CSW096
634800210712     C           PMRONS    CAT  PMROBR    I#RCAC                          CSW096
634900210712     C           PMRONS    WHNE *BLANKS                                   CSW096
635000210712     C                     MOVELPMRONS    I#RCAC                          CSW096
635100210712     C                     ENDSL                                          CSW096
635200210712     C                     ENDIF                                          CSW096
635300210712      * Set up Pay account information                                    CSW096
635400210712     C           PMPONS    IFNE *BLANKS                                   CSW096
635500210712     C                     SELEC                                          CSW096
635600210712     C           PMPOBR    WHNE *BLANKS                                   CSW096
635700210712     C           PMPONS    CAT  PMPOBR    I#PYAC                          CSW096
635800210712     C           PMPONS    WHNE *BLANKS                                   CSW096
635900210712     C                     MOVELPMPONS    I#PYAC                          CSW096
636000210712     C                     ENDSL                                          CSW096
636100210712     C                     ENDIF                                          CSW096
636200210712      * If extra message and Rec Corr. then set 5354 field                CSW096
636300210712     C           PMRVNO    IFNE *BLANKS                                   CSW096
636400210712     C           PMRCRN    ANDNE*BLANKS                                   CSW096
636500210712     C                     MOVEL'Y'       I#5354                          CSW096
636600210712     C                     ENDIF                                          CSW096
636700210712      * Set up message type                                               CSW096
636800210712     C           PMPOCN    IFNE *BLANKS                                   CSW096
636900210712      *                                                                                       CSW203
637000210712      ** Set I#MTYP to "103" instead of "100" if CSW203 is installed                          CSW203
637100210712      *                                                                                       CSW203
637200210712     C           CSW203    IFEQ 'Y'                                                           CSW203
637300210712     C                     MOVEL'103'     I#MTYP                                              CSW203
637400210712     C                     ELSE                                                               CSW203
637500210712     C                     MOVEL'100'     I#MTYP                          CSW096
637600210712     C                     ENDIF                                                              CSW203
637700210712     C                     ELSE                                           CSW096
637800210712     C                     MOVEL'202'     I#MTYP                          CSW096
637900210712     C                     ENDIF                                          CSW096
638000210712      * Transaction Type                                                  CSW096
638100210712     C                     MOVELPMTTYP    I#TTYP                          CSW096
638200210712      *                                                                   CSW096
638300210712     C                     CLEARO#PARM                                    CSW096
638400210712     C                     CLEARE#PARM                                    CSW096
638500210712      * Send messages to correct calling process                          CSW096
638600210712     C/COPY WNCPYSRC,SD2410C031
638700210712     C                     SELEC                                          CSW096
638800210712     C           PMCPGM    WHEQ 'FXFX'                                    CSW096
638900210712     C                     MOVEL'ME9950'  E#CPGM                          CSW096
639000210712     C                     MOVEL'DL'      I#MMOD                          CSW096
639100210712     C           PMCPGM    WHEQ 'MMLD'                                    CSW096
639200210712     C                     MOVEL'ME9950'  E#CPGM                          CSW096
639300210712     C                     MOVEL'LE'      I#MMOD                          CSW096
639400210712     C           PMCPGM    WHEQ 'FRIR'                                    CSW005
639500210712     C           CSW005    ANDEQ'Y'                                       CSW005
639600210712     C           PMCPGM    OREQ 'FRIR'                                    CSW011
639700210712     C           CSW011    ANDEQ'Y'                                       CSW011
639800210712     C           PMCPGM    OREQ 'FXFX'                                                        CSW212
639900210712     C           CSW212    ANDEQ'Y'                                                           CSW212
640000210712     C                     MOVEL'ME9950'  E#CPGM                          CSW005
640100210712     C                     MOVEL'DL'      I#MMOD                          CSW005
640200210712     C           PMCPGM    WHEQ 'SSI '                                    CSW096
640300210712     C                     MOVEL'SD0401R' E#CPGM                          CSW096
640400210712     C                     MOVEL'AT'      I#MMOD                          CSW096
640500210712     C                     OTHER                                          CSW096
640600210712     C                     MOVEL'ME9950'  E#CPGM                          CSW096
640700210712     C                     ENDSL                                          CSW096
640800210712      * Set standard message text                                         CSW096
640900210712     C                     MOVEL'MEC0114' E#MSGD                          CSW096
641000210712     C                     MOVEL'MEMSG'   E#MSGF                          CSW096
641100210712      *                                                                   CSW096
641200210712     C/COPY WNCPYSRC,SD2410C101
641300210712     C                     CALL 'ME9950'                                  CSW096
641400210712     C                     PARM           W0RTN   7                       CSW096
641500210712     C                     PARM           I#PARM           I Input Parms  CSW096
641600210712     C                     PARM           O#PARM           O Output Parms CSW096
641700210712     C                     PARM           E#PARM           E Error Inform CSW096
641800210712     C                     PARM           Z#PARM256        B User Defined CSW096
641900210712     C/COPY WNCPYSRC,SD2410C032
642000210712      *                                                                   CSW096
642100210712      * On return if errors copy into error array                         CSW096
642200210712      *                                                                   CSW096
642300210712     C                     MOVELO#BTB1    PMBTB1                          CSW096
642400210712     C                     MOVELO#BTB2    PMBTB2                          CSW096
642500210712     C                     MOVELO#BTB3    PMBTB3                          CSW096
642600210712     C                     MOVELO#BTB4    PMBTB4                          CSW096
642700210712     C                     MOVELO#BTB5    PMBTB5                          CSW096
642800210712     C                     MOVELO#BTB6    PMBTB6                          CSW096
642900210712     C/COPY WNCPYSRC,SD2410C102
643000210712      *                                                                   CSW005
643100210712      ** Subtract 1 from error array index                                CSW005
643200210712     C                     SUB  1         E#INDX                          CSW005
643300210712      *                                                                   CSW096
643400210712     C           E#ERRM    IFNE *BLANKS                                   CSW096
643500210712      *                                                                   CSW096
643600210712     C           1         DO   E#INDX    Q#      50                      CSW096
643700210712     C                     MOVEAO#E,Q#    ERCD,S                          CSW096
643800210712     C                     ADD  1         S                               CSW096
643900210712     C                     ENDDO                                          CSW096
644000210712      *                                                                   CSW096
644100210712      * Mark pay side as in error                                         CSW096
644200210712     C                     MOVEL*ON       *IN31                           CSW096
644300210712      *                                                                   CSW096
644400210712     C                     ENDIF                                          CSW096
644500210712      *                                                                   CSW096
644600210712      *****************************************************************   CSW096
644700210712      ***********                                                         CSW096
644800210712     C***********                                                   S01408CSW096
644900210712     C***********                                                         CSW096
645000210712     C***FIRST*BANK TO BANK INFORMATION FIELD                             CSW096
645100210712     C***********PMBTB1    IFNE *BLANKS                    B1             CSW096
645200210712     C***********          Z-ADD1         LINE    10       *1             CSW096
645300210712     C***********          MOVE PMBTB1    XBTB             *1             CSW096
645400210712     C***********SLASH2    IFEQ '//'                       B*2            CSW096
645500210712     C***********          MOVE '989'     ERCD,S           **2            CSW096
645600210712     C***********          ADD  1         S                **2            CSW096
645700210712     C***********          MOVE '1'       *IN31                     LN0787CSW096
645800210712     C***********          ELSE                            X*2            CSW096
645900210712     C***********SLASH1    IFEQ '/'                        B**3           CSW096
646000210712     C***********          MOVE '1'       *IN63            ***3           CSW096
646100210712     C***********          EXSR BTBVAL                     ***3           CSW096
646200210712     C***********BTBERR    IFNE 'E'                        B***4          CSW096
646300210712     C***********XBTB      ANDNEPMBTB1                     ****4          CSW096
646400210712     C***********          MOVE XBTB      PMBTB1           ****4          CSW096
646500210712     C***********          END                             E***4          CSW096
646600210712      ***********                                                   S01414CSW096
646700210712      ****If*entry does not begin '/' or '//', entry is now invalid S01412CSW096
646800210712     C***********          ELSE                            X**3     S01412CSW096
646900210712     C***********          MOVE '153'     ERCD,S                    S01412CSW096
647000210712     C***********          ADD  1         S                         S01412CSW096
647100210712     C***********          MOVE '1'       *IN31                     S01412CSW096
647200210712     C***********          END                             E**3           CSW096
647300210712     C***********          END                             E*2            CSW096
647400210712     C***********          END                             E1             CSW096
647500210712     C***********                                                         CSW096
647600210712     C***SECOND*BANK TO BANK INFORMATION FIELD                            CSW096
647700210712     C***********PMBTB2    IFNE *BLANKS                    B1             CSW096
647800210712     C***********          Z-ADD2         LINE             *1             CSW096
647900210712     C***********          MOVE PMBTB2    XBTB             *1             CSW096
648000210712     C***********SLASH2    IFEQ '//'                       B*2            CSW096
648100210712     C***********          MOVE '1'       *IN80            **2            CSW096
648200210712      ****If*entry begins with "//", it cannot be followed          096151CSW096
648300210712      ****by*all*blanks.                                            096151CSW096
648400210712     C***********BLKCHK    IFEQ *BLANKS                    B**3     096151CSW096
648500210712     C***********          MOVE '153'     ERCD,S           ***3     096151CSW096
648600210712     C***********          ADD  1         S                ***3     096151CSW096
648700210712     C***********          MOVE '1'       *IN31                     096151CSW096
648800210712     C***********          END                             E**3     096151CSW096
648900210712     C************IN63     IFNE '1'                        B**3           CSW096
649000210712     C***********          MOVE '989'     ERCD,S           ***3           CSW096
649100210712     C***********          ADD  1         S                ***3           CSW096
649200210712     C*********************                                  092396 096151CSW096
649300210712     C*********************ELSE                              092396 096151CSW096
649400210712     C*********************MOVE PMBTB2    BLK33  33          092396 096151CSW096
649500210712     C***********BLK33*****IFEQ *BLANKS                      092396 096151CSW096
649600210712     C*********************MOVE '989'     ERCD,S             092396 096151CSW096
649700210712     C*********************ADD  1         S                  092396 096151CSW096
649800210712     C*********************END                               092396 096151CSW096
649900210712     C*********************                                  092396 096151CSW096
650000210712     C***********          MOVE '1'       *IN31                     LN0787CSW096
650100210712     C***********          END                             E**3           CSW096
650200210712     C***********          ELSE                            X*2            CSW096
650300210712     C***********SLASH1    IFEQ '/'                        B**3           CSW096
650400210712     C***********          MOVEA'000'     *IN,71           ***3     S01412CSW096
650500210712     C***********          EXSR BTBVAL                     ***3           CSW096
650600210712     C***********BTBERR    IFNE 'E'                        B***4          CSW096
650700210712     C***********XBTB      ANDNEPMBTB2                     ****4          CSW096
650800210712     C***********          MOVE XBTB      PMBTB2           ****4          CSW096
650900210712     C***********          END                             E***4          CSW096
651000210712      ***********                                                   S01414CSW096
651100210712      ****If*entry does not begin '/' or '//', entry is now invalid S01412CSW096
651200210712     C***********          ELSE                            X**3     S01412CSW096
651300210712     C***********          MOVE '153'     ERCD,S                    S01412CSW096
651400210712     C***********          ADD  1         S                         S01412CSW096
651500210712     C***********          MOVE '1'       *IN31                     S01412CSW096
651600210712     C***********          END                             E**3           CSW096
651700210712     C***********          END                             E*2            CSW096
651800210712     C***********SLASH1    IFEQ '/'                        B*2            CSW096
651900210712     C***********          MOVE '1'       *IN64            **2            CSW096
652000210712     C***********          END                             E*2            CSW096
652100210712     C***********          END                             E1             CSW096
652200210712     C***IF*/IBK/*ENTERED*A*MAXIMUM*OF*1*LINE*MAY*BE*USED*OPTIONALLYS01412CSW096
652300210712     C***PRECEDED*BY*AN*ACCOUNT*NUMBER*LINE*************************S01412CSW096
652400210712     C************IN72     IFEQ '1'                                 S01412CSW096
652500210712     C************IN80     ANDEQ'1'                                 S01412CSW096
652600210712     C***********          MOVE '998'     ERCD,S                    S01412CSW096
652700210712     C***********          ADD  1         S                         S01412CSW096
652800210712     C***********          MOVE '1'       *IN31               LN0787S01412CSW096
652900210712     C***********          END                                      S01412CSW096
653000210712     C***********                                                         CSW096
653100210712     C***THIRD*BANK TO BANK INFORMATION FIELD                             CSW096
653200210712     C***********PMBTB3    IFNE *BLANKS                    B1             CSW096
653300210712     C***********          Z-ADD3         LINE             *1             CSW096
653400210712     C***********          MOVE PMBTB3    XBTB             *1             CSW096
653500210712     C***********SLASH2    IFEQ '//'                       B*2            CSW096
653600210712     C***********          MOVE '1'       *IN81            **2            CSW096
653700210712      ****If*entry begins with "//", it cannot be followed          096151CSW096
653800210712      ****by*all*blanks.                                            096151CSW096
653900210712     C***********BLKCHK    IFEQ *BLANKS                    B**3     096151CSW096
654000210712     C***********          MOVE '153'     ERCD,S           ***3     096151CSW096
654100210712     C***********          ADD  1         S                ***3     096151CSW096
654200210712     C***********          MOVE '1'       *IN31                     096151CSW096
654300210712     C***********          END                             E**3     096151CSW096
654400210712     C************IN64     IFNE '1'                        B**3           CSW096
654500210712     C***********          MOVE '989'     ERCD,S           ***3           CSW096
654600210712     C***********          ADD  1         S                ***3           CSW096
654700210712     C***********          MOVE '1'       *IN31                     LN0787CSW096
654800210712     C***********          END                             E**3           CSW096
654900210712     C***********          ELSE                            X*2            CSW096
655000210712     C***********SLASH1    IFEQ '/'                        B**3           CSW096
655100210712     C***********          MOVEA'000'     *IN,71           ***3     S01412CSW096
655200210712     C***********          EXSR BTBVAL                     ***3           CSW096
655300210712     C***********BTBERR    IFNE 'E'                        B***4          CSW096
655400210712     C***********XBTB      ANDNEPMBTB3                     ****4          CSW096
655500210712     C***********          MOVE XBTB      PMBTB3           ****4          CSW096
655600210712     C***********          END                             E***4          CSW096
655700210712      ***********                                                   S01414CSW096
655800210712      ****If*entry does not begin '/' or '//', entry is now invalid S01412CSW096
655900210712     C***********          ELSE                            X**3     S01412CSW096
656000210712     C***********          MOVE '153'     ERCD,S                    S01412CSW096
656100210712     C***********          ADD  1         S                         S01412CSW096
656200210712     C***********          MOVE '1'       *IN31                     S01412CSW096
656300210712     C***********          END                             E**3           CSW096
656400210712     C***********          END                             E*2            CSW096
656500210712     C***********SLASH1    IFEQ '/'                        B*2            CSW096
656600210712     C***********          MOVE '1'       *IN65            **2            CSW096
656700210712     C***********          END                             E*2            CSW096
656800210712     C***********          END                             E1             CSW096
656900210712     C***********                                                         CSW096
657000210712     C***IF*/INS/ OR /OGB/ ENTERED A MAXIMUM OF 2 LINES MAY BE USED       CSW096
657100210712     C***IF*/IBK/*ENTERED*A*MAXIMUM*OF*1*LINE*MAY*BE*USED*OPTIONALLYS01412CSW096
657200210712     C***PRECEDED BY AN ACCOUNT NUMBER LINE                               CSW096
657300210712     C************IN71     IFEQ '1'                                       CSW096
657400210712     C************IN73     OREQ '1'                                 S01412CSW096
657500210712     C************IN80     IFEQ '1'                                       CSW096
657600210712     C************IN81     ANDEQ'1'                                       CSW096
657700210712     C***********          MOVE '998'     ERCD,S                          CSW096
657800210712     C***********          ADD  1         S                               CSW096
657900210712     C***********          MOVE '1'       *IN31                     LN0787CSW096
658000210712     C***********          END                                            CSW096
658100210712     C***********          END                                            CSW096
658200210712     C************IN72     IFEQ '1'                                 S01412CSW096
658300210712     C************IN81     ANDEQ'1'                                 S01412CSW096
658400210712     C***********          MOVE '998'     ERCD,S                    S01412CSW096
658500210712     C***********          ADD  1         S                         S01412CSW096
658600210712     C***********          MOVE '1'       *IN31               LN0787S01412CSW096
658700210712     C***********          END                                      S01412CSW096
658800210712     C***********                                                         CSW096
658900210712     C***FOURTH*BANK TO BANK INFORMATION FIELD                            CSW096
659000210712     C***********PMBTB4    IFNE *BLANKS                    B1             CSW096
659100210712     C***********          Z-ADD4         LINE             *1             CSW096
659200210712     C***********          MOVE PMBTB4    XBTB             *1             CSW096
659300210712     C***********SLASH2    IFEQ '//'                       B*2            CSW096
659400210712     C***********          MOVE '1'       *IN82            **2            CSW096
659500210712      ****If*entry begins with "//", it cannot be followed          096151CSW096
659600210712      ****by*all*blanks.                                            096151CSW096
659700210712     C***********BLKCHK    IFEQ *BLANKS                    B**3     096151CSW096
659800210712     C***********          MOVE '153'     ERCD,S           ***3     096151CSW096
659900210712     C***********          ADD  1         S                ***3     096151CSW096
660000210712     C***********          MOVE '1'       *IN31                     096151CSW096
660100210712     C***********          END                             E**3     096151CSW096
660200210712     C************IN65     IFNE '1'                        B**3           CSW096
660300210712     C***********          MOVE '989'     ERCD,S           ***3           CSW096
660400210712     C***********          ADD  1         S                ***3           CSW096
660500210712     C***********          MOVE '1'       *IN31                     LN0787CSW096
660600210712     C***********          END                             E**3           CSW096
660700210712     C***********          ELSE                            X*2            CSW096
660800210712     C***********SLASH1    IFEQ '/'                        B**3           CSW096
660900210712     C***********          MOVEA'000'     *IN,71           ***3     S01412CSW096
661000210712     C***********          EXSR BTBVAL                     ***3           CSW096
661100210712     C***********BTBERR    IFNE 'E'                        B***4          CSW096
661200210712     C***********XBTB      ANDNEPMBTB4                     ****4          CSW096
661300210712     C***********          MOVE XBTB      PMBTB4           ****4          CSW096
661400210712     C***********          END                             E***4          CSW096
661500210712      ***********                                                   S01414CSW096
661600210712      ****If*entry does not begin '/' or '//', entry is now invalid S01412CSW096
661700210712     C***********          ELSE                            X**3     S01412CSW096
661800210712     C***********          MOVE '153'     ERCD,S                    S01412CSW096
661900210712     C***********          ADD  1         S                         S01412CSW096
662000210712     C***********          MOVE '1'       *IN31                     S01412CSW096
662100210712     C***********          END                             E**3           CSW096
662200210712     C***********          END                             E*2            CSW096
662300210712     C***********SLASH1    IFEQ '/'                        B*2            CSW096
662400210712     C***********          MOVE '1'       *IN66            **2            CSW096
662500210712     C***********          END                             E*2            CSW096
662600210712     C***********          END                             E1             CSW096
662700210712     C***********                                                         CSW096
662800210712     C***IF*/INS/ OR /OGB/ ENTERED A MAXIMUM OF 2 LINES MAY BE USED       CSW096
662900210712     C***IF*/IBK/*ENTERED*A*MAXIMUM*OF*1*LINE*MAY*BE*USED*OPTIONALLYS01412CSW096
663000210712     C***PRECEDED BY AN ACCOUNT NUMBER LINE                               CSW096
663100210712     C************IN71     IFEQ '1'                                       CSW096
663200210712     C************IN73     OREQ '1'                                 S01412CSW096
663300210712     C************IN81     IFEQ '1'                                       CSW096
663400210712     C************IN82     ANDEQ'1'                                       CSW096
663500210712     C***********          MOVE '998'     ERCD,S                          CSW096
663600210712     C***********          ADD  1         S                               CSW096
663700210712     C***********          MOVE '1'       *IN31                     LN0787CSW096
663800210712     C***********          END                                            CSW096
663900210712     C***********          END                                            CSW096
664000210712     C************IN72     IFEQ '1'                                 S01412CSW096
664100210712     C************IN82     ANDEQ'1'                                 S01412CSW096
664200210712     C***********          MOVE '998'     ERCD,S                    S01412CSW096
664300210712     C***********          ADD  1         S                         S01412CSW096
664400210712     C***********          MOVE '1'       *IN31               LN0787S01412CSW096
664500210712     C***********          END                                      S01412CSW096
664600210712     C***********                                                         CSW096
664700210712     C***FIFTH*BANK TO BANK INFORMATION FIELD                             CSW096
664800210712     C***********PMBTB5    IFNE *BLANKS                    B1             CSW096
664900210712     C***********          Z-ADD5         LINE             *1             CSW096
665000210712     C***********          MOVE PMBTB5    XBTB             *1             CSW096
665100210712     C***********SLASH2    IFEQ '//'                       B*2            CSW096
665200210712     C***********          MOVE '1'       *IN83            **2            CSW096
665300210712      ****If*entry begins with "//", it cannot be followed          096151CSW096
665400210712      ****by*all*blanks.                                            096151CSW096
665500210712     C***********BLKCHK    IFEQ *BLANKS                    B**3     096151CSW096
665600210712     C***********          MOVE '153'     ERCD,S           ***3     096151CSW096
665700210712     C***********          ADD  1         S                ***3     096151CSW096
665800210712     C***********          MOVE '1'       *IN31                     096151CSW096
665900210712     C***********          END                             E**3     096151CSW096
666000210712     C************IN66     IFNE '1'                        B**3           CSW096
666100210712     C***********          MOVE '989'     ERCD,S           ***3           CSW096
666200210712     C***********          ADD  1         S                ***3           CSW096
666300210712     C***********          MOVE '1'       *IN31                     LN0787CSW096
666400210712     C***********          END                             E**3           CSW096
666500210712     C***********          ELSE                            X*2            CSW096
666600210712     C***********SLASH1    IFEQ '/'                        B**3           CSW096
666700210712     C***********          MOVEA'000'     *IN,71           ***3     S01412CSW096
666800210712     C***********          EXSR BTBVAL                     ***3           CSW096
666900210712     C***********BTBERR    IFNE 'E'                        B***4          CSW096
667000210712     C***********XBTB      ANDNEPMBTB5                     ****4          CSW096
667100210712     C***********          MOVE XBTB      PMBTB5           ****4          CSW096
667200210712     C***********          END                             E***4          CSW096
667300210712      ***********                                                   S01414CSW096
667400210712      ****If*entry does not begin '/' or '//', entry is now invalid S01412CSW096
667500210712     C***********          ELSE                            X**3     S01412CSW096
667600210712     C***********          MOVE '153'     ERCD,S                    S01412CSW096
667700210712     C***********          ADD  1         S                         S01412CSW096
667800210712     C***********          MOVE '1'       *IN31                     S01412CSW096
667900210712     C***********          END                             E**3           CSW096
668000210712     C***********          END                             E*2            CSW096
668100210712     C***********SLASH1    IFEQ '/'                        B*2            CSW096
668200210712     C***********          MOVE '1'       *IN67            **2            CSW096
668300210712     C***********          END                             E*2            CSW096
668400210712     C***********          END                             E1             CSW096
668500210712     C***********                                                         CSW096
668600210712     C***IF*/INS/ OR /OGB/ ENTERED A MAXIMUM OF 2 LINES MAY BE USED       CSW096
668700210712     C***IF*/IBK/*ENTERED*A*MAXIMUM*OF*1*LINE*MAY*BE*USED.********* S01412CSW096
668800210712     C***********                                                         CSW096
668900210712     C************IN71     IFEQ '1'                                       CSW096
669000210712     C************IN82     IFEQ '1'                                       CSW096
669100210712     C************IN83     ANDEQ'1'                                       CSW096
669200210712     C***********          MOVE '998'     ERCD,S                          CSW096
669300210712     C***********          ADD  1         S                               CSW096
669400210712     C***********          MOVE '1'       *IN31                     LN0787CSW096
669500210712     C***********          END                                            CSW096
669600210712     C***********          END                                            CSW096
669700210712     C************IN72     IFEQ '1'                                 S01412CSW096
669800210712     C************IN83     ANDEQ'1'                                 S01412CSW096
669900210712     C***********          MOVE '998'     ERCD,S                    S01412CSW096
670000210712     C***********          ADD  1         S                         S01412CSW096
670100210712     C***********          MOVE '1'       *IN31               LN0787S01412CSW096
670200210712     C***********          END                                      S01412CSW096
670300210712     C***********                                                         CSW096
670400210712     C***ERROR*IF*/IBK/*ENTERED*WITH*AN*ACCOUNT*LINE*IN*LINE*5******S01412CSW096
670500210712     C***********LINE      IFEQ 5                                   S01412CSW096
670600210712     C************IN73     ANDEQ'1'                                 S01412CSW096
670700210712     C************IN83     ANDEQ'0'                                 S01412CSW096
670800210712     C***********          MOVE '891'     ERCD,S                    S01412CSW096
670900210712     C***********          ADD  1         S                         S01412CSW096
671000210712     C***********          MOVE '1'       *IN31               LN0787S01412CSW096
671100210712     C***********          END                                      S01412CSW096
671200210712     C***********                                                         CSW096
671300210712     C***SIXTH*BANK TO BANK INFORMATION FIELD                             CSW096
671400210712     C***********PMBTB6    IFNE *BLANKS                    B1             CSW096
671500210712     C***********          Z-ADD6         LINE             *1             CSW096
671600210712     C***********          MOVE PMBTB6    XBTB             *1             CSW096
671700210712     C***********SLASH2    IFEQ '//'                       B*2            CSW096
671800210712     C***********          MOVE '1'       *IN84            **2            CSW096
671900210712      ****If*entry begins with "//", it cannot be followed          096151CSW096
672000210712      ****by*all*blanks.                                            096151CSW096
672100210712     C***********BLKCHK    IFEQ *BLANKS                    B**3     096151CSW096
672200210712     C***********          MOVE '153'     ERCD,S           ***3     096151CSW096
672300210712     C***********          ADD  1         S                ***3     096151CSW096
672400210712     C***********          MOVE '1'       *IN31                     096151CSW096
672500210712     C***********          END                             E**3     096151CSW096
672600210712     C************IN67     IFNE '1'                        B**3           CSW096
672700210712     C***********          MOVE '989'     ERCD,S           ***3           CSW096
672800210712     C***********          ADD  1         S                ***3           CSW096
672900210712     C***********          MOVE '1'       *IN31                     LN0787CSW096
673000210712     C***********          END                             E**3           CSW096
673100210712     C***********          ELSE                            X*2            CSW096
673200210712     C***********SLASH1    IFEQ '/'                        B**3           CSW096
673300210712     C***********          MOVEA'000'     *IN,71           ***3     S01412CSW096
673400210712     C***********          EXSR BTBVAL                     ***3           CSW096
673500210712     C***********BTBERR    IFNE 'E'                        B***4          CSW096
673600210712     C***********XBTB      ANDNEPMBTB6                     ****4          CSW096
673700210712     C***********          MOVE XBTB      PMBTB6           ****4          CSW096
673800210712     C***********          END                             E***4          CSW096
673900210712      ***********                                                   S01414CSW096
674000210712      ****If*entry does not begin '/' or '//', entry is now invalid S01412CSW096
674100210712     C***********          ELSE                            X**3     S01412CSW096
674200210712     C***********          MOVE '153'     ERCD,S                    S01412CSW096
674300210712     C***********          ADD  1         S                         S01412CSW096
674400210712     C***********          MOVE '1'       *IN31                     S01412CSW096
674500210712     C***********          END                             E**3           CSW096
674600210712     C***********          END                             E*2            CSW096
674700210712     C***********SLASH1    IFEQ '/'                        B*2            CSW096
674800210712     C***********          MOVE '1'       *IN68            **2            CSW096
674900210712     C***********          END                             E*2            CSW096
675000210712     C***********          END                             E1             CSW096
675100210712     C***********                                                         CSW096
675200210712     C***IF*/INS/ OR /OGB/ ENTERED A MAXIMUM OF 2 LINES MAY BE USED       CSW096
675300210712     C************IN71     IFEQ '1'                                       CSW096
675400210712     C************IN83     ANDEQ'1'                                       CSW096
675500210712     C************IN84     ANDEQ'1'                                       CSW096
675600210712     C***********          MOVE '998'     ERCD,S                          CSW096
675700210712     C***********          ADD  1         S                               CSW096
675800210712     C***********          MOVE '1'       *IN31                     LN0787CSW096
675900210712     C***********          END                                            CSW096
676000210712     C***********                                                         CSW096
676100210712     C***ERROR*IF*/IBK/*ENTERED*IN*LINE*6************************   S01412CSW096
676200210712     C***********LINE      IFEQ 6                                   S01412CSW096
676300210712     C************IN73     IFEQ '1'                                 S01412CSW096
676400210712     C************IN72     OREQ '1'                                 S01412CSW096
676500210712     C***********          MOVE '891'     ERCD,S                    S01412CSW096
676600210712     C***********          ADD  1         S                         S01412CSW096
676700210712     C***********          MOVE '1'       *IN31               LN0787S01412CSW096
676800210712     C***********          ELSE                                     S01412CSW096
676900210712     C***********                                                         CSW096
677000210712     C***ERROR*IF*/IBK/*ENTERED*AND*ALL*SIX*BANK*TO*BANK*LINES*HAVE*S01412CSW096
677100210712     C***BEEN*USED**************************************************S01412CSW096
677200210712     C************IN74     IFEQ '1'                                 S01412CSW096
677300210712     C***********PMBTB1    ANDNE*BLANKS                             S01412CSW096
677400210712     C***********PMBTB2    ANDNE*BLANKS                             S01412CSW096
677500210712     C***********PMBTB3    ANDNE*BLANKS                             S01412CSW096
677600210712     C***********PMBTB4    ANDNE*BLANKS                             S01412CSW096
677700210712     C***********PMBTB5    ANDNE*BLANKS                             S01412CSW096
677800210712     C***********PMBTB6    ANDNE*BLANKS                             S01412CSW096
677900210712     C***********          MOVE '891'     ERCD,S                    S01412CSW096
678000210712     C***********          ADD  1         S                         S01412CSW096
678100210712     C***********          MOVE '1'       *IN31               LN0787S01412CSW096
678200210712     C***********          END                                      S01412CSW096
678300210712     C***********          END                                      S01412CSW096
678400210712     C***********          END                                      S01412CSW096
678500210712     C***********                                                         CSW096
678600210712     C***/INT/*MAY ONLY BE USED IF FIELD 56 INTERMEDIARY BANK IS          CSW096
678700210712     C***ENTERED*                                                   S01412CSW096
678800210712     C***ENTERED*OR*/IBK/*IN*FIELD*72*IS*ENTERED********************S01412CSW096
678900210712     C************IN76     IFEQ '1'                                       CSW096
679000210712     C***********PMPIBN    ANDEQ*BLANKS                                   CSW096
679100210712     C************IN74     ANDEQ'0'                                 S01412CSW096
679200210712     C***********          MOVE '893'     ERCD,S                          CSW096
679300210712     C***********          ADD  1         S                               CSW096
679400210712     C***********          MOVE '1'       *IN31                     LN0787CSW096
679500210712     C***********          END                                            CSW096
679600210712     C***********                                                         CSW096
679700210712     C***/CABLEIBK/, /PHONIBK/ AND /TELEXIBK/ MAY ONLY BE USED IF         CSW096
679800210712     C***FIELD*56 INTERMEDIARY BANK IS ENTERED                      S01412CSW096
679900210712     C***FIELD*56*INTERMEDIARY*BANK*IS*ENTERED*OR*/IBK/*IN*FIELD*72*S01412CSW096
680000210712     C***ENTERED****************************************************S01412CSW096
680100210712     C************IN75     IFEQ '1'                                       CSW096
680200210712     C***********PMPIBN    ANDEQ*BLANKS                                   CSW096
680300210712     C************IN74     ANDEQ'0'                                 S01412CSW096
680400210712     C***********          MOVE '894'     ERCD,S                          CSW096
680500210712     C***********          ADD  1         S                               CSW096
680600210712     C***********          MOVE '1'       *IN31                     LN0787CSW096
680700210712     C***********          END                                            CSW096
680800210712     C***********                                                         CSW096
680900210712     C***FREE*TEXT MUST BE ENTERED AFTER ALL CODE WORDS AND               CSW096
681000210712     C***CONTINUATION LINES                                               CSW096
681100210712     C************IN63     IFNE '1'                        B1             CSW096
681200210712     C************IN64     IFEQ '1'                        B*2            CSW096
681300210712     C************IN65     OREQ '1'                        **2            CSW096
681400210712     C************IN66     OREQ '1'                        **2            CSW096
681500210712     C************IN67     OREQ '1'                        **2            CSW096
681600210712     C************IN68     OREQ '1'                        **2            CSW096
681700210712     C***********          MOVE '994'     ERCD,S           **2            CSW096
681800210712     C***********          ADD  1         S                **2            CSW096
681900210712     C***********          MOVE '1'       *IN31                     LN0787CSW096
682000210712     C***********          GOTO V01END                     **2            CSW096
682100210712     C***********          END                             E*2            CSW096
682200210712     C***********          END                             E1             CSW096
682300210712     C************IN64     IFNE '1'                        B1             CSW096
682400210712     C************IN65     IFEQ '1'                        B*2            CSW096
682500210712     C************IN66     OREQ '1'                        **2            CSW096
682600210712     C************IN67     OREQ '1'                        **2            CSW096
682700210712     C************IN68     OREQ '1'                        **2            CSW096
682800210712     C***********          MOVE '994'     ERCD,S           **2            CSW096
682900210712     C***********          ADD  1         S                **2            CSW096
683000210712     C***********          MOVE '1'       *IN31                     LN0787CSW096
683100210712     C***********          GOTO V01END                     **2            CSW096
683200210712     C***********          END                             E*2            CSW096
683300210712     C***********          END                             E1             CSW096
683400210712     C************IN65     IFNE '1'                        B1             CSW096
683500210712     C************IN66     IFEQ '1'                        B*2            CSW096
683600210712     C************IN67     OREQ '1'                        **2            CSW096
683700210712     C************IN68     OREQ '1'                        **2            CSW096
683800210712     C***********          MOVE '994'     ERCD,S           **2            CSW096
683900210712     C***********          ADD  1         S                **2            CSW096
684000210712     C***********          MOVE '1'       *IN31                     LN0787CSW096
684100210712     C***********          GOTO V01END                     **2            CSW096
684200210712     C***********          END                             E*2            CSW096
684300210712     C***********          END                             E1             CSW096
684400210712     C************IN66     IFNE '1'                        B1             CSW096
684500210712     C************IN67     IFEQ '1'                        B*2            CSW096
684600210712     C************IN68     OREQ '1'                        **2            CSW096
684700210712     C***********          MOVE '994'     ERCD,S           **2            CSW096
684800210712     C***********          ADD  1         S                *1             CSW096
684900210712     C***********          MOVE '1'       *IN31                     LN0787CSW096
685000210712     C***********          GOTO V01END                     **2            CSW096
685100210712     C***********          END                             E*2            CSW096
685200210712     C***********          END                             E1             CSW096
685300210712     C************IN67     IFNE '1'                        B1             CSW096
685400210712     C************IN68     ANDEQ'1'                        B1             CSW096
685500210712     C***********          MOVE '994'     ERCD,S           *1             CSW096
685600210712     C***********          ADD  1         S                *1             CSW096
685700210712     C***********          MOVE '1'       *IN31                     LN0787CSW096
685800210712     C***********          END                             E1             CSW096
685900210712     C***********                                                         CSW096
686000210712     C*                                                                   S01408
686100210712     C/COPY WNCPYSRC,SD2410CP11                                           S01408
686200210712     C*                                                                   S01408
686300210712     C**                                                                  S01117
686400210712     C** The following code has been moved further up the program         S01117
686500210712     C** as the Branch validation has been done too late.                 S01117
686600210712     C**                                                                  S01117
686700210712     C***SETTLEMENT*BRANCH***************************************         S01117
686800210712     C** -----------------                                                S01117
686900210712     C**                                                                  S01117
687000210712     C***IF*MULTIBRANCHING*FLAG*IS*OFF*SKIP*FURTHER*VALIDATION***         S01117
687100210712     C***********@MBIN     IFEQ 'N'                        B1             S01117
687200210712     C*********************GOTO EVAL17                     *1             S01117
687300210712     C*********************END                             E1             S01117
687400210712     C*                                                                   S01117
687500210712     C***SETTLEMENT*BRANCH*ONLY*ALLOWED*WITH*SETTLEMENT*METHOD*5**        S01117
687600210712      ***ONLY*VALIDATE*IF*USER*SET*UP*********************                S01117
687700210712     C***********PMPSTM    IFNE 05                         B1             S01117
687800210712     C***********PBRF      ANDEQ*BLANKS                    B1             S01117
687900210712     C*                                                                   S01117
688000210712     C***Validate*Pay*Branch*if*user*set*up.*********************         S01117
688100210712     C***********PBRF      IFEQ *BLANKS                    B*2            S01117
688200210712     C***********PMOSSB    IFNE *BLANKS                    B*2            S01117
688300210712     C***********PMPOBR    IFNE *BLANKS                    B*2            S01117
688400210712     C*********************MOVE '883'     ERCD,S           **2            S01117
688500210712     C*********************ADD  1         S                **2            S01117
688600210712     C*********************END                             E*2            S01117
688700210712     C*********************END                             E*2            S01117
688800210712     C*                                                                   S01117
688900210712     C*********************ELSE                            X1             S01117
689000210712     C*                                                                   S01117
689100210712     C***SETTLEMENT*BRANCH*MANDATORY*WITH*SETTLEMENT*METHOD*5****         S01117
689200210712     C***********PMOSSB    IFEQ *BLANKS                    B*2            S01117
689300210712     C***********PMPOBR    IFEQ *BLANKS                    B*2            S01117
689400210712     C*********************MOVE '882'     ERCD,S           **2            S01117
689500210712     C*********************ADD  1         S                **2            S01117
689600210712     C*                                                                   S01117
689700210712     C*********************ELSE                            X*2            S01117
689800210712     C*                                                                   S01117
689900210712     C***VALIDATE*SETTLEMENT*BRANCH******************************         S01117
690000210712     C*********************MOVE PMOSSB    @OBR    3        **2            S01117
690100210712     C*********************MOVE PMPOBR    @OBR    3        **2            S01117
690200210712     C*********************EXSR CHKBR                      **2            S01117
690300210712     C***********@RTCD     IFNE *BLANKS                    B**3           S01117
690400210712     C*********************MOVE '881'     ERCD,S           ***3           S01117
690500210712     C*********************ADD  1         S                ***3           S01117
690600210712     C*********************ELSE                            ***3           S01117
690700210712     C*********************MOVE @DSNB     PMPOBR           ***3           S01117
690800210712     C*********************END                             E**3           S01117
690900210712     C*********************END                             E*2            S01117
691000210712     C*********************END                             E1             S01117
691100210712     C*                                                                   S01117
691200210712     C*                                                                   S01117
691300210712     C***********EVAL17    TAG                                            S01117
691400210712     C*                                                                   CSW005
691500210712     C**  Validate new FRA/IRS settlement fields:                         CSW005
691600210712     C**  ---------------------------------------                         CSW005
691700210712     C*                                                                   CSW005
691800210712     C           CSW005    IFEQ 'Y'                                       CSW005
691900210712     C           PMCPGM    ANDEQ'FRIR'                                    CSW005
692000210712     C           CSW005    OREQ 'Y'                                       CSW005
692100210712     C           PMCPGM    ANDEQ'SSI '                                    CSW005
692200210712     C           CSW011    OREQ 'Y'                                       CSW011
692300210712     C           PMCPGM    ANDEQ'FRIR'                                    CSW011
692400210712     C           CSW011    OREQ 'Y'                                       CSW011
692500210712     C           PMCPGM    ANDEQ'SSI '                                    CSW011
692600210712     C           CSW212    OREQ 'Y'                                                           CSW212
692700210712     C           PMCPGM    ANDEQ'FXFX'                                                        CSW212
692800210712     C           CSW212    OREQ 'Y'                                                         AR995086
692900210712     C           PMCPGM    ANDEQ'SSI '                                                      AR995086
693000210712     C*                                                                   CSW005
693100210712     C**  First, convert Agreement Type to disregard leading blanks       CSW005
693200210712     C*                                                                   CSW005
693300210712     C           SDAGTY    IFNE *BLANKS                                   CSW005
693400210712     C*                                                                   CSW005
693500210712     C           PMTTYP    IFEQ 'RS'                                      CSW005
693600210712     C           PMTTYP    OREQ 'RX'                                      CSW005
693700210712     C           PMTTYP    OREQ 'DV'                                                         BUG7139
693800210712     C           CDL031    ANDEQ'Y'                                                          BUG7139
693900210712     C           PMTTYP    OREQ 'FR'                                      CSW097
694000210712     C           PMCPGM    OREQ 'SSI '                                    CSW005
694100210712     C           PMTTYP    ANDEQ'AT'                                      CSW005
694200210712     C           CSW005    ANDEQ'Y'                                       CSW011
694300210712     C           PMTTYP    OREQ 'AT'                                                          CSW212
694400210712     C           CSW212    ANDEQ'Y'                                                           CSW212
694500210712     C           PMTTYP    OREQ 'FX'                                                          CSW212
694600210712     C           CSW212    ANDEQ'Y'                                                           CSW212
694700210712     C           PMTTYP    OREQ 'OP'                                                          CSW212
694800210712     C           CSW212    ANDEQ'Y'                                                           CSW212
694900210712     C           PMTTYP    OREQ 'FF'                                                          CSW212
695000210712     C           CSW212    ANDEQ'Y'                                                           CSW212
695100210712     C           PMTTYP    OREQ 'CL'                                                          CSW212
695200210712     C           CDL008    ANDEQ'Y'                                                           CSW212
695300210712     C           CSW212    ANDEQ'Y'                                                           CSW212
695400210712     C*                                                                   CSW005
695500210712     C                     MOVELSDAGTY    ##FLD   6                       CSW005
695600210712     C           1         DO   6         X       10                      CSW005
695700210712     C           1         SUBSTSDAGTY:X  ##001   1                       CSW005
695800210712     C           ##001     IFNE *BLANKS                                   CSW005
695900210712     C                     LEAVE                                          CSW005
696000210712     C                     ENDIF                                          CSW005
696100210712     C                     ENDDO                                          CSW005
696200210712     C*                                                                   CSW005
696300210712     C                     SUBST##FLD:X   SDAGTY    P                     CSW005
696400210712     C*                                                                   CSW005
696500210712     C                     ENDIF                                          CSW005
696600210712     C                     ENDIF                                          CSW005
696700210712     C*                                                                   CSW005
696800210712     C**  Definition Confirmation Sender to Receiver                      CSW005
696900210712     C*                                                                   CSW005
697000210712     C                     CLEARI#PARM                                    CSW005
697100210712     C                     CLEARE#PARM                                    CSW005
697200210712     C                     CLEARO#PARM                                    CSW005
697300210712     C*                                                                   CSW005
697400210712     C                     MOVEL':72: '   I#VFLD    P                     CSW005
697500210712     C                     MOVELPMTTYP    I#TTYP                          CSW005
697600210712     C                     MOVEL'FI'      I#MMOD                          CSW005
697700210712     C           PMAWBN    IFNE *BLANKS                                   CSW005
697800210712     C                     MOVEL'X'       I#AWBT                          CSW005
697900210712     C                     MOVELPMAWBN    I#AWBK                          CSW005
698000210712     C                     ENDIF                                          CSW005
698100210712     C                     MOVELSDDSR1    I#BTB1                          CSW005
698200210712     C                     MOVELSDDSR2    I#BTB2                          CSW005
698300210712     C                     MOVELSDDSR3    I#BTB3                          CSW005
698400210712     C                     MOVELSDDSR4    I#BTB4                          CSW005
698500210712     C                     MOVELSDDSR5    I#BTB5                          CSW005
698600210712     C                     MOVELSDDSR6    I#BTB6                          CSW005
698700210712      *                                                                   CSW005
698800210712     C                     MOVEL*BLANKS   W#MSTX  1                                           CSW212
698900210712     C           CSW212    IFEQ 'Y'                                                           CSW212
699000210712     C           I#TTYP    IFEQ 'AT'                                                          CSW212
699100210712     C           I#TTYP    OREQ 'FX'                                                          CSW212
699200210712     C           I#TTYP    OREQ 'OP'                                                          CSW212
699300210712     C           I#TTYP    OREQ 'FF'                                                          CSW212
699400210712     C           I#TTYP    OREQ 'CL'                                                          CSW212
699500210712     C           CDL008    ANDEQ'Y'                                                           CSW212
699600210712      *                                                                                       CSW212
699700210712      **  Field is allowed if Cover MT202 indicator is Y                                      CSW212
699800210712      *                                                                                       CSW212
699900210712     C                     MOVELPMCVMR    I#COVR                                              CSW212
700000210712     C           I#BTB     IFNE *BLANKS                                                       CSW212
700100210712     C           I#COVR    ANDNE'Y'                                                           CSW212
700200210712     C                     MOVE '421'     ERCD,S                                              CSW212
700300210712     C                     ADD  1         S                                                   CSW212
700400210712     C                     ENDIF                                                              CSW212
700500210712      *                                                                                       CSW212
700600210712     C                     MOVEL'DL'      I#MMOD                                              CSW212
700700210712     C                     MOVELPMPSTM    I#PSTM                                              CSW212
700800210712      *                                                                                       CSW212
700900210712     C           I#TTYP    IFNE 'AT'                                                          CSW212
701000210712     C           I#TTYP    OREQ 'AT'                                                          CSW212
701100210712     C           CSW005    ANDEQ'N'                                                           CSW212
701200210712     C           CSW011    ANDEQ'N'                                                           CSW212
701300210712     C                     MOVEL'202'     I#MTYP                                              CSW212
701400210712     C                     ENDIF                                                              CSW212
701500210712      *                                                                                       CSW212
701600210712      ** Map Beneficiary with Receipient of Pay Inst.                                         CSW212
701700210712      *                                                                                       CSW212
701800210712     C           PARVNO    IFNE *BLANKS                                                       CSW212
701900210712     C                     MOVELPARVNO    I#BENF                                              CSW212
702000210712     C                     MOVEL'X'       I#BENT                                              CSW212
702100210712     C                     ENDIF                                                              CSW212
702200210712      *                                                                                       CSW212
702300210712      ** Map Intermediary bank with Pay-Our Nostro                                            CSW212
702400210712      *                                                                                       CSW212
702500210712     C           PMPONS    IFNE *BLANKS                                                       CSW212
702600210712     C                     MOVELPMPCCY    @CYCD                                               CSW212
702700210712     C                     MOVELPMPONS    @NONB                                               CSW212
702800210712     C                     EXSR CHKNO                                                         CSW212
702900210712     C                     MOVELA7CUST    I#INBK                                              CSW212
703000210712     C                     MOVEL'X'       I#INBT                                              CSW212
703100210712     C                     ENDIF                                                              CSW212
703200210712      *                                                                                       CSW212
703300210712      ** Map Account with Bank with Receiver's Correspondent                                  CSW212
703400210712      *                                                                                       CSW212
703500210712     C           PARCRN    IFNE *BLANKS                                                       CSW212
703600210712     C                     MOVEL'X'       I#AWBT                                              CSW212
703700210712     C                     MOVELPARCRN    I#AWBK                                              CSW212
703800210712     C                     ENDIF                                                              CSW212
703900210712      *                                                                                       CSW212
704000210712      ** Set standard message text                                                            CSW212
704100210712      *                                                                                       CSW212
704200210712     C                     MOVEL'MEC2311' E#MSGD                                              CSW212
704300210712     C                     MOVEL'Y'       W#MSTX                                              CSW212
704400210712      *                                                                                       CSW212
704500210712     C                     ENDIF                                                              CSW212
704600210712     C                     ENDIF                                                              CSW212
704700210712      *                                                                                       CSW212
704800210712     C                     SELEC                                          CSW005
704900210712     C           PMCPGM    WHEQ 'FRIR'                                    CSW005
705000210712     C           PMCPGM    OREQ 'FXFX'                                                        CSW212
705100210712     C           CSW212    ANDEQ'Y'                                                           CSW212
705200210712     C                     MOVEL'SD2400'  E#CPGM                          CSW005
705300210712     C           PMCPGM    WHEQ 'SSI '                                    CSW005
705400210712     C**********           MOVEL'SD0402R' E#CPGM                                     CSW005 AR992011
705500210712     C                     MOVELPMDPGM    E#CPGM                                            AR992011
705600210712     C           E#CPGM    IFNE 'SD0402R'                                                   AR992011
705700210712     C                     MOVEL*BLANKS   I#BTB                                             AR992011
705800210712     C                     ENDIF                                                            AR992011
705900210712     C                     OTHER                                          CSW005
706000210712     C                     MOVEL'ME9950'  E#CPGM                          CSW005
706100210712     C                     ENDSL                                          CSW005
706200210712      *                                                                   CSW005
706300210712      * Set standard message text                                         CSW005
706400210712     C           W#MSTX    IFNE 'Y'                                                           CSW212
706500210712     C                     MOVEL'MEC0201' E#MSGD                          CSW005
706600210712     C                     ENDIF                                                              CSW212
706700210712     C                     MOVEL'MEMSG'   E#MSGF                          CSW005
706800210712      *                                                                   CSW005
706900210712     C                     CALL 'ME9950'                                  CSW005
707000210712     C                     PARM           W0RTN   7                       CSW005
707100210712     C                     PARM           I#PARM           I Input Parms  CSW005
707200210712     C                     PARM           O#PARM           O Output Parms CSW005
707300210712     C                     PARM           E#PARM           E Error Inform CSW005
707400210712     C                     PARM           Z#PARM256        B User Defined CSW005
707500210712      *                                                                   CSW005
707600210712      * On return if errors copy into error array                         CSW005
707700210712      *                                                                   CSW005
707800210712     C                     MOVELO#BTB1    SDDSR1                          CSW005
707900210712     C                     MOVELO#BTB2    SDDSR2                          CSW005
708000210712     C                     MOVELO#BTB3    SDDSR3                          CSW005
708100210712     C                     MOVELO#BTB4    SDDSR4                          CSW005
708200210712     C                     MOVELO#BTB5    SDDSR5                          CSW005
708300210712     C                     MOVELO#BTB6    SDDSR6                          CSW005
708400210712      *                                                                   CSW005
708500210712      ** Subtract 1 from error array index                                CSW005
708600210712     C                     SUB  1         E#INDX                          CSW005
708700210712      *                                                                   CSW005
708800210712     C           E#WARN    IFEQ 'Y'                                                           CSW214
708900210712     C           CSW214    IFEQ 'Y'                                                           CSW214
709000210712     C           O#E,1     IFEQ '899'                                                         CSW214
709100210712     C                     MOVE '899'     ERCD,S                                              CSW214
709200210712     C                     ADD  1         S                                                   CSW214
709300210712     C                     ENDIF                                                              CSW214
709400210712     C                     ENDIF                                                              CSW214
709500210712     C                     ENDIF                                                              CSW214
709600210712      *                                                                                       CSW214
709700210712     C           E#ERRM    IFNE *BLANKS                                   CSW005
709800210712     C                     MOVE 'X01'     ERCD,S                          CSW005
709900210712     C                     ADD  1         S                               CSW005
710000210712     C                     ENDIF                                          CSW005
710100210712     C*                                                                   CSW005
710200210712     C**  Settlement/Reset Confirmation Sender to Receiver                CSW005
710300210712     C*                                                                   CSW005
710400210712     C                     CLEARI#PARM                                    CSW005
710500210712     C                     CLEARE#PARM                                    CSW005
710600210712     C                     CLEARO#PARM                                    CSW005
710700210712     C*                                                                   CSW005
710800210712     C                     MOVEL':72: '   I#VFLD    P                     CSW005
710900210712     C                     MOVELPMTTYP    I#TTYP                          CSW005
711000210712     C                     MOVEL*BLANKS   W#MSTX                                              CSW212
711100210712     C           CSW212    IFEQ 'Y'                                                           CSW212
711200210712     C           I#TTYP    IFEQ 'AT'                                                          CSW212
711300210712     C           I#TTYP    OREQ 'FX'                                                          CSW212
711400210712     C           I#TTYP    OREQ 'OP'                                                          CSW212
711500210712     C           I#TTYP    OREQ 'FF'                                                          CSW212
711600210712     C           I#TTYP    OREQ 'CL'                                                          CSW212
711700210712     C           CDL008    ANDEQ'Y'                                                           CSW212
711800210712     C                     MOVEL'DL'      I#MMOD                                              CSW212
711900210712     C                     MOVELPMCVMR    I#COVR                                              CSW212
712000210712     C                     MOVELPMPSTM    I#PSTM                                              CSW212
712100210712     C                     MOVEL'MEC2312' E#MSGD                                              CSW212
712200210712     C                     MOVEL'Y'       W#MSTX                                              CSW212
712300210712     C           I#TTYP    IFNE 'AT'                                                          CSW212
712400210712     C           I#TTYP    OREQ 'AT'                                                          CSW212
712500210712     C           CSW005    ANDEQ'N'                                                           CSW212
712600210712     C           CSW011    ANDEQ'N'                                                           CSW212
712700210712     C                     MOVEL'300'     I#MTYP                                              CSW212
712800210712     C                     ENDIF                                                              CSW212
712900210712      *                                                                                       CMG003
713000210712      ** Set Message Type to '600' if CMG003 is ON                                            CMG003
713100210712      ** and Precious Metal Ind of the currency is Y                                          CMG003
713200210712      *                                                                                       CMG003
713300210712     C           CMG003    IFEQ 'Y'                                                           CMG003
713400210712     C                     MOVELPMPCCY    I#PCCY                                              CMG003
713500210712     C                     CALL 'AOCURRR0'                                                    CMG003
713600210712     C                     PARM *BLANKS   PRTCD                                               CMG003
713700210712     C                     PARM '*KEY   ' POPTN                                               CMG003
713800210712     C                     PARM I#PCCY    PCURR                                               CMG003
713900210712     C           SDCURR    PARM SDCURR    DSSDY                                               CMG003
714000210712      *                                                                                       CMG003
714100210712     C           PRTCD     IFEQ *BLANKS                                                       CMG003
714200210712     C           A6PMRT    ANDEQ'Y'                                                           CMG003
714300210712     C                     MOVEL'600'     I#MTYP                                              CMG003
714400210712     C                     ENDIF                                                              CMG003
714500210712     C                     ENDIF                                                              CMG003
714600210712      *                                                                                       CMG003
714700210712     C**********           ENDIF                                                     CSW212 MD022522
714800210712     C                     ELSE                                                               CSW212
714900210712     C                     MOVEL'FI'      I#MMOD                          CSW005
715000210712     C                     ENDIF                                                              CSW212
715100210712     C                     ENDIF                                                            MD022522
715200210712     C           PMAWBN    IFNE *BLANKS                                   CSW005
715300210712     C                     MOVEL'X'       I#AWBT                          CSW005
715400210712     C                     MOVELPMAWBN    I#AWBK                          CSW005
715500210712     C                     ENDIF                                          CSW005
715600210712     C                     MOVELSDSSR1    I#BTB1                          CSW005
715700210712     C                     MOVELSDSSR2    I#BTB2                          CSW005
715800210712     C                     MOVELSDSSR3    I#BTB3                          CSW005
715900210712     C                     MOVELSDSSR4    I#BTB4                          CSW005
716000210712     C                     MOVELSDSSR5    I#BTB5                          CSW005
716100210712     C                     MOVELSDSSR6    I#BTB6                          CSW005
716200210712      *                                                                   CSW005
716300210712     C                     SELEC                                          CSW005
716400210712     C           PMCPGM    WHEQ 'FRIR'                                    CSW005
716500210712     C           PMCPGM    OREQ 'FXFX'                                                        CSW212
716600210712     C           CSW212    ANDEQ'Y'                                                           CSW212
716700210712     C                     MOVEL'SD2400'  E#CPGM                          CSW005
716800210712     C           PMCPGM    WHEQ 'SSI '                                    CSW005
716900210712     C**********           MOVEL'SD0402R' E#CPGM                                     CSW005 AR992011
717000210712     C                     MOVELPMDPGM    E#CPGM                                            AR992011
717100210712     C           E#CPGM    IFNE 'SD0402R'                                                   AR992011
717200210712     C                     MOVEL*BLANKS   I#BTB                                             AR992011
717300210712     C                     ENDIF                                                            AR992011
717400210712     C                     OTHER                                          CSW005
717500210712     C                     MOVEL'ME9950'  E#CPGM                          CSW005
717600210712     C                     ENDSL                                          CSW005
717700210712      *                                                                   CSW005
717800210712      * Set standard message text                                         CSW005
717900210712     C           W#MSTX    IFNE 'Y'                                                           CSW212
718000210712     C                     MOVEL'MEC0202' E#MSGD                          CSW005
718100210712     C                     ENDIF                                                              CSW212
718200210712     C                     MOVEL'MEMSG'   E#MSGF                          CSW005
718300210712      *                                                                   CSW005
718400210712     C                     CALL 'ME9950'                                  CSW005
718500210712     C                     PARM           W0RTN   7                       CSW005
718600210712     C                     PARM           I#PARM           I Input Parms  CSW005
718700210712     C                     PARM           O#PARM           O Output Parms CSW005
718800210712     C                     PARM           E#PARM           E Error Inform CSW005
718900210712     C                     PARM           Z#PARM256        B User Defined CSW005
719000210712      *                                                                   CSW005
719100210712      * On return if errors copy into error array                         CSW005
719200210712      *                                                                   CSW005
719300210712     C                     MOVELO#BTB1    SDSSR1                          CSW005
719400210712     C                     MOVELO#BTB2    SDSSR2                          CSW005
719500210712     C                     MOVELO#BTB3    SDSSR3                          CSW005
719600210712     C                     MOVELO#BTB4    SDSSR4                          CSW005
719700210712     C                     MOVELO#BTB5    SDSSR5                          CSW005
719800210712     C                     MOVELO#BTB6    SDSSR6                          CSW005
719900210712      *                                                                   CSW005
720000210712      ** Subtract 1 from error array index                                CSW005
720100210712     C                     SUB  1         E#INDX                          CSW005
720200210712      *                                                                   CSW005
720300210712     C           E#WARN    IFEQ 'Y'                                                           CSW214
720400210712     C           CSW214    IFEQ 'Y'                                                           CSW214
720500210712     C           O#E,1     IFEQ '899'                                                         CSW214
720600210712     C                     MOVE '899'     ERCD,S                                              CSW214
720700210712     C                     ADD  1         S                                                   CSW214
720800210712     C                     ENDIF                                                              CSW214
720900210712     C                     ENDIF                                                              CSW214
721000210712     C                     ENDIF                                                              CSW214
721100210712      *                                                                                       CSW214
721200210712     C           E#ERRM    IFNE *BLANKS                                   CSW005
721300210712     C                     MOVE 'X02'     ERCD,S                          CSW005
721400210712     C                     ADD  1         S                               CSW005
721500210712     C                     ENDIF                                          CSW005
721600210712     C*                                                                   CSW005
721700210712     C**  Conditions                                                      CSW005
721800210712     C*                                                                   CSW005
721900210712     C**     Condition 1 mandatory if Agreement type is 'OTHER'           CSW005
722000210712     C*                                                                   CSW005
722100210712     C           PMTTYP    IFEQ 'RS'                                      CSW005
722200210712     C           PMTTYP    OREQ 'RX'                                      CSW005
722300210712     C           PMTTYP    OREQ 'DV'                                                         BUG7139
722400210712     C           CDL031    ANDEQ'Y'                                                          BUG7139
722500210712     C           PMCPGM    OREQ 'SSI '                                    CSW005
722600210712     C           PMTTYP    ANDEQ'AT'                                      CSW005
722700210712     C           CSW005    ANDEQ'Y'                                       CSW011
722800210712     C           PMTTYP    OREQ 'AT'                                                          CSW212
722900210712     C           CSW212    ANDEQ'Y'                                                           CSW212
723000210712     C           PMTTYP    OREQ 'FX'                                                          CSW212
723100210712     C           CSW212    ANDEQ'Y'                                                           CSW212
723200210712     C           PMTTYP    OREQ 'OP'                                                          CSW212
723300210712     C           CSW212    ANDEQ'Y'                                                           CSW212
723400210712     C           PMTTYP    OREQ 'FF'                                                          CSW212
723500210712     C           CSW212    ANDEQ'Y'                                                           CSW212
723600210712     C           PMTTYP    OREQ 'CL'                                                          CSW212
723700210712     C           CDL008    ANDEQ'Y'                                                           CSW212
723800210712     C           CSW212    ANDEQ'Y'                                                           CSW212
723900210712     C           SDAGTY    IFEQ 'OTHER'                                   CSW005
724000210712     C           SDCND1    ANDEQ*BLANKS                                   CSW005
724100210712     C                     MOVE '400'     ERCD,S                          CSW005
724200210712     C                     ADD  1         S                               CSW005
724300210712     C                     ENDIF                                          CSW005
724400210712     C                     ENDIF                                          CSW005
724500210712     C*                                                                   CSW005
724600210712     C**     Other validation                                             CSW005
724700210712     C*                                                                   CSW005
724800210712     C                     CLEARI#PARM                                    CSW005
724900210712     C                     CLEARE#PARM                                    CSW005
725000210712     C                     CLEARO#PARM                                    CSW005
725100210712      * Set standard message text                                         CSW005
725200210712     C                     MOVEL'MEC0203' E#MSGD                          CSW005
725300210712     C                     MOVEL'MEMSG'   E#MSGF                          CSW005
725400210712     C*                                                                   CSW005
725500210712     C                     MOVEL':77D:'   I#VFLD    P                     CSW005
725600210712     C                     MOVELPMTTYP    I#TTYP    P                     CSW005
725700210712     C                     MOVEL'FI'      I#MMOD                          CSW005
725800210712     C           CSW212    IFEQ 'Y'                                                           CSW212
725900210712     C           I#TTYP    IFEQ 'AT'                                                          CSW212
726000210712     C           I#TTYP    OREQ 'FX'                                                          CSW212
726100210712     C           I#TTYP    OREQ 'OP'                                                          CSW212
726200210712     C           I#TTYP    OREQ 'FF'                                                          CSW212
726300210712     C           I#TTYP    OREQ 'CL'                                                          CSW212
726400210712     C           CDL008    ANDEQ'Y'                                                           CSW212
726500210712     C                     MOVEL'DL'      I#MMOD                                              CSW212
726600210712     C                     MOVEL'300'     I#MTYP                                              CSW213
726700210712     C           CSW213    IFEQ 'Y'                                                           CSW213
726800210712     C                     MOVELPMPCCY    I#PCCY                                              CSW213
726900210712     C                     CALL 'AOCURRR0'                                                    CSW213
727000210712     C                     PARM '       ' PRTCD                                               CSW213
727100210712     C                     PARM '*KEY   ' POPTN                                               CSW213
727200210712     C                     PARM I#PCCY    PCURR                                               CSW213
727300210712     C           SDCURR    PARM SDCURR    DSSDY                                               CSW213
727400210712     C           PRTCD     IFEQ *BLANKS                                                       CSW213
727500210712     C           A6PMRT    IFEQ 'Y'                                                           CSW213
727600210712     C                     MOVEL'600'     I#MTYP                                              CSW213
727700210712     C                     ENDIF                                                              CSW213
727800210712     C                     ENDIF                                                              CSW213
727900210712     C                     ENDIF                                                              CSW213
728000210712     C                     ENDIF                                                              CSW212
728100210712     C                     ENDIF                                                              CSW212
728200210712     C                     MOVELSDCND1    I#BTB1                          CSW005
728300210712     C                     MOVELSDCND2    I#BTB2                          CSW005
728400210712     C                     MOVELSDCND3    I#BTB3                          CSW005
728500210712     C                     MOVELSDCND4    I#BTB4                          CSW005
728600210712     C                     MOVELSDCND5    I#BTB5                          CSW005
728700210712     C                     MOVELSDCND6    I#BTB6                          CSW005
728800210712      *                                                                   CSW005
728900210712     C                     SELEC                                          CSW005
729000210712     C           PMCPGM    WHEQ 'FRIR'                                    CSW005
729100210712     C           PMCPGM    OREQ 'FXFX'                                                        CSW212
729200210712     C           CSW212    ANDEQ'Y'                                                           CSW212
729300210712     C                     MOVEL'SD2400'  E#CPGM                          CSW005
729400210712     C           PMCPGM    WHEQ 'SSI '                                    CSW005
729500210712     C**********           MOVEL'SD0402R' E#CPGM                                     CSW005 AR992011
729600210712     C                     MOVELPMDPGM    E#CPGM                                            AR992011
729700210712     C           E#CPGM    IFNE 'SD0402R'                                                   AR992011
729800210712     C                     MOVEL*BLANKS   I#BTB                                             AR992011
729900210712     C                     ENDIF                                                            AR992011
730000210712     C                     OTHER                                          CSW005
730100210712     C                     MOVEL'ME9950'  E#CPGM                          CSW005
730200210712     C                     ENDSL                                          CSW005
730300210712      *                                                                   CSW005
730400210712     C                     CALL 'ME9960'                                  CSW005
730500210712     C                     PARM           W0RTN   7                       CSW005
730600210712     C                     PARM           I#PARM           I Input Parms  CSW005
730700210712     C                     PARM           O#PARM           O Output Parms CSW005
730800210712     C                     PARM           E#PARM           E Error Inform CSW005
730900210712     C                     PARM           Z#PARM256        B User Defined CSW005
731000210712      *                                                                   CSW005
731100210712      * On return if errors copy into error array                         CSW005
731200210712      *                                                                   CSW005
731300210712     C                     MOVELO#BTB1    SDCND1                          CSW005
731400210712     C                     MOVELO#BTB2    SDCND2                          CSW005
731500210712     C                     MOVELO#BTB3    SDCND3                          CSW005
731600210712     C                     MOVELO#BTB4    SDCND4                          CSW005
731700210712     C                     MOVELO#BTB5    SDCND5                          CSW005
731800210712     C                     MOVELO#BTB6    SDCND6                          CSW005
731900210712      *                                                                   CSW005
732000210712      ** Subtract 1 from error array index                                CSW005
732100210712     C                     SUB  1         E#INDX                          CSW005
732200210712      *                                                                   CSW005
732300210712     C           E#ERRM    IFNE *BLANKS                                   CSW005
732400210712     C           1         DO   E#INDX    Q#      50                      CSW005
732500210712     C                     MOVEAO#E,Q#    ERCD,S                          CSW005
732600210712     C                     ADD  1         S                               CSW005
732700210712     C                     ENDDO                                          CSW005
732800210712     C                     ENDIF                                          CSW005
732900210712     C*                                                                   CSW005
733000210712     C           PMTTYP    IFEQ 'RS'                                      CSW005
733100210712     C           PMTTYP    OREQ 'RX'                                      CSW005
733200210712     C           PMTTYP    OREQ 'DV'                                                         BUG7139
733300210712     C           CDL031    ANDEQ'Y'                                                          BUG7139
733400210712     C           PMTTYP    OREQ 'FR'                                      CSW097
733500210712     C           PMCPGM    OREQ 'SSI '                                    CSW005
733600210712     C           PMTTYP    ANDEQ'AT'                                      CSW005
733700210712     C           CSW005    ANDEQ'Y'                                       CSW011
733800210712     C           PMCPGM    OREQ 'SSI '                                    CSW200
733900210712     C           PMTTYP    ANDEQ'AT'                                      CSW200
734000210712     C           CSW011    ANDEQ'Y'                                       CSW200
734100210712     C           CSW200    ANDEQ'Y'                                       CSW200
734200210712     C           PMTTYP    OREQ 'AT'                                                          CSW212
734300210712     C           CSW212    ANDEQ'Y'                                                           CSW212
734400210712     C           PMTTYP    OREQ 'FX'                                                          CSW212
734500210712     C           CSW212    ANDEQ'Y'                                                           CSW212
734600210712     C           PMTTYP    OREQ 'OP'                                                          CSW212
734700210712     C           CSW212    ANDEQ'Y'                                                           CSW212
734800210712     C           PMTTYP    OREQ 'FF'                                                          CSW212
734900210712     C           CSW212    ANDEQ'Y'                                                           CSW212
735000210712     C           PMTTYP    OREQ 'CL'                                                          CSW212
735100210712     C           CDL008    ANDEQ'Y'                                                           CSW212
735200210712     C           CSW212    ANDEQ'Y'                                                           CSW212
735300210712      *                                                                                       CSW214
735400210712      ** ISDA Agreement Type is mandatory for MT600                                           CSW214
735500210712      *                                                                                       CSW214
735600210712     C           CSW214    IFEQ 'Y'                                                           CSW214
735700210712     C           I#MTYP    ANDEQ'600'                                                         CSW214
735800210712     C           SDAGTY    ANDEQ*BLANKS                                                       CSW214
735900210712     C                     MOVE '422'     ERCD,S                                              CSW214
736000210712     C                     ADD  1         S                                                   CSW214
736100210712     C                     ENDIF                                                              CSW214
736200210712      **********                                                                   MD030342 MD030943
736300210712      ***Valid*values*for*Agreement*type*for*MT600*                                MD030342 MD030943
736400210712      **********                                                                   MD030342 MD030943
736500210712     C********** I#MTYP    IFEQ '600'                                              MD030342 MD030943
736600210712     C********** SDAGTY    ANDNE*BLANKS                                            MD030342 MD030943
736700210712     C********** SDAGTY    IFNE 'ISDA'                                             MD030342 MD030943
736800210712     C********** SDAGTY    ANDNE'OTHER'                                            MD030342 MD030943
736900210712     C**********           MOVE '423'     ERCD,S                                   MD030342 MD030943
737000210712     C**********           ADD  1         S                                        MD030342 MD030943
737100210712     C**********           ENDIF                                                   MD030342 MD030943
737200210712     C**********           ENDIF                                                   MD030342 MD030943
737300210712      **********                                                                   MD030342 MD030943
737400210712     C*                                                                   CSW005
737500210712     C           PMTTYP    IFEQ 'RS'                                      CSW097
737600210712     C           PMTTYP    OREQ 'RX'                                      CSW097
737700210712     C           PMTTYP    OREQ 'DV'                                                         BUG7139
737800210712     C           CDL031    ANDEQ'Y'                                                          BUG7139
737900210712     C           PMTTYP    OREQ 'AT'                                      CSW097
738000210712     C           CSW005    ANDEQ'Y'                                       CSW200
738100210712     C*                                                                   CSW097
738200210712     C**  Allow all blank entry for type AT only                          CSW097
738300210712     C*                                                                   CSW097
738400210712     C           SDISDA    IFNE *BLANKS                                   CSW097
738500210712     C           SDAGTY    ORNE *BLANKS                                   CSW097
738600210712     C           SDAGDT    ORNE *BLANKS                                   CSW097
738700210712     C           SDAGVV    ORNE *BLANKS                                   CSW097
738800210712     C           PMTTYP    OREQ 'RS'                                      CSW097
738900210712     C           PMTTYP    OREQ 'RX'                                      CSW097
739000210712     C           PMTTYP    OREQ 'DV'                                                         BUG7139
739100210712     C           CDL031    ANDEQ'Y'                                                          BUG7139
739200210712     C*                                                                   CSW097
739300210712     C**  ISDA Rules version must be numeric                              CSW005
739400210712     C**  RS/RX                                                           CSW097
739500210712     C*                                                                   CSW005
739600210712     C           SDAGTY    IFNE 'ISDA'                                    CSW097
739700210712     C           SDAGTY    ANDNE'OTHER'                                   CSW097
739800210712     C           SDISDA    IFNE *BLANKS                                   CSW097
739900210712     C           SDISDA    ANDNE'0000'                                    CSW097
740000210712     C                     MOVE '407'     ERCD,S                          CSW097
740100210712     C                     ADD  1         S                               CSW097
740200210712     C                     ENDIF                                          CSW097
740300210712     C                     ENDIF                                          CSW097
740400210712     C*                                                                   CSW097
740500210712     C           SDAGTY    IFEQ 'ISDA'                                    CSW097
740600210712     C           SDAGTY    OREQ 'OTHER'                                   CSW097
740700210712     C           SDISDA    ANDNE*BLANKS                                   CSW097
740800210712     C                     MOVE '0'       WISDA   5                       CSW097
740900210712     C                     MOVELSDISDA    WISDA                           CSW097
741000210712     C                     TESTN          WISDA      60                   CSW097
741100210712     C***********          TESTN          SDISDA     60            CSW005 CSW097
741200210712     C*                                                                   CSW097
741300210712     C           *IN60     IFEQ *OFF                                      CSW005
741400210712     C           SDISDA    OREQ *ZEROS                                    CSW097
741500210712     C           SDAGTY    ANDEQ'ISDA'                                    CSW097
741600210712     C                     MOVE '406'     ERCD,S                          CSW005
741700210712     C                     ADD  1         S                               CSW005
741800210712     C                     ENDIF                                          CSW005
741900210712     C                     ENDIF                                          CSW097
742000210712     C*                                                                   CSW005
742100210712      **  ISDA Rules version must be a valid year starting with 199 or 20.                  MD051567
742200210712      *                                                                                     MD051567
742300210712     C           CSW212    IFEQ 'Y'                                                         MD051567
742400210712     C           SDISDA    IFNE *BLANKS                                                     MD051567
742500210712     C           SDISDA    ANDNE'0000'                                                      MD051567
742600210712     C                     MOVELSDISDA    ISDA3                                             MD051567
742700210712     C                     MOVELSDISDA    ISDA2                                             MD051567
742800210712     C           ISDA3     IFNE '199'                                                       MD051567
742900210712     C           ISDA2     ANDNE'20'                                                        MD051567
743000210712     C           SDAGTY    ANDEQ'ISDA'                                                      MD051567
743100210712     C                     MOVE '418'     ERCD,S                                            MD051567
743200210712     C                     ADD  1         S                                                 MD051567
743300210712     C                     ENDIF                                                            MD051567
743400210712     C                     ENDIF                                                            MD051567
743500210712     C                     ELSE                                                             MD051567
743600210712      *                                                                                     MD051567
743700210712      ** If CSW201 is on, SDISDA may accept '2000'.                                           CSW201
743800210712      *                                                                                       CSW201
743900210712     C           CSW201    IFEQ 'Y'                                                           CSW201
744000210712     C           SDISDA    ANDEQ'2000'                                                        CSW201
744100210712     C                     MOVE 'Y'       WY2000  1                                           CSW201
744200210712     C                     ELSE                                                               CSW201
744300210712     C                     MOVE 'N'       WY2000                                              CSW201
744400210712     C                     ENDIF                                                              CSW201
744500210712      *                                                                                       CSW201
744600210712     C           CSW200    IFEQ 'Y'                                       CSW200
744700210712     C           SDAGTY    ANDEQ'ISDA'                                    CSW200
744800210712      *                                                                   CSW200
744900210712     C           SDISDA    IFNE '1991'                                    CSW200
745000210712     C           SDISDA    ANDNE'1998'                                    CSW200
745100210712     C           WY2000    ANDNE'Y'                                                           CSW201
745200210712     C           SDISDA    ANDNE'2006'                                                        254023
745300210712     C***********          MOVE '414'     ERCD,S                                       CSW200 CSW201
745400210712     C**********           MOVE '417'     ERCD,S                                       CSW201 254023
745500210712     C                     MOVE '414'     ERCD,S                                              254023
745600210712     C                     ADD  1         S                               CSW200
745700210712     C                     ENDIF                                          CSW200
745800210712      *                                                                   CSW200
745900210712     C                     ENDIF                                          CSW200
746000210712     C                     ENDIF                                                            MD051567
746100210712      *                                                                   CSW200
746200210712     C**  Agreement Type                                                  CSW005
746300210712     C**  RS/RX                                                           CSW097
746400210712     C*                                                                   CSW005
746500210712     C           SDAGTY    IFNE 'ISDA  '                                  CSW005
746600210712     C           SDAGTY    ANDNE'AFB   '                                  CSW005
746700210712     C           SDAGTY    ANDNE'BBAIRS'                                  CSW005
746800210712     C           SDAGTY    ANDNE'ISDACN'                                                      CSW214
746900210712     C           SDAGTY    ANDNE'OTHER '                                  CSW005
747000210712     C           SDAGTY    ANDNE'DERV  '                                                      CSW202
747100210712     C           SDAGTY    OREQ 'DERV  '                                                      CSW202
747200210712     C           CSW202    ANDEQ'N'                                                           CSW202
747300210712     C           SDAGTY    OREQ 'ISDACN'                                                      CSW214
747400210712     C           CSW214    ANDEQ'N'                                                           CSW214
747500210712      *                                                                                       CSW221
747600210712     C           CSW221    IFEQ 'Y'                                                           CSW221
747700210712     C           PMTTYP    ANDEQ'AT'                                                          CSW221
747800210712     C           SDAGTY    ANDEQ'ISDACS'                                                      CSW221
747900210712     C                     ELSE                                                               CSW221
748000210712      *                                                                                       CSW221
748100210712      *                                                                                      MD26990
748200210712     C           CSW005    IFEQ 'Y'                                                          MD26990
748300210712     C           CSW005    ORNE 'Y'                                                          MD26990
748400210712     C           SDAGTY    ANDNE*BLANK                                                       MD26990
748500210712     C                     MOVE '401'     ERCD,S                          CSW005
748600210712     C                     ADD  1         S                               CSW005
748700210712     C                     ENDIF                                                             MD26990
748800210712     C                     ENDIF                                                              CSW221
748900210712      *                                                                                      MD26990
749000210712     C                     ELSE                                                             MD031820
749100210712      *                                                                                     MD031820
749200210712     C           SDAGTY    IFNE *BLANKS                                                     MD031820
749300210712     C           I#MTYP    IFEQ '600'                                                       MD031820
749400210712     C           SDAGTY    IFNE 'ISDA'                                                      MD031820
749500210712     C           SDAGTY    ANDNE'OTHER'                                                     MD031820
749600210712     C                     MOVE '423'     ERCD,S                                            MD031820
749700210712     C                     ADD  1         S                                                 MD031820
749800210712     C                     ENDIF                                                            MD031820
749900210712     C                     ENDIF                                                            MD031820
750000210712     C                     ENDIF                                                            MD031820
750100210712      *                                                                                     MD031820
750200210712     C                     ENDIF                                          CSW005
750300210712     C*                                                                   CSW005
750400210712     C**  Agreement Date                                                  CSW005
750500210712     C**  RS/RX                                                           CSW097
750600210712     C*                                                                   CSW005
750700210712     C***********SDAGTY    IFEQ 'OTHER'                            CSW005 CSW097
750800210712     C           SDAGTY    IFEQ 'BBAIRS'                                  CSW097
750900210712     C           SDAGDT    IFNE *BLANKS                                   CSW005
751000210712     C                     MOVE '402'     ERCD,S                          CSW005
751100210712     C                     ADD  1         S                               CSW005
751200210712     C                     ENDIF                                          CSW005
751300210712     C*                                                                   CSW005
751400210712     C                     ELSE                                           CSW005
751500210712     C*                                                                   CSW097
751600210712     C           SDAGTY    IFEQ 'OTHER'                                   CSW097
751700210712     C           SDAGDT    ANDNE*BLANKS                                   CSW097
751800210712     C           SDAGTY    OREQ 'OTHER'                                   CSW097
751900210712     C           SDAGVV    ANDNE*BLANKS                                   CSW097
752000210712     C           SDAGDT    ANDEQ*BLANKS                                   CSW097
752100210712     C           SDAGTY    ORNE 'OTHER'                                   CSW097
752200210712     C*                                                                   CSW097
752300210712     C**  Input date must be in YYMMDD format                             CSW005
752400210712     C**  RS/RX                                                           CSW097
752500210712     C                     MOVE '0'       WAGDT   7                       CSW097
752600210712     C                     MOVELSDAGDT    WAGDT                           CSW097
752700210712     C                     TESTN          WAGDT      60                   CSW097
752800210712     C***********          TESTN          SDAGDT     60            CSW005 CSW097
752900210712     C*                                                                   CSW005
753000210712     C           *IN60     IFEQ *ON                                       CSW005
753100210712     C                     MOVE *OFF      *IN98                           CSW005
753200210712     C                     MOVE *OFF      *IN99                           CSW005
753300210712     C                     MOVELSDAGDT    W#AGDT                          CSW005
753400210712     C                     Z-ADDDD        WDD                             CSW005
753500210712     C                     Z-ADDMM        WMM                             CSW005
753600210712     C                     Z-ADDYY        WYY                             CSW005
753700210712     C                     MOVELWWAGDT    ZDATE                           CSW005
753800210712     C                     EXSR ZDATE1                                    CSW005
753900210712     C                     ENDIF                                          CSW005
754000210712     C*********************ENDIF                                   CSW005 CSW097
754100210712     C*                                                                   CSW005
754200210712     C           *IN60     IFEQ *OFF                                      CSW005
754300210712     C           *IN99     OREQ *ON                                       CSW005
754400210712      *                                                                                      MD26990
754500210712     C           CSW005    IFEQ 'Y'                                                          MD26990
754600210712     C           CSW005    ORNE 'Y'                                                          MD26990
754700210712     C           SDAGDT    ANDNE*BLANK                                                       MD26990
754800210712     C                     MOVE '403'     ERCD,S                          CSW005
754900210712     C                     ADD  1         S                               CSW005
755000210712     C                     ENDIF                                                             MD26990
755100210712      *                                                                                      MD26990
755200210712     C                     ENDIF                                          CSW005
755300210712     C                     ENDIF                                          CSW097
755400210712     C                     ENDIF                                          CSW097
755500210712     C*                                                                   CSW005
755600210712     C**  Agreement Version                                               CSW005
755700210712     C**  RS/RX                                                           CSW097
755800210712     C*                                                                   CSW005
755900210712     C***********SDAGTY    IFEQ 'OTHER''                            CSW005CSW097
756000210712     C           SDAGTY    IFEQ 'BBAIRS'                                  CSW097
756100210712     C           SDAGVV    IFNE *BLANKS                                   CSW005
756200210712     C                     MOVE '404'     ERCD,S                          CSW005
756300210712     C                     ADD  1         S                               CSW005
756400210712     C                     ENDIF                                          CSW005
756500210712     C*                                                                   CSW097
756600210712     C                     ELSE                                           CSW005
756700210712     C*                                                                   CSW097
756800210712     C           SDAGTY    IFEQ 'OTHER'                                   CSW097
756900210712     C           SDAGVV    ANDNE*BLANKS                                   CSW097
757000210712     C           SDAGTY    OREQ 'OTHER'                                   CSW097
757100210712     C           SDAGDT    ANDNE*BLANKS                                   CSW097
757200210712     C           SDAGVV    ANDEQ*BLANKS                                   CSW097
757300210712     C           SDAGTY    ORNE 'OTHER'                                   CSW097
757400210712     C*                                                                   CSW097
757500210712     C                     MOVE '0'       WAGVV   5                       CSW097
757600210712     C                     MOVELSDAGVV    WAGVV                           CSW097
757700210712     C                     TESTN          WAGVV      60                   CSW097
757800210712     C***********          TESTN          SDAGVV     60            CSW005 CSW097
757900210712     C           *IN60     IFEQ *OFF                                      CSW005
758000210712     C           SDAGVV    OREQ *ZEROS                                    CSW097
758100210712      *                                                                                      MD26990
758200210712     C           CSW005    IFEQ 'Y'                                                          MD26990
758300210712     C           CSW005    ORNE 'Y'                                                          MD26990
758400210712     C           SDAGVV    ANDNE*BLANK                                                       MD26990
758500210712     C                     MOVE '405'     ERCD,S                          CSW005
758600210712     C                     ADD  1         S                               CSW005
758700210712     C                     ENDIF                                                             MD26990
758800210712      *                                                                                      MD26990
758900210712     C                     ENDIF                                          CSW005
759000210712     C                     ENDIF                                          CSW005
759100210712     C*                                                                   CSW005
759200210712     C                     ENDIF                                          CSW005
759300210712     C                     ENDIF                                          CSW005
759400210712     C***********          ENDIF                                   CSW005 CSW097
759500210712     C*                                                                   S01117
759600210712     C                     ELSE                                           CSW097
759700210712     C*                                                                   CSW097
759800210712     C           PMTTYP    IFEQ 'FR'                                      CSW097
759900210712     C           PMTTYP    OREQ 'AT'                                      CSW200
760000210712     C           CSW011    ANDEQ'Y'                                       CSW200
760100210712     C           CSW200    ANDEQ'Y'                                       CSW200
760200210712     C           PMTTYP    OREQ 'AT'                                                          CSW212
760300210712     C           CSW212    ANDEQ'Y'                                                           CSW212
760400210712     C           PMTTYP    OREQ 'FX'                                                          CSW212
760500210712     C           CSW212    ANDEQ'Y'                                                           CSW212
760600210712     C           PMTTYP    OREQ 'OP'                                                          CSW212
760700210712     C           CSW212    ANDEQ'Y'                                                           CSW212
760800210712     C           PMTTYP    OREQ 'FF'                                                          CSW212
760900210712     C           CSW212    ANDEQ'Y'                                                           CSW212
761000210712     C           PMTTYP    OREQ 'CL'                                                          CSW212
761100210712     C           CDL008    ANDEQ'Y'                                                           CSW212
761200210712     C           CSW212    ANDEQ'Y'                                                           CSW212
761300210712     C*                                                                   CSW097
761400210712     C**  Validate ISDA fields for FR type agreement                      CSW097
761500210712     C*                                                                   CSW097
761600210712     C**  Allow all blank entry                                           CSW097
761700210712     C*                                                                   CSW097
761800210712     C           SDISDA    IFNE *BLANKS                                   CSW097
761900210712     C           SDAGTY    ORNE *BLANKS                                   CSW097
762000210712     C           SDAGDT    ORNE *BLANKS                                   CSW097
762100210712     C           SDAGVV    ORNE *BLANKS                                   CSW097
762200210712     C*                                                                   CSW097
762300210712     C**  FR ISDA Rules version must be numeric                           CSW097
762400210712     C*                                                                   CSW097
762500210712     C           SDAGTY    IFNE 'ISDA'                                    CSW097
762600210712     C           SDISDA    IFNE *BLANKS                                   CSW097
762700210712     C           SDISDA    ANDNE'0000'                                    CSW097
762800210712     C                     MOVE '408'     ERCD,S                          CSW097
762900210712     C                     ADD  1         S                               CSW097
763000210712     C                     ENDIF                                          CSW097
763100210712     C                     ENDIF                                          CSW097
763200210712     C           SDAGTY    IFEQ 'ISDA'                                    CSW097
763300210712     C                     MOVE '0'       WISDA   5                       CSW097
763400210712     C                     MOVELSDISDA    WISDA                           CSW097
763500210712     C                     TESTN          WISDA      60                   CSW097
763600210712     C           *IN60     IFEQ *OFF                                      CSW097
763700210712     C           SDISDA    OREQ *ZEROS                                    CSW097
763800210712     C                     MOVE '406'     ERCD,S                          CSW097
763900210712     C                     ADD  1         S                               CSW097
764000210712     C                     ENDIF                                          CSW097
764100210712     C                     ENDIF                                          CSW097
764200210712      *                                                                                     MD051567
764300210712      **  ISDA Rules version must be a valid year starting with 199 or 20.                  MD051567
764400210712      *                                                                                     MD051567
764500210712     C           CSW212    IFEQ 'Y'                                                         MD051567
764600210712     C           PMTTYP    ANDEQ'FR'                                                        MD051567
764700210712     C           SDISDA    IFNE *BLANKS                                                     MD051567
764800210712     C           SDISDA    ANDNE'0000'                                                      MD051567
764900210712     C                     MOVELSDISDA    ISDA3                                             MD051567
765000210712     C                     MOVELSDISDA    ISDA2                                             MD051567
765100210712     C           ISDA3     IFNE '199'                                                       MD051567
765200210712     C           ISDA2     ANDNE'20'                                                        MD051567
765300210712     C           SDAGTY    ANDEQ'ISDA'                                                      MD051567
765400210712     C                     MOVE '418'     ERCD,S                                            MD051567
765500210712     C                     ADD  1         S                                                 MD051567
765600210712     C                     ENDIF                                                            MD051567
765700210712     C                     ENDIF                                                            MD051567
765800210712     C                     ELSE                                                             MD051567
765900210712      *                                                                                     MD051567
766000210712     C           PMTTYP    IFEQ 'FR'                                                        MD056763
766100210712     C           PMTTYP    OREQ 'AT'                                                        MD056763
766200210712      *                                                                                       CSW201
766300210712      ** If CSW201 is on, SDISDA may accept '2000'.                                           CSW201
766400210712      *                                                                                       CSW201
766500210712     C           CSW201    IFEQ 'Y'                                                           CSW201
766600210712     C           SDISDA    ANDEQ'2000'                                                        CSW201
766700210712     C                     MOVE 'Y'       WY2000                                              CSW201
766800210712     C                     ELSE                                                               CSW201
766900210712     C                     MOVE 'N'       WY2000                                              CSW201
767000210712     C                     ENDIF                                                              CSW201
767100210712      *                                                                   CSW200
767200210712     C           CSW200    IFEQ 'Y'                                       CSW200
767300210712     C           SDAGTY    ANDEQ'ISDA'                                    CSW200
767400210712      *                                                                   CSW200
767500210712     C           SDISDA    IFNE '1991'                                    CSW200
767600210712     C           SDISDA    ANDNE'1998'                                    CSW200
767700210712     C           WY2000    ANDNE'Y'                                                           CSW201
767800210712     C           SDISDA    ANDNE'2006'                                                        254023
767900210712     C***********          MOVE '414'     ERCD,S                                       CSW200 CSW201
768000210712     C**********           MOVE '417'     ERCD,S                                       CSW201 254023
768100210712     C                     MOVE '414'     ERCD,S                                              254023
768200210712     C                     ADD  1         S                               CSW200
768300210712     C                     ENDIF                                          CSW200
768400210712      *                                                                   CSW200
768500210712     C                     ENDIF                                          CSW200
768600210712     C                     ENDIF                                                            MD056763
768700210712     C                     ENDIF                                                            MD051567
768800210712      *                                                                                       CSW212
768900210712     C           CSW212    IFEQ 'Y'                                                           CSW212
769000210712     C           SDISDA    ANDNE*BLANKS                                                       CSW212
769100210712     C           PMTTYP    IFEQ 'AT'                                                          CSW212
769200210712     C           PMTTYP    OREQ 'FX'                                                          CSW212
769300210712     C           PMTTYP    OREQ 'OP'                                                          CSW212
769400210712     C           PMTTYP    OREQ 'FF'                                                          CSW212
769500210712     C           PMTTYP    OREQ 'CL'                                                          CSW212
769600210712     C           CDL008    ANDEQ'Y'                                                           CSW212
769700210712      *                                                                                       CSW212
769800210712      ** ISDA rule version must be valid year starting with 199 or 20'                        CSW212
769900210712      *                                                                                       CSW212
770000210712     C                     MOVELSDISDA    ISDA3   3                                           CSW212
770100210712     C                     MOVELSDISDA    ISDA2   2                                           CSW212
770200210712     C           ISDA3     IFNE '199'                                                         CSW212
770300210712     C           ISDA2     ANDNE'20'                                                          CSW212
770400210712     C                     MOVE '418'     ERCD,S                                              CSW212
770500210712     C                     ADD  1         S                                                   CSW212
770600210712     C                     ENDIF                                                              CSW212
770700210712     C                     ENDIF                                                              CSW212
770800210712     C                     ENDIF                                                              CSW212
770900210712     C*                                                                   CSW097
771000210712     C**  FR Agreement Type                                               CSW097
771100210712     C*                                                                   CSW097
771200210712     C           PMTTYP    IFEQ 'AT'                                                          CSW212
771300210712     C           CSW212    ANDEQ'Y'                                                           CSW212
771400210712     C           PMTTYP    OREQ 'FX'                                                          CSW212
771500210712     C           CSW212    ANDEQ'Y'                                                           CSW212
771600210712     C           PMTTYP    OREQ 'OP'                                                          CSW212
771700210712     C           CSW212    ANDEQ'Y'                                                           CSW212
771800210712     C           PMTTYP    OREQ 'FF'                                                          CSW212
771900210712     C           CSW212    ANDEQ'Y'                                                           CSW212
772000210712     C           PMTTYP    OREQ 'CL'                                                          CSW212
772100210712     C           CDL008    ANDEQ'Y'                                                           CSW212
772200210712     C           CSW212    ANDEQ'Y'                                                           CSW212
772300210712      *                                                                                       CSW212
772400210712      ** Valid Codes for Agreement type                                                       CSW212
772500210712      *                                                                                       CSW212
772600210712     C           SDAGTY    IFNE *BLANKS                                                       CSW212
772700210712     C           I#MTYP    IFEQ '600'                                                       MD030943
772800210712     C           SDAGTY    IFNE 'ISDA'                                                      MD030943
772900210712     C           SDAGTY    ANDNE'OTHER'                                                     MD030943
773000210712     C                     MOVE '423'     ERCD,S                                            MD030943
773100210712     C                     ADD  1         S                                                 MD030943
773200210712     C                     ENDIF                                                            MD030943
773300210712     C                     ELSE                                                             MD030943
773400210712     C           SDAGTY    IFNE 'AFB'                                                         CSW212
773500210712     C           SDAGTY    ANDNE'DERV'                                                        CSW212
773600210712     C           SDAGTY    ANDNE'FBF'                                                         CSW212
773700210712     C           SDAGTY    ANDNE'FEOMA'                                                       CSW212
773800210712     C           SDAGTY    ANDNE'ICOM'                                                        CSW212
773900210712     C           SDAGTY    ANDNE'IFEMA'                                                       CSW212
774000210712     C           SDAGTY    ANDNE'ISDA'                                                        CSW212
774100210712     C           SDAGTY    ANDNE'ISDACN'                                                      CSW214
774200210712     C           SDAGTY    ANDNE'ISDACS'                                                      CSW221
774300210712     C           SDAGTY    ANDNE'OTHER'                                                       CSW212
774400210712     C           SDAGTY    OREQ 'ISDACN'                                                      CSW214
774500210712     C           CSW214    ANDEQ'N'                                                           CSW214
774600210712     C           SDAGTY    OREQ 'ISDACS'                                                      CSW221
774700210712     C           CSW221    ANDEQ'N'                                                           CSW221
774800210712     C                     MOVE '419'     ERCD,S                                              CSW212
774900210712     C                     ADD  1         S                                                   CSW212
775000210712     C                     ENDIF                                                              CSW212
775100210712     C                     ENDIF                                                            MD030943
775200210712     C                     ELSE                                                               CSW212
775300210712      *                                                                                       CSW212
775400210712      ***Mandatory*if*ISDA*agreement*date*and*version*is*inserted                    CSW212 AR992011
775500210712      ** Mandatory if any of the ISDA agreement date or                                     AR992011
775600210712      ** version or ISDA rules version is inserted                                          AR992011
775700210712      *                                                                                       CSW212
775800210712     C           SDAGDT    IFNE *BLANKS                                                       CSW212
775900210712     C********** SDAGVV    ANDNE*BLANKS                                              CSW212 AR992011
776000210712     C           SDAGVV    ORNE *BLANKS                                                     AR992011
776100210712     C           SDISDA    ORNE *BLANKS                                                     AR992011
776200210712     C                     MOVE '420'     ERCD,S                                              CSW212
776300210712     C                     ADD  1         S                                                   CSW212
776400210712     C                     ENDIF                                                              CSW212
776500210712     C                     ENDIF                                                              CSW212
776600210712      *                                                                                       CSW212
776700210712     C                     ELSE                                                               CSW212
776800210712     C           SDAGTY    IFNE 'ISDA'                                    CSW097
776900210712     C           SDAGTY    ANDNE'AFB'                                     CSW097
777000210712     C           SDAGTY    ANDNE'DERV'                                    CSW200
777100210712     C           SDAGTY    ANDNE'EMA'                                                         CSW214
777200210712     C           SDAGTY    ANDNE'FRABBA'                                  CSW200
777300210712     C           SDAGTY    ANDNE'ISDACN'                                                      CSW214
777400210712     C           SDAGTY    ANDNE'OTHER'                                                       CSW214
777500210712     C           SDAGTY    OREQ 'DERV'                                    CSW200
777600210712     C           CSW200    ANDEQ'N'                                       CSW200
777700210712     C           SDAGTY    OREQ 'FRABBA'                                  CSW200
777800210712     C           CSW200    ANDEQ'N'                                       CSW200
777900210712     C           SDAGTY    OREQ 'ISDACN'                                                      CSW214
778000210712     C           CSW214    ANDEQ'N'                                                           CSW214
778100210712     C                     MOVE '409'     ERCD,S                          CSW097
778200210712     C                     ADD  1         S                               CSW097
778300210712     C                     ENDIF                                          CSW097
778400210712     C                     ENDIF                                                              CSW212
778500210712     C*                                                                   CSW097
778600210712     C**  FR Agreement Date                                               CSW097
778700210712     C*                                                                   CSW097
778800210712     C           CSW212    IFNE 'Y'                                                           CSW212
778900210712     C           CSW200    IFEQ 'Y'                                       CSW200
779000210712     C           SDAGTY    ANDEQ'FRABBA'                                  CSW200
779100210712     C           SDAGDT    ANDNE*BLANKS                                   CSW200
779200210712     C                     MOVE '415'     ERCD,S                          CSW200
779300210712     C                     ADD  1         S                               CSW200
779400210712     C                     ENDIF                                          CSW200
779500210712     C                     ENDIF                                                              CSW212
779600210712      *                                                                   CSW200
779700210712     C           SDAGDT    IFNE *BLANKS                                                       CSW212
779800210712     C           CSW200    IFEQ 'Y'                                       CSW200
779900210712     C           SDAGDT    ANDNE*BLANKS                                   CSW200
780000210712     C           CSW200    OREQ 'N'                                       CSW200
780100210712     C           PMTTYP    OREQ 'AT'                                                          CSW212
780200210712     C           CSW212    ANDEQ'Y'                                                           CSW212
780300210712     C           PMTTYP    OREQ 'FX'                                                          CSW212
780400210712     C           CSW212    ANDEQ'Y'                                                           CSW212
780500210712     C           PMTTYP    OREQ 'OP'                                                          CSW212
780600210712     C           CSW212    ANDEQ'Y'                                                           CSW212
780700210712     C           PMTTYP    OREQ 'FF'                                                          CSW212
780800210712     C           CSW212    ANDEQ'Y'                                                           CSW212
780900210712     C           PMTTYP    OREQ 'CL'                                                          CSW212
781000210712     C           CDL008    ANDEQ'Y'                                                           CSW212
781100210712     C           CSW212    ANDEQ'Y'                                                           CSW212
781200210712      *                                                                   CSW200
781300210712     C**  FR Input date, must be in YYMMDD format                         CSW097
781400210712     C*                                                                   CSW097
781500210712     C                     MOVE '0'       WAGDT   7                       CSW097
781600210712     C                     MOVELSDAGDT    WAGDT                           CSW097
781700210712     C                     TESTN          WAGDT      60                   CSW097
781800210712     C           *IN60     IFEQ *ON                                       CSW097
781900210712     C                     MOVE *OFF      *IN98                           CSW097
782000210712     C                     MOVE *OFF      *IN99                           CSW097
782100210712     C                     MOVELSDAGDT    W#AGDT                          CSW097
782200210712     C                     Z-ADDDD        WDD                             CSW097
782300210712     C                     Z-ADDMM        WMM                             CSW097
782400210712     C                     Z-ADDYY        WYY                             CSW097
782500210712     C                     MOVELWWAGDT    ZDATE                           CSW097
782600210712     C                     EXSR ZDATE1                                    CSW097
782700210712     C                     ENDIF                                          CSW097
782800210712     C*                                                                   CSW097
782900210712     C           *IN60     IFEQ *OFF                                      CSW097
783000210712     C           *IN99     OREQ *ON                                       CSW097
783100210712     C                     MOVE '403'     ERCD,S                          CSW097
783200210712     C                     ADD  1         S                               CSW097
783300210712     C                     ENDIF                                          CSW097
783400210712     C                     ENDIF                                          CSW200
783500210712     C                     ENDIF                                                              CSW212
783600210712     C*                                                                   CSW097
783700210712     C**  FR Agreement Version                                            CSW097
783800210712     C*                                                                   CSW097
783900210712     C           CSW200    IFEQ 'Y'                                       CSW200
784000210712     C           SDAGTY    ANDEQ'FRABBA'                                  CSW200
784100210712     C           SDAGVV    ANDNE*BLANKS                                   CSW200
784200210712     C                     MOVE '416'     ERCD,S                          CSW200
784300210712     C                     ADD  1         S                               CSW200
784400210712     C                     ENDIF                                          CSW200
784500210712      *                                                                   CSW200
784600210712     C           SDAGVV    IFNE *BLANKS                                                       CSW212
784700210712     C           CSW200    IFEQ 'Y'                                       CSW200
784800210712     C           SDAGVV    ANDNE*BLANKS                                   CSW200
784900210712     C           CSW200    OREQ 'N'                                       CSW200
785000210712     C           PMTTYP    OREQ 'AT'                                                          CSW212
785100210712     C           CSW212    ANDEQ'Y'                                                           CSW212
785200210712     C           PMTTYP    OREQ 'FX'                                                          CSW212
785300210712     C           CSW212    ANDEQ'Y'                                                           CSW212
785400210712     C           PMTTYP    OREQ 'OP'                                                          CSW212
785500210712     C           CSW212    ANDEQ'Y'                                                           CSW212
785600210712     C           PMTTYP    OREQ 'FF'                                                          CSW212
785700210712     C           CSW212    ANDEQ'Y'                                                           CSW212
785800210712     C           PMTTYP    OREQ 'CL'                                                          CSW212
785900210712     C           CDL008    ANDEQ'Y'                                                           CSW212
786000210712     C           CSW212    ANDEQ'Y'                                                           CSW212
786100210712      *                                                                   CSW200
786200210712     C                     MOVE '0'       WAGVV   5                       CSW097
786300210712     C                     MOVELSDAGVV    WAGVV                           CSW097
786400210712     C                     TESTN          WAGVV      60                   CSW097
786500210712     C           *IN60     IFEQ *OFF                                      CSW097
786600210712     C           SDAGVV    OREQ *ZEROS                                    CSW097
786700210712     C                     MOVE '405'     ERCD,S                          CSW097
786800210712     C                     ADD  1         S                               CSW097
786900210712     C                     ENDIF                                          CSW097
787000210712     C*                                                                   CSW097
787100210712     C                     ENDIF                                          CSW200
787200210712     C                     ENDIF                                                              CSW212
787300210712     C*                                                                   CSW200
787400210712     C                     ENDIF                                          CSW097
787500210712     C*                                                                   CSW097
787600210712     C                     ENDIF                                          CSW097
787700210712     C*                                                                   CSW097
787800210712     C                     ENDIF                                          CSW097
787900210712     C*                                                                   CSW097
788000210712     C                     ENDIF                                          CSW097
788100210712     C*                                                                   CSW097
788200210712     C                     ENDIF                                          CSW097
788300210712     C*                                                                   S01408
788400210712     C/COPY WNCPYSRC,SD2410CVS4                                           S01408
788500210712     C*                                                                   S01408
788600210712     C*
788700210712     C           PAYEND    TAG                                                                221452
788800210712      *                                                                                       CLE031
788900210712     C           CLE031    IFEQ 'Y'                                                           CLE031
789000210712     C           PMCPGM    ANDEQ'LEND'                                                        CLE031
789100210712      *                                                                                       CLE031
789200210712     C                     MOVE 'N'       FLDERR                                              CLE031
789300210712      *                                                                                       CLE031
789400210712     C                     MOVE *BLANKS   ZFIELD                                              CLE031
789500210712     C                     MOVE PMREXR    ZFIELD                                              CLE031
789600210712     C                     Z-ADD5         ZADIG                                               CLE031
789700210712     C                     Z-ADD8         ZADEC                                               CLE031
789800210712      *                                                                                       CLE031
789900210712     C                     CALL 'ZALIGN'                                                      CLE031
790000210712     C                     PARM *BLANK    PRTCD                                               CLE031
790100210712     C                     PARM           ZFIELD                                              CLE031
790200210712     C                     PARM           ZADEC                                               CLE031
790300210712     C                     PARM           ZADIG                                               CLE031
790400210712     C                     PARM *BLANKS   ZAVAL                                               CLE031
790500210712      *                                                                                       CLE031
790600210712     C                     MOVE ZAVAL     WMREXR 140                                          CLE031
790700210712      *                                                                                       CLE031
790800210712     C                     MOVE *BLANKS   ZFIELD                                              CLE031
790900210712     C                     MOVE PMPEXR    ZFIELD                                              CLE031
791000210712     C                     Z-ADD5         ZADIG                                               CLE031
791100210712     C                     Z-ADD8         ZADEC                                               CLE031
791200210712      *                                                                                       CLE031
791300210712     C                     CALL 'ZALIGN'                                                      CLE031
791400210712     C                     PARM *BLANK    PRTCD                                               CLE031
791500210712     C                     PARM           ZFIELD                                              CLE031
791600210712     C                     PARM           ZADEC                                               CLE031
791700210712     C                     PARM           ZADIG                                               CLE031
791800210712     C                     PARM *BLANKS   ZAVAL                                               CLE031
791900210712      *                                                                                       CLE031
792000210712     C                     MOVE ZAVAL     WMPEXR 140                                          CLE031
792100210712      *                                                                                       CLE031
792200210712     C           ARINCY    IFNE 'Y'                                                           CLE031
792300210712      *                                                                                       CLE031
792400210712     C           PMRSCY    IFEQ *BLANKS                                                       CLE031
792500210712     C           PMREXR    ANDNE*BLANKS                                                       CLE031
792600210712     C           WMREXR    ANDNE*ZEROS                                                        CLE031
792700210712     C           PMRSCY    OREQ *BLANKS                                                       CLE031
792800210712     C           PMREXI    ANDNE*BLANKS                                                       CLE031
792900210712     C                     MOVE '801'     ERCD,S                                              CLE031
793000210712     C                     ADD  1         S                                                   CLE031
793100210712     C                     MOVE '1'       *IN08                                               CLE031
793200210712     C                     MOVE 'Y'       FLDERR  1                                           CLE031
793300210712     C                     ENDIF                                                              CLE031
793400210712      *                                                                                       CLE031
793500210712     C           PMRCCY    IFEQ BKEURO                                                        CLE031
793600210712     C           BRINCY    ANDEQ'Y'                                                           CLE031
793700210712     C           PMRCCY    OREQ BKEURO                                                        CLE031
793800210712     C           PMRSCY    ANDEQBKEURO                                                        CLE031
793900210712      *                                                                                       CLE031
794000210712     C           PMREXR    IFNE *BLANKS                                                       CLE031
794100210712     C           WMREXR    ANDNE*ZEROS                                                        CLE031
794200210712     C           PMREXI    ORNE *BLANKS                                                       CLE031
794300210712     C                     MOVE '802'     ERCD,S                                              CLE031
794400210712     C                     ADD  1         S                                                   CLE031
794500210712     C                     MOVE '1'       *IN08                                               CLE031
794600210712     C                     ENDIF                                                              CLE031
794700210712     C                     MOVE 'Y'       FLDERR                                              CLE031
794800210712     C                     ENDIF                                                              CLE031
794900210712      *                                                                                       CLE031
795000210712     C           ARINCY    IFNE 'Y'                                                           CLE031
795100210712     C           PMRCCY    ANDNEBKEURO                                                        CLE031
795200210712     C           PMRSCY    ANDNE*BLANKS                                                       CLE031
795300210712     C           BRINCY    ANDEQ'Y'                                                           CLE031
795400210712     C                     MOVE '810'     ERCD,S                                              CLE031
795500210712     C                     ADD  1         S                                                   CLE031
795600210712     C                     MOVE '1'       *IN08                                               CLE031
795700210712     C                     MOVE 'Y'       FLDERR                                              CLE031
795800210712     C                     ENDIF                                                              CLE031
795900210712      *                                                                                       CLE031
796000210712     C           PMPRCV    IFNE 'Y'                                                           219495
796100210712     C           PMACTC    OREQ 'X'                                                           219495
796200210712     C           PMRSCY    IFNE *BLANKS                                                       CLE031
796300210712     C           BRDLCI    ANDNE'Y'                                                           CLE031
796400210712     C                     MOVE '812'     ERCD,S                                              CLE031
796500210712     C                     ADD  1         S                                                   CLE031
796600210712     C                     MOVE '1'       *IN08                                               CLE031
796700210712     C                     MOVE 'Y'       FLDERR                                              CLE031
796800210712     C                     ENDIF                                                              CLE031
796900210712     C                     ENDIF                                                              219495
797000210712      *                                                                                       CLE031
797100210712     C           PMRSCY    IFEQ PMRCCY                                                        CLE031
797200210712     C           PMRSCY    ANDNE*BLANKS                                                       CLE031
797300210712     C                     MOVE '814'     ERCD,S                                              CLE031
797400210712     C                     ADD  1         S                                                   CLE031
797500210712     C                     MOVE '1'       *IN08                                               CLE031
797600210712     C                     MOVE 'Y'       FLDERR                                              CLE031
797700210712     C                     ENDIF                                                              CLE031
797800210712      *                                                                                       CLE031
797900210712     C           FLDERR    IFEQ 'N'                                                           CLE031
798000210712     C                     MOVEL*BLANKS   ZMDIX                                               CLE031
798100210712     C           PMREXR    IFEQ *BLANKS                                                       CLE031
798200210712     C           WMREXR    OREQ *ZEROS                                                        CLE031
798300210712     C           PMRSCY    IFNE *BLANKS                                                       CLE031
798400210712     C           CLE033    IFEQ 'Y'                                                           221891
798500210712     C           SET09     ANDEQ'T'                                                           221891
798600210712     C           PMRSTM    ANDEQ09                                                            221891
798700210712      *                                                                                       221891
798800210712      ** Do not want exchange rate default in these circumstances                             221891
798900210712      *                                                                                       221891
799000210712     C                     ELSE                                                               221891
799100210712      *                                                                                       CLE031
799200210712      ** Calculate cross rate from Receive Ccy to Receive Sett Ccy                            CLE031
799300210712      *                                                                                       CLE031
799400210712     C                     Z-ADDARSPRT    ZRATE1                                              CLE031
799500210712     C                     MOVELARMDIN    ZMDI1                                               CLE031
799600210712     C                     Z-ADDAMREXR    ZRATE2                                              CLE031
799700210712     C                     MOVELAMREXI    ZMDI2                                               CLE031
799800210712     C                     EXSR ZXRATE                                                        CLE031
799900210712     C                     MOVE ZRATEX    PMREXC 14                                           CLE031
800000210712     C                     ENDIF                                                              CLE031
800100210712     C                     ENDIF                                                              221891
800200210712      *                                                                                       CLE031
800300210712     C                     ELSE                                                               CLE031
800400210712      *                                                                                       CLE031
800500210712     C                     MOVE *BLANKS   ZFIELD                                              CLE031
800600210712     C                     MOVE PMREXR    ZFIELD 16                                           CLE031
800700210712     C                     Z-ADD5         ZADIG   20                                          CLE031
800800210712     C                     Z-ADD8         ZADEC   10                                          CLE031
800900210712      *                                                                                       CLE031
801000210712     C                     CALL 'ZALIGN'                                                      CLE031
801100210712     C                     PARM *BLANK    PRTCD                                               CLE031
801200210712     C                     PARM           ZFIELD                                              CLE031
801300210712     C                     PARM           ZADEC                                               CLE031
801400210712     C                     PARM           ZADIG                                               CLE031
801500210712     C                     PARM *BLANKS   ZAVAL  16                                           CLE031
801600210712      *                                                                                       CLE031
801700210712     C           PRTCD     IFNE *BLANK                                                        CLE031
801800210712     C                     MOVE '865'     ERCD,S                                              CLE031
801900210712     C                     ADD  1         S                                                   CLE031
802000210712     C                     MOVE '1'       *IN08                                               CLE031
802100210712     C                     ELSE                                                               CLE031
802200210712     C                     MOVE ZAVAL     PMREXC                                              CLE031
802300210712     C                     ENDIF                                                              CLE031
802400210712     C                     ENDIF                                                              CLE031
802500210712      *                                                                                       CLE031
802600210712     C           PRTCD     IFEQ *BLANKS                                                       CLE031
802700210712     C           PMREXC    ANDNE*BLANKS                                                       CLE031
802800210712     C           PMRSCY    ANDNE*BLANKS                                                       CLE031
802900210712     C                     MOVE *BLANKS   ZFIELD                                              CLE031
803000210712     C                     MOVE PMREXC    ZFIELD                                              CLE031
803100210712     C                     Z-ADD8         ZADEC                                               CLE031
803200210712     C                     EXSR ZEDIT                                                         CLE031
803300210712     C                     MOVE ZFIELD    PMREXR                                              CLE031
803400210712     C                     ENDIF                                                              CLE031
803500210712     C                     ENDIF                                                              CLE031
803600210712      *                                                                                       CLE031
803700210712     C           FLDERR    IFEQ 'N'                                                           CLE031
803800210712     C           PMREXI    IFNE *BLANKS                                                       CLE031
803900210712     C           PMREXI    ANDNE'M'                                                           CLE031
804000210712     C           PMREXI    ANDNE'D'                                                           CLE031
804100210712     C                     MOVE '878'     ERCD,S                                              CLE031
804200210712     C                     ADD  1         S                                                   CLE031
804300210712     C                     MOVE '1'       *IN08                                               CLE031
804400210712     C                     ELSE                                                               CLE031
804500210712      *                                                                                       CLE031
804600210712     C           PMREXI    IFEQ *BLANKS                                                       CLE031
804700210712     C           CLE033    IFEQ 'Y'                                                           221891
804800210712     C           SET09     ANDEQ'T'                                                           221891
804900210712     C           PMRSTM    ANDEQ09                                                            221891
805000210712      *                                                                                       221891
805100210712      ** Do not want multiply/divide ind default in these circumstances                       221891
805200210712      *                                                                                       221891
805300210712     C                     ELSE                                                               221891
805400210712     C           ZMDIX     IFNE *BLANKS                                                       CLE031
805500210712     C                     MOVELZMDIX     PMREXI                                              CLE031
805600210712     C                     ELSE                                                               CLE031
805700210712     C                     MOVE AMREXI    PMREXI                                              CLE031
805800210712     C                     ENDIF                                                              CLE031
805900210712     C                     ENDIF                                                              221891
806000210712     C                     ENDIF                                                              CLE031
806100210712     C                     ENDIF                                                              CLE031
806200210712     C                     ENDIF                                                              CLE031
806300210712      *                                                                                       CLE031
806400210712     C                     ELSE                                                               CLE031
806500210712     C           PMREXR    IFNE *BLANKS                                                       CLE031
806600210712     C           WMREXR    ANDNE*ZEROS                                                        CLE031
806700210712     C           PMREXI    ORNE *BLANKS                                                       CLE031
806800210712     C                     MOVE '802'     ERCD,S                                              CLE031
806900210712     C                     ADD  1         S                                                   CLE031
807000210712     C                     MOVE '1'       *IN08                                               CLE031
807100210712     C                     ENDIF                                                              CLE031
807200210712      *                                                                                       CLE031
807300210712     C                     ENDIF                                                              CLE031
807400210712      *                                                                                       CLE031
807500210712     C                     MOVE 'N'       FLDERR                                              CLE031
807600210712     C           APINCY    IFNE 'Y'                                                           CLE031
807700210712      *                                                                                       CLE031
807800210712     C           PMPSCY    IFEQ *BLANKS                                                       CLE031
807900210712     C           PMPEXR    ANDNE*BLANKS                                                       CLE031
808000210712     C           WMPEXR    ANDNE*ZEROS                                                        CLE031
808100210712     C           PMPSCY    OREQ *BLANKS                                                       CLE031
808200210712     C           PMPEXI    ANDNE*BLANKS                                                       CLE031
808300210712     C                     MOVE '808'     ERCD,S                                              CLE031
808400210712     C                     ADD  1         S                                                   CLE031
808500210712     C                     MOVE '1'       *IN11                                               CLE031
808600210712     C                     MOVE 'Y'       FLDERR  1                                           CLE031
808700210712     C                     ENDIF                                                              CLE031
808800210712      *                                                                                       CLE031
808900210712     C           PMPCCY    IFEQ BKEURO                                                        CLE031
809000210712     C           BPINCY    ANDEQ'Y'                                                           CLE031
809100210712     C           PMPCCY    OREQ BKEURO                                                        CLE031
809200210712     C           PMPSCY    ANDEQBKEURO                                                        CLE031
809300210712      *                                                                                       CLE031
809400210712     C           PMPEXR    IFNE *BLANKS                                                       CLE031
809500210712     C           WMPEXR    ANDNE*ZEROS                                                        CLE031
809600210712     C           PMPEXI    ORNE *BLANKS                                                       CLE031
809700210712     C                     MOVE '809'     ERCD,S                                              CLE031
809800210712     C                     ADD  1         S                                                   CLE031
809900210712     C                     MOVE '1'       *IN11                                               CLE031
810000210712     C                     ENDIF                                                              CLE031
810100210712     C                     MOVE 'Y'       FLDERR                                              CLE031
810200210712     C                     ENDIF                                                              CLE031
810300210712      *                                                                                       CLE031
810400210712     C           APINCY    IFNE 'Y'                                                           CLE031
810500210712     C           PMPCCY    ANDNEBKEURO                                                        CLE031
810600210712     C           PMPSCY    ANDNE*BLANKS                                                       CLE031
810700210712     C           BPINCY    ANDEQ'Y'                                                           CLE031
810800210712     C                     MOVE '811'     ERCD,S                                              CLE031
810900210712     C                     ADD  1         S                                                   CLE031
811000210712     C                     MOVE '1'       *IN11                                               CLE031
811100210712     C                     MOVE 'Y'       FLDERR                                              CLE031
811200210712     C                     ENDIF                                                              CLE031
811300210712      *                                                                                       CLE031
811400210712     C           PMPPAY    IFNE 'Y'                                                           219495
811500210712     C           PMACTC    OREQ 'X'                                                           219495
811600210712     C           PMPSCY    IFNE *BLANKS                                                       CLE031
811700210712     C           BPDLCI    ANDNE'Y'                                                           CLE031
811800210712     C                     MOVE '813'     ERCD,S                                              CLE031
811900210712     C                     ADD  1         S                                                   CLE031
812000210712     C                     MOVE '1'       *IN11                                               CLE031
812100210712     C                     MOVE 'Y'       FLDERR                                              CLE031
812200210712     C                     ENDIF                                                              CLE031
812300210712     C                     ENDIF                                                              219495
812400210712      *                                                                                       CLE031
812500210712     C           PMPSCY    IFEQ PMPCCY                                                        CLE031
812600210712     C           PMPSCY    ANDNE*BLANKS                                                       CLE031
812700210712     C                     MOVE '815'     ERCD,S                                              CLE031
812800210712     C                     ADD  1         S                                                   CLE031
812900210712     C                     MOVE '1'       *IN11                                               CLE031
813000210712     C                     MOVE 'Y'       FLDERR                                              CLE031
813100210712     C                     ENDIF                                                              CLE031
813200210712      *                                                                                       CLE031
813300210712     C           FLDERR    IFEQ 'N'                                                           CLE031
813400210712     C                     MOVEL*BLANKS   ZMDIX                                               CLE031
813500210712     C           PMPEXR    IFEQ *BLANKS                                                       CLE031
813600210712     C           WMPEXR    OREQ *ZEROS                                                        CLE031
813700210712     C           PMPSCY    IFNE *BLANKS                                                       CLE031
813800210712     C           CLE033    IFEQ 'Y'                                                           221891
813900210712     C           SET09     ANDEQ'T'                                                           221891
814000210712     C           PMPSTM    ANDEQ09                                                            221891
814100210712      *                                                                                       221891
814200210712      ** Do not want exchange rate default in these circumstances                             221891
814300210712      *                                                                                       221891
814400210712     C                     ELSE                                                               221891
814500210712      *                                                                                       CLE031
814600210712      ** Calculate cross rate from Pay Ccy to Pay Sett Ccy                                    CLE031
814700210712      *                                                                                       CLE031
814800210712     C                     Z-ADDAPSPRT    ZRATE1                                              CLE031
814900210712     C                     MOVELAPMDIN    ZMDI1                                               CLE031
815000210712     C                     Z-ADDAMPEXR    ZRATE2                                              CLE031
815100210712     C                     MOVELAMPEXI    ZMDI2                                               CLE031
815200210712     C                     EXSR ZXRATE                                                        CLE031
815300210712     C                     MOVE ZRATEX    PMPEXC 14                                           CLE031
815400210712     C                     ENDIF                                                              221891
815500210712     C                     ENDIF
815600210712      *
815700210712     C                     ELSE                                                               CLE031
815800210712      *                                                                                       CLE031
815900210712     C                     MOVE *BLANKS   ZFIELD                                              CLE031
816000210712     C                     MOVE PMPEXR    ZFIELD                                              CLE031
816100210712     C                     Z-ADD5         ZADIG                                               CLE031
816200210712     C                     Z-ADD8         ZADEC                                               CLE031
816300210712      *                                                                                       CLE031
816400210712     C                     CALL 'ZALIGN'                                                      CLE031
816500210712     C                     PARM *BLANK    PRTCD                                               CLE031
816600210712     C                     PARM           ZFIELD                                              CLE031
816700210712     C                     PARM           ZADEC                                               CLE031
816800210712     C                     PARM           ZADIG                                               CLE031
816900210712     C                     PARM *BLANKS   ZAVAL                                               CLE031
817000210712      *                                                                                       CLE031
817100210712     C           PRTCD     IFNE *BLANKS                                                       CLE031
817200210712     C                     MOVE '866'     ERCD,S                                              CLE031
817300210712     C                     ADD  1         S                                                   CLE031
817400210712     C                     MOVE '1'       *IN11                                               CLE031
817500210712     C                     ELSE                                                               CLE031
817600210712     C                     MOVE ZAVAL     PMPEXC                                              CLE031
817700210712     C                     ENDIF                                                              CLE031
817800210712     C                     ENDIF                                                              CLE031
817900210712      *                                                                                       CLE031
818000210712     C           PRTCD     IFEQ *BLANKS                                                       CLE031
818100210712     C           PMPEXC    ANDNE*BLANKS                                                       CLE031
818200210712     C           PMPSCY    ANDNE*BLANKS                                                       CLE031
818300210712     C                     MOVE *BLANKS   ZFIELD                                              CLE031
818400210712     C                     MOVE PMPEXC    ZFIELD                                              CLE031
818500210712     C                     Z-ADD8         ZADEC                                               CLE031
818600210712     C                     EXSR ZEDIT                                                         CLE031
818700210712     C                     MOVE ZFIELD    PMPEXR                                              CLE031
818800210712     C                     ENDIF                                                              CLE031
818900210712      *                                                                                       CLE031
819000210712     C                     ENDIF                                                              CLE031
819100210712      *                                                                                       CLE031
819200210712     C           FLDERR    IFEQ 'N'                                                           CLE031
819300210712     C           PMPEXI    IFNE *BLANKS                                                       CLE031
819400210712     C           PMPEXI    ANDNE'M'                                                           CLE031
819500210712     C           PMPEXI    ANDNE'D'                                                           CLE031
819600210712     C                     MOVE '880'     ERCD,S                                              CLE031
819700210712     C                     ADD  1         S                                                   CLE031
819800210712     C                     MOVE '1'       *IN11                                               CLE031
819900210712     C                     ELSE                                                               CLE031
820000210712      *                                                                                       CLE031
820100210712     C           PMPEXI    IFEQ *BLANKS                                                       CLE031
820200210712     C           CLE033    IFEQ 'Y'                                                           221891
820300210712     C           SET09     ANDEQ'T'                                                           221891
820400210712     C           PMPSTM    ANDEQ09                                                            221891
820500210712      *                                                                                       221891
820600210712      ** Do not want multiply/divide ind default in these circumstances                       221891
820700210712      *                                                                                       221891
820800210712     C                     ELSE                                                               221891
820900210712     C           ZMDIX     IFNE *BLANKS                                                       CLE031
821000210712     C                     MOVELZMDIX     PMPEXI                                              CLE031
821100210712     C                     ELSE                                                               CLE031
821200210712     C                     MOVE AMPEXI    PMPEXI                                              CLE031
821300210712     C                     ENDIF                                                              CLE031
821400210712     C                     ENDIF                                                              221891
821500210712     C                     ENDIF                                                              CLE031
821600210712     C                     ENDIF                                                              CLE031
821700210712     C                     ENDIF                                                              CLE031
821800210712      *                                                                                       CLE031
821900210712     C                     ELSE                                                               CLE031
822000210712     C           PMPEXR    IFNE *BLANKS                                                       CLE031
822100210712     C           WMPEXR    ANDNE*ZEROS                                                        CLE031
822200210712     C           PMPEXI    ORNE *BLANKS                                                       CLE031
822300210712     C                     MOVE '809'     ERCD,S                                              CLE031
822400210712     C                     ADD  1         S                                                   CLE031
822500210712     C                     MOVE '1'       *IN11                                               CLE031
822600210712     C                     ENDIF                                                              CLE031
822700210712      *                                                                                       CLE031
822800210712     C                     ENDIF                                                              CLE031
822900210712      *                                                                                       CLE031
823000210712     C                     MOVE *ZEROS    AMPEXR                                              CLE031
823100210712     C                     MOVE *BLANKS   AMPEXI                                              CLE031
823200210712     C                     MOVE *BLANKS   AMREXI                                              CLE031
823300210712     C                     MOVE *ZEROS    AMREXR                                              CLE031
823400210712     C                     ENDIF                                                              CLE031
823500210712      *                                                                                       CLE031
823600210712     C           V01END    ENDSR
823700210712     C/EJECT
823800210712      *************************************************************************               CDL094
823900210712     C** CHRBTB - Validation of Bank to Bank Information (Receive Instructions)               CDL094
824000210712      *************************************************************************               CDL094
824100210712     C           CHRBTB    BEGSR                                                              CDL094
824200210712      *                                                                                       CDL094
824300210712      ** Must be blank if settlement type is '00'                                             CDL094
824400210712     C           PMRSTM    IFEQ 00                                                            CDL094
824500210712      *                                                                                       CDL094
824600210712     C           PMRBB1    IFNE *BLANKS                                                       CDL094
824700210712     C           PMRBB2    ORNE *BLANKS                                                       CDL094
824800210712     C           PMRBB3    ORNE *BLANKS                                                       CDL094
824900210712     C           PMRBB4    ORNE *BLANKS                                                       CDL094
825000210712     C           PMRBB5    ORNE *BLANKS                                                       CDL094
825100210712     C           PMRBB6    ORNE *BLANKS                                                       CDL094
825200210712     C                     MOVE 'R88'     ERCD,S                                              CDL094
825300210712     C                     ADD  1         S                                                   CDL094
825400210712     C                     MOVE '1'       *IN30                                               CDL094
825500210712     C                     ENDIF                                                              CDL094
825600210712     C                     ENDIF                                                              CDL094
825700210712      *                                                                                       CDL094
825800210712      * Call Bank to Bank Validation object
825900210712      * Set up parameters                                                                     CDL094
826000210712      *                                                                                       CDL094
826100210712     C                     MOVE *BLANKS   W0RTN                                               CDL094
826200210712     C                     CLEARI#PARM                                                        CDL094
826300210712      * Set up Control fields                                                                 CDL094
826400210712     C                     MOVEL':72: '   I#VFLD                                              CDL094
826500210712     C                     MOVEL'PAY'     I#PR                                                CDL094
826600210712      * Set up Currency fields                                                                CDL094
826700210712     C                     MOVELWRECY     I#PCCY                                              CDL094
826800210712     C                     MOVELWPECY     I#RCCY                                              CDL094
826900210712      * Set up Intermediary (From the screen)                                                 CDL094
827000210712     C           PMRIBN    IFNE *BLANKS                                                       CDL094
827100210712     C                     MOVEL'X'       I#INBT                                              CDL094
827200210712     C                     MOVELPMRIBN    I#INBK                                              CDL094
827300210712     C                     ENDIF                                                              CDL094
827400210712      * Set up Intermediary (If defined for the Receive Nostro)                               CDL094
827500210712     C           A7RF56    IFNE *BLANKS                                                       CDL094
827600210712     C                     MOVEL'X'       I#INBT                                              CDL094
827700210712     C                     MOVELA7RF56    I#INBK                                              CDL094
827800210712     C                     ENDIF                                                              CDL094
827900210712      * Set up Account with Bank (If defined for the Receive Nostro)                          CDL094
828000210712     C           A7RF57    IFNE *BLANKS                                                       CDL094
828100210712     C                     MOVEL'X'       I#AWBT                                              CDL094
828200210712     C                     MOVELA7RF57    I#AWBK                                              CDL094
828300210712     C                     ENDIF                                                              CDL094
828400210712      * Set up Beneficiary (If defined for the Receive Nostro and not FX Deal)                CDL094
828500210712     C           A7RF58    IFNE *BLANKS                                                       CDL094
828600210712     C           PMCPGM    ANDNE'FXDL'                                                        CDL094
828700210712     C                     MOVEL'X'       I#BENT                                              CDL094
828800210712     C                     MOVELA7RF58    I#BENF                                              CDL094
828900210712     C                     ENDIF                                                              CDL094
829000210712      * Move in Bank to Bank Information                                                      CDL094
829100210712     C                     MOVELPMRBB1    I#BTB1                                              CDL094
829200210712     C                     MOVELPMRBB2    I#BTB2                                              CDL094
829300210712     C                     MOVELPMRBB3    I#BTB3                                              CDL094
829400210712     C                     MOVELPMRBB4    I#BTB4                                              CDL094
829500210712     C                     MOVELPMRBB5    I#BTB5                                              CDL094
829600210712     C                     MOVELPMRBB6    I#BTB6                                              CDL094
829700210712      *                                                                                       CDL094
829800210712      * Set up Account Information (As ME9950 validates BTB Info based on                     CDL094
829900210712      * Pay side details, switch fields and move receive details to Pay                       CDL094
830000210712      * parameters and pay details to Receive parameters)                                     CDL094
830100210712      * Set up pay account information in Receipt parameters                                  CDL094
830200210712     C           PMPONS    IFNE *BLANKS                                                       CDL094
830300210712     C                     SELEC                                                              CDL094
830400210712     C           PMPOBR    WHNE *BLANKS                                                       CDL094
830500210712     C           PMPONS    CAT  PMPOBR    I#RCAC                                              CDL094
830600210712     C           PMPONS    WHNE *BLANKS                                                       CDL094
830700210712     C                     MOVELPMPONS    I#RCAC                                              CDL094
830800210712     C                     ENDSL                                                              CDL094
830900210712     C                     ENDIF                                                              CDL094
831000210712      * Set up Receive account information in Pay paremeters                                  CDL094
831100210712     C           PMPONS    IFNE *BLANKS                                                       CDL094
831200210712     C                     SELEC                                                              CDL094
831300210712     C           PMPOBR    WHNE *BLANKS                                                       CDL094
831400210712     C           PMPONS    CAT  PMPOBR    I#PYAC                                              CDL094
831500210712     C           PMPONS    WHNE *BLANKS                                                       CDL094
831600210712     C                     MOVELPMPONS    I#PYAC                                              CDL094
831700210712     C                     ENDSL                                                              CDL094
831800210712     C                     ENDIF                                                              CDL094
831900210712      * If extra message and Rec Corr. then set 5354 field                                    CDL094
832000210712     C           PMRVNO    IFNE *BLANKS                                                       CDL094
832100210712     C           PMRCRN    ANDNE*BLANKS                                                       CDL094
832200210712     C                     MOVEL'Y'       I#5354                                              CDL094
832300210712     C                     ENDIF                                                              CDL094
832400210712      * Transaction Type                                                                      CDL094
832500210712     C                     MOVELPMTTYP    I#TTYP                                              CDL094
832600210712     C                     MOVELPMRSTM    I#PSTM                                              CDL094
832700210712      *                                                                                       CDL094
832800210712     C                     CLEARO#PARM                                                        CDL094
832900210712     C                     CLEARE#PARM                                                        CDL094
833000210712      * Send messages to correct calling process                                              CDL094
833100210712     C                     SELEC                                                              CDL094
833200210712     C           PMCPGM    WHEQ 'SSI '                                                        CDL094
833300210712     C                     MOVEL'SD0401R' E#CPGM                                              CDL094
833400210712     C                     MOVEL'AT'      I#MMOD                                              CDL094
833500210712     C                     OTHER                                                              CDL094
833600210712     C                     MOVEL'ME9950'  E#CPGM                                              CDL094
833700210712     C                     ENDSL                                                              CDL094
833800210712      * Set standard message text                                                             CDL094
833900210712     C                     MOVEL'MEC0114' E#MSGD                                              CDL094
834000210712     C                     MOVEL'MEMSG'   E#MSGF                                              CDL094
834100210712      *                                                                                       CDL094
834200210712     C                     CALL 'ME9950'                                                      CDL094
834300210712     C                     PARM           W0RTN                                               CDL094
834400210712     C                     PARM           I#PARM                                              CDL094
834500210712     C                     PARM           O#PARM                                              CDL094
834600210712     C                     PARM           E#PARM                                              CDL094
834700210712     C                     PARM           Z#PARM256                                           CDL094
834800210712      *                                                                                       CDL094
834900210712      * On return if errors copy into error array                                             CDL094
835000210712      *                                                                                       CDL094
835100210712     C                     MOVELO#BTB1    PMRBB1                                              CDL094
835200210712     C                     MOVELO#BTB2    PMRBB2                                              CDL094
835300210712     C                     MOVELO#BTB3    PMRBB3                                              CDL094
835400210712     C                     MOVELO#BTB4    PMRBB4                                              CDL094
835500210712     C                     MOVELO#BTB5    PMRBB5                                              CDL094
835600210712     C                     MOVELO#BTB6    PMRBB6                                              CDL094
835700210712      *                                                                                       CDL094
835800210712      ** Subtract 1 from error array index                                                    CDL094
835900210712     C                     SUB  1         E#INDX                                              CDL094
836000210712      *                                                                                       CDL094
836100210712     C           E#ERRM    IFNE *BLANKS                                                       CDL094
836200210712      *                                                                                       CDL094
836300210712     C           1         DO   E#INDX    Q#      50                                          CDL094
836400210712     C                     MOVEAO#E,Q#    ERB1                                                CDL094
836500210712     C           ER2A      IFEQ '99'                                                          CDL094
836600210712     C                     MOVEL'RR'      ERB1                                                CDL094
836700210712     C                     ELSE                                                               CDL094
836800210712     C                     MOVEL'R'       ERB1                                                CDL094
836900210712     C                     ENDIF                                                              CDL094
837000210712     C                     MOVE ERB1      ERCD,S                                              CDL094
837100210712     C                     ADD  1         S                                                   CDL094
837200210712     C                     ENDDO                                                              CDL094
837300210712      *                                                                                       CDL094
837400210712      * Mark receive side as in error                                                         CDL094
837500210712     C                     MOVEL*ON       *IN30                                               CDL094
837600210712      *                                                                                       CDL094
837700210712     C                     ENDIF                                                              CDL094
837800210712     C                     ENDSR                                                              CDL094
837900210712     C/EJECT                                                                                  CDL094
838000210712     C/COPY WNCPYSRC,SD2410C021
838100210712     C*****************************************************************
838200210712     C*
838300210712     C* SR TO DETERMINE WETHER THE CONTENTS OF THE FIELD CHKFLD IS:
838400210712     C*   A: A LIVE RECORD ON SDCUSTPD
838500210712     C*   B: A CUSTOMER SHORTNAME
838600210712     C*   C: A COUNTERPARTY NOSTRO CODE
838700210712     C*
838800210712     C* CALLED BY : SR V01
838900210712     C* CALLS     :
839000210712     C*
839100210712     C* PARAMETERS:
839200210712     C*      INPUT :CHKFLD(10A)
839300210712     C*      OUTPUT:RESULT(1A) CONTENTS: A = CUSTOMER NUMBER
839400210712     C*                                  B = CUSTOMER SHORTNAME
839500210712     C*                                  C = COUNTERPARTY NOSTRO CODE
839600210712     C*                                  E = ERROR (NON OF ABOVE)
839700210712     C*              BANKNB(1A)      BLANK = NO LIVE RECORD ON SDCUSTPD
839800210712     C*                                  B = BANK
839900210712     C*                                  N = NON-BANK
840000210712     C           CHKFL     BEGSR
840100210712     C/COPY WNCPYSRC,SD2410C036
840200210712      *
840300210712     C                     MOVE *BLANK    RESULT  1
840400210712     C                     MOVE *BLANK    BANKNB  1
840500210712     C                     MOVE *BLANKS   RTCD    7
840600210712     C                     MOVEL'*KEY   ' OPTN
840700210712     C                     MOVE *BLANKS   KEY1   10
840800210712     C                     MOVE *BLANKS   KYST    7
840900210712     C                     MOVE *BLANKS   CBNB    8
841000210712      *
841100210712     C** CHECK FOR CUSTOMER NUMBER OR SHORTNAME
841200210712     C                     MOVELCHKFLD    KEY1
841300210712     C                     CALL 'AOCUSTR0'             90
841400210712     C                     PARM           RTCD
841500210712     C                     PARM           OPTN
841600210712     C                     PARM           KEY1
841700210712     C                     PARM           KYST
841800210712     C***********CURF      PARM CURF      DSSDY                    S01194 S01117
841900210712     C           CURF      PARM *BLANKS   DSSDY                           S01117
842000210712     C***********          PARM           CURF                            S01194
842100210712      *
842200210712     C           *IN90     IFEQ '1'
842300210712     C                     MOVEL'CUST '   PMDBFL           **************
842400210712     C*****                MOVEL'SDKUUPR' PMDPGM           ** DBASE 02 ** S01227
842500210712     C                     MOVEL'SD2410'  PMDPGM           ** DBASE 02 ** S01227
842600210712     C                     Z-ADD2         PMDBSE           **************
842700210712     C                     SETON                     U7U8LR
842800210712     C                     MOVE 'T'       PMTERM
842900210712     C                     RETRN
843000210712     C                     END
843100210712     C           RTCD      IFEQ *BLANKS
843200210712     C           KYST      IFEQ '*CNUM  '
843300210712     C                     MOVE 'A'       RESULT
843400210712     C                     ELSE
843500210712     C                     MOVE 'B'       RESULT
843600210712     C                     END
843700210712     C*                                                                   S01408
843800210712     C** Core hook for externalisation.                                   S01408
843900210712     C/COPY WNCPYSRC,SD2410CVSF                                           S01408
844000210712     C*                                                                   S01408
844100210712     C** TEST FOR BANK/NON-BANK WHEN LIVE CUSTOMER FOUND
844200210712     C********** BBBNBI    IFNE 'Y'                                       099441
844300210712     C           BBSWFI    IFNE 'Y'                                       099441
844400210712     C                     MOVE 'N'       BANKNB
844500210712     C                     ELSE
844600210712     C                     MOVE 'B'       BANKNB
844700210712     C                     END
844800210712     C                     MOVE BBCSID    SWFT
844900210712     C                     Z-ADDBBFWCD    FEDW
845000210712     C** ELSE: NO VALID CUSTOMER NUMBER OR SHORTNAME RETURNED
845100210712     C**       CHECK FOR NOSTRO
845200210712     C                     ELSE
845300210712      *                                                                   S01117
845400210712      ** Only check for Nostro if result is allowed to be a               S01117
845500210712      ** counterparty nostro shortname.                                   S01117
845600210712      *                                                                   S01117
845700210712     C           @CPNA     IFEQ 'Y'                                       S01117
845800210712      *                                                                   S01117
845900210712     C                     MOVE *BLANKS   RTCD
846000210712     C                     MOVE '*KEY   ' OPTN
846100210712     C                     MOVELCHKFLD    CBNB
846200210712      *
846300210712     C                     CALL 'AOCNSTR0'             90
846400210712     C                     PARM           RTCD
846500210712     C                     PARM           OPTN
846600210712     C                     PARM           CBNB
846700210712     C***********ALRF      PARM ALRF      DSFDY                    S01194 S01117
846800210712     C           ALRF      PARM *BLANKS   DSFDY                           S01117
846900210712     C***********          PARM           ALRF                            S01194
847000210712      *
847100210712     C           *IN90     IFEQ '1'
847200210712     C                     MOVEL'CNST '   PMDBFL           **************
847300210712     C*****                MOVEL'SDKUUPR' PMDPGM           ** DBASE 03 ** S01227
847400210712     C                     MOVEL'SD2410'  PMDPGM           ** DBASE 03 ** S01227
847500210712     C                     Z-ADD3         PMDBSE           **************
847600210712     C                     SETON                     U7U8LR
847700210712     C                     MOVE 'T'       PMTERM
847800210712     C                     RETRN
847900210712     C                     END
848000210712     C           RTCD      IFEQ *BLANKS
848100210712     C                     MOVE 'C'       RESULT
848200210712     C                     MOVE AWSWID    SWFT   11
848300210712     C                     Z-ADDAWFWCD    FEDW    90
848400210712     C** ELSE: NO VALID COUNTERPARTY RETURNED
848500210712     C                     ELSE
848600210712     C                     MOVE 'E'       RESULT
848700210712     C                     END
848800210712      *                                                                   S01117
848900210712     C** ELSE: NO RECORD FOUND.                                           S01117
849000210712     C                     ELSE                                           S01117
849100210712     C                     MOVE 'E'       RESULT                          S01117
849200210712      *                                                                   S01117
849300210712     C                     END                                            S01117
849400210712      *                                                                   S01117
849500210712     C                     END
849600210712     C                     ENDSR
849700210712     C/EJECT
849800210712     C*****************************************************************
849900210712     C*
850000210712     C* SR TO ACCESS A RECORD ON THE FILE ACCNTAB
850100210712     C*
850200210712     C* CALLED BY : SR V01
850300210712     C* CALLS     :
850400210712     C*
850500210712     C* PARAMETERS:
850600210712     C*      INPUT :STANDARD FOR ACCESS OBJECT AOACCTV0
850700210712     C*      OUTPUT:STANDARD FOR ACCESS OBJECT AOACCTV0
850800210712     C           CHKAC     BEGSR
850900210712      *
851000210712     C                     MOVE *BLANKS   RTCD             *1
851100210712      *
851200210712     C                     CALL 'AOACCTV0'             90  *1
851300210712      *
851400210712     C                     PARM           RTCD             *1
851500210712     C                     PARM           ACID             *1
851600210712     C                     PARM           CUCD             *1
851700210712     C                     PARM           ACCD             *1
851800210712     C                     PARM           ACSQA            *1
851900210712     C                     PARM           BRCD    3        *1             S01117
852000210712     C                     PARM           TYPE    7        *1
852100210712     C                     PARM           NOSN    2        *1
852200210712     C***********ACCT      PARM ACCT      DSSDY            *1      S01194 S01117
852300210712     C           ACCT      PARM *BLANKS   DSSDY            *1             S01117
852400210712     C***********          PARM           ACCT             *1             S01194
852500210712      *
852600210712     C           *IN90     IFEQ '1'
852700210712     C                     MOVEL'ACCTV'   PMDBFL           **************
852800210712     C*****                MOVEL'SDKUUPR' PMDPGM           ** DBASE 04 ** S01227
852900210712     C                     MOVEL'SD2410'  PMDPGM           ** DBASE 04 ** S01227
853000210712     C                     Z-ADD4         PMDBSE           **************
853100210712     C                     MOVE 'T'       PMTERM
853200210712     C                     SETON                     U7U8LR
853300210712     C                     RETRN
853400210712     C                     END
853500210712     C                     ENDSR
853600210712     C/EJECT
853700210712     C*****************************************************************
853800210712     C*
853900210712     C* SR TO ACCESS A RECORD ON THE FILE SDNOSTPD
854000210712     C*
854100210712     C* CALLED BY : SR V01
854200210712     C* CALLS     :
854300210712     C*
854400210712     C* PARAMETERS:
854500210712     C*      INPUT :STANDARD FOR ACCESS OBJECT AONOSTR0
854600210712     C*      OUTPUT:STANDARD FOR ACCESS OBJECT AONOSTR0
854700210712     C           CHKNO     BEGSR
854800210712      *
854900210712     C                     MOVE *BLANKS   RTCD
855000210712      *
855100210712     C**********           CALL 'AONOSTR0'             90                                     CDL094
855200210712     C                     CALL 'AONOSTR1'             90                                     CDL094
855300210712      *
855400210712     C                     PARM           RTCD
855500210712     C                     PARM           OPTN
855600210712     C                     PARM *BLANKS   @CUST   6                       S01194
855700210712     C                     PARM           @CYCD   3                       S01194
855800210712     C**********           PARM *BLANKS   @ACCD   4                                    S01194 CGL029
855900210712     C                     PARM *BLANKS   @ACCD  10                                           CGL029
856000210712     C                     PARM *BLANKS   @ACSN   2                       S01194
856100210712     C                     PARM           @NONB   2                       S01194
856200210712     C                     PARM *BLANKS   @BRCD   3                       S01194
856300210712     C                     PARM *BLANKS   @CSSN  10                       S01194
856400210712     C                     PARM *BLANKS   @PNOI   1                       S01194
856500210712     C***********A7RF      PARM A7RF      DSFDY                    S01194 S01117
856600210712     C********** A7RF      PARM *BLANKS   DSFDY                                        S01117 CDL094
856700210712     C           A7RF      PARM *BLANKS   DSSDY                                               CDL094
856800210712     C***********          PARM           A7RF                            S01194
856900210712     C*                                                                   DT0069
857000210712     C** Set flag to indicate that value came from Nostros file.          DT0069
857100210712     C                     MOVE 'Y'       @NOST   1                       DT0069
857200210712      *
857300210712     C           *IN90     IFEQ '1'
857400210712     C                     MOVEL'NOSTR'   PMDBFL           **************
857500210712     C*****                MOVEL'SDKUUPR' PMDPGM           ** DBASE 05 ** S01227
857600210712     C                     MOVEL'SD2410'  PMDPGM           ** DBASE 05 ** S01227
857700210712     C                     Z-ADD5         PMDBSE           **************
857800210712     C                     SETON                     U7U8LR
857900210712     C                     MOVE 'T'       PMTERM
858000210712     C                     RETRN
858100210712     C                     END
858200210712     C                     ENDSR
858300210712     C/EJECT
858400210712     C*****************************************************************
858500210712     C*
858600210712     C* SR TO ACCESS A RECORD ON THE FILE SDCCSYPD
858700210712     C*
858800210712     C* CALLED BY : SR V01
858900210712     C* CALLS     :
859000210712     C*
859100210712     C* PARAMETERS:
859200210712     C*      INPUT :STANDARD FOR ACCESS OBJECT AOCCSYR0
859300210712     C*      OUTPUT:STANDARD FOR ACCESS OBJECT AOCCSYR0
859400210712     C           CHKCY     BEGSR
859500210712      *
859600210712     C                     MOVE *BLANKS   RTCD
859700210712     C                     MOVE '*VERIFY' OPTN
859800210712      *
859900210712     C                     CALL 'AOCCSYR0'             90
860000210712      *
860100210712     C                     PARM           RTCD
860200210712     C                     PARM           OPTN
860300210712     C                     PARM           KEYY
860400210712     C                     PARM           KEYZ
860500210712     C***********DMRF      PARM DMRF      DSFDY                    S01194 S01117
860600210712     C           DMRF      PARM *BLANKS   DSFDY                           S01117
860700210712     C***********          PARM           DMRF                            S01194
860800210712      *
860900210712     C           *IN90     IFEQ '1'
861000210712     C                     MOVEL'CCSY'    PMDBFL           **************
861100210712     C*****                MOVEL'SDKUUPR' PMDPGM           ** DBASE 06 ** S01227
861200210712     C                     MOVEL'SD2410'  PMDPGM           ** DBASE 06 ** S01227
861300210712     C                     Z-ADD6         PMDBSE           **************
861400210712     C                     SETON                     U7U8LR
861500210712     C                     MOVE 'T'       PMTERM
861600210712     C                     RETRN
861700210712     C                     END
861800210712     C                     MOVE *BLANKS   KEYY    3                       CSW096
861900210712     C                     MOVE *BLANKS   KEYZ    2                       CSW096
862000210712      *
862100210712     C                     ENDSR
862200210712     C/EJECT
862300210712      *
862400210712     C*****************************************************************   S01117
862500210712     C*                                                                   S01117
862600210712     C* SR TO ACCESS  RECORD ON THE FILE SDBANKPD                         S01117
862700210712     C*                                                                   S01117
862800210712     C* CALLED BY : SR V01                                                S01117
862900210712     C* CALLS     :                                                       S01117
863000210712     C*                                                                   S01117
863100210712     C* PARAMETERS:                                                       S01117
863200210712     C*      INPUT :STANDARD FOR ACCESS OBJECT AOBANKR0                   S01117
863300210712     C*      OUTPUT:STANDARD FOR ACCESS OBJECT AOBANKR0                   S01117
863400210712     C           CHKBK     BEGSR                                          S01117
863500210712      *                                                                   S01117
863600210712      ** IF SDBANKPD ALREADY ACCESSED IN THIS PGM NO NEED TO REREAD       S01117
863700210712     C           BJRDNB    IFEQ *ZERO                      B1             S01117
863800210712     C                     CALL 'AOBANKR0'                 *1             S01117
863900210712     C                     PARM '*MSG    '@RTCD   7        *1             S01117
864000210712     C                     PARM '*FIRST  '@OPTN   7        *1             S01117
864100210712     C           SDBANK    PARM SDBANK    DSFDY                           S01194
864200210712     C***********          PARM           SDBANK           *1             S01194
864300210712     C*                                                                   S01117
864400210712     C           @RTCD     IFNE *BLANK                     B**2           S01117
864500210712     C                     MOVEL'BANK'    PMDBFL           ************** S01117
864600210712     C*******************  MOVEL'SDKUUPR' PMDPGM           ** DBASE 07 ** S01117
864700210712     C                     MOVEL'SD2410 ' PMDPGM           ** DBASE 07 ** S01117
864800210712     C                     Z-ADD7         PMDBSE           ************** S01117
864900210712     C                     SETON                     U7U8LR**2            S01117
865000210712     C                     MOVE 'T'       PMTERM           **2            S01117
865100210712     C                     RETRN                           **2            S01117
865200210712     C                     END                             E*2            S01117
865300210712     C                     END                             E1             S01117
865400210712      *                                                                   S01117
865500210712     C                     ENDSR                                          S01117
865600210712     C/EJECT                                                              S01117
865700210712     C*                                                                   S01117
865800210712     C*****************************************************************   S01117
865900210712     C*                                                                   S01117
866000210712     C* SR TO ACCESS  RECORD ON THE FILE SDBRCHPD                         S01117
866100210712     C*                                                                   S01117
866200210712     C* CALLED BY : SR V01                                                S01117
866300210712     C* CALLS     :                                                       S01117
866400210712     C*                                                                   S01117
866500210712     C* PARAMETERS:                                                       S01117
866600210712     C*      INPUT :STANDARD FOR ACCESS OBJECT AOBRCHR0                   S01117
866700210712     C*      OUTPUT:STANDARD FOR ACCESS OBJECT AOBRCHR0                   S01117
866800210712     C           CHKBR     BEGSR                                          S01117
866900210712      *                                                                   S01117
867000210712     C**********           CALL 'AOBRCHR0'             90                              S01117 CGL029
867100210712     C                     CALL 'AOBRCHR1'             90                                     CGL029
867200210712     C*********************PARM '*BLANKS '@RTCD   7                       S01117
867300210712     C                     PARM *BLANKS   @RTCD   7                       S01117
867400210712     C*********************PARM '*VERIFY '@OPTN   7                       S01117
867500210712     C                     PARM '*KEY   ' @OPTN   7                       S01117
867600210712     C                     PARM @OBR      @DSNB   3                       S01117
867700210712     C***********SDBRCH    PARM SDBRCH    DSFDY                    S01194 S01117
867800210712     C********** SDBRCH    PARM *BLANKS   DSFDY                                        S01117 CGL029
867900210712     C           SDBRCH    PARM *BLANKS   DSSDY                                               CGL029
868000210712     C*************        PARM           SDBRCH                          S01117
868100210712     C*                                                                   S01117
868200210712     C           *IN90     IFEQ '1'                                       S01117
868300210712     C                     MOVEL'BRCH'    PMDBFL           ************** S01117
868400210712     C*********************MOVEL'SDKUUPR' PMDPGM           ** DBASE 08 ** S01117
868500210712     C                     MOVEL'SD2410'  PMDPGM           ** DBASE 08 ** S01227
868600210712     C                     Z-ADD8         PMDBSE           ************** S01117
868700210712     C                     SETON                     U7U8LR               S01117
868800210712     C                     MOVE 'T'       PMTERM                          S01117
868900210712     C                     RETRN                                          S01117
869000210712     C                     END                                            S01117
869100210712      *                                                                   S01117
869200210712     C                     ENDSR                                          S01117
869300210712     C/EJECT                                                              S01117
869400210712     C*                                                                   S01117
869500210712      *****************************************************************   CSW096
869600210712      *                                                               *   CSW096
869700210712      * Removed for SWIFT Changes 96, replaced in program ME9950      *   CSW096
869800210712      *                                                               *   CSW096
869900210712      *****************************************************************   CSW096
870000210712      ***********                                                         CSW096
870100210712     C*****************************************************************   CSW096
870200210712     C***********                                                         CSW096
870300210712     C**SR*TO*VALIDATE BANK TO BANK INFORMATION                           CSW096
870400210712     C***********                                                         CSW096
870500210712     C**CALLED*BY : SR V01                                                CSW096
870600210712     C**CALLS**** :                                                       CSW096
870700210712     C***********                                                         CSW096
870800210712     C**PARAMETERS:                                                       CSW096
870900210712     C********INPUT :XBTB(35A)                                            CSW096
871000210712     C********OUTPUT:BTBERR(1A) CONTENTS: BLANK = NO ERROR FOUND          CSW096
871100210712     C***********                         E = ERROR; SET ON ERROR IND.    CSW096
871200210712     C***********BTBVAL    BEGSR                                          CSW096
871300210712     C***********          MOVE *BLANK    BTBERR  1                       CSW096
871400210712     C***********          MOVE *BLANK    WORD    9                       CSW096
871500210712     C***********          MOVE 'N'       PLUS    1                       CSW096
871600210712     C***********                                                         CSW096
871700210712     C***********          MOVEL'CABLEBEN'WORD1   9                       CSW096
871800210712     C***********          MOVE '/'       WORD1                           CSW096
871900210712     C***********          MOVEL'TELEXBEN'WORD2   9                       CSW096
872000210712     C***********          MOVE '/'       WORD2                           CSW096
872100210712     C***********          MOVEL'CABLEIBK'WORD3   9                       CSW096
872200210712     C***********          MOVE '/'       WORD3                           CSW096
872300210712     C***********          MOVEL'TELEXIBK'WORD4   9                       CSW096
872400210712     C***********          MOVE '/'       WORD4                           CSW096
872500210712     C***********                                                         CSW096
872600210712     C/COPY WNCPYSRC,SD2410C100
872700210712     C***CHECK*DS FOR VALID CODE WORD                                     CSW096
872800210712     C***********CODE1A    IFEQ 'REC/'                                    CSW096
872900210712     C***********CODE1A    OREQ 'INT/'                                    CSW096
873000210712     C***********CODE1A    OREQ 'BNF/'                                    CSW096
873100210712     C***********CODE1A    OREQ 'INS/'                                    CSW096
873200210712     C***********CODE1A    OREQ 'OGB/'                                    CSW096
873300210712     C***********CODE1A    OREQ 'IBK/'                              S01412CSW096
873400210712     C***********          MOVELCODE1A    WORD                            CSW096
873500210712     C***********          GOTO BVALID                                    CSW096
873600210712     C***********          END                                            CSW096
873700210712     C***********CODE1A    IFEQ 'ACC/'                                    CSW096
873800210712     C***********PMAWBN    IFNE *BLANKS                                   CSW096
873900210712     C***********          MOVELCODE1A    WORD                            CSW096
874000210712     C***********          GOTO BVALID                                    CSW096
874100210712     C***********          ELSE                                           CSW096
874200210712     C***********          MOVE '895'     ERCD,S                          CSW096
874300210712     C***********          ADD  1         S                               CSW096
874400210712     C***********          MOVE '1'       *IN31                     LN0787CSW096
874500210712     C***********          MOVE 'E'       BTBERR                          CSW096
874600210712     C***********          GOTO EBTBVL                                    CSW096
874700210712     C***********          END                                            CSW096
874800210712     C***********          END                                            CSW096
874900210712     C***********CODE1B    IFEQ 'HOLD/'                                   CSW096
875000210712     C***********          MOVELCODE1B    WORD                            CSW096
875100210712     C***********          GOTO BVALID                                    CSW096
875200210712     C***********          END                                            CSW096
875300210712     C***********CODE1B    IFEQ 'PHON/'                                   CSW096
875400210712     C***********PMAWBN    IFNE *BLANKS                                   CSW096
875500210712     C***********          MOVELCODE1B    WORD                            CSW096
875600210712     C***********          GOTO BVALID                                    CSW096
875700210712     C***********          ELSE                                           CSW096
875800210712     C***********          MOVE '895'     ERCD,S                          CSW096
875900210712     C***********          ADD  1         S                               CSW096
876000210712     C***********          MOVE '1'       *IN31                     LN0787CSW096
876100210712     C***********          MOVE 'E'       BTBERR                          CSW096
876200210712     C***********          GOTO EBTBVL                                    CSW096
876300210712     C***********          END                                            CSW096
876400210712     C***********          END                                            CSW096
876500210712     C***********CODE1C    IFEQ 'CABLE/'                                  CSW096
876600210712     C***********CODE1C    OREQ 'TELEX/'                                  CSW096
876700210712     C***********PMAWBN    IFNE *BLANKS                                   CSW096
876800210712     C***********          MOVELCODE1C    WORD                            CSW096
876900210712     C***********          GOTO BVALID                                    CSW096
877000210712     C***********          ELSE                                           CSW096
877100210712     C***********          MOVE '895'     ERCD,S                          CSW096
877200210712     C***********          ADD  1         S                               CSW096
877300210712     C***********          MOVE '1'       *IN31                     LN0787CSW096
877400210712     C***********          MOVE 'E'       BTBERR                          CSW096
877500210712     C***********          GOTO EBTBVL                                    CSW096
877600210712     C***********          END                                            CSW096
877700210712     C***********          END                                            CSW096
877800210712     C***********CODE1D    IFEQ 'CHEQUE/'                                 CSW096
877900210712     C***********          MOVELCODE1D    WORD                            CSW096
878000210712     C***********          GOTO BVALID                                    CSW096
878100210712     C***********          END                                            CSW096
878200210712     C***********CODE1E    IFEQ 'BENONLY/'                                CSW096
878300210712     C***********CODE1E    OREQ 'CONFIRM/'                                CSW096
878400210712     C***********CODE1E    OREQ 'RESERVE/'                                CSW096
878500210712     C***********CODE1E    OREQ 'PHONBEN/'                                CSW096
878600210712     C***********CODE1E    OREQ 'PHONIBK/'                                CSW096
878700210712     C***********          MOVELCODE1E    WORD                            CSW096
878800210712     C***********          GOTO BVALID                                    CSW096
878900210712     C***********          END                                            CSW096
879000210712     C***********CODE1F    IFEQ WORD1                                     CSW096
879100210712     C***********CODE1F    OREQ WORD2                                     CSW096
879200210712     C***********CODE1F    OREQ WORD3                                     CSW096
879300210712     C***********CODE1F    OREQ WORD4                                     CSW096
879400210712     C***********          MOVELCODE1F    WORD                            CSW096
879500210712     C***********          GOTO BVALID                                    CSW096
879600210712     C***********          END                                            CSW096
879700210712     C***********          MOVE '990'     ERCD,S                          CSW096
879800210712     C***********          ADD  1         S                               CSW096
879900210712     C***********          MOVE '1'       *IN31                     LN0787CSW096
880000210712     C***********          MOVE 'E'       BTBERR                          CSW096
880100210712     C***********          GOTO EBTBVL                                    CSW096
880200210712     C***********BVALID    TAG                                            CSW096
880300210712     C***VALID*CODE WORD; CHECK IF ALREADY USED                           CSW096
880400210712     C***********          Z-ADD1         Y       10                      CSW096
880500210712     C***********          DO   X                                         CSW096
880600210712     C***********WORD      IFEQ BTB,Y                                     CSW096
880700210712     C***********          MOVE '997'     ERCD,S                          CSW096
880800210712     C***********          ADD  1         S                               CSW096
880900210712     C***********          MOVE '1'       *IN31                     LN0787CSW096
881000210712     C***********          MOVE 'E'       BTBERR                          CSW096
881100210712     C***********          GOTO EBTBVL                                    CSW096
881200210712     C***********          END                                            CSW096
881300210712     C***********          ADD  1         Y                               CSW096
881400210712     C***********          END                                            CSW096
881500210712     C***STORE*VALID CODE WORD IN ARRAY                                   CSW096
881600210712     C***********          ADD  1         X                               CSW096
881700210712     C***********          MOVE WORD      BTB,X                           CSW096
881800210712     C***********                                                         CSW096
881900210712     C***THE*NEXT CODE WORDS CAN BE FOLLOWED BY '+' IF SO ADD TELEPHONE   CSW096
882000210712     C***OR*TELEX NEMBER TO DS.                                           CSW096
882100210712     C***********CODE1B    IFEQ 'PHON/'                                   CSW096
882200210712     C***********PLUS1A    ANDEQ'+'                                       CSW096
882300210712     C***********          MOVE ACPHON    PHONEA                          CSW096
882400210712     C***********          MOVE 'Y'       PLUS                            CSW096
882500210712     C***********          END                                            CSW096
882600210712     C***********CODE1C    IFEQ 'TELEX/'                                  CSW096
882700210712     C***********PLUS1B    ANDEQ'+'                                       CSW096
882800210712     C***********          MOVE ACTELX    TELEXA                          CSW096
882900210712     C***********          MOVE 'Y'       PLUS                            CSW096
883000210712     C***********          END                                            CSW096
883100210712     C***********CODE1E    IFEQ 'PHONBEN/'                                CSW096
883200210712     C***********PLUS1C    ANDEQ'+'                                       CSW096
883300210712     C***********          MOVE BEPHON    PHONEB                          CSW096
883400210712     C***********          MOVE 'Y'       PLUS                            CSW096
883500210712     C***********          END                                            CSW096
883600210712     C***********CODE1F    IFEQ WORD2                                     CSW096
883700210712     C***********PLUS1D    ANDEQ'+'                                       CSW096
883800210712     C***********          MOVE BETELX    TELEXB                          CSW096
883900210712     C***********          MOVE 'Y'       PLUS                            CSW096
884000210712     C***********          END                                            CSW096
884100210712     C***********CODE1E    IFEQ 'PHONIBK/'                                CSW096
884200210712     C***********PLUS1C    ANDEQ'+'                                       CSW096
884300210712     C***********          MOVE INPHON    PHONEB                          CSW096
884400210712     C***********          MOVE 'Y'       PLUS                            CSW096
884500210712     C***********          END                                            CSW096
884600210712     C***********CODE1F    IFEQ WORD4                                     CSW096
884700210712     C***********PLUS1D    ANDEQ'+'                                       CSW096
884800210712     C***********          MOVE INTELX    TELEXB                          CSW096
884900210712     C***********          MOVE 'Y'       PLUS                            CSW096
885000210712     C***********          END                                            CSW096
885100210712     C***********                                                         CSW096
885200210712     C***THE*FOLLOWING CODE WORDS MUST NOT BE FOLLOWED BY BLANKS          CSW096
885300210712     C***********CODE1A    IFEQ 'REC/'                                    CSW096
885400210712     C***********CODE1A    OREQ 'INT/'                                    CSW096
885500210712     C***********CODE1A    OREQ 'ACC/'                                    CSW096
885600210712     C***********CODE1A    OREQ 'BNF/'                                    CSW096
885700210712     C***********CODE1A    OREQ 'INS/'                                    CSW096
885800210712     C***********CODE1A    OREQ 'OGB/'                                    CSW096
885900210712     C***********CODE1A    OREQ 'IBK/'                              S01412CSW096
886000210712     C***********BLNK1A    IFEQ *BLANK                                    CSW096
886100210712     C***********          MOVE '993'     ERCD,S                          CSW096
886200210712     C***********          ADD  1         S                               CSW096
886300210712     C***********          MOVE '1'       *IN31                     LN0787CSW096
886400210712     C***********          MOVE 'E'       BTBERR                          CSW096
886500210712     C***********          GOTO EBTBVL                                    CSW096
886600210712     C***********          END                                            CSW096
886700210712     C***********          END                                            CSW096
886800210712     C***********                                                         CSW096
886900210712     C***IF*'/INS/' OR '/OGB/' ENTERED SET INDICATORS TO CHECK NUMBER     CSW096
887000210712     C***OF*CONTINUATION LINES                                            CSW096
887100210712     C***********CODE1A    IFEQ 'INS/'                                    CSW096
887200210712     C***********CODE1A    OREQ 'OGB/'                                    CSW096
887300210712     C***********          MOVE '1'       *IN71                           CSW096
887400210712     C***********          END                                            CSW096
887500210712     C***********                                                         CSW096
887600210712     C***IF*'/IBK/'*ENTERED*SET*INDICATORS*TO*CHECK*NUMBER*******   S01412CSW096
887700210712     C***OF*CONTINUATION*LINES***********************************   S01412CSW096
887800210712     C***********CODE1A    IFEQ 'IBK/'                              S01412CSW096
887900210712     C***********          MOVE '1'       *IN74                     S01412CSW096
888000210712     C***********SLASH3    IFEQ '/'                                 S01412CSW096
888100210712     C***********          MOVE '1'       *IN73                     S01412CSW096
888200210712     C***********          ELSE                                     S01412CSW096
888300210712     C***********          MOVE '1'       *IN72                     S01412CSW096
888400210712     C***********          END                                      S01412CSW096
888500210712     C***********          END                                      S01412CSW096
888600210712     C***********                                                         CSW096
888700210712     C***IF*'/CABLEIBK','/PHONIBK/' OR '/TELEXIBK/' SET INDICATOR TO      CSW096
888800210712     C***VALIDATE LATER                                                   CSW096
888900210712     C***********CODE1E    IFEQ 'PHONIBK/'                                CSW096
889000210712     C***********CODE1F    OREQ WORD3                                     CSW096
889100210712     C***********CODE1A    OREQ WORD4                                     CSW096
889200210712     C***********          MOVE '1'       *IN75                           CSW096
889300210712     C***********          END                                            CSW096
889400210712     C***********                                                         CSW096
889500210712     C***IF*'/INT/' SET INDICATOR TO VALIDATE LATER                       CSW096
889600210712     C***********CODE1A    IFEQ 'INT/'                                    CSW096
889700210712     C***********          MOVE '1'       *IN76                           CSW096
889800210712     C***********          END                                            CSW096
889900210712     C***********                                                         CSW096
890000210712     C***'/OGB/'*ONLY ALLOWED IF BENEFICIARY IS A BANK                    CSW096
890100210712     C***********CODE1A    IFEQ 'OGB/'                                    CSW096
890200210712     C***********CPBENN    ANDEQ'N'                                       CSW096
890300210712     C***********BENBNK    ANDEQ'N'                                       CSW096
890400210712     C***********          MOVE '995'     ERCD,S                          CSW096
890500210712     C***********          ADD  1         S                               CSW096
890600210712     C***********          MOVE '1'       *IN31                     LN0787CSW096
890700210712     C***********          MOVE 'E'       BTBERR                          CSW096
890800210712     C***********          GOTO EBTBVL                                    CSW096
890900210712     C***********          END                                            CSW096
891000210712      ***********                                                         CSW096
891100210712     C*
891200210712     C***'/IBK/'*ONLY*ALLOWED*FOR*A*CUSTOMER*TRANSFER*AND*IT*MUST*BE***   S01412
891300210712     C***FOLLOWED*BY*THE*CUSTOMER*NUMBER*OR*SHORTNAME*OF*A*BANK********   S01412
891400210712     C***********CODE1A    IFEQ 'IBK/'                     B1             S01412
891500210712     C***********          MOVE *BLANKS   IBKNO            *1             S01412
891600210712     C***********PMBENN    IFEQ *BLANKS                    B*2            S01412
891700210712     C***********BENBNK    ORNE 'N'                        **2            S01412
891800210712     C***********          MOVE '897'     ERCD,S           **2            S01412
891900210712     C***********          ADD  1         S                **2            S01412
892000210712     C***********          MOVE '1'       *IN31                     LN0787S01412
892100210712     C***********          MOVE 'E'       BTBERR           **2            S01412
892200210712     C***********          GOTO EBTBVL                     **2            S01412
892300210712     C***********          ELSE                            X*2            S01412
892400210712     C************IN72     IFEQ '1'                        B**3           S01412
892500210712     C***********          MOVE CODE1G    CHKFLD           ***3           S01412
892600210712     C***********          ELSE                            X**3           S01412
892700210712     C***********LINE      IFEQ 1                          B***4          S01412
892800210712     C***********          MOVELPMBTB2    YBTB             ****4          S01412
892900210712     C***********          MOVE CODE1H    CHKFLD           ****4          S01412
893000210712     C***********          END                             E***4          S01412
893100210712     C***********LINE      IFEQ 2                          B***4          S01412
893200210712     C***********          MOVELPMBTB3    YBTB             ****4          S01412
893300210712     C***********          MOVE CODE1H    CHKFLD           ****4          S01412
893400210712     C***********          END                             E***4          S01412
893500210712     C***********LINE      IFEQ 3                          B***4          S01412
893600210712     C***********          MOVELPMBTB4    YBTB             ****4          S01412
893700210712     C***********          MOVE CODE1H    CHKFLD           ****4          S01412
893800210712     C***********          END                             E***4          S01412
893900210712     C***********LINE      IFEQ 4                          B***4          S01412
894000210712     C***********          MOVELPMBTB5    YBTB             ****4          S01412
894100210712     C***********          MOVE CODE1H    CHKFLD           ****4          S01412
894200210712     C***********          END                             E***4          S01412
894300210712     C***********LINE      IFEQ 5                          B***4          S01412
894400210712     C***********          MOVELPMBTB6    YBTB             ****4          S01412
894500210712     C***********          MOVE CODE1H    CHKFLD           ****4          S01412
894600210712     C***********          END                             E***4          S01412
894700210712     C***********          END                             E**3           S01412
894800210712     C***********          MOVE 'N'       @CPNA            **2      S01117S01412
894900210712     C***********          EXSR CHKFL                      **2            S01412
895000210712     C***********RTCD      IFEQ '*NOSEL '                  B**3     S01117S01412
895100210712     C***********          MOVE '867'     ERCD,S           ***3     S01117S01412
895200210712     C***********          ADD  1         S                ***3     S01117S01412
895300210712     C***********          MOVE '1'       *IN31                     LN0787S01412
895400210712     C***********          END                             E**3     S01117S01412
895500210712     C***********RESULT    IFEQ 'E'                        B**3           S01412
895600210712     C*********************MOVE '897'     ERCD,S           ***3
895700210712     C*********************MOVE '866'     ERCD,S           ***3           LN0785
895800210712     C***********          MOVE '897'     ERCD,S           ***3     LN0785S01412
895900210712     C***********          ADD  1         S                ***3           S01412
896000210712     C***********          MOVE '1'       *IN31                     LN0787S01412
896100210712     C***********          ELSE                            X**3           S01412
896200210712     C***********RESULT    IFEQ 'A'                        B***4          S01412
896300210712     C***********RESULT    OREQ 'B'                        ****4          S01412
896400210712     C***********BANKNB    IFNE 'B'                        B****5         S01412
896500210712     C*********************MOVE '897'     ERCD,S           *****5
896600210712     C*********************MOVE '866'     ERCD,S           ***3           LN0785
896700210712     C***********          MOVE '897'     ERCD,S           ***3     LN0785S01412
896800210712     C***********          ADD  1         S                *****5         S01412
896900210712     C***********          MOVE '1'       *IN31                     LN0787S01412
897000210712     C***********          ELSE                            X****5         S01412
897100210712     C***********          MOVELBBCUST    IBKNO   8        *****5         S01412
897200210712     C***********          END                             E****5         S01412
897300210712     C*********************ELSE                            X***4          S01117
897400210712     C*********************MOVELAWCPNC    IBKNO            ****4          S01117
897500210712     C***********                                                         S01412
897600210712     C***MOVE*CUSTOMER SHORTNAME TO REPLACE '?' ON SCREEN.                S01412
897700210712     C************IN72     IFEQ '1'                        B****5   S01117S01412
897800210712     C***********          MOVELBBCSSN    CODE1G           *****5   S01117S01412
897900210712     C***********          ELSE                            X****5   S01117S01412
898000210712     C***********          MOVELBBCSSN    CODE1H           *****5   S01117S01412
898100210712     C***********LINE      IFEQ 1                          B*****6  S01117S01412
898200210712     C***********          MOVELYBTB      PMBTB2           ******6  S01117S01412
898300210712     C***********          END                             E*****6  S01117S01412
898400210712     C***********LINE      IFEQ 2                          B*****6  S01117S01412
898500210712     C***********          MOVELYBTB      PMBTB3           ******6  S01117S01412
898600210712     C***********          END                             E*****6  S01117S01412
898700210712     C***********LINE      IFEQ 3                          B*****6  S01117S01412
898800210712     C***********          MOVELYBTB      PMBTB4           ******6  S01117S01412
898900210712     C***********          END                             E*****6  S01117S01412
899000210712     C***********LINE      IFEQ 4                          B*****6  S01117S01412
899100210712     C***********          MOVELYBTB      PMBTB5           ******6  S01117S01412
899200210712     C***********          END                             E*****6  S01117S01412
899300210712     C***********LINE      IFEQ 5                          B*****6  S01117S01412
899400210712     C***********          MOVELYBTB      PMBTB6           ******6  S01117S01412
899500210712     C***********          END                             E*****6  S01117S01412
899600210712     C***********          END                             E****5   S01117S01412
899700210712     C***********          END                             E***4          S01412
899800210712     C***********          END                             E**3           S01412
899900210712     C***********          END                             E*2            S01412
900000210712     C***********                                                         S01412
900100210712     C***INTERMEDIARY BANK MUST NOT BE THE SAME AS BRANCH INTERNAL        S01412
900200210712     C***CUSTOMER, OUR NOSTRO, RECEIVER, ACCOUNT WITH BANK OR             S01412
900300210712     C***BENEFICIARY                                                      S01412
900400210712     C***********IBKNO     IFNE *BLANKS                    B*2            S01412
900500210712     C***********IBKNO     IFEQ A8BICN                     B**3           S01412
900600210712     C***********IBKNO     OREQ PNOST                      ***3           S01412
900700210712     C***********IBKNO     OREQ PARVNO                     ***3           S01412
900800210712     C***********IBKNO     OREQ PAAWBN                     ***3           S01412
900900210712     C***********IBKNO     OREQ PABENN                     ***3           S01412
901000210712     C***********          MOVE '892'     ERCD,S           ***3           S01412
901100210712     C***********          ADD  1         S                ***3           S01412
901200210712     C***********          MOVE '1'       *IN31                     LN0787S01412
901300210712     C***********          END                             E**3           S01412
901400210712     C***********          END                             E*2            S01412
901500210712     C***********          END                             E1             S01412
901600210712     C***********                                                         CSW096
901700210712     C***********EBTBVL    ENDSR                                          CSW096
901800210712     C/EJECT
901900210712      *
902000210712     C*****************************************************************
902100210712     C*****                                                               S01117
902200210712     C**SR Z01 TO CALL ACCESS OBJECTS TO CLOSE OPEN FILES                 S01117
902300210712     C*****                                                               S01117
902400210712     C**CALLED BY : SR V01                                                S01117
902500210712     C**CALLS     :                                                       S01117
902600210712     C*****                                                               S01117
902700210712     C*****      Z01       BEGSR                                          S01117
902800210712     C*****                                                               S01117
902900210712     C*****                MOVE '*FREE'   RTCD                            S01117
903000210712     C*****                CALL 'AOACCTV0'                                S01117
903100210712     C*****                PARM           RTCD                            S01117
903200210712     C*****                PARM           ACID                            S01117
903300210712     C*****                PARM           CUCD                            S01117
903400210712     C*****                PARM           ACCD                            S01117
903500210712     C*****                PARM           ACSQA                           S01117
903600210712     C*****                PARM           TYPE                            S01117
903700210712     C*****                PARM           NOSN                            S01117
903800210712     C*****                PARM           ACCT                            S01117
903900210712      *****                                                               S01117
904000210712     C*****                MOVE *BLANKS   RTCD                            S01117
904100210712     C*****                MOVE '*FREE'   OPTN                            S01117
904200210712     C*****                CALL 'AOBRCHR0'                                S01117
904300210712     C*****                PARM           RTCD                            S01117
904400210712     C*****                PARM           OPTN                            S01117
904500210712     C*****                PARM           DSNB                            S01117
904600210712     C*****                PARM           A8RF                            S01117
904700210712      *****                                                               S01117
904800210712     C*****                MOVE *BLANKS   RTCD                            S01117
904900210712     C*****                MOVE '*FREE'   OPTN                            S01117
905000210712     C*****                CALL 'AOCCSYR0'                                S01117
905100210712     C*****                PARM           RTCD                            S01117
905200210712     C*****                PARM           OPTN                            S01117
905300210712     C*****                PARM           KEYY                            S01117
905400210712     C*****                PARM           KEYZ                            S01117
905500210712     C*****                PARM           DMRF                            S01117
905600210712      *****                                                               S01117
905700210712     C*****                MOVE *BLANKS   RTCD                            S01117
905800210712     C*****                MOVE '*FREE'   OPTN                            S01117
905900210712     C*****                CALL 'AOCNSTR0'                                S01117
906000210712     C*****                PARM           RTCD                            S01117
906100210712     C*****                PARM           OPTN                            S01117
906200210712     C*****                PARM           CBNB                            S01117
906300210712     C*****                PARM           ALRF                            S01117
906400210712      *****                                                               S01117
906500210712     C*****                MOVE *BLANKS   RTCD                            S01117
906600210712     C*****                MOVE '*FREE'   OPTN                            S01117
906700210712     C*****                CALL 'AOCUSTR0'                                S01117
906800210712     C*****                PARM           RTCD                            S01117
906900210712     C*****                PARM           OPTN                            S01117
907000210712     C*****                PARM           KEY1                            S01117
907100210712     C*****                PARM           KYST                            S01117
907200210712     C*****                PARM           CURF                            S01117
907300210712      *****                                                               S01117
907400210712     C*****                MOVE *BLANKS   RTCD                            S01117
907500210712     C*****                MOVE '*FREE'   OPTN                            S01117
907600210712     C*****                CALL 'AONOSTR0'                                S01117
907700210712     C*****                PARM           RTCD                            S01117
907800210712     C*****                PARM           OPTN                            S01117
907900210712     C*****                PARM           KEYA                            S01117
908000210712     C*****                PARM           KEYB                            S01117
908100210712     C*****                PARM           KEYC                            S01117
908200210712     C*****                PARM           KEYD                            S01117
908300210712     C*****                PARM           KEYE                            S01117
908400210712     C*****                PARM           A7RF                            S01117
908500210712      *****                                                               S01117
908600210712     C*****                                                               S01117
908700210712     C*****      Z09       ENDSR                                          S01117
908800210712      *     S01297 - RELEASE 10 EXTENDED SETTLEMENTS DEFAULTING.     *    S01297
908900210712     C*****************************************************************   S01297
909000210712     C*                                                               *   S01297
909100210712     C* DEFLT    - Defaulting                                         *   S01297
909200210712     C*                                                               *   S01297
909300210712     C* CALLED BY MAIN                                                *   S01297
909400210712     C*                                                               *   S01297
909500210712     C* CALLS - DEF18, CUSGET                                         *   S01297
909600210712     C*                                                               *   S01297
909700210712     C*****************************************************************   S01297
909800210712     C*                                                                   S01297
909900210712     C           DEFLT     BEGSR                                          S01297
910000210712     C*                                                                   S01297
910100210712     C                     MOVEA*BLANK    ERCD                            S01297
910200210712     C                     Z-ADD1         S       30                      S01297
910300210712     C*                                                                   S01297
910400210712     C* FIND WHETHER  DEAL COUNTERPARTY IS A BANK AND                     S01297
910500210712     C* STORE INFORMATION FOR LATER USE                                   S01297
910600210712     C*                                                                   S01297
910700210712     C*                                                                   S01297
910800210712     C                     MOVELPMCSNM    CSTKEY                          S01297
910900210712     C                     EXSR CUSGET                                    S01297
911000210712     C           RTCD      IFEQ *BLANK                     *IF1*          S01297
911100210712     C*                                                                   S01408
911200210712     C** Core hook for externalisation.                                   S01408
911300210712     C/COPY WNCPYSRC,SD2410CCP1                                           S01408
911400210712     C*                                                                   S01408
911500210712     C**********           MOVELBBBNBI    CPBNBI  1                S01297 099441
911600210712     C                     MOVELBBSWFI    CPBNBI  1                       099441
911700210712     C                     MOVELBBCSID    CPCSID 12                       S01297
911800210712     C                     MOVELBBCSSN    CPCSSN 10                       BHF766
911900210712     C                     ELSE                                           S01297
912000210712     C                     GOTO DFLERR                                    S01297
912100210712     C                     END                             *END1*         S01297
912200210712     C*                                                                   S01297
912300210712     C* FIND OUT WHAT THE SETTLEMENT BRANCH IS                            S01297
912400210712     C                     EXSR PBRGET                                    S01297
912500210712     C*                                                                   S01297
912600210712     C           RTCD      IFEQ *BLANK                                    S01297
912700210712     C                     MOVELA7BRCD    PAYBRA  3                       S01297
912800210712     C                     ELSE                                           S01297
912900210712     C                     GOTO DFLERR                                    S01297
913000210712     C                     END                                            S01297
913100210712     C*********                                                     BHF564LN0759
913200210712     C***IF*THERE*ARE*OUTSTANDING*ERRORS*ON*THE*SCREEN*OR*THE       BHF564LN0759
913300210712     C***OR*THE*SETTLEMENT*TYPE*IS*NOT*08*REDEFAULT**********       BHF564LN0759
913400210712     C***OTHERWISE*ONLY*DEFAULT*ON*FIRST*ENTER***************       BHF564LN0759
913500210712     C*********                                                     BHF564LN0759
913600210712     C*********  S         IFEQ 0                                   BHF564LN0759
913700210712     C/COPY WNCPYSRC,SD2410C044
913800210712     C*********  PMPSTM    ORNE 08                                  BHF564LN0759
913900210712     C*********            MOVE 'Y'       PMDEFT                    BHF564LN0759
914000210712     C*********            END                                      BHF564LN0759
914100210712     C*                                                             S01297BHF564
914200210712     C/COPY WNCPYSRC,SD2410C045
914300210712     C**ONLY*DO*DEFAULTS*IF*IT*IS*THE*FIRST*ENTER,*OR*IF*THE*SETTLEMS01297BHF564
914400210712     C**METHOD*IS*CHIPS*(07)****************************************S01297BHF564
914500210712     C**--------------------****************************************S01297BHF564
914600210712     C*                                                                   S01297
914700210712     C***********PMDEFT****IFEQ 'Y'                        *IF1**   S01297LN0787
914800210712     C********** PMPSTM    OREQ 07                                        S01297
914900210712     C*                                                                   S01297
915000210712     C* FIELD 58, BENEFICIARY                                             S01297
915100210712     C* ---------------------                                             S01297
915200210712     C* BENEFICIARY DEFAULTS TO THE DEAL COUNTERPARTY                     S01297
915300210712     C           PMBENN    IFEQ *BLANK                     *IF2**         S01297
915400210712     C/COPY WNCPYSRC,SD2410C081
915500210712     C                     MOVELPMCSNM    PMBENN                          S01297
915600210712     C/COPY WNCPYSRC,SD2410C046
915700210712     C                     END                             *END2*         S01297
915800210712     C*                                                                   S01297
915900210712     C/COPY WNCPYSRC,SD2410C082
916000210712     C* FIND WHETHER BENEFICIARY IS A BANK AND                            S01297
916100210712     C* STORE INFORMATION FOR LATER USE                                   S01297
916200210712     C*                                                                   S01297
916300210712     C                     MOVELPMBENN    CSTKEY                          S01297
916400210712     C                     EXSR CUSGET                                    S01297
916500210712     C           RTCD      IFEQ *BLANK                     *IF1*          S01297
916600210712     C**********           MOVELBBBNBI    BFBNBI  1                S01297 099441
916700210712     C                     MOVELBBSWFI    BFBNBI  1                       099441
916800210712     C                     ELSE                                           S01297
916900210712     C                     GOTO DFLERR                                    S01297
917000210712     C                     END                             *END1*         S01297
917100210712     C/COPY WNCPYSRC,SD2410C083
917200210712     C*                                                                   S01297
917300210712     C* FIELD 72, BANK TO BANK INFORMATION                                S01297
917400210712     C* ----------------------------------                                S01297
917500210712     C* FOR DEALS INPUT ONLY:                                             S01297
917600210712     C*                    IF THEN DEAL IS SETTLED VIA SWIFT AND          BHF596
917700210712     C* IF THE BENEFICIARY (INPUT OR DEFAULTED) IS A BANK, AND NOT THE    S01297
917800210712     C* DEAL COUNTERPARTY, AND DEAL BOOKING BRANCH DIFFERS FROM           S01297
917900210712     C* SETTLEMENT BRANCH, DEFAULT FIELD 72.                              S01297
918000210712     C* DEAL COUNTERPARTY MUST ALSO BE A BANK.                            BHF764
918100210712     C*                                                                   S01297
918200210712     C           PMCPGM    IFNE 'SSI '                     **IF2**        S01297
918300210712     C           PMBTB1    IFEQ *BLANK                     **IF3**        S01297
918400210712     C           BFBNBI    IFEQ 'Y'                        **IF4**        S01297
918500210712     C           CPBNBI    ANDEQ'Y'                                       BHF764
918600210712     C           PMBENN    ANDNEPMCSNM                                    S01297
918700210712     C           PMBRCA    ANDNEPAYBRA                                    S01297
918800210712     C           PMPSTM    ANDEQ08                                        BHF596
918900210712     C/COPY WNCPYSRC,SD2410C034
919000210712     C*                                                                   S01297
919100210712     C* USE SWIFT ID IF PRESENT, ELSE USE CUSTOMER REPORT NAME AND TOWN   S01297
919200210712     C*                                                                   S01297
919300210712     C           CPCSID    IFNE *BLANK                     **IF5**        S01297
919400210712     C                     MOVE CPCSID    WRK17  17                       S01297
919500210712     C                     MOVELWRK17     PMBTB1                          S01297
919600210712     C                     ELSE                            *ELSE5*        S01297
919700210712     C*                                                                   BHF506
919800210712     C** FIND CUSTOMER REPORT NAME AND TOWN                               BHF506
919900210712     C*                                                                   BHF506
920000210712     C                     MOVELPMCSNM    CSTKEY                          BHF506
920100210712     C                     EXSR CUSGET                                    BHF506
920200210712     C           RTCD      IFNE *BLANK                     *IF1*          BHF506
920300210712     C                     GOTO DFLERR                                    BHF506
920400210712     C                     END                             *END1*         BHF506
920500210712     C                     MOVELBBCRNM    WRK30  30                       S01297
920600210712     C                     MOVE BBCRTN    WRK30                           S01297
920700210712     C                     MOVE WRK30     PMBTB1                          S01297
920800210712     C                     END                             **END5*        S01297
920900210712     C*                                                                   S01297
921000210712     C                     MOVEL'/INS/'   PMBTB1                          S01297
921100210712     C/COPY WNCPYSRC,SD2410C035
921200210712     C                     END                             **END4*        S01297
921300210712     C                     END                             **END3*        S01297
921400210712     C                     END                             **END2*        S01297
921500210712     C*                                                                   S01297
921600210712     C********** PMPSTM    IFEQ 01                                  S01297BHF517
921700210712     C********** PMPSTM    OREQ 08                                  S01297BHF517
921800210712     C           PMPSTM    IFEQ 08                                        BHF517
921900210712     C                     EXSR DEF18                                     S01297
922000210712     C                     END                                            S01297
922100210712     C*                                                                   S01297
922200210712     C           PMPSTM    IFEQ 07                         **IF2**        S01297
922300210712     C                     EXSR CHIPS                                     S01297
922400210712     C                     END                             **END2*        S01297
922500210712     C*********************END                             **END1*  S01297LN0787
922600210712     C                     MOVE 'N'       PMDEFT                          S01297
922700210712     C*                                                                   S01297
922800210712     C           DFLERR    TAG                                            S01297
922900210712     C*                                                                   S01297
923000210712     C                     ENDSR                                          S01297
923100210712     C********************************************************************S01297
923200210712      /EJECT                                                              S01297
923300210712     C*****************************************************************   S01297
923400210712     C*                                                               *   S01297
923500210712     C**DEF18****-*01*08**PROCESSING********************************S01297BHF517
923600210712     C* DEF18 - 08  PROCESSING                                        *   BHF517
923700210712     C*                                                               *   S01297
923800210712     C* CALLED BY DEFLT                                               *   S01297
923900210712     C*                                                               *   S01297
924000210712     C*****************************************************************   S01297
924100210712     C*                                                                   S01297
924200210712     C           DEF18     BEGSR                                          S01297
924300210712     C*                                                                   S01297
924400210712     C* FIELD 50, ORDERING CUSTOMER (PAY SIDE)                            S01297
924500210712     C* --------------------------------------                            S01297
924600210712     C**IF*THE*BENEFICIARY*IS*THE*DEAL*COUNTERPARTY*AND*THE*********S01297BHF585
924700210712     C**DEAL*COUNTERPARTY*IS*A*NON-BANK,THEN*DEFAULT*TO*THE*DEAL****BHF569BHF585
924800210712     C**COUNTERPARTY.***********************************************S01297BHF585
924900210712     C* IF THE DEAL COUNTERPARTY IS A NON-BANK,THEN DEFAULT TO THE        BHF585
925000210712     C* DEAL COUNTERPARTY.                                                BHF585
925100210712     C*                                                                   S01297
925200210712     C*********  PMCSNM    IFEQ PMBENN                     *IF0**         BHF585
925300210712     C*********  PMPOCN    IFEQ *BLANK                     *IF1**   S01297LN0782
925400210712     C********** PMPOBN    ANDEQ*BLANK                              BHF549LN0782
925500210712     C*                                                                   S01297
925600210712     C********** BFBNBI    IFNE 'Y'                        *IF3**   S01297LN0748
925700210712     C********** CPBNBI    ANDEQ'N'                                 BHF585LN0748
925800210712     C**********           MOVELPMCSNM    PMPOCN                    S01297LN0782
925900210712     C**********           END                             *END3*   S01297LN0782
926000210712     C**********           END                             *END1*   S01297LN0748
926100210712     C**********           END                             *END0*         BHF585
926200210712     C*                                                                   LN0782
926300210712     C** IF THE BENEFICIARY IS A NON BANK OR THE DEAL C/PARTY IS          LN0782
926400210712     C** A NON BANK THEN DEFAULT FIELD 50 TO THE DEAL C/PARTY             LN0782
926500210712     C*                                                                   LN0782
926600210712     C********** BFBNBI    IFEQ 'N'                                                  LN0782 MD027449
926700210712     C********** CPBNBI    OREQ 'N'                                                  LN0782 MD027449
926800210712     C********** PMPOBN    ANDEQ*BLANKS                                              142408 MD027449
926900210712     C********** BFBNBI    ANDEQ'N'                                                  134496 MD027449
927000210712     C           PMPOBN    IFEQ *BLANKS                                                     MD027449
927100210712     C           PMPOCN    ANDEQ*BLANKS                                                     MD027449
927200210712     C           BFBNBI    IFEQ 'N'                                                         MD027449
927300210712     C           CPBNBI    OREQ 'N'                                                         MD027449
927400210712      *                                                                   157861
927500210712     C                     MOVELPMCSNM    CSTKEY                          157861
927600210712     C                     EXSR CUSGET                                    157861
927700210712      *                                                                   157861
927800210712      ** Default a non bank ordering customer                             157861
927900210712      *                                                                   157861
928000210712     C           BBBNBI    IFEQ 'N'                                       157861
928100210712     C                     MOVELPMCSNM    PMPOCN                          LN0782
928200210712     C                     ENDIF                                          157861
928300210712     C                     ENDIF                                                            MD027449
928400210712     C                     END                                            LN0782
928500210712     C*                                                                   S01297
928600210712     C* FIELD 52 - ORDERING BANK, PAY SIDE.                               S01297
928700210712     C* -----------------------------------                               S01297
928800210712     C*                                                                   S01297
928900210712     C**IF*ORDERING*BANK*IS*BLANK:*                                 S01297BHF569
929000210712     C********** PMPOBN    IFEQ *BLANK                     *IF1**   S01297BHF569
929100210712     C********** PMPOCN    ANDEQ*BLANK                              BHF549BHF569
929200210712     C**********                                                    S01297BHF569
929300210712     C**IF*THE*BENEFICIARY*IS*A*BANK,*                              S01297BHF569
929400210712     C**AND*DEAL*COUNTERPARTY*IS*A*BANK*                            S01297BHF569
929500210712     C**AND*BENEFICIARY*DIFFERS*FROM*DEAL*COUNTERPARTY              S01297BHF569
929600210712     C**********                                                    S01297BHF569
929700210712     C********** BFBNBI    IFEQ 'Y'                        *IF2**   S01297BHF569
929800210712     C********** CPBNBI    ANDEQ'Y'                                 S01297BHF569
929900210712     C********** PMBENN    ANDNEPMCSNM                              S01297BHF569
930000210712     C**********                                                    S01297BHF569
930100210712     C********** PMBRCA    IFEQ PAYBRA                     *IF3**   S01297BHF569
930200210712     C********** PMCPGM    ANDNE'SSI '                              S01297BHF569
930300210712     C********** PMCPGM    OREQ 'SSI '                              S01297BHF569
930400210712     C**********                                                    S01297BHF569
930500210712     C****DEFAULT*TO*DEAL*COUNTERPARTY*                             S01297BHF569
930600210712     C**********           MOVELPMCSNM    PMPOBN                    S01297BHF569
930700210712     C**********                                                    S01297BHF569
930800210712     C**********           END                             *END3*   S01297BHF569
930900210712     C**********           END                             *END2*   S01297BHF569
931000210712     C**********                                                    S01297BHF569
931100210712     C**FOR*DEALS*INPUT*ONLY:*                                      S01297BHF569
931200210712     C**IF*DEAL*BOOKING*BRANCH*DIFFERS*FROM*SETTLEMENT*BRANCH*      S01297BHF569
931300210712     C**DEFAULT*TO*SWIFT*ADDRESS*OF*BICN*OF*DEAL*BOOKING*BRANCH*    S01297BHF569
931400210712     C*********  PMCPGM    IFNE 'SSI '                     *IF2**   S01297BHF569
931500210712     C*********  PMBRCA    IFNE PAYBRA                     *IF3**   S01297BHF569
931600210712     C*********                                                     S01297BHF569
931700210712     C*********            CALL 'AOBRCHR0'                          S01297BHF569
931800210712     C*********            PARM           RTCD                      S01297BHF569
931900210712     C*********            PARM '*KEY'    OPTN                      S01297BHF569
932000210712     C*********            PARM           PMBRCA                    S01297BHF569
932100210712     C*********  SDBRCH    PARM SDBRCH    DSFDY                     S01297BHF569
932200210712     C**********                                                    S01297BHF569
932300210712     C********** RTCD      IFEQ *BLANK                     *IF4**   S01297BHF569
932400210712     C**********           MOVELA8BICN    CSTKEY                    S01297BHF569
932500210712     C**********           EXSR CUSGET                              S01297BHF569
932600210712     C**********                                                    S01297BHF569
932700210712     C********** RTCD      IFEQ *BLANK                     *IF5**   S01297BHF569
932800210712     C**********           MOVELBBCSSN    PMPOBN                    S01297BHF569
932900210712     C**********           MOVELBBCUST    PAPOBN                    S01297BHF569
933000210712     C**********           MOVELBBCUST    PMPOBN                    S01297BHF569
933100210712     C**********           ELSE                            *ELS5*   S01297BHF569
933200210712     C**********           MOVELA8BICN    PAPOBN                    S01297BHF569
933300210712     C**********           MOVELA8BICN    PMPOBN                    S01297BHF569
933400210712     C**********           END                             *END5*   S01297BHF569
933500210712     C**********                                                    S01297BHF569
933600210712     C**********           END                             *END4*   S01297BHF569
933700210712     C**********                                                    S01297BHF569
933800210712     C**********           END                             *END3*   S01297BHF569
933900210712     C**********                                                    S01297BHF569
934000210712     C**********           END                             *END2*   S01297BHF569
934100210712     C**********                                                    S01297BHF569
934200210712     C**********                                                    S01297BHF569
934300210712     C**********           END                             *END1*   S01297BHF569
934400210712     C**********                                                    S01297BHF569
934500210712     C*                                                                   BHF569
934600210712     C** IF SD INPUT OR BOOKING BRANCH = SETTLEMENT BRANCH                BHF569
934700210712     C*                                                                   BHF569
934800210712     C           PMCPGM    IFEQ 'SSI '                     *IF1**         BHF569
934900210712     C           PMBRCA    OREQ PAYBRA                                    BHF569
935000210712     C*                                                                   BHF569
935100210712     C* IF BENEFICIARY IS A BANK AND C/PARTY IS A BANK                    BHF569
935200210712     C* AND BENEFICIARY IS NOT THE  C/PARTY                               BHF569
935300210712     C*                                                                   BHF569
935400210712     C           PMBENN    IFNE CPCSSN                                    BHF766
935500210712     C           PMBENN    ANDNEPMCSNM                                    BHF766
935600210712     C*                                                                   BHF766
935700210712     C           BFBNBI    IFEQ 'Y'                         *IF2**        BHF569
935800210712     C           CPBNBI    ANDEQ'Y'                                       BHF569
935900210712     C*                                                                   043712
936000210712     C           PMPOBN    IFEQ *BLANKS                                   043712
936100210712     C****       PMBENN    ANDNEPMCSNM                             BHF569 BHF766
936200210712     C*                                                                   BHF569
936300210712     C**  DEFAULT TO DEAL COUNTERPARTY                                    BHF569
936400210712     C*                                                                   BHF569
936500210712     C                     MOVELPMCSNM    PMPOBN                          BHF569
936600210712     C*                                                                   043712
936700210712     C                     END                                            043712
936800210712     C*                                                                   BHF569
936900210712     C                     END                             *END2*         BHF569
937000210712     C*                                                                   BHF766
937100210712     C                     END                                            BHF766
937200210712     C*                                                                   BHF569
937300210712     C                     END                             *END1*         BHF569
937400210712     C/COPY WNCPYSRC,SD2410C030
937500210712     C*                                                                   BHF569
937600210712     C** IF NOT SD INPUT AND BOOKING BRANCH IS NOT = SETTLEMENT BRANCH    BHF569
937700210712     C*                                                                   BHF569
937800210712     C           PMCPGM    IFNE 'SSI '                     *IF1**         BHF569
937900210712     C           PMBRCA    ANDNEPAYBRA                                    BHF569
938000210712     C*                                                                   BHF569
938100210712     C** GET BOOKING BRANCH BICN                                          BHF569
938200210712     C*                                                                   BHF569
938300210712     C**********           CALL 'AOBRCHR0'                                             BHF569 CGL029
938400210712     C                     CALL 'AOBRCHR1'                                                    CGL029
938500210712     C                     PARM           RTCD                            BHF569
938600210712     C                     PARM '*KEY'    OPTN                            BHF569
938700210712     C                     PARM           PMBRCA                          BHF569
938800210712     C********** SDBRCH    PARM SDBRCH    DSFDY                                        BHF569 CGL029
938900210712     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
939000210712     C*                                                                   BHF569
939100210712     C** ACCESS CUSTOMER FOR THIS BICN                                    BHF569
939200210712     C*                                                                   BHF569
939300210712     C           RTCD      IFEQ *BLANK                      *IF2**        BHF569
939400210712     C***********          MOVELA8BICN    CSTKEY                    BHF569CSW096
939500210712     C                     MOVELA8BICN    CSTKEY    P                     CSW096
939600210712     C                     EXSR CUSGET                                    BHF569
939700210712     C*                                                                   BHF569
939800210712     C** IF SHORTNAME IS NON BLANK DEFAULT FIELD 52 TO THE SHORTNAME      BHF569
939900210712     C*                                                                   BHF569
940000210712     C           RTCD      IFEQ *BLANK                      *IF3**        BHF569
940100210712     C           PMPOBN    IFEQ *BLANK                      *CES1         101041
940200210712     C           BBCSSN    ANDNE*BLANK                                    BHF569
940300210712     C                     MOVELBBCSSN    PMPOBN                          BHF569
940400210712     C*                                                                   BHF569
940500210712     C                     ELSE                             *ELS3*        BHF569
940600210712     C*                                                                   BHF569
940700210712     C** DEFAULT FIELD 52 TO THE BICN                                     BHF569
940800210712     C*                                                                   BHF569
940900210712     C           PMPOBN    IFEQ *BLANK                      *CES2         101041
941000210712     C           BBCSSN    ANDEQ*BLANK                                    101041
941100210712     C                     MOVELA8BICN    PMPOBN                          BHF569
941200210712     C*                                                                   BHF569
941300210712     C                     END                              *CES2         101041
941400210712     C                     END                              *CES1         101041
941500210712     C                     END                              *END3*        BHF569
941600210712     C                     END                              *END2*        BHF569
941700210712     C                     END                              *END1*        BHF569
941800210712     C*                                                                   BHF569
941900210712     C*                                                                   BHF569
942000210712     C* FIELD 57, 'ACCOUNT WITH' BANK (PAY SIDE)                          S01297
942100210712     C* ----------------------------------------                          S01297
942200210712     C* FOR DEALS INPUT ONLY:                                             S01297
942300210712     C*                                                                   S01297
942400210712     C           PMCPGM    IFNE 'SSI '                     *IF1**  NOT SD S01297
942500210712     C*                                                                   S01297
942600210712     C                     CALL 'AOTRADR0'                                S01297
942700210712     C                     PARM '*DBERR'  RTCD                            S01297
942800210712     C                     PARM '*FIRST'  OPTN                            S01297
942900210712     C           SDTRAD    PARM SDTRAD    DSFDY                           S01297
943000210712     C*                                                                   S01297
943100210712     C* IF THE DEAL IS FOR FEDERAL FUNDS AND THE DEAL (PAY) CURRENCY      S01297
943200210712     C* IS US DOLLARS.                                                    S01297
943300210712     C*                                                                   S01297
943400210712     C           PMFFND    IFEQ 'Y'                        **IF2**        S01297
943500210712     C           PMPCCY    ANDEQBLUSCY                                    S01297
943600210712     C*                                                                   S01297
943700210712     C* IF FIELD 57 IS BLANK THEN DISPLAY ERROR MESSAGE                   S01297
943800210712     C********** PMAWBA    IFEQ *BLANK                              S01297LN0691
943900210712     C           PMAWBN    IFEQ *BLANK                                    LN0691
944000210712     C** Only check if the pay side is not protected                      158192
944100210712     C           PMPPAY    ANDNE'Y'                                       158192
944200210712     C** ERROR**                                                          S01297
944300210712     C                     MOVE '703'     ERCD,S                          S01297
944400210712     C                     ADD  1         S                               S01297
944500210712     C                     MOVE '1'       *IN31                           LN0787
944600210712     C**********           END                             *END1*   S01297LN0691
944700210712     C**********           ELSE                            *ELSE1*  LN0691BHF503
944800210712     C                     END                             *END1*         BHF503
944900210712     C*                                                                   S01297
945000210712     C*                                                                   S01297
945100210712     C* IF THE INTERMEDIARY BANK IS NOT BLANK:                            S01297
945200210712     C********** PAPIBN    IFNE *BLANK                     **IF3**  BHF584S01297
945300210712     C           PMPIBN    IFNE *BLANK                     **IF3**        BHF584
945400210712     C*                                                                   S01297
945500210712     C* IF INTERMEDIARY BANK A/C LINE IS BLANK DEFAULT, ELSE VALIDATE.    S01297
945600210712     C           PMPIBA    IFEQ *BLANK                     **IF4**        S01297
945700210712     C                     MOVEL'//FW'    PMPIBA                          S01297
945800210712     C                     ELSE                            *ELSE4*        S01297
945900210712     C**********           MOVELPMPIBA    CHECK3  3                 S01297LN0691
946000210712     C                     MOVELPMPIBA    CHECK4  4                       LN0691
946100210712     C********** CHECK3    IFNE '//FW'                     **IF5**  S01297LN0691
946200210712     C           CHECK4    IFNE '//FW'                     **IF5**        LN0691
946300210712     C** ERROR***                                                         S01297
946400210712     C                     MOVE '700'     ERCD,S                          S01297
946500210712     C                     ADD  1         S                               S01297
946600210712     C                     MOVE '1'       *IN31                           LN0787
946700210712     C                     END                             **END5*        S01297
946800210712     C*                                                                   S01297
946900210712     C                     END                             **END4*        S01297
947000210712     C*                                                                   S01297
947100210712     C* IF INTERMEDIARY BANK (FIELD 56) IS BLANK:                         S01297
947200210712     C                     ELSE                            *ELSE3*        S01297
947300210712     C*                                                                   S01297
947400210712     C* IF ACCOUNT WITH BANK A/C LINE IS BLANK DEFAULT, ELSE VALIDATE.    S01297
947500210712     C           PMAWBA    IFEQ *BLANK                     **IF4**        S01297
947600210712     C                     MOVEL'//FW'    PMAWBA                          S01297
947700210712     C                     ELSE                            *ELSE4*        S01297
947800210712     C**********           MOVELPMAWBA    CHECK3                    S01297LN0691
947900210712     C                     MOVELPMAWBA    CHECK4                          LN0691
948000210712     C********** CHECK3    IFNE '//FW'                     **IF5**  S01297LN0691
948100210712     C           CHECK4    IFNE '//FW'                     **IF5**        LN0691
948200210712     C** ERROR***                                                         S01297
948300210712     C                     MOVE '701'     ERCD,S                          S01297
948400210712     C                     ADD  1         S                               S01297
948500210712     C                     MOVE '1'       *IN31                           LN0787
948600210712     C                     END                             **END5*        S01297
948700210712     C                     END                             **END4*        S01297
948800210712     C*                                                                   S01297
948900210712     C                     END                             **END3*        S01297
949000210712     C*                                                                   S01297
949100210712     C**********    *      END                             **END2*  S01297BHF503
949200210712     C*                                                                   S01297
949300210712     C                     END                             **END1*        S01297
949400210712     C                     END                                            LN0691
949500210712     C*                                                                   S01297
949600210712     C*                                                                   S01297
949700210712     C                     ENDSR                                          S01297
949800210712     C********************************************************************S01297
949900210712      /EJECT                                                              S01297
950000210712     C*****************************************************************   S01297
950100210712     C*                                                               *   S01297
950200210712     C* CHIPS    - 07 PROCESSING                                      *   S01297
950300210712     C*                                                               *   S01297
950400210712     C* CALLED BY                                                     *   S01297
950500210712     C*                                                               *   S01297
950600210712     C*****************************************************************   S01297
950700210712     C*                                                                   S01297
950800210712     C           CHIPS     BEGSR                                          S01297
950900210712     C*                                                                   S01297
951000210712     C* FIELD 50, ORDERING CUSTOMER (PAY SIDE)                            S01297
951100210712     C* --------------------------------------                            S01297
951200210712     C* IF THE BENEFICIARY DIFFERS FROM THE DEAL COUNTERPARTY AND THE     S01297
951300210712     C* DEAL COUNTERPARTY IS A NON-BANK, THEN DEFAULT TO THE DEAL         S01297
951400210712     C* COUNTERPARTY.                                                     S01297
951500210712     C*                                                                   S01297
951600210712     C           PMPOCN    IFEQ *BLANK                     *IF1**         S01297
951700210712     C           PMBENN    IFNE PMCSNM                     *IF2**         S01297
951800210712     C           CPBNBI    ANDNE'Y'                                       S01297
951900210712     C           BFBNBI    ANDEQ'N'                                       134496
952000210712     C                     MOVELPMCSNM    PMPOCN                          S01297
952100210712     C                     END                             *END2*         S01297
952200210712     C*                                                                   S01297
952300210712     C                     END                             *END1*         S01297
952400210712     C*                                                                   S01297
952500210712     C* FIELD 52 - ORDERING BANK, PAY SIDE.                               S01297
952600210712     C* -----------------------------------                               S01297
952700210712     C* IF THE BENEFICIARY DIFFERS FROM THE DEAL COUNTERPARTY             S01297
952800210712     C* AND THE DEAL COUNTERPARTY IS A BANK THEN DEFAULT TO DEAL          S01297
952900210712     C* COUNTERPARTY.                                                     S01297
953000210712     C*                                                                   S01297
953100210712     C           PMPOBN    IFEQ *BLANK                     *IF1**         S01297
953200210712     C*                                                                   S01297
953300210712     C           PMBENN    IFNE PMCSNM                     *IF2**         S01297
953400210712     C           CPBNBI    ANDEQ'Y'                                       S01297
953500210712     C                     MOVELPMCSNM    PMPOBN                          S01297
953600210712     C                     END                             *END2*         S01297
953700210712     C*                                                                   S01297
953800210712     C                     END                             *END1*         S01297
953900210712     C**********                                                    S01297BHF519
954000210712     C**FOR*SETTLEMENT*TYPE*07*IF*BOTH*FIELD*50*AND*FIELD*52*ARE*BLAS01297BHF519
954100210712     C**THEN*DISPLAY*ERROR*MESSAGE*                                 S01297BHF519
954200210712     C**********                                                    S01297BHF519
954300210712     C********** PMPOCN    IFEQ *BLANK                     *IF1**   S01297BHF519
954400210712     C********** PMPOBN    ANDEQ*BLANK                              S01297BHF519
954500210712     C** ERROR**                                                    S01297BHF519
954600210712     C**********           MOVE '702'     ERCD,S                    S01297BHF519
954700210712     C**********           ADD  1         S                         S01297BHF519
954800210712     C**********           END                             *END1*   S01297BHF519
954900210712     C*                                                                   S01297
955000210712     C* IF FIELD 57 IS BLANK THEN DISPLAY ERROR MESSAGE                   S01297
955100210712     C********** PMAWBA    IFEQ *BLANK                              S01297LN0691
955200210712     C           PMAWBN    IFEQ *BLANK                                    LN0691
955300210712     C** ERROR**                                                          S01297
955400210712     C                     MOVE '703'     ERCD,S                          S01297
955500210712     C                     ADD  1         S                               S01297
955600210712     C                     MOVE '1'       *IN31                           LN0787
955700210712     C                     END                             *END1*         S01297
955800210712     C*                                                                   S01297
955900210712     C**IF*NO*VALID*CHIPS*ABA*SET*UP*ON*CUSTOMER*DETAILS*           S01297BHF552
956000210712     C**FOR*RECEIVING*BANK*THEN*ERROR.*                             S01297BHF552
956100210712     C**USE*INTERMEDIARY*BANK*IF*PRESENT*ELSE*USE*'ACCOUNT WITH'*BANS01297BHF552
956200210712     C**********                                                    S01297BHF552
956300210712     C********** PMPIBN    IFNE *BLANK                     *IF1**   S01297BHF552
956400210712     C**********           MOVELPMPIBN    CSTKEY                    S01297BHF552
956500210712     C**********           EXSR CUSGET                              S01297BHF552
956600210712     C********** BBCABA    IFEQ *ZERO                      *IF2**   S01297BHF552
956700210712     C***ERROR**                                                    S01297BHF552
956800210712     C**********           MOVE '704'     ERCD,S                    S01297BHF552
956900210712     C**********           ADD  1         S                         S01297BHF552
957000210712     C**********           END                             *END2*   S01297BHF552
957100210712     C*********            ELSE                            *ELS1*   S01297BHF552
957200210712     C*                                                             S01297BHF552
957300210712     C********** PAAWBN    IFNE *BLANK                     *IF2**   S01297BHF504
957400210712     C**********           MOVELPAAWBN    CSTKEY                    S01297BHF504
957500210712     C********** PMAWBN    IFNE *BLANK                     *IF2**   BHF504BHF552
957600210712     C**********           MOVELPMAWBN    CSTKEY                    BHF504BHF552
957700210712     C**********           EXSR CUSGET                              S01297BHF552
957800210712     C********** BBCABA    IFEQ *ZERO                      *IF3**   S01297BHF552
957900210712     C***ERROR**                                                    S01297BHF552
958000210712     C**********           MOVE '705'     ERCD,S                    S01297BHF552
958100210712     C**********           ADD  1         S                         S01297BHF552
958200210712     C**********           END                             *END3*   S01297BHF552
958300210712     C**********           END                             *END2*   S01297BHF552
958400210712     C**********           END                             *END1*   S01297BHF552
958500210712     C*                                                             S01297BHF552
958600210712     C                     ENDSR                                          S01297
958700210712     C*                                                                   S01297
958800210712     C*****************************************************************   S01297
958900210712      /EJECT                                                              S01297
959000210712     C*****************************************************************   S01297
959100210712     C*                                                               *   S01297
959200210712     C* CUSGET   - To Access customer details                         *   S01297
959300210712     C*                                                               *   S01297
959400210712     C* CALLED BY       DEFLT, CHIPS, DEF18.                          *   S01297
959500210712     C*                                                               *   S01297
959600210712     C*****************************************************************   S01297
959700210712     C*                                                                   S01297
959800210712     C           CUSGET    BEGSR                                          S01297
959900210712     C*                                                                   S01297
960000210712     C/COPY WNCPYSRC,SD2410C037
960100210712     C                     MOVE *BLANKS   RTCD                            S01297
960200210712     C*                                                                   S01297
960300210712     C                     CALL 'AOCUSTR0'                                S01297
960400210712     C                     PARM           RTCD    7                       S01297
960500210712     C                     PARM '*KEY   ' OPTN    7                       S01297
960600210712     C                     PARM           CSTKEY 10                       S01297
960700210712     C                     PARM           KEYSTS  7                       S01297
960800210712     C           CURF      PARM CURF      DSSDY                           S01297
960900210712     C*                                                                   S01297
961000210712     C                     ENDSR                                          S01297
961100210712     C*********************************************************************
961200210712     C*                                                               *   S01297
961300210712     C* PBRGET   - To Obtain Pay Settlement Branch fof Validation     *   S01297
961400210712     C*                                                               *   S01297
961500210712     C* CALLED BY       DEFLT.                                        *   S01297
961600210712     C*                                                               *   S01297
961700210712     C*****************************************************************   S01297
961800210712     C           PBRGET    BEGSR                                          S01297
961900210712     C                     MOVE *BLANKS   RTCD                            S01297
962000210712      *                                                                   S01297
962100210712     C                     MOVELPMPONS    NOSTRO                          S01297
962200210712     C                     MOVELNOST02    @NONB                           S01297
962300210712      *                                                                   137252
962400210712      **  Beneficiary details are not being defaulted on first time       137252
962500210712     C           WPECY     IFNE *BLANKS                                   137252
962600210712     C***********          MOVELPMPCCY    @CYCD                    S01297 CEU003
962700210712     C                     MOVELWPECY     @CYCD                           CEU003
962800210712     C                     ELSE                                           137252
962900210712     C                     MOVELPMPCCY    @CYCD                           137252
963000210712     C                     END                                            137252
963100210712      *                                                                                       162959
963200210712     C           PMPSCY    IFNE *BLANKS                                                       162959
963300210712     C                     MOVELPMPSCY    @CYCD                                               162959
963400210712     C                     ELSE                                                               162959
963500210712     C                     MOVELPMPCCY    @CYCD                                               162959
963600210712     C                     ENDIF                                                              162959
963700210712      *                                                                   108517
963800210712      ** Test if the Nostro field contains a '?'.  Remove if found.       108517
963900210712      *                                                                   108517
964000210712     C                     MOVEA@NONB     @QM                             108517
964100210712     C           '?'       LOKUP@QM                      62               108517
964200210712     C           *IN62     IFEQ *ON                                       108517
964300210712     C                     MOVEL*BLANKS   @NONB                           108517
964400210712     C                     ENDIF                                          108517
964500210712      *                                                                   S01297
964600210712     C**********           CALL 'AONOSTR0'                                             S01297 CDL094
964700210712     C                     CALL 'AONOSTR1'                                                    CDL094
964800210712     C                     PARM           RTCD                            S01297
964900210712     C                     PARM '*KEY   ' OPTN                            S01297
965000210712     C                     PARM *BLANKS   @CUST   6                       S01297
965100210712     C                     PARM           @CYCD   3                       S01297
965200210712     C**********           PARM *BLANKS   @ACCD   4                                    S01297 CGL029
965300210712     C                     PARM *BLANKS   @ACCD                                               CGL029
965400210712     C                     PARM *BLANKS   @ACSN   2                       S01297
965500210712     C                     PARM           @NONB   2                       S01297
965600210712     C                     PARM *BLANKS   @BRCD   3                       S01297
965700210712     C                     PARM *BLANKS   @CSSN  10                       S01297
965800210712     C                     PARM *BLANKS   @PNOI   1                       S01297
965900210712     C********** A7RF      PARM A7RF      DSFDY                                        S01297 CDL094
966000210712     C           A7RF      PARM A7RF      DSSDY                                               CDL094
966100210712     C*                                                                   S01297
966200210712     C                     ENDSR                                          S01297
966300210712     C*****************************************************************   BHF465
966400210712     C*                                                               *   BHF465
966500210712     C* RECDEF   - Do Receive side Defaulting                         *   BHF465
966600210712     C*                                                               *   BHF465
966700210712     C* CALLED BY       MAIN                                          *   BHF465
966800210712     C*                                                               *   BHF465
966900210712     C*****************************************************************   BHF465
967000210712     C*                                                                   BHF465
967100210712     C           RECDEF    BEGSR                                          BHF465
967200210712     C*                                                                   BHF553
967300210712     C***ONLY*DO*DEFAULTS IF IT IS THE FIRST ENTER                  BHF553LN0787
967400210712     C********************                                          BHF553LN0787
967500210712     C***********PMDEFT    IFEQ 'Y'                        *IF1**   BHF553LN0787
967600210712     C*                                                                   BHF572
967700210712     C* FIND WHETHER  DEAL COUNTERPARTY IS A BANK AND                     BHF572
967800210712     C* STORE INFORMATION FOR LATER USE                                   BHF572
967900210712     C*                                                                   BHF572
968000210712     C*                                                                   BHF572
968100210712     C                     MOVELPMCSNM    CSTKEY                          BHF572
968200210712     C                     EXSR CUSGET                                    BHF572
968300210712     C           RTCD      IFEQ *BLANK                     *IF1*          BHF572
968400210712     C*                                                                   S01408
968500210712     C** Core hook for externalisation.                                   S01408
968600210712     C/COPY WNCPYSRC,SD2410CCP2                                           S01408
968700210712     C*                                                                   S01408
968800210712     C**********           MOVELBBBNBI    CPBNBI  1                BHF572 099441
968900210712     C                     MOVELBBSWFI    CPBNBI  1                       099441
969000210712     C                     MOVELBBCSID    CPCSID 12                       BHF572
969100210712     C                     ELSE                                           BHF572
969200210712     C                     GOTO ERROR                                     BHF572
969300210712     C                     END                             *END1*         BHF572
969400210712     C*                                                                   BHF553
969500210712     C** IF BOTH ORDERING CUSTOMER AND ORDERING BANK ARE BLANK            BHF553
969600210712     C** AND THE DEAL COUNTERPARTY IS A BANK DEFAULT ORDERING             BHF553
969700210712     C** BANK TO THE CUSTOMER                                             BHF553
969800210712     C*                                                                   BHF465
969900210712     C           CPBNBI    IFEQ 'Y'                        *IF2**         BHF465
970000210712     C           PMROCN    ANDEQ*BLANKS                                   BHF553
970100210712     C           PMROBN    ANDEQ*BLANKS                                   BHF553
970200210712     C                     MOVE PMCSNM    PMROBN                          BHF465
970300210712     C**********           ELSE                                     BHF465BHF553
970400210712     C                     END                             *END2*         BHF553
970500210712     C*                                                                   BHF553
970600210712     C** IF BOTH ORDERING CUSTOMER AND ORDERING BANK ARE BLANK            BHF553
970700210712     C** AND THE DEAL COUNTERPARTY IS NOT A BANK DEFAULT ORDERING         BHF553
970800210712     C** CUSTOMER TO THE CUSTOMER                                         BHF553
970900210712     C*                                                                   BHF553
971000210712     C           CPBNBI    IFEQ 'N'                         *IF3**        BHF465
971100210712     C           PMROBN    ANDEQ*BLANKS                                   BHF553
971200210712     C           PMROCN    ANDEQ*BLANKS                                   BHF55D
971300210712     C                     MOVE PMCSNM    PMROCN                          BHF465
971400210712     C                     END                              *END3*        BBHF55
971500210712     C*********************END                              *END1*  BHF553LN0787
971600210712     C                     MOVE 'N'       PMDEFR                          LN0787
971700210712     C           ERROR     TAG
971800210712     C                     ENDSR                                          BHF465
971900210712     C*                                                                   BHF465
972000210712     C*****************************************************************   BHF465
972100210712     C*                                                                   S01408
972200210712     C/COPY ZSRSRC,ZDATE1Z2                                               CSW005
972300210712     C/COPY ZSRSRC,ZXRATEZ1                                                                   CLE031
972400210712     C/COPY WNCPYSRC,SD2410CP19                                           S01408
972500210712     C*                                                                   S01408
972600210712      *                                                                   S01408
972700210712      /COPY WNCPYSRC,SD2410CEND                                           S01408
972800210712      *                                                                   S01408
972900210712      /COPY WNCPYSRC,SD2410ADTA                                           S01408
973000210712      /EJECT                                                                                  CLE031
973100210712     C/COPY ZSRSRC,ZEDITZ2                                                                    CLE031
973200210712**  CPY@
973300210712(c) Finastra International Limited 2001
973400210712**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
9735002107120366073110961461
973600210712**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
973700210712000031059090120151181212243273304334365
973800210712**   SVAL  -  SYSTEM VALUES ARRAY                                                             CLE033
973900210712Settlement09Customer                                                                          CLE033
974000210712Settlement09AccCode                                                                           CLE033
974100210712Settlement09Hostpgm                                                                           CLE033
974200210712Settlement09Postings                                                                          218782
