     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas SD BRT customer details maintenance')
      *****************************************************************
      *                                                               *
      *  Midas - Standing Data Module                                 *
      *                                                               *
      *  SD2464  -  BASIC RATE TAX (BRT) CUSTOMER DETAILS MAINTENANCE *
      *                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. 260405             Date 04Apr20               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD027             Date 09Dec05               *
      *                 CAAA03             Date 15Apr04               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CRE007             Date 01Mar01               *
      * Midas DBA 3.02 -----------------------------------------------*
      *                 112708             Date 13Oct99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                    090634             DATE 27FEB98            *
      *                    096730             DATE 23JAN98            *
      *                    091778             DATE 20JAN98            *
      *                    075324             DATE 13JAN98            *
      *                    077335             DATE 09NOV94            *
      *                    S01383             DATE 27APR92            *
      *                                                               *
      *****************************************************************
      *                                                               *
      *  260405 - BRT Participation Date of Birth field is missing.   *
      *           Upgrade fix 235425. Amend date of birth fields to   *
      *           cater for century value.                            *
      *         - Applied for MD055446.                               *
      *  MD046248 - Finastra Rebranding                               *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CAAA03 - Webfacing Changes (Recompile)                       *
      *  CRE007  -  Base Rate Tax 2001.                               *
      *  112708  -  Default for further parties should be 'N'         *
      *  090634  -  Ensure that participator history file is updated  *
      *             if participator details are changed.              *
      *  096730  -  Display msg 'Interest adjustment required....'    *
      *             if a/c holder type changed to B, C, N or O and    *
      *             interest payments exist in the current tax year.  *
      *  091778  -  Further parties field should not be blanks -      *
      *             default the value if not input.                   *
      *  075324  -  Allow entry of BRT Tax indicator 'L' or 'N' if    *
      *             BRT Liable field is 'X'.                          *
      *     077335  -  THE SCREEN SHOULD NOT BE DISPLAYED IN DELETE   *
      *                MODE.                                          *
      *     S01383  -  BASIC RATE TAX INCORPORATION                   *
      *                NEW PROGRAM                                    *
      *                                                               *
      *****************************************************************
     FSDCBRTL0IF  E           K        DISK
     FINTPSL6 IF  E           K        DISK
     FINTPSL7 IF  E           K        DISK
     F            INTPSDDF                          KRENAMEINTPSD7F
     FINTPSL8 IF  E           K        DISK
     F            INTPSDDF                          KRENAMEINTPSD8F
     FSDCBRTL1UF  E           K        DISK                      A
     F            SDCBRTD0                          KRENAMESDCBRTDX
     F                                              KCOMIT
     FPTYHSTPDUF  E           K        DISK                      A
     F                                              KCOMIT
      * Display File
     F*SD2464DFCF**E*****               WORKSTN                           077335
     FSD2464DFCF  E                    WORKSTN                        UC  077335
      *
      /EJECT
      *****************************************************************
      *                                                               *
      *    F U N C T I O N    O F   I N D I C A T O R S               *
      *    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~               *
      *         02         CHAIN FAIL SDCBRTD0                        *
      *         04         NON DISPLAY FURTHER PARTIES                *
      *         06         PROTECT FURTHER PARTIES                    *
      *         07         NON DISPLAY TAX INDICATOR                  *
      *         08         PROTECT TAX INDICATOR                      *
      *         09         PROTECT ALL SCREEN FIELDS SCREEN 1         *
      *         10         HELP KEY PRESSED                           *
      *         11         PROTECT ALL SCREEN FIELDS SCREEN 2         *
      *         15         END OF FILE - CUSDL (DEALSDC)              *
      *         16         END OF FILE - ACCNTXL1                     *
      *         18         CMD KEY 18 PRESSED                         *
      *         19         ENABLE COMMAND KEY 18                      *
      *         20         ERROR FOUND IN SCREEN 1                    *
      *         21         HOLDER 1 NAME FIELD ERROR                  *
      *         22            -     ADDRESS 1 FIELD ERROR             *
      *         23            -       -     2   -     -
      *         24            -       -     3   -     -               *
      *         25            -     POSTCODE 1 FIELD ERROR            *
      *         26            -     POSTCODE 2 FIELD ERROR            *
      *         27            -     BRT LIABLE FIELD ERROR            *
      *         28            -     N.I. NUMBER FIELD ERROR           *
      *         29            -     DATE OF BIRTH FIELD ERROR         *
      *         30         HOLDER 2 ALL DETAILS IN ERROR              *
      *         31            -     NAME FIELD ERROR                  *
      *         32            -     ADDRESS 1 FIELD ERROR             *
      *         33            -       -     2   -     -
      *         34            -       -     3   -     -               *
      *         35            -     POSTCODE 1 FIELD ERROR            *
      *         36            -     POSTCODE 2 FIELD ERROR            *
      *         37            -     BRT LIABLE FIELD ERROR            *
      *         38            -     N.I. NUMBER FIELD ERROR           *
      *         39            -     DATE OF BIRTH FIELD ERROR         *
      *         40         TAX INDICATOR FIELD ERROR (SCREEN 1)       *
      *         41         FURTHER PARTIES FIELD ERROR                *
      *         47         TAX INDICATOR INVALID                      *
      *         48         BRT CATEGORY INVALID                       *
      *         49         PROTECT POST 4/5/01 (SCREEN 1)             *                       CRE007
      *         50         ERROR FOUND IN SCREEN 2                    *
      *         51         HOLDER 3 NAME FIELD ERROR                  *
      *         52            -     ADDRESS 1 FIELD ERROR             *
      *         53            -       -     2   -     -
      *         54            -       -     3   -     -               *
      *         55            -     POSTCODE 1 FIELD ERROR            *
      *         56            -     POSTCODE 2 FIELD ERROR            *
      *         57            -     BRT LIABLE FIELD ERROR            *
      *         58            -     N.I. NUMBER FIELD ERROR           *
      *         59            -     DATE OF BIRTH FIELD ERROR         *
      *         60         HOLDER 4 ALL DETAILS IN ERROR              *
      *         61            -     NAME FIELD ERROR                  *
      *         62            -     ADDRESS 1 FIELD ERROR             *
      *         63            -       -     2   -     -
      *         64            -       -     3   -     -               *
      *         65            -     POSTCODE 1 FIELD ERROR            *
      *         66            -     POSTCODE 2 FIELD ERROR            *
      *         67            -     BRT LIABLE FIELD ERROR            *
      *         68            -     N.I. NUMBER FIELD ERROR           *
      *         69            -     DATE OF BIRTH FIELD ERROR         *
      *         70         HOLDER 5 ALL DETAILS IN ERROR              *
      *         71            -     NAME FIELD ERROR                  *
      *         72            -     ADDRESS 1 FIELD ERROR             *
      *         73            -       -     2   -     -
      *         74            -       -     3   -     -               *
      *         75            -     POSTCODE 1 FIELD ERROR            *
      *         76            -     POSTCODE 2 FIELD ERROR            *
      *         77            -     BRT LIABLE FIELD ERROR            *
      *         78            -     N.I. NUMBER FIELD ERROR           *
      *         79            -     DATE OF BIRTH FIELD ERROR         *
      *         80         TAX INDICATOR FIELD ERROR (SCREEN 2)       *
      *         81         POST 4/5/01  FIELD ERROR (SCREEN 1)        *                       CRE007
      *         82         POST 4/5/01  FIELD ERROR (SCREEN 2)        *                       CRE007
      *         83         TAX INDICATOR FIELD PROTECT (SCREEN 2)     *                       CRE007
      *         85         ERROR IN AMEND SCREEN                      *
      *         90-99      STANDARD SUBROUTINE INDICATORS             *
      *         LR         END OF PROGRAM                             *
      *                                                               *
      *****************************************************************
      *
      /EJECT
     E                    ERR       100  4               ERROR CODES
     E***********         ERRM    1   5 79               ERROR MESSAGES                       CRE007
     E                    ERRM    1  13 79               ERROR MESSAGES                       CRE007
     E                    TEMP        5139               TEMP DETAILS
     E                    AOLD        5 23               OLD PARTY NAMES
     E                    ANEW        5 23               NEW PARTY NAMES
     E                    PSTS        5  1               PARTY STATUS
     E                    SPST        5  1               SCREEN PARTY STATUS
     E*
      /COPY ZSRSRC,ZDATE2Z1
     E*
     E                    LFLG       10  1               LIABLE FLAG ARRAY
     E                    EFLD       10  5 0             EFFECT. DATE ARR
     E                    LCHD       10  5 0             LIAB.CHG. DTE ARR
     I**
     IINTPSDDF                                                            S10213
     I              CNUM                            CNUML6                S10213
     IINTPSD7F                                                            S10213
     I              CNUM                            CNUML7                S10213
     IINTPSD8F                                                            S10213
     I              CNUM                            CNUML8                S10213
     IPTYHSTF                                                             S10213
     I              XLCD                            XPLCD                 S10213
     I              XCHTP                           XPCHTP                S10213
     I              XTNLU                           XPTNLU                S10213
     ISCRMSG      DS                          1 400
     I                                        1 400 ERR
     I                                        1  79 ERRCDE
     I**
     I** DATA STRUCTURE FOR SCREEN FIELDS
     I**
     I            DS
     I                                        2 248 LOTB1
     I                                      249 495 LOTB2
     I                                      496 704 LOTB3
     I                                        9 147 DETAI1
     I                                      148 286 DETAI2
     I                                      175 286 OTHER2
     I                                      287 425 DETAI3
     I                                      314 425 OTHER3
     I                                      426 564 DETAI4
     I                                      453 564 OTHER4
     I                                      565 703 DETAI5
     I                                      592 703 OTHER5
     I                                        2   7 SCNUM
     I                                        8   8 SCHLRT
     I                                        9  12 S1TITL
     I                                       13  35 S1NAME
     I                                       36  38 S1INIT
     I                                       39  66 S1ADR1
     I                                       67  94 S1ADR2
     I                                       95 122 S1ADR3
     I                                      123 126 S1PCD1
     I                                      127 129 S1PCD2
     I                                      130 130 S1BRTL
     I                                      131 139 S1NINO
     I                                      140 145 S1DOB
     I                                      146 147 S1SEQN
     I                                      148 151 S2TITL
     I                                      152 174 S2NAME
     I                                      175 177 S2INIT
     I                                      178 205 S2ADR1
     I                                      206 233 S2ADR2
     I                                      234 261 S2ADR3
     I                                      262 265 S2PCD1
     I                                      266 268 S2PCD2
     I                                      269 269 S2BRTL
     I                                      270 278 S2NINO
     I                                      279 284 S2DOB
     I                                      285 286 S2SEQN
     I                                      287 290 S3TITL
     I                                      291 313 S3NAME
     I                                      314 316 S3INIT
     I                                      317 344 S3ADR1
     I                                      345 372 S3ADR2
     I                                      373 400 S3ADR3
     I                                      401 404 S3PCD1
     I                                      405 407 S3PCD2
     I                                      408 408 S3BRTL
     I                                      409 417 S3NINO
     I                                      418 423 S3DOB
     I                                      424 425 S3SEQN
     I                                      426 429 S4TITL
     I                                      430 452 S4NAME
     I                                      453 455 S4INIT
     I                                      456 483 S4ADR1
     I                                      484 511 S4ADR2
     I                                      512 539 S4ADR3
     I                                      540 543 S4PCD1
     I                                      544 546 S4PCD2
     I                                      547 547 S4BRTL
     I                                      548 556 S4NINO
     I                                      557 562 S4DOB
     I                                      563 564 S4SEQN
     I                                      565 568 S5TITL
     I                                      569 591 S5NAME
     I                                      592 594 S5INIT
     I                                      595 622 S5ADR1
     I                                      623 650 S5ADR2
     I                                      651 678 S5ADR3
     I                                      679 682 S5PCD1
     I                                      683 685 S5PCD2
     I                                      686 686 S5BRTL
     I                                      687 695 S5NINO
     I                                      696 701 S5DOB
     I                                      702 703 S5SEQN
     I                                      704 704 SAXIND
     I*
      ** DS for screen Party Status
     I            DS
     I                                        1   5 SPST
     I                                        1   1 S1STS
     I                                        2   2 S2STS
     I                                        3   3 S3STS
     I                                        4   4 S4STS
     I                                        5   5 S5STS
     I**
     I** DATA STRUCTURE FOR SDCBRTPD FIELDS
     I**
     I          E DSSDCBRTPD
     I                                        2 248 LOTA1
     I                                      249 495 LOTA2
     I                                      496 704 LOTA3
     I                                        9 147 DET1
     I                                      130 130 OLDBR1
     I                                      148 286 DET2
     I                                      269 269 OLDBR2
     I                                      287 425 DET3
     I                                      408 408 OLDBR3
     I                                      426 564 DET4
     I                                      547 547 OLDBR4
     I                                      565 703 DET5
     I                                      686 686 OLDBR5
     I            DS
     I                                        1 139 PP1DET
     I                                        1   4 PT1TTL
     I                                        5  27 PT1NME
     I                                       28  30 PT1INT
     I                                       31  58 PT1AD1
     I                                       59  86 PT1AD2
     I                                       87 114 PT1AD3
     I                                      115 118 PT1PC1
     I                                      119 121 PT1PC2
     I                                      122 122 NEWBR1
     I                                      123 131 PT1NIN
     I                                      132 137 NEWDB1
     I                                      138 139 NEWSQ1
     I                                      140 278 PP2DET
     I                                      140 143 PT2TTL
     I                                      144 166 PT2NME
     I                                      167 169 PT2INT
     I                                      170 197 PT2AD1
     I                                      198 225 PT2AD2
     I                                      226 253 PT2AD3
     I                                      254 257 PT2PC1
     I                                      258 260 PT2PC2
     I                                      261 261 NEWBR2
     I                                      262 270 PT2NIN
     I                                      271 276 NEWDB2
     I                                      277 278 NEWSQ2
     I                                      279 417 PP3DET
     I                                      279 282 PT3TTL
     I                                      283 305 PT3NME
     I                                      306 308 PT3INT
     I                                      309 336 PT3AD1
     I                                      337 364 PT3AD2
     I                                      365 392 PT3AD3
     I                                      393 396 PT3PC1
     I                                      397 399 PT3PC2
     I                                      400 400 NEWBR3
     I                                      401 409 PT3NIN
     I                                      410 415 NEWDB3
     I                                      416 417 NEWSQ3
     I                                      418 556 PP4DET
     I                                      418 421 PT4TTL
     I                                      422 444 PT4NME
     I                                      445 447 PT4INT
     I                                      448 475 PT4AD1
     I                                      476 503 PT4AD2
     I                                      504 531 PT4AD3
     I                                      532 535 PT4PC1
     I                                      536 538 PT4PC2
     I                                      539 539 NEWBR4
     I                                      540 548 PT4NIN
     I                                      549 554 NEWDB4
     I                                      555 556 NEWSQ4
     I                                      557 695 PP5DET
     I                                      557 560 PT5TTL
     I                                      561 583 PT5NME
     I                                      584 586 PT5INT
     I                                      587 614 PT5AD1
     I                                      615 642 PT5AD2
     I                                      643 670 PT5AD3
     I                                      671 674 PT5PC1
     I                                      675 677 PT5PC2
     I                                      678 678 NEWBR5
     I                                      679 687 PT5NIN
     I                                      688 693 NEWDB5
     I                                      694 695 NEWSQ5
     I            DS
     I                                        1   5 PPSTS
     I                                        1   1 PSTS1
     I                                        2   2 PSTS2
     I                                        3   3 PSTS3
     I                                        4   4 PSTS4
     I                                        5   5 PSTS5
     I            DS
     I                                        1  10 LFLAGS
     I                                        1  10 LFLG
     I            DS
     I                                        1  30 EFFLDS
     I                                    P   1  30 EFLD
     I            DS
     I                                        1  30 LCHGDS
     I                                    P   1  30 LCHD
     I            DS
     I                                        1   6 DATE
     I                                        1   20DAY
     I                                        3   40MONTH
     I                                        5   60YEAR
     I            DS
     I                                        1   6 TDATE
     I                                        1   2 TDAY
     I                                        3   4 TMONTH
     I                                        5   6 TYEAR
     I*
     I            DS                              8                                           260405
     I                                        1   8 #NWDTE                                    260405
     I                                        1   4 #DDMM                                     260405
     I                                        5   6 #CC                                       260405
     I                                        7   8 #YY                                       260405
     I                                        5   8 #YEAR                                     260405
      *                                                                                       260405
     IDSFDY     E DSDSFDY
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE
     I**
     ISDBANK    E DSSDBANKPD
     I**  EXTERNAL DS FOR BANK DETAILS
     I*
     I* ERROR DATA STRUCTURE FOR LDA
     ILDA         DS                            256
     I                                      134 141 DBFILE
     I                                      142 170 DBKEY
     I                                      171 180 DBPGM
     I                                      181 1830DBASE
     I*
     I* DATA AREA FOR PROGRAM STATUS DATA AREA
     I*
     IPSDS       SDS
     I                                      244 253 WID
     I                                      254 263 USRID
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C*   MAIN CONTROL                                                *
     C*                                                               *
     C*   CALLS   : INIT
     C*   CALLS   : SETUP1
     C*   CALLS   : ENQUIR
     C*   CALLS   : INSERI
     C*   CALLS   : INSERJ
     C*   CALLS   : AMENI1
     C*   CALLS   : AMENI2
     C*   CALLS   : AMENJ1
     C*   CALLS   : AMENJ2
     C*                                                               *
     C*                                                               *
     C*****************************************************************
     C           *ENTRY    PLIST
     C                     PARM           PACTN   1
     C                     PARM           PRETC   7
     C**********           PARM           PCNUM   60                                          CSD027
     C                     PARM           PCNUM   6                                           CSD027
     C                     PARM           PACHLR  1
     C*
     C**  Perform initial processing
     C*
     C                     EXSR INIT
     C*
     C* INITIALIZE SDCBRTPD DETAILS
     C*
     C                     MOVEL*BLANK    PP1DET
     C                     MOVEL*BLANK    PP2DET
     C                     MOVEL*BLANK    PP3DET
     C                     MOVEL*BLANK    PP4DET
     C                     MOVEL*BLANK    PP5DET
     C                     MOVEL*BLANK    PTAXIN  1
     C                     MOVEL*BLANK    PPSTS
     C*
     C**  Chain to SDCBRTD0 using entry parameters
     C*
     C                     MOVE PCNUM     XCNUM
     C           XCNUM     CHAINSDCBRTD0             02
     C*
     C**  IF INSERT AND LIVE RECORD FOUND - ERROR
     C*
     C           PACTN     IFEQ 'I'                        B1
     C*
     C           *IN02     IFEQ '0'                        B*2
     C           XRECI     ANDEQ'D'                        B*2
     C                     MOVEL'SDCBRTPD'#FILE            ************
     C                     MOVELXCNUM     #KEY             * DBERR 001*
     C                     MOVE '001'     #BASE            ************
     C                     SETON                     U7U8LR**2
     C           *LOCK     IN   LDA
     C                     MOVEL#PGM      DBPGM
     C                     MOVEL#KEY      DBKEY
     C                     MOVEL#FILE     DBFILE
     C                     MOVEL#BASE     DBASE
     C                     OUT  LDA
     C                     MOVEL'Y2U0003' PRETC            **2
     C                     DUMP                            **2
     C                     RETRN                           **2
     C                     END                             E*2
     C*
     C                     ELSE                            X1
     C*
     C**  IF DELETE, AMEND OR ENQUIRE
     C*
     C**  IF LIVE RECORD NOT FOUND - ERROR
     C*
     C           *IN02     IFEQ '1'                        B*2
     C           XRECI     ORNE 'D'                        B*2
     C                     MOVEL'SDCBRTPD'#FILE            ************
     C                     MOVELXCNUM     #KEY             * DBERR 002*
     C                     MOVE '002'     #BASE            ************
     C                     SETON                     U7U8LR**2
     C           *LOCK     IN   LDA
     C                     MOVEL#PGM      DBPGM
     C                     MOVEL#KEY      DBKEY
     C                     MOVEL#FILE     DBFILE
     C                     MOVEL#BASE     DBASE
     C                     OUT  LDA
     C                     MOVEL'Y2U0005' PRETC            **2
     C                     DUMP                            **2
     C                     RETRN                           **2
     C                     END                             E*2
     C*
     C* SET UP SDCBRTPD DETAILS IF A/C HOLDER TYPE IS 'I' OR 'J'
     C* OR R.                                                                                 CRE007
     C*
     C           PACHLR    IFEQ 'I'
     C           PACHLR    OREQ 'J'
     C           PACHLR    OREQ 'R'                                                           CRE007
     C                     MOVELDET1      PP1DET
     C                     MOVELDET2      PP2DET
     C                     MOVELDET3      PP3DET
     C                     MOVELDET4      PP4DET
     C                     MOVELDET5      PP5DET
     C                     MOVELTAXIND    PTAXIN
     C                     END
     C*
     C** COUNT THE NUMBER OF PARTIES
     C*
     C                     Z-ADD0         OLDNOP  10
     C           H1BRTL    IFNE ' '
     C                     ADD  1         OLDNOP
     C                     END
     C           H2BRTL    IFNE ' '
     C                     ADD  1         OLDNOP
     C                     END
     C           H3BRTL    IFNE ' '
     C                     ADD  1         OLDNOP
     C                     END
     C           H4BRTL    IFNE ' '
     C                     ADD  1         OLDNOP
     C                     END
     C           H5BRTL    IFNE ' '
     C                     ADD  1         OLDNOP
     C                     END
     C                     END                             E1
     C*
     C* IF ACTION CODE IS DELETE OR A/C HOLDER IS NOT 'I' OR 'J'
     C* OR R.                                                                                 CRE007
     C* BYPASS SCREEN PROCESSING
     C*
     C           PACTN     IFEQ 'D'                        B1
     C           PACHLR    ORNE 'I'
     C           PACHLR    ANDNE'J'
     C           PACHLR    ANDNE'R'                                                           CRE007
     C                     GOTO ENDPGM
     C                     END                             E1
     C*
     C**  SET UP SCREEN ONE DETAILS
     C*
     C                     EXSR SETUP1
     C*
     C           *INKC     DOWEQ'0'                        B1
     C           *INKL     ANDEQ'0'
     C*
     C**  DISPLAY THE FIRST SCREEN
     C*
     C                     WRITESD2464F1                   *1
     C                     WRITESD2464F4                   *1
     C                     EXFMTSD2464F2                   *1
     C*
     C**  EXIT PROGRAM IF CMD/3 PRESSED
     C*
     C           *INKC     IFEQ '1'                        B*2
     C                     MOVEL'PREV   ' PRETC            **2
     C                     ELSE                            X*2
     C*
     C**  EXIT PROGRAM IF CMD/12 PRESSED
     C*
     C           *INKL     IFEQ '1'                        B**3
     C                     MOVEL'USR0790' PRETC            ***3
     C                     ELSE                            X**3
     C*
     C**  ENTER PRESSED
     C*
     C*   IF ENQUIRE
     C*
     C           PACTN     IFEQ 'E'                        B***4
     C                     EXSR ENQUIR                     ****4
     C                     END                             E***4
     C*
     C*   IF INSERT
     C*
     C           PACTN     IFEQ 'I'                        B***4
     C           PACHLR    IFEQ 'I'                        B****5
     C           PACHLR    OREQ 'R'                                                           CRE007
     C                     EXSR INSERI                     *****5
     C                     ELSE                            X****5
     C                     EXSR INSERJ                     *****5
     C                     END                             E****5
     C                     END                             E***4
     C*
     C*   IF AMEND
     C*
     C           PACTN     IFEQ 'A'                        B***4
     C*
     C*   IF ACCOUNT HOLDER NOW 'I'
     C*
     C           PACHLR    IFEQ 'I'                        B****5
     C*
     C*   IF ACCOUNT ONLY HAD ONE PARTY
     C*
     C           DETAI2    IFEQ *BLANKS                    B*****6
     C                     EXSR AMENI1                     ******6
     C*
     C*   IF ACCOUNT HAD THREE OR MORE PARTIES
     C*
     C                     ELSE                            X*****6
     C                     EXSR AMENI2                     ******6
     C                     END                             E*****6
     C*
     C                     END                             E****5
     C*
     C           PACHLR    IFEQ 'R'                        B****5                             CRE007
     C*                                                                                       CRE007
     C*   IF ACCOUNT ONLY HAD ONE OR TWO PARTIES                                              CRE007
     C*                                                                                       CRE007
     C           DETAI3    IFEQ *BLANKS                    B*****6                            CRE007
     C                     EXSR AMENI1                     ******6                            CRE007
     C*                                                                                       CRE007
     C*   IF ACCOUNT HAD THREE OR MORE PARTIES                                                CRE007
     C*                                                                                       CRE007
     C                     ELSE                            X*****6                            CRE007
     C                     EXSR AMENI2                     ******6                            CRE007
     C                     ENDIF                           E*****6                            CRE007
     C*                                                                                       CRE007
     C                     ENDIF                           E****5                             CRE007
     C*                                                                                       CRE007
     C*   IF ACCOUNT HOLDER NOW 'J'
     C*
     C           PACHLR    IFEQ 'J'                        B****5
     C*
     C*   IF THERE WAS NO THIRD PARTICIPATOR
     C*
     C           DETAI3    IFEQ *BLANKS                    B*****6
     C                     EXSR AMENJ1                     ******6
     C                     ELSE                            X*****6
     C*
     C*   IF ACCOUNT HOLDER TYPE WAS 'I' WITH 3 OR MORE PARTIES.
     C*
     C           ACHLRT    IFEQ 'I'                        B******7
     C           DETAI3    ANDNE*BLANKS                    B******7
     C                     EXSR AMENJ2                     *******7
     C                     END                             E******7
     C*
     C                     END                             E*****6
     C*
     C                     END                             E****5
     C*
     C                     END                             E***4
     C                     END                             E**3
     C                     END                             E*2
     C                     END                             E1
     C*
     C           ENDPGM    TAG
     C*
     C* AS LONG AS CMD/3 OR CMD/12 WAS NOT TAKEN
     C* AND THIS IS NOT AN ENQUIRY
     C*
     C           PRETC     IFNE 'PREV'
     C           PRETC     ANDNE'USR0790'
     C           PACTN     ANDNE'E'
     C*
     C* UPDATE THE FILES
     C*
     C                     EXSR UPDFLS
      *                                                                   077335
      **  IF IN DELETE MODE - END PROGRAM                                 077335
      *                                                                   077335
     C           PACTN     IFEQ 'D'                                       077335
     C                     SETON                     LR                   077335
     C                     RETRN                                          077335
     C                     END                                            077335
     C*
     C**  IF INTEREST ADJUSTMENT REQUIRED
     C**  REDISPLAY THE FIRST SCREEN WITH ALL FIELDS PROTECTED
     C*
     C           INADJR    IFEQ 'Y'
     C                     MOVELERRM,5    ERMSG
     C                     MOVEL*BLANK    ERRCDE
     C                     MOVE '1'       *IN20
     C                     MOVEL'1'       *IN09
     C                     WRITESD2464F1
     C                     WRITESD2464F4
     C                     EXFMTSD2464F2
     C                     END
     C                     END
     C*
     C                     SETON                     LR
     C                     RETRN
     C*
      /EJECT
     C*****************************************************************
     C*                                                               *
     C*          I N D E X   O F   S U B R O U T I N E S              *
     C*          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~              *
     C*          INIT   -  INITIAL PROCESSING                         *
     C*          SETUP1 -  SETUP AND DISPLAY SCREEN 1                 *
     C*          INSERI -  INSERT SCREEN PROCESS ACCOUNT HOLDER 'I'   *
     C*          INSERJ -  INSERT SCREEN PROCESS ACCOUNT HOLDER 'J'   *
     C*          INSER2 -  INSERT SCREEN PROCESS SECOND SCREEN        *
     C*          AMENI1 -  AMEND SCREEN PROCESS I ONE PARTY           *
     C*          AMENI2 -  AMEND SCREEN PROCESS I 3+ PARTIES          *
     C*          AMDVAL -  AMEND SCREEN VALIDATION 3+ PARTIES         *
     C*          AMENJ1 -  AMEND SCREEN PROCESS J ONE PARTY           *
     C*          AMENJ2 -  AMEND SCREEN PROCESS J 3+ PARTIES          *
     C*          AMEND2 -  DISPLAY/VALIDATE SECOND SCREEN             *
     C*          ENQUIR -  ENQUIRY SCREEN PROCESS                     *
     C*          VALID1 -  INITIAL SCREEN VALIDATION TYPE I           *
     C*          VALID2 -  INITIAL SCREEN VALIDATION TYPE J           *
     C*          VALID3 -  SECOND SCREEN VALIDATION TYPE I            *
     C*          TAXIND -  DISPLAY/VALIDATE TAX INDICATOR             *
     C*          VALTAX -  VALIDATE TAX INDICATOR SCREEN 1            *
     C*                                                               *
     C*                                                               *
     C*****************************************************************
     C*
      /EJECT
     C*
     C*****************************************************************
     C*                                                               *
     C*   INIT - INITIAL PROCESSING                                   *
     C*                                                               *
     C*   CALLED BY  :  MAIN PROCESS                                  *
     C*                                                               *
     C*                                                               *
     C*****************************************************************
     C*
     C           INIT      BEGSR
      *                                                                   077335
      ** OPEN DISPLAY FILE IF NOT IN DELETE MODE                          077335
      *                                                                   077335
     C           PACTN     IFNE 'D'                                       077335
     C                     OPEN SD2464DF                                  077335
     C                     END                                            077335
     C*
     C*
     C** SET UP DBPGM FOR DATABASE ERROR
     C*
     C           *LIKE     DEFN DBKEY     #KEY
     C           *LIKE     DEFN DBASE     #BASE
     C           *LIKE     DEFN DBFILE    #FILE
     C           *LIKE     DEFN DBPGM     #PGM
     C                     MOVE 'SD2464'  #PGM
     C           *NAMVAR   DEFN           LDA
     C*
     C** INITIALISE ERROR ARRAY INDEX TO 1
     C*
     C                     Z-ADD1         X
     C**
     C**  ACCESS BANK DETAILS
     C**
     C                     CALL 'AOBANKR0'
     C                     PARM '*DBERR ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C           SDBANK    PARM SDBANK    DSFDY
     C**
     C**   ROUTINE TO CALCULATE DAY NUMBER OF APRIL 6TH FOR CURRENT TAX YEAR
     C**
     C                     MOVE '0'       *IN98
     C                     Z-ADDBJRDNB    ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZDATE     DATE
     C**
     C           MONTH     IFLT 4
     C           MONTH     OREQ 4
     C           DAY       ANDLT6
     C                     SUB  1         YEAR
     C                     END
     C**
     C                     MOVE '06'      TDAY
     C                     MOVE '04'      TMONTH
     C                     MOVE YEAR      TYEAR
     C**
     C                     MOVE TDATE     ZDATE
     C                     EXSR ZDATE1
     C                     Z-ADDZDAYNO    APR6CY  50
     C*
     C           BJDFIN    COMP 'M'                      98* DATE FORMAT
     C*
      ** Access SAR details file to see if Base Rate Tax 2001 is ON.      CRE007
      *                                                                   CRE007
     C                     CALL 'AOSARDR0'                                CRE007
     C                     PARM '       ' @RTCD                           CRE007
     C                     PARM '*VERIFY' @OPTN                           CRE007
     C                     PARM 'CRE007'  @SARD   6                       CRE007
      *                                                                   CRE007
      ** If Base Rate Tax 2001 is switched ON display field               CRE007
      ** SPSTR - Post 5/4/01 R105.                                        CRE007
      *                                                                   CRE007
     C           @RTCD     IFEQ *BLANKS                                   CRE007
     C                     MOVEL'Y'       CRE007  1                       CRE007
     C                     MOVE *OFF      *IN84                           CRE007
     C                     ELSE                                           CRE007
     C                     MOVE 'N'       CRE007                          CRE007
     C                     MOVE *ON       *IN84                           CRE007
     C                     MOVE *ON       *IN49                           CRE007
     C                     ENDIF                                          CRE007
      *                                                                   CRE007
     C                     ENDSR
     C*
     C*****************************************************************
     C*
      /EJECT
     C*
     C*****************************************************************
     C*                                                               *
     C*   SETUP1 - SETUP DISPLAY SCREEN 1                             *
     C*                                                               *
     C*   CALLED BY  :  MAIN PROCESS                                  *
     C*                                                               *
     C*   CALLS      :                                                *
     C*                                                               *
     C*****************************************************************
     C*
     C           SETUP1    BEGSR
     C*
     C** ACTION CODE 'I'
     C*
     C           PACTN     IFEQ 'I'                        B1
     C                     MOVE *BLANKS   LOTB1            *1
     C                     MOVE *BLANKS   LOTB2            *1
     C                     MOVE *BLANKS   LOTB3            *1
     C                     MOVE PCNUM     SCNUM            *1
     C                     MOVE PACHLR    SCHLRT           *1
     C                     MOVE PACTN     SACTN            *1
      *                                                                                       CRE007
      ** IF ACCOUNT HOLDER 'R' MOVE N TO BRT TAX INDICATOR                                    CRE007
      ** AND PROTECT BRT TAX INDICATOR                                                        CRE007
     C           PACHLR    IFEQ 'R'                                                           CRE007
     C                     MOVE 'N'       SFURPA                                              CRE007
     C                     MOVE 'N'       SAXIND                                              CRE007
     C                     MOVE '1'       *IN07                                               CRE007
     C                     MOVE '1'       *IN08                                               CRE007
      *                                                                                       CRE007
      ** DEFAULT POST 5/4/01 R105 FIELD TO 'Y'.                                               CRE007
      ** ALREADY NON-DISPLAY (IN07)                                                           CRE007
      *                                                                                       CRE007
     C                     MOVE 'Y'       SPSTR                                               CRE007
      *                                                                                       CRE007
     C                     ELSE                                                               CRE007
     C*
     C** IF ACCOUNT HOLDER 'I' MOVE BLANKS TO FURTHER PARTIES AND
     C** PROTECT AND NON DISPLAY BRT TAX INDICATOR
     C** IF ACCOUNT HOLDER 'J' MOVE BLANKS TO TAX INDICATOR AND
     C** PROTECT AND NON DISPLAY FURTHER PARTIES
     C*
     C           PACHLR    IFEQ 'I'                        B*2
     C***********          MOVE *BLANKS   SFURPA           **2            112708
     C                     MOVE 'N'       SFURPA           **2            112708
     C                     MOVE '1'       *IN07            **2
     C                     MOVE '1'       *IN08            **2
     C                     ELSE                            X*2
     C                     MOVE '1'       *IN04            **2
     C                     MOVE '1'       *IN06            **2
     C                     MOVE *BLANKS   SAXIND           **2
     C                     END                             E*2
     C*
     C                     ENDIF                                                              CRE007
     C                     END                             E1
     C*
     C*
     C** ACTION CODE 'A'
     C*
     C           PACTN     IFEQ 'A'                        B1
     C                     MOVE LOTA1     LOTB1            *1
     C                     MOVE LOTA2     LOTB2            *1
     C                     MOVE LOTA3     LOTB3            *1
     C                     MOVE PCNUM     SCNUM            *1
     C                     MOVE PACHLR    SCHLRT           *1
     C                     MOVE PACTN     SACTN            *1
      *
     C                     MOVE H1NAME    AOLD,1
     C                     MOVE H2NAME    AOLD,2
     C                     MOVE H3NAME    AOLD,3
     C                     MOVE H4NAME    AOLD,4
     C                     MOVE H5NAME    AOLD,5
     C*
     C** IF DATES OF BIRTH ZERO ON FILE DISPLAY AS BLANKS.
     C*
     C           H1DOB     IFEQ *ZEROS                     B*2
     C                     MOVE *BLANKS   S1DOB
     C                     END                             E*2
     C*
     C           H2DOB     IFEQ *ZEROS                     B*2
     C                     MOVE *BLANKS   S2DOB
     C                     END                             E*2
     C*
     C           H3DOB     IFEQ *ZEROS                     B*2
     C                     MOVE *BLANKS   S3DOB
     C                     END                             E*2
     C*
     C           H4DOB     IFEQ *ZEROS                     B*2
     C                     MOVE *BLANKS   S4DOB
     C                     END                             E*2
     C*
     C           H5DOB     IFEQ *ZEROS                     B*2
     C                     MOVE *BLANKS   S5DOB
     C                     END                             E*2
      *
      ** Check if century field is not zero during amend mode.                                260405
      ** More value of century for display.                                                   260405
      *                                                                                       260405
     C           H1DOB     IFNE *ZEROS                                                        260405
     C                     MOVE *BLANKS   S1DOBN                                              260405
     C           H1DOBC    IFNE *ZEROS                                                        260405
     C                     MOVELH1DOB     #DDMM                                               260405
     C                     MOVE H1DOB     #YY                                                 260405
     C                     MOVE H1DOBC    #CC                                                 260405
     C                     MOVE #NWDTE    S1DOBN                                              260405
     C                     ELSE                                                               260405
     C                     MOVELH1DOB     S1DOBN                                              260405
     C                     ENDIF                                                              260405
     C                     ELSE                                                               260405
     C                     MOVE *BLANKS   S1DOBN                                              260405
     C                     ENDIF                                                              260405
      *                                                                                       260405
     C           H2DOB     IFNE *ZEROS                                                        260405
     C                     MOVE *BLANKS   S2DOBN                                              260405
     C           H2DOBC    IFNE *ZEROS                                                        260405
     C                     MOVELH2DOB     #DDMM                                               260405
     C                     MOVE H2DOB     #YY                                                 260405
     C                     MOVE H2DOBC    #CC                                                 260405
     C                     MOVE #NWDTE    S2DOBN                                              260405
     C                     ELSE                                                               260405
     C                     MOVELH2DOB     S2DOBN                                              260405
     C                     ENDIF                                                              260405
     C                     ELSE                                                               260405
     C                     MOVE *BLANKS   S2DOBN                                              260405
     C                     ENDIF                                                              260405
      *                                                                                       260405
     C           H3DOB     IFNE *ZEROS                                                        260405
     C                     MOVE *BLANKS   S3DOBN                                              260405
     C           H3DOBC    IFNE *ZEROS                                                        260405
     C                     MOVELH3DOB     #DDMM                                               260405
     C                     MOVE H3DOB     #YY                                                 260405
     C                     MOVE H3DOBC    #CC                                                 260405
     C                     MOVE #NWDTE    S3DOBN                                              260405
     C                     ELSE                                                               260405
     C                     MOVELH3DOB     S3DOBN                                              260405
     C                     ENDIF                                                              260405
     C                     ELSE                                                               260405
     C                     MOVE *BLANKS   S3DOBN                                              260405
     C                     ENDIF                                                              260405
      *                                                                                       260405
     C           H4DOB     IFNE *ZEROS                                                        260405
     C                     MOVE *BLANKS   S4DOBN                                              260405
     C           H4DOBC    IFNE *ZEROS                                                        260405
     C                     MOVELH4DOB     #DDMM                                               260405
     C                     MOVE H4DOB     #YY                                                 260405
     C                     MOVE H4DOBC    #CC                                                 260405
     C                     MOVE #NWDTE    S4DOBN                                              260405
     C                     ELSE                                                               260405
     C                     MOVELH4DOB     S4DOBN                                              260405
     C                     ENDIF                                                              260405
     C                     ELSE                                                               260405
     C                     MOVE *BLANKS   S4DOBN                                              260405
     C                     ENDIF                                                              260405
      *                                                                                       260405
     C           H5DOB     IFNE *ZEROS                                                        260405
     C                     MOVE *BLANKS   S5DOBN                                              260405
     C           H5DOBC    IFNE *ZEROS                                                        260405
     C                     MOVELH5DOB     #DDMM                                               260405
     C                     MOVE H5DOB     #YY                                                 260405
     C                     MOVE H5DOBC    #CC                                                 260405
     C                     MOVE #NWDTE    S5DOBN                                              260405
     C                     ELSE                                                               260405
     C                     MOVELH5DOB     S5DOBN                                              260405
     C                     ENDIF                                                              260405
     C                     ELSE                                                               260405
     C                     MOVE *BLANKS   S5DOBN                                              260405
     C                     ENDIF                                                              260405
      *                                                                                       260405
      ** IF SEQUENCE NUMBERS ZERO ON FILE DISPLAY AS BLANKS.
      *
     C           H1SEQN    IFEQ *ZEROS                     B*2
     C                     MOVE *BLANKS   S1SEQN
     C                     END                             E*2
      *
     C           H2SEQN    IFEQ *ZEROS                     B*2
     C                     MOVE *BLANKS   S2SEQN
     C                     END                             E*2
      *
     C           H3SEQN    IFEQ *ZEROS                     B*2
     C                     MOVE *BLANKS   S3SEQN
     C                     END                             E*2
      *
     C           H4SEQN    IFEQ *ZEROS                     B*2
     C                     MOVE *BLANKS   S4SEQN
     C                     END                             E*2
      *
     C           H5SEQN    IFEQ *ZEROS                     B*2
     C                     MOVE *BLANKS   S5SEQN
     C                     END                             E*2
      *
      ** MOVE POST 5/4/01 R105 FILE FIELD TO SCREEN                                           CRE007
     C                     MOVELPSTR      SPSTR                                               CRE007
     C*                                                                                       CRE007
     C** PROTECT AND NON-DISPLAY BRT TAX INDICATOR
     C** AND POST 5/4/01 R105.                                                                CRE007
     C*
     C                     MOVE '1'       *IN07            *1
     C                     MOVE '1'       *IN08            *1
     C*
     C** IF ACCOUNT HOLDER CHANGING TO 'I' AND WAS ONLY ONE PARTY
     C** OR WAS 'J'
     C** DISPLAY FURTHER PARTIES.
     C*
     C           PACHLR    IFEQ 'I'                        B*2
     C           PACHLR    OREQ 'R'                        B*2                                CRE007
     C           DETAI3    ANDEQ*BLANKS                    B*2
     C***********          MOVE *BLANKS   SFURPA           **2            112708
     C                     MOVE 'N'       SFURPA           **2            112708
     C                     MOVE '0'       *IN03            **2
     C                     MOVE '0'       *IN04            **2
     C                     MOVE '0'       *IN06            **2
     C                     END                             E*2
     C*
     C** IF ACCOUNT HOLDER CHANGING TO 'J' AND WAS 'J' OR 'I' WITH
     C** ONLY ONE PARTY PROTECT AND NON-DISPLAY FURTHER PARTIES.
     C** DISPLAY BRT INDICATOR.
     C*
     C           PACHLR    IFEQ 'J'                        B*2
     C           DETAI3    ANDEQ*BLANKS                    B*2
     C                     MOVE '0'       *IN03            **2
     C                     MOVE '1'       *IN04            **2
     C                     MOVE '1'       *IN06            **2
     C                     MOVE '0'       *IN07            **2
     C                     MOVE '0'       *IN08            **2
     C                     END                             E*2
     C*
     C** IF 3RD PARTY NAME IS NOT BLANK PROTECT AND NON DISPLAY
     C** FURTHER PARTIES.
     C** DISPLAY PROMPT FOR OTHER DETAILS
     C*
     C           DETAI3    IFNE *BLANKS                    B*2
     C                     MOVE '1'       *IN03            **2
     C                     MOVE '1'       *IN04            **2
     C                     MOVE '1'       *IN06            **2
     C                     END                             E*2
     C*
     C                     END                             E1
     C*
     C*
     C** ACTION CODE 'E'
     C*
     C           PACTN     IFEQ 'E'                        B1
     C*
     C** PROTECT ALL SCREEN FIELDS
     C*
     C                     MOVE '1'       *IN09            *1
     C                     MOVE '1'       *IN49            *1                                 CRE007
     C                     MOVE LOTA1     LOTB1            *1
     C                     MOVE LOTA2     LOTB2            *1
     C                     MOVE LOTA3     LOTB3            *1
     C                     MOVE PACTN     SACTN            *1
     C*
     C** MOVE POST 5/4/01 R105 FILE FIELD TO SCREEN                                           CRE007
     C                     MOVELPSTR      SPSTR                                               CRE007
     C*
     C           H1DOB     IFEQ *ZEROS
     C                     MOVE *BLANKS   S1DOB
     C                     END
     C*
     C           H2DOB     IFEQ *ZEROS
     C                     MOVE *BLANKS   S2DOB
     C                     END
     C*
     C           H3DOB     IFEQ *ZEROS
     C                     MOVE *BLANKS   S3DOB
     C                     END
     C*
     C           H4DOB     IFEQ *ZEROS
     C                     MOVE *BLANKS   S4DOB
     C                     END
     C*
     C           H5DOB     IFEQ *ZEROS
     C                     MOVE *BLANKS   S5DOB
     C                     END
      *
      ** Check if century field is not zero for enquiry mode.                                 260405
      ** Move value of century for display.                                                   260405
      *                                                                                       260405
     C           H1DOB     IFNE *ZEROS                                                        260405
     C                     MOVE *BLANKS   S1DOBN                                              260405
     C           H1DOBC    IFNE *ZEROS                                                        260405
     C                     MOVELH1DOB     #DDMM                                               260405
     C                     MOVE H1DOB     #YY                                                 260405
     C                     MOVE H1DOBC    #CC                                                 260405
     C                     MOVE #NWDTE    S1DOBN                                              260405
     C                     ELSE                                                               260405
     C                     MOVELH1DOB     S1DOBN                                              260405
     C                     ENDIF                                                              260405
     C                     ENDIF                                                              260405
      *                                                                                       260405
     C           H2DOB     IFNE *ZEROS                                                        260405
     C                     MOVE *BLANKS   S2DOBN                                              260405
     C           H2DOBC    IFNE *ZEROS                                                        260405
     C                     MOVELH2DOB     #DDMM                                               260405
     C                     MOVE H2DOB     #YY                                                 260405
     C                     MOVE H2DOBC    #CC                                                 260405
     C                     MOVE #NWDTE    S2DOBN                                              260405
     C                     ELSE                                                               260405
     C                     MOVELH2DOB     S2DOBN                                              260405
     C                     ENDIF                                                              260405
     C                     ENDIF                                                              260405
      *                                                                                       260405
     C           H3DOB     IFNE *ZEROS                                                        260405
     C                     MOVE *BLANKS   S3DOBN                                              260405
     C           H3DOBC    IFNE *ZEROS                                                        260405
     C                     MOVELH3DOB     #DDMM                                               260405
     C                     MOVE H3DOB     #YY                                                 260405
     C                     MOVE H3DOBC    #CC                                                 260405
     C                     MOVE #NWDTE    S3DOBN                                              260405
     C                     ELSE                                                               260405
     C                     MOVELH3DOB     S3DOBN                                              260405
     C                     ENDIF                                                              260405
     C                     ENDIF                                                              260405
      *                                                                                       260405
     C           H4DOB     IFNE *ZEROS                                                        260405
     C                     MOVE *BLANKS   S4DOBN                                              260405
     C           H4DOBC    IFNE *ZEROS                                                        260405
     C                     MOVELH4DOB     #DDMM                                               260405
     C                     MOVE H4DOB     #YY                                                 260405
     C                     MOVE H4DOBC    #CC                                                 260405
     C                     MOVE #NWDTE    S4DOBN                                              260405
     C                     ELSE                                                               260405
     C                     MOVELH4DOB     S4DOBN                                              260405
     C                     ENDIF                                                              260405
     C                     ENDIF                                                              260405
      *                                                                                       260405
     C           H5DOB     IFNE *ZEROS                                                        260405
     C                     MOVE *BLANKS   S5DOBN                                              260405
     C           H5DOBC    IFNE *ZEROS                                                        260405
     C                     MOVELH5DOB     #DDMM                                               260405
     C                     MOVE H5DOB     #YY                                                 260405
     C                     MOVE H5DOBC    #CC                                                 260405
     C                     MOVE #NWDTE    S5DOBN                                              260405
     C                     ELSE                                                               260405
     C                     MOVELH5DOB     S5DOBN                                              260405
     C                     ENDIF                                                              260405
     C                     ENDIF                                                              260405
      *                                                                                       260405
      ** IF SEQUENCE NUMBERS ZERO ON FILE DISPLAY AS BLANKS.
      *
     C           H1SEQN    IFEQ *ZEROS                     B*2
     C                     MOVE *BLANKS   S1SEQN
     C                     END                             E*2
      *
     C           H2SEQN    IFEQ *ZEROS                     B*2
     C                     MOVE *BLANKS   S2SEQN
     C                     END                             E*2
      *
     C           H3SEQN    IFEQ *ZEROS                     B*2
     C                     MOVE *BLANKS   S3SEQN
     C                     END                             E*2
      *
     C           H4SEQN    IFEQ *ZEROS                     B*2
     C                     MOVE *BLANKS   S4SEQN
     C                     END                             E*2
      *
     C           H5SEQN    IFEQ *ZEROS                     B*2
     C                     MOVE *BLANKS   S5SEQN
     C                     END                             E*2
     C*
     C** PROTECT AND NON DISPLAY FURTHER PARTIES INDICATOR
     C*
     C                     MOVE '1'       *IN04            *1
     C                     MOVE '1'       *IN06            *1
     C*
     C** IF ACCOUNT HOLDER 'I' AND 3RD PARTY NAME NOT BLANK
     C** PROTECT AND NON DISPLAY THE BRT TAX INDICATOR
     C** DISPLAY PROMPT FOR OTHER DETAILS
     C*
     C           PACHLR    IFEQ 'I'                        B*2
     C           PACHLR    OREQ 'R'                        B*2                                CRE007
     C           DETAI3    ANDNE*BLANKS                    B*2
     C                     MOVE '1'       *IN07            **2
     C                     MOVE '1'       *IN08            **2
     C                     MOVE '1'       *IN03            ***3
     C                     END                             E*2
     C*
     C                     END                             E1
     C*
     C                     ENDSR
     C*
     C*****************************************************************
      /EJECT
     C*
     C*****************************************************************
     C*                                                               *
     C*   INSERI - INSERT SCREEN PROCESS I                            *
     C*                                                               *
     C*   CALLED BY  :  MAIN PROCESS                                  *
     C*                                                               *
     C*   CALLS      :  VALID1                                        *
     C*   CALLS      :  TAXIN                                         *
     C*   CALLS      :  INSER2                                        *
     C*                                                               *
     C*****************************************************************
     C*
     C           INSERI    BEGSR
     C*
     C** VALIDATE FIRST SCREEN
     C*
     C                     EXSR VALID1
     C*
     C** IF FIRST SCREEN VALID
     C*
     C           *IN20     IFEQ '0'                        B1
     C*
     C** IF FURTHER PARTIES INDICATOR = N, DISPLAY TAX INDICATOR
     C*
     C           SFURPA    IFEQ 'N'                        B*2
     C*
     C** ALLOW DISPLAY AND INPUT TO TAX INDICATOR
     C** AND TO POST 5/4/01 R105. KEEP TAX IND DEFAULTED TO N IF A/C                          CRE007
     c** HOLDER IS 'R'.                                                                       CRE007
     C*
     C           PACHLR    IFEQ 'I'                                                           CRE007
     C                     MOVE *BLANKS   SAXIND           **2
     C***********          MOVE '0'       *IN07            **2                                CRE007
     C                     MOVE '0'       *IN08            **2
     C                     ENDIF                                                              CRE007
     C                     MOVE '0'       *IN07            **2                                CRE007
     C*                                                                                       CRE007
     C           CRE007    IFEQ 'Y'                                                           CRE007
     C                     MOVE '0'       *IN49                                               CRE007
     C                     ENDIF                                                              CRE007
     C*
     C** PROTECT ALL OTHER FIELDS
     C*
     C                     MOVE '1'       *IN09            **2
     C                     MOVE '1'       *IN06            **2
     C*
     C** ENABLE COMMAND 18
     C*
     C                     MOVE '1'       *IN19            **2
     C*
     C** DISPLAY AND VALIDATE TAX INDICATOR
     C*
     C                     EXSR TAXIN                      **2
     C*
     C                     ELSE                            X*2
     C*
     C** MOVE FIRST SCREEN DETAILS TO PARAMETERS
     C*
     C                     MOVE DETAI1    PP1DET
     C                     MOVE DETAI2    PP2DET
     C*
     C** IF FURTHER PARTIES INDICATOR = Y, SET UP AND DISPLAY/VALIDATE
     C** THE SECOND SCREEN
     C*
     C                     EXSR INSER2                     **2
     C                     END                             E*2
     C*
     C                     END                             E1
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C*
      /EJECT
     C*
     C*****************************************************************
     C*                                                               *
     C*   INSERJ - INSERT SCREEN PROCESS J                            *
     C*                                                               *
     C*   CALLED BY  :  MAIN PROCESS                                  *
     C*                                                               *
     C*   CALLS      :  VALID2                                        *
     C*                                                               *
     C*****************************************************************
     C*
     C           INSERJ    BEGSR
     C*
     C** Validate insert screen
     C*
     C                     EXSR VALID2
     C*
     C** If insert screen valid,
     C*
     C           *IN20     IFEQ '0'                        B1
     C*
     C** SET UP PARTY PARAMETERS WITH SCREEN DETAILS AND RETURN
     C*
     C                     MOVE DETAI1    PP1DET           *1
     C                     MOVE DETAI2    PP2DET           *1
     C                     MOVE SAXIND    PTAXIN           *1
     C                     MOVE '1'       *INKC            *1
     C                     END                             E1
     C*
     C                     ENDSR
     C*
      /EJECT
     C*
     C*****************************************************************
     C*                                                               *
     C*   AMENI1- AMENDMENT SCREEN PROCESSING  FOR TYPE I 1 PARTY     *
     C*                                                               *
     C*   CALLED BY  :  MAIN PROCESS                                  *
     C*                                                               *
     C*   CALLS      :  VALID1                                        *
     C*   CALLS      :  TAXIN                                         *
     C*   CALLS      :  AMEND2                                        *
     C*                                                               *
     C*****************************************************************
     C*
     C           AMENI1    BEGSR
     C*
     C** VALIDATE FIRST SCREEN DETAILS
     C*
     C                     EXSR VALID1
     C*
     C** IF FIRST SCREEN VALID
     C*
     C           *IN20     IFEQ '0'
     C*
     C** IF FURTHER PARTIES INDICATOR = 'N'
     C** DISPLAY TAX INDICATOR,  PROTECT ALL SCREEN FIELDS
     C** VALIDATE TAX INDICATOR.          '
     C*
     C           SFURPA    IFEQ 'N'
     C                     MOVE '0'       *IN07
     C                     MOVE '0'       *IN08
     C                     MOVE '1'       *IN09
     C                     MOVE '1'       *IN06
     C                     MOVE '1'       *IN19
     C                     EXSR TAXIN
     C                     ELSE
     C*
     C** UPDATE PARAMETERS WITH FIRST SCREEN DETAILS.
     C** DISPLAY/VALIDATE SECOND SCREEN
     C*
     C                     MOVE DETAI1    PP1DET
     C                     MOVE DETAI2    PP2DET
     C                     EXSR AMEND2
     C                     END
     C*
     C                     END
     C*
     C                     ENDSR
     C*
     C*****************************************************************
      /EJECT
     C*
     C*****************************************************************
     C*                                                               *
     C*   AMENI2- AMENDMENT SCREEN PROCESSING FOR ACCOUNT HOLDER      *
     C*           TYPE I CHANGING FROM J OR FROM I WITH 3 OR MORE     *
     C*           PARTIES                                             *
     C*                                                               *
     C*   CALLED BY  :  MAIN PROCESS                                  *
     C*                                                               *
     C*   CALLS      :  AMDVAL                                        *
     C*                                                               *
     C*                                                               *
     C*****************************************************************
     C*
     C           AMENI2    BEGSR
     C*
     C** DISPLAY OTHER DETAILS PROMPT
     C*
     C                     MOVE '0'       *IN03
     C*
     C           PACHLR    IFEQ 'I'                                                           CRE007
     C*
     C** DISPLAY SCREENS AND VALIDATE UNTIL NO. OF PARTIES IS NOT 2
     C** OR ZERO AND THERE ARE NO VALIDATION ERRORS OR UNTIL CMD3
     C*  OR CMD12 ARE PRESSED.
     C*
     C           Z         DOUNE2                          B1
     C           Z         ANDGT0
     C           *IN85     ANDEQ'0'
     C           *INKC     OREQ '1'
     C           *INKL     OREQ '1'
     C*
     C** DISPLAY SECOND SCREEN
     C*
     C                     WRITESD2464F4
     C                     EXFMTSD2464F3
     C*
     C** IF CMD/3 PRESSED EXIT
     C*
     C           *INKC     IFEQ '1'                        B*2
     C                     MOVEL'PREV   ' PRETC
     C                     ELSE                            X*2
     C*
     C** IF ENTER PRESSED ANALYSE SCREENS
     C*
     C           *INKL     IFEQ '0'                        B**3
     C                     MOVE *BLANKS   TEMP
     C                     Z-ADD0         Z       20
     C           S1NAME    IFNE *BLANKS                    B***4
     C                     ADD  1         Z
     C                     MOVE DETAI1    TEMP,Z
     C                     END                             E***4
     C*
     C           S2NAME    IFNE *BLANKS                    B***4
     C                     ADD  1         Z
     C                     MOVE DETAI2    TEMP,Z
     C                     END                             E***4
     C*
     C           S3NAME    IFNE *BLANKS                    B***4
     C                     ADD  1         Z
     C                     MOVE DETAI3    TEMP,Z
     C                     END                             E***4
     C*
     C           S4NAME    IFNE *BLANKS                    B***4
     C                     ADD  1         Z
     C                     MOVE DETAI4    TEMP,Z
     C                     END                             E***4
     C*
     C           S5NAME    IFNE *BLANKS                    B***4
     C                     ADD  1         Z
     C                     MOVE DETAI5    TEMP,Z
     C                     END                             E***4
     C*
     C** SETUP SCREEN DETAILS WITH CHOSEN DETAILS
     C*
     C                     MOVE TEMP,1    DETAI1
     C                     MOVE TEMP,2    DETAI2
     C                     MOVE TEMP,3    DETAI3
     C                     MOVE TEMP,4    DETAI4
     C                     MOVE TEMP,5    DETAI5
     C*
     C** IF NO. OF PARTIES CHOSEN VALID THEN VALIDATE CHOSEN DETAILS
     C*
     C           Z         IFNE 2                          B***4
     C           Z         ANDNE0
     C                     EXSR AMDVAL
     C                     ELSE                            X***4
     C*
     C** ELSE SET UP ERROR MESSAGE TO USER.
     C*
     C                     MOVELERRM,4    ERMSG
     C                     MOVE '1'       *IN20
     C                     END                             E***4
     C*
     C                     END                             E**3
     C*
     C** IF ANY ERRORS REDISPLAY FIRST SCREEN WITH CHOSEN DETAILS
     C*
     C           Z         IFEQ 2                          B**3
     C           Z         OREQ 0
     C           *INKL     OREQ '1'
     C           *IN85     OREQ '1'
     C*
     C                     MOVE '1'       *IN03
     C                     MOVE '1'       *IN04
     C                     MOVE '1'       *IN06
     C                     MOVE '0'       *IN07
     C                     MOVE '0'       *IN08
     C*
     C*
     C                     WRITESD2464F4
     C                     EXFMTSD2464F2
     C*
     C** IF CMD/3 PRESSED THEN EXIT
     C*
     C           *INKC     IFEQ '1'                        B***4
     C                     MOVEL'PREV   ' PRETC
     C                     ELSE                            X***4
     C*
     C** IF CMD/12 PRESSED THEN EXIT
     C*
     C           *INKL     IFEQ '1'                        B****5
     C                     MOVEL'USR0790' PRETC
     C                     END                             E****5
     C*
     C                     END                             E***4
     C*
     C                     ELSE                            X**3
     C*
     C** IF NO ERRORS
     C*
     C** IF TAX INDICATOR CHANGED FROM  'P'
     C** SEND MESSAGE TO USER.
     C*
     C           TAXIND    IFNE SAXIND                     B***4
     C           TAXIND    IFEQ 'P'                        B****5
     C                     MOVELERRM,2    ERMSG            *****5
     C                     END                             E****5
     C                     END                             E***4
      *
     C           ERMSG     IFNE *BLANKS                    B***4
     C           ERRCDE    ORNE *BLANKS                    ****4
     C                     MOVE '1'       *IN09            ****4
     C                     MOVE '1'       *IN20            ****4
     C                     WRITESD2464F2                   ****4
     C                     EXFMTSD2464F4                   ****4
     C                     MOVE '0'       *IN09            ****4
     C                     MOVE '0'       *IN20            ****4
     C                     END                             E***4
     C*
     C** SET UP PARMS AND EXIT
     C*
     C                     MOVE DETAI1    PP1DET           ***3
     C                     MOVE DETAI2    PP2DET           ***3
     C                     MOVE DETAI3    PP3DET           ***3
     C                     MOVE DETAI4    PP4DET           ***3
     C                     MOVE DETAI5    PP5DET           ***3
     C                     MOVE SAXIND    PTAXIN           ***3
     C**
     C                     EXSR CHKP                       ***3
     C**
     C                     MOVEAPSTS      PPSTS            ***3
     C                     MOVE '1'       *INKC            ***3
     C*
     C                     END                             E**3
     C*
     C                     END                             E*2
     C                     END                             E1
     C*
     C                     ELSE                                                               CRE007
     C*                                                                                       CRE007
     C** ACCOUNT HOLDER IS R.                                                                 CRE007
     C** DISPLAY SCREENS AND VALIDATE UNTIL NO. OF PARTIES IS NOT                             CRE007
     C** ZERO AND THERE ARE NO VALIDATION ERRORS OR UNTIL CMD3                                CRE007
     C*  OR CMD12 ARE PRESSED.                                                                CRE007
     C*                                                                                       CRE007
     C           Z         DOUGT0                          B1                                 CRE007
     C           *IN85     ANDEQ'0'                                                           CRE007
     C           *INKC     OREQ '1'                                                           CRE007
     C           *INKL     OREQ '1'                                                           CRE007
     C*                                                                                       CRE007
     C** DISPLAY SECOND SCREEN                                                                CRE007
     C*                                                                                       CRE007
     C                     WRITESD2464F4                                                      CRE007
     C                     EXFMTSD2464F3                                                      CRE007
     C*                                                                                       CRE007
     C** IF CMD/3 PRESSED EXIT                                                                CRE007
     C*                                                                                       CRE007
     C           *INKC     IFEQ '1'                        B*2                                CRE007
     C                     MOVEL'PREV   ' PRETC                                               CRE007
     C                     ELSE                            X*2                                CRE007
     C*                                                                                       CRE007
     C** IF ENTER PRESSED ANALYSE SCREENS                                                     CRE007
     C*                                                                                       CRE007
     C           *INKL     IFEQ '0'                        B**3                               CRE007
     C                     MOVE *BLANKS   TEMP                                                CRE007
     C                     Z-ADD0         Z       20                                          CRE007
     C           S1NAME    IFNE *BLANKS                    B***4                              CRE007
     C                     ADD  1         Z                                                   CRE007
     C                     MOVE DETAI1    TEMP,Z                                              CRE007
     C                     END                             E***4                              CRE007
     C*                                                                                       CRE007
     C           S2NAME    IFNE *BLANKS                    B***4                              CRE007
     C                     ADD  1         Z                                                   CRE007
     C                     MOVE DETAI2    TEMP,Z                                              CRE007
     C                     END                             E***4                              CRE007
     C*                                                                                       CRE007
     C           S3NAME    IFNE *BLANKS                    B***4                              CRE007
     C                     ADD  1         Z                                                   CRE007
     C                     MOVE DETAI3    TEMP,Z                                              CRE007
     C                     END                             E***4                              CRE007
     C*                                                                                       CRE007
     C           S4NAME    IFNE *BLANKS                    B***4                              CRE007
     C                     ADD  1         Z                                                   CRE007
     C                     MOVE DETAI4    TEMP,Z                                              CRE007
     C                     END                             E***4                              CRE007
     C*                                                                                       CRE007
     C           S5NAME    IFNE *BLANKS                    B***4                              CRE007
     C                     ADD  1         Z                                                   CRE007
     C                     MOVE DETAI5    TEMP,Z                                              CRE007
     C                     END                             E***4                              CRE007
     C*                                                                                       CRE007
     C** SETUP SCREEN DETAILS WITH CHOSEN DETAILS                                             CRE007
     C*                                                                                       CRE007
     C                     MOVE TEMP,1    DETAI1                                              CRE007
     C                     MOVE TEMP,2    DETAI2                                              CRE007
     C                     MOVE TEMP,3    DETAI3                                              CRE007
     C                     MOVE TEMP,4    DETAI4                                              CRE007
     C                     MOVE TEMP,5    DETAI5                                              CRE007
     C*                                                                                       CRE007
     C** IF NO. OF PARTIES CHOSEN VALID THEN VALIDATE CHOSEN DETAILS                          CRE007
     C*                                                                                       CRE007
     C           Z         IFNE 0                          B***4                              CRE007
     C                     EXSR AMDVAL                                                        CRE007
     C                     ELSE                            X***4                              CRE007
     C*                                                                                       CRE007
     C** ELSE SET UP ERROR MESSAGE TO USER.                                                   CRE007
     C*                                                                                       CRE007
     C                     MOVELERRM,6    ERMSG                                               CRE007
     C                     MOVE '1'       *IN20                                               CRE007
     C                     END                             E***4                              CRE007
     C*                                                                                       CRE007
     C                     END                             E**3                               CRE007
     C*                                                                                       CRE007
     C** IF ANY ERRORS REDISPLAY FIRST SCREEN WITH CHOSEN DETAILS                             CRE007
     C*                                                                                       CRE007
     C           Z         IFEQ 0                          B**3                               CRE007
     C           *INKL     OREQ '1'                                                           CRE007
     C           *IN85     OREQ '1'                                                           CRE007
     C*                                                                                       CRE007
     C                     MOVE '1'       *IN03                                               CRE007
     C                     MOVE '1'       *IN04                                               CRE007
     C                     MOVE '1'       *IN06                                               CRE007
     C                     MOVE '0'       *IN07                                               CRE007
     C                     MOVE '0'       *IN08                                               CRE007
     C*                                                                                       CRE007
     C*                                                                                       CRE007
     C                     WRITESD2464F4                                                      CRE007
     C                     EXFMTSD2464F2                                                      CRE007
     C*                                                                                       CRE007
     C** IF CMD/3 PRESSED THEN EXIT                                                           CRE007
     C*                                                                                       CRE007
     C           *INKC     IFEQ '1'                        B***4                              CRE007
     C                     MOVEL'PREV   ' PRETC                                               CRE007
     C                     ELSE                            X***4                              CRE007
     C*                                                                                       CRE007
     C** IF CMD/12 PRESSED THEN EXIT                                                          CRE007
     C*                                                                                       CRE007
     C           *INKL     IFEQ '1'                        B****5                             CRE007
     C                     MOVEL'USR0790' PRETC                                               CRE007
     C                     END                             E****5                             CRE007
     C*                                                                                       CRE007
     C                     END                             E***4                              CRE007
     C*                                                                                       CRE007
     C                     ELSE                            X**3                               CRE007
     C*                                                                                       CRE007
     C** IF NO ERRORS                                                                         CRE007
     C*                                                                                       CRE007
     C** IF TAX INDICATOR CHANGED FROM  'P'                                                   CRE007
     C** SEND MESSAGE TO USER.                                                                CRE007
     C*                                                                                       CRE007
     C           TAXIND    IFNE SAXIND                     B***4                              CRE007
     C           TAXIND    IFEQ 'P'                        B****5                             CRE007
     C                     MOVELERRM,2    ERMSG            *****5                             CRE007
     C                     END                             E****5                             CRE007
     C                     END                             E***4                              CRE007
      *                                                                                       CRE007
     C           ERMSG     IFNE *BLANKS                    B***4                              CRE007
     C           ERRCDE    ORNE *BLANKS                    ****4                              CRE007
     C                     MOVE '1'       *IN09            ****4                              CRE007
     C                     MOVE '1'       *IN20            ****4                              CRE007
     C                     WRITESD2464F2                   ****4                              CRE007
     C                     EXFMTSD2464F4                   ****4                              CRE007
     C                     MOVE '0'       *IN09            ****4                              CRE007
     C                     MOVE '0'       *IN20            ****4                              CRE007
     C                     END                             E***4                              CRE007
     C*                                                                                       CRE007
     C** SET UP PARMS AND EXIT                                                                CRE007
     C*                                                                                       CRE007
     C                     MOVE DETAI1    PP1DET           ***3                               CRE007
     C                     MOVE DETAI2    PP2DET           ***3                               CRE007
     C                     MOVE DETAI3    PP3DET           ***3                               CRE007
     C                     MOVE DETAI4    PP4DET           ***3                               CRE007
     C                     MOVE DETAI5    PP5DET           ***3                               CRE007
     C                     MOVE SAXIND    PTAXIN           ***3                               CRE007
     C**                                                                                      CRE007
     C                     EXSR CHKP                       ***3                               CRE007
     C**                                                                                      CRE007
     C                     MOVEAPSTS      PPSTS            ***3                               CRE007
     C                     MOVE '1'       *INKC            ***3                               CRE007
     C*                                                                                       CRE007
     C                     END                             E**3                               CRE007
     C*                                                                                       CRE007
     C                     END                             E*2                                CRE007
     C                     END                             E1                                 CRE007
     C*                                                                                       CRE007
     C                     ENDIF                                                              CRE007
     C*
     C                     ENDSR
     C*
     C*****************************************************************
      /EJECT
     C*
     C*****************************************************************
     C*                                                               *
     C*   AMDVAL- AMENDMENT SCREEN VALIDATION FOR ACCOUNT HOLDER      *
     C*           TYPE I CHANGING FROM J OR FROM I WITH 3 OR MORE     *
     C*           PARTIES.                                            *
     C*                                                               *
     C*   CALLED BY  :  AMENI2                                        *
     C*                                                               *
     C*   CALLS      :  VALID1                                        *
     C*   CALLS      :  VALTAX                                        *
     C*   CALLS      :  VALID3                                        *
     C*                                                               *
     C*****************************************************************
     C*
     C           AMDVAL    BEGSR
     C*
     C** INITIALISE ERROR INDICATOR
     C*
     C                     MOVE '0'       *IN85
     C*
     C** IF ONLY ONE PARTY VALIDATE SCREEN 1 AND TAX INDICATOR
     C*
     C           DETAI3    IFEQ *BLANKS
     C                     MOVE 'N'       SFURPA
     C                     MOVE '0'       *IN50
     C                     EXSR VALID1
     C                     EXSR VALTAX
     C                     ELSE
     C*
     C** IF 3 OR MORE PARTIES VALIDATE BOTH SCREENS.
     C*
     C                     MOVE 'Y'       SFURPA
     C                     EXSR VALID1
     C                     EXSR VALID3
     C                     END
     C*
     C** IF ERRORS IN ANY SCREEN SET ON INDICATOR 85.
     C*
     C           *IN20     IFEQ '1'
     C           *IN40     OREQ '1'
     C           *IN50     OREQ '1'
     C                     MOVE '1'       *IN85
     C                     END
     C*
     C                     ENDSR
     C*
     C*****************************************************************
      /EJECT
     C*
     C*****************************************************************
     C*                                                               *
     C*   AMENJ1- AMENDMENT SCREEN PROCESSING FOR ACCOUNT HOLDER      *
     C*           TYPE J SCREEN 1.                                    *
     C*                                                               *
     C*   CALLED BY  :  MAIN PROCESS                                  *
     C*                                                               *
     C*   CALLS      :  VALID2                                        *
     C*                                                               *
     C*****************************************************************
     C*
     C           AMENJ1    BEGSR
     C*
     C** VALIDATE SCREEN 1
     C*
     C                     EXSR VALID2
     C*
     C** IF FIRST SCREEN VALID
     C*
     C           *IN20     IFEQ '0'
     C*
     C** IF TAX INDICATOR CHANGED FROM OR TO 'P'
     C*  SEND MESSAGE TO USER.
     C*
     C           TAXIND    IFNE SAXIND
     C           TAXIND    IFEQ 'P'
     C           SAXIND    OREQ 'P'
     C                     MOVELERRM,2    ERMSG
     C                     END
     C                     END
      *
     C           ERMSG     IFNE *BLANKS
     C           ERRCDE    ORNE *BLANKS
     C                     MOVE '1'       *IN09
     C                     MOVE '1'       *IN20
     C                     WRITESD2464F2
     C                     EXFMTSD2464F4
     C                     MOVE '0'       *IN09
     C                     MOVE '0'       *IN20
     C                     END
     C*
     C** UPDATE PARAMETERS AND EXIT PROGRAM
     C*
     C                     MOVE DETAI1    PP1DET
     C                     MOVE DETAI2    PP2DET
     C                     MOVE DETAI3    PP3DET
     C                     MOVE DETAI4    PP4DET
     C                     MOVE DETAI5    PP5DET
     C                     MOVE SAXIND    PTAXIN
     C**
     C                     EXSR CHKP
     C**
     C                     MOVEAPSTS      PPSTS
     C                     MOVE '1'       *INKC
     C                     END
     C*
     C                     ENDSR
     C*
     C*****************************************************************
      /EJECT
     C*
     C*****************************************************************
     C*                                                               *
     C*   AMENJ2- AMENDMENT SCREEN PROCESSING FOR ACCOUNT HOLDER      *
     C*           TYPE J CHANGING FROM TYPE I (3 OR MORE PARTIES)     *
     C*                                                               *
     C*   CALLED BY  :  MAIN PROCESS                                  *
     C*                                                               *
     C*   CALLS      :  VALID2                                        *
     C*                                                               *
     C*                                                               *
     C*****************************************************************
     C*
     C           AMENJ2    BEGSR
     C*
     C** NON DISPLAY OTHER DETAILS PROMPT
     C*
     C                     MOVE '0'       *IN03
     C*
     C** DISPLAY SECOND SCREEN UNTIL NO. OF PARTIES =2 OR CMD3 OR CMD12
     C** PRESSED.
     C*
     C           Z         DOUEQ2                          B1
     C           *INKC     OREQ '1'
     C           *INKL     OREQ '1'
     C*
     C                     WRITESD2464F4
     C                     EXFMTSD2464F3
     C*
     C** IF CMD/3 PRESSED EXIT
     C*
     C           *INKC     IFEQ '1'                        B*2
     C                     MOVEL'PREV   ' PRETC
     C                     ELSE                            X*2
     C*
     C** IF ENTER PRESSED ANALYSE SCREENS
     C*
     C           *INKL     IFEQ '0'                        B**3
     C                     MOVE *BLANKS   TEMP
     C                     Z-ADD0         Z       20
     C           S1NAME    IFNE *BLANKS                    B***4
     C                     ADD  1         Z
     C                     MOVE DETAI1    TEMP,Z
     C                     END                             E***4
     C*
     C           S2NAME    IFNE *BLANKS                    B***4
     C                     ADD  1         Z
     C                     MOVE DETAI2    TEMP,Z
     C                     END                             E***4
     C*
     C           S3NAME    IFNE *BLANKS                    B***4
     C                     ADD  1         Z
     C                     MOVE DETAI3    TEMP,Z
     C                     END                             E***4
     C*
     C           S4NAME    IFNE *BLANKS                    B***4
     C                     ADD  1         Z
     C                     MOVE DETAI4    TEMP,Z
     C                     END                             E***4
     C*
     C           S5NAME    IFNE *BLANKS                    B***4
     C                     ADD  1         Z
     C                     MOVE DETAI5    TEMP,Z
     C                     END                             E***4
     C*
     C** MOVE CHOSEN DETAILS TO SCREEN
     C*
     C                     MOVE TEMP,1    DETAI1
     C                     MOVE TEMP,2    DETAI2
     C                     MOVE TEMP,3    DETAI3
     C                     MOVE TEMP,4    DETAI4
     C                     MOVE TEMP,5    DETAI5
     C*
     C** IF NO. OF PARTIES NOT = 2 SET UP ERROR MSG TO USER.
     C*
     C           Z         IFNE 2                          B***4
     C                     MOVELERRM,3    ERMSG
     C                     MOVE '1'       *IN20
     C                     ELSE
     C                     MOVE '0'       *IN20
     C                     END                             E***4
     C*
     C                     END                             E**3
     C*
     C** SET UP SCREEN 1 WITH CHOSEN DETAILS AND DISPLAY
     C*
     C           Z         IFGT 2                          B**3
     C                     MOVE '1'       *IN03
     C                     ELSE                            X**3
     C                     MOVE '0'       *IN03
     C                     END                             E**3
     C                     MOVE '0'       *INKL
     C                     MOVE '1'       *IN04
     C                     MOVE '1'       *IN06
     C                     MOVE '0'       *IN07
     C                     MOVE '0'       *IN08
     C*
     C                     WRITESD2464F4
     C                     EXFMTSD2464F2
     C*
     C** IF CMD/3 PRESSED EXIT
     C*
     C           *INKC     IFEQ '1'                        B**3
     C                     MOVEL'PREV   ' PRETC
     C                     ELSE                            X**3
     C*
     C** IF CMD/12 PRESSED EXIT
     C*
     C           *INKL     IFEQ '1'                        B***4
     C                     MOVEL'USR0790' PRETC
     C                     END                             E***4
     C                     END                             E**3
     C                     END                             E*2
     C                     END                             E1
     C*
     C** IF NO. OF PARTIES = 2 AND NOT CMD3 OR CMD12
     C** VALIDATE NEW DETAILS
     C*
     C           Z         IFEQ 2                          B1
     C           *INKC     ANDEQ'0'                        B1
     C           *INKL     ANDEQ'0'                        B1
     C                     EXSR VALID2
     C*
     C** IF SCREEN VALID
     C*
     C           *IN20     IFEQ '0'                        B*2
     C*
     C** IF TAX INDICATOR CHANGED TO 'P'
     C** SEND MESSAGE TO USER.
     C*
     C           TAXIND    IFNE SAXIND                     B**3
     C           SAXIND    IFEQ 'P'                        B***4
     C                     MOVELERRM,2    ERMSG            ****4
     C                     END                             E***4
     C                     END                             E**3
      *
     C           ERMSG     IFNE *BLANKS                    B**3
     C           ERRCDE    ORNE *BLANKS                    ***3
     C                     MOVE '1'       *IN09            ***3
     C                     MOVE '1'       *IN20            ***3
     C                     WRITESD2464F2                   ***3
     C                     EXFMTSD2464F4                   ***3
     C                     MOVE '0'       *IN09            ***3
     C                     MOVE '0'       *IN20            ***3
     C                     END                             E**3
     C*
     C** SET UP PARMS AND EXIT
     C*
     C                     MOVE DETAI1    PP1DET           **2
     C                     MOVE DETAI2    PP2DET           **2
     C                     MOVE DETAI3    PP3DET           **2
     C                     MOVE DETAI4    PP4DET           **2
     C                     MOVE DETAI5    PP5DET           **2
     C                     MOVE SAXIND    PTAXIN           **2
     C**
     C                     EXSR CHKP                       **2
     C**
     C                     MOVEAPSTS      PPSTS            **2
     C                     MOVE '1'       *INKC            **2
     C                     END                             E*2
     C*
     C                     END                             E1
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C*
      /EJECT
     C*
     C*****************************************************************
     C*                                                               *
     C*   ENQUIR - ENQUIRY SCREEN PROCESSING                          *
     C*                                                               *
     C*   CALLED BY  :  MAIN PROCESS                                  *
     C*                                                               *
     C*   CALLS      :                                                *
     C*                                                               *
     C*****************************************************************
     C*
     C           ENQUIR    BEGSR
     C*
     C** IF 3RD PARTY DETAILS EXIST SET UP AND DISPLAY SCREEN 2
     C*
     C           H3NAME    IFNE *BLANKS                    B1
     C*
     C** PROTECT ALL SCREEN FIELDS
     C*
     C                     MOVE '1'       *IN11            *1
     C                     MOVE '0'       *IN03            *1
     C*
     C** DISPLAY THE SECOND SCREEN
     C*
     C                     WRITESD2464F4                   *1
     C                     EXFMTSD2464F3                   *1
     C*
     C** IF CMD/3 PRESSED EXIT
     C*
     C           *INKC     IFEQ '1'                        B*2
     C                     MOVEL'PREV   ' PRETC            **2
     C                     ELSE                            X*2
     C*
     C** RESET CMD/12 SO ONLY RETURNS AS FAR AS PREVIOUS SCREEN.
     C** DISPLAY PROMPT FOR OTHER DETAILS ON PREVIOUS SCREEN.
     C*
     C           *INKL     IFEQ '1'                        B**3
     C                     MOVE '0'       *INKL
     C                     MOVE '1'       *IN03
     C                     ELSE                            X**3
     C*
     C** ENTER PRESSED ON SECOND SCREEN SO EXIT PROGRAM
     C*
     C                     MOVE '1'       *INKL
     C                     END                             E**3
     C                     END                             E*2
     C*
     C** ENTER PRESSED ON FIRST SCREEN SO EXIT PROGRAM
     C*
     C                     ELSE                            X1
     C                     MOVE '1'       *INKL
     C                     END                             E1
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C*
      /EJECT
     C*
     C*****************************************************************
     C*                                                               *
     C*   VALID1 - VALIDATE SCREEN ONE                                *
     C*                                                               *
     C*   CALLED BY  :  INSERI                                        *
     C*                 AMENI1                                        *
     C*                 AMDVAL                                        *
     C*                                                               *
     C*   CALLS      :  ZDATE1                                        *
     C*                                                               *
     C*****************************************************************
     C*
     C           VALID1    BEGSR
     C*
     C** BLANK OUT ERROR CODES BEFORE REVALIDATING SCREEN
     C*
     C                     MOVE *BLANKS   ERMSG            *1
     C                     MOVE *BLANKS   ERRCDE           *1
     C                     MOVEA*BLANKS   ERR              *1
     C                     Z-ADD1         X                *1
     C                     SETOF                     121314*1
     C                     SETOF                     202122*1
     C                     SETOF                     232425*1
     C                     SETOF                     262728*1
     C                     SETOF                     293031*1
     C                     SETOF                     323334*1
     C                     SETOF                     353637*1
     C                     SETOF                     383940*1
     C                     SETOF                     41    *1
     C                     SETOF                     81    *1                                 CRE007
     C*
     C** VALIDATE PARTY 1 NAME - ENTRY MANDATORY IF BLANK HI/RI ALL
     C**                         PARTY 1 FIELDS
     C*
     C           S1NAME    IFEQ *BLANKS                    B1
     C                     MOVE ' 900'    ERR,X            *1
     C                     SETON                     2120  *1
     C                     ADD  1         X       20       *1
     C*
     C** IF NO PARTY 1 NAME ALL PARTY 2 DETAILS MUST BE BLANK
     C*
     C           DETAI2    IFNE *BLANKS                    B*2
     C                     MOVE ' 908'    ERR,X            **2
     C                     SETON                     3020  **2
     C                     ADD  1         X                **2
     C                     END                             E*2
     C                     ELSE                            X1
     C*
     C** PARTY 1 NAME VALID SO VALIDATE PARTY 1 OTHER DETAILS
     C*
     C*
     C** VALIDATE PARTY 1 ADDRESS LINE 1
     C*
     C           S1ADR1    IFEQ *BLANKS                    B*2
     C                     MOVE ' 901'    ERR,X            **2
     C                     SETON                     2220  **2
     C                     ADD  1         X                **2
     C                     END                             E*2
     C*
     C** VALIDATE PARTY 1 ADDRESS LINE 2
     C*
     C           S1ADR1    IFEQ *BLANKS                    B*2
     C           S1ADR2    ANDNE*BLANKS                    **2
     C                     MOVE ' 902'    ERR,X            **2
     C                     SETON                     2320  **2
     C                     ADD  1         X                **2
     C                     END                             E*2
     C*
     C** VALIDATE PARTY 1 ADDRESS LINE 3
     C*
     C           S1ADR2    IFEQ *BLANKS                    B*2
     C           S1ADR3    ANDNE*BLANKS                    B*2
     C                     MOVE ' 903'    ERR,X            **2
     C                     SETON                     2420  **2
     C                     ADD  1         X                **2
     C                     END                             E*2
     C*
     C** VALIDATE PARTY 1 POSTCODE 2
     C*
     C           S1PCD1    IFEQ *BLANKS                    B*2
     C           S1PCD2    ANDNE*BLANKS                    B*2
     C                     MOVE ' 904'    ERR,X            **2
     C                     SETON                     2620  **2
     C                     ADD  1         X                **2
     C                     END                             E*2
     C*
     C** VALIDATE PARTY 1 BRT LIABLE
     C*
     C           PACHLR    IFEQ 'R'                                                           CRE007
     C           S1BRTL    IFNE 'X'                                                           CRE007
     C           S1BRTL    ANDNE'N'                                                           CRE007
     C                     MOVELERRM,9    ERMSG                                               CRE007
     C                     SETON                     2720                                     CRE007
     C                     ENDIF                                                              CRE007
     C                     ELSE                                                               CRE007
     C           S1BRTL    IFNE 'Y'                        B*2
     C           S1BRTL    ANDNE'N'                        B*2
     C           S1BRTL    ANDNE'X'                        B*2
     C                     MOVE ' 905'    ERR,X            **2
     C                     SETON                     2720  **2
     C                     ADD  1         X                **2
     C                     END                             E*2
     C                     ENDIF                                                              CRE007
     C*
     C** VALIDATE PARTY 1 DATE OF BIRTH    29 906
     C*
      ** Move display file field S1DOBN to field S1DOB                                        260405
      *                                                                                       260405
     C           S1DOBN    IFNE *BLANKS                                                       260405
     C                     MOVELS1DOBN    #DDMM                                               260405
     C                     MOVE S1DOBN    #YY                                                 260405
     C           #YY       IFNE *BLANKS                                                       260405
      *                                                                                       260405
      ** Century exists.  Move century to file field.                                         260405
      *                                                                                       260405
     C                     MOVE S1DOBN    #YEAR                                               260405
      *                                                                                       260405
      ** Update field S1DOB                                                                   260405
      *                                                                                       260405
     C                     MOVEL#DDMM     W1DOBX  6                                           260405
     C                     MOVE #YY       W1DOBX                                              260405
     C                     MOVE W1DOBX    S1DOB                                               260405
     C                     ELSE                                                               260405
     C                     MOVELS1DOBN    S1DOB                                               260405
     C                     ENDIF                                                              260405
     C                     ELSE                                                               260405
     C                     MOVE *BLANKS   S1DOB                                               260405
     C                     ENDIF                                                              260405
      *                                                                                       260405
     C* Date of Birth can be blank if A/C Type Holder is R but                                CRE007
     C* BRT liable is N.                                                                      CRE007
     C           PACHLR    IFNE 'R'                                                           CRE007
     C           S1BRTL    ANDEQ'N'                        B*2                                CRE007
     C***********S1BRTL    IFEQ 'N'                        B*2                                CRE007
     C           S1DOB     ANDEQ*BLANKS                    B*2
     C                     MOVE ' 906'    ERR,X            **2
     C                     SETON                     292027**2
     C                     ADD  1         X                **2
     C                     END                             E*2
     C*
     C           S1DOB     IFNE *BLANKS                    B*2
     C                     MOVE S1DOB     ZDATE            **2
     C                     EXSR ZDATE1                     **2
     C           *IN99     IFEQ '1'                        B**3
     C                     MOVE ' 907'    ERR,X            ***3
     C                     SETON                     2920  ***3
     C                     SETOF                     99    ***3
     C                     ADD  1         X                ***3
     C                     END                             E**3
     C                     END                             E*2
     C*
     C*
     C** VALIDATE PP2DET DETAILS
     C*
     C** VALIDATE PARTY 2 NAME
     C*
     C           S2NAME    IFEQ *BLANKS                    B*2
     C           OTHER2    IFNE *BLANKS                    B**3
     C                     MOVE ' 900'    ERR,X            ***3
     C                     SETON                     3120  ***3
     C                     ADD  1         X                ***3
     C                     END                             E**3
     C                     ELSE                            X*2
     C*
     C** PARTY 2 NAME VALID SO VALIDATE PARTY 2 OTHER DETAILS
     C*
     C*
     C** VALIDATE PARTY 2 ADDRESS LINE 1
     C*
     C           S2ADR1    IFEQ *BLANKS                    B**3
     C                     MOVE ' 901'    ERR,X            ***3
     C                     SETON                     3220  ***3
     C                     ADD  1         X                ***3
     C                     END                             E**3
     C*
     C** VALIDATE PARTY 2 ADDRESS LINE 2
     C*
     C           S2ADR1    IFEQ *BLANKS                    B**3
     C           S2ADR2    ANDNE*BLANKS                    B**3
     C                     MOVE ' 902'    ERR,X            ***3
     C                     SETON                     3320  ***3
     C                     ADD  1         X                ***3
     C                     END                             E**3
     C*
     C** VALIDATE PARTY 2 ADDRESS LINE 3
     C*
     C           S2ADR2    IFEQ *BLANKS                    B**3
     C           S2ADR3    ANDNE*BLANKS                    B**3
     C                     MOVE ' 903'    ERR,X            ***3
     C                     SETON                     3420  ***3
     C                     ADD  1         X                ***3
     C                     END                             E**3
     C*
     C** VALIDATE PARTY 2 POSTCODE 2
     C*
     C           S2PCD1    IFEQ *BLANKS                    B**3
     C           S2PCD2    ANDNE*BLANKS                    B**3
     C                     MOVE ' 904'    ERR,X            ***3
     C                     SETON                     3620  ***3
     C                     ADD  1         X                ***3
     C                     END                             E**3
     C*
     C** VALIDATE PARTY 2 BRT LIABLE
     C*
     C           PACHLR    IFEQ 'R'                                                           CRE007
     C           S2BRTL    IFNE 'X'                                                           CRE007
     C           S2BRTL    ANDNE'N'                                                           CRE007
     C                     MOVELERRM,9    ERMSG                                               CRE007
     C                     SETON                     2720                                     CRE007
     C                     ENDIF                                                              CRE007
     C                     ELSE                                                               CRE007
     C           S2BRTL    IFNE 'Y'                        B**3
     C           S2BRTL    ANDNE'N'                        B**3
     C           S2BRTL    ANDNE'X'                        B**3
     C                     MOVE ' 905'    ERR,X            ***3
     C                     SETON                     3720  ***3
     C                     ADD  1         X                ***3
     C                     END                             E**3
     C                     ENDIF                                                              CRE007
     C*
     C** VALIDATE PARTY 2 DATE OF BIRTH
      *                                                                                       260405
      ** Move display file field S2DOBN to field S2DOB                                        260405
      *                                                                                       260405
     C           S2DOBN    IFNE *BLANKS                                                       260405
     C                     MOVELS2DOBN    #DDMM                                               260405
     C                     MOVE S2DOBN    #YY                                                 260405
     C           #YY       IFNE *BLANKS                                                       260405
      *                                                                                       260405
      ** Century exists.  Move century to file field.                                         260405
      *                                                                                       260405
     C                     MOVE S2DOBN    #YEAR                                               260405
      *                                                                                       260405
      ** Update field S2DOB                                                                   260405
      *                                                                                       260405
     C                     MOVEL#DDMM     W2DOBX  6                                           260405
     C                     MOVE #YY       W2DOBX                                              260405
     C                     MOVE W2DOBX    S2DOB                                               260405
     C                     ELSE                                                               260405
     C                     MOVELS2DOBN    S2DOB                                               260405
     C                     ENDIF                                                              260405
     C                     ELSE                                                               260405
     C                     MOVE *BLANKS   S2DOB                                               260405
     C                     ENDIF                                                              260405
      *                                                                                       260405
     C*
     C* Date of Birth can be blank if A/C Type Holder is R but                                CRE007
     C* BRT liable is N.                                                                      CRE007
     C*                                                                                       CRE007
     C           PACHLR    IFNE 'R'                        B*3                                CRE007
     C           S2BRTL    ANDEQ'N'                        B*3                                CRE007
     C***********S2BRTL    IFEQ 'N'                        B*3                                CRE007
     C           S2DOB     ANDEQ*BLANKS                    B**3
     C                     MOVE ' 906'    ERR,X            ***3
     C                     SETON                     392037***3
     C                     ADD  1         X                ***3
     C                     END                             E**3
     C*
     C           S2DOB     IFNE *BLANKS                    B**3
     C                     MOVE S2DOB     ZDATE            ***3
     C                     EXSR ZDATE1                     ***3
     C           *IN99     IFEQ '1'                        B***4
     C                     MOVE ' 907'    ERR,X            ****4
     C                     SETON                     3920  ****4
     C                     SETOF                     99    ****4
     C                     ADD  1         X                ****4
     C                     END                             E***4
     C                     END                             E**3
     C*
     C** DETAILS INPUT FOR PARTY 1 AND 2
     C*
     C           PACHLR    IFEQ 'I'                                                           CRE007
     C*                                                                                       CRE007
     C** PARTY 2 BRT CAN ONLY BE Y OR X IF PARTY 1 BRT IS Y
     C*
     C           S1BRTL    IFEQ 'Y'                        B**3
     C           S2BRTL    IFNE 'Y'                        B***4
     C           S2BRTL    ANDNE'X'                        ****4
     C                     MOVE ' 909'    ERR,X            ****4
     C                     SETON                     273720****4
     C                     ADD  1         X                ****4
     C                     ELSE                            X***4
     C*
     C** SETON INDICATOR 12 TO INDICATE ONLY X OR Y ENTERED ON FIRST
     C** SCREEN.
     C*
     C                     MOVE '1'       *IN12            ****4
     C                     END                             E***4
     C                     END                             E**3
     C*
     C** PARTY 2 BRT CAN ONLY BE N OR X IF PARTY 1 BRT IS N
     C*
     C           S1BRTL    IFEQ 'N'                        B**3
     C           S2BRTL    IFNE 'N'                        B***4
     C           S2BRTL    ANDNE'X'                        ****4
     C                     MOVE ' 909'    ERR,X            ****4
     C                     SETON                     273720****4
     C                     ADD  1         X                ****4
     C                     ELSE                            X***4
     C*
     C** SETON INDICATOR 13 TO INDICATE ONLY X OR N ENTERED ON FIRST
     C** SCREEN.
     C*
     C                     MOVE '1'       *IN13            ****4
     C                     END                             E***4
     C                     END                             E**3
     C*
     C           S1BRTL    IFEQ 'X'                        B**3
     C           S2BRTL    IFEQ 'Y'                        B***4
     C                     MOVE '1'       *IN12            ****4
     C                     END                             E***4
     C           S2BRTL    IFEQ 'N'                        B***4
     C                     MOVE '1'       *IN13            ****4
     C                     END                             E***4
     C*
     C** SETON INDICATOR 14 TO INDICATE ONLY X  ENTERED ON FIRST
     C** SCREEN.
     C*
     C           S2BRTL    IFEQ 'X'                        B***4
     C                     MOVE '1'       *IN14            ****4
     C                     END                             E***4
     C                     END                             E**3
     C*
     C                     ENDIF                                                              CRE007
     C*                                                                                       CRE007
     C           PACHLR    IFEQ 'R'                                                           CRE007
     C*                                                                                       CRE007
     C** IF BOTH PARTIES ENTERED AND BRT LIABLE = 'X' SETON *IN14                             CRE007
     C*                                                                                       CRE007
     C           S1BRTL    IFEQ 'X'                        B**3                               CRE007
     C           S2BRTL    ANDEQ'X'                        ****3                              CRE007
     C                     MOVE '1'       *IN14            ****3                              CRE007
     C                     END                             E**3                               CRE007
      *                                                                                       CRE007
     C                     ENDIF                                                              CRE007
      *                                                                                       CRE007
     C                     END                             E*2
     C*
     C** IF ONLY 1 PARTY ENTERED, CANNOT HAVE BRT LAIBLE = 'X'                                CRE007
     C           PACHLR    IFEQ 'R'                                                           CRE007
     C           S2NAME    ANDEQ*BLANKS                                                       CRE007
     C           OTHER2    ANDEQ*BLANKS                                                       CRE007
     C           S1BRTL    ANDEQ'X'                                                           CRE007
     C                     MOVELERRM,10   ERMSG                                               CRE007
     C                     SETON                     2720                                     CRE007
     C                     ENDIF                                                              CRE007
      *                                                                                       CRE007
     C                     END                             E1
     C*
     C** VALIDATE FURTHER PARTIES INDICATOR
     C*
     C* If Further Parties is nor N, Y or Blank error                                         CRE007
     C           SFURPA    IFNE *BLANKS                                                       CRE007
     C           SFURPA    ANDNE'N'                                                           CRE007
     C           SFURPA    ANDNE'Y'                                                           CRE007
     C                     MOVELERRM,11   ERMSG                                               CRE007
     C                     SETON                     4120                                     CRE007
     C                     ENDIF                                                              CRE007
      *                                                                   091778
      * If 'Further parties' blank, default it if a/c holder = 'I'        091778
     C           SFURPA    IFEQ *BLANKS                                   091778
     C           PACHLR    ANDEQ'I'                                       091778
     C           SFURPA    OREQ *BLANKS                                                       CRE007
     C           PACHLR    ANDEQ'R'                                                           CRE007
     C           S2NAME    IFEQ *BLANKS                                   091778
     C                     MOVEL'N'       SFURPA                          091778
     C                     ELSE                                           091778
     C                     MOVEL'Y'       SFURPA                          091778
     C                     ENDIF                                          091778
     C                     ENDIF                                          091778
      *                                                                   091778
     C           S2NAME    IFNE *BLANKS
      * If account type holder is I and 2nd party details filled then                         CRE007
      * must be at least another party entered. If account holder type                        CRE007
      * is R there need not be.                                                               CRE007
     C           PACHLR    IFEQ 'I'                                                           CRE007
      *                                                                                       CRE007
     C           SFURPA    IFEQ 'N'
     C           SFURPA    OREQ *BLANKS
     C                     MOVE ' 911'    ERR,X
     C                     SETON                     4120
     C                     ADD  1         X
     C                     END
      *                                                                                       CRE007
     C                     ENDIF                                                              CRE007
     C                     ELSE
     C           SFURPA    IFEQ 'Y'
     C           SFURPA    OREQ *BLANKS
     C                     MOVE ' 912'    ERR,X
     C                     SETON                     4120
     C                     ADD  1         X
     C                     END
     C                     END
      *                                                                                       CRE007
      * If Account Holder type is R and both parties entered and BRT                          CRE007
      * liable is X then error if Further Parties is N.                                       CRE007
     C           PACHLR    IFEQ 'R'                                                           CRE007
     C           *IN14     ANDEQ*ON                                                           CRE007
     C           SFURPA    ANDEQ'N'                                                           CRE007
     C                     MOVELERRM,12   ERMSG                                               CRE007
     C                     SETON                     2720                                     CRE007
     C                     ENDIF                                                              CRE007
      *                                                                                       CRE007
     C                     ENDSR
     C*
     C*****************************************************************
      /EJECT
     C*
     C*****************************************************************
     C*                                                               *
     C*   VALID2 - VALIDATE SCREEN ONE FOR ACCOUNT HOLDER J           *
     C*                                                               *
     C*   CALLED BY  :  INSERJ                                        *
     C*                 AMENJ1                                        *
     C*                 AMENJ2                                        *
     C*                                                               *
     C*   CALLS      :  ZDATE1                                        *
     C*                                                               *
     C*****************************************************************
     C*
     C           VALID2    BEGSR
     C*
     C** BLANK OUT ERROR CODES BEFORE REVALIDATING SCREEN
     C*
     C           *IN20     IFEQ '1'
     C                     MOVE *BLANKS   ERMSG            *1
     C                     MOVE *BLANKS   ERRCDE           *1
     C                     MOVEA*BLANKS   ERR              *1
     C                     Z-ADD1         X                *1
     C                     SETOF                     202122*1
     C                     SETOF                     232425*1
     C                     SETOF                     262728*1
     C                     SETOF                     293031*1
     C                     SETOF                     323334*1
     C                     SETOF                     353637*1
     C                     SETOF                     383940*1
     C                     SETOF                     41    *1
     C                     SETOF                     82    *1                                 CRE007
     C                     END
     C*
     C** VALIDATE PARTY 1 NAME - ENTRY MANDATORY IF BLANK HI/RI ALL
     C**                         PARTY 1 FIELDS
     C*
     C           S1NAME    IFEQ *BLANKS                    B1
     C                     MOVE ' 900'    ERR,X            *1
     C                     SETON                     2120  *1
     C                     ADD  1         X                *1
     C*
     C** IF NO PARTY 1 NAME ALL PARTY 2 DETAILS MUST BE BLANK
     C*
     C           DETAI2    IFNE *BLANKS                    B*2
     C                     MOVE ' 908'    ERR,X            **2
     C                     SETON                     3020  **2
     C                     ADD  1         X                **2
     C                     END                             E*2
     C                     ELSE                            X1
     C*
     C** PARTY 1 NAME VALID SO VALIDATE PARTY 1 OTHER DETAILS
     C*
     C*
     C** VALIDATE PARTY 1 ADDRESS LINE 1
     C*
     C           S1ADR1    IFEQ *BLANKS                    B*2
     C                     MOVE ' 901'    ERR,X            **2
     C                     SETON                     2220  **2
     C                     ADD  1         X                **2
     C                     END                             E*2
     C*
     C** VALIDATE PARTY 1 ADDRESS LINE 2
     C*
     C           S1ADR1    IFEQ *BLANKS                    B*2
     C           S1ADR2    ANDNE*BLANKS                    **2
     C                     MOVE ' 902'    ERR,X            **2
     C                     SETON                     2320  **2
     C                     ADD  1         X                **2
     C                     END                             E*2
     C*
     C** VALIDATE PARTY 1 ADDRESS LINE 3
     C*
     C           S1ADR2    IFEQ *BLANKS                    B*2
     C           S1ADR3    ANDNE*BLANKS                    B*2
     C                     MOVE ' 903'    ERR,X            **2
     C                     SETON                     2420  **2
     C                     ADD  1         X                **2
     C                     END                             E*2
     C*
     C** VALIDATE PARTY 1 POSTCODE 2
     C*
     C           S1PCD1    IFEQ *BLANKS                    B*2
     C           S1PCD2    ANDNE*BLANKS                    B*2
     C                     MOVE ' 904'    ERR,X            **2
     C                     SETON                     2620  **2
     C                     ADD  1         X                **2
     C                     END                             E*2
     C*
     C** VALIDATE PARTY 1 BRT LIABLE
     C*
     C           S1BRTL    IFNE 'Y'                        B*2
     C           S1BRTL    ANDNE'N'                        B*2
     C           S1BRTL    ANDNE'X'                        B*2
     C                     MOVE ' 905'    ERR,X            **2
     C                     SETON                     2720  **2
     C                     ADD  1         X                **2
     C                     END                             E*2
     C*
     C** VALIDATE PARTY 1 DATE OF BIRTH    29 906
     C*
      * Date of Birth can be blank if A/C Type Holder is R but                                CRE007
      * BRT liable is N.                                                                      CRE007
     C           PACHLR    IFNE 'R'                                                           CRE007
     C           S1BRTL    ANDEQ'N'                        B*2                                CRE007
     C***********S1BRTL    IFEQ 'N'                        B*2                                CRE007
     C           S1DOB     ANDEQ*BLANKS                    B*2
     C                     MOVE ' 906'    ERR,X            **2
     C                     SETON                     292027**2
     C                     ADD  1         X                **2
     C                     END                             E*2
     C*
     C           S1DOB     IFNE *BLANKS                    B*2
     C                     MOVE S1DOB     ZDATE            **2
     C                     EXSR ZDATE1                     **2
     C           *IN99     IFEQ '1'                        B**3
     C                     MOVE ' 907'    ERR,X            ***3
     C                     SETON                     2920  ***3
     C                     SETOF                     99    ***3
     C                     ADD  1         X                ***3
     C                     END                             E**3
     C                     END                             E*2
     C*
     C*
     C** VALIDATE PARTY 2 DETAILS
     C*
     C** VALIDATE PARTY 2 NAME
     C*
     C           S2NAME    IFEQ *BLANKS                    B*2
     C                     MOVE ' 900'    ERR,X            **2
     C                     SETON                     3120  **2
     C                     ADD  1         X                **2
     C                     ELSE                            X*2
     C*
     C** PARTY 2 NAME VALID SO VALIDATE PARTY 2 OTHER DETAILS
     C*
     C*
     C** VALIDATE PARTY 2 ADDRESS LINE 1
     C*
     C           S2ADR1    IFEQ *BLANKS                    B**3
     C                     MOVE ' 901'    ERR,X            ***3
     C                     SETON                     3220  ***3
     C                     ADD  1         X                ***3
     C                     END                             E**3
     C*
     C** VALIDATE PARTY 2 ADDRESS LINE 2
     C*
     C           S2ADR1    IFEQ *BLANKS                    B**3
     C           S2ADR2    ANDNE*BLANKS                    B**3
     C                     MOVE ' 902'    ERR,X            ***3
     C                     SETON                     3320  ***3
     C                     ADD  1         X                ***3
     C                     END                             E**3
     C*
     C** VALIDATE PARTY 2 ADDRESS LINE 3
     C*
     C           S2ADR2    IFEQ *BLANKS                    B**3
     C           S2ADR3    ANDNE*BLANKS                    B**3
     C                     MOVE ' 903'    ERR,X            ***3
     C                     SETON                     3420  ***3
     C                     ADD  1         X                ***3
     C                     END                             E**3
     C*
     C** VALIDATE PARTY 2 POSTCODE 2
     C*
     C           S2PCD1    IFEQ *BLANKS                    B**3
     C           S2PCD2    ANDNE*BLANKS                    B**3
     C                     MOVE ' 904'    ERR,X            ***3
     C                     SETON                     3620  ***3
     C                     ADD  1         X                ***3
     C                     END                             E**3
     C*
     C** VALIDATE PARTY 2 BRT LIABLE
     C*
     C           S2BRTL    IFNE 'Y'                        B**3
     C           S2BRTL    ANDNE'N'                        B**3
     C           S2BRTL    ANDNE'X'                        B**3
     C                     MOVE ' 905'    ERR,X            ***3
     C                     SETON                     3720  ***3
     C                     ADD  1         X                ***3
     C                     END                             E**3
     C*
     C** FOR ACCOUNT HOLDER TYPE J BOTH PARTIES BRT CANNOT BE X
     C*
     C           S1BRTL    IFEQ 'X'                        B**3
     C           S2BRTL    ANDEQ'X'                        B**3
     C                     MOVE ' 913'    ERR,X            ***3
     C                     SETON                     3720  ***3
     C                     ADD  1         X                ***3
     C                     END                             E**3
     C*
     C** VALIDATE PARTY 2 DATE OF BIRTH
     C*
      * Date of Birth can be blank if A/C Type Holder is R but                                CRE007
      * BRT liable is N.                                                                      CRE007
     C           PACHLR    IFNE 'R'                                                           CRE007
     C           S2BRTL    ANDEQ'N'                        B*2                                CRE007
     C***********S2BRTL    IFEQ 'N'                        B*2                                CRE007
     C           S2DOB     ANDEQ*BLANKS                    B**3
     C                     MOVE ' 906'    ERR,X            ***3
     C                     SETON                     392037***3
     C                     ADD  1         X                ***3
     C                     END                             E**3
     C*
     C           S2DOB     IFNE *BLANKS                    B**3
     C                     MOVE S2DOB     ZDATE            ***3
     C                     EXSR ZDATE1                     ***3
     C           *IN99     IFEQ '1'                        B***4
     C                     MOVE ' 907'    ERR,X            ****4
     C                     SETON                     3920  ****4
     C                     SETOF                     99    ****4
     C                     ADD  1         X                ****4
     C                     END                             E***4
     C                     END                             E**3
     C*
     C*
     C                     END                             E*2
     C*
     C                     END                             E1
     C*
     C** VALIDATE TAX INDICATOR
     C           SAXIND    IFNE 'L'                        B1
     C           SAXIND    ANDNE'N'                        B1
     C           SAXIND    ANDNE'P'                        B1
     C           SAXIND    OREQ 'X'                        B1
     C                     MOVE ' 914'    ERR,X            *1
     C                     SETON                     4020  *1
     C                     ADD  1         X                *1
     C                     END                             E1
     C*
     C** FOR TAX IND. = L NEITHER PARTY CAN BE NON LIABLE.
     C*
     C           SAXIND    IFEQ 'L'                        B1
     C           S1BRTL    IFEQ 'N'                        B*2
     C           S2BRTL    OREQ 'N'                        B*2
     C                     MOVE ' 914'    ERR,X            **2
     C                     SETON                     4020  **2
     C                     ADD  1         X                **2
     C                     END                             E*2
     C                     END                             E1
     C*
     C** FOR TAX IND. = P ONE PARTY MUST BE LIABLE AND THE OTHER NOT.
     C*
     C           SAXIND    IFEQ 'P'                        B1
     C           S1BRTL    IFEQ S2BRTL                     B*2
     C           S1BRTL    OREQ 'X'                        B*2
     C           S2BRTL    OREQ 'X'                        B*2
     C                     MOVE ' 914'    ERR,X            **2
     C                     SETON                     4020  **2
     C                     ADD  1         X                **2
     C                     END                             E*2
     C                     END                             E1
     C*
     C** FOR TAX IND. = N NEITHER PARTY MUST BE LIABLE.
     C*
     C           SAXIND    IFEQ 'N'                        B1
     C           S1BRTL    IFEQ 'Y'                        B*2
     C           S2BRTL    OREQ 'Y'                        B*2
     C                     MOVE ' 914'    ERR,X            **2
     C                     SETON                     4020  **2
     C                     ADD  1         X                **2
     C                     END                             E*2
     C                     END                             E1
      *                                                                                       CRE007
      ** VALIDATE POST 4/5/01 R105                                                            CRE007
     C           CRE007    IFEQ 'Y'                                                           CRE007
     C                     EXSR VLPST1                                                        CRE007
     C                     ENDIF                                                              CRE007
      *                                                                                       CRE007
     C                     ENDSR
     C*
     C*****************************************************************
     C*                                                               *
     C*   VALID3 - VALIDATE SCREEN TWO                                *
     C*                                                               *
     C*   CALLED BY  :  AMDVAL                                        *
     C*                 INSER2                                        *
     C*                 AMEND2                                        *
     C*                                                               *
     C*   CALLS      :  ZDATE1                                        *
     C*                                                               *
     C*****************************************************************
     C*
     C           VALID3    BEGSR
     C*
     C** BLANK OUT ERROR CODES BEFORE REVALIDATING SCREEN
     C*
     C           *IN50     IFEQ '1'                        B1
     C                     MOVE *BLANKS   ERMSG            *1
     C                     MOVE *BLANKS   ERRCDE           *1
     C                     MOVEA*BLANKS   ERR              *1
     C                     Z-ADD1         X                *1
     C                     SETOF                     505152*1
     C                     SETOF                     535455*1
     C                     SETOF                     565758*1
     C                     SETOF                     596061*1
     C                     SETOF                     626364*1
     C                     SETOF                     656667*1
     C                     SETOF                     686970*1
     C                     SETOF                     717273*1
     C                     SETOF                     747576*1
     C                     SETOF                     777879*1
     C                     SETOF                     80    *1
     C                     SETOF                     82    *1                                 CRE007
     C                     END                             E1
     C*
     C** VALIDATE PARTY 3 NAME - ENTRY MANDATORY IF BLANK HI/RI ALL
     C**                         PARTY 3 FIELDS
     C*
     C           S3NAME    IFEQ *BLANKS                    B1
     C                     MOVE ' 900'    ERR,X            *1
     C                     SETON                     5150  *1
     C                     ADD  1         X                *1
     C           OTHER3    IFNE *BLANKS                    B*2
     C                     MOVE ' 900'    ERR,X            **2
     C                     SETON                     575258**2
     C                     SETON                     535954**2
     C                     SETON                     555650**2
     C                     ADD  1         X                **2
     C                     END                             E*2
     C*
     C** IF NO PARTY 3 NAME ALL PARTY 4 DETAILS MUST BE BLANK
     C*
     C           DETAI4    IFNE *BLANKS                    B*2
     C                     MOVE ' 915'    ERR,X            **2
     C                     SETON                     6050  **2
     C                     ADD  1         X                **2
     C                     END                             E*2
     C*
     C** IF NO PARTY 3 NAME ALL PARTY 5 DETAILS MUST BE BLANK
     C*
     C           DETAI5    IFNE *BLANKS                    B*2
     C                     MOVE ' 916'    ERR,X            **2
     C                     SETON                     7050  **2
     C                     ADD  1         X                **2
     C                     END                             E*2
     C                     ELSE                            X1
     C*
     C** PARTY 3 NAME VALID SO VALIDATE PARTY 3 OTHER DETAILS
     C*
     C*
     C** VALIDATE PARTY 3 ADDRESS LINE 1
     C*
     C           S3ADR1    IFEQ *BLANKS                    B*2
     C                     MOVE ' 901'    ERR,X            **2
     C                     SETON                     5250  **2
     C                     ADD  1         X                **2
     C                     END                             E*2
     C*
     C** VALIDATE PARTY 3 ADDRESS LINE 2
     C*
     C           S3ADR1    IFEQ *BLANKS                    B*2
     C           S3ADR2    ANDNE*BLANKS                    **2
     C                     MOVE ' 902'    ERR,X            **2
     C                     SETON                     5350  **2
     C                     ADD  1         X                **2
     C                     END                             E*2
     C*
     C** VALIDATE PARTY 3 ADDRESS LINE 3
     C*
     C           S3ADR2    IFEQ *BLANKS                    B*2
     C           S3ADR3    ANDNE*BLANKS                    B*2
     C                     MOVE ' 903'    ERR,X            **2
     C                     SETON                     5450  **2
     C                     ADD  1         X                **2
     C                     END                             E*2
     C*
     C** VALIDATE PARTY 3 POSTCODE 2
     C*
     C           S3PCD1    IFEQ *BLANKS                    B*2
     C           S3PCD2    ANDNE*BLANKS                    B*2
     C                     MOVE ' 904'    ERR,X            **2
     C                     SETON                     5650  **2
     C                     ADD  1         X                **2
     C                     END                             E*2
     C*
     C** VALIDATE PARTY 3 BRT LIABLE
     C*
     C           PACHLR    IFEQ 'R'                                                           CRE007
     C           S3BRTL    IFNE 'X'                                                           CRE007
     C           S3BRTL    ANDNE'N'                                                           CRE007
     C                     MOVELERRM,9    ERMSG                                               CRE007
     C                     SETON                     5750                                     CRE007
     C                     END                                                                CRE007
     C                     ELSE                                                               CRE007
     C           S3BRTL    IFNE 'Y'                        B*2
     C           S3BRTL    ANDNE'N'                        B*2
     C           S3BRTL    ANDNE'X'                        B*2
     C                     MOVE ' 905'    ERR,X            **2
     C                     SETON                     5750  **2
     C                     ADD  1         X                **2
     C                     END                             E*2
     C                     ENDIF                                                              CRE007
     C*
     C** IF PP3DET BRT LIABLE PREVIOUS PARTIES MUST NOT HAVE BEEN
     C** NON-LIABLE.(*IN13)
     C*
     C           S3BRTL    IFEQ 'Y'                        B*2
     C           *IN13     IFEQ '1'                        B**3
     C                     MOVE ' 909'    ERR,X            ***3
     C                     SETON                     5750  ***3
     C                     ADD  1         X                ***3
     C                     ELSE                            X**3
     C                     MOVE '1'       *IN12            ***3
     C                     MOVE '0'       *IN14            ***3
     C                     END                             E**3
     C                     END                             E*2
     C*
     C** IF PP3DET NON BRT LIABLE PREVIOUS PARTIES MUST NOT HAVE
     C** BEEN LIABLE.(*IN12)
     C*
     C           S3BRTL    IFEQ 'N'                        B*2
     C           *IN12     IFEQ '1'                        B**3
     C                     MOVE ' 909'    ERR,X            ***3
     C                     SETON                     5750  ***3
     C                     ADD  1         X                ***3
     C                     ELSE                            X**3
     C                     MOVE '1'       *IN13            ***3
     C                     MOVE '0'       *IN14            ***3
     C                     END                             E**3
     C                     END                             E*2
     C*
     C** VALIDATE PARTY 3 DATE OF BIRTH
     C*
      * Date of Birth can be blank if A/C Type Holder is R but                                CRE007
      * BRT liable is N.                                                                      CRE007
     C           PACHLR    IFNE 'R'                                                           CRE007
     C           S3BRTL    ANDEQ'N'                        B*2                                CRE007
     C***********S3BRTL    IFEQ 'N'                        B*2                                CRE007
     C           S3DOB     ANDEQ*BLANKS                    B*2
     C                     MOVE ' 906'    ERR,X            **2
     C***********          SETON                     592057**2                                CRE007
     C                     SETON                     595057**2                                CRE007
     C                     ADD  1         X                **2
     C                     END                             E*2
     C*
     C           PACHLR    IFEQ 'R'                                                           CRE007
     C           S3BRTL    ANDEQ'N'                                                           CRE007
     C                     MOVE '0'       *IN14                                               CRE007
     C                     ENDIF                                                              CRE007
      *                                                                                       CRE007
     C           S3DOB     IFNE *BLANKS                    B*2
     C                     MOVE S3DOB     ZDATE            **2
     C                     EXSR ZDATE1                     **2
     C           *IN99     IFEQ '1'                        B**3
     C                     MOVE ' 907'    ERR,X            ***3
     C                     SETON                     5950  ***3
     C                     SETOF                     99    ***3
     C                     ADD  1         X                ***3
     C                     END                             E**3
     C                     END                             E*2
     C*
     C*
     C** VALIDATE PARTY 4 DETAILS
     C*
     C** VALIDATE PARTY 4 NAME
     C*
     C           S4NAME    IFEQ *BLANKS                    B*2
     C           OTHER4    IFNE *BLANKS                    B**3
     C                     MOVE ' 900'    ERR,X            ***3
     C                     SETON                     6150  ***3
     C                     ADD  1         X                ***3
     C                     END                             E**3
     C*
     C** IF NO PARTY 4 NAME ALL PARTY 5 DETAILS MUST BE BLANK
     C*
     C           DETAI5    IFNE *BLANKS                    B**3
     C                     MOVE ' 917'    ERR,X            ***3
     C                     SETON                     7050  ***3
     C                     ADD  1         X                ***3
     C                     END                             E**3
     C*
     C                     ELSE                            X*2
     C*
     C** PARTY 4 NAME VALID SO VALIDATE PARTY 4 OTHER DETAILS
     C*
     C*
     C** VALIDATE PARTY 4 ADDRESS LINE 1
     C*
     C           S4ADR1    IFEQ *BLANKS                    B**3
     C                     MOVE ' 901'    ERR,X            ***3
     C                     SETON                     6250  ***3
     C                     ADD  1         X                ***3
     C                     END                             E**3
     C*
     C** VALIDATE PARTY 4 ADDRESS LINE 2
     C*
     C           S4ADR1    IFEQ *BLANKS                    B**3
     C           S4ADR2    ANDNE*BLANKS                    B**3
     C                     MOVE ' 902'    ERR,X            ***3
     C                     SETON                     6350  ***3
     C                     ADD  1         X                ***3
     C                     END                             E**3
     C*
     C** VALIDATE PARTY 4 ADDRESS LINE 3
     C*
     C           S4ADR2    IFEQ *BLANKS                    B**3
     C           S4ADR3    ANDNE*BLANKS                    B**3
     C                     MOVE ' 903'    ERR,X            ***3
     C                     SETON                     6450  ***3
     C                     ADD  1         X                ***3
     C                     END                             E**3
     C*
     C** VALIDATE PARTY 4 POSTCODE 2
     C*
     C           S4PCD1    IFEQ *BLANKS                    B**3
     C           S4PCD2    ANDNE*BLANKS                    B**3
     C                     MOVE ' 904'    ERR,X            ***3
     C                     SETON                     6650  ***3
     C                     ADD  1         X                ***3
     C                     END                             E**3
     C*
     C** VALIDATE PARTY 4 BRT LIABLE
     C*
     C           PACHLR    IFEQ 'R'                                                           CRE007
     C           S4BRTL    IFNE 'X'                                                           CRE007
     C           S4BRTL    ANDNE'N'                                                           CRE007
     C                     MOVELERRM,9    ERMSG                                               CRE007
     C                     SETON                     5750                                     CRE007
     C                     END                                                                CRE007
     C                     ELSE                                                               CRE007
     C           S4BRTL    IFNE 'Y'                        B**3
     C           S4BRTL    ANDNE'N'                        B**3
     C           S4BRTL    ANDNE'X'                        B**3
     C                     MOVE ' 905'    ERR,X            ***3
     C                     SETON                     6750  ***3
     C                     ADD  1         X                ***3
     C                     END                             E**3
     C                     ENDIF                                                              CRE007
     C*
     C           PACHLR    IFEQ 'R'                                                           CRE007
     C           S4BRTL    ANDEQ'N'                                                           CRE007
     C                     MOVE '0'       *IN14                                               CRE007
     C                     ENDIF                                                              CRE007
      *                                                                                       CRE007
     C** IF PP4DET BRT LIABLE PREVIOUS PARTIES MUST NOT HAVE BEEN
     C** NON-LIABLE.(*IN13)
     C*
     C           PACHLR    IFEQ 'I'                                                           CRE007
     C           S4BRTL    IFEQ 'Y'                        B**3
     C           *IN13     IFEQ '1'                        B***4
     C                     MOVE ' 909'    ERR,X            ****4
     C                     SETON                     6750  ****4
     C                     ADD  1         X                ****4
     C                     ELSE                            X***4
     C                     MOVE '1'       *IN12            ****4
     C                     MOVE '0'       *IN14            ****4
     C                     END                             E***4
     C                     END                             E**3
     C*
     C** IF PP4DET NON BRT LIABLE PREVIOUS PARTIES MUST NOT HAVE
     C** BEEN LIABLE.(*IN12)
     C*
     C           S4BRTL    IFEQ 'N'                        B**3
     C           *IN12     IFEQ '1'                        B***4
     C                     MOVE ' 909'    ERR,X            ****4
     C                     SETON                     6750  ****4
     C                     ADD  1         X                ****4
     C                     ELSE                            X***4
     C                     MOVE '1'       *IN13            ****4
     C                     MOVE '0'       *IN14            ****4
     C                     END                             E***4
     C                     END                             E**3
      *                                                                                       CRE007
     C                     ENDIF                                                              CRE007
     C*
     C** VALIDATE PARTY 4 DATE OF BIRTH
     C*
      * Date of Birth can be blank if A/C Type Holder is R but                                CRE007
      * BRT liable is N.                                                                      CRE007
     C           PACHLR    IFNE 'R'                                                           CRE007
     C           S4BRTL    ANDEQ'N'                        B*2                                CRE007
     C***********S4BRTL    IFEQ 'N'                        B*2                                CRE007
     C           S4DOB     ANDEQ*BLANKS                    B**3
     C                     MOVE ' 906'    ERR,X            ***3
     C***********          SETON                     692067***3                               CRE007
     C                     SETON                     695067***3                               CRE007
     C                     ADD  1         X                ***3
     C                     END                             E**3
     C*
     C           S4DOB     IFNE *BLANKS                    B**3
     C                     MOVE S4DOB     ZDATE            ***3
     C                     EXSR ZDATE1                     ***3
     C           *IN99     IFEQ '1'                        B***4
     C                     MOVE ' 907'    ERR,X            ****4
     C                     SETON                     6950  ****4
     C                     SETOF                     99    ****4
     C                     ADD  1         X                ****4
     C                     END                             E***4
     C                     END                             E**3
     C*
     C** VALIDATE PARTY 5 DETAILS
     C*
     C** VALIDATE PARTY 5 NAME
     C*
     C           S5NAME    IFEQ *BLANKS                    B**3
     C           OTHER5    IFNE *BLANKS                    B***4
     C                     MOVE ' 900'    ERR,X            ****4
     C                     SETON                     7150  ****4
     C                     ADD  1         X                ****4
     C                     END                             E***4
     C*
     C                     ELSE                            X**3
     C*
     C** PARTY 5 NAME VALID SO VALIDATE PARTY 5 OTHER DETAILS
     C*
     C*
     C** VALIDATE PARTY 5 ADDRESS LINE 1
     C*
     C           S5ADR1    IFEQ *BLANKS                    B***4
     C                     MOVE ' 901'    ERR,X            ****4
     C                     SETON                     7250  ****4
     C                     ADD  1         X                ****4
     C                     END                             E***4
     C*
     C** VALIDATE PARTY 5 ADDRESS LINE 2
     C*
     C           S5ADR1    IFEQ *BLANKS                    B***4
     C           S5ADR2    ANDNE*BLANKS                    B***4
     C                     MOVE ' 902'    ERR,X            ****4
     C                     SETON                     7350  ****4
     C                     ADD  1         X                ****4
     C                     END                             E***4
     C*
     C** VALIDATE PARTY 5 ADDRESS LINE 3
     C*
     C           S5ADR2    IFEQ *BLANKS                    B***4
     C           S5ADR3    ANDNE*BLANKS                    B***4
     C                     MOVE ' 903'    ERR,X            ****4
     C                     SETON                     7450  ****4
     C                     ADD  1         X                ****4
     C                     END                             E***4
     C*
     C** VALIDATE PARTY 5 POSTCODE 2
     C*
     C           S5PCD1    IFEQ *BLANKS                    B***4
     C           S5PCD2    ANDNE*BLANKS                    B***4
     C                     MOVE ' 904'    ERR,X            ****4
     C                     SETON                     7650  ****4
     C                     ADD  1         X                ****4
     C                     END                             E***4
     C*
     C** VALIDATE PARTY 5 BRT LIABLE
     C*
     C           PACHLR    IFEQ 'R'                                                           CRE007
     C           S5BRTL    IFNE 'X'                                                           CRE007
     C           S5BRTL    ANDNE'N'                                                           CRE007
     C                     MOVELERRM,9    ERMSG                                               CRE007
     C                     SETON                     5750                                     CRE007
     C                     END                                                                CRE007
     C                     ELSE                                                               CRE007
     C           S5BRTL    IFNE 'Y'                        B***4
     C           S5BRTL    ANDNE'N'                        B***4
     C           S5BRTL    ANDNE'X'                        B***4
     C                     MOVE ' 905'    ERR,X            ****4
     C                     SETON                     7750  ****4
     C                     ADD  1         X                ****4
     C                     END                             E***4
     C                     ENDIF                                                              CRE007
     C*
     C** IF PP5DET BRT LIABLE PREVIOUS PARTIES MUST NOT HAVE BEEN
     C** NON-LIABLE.(*IN13)
     C*
     C           PACHLR    IFEQ 'I'                                                           CRE007
     C           S5BRTL    IFEQ 'Y'                        B***4
     C           *IN13     IFEQ '1'                        B****5
     C                     MOVE ' 909'    ERR,X            *****5
     C                     SETON                     7750  *****5
     C                     ADD  1         X                *****5
     C                     ELSE                            X****5
     C                     MOVE '1'       *IN12            *****5
     C                     MOVE '0'       *IN14            *****5
     C                     END                             E****5
     C                     END                             E***4
     C*
     C** IF PP5DET NON BRT LIABLE PREVIOUS PARTIES MUST NOT HAVE
     C** BEEN LIABLE.(*IN12)
     C*
     C           S5BRTL    IFEQ 'N'                        B***4
     C           *IN12     IFEQ '1'                        B****5
     C                     MOVE ' 909'    ERR,X            *****5
     C                     SETON                     7750  *****5
     C                     ADD  1         X                *****5
     C                     ELSE                            X****5
     C                     MOVE '1'       *IN13            *****5
     C                     MOVE '0'       *IN14            *****5
     C                     END                             E****5
     C                     END                             E***4
      *                                                                                       CRE007
     C                     ENDIF                                                              CRE007
     C*
     C           PACHLR    IFEQ 'R'                                                           CRE007
     C           S5BRTL    ANDEQ'N'                                                           CRE007
     C                     MOVE '0'       *IN14                                               CRE007
     C                     ENDIF                                                              CRE007
     C*                                                                                       CRE007
     C** VALIDATE PARTY 5 DATE OF BIRTH
     C*
      * Date of Birth can be blank if A/C Type Holder is R but                                CRE007
      * BRT liable is N.                                                                      CRE007
     C           PACHLR    IFNE 'R'                                                           CRE007
     C           S5BRTL    ANDEQ'N'                        B*2                                CRE007
     C***********S5BRTL    IFEQ 'N'                        B*2                                CRE007
     C           S5DOB     ANDEQ*BLANKS                    B***4
     C                     MOVE ' 906'    ERR,X            ****4
     C***********          SETON                     792077****4                              CRE007
     C                     SETON                     795077****4                              CRE007
     C                     ADD  1         X                ****4
     C                     END                             E***4
     C*
     C           S5DOB     IFNE *BLANKS                    B***4
     C                     MOVE S5DOB     ZDATE            ****4
     C                     EXSR ZDATE1                     ****4
     C           *IN99     IFEQ '1'                        B****5
     C                     MOVE ' 907'    ERR,X            *****5
     C                     SETON                     7950  *****5
     C                     SETOF                     99    *****5
     C                     ADD  1         X                *****5
     C                     END                             E****5
     C                     END                             E***4
     C*
     C                     END                             E**3
     C*
     C                     END                             E*2
     C*
     C*
     C** AT LEAST ONE BRT LIABLE FLAG MUST NOT BE 'X'
     C*
     C           *IN14     IFEQ '1'                        B*2
     C           PACHLR    IFNE 'R'                                                           CRE007
     C                     MOVE ' 909'    ERR,X            **2
     C                     SETON                     5750  **2
     C                     ADD  1         X                **2
     C                     ELSE                                                               CRE007
     C                     MOVELERRM,12   ERMSG                                               CRE007
     C                     SETON                     5750                                     CRE007
     C                     END                             E*2
     C                     ENDIF                                                              CRE007
     C*
     C** VALIDATE TAX INDICATOR
     C*
     C           PACHLR    IFEQ 'I'                                                           CRE007
      *                                                                                       CRE007
     C           SAXIND    IFEQ 'L'                        B*2
     C           *IN12     ANDNE'1'                        **2
     C                     MOVE ' 914'    ERR,X            **2
     C                     SETON                     8050  **2
     C                     ADD  1         X                **2
     C                     END                             E*2
     C*
     C           SAXIND    IFEQ 'N'                        B*2
     C           *IN13     ANDNE'1'                        **2
     C                     MOVE ' 914'    ERR,X            **2
     C                     SETON                     8050  **2
     C                     ADD  1         X                **2
     C                     END                             E*2
     C*
     C           SAXIND    IFNE 'L'                        B*2
     C           SAXIND    ANDNE'N'                        **2
     C                     MOVE ' 914'    ERR,X            **2
     C                     SETON                     8050  **2
     C                     ADD  1         X                **2
     C                     END                             E*2
      *                                                                                       CRE007
     C                     ENDIF                                                              CRE007
      *                                                                                       CRE007
     C           PACHLR    IFEQ 'R'                                                           CRE007
     C           SAXIND    ANDNE'N'                                                           CRE007
     C                     MOVELERRM,7    ERMSG                                               CRE007
     C                     SETON                     4050                                     CRE007
     C                     ENDIF                                                              CRE007
      *                                                                                       CRE007
      ** VALIDATE POST 4/5/01 R105                                                            CRE007
     C           CRE007    IFEQ 'Y'                                                           CRE007
     C                     EXSR VLPST2                                                        CRE007
     C                     ENDIF                                                              CRE007
      *                                                                                       CRE007
     C                     END                             E1
     C*
     C                     ENDSR
      /EJECT
     C*****************************************************************
     C*                                                               *
     C*   TAXIN  - PROCESS TAX INDICATOR ON FIRST SCREEN              *
     C*                                                               *
     C*   CALLED BY  :  INSERI                                        *
     C*                 AMENDI1                                       *
     C*   CALLS      :  VALTAX
     C*                                                               *
     C*****************************************************************
     C*
     C           TAXIN     BEGSR
     C*
     C** DISPLAY AND VALIDATE FIRST SCREEN WITH TAX INDICATOR
     C*
     C                     MOVE '0'       *IN03
     C*
     C           *INKC     DOWEQ'0'                        B1
     C           *INKL     ANDEQ'0'                        B1
     C           *IN18     ANDEQ'0'                        B1
     C*
     C** DISPLAY THE FIRST SCREEN
     C*
     C                     WRITESD2464F4                   *1
     C                     EXFMTSD2464F2                   *1
     C*
     C** IF CMD/3 PRESSED EXIT
     C*
     C           *INKC     IFEQ '1'                        B*2
     C                     MOVEL'PREV   ' PRETC            **2
     C                     ELSE                            X*2
     C*
     C** IF CMD/12 PRESSED EXIT
     C*
     C           *INKL     IFEQ '1'                        B**3
     C                     MOVEL'USR0790' PRETC            ***3
     C                     ELSE                            X**3
     C*
     C** RETURN TO PREVIOUS SCREEN IF CMD/18 PRESSED
     C*
     C           *IN18     IFEQ '1'                        B***4
     C                     SETON                     0708  ****4
     C                     SETOF                     190609****4
     C                     MOVE *BLANKS   ERRCDE           ****4
     C                     MOVEA*BLANKS   ERR              ****4
     C                     MOVE *BLANKS   ERMSG            ****4
     C                     Z-ADD1         X                ****4
     C                     SETOF                     4020  ****4
     C*
     C                     ELSE                            X***4
     C*
     C** IF SCREEN 2 DETAILS ARE NOT BLANK SEND MESSAGE TO SAY THAT
     C** FURTHER PARTY DETAILS WILL BE IGNORED IF ENTER PRESSED
     C*
     C           DETAI3    IFNE *BLANKS                    B****5
     C           DETAI4    ORNE *BLANKS                    B****5
     C           DETAI5    ORNE *BLANKS                    B****5
     C                     MOVELERRM,1    ERMSG            *****5
     C                     SETON                     20    *****5
     C*
     C** REDISPLAY  FIRST SCREEN
     C*
     C                     WRITESD2464F4                   *****5
     C                     EXFMTSD2464F2                   *****5
     C                     END                             E****5
     C*
     C           *IN18     IFEQ '0'                        B****5
     C*
     C** ENTER PRESSED VALIDATE TAX INDICATOR
     C*
     C                     EXSR VALTAX                     *****5
      *                                                                                       CRE007
      ** VALIDATE POST 5/4/01 R105                                                            CRE007
      *                                                                                       CRE007
     C           CRE007    IFEQ 'Y'                                                           CRE007
     C                     EXSR VLPST1                                                        CRE007
     C                     ENDIF                                                              CRE007
      *                                                                                       CRE007
     C           *IN40     IFEQ '0'                        B*****6
     C           *IN81     ANDEQ'0'                                                           CRE007
     C*
     C** IF IN AMEND
     C*
     C           PACTN     IFEQ 'A'                        B******7
     C*
     C** IF TAX INDICATOR CHANGED FROM 'P' SEND MSG TO USER.
     C*
     C           TAXIND    IFNE SAXIND                     B*******8
     C           TAXIND    ANDEQ'P'                        ********8
     C                     MOVELERRM,2    ERMSG            ********8
     C                     END                             E*******8
      *
     C           ERMSG     IFNE *BLANKS                    B*******8
     C           ERRCDE    ORNE *BLANKS                    ********8
     C                     MOVE '1'       *IN09            ********8
     C                     MOVE '1'       *IN20            ********8
     C                     WRITESD2464F2                   ********8
     C                     EXFMTSD2464F4                   ********8
     C                     MOVE '0'       *IN09            ********8
     C                     MOVE '0'       *IN20            ********8
     C                     END                             E*******8
     C                     END                             E******7
     C*
     C*
     C** SET UP PARTY PARAMETERS WITH SCREEN DETAILS AND RETURN
     C*
     C                     MOVE DETAI1    PP1DET           ******6
     C                     MOVE DETAI2    PP2DET           ******6
     C                     MOVE DETAI3    PP3DET           ******6
     C                     MOVE DETAI4    PP4DET           ******6
     C                     MOVE DETAI5    PP5DET           ******6
     C**
     C                     EXSR CHKP
     C**
     C                     MOVEAPSTS      PPSTS
     C                     MOVE SAXIND    PTAXIN           ******6
     C                     MOVE '1'       *INKC            ******6
     C                     END                             E*****6
     C*
     C                     ELSE                            X****5
     C*
     C** RETURN TO PREVIOUS SCREEN IF CMD/18 PRESSED
     C*
     C                     SETON                     0708  *****5
     C                     SETOF                     190609*****5
     C                     MOVE *BLANKS   ERRCDE           *****5
     C                     MOVEA*BLANKS   ERR              *****5
     C                     MOVE *BLANKS   ERMSG            *****5
     C                     Z-ADD1         X                *****5
     C                     SETOF                     4020  *****5
     C                     END                             E****5
     C                     END                             E***4
     C                     END                             E**3
     C                     END                             E*2
     C                     END                             E1
     C                     ENDSR
     C*
     C*****************************************************************
     C*
      /EJECT
     C*
     C*****************************************************************
     C*                                                               *
     C*   VALTAX - VALIDATE TAX INDICATOR ON FIRST SCREEN             *
     C*                                                               *
     C*   CALLED BY  :  AMDVAL                                        *
     C*                 TAXIN                                         *
     C*                                                               *
     C*   CALLS      :
     C*                                                               *
     C*****************************************************************
     C*
     C           VALTAX    BEGSR
     C*
     C** IF ERROR IN SCREEN SETOF ERROR, AND CLEAR ERROR ARRAY
     C*
     C           *IN40     IFEQ '1'                        B1
     C                     MOVE *BLANKS   ERRCDE           *1
     C                     MOVEA*BLANKS   ERR              *1
     C                     Z-ADD1         X                *1
     C                     SETOF                     4020  *1
     C                     END                             E1
     C*
     C           PACHLR    IFEQ 'R'                                                           CRE007
      *                                                                                       CRE007
     C           SAXIND    IFNE 'N'                                                           CRE007
     C                     MOVELERRM,7    ERMSG                                               CRE007
     C                     SETON                     4020                                     CRE007
     C                     ENDIF                                                              CRE007
      *                                                                                       CRE007
     C                     ELSE                                                               CRE007
      *                                                                                       CRE007
     C           SAXIND    IFNE 'L'                        B1
     C           SAXIND    ANDNE'N'                        B1
     C           SAXIND    OREQ 'X'                        B1
     C           SAXIND    OREQ 'P'                        B1
     C                     MOVE ' 914'    ERR,X            *1
     C                     SETON                     4020  *1
     C                     ADD  1         X                *1
     C                     END                             E1
     C*
     C           SAXIND    IFEQ 'N'                        B1
     C           S1BRTL    ANDNE'N'                        B1
     C           S1BRTL    ANDNE'X'                                       075324
     C                     MOVE ' 914'    ERR,X            *1
     C                     SETON                     4020  *1
     C                     ADD  1         X                *1
     C                     END                             E1
     C*
     C           SAXIND    IFEQ 'L'                        B1
     C           S1BRTL    ANDNE'Y'                        B1
     C           S1BRTL    ANDNE'X'                                       075324
     C                     MOVE ' 914'    ERR,X            *1
     C                     SETON                     4020  *1
     C                     ADD  1         X                *1
     C                     END                             E1
     C*
     C                     ENDIF                                                              CRE007
     C                     ENDSR
     C*
     C*****************************************************************
     C*****************************************************************                       CRE007
     C*                                                               *                       CRE007
     C*   VLPST1 - VALIDATE POST 4/5/01 R105 ON FIRST SCREEN          *                       CRE007
     C*                                                               *                       CRE007
     C*   CALLED BY  :                                                *                       CRE007
     C*                                                               *                       CRE007
     C*                                                               *                       CRE007
     C*   CALLS      :                                                                        CRE007
     C*                                                               *                       CRE007
     C*****************************************************************                       CRE007
     C*                                                                                       CRE007
     C           VLPST1    BEGSR                                                              CRE007
     C*                                                                                       CRE007
     C                     MOVE *OFF      *IN81                                               CRE007
     C** IF A/C TYPE HOLDER IS I OR J AND VALUE NOT S OR BLANK                                CRE007
     C** THEN ERROR.                                                                          CRE007
     C*                                                                                       CRE007
     C           PACHLR    IFEQ 'I'                        B1                                 CRE007
     C           PACHLR    OREQ 'J'                        B1                                 CRE007
     C           SPSTR     IFNE 'S'                        B2                                 CRE007
     C           SPSTR     ANDNE*BLANKS                    B2                                 CRE007
     C                     MOVELERRM,8    ERMSG                                               CRE007
     C                     SETON                     8120                                     CRE007
     C                     END                             E2                                 CRE007
     C                     END                             E1                                 CRE007
     C** IF A/C TYPE HOLDER IS R AND VALUE NOT N OR Y                                         CRE007
     C** THEN ERROR.                                                                          CRE007
     C*                                                                                       CRE007
     C           PACHLR    IFEQ 'R'                        B1                                 CRE007
     C           SPSTR     IFNE 'Y'                        B2                                 CRE007
     C           SPSTR     ANDNE'N'                        B2                                 CRE007
     C                     MOVELERRM,13   ERMSG                                               CRE007
     C                     SETON                     8120                                     CRE007
     C                     END                             E2                                 CRE007
     C                     END                             E1                                 CRE007
     C*                                                                                       CRE007
     C                     ENDSR                                                              CRE007
     C*****************************************************************                       CRE007
     C*                                                               *                       CRE007
     C*   VLPST2 - VALIDATE POST 4/5/01 R105 ON SECOND SCREEN         *                       CRE007
     C*                                                               *                       CRE007
     C*   CALLED BY  :                                                *                       CRE007
     C*                                                               *                       CRE007
     C*                                                               *                       CRE007
     C*   CALLS      :                                                                        CRE007
     C*                                                               *                       CRE007
     C*****************************************************************                       CRE007
     C*                                                                                       CRE007
     C           VLPST2    BEGSR                                                              CRE007
     C*                                                                                       CRE007
     C                     MOVE *OFF      *IN82                                               CRE007
     C** IF A/C TYPE HOLDER IS I OR J AND VALUE NOT S OR BLANK                                CRE007
     C** THEN ERROR.                                                                          CRE007
     C*                                                                                       CRE007
     C           PACHLR    IFEQ 'I'                        B1                                 CRE007
     C           PACHLR    OREQ 'J'                        B1                                 CRE007
     C           SPSTR     IFNE 'S'                        B2                                 CRE007
     C           SPSTR     ANDNE*BLANKS                    B2                                 CRE007
     C                     MOVELERRM,8    ERMSG                                               CRE007
     C                     SETON                     8250                                     CRE007
     C                     END                             E2                                 CRE007
     C                     END                             E1                                 CRE007
     C** IF A/C TYPE HOLDER IS R AND VALUE NOT N OR Y                                         CRE007
     C** THEN ERROR.                                                                          CRE007
     C*                                                                                       CRE007
     C           PACHLR    IFEQ 'R'                        B1                                 CRE007
     C           SPSTR     IFNE 'Y'                        B2                                 CRE007
     C           SPSTR     ANDNE'N'                        B2                                 CRE007
     C                     MOVELERRM,13   ERMSG                                               CRE007
     C                     SETON                     8250                                     CRE007
     C                     END                             E2                                 CRE007
     C                     END                             E1                                 CRE007
     C*                                                                                       CRE007
     C                     ENDSR                                                              CRE007
      /EJECT
     C*
     C*****************************************************************
     C*****************************************************************
     C*                                                               *
     C*   INSER2 - PROCESS INSERT SECOND SCREEN                       *
     C*                                                               *
     C*   CALLED BY  :  INSERI                                        *
     C*                                                               *
     C*   CALLS      :  VALID3
     C*                                                               *
     C*****************************************************************
     C*
     C           INSER2    BEGSR
     C*
     C** DISPLAY AND VALIDATE SECOND SCREEN
     C*
     C           *INKC     DOWEQ'0'                        B1
     C           *INKL     ANDEQ'0'                        B1
     C*
     C** DISPLAY THE FIRST SCREEN
     C*                                                                                       CRE007
     C** If Account Type Holder is R ensure Tax Indicator field is still                      CRE007
     C** protected.                                                                           CRE007
     C           PACHLR    IFEQ 'R'                                                           CRE007
     C                     MOVE '1'       *IN83                                               CRE007
     C                     ENDIF                                                              CRE007
     C*
     C                     WRITESD2464F4                   *1
     C                     EXFMTSD2464F3                   *1
     C*
     C** IF CMD/3 PRESSED EXIT
     C*
     C           *INKC     IFEQ '1'                        B*2
     C                     MOVEL'PREV   ' PRETC            **2
     C                     ELSE                            X*2
     C*
     C** BLANK OUT ERRORS & RETURN TO PREVIOUS SCREEN IF CMD/12 PRESSED
     C*
     C           *INKL     IFEQ '1'                        B**3
     C                     MOVE *BLANKS   ERRCDE           ***3
     C                     MOVEA*BLANKS   ERR              ***3
     C                     Z-ADD1         X                ***3
     C                     SETOF                     505152***3
     C                     SETOF                     535455***3
     C                     SETOF                     565758***3
     C                     SETOF                     596061***3
     C                     SETOF                     626364***3
     C                     SETOF                     656667***3
     C                     SETOF                     686970***3
     C                     SETOF                     717273***3
     C                     SETOF                     747576***3
     C                     SETOF                     777879***3
     C                     SETOF                     80    ***3
     C                     SETOF                     82    ***3                               CRE007
     C                     ELSE                            X**3
     C*
     C** ENTER PRESSED VALIDATE SECOND SCREEN
     C*
     C                     EXSR VALID3
     C           *IN50     IFEQ '0'                        B***4
     C*
     C** IF NO ERRORS
     C** SET UP PARTY PARAMETERS WITH SCREEN DETAILS AND RETURN
     C*
     C                     MOVE DETAI3    PP3DET           ****4
     C                     MOVE DETAI4    PP4DET           ****4
     C                     MOVE DETAI5    PP5DET           ****4
     C                     MOVE SAXIND    PTAXIN           ****4
     C                     MOVE '1'       *INKC            ****4
     C                     END                             E***4
     C*
     C                     END                             E**3
     C                     END                             E*2
     C                     END                             E1
     C*
     C                     MOVE '0'       *INKL
     C*
     C                     ENDSR
     C*
     C*
      /EJECT
     C*
     C*****************************************************************
     C*                                                               *
     C*   AMEND2 - PROCESS AMEND SECOND SCREEN                        *
     C*                                                               *
     C*   CALLED BY  :  AMENI1                                        *
     C*                                                               *
     C*   CALLS      :  VALID3
     C*                                                               *
     C*****************************************************************
     C*
     C           AMEND2    BEGSR
     C*
     C** DISPLAY AND VALIDATE SECOND SCREEN
     C*
     C                     MOVE '0'       *IN03
     C           *INKC     DOWEQ'0'                        B1
     C           *INKL     ANDEQ'0'                        B1
     C*
     C** DISPLAY THE SECOND SCREEN
     C*
     C                     WRITESD2464F4                   *1
     C                     EXFMTSD2464F3                   *1
     C*
     C** IF CMD/3 PRESSED EXIT
     C*
     C           *INKC     IFEQ '1'                        B*2
     C                     MOVEL'PREV   ' PRETC            **2
     C                     ELSE                            X*2
     C*
     C** BLANK OUT ERRORS & RETURN TO PREVIOUS SCREEN IF CMD/12 PRESSED
     C*
     C           *INKL     IFEQ '1'                        B**3
     C                     MOVE *BLANKS   ERRCDE           ***3
     C                     MOVEA*BLANKS   ERR              ***3
     C                     Z-ADD1         X                ***3
     C                     SETOF                     505152***3
     C                     SETOF                     535455***3
     C                     SETOF                     565758***3
     C                     SETOF                     596061***3
     C                     SETOF                     626364***3
     C                     SETOF                     656667***3
     C                     SETOF                     686970***3
     C                     SETOF                     717273***3
     C                     SETOF                     747576***3
     C                     SETOF                     777879***3
     C                     SETOF                     80    ***3
     C                     SETOF                     82    ***3                               CRE007
     C                     ELSE                            X**3
     C*
     C** ENTER PRESSED VALIDATE SECOND SCREEN
     C*
     C                     EXSR VALID3
     C*
     C** IF NO ERRORS
     C*
     C           *IN50     IFEQ '0'                        B***4
     C*
     C** IF TAX INDICATOR CHANGED TO 'P' SEND MSG TO USER.
     C*
     C           TAXIND    IFNE SAXIND                     B****5
     C           SAXIND    ANDEQ'P'                        *****5
     C                     MOVELERRM,2    ERMSG            *****5
     C                     END                             E****5
      *
     C           ERMSG     IFNE *BLANKS                    B****5
     C           ERRCDE    ORNE *BLANKS                    *****5
     C                     MOVE '1'       *IN09            *****5
     C                     MOVE '1'       *IN20            *****5
     C*
     C                     WRITESD2464F2                   *****5
     C                     EXFMTSD2464F4                   *****5
     C                     MOVE '0'       *IN09            *****5
     C                     MOVE '0'       *IN20            *****5
     C                     END                             E****5
     C*
     C** SET UP PARTY PARAMETERS WITH SCREEN DETAILS AND RETURN
     C*
     C                     MOVE DETAI3    PP3DET           ****4
     C                     MOVE DETAI4    PP4DET           ****4
     C                     MOVE DETAI5    PP5DET           ****4
     C                     MOVE SAXIND    PTAXIN           ****4
     C**
     C                     EXSR CHKP
     C**
     C                     MOVEAPSTS      PPSTS
     C*
     C                     END                             E***4
     C                     END                             E**3
     C                     END                             E*2
     C                     END                             E1
     C*
     C** RESET CMD/12 TO PREVENT PROGRAM FROM GOING BACK TOO FAR.
     C*
     C                     MOVE '0'       *INKL
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C*
      /EJECT
      *****************************************************************
      *                                                               *
      *   CHKP - TEST WHETHER PARTIES HAVE BEEN CHANGED               *
      *                                                               *
      *   CALLED BY  :  AMENI2, AMENJ1, AMENJ2, TAXIN, AMEND2.        *
      *                                                               *
      *   CALLS      :  NO OTHER SR.                                  *
      *                                                               *
      *****************************************************************
      *
     C           CHKP      BEGSR
      *
      ** MOVE NEW PARTY NAMES INTO ARRAY ANEW
      *
     C                     MOVEAS1NAME    ANEW,1
     C                     MOVEAS2NAME    ANEW,2
     C                     MOVEAS3NAME    ANEW,3
     C                     MOVEAS4NAME    ANEW,4
     C                     MOVEAS5NAME    ANEW,5
      *
      ** INITIALISE PARTY STATUS ARRAYS
      *
     C                     MOVEA'NNNNN'   PSTS
     C                     MOVEA'NNNNN'   SPST
     C                     Z-ADD1         Z       20
     C                     Z-ADD42        IN      20
      *
      ** FOR EACH PARTY CHECK IF IT WAS A PARTY PREVIOUSLY
      ** BY CHECKING IF THE NAME EXISTS IN THE OLD NAMES ARRAY.
      *
     C           Z         DOUEQ6                          B1
     C                     MOVEAANEW,Z    NEW    23
      *
      ** IF NOT BLANK NOW ...
      *
     C           NEW       IFNE *BLANK                     B2
      *
      ** AND NOT BLANK BEFORE.
      *
     C           AOLD,Z    IFNE *BLANK                     B3
     C           NEW       LOKUPAOLD                     86
      *
      ** IF A NEW NAME DISPLAY MESSAGE 'IS THIS A NEW PARTICIPANT ? '
      ** UNTIL Y OR N ENTERED
      *
     C           *IN86     IFEQ '0'                        B4
     C                     MOVE '1'       *IN,IN
     C                     MOVE '1'       *IN09
      *
     C           SPST,Z    DOUEQ'Y'                        B5
     C           SPST,Z    OREQ 'N'                         5
     C                     WRITESD2464F1
     C                     WRITESD2464F4
     C           Z         IFLT 3                          B6
     C                     EXFMTSD2464F2
     C                     ELSE                            X6
     C                     EXFMTSD2464F3
     C                     END                             E6
     C                     END                             E5
      *
     C                     MOVE '0'       *IN20
     C                     MOVE '0'       *IN09
     C                     MOVE '0'       *IN,IN
      *
      ** STORE SCREEN VALUE IN PARAMETER
      *
     C                     MOVEASPST,Z    PSTS,Z
     C                     END                             E4
      *
      ** IF OLD PARTY NAME WAS BLANK SET PARTY STATUS TO 'Y' TO
      ** SHOW THIS IS A NEW PARTY.
      *
     C                     ELSE                            X3
     C                     MOVE 'Y'       PSTS,Z
     C                     END                             E3
      *
      ** IF NEW PARTY NAME IS BLANK SET PARTY STATUS TO BLANK
      *
     C                     ELSE                            X2
     C                     MOVE *BLANK    PSTS,Z
     C                     END                             E2
      *
     C                     ADD  1         Z
     C                     ADD  1         IN
     C                     END                             E1
      *
     C                     ENDSR
      *
     C********************************************************************
      /EJECT
      *****************************************************************
      *                                                               *
      *   UPDFLS - UPDATE SDCBRTPD AND PTYHSTPD FILES                 *
      *                                                               *
      *   CALLED BY  :  MAIN                                          *
      *                                                               *
      *   CALLS      :  CHKPRT                                        *
      *                                                               *
      *****************************************************************
      *
     C           UPDFLS    BEGSR
     C*
     C*  IF A/C HOLDER TYPE IS NOW 'B' 'C' 'N' OR 'O' SET TAXABLE INDICATOR
     C*
     C           PACHLR    IFEQ 'B'
     C           PACHLR    OREQ 'C'
     C                     MOVEL'N'       PTAXIN
     C                     ELSE
     C           PACHLR    IFEQ 'N'
     C           PACHLR    OREQ 'O'
     C                     MOVEL'X'       PTAXIN
     C                     END
     C                     END
     C*
     C**  Chain to SDCBRTDX using entry parameters
     C*
     C           XCNUM     CHAINSDCBRTDX             90
     C           PACTN     IFEQ 'D'
     C                     MOVE 'C'       XRECI
     C                     ELSE
     C                     MOVE 'D'       XRECI
     C                     END
     C                     MOVE BJRDNB    XLCD
     C                     MOVE PACTN     XCHTP
     C**
     C** A M E N D
     C**
     C           PACTN     IFEQ 'A'
     C                     Z-ADDNXASQN    AVASQN
     C                     Z-ADD0         NEWNOP  10
     C**
     C           PSTS1     IFNE *BLANKS
     C                     MOVE PT1TTL    TITLE   4
     C                     MOVE PT1NME    NAME   23
     C                     MOVE PT1INT    INITL   3
     C                     MOVE PT1AD1    ADR1   28
     C                     MOVE PT1AD2    ADR2   28
     C                     MOVE PT1AD3    ADR3   28
     C                     MOVE PT1PC1    PCD1    4
     C                     MOVE PT1PC2    PCD2    3
     C                     MOVE PT1NIN    NINO    9
     C                     MOVE NEWDB1    DOB     60
     C                     MOVE PSTS1     PARSTS  1
     C                     MOVE OLDBR1    OLDBRT  1
     C                     MOVE NEWBR1    NEWBRT  1
     C                     MOVE NEWSQ1    SEQN    20
     C                     EXSR CHKPRT
     C                     MOVE SEQN      NEWSQ1
     C                     ADD  1         NEWNOP
     C                     END
     C**
     C           PSTS2     IFNE *BLANKS
     C                     MOVE PT2TTL    TITLE
     C                     MOVE PT2NME    NAME
     C                     MOVE PT2INT    INITL
     C                     MOVE PT2AD1    ADR1
     C                     MOVE PT2AD2    ADR2
     C                     MOVE PT2AD3    ADR3
     C                     MOVE PT2PC1    PCD1
     C                     MOVE PT2PC2    PCD2
     C                     MOVE PT2NIN    NINO
     C                     MOVE NEWDB2    DOB
     C                     MOVE PSTS2     PARSTS
     C                     MOVE OLDBR2    OLDBRT
     C                     MOVE NEWBR2    NEWBRT
     C                     MOVE NEWSQ2    SEQN
     C                     EXSR CHKPRT
     C                     MOVE SEQN      NEWSQ2
     C                     ADD  1         NEWNOP
     C                     END
     C**
     C           PSTS3     IFNE *BLANKS
     C                     MOVE PT3TTL    TITLE
     C                     MOVE PT3NME    NAME
     C                     MOVE PT3INT    INITL
     C                     MOVE PT3AD1    ADR1
     C                     MOVE PT3AD2    ADR2
     C                     MOVE PT3AD3    ADR3
     C                     MOVE PT3PC1    PCD1
     C                     MOVE PT3PC2    PCD2
     C                     MOVE PT3NIN    NINO
     C                     MOVE NEWDB3    DOB
     C                     MOVE PSTS3     PARSTS
     C                     MOVE OLDBR3    OLDBRT
     C                     MOVE NEWBR3    NEWBRT
     C                     MOVE NEWSQ3    SEQN
     C                     EXSR CHKPRT
     C                     MOVE SEQN      NEWSQ3
     C                     ADD  1         NEWNOP
     C                     END
     C**
     C           PSTS4     IFNE *BLANKS
     C                     MOVE PT4TTL    TITLE
     C                     MOVE PT4NME    NAME
     C                     MOVE PT4INT    INITL
     C                     MOVE PT4AD1    ADR1
     C                     MOVE PT4AD2    ADR2
     C                     MOVE PT4AD3    ADR3
     C                     MOVE PT4PC1    PCD1
     C                     MOVE PT4PC2    PCD2
     C                     MOVE PT4NIN    NINO
     C                     MOVE NEWDB4    DOB
     C                     MOVE PSTS4     PARSTS
     C                     MOVE OLDBR4    OLDBRT
     C                     MOVE NEWBR4    NEWBRT
     C                     MOVE NEWSQ4    SEQN
     C                     EXSR CHKPRT
     C                     MOVE SEQN      NEWSQ4
     C                     ADD  1         NEWNOP
     C                     END
     C**
     C           PSTS5     IFNE *BLANKS
     C                     MOVE PT5TTL    TITLE
     C                     MOVE PT5NME    NAME
     C                     MOVE PT5INT    INITL
     C                     MOVE PT5AD1    ADR1
     C                     MOVE PT5AD2    ADR2
     C                     MOVE PT5AD3    ADR3
     C                     MOVE PT5PC1    PCD1
     C                     MOVE PT5PC2    PCD2
     C                     MOVE PT5NIN    NINO
     C                     MOVE NEWDB5    DOB
     C                     MOVE PSTS5     PARSTS
     C                     MOVE OLDBR5    OLDBRT
     C                     MOVE NEWBR5    NEWBRT
     C                     MOVE NEWSQ5    SEQN
     C                     EXSR CHKPRT
     C                     MOVE SEQN      NEWSQ5
     C                     ADD  1         NEWNOP
     C                     END
      *                                                                   096730
      * If a/c holder type changed to B/C/N/O check if need to display    096730
      * warning msg 'Interest adjustment required....'                    096730
     C           PACHLR    IFNE 'I'                                       096730
     C           PACHLR    ORNE 'J'                                       096730
     C                     MOVE 'N'       NEWBRT                          096730
     C                     EXSR BRTFL                                     096730
     C           INADJR    IFEQ 'Y'                                       096730
     C                     MOVE PCNUM     SCNUM                           096730
     C                     MOVE PACHLR    SCHLRT                          096730
     C                     MOVE PACTN     SACTN                           096730
     C                     SETON                     0406                 096730
     C                     END                                            096730
     C                     END                                            096730
     C                     END
     C**
     C** I N S E R T
     C**
     C           PACTN     IFEQ 'I'
     C                     Z-ADD1         AVASQN  20
     C                     MOVEA*BLANKS   LFLG
     C                     Z-ADD*ZEROS    EFLD
     C                     Z-ADD*ZEROS    LCHD
     C                     MOVE BJRDNB    XPLCD
     C                     MOVE PACTN     XPCHTP
     C**
     C           PP1DET    IFNE *BLANKS
     C                     MOVE PT1TTL    PTTITL
     C                     MOVE PT1NME    PTNAME
     C                     MOVE PT1INT    PTINIT
     C                     MOVE PT1AD1    PTADR1
     C                     MOVE PT1AD2    PTADR2
     C                     MOVE PT1AD3    PTADR3
     C                     MOVE PT1PC1    PTPCD1
     C                     MOVE PT1PC2    PTPCD2
     C                     MOVE PT1NIN    PTNINO
     C                     MOVE NEWDB1    PTDOB
     C                     MOVE AVASQN    NEWSQ1
     C                     MOVE NEWSQ1    PTYSQN
     C                     ADD  1         AVASQN
     C                     MOVEANEWBR1    LFLG,1
     C                     Z-ADDAPR6CY    EFLD,1
     C                     Z-ADDBJRDNB    LCHD,1
     C                     WRITEPTYHSTF
     C                     END
     C**
     C           PP2DET    IFNE *BLANKS
     C                     MOVE PT2TTL    PTTITL
     C                     MOVE PT2NME    PTNAME
     C                     MOVE PT2INT    PTINIT
     C                     MOVE PT2AD1    PTADR1
     C                     MOVE PT2AD2    PTADR2
     C                     MOVE PT2AD3    PTADR3
     C                     MOVE PT2PC1    PTPCD1
     C                     MOVE PT2PC2    PTPCD2
     C                     MOVE PT2NIN    PTNINO
     C                     MOVE NEWDB2    PTDOB
     C                     MOVE AVASQN    NEWSQ2
     C                     MOVE NEWSQ2    PTYSQN
     C                     ADD  1         AVASQN
     C                     MOVEANEWBR2    LFLG,1
     C                     Z-ADDAPR6CY    EFLD,1
     C                     Z-ADDBJRDNB    LCHD,1
     C                     WRITEPTYHSTF
     C                     END
     C**
     C           PP3DET    IFNE *BLANKS
     C                     MOVE PT3TTL    PTTITL
     C                     MOVE PT3NME    PTNAME
     C                     MOVE PT3INT    PTINIT
     C                     MOVE PT3AD1    PTADR1
     C                     MOVE PT3AD2    PTADR2
     C                     MOVE PT3AD3    PTADR3
     C                     MOVE PT3PC1    PTPCD1
     C                     MOVE PT3PC2    PTPCD2
     C                     MOVE PT3NIN    PTNINO
     C                     MOVE NEWDB3    PTDOB
     C                     MOVE AVASQN    NEWSQ3
     C                     MOVE NEWSQ3    PTYSQN
     C                     ADD  1         AVASQN
     C                     MOVEANEWBR3    LFLG,1
     C                     Z-ADDAPR6CY    EFLD,1
     C                     Z-ADDBJRDNB    LCHD,1
     C                     WRITEPTYHSTF
     C                     END
     C**
     C           PP4DET    IFNE *BLANKS
     C                     MOVE PT4TTL    PTTITL
     C                     MOVE PT4NME    PTNAME
     C                     MOVE PT4INT    PTINIT
     C                     MOVE PT4AD1    PTADR1
     C                     MOVE PT4AD2    PTADR2
     C                     MOVE PT4AD3    PTADR3
     C                     MOVE PT4PC1    PTPCD1
     C                     MOVE PT4PC2    PTPCD2
     C                     MOVE PT4NIN    PTNINO
     C                     MOVE NEWDB4    PTDOB
     C                     MOVE AVASQN    NEWSQ4
     C                     MOVE NEWSQ4    PTYSQN
     C                     ADD  1         AVASQN
     C                     MOVEANEWBR4    LFLG,1
     C                     Z-ADDAPR6CY    EFLD,1
     C                     Z-ADDBJRDNB    LCHD,1
     C                     WRITEPTYHSTF
     C                     END
     C**
     C           PP5DET    IFNE *BLANKS
     C                     MOVE PT5TTL    PTTITL
     C                     MOVE PT5NME    PTNAME
     C                     MOVE PT5INT    PTINIT
     C                     MOVE PT5AD1    PTADR1
     C                     MOVE PT5AD2    PTADR2
     C                     MOVE PT5AD3    PTADR3
     C                     MOVE PT5PC1    PTPCD1
     C                     MOVE PT5PC2    PTPCD2
     C                     MOVE PT5NIN    PTNINO
     C                     MOVE NEWDB5    PTDOB
     C                     MOVE AVASQN    NEWSQ5
     C                     MOVE NEWSQ5    PTYSQN
     C                     ADD  1         AVASQN
     C                     MOVEANEWBR5    LFLG,1
     C                     Z-ADDAPR6CY    EFLD,1
     C                     Z-ADDBJRDNB    LCHD,1
     C                     WRITEPTYHSTF
     C                     END
     C**
     C                     END
     C**
     C** I N S E R T   O R   A M E N D
     C**
     C           PACTN     IFEQ 'I'
     C           PACTN     OREQ 'A'
     C**
     C           NEWDB1    IFEQ *BLANKS
     C                     MOVE *ZEROS    NEWDB1
     C                     END
     C**
     C           NEWDB2    IFEQ *BLANKS
     C                     MOVE *ZEROS    NEWDB2
     C                     END
     C**
     C           NEWDB3    IFEQ *BLANKS
     C                     MOVE *ZEROS    NEWDB3
     C                     END
     C**
     C           NEWDB4    IFEQ *BLANKS
     C                     MOVE *ZEROS    NEWDB4
     C                     END
     C**
     C           NEWDB5    IFEQ *BLANKS
     C                     MOVE *ZEROS    NEWDB5
     C                     END
     C**
     C           NEWSQ1    IFEQ *BLANKS
     C                     MOVE *ZEROS    NEWSQ1
     C                     END
     C**
     C           NEWSQ2    IFEQ *BLANKS
     C                     MOVE *ZEROS    NEWSQ2
     C                     END
     C**
     C           NEWSQ3    IFEQ *BLANKS
     C                     MOVE *ZEROS    NEWSQ3
     C                     END
     C**
     C           NEWSQ4    IFEQ *BLANKS
     C                     MOVE *ZEROS    NEWSQ4
     C                     END
     C**
     C           NEWSQ5    IFEQ *BLANKS
     C                     MOVE *ZEROS    NEWSQ5
     C                     END
     C**
1770 C**   SET UP OUTPUT FIELDS FOR SDCBRTPD.
     C**
     C                     MOVE PP1DET    DET1
     C                     MOVE PP2DET    DET2
     C                     MOVE PP3DET    DET3
     C                     MOVE PP4DET    DET4
     C                     MOVE PP5DET    DET5
     C**
     C                     MOVE PTAXIN    TAXIND
     C                     MOVE PACHLR    ACHLRT
     C                     Z-ADDAVASQN    NXASQN
     C                     MOVELSPSTR     PSTR                                                CRE007
      *                                                                                       260405
      ** Check birthdate century  (BRT Customer Details)                                      260405
      *                                                                                       260405
     C           S1DOBN    IFNE *BLANKS                                                       260405
     C                     MOVELS1DOBN    #DDMM                                               260405
     C                     MOVE S1DOBN    #YY                                                 260405
     C           #YY       IFNE *BLANKS                                                       260405
      *                                                                                       260405
      ** Century exists.  Move century to file field.                                         260405
      *                                                                                       260405
     C                     MOVE S1DOBN    #YEAR                                               260405
     C                     MOVE #CC       H1DOBC                                              260405
      *                                                                                       260405
      ** Update field S1DOB                                                                   260405
      *                                                                                       260405
     C                     MOVEL#DDMM     W1DOBX  6                                           260405
     C                     MOVE #YY       W1DOBX                                              260405
     C                     MOVE W1DOBX    S1DOB                                               260405
     C                     ELSE                                                               260405
     C                     MOVELS1DOBN    S1DOB                                               260405
     C                     MOVE *BLANKS   H1DOBC                                              260405
     C                     ENDIF                                                              260405
     C                     MOVE S1DOB     H1DOB                                               260405
     C                     ELSE                                                               260405
     C                     MOVE *BLANKS   S1DOB                                               260405
     C                     MOVE *BLANKS   H1DOB                                               260405
     C                     MOVE *BLANKS   H1DOBC                                              260405
     C                     ENDIF                                                              260405
      *                                                                                       260405
     C           S2DOBN    IFNE *BLANKS                                                       260405
     C                     MOVELS2DOBN    #DDMM                                               260405
     C                     MOVE S2DOBN    #YY                                                 260405
     C           #YY       IFNE *BLANKS                                                       260405
      *                                                                                       260405
      ** Century exists.  Move century to file field.                                         260405
      *                                                                                       260405
     C                     MOVE S2DOBN    #YEAR                                               260405
     C                     MOVE #CC       H2DOBC                                              260405
      *                                                                                       260405
      ** Update field S2DOB                                                                   260405
      *                                                                                       260405
     C                     MOVEL#DDMM     W2DOBX  6                                           260405
     C                     MOVE #YY       W2DOBX                                              260405
     C                     MOVE W2DOBX    S2DOB                                               260405
     C                     ELSE                                                               260405
     C                     MOVELS2DOBN    S2DOB                                               260405
     C                     MOVE *BLANKS   H2DOBC                                              260405
     C                     ENDIF                                                              260405
     C                     MOVE S2DOB     H2DOB                                               260405
     C                     ELSE                                                               260405
     C                     MOVE *BLANKS   S2DOB                                               260405
     C                     MOVE *BLANKS   H2DOB                                               260405
     C                     MOVE *BLANKS   H2DOBC                                              260405
     C                     ENDIF                                                              260405
      *                                                                                       260405
     C           S3DOBN    IFNE *BLANKS                                                       260405
     C                     MOVELS3DOBN    #DDMM                                               260405
     C                     MOVE S3DOBN    #YY                                                 260405
     C           #YY       IFNE *BLANKS                                                       260405
      *                                                                                       260405
      ** Century exists.  Move century to file field.                                         260405
      *                                                                                       260405
     C                     MOVE S3DOBN    #YEAR                                               260405
     C                     MOVE #CC       H3DOBC                                              260405
      *                                                                                       260405
      ** Update field S3DOB                                                                   260405
      *                                                                                       260405
     C                     MOVEL#DDMM     W3DOBX  6                                           260405
     C                     MOVE #YY       W3DOBX                                              260405
     C                     MOVE W3DOBX    S3DOB                                               260405
     C                     ELSE                                                               260405
     C                     MOVELS3DOBN    S3DOB                                               260405
     C                     MOVE *BLANKS   H3DOBC                                              260405
     C                     ENDIF                                                              260405
     C                     MOVE S3DOB     H3DOB                                               260405
     C                     ELSE                                                               260405
     C                     MOVE *BLANKS   S3DOB                                               260405
     C                     MOVE *BLANKS   H3DOB                                               260405
     C                     MOVE *BLANKS   H3DOBC                                              260405
     C                     ENDIF                                                              260405
      *                                                                                       260405
     C           S4DOBN    IFNE *BLANKS                                                       260405
     C                     MOVELS4DOBN    #DDMM                                               260405
     C                     MOVE S4DOBN    #YY                                                 260405
     C           #YY       IFNE *BLANKS                                                       260405
      *                                                                                       260405
      ** Century exists.  Move century to file field.                                         260405
      *                                                                                       260405
     C                     MOVE S4DOBN    #YEAR                                               260405
     C                     MOVE #CC       H4DOBC                                              260405
      *                                                                                       260405
      ** Update field S4DOB                                                                   260405
      *                                                                                       260405
     C                     MOVEL#DDMM     W4DOBX  6                                           260405
     C                     MOVE #YY       W4DOBX                                              260405
     C                     MOVE W4DOBX    S4DOB                                               260405
     C                     ELSE                                                               260405
     C                     MOVELS4DOBN    S4DOB                                               260405
     C                     MOVE *BLANKS   H4DOBC                                              260405
     C                     ENDIF                                                              260405
     C                     MOVE S4DOB     H4DOB                                               260405
     C                     ELSE                                                               260405
     C                     MOVE *BLANKS   S4DOB                                               260405
     C                     MOVE *BLANKS   H4DOB                                               260405
     C                     MOVE *BLANKS   H4DOBC                                              260405
     C                     ENDIF                                                              260405
      *                                                                                       260405
     C           S5DOBN    IFNE *BLANKS                                                       260405
     C                     MOVELS5DOBN    #DDMM                                               260405
     C                     MOVE S5DOBN    #YY                                                 260405
     C           #YY       IFNE *BLANKS                                                       260405
      *                                                                                       260405
      ** Century exists.  Move century to file field.                                         260405
      *                                                                                       260405
     C                     MOVE S5DOBN    #YEAR                                               260405
     C                     MOVE #CC       H5DOBC                                              260405
      *                                                                                       260405
      ** Update field S5DOB                                                                   260405
      *                                                                                       260405
     C                     MOVEL#DDMM     W5DOBX  6                                           260405
     C                     MOVE #YY       W5DOBX                                              260405
     C                     MOVE W5DOBX    S5DOB                                               260405
     C                     ELSE                                                               260405
     C                     MOVELS5DOBN    S5DOB                                               260405
     C                     MOVE *BLANKS   H5DOBC                                              260405
     C                     ENDIF                                                              260405
     C                     MOVE S5DOB     H5DOB                                               260405
     C                     ELSE                                                               260405
     C                     MOVE *BLANKS   S5DOB                                               260405
     C                     MOVE *BLANKS   H5DOB                                               260405
     C                     MOVE *BLANKS   H5DOBC                                              260405
     C                     ENDIF                                                              260405
     C**
     C**  SET UP ACCOUNT CHANGE DATE
     C**  IF INSERT
     C**
     C           PACTN     IFEQ 'I'
     C                     Z-ADD0         ACHCGD
     C                     ELSE
     C**  IF AMEND
     C           PSTS1     IFEQ 'Y'
     C           PSTS2     OREQ 'Y'
     C           PSTS3     OREQ 'Y'
     C           PSTS4     OREQ 'Y'
     C           PSTS5     OREQ 'Y'
     C                     Z-ADDBJRDNB    ACHCGD
     C                     ELSE
     C           OLDNOP    IFNE NEWNOP
     C                     Z-ADDBJRDNB    ACHCGD
     C                     END
     C                     END
     C                     END
     C**
     C                     END
     C*
     C* UPDATE OR WRITE TO SDCBRTDX
     C*
     C           *IN90     IFEQ '0'
     C                     UPDATSDCBRTDX
     C                     ELSE
     C                     WRITESDCBRTDX
     C                     END
     C                     ENDSR
     C********************************************************************
      /EJECT
      **********************************************************************
      *                                                                    *
      *   CHKPRT-CHECK PARTICIPATOR HISTORY FILE AND UPDATE IT ACCORDINGLY *
      *                                                                    *
      *   CALLED BY  :  UPDFLS                                             *
      *                                                                    *
      *   CALLS      :  NO OTHER SR.                                       *
      *                                                                    *
      **********************************************************************
      *
     C           CHKPRT    BEGSR
     C**
     C**  SET UP KEY LISTS TO CHAIN TO INTEREST PAYMENT HISTORY FILE
     C**  AND THE PARTICIPATOR HISTORY FILE
     C**
     C           INTKEY    KLIST
     C                     KFLD           XCNUM
     C                     KFLD           KDATE   50
     C**
     C           PTYKEY    KLIST
     C                     KFLD           XCNUM
     C                     KFLD           SEQN
      *                                                                   090634
      * Initialise 'update' flag                                          090634
     C                     MOVEL'N'       @UPDFL  1                       090634
     C**
     C           PTYKEY    CHAINPTYHSTF              89
     C**
     C**  IF THE PARTY STATUS IS 'Y' I.E THE PARTY IS NEW
     C**  ADD A NEW RECORD TO THE PARTICIPATOR HISTORY FILE.
     C**
     C           PARSTS    IFEQ 'Y'                        B1
     C                     MOVE TITLE     PTTITL
     C                     MOVE NAME      PTNAME
     C                     MOVE INITL     PTINIT
     C                     MOVE ADR1      PTADR1
     C                     MOVE ADR2      PTADR2
     C                     MOVE ADR3      PTADR3
     C                     MOVE PCD1      PTPCD1
     C                     MOVE PCD2      PTPCD2
     C                     MOVE NINO      PTNINO
     C                     MOVE DOB       PTDOB
     C                     MOVEA*BLANKS   LFLG
     C                     Z-ADD*ZEROS    EFLD
     C                     Z-ADD*ZEROS    LCHD
     C                     Z-ADDAVASQN    PTYSQN
     C                     Z-ADDPTYSQN    SEQN
     C                     ADD  1         AVASQN
     C                     Z-ADDBJRDNB    LCHD,1
     C                     MOVEANEWBRT    LFLG,1
     C**
     C                     EXSR BRTFL
     C                     Z-ADDEFF       EFLD,1
     C                     MOVE BJRDNB    XPLCD
     C                     MOVE PACTN     XPCHTP
     C                     WRITEPTYHSTF
     C                     Z-ADDAVASQN    NXASQN
     C                     Z-ADDBJRDNB    ACHCGD
     C**
     C**  IF THE PARTY STATUS IS 'N'
     C**
     C                     ELSE                            X1
     C**
     C**  IF THE BRT LIABLE FLAG HAS CHANGED CALCULATE THE DATE
     C**  FROM WHICH THE NEW VALUE IS TO BE EFFECTIVE.
     C**
     C           OLDBRT    IFNE NEWBRT                     B*2
     C                     EXSR BRTFL
     C**
     C**  IF THE EFFECTIVE DATE IS THE SAME AS AN EXISTING DATE
     C**  IN THE EFFECTIVE DATE ARRAY.
     C**
     C                     Z-ADD1         Z       20
     C           EFF       LOKUPEFLD,Z                   89
     C**
     C           *IN89     IFEQ '1'                        B**3
     C**
     C**  CHECK IF ANY INTEREST PAYMENTS HAVE BEEN MADE BETWEEN THE
     C**  EFFECTIVE DATE AND TODAY'S DATE.
     C**
     C                     Z-ADDEFF       KDATE
     C           INTKEY    SETLLINTPSL6
     C                     READ INTPSL6                  89
     C**
     C           *IN89     IFEQ '0'                        B***4
     C           XCNUM     ANDEQCNUML6
     C           IPDT      ANDLTBJRDNB
     C           IPDT      ANDGEEFF
     C**
     C**  IF PAYMENTS MADE THE NEXT AVAILABLE ARRAY ELEMENTS ARE
     C**  UPDATED WITH THE NEW DATA.
     C**
     C                     Z-ADD1         W       20
     C           *BLANKS   LOKUPLFLG,W                   89
     C**
     C                     MOVEANEWBRT    LFLG,W
     C                     Z-ADDEFF       EFLD,W
     C                     Z-ADDBJRDNB    LCHD,W
     C**
     C**  IF NO PAYMENTS HAVE BEEN MADE THEN THE CURRENT ELEMENT
     C**  IS OVERWRITTEN AND ALL SUBSEQUENT ELEMENTS ARE CLEARED.
     C**
     C                     ELSE                            X***4
     C                     MOVEANEWBRT    LFLG,Z
     C                     Z-ADDEFF       EFLD,Z
     C                     Z-ADDBJRDNB    LCHD,Z
     C**
     C           Z         DOUEQ10                         B****5
     C                     ADD  1         Z
     C                     MOVEA*BLANKS   LFLG,Z
     C                     Z-ADD*ZEROS    EFLD,Z
     C                     Z-ADD*ZEROS    LCHD,Z
     C                     END                             E****5
     C**
     C                     END                             E***4
     C**
     C**  IF EFFECTIVE DATE DOES NOT MATCH AN EXISTING EFFECTIVE DATE
     C**  UPDATE THE NEXT ARRAY ELEMENTS WITH THE NEW DATA.
     C**
     C                     ELSE                            X**3
     C                     Z-ADD1         W
     C           *BLANKS   LOKUPLFLG,W                   89
     C**
     C                     MOVEANEWBRT    LFLG,W
     C                     Z-ADDEFF       EFLD,W
     C                     Z-ADDBJRDNB    LCHD,W
     C                     END                             E**3
      *                                                                   090634
      * Set 'update' flag so that file is updated                         090634
     C                     MOVEL'Y'       @UPDFL                          090634
     C                     ENDIF                           E*2            090634
      *                                                                   090634
      * If update flag is not set, check for change in personal details   090634
     C           @UPDFL    IFEQ 'N'                        B*2            090634
     C           TITLE     IFNE PTTITL                     B**3           090634
     C           NAME      ORNE PTNAME                                    090634
     C           INITL     ORNE PTINIT                                    090634
     C           ADR1      ORNE PTADR1                                    090634
     C           ADR2      ORNE PTADR2                                    090634
     C           ADR3      ORNE PTADR3                                    090634
     C           PCD1      ORNE PTPCD1                                    090634
     C           PCD2      ORNE PTPCD2                                    090634
     C           NINO      ORNE PTNINO                                    090634
     C           DOB       ORNE PTDOB                                     090634
     C                     MOVEL'Y'       @UPDFL                          090634
     C                     ENDIF                           E**3           090634
     C                     ENDIF                           E*2            090634
      *                                                                   090634
      * Update file if flag set                                           090634
     C           @UPDFL    IFEQ 'Y'                        B*2            090634
      *                                                                   090634
      * Update personal details with latest values                        090634
     C                     MOVE TITLE     PTTITL                          090634
     C                     MOVE NAME      PTNAME                          090634
     C                     MOVE INITL     PTINIT                          090634
     C                     MOVE ADR1      PTADR1                          090634
     C                     MOVE ADR2      PTADR2                          090634
     C                     MOVE ADR3      PTADR3                          090634
     C                     MOVE PCD1      PTPCD1                          090634
     C                     MOVE PCD2      PTPCD2                          090634
     C                     MOVE NINO      PTNINO                          090634
     C                     MOVE DOB       PTDOB                           090634
     C**
     C**  UPDATE PARTICIPATOR HISTORY FILE.
     C**
     C                     MOVE BJRDNB    XPLCD
     C                     MOVE PACTN     XPCHTP
     C                     UPDATPTYHSTF
     C**
     C                     END                             E*2
     C**
     C                     END                             E1
     C                     ENDSR
      **********************************************************************
      *                                                                    *
      *   BRTFL - TO CALCULATE THE EFFECTIVE DATE DEPENDING                *
      *           ON THE BRT LIABLE FLAG FOR THE PARTICIPANT.              *0213
      *                                                                    *
      *   CALLED BY  :  CHKPRT                                             *
      *                                                                    *
      *   CALLS      :  NO OTHER SR.                                       *
      *                                                                    *
      **********************************************************************
     C           BRTFL     BEGSR
     C**
     C**  SET DEFAULT EFFECTIVE DATE TO APRIL 6TH OF CURRENT TAX YEAR
     C**
     C                     Z-ADDAPR6CY    EFF     50
     C**
     C**  IF THE BRT IS 'N' AND A S352 STATEMENT HAS BEEN PRODUCED
     C**  EFFECTIVE DATE WILL BE SET TO THE LAST INTEREST DATE
     C**  PAYMENT ON THE INTEREST PAYMENT HISTORY FILE.
     C**
     C           NEWBRT    IFEQ 'N'                        B1
     C                     Z-ADD99999     KDATE
     C           INTKEY    SETGTINTPSL7
     C                     READPINTPSL7                  89
     C**
     C           *IN89     IFEQ '0'                        B*2
     C           XCNUM     ANDEQCNUML7
     C**
     C                     Z-ADDIPDT      EFF
     C**
     C**  IF NO S352 STATEMENT HAS BEEN PRODUCED THE EFFECTIVE DATE
     C**  WILL BE SET TO APRIL 6TH OF THE CURRENT TAX YEAR.
     C**
     C                     ELSE                            X*2
     C                     Z-ADDAPR6CY    EFF
     C                     Z-ADD00000     KDATE
     C           INTKEY    SETLLINTPSL8
     C                     READ INTPSL8                  89
     C**
     C           *IN89     IFEQ '0'                        B**3
     C           XCNUM     ANDEQCNUML8
     C                     Z-ADDAPR6CY    EFF
     C**
     C**  IF ANY INTEREST PAYMENTS HAVE BEEN MADE IN THE CURRENT TAX
     C**  YEAR, SEND MESSAGE 'INTEREST ADJUSTMENT ....'
     C**
     C           IPDT      IFGE APR6CY                     B***4
     C                     MOVEL'Y'       INADJR  1
     C                     END                             E***4
     C**
     C                     END                             E**3
     C**
     C                     END                             E*2
     C**
     C**  IF THE BRT IS 'Y' OR 'X' THE EFFECTIVE DATE WILL BE SET TO
     C**  THE LAST INTEREST PAYMENT DATE ON THE INTEREST PAYMENT
     C**  HISTORY FILE. IF THERE HAVE BEEN NO INTEREST PAYMENTS
     C**  FOR THIS ACCOUNT IN THE CURRENT TAX YEAR THE EFFECTIVE
     C**  DATE WILL BE SET TO APRIL 6TH OF THE CURRENT TAX YEAR.
     C**
     C                     ELSE                            X1
     C                     Z-ADD99999     KDATE
     C           INTKEY    SETGTINTPSL6
     C                     READPINTPSL6                  89
     C**
     C           *IN89     IFEQ '0'                        B*2
     C           XCNUM     ANDEQCNUML6
     C                     Z-ADDIPDT      EFF
     C                     ELSE                            X*2
     C                     Z-ADDAPR6CY    EFF
     C                     END                             E*2
     C**
     C                     END                             E1
     C**
     C                     ENDSR
     C********************************************************************
      /EJECT
     C********************************************************************
      /COPY ZSRSRC,ZDATE1Z2
      /COPY ZSRSRC,ZDATE2Z2
     C********************************************************************
      /EJECT
**   ERRM - ERROR MESSAGES
FURTHER PARTY DETAILS PRESENT - PRESS ENTER TO IGNORE, CMD/18 TO RETURN
S352 STATEMENTS SHOULD BE REQUESTED FOR ALL ACCOUNTS/DEALS - PRESS ENTER
TWO PARTIES MUST EXIST FOR ACCOUNT HOLDER TYPE J
NO. OF PARTIES NOT ALLOWED FOR ACCOUNT HOLDER TYPE I
INTEREST ADJUSTMENT REQUIRED TO REFUND BRT ALREADY DEDUCTED
NO. OF PARTIES NOT ALLOWED FOR ACCOUNT HOLDER TYPE R                                          CRE007
TAX IND MUST BE 'N' IF A/C HOLDER TYPE IS R                                                   CRE007
VALUE MUST BE S OR BLANK IN POST 5/4/01 FIELD AS A/C HOLDER IS I OR J                         CRE007
VALUE MUST BE X OR N IF ACCOUNT HOLDER TYPE IS R                                              CRE007
VALUE MUST BE N IF ACCOUNT HOLDER TYPE IS R & NO FURTHER PARTIES                              CRE007
VALUE MUST BE Y, N OR BLANK                                                                   CRE007
ONE PARTY MUST HAVE BRT LIABLE CODE OF N AS A/C HOLDER IS R                                   CRE007
VALUE MUST BE Y OR N IN POST 5/4/01 FIELD AS A/C HOLDER IS R                                  CRE007
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
