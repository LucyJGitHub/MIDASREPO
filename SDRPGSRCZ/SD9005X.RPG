     H        1   Y
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas SD Initialise ICD records')                      *
      *****************************************************************
      *                                                               *
      *  Midas - Standing Data Module                                 *
      *                                                               *
      *  SD9005X - Initialise ICD Records.                            *
      *                                                               *
      *  Function:  This program initialises the ICD records.         *
      *                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
      *                                                               *
      *  Last Amend No. MD030956           Date 09Oct14               *
      *  Prev Amend No. CLE134             Date 01Aug12               *
      *                 207288             Date 11Jul12               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 BUG12434           Date 15Nov06               *
      *                 CSD027             Date 09Dec05               *
      *                 CDL038             Date 10May05               *
      *                 CPK022             Date 05Jul05               *
      *                 BUG3644            Date 12Jul04               *
      *                 BUG4544            Date 19Oct04               *
      *                 CFX001             Date 20Oct03               *
      *                 CGL014             Date 20Oct03               *
      *                 CLE025             Date 20Oct03               *
      *                 CGP001             Date 04Jan03               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CSD011             Date 04Mar02               *
      *                 CAS001             Date 23Nov01               *
      *                 CRT005             Date 09Aug01               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 CSD006             Date 30Nov01               *
      *                 CRT006             Date 17Apr01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CFT009             Date 30May00               *
      *                 CTI003             Date 12Mar01               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 CSD009             Date 10Oct00               *
      * Midas DBA 3.03 -----------------------------------------------*
      * Midas DBA 3.02 -----------------------------------------------*
      *                 167480             Date 18Jan00               *
      *                 CAP032             Date 26Apr99               *
      *                 CTI099             Date 05Jul99               *
      *                 CPB001             Date 11Jun99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CPL002             DATE 08MAR99               *
      *                 CAP006             DATE 12FEB99               *
      *                 CTI002             DATE 23SEP98               *
      *                 CAP002             DATE 29MAY98               *
      *                 110533             DATE 29OCT97               *
      *                 CSD003             Date 27OCT97               *
      *                 CTI001             Date 25JUL97               *
      *                 118932             Date 12JUN97               *
      *                 CPL002             Date 19MAR97               *
      *                 CFF003             Date 10MAR97               *
      *                 CSW009             Date 28FEB97               *
      *                 096179             Date 26FEB97               *
      *                 CLE004             Date 19FEB97               *
      *                 CGL004             Date 05FEB97               *
      *                 CDL002             Date 01FEB97               *
      *                 CSW005             Date 06NOV96               *
      *                 CAC002             DATE 25OCT96               *
      *                 CRT003             DATE 04OCT96               *
      *                 CRT002             DATE 04OCT96               *
      *                 CPM005             DATE 09JUL96               *
      *                 101971             DATE 22APR96               *
      *                 100025             DATE 26FEB96               *
      *                 099942             DATE 23FEB96               *
      *                 CPM004             DATE 19FEB96               *
      *                 S01408             DATE 15FEB96               *
      *                 CAC001             DATE 09FEB96
      *                 CCM002             DATE 10AUG95               *
      *                 091573             DATE 08AUG95               *
      *                 087987             DATE 24MAY95               *
      *                 CRT001             DATE 28FEB95               *
      *                 CRM001             DATE 06FEB95               *
      *                 CAAA01             DATE 10JAN95               *
      *                 078155             DATE 20DEC94               *
      *                 S01530             DATE 20DEC94               *
      *                 074431             DATE 30AUG94               *
      *                 S01517             DATE 21JUL94               *
      *                 S01502             DATE 21JUL94               *
      *                 S01505             DATE 04JUL94               *
      *                 S01496             DATE 04JUL94               *
      *                 S01486             DATE 04JUL94               *
      *                 S01495             DATE 13JUN94               *
      *                 S01491             DATE 13JUN94               *
      *                 S01493             DATE 25MAY94               *
      *                 S01464             DATE 11APR94               *
      *                 S01465             DATE 11APR94               *
      *                 S01470             DATE 07MAR94               *
      *                 066562             DATE 09FEB94               *
      *                 S01461             DATE 14JAN94               *
      *                 S01455             DATE 16NOV93               *
      *                 S01459             DATE 16NOV93               *
      *                 S01431             DATE 09OCT93               *
      *                 S01448             DATE 09OCT93               *
      *                 S01446             DATE 09OCT93               *
      *                 S01442             DATE 08OCT93               *
      *                 S01434             DATE 08OCT93               *
      *                 S01443             DATE 08OCT93               *
      *                 S01440             DATE 08OCT93               *
      *                 S01437             DATE 13AUG93               *
      *                 S01421 (S01423)    DATE 29JUN93               *
      *                        (S01424)                               *
      *                 049980             DATE 05FEB93               *
      *                 S01390             DATE 10NOV92               *
      *                 S01403             DATE 10NOV92               *
      *                 S01393             DATE 05NOV92               *
      *                 S01379             DATE 15SEP92               *
      *                 S01382             DATE 30JUL92               *
      *                 S01339             DATE 27MAY92               *
      *                 E28496             DATE 18SEP91               *
      *                 S01319             DATE 05AUG91               *
      *                 S01310             DATE 31MAY91               *
      *                 E23415             DATE 14NOV90               *
      *                 S01269             DATE 05NOV90               *
      *                 LN0573             DATE 02AUG90               *
      *                 LN0572             DATE 02AUG90               *
      *                 S01117             DATE 15MAY90               *
      *                 E21357             DATE 09MAR90               *
      *                 S01117             DATE 07MAR90               *
      *---------------------------------------------------------------*
      *                                                               *
      *  MD030956 - Additional changes to BFM-TI enhancement          *
      *  CLE134 - Past Due Call Loan Processing (Recompile)           *
      *  207288 - Recompile over changes in SDTOFPD.                  *
      *           Applied for AR999664 (Child: AR999668)              *
      *  BUG12434 - Initialise authorisation flag to '00'.            *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CDL038 - Extended Deal Sub Type (Recompile)                  *
      *  CPK022  - TQAUBC is now changed as TQACMT. Initialise this   *
      *            instead.                                           *
      *  BUG3644 - Serious Error in Collateralised Lending (Recompile)*
      *  BUG4544 - LEC000030 fails due to length of string operation  *
      *            out of range                                       *
      *  CFX001 - FX Margin Trading                                   *
      *  CGL014 - Collaterals Processing                              *
      *  CLE025 - Credit Lines                                        *
      *  CGP001 - Global processing.  New ICD setting for             *
      *           Authorisation of Fee Adjustments.                   *
      *  CSD011 - Performance Incentive Fees. Recompile over changed  *
      *           SDTOFPD.                                            *
      *  CAS001 - Net Present Value (NPV) Accounting                  *
      *  CRT005 - Cashier Enhancement for Cash In/Cash Out            *
      *  CRT006 - Addition of Market Data Feed.                       *
      *  CRT006 - Cashier Reserve Transactions.                       *
      *  CFT009 - Addition of fields for FT fees and charges          *
      *           Recompile                                           *
      *  CTI003 - Patch D. New fields on ICD.                         *
      *  CSD009 - Profit Centre Accounting Default Matrix Enhancement *
      *  167480 - Added new field 'TICUSN' to flag whether the Midas  *
      *           Customer Number or Midas Customer Shortname is to   *
      *           used as the TI Customer Identifier.                 *
      *  CAP032 - Conversion of Journal Batch Entry inputs into       *
      *           modular structure to use as APIs.                   *
      *  CTI099 - Utility to open accounts for Midas/TI Interface     *
      *  CPB001 - Private Banking Module:                             *
      *           - New ICD file - Midas-TOF Interface ICD.           *
      *  CPL002 - Midas-Plato Interface                               *
      *           ICD file no longer needed.                          *
      *  CAP006 - Standard fields added to SDAPIPD                    *
      *  CTI002 - Recompiled : File SDEXPMPD changed                  *
      *  CAP002 - API processing                                      *
      *  110533 - Semaphore path format depends on OS/2 or AIX        *
      *           flag on ICD                                         *
      *  CSD003 - Synon Closedown Project (SD):                       *
      *           - Program removed from SD model.                    *
      *  CTI001 - Midas-Trade Innovation Interface:                   *
      *           - New ICD file - Midas-TI Interface ICD.            *
      *  118932 - Change defaults of cashier ICD fields:              *
      *           - Product to 'CASHIER'                              *
      *           - Job Description to 'CIJOBD'                       *
      *           - Job Queue to 'CIJOBQ'                             *
      *           - Class to 'CICLASS'                                *
      *  CPL002 - Plato Interface:                                    *
      *           new ICD file - Plato Interface ICD.                 *
      *  CFF003 - OTC enhancement Phase 2 :                           *
      *           added the new fields FX Deal Generation,            *
      *           Default FX Deal Sub-Type, Default FX Deal Broker    *
      *           and OTC Days Unexpired to Futures & Options ICD.    *
      *  CSW009 - SWIFT Alliance semi-interactive link:               *
      *           9 fields added to Message Management ICD.           *
      *  096179 - Incorrect Transaction Type for Interbranch entries: *
      *           Interbranch Default Transaction Type & Main Branch  *
      *           Default Transaction Type fields added to            *
      *           RTS Default Charges Transaction Types.              *
      *  CLE004 - Lending Enhancements:                               *
      *           18 new fields added to Customer Lending ICD.        *
      *  CGL004 - Fontis Interface:                                   *
      *           New ICD record - Fontis Interface ICD               *
      *  CDL002 - FX Netting:                                         *
      *           Addition of new field to Exposure Man. ICD;         *
      *           Addition of 4 new fields to Dealing ICD.            *
      *  CSW005 - FRA/IRS MT34*, MT36* Message Generation.            *
      *           Addition of 4 new fields to FRA/IRS ICD:            *
      *           - Version of ISDA rules                             *
      *           - Type of ISDA Agreement                            *
      *           - Date of ISDA Agreement                            *
      *           - Currency for Rate Fix Holiday                     *
      *  CAC002 - PCA Phase 2: Field Teller Profit Centre             *
      *            added to RTS Default Charges Transaction Type.     *
      *  CRT003 - Cashier Interface: New ICD Record.                  *
      *  CRT002 - Retail Branch Access: Initialise RTS Default        *
      *             Charges Transaction Types.                        *
      *  CPM005 - PM Focus Group development (SDPORTPD changes).      *
      *         - Addition of 'Save Notional FX Deals'                *
      *                       'Notional FX Deals Instrument'          *
      *                       'Percentage Calculation Method'         *
      *                       'Display Customer/Portfolio'            *
      *  101971 - Addition of 'Drip Feed Batch Retention Period'      *
      *           to SDMEXPPD.                                        *
      *           - Initialise to 3.                                  *
      *  100025 - Addition of 'COB Control Profile' to SDCOBPPD.      *
      *           - Initialise to blanks.                             *
      *  099942 - Addition of 'Apply Modulus 10 Check' to SDBANKPD.   *
      *           - Initialise to 'Y'.                                *
      *  CPM004 - PM Bank Portfolios:                                 *
      *           - Initialise new field 'Portfolios Supported' on    *
      *             Portfolio Management ICD.                         *
      *  S01408 - Addition of core hook SD9005XEP1.                   *
      *           Addition of core hook SD9005XCP1.                   *
      *  CAC001 - Profit Centre Accounting ICD.                       *
      *           - Initialise fields for SDPCACPD.                   *
      *           - Remove Analytical Accounting ICD file             *
      *             initialisation.                                   *
      *           - Remove Management Accounting ICD file             *
      *             initialisation.                                   *
      *  CCM002 - City Dealer Phases 5/6:                             *
      *           - Addition of 'Delay Period for Transmission' field.*
      *  091573 - Amend initialisation of number of COB streams       *
      *           to 10.                                              *
      *  087987 - Amend initialisation of field ABCBRT on file        *
      *           CBAICDPD to '*DAILY'.                               *
      *         - Change initial value DBTHR to DBTHU on file         *
      *           CBACOBPD.                                           *
      *  CRT001 - Retail Teller System Development, initialise        *
      *           'RTS default Charges Transaction Type' file.        *
      *  CRM001 - Change 'Strategic Risk Management' to 'Interest     *
      *           Risk Management'.                                   *
      *           Addition of a new field 'Nominal Days to Maturity   *
      *           for Call Days' to Interest Risk Management file     *
      *           and initialise it to 0.                             *
      *           Initialise 'Extract/Download Frequency' to 'Z'.     *
      *  CAAA01 - Addition of 'Graphical User Interface Active'       *
      *           to SDCOBPPD and initialise it to 'N'.               *
      *  078155 - Addition of 'Download Data Option' to the Optical   *
      *           Disk file and initialise it to 'N'.                 *
      *  S01530 - Addition of 'User Data Option' to the RCF data      *
      *           file and initialise it to 'R'.                      *
      *  074431 - File SDMGMEPD should be initialised if the          *
      *           Message Management module is on. At present         *
      *           the program checks for Midas Swift being on.        *
      *  S01517 - Allow Component Bypass in COB Enhancement:          *
      *           - Initialise Allow Bypass field.                    *
      *  S01502 - Telekurs Development:                               *
      *           - Initialise Telekurs Interface field.              *
      *  S01505 - Profit Centre Accounting Development:               *
      *           - Addition of Analytical Accounting ICD file        *
      *             initialisation.                                   *
      *           - Addition of Management Accounting ICD file        *
      *             initialisation.                                   *
      *  S01496 - Jyske Enhancements:                                 *
      *           - Addition of five Priority Indicators for charge   *
      *             initialisation.                                   *
      *           - Addition of 'Retention of Position Settlement',   *
      *             'Early Redemption Dummy Customer' and             *
      *             'Trade Number Range'.                             *
      *  S01486 - Private Banking Development:                        *
      *           - Addition of Portfolio Management ICD file         *
      *             initialisation.                                   *
      *           - Addition of Portfolio Lending ICD file            *
      *             initialisation.                                   *
      *  S01495 - Create CBACOBPD and CBICDPD.                        *
      *  S01491 - Addition of new fields to SDCOBPPD for Autocall     *
      *           Project:                                            *
      *           - 'Initiate ECS' field.                             *
      *           - 'Telephone Number' field.                         *
      *           - Several 'Pager Number' fields.                    *
      *  S01493 - Reinstate Midas Export Data processing.             *
      *  S01464 - Add 'Safe Custody Fees Flag' to SDSTRDPD            *
      *           and initialise it to 'N'.                           *
      *           Addition of Safe Custody Fees ICD data.             *
      *  S01465 - Add 'Default Auto-settle Indicator' to SDCLDNPD     *
      *           and initialise it to 'Y'.                           *
      *         - Add 'Guarantees Issued Active' to SDCLDNPD          *
      *           and initialise it to 'N'.                           *
      *  S01470 - Add 'Mand Hash Tot/No. of Items in Batch' to        *
      *           SDGELRPD and initialise it to 'N'.                  *
      *  066562 - Field BVAPS renamed to BVAPST on SDSTRDPD.          *
      *           Field BLRSS renamed to BLRSST on SDTRADPD.          *
      *           Regenerate and recompile program.                   *
      *  S01461 - The Midas Export module processing was removed      *
      *           and moved to the DTA platform.                      *
      *  S01455 - Add 'Processing Type on Account Key' and            *
      *           'Instrument Type on Account Key' to SDFODAPD.       *
      *  S01459 - Addition of headerbox and PSSR processing.          *
      *  S01431 - MERVA/2 Direct Link fields added.                   *
      *  S01448 - Bulk Input Enhancements:                            *
      *           - Add 'Default Agency Trade' field.                 *
      *           - Add 'Review Bulk Trades Default' field.           *
      *           - Add 'Allow Trades Between Portfolio               *
      *             Customers' field.                                 *
      *           - Change 'Bulk Input' default from *BLANK to 'N'.   *
      *  S01446 - Customer Commissions Development:                   *
      *           - Add 'Charges Currency' field.                     *
      *           - Add 'Adjust Commissions Same Day Trade' field.    *
      *           - Change 'Auto Charge' default from *BLANK          *
      *             to 'N'.                                           *
      *  S01442 - Add 'Ccy for Rate Fix Holiday' field to SDFAISPD.   *
      *  S01434 - Added new field "Number of Working Days Before      *
      *           Maturity Date" to SDDEALPD.                         *
      *  S01443 - Added new field "Loans/Deposits Interest Rate       *
      *           Tolerance Percentage" to SDDEALPD.                  *
      *  S01440 - Added new field "Accruals on Interest Outrights"    *
      *           to SDDEALPD.                                        *
      *  S01437 - Addition of Midas Export module.                    *
      *  S01421 - BLI Development Phase 1.                            *
      *         - Add default for the new display COB prompts         *
      *           at ICT flag on SDCOBPPD.                            *
      *         - Includes changes for:                               *
      *           S01423 - Customer Service Fees switchable           *
      *                    feature:                                   *
      *                  - Add processing to default values into      *
      *                    the new Customer Service Fees ICD file     *
      *                    (SDCSFDPD).                                *
      *           S01424 - Customer deletion in COB feature:          *
      *                  - Add default for the new customer           *
      *                    deletion in COB flag on SDBANKPD.          *
      *  048890 - Addition of a new fields 'Save HAF Data to          *
      *           External Media' and 'Device for HAF Data Save.      *
      *         - Change default for submit HAF Monitor at signon     *
      *           to 'N'.                                             *
      *  S01390 - Addition of a new field, 'Australian Dollar         *
      *           Currency' to SDTRADPD. Pass this field as a         *
      *           parameter to 'Create Trading Data'.                 *
      *  S01403 - Addition of two new fields, 'Book Code Optional'    *
      *           and 'Default Book Code' to SDDEALPD                 *
      *           Pass these two fields as parameters to              *
      *           'Create Dealing Data'.                              *
      *  S01393 - ADDITION OF STRATEGIC RISK MANAGEMENT.              *
      *  S01379 - ADDITION OF HISTORY AND AUDIT FACILITY              *
      *  S01382 - ADDITION OF OPTICAL DISK                            *
      *  S01339 - SYNDICATED LOANS MODULE MADE REDUNDANT AT R10.      *
      *  E28496 - REMOVE 'HEDGED EVENTS ON CASHFLOW' FROM SDFAISPD    *
      *           REGENERATE ONLY                                     *
      *  S01319 - RATIONALISE DRS/MIDAS INTERFACE -                   *
      *           7 FIELDS ADDED TO SDDEALPD                          *
      *           ADD TREASURY MANAGEMENT DATA                        *
      *  S01310 - SWIFT RATIONALISATION                               *
      *  E23415 - UPDATE DLSTAT FOR FAIS (DELIVERED UNDER LN0975)     *
      *  S01269 - TRADE AUTHORISATION - NEW FIELD ON SE (LN0952)      *
      *  LN0573 - THE RECORD FOR MICROFICHE WAS INCORRECTLY SET UP    *
      *           WITH THE WRONG KEY                                  *
      *  LN0572 - COB PROCESSING WAS NOT BEING SET UP WITH A RECORD   *
      *  S01117 - ADDITION OF COB PROCESSING                          *
      *  E21357 - REMOVAL OF WINDOW PROCESSING FROM DEALING DATA      *
      *           AND FUTURES AND OPTIONS DATA                        *
      *  S01117 - RELEASE 10 ENHANCEMENTS                             *
      *                                                               *
      *****************************************************************
     F/COPY WNCPYSRC,SD9005XFPG                                           S01408
     FCBACOBL0IF  E           K        DISK                      A
      *
     FCBAICDL0IF  E           K        DISK                      A
      *
     FSDMMODL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0001
     F                                              KINFSR *PSSR
      * RTV : Midas SD Midas module flags retrieval
      *
     FSDDEALL0IF  E           K        DISK                      A    UC
     F                                              KINFDS ID0002
     F                                              KINFSR *PSSR
      * UPD : Midas SD Dealing ICD data update
      *
     FSDTRADL0IF  E           K        DISK                      A    UC
     F                                              KINFDS ID0003
     F                                              KINFSR *PSSR
      * UPD : Trading Data              Update index
      *
     FSDSTRDL0IF  E           K        DISK                      A    UC
     F                                              KINFDS ID0004
     F                                              KINFSR *PSSR
      * UPD : Midas SD Securities trading ICD update
      *
     FSDCLNDL0IF  E           K        DISK                      A    UC
     F                                              KINFDS ID0005
     F                                              KINFSR *PSSR
      * UPD : Midas SD Customer Lending ICD update
      *
     FSDFODAL0IF  E           K        DISK                      A    UC
     F                                              KINFDS ID0006
     F                                              KINFSR *PSSR
      * UPD : Midas SD Futures and options ICD update
      *
     FSDRETLL0IF  E           K        DISK                      A    UC
     F                                              KINFDS ID0007
     F                                              KINFSR *PSSR
      * UPD : Retail Details            Update index
      *
     FSDGELRL0IF  E           K        DISK                      A    UC
     F                                              KINFDS ID0008
     F                                              KINFSR *PSSR
      * UPD : Midas SD General ledger ICD details update
      *
     FSDBANKL0IF  E           K        DISK                      A    UC
     F                                              KINFDS ID0009
     F                                              KINFSR *PSSR
      * UPD : Midas SD Bank details ICD update
      *
     FSDFAISL0IF  E           K        DISK                      A    UC
     F                                              KINFDS ID0010
     F                                              KINFSR *PSSR
      * UPD : Fwd Rate Agmt/Int Rate Sw Update index
      *
     FSDMGMEL0IF  E           K        DISK                      A    UC
     F                                              KINFDS ID0011
     F                                              KINFSR *PSSR
      * UPD : Midas SD Message management
      *
     FSDMTLXL0IF  E           K        DISK                      A    UC
     F                                              KINFDS ID0012
     F                                              KINFSR *PSSR
      * UPD : Midas/Telex Data          Update index
      *
     FSDFTFRL0IF  E           K        DISK                      A    UC
     F                                              KINFDS ID0013
     F                                              KINFSR *PSSR
      * UPD : Midas SD Funds transfer ICD update
      *
     FSDEXPML0IF  E           K        DISK                      A    UC
     F                                              KINFDS ID0014
     F                                              KINFSR *PSSR
      * UPD : Exposure Management Data  Update index
      *
     FSDRCFL0 IF  E           K        DISK                      A    UC
     F                                              KINFDS ID0015
     F                                              KINFSR *PSSR
      * UPD : Midas SD RCF data update
      *
     FSDMCFCL0IF  E           K        DISK                      A    UC
     F                                              KINFDS ID0016
     F                                              KINFSR *PSSR
      * UPD : Microfiche Data           Update index
      *
     FSDOPTCL0IF  E           K        DISK                      A    UC
     F                                              KINFDS ID0017
     F                                              KINFSR *PSSR
      * UPD : Midas SD Optical disk update
      *
     FSDHAFDL0IF  E           K        DISK                      A    UC
     F                                              KINFDS ID0018
     F                                              KINFSR *PSSR
      * UPD : Midas SD History and audit facility ICD
      *
     FSDRISKL0IF  E           K        DISK                      A    UC
     F                                              KINFDS ID0019
     F                                              KINFSR *PSSR
      * UPD : Midas SD Interest risk management ICD update
      *
     FSDCOBPL0IF  E           K        DISK                      A    UC
     F                                              KINFDS ID0020
     F                                              KINFSR *PSSR
      * UPD : Midas SD System control ICD update
      *
     FSDTRMAL0IF  E           K        DISK                      A    UC
     F                                              KINFDS ID0021
     F                                              KINFSR *PSSR
      * UPD : Midas Treasury Management Data  Updte indx
      *
     FSDCSFDL0IF  E           K        DISK                      A    UC
     F                                              KINFDS ID0022
     F                                              KINFSR *PSSR
      * UPD : Midas SD Customer service fees ICD update
      *
     FSDSCFEL0IF  E           K        DISK                      A    UC
     F                                              KINFDS ID0023
     F                                              KINFSR *PSSR
      * UPD : Midas SD Safe custody fees ICD update
      *
     FSDMEXPL0IF  E           K        DISK                      A    UC
     F                                              KINFDS ID0024
     F                                              KINFSR *PSSR
      * UPD : Midas SD Midas export data ICD update
      *
     FSDPORTL0IF  E           K        DISK                      A    UC
     F                                              KINFDS ID0025
     F                                              KINFSR *PSSR
      * UPD : Midas SD Portfolio management ICD update
      *
     FSDLOMBL0IF  E           K        DISK                      A    UC
     F                                              KINFDS ID0026
     F                                              KINFSR *PSSR
      * UPD : Midas SD Portfolio lending ICD update
      *
     FSDPCACL0IF  E           K        DISK                      A    UC
     F                                              KINFDS ID0027
     F                                              KINFSR *PSSR
      * UPD : Midas SD Profit centre accounting ICD update
      *
     FSDTCHGL0IF  E           K        DISK                      A    UC
     F                                              KINFDS ID0028
     F                                              KINFSR *PSSR
      * UPD : Midas SD RTS Default Charges Tran Type   Update
      *
     FSDBAIIL0IF  E           K        DISK                      A    UC
     F                                              KINFDS ID0029
     F                                              KINFSR *PSSR
      * UPD : BAI ICD                   Update index
      *
     FSDFONTL0IF  E           K        DISK                      A    UC
     F                                              KINFDS ID0030
     F                                              KINFSR *PSSR
      * UPD : Midas SD Fontis Interface ICD      Update index
      *
     F***SDMPICL0IF  E           K        DISK                A    UC     CPL002
     F**********                                    KINFDS ID0031         CPL002
     F**********                                    KINFSR *PSSR          CPL002
      * UPD : Midas SD Plato Interface ICD       Update index
      *
     FSDTIINL0IF  E           K        DISK                      A    UC
     F                                              KINFDS ID0032
     F                                              KINFSR *PSSR
      * UPD : Midas SD Midas/TI interface ICD update
     FSDAPIL0 IF  E           K        DISK                      A    UC  CAP002
     F                                              KINFDS ID0033         CAP002
     F                                              KINFSR *PSSR          CAP002
      * UPD : Midas SD API ICD update                                     CAP002
      *
     FSDTOFPD IF  E                    DISK                      A    UC  CPB001
     F                                              KINFDS ID0034         CPB001
     F                                              KINFSR *PSSR          CPB001
      * UPD : Midas SD Private Banking ICD update                         CPB001
     FSDMDFCPDIF  E                    DISK                      A    UC                      CSD006
     F                                              KINFDS ID0035                             CSD006
     F                                              KINFSR *PSSR                              CSD006
      * UPD : Midas SD MDF ICD update                                                         CSD006
      **********                                                                      CLE025 BUG4544
      ***Collateral*and*Credit*Control*ICD*file************************               CLE025 BUG4544
     F***SDCOCCPDUF  E                    DISK                      A    UC           CLE025 BUG4544
     F**********                                    KINFDS ID0036                     CLE025 BUG4544
     F**********                                    KINFSR *PSSR                      CLE025 BUG4544
      **********                                                                      CLE025 BUG4544
     E* Description     : Copyright notice for inclusion in all programs
     E*
     E********************************************************************
     E                    CPY@    1   1 80               Copyright array
      * Long constants
     E**********          @CN#    1  16  6   @CN    25                                        CSD006
     E**********          @CN#    1  17  6   @CN    25                                 CSD006 CRT005
     E                    @CN#    1  21  6   @CN    25                                        CRT005
     I/COPY WNCPYSRC,SD9005XIPG                                           S01408
     I*
     I* Description     : Copyright notice for inclusion in all programs
     I*
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IA@CPY       DS
     I* Copyright array
     I                                        1  80 CPY@
     IDLSTAT      DS                                                      E23415
     I                                        1 256 UDATA                 E23415
     I                                       35  35 UDLST                 E23415
     IID0001      DS                            528
      * File information data structure
      *
     IID0002      DS                            528
      * File information data structure
      *
     IID0003      DS                            528
      * File information data structure
      *
     IID0004      DS                            528
      * File information data structure
      *
     IID0005      DS                            528
      * File information data structure
      *
     IID0006      DS                            528
      * File information data structure
      *
     IID0007      DS                            528
      * File information data structure
      *
     IID0008      DS                            528
      * File information data structure
      *
     IID0009      DS                            528
      * File information data structure
      *
     IID0010      DS                            528
      * File information data structure
      *
     IID0011      DS                            528
      * File information data structure
      *
     IID0012      DS                            528
      * File information data structure
      *
     IID0013      DS                            528
      * File information data structure
      *
     IID0014      DS                            528
      * File information data structure
      *
     IID0015      DS                            528
      * File information data structure
      *
     IID0016      DS                            528
      * File information data structure
      *
     IID0017      DS                            528
      * File information data structure
      *
     IID0018      DS                            528
      * File information data structure
      *
     IID0019      DS                            528
      * File information data structure
      *
     IID0020      DS                            528
      * File information data structure
      *
     IID0021      DS                            528
      * File information data structure
      *
     IID0022      DS                            528
      * File information data structure
      *
     IID0023      DS                            528
      * File information data structure
      *
     IID0024      DS                            528
      * File information data structure
      *
     IID0025      DS                            528
      * File information data structure
      *
     IID0026      DS                            528
      * File information data structure
      *
     IID0027      DS                            528
      * File information data structure
      *
     IID0028      DS                            528
      * File information data structure
      *
     IID0029      DS                            528
      * File information data structure
      *
     IID0030      DS                            528
      * File information data structure
      *
     IID0031      DS                            528
      * File information data structure
      *
     IID0032      DS                            528
      * File information data structure
      *
     IID0033      DS                            528                       CAP002
      * File information data structure                                   CAP002
      *                                                                   CAP002
     IID0034      DS                            528                       CPB001
      * File information data structure                                   CPB001
      *                                                                   CPB001
     IID0035      DS                            528                                           CSD006
      * File information data structure                                                       CSD006
      *                                                                                       CSD006
      ***File*information*DS*(SDCOCCPD)********************************               CLE025 BUG4544
     I***ID0036      DS                            528                                CLE025 BUG4544
      **********                                                                      CLE025 BUG4544
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Database Error (ICD)'
      * Filename
     I                                        1  10 ZA0001
     ISCSARD    E DSSCSARDPD                                                                  CRT005
      ** External DS for Switchable Features                                                  CRT005
      *                                                                                       CRT005
     ILDA       E DSLDA                         256                                           CRT005
      ** Local data area for database error details                                           CRT005
      *                                                                                       CRT005
     IDSFDY     E DSDSFDY                                                                     CRT005
      **  First DS for access programs, Short data structure                                  CRT005
      *                                                                                       CRT005
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Initialise ICD Records
      * Start of S01459
      * SD9005X Precompiler - MIDAS Modules  *
      * End of S01459
      * 00/Copy member SD9005XFPG - MIDAS Modules  *
      * 00/Copy member SD9005XIPG - MIDAS Modules  *
      * 00/Copy member SD9005XEP1 - MIDAS Modules  *
     C*                                                                   S01408
     C/COPY WNCPYSRC,SD9005XEP1                                           S01408
     C*                                                                   S01408
      * Copyright Statement 1988 - Standard Functions  * Copyright
      * Get all Midas Modules - MIDAS Modules  *
     C                     EXSR SARVGN
      * Start of change S01423 - Customer Service Fees switchable feature
     C                     MOVEL'S01423'  WUSARN           SAR number fiel
      * SAR switched on check - Standard Functions  *
     C                     CALL 'AOSARDR0'             90  SAR switched on
     C           WUAPRC    PARM WUAPRC    WQ0001  7        Access Pgm Retu
     C                     PARM '*VERIFY' WQ0002  7        Option for ACCO
     C           WUSARN    PARM WUSARN    WQ0003  6        SAR number fiel
     C                     PARM WUFDY     WQ0004 76        Access obj dumm
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'AOSARDR0'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Check to see if Customer Service Fees is present.
      * CASE: WRK.Access Pgm Return Code is *Normal
     C           WUAPRC    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       WUKKST           Customer Servic
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUKKST           Customer Servic
     C                     END                             *FI
      * End of change S01423 - Customer Service Fees switchable feature.
      * 00/Copy member SD9005XCP1 - MIDAS Modules  *
     C*                                                                   S01408
     C/COPY WNCPYSRC,SD9005XCP1                                           S01408
     C*                                                                   S01408
      * Start of SAR S01310
      * Get rid of redundant code
      * End of SAR S01310
     C                     MOVEL'N'       WUTDSU           Trading Data Se
      * Dealing
      * CASE: WRK.Dealing: FX is Yes
     C           WUDLFX    IFEQ 'Y'                        *IF
      * Create Dealing Data - Dealing Data  *
     C                     EXSR SBCRRC
      * Create Trading Data - Trading Data  *
     C                     EXSR SCCRRC
     C                     MOVEL'Y'       WUTDSU           Trading Data Se
     C                     ELSE
      * CASE: WRK.Dealing: MM is Yes
     C           WUDLMM    IFEQ 'Y'                        *IF
      * Create Dealing Data - Dealing Data  *
     C                     EXSR SDCRRC
      * Create Trading Data - Trading Data  *
     C                     EXSR SECRRC
     C                     MOVEL'Y'       WUTDSU           Trading Data Se
     C                     END                             *FI
     C                     END                             *FI
      * S01339 - Syndicated Loans processing removed.
      * Securities Trading
      * CASE: WRK.Securities is Yes
     C           WUSECS    IFEQ 'Y'                        *IF
      * Start of SAR S01269
      * New field Trade Authorisation initialised as blank.
      * End of SAR S01269
      * Create Sec. Trading - Securities Trading Data  *
     C                     EXSR SFCRRC
      * CASE: WRK.Trading Data Set-up is No
     C           WUTDSU    IFEQ 'N'                        *IF
      * Create Trading Data - Trading Data  *
     C                     EXSR SGCRRC
     C                     MOVEL'Y'       WUTDSU           Trading Data Se
     C                     END                             *FI
     C                     END                             *FI
      * Customer Lending
      * CASE: WRK.Customer Lending is Yes
     C           WUCSLN    IFEQ 'Y'                        *IF
      * Create Customer Lending - Customer Lending Data  *
     C                     EXSR SHCRRC
      * Trading Data not setup.
      * CASE: WRK.Trading Data Set-up is No
     C           WUTDSU    IFEQ 'N'                        *IF
      * Create Trading Data - Trading Data  *
     C                     EXSR SICRRC
     C                     MOVEL'Y'       WUTDSU           Trading Data Se
     C                     END                             *FI
     C                     END                             *FI
      * Futures & Options
      * CASE: WRK.Futures & Options is Yes
     C           WUFUOP    IFEQ 'Y'                        *IF
      * Create Futures & Opts - Futures & Options Data  *
     C                     EXSR SJCRRC
      * CASE: WRK.Trading Data Set-up is No
     C           WUTDSU    IFEQ 'N'                        *IF
      * Create Trading Data - Trading Data  *
     C                     EXSR SKCRRC
     C                     MOVEL'Y'       WUTDSU           Trading Data Se
     C                     END                             *FI
     C                     END                             *FI
      * Retail
      * CASE: WRK.Retail Banking is Yes
     C           WURTBN    IFEQ 'Y'                        *IF
      * Create Retail Details - Retail Details  *
     C                     EXSR SLCRRC
     C                     ELSE
      * CASE: WRK.Interest on accounts is Yes
     C           WUIOAC    IFEQ 'Y'                        *IF
      * Create Retail Details - Retail Details  *
     C                     EXSR SMCRRC
     C                     END                             *FI
     C                     END                             *FI
      * Standing Data/General Ledger
      * CASE: WRK.Standing data/Gen.Ledger is Yes
     C           WUSDGL    IFEQ 'Y'                        *IF
      * Create General Ledger - General Ledger Details  *
     C                     EXSR SNCRRC
      * Start of change S01424.
      * Create Bank Details - Bank Details  *
     C                     EXSR SOCRRC
      * End of change S01424.
     C                     END                             *FI
      * FRA/IRS
      * CASE: WRK.FRA/IRS Indicator is Yes
     C           WUFIIN    IFEQ 'Y'                        *IF
      * Create FRA/IRS - Fwd Rate Agmt/Int Rate Sw  *
     C                     EXSR SPCRRC
      * Start of Fix E23415
      * DLSTAT needs to be updated with position 35 to Y for
      * processing required in next day set up.
      * Update DLSTAT for FAIS - MIDAS Modules  *
     C           *NAMVAR   DEFN           DLSTAT                          E23415
     C           *LOCK     IN   DLSTAT                                    E23415
     C                     MOVE 'Y'       UDLST                        D  E23415
     C                     OUT  DLSTAT                                    E23415
      * End of Fix E23415
     C                     END                             *FI
      * Start of SAR S01310
      * Start of change 074431
      * Change Reference from Midas Swift Direct Link to Message Manageme
      * End of change 074431
      * Message Management
      * CASE: WRK.Message Management is Yes
     C           WUNWMI    IFEQ 'Y'                        *IF
      * Create Message Management - Message Management  *
     C                     EXSR SQCRRC
     C                     END                             *FI
      * End of SAR S01310
      * Midas/Telex
      * CASE: WRK.Midas/Telex Module Ind. is Yes
     C           WUMTMI    IFEQ 'Y'                        *IF
      * Create Midas/Telex - Midas/Telex Data  *
     C                     EXSR SRCRRC
     C                     END                             *FI
      * Funds Transfer
      * CASE: WRK.Funds Transfer is Yes
     C           WUFDTR    IFEQ 'Y'                        *IF
      * Create Funds Transfer - Funds Transfer Details  *
     C                     EXSR SSCRRC
     C                     END                             *FI
      * Exposure Management
      * CASE: WRK.Exposure Management is Yes
     C           WUEXMG    IFEQ 'Y'                        *IF
      * Create Exposure Managemen - Exposure Management Data  *
     C                     EXSR STCRRC
     C                     END                             *FI
      * TABTB File Update - MIDAS Modules  *
     C                     CALL 'TABTB'                90  TABTB File Upda
     C                     PARM WUMTMI    WQ0005  1        Midas/Telex Mod
     C                     PARM WUDLFX    WQ0006  1        Dealing: FX
     C                     PARM WUSYLN    WQ0007  1        Syndicated Loan
     C                     PARM WUEXMG    WQ0008  1        Exposure Manage
     C                     PARM WUCSLN    WQ0009  1        Customer Lendin
     C                     PARM WURTBN    WQ0010  1        Retail Banking
     C                     PARM WUMSDL    WQ0011  1        Midas/Swift dir
     C                     PARM WUSECS    WQ0012  1        Securities
     C                     PARM WUFDTR    WQ0013  1        Funds Transfer
     C                     PARM WUFUOP    WQ0014  1        Futures & Optio
     C                     PARM WUFIIN    WQ0015  1        FRA/IRS Indicat
     C                     PARM WUDLMM    WQ0016  1        Dealing: MM
     C           W0RTN     PARM *BLANK    WQ0017  7        *Return code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'TABTB'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Start of SAR S01117
      * RCF Data
     C                     EXSR UASUBR                     RCF Data
      * Microfiche Data
     C                     EXSR UBSUBR                     Microfiche Data
      * End of SAR S01117
      * Start of SAR S01382
      * Optical Disk
     C                     EXSR UCSUBR                     Optical Disk
      * End of SAR S01382
      * Start of SAR S01379
      * History and Audit Facility
     C                     EXSR UDSUBR                     History and Aud
      * End of SAR S01379
      * Start of SAR S01393
      * Start of CRM001
      * Interest Risk Management
     C                     EXSR UESUBR                     Interest Risk M
      * End of CRM001
      * End of SAR S01393
      * Start of Error Fix LN0572
      * Start of change S01421.
      * Create SC ICD Processing - COB Processing  *
     C                     EXSR SZCRRC
      * End of change S01421.
      * End of Error Fix LN0572
      * start S01319
      * add Treasury Management
      * Treasury Management.
      * CASE: WRK.Treasury Management is Yes
     C           WUTRMG    IFEQ 'Y'                        *IF
      * Create Treasury Managemen - Treasury Management Data  *
     C                     EXSR TACRRC
     C                     END                             *FI
      * end S01319
      * Start of change S01423 - Customer Service Fees switchable feature
      * Customer Service Fees switchable feature.
     C                     EXSR UFSUBR                     Customer Servic
      * End of change S01423 - Customer Service Fees switchable feature.
      * Start of change S01464 - Safe Custody Fees.
      * Safe Custody Fees.
     C                     EXSR UGSUBR                     Safe Custody Fe
      * End of change S01464 - Safe Custody Fees.
      * Start of S01493 - Reinstate Midas-Eureka Interface processing.
      * Midas Export Data
     C                     EXSR UHSUBR                     Midas Export Da
      * End of S01493 - Reinstate Midas-Eureka Interface processing.
      * Start of S01495
      * Initialise CBACOBPD - MIDAS Modules  *
     C*
     C* Check to see if CBACOBL0 has a record.
     C*
     C                     MOVEL'*daily'  KEYONE 10
     C*
     C           KEYONE    SETLL@ACOBF0                  90
     C           *IN90     IFEQ '0'
     C*
     C                     MOVEL'*DAILY'  KEYONE
     C*
     C           KEYONE    SETLL@ACOBF0                  90
     C                     END
      *
      * If CBACOBL0 does not have a record then default one.
      *
     C           *IN90     IFEQ '0'
     C                     MOVEL'*daily'  AAAUTO
     C                     Z-ADD1         AASASP
     C                     MOVEL'*YES'    AASSAV
     C                     MOVEL'*NOTIFY' AAMSGS
     C                     MOVEL'*YES'    AACSAV
     C                     MOVEL'DBMON'   AAMON
     C                     MOVEL'DBTUE'   AATUE
     C                     MOVEL'DBWED'   AAWED
     C**********           MOVEL'DBTHR'   AATHR                           087987
     C                     MOVEL'DBTHU'   AATHR                           087987
     C                     MOVEL'DBFRI'   AAFRI
     C                     MOVEL'DBSAT'   AASAT
     C                     MOVEL'DBSUN'   AASUN
     C                     MOVEL'*DISK'   AATSFO
     C                     MOVEL'*DISK'   AANSSO
     C                     MOVEL*BLANKS   AACBNA
     C                     MOVEL*BLANKS   AAAJOB
     C                     MOVEL*BLANKS   AAAUSR
     C                     Z-ADD*ZEROS    AAATIM
     C                     MOVEL*BLANKS   AAARDT
     C                     MOVEL*BLANKS   AAAACT
     C                     Z-ADD*ZEROS    AARDNB
      *
     C                     WRITE@ACOBF0
      *
     C                     SETOF                     90
      *
     C                     END
      *
      * Initialise CBAICDPD - MIDAS Modules  *
     C*
     C* Check to see if CBAICDL0 has a record.
     C*
     C*
     C                     MOVEL'A.COB'   KEYTWO  6
     C*
     C           KEYTWO    SETLL@AICDF0                  90
      *
      * If CBAICDL0 does not have a record then default one.
      *
     C           *IN90     IFEQ '0'
     C                     MOVEL'A.COB'   ABACOB
     C                     MOVEL'*YES'    ABDAYF
     C                     MOVEL'*daily'  ABDYKY
     C                     MOVEL'*YES'    ABWKF
     C                     MOVEL'*daily'  ABWKKY
     C                     MOVEL'*YES'    ABMTHF
     C                     MOVEL'*daily'  ABMHKY
     C                     MOVEL'*YES'    ABYRF
     C                     MOVEL'*daily'  ABYRKY
     C                     MOVEL'FRI'     ABLDWK
     C**********           MOVEL*BLANKS   ABCBRT                          087987
     C                     MOVEL'*DAILY'  ABCBRT                          087987
     C                     MOVEL*BLANKS   ABCBRO
     C                     MOVEL*BLANKS   ABCBDO
     C                     MOVEL*BLANKS   ABCBCF
     C                     MOVEL*BLANKS   ABCBMD
     C                     Z-ADD*ZERO     ABDBRN
     C                     MOVEL*BLANKS   ABCBDN
     C                     MOVEL*BLANKS   ABAJOB
     C                     MOVEL*BLANKS   ABAUSR
     C                     Z-ADD*ZERO     ABATIM
     C                     MOVEL*BLANKS   ABARDT
     C                     MOVEL*BLANKS   ABAACT
     C                     Z-ADD*ZERO     ABRDNB
      *
     C                     WRITE@AICDF0
      *
     C                     SETOF                     90
      *
     C                     END
      * End of S01495
      * Start of change S01486.
      * Portfolio Management
     C                     EXSR UISUBR                     Portfolio Manag
      * Portfolio Lending
     C                     EXSR UJSUBR                     Portfolio Lendi
      * End of change S01486.
      * Change CAC001 - Reverse out S01505.
      * Start of change CAC001 - Profit Centre Accounting.
     C                     MOVEL'CAC001'  WUSARN           SAR number fiel
      * SAR switched on check - Standard Functions  *
     C                     CALL 'AOSARDR0'             90  SAR switched on
     C           WUAPRC    PARM WUAPRC    WQ0018  7        Access Pgm Retu
     C                     PARM '*VERIFY' WQ0019  7        Option for ACCO
     C           WUSARN    PARM WUSARN    WQ0020  6        SAR number fiel
     C                     PARM WUFDY     WQ0021 76        Access obj dumm
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'AOSARDR0'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Check to see if Profit Centre Accounting is present.
      * CASE: WRK.Access Pgm Return Code is *Normal
     C           WUAPRC    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       WUW7ST           cac001
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUW7ST           cac001
     C                     END                             *FI
      * Profit Centre Accounting
      * CASE:
      *  - c1 OR c2
      *   |- c1    : WRK.cac001 is Present
      *   |- c2    : WRK.Analytical Accounting is Yes
      *   '-
     C           WUW7ST    IFEQ 'Y'                        *IF
     C           WUN0ST    OREQ 'Y'                        *OR
      * Create Profit Centre A/C - Profit Centre A/C ICD  *
     C                     EXSR TGCRRC
     C                     END                             *FI
      * End of change CAC001.
      * Start of change CRT001 - Retail Teller System
     C                     MOVEL'CRT001'  WUSARN           SAR number fiel
      * SAR switched on check - Standard Functions  *
     C                     CALL 'AOSARDR0'             90  SAR switched on
     C           WUAPRC    PARM WUAPRC    WQ0022  7        Access Pgm Retu
     C                     PARM '*VERIFY' WQ0023  7        Option for ACCO
     C           WUSARN    PARM WUSARN    WQ0024  6        SAR number fiel
     C                     PARM WUFDY     WQ0025 76        Access obj dumm
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'AOSARDR0'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Check to see if CRT001 is present on SCSARDPD
      * CASE: WRK.Access Pgm Return Code is *Normal
     C           WUAPRC    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       WURTSW           RTS CRT001
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WURTSW           RTS CRT001
     C                     END                             *FI
      * Start of change CRT002 - Retail Branch Access
     C                     MOVEL'CRT002'  WUSARN           SAR number fiel
      * SAR switched on check - Standard Functions  *
     C                     CALL 'AOSARDR0'             90  SAR switched on
     C           WUAPRC    PARM WUAPRC    WQ0026  7        Access Pgm Retu
     C                     PARM '*VERIFY' WQ0027  7        Option for ACCO
     C           WUSARN    PARM WUSARN    WQ0028  6        SAR number fiel
     C                     PARM WUFDY     WQ0029 76        Access obj dumm
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'AOSARDR0'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Check to see if CRT002 is present on SCSARDPD
      * CASE: WRK.Access Pgm Return Code is *Normal
     C           WUAPRC    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       WUCRT2           Switchable feat
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUCRT2           Switchable feat
     C                     END                             *FI
      * End of change CRT002
      * Initialise RTS Default Charges Transaction Type file
      * CASE: c4 added by CRT002
      *  - (c1ORc4) AND c2 AND c3
      *   |- c1    : WRK.RTS CRT001 is Present
      *   |- c4    : WRK.Switchable feature CRT002 is Present
      *   |- c2    : WRK.Retail Banking is Yes
      *   |- c3    : WRK.Retail 3 is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C                     MOVEL'0'       Y0CX02  1
     C           WURTSW    IFEQ 'Y'                        *IF
     C           WUCRT2    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C           WURTBN    IFEQ 'Y'                        *IF
     C           WUNXST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Create RTS Dft Charges Tr - RTS Dft Charges Tran Type  *
     C                     EXSR THCRRC
     C                     END                             *FI
      * End of change CRT001
      * Start of change CRT003 - Cashier Interface.
     C                     MOVEL'CRT003'  WUSARN           SAR number fiel
      * SAR switched on check - Standard Functions  *
     C                     CALL 'AOSARDR0'             90  SAR switched on
     C           WUAPRC    PARM WUAPRC    WQ0030  7        Access Pgm Retu
     C                     PARM '*VERIFY' WQ0031  7        Option for ACCO
     C           WUSARN    PARM WUSARN    WQ0032  6        SAR number fiel
     C                     PARM WUFDY     WQ0033 76        Access obj dumm
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'AOSARDR0'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Check to see if Cashier Interface is present.
      * CASE: WRK.Access Pgm Return Code is *Normal
     C           WUAPRC    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       WUCRT3           Switchable feat
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUCRT3           Switchable feat
     C                     END                             *FI
      * Cashier Interface ICD.
      * CASE: WRK.Switchable feature CRT003 is Present
     C           WUCRT3    IFEQ 'Y'                        *IF
      * Create Cashier Intrf ICD - BAI ICD  *
     C                     EXSR TICRRC
     C                     END                             *FI
      * End of change CRT003.
      * Start of change CGL004 - Fontis Interface.
     C                     MOVEL'CGL004'  WUSARN           SAR number fiel
      * SAR switched on check - Standard Functions  *
     C                     CALL 'AOSARDR0'             90  SAR switched on
     C           WUAPRC    PARM WUAPRC    WQ0034  7        Access Pgm Retu
     C                     PARM '*VERIFY' WQ0035  7        Option for ACCO
     C           WUSARN    PARM WUSARN    WQ0036  6        SAR number fiel
     C                     PARM WUFDY     WQ0037 76        Access obj dumm
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'AOSARDR0'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Check to see if Fontis Interface is present.
      * CASE: WRK.Access Pgm Return Code is *Normal
     C           WUAPRC    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       WU               Switchable Feat
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WU               Switchable Feat
     C                     END                             *FI
      * Fontis Interface ICD.
      * CASE: WRK.Switchable Feature CGL004 is Present
     C           WU        IFEQ 'Y'                        *IF
      * Create Fontis Interface I - Fontis Interface ICD  *
     C                     EXSR TJCRRC
     C                     END                             *FI
      * End of change CGL004.
      * Start of change CPL002 - Plato Interface.
      ***********                                                         CPL002
     C***********          MOVEL'CPL002'  WUSARN           SAR number fielCPL002
      **SAR*switched on check - Standard Functions  *                     CPL002
     C***********          CALL 'AOSARDR0'             90  SAR switched onCPL002
     C***********WUAPRC    PARM WUAPRC    WQ0038  7        Access Pgm RetuCPL002
     C***********          PARM '*VERIFY' WQ0039  7        Option for ACCOCPL002
     C***********WUSARN    PARM WUSARN    WQ0040  6        SAR number fielCPL002
     C***********          PARM WUFDY     WQ0041 76        Access obj dummCPL002
      ***********                                                         CPL002
     C************IN90     IFEQ '1'                                       CPL002
      **Call*to*program ended in error                                    CPL002
     C***********          MOVEL'Y2U0032' W0RTN                           CPL002
     C***********          MOVEL*BLANKS   W0CLPG 10                       CPL002
     C***********          MOVEL'AOSARDR0'W0CLPG                          CPL002
      **Send*message '*Error occured on CALL...'                          CPL002
     C***********          MOVEL'Y2U0032' ZAMSID                          CPL002
     C***********          MOVEL'Y2USRMSG'ZAMSGF                          CPL002
     C***********          MOVELW0CLPG    ZAMSDA           Message data   CPL002
     C***********          EXSR ZASNMS                                    CPL002
     C***********          END                                            CPL002
      ***********                                                         CPL002
      **Check*to*see if Plato Interface is present.                       CPL002
      **CASE:*WRK.Access Pgm Return Code is *Normal                       CPL002
     C***********WUAPRC    IFEQ *BLANK                     *IF            CPL002
     C***********          MOVEL'Y'       WUCPL2           Switchable FeatCPL002
     C***********          ELSE                                           CPL002
      **CASE:**OTHERWISE                                                  CPL002
     C***********          MOVEL'N'       WUCPL2           Switchable FeatCPL002
     C***********          END                             *FI            CPL002
      **Plato*Interface ICD.                                              CPL002
      **CASE:*WRK.Switchable Feature CPL002 is Present                    CPL002
     C***********WUCPL2    IFEQ 'Y'                        *IF            CPL002
      **Create*Plato Interface IC - Plato Interface ICD  *                CPL002
     C***********          EXSR TKCRRC                                    CPL002
     C***********          END                             *FI            CPL002
      * End of change CPL002.
      * Start of change CTI001 - Midas-Trade Innovation Interface
      * Midas-Trade Innovation Interface ICD.
      * CASE: WRK.Midas-Trade Innovation If is Yes
     C           WUN3ST    IFEQ 'Y'                        *IF
     C           CTI006    OREQ 'Y'                                                         MD030956
      * Create Midas/TI Interface - Midas/TI Interface ICD  *
     C                     EXSR TLCRRC
     C                     END                             *FI
      * End of change CTI001
      * Start of change CPB001 - Midas-Private Banking                    CPB001
      * Midas-Private Banking ICD.                                        CPB001
      * CASE: WRK.Midas-Private Banking If is Yes                         CPB001
     C           WUN4ST    IFEQ 'Y'                        *IF            CPB001
      * Create Midas/Private Banking ICD *                                CPB001
     C                     EXSR PBCRRC                                    CPB001
     C                     END                             *FI            CPB001
      * End of change CPB001                                              CPB001
      *                                                                   CAP002
      * Start of change CSD006 - Market Data Feed                                             CSD006
      *                                                                                       CSD006
      * Setup MDF ICD (CSD006)                                                                CSD006
     C                     MOVEL'CSD006'  WUSARN           SAR number field                   CSD006
      * APIs switched on check.                                                               CSD006
     C                     CALL 'AOSARDR0'             90  SAR switched on                    CSD006
     C           WUAPRC    PARM WUAPRC    WQ0001  7        Access Pgm Return Code             CSD006
     C                     PARM '*VERIFY' WQ0002  7        Option for ACCO                    CSD006
     C           WUSARN    PARM WUSARN    WQ0003  6        SAR number field                   CSD006
     C                     PARM WUFDY     WQ0004 76        Access obj dummy string            CSD006
      *                                                                                       CSD006
     C           *IN90     IFEQ '1'                                                           CSD006
      * Call to program ended in error                                                        CSD006
     C                     MOVEL'Y2U0032' W0RTN                                               CSD006
     C                     MOVEL*BLANKS   W0CLPG 10                                           CSD006
     C                     MOVEL'AOSARDR0'W0CLPG                                              CSD006
      * Send message '*Error occured on CALL...'                                              CSD006
     C                     MOVEL'Y2U0032' ZAMSID                                              CSD006
     C                     MOVEL'Y2USRMSG'ZAMSGF                                              CSD006
     C                     MOVELW0CLPG    ZAMSDA           Message data                       CSD006
     C                     EXSR ZASNMS                                                        CSD006
     C                     END                                                                CSD006
      *                                                                                       CSD006
      * Check to see if MDF is set on.                                                        CSD006
      * CASE: WRK.Access Pgm Return Code is *Normal                                           CSD006
     C           WUAPRC    IFEQ *BLANK                     *IF                                CSD006
     C                     MOVEL'Y'       CSD006  1        APIs                               CSD006
     C                     ELSE                                                               CSD006
      * CASE: *OTHERWISE                                                                      CSD006
     C                     MOVEL'N'       CSD006           APIs                               CSD006
     C                     END                             *FI                                CSD006
      * MDF Interface ICD.                                                                    CSD006
      * CASE: WRK.Switchable Feature CSD006 is Present                                        CSD006
     C           CSD006    IFEQ 'Y'                        *IF                                CSD006
      * Create MDF ICD                                                                        CSD006
     C                     EXSR MFCRRC                                                        CSD006
     C                     END                             *FI                                CSD006
      * End of change CSD006                                                                  CSD006
      *                                                                                       CSD006
      * Setup API module ICD (CAP002)                                     CAP002
     C                     MOVEL'CAP002'  WUSARN           SAR number fielCAP002
      * APIs switched on check.                                           CAP002
     C                     CALL 'AOSARDR0'             90  SAR switched onCAP002
     C           WUAPRC    PARM WUAPRC    WQ0001  7        Access Pgm RetuCAP002
     C                     PARM '*VERIFY' WQ0002  7        Option for ACCOCAP002
     C           WUSARN    PARM WUSARN    WQ0003  6        SAR number fielCAP002
     C                     PARM WUFDY     WQ0004 76        Access obj dummCAP002
      *                                                                   CAP002
     C           *IN90     IFEQ '1'                                       CAP002
      * Call to program ended in error                                    CAP002
     C                     MOVEL'Y2U0032' W0RTN                           CAP002
     C                     MOVEL*BLANKS   W0CLPG 10                       CAP002
     C                     MOVEL'AOSARDR0'W0CLPG                          CAP002
      * Send message '*Error occured on CALL...'                          CAP002
     C                     MOVEL'Y2U0032' ZAMSID                          CAP002
     C                     MOVEL'Y2USRMSG'ZAMSGF                          CAP002
     C                     MOVELW0CLPG    ZAMSDA           Message data   CAP002
     C                     EXSR ZASNMS                                    CAP002
     C                     END                                            CAP002
      *                                                                   CAP002
      * Check to see if APIs are set on.                                  CAP002
      * CASE: WRK.Access Pgm Return Code is *Normal                       CAP002
     C           WUAPRC    IFEQ *BLANK                     *IF            CAP002
     C                     MOVEL'Y'       CAP002  1        APIs           CAP002
     C                     ELSE                                           CAP002
      * CASE: *OTHERWISE                                                  CAP002
     C                     MOVEL'N'       CAP002           APIs           CAP002
     C                     END                             *FI            CAP002
      * API Interface ICD.                                                CAP002
      * CASE: WRK.Switchable Feature CAP002 is Present                    CAP002
     C           CAP002    IFEQ 'Y'                        *IF            CAP002
      * Create API ICD                                                    CAP002
     C                     EXSR TKAPI                                     CAP002
     C                     END                             *FI            CAP002
      *                                                                                       CRT005
      ** Initialize LDA                                                                       CRT005
      *                                                                                       CRT005
     C           *NAMVAR   DEFN           LDA                                                 CRT005
     C           *LOCK     IN   LDA                                                           CRT005
     C                     MOVE *BLANKS   DBFILE                                              CRT005
     C                     MOVE *BLANKS   DBKEY                                               CRT005
     C                     MOVE *BLANKS   DBPGM                                               CRT005
     C                     MOVEL'SD9005X' DBPGM                                               CRT005
     C                     OUT  LDA                                                           CRT005
      *                                                                                       CRT005
      ** Determine if CRT005 is installed                                                     CRT005
      *                                                                                       CRT005
     C                     CALL 'AOSARDR0'                                                    CRT005
     C                     PARM *BLANKS   PRTCD   7                                           CRT005
     C                     PARM '*VERIFY 'POPTN   7                                           CRT005
     C                     PARM 'CRT005'  PSARD   6                                           CRT005
     C           SCSARD    PARM SCSARD    DSFDY                                               CRT005
      *                                                                                       CRT005
     C           PRTCD     IFNE *BLANKS                                                       CRT005
     C           PRTCD     ANDNE'*NRF   '                                                     CRT005
     C           *LOCK     IN   LDA                                                           CRT005
     C                     MOVEL'SCSARDPD'DBFILE                                              CRT005
     C                     Z-ADD1         DBASE                                               CRT005
     C                     MOVEL'CRT005'  DBKEY                                               CRT005
     C                     OUT  LDA                                                           CRT005
     C                     EXSR *PSSR                                                         CRT005
     C                     ENDIF                                                              CRT005
      *                                                                                       CRT005
     C           PRTCD     IFEQ *BLANKS                                                       CRT005
     C                     MOVE 'Y'       CRT005  1                                           CRT005
     C                     ELSE                                                               CRT005
     C                     MOVE 'N'       CRT005                                              CRT005
     C                     ENDIF                                                              CRT005
      *                                                                                     MD030956
      ** Check if CTI006 is enabled                                                         MD030956
      *                                                                                     MD030956
     C                     CALL 'AOSARDR0'                                                  MD030956
     C                     PARM *BLANKS   PRTCD                                             MD030956
     C                     PARM '*VERIFY 'POPTN                                             MD030956
     C                     PARM 'CTI006'  PSARD                                             MD030956
     C           SCSARD    PARM SCSARD    DSFDY                                             MD030956
      *                                                                                     MD030956
     C           PRTCD     IFNE *BLANKS                                                     MD030956
     C           PRTCD     ANDNE'*NRF   '                                                   MD030956
     C           *LOCK     IN   LDA                                                         MD030956
     C                     MOVEL'SCSARDPD'DBFILE                                            MD030956
     C                     Z-ADD2         DBASE                                             MD030956
     C                     MOVEL'CTI006'  DBKEY                                             MD030956
     C                     OUT  LDA                                                         MD030956
     C                     EXSR *PSSR                                                       MD030956
     C                     ENDIF                                                            MD030956
      *                                                                                     MD030956
     C           PRTCD     IFEQ *BLANKS                                                     MD030956
     C                     MOVE 'Y'       CTI006  1                                         MD030956
     C                     ELSE                                                             MD030956
     C                     MOVE 'N'       CTI006                                            MD030956
     C                     ENDIF                                                            MD030956
      **********                                                                      CLE025 BUG4544
      ***Check*if*CLE025*is*on*****************************************               CLE025 BUG4544
      **********                                                                      CLE025 BUG4544
     C**********           CALL 'AOSARDR0'                                            CLE025 BUG4544
     C**********           PARM *BLANKS   PRTCD                                       CLE025 BUG4544
     C**********           PARM '*VERIFY' POPTN                                       CLE025 BUG4544
     C**********           PARM 'CLE025'  PSARD                                       CLE025 BUG4544
     C********** SCSARD    PARM SCSARD    DSFDY                                       CLE025 BUG4544
      **********                                                                      CLE025 BUG4544
     C********** PRTCD     IFNE *BLANKS                                               CLE025 BUG4544
     C********** PRTCD     ANDNE'*NRF   '                                             CLE025 BUG4544
     C********** *LOCK     IN   LDA                                                   CLE025 BUG4544
     C**********           MOVEL'SCSARDPD'DBFILE                                      CLE025 BUG4544
     C**********           MOVEL'CLE025'  DBKEY                                       CLE025 BUG4544
     C**********           Z-ADD2         DBASE                                       CLE025 BUG4544
     C**********           OUT  LDA                                                   CLE025 BUG4544
     C**********           EXSR *PSSR                                                 CLE025 BUG4544
     C**********           ENDIF                                                      CLE025 BUG4544
      **********                                                                      CLE025 BUG4544
      ***If*CLE025 is on, update Collateral & Credit Control ICD record               CLE025 BUG4544
      **********                                                                      CLE025 BUG4544
     C********** PRTCD     IFEQ *BLANKS                                               CLE025 BUG4544
     C**********           MOVEL'Y'       CLE025  1                                   CLE025 BUG4544
     C**********           EXSR SRCOCC                                                CLE025 BUG4544
     C**********           ELSE                                                       CLE025 BUG4544
     C**********           MOVEL'N'       CLE025                                      CLE025 BUG4544
     C**********           ENDIF                                                      CLE025 BUG4544
      **********                                                                      CGL014 BUG4544
      ***Check*if CGL014 is on                                                        CGL014 BUG4544
      **********                                                                      CGL014 BUG4544
     C**********           CALL 'AOSARDR0'                                            CGL014 BUG4544
     C**********           PARM *BLANKS   PRTCD                                       CGL014 BUG4544
     C**********           PARM '*VERIFY' POPTN                                       CGL014 BUG4544
     C**********           PARM 'CGL014'  PSARD                                       CGL014 BUG4544
     C********** SCSARD    PARM SCSARD    DSFDY                                       CGL014 BUG4544
      **********                                                                      CGL014 BUG4544
     C********** PRTCD     IFNE *BLANKS                                               CGL014 BUG4544
     C********** PRTCD     ANDNE'*NRF   '                                             CGL014 BUG4544
     C********** *LOCK     IN   LDA                                                   CGL014 BUG4544
     C**********           MOVEL'SCSARDPD'DBFILE                                      CGL014 BUG4544
     C**********           MOVEL'CGL014'  DBKEY                                       CGL014 BUG4544
     C**********           Z-ADD3         DBASE                                       CGL014 BUG4544
     C**********           OUT  LDA                                                   CGL014 BUG4544
     C**********           EXSR *PSSR                                                 CGL014 BUG4544
     C**********           ENDIF                                                      CGL014 BUG4544
      **********                                                                      CGL014 BUG4544
      ***If*CGL014 is on, update Collateral & Credit Control ICD record               CGL014 BUG4544
      **********                                                                      CGL014 BUG4544
     C********** PRTCD     IFEQ *BLANKS                                               CGL014 BUG4544
     C**********           MOVEL'Y'       CGL014  1                                   CGL014 BUG4544
     C**********           EXSR SRCOCC                                                CGL014 BUG4544
     C**********           ELSE                                                       CGL014 BUG4544
     C**********           MOVEL'N'       CGL014                                      CGL014 BUG4544
     C**********           ENDIF                                                      CGL014 BUG4544
      **********                                                                      CFX001 BUG4544
      ***Check*if CFX001 is on                                                        CFX001 BUG4544
      **********                                                                      CFX001 BUG4544
     C**********           CALL 'AOSARDR0'                                            CFX001 BUG4544
     C**********           PARM *BLANKS   PRTCD                                       CFX001 BUG4544
     C**********           PARM '*VERIFY' POPTN                                       CFX001 BUG4544
     C**********           PARM 'CFX001'  PSARD                                       CFX001 BUG4544
     C********** SCSARD    PARM SCSARD    DSFDY                                       CFX001 BUG4544
      **********                                                                      CFX001 BUG4544
     C********** PRTCD     IFNE *BLANKS                                               CFX001 BUG4544
     C********** PRTCD     ANDNE'*NRF   '                                             CFX001 BUG4544
     C********** *LOCK     IN   LDA                                                   CFX001 BUG4544
     C**********           MOVEL'SCSARDPD'DBFILE                                      CFX001 BUG4544
     C**********           MOVEL'CFX001'  DBKEY                                       CFX001 BUG4544
     C**********           Z-ADD4         DBASE                                       CFX001 BUG4544
     C**********           OUT  LDA                                                   CFX001 BUG4544
     C**********           EXSR *PSSR                                                 CFX001 BUG4544
     C**********           ENDIF                                                      CFX001 BUG4544
      **********                                                                      CFX001 BUG4544
      ***If*CGL014 is on, update Collateral & Credit Control ICD record               CFX001 BUG4544
      **********                                                                      CFX001 BUG4544
     C********** PRTCD     IFEQ *BLANKS                                               CFX001 BUG4544
     C**********           MOVEL'Y'       CFX001  1                                   CFX001 BUG4544
     C**********           EXSR SRCOCC                                                CFX001 BUG4544
     C**********           ELSE                                                       CFX001 BUG4544
     C**********           MOVEL'N'       CFX001                                      CFX001 BUG4544
     C**********           ENDIF                                                      CFX001 BUG4544
      *                                                                                       CGL014
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Get all Midas Modules - MIDAS Modules  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           BGMODS           Modules
      * Move fields to key list
     C                     MOVE *BLANK    BGMODS           Modules
     C                     MOVEL'MMOD'    BGMODS           Modules
     C           KRSSA     CHAIN@BGREC8              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0096' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * Setup message data for message
     C                     MOVEL'SDMMODPD'ZA0001           Filename
      * Send message 'Database Error (ICD)'
     C                     MOVEL'USR0377' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO SAEXIT                     *QUIT
     C                     GOTO SAEXIT
     C                     END
      *
      * USER: Exit processing
      * PAR = DB1 By name
     C                     MOVELBGMTMI    WUMTMI           Midas/Telex Mod
     C                     MOVELBGSWFT    WUSWFT           SWIFT Funds Tra
     C                     MOVELBGSWST    WUSWST           SWIFT Securitie
     C                     MOVELBGSWCL    WUSWCL           SWIFT Customer
     C                     MOVELBGSWSL    WUSWSL           SWIFT Synd Loan
     C                     MOVELBGSWSM    WUSWSM           SWIFT Statement
     C                     MOVELBGSWDL    WUSWDL           SWIFT Dealing
     C                     MOVELBGSDGL    WUSDGL           Standing data/G
     C                     MOVELBGDLFX    WUDLFX           Dealing: FX
     C                     MOVELBGSYLN    WUSYLN           Syndicated Loan
     C                     MOVELBGEXMG    WUEXMG           Exposure Manage
     C                     MOVELBGFNMO    WUFNMO           Financial Model
     C                     MOVELBGSTRT    WUSTRT           Statutory Retur
     C                     MOVELBGCSLN    WUCSLN           Customer Lendin
     C                     MOVELBGRTBN    WURTBN           Retail Banking
     C                     MOVELBGMSDL    WUMSDL           Midas/Swift dir
     C                     MOVELBGSECS    WUSECS           Securities
     C                     MOVELBGAURC    WUAURC           Auto-reconcilia
     C                     MOVELBGBDLI    WUBDLI           Bond Dealers In
     C                     MOVELBGDRSD    WUDRSD           DRS Standing Da
     C                     MOVELBGDRCM    WUDRCM           DRS Control mod
     C                     MOVELBGDRFE    WUDRFE           DRS Foreign Exc
     C                     MOVELBGDRMM    WUDRMM           DRS Money Marke
     C                     MOVELBGDRAR    WUDRAR           DRS Arbitrage
     C                     MOVELBGFDTR    WUFDTR           Funds Transfer
     C                     MOVELBGDRCA    WUDRCA           DRS Common Appl
     C                     MOVELBGFUOP    WUFUOP           Futures & Optio
     C                     MOVELBGMTSL    WUMTSL           Midas/Telex Syn
     C                     MOVELBGMTDL    WUMTDL           Midas/Telex Dea
     C                     MOVELBGMTGL    WUMTGL           Midas/Telex Gen
     C                     MOVELBGMTCL    WUMTCL           Midas/Telex Cus
     C                     MOVELBGNWMI    WUNWMI           Message Managem
     C                     MOVELBGFIIN    WUFIIN           FRA/IRS Indicat
     C                     MOVELBGDLMM    WUDLMM           Dealing: MM
     C                     MOVELBGINCN    WUINCN           Internal Contra
     C                     MOVELBGTRMG    WUTRMG           Treasury Manage
     C                     MOVELBGRKMG    WURKMG           Interest Risk M
     C                     MOVELBGTSKY    WUTSKY           Testkey
     C                     MOVELBGMIDQ    WUMIDQ           Midas/Q
     C                     MOVELBGMFIC    WUMFIC           Microfiche
     C                     MOVELBGIOAC    WUIOAC           Interest on acc
     C                     MOVELBGWDPR    WUWDPR           Window processi
     C                     MOVELBGSARP    WUSARP           SAR's processin
     C                     MOVELBGFRIN    WUFRIN           French return i
     C                     MOVELBGLRIN    WULRIN           Lux return indi
     C                     MOVELBGDRIN    WUDRIN           Dutch return in
     C                     MOVELBGGRIN    WUGRIN           German return i
     C                     MOVELBGBRIN    WUBRIN           Belgian return
     C                     MOVELBGIRIN    WUIRIN           Italian return
     C                     MOVELBGSWEI    WUSWEI           Swift External
     C                     MOVELBGPFMG    WUPFMG           Portfolio Manag
     C                     MOVELBGCRMG    WUCRMG           Credit Manageme
     C                     MOVELBGHORP    WUHORP           Head Office Rep
     C                     MOVELBGAVBL    WUAVBL           Average Balance
     C                     MOVELBGMARG    WUMARG           Margins
     C                     MOVELBGCFMT    WUCFMT           Confirmation Ma
     C                     MOVELBGMIMX    WUMIMX           Mimix
     C                     MOVELBGRCFI    WURCFI           Report Control
     C                     MOVELBGAMIN    WUAMIN           Amps Int
     C                     MOVELBGSWRT    WUSWRT           Swiss Returns
     C                     MOVELBGFLND    WUFLND           Fiduciary Loans
     C                     MOVELBGLMCR    WULMCR           Portfolio Lendi
     C                     MOVELBGCNTX    WUCNTX           Cantonal Tax
     C                     MOVELBGSTDU    WUSTDU           Stamp Duty
     C                     MOVELBGUDRS    WUUDRS           Use DRS Shortna
     C                     MOVELBGCHDL    WUCHDL           Chips Dealing
     C                     MOVELBGCHLN    WUCHLN           Chips Lending
     C                     MOVELBGCHOB    WUCHOB           Chips Opening B
     C                     MOVELBGCHIP    WUCHIP           CHIPS
     C                     MOVELBGCHDI    WUCHDI           Chips Direct Li
     C                     MOVELBGOPDK    WUOPDK           Optical Disk
     C                     MOVELBGMBIN    WUMBIN           Multi-branching
     C                     MOVELBGNNST    WUNNST           Leo Data Nucleu
     C                     MOVELBGNOST    WUNOST           Leo Letters of
     C                     MOVELBGNPST    WUNPST           Leo Collections
     C                     MOVELBGNQST    WUNQST           Leo Bills/Finan
     C                     MOVELBGNRST    WUNRST           Leo Bankers Acc
     C                     MOVELBGNSST    WUNSST           Leo Reimburseme
     C                     MOVELBGNTST    WUNTST           Taxes
     C                     MOVELBGNUST    WUNUST           History & Audit
     C                     MOVELBGNVST    WUNVST           Management Acco
     C                     MOVELBGNWST    WUNWST           IBLC Returns
     C                     MOVELBGNXST    WUNXST           Retail 3
     C                     MOVELBGNYST    WUNYST           Interest on Acc
     C                     MOVELBGNZST    WUNZST           Midas Export Da
     C                     MOVELBGN0ST    WUN0ST           Analytical Acco
     C                     MOVELBGN1ST    WUN1ST           User Defined Co
     C                     MOVELBGN2ST    WUN2ST           Midas-Plato Int
     C                     MOVELBGN3ST    WUN3ST           Midas-Trade Inn
     C                     MOVELBGN4ST    WUN4ST           Reserved for La
     C                     MOVELBGN5ST    WUN5ST           Reserved for La
     C                     MOVELBGN6ST    WUN6ST           Reserved for La
     C                     MOVELBGN7ST    WUN7ST           Reserved for La
     C                     MOVELBGN8ST    WUN8ST           Reserved for La
     C                     MOVELBGN9ST    WUN9ST           Reserved for La
     C                     MOVELBGOAST    WUOAST           Reserved for La
     C                     MOVELBGOBST    WUOBST           Reserved for La
     C                     MOVELBGOCST    WUOCST           Reserved for La
     C                     MOVELBGODST    WUODST           Reserved for La
     C                     MOVELBGOEST    WUOEST           Reserved for La
     C                     MOVELBGOFST    WUOFST           Reserved for La
     C                     MOVELBGOGST    WUOGST           Reserved for La
     C                     MOVELBGOHST    WUOHST           Reserved for La
     C                     MOVELBGOIST    WUOIST           Reserved for La
     C                     MOVELBGOJST    WUOJST           Reserved for La
     C                     MOVELBGOKST    WUOKST           Reserved for La
     C                     MOVELBGOLST    WUOLST           Reserved for La
     C                     MOVELBGOMST    WUOMST           Reserved for La
     C                     MOVELBGONST    WUONST           Reserved for La
     C                     MOVELBGOOST    WUOOST           Reserved for La
     C                     MOVELBGOPST    WUOPST           Reserved for La
     C                     MOVELBGOQST    WUOQST           Reserved for La
     C                     MOVELBGORST    WUORST           Reserved for La
     C                     MOVELBGOSST    WUOSST           Reserved for La
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBCRRC    BEGSR
      *================================================================
      * Create Dealing Data - Dealing Data  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BNREEH
     C                     MOVE *BLANK    BNDLDA           Dealing Data
     C                     MOVEL'DEAL'    BNDLDA           Dealing Data
     C                     MOVEL*BLANK    BNACCD           Account Code
     C                     MOVEL*BLANK    BNFRPL           Forward Reval.
     C                     MOVEL*BLANK    BNFTAC           Forward Trade A
     C                     MOVEL*BLANK    BNSWTA           Swap Trade Acco
     C                     MOVEL*BLANK    BNBTCD           Trade Account C
     C                     MOVEL*BLANK    BNBUCD           Trade Account C
     C                     MOVEL*BLANK    BNCYCD           Currency Code
     C                     MOVEL*BLANK    BNCUST           Customer Number
     C                     Z-ADD*ZERO     BNLCD            Last Change Dat
     C                     MOVEL'I'       BNTYLC           Type of Last Ch
     C                     MOVEL'N'       BNMCRI           Maturity Confs.
     C                     MOVEL'N'       BNNAIA           Neg. Assets Int
     C                     Z-ADD*ZERO     BNMCEL           Maturity Confs.
     C                     Z-ADD*ZERO     BNMCTG           Maturity Confs
     C                     MOVEL'N'       BNFRDI           Fwd Reval of De
     C                     Z-ADD*ZERO     BNMBAM           Minimum Brokera
     C                     Z-ADD*ZERO     BNDHRT           Deals Historic
     C                     Z-ADD*ZERO     BNEXRT           Exchange Rate T
     C                     Z-ADD*ZERO     BNHKTR           Hong Kong Tax R
     C                     MOVEL','       BNTHSP           Thousand Separa
     C                     MOVEL'.'       BNDCSP           Decimal Separat
     C                     MOVEL*BLANK    BNCYDL           Base Currency f
     C                     MOVEL*BLANK    BNFXAU           FX Authorisatio
     C                     MOVEL*BLANK    BNFXRA           FX Reauth Amend
     C                     MOVEL*BLANK    BNMMAU           MM Authorisatio
     C                     MOVEL*BLANK    BNMMRA           MM Reauth Amend
     C                     MOVEL*BLANK    BNBKCD           Book Code
     C                     MOVEL'N'       BNBCOP           Book Code Optio
     C                     MOVEL'N'       BNAOIO           Accruals on int
     C                     Z-ADD*ZERO     BNLDIT           Loans/depsts in
     C                     Z-ADD5         BNNWDM           No of working d
     C                     Z-ADD30        BNDLYP           Delay Period fo
     C                     Z-ADD*ZERO     BNLTMD           Last Transmissi
     C                     Z-ADD*ZERO     BNLTMT           Last Transmissi
     C                     MOVEL'N'       BNNTCE           Net FX Customer
     C                     MOVEL'N'       BNNMAM           Net Manual Matc
     C                     MOVEL*BLANK    BNNEAC           Netting Account
     C                     MOVEL'N'       BNNESB           Netting by Sing
     C                     MOVEL*BLANK    BNNPVM                                              CAS001
     C                     MOVEL*BLANK    BNBCYC                                              CAS001
     C                     Z-ADD*ZERO     BNDCMT                                              CAS001
     C                     MOVEL*BLANK    BNBCPL                                              CAS001
      *
      * USER: Processing before Data update
      * Start of Fix E21357
      * Removal of window processing
      * End of Fix E21357
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/COPY Member SD9121RCBU - Dealing Data  *
     C/COPY WNCPYSRC,SD9121RCBU
     C                     END                             *FI
     C           KLCRSB    KLIST
     C                     KFLD           BNDLDA           Dealing Data
      * Check for duplicate primary key
     C           KLCRSB    SETLL@BNREEH                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0206' W0RTN   7
      * Send message 'Dealing Data           EX'
     C                     MOVEL'USR0206' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     END
      *
     C                     WRITE@BNREEH                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/COPY Member SD9121RCAU - Dealing Data  *
     C/COPY WNCPYSRC,SD9121RCAU
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCRRC    BEGSR
      *================================================================
      * Create Trading Data - Trading Data  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BLREEN
     C                     MOVE *BLANK    BLTRAD           Trading
     C                     MOVEL'TRAD'    BLTRAD           Trading
     C                     MOVEL*BLANK    BLACCD           Account Code
     C                     MOVEL*BLANK    BLSRAC           Spot Revaluatio
     C                     MOVEL*BLANK    BLSPTA           Spot Trade Acco
     C                     MOVEL*BLANK    BLCYCD           Currency Code
     C                     MOVEL*BLANK    BLUSCY           US Dollars Curr
     C                     Z-ADD*ZERO     BLLCD            Last Change Dat
     C                     MOVEL'I'       BLTYLC           Type of Last Ch
     C                     MOVEL'N'       BLBRCF           Base Rate Chang
     C                     MOVEL'N'       BLONOC           Ourselves/Nostr
     C                     MOVEL'Y'       BLBNOC           Branch Name on
     C                     MOVEL'B'       BLLCTB           Local ccy nos -
     C                     MOVEL'1'       BLGLSI           GL Stationery I
     C                     MOVEL'1'       BLRSST           Retail Statemen
     C                     MOVEL'1'       BLDLSS           DL Statement St
     C                     MOVEL'1'       BLNSS            Nostro Statemen
     C                     MOVEL'1'       BLCSS            Contingency Stm
     C                     MOVEL'N'       BLFFIN           Federal Funds I
     C                     MOVEL'N'       BLCPBD           C/party Rec. Ba
     C                     MOVEL'N'       BLL2II           2-level Input I
     C                     Z-ADD*ZERO     BLSWPY           SWIFT Confirmat
     C                     Z-ADD*ZERO     BLCHPY           CHIPS Confirmat
     C                     Z-ADD*ZERO     BLCPPY           CHAPS Confirmat
     C                     Z-ADD*ZERO     BLTXPY           TELEX Confirmat
     C                     Z-ADD*ZERO     BLFDPY           FEDWIRE Confirm
     C                     Z-ADD*ZERO     BLBAPY           BANKWIRE Confir
     C                     MOVEL*BLANK    BLADCY           Australian Doll
      *
     C           KLCRSC    KLIST
     C                     KFLD           BLTRAD           Trading
      * Check for duplicate primary key
     C           KLCRSC    SETLL@BLREEN                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0202' W0RTN   7
      * Send message 'Trading Data           EX'
     C                     MOVEL'USR0202' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     END
      *
     C                     WRITE@BLREEN                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
      * USER: Processing if Data update error
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * CASE: WRK.Window processing requir. is Yes
     C           WUWDPR    IFEQ 'Y'                        *IF
      * 00/Copy member SD9231RCBW - Trading Data  *
     C*
     C/COPY WNCPYSRC,SD9231RCBW
     C*
     C                     END                             *FI
      * 00/Copy member SD9231RCBU - Trading Data  *
     C*
     C/COPY WNCPYSRC,SD9231RCBU
     C*
     C                     END                             *FI
     C                     ELSE
      * USER: Processing after Data update
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy member SD9231RCAU - Trading Data  *
     C*
     C/COPY WNCPYSRC,SD9231RCAU
     C*
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCRRC    BEGSR
      *================================================================
      * Create Dealing Data - Dealing Data  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BNREEH
     C                     MOVE *BLANK    BNDLDA           Dealing Data
     C                     MOVEL'DEAL'    BNDLDA           Dealing Data
     C                     MOVEL*BLANK    BNACCD           Account Code
     C                     MOVEL*BLANK    BNFRPL           Forward Reval.
     C                     MOVEL*BLANK    BNFTAC           Forward Trade A
     C                     MOVEL*BLANK    BNSWTA           Swap Trade Acco
     C                     MOVEL*BLANK    BNBTCD           Trade Account C
     C                     MOVEL*BLANK    BNBUCD           Trade Account C
     C                     MOVEL*BLANK    BNCYCD           Currency Code
     C                     MOVEL*BLANK    BNCUST           Customer Number
     C                     Z-ADD*ZERO     BNLCD            Last Change Dat
     C                     MOVEL'I'       BNTYLC           Type of Last Ch
     C                     MOVEL'N'       BNMCRI           Maturity Confs.
     C                     MOVEL'N'       BNNAIA           Neg. Assets Int
     C                     Z-ADD*ZERO     BNMCEL           Maturity Confs.
     C                     Z-ADD*ZERO     BNMCTG           Maturity Confs
     C                     MOVEL'N'       BNFRDI           Fwd Reval of De
     C                     Z-ADD*ZERO     BNMBAM           Minimum Brokera
     C                     Z-ADD*ZERO     BNDHRT           Deals Historic
     C                     Z-ADD*ZERO     BNEXRT           Exchange Rate T
     C                     Z-ADD*ZERO     BNHKTR           Hong Kong Tax R
     C                     MOVEL','       BNTHSP           Thousand Separa
     C                     MOVEL'.'       BNDCSP           Decimal Separat
     C                     MOVEL*BLANK    BNCYDL           Base Currency f
     C                     MOVEL*BLANK    BNFXAU           FX Authorisatio
     C                     MOVEL*BLANK    BNFXRA           FX Reauth Amend
     C                     MOVEL*BLANK    BNMMAU           MM Authorisatio
     C                     MOVEL*BLANK    BNMMRA           MM Reauth Amend
     C                     MOVEL*BLANK    BNBKCD           Book Code
     C                     MOVEL'N'       BNBCOP           Book Code Optio
     C                     MOVEL'N'       BNAOIO           Accruals on int
     C                     Z-ADD*ZERO     BNLDIT           Loans/depsts in
     C                     Z-ADD5         BNNWDM           No of working d
     C                     Z-ADD30        BNDLYP           Delay Period fo
     C                     Z-ADD*ZERO     BNLTMD           Last Transmissi
     C                     Z-ADD*ZERO     BNLTMT           Last Transmissi
     C                     MOVEL'N'       BNNTCE           Net FX Customer
     C                     MOVEL'N'       BNNMAM           Net Manual Matc
     C                     MOVEL*BLANK    BNNEAC           Netting Account
     C                     MOVEL'N'       BNNESB           Netting by Sing
     C                     MOVEL*BLANK    BNNPVM                                              CAS001
     C                     MOVEL*BLANK    BNBCYC                                              CAS001
     C                     Z-ADD*ZEROS    BNDCMT                                              CAS001
     C                     MOVEL*BLANK    BNBCPL                                              CAS001
      *
      * USER: Processing before Data update
      * Start of Fix E21357
      * Removal of window processing
      * End of Fix E21357
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/COPY Member SD9121RCBU - Dealing Data  *
     C/COPY WNCPYSRC,SD9121RCBU
     C                     END                             *FI
     C           KLCRSD    KLIST
     C                     KFLD           BNDLDA           Dealing Data
      * Check for duplicate primary key
     C           KLCRSD    SETLL@BNREEH                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0206' W0RTN   7
      * Send message 'Dealing Data           EX'
     C                     MOVEL'USR0206' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     END
      *
     C                     WRITE@BNREEH                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/COPY Member SD9121RCAU - Dealing Data  *
     C/COPY WNCPYSRC,SD9121RCAU
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECRRC    BEGSR
      *================================================================
      * Create Trading Data - Trading Data  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BLREEN
     C                     MOVE *BLANK    BLTRAD           Trading
     C                     MOVEL'TRAD'    BLTRAD           Trading
     C                     MOVEL*BLANK    BLACCD           Account Code
     C                     MOVEL*BLANK    BLSRAC           Spot Revaluatio
     C                     MOVEL*BLANK    BLSPTA           Spot Trade Acco
     C                     MOVEL*BLANK    BLCYCD           Currency Code
     C                     MOVEL*BLANK    BLUSCY           US Dollars Curr
     C                     Z-ADD*ZERO     BLLCD            Last Change Dat
     C                     MOVEL'I'       BLTYLC           Type of Last Ch
     C                     MOVEL'N'       BLBRCF           Base Rate Chang
     C                     MOVEL'N'       BLONOC           Ourselves/Nostr
     C                     MOVEL'Y'       BLBNOC           Branch Name on
     C                     MOVEL'B'       BLLCTB           Local ccy nos -
     C                     MOVEL'1'       BLGLSI           GL Stationery I
     C                     MOVEL'1'       BLRSST           Retail Statemen
     C                     MOVEL'1'       BLDLSS           DL Statement St
     C                     MOVEL'1'       BLNSS            Nostro Statemen
     C                     MOVEL'1'       BLCSS            Contingency Stm
     C                     MOVEL'N'       BLFFIN           Federal Funds I
     C                     MOVEL'N'       BLCPBD           C/party Rec. Ba
     C                     MOVEL'N'       BLL2II           2-level Input I
     C                     Z-ADD*ZERO     BLSWPY           SWIFT Confirmat
     C                     Z-ADD*ZERO     BLCHPY           CHIPS Confirmat
     C                     Z-ADD*ZERO     BLCPPY           CHAPS Confirmat
     C                     Z-ADD*ZERO     BLTXPY           TELEX Confirmat
     C                     Z-ADD*ZERO     BLFDPY           FEDWIRE Confirm
     C                     Z-ADD*ZERO     BLBAPY           BANKWIRE Confir
     C                     MOVEL*BLANK    BLADCY           Australian Doll
      *
     C           KLCRSE    KLIST
     C                     KFLD           BLTRAD           Trading
      * Check for duplicate primary key
     C           KLCRSE    SETLL@BLREEN                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0202' W0RTN   7
      * Send message 'Trading Data           EX'
     C                     MOVEL'USR0202' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     END
      *
     C                     WRITE@BLREEN                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
      * USER: Processing if Data update error
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * CASE: WRK.Window processing requir. is Yes
     C           WUWDPR    IFEQ 'Y'                        *IF
      * 00/Copy member SD9231RCBW - Trading Data  *
     C*
     C/COPY WNCPYSRC,SD9231RCBW
     C*
     C                     END                             *FI
      * 00/Copy member SD9231RCBU - Trading Data  *
     C*
     C/COPY WNCPYSRC,SD9231RCBU
     C*
     C                     END                             *FI
     C                     ELSE
      * USER: Processing after Data update
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy member SD9231RCAU - Trading Data  *
     C*
     C/COPY WNCPYSRC,SD9231RCAU
     C*
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCRRC    BEGSR
      *================================================================
      * Create Sec. Trading - Securities Trading Data  *
      *================================================================
      * Clear all neither parameters
     C                     MOVEL*BLANK    WN0001  2        Default Portfol
     C                     MOVEL*BLANK    WN0002  2        Default Transfe
     C                     MOVEL*BLANK    WN0003  3        E/C Belgian Fra
     C                     MOVEL*BLANK    WN0004  3        E/C Deutsch Mar
     C                     MOVEL*BLANK    WN0005  3        E/C Japanese Ye
     C                     MOVEL*BLANK    WN0006  3        Euroclear Curre
     C                     MOVEL*BLANK    WN0007  6        Depot Ref 3, Ka
     C                     MOVEL*BLANK    WN0008  6        Depot Reference
     C                     MOVEL*BLANK    WN0009  6        Depot Reference
     C                     MOVEL*BLANK    WN0010  6        Depot Reference
     C                     MOVEL*BLANK    WN0011  6        Depot Reference
     C                     MOVEL*BLANK    WN0012  6        Depot Reference
     C                     MOVEL*BLANK    WN0013  6        Depot Reference
     C                     MOVEL*BLANK    WN0014  6        Depot Reference
     C                     MOVEL*BLANK    WN0015  6        Depot Reference
     C                     MOVEL*BLANK    WN0016  2        Default Market
     C                     MOVEL*BLANK    WN0017  2        Default Portfol
     C                     MOVEL*BLANK    WN0018  1        Realised Profit
     C                     MOVEL*BLANK    WN0019  1        Unrealised Prof
     C                     MOVEL*BLANK    WN0020  1        Unrealised Prof
     C                     MOVEL*BLANK    WN0021  1        Adjust Unrealis
     C                     MOVEL*BLANK    WN0022  1        Summarise Daily
     C                     MOVEL*BLANK    WN0023  1        FIFO Accounting
     C                     MOVEL*BLANK    WN0024  1        Split Purchased
     C                     MOVEL*BLANK    WN0025  1        Split Negative
     C                     MOVEL*BLANK    WN0026  1        Trade Subtypes
     C                     MOVEL*BLANK    WN0027  1        Convertible Ind
     C                     MOVEL*BLANK    WN0028  1        Negative positi
     C                     MOVEL*BLANK    WN0029  1        General Disc/Pr
     C                     MOVEL*BLANK    WN0030  1        Suppress keys o
     C                     MOVEL*BLANK    WN0031  1        Post no Stnd De
     C                     MOVEL*BLANK    WN0032  1        Cross Currency
     C                     Z-ADD*ZERO     WN0033 130       Settlement Desc
     C                     MOVEL*BLANK    WN0034  1        Autopost Positi
     C                     MOVEL*BLANK    WN0035  1        Mark to Market
     C                     Z-ADD*ZERO     WN0036  20       Mark to Market
     C                     Z-ADD*ZERO     WN0037  50       Mark to Market
     C                     MOVEL*BLANK    WN0038  1        Reallowance ban
     C                     MOVEL*BLANK    WN0039  1        Charges in bank
     C                     Z-ADD*ZERO     WN0040 130       Settlement Desc
     C                     MOVEL*BLANK    WN0041  1        Commission in b
     C                     MOVEL*BLANK    WN0042  1        Reallowance cus
     C                     MOVEL*BLANK    WN0043  1        Charges in cust
     C                     MOVEL*BLANK    WN0044  1        Commission in c
     C                     Z-ADD*ZERO     WN0045  30       Back value peri
     C                     Z-ADD*ZERO     WN0046  20       Retention of se
     C                     Z-ADD*ZERO     WN0047  20       Retention of di
     C                     Z-ADD*ZERO     WN0048  20       Retention of ma
     C                     MOVEL*BLANK    WN0049  1        Euclid
     C                     MOVEL*BLANK    WN0050  1        Auto-transmissi
     C                     MOVEL*BLANK    WN0051  1        Dealing Events
     C                     MOVEL*BLANK    WN0052  1        FI Collateral I
     C                     MOVEL*BLANK    WN0053  1        Reprompt defaul
     C                     MOVEL*BLANK    WN0054  1        Trade/Value Dat
     C                     MOVEL*BLANK    WN0055  1        Trade/Value Col
     C                     Z-ADD*ZERO     WN0056  30       Collateral Curr
     C                     Z-ADD*ZERO     WN0057  30       Foreign Exchang
     C                     MOVEL*BLANK    WN0058  1        Market/Book Exp
     C                     Z-ADD*ZERO     WN0059  30       All Holdings Li
     C                     Z-ADD*ZERO     WN0060  30       Discretionary L
     C                     Z-ADD*ZERO     WN0061  30       Customers Limit
     C                     MOVEL*BLANK    WN0062  1        Redemptions on
     C                     MOVEL*BLANK    WN0063  1        Redemptions in
     C                     MOVEL*BLANK    WN0064  2        Default brokera
     C                     MOVEL*BLANK    WN0065  1        Extel Option
     C                     MOVEL*BLANK    WN0066  1        Trading Confirm
     C                     MOVEL*BLANK    WN0067  1        Trade & Book Po
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BVREFE
     C                     MOVE *BLANK    BVSCTR           Securities Trad
     C                     MOVEL'STRD'    BVSCTR           Securities Trad
     C                     MOVEL*BLANK    BVDMKS           Default Market
     C                     MOVEL*BLANK    BVCCCY           Cedel Currency
     C                     MOVEL*BLANK    BVDR1            Depot 1 (EUROCL
     C                     MOVEL*BLANK    BVATBK           Agency Trading
     C                     Z-ADD*ZERO     BVLCD            Last Change Dat
     C                     MOVEL'I'       BVTYLC           Type of Last Ch
     C                     MOVEL'N'       BVBIOP           Bulk Input Opti
     C                     MOVEL'N'       BVACOP           Autocharge Opti
     C                     MOVEL*BLANK    BVRDOT           Reprompt Defaul
     C**********           MOVEL*BLANK    BVAUTH           Trade Authorisa                  BUG12434
     C                     MOVEL'00'      BVAUTH                                            BUG12434
     C                     MOVEL*BLANK    BVCHRC           SE charges curr
     C                     MOVEL*BLANK    BVACSD           Adjust Comm s/d
     C                     MOVEL*BLANK    BVDEAT           Default Agency
     C                     MOVEL*BLANK    BVRVBT           Review Bulk Tra
     C                     MOVEL*BLANK    BVATPC           Allow Trades P/
     C                     MOVEL'N'       BVCUIN           Safe Custody Fe
     C                     MOVEL*BLANK    BVPBDF           Priority of Bra
     C                     MOVEL*BLANK    BVPCSD           Priority of Cus
     C                     MOVEL*BLANK    BVPIDF           Priority of Inv
     C                     MOVEL*BLANK    BVPMDF           Priority of Mar
     C                     MOVEL*BLANK    BVPOCD           Priority of Cus
     C                     MOVEL'N'       BVTKIF           Telekurs Interf
     C                     Z-ADD*ZERO     BVROPS           Retention of Po
     C                     MOVEL*BLANK    BVERCU           Early Redemptio
     C                     Z-ADD*ZERO     BVTRNR           Trade Number Ra
     C                     MOVEL*BLANK    BVSEPC           SE Profit Centr
      *
     C           KLCRSF    KLIST
     C                     KFLD           BVSCTR           Securities Trad
      * Check for duplicate primary key
     C           KLCRSF    SETLL@BVREFE                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0240' W0RTN   7
      * Send message 'Securities Trading Dat EX'
     C                     MOVEL'USR0240' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     END
      *
     C                     WRITE@BVREFE                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     END
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCRRC    BEGSR
      *================================================================
      * Create Trading Data - Trading Data  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BLREEN
     C                     MOVE *BLANK    BLTRAD           Trading
     C                     MOVEL'TRAD'    BLTRAD           Trading
     C                     MOVEL*BLANK    BLACCD           Account Code
     C                     MOVEL*BLANK    BLSRAC           Spot Revaluatio
     C                     MOVEL*BLANK    BLSPTA           Spot Trade Acco
     C                     MOVEL*BLANK    BLCYCD           Currency Code
     C                     MOVEL*BLANK    BLUSCY           US Dollars Curr
     C                     Z-ADD*ZERO     BLLCD            Last Change Dat
     C                     MOVEL'I'       BLTYLC           Type of Last Ch
     C                     MOVEL'N'       BLBRCF           Base Rate Chang
     C                     MOVEL'N'       BLONOC           Ourselves/Nostr
     C                     MOVEL'Y'       BLBNOC           Branch Name on
     C                     MOVEL'B'       BLLCTB           Local ccy nos -
     C                     MOVEL'1'       BLGLSI           GL Stationery I
     C                     MOVEL'1'       BLRSST           Retail Statemen
     C                     MOVEL'1'       BLDLSS           DL Statement St
     C                     MOVEL'1'       BLNSS            Nostro Statemen
     C                     MOVEL'1'       BLCSS            Contingency Stm
     C                     MOVEL'N'       BLFFIN           Federal Funds I
     C                     MOVEL'N'       BLCPBD           C/party Rec. Ba
     C                     MOVEL'N'       BLL2II           2-level Input I
     C                     Z-ADD*ZERO     BLSWPY           SWIFT Confirmat
     C                     Z-ADD*ZERO     BLCHPY           CHIPS Confirmat
     C                     Z-ADD*ZERO     BLCPPY           CHAPS Confirmat
     C                     Z-ADD*ZERO     BLTXPY           TELEX Confirmat
     C                     Z-ADD*ZERO     BLFDPY           FEDWIRE Confirm
     C                     Z-ADD*ZERO     BLBAPY           BANKWIRE Confir
     C                     MOVEL*BLANK    BLADCY           Australian Doll
      *
     C           KLCRSG    KLIST
     C                     KFLD           BLTRAD           Trading
      * Check for duplicate primary key
     C           KLCRSG    SETLL@BLREEN                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0202' W0RTN   7
      * Send message 'Trading Data           EX'
     C                     MOVEL'USR0202' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     END
      *
     C                     WRITE@BLREEN                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
      * USER: Processing if Data update error
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * CASE: WRK.Window processing requir. is Yes
     C           WUWDPR    IFEQ 'Y'                        *IF
      * 00/Copy member SD9231RCBW - Trading Data  *
     C*
     C/COPY WNCPYSRC,SD9231RCBW
     C*
     C                     END                             *FI
      * 00/Copy member SD9231RCBU - Trading Data  *
     C*
     C/COPY WNCPYSRC,SD9231RCBU
     C*
     C                     END                             *FI
     C                     ELSE
      * USER: Processing after Data update
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy member SD9231RCAU - Trading Data  *
     C*
     C/COPY WNCPYSRC,SD9231RCAU
     C*
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCRRC    BEGSR
      *================================================================
      * Create Customer Lending - Customer Lending Data  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BPREEQ
     C                     MOVE *BLANK    BPCLND           Customer Lend
     C                     MOVEL'CLND'    BPCLND           Customer Lend
     C                     Z-ADD*ZERO     BPLCD            Last Change Dat
     C                     MOVEL'I'       BPTYLC           Type of Last Ch
     C                     MOVEL'N'       BPBRCF           Base Rate Chang
     C                     MOVEL'N'       BPGEEB           Generate Events
     C                     MOVEL'N'       BPBTIN           Billing Telex I
     C                     Z-ADD*ZERO     BPLGAM           Large Amount
     C                     Z-ADD*ZERO     BPELAP           End of Last Act
     C                     Z-ADD*ZERO     BPPND1           Past Due Notice
     C                     Z-ADD*ZERO     BPPND2           Past Due Notice
     C                     Z-ADD*ZERO     BPPND3           Past Due Notice
     C                     Z-ADD*ZERO     BPPND4           Past Due Notice
     C                     Z-ADD*ZERO     BPPND5           Past Due Notice
     C                     Z-ADD*ZERO     BPPND6           Past Due Notice
     C                     Z-ADD*ZERO     BPPND7           Past Due Notice
     C                     Z-ADD*ZERO     BPPND8           Past Due Notice
     C                     Z-ADD*ZERO     BPDBDY           Default Billing
     C                     Z-ADD*ZERO     BPHRPR           Historic Retent
     C                     MOVEL*BLANK    BPDBKC           Default Book Co
     C                     Z-ADD*ZERO     BPEFRP           Exp. Fac. Reten
     C                     MOVEL'N'       BPGIAV           Guarantees Issu
     C                     MOVEL'Y'       BPDASI           Default Auto-se
     C                     MOVEL'N'       BPCONR           Consolidated Co
     C                     MOVEL'Y'       BPFAAU           Facilities to b
     C                     MOVEL'Y'       BPLOAU           Loans to be Aut
     C                     MOVEL'Y'       BPPPAU           Parts Purch to
     C                     MOVEL'Y'       BPPSAU           Parts Sold to b
     C                     MOVEL'Y'       BPROAU           Rollovers to be
     C                     MOVEL'Y'       BPLMAU           Loan Amends to
     C                     MOVEL'Y'       BPMRAU           Manual Reps to
     C                     MOVEL'Y'       BPREAU           Repay Schds to
     C                     MOVEL'Y'       BPTPAU           Trnsfr Prin to
     C                     MOVEL'Y'       BPFEAU           Fees to be Auth
     C                     MOVEL'Y'       BPFSAU           Fees Settmt to
     C                     MOVEL'Y'       BPGUAU           Guarnt/Coll to
     C                     MOVEL'Y'       BPFAAM           Faclty Amds to
     C                     MOVEL'Y'       BPFAUT           Man Fac Uts to
     C                     MOVEL'Y'       BPCAAU           Credit Apls to
     C                     Z-ADD*ZERO     BPGRPR           Grace Days for
     C                     Z-ADD*ZERO     BPGRIR           Grace Days for
     C                     MOVEL*BLANKS   BPBCPL                                              CAS001
     C                     MOVEL'Y'       BPFJAU           Fee Adjustments                    CGP001
      *
      * USER: Processing before Data update
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/COPY member SD9111RCBW - Customer Lending Data  *
     C/COPY WNCPYSRC,SD9111RCBW
     C                     END                             *FI
      * 00/COPY member SD9111RCBU - Customer Lending Data  *
     C/COPY WNCPYSRC,SD9111RCBU
     C           KLCRSH    KLIST
     C                     KFLD           BPCLND           Customer Lend
      * Check for duplicate primary key
     C           KLCRSH    SETLL@BPREEQ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0214' W0RTN   7
      * Send message 'Customer Lending Data  EX'
     C                     MOVEL'USR0214' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     END
      *
     C                     WRITE@BPREEQ                91  *
     C/COPY WNCPYSRC,SD9005XC01
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/COPY member SD9111RCAU - Customer Lending Data  *
     C/COPY WNCPYSRC,SD9111RCAU
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICRRC    BEGSR
      *================================================================
      * Create Trading Data - Trading Data  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BLREEN
     C                     MOVE *BLANK    BLTRAD           Trading
     C                     MOVEL'TRAD'    BLTRAD           Trading
     C                     MOVEL*BLANK    BLACCD           Account Code
     C                     MOVEL*BLANK    BLSRAC           Spot Revaluatio
     C                     MOVEL*BLANK    BLSPTA           Spot Trade Acco
     C                     MOVEL*BLANK    BLCYCD           Currency Code
     C                     MOVEL*BLANK    BLUSCY           US Dollars Curr
     C                     Z-ADD*ZERO     BLLCD            Last Change Dat
     C                     MOVEL'I'       BLTYLC           Type of Last Ch
     C                     MOVEL'N'       BLBRCF           Base Rate Chang
     C                     MOVEL'N'       BLONOC           Ourselves/Nostr
     C                     MOVEL'Y'       BLBNOC           Branch Name on
     C                     MOVEL'B'       BLLCTB           Local ccy nos -
     C                     MOVEL'1'       BLGLSI           GL Stationery I
     C                     MOVEL'1'       BLRSST           Retail Statemen
     C                     MOVEL'1'       BLDLSS           DL Statement St
     C                     MOVEL'1'       BLNSS            Nostro Statemen
     C                     MOVEL'1'       BLCSS            Contingency Stm
     C                     MOVEL'N'       BLFFIN           Federal Funds I
     C                     MOVEL'N'       BLCPBD           C/party Rec. Ba
     C                     MOVEL'N'       BLL2II           2-level Input I
     C                     Z-ADD*ZERO     BLSWPY           SWIFT Confirmat
     C                     Z-ADD*ZERO     BLCHPY           CHIPS Confirmat
     C                     Z-ADD*ZERO     BLCPPY           CHAPS Confirmat
     C                     Z-ADD*ZERO     BLTXPY           TELEX Confirmat
     C                     Z-ADD*ZERO     BLFDPY           FEDWIRE Confirm
     C                     Z-ADD*ZERO     BLBAPY           BANKWIRE Confir
     C                     MOVEL*BLANK    BLADCY           Australian Doll
      *
     C           KLCRSI    KLIST
     C                     KFLD           BLTRAD           Trading
      * Check for duplicate primary key
     C           KLCRSI    SETLL@BLREEN                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0202' W0RTN   7
      * Send message 'Trading Data           EX'
     C                     MOVEL'USR0202' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     END
      *
     C                     WRITE@BLREEN                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
      * USER: Processing if Data update error
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * CASE: WRK.Window processing requir. is Yes
     C           WUWDPR    IFEQ 'Y'                        *IF
      * 00/Copy member SD9231RCBW - Trading Data  *
     C*
     C/COPY WNCPYSRC,SD9231RCBW
     C*
     C                     END                             *FI
      * 00/Copy member SD9231RCBU - Trading Data  *
     C*
     C/COPY WNCPYSRC,SD9231RCBU
     C*
     C                     END                             *FI
     C                     ELSE
      * USER: Processing after Data update
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy member SD9231RCAU - Trading Data  *
     C*
     C/COPY WNCPYSRC,SD9231RCAU
     C*
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCRRC    BEGSR
      *================================================================
      * Create Futures & Opts - Futures & Options Data  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BXREFK
     C                     MOVE *BLANK    BXFOKY           futures & Optio
     C                     MOVEL'FODA'    BXFOKY           futures & Optio
     C                     MOVEL*BLANK    BXACCD           Account Code
     C                     MOVEL*BLANK    BXDCAC           Default Custome
     C                     MOVEL*BLANK    BXBKCD           Book Code
     C                     MOVEL*BLANK    BXDTBC           Default Trading
     C                     Z-ADD*ZERO     BXLCD            Last Change Dat
     C                     MOVEL'I'       BXTYLC           Type of Last Ch
     C                     MOVEL'N'       BXCCC            Customer Charge
     C                     MOVEL'N'       BXHPOE           Hedged position
     C                     Z-ADD*ZERO     BXTFVC           T-bill Face val
     C                     MOVEL'F'       BXLFOI           L/F in FO indic
     C                     Z-ADD*ZERO     BXHSPR           Historical Peri
     C                     MOVEL'N'       BXTBRC           Trade & Book Po
     C                     MOVEL'N'       BXPROT           Process Type on
     C                     MOVEL'N'       BXISTY           Instrument Typ
     C                     MOVEL*BLANK    BXFOPC           FF Profit Centr
     C                     MOVEL'N'       BXFXDG           FX Deal Generat
     C                     MOVEL*BLANK    BXDFDS           Default FX Deal
     C                     MOVEL*BLANK    BXDFDB           Default FX Deal
     C                     Z-ADD*ZERO     BXOTDU           OTC Days Unexpi
      *
      * USER: Processing before Data update
      * Start of Fix E21357
      * Removal of window processing
      * End of Fix E21357
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy member SD9151RCBU - Futures & Options Data  *
     C*
     C/COPY WNCPYSRC,SD9151RCBU
     C*
     C                     END                             *FI
     C           KLCRSJ    KLIST
     C                     KFLD           BXFOKY           futures & Optio
      * Check for duplicate primary key
     C           KLCRSJ    SETLL@BXREFK                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0314' W0RTN   7
      * Send message 'Futures & Options Data EX'
     C                     MOVEL'USR0314' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     END
      *
     C                     WRITE@BXREFK                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy member SD9151RCAU - Futures & Options Data  *
     C/COPY WNCPYSRC,SD9151RCAU
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCRRC    BEGSR
      *================================================================
      * Create Trading Data - Trading Data  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BLREEN
     C                     MOVE *BLANK    BLTRAD           Trading
     C                     MOVEL'TRAD'    BLTRAD           Trading
     C                     MOVEL*BLANK    BLACCD           Account Code
     C                     MOVEL*BLANK    BLSRAC           Spot Revaluatio
     C                     MOVEL*BLANK    BLSPTA           Spot Trade Acco
     C                     MOVEL*BLANK    BLCYCD           Currency Code
     C                     MOVEL*BLANK    BLUSCY           US Dollars Curr
     C                     Z-ADD*ZERO     BLLCD            Last Change Dat
     C                     MOVEL'I'       BLTYLC           Type of Last Ch
     C                     MOVEL'N'       BLBRCF           Base Rate Chang
     C                     MOVEL'N'       BLONOC           Ourselves/Nostr
     C                     MOVEL'Y'       BLBNOC           Branch Name on
     C                     MOVEL'B'       BLLCTB           Local ccy nos -
     C                     MOVEL'1'       BLGLSI           GL Stationery I
     C                     MOVEL'1'       BLRSST           Retail Statemen
     C                     MOVEL'1'       BLDLSS           DL Statement St
     C                     MOVEL'1'       BLNSS            Nostro Statemen
     C                     MOVEL'1'       BLCSS            Contingency Stm
     C                     MOVEL'N'       BLFFIN           Federal Funds I
     C                     MOVEL'N'       BLCPBD           C/party Rec. Ba
     C                     MOVEL'N'       BLL2II           2-level Input I
     C                     Z-ADD*ZERO     BLSWPY           SWIFT Confirmat
     C                     Z-ADD*ZERO     BLCHPY           CHIPS Confirmat
     C                     Z-ADD*ZERO     BLCPPY           CHAPS Confirmat
     C                     Z-ADD*ZERO     BLTXPY           TELEX Confirmat
     C                     Z-ADD*ZERO     BLFDPY           FEDWIRE Confirm
     C                     Z-ADD*ZERO     BLBAPY           BANKWIRE Confir
     C                     MOVEL*BLANK    BLADCY           Australian Doll
      *
     C           KLCRSK    KLIST
     C                     KFLD           BLTRAD           Trading
      * Check for duplicate primary key
     C           KLCRSK    SETLL@BLREEN                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0202' W0RTN   7
      * Send message 'Trading Data           EX'
     C                     MOVEL'USR0202' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     END
      *
     C                     WRITE@BLREEN                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
      * USER: Processing if Data update error
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * CASE: WRK.Window processing requir. is Yes
     C           WUWDPR    IFEQ 'Y'                        *IF
      * 00/Copy member SD9231RCBW - Trading Data  *
     C*
     C/COPY WNCPYSRC,SD9231RCBW
     C*
     C                     END                             *FI
      * 00/Copy member SD9231RCBU - Trading Data  *
     C*
     C/COPY WNCPYSRC,SD9231RCBU
     C*
     C                     END                             *FI
     C                     ELSE
      * USER: Processing after Data update
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy member SD9231RCAU - Trading Data  *
     C*
     C/COPY WNCPYSRC,SD9231RCAU
     C*
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCRRC    BEGSR
      *================================================================
      * Create Retail Details - Retail Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BMREEK
     C                     MOVE *BLANK    BMRETL           Retail
     C                     MOVEL'RETL'    BMRETL           Retail
     C                     MOVEL*BLANK    BMACCD           Account Code
     C                     Z-ADD*ZERO     BMLCD            Last Change Dat
     C                     MOVEL'I'       BMTYLC           Type of Last Ch
     C                     MOVEL'N'       BMLDAI           Last Day Accrua
     C                     MOVEL'N'       BMCBAI           Cleared Balance
     C                     Z-ADD*ZERO     BMNDFV           No. Days Forwar
     C                     MOVEL'N'       BMRCPI           Rate Change Pri
     C                     MOVEL'N'       BMRANR           Retail A/C Nos.
     C                     Z-ADD*ZERO     BMNDBI           No. Days Before
     C                     MOVEL'N'       BMBNRA           Branch name on
      *
     C           KLCRSL    KLIST
     C                     KFLD           BMRETL           Retail
      * Check for duplicate primary key
     C           KLCRSL    SETLL@BMREEK                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0204' W0RTN   7
      * Send message 'Retail Details         EX'
     C                     MOVEL'USR0204' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     END
      *
     C                     WRITE@BMREEK                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     END
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCRRC    BEGSR
      *================================================================
      * Create Retail Details - Retail Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BMREEK
     C                     MOVE *BLANK    BMRETL           Retail
     C                     MOVEL'RETL'    BMRETL           Retail
     C                     MOVEL*BLANK    BMACCD           Account Code
     C                     Z-ADD*ZERO     BMLCD            Last Change Dat
     C                     MOVEL'I'       BMTYLC           Type of Last Ch
     C                     MOVEL'N'       BMLDAI           Last Day Accrua
     C                     MOVEL'N'       BMCBAI           Cleared Balance
     C                     Z-ADD*ZERO     BMNDFV           No. Days Forwar
     C                     MOVEL'N'       BMRCPI           Rate Change Pri
     C                     MOVEL'N'       BMRANR           Retail A/C Nos.
     C                     Z-ADD*ZERO     BMNDBI           No. Days Before
     C                     MOVEL'N'       BMBNRA           Branch name on
      *
     C           KLCRSM    KLIST
     C                     KFLD           BMRETL           Retail
      * Check for duplicate primary key
     C           KLCRSM    SETLL@BMREEK                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0204' W0RTN   7
      * Send message 'Retail Details         EX'
     C                     MOVEL'USR0204' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     END
      *
     C                     WRITE@BMREEK                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     END
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNCRRC    BEGSR
      *================================================================
      * Create General Ledger - General Ledger Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BKREEB
     C                     MOVE *BLANK    BKGNLG           General Ledger
     C                     MOVEL'GELR'    BKGNLG           General Ledger
     C                     MOVEL*BLANK    BKACCD           Account Code
     C                     MOVEL*BLANK    BKPLAC           Profit & Loss A
     C                     MOVEL*BLANK    BKCUST           Customer Number
     C                     Z-ADD*ZERO     BKLCD            Last Change Dat
     C                     MOVEL'I'       BKTYLC           Type of Last Ch
     C                     MOVEL*BLANK    BKBCTF           Base Currency T
     C                     MOVEL'N'       BKAKSI           Accrual Key Sum
     C                     Z-ADD*ZERO     BKAPDT           Accruals/Profit
     C                     MOVEL*BLANK    BKAPFQ           Accruals/Profit
     C                     Z-ADD*ZERO     BKAPFD           Accruals/Profit
     C                     MOVEL'N'       BKALDI           Accrue on Last
     C                     Z-ADD*ZERO     BKAPRP           A/c Posting Ret
     C                     MOVEL'0'       BKANWD           Accrual Non-Wk
     C                     Z-ADD*ZERO     BKSRRP           Spot Rates Rete
     C                     Z-ADD*ZERO     BKBRRP           Base Rates Rete
     C                     MOVEL'N'       BKGLDI           GL Description
     C                     MOVEL'N'       BKPRCU           Profit Centres
     C                     MOVEL'N'       BKPRCA           Profit Centres
     C                     MOVEL'N'       BKPCDU           Profit Centre D
     C                     MOVEL*BLANK    BKPMBK           Prof C Def Matr
     C                     MOVEL*BLANK    BKPMTT           Prof C Def Matr
     C                     MOVEL*BLANK    BKPMST           Prof C Def Matr
     C                     MOVEL*BLANK    BKPMBH           Prof C Def Matr
     C                     MOVEL*BLANK    BKPMDT           Prof C Def Matr
     C                     MOVEL*BLANK    BKPMUR           Prof C Def Matr
     C                     MOVEL*BLANK    BKPMAO           Prof C Def Matr
     C                     MOVEL*BLANK    BKPMCU           Prof C Def Matr
     C                     MOVEL'N'       BKOBRU           Originating Bra
     C                     MOVEL'N'       BKOBUV           Orig Branch/Use
     C                     MOVEL*BLANK    BKJESP           JE Special Char
     C                     MOVEL*BLANK    BKIEBI           JE Int-Bch Ents
     C                     MOVEL*BLANK    BKMABR           Main Branch
     C                     MOVEL*BLANK    BKIEMB           Int-bch Ent Via
     C                     Z-ADD*ZERO     BKELAP           End of Last Act
     C                     Z-ADD*ZERO     BKECAP           End of Current
     C                     MOVEL*BLANK    BKDSFC           Default Stateme
     C                     MOVEL*BLANK    BKFCTF           Foreign CCY Tra
     C                     MOVEL*BLANK    BKFCRC           FC Tfr to Retai
     C                     MOVEL*BLANK    BKPSET           Periodic Proces
     C                     Z-ADD*ZERO     BKJREP           Journal Retenti
     C                     MOVEL'N'       BKMHTN           Mand Batch Tot/
      *
     C           KLCRSN    KLIST
     C                     KFLD           BKGNLG           General Ledger
      * Check for duplicate primary key
     C           KLCRSN    SETLL@BKREEB                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0200' W0RTN   7
      * Send message 'General Ledger Details EX'
     C                     MOVEL'USR0200' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SNEXIT
     C                     END
      *
     C                     WRITE@BKREEB                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     END
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCRRC    BEGSR
      *================================================================
      * Create Bank Details - Bank Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BJREEE
     C                     MOVE *BLANK    BJBANK           Bank
     C                     MOVEL'BANK'    BJBANK           Bank
     C                     MOVEL*BLANK    BJCNCD           Country Code
     C                     MOVEL*BLANK    BJCYCD           Currency Code
     C                     MOVEL*BLANK    BJHOCY           Head Office Cur
     C                     MOVEL*BLANK    BJLCCY           Local Currency
     C                     MOVEL*BLANK    BJSBRC           Single Branch C
     C                     MOVEL*BLANK    BJCUST           Customer Number
     C                     MOVEL*BLANK    BJSLCD           System Location
     C                     Z-ADD*ZERO     BJRDNB           Run day number
     C                     Z-ADD*ZERO     BJLCD            Last Change Dat
     C                     MOVEL'I'       BJTYLC           Type of Last Ch
     C                     MOVEL'N'       BJSUC            Set Up Complete
     C                     MOVEL'D'       BJDFIN           Date Format Ind
     C                     MOVE *BLANK    BJMRDT           Midas Run Date
     C                     MOVEL'*zero'   BJMRDT           Midas Run Date
     C                     Z-ADD*ZERO     BJDNWD           Date of Next Wo
     C                     Z-ADD*ZERO     BJEYD            End of Year Dat
     C                     Z-ADD*ZERO     BJPEYD           Previous End of
     C                     Z-ADD*ZERO     BJBVPD           Back Value Peri
     C                     MOVEL*BLANK    BJURPT           User Report Tit
     C                     MOVEL'N'       BJPCFU           Password Chg Fc
     C                     Z-ADD*ZERO     BJPCFQ           Password Change
     C                     MOVEL'Y'       BJMDEL           Allow Manual De
     C                     MOVEL'Y'       BJMODT           Apply Modulus 1
      *
      * USER: Processing before Data update
      * Window processing
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * Window processing - window on
      * CASE: WRK.Window processing requir. is Yes
     C           WUWDPR    IFEQ 'Y'                        *IF
      * 00/COPY Member SD9101RCBW - Bank Details  *
     C/COPY WNCPYSRC,SD9101RCBW
     C                     END                             *FI
     C                     END                             *FI
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/COPY Member SD9101RCBU - Bank Details  *
     C/COPY WNCPYSRC,SD9101RCBU
     C                     END                             *FI
     C           KLCRSO    KLIST
     C                     KFLD           BJBANK           Bank
      * Check for duplicate primary key
     C           KLCRSO    SETLL@BJREEE                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0198' W0RTN   7
      * Send message 'Bank Details           EX'
     C                     MOVEL'USR0198' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     END
      *
     C                     WRITE@BJREEE                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * Window processing
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/COPY Member SD9101RCAU - Bank Details  *
     C/COPY WNCPYSRC,SD9101RCAU
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPCRRC    BEGSR
      *================================================================
      * Create FRA/IRS - Fwd Rate Agmt/Int Rate Sw  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BQREET
     C                     MOVE *BLANK    BQFIDT           FRA/IRS Details
     C                     MOVEL'FAIS'    BQFIDT           FRA/IRS Details
     C                     MOVEL*BLANK    BQFIDB           FRA/IRS Enq.Def
     C                     MOVEL*BLANK    BQFTBC           FRA Trading Boo
     C                     MOVEL*BLANK    BQITBC           IRS Trading Boo
     C                     Z-ADD*ZERO     BQLCD            Last Change Dat
     C                     MOVEL'I'       BQTYLC           Type of Last Ch
     C                     MOVEL'N'       BQHFRA           Hedged FRA Accr
     C                     Z-ADD*ZERO     BQFLPC           FRA Lower End P
     C                     Z-ADD*ZERO     BQFUPC           FRA Upper End P
     C                     Z-ADD*ZERO     BQFUPD           FRA Upper End P
     C                     Z-ADD*ZERO     BQFLPD           FRA Lower End P
     C                     Z-ADD*ZERO     BQILPC           IRS Lower End P
     C                     Z-ADD*ZERO     BQIUPC           IRS Upper End P
     C                     Z-ADD*ZERO     BQIUEP           IRS Upper End P
     C                     Z-ADD*ZERO     BQILEP           IRS Lower End P
     C                     MOVEL'D'       BQCRFH           CCY for rate fi
     C                     MOVEL*BLANK    BQISDA           Version of ISDA
     C                     MOVEL*BLANK    BQAGTY           Type of ISDA ag
     C                     MOVE *BLANK    BQAGDT           Date of ISDA Ag
     C                     MOVEL'*ZERO'   BQAGDT           Date of ISDA Ag
     C                     MOVEL*BLANK    BQAGVV           Version of ISDA
      *
      * USER: Processing before Data update
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/COPY Member SD9161RCBU - Fwd Rate Agmt/Int Rate Sw  * S01216
     C*
     C/COPY WNCPYSRC,SD9161RCBU
     C*
     C                     END                             *FI
     C           KLCRSP    KLIST
     C                     KFLD           BQFIDT           FRA/IRS Details
      * Check for duplicate primary key
     C           KLCRSP    SETLL@BQREET                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0216' W0RTN   7
      * Send message 'Fwd Rate Agmt/Int Rate EX'
     C                     MOVEL'USR0216' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     END
      *
     C                     WRITE@BQREET                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/COPY Member SD9161RCAU - Fwd Rate Agmt/Int Rate Sw  * S01216
     C*
     C/COPY WNCPYSRC,SD9161RCAU
     C*
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQCRRC    BEGSR
      *================================================================
      * Create Message Management - Message Management  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @ENREKZ
     C                     MOVE *BLANK    ENMGME           Message Managem
     C                     MOVEL'MGME'    ENMGME           Message Managem
     C                     Z-ADD*ZERO     ENLCD            Last Change Dat
     C                     MOVEL'I'       ENTYLC           Type of Last Ch
     C                     Z-ADD*ZERO     ENDSMN           Drop SWIFT Msgs
     C                     MOVEL*BLANK    ENPRUS           Protocol Used
     C                     MOVEL'N'       ENVPM            Verify Payment
     C                     MOVEL'N'       ENFFCR           Free Format Con
     C                     MOVEL'N'       ENFFAR           Free Format Adv
     C                     MOVEL'N'       ENAPRG           Auto Pay/Rec Ge
     C                     MOVEL'N'       ENSPFR           SWIFT Postings
     C                     MOVEL'N'       ENTSDC           Transmit Stmnt
     C                     MOVEL*BLANK    ENM1NQ           Q for Normal MT
     C                     MOVEL*BLANK    ENM2NQ           Q for Normal MT
     C                     MOVEL*BLANK    ENM3NQ           Q for Normal MT
     C                     MOVEL*BLANK    ENM4NQ           Q for Normal MT
     C                     MOVEL*BLANK    ENM5NQ           Q for Normal MT
     C                     MOVEL*BLANK    ENM6NQ           Q for Normal MT
     C                     MOVEL*BLANK    ENM7NQ           Q for Normal MT
     C                     MOVEL*BLANK    ENM8NQ           Q for Normal MT
     C                     MOVEL*BLANK    ENM9NQ           Q for Normal MT
     C                     MOVEL*BLANK    ENM1UQ           Q for Urgent MT
     C                     MOVEL*BLANK    ENM2UQ           Q for Urgent MT
     C                     MOVEL*BLANK    ENM3UQ           Q for Urgent MT
     C                     MOVEL*BLANK    ENM4UQ           Q for Urgent MT
     C                     MOVEL*BLANK    ENM5UQ           Q for Urgent MT
     C                     MOVEL*BLANK    ENM6UQ           Q for Urgent MT
     C                     MOVEL*BLANK    ENM7UQ           Q for Urgent MT
     C                     MOVEL*BLANK    ENM8UQ           Q for Urgent MT
     C                     MOVEL*BLANK    ENM9UQ           Q for Urgent MT
     C                     MOVEL*BLANK    ENUSER           Merva/2 User Pr
     C                     MOVEL*BLANK    ENPASS           Merva/2 Passwor
     C                     MOVEL'1'       ENLOGL           API Logging Lev
     C                     MOVEL'N'       ENOGON           Outgoing Only F
     C                     Z-ADD*ZERO     ENSPLO           Polling Freqncy
     C                     Z-ADD*ZERO     ENSPLI           Polling Freqncy
     C                     MOVE *BLANK    ENSRFO           Remote Filename
     C                     MOVEL'*blank'  ENSRFO           Remote Filename
     C                     MOVE *BLANK    ENSRFI           Remote Filnm pa
     C                     MOVEL'*blank'  ENSRFI           Remote Filnm pa
     C                     MOVE *BLANK    ENSPHO           Remote Path Nam
     C                     MOVEL'*blank'  ENSPHO           Remote Path Nam
     C                     MOVE *BLANK    ENSPHI           Remote Path Nam
     C                     MOVEL'*blank'  ENSPHI           Remote Path Nam
     C                     MOVE *BLANK    ENSAIP           Alliance Host N
     C                     MOVEL'*blank'  ENSAIP           Alliance Host N
     C                     MOVE *BLANK    ENSUSR           Alliance User I
     C                     MOVEL'*blank'  ENSUSR           Alliance User I
     C                     MOVE *BLANK    ENSPWD           Alliance Passwo
     C                     MOVEL'*blank'  ENSPWD           Alliance Passwo
     C                     MOVEL'OS/2'    ENFRMT           Merva Oper.Sys 110533
      *
     C           KLCRSQ    KLIST
     C                     KFLD           ENMGME           Message Managem
      * Check for duplicate primary key
     C           KLCRSQ    SETLL@ENREKZ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1628' W0RTN   7
      * Send message 'Message Management     EX'
     C                     MOVEL'USR1628' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SQEXIT
     C                     END
      *
     C                     WRITE@ENREKZ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     END
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRCRRC    BEGSR
      *================================================================
      * Create Midas/Telex - Midas/Telex Data  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BRREE9
     C                     MOVE *BLANK    BRMTXK           Midas Telex Key
     C                     MOVEL'MTLX'    BRMTXK           Midas Telex Key
     C                     Z-ADD*ZERO     BRLCD            Last Change Dat
     C                     MOVEL'I'       BRTYLC           Type of Last Ch
     C                     MOVEL'N'       BRVPM            Verify Payment
      *
     C           KLCRSR    KLIST
     C                     KFLD           BRMTXK           Midas Telex Key
      * Check for duplicate primary key
     C           KLCRSR    SETLL@BRREE9                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0223' W0RTN   7
      * Send message 'Midas/Telex Data       EX'
     C                     MOVEL'USR0223' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SREXIT
     C                     END
      *
     C                     WRITE@BRREE9                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     END
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCRRC    BEGSR
      *================================================================
      * Create Funds Transfer - Funds Transfer Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BTREE3
     C                     MOVE *BLANK    BTFTD            Funds Transfer
     C                     MOVEL'FTFR'    BTFTD            Funds Transfer
     C                     Z-ADD*ZERO     BTLCD            Last Change Dat
     C                     MOVEL'I'       BTTYLC           Type of Last Ch
     C                     MOVEL'N'       BTLVJN           Level Joiner
     C                     MOVEL'B'       BTCHCY           Charges Currenc
     C                     MOVEL*BLANK    BTMSCS           Message Creatio
     C                     MOVEL*BLANK    BTAFTM           Autocreation of
     C                     MOVEL*BLANK    BTIOSA           Inward/Outward
     C                     Z-ADD*ZERO     BTOVCP           Overdue Cheque
     C                     Z-ADD*ZERO     BTMAHP           Matured Held Pe
     C                     Z-ADD*ZERO     BTAUDT           Audit Threshold
     C                     Z-ADD*ZERO     BTPCRD           Percent. Rate D
      *
     C           KLCRSS    KLIST
     C                     KFLD           BTFTD            Funds Transfer
      * Check for duplicate primary key
     C           KLCRSS    SETLL@BTREE3                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0227' W0RTN   7
      * Send message 'Funds Transfer Details EX'
     C                     MOVEL'USR0227' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     END
      *
     C                     WRITE@BTREE3                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     END
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STCRRC    BEGSR
      *================================================================
      * Create Exposure Managemen - Exposure Management Data  *
      *================================================================
      * Clear all neither parameters
     C                     MOVEL*BLANK    WN0068  1        Issuer Risk Fac
     C                     MOVEL*BLANK    WN0069  1        Portfolio Holdi
     C                     MOVEL*BLANK    WN0070  1        Long/Short Hold
     C                     MOVEL*BLANK    WN0071  1        Portfolio to in
     C                     MOVEL*BLANK    WN0072  1        Counterparty Ta
     C                     MOVEL*BLANK    WN0073  1        Allow for Pay C
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BUREE0
     C                     MOVE *BLANK    BUEXMK           Exposure Manage
     C                     MOVEL'EXPM'    BUEXMK           Exposure Manage
     C                     MOVEL*BLANK    BUCYCD           Currency Code
     C                     Z-ADD*ZERO     BULCD            Last Change Dat
     C                     MOVEL'I'       BUTYLC           Type of Last Ch
     C                     Z-ADD*ZERO     BUUPWT           Update Wait Tim
     C                     Z-ADD*ZERO     BUMSFX           Mod. Seq. for F
     C                     Z-ADD*ZERO     BUMSMM           Mod. Seq. for M
     C                     Z-ADD*ZERO     BUMSFR           Mod. Seq. for F
     C                     Z-ADD*ZERO     BUMSLN           Mod. Seq. for L
     C                     Z-ADD*ZERO     BUMSRT           Mod. Seq. for R
     C                     Z-ADD*ZERO     BUMSIR           Mod. Seq. for I
     C                     Z-ADD*ZERO     BUMSSC           Mod. Seq. for S
     C                     Z-ADD*ZERO     BUMSSI           Mod. Seq. for S
     C                     Z-ADD*ZERO     BUMSSP           Mod. Seq. for S
     C                     Z-ADD*ZERO     BUMSFU           Mod. Seq. for F
     C                     Z-ADD*ZERO     BUMSOP           Mod. seq. for O
     C                     MOVEL*BLANK    BUCCSO           Caps/clrs/flrs
     C                     MOVEL*BLANK    BUFONG           FO positions Ne
     C                     MOVEL'N'       BUNTEM           Net FX Exposure
      *
      * USER: Processing before Data update
      * Window processing
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * Window processing - window on
      * CASE: WRK.Window processing requir. is Yes
     C           WUWDPR    IFEQ 'Y'                        *IF
      * 00/COPY Member SD9131RCBW - Exposure Management Data  *
     C/COPY WNCPYSRC,SD9131RCBW
     C                     END                             *FI
      * 00/COPY Member SD9131RCBU - Exposure Management Data  *
     C/COPY WNCPYSRC,SD9131RCBU
     C                     END                             *FI
     C           KLCRST    KLIST
     C                     KFLD           BUEXMK           Exposure Manage
      * Check for duplicate primary key
     C           KLCRST    SETLL@BUREE0                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0229' W0RTN   7
      * Send message 'Exposure Management Da EX'
     C                     MOVEL'USR0229' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO STEXIT
     C                     END
      *
     C                     WRITE@BUREE0                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * Window processing
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/COPY Member SD9131RCAU - Exposure Management Data  *
     C/COPY WNCPYSRC,SD9131RCAU
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUCRRC    BEGSR
      *================================================================
      * Create RCF Data - RCF Data  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @D0REHV
     C                     MOVE *BLANK    D0RCF            RCF
     C                     MOVEL'RCF'     D0RCF            RCF
     C                     MOVEL'N'       D0OFPR           Office Present
     C                     Z-ADD300       D0DWTI           Distribution Wa
     C                     Z-ADD*ZERO     D0LCD            Last Change Dat
     C                     MOVEL'I'       D0TYLC           Type of Last Ch
     C                     MOVEL'R'       D0UDTA           User Data Optio
      *
     C           KLCRSU    KLIST
     C                     KFLD           D0RCF            RCF
      * Check for duplicate primary key
     C           KLCRSU    SETLL@D0REHV                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0668' W0RTN   7
      * Send message 'RCF Data               EX'
     C                     MOVEL'USR0668' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     END
      *
     C                     WRITE@D0REHV                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     END
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVCRRC    BEGSR
      *================================================================
      * Create Microfiche Data - Microfiche Data  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @D1REHY
     C                     MOVE *BLANK    D1MCFC           Microfiche (Key
     C                     MOVEL'MCFC'    D1MCFC           Microfiche (Key
     C                     MOVEL*BLANK    D1TDEV           Tape Device
     C                     MOVEL*BLANK    D1TVOL           Tape Volume
     C                     MOVEL*BLANK    D1TOWN           Tape Owner
     C                     Z-ADD*ZERO     D1TDEN           Tape Density
     C                     MOVE *BLANK    D1CLTP           Clear Tape
     C                     MOVEL'*NO'     D1CLTP           Clear Tape
     C                     Z-ADD1         D1NOCP           Number of Copie
     C                     Z-ADD133       D1RELN           Record Length
     C                     Z-ADD7980      D1BLLN           Block Length
     C                     MOVEL*BLANK    D1BTJQ           Batch Job Queue
     C                     MOVEL*BLANK    D1JOBD           Job Description
     C                     Z-ADD*ZERO     D1LCD            Last Change Dat
     C                     MOVEL'I'       D1TYLC           Type of Last Ch
     C                     MOVEL'N'       D1AINZ           Allow auto-INZT
     C                     MOVEL'N'       D1HJBQ           Hold on job que
     C                     MOVEL'N'       D1ACLR           Allow Auto-clea
      *
     C           KLCRSV    KLIST
     C                     KFLD           D1MCFC           Microfiche (Key
      * Check for duplicate primary key
     C           KLCRSV    SETLL@D1REHY                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0670' W0RTN   7
      * Send message 'Microfiche Data        EX'
     C                     MOVEL'USR0670' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SVEXIT
     C                     END
      *
     C                     WRITE@D1REHY                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     END
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWCRRC    BEGSR
      *================================================================
      * Create Optical Disk - Optical Disk  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @ODREJ8
     C                     MOVE *BLANK    ODOPTC           Optical Disk (K
     C                     MOVEL'OPTC'    ODOPTC           Optical Disk (K
     C                     MOVEL'N'       ODHJBQ           Hold on job que
     C                     MOVEL'N'       ODACLR           Allow Auto-clea
     C                     MOVEL*BLANK    ODBTJQ           Batch Job Queue
     C                     MOVEL*BLANK    ODJOBD           Job Description
     C                     Z-ADD*ZERO     ODLCD            Last Change Dat
     C                     MOVEL'I'       ODTYLC           Type of Last Ch
     C                     MOVEL'N'       ODDOWN           Download Data O
      *
     C           KLCRSW    KLIST
     C                     KFLD           ODOPTC           Optical Disk (K
      * Check for duplicate primary key
     C           KLCRSW    SETLL@ODREJ8                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1548' W0RTN   7
      * Send message 'Optical Disk           EX'
     C                     MOVEL'USR1548' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SWEXIT
     C                     END
      *
     C                     WRITE@ODREJ8                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     END
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXCRRC    BEGSR
      *================================================================
      * Create History and Audit - History and Audit ICD  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @ETRELS
     C                     MOVE *BLANK    ETHAFD           History and Aud
     C                     MOVEL'HAFD'    ETHAFD           History and Aud
     C                     Z-ADD300       ETWAIT           HAF Monitor Wai
     C                     MOVEL'N'       ETSICI           Start HAF Monit
     C                     MOVEL'N'       ETSSON           Start HAF Monit
     C                     Z-ADD*ZERO     ETLCD            Last Change Dat
     C                     MOVEL'I'       ETTYLC           Type of Last Ch
     C                     MOVEL'N'       ETSAVE           Save HAF data t
     C                     MOVEL*BLANK    ETDEVC           Save device for
      *
     C           KLCRSX    KLIST
     C                     KFLD           ETHAFD           History and Aud
      * Check for duplicate primary key
     C           KLCRSX    SETLL@ETRELS                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1824' W0RTN   7
      * Send message 'History and Audit ICD  EX'
     C                     MOVEL'USR1824' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SXEXIT
     C                     END
      *
     C                     WRITE@ETRELS                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     END
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYCRRC    BEGSR
      *================================================================
      * Create Risk Management IC - Interest Risk Management  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to SDRISKUI
     C                     MOVE *BLANK    EURKEY           RM ICD Data Key
     C                     MOVEL'RISK'    EURKEY           RM ICD Data Key
     C                     MOVEL'Z'       EUFREQ           Extract/Downloa
     C                     Z-ADD*ZERO     EUMTHD           Day of the Mont
     C                     Z-ADD*ZERO     EUNXDT           Next Extract/Do
     C                     Z-ADD*ZERO     EUPRDT           Prev RM Run Dat
     C                     MOVEL*BLANK    EUSFPB           SE FRN Process
     C                     Z-ADD*ZERO     EULCD            Last Change Dat
     C                     MOVEL'I'       EUTYLC           Type of Last Ch
     C                     Z-ADD*ZERO     EUNMDY           Nom Days to Mat
      *
     C           KLCRSY    KLIST
     C                     KFLD           EURKEY           RM ICD Data Key
      * Check for duplicate primary key
     C           KLCRSY    SETLLSDRISKUI                 90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1842' W0RTN   7
      * Send message 'Interest Risk Manageme EX'
     C                     MOVEL'USR1842' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SYEXIT
     C                     END
      *
     C                     WRITESDRISKUI               91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     END
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZCRRC    BEGSR
      *================================================================
      * Create SC ICD Processing - COB Processing  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DOREG0
     C                     MOVE *BLANK    DOCOPK           COB Processing
     C                     MOVEL'COBP'    DOCOPK           COB Processing
     C                     Z-ADD*ZERO     DOLCD            Last Change Dat
     C                     MOVEL'I'       DOTYLC           Type of Last Ch
     C                     MOVEL*BLANK    DOAQCM           Allow QCL after
     C                     MOVEL*BLANK    DORCSP           Run COB separat
     C                     Z-ADD10        DOMNAS           Max.no.active C
     C                     MOVEL'Y'       DODSCP           Disp COB Pmpts
     C                     MOVEL'N'       DOIECS           Initiate ECS
     C                     MOVEL*BLANK    DOTNB1           Bureau Telephon
     C                     MOVEL*BLANK    DOPNB1           ECS Pager Numbe
     C                     MOVEL*BLANK    DOPNB2           ECS Pager Numbe
     C                     MOVEL*BLANK    DOPNB3           ECS Pager Numbe
     C                     MOVEL*BLANK    DOPNB4           ECS Pager Numbe
     C                     MOVEL*BLANK    DOPNB5           ECS Pager Numbe
     C                     MOVEL'N'       DOABIC           Allow Comp Bypa
     C                     MOVEL'N'       DOGUIA           Graphical user
     C                     MOVEL*BLANK    DOCPRF           COB Control Pro
      *
     C           KLCRSZ    KLIST
     C                     KFLD           DOCOPK           COB Processing
      * Check for duplicate primary key
     C           KLCRSZ    SETLL@DOREG0                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1337' W0RTN   7
      * Send message 'COB Processing         EX'
     C                     MOVEL'USR1337' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SZEXIT
     C                     END
      *
     C                     WRITE@DOREG0                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     END
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TACRRC    BEGSR
      *================================================================
      * Create Treasury Managemen - Treasury Management Data  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @ERRELM
     C                     MOVE *BLANK    ERTRMA           Treasury Manage
     C                     MOVEL'TRMA'    ERTRMA           Treasury Manage
     C                     MOVEL*BLANK    ERSPRE           Short P/L Perio
     C                     MOVEL*BLANK    EROVDI           FX Options on V
     C                     Z-ADD*ZERO     ERLCD            Last Change Dat
     C                     MOVEL'I'       ERTYLC           Type of Last Ch
      *
      * USER: Processing before Data update
      * 00/COPY Member SD9291RCBU - Treasury Management Data  *
     C*00/COPY member SD9291R   Processing Before Create
     C/COPY WNCPYSRC,SD9291RCBU
     C           KLCRTA    KLIST
     C                     KFLD           ERTRMA           Treasury Manage
      * Check for duplicate primary key
     C           KLCRTA    SETLL@ERRELM                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1763' W0RTN   7
      * Send message 'Treasury Management Da EX'
     C                     MOVEL'USR1763' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TAEXIT
     C                     END
      *
     C                     WRITE@ERRELM                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * 00/COPY Member SD9291RCAU - Treasury Management Data  *
     C*00/COPY member SD9291R   Processing After Create
     C/COPY WNCPYSRC,SD9291RCAU
     C                     END
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBCRRC    BEGSR
      *================================================================
      * Create Customer Service F - Customer Service Fees ICD  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CSFDL0
     C                     MOVE *BLANK    E4CSFD           Cust Service Fe
     C                     MOVEL'CSFD'    E4CSFD           Cust Service Fe
     C                     Z-ADD*ZERO     E4LCD            Last Change Dat
     C                     MOVEL'I'       E4TYLC           Type of Last Ch
     C                     Z-ADD*ZERO     E4NAMT           CS Fee Num A/c
     C                     MOVEL*BLANK    E4NPFQ           CS Fee Num A/c
     C                     MOVEL*BLANK    E4NACD           CS Fee Num A/c
     C                     Z-ADD*ZERO     E4NCDN           CS Fee Num A/c
     C                     Z-ADD*ZERO     E4NCDT           CS Fee Num A/c
     C                     Z-ADD*ZERO     E4HAMT           CS Fee Hold Mai
     C                     MOVEL*BLANK    E4HPFQ           CS Fee Hold Mai
     C                     MOVEL*BLANK    E4HACD           CS Fee Hold Mai
     C                     Z-ADD*ZERO     E4HCDN           CS Fee Hold Mai
     C                     Z-ADD*ZERO     E4HCDT           CS Fee Hold Mai
      *
      * USER: Processing before Data update
      * Window processing.
      * CASE: WRK.Window processing requir. is Yes
     C           WUWDPR    IFEQ 'Y'                        *IF
      * 00/Copy member SD9351RCBW - Customer Service Fees ICD  *
     C/COPY WNCPYSRC,SD9351RCBW
     C                     END                             *FI
      * 00/Copy member SD9351RCBU - Customer Service Fees ICD  *
     C/COPY WNCPYSRC,SD9351RCBU
     C           KLCRTB    KLIST
     C                     KFLD           E4CSFD           Cust Service Fe
      * Check for duplicate primary key
     C           KLCRTB    SETLL@CSFDL0                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1910' W0RTN   7
      * Send message 'Customer Service Fees  EX'
     C                     MOVEL'USR1910' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TBEXIT
     C                     END
      *
     C                     WRITE@CSFDL0                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * 00/Copy member SD9351RCAU - Customer Service Fees ICD  *
     C/COPY WNCPYSRC,SD9351RCAU
     C                     END
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCCRRC    BEGSR
      *================================================================
      * Create Safe Custody Fees - Safe Custody Fees ICD  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @SCFEL0
     C                     MOVE *BLANK    FBSCFE           Safe Custody Fe
     C                     MOVEL'SCFE'    FBSCFE           Safe Custody Fe
     C                     Z-ADD*ZERO     FBLCD            Last Change Dat
     C                     MOVEL'I'       FBTYLC           Type of Last Ch
     C                     MOVEL*BLANK    FBCFCP           Fees Per Custom
     C                     MOVEL*BLANK    FBFGCP           Fees Group Per
     C                     MOVEL*BLANK    FBAUPI           Auto Posting In
     C                     MOVEL*BLANK    FBBCGC           Bank Charging C
     C                     Z-ADD*ZERO     FBINCA           Income A/c Code
     C                     Z-ADD*ZERO     FBAACT           Accrual Account
     C                     Z-ADD*ZERO     FBSGDY           Settlement Gen
     C                     Z-ADD*ZERO     FBNSGD           Next Settlement
     C                     MOVEL*BLANK    FBAFRQ           Accrual Frequen
     C                     Z-ADD*ZERO     FBADYM           Accrual Day in
     C                     Z-ADD*ZERO     FBANDA           Next Accrual Da
     C                     MOVEL*BLANK    FBSFRE           Settlement Freq
     C                     Z-ADD*ZERO     FBSDYM           Settlement Day
     C                     Z-ADD*ZERO     FBSNDA           Next Settlement
     C                     Z-ADD*ZERO     FBLCRD           Last Accrual Da
     C                     Z-ADD*ZERO     FBCCRD           Current Accrual
     C                     MOVEL*BLANK    FBPCSF           Pft Cntr For Sa
      *
     C           KLCRTC    KLIST
     C                     KFLD           FBSCFE           Safe Custody Fe
      * Check for duplicate primary key
     C           KLCRTC    SETLL@SCFEL0                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2243' W0RTN   7
      * Send message 'Safe Custody Fees ICD  EX'
     C                     MOVEL'USR2243' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TCEXIT
     C                     END
      *
     C                     WRITE@SCFEL0                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     END
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDCRRC    BEGSR
      *================================================================
      * Create Midas Export Data - Midas export data ICD  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @MEXPL0
     C                     MOVE *BLANK    E7MEXP           Midas Export Da
     C                     MOVEL'MEXP'    E7MEXP           Midas Export Da
     C                     Z-ADD*ZERO     E7LCD            Last Change Dat
     C                     MOVEL'I'       E7TYLC           Type of Last Ch
     C                     MOVEL'N'       E7DFEN           Drip Feed Trans
     C                     Z-ADD07200     E7DFWT           Drip Feed Wait
     C                     Z-ADD3599      E7DFMR           Drip Feed Max R
     C                     MOVEL'N'       E7BUEN           Bulk Transfer E
     C                     Z-ADD3999      E7BUMR           Bulk Transfer M
     C                     Z-ADD3         E7DFRP           Drip Feed Batch
      *
     C           KLCRTD    KLIST
     C                     KFLD           E7MEXP           Midas Export Da
      * Check for duplicate primary key
     C           KLCRTD    SETLL@MEXPL0                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2016' W0RTN   7
      * Send message 'Midas export data ICD  EX'
     C                     MOVEL'USR2016' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TDEXIT
     C                     END
      *
     C                     WRITE@MEXPL0                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     END
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TECRRC    BEGSR
      *================================================================
      * Create Portfolio Manageme - Portfolio Management ICD  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @PORTL0
     C                     MOVE *BLANK    FCPORT           Portfolio Manag
     C                     MOVEL'PORT'    FCPORT           Portfolio Manag
     C                     MOVEL*BLANK    FCLIAB           Liabilities Inc
     C                     MOVEL*BLANK    FCHLVS           High Level Secu
     C                     MOVEL*BLANK    FCTVPS           Trade/Value Dat
     C                     MOVEL*BLANK    FCDP97           Dsp Non-Portfol
     C                     MOVEL*BLANK    FCR997           Ref Attached to
     C                     MOVEL*BLANK    FCN997           Narr Attached t
     C                     MOVEL*BLANK    FCDP98           Dsp Consolidate
     C                     MOVEL*BLANK    FCR998           Ref Attached to
     C                     MOVEL*BLANK    FCN998           Narr Attached t
     C                     MOVEL*BLANK    FCR999           Ref Attached to
     C                     MOVEL*BLANK    FCN999           Narr Attached t
     C                     Z-ADD*ZERO     FCCDYB           Charging Day Ba
     C                     Z-ADD*ZERO     FCCDVB           Charging Diviso
     C                     Z-ADD*ZERO     FCLCD            Last Change Dat
     C                     MOVEL'I'       FCTYLC           Type of Last Ch
     C                     MOVEL*BLANK    FCDINR           Default Instrum
     C                     MOVEL*BLANK    FCLICD           Local Industry
     C                     MOVEL*BLANK    FCCNCD           Country Code
     C                     MOVEL*BLANK    FCSHFC           Show Fees and C
     C                     MOVEL*BLANK    FCSHCC           Show Capital Ch
     C                     MOVEL*BLANK    FCUIIC           Unearned Int in
     C                     MOVEL*BLANK    FCPPPR           Pool Portfolio
     C                     MOVEL*BLANK    FCRDCI           Retain Deleted
     C                     MOVEL*BLANK    FCRCCS           Report Cap Chgs
     C                     Z-ADD*ZERO     FCADIF           Acceptable Diff
     C                     MOVEL'C'       FCPORS           Portfolios Supp
     C                     MOVEL'N'       FCSAVI           Save Notional F
     C                     MOVEL*BLANK    FCNINS           Notional FX Dea
     C                     MOVEL'N'       FCPCAM           Percentage Calc
     C                     MOVEL'P'       FCDCPD           Display Custome
      *
     C           KLCRTE    KLIST
     C                     KFLD           FCPORT           Portfolio Manag
      * Check for duplicate primary key
     C           KLCRTE    SETLL@PORTL0                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2285' W0RTN   7
      * Send message 'Portfolio Management I EX'
     C                     MOVEL'USR2285' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TEEXIT
     C                     END
      *
     C                     WRITE@PORTL0                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     END
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFCRRC    BEGSR
      *================================================================
      * Create Portfolio Lending - Portfolio Lending ICD  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @LOMBL0
     C                     MOVE *BLANK    LBLBCR           Portfolio Lendi
     C                     MOVEL'LOMB'    LBLBCR           Portfolio Lendi
     C                     MOVEL'I'       LBTYLC           Type of Last Ch
     C                     Z-ADD*ZERO     LBLCD            Last Change Dat
     C                     MOVEL'D'       LBRECI           Record Id
     C                     Z-ADD*ZERO     LBDLUP           Day of last upd
     C                     MOVEL*BLANK    LBMLUP           Month of last u
     C                     Z-ADD*ZERO     LBYLUP           Year of last up
     C                     Z-ADD*ZERO     LBTLUP           Time of last up
     C                     Z-ADD*ZERO     LBORED           Original entry
     C                     MOVEL*BLANK    LBCYCD           Currency Code
     C                     MOVEL*BLANK    LBCMNV           Collateral Mark
     C                     Z-ADD*ZERO     LBPERE           Exposure/Commit
     C                     Z-ADD*ZERO     LBAMTE           Exposure/Commit
     C                     Z-ADD*ZERO     LBFXMP           FX Margin Revie
     C                     Z-ADD*ZERO     LBFXCP           FX Margin %
     C                     Z-ADD*ZERO     LBPERL           Period Review C
     C                     MOVEL*BLANK    LBFRCL           Report Freq Cmt
     C                     MOVEL*BLANK    LBINBP           Pledges Increas
     C                     MOVEL*BLANK    LBPLDC           Pledges Calcula
     C                     MOVEL*BLANK    LBHLDI           Predefined Held
     C                     MOVEL*BLANK    LBCUSI           Predefined Cust
     C                     MOVEL*BLANK    LBPLEG           Predefined Pled
     C                     MOVEL*BLANK    LBGUAR           Predefined Guar
     C                     MOVEL*BLANK    LBCOLI           Predefined Coll
     C                     MOVEL*BLANK    LBSECU           Predefined Secu
     C                     MOVEL*BLANK    LBFXUP           Predefined FX U
     C                     MOVEL*BLANK    LBFXUL           Predefined FX U
     C                     MOVEL*BLANK    LBFXMA           Predefined FX M
     C                     MOVEL*BLANK    LBFXMC           Predefined Marg
     C                     MOVEL*BLANK    LBFXPL           Predefined Clsd
     C                     Z-ADD*ZERO     LBPMMP           PM Margin Revie
     C                     Z-ADD*ZERO     LBPMCP           PM Margin %
     C                     MOVEL*BLANK    LBPMUP           Predefined PM U
     C                     MOVEL*BLANK    LBPMUL           Predefined PM U
     C                     MOVEL*BLANK    LBPMMA           Predefined PM M
     C                     MOVEL*BLANK    LBPMMC           Predefined PM M
     C                     MOVEL*BLANK    LBPMPL           Predefined Clos
     C                     MOVEL*BLANK    LBLIFX           FX Moduler Limi
     C                     MOVEL*BLANK    LBLIPM           PM Moduler Limi
     C                     MOVEL*BLANK    LBLIMM           MM Moduler Limi
     C                     MOVEL*BLANK    LBLILE           LE Moduler Limi
     C                     MOVEL*BLANK    LBLIRE           RE Moduler Limi
     C                     MOVEL*BLANK    LBLCDL           LB Clients DL E
     C                     MOVEL*BLANK    LBLCLE           LB Clients LE E
     C                     MOVEL*BLANK    LBLCRT           LB Clients RE E
     C                     MOVEL*BLANK    LBMGLE           Margin on Limit
      *
     C           KLCRTF    KLIST
     C                     KFLD           LBLBCR           Portfolio Lendi
      * Check for duplicate primary key
     C           KLCRTF    SETLL@LOMBL0                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2287' W0RTN   7
      * Send message 'Portfolio Lending ICD  EX'
     C                     MOVEL'USR2287' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TFEXIT
     C                     END
      *
     C                     WRITE@LOMBL0                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     END
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGCRRC    BEGSR
      *================================================================
      * Create Profit Centre A/C - Profit Centre A/C ICD  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @PCACL0
     C                     MOVE *BLANK    FTPCAI           Profit Centre A
     C                     MOVEL'PCAC'    FTPCAI           Profit Centre A
     C                     Z-ADD*ZERO     FTLCD            Last Change Dat
     C                     MOVEL'I'       FTTYLC           Type of Last Ch
     C                     MOVEL*BLANK    FTPRCG           Primary Control
     C                     MOVEL*BLANK    FTPFGA           Primary Funding
     C                     MOVEL*BLANK    FTFNBR           Funding Base Ra
     C                     MOVEL*BLANK    FTFNIC           Funding Int A/C
     C                     MOVEL*BLANK    FTFNAA           Funding Accrual
     C                     MOVEL*BLANK    FTFGCF           Funding Gap Cap
     C                     MOVEL*BLANK    FTPRFP           Primary Fund Pr
     C                     MOVEL*BLANK    FTEYPC           End of Year P&L
     C                     MOVEL*BLANK    FTUAPC           Unallocated Pro
     C                     Z-ADD*ZERO     FTTFRT           Tol for Funding
     C                     Z-ADD*ZERO     FTTMRT           Tol for FX Marg
     C                     MOVEL*BLANK    FTFMAC           FX Margin Accou
      *
      * USER: Processing before Data update
      * 00/Copy member SD9401RCBU - Profit Centre A/C ICD  *
     C*Profit Centre A/C ICD    Processing Before Create
     C/COPY WNCPYSRC,SD9401RCBU
     C           KLCRTG    KLIST
     C                     KFLD           FTPCAI           Profit Centre A
      * Check for duplicate primary key
     C           KLCRTG    SETLL@PCACL0                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2854' W0RTN   7
      * Send message 'Profit Centre A/C ICD  EX'
     C                     MOVEL'USR2854' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TGEXIT
     C                     END
      *
     C                     WRITE@PCACL0                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * 00/Copy member SD9401RCAU - Profit Centre A/C ICD  *
     C*Profit Centre A/C ICD    Processing After Create
     C/COPY WNCPYSRC,SD9401RCAU
     C                     END
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THCRRC    BEGSR
      *================================================================
      * Create RTS Dft Charges Tr - RTS Dft Charges Tran Type  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @TCHGL0
     C                     MOVE *BLANK    FSTCHG           Default Charge
     C                     MOVEL'TCHG'    FSTCHG           Default Charge
     C                     Z-ADD*ZERO     FSLCD            Last Change Dat
     C                     MOVEL'I'       FSTYLC           Type of Last Ch
     C                     MOVEL'99500'   FSFJIB           FX Buy Default
     C                     MOVEL'99505'   FSFJIS           FX Sell Default
     C                     MOVEL'99510'   FSFJIC           FX Charge Deflt
     C                     MOVEL'99510'   FSF00N           00N Charg Deflt
     C                     MOVEL'99510'   FSF00H           00H Charg Deflt
     C                     MOVEL'99510'   FSF00P           00P Charg Deflt
     C                     MOVEL'99515'   FSF00K           00K Charg Deflt
     C                     MOVEL'99515'   FSF00Q           00Q Charg Deflt
     C                     MOVEL'99510'   FSF00O           00O Charg Deflt
     C                     MOVEL'99510'   FSF00L           00L Charg Deflt
     C                     MOVEL'99510'   FSF0JN           0JN Charg Deflt
     C                     MOVEL'99510'   FSF0JH           0JH Charg Deflt
     C                     MOVEL'99510'   FSF0JP           0JP Charg Deflt
     C                     MOVEL'99515'   FSF0JK           0JK Charg Deflt
     C                     MOVEL'99515'   FSF0JQ           0JQ Charg Deflt
     C                     MOVEL'99510'   FSF0JO           0JO Charg Deflt
     C                     MOVEL'99510'   FSF0JL           0JL Charg Deflt
     C                     MOVEL*BLANK    FSTEPC           Teller Profit C
     C                     MOVEL'99790'   FSFINT           Interbranch Dfl
     C                     MOVEL'99795'   FSFMNB           Main Branch Dfl
      *
     C           KLCRTH    KLIST
     C                     KFLD           FSTCHG           Default Charge
      * Check for duplicate primary key
     C           KLCRTH    SETLL@TCHGL0                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2688' W0RTN   7
      * Send message 'RTS Dft Charges Tran T EX'
     C                     MOVEL'USR2688' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO THEXIT
     C                     END
      *
     C                     WRITE@TCHGL0                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     END
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TICRRC    BEGSR
      *================================================================
      * Create Cashier Intrf ICD - BAI ICD  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BAIIL0
     C                     MOVE *BLANK    FUBAII           BAI ICD Record
     C                     MOVEL'BAII'    FUBAII           BAI ICD Record
     C                     Z-ADD*ZERO     FULCD            Last Change Dat
     C                     MOVEL'I'       FUTYLC           Type of Last Ch
     C                     MOVE *BLANK    FUPROD           Retail Banking
     C                     MOVEL'CASHIER' FUPROD           Retail Banking
     C                     MOVEL*BLANK    FUCOMP           Communications
     C                     MOVEL*BLANK    FUCOMM           Communications
     C                     Z-ADD*ZERO     FUCONV           No. Convs for C
     C                     MOVEL'Y'       FUINIT           Start BAI at I/
     C                     MOVE *BLANK    FUJBDE           Job Description
     C                     MOVEL'CIJOBD'  FUJBDE           Job Description
     C                     MOVE *BLANK    FUJBQU           Job Queue to us
     C                     MOVEL'CIJOBQ'  FUJBQU           Job Queue to us
     C                     MOVE *BLANK    FUCLSS           Class to use
     C                     MOVEL'CICLASS' FUCLSS           Class to use
     C                     MOVEL'Y'       FUBALE           Retail A/c Bala
     C                     MOVEL@CN,01    FUBALP           Retail A/c Bal
     C                     MOVEL'Y'       FURTFR           Retail A/c Tran
     C                     MOVEL@CN,02    FUTFRP           Retail A/c Tran
     C                     MOVEL'Y'       FUCDAC           Cash Dep in A/c
     C                     MOVEL@CN,03    FUCDAP           Cash Dep In A/c
     C                     MOVEL'Y'       FUCQDA           Chq Dep in A/c
     C                     MOVEL@CN,04    FUCQDP           Chq Dep In A/c
     C                     MOVEL'Y'       FUCDNC           Cash Dep in Non
     C                     MOVEL@CN,05    FUCDNP           Cash Dep Non A/
     C                     MOVEL'Y'       FUCQNA           Chq Dep in Non
     C                     MOVEL@CN,06    FUCQNP           Chq Dep Non A/c
     C                     MOVEL'Y'       FUCWAC           Cash Wdl in A/c
     C                     MOVEL@CN,07    FUCWAP           Cash Wdl In A/c
     C                     MOVEL'Y'       FUCWNA           Cash Wdl in Non
     C                     MOVEL@CN,08    FUCWNP           Cash Wdl Non A/
     C                     MOVEL'Y'       FUCQWA           Chq Wdl in A/c
     C                     MOVEL@CN,09    FUCQWP           Chq Wdl In A/c
     C                     MOVEL'Y'       FUCQWN           Chq Wdl in Non
     C                     MOVEL@CN,10    FUCQWQ           Chq Wdl Non A/c
     C                     MOVEL'Y'       FUBDCT           Bureau De Chang
     C                     MOVEL@CN,11    FUBDCP           Bureau De Chang
     C                     MOVEL'Y'       FUBTC            Buy Traveller's
     C                     MOVEL@CN,12    FUBTCP           Buy Traveller's
     C                     MOVEL'Y'       FUSTC            Sell Traveller'
     C                     MOVEL@CN,12    FUSTCP           Sell Traveller'
     C                     MOVEL'Y'       FUTXRV           Transaction Rev
     C                     MOVEL@CN,13    FUTXRP           Transaction Rev
     C                     MOVEL'Y'       FUPUPD           Passbook Update
     C                     MOVEL@CN,14    FUPUPP           Passbook Update
     C                     MOVEL'Y'       FUPNAD           Passbook Name &
     C                     MOVEL@CN,15    FUPNAP           Passbook Name/A
     C                     MOVEL'Y'       FUDISS           Draft Issue
     C                     MOVEL@CN,16    FUDISP           Draft Issue Pgm
      *                                                                                       CRT005
     C           CRT005    IFEQ 'Y'                                                           CRT005
     C                     MOVEL'Y'       FUTCI                                               CRT005
     C                     MOVEL@CN,18    FUTCIP                                              CRT005
     C                     MOVEL'Y'       FUTCO                                               CRT005
     C                     MOVEL@CN,19    FUTCOP                                              CRT005
     C                     MOVEL'Y'       FUTTI                                               CRT005
     C                     MOVEL@CN,20    FUTTIP                                              CRT005
     C                     MOVEL'Y'       FUTTO                                               CRT005
     C                     MOVEL@CN,21    FUTTOP                                              CRT005
      *                                                                                       CRT005
     C                     MOVE *BLANKS   FUOUAC                                              CRT005
      *                                                                                       CRT005
     C                     ENDIF                                                              CRT005
      *
     C           KLCRTI    KLIST
     C                     KFLD           FUBAII           BAI ICD Record
      * Check for duplicate primary key
     C           KLCRTI    SETLL@BAIIL0                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2891' W0RTN   7
      * Send message 'BAI ICD               EX'
     C                     MOVEL'USR2891' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TIEXIT
     C                     END
      *
     C                     WRITE@BAIIL0                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     END
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJCRRC    BEGSR
      *================================================================
      * Create Fontis Interface I - Fontis Interface ICD  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FONTL0
     C                     MOVE *BLANK    F8FONT           Fontis Interfac
     C                     MOVEL'FONT'    F8FONT           Fontis Interfac
     C                     Z-ADD*ZERO     F8DNFQ           Download Freque
     C                     MOVE *BLANK    F8HOST           Fontis Server H
     C                     MOVEL'*blank'  F8HOST           Fontis Server H
     C                     MOVE *BLANK    F8MUFS           Midas User on F
     C                     MOVEL'*blank'  F8MUFS           Midas User on F
     C                     MOVE *BLANK    F8PASW           Password for Mi
     C                     MOVEL'*blank'  F8PASW           Password for Mi
     C                     MOVE *BLANK    F8PATH           Fontis Servr Dt
     C                     MOVEL'*blank'  F8PATH           Fontis Servr Dt
     C                     Z-ADD3         F8RTRY           Maximum no. of
     C                     Z-ADD15        F8HSTP           History Retenti
     C                     Z-ADD*ZERO     F8LCD            Last Change Dat
     C                     MOVEL'I'       F8TYLC           Type of Last Ch
      *
     C           KLCRTJ    KLIST
     C                     KFLD           F8FONT           Fontis Interfac
      * Check for duplicate primary key
     C           KLCRTJ    SETLL@FONTL0                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3186' W0RTN   7
      * Send message 'Fontis Interface ICD   EX'
     C                     MOVEL'USR3186' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TJEXIT
     C                     END
      *
     C                     WRITE@FONTL0                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     END
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     C***SR******TKCRRC    BEGSR                                          CPL002
      *================================================================
      * Create Plato Interface IC - Plato Interface ICD  *
      *================================================================
     C***********          MOVEL*BLANK    W0RTN   7                       CPL002
      **Move*all*fields to @MPICL0                                        CPL002
     C***********          MOVE *BLANK    TOIDKY           Plato InterfaceCPL002
     C***********          MOVEL'MPIC'    TOIDKY           Plato InterfaceCPL002
     C***********          MOVEL*BLANK    TOIDEF           Plato Extract FCPL002
     C***********          Z-ADD*ZERO     TOIDED           Plato Next ExtrCPL002
     C***********          Z-ADD*ZERO     TOIDNL           Plato Nom Days-CPL002
     C***********          Z-ADD*ZERO     TOIDNE           Plato Nom Mths-CPL002
     C***********          Z-ADD*ZERO     TOIDNC           Plato Nom Mths-CPL002
     C***********          MOVEL*BLANK    TOIDCS           Plato Mtch InstCPL002
     C***********          MOVEL*BLANK    TOIDIS           Plato Match InsCPL002
     C***********          MOVEL*BLANK    TOIDCM           Plato Mtch InstCPL002
     C***********          MOVEL*BLANK    TOIDIM           Plato Match InsCPL002
     C***********          MOVEL*BLANK    TOIDCG           Plato Mtch InstCPL002
     C***********          MOVEL*BLANK    TOIDIG           Plato Match InsCPL002
     C***********          MOVEL*BLANK    TOIDCI           Plato Mtch InstCPL002
     C***********          MOVEL*BLANK    TOIDII           Plato Match InsCPL002
     C***********          MOVEL*BLANK    TOIDCR           Plato Mtch InstCPL002
     C***********          MOVEL*BLANK    TOIDIR           Plato Match InsCPL002
     C***********          MOVEL*BLANK    TOIDCF           Plato Mtch InstCPL002
     C***********          MOVEL*BLANK    TOIDIF           Plato Match InsCPL002
     C***********          MOVEL*BLANK    TOIDCO           Plato Mtch InstCPL002
     C***********          MOVEL*BLANK    TOIDIO           Plato Match InsCPL002
     C***********          Z-ADD*ZERO     TOIDMB           Plato Prtf Map CPL002
     C***********          Z-ADD*ZERO     TOIDMO           Plato Prtf Map CPL002
     C***********          Z-ADD*ZERO     TOIDMR           Plato Prtf Map CPL002
     C***********          MOVEL'*ZERO'   TOIDPV           Plato Version NCPL002
     C***********          Z-ADD*ZERO     TOLCD            Last Change DatCPL002
     C***********          MOVEL'I'       TOTYLC           Type of Last ChCPL002
      ***********                                                         CPL002
      **USER:*Processing before Data update                               CPL002
      **00/Copy*Member SD9431RCBU - Plato Interface ICD  *                CPL002
     C*Plato*Intrf ICD Maint    Processing Before Create                  CPL002
     C***/COPY*WNCPYSRC,SD9431RCBU                                        CPL002
     C***********KLCRTK    KLIST                                          CPL002
     C***********          KFLD           TOIDKY           Plato InterfaceCPL002
      **Check*for duplicate primary key                                   CPL002
     C***********KLCRTK    SETLL@MPICL0                  90*              CPL002
     C************IN90     IFEQ '1'                                       CPL002
     C***********          MOVEL'USR3269' W0RTN   7                       CPL002
      **Send*message 'Plato Interface ICD    EX'                          CPL002
     C***********          MOVEL'USR3269' ZAMSID                          CPL002
     C***********          EXSR ZASNMS                                    CPL002
     C***********          GOTO TKEXIT                                    CPL002
     C***********          END                                            CPL002
      ***********                                                         CPL002
     C***********          WRITE@MPICL0                91  *              CPL002
      ***********                                                         CPL002
     C************IN91     IFEQ '1'                                       CPL002
      **Write*error detected                                              CPL002
     C***********          MOVEL'Y2U0004' W0RTN   7                       CPL002
     C***********          ELSE                                           CPL002
      **USER:*Processing after Data update                                CPL002
      **00/Copy*Member SD9431RCAU - Plato Interface ICD  *                CPL002
     C*Plato*Intrf ICD Maint    Processing After Create                   CPL002
     C***/COPY*WNCPYSRC,SD9431RCAU                                        CPL002
     C***********          END                                            CPL002
      *================================================================
     C***SR******TKEXIT    ENDSR
      /EJECT
     CSR         TLCRRC    BEGSR
      *================================================================
      * Create Midas/TI Interface - Midas/TI Interface ICD  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @TIINL0
     C                     MOVE *BLANK    TIINKY           Midas/TI Interf
     C                     MOVEL'TIIN'    TIINKY           Midas/TI Interf
     C                     MOVEL*BLANK    TIBRCH           Branch
     C                     MOVEL*BLANK    TIDEPT           Department
     C                     MOVEL*BLANK    TITRTP           Transaction Typ
     C                     MOVEL*BLANK    TIPRFC           Profit centre c
     C                     MOVEL*BLANK    TIBOOK           Book
     C                     Z-ADD*ZERO     TIMNBS           Minimum Batch S
     C                     Z-ADD*ZERO     TIMXBS           Maximum Batch S
     C                     Z-ADD*ZERO     TILRBN           Lower Range Bat
     C                     Z-ADD*ZERO     TIURBN           Upper Range Bat
     C                     MOVEL'N'       TIREAS           Retail Account
     C                     Z-ADD*ZERO     TIPRWT           Processing Wait
     C***********          MOVEL'N'       TICMNL           Continue COB if                    CTI003
     C                     MOVEL*BLANKS   TIATYP           SP101 Account Type                 CTI099
     C                     MOVEL*BLANKS   TIBCNO           SP101 Basic Number                 CTI099
     C                     MOVEL'N'       TICUSN           TI Cust flag   167480
     C                     Z-ADD*ZERO     TINOSM           No. of SWIFT messages              CTI003
     C                     MOVEL'N'       TIACBB           Accruals check by branch           CTI003
     C                     MOVEL*BLANKS   TIBALA           Balancing Account Code             CTI003
     C                     MOVEL'I'       TITYLC           Type of Last Ch
     C                     Z-ADD*ZERO     TILCD            Last Change Dat
      *
      * USER: Processing before Data update
      * 00/COPY SD9441RCBU - Midas/TI Interface ICD  *
     C/COPY WNCPYSRC,SD9441RCBU
     C           KLCRTL    KLIST
     C                     KFLD           TIINKY           Midas/TI Interf
      * Check for duplicate primary key
     C           KLCRTL    SETLL@TIINL0                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3503' W0RTN   7
      * Send message 'Midas/TI Interface ICD EX'
     C                     MOVEL'USR3503' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TLEXIT
     C                     END
      *
     C                     WRITE@TIINL0                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * 00/COPY SD9441RCAU - Midas/TI Interface ICD  *
     C/COPY WNCPYSRC,SD9441RCAU
     C                     END
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT                                                              CPB001
     CSR         PBCRRC    BEGSR                                          CPB001
      *================================================================   CPB001
      * Create Midas/Private Banking ICD *                                CPB001
      *================================================================   CPB001
     C                     MOVEL*BLANK    W0RTN   7                       CPB001
      * Move all fields to SDTODPF                                        CPB001
     C                     MOVE *BLANK    TQTOID           Midas/TOF Int. CPB001
     C                     MOVEL'TOF'     TQTOID           Midas/TOF Int. CPB001
     C                     Z-ADD*ZERO     TQHSPD           History Period CPB001
     C                     Z-ADD*ZERO     TQBTNB           Starting Batch CPB001
     C**********           Z-ADD*ZERO     TQSCUS           Starting Cust.              CPB001 CSD027
     C**********           Z-ADD*ZERO     TQECUS           Ending Customer             CPB001 CSD027
     C                     MOVE *BLANKS   TQSCUS           Starting Cust.                     CSD027
     C                     MOVE *BLANKS   TQECUS           Ending Customer                    CSD027
     C                     MOVE *BLANKS   TQBRKD           Broker Dealing CPB001
     C                     MOVE *BLANKS   TQBKSE           SE Book Code   CPB001
     C                     MOVE *BLANKS   TQBKDL           DL Book Code   CPB001
     C                     MOVE *BLANKS   TQBKFF           FF Book Code   CPB001
     C                     Z-ADD*ZERO     TQDLNO           Starting Deal  CPB001
     C                     Z-ADD*ZERO     TQTRNR           SE Trade Range CPB001
     C                     MOVE *BLANKS   TQSESN           Dummy Security CPB001
     C**********           Z-ADD*ZERO     TQDSEC           Dum. SE Cust.               CPB001 CSD027
     C                     MOVE *BLANKS   TQDSEC           Dum. SE Cust.                      CSD027
     C                     MOVE *BLANKS   TQCUAU           Cust. Open AutoCPB001
     C**********           MOVE *BLANKS   TQAUBC           Auto. Batch Ac.             CPB001 CPK022
     C                     MOVE *BLANKS   TQACMT           Auto. Complete                     CPK022
      *                                                                   CPB001
      * Check for duplicate primary key                                   CPB001
     C           1         SETLLSDTOFPD                  90*              CPB001
     C           *IN90     IFEQ '1'                                       CPB001
     C                     MOVEL'USR4522' W0RTN   7                       CPB001
      * Send message 'Private Banking ICD exist'                          CPB001
     C                     MOVEL'USR4522' ZAMSID                          CPB001
     C                     EXSR ZASNMS                                    CPB001
     C                     GOTO PBEXIT                                    CPB001
     C                     ENDIF                                          CPB001
      *                                                                   CPB001
     C                     WRITESDTODPF                91  *              CPB001
      *                                                                   CPB001
     C           *IN91     IFEQ '1'                                       CPB001
      * Write error detected                                              CPB001
     C                     MOVEL'Y2U0004' W0RTN   7                       CPB001
     C                     ENDIF                                          CPB001
      *================================================================   CPB001
     CSR         PBEXIT    ENDSR                                          CPB001
      /EJECT
     CSR         MFCRRC    BEGSR                                                              CSD006
      *================================================================                       CSD006
      * Create MDF ICD *                                                                      CSD006
      *================================================================                       CSD006
     C                     MOVEL*BLANK    W0RTN   7                                           CSD006
      * Move all fields to SDMDFCD0                                                           CSD006
     C                     MOVEL'D'       MDRECI                                              CSD006
     C                     MOVEL'MIDAS'   MDTRGI                                              CSD006
     C                     Z-ADD999.99    MDSPTL                                              CSD006
     C                     Z-ADD999.99    MDSRTL                                              CSD006
     C                     Z-ADD999.99    MDFRTL                                              CSD006
     C                     Z-ADD999.99    MDIRTL                                              CSD006
     C                     Z-ADD999.99    MDBRTL                                              CSD006
     C                     MOVEL@CN,17    MDDSPS                                              CSD006
     C                     MOVEL@CN,17    MDDSRS                                              CSD006
     C                     MOVEL@CN,17    MDDFRS                                              CSD006
     C                     MOVEL@CN,17    MDDBOS                                              CSD006
     C                     MOVEL@CN,17    MDDLES                                              CSD006
     C                     MOVEL@CN,17    MDDBRS                                              CSD006
     C                     Z-ADD10        MDHRTP                                              CSD006
     C                     Z-ADD0         MDLCD                                               CSD006
     C                     MOVEL'I'       MDTYLC                                              CSD006
     C                     Z-ADD20        MDTNLU                                              CSD006
      *                                                                                       CSD006
      * Check for duplicate primary key                                                       CSD006
     C           1         SETLLSDMDFCPD                 90*                                  CSD006
     C           *IN90     IFEQ '1'                                                           CSD006
     C                     MOVEL'USR4612' W0RTN   7                                           CSD006
      * Send message 'MDF ICD exist'                                                          CSD006
     C                     MOVEL'USR4612' ZAMSID                                              CSD006
     C                     EXSR ZASNMS                                                        CSD006
     C                     GOTO MFEXIT                                                        CSD006
     C                     ENDIF                                                              CSD006
      *                                                                                       CSD006
     C                     WRITESDMDFCD0               91  *                                  CSD006
      *                                                                                       CSD006
     C           *IN91     IFEQ '1'                                                           CSD006
      * Write error detected                                                                  CSD006
     C                     MOVEL'Y2U0004' W0RTN   7                                           CSD006
     C                     ENDIF                                                              CSD006
      *================================================================                       CSD006
     CSR         MFEXIT    ENDSR                                                              CSD006
      /EJECT                                                                                  CSD006
      *****************************************************************                       CLE025
      *                                                               *                       CLE025
      *  SRCOCC - Create Collateral & Credit Control ICD              *                       CLE025
      *                                                               *                       CLE025
      *****************************************************************                       CLE025
      *                                                                                       CLE025
     C********** SRCOCC    BEGSR                                                      CLE025 BUG4544
      **********                                                                      CLE025 BUG4544
      ***Check*for duplicate primary key                                              CLE025 BUG4544
      **********                                                                      CLE025 BUG4544
     C********** 1         SETLLSDCOCCPD                 90                           CLE025 BUG4544
     C**********           READ SDCOCCPD                 90                           CLE025 BUG4544
      **********                                                                      CLE025 BUG4544
      ***Record*exists                                                                CLE025 BUG4544
      **********                                                                      CLE025 BUG4544
     C********** *IN90     IFEQ *OFF                                                  CLE025 BUG4544
      **********                                                                      CLE025 BUG4544
     C********** CLE025    IFEQ 'Y'                                                   CLE025 BUG4544
     C**********           MOVE 'F'       CCFVFN                                      CLE025 BUG4544
     C**********           ENDIF                                                      CLE025 BUG4544
      **********                                                                      CGL014 BUG4544
     C********** CGL014    IFEQ 'Y'                                                   CGL014 BUG4544
     C**********           MOVE 'M'       CCDCPS                                      CGL014 BUG4544
     C**********           MOVE 'Y'       CCICED                                      CGL014 BUG4544
     C**********           MOVE 'Y'       CCCAKG                                      CGL014 BUG4544
     C**********           ENDIF                                                      CGL014 BUG4544
      **********                                                                      CFX001 BUG4544
     C********** CFX001    IFEQ 'Y'                                                   CFX001 BUG4544
     C**********           MOVE 'F'       CCFVFN                                      CFX001 BUG4544
     C**********           MOVE 'O'       CCMCDO                                      CFX001 BUG4544
     C**********           ENDIF                                                      CFX001 BUG4544
      **********                                                                      CLE025 BUG4544
     C**********           MOVE 'A'       CCTYLC                                      CLE025 BUG4544
      **********                                                                      CLE025 BUG4544
      ***Update*ICD record                                                            CLE025 BUG4544
      **********                                                                      CLE025 BUG4544
     C**********           UPDATSDCOCCD0               91                             CLE025 BUG4544
      **********                                                                      CLE025 BUG4544
      ***Write*error detected                                                         CLE025 BUG4544
      **********                                                                      CLE025 BUG4544
     C********** *IN91     IFEQ '1'                                                   CLE025 BUG4544
     C**********           MOVEL'Y2U0004' W0RTN                                       CLE025 BUG4544
     C**********           ENDIF                                                      CLE025 BUG4544
      **********                                                                      CLE025 BUG4544
      ***No*record found                                                              CLE025 BUG4544
      **********                                                                      CLE025 BUG4544
     C**********           ELSE                                                       CLE025 BUG4544
      **********                                                                      CLE025 BUG4544
      ***Initialise fields                                                            CLE025 BUG4544
      **********                                                                      CLE025 BUG4544
     C********** CLE025    IFEQ 'Y'                                                   CLE025 BUG4544
     C**********           MOVE 'F'       CCFVFN                                      CLE025 BUG4544
     C**********           MOVE *BLANK    CCMCDO                                      CLE025 BUG4544
     C**********           MOVE *BLANK    CCDCPS                                      CLE025 BUG4544
     C**********           MOVE *BLANK    CCICED                                      CLE025 BUG4544
     C**********           MOVE *BLANK    CCCAKG                                      CLE025 BUG4544
     C**********           ENDIF                                                      CLE025 BUG4544
      **********                                                                      CGL014 BUG4544
     C********** CGL014    IFEQ 'Y'                                                   CGL014 BUG4544
     C**********           MOVE *BLANK    CCFVFN                                      CGL014 BUG4544
     C**********           MOVE *BLANK    CCMCDO                                      CGL014 BUG4544
     C**********           MOVE 'M'       CCDCPS                                      CGL014 BUG4544
     C**********           MOVE 'Y'       CCICED                                      CGL014 BUG4544
     C**********           MOVE 'Y'       CCCAKG                                      CGL014 BUG4544
     C**********           ENDIF                                                      CGL014 BUG4544
      **********                                                                      CFX001 BUG4544
     C********** CFX001    IFEQ 'Y'                                                   CFX001 BUG4544
     C**********           MOVE 'F'       CCFVFN                                      CFX001 BUG4544
     C**********           MOVE 'O'       CCMCDO                                      CFX001 BUG4544
     C**********           MOVE *BLANK    CCDCPS                                      CLE025 BUG4544
     C**********           MOVE *BLANK    CCICED                                      CLE025 BUG4544
     C**********           MOVE *BLANK    CCCAKG                                      CLE025 BUG4544
     C**********           ENDIF                                                      CFX001 BUG4544
      **********                                                                      CLE025 BUG4544
     C**********           MOVEL'COCC'    CCCOCC                                      CLE025 BUG4544
     C**********           Z-ADD*ZERO     CCLCD                                       CLE025 BUG4544
     C**********           MOVE 'I'       CCTYLC                                      CLE025 BUG4544
      **********                                                                      CLE025 BUG4544
     C**********           WRITESDCOCCD0               91                             CLE025 BUG4544
      **********                                                                      CLE025 BUG4544
      ***Write*error detected                                                         CLE025 BUG4544
      **********                                                                      CLE025 BUG4544
     C********** *IN91     IFEQ '1'                                                   CLE025 BUG4544
     C**********           MOVEL'Y2U0004' W0RTN                                       CLE025 BUG4544
     C**********           ENDIF                                                      CLE025 BUG4544
      **********                                                                      CLE025 BUG4544
     C**********           ENDIF                                                      CLE025 BUG4544
      **********                                                                      CLE025 BUG4544
     C**********           ENDSR                                                      CLE025 BUG4544
      *                                                                                       CLE025
      *****************************************************************                       CLE025
      /EJECT                                                                                  CLE025
      *****************************************************************                       CLE025
     CSR         TKAPI     BEGSR                                          CAP002
      *================================================================   CAP002
      * Create API ICD                                                    CAP002
      *================================================================   CAP002
     C                     MOVEL*BLANK    W0RTN   7                       CAP002
      * Move all fields to SDAPID0                                        CAP002
     C                     MOVEL'API'     GHAPID                          CAP002
     C                     MOVE 'Y'       GHSTSV                          CAP002
     C                     MOVE 'Y'       GHSTDU                          CAP002
     C                     MOVE 'N'       GHCBSV                          CAP002
     C                     MOVE 'Y'       GHMQIM                          CAP002
     C                     MOVE 'N'       GHPWCR                          CAP002
     C                     MOVE 'N'       GHSTDF                          CAP002
     C                     MOVE 'N'       GHHTIN                          CAP002
     C                     MOVE 'N'       GHHTVL                          CAP002
     C                     MOVE 'N'       GHCLIN                          CAP002
     C                     Z-ADD0         GHRTPD                          CAP002
     C                     Z-ADD0         GHLSCL                          CAP002
     C                     Z-ADD0         GHBINT                          CAP032
     C                     MOVEL'I'       GHTYLC                          CAP006
     C                     Z-ADD*ZERO     GHLCD                           CAP006
      *                                                                   CAP002
      * USER: Processing before API ICD Data update                       CAP002
     C           KLAPI     KLIST                                          CAP002
     C                     KFLD           GHAPID           API ICD key    CAP002
      * Check for duplicate primary key                                   CAP002
     C           KLAPI     SETLLSDAPID0                  90               CAP002
     C           *IN90     IFEQ '1'                                       CAP002
     C                     MOVEL'USR3581' W0RTN   7                       CAP002
      * Send message 'API ICD EXISTS'                                     CAP002
     C                     MOVEL'USR3581' ZAMSID                          CAP002
     C                     EXSR ZASNMS                                    CAP002
     C                     GOTO TKAPIX                                    CAP002
     C                     END                                            CAP002
      *                                                                   CAP002
     C                     WRITESDAPID0                91                 CAP002
      *                                                                   CAP002
     C           *IN91     IFEQ '1'                                       CAP002
      * Write error detected                                              CAP002
     C                     MOVEL'Y2U0004' W0RTN   7                       CAP002
     C                     ELSE                                           CAP002
     C                     END                                            CAP002
      *================================================================   CAP002
     CSR         TKAPIX    ENDSR                                          CAP002
      /EJECT                                                              CAP002
     CSR         UASUBR    BEGSR
      *================================================================
      * RCF Data
      *================================================================
      * RCF module in SDMMODPD will always be on so no need to check
      * its status.
      * Create RCF Data - RCF Data  *
     C                     EXSR SUCRRC
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Microfiche Data
      *================================================================
      * CASE: WRK.Microfiche is Yes
     C           WUMFIC    IFEQ 'Y'                        *IF
      * Start of Error fix LN0573
      * Create Microfiche Data - Microfiche Data  *
     C                     EXSR SVCRRC
      * End of Error fix LN0573
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Optical Disk
      *================================================================
      * CASE: WRK.Optical Disk is Yes
     C           WUOPDK    IFEQ 'Y'                        *IF
      * Create Optical Disk - Optical Disk  *
     C                     EXSR SWCRRC
     C                     END                             *FI
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * History and Audit Facility
      *================================================================
      * CASE: WRK.History & Audit Facility is Yes
     C           WUNUST    IFEQ 'Y'                        *IF
      * Create History and Audit - History and Audit ICD  *
     C                     EXSR SXCRRC
     C                     END                             *FI
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Interest Risk Management
      *================================================================
      * CASE: WRK.Interest Risk Management is Yes
     C           WURKMG    IFEQ 'Y'                        *IF
      * Create Risk Management IC - Interest Risk Management  *
     C                     EXSR SYCRRC
     C                     END                             *FI
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Customer Service Fees switchable feature.
      *================================================================
      * CASE: WRK.Customer Service Fees on is Present
     C           WUKKST    IFEQ 'Y'                        *IF
      * Create Customer Service F - Customer Service Fees ICD  *
     C                     EXSR TBCRRC
     C                     END                             *FI
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Safe Custody Fees.
      *================================================================
      * CASE: WRK.Securities is Yes
     C           WUSECS    IFEQ 'Y'                        *IF
      * Create Safe Custody Fees - Safe Custody Fees ICD  *
     C                     EXSR TCCRRC
     C                     END                             *FI
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * Midas Export Data
      *================================================================
      * CASE: WRK.Eureka Data Import Appln is Yes
     C           WUNZST    IFEQ 'Y'                        *IF
      * Create Midas Export Data - Midas export data ICD  *
     C                     EXSR TDCRRC
     C                     END                             *FI
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * Portfolio Management
      *================================================================
      * CASE: WRK.Portfolio Management is Yes
     C           WUPFMG    IFEQ 'Y'                        *IF
      * Create Portfolio Manageme - Portfolio Management ICD  *
     C                     EXSR TECRRC
     C                     END                             *FI
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         UJSUBR    BEGSR
      *================================================================
      * Portfolio Lending
      *================================================================
      * CASE: WRK.Portfolio Lending is Yes
     C           WULMCR    IFEQ 'Y'                        *IF
      * Create Portfolio Lending - Portfolio Lending ICD  *
     C                     EXSR TFCRRC
     C                     END                             *FI
      *================================================================
     CSR         UJEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Setup job date/time
      *
     C                     Z-ADDUDATE     ##JDT
      * Set century digit (If YY prior to 1940 treat as 20YY)
     C           ##JYY     IFLT 40
     C                     Z-ADD1         ##JCC
     C                     ELSE
     C                     Z-ADD0         ##JCC
     C                     END
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Midas/Telex Module Ind.
     C                     MOVEL*BLANK    WUMTMI  1
      * Define work field SWIFT Funds Transfer
     C                     MOVEL*BLANK    WUSWFT  1
      * Define work field SWIFT Securities Trading
     C                     MOVEL*BLANK    WUSWST  1
      * Define work field SWIFT Customer Lending
     C                     MOVEL*BLANK    WUSWCL  1
      * Define work field SWIFT Synd Loans (REDUN)
     C                     MOVEL*BLANK    WUSWSL  1
      * Define work field SWIFT Statements
     C                     MOVEL*BLANK    WUSWSM  1
      * Define work field SWIFT Dealing
     C                     MOVEL*BLANK    WUSWDL  1
      * Define work field Standing data/Gen.Ledger
     C                     MOVEL*BLANK    WUSDGL  1
      * Define work field Dealing: FX
     C                     MOVEL*BLANK    WUDLFX  1
      * Define work field Syndicated Loans (REDUN)
     C                     MOVEL*BLANK    WUSYLN  1
      * Define work field Exposure Management
     C                     MOVEL*BLANK    WUEXMG  1
      * Define work field Financial Modeller
     C                     MOVEL*BLANK    WUFNMO  1
      * Define work field Statutory Returns
     C                     MOVEL*BLANK    WUSTRT  1
      * Define work field Customer Lending
     C                     MOVEL*BLANK    WUCSLN  1
      * Define work field Retail Banking
     C                     MOVEL*BLANK    WURTBN  1
      * Define work field Midas/Swift direct link
     C                     MOVEL*BLANK    WUMSDL  1
      * Define work field Securities
     C                     MOVEL*BLANK    WUSECS  1
      * Define work field Auto-reconciliations
     C                     MOVEL*BLANK    WUAURC  1
      * Define work field Bond Dealers Interface
     C                     MOVEL*BLANK    WUBDLI  1
      * Define work field DRS Standing Data
     C                     MOVEL*BLANK    WUDRSD  1
      * Define work field DRS Control module
     C                     MOVEL*BLANK    WUDRCM  1
      * Define work field DRS Foreign Exchange
     C                     MOVEL*BLANK    WUDRFE  1
      * Define work field DRS Money Market
     C                     MOVEL*BLANK    WUDRMM  1
      * Define work field DRS Arbitrage
     C                     MOVEL*BLANK    WUDRAR  1
      * Define work field Funds Transfer
     C                     MOVEL*BLANK    WUFDTR  1
      * Define work field DRS Common Applications
     C                     MOVEL*BLANK    WUDRCA  1
      * Define work field Futures & Options
     C                     MOVEL*BLANK    WUFUOP  1
      * Define work field Midas/Telex Synd. Loans
     C                     MOVEL*BLANK    WUMTSL  1
      * Define work field Midas/Telex Dealing
     C                     MOVEL*BLANK    WUMTDL  1
      * Define work field Midas/Telex Gen. Ledger
     C                     MOVEL*BLANK    WUMTGL  1
      * Define work field Midas/Telex Cust. Lending
     C                     MOVEL*BLANK    WUMTCL  1
      * Define work field Message Management
     C                     MOVEL*BLANK    WUNWMI  1
      * Define work field FRA/IRS Indicator
     C                     MOVEL*BLANK    WUFIIN  1
      * Define work field Dealing: MM
     C                     MOVEL*BLANK    WUDLMM  1
      * Define work field Internal Contracts
     C                     MOVEL*BLANK    WUINCN  1
      * Define work field Treasury Management
     C                     MOVEL*BLANK    WUTRMG  1
      * Define work field Interest Risk Management
     C                     MOVEL*BLANK    WURKMG  1
      * Define work field Testkey
     C                     MOVEL*BLANK    WUTSKY  1
      * Define work field Midas/Q
     C                     MOVEL*BLANK    WUMIDQ  1
      * Define work field Microfiche
     C                     MOVEL*BLANK    WUMFIC  1
      * Define work field Interest on accounts
     C                     MOVEL*BLANK    WUIOAC  1
      * Define work field Window processing requir.
     C                     MOVEL*BLANK    WUWDPR  1
      * Define work field SAR's processing required
     C                     MOVEL*BLANK    WUSARP  1
      * Define work field French return indicator
     C                     MOVEL*BLANK    WUFRIN  1
      * Define work field Lux return indicator
     C                     MOVEL*BLANK    WULRIN  1
      * Define work field Dutch return indicator
     C                     MOVEL*BLANK    WUDRIN  1
      * Define work field German return indicator
     C                     MOVEL*BLANK    WUGRIN  1
      * Define work field Belgian return indicator
     C                     MOVEL*BLANK    WUBRIN  1
      * Define work field Italian return indicator
     C                     MOVEL*BLANK    WUIRIN  1
      * Define work field Swift External Interface
     C                     MOVEL*BLANK    WUSWEI  1
      * Define work field Portfolio Management
     C                     MOVEL*BLANK    WUPFMG  1
      * Define work field Credit Management.
     C                     MOVEL*BLANK    WUCRMG  1
      * Define work field Head Office Reporting
     C                     MOVEL*BLANK    WUHORP  1
      * Define work field Average Balances
     C                     MOVEL*BLANK    WUAVBL  1
      * Define work field Margins
     C                     MOVEL*BLANK    WUMARG  1
      * Define work field Confirmation Matching
     C                     MOVEL*BLANK    WUCFMT  1
      * Define work field Mimix
     C                     MOVEL*BLANK    WUMIMX  1
      * Define work field Report Control Facility
     C                     MOVEL*BLANK    WURCFI  1
      * Define work field Amps Int
     C                     MOVEL*BLANK    WUAMIN  1
      * Define work field Swiss Returns
     C                     MOVEL*BLANK    WUSWRT  1
      * Define work field Fiduciary Loans & Deposit
     C                     MOVEL*BLANK    WUFLND  1
      * Define work field Portfolio Lending
     C                     MOVEL*BLANK    WULMCR  1
      * Define work field Cantonal Tax
     C                     MOVEL*BLANK    WUCNTX  1
      * Define work field Stamp Duty
     C                     MOVEL*BLANK    WUSTDU  1
      * Define work field Use DRS Shortnames
     C                     MOVEL*BLANK    WUUDRS  1
      * Define work field Chips Dealing
     C                     MOVEL*BLANK    WUCHDL  1
      * Define work field Chips Lending
     C                     MOVEL*BLANK    WUCHLN  1
      * Define work field Chips Opening Balance
     C                     MOVEL*BLANK    WUCHOB  1
      * Define work field CHIPS
     C                     MOVEL*BLANK    WUCHIP  1
      * Define work field Chips Direct Link
     C                     MOVEL*BLANK    WUCHDI  1
      * Define work field Optical Disk
     C                     MOVEL*BLANK    WUOPDK  1
      * Define work field Multi-branching Indicator
     C                     MOVEL*BLANK    WUMBIN  1
      * Define work field Leo Data Nucleus
     C                     MOVEL*BLANK    WUNNST  1
      * Define work field Leo Letters of Credit
     C                     MOVEL*BLANK    WUNOST  1
      * Define work field Leo Collections
     C                     MOVEL*BLANK    WUNPST  1
      * Define work field Leo Bills/Financing
     C                     MOVEL*BLANK    WUNQST  1
      * Define work field Leo Bankers Acceptances
     C                     MOVEL*BLANK    WUNRST  1
      * Define work field Leo Reimbursements
     C                     MOVEL*BLANK    WUNSST  1
      * Define work field Taxes
     C                     MOVEL*BLANK    WUNTST  1
      * Define work field History & Audit Facility
     C                     MOVEL*BLANK    WUNUST  1
      * Define work field Management Accounts
     C                     MOVEL*BLANK    WUNVST  1
      * Define work field IBLC Returns
     C                     MOVEL*BLANK    WUNWST  1
      * Define work field Retail 3
     C                     MOVEL*BLANK    WUNXST  1
      * Define work field Interest on Accounts 3
     C                     MOVEL*BLANK    WUNYST  1
      * Define work field Midas Export Data Module
     C                     MOVEL*BLANK    WUNZST  1
      * Define work field Analytical Accounting
     C                     MOVEL*BLANK    WUN0ST  1
      * Define work field User Defined Correspondnc
     C                     MOVEL*BLANK    WUN1ST  1
      * Define work field Midas-Plato Interface
     C                     MOVEL*BLANK    WUN2ST  1
      * Define work field Midas-Trade Innovation If
     C                     MOVEL*BLANK    WUN3ST  1
      * Define work field Reserved for Later Use 41
     C                     MOVEL*BLANK    WUN4ST  1
      * Define work field Reserved for Later Use 42
     C                     MOVEL*BLANK    WUN5ST  1
      * Define work field Reserved for Later Use 43
     C                     MOVEL*BLANK    WUN6ST  1
      * Define work field Reserved for Later Use 44
     C                     MOVEL*BLANK    WUN7ST  1
      * Define work field Reserved for Later Use 45
     C                     MOVEL*BLANK    WUN8ST  1
      * Define work field Reserved for Later Use 46
     C                     MOVEL*BLANK    WUN9ST  1
      * Define work field Reserved for Later Use 47
     C                     MOVEL*BLANK    WUOAST  1
      * Define work field Reserved for Later Use 48
     C                     MOVEL*BLANK    WUOBST  1
      * Define work field Reserved for Later Use 49
     C                     MOVEL*BLANK    WUOCST  1
      * Define work field Reserved for Later Use 50
     C                     MOVEL*BLANK    WUODST  1
      * Define work field Reserved for Later Use 51
     C                     MOVEL*BLANK    WUOEST  1
      * Define work field Reserved for Later Use 52
     C                     MOVEL*BLANK    WUOFST  1
      * Define work field Reserved for Later Use 53
     C                     MOVEL*BLANK    WUOGST  1
      * Define work field Reserved for Later Use 54
     C                     MOVEL*BLANK    WUOHST  1
      * Define work field Reserved for Later Use 55
     C                     MOVEL*BLANK    WUOIST  1
      * Define work field Reserved for Later Use 56
     C                     MOVEL*BLANK    WUOJST  1
      * Define work field Reserved for Later Use 57
     C                     MOVEL*BLANK    WUOKST  1
      * Define work field Reserved for Later Use 58
     C                     MOVEL*BLANK    WUOLST  1
      * Define work field Reserved for Later Use 59
     C                     MOVEL*BLANK    WUOMST  1
      * Define work field Reserved for Later Use 60
     C                     MOVEL*BLANK    WUONST  1
      * Define work field Reserved for Later Use 61
     C                     MOVEL*BLANK    WUOOST  1
      * Define work field Reserved for Later Use 62
     C                     MOVEL*BLANK    WUOPST  1
      * Define work field Reserved for Later Use 63
     C                     MOVEL*BLANK    WUOQST  1
      * Define work field Reserved for Later Use 64
     C                     MOVEL*BLANK    WUORST  1
      * Define work field Reserved for Later Use 65
     C                     MOVEL*BLANK    WUOSST  1
      * Obtain default message file
     C           *NAMVAR   DEFN Y2MGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field SAR number field
     C                     MOVEL*BLANK    WUSARN  6
      * Define work field Access Pgm Return Code
     C                     MOVEL*BLANK    WUAPRC  7
      * Define work field Access obj dummy DS (76)
     C                     MOVEL*BLANK    WUFDY  76
      * Define work field Customer Service Fees on
     C                     MOVEL*BLANK    WUKKST  1
      * Define work field Trading Data Set-up
     C                     MOVEL*BLANK    WUTDSU  1
      * Define work field S01212
     C                     MOVEL*BLANK    WUMFTS  1
      * Define work field cac001
     C                     MOVEL*BLANK    WUW7ST  1
      * Define work field RTS CRT001
     C                     MOVEL*BLANK    WURTSW  1
      * Define work field Switchable feature CRT002
     C                     MOVEL*BLANK    WUCRT2  1
      * Define work field Switchable feature CRT003
     C                     MOVEL*BLANK    WUCRT3  1
      * Define work field Switchable Feature CGL004
     C                     MOVEL*BLANK    WU      1
      * Define work field Switchable Feature CPL002
     C                     MOVEL*BLANK    WUCPL2  1
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Open files
     C                     OPEN SDMMODL1
     C                     OPEN SDDEALL0
     C                     OPEN SDTRADL0
     C                     OPEN SDSTRDL0
     C                     OPEN SDCLNDL0
     C                     OPEN SDFODAL0
     C                     OPEN SDRETLL0
     C                     OPEN SDGELRL0
     C                     OPEN SDBANKL0
     C                     OPEN SDFAISL0
     C                     OPEN SDMGMEL0
     C                     OPEN SDMTLXL0
     C                     OPEN SDFTFRL0
     C                     OPEN SDEXPML0
     C                     OPEN SDRCFL0
     C                     OPEN SDMCFCL0
     C                     OPEN SDOPTCL0
     C                     OPEN SDHAFDL0
     C                     OPEN SDRISKL0
     C                     OPEN SDCOBPL0
     C                     OPEN SDTRMAL0
     C                     OPEN SDCSFDL0
     C                     OPEN SDSCFEL0
     C                     OPEN SDMEXPL0
     C                     OPEN SDPORTL0
     C                     OPEN SDLOMBL0
     C                     OPEN SDPCACL0
     C                     OPEN SDTCHGL0
     C                     OPEN SDBAIIL0
     C                     OPEN SDFONTL0
     C*********************OPEN SDMPICL0                            CPL002
     C                     OPEN SDTIINL0
     C                     OPEN SDAPIL0                             CAP002
     C                     OPEN SDTOFPD                                   CPB001
     C                     OPEN SDMDFCPD                                                      CSD006
     C**********           OPEN SDCOCCPD                                              CLE025 BUG4544
     C/COPY WNCPYSRC,SD9005XC02
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
      /EJECT
     CSR         *PSSR     BEGSR
      *****************************************************************
      *                                                               *
      * *PSSR  - Program exception error routine                      *
      *          Called automatically if a program error occurs,      *
      *          or directly by the program code using EXSR.          *
      *          This subroutine DUMPs the program just once.         *
      *                                                               *
      *****************************************************************
      *
      * Core function specific processing.
      *
     C/COPY WNCPYSRC,SD9005XPSC
      *
      * Start of PSSR user point.
      *
     C/COPY WNCPYSRC,SD9005XPS1
      *
      * Standard Midas PSSR processing.
      *
     C/COPY SDCPYSRC,SDPSSRBCH
      *
      * End of PSSR user point.
      *
     C/COPY WNCPYSRC,SD9005XPS2
      *
      *================================================================
     CSR                   ENDSR
      *================================================================
** CPY@     : Copyright notice for inclusion in all programs
(c) Misys International Banking Systems Ltd. 2001
** @CN
00001 RE4135RAE
00002 RE411200A
00003 RE411400N
00004 RE4114H/C
00005 RE41150JN
00006 RE4115H/C
00007 RE411600O
00008 RE41170JO
00009 RE411800L
00010 RE41190JL
00011 RE41200JI
00012 4111/4120
00013 RE41240JD
00014 RE403200B
00015 RE4035PNA
00016 CASH_REC                                                                                CRT006
      BLOOMBERG                                                                               CSD006
00018 RE412200E                                                                               CRT005
00019 RE412200F                                                                               CRT005
00020 RE41220JE                                                                               CRT005
00021 RE41220JF                                                                               CRT005
