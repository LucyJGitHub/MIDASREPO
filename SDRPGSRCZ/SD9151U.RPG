     H        1   Y
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas SD Check the deal type')
      *****************************************************************
      *                                                               *
      *  Midas - Standing Data Module                                 *
      *                                                               *
      *  SD9151U - Check the deal type.                               *
      *                                                               *
      *  Function:  This reads FDDTSTPD and checks the deal types     *
      *             for the deal sub-types passed to it.              *
      *                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *  Prev Amend No. CDL038             Date 10May05               *
      *                 CFF003             Date 13Mar97               *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  CDL038 - Extended Deal Sub Type (Recompile)                  *
      *  CFF003 - OTC enhancement Phase 2, New program:               *
      *           This program checks if the deal sub-type passed to  *
      *           it does exist and then check if the deal type       *
      *           associated with the deal sub-type is FP, FS or CX.  *
      *                                                               *
      *****************************************************************
     FFDDTSTL1IF  E           K        DISK
      *
     C           *ENTRY    PLIST
     C                     PARM           WRRTN   7
     C                     PARM           WDLST   2
      *
      ** Make sure the return code is blank.
      *
     C                     MOVE *BLANK    WRRTN
      *
     C           *IN77     DOWEQ'0'                        B1
     C                     READ FDDTSTL1                 77
      *
      **  Live record is found.
      *
     C           *IN77     IFEQ '0'                        B2
     C           WDLST     ANDEQDLST11
      *
      ** Check the deal Type.
      *
     C           DTPE11    IFEQ 'FP'                       B3
     C           DTPE11    OREQ 'FS'
     C           DTPE11    OREQ 'CX'
     C                     MOVE 'VALID  ' WRRTN
     C                     GOTO VALID
      *
     C                     ELSE
     C                     MOVE 'INVALID' WRRTN
      *
     C                     END                             E3
      *
      ** No record found or not live.
      *
     C                     ELSE
      *
     C           WRRTN     IFEQ *BLANK
     C                     MOVE '*NRF   ' WRRTN
     C                     END
      *
     C                     END                             E2
      *
     C                     END                             E1
      *
     C           VALID     TAG
     C                     SETON                     LR
     C                     RETRN
