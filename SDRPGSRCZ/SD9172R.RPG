     H        1   Y
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas SD General ledger ICD data 2 maintenance')
      *****************************************************************
      *                                                               *
      *  Midas - Standing Data Module                                 *
      *                                                               *
      *  SD9172R - Maintain General Ledger ICD - Screen 2.            *
      *                                                               *
      *  Function:  This program maintaines the general ledger ICD.   *
      *                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
      *                                                               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Last Amend No. 237752             Date 18Jan06               *
      *  Prev Amend No. CSD027             Date 09Dec05               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.04 -----------------------------------------------*
      *                 CSD009             Date 10Oct00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 125935             Date 20Jan98               *
      * Midas DBA 3.02 -----------------------------------------------*
      *                 CGL010             Date 08Nov99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 134204             Date 27Apr98               *
      *                 CSD003             Date 27Oct97               *
      *                 072628             DATE 30AUG94               *
      *                 S10736             DATE 04NOV92               *
      *                 S01340             DATE 17MAR92               *
      *                 LN1260             DATE 07MAY91               *
      *                 S01314             DATE 18APR91               *
      *                 LN0592             DATE 20AUG90               *
      *                 LN0255             DATE 15JUN90               *
      *                 S01117             DATE 08FEB90               *
      *                 S01212             DATE 08FEB90               *
      *                                                               *
      *****************************************************************
      *                                                               *
      *  237752 - Allow a blank value for the 'Main Branch' field     *
      *           when the 'Inter-Branch Entries via Main Branch'     *
      *           field is set to 'N'.                                *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CSD009 - Profit Centre Accounting Default Matrix Enhancement *
      *  125935 - Should not allow user to blank priority if field    *
      *           corresponding to priority blanked contains data .   *
      *           Send message for user to take appropriate action .  *
      *  CGL010 - Future Value Dated Journal Entries for              *
      *           Non-Retail Accounts                                 *
      *  134204 - Extend the data checking datastructures from 77     *
      *           to 83 (missed from CEU008 development).             *
      *  CSD003 - Synon Closedown Project (SD):                       *
      *           - Program removed from SD model.                    *
      *  072628 - Regenerate over Germany development file change.    *
      *  S10736 - Display 'Periodic Processing Set' on the screen,    *
      *           only if 'Management Accounts' on SDMMODPD is 'Y'.   *
      *  S01340 - MIS R10 - Batch Retention. Change parameters.       *
      *  LN1260 - Recompile due to changes in SDEXSTPD.               *
      *  S01314 - Changes required for PTF incorporation -            *
      *           Recompile due to additional fields in SDGELRPD.     *
      *  LN0592 - The branch priority for the profit centre default   *
      *           matrix should not be displayed if the system is     *
      *           single branched.                                    *
      *  LN0255 - Standardise ICD Headers and Footers.                *
      *  S01117 - Release 10 Changes.                                 *
      *  S01212 - /Copy and Window Processing.                        *
      *                                                               *
      *****************************************************************
     F*00/Copy member SD9172R   Initialise Program I-Spec
     F/COPY WNCPYSRC,SD9172RFPG
     FSD9172R#CF  E                    WORKSTN                        UC
     F                                              KINFDS INFDS#
     F                                              KINFSR *PSSR
      * DSP: Midas SD General ledger ICD maintenance 2
      *
     FSDGELRL1IF  E           K        DISK                           UC
     F                                              KINFDS INFDS1
     F                                              KINFSR *PSSR
      * RTV : Midas SD General ledger ICD details retrieval
      *
     FSDBANKL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0001
     F                                              KINFSR *PSSR
      * RTV : Midas SD Bank details ICD retrieval
      *
     FSDBRCHL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0002
     F                                              KINFSR *PSSR
      * RTV : Midas SD Branch codes retrieval
      *
     FSDMMODL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0003
     F                                              KINFSR *PSSR
      * RTV : Midas SD Midas module flags retrieval
      *
     FSDGELRL0UF  E           K        DISK                           UC
     F                                              KCOMIT
     F                                              KINFDS ID0004
     F                                              KINFSR *PSSR
      * UPD : Midas SD General ledger ICD details update
      *
     FSDPRFML1IF  E           K        DISK                               125935
      * RTV : Midas SD Profit centre default matrix                       125935
     E*
     E* Set up array ARRA to contain the 8 Profit Centre Default Matrix
     E*   Priority Fields.
     E*
     E**********          ARRA        8  1 0                              CSD009
     E                    ARRA       20  1 0                              CSD009
      *                                                                   CSD009
      ** Set up array to contain the 20 Profit Centre Default Matrix      CSD009
      ** Priority Fields - Alphanumeric                                   CSD009
      *                                                                   CSD009
     E                    ARRB       12  1                                CSD009
      *                                                                   CSD009
     E* Description     : Copyright notice for inclusion in all programs
     E*
     E********************************************************************
     E                    CPY@    1   1 80               Copyright
     E/COPY WNCPYSRC,SD9172REPG
     I*
     I* Description     : Copyright notice for inclusion in all programs
     I*
     I****/COPY QWINDSRC,HME1DTA                                          S01229
     I/COPY QWINDSRC,SD9170GDTA                                           S01229
     I/COPY WNCPYSRC,SD9172RIPG
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     I@1DBRC    E DSSDGELRL0
      * UPD : Midas SD General ledger ICD details update
      * Current/previous master file format fields for change control
      *
     ISCSARD    E DSSCSARDPD                                              CSD009
      ** External DS for SAR Details                                      CSD009
      *                                                                   CSD009
     IDSFDY     E DSDSFDY                                                 CSD009
      ** First DS for Access Programs, Short Data Structure               CSD009
      *                                                                   CSD009
     I*#1DBRC*****DS                             77                       134204
     I***#1DBRC** DS                             83                134204 CGL010
     I*#1DBRC***   DS                            121               CGL010 CSD009
     I***#1DBRC*     DS                            133                                 CSD009 CGL029
     I#1DBRC      DS                           9999                                           CGL029
      * Stored master file format fields
     I                                        1   1 #1DB1
      *
     I*YARDCS*****DS                             77                       134204
     I***YARDCS** DS                             83                134204 CGL010
     I*YARDCS***   DS                            121               CGL010 CSD009
     I***YARDCS*     DS                            133                                 CSD009 CGL029
     IYARDCS      DS                           9999                                           CGL029
     IPARC        DS                             10                       CGL010
      ** KEY : Midas SD General ledger ICD details retrieval              CGL010
      ** I : MAP General Ledger                                           CGL010
      *                                                                   CGL010
     I                                        1  10 PAGNLG                CGL010
      *                                                                   CGL010
     IA@CPY       DS
      * Copyright array
     I                                        1  80 CPY@
     IRUNDAT      DS
     I                                        1   7 MRDT
     I                                    P   8  100RDNB
     I                                       11  11 SUC
     I                                       12  12 DFF
     I                                       13  13 MBIN
     IID0001      DS                            528
      * File information data structure
      *
     IID0002      DS                            528
      * File information data structure
      *
     IID0003      DS                            528
      * File information data structure
      *
     IID0004      DS                            528
      * File information data structure
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * B : MAP Work Return code
     I                                        1   5 P1WRTC
     IP2PARM      DS                             10
      * KEY: Midas SD General ledger ICD details retrieval
      * I : MAP General Ledger
     I                                        1  10 P2GNLG
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Value required - press'?''
      * JE Special Character
     I                                        1   1 ZA0001
      * Message data for 'Invalid value - press '?''
      * JE Special Character
     I                                        1   1 ZA0002
      * Message data for 'Value required'
      * *Required Value
     I                                        1  30 ZA0003
      * Message data for 'Profit Ctres Used Invalid'
      * Profit Centres Used
     I                                        1   1 ZA0004
      * Message data for 'P.C.Used - Amend/Default'
      * Profit Centres Amendable
     I                                        1   1 ZA0005
      * Message data for 'Invalid PC Amend/Def Used'
      * Profit Centres Amendable
     I                                        1   1 ZA0006
      * Message data for 'P.C.Used - Amend/Default'
      * Profit Centres Amendable
     I                                        1   1 ZA0007
      * Message data for 'Invalid PC Amend/Def Used'
      * Profit Centres Amendable
     I                                        1   1 ZA0008
      * Message data for 'Priorities must be blank'
      * Prof C Def Matrix-Book
     I                                        1   1 ZA0009
      * Message data for 'Priorities must be blank'
      * Prof C Def Matrix-Book
     I                                        1   1 ZA0010
      * Message data for 'Priorities must be blank'
      * Prof C Def Matrix-Book
     I                                        1   1 ZA0011
      * Message data for 'Priorities must be blank'
      * Prof C Def Matrix-Book
     I                                        1   1 ZA0012
      * Message data for 'Priorities must be blank'
      * Prof C Def Matrix-Book
     I                                        1   1 ZA0013
      * Message data for 'Priorities must be blank'
      * Prof C Def Matrix-Book
     I                                        1   1 ZA0014
      * Message data for 'Priorities must be blank'
      * Prof C Def Matrix-Book
     I                                        1   1 ZA0015
      * Message data for 'Priorities must be blank'
      * Prof C Def Matrix-Book
     I                                        1   1 ZA0016
      * Message data for 'Value required'
      * *Required Value
     I                                        1  30 ZA0017
      * Message data for 'Inval value - must be Y/N'
      * Originating Branch Used
     I                                        1   1 ZA0018
      * Message data for 'Value required'
      * *Required Value
     I                                        1  30 ZA0019
      * Message data for 'Inval value - must be Y/N'
      * Originating Branch Used
     I                                        1   1 ZA0020
      * Message data for 'PC priority must be blank'
      * Prof C Def Matrix-Ac Off
     I                                        1   1 ZA0021
      * Message data for 'PC priority must be blank'
      * Prof C Def Matrix-Ac Off
     I                                        1   1 ZA0022
      * Message data for 'PC priority must be blank'
      * Prof C Def Matrix-Ac Off
     I                                        1   1 ZA0023
      * Message data for 'PC priority must be blank'
      * Prof C Def Matrix-Ac Off
     I                                        1   1 ZA0024
      * Message data for 'PC priority must be blank'
      * Prof C Def Matrix-Ac Off
     I                                        1   1 ZA0025
      * Message data for 'PC priority must be blank'
      * Prof C Def Matrix-Ac Off
     I                                        1   1 ZA0026
      * Message data for 'PC priority must be blank'
      * Prof C Def Matrix-Ac Off
     I                                        1   1 ZA0027
      * Message data for 'PC priority must be blank'
      * Prof C Def Matrix-Ac Off
     I                                        1   1 ZA0028
      * Message data for 'Priority not valid value'
      * Prof C Def Matrix-Ac Off
     I                                        1   1 ZA0029
      * Message data for 'Priority not valid value'
      * Prof C Def Matrix-Ac Off
     I                                        1   1 ZA0030
      * Message data for 'Priority not valid value'
      * Prof C Def Matrix-Ac Off
     I                                        1   1 ZA0031
      * Message data for 'Priority not valid value'
      * Prof C Def Matrix-Ac Off
     I                                        1   1 ZA0032
      * Message data for 'Priority not valid value'
      * Prof C Def Matrix-Ac Off
     I                                        1   1 ZA0033
      * Message data for 'Priority not valid value'
      * Prof C Def Matrix-Ac Off
     I                                        1   1 ZA0034
      * Message data for 'Priority not valid value'
      * Prof C Def Matrix-Ac Off
     I                                        1   1 ZA0035
      * Message data for 'Priority not valid value'
      * Prof C Def Matrix-Ac Off
     I                                        1   1 ZA0036
      * Message data for 'SB One priority must be 1'
      * Prof C Def Matrix-Book
     I                                        1   1 ZA0037
      * Prof C Def Matrix-T Type
     I                                        2   2 ZA0038
      * Prof C Def Matrix-S Type
     I                                        3   3 ZA0039
      * Prof C Def Matrix-Dept
     I                                        4   4 ZA0040
      * Prof C Def Matrix-User
     I                                        5   5 ZA0041
      * Prof C Def Matrix-Ac Off
     I                                        6   6 ZA0042
      * Prof C Def Matrix-Cust
     I                                        7   7 ZA0043
      * Message data for 'One GL Priority must be 1'
      * Prof C Def Matrix-Book
     I                                        1   1 ZA0044
      * Prof C Def Matrix-T Type
     I                                        2   2 ZA0045
      * Prof C Def Matrix-S Type
     I                                        3   3 ZA0046
      * Prof C Def Matrix-Branch
     I                                        4   4 ZA0047
      * Prof C Def Matrix-Dept
     I                                        5   5 ZA0048
      * Prof C Def Matrix-User
     I                                        6   6 ZA0049
      * Prof C Def Matrix-Ac Off
     I                                        7   7 ZA0050
      * Prof C Def Matrix-Cust
     I                                        8   8 ZA0051
      * Message data for 'SB No duplicates in Prior'
      * Prof C Def Matrix-Book
     I                                        1   1 ZA0052
      * Prof C Def Matrix-T Type
     I                                        2   2 ZA0053
      * Prof C Def Matrix-S Type
     I                                        3   3 ZA0054
      * Prof C Def Matrix-Dept
     I                                        4   4 ZA0055
      * Prof C Def Matrix-User
     I                                        5   5 ZA0056
      * Prof C Def Matrix-Ac Off
     I                                        6   6 ZA0057
      * Prof C Def Matrix-Cust
     I                                        7   7 ZA0058
      * Message data for 'No duplicates in GL Prior'
      * Prof C Def Matrix-Book
     I                                        1   1 ZA0059
      * Prof C Def Matrix-T Type
     I                                        2   2 ZA0060
      * Prof C Def Matrix-S Type
     I                                        3   3 ZA0061
      * Prof C Def Matrix-Branch
     I                                        4   4 ZA0062
      * Prof C Def Matrix-Dept
     I                                        5   5 ZA0063
      * Prof C Def Matrix-User
     I                                        6   6 ZA0064
      * Prof C Def Matrix-Ac Off
     I                                        7   7 ZA0065
      * Prof C Def Matrix-Cust
     I                                        8   8 ZA0066
      * Message data for 'SB Priorities in sequence'
      * Prof C Def Matrix-Book
     I                                        1   1 ZA0067
      * Prof C Def Matrix-T Type
     I                                        2   2 ZA0068
      * Prof C Def Matrix-S Type
     I                                        3   3 ZA0069
      * Prof C Def Matrix-Dept
     I                                        4   4 ZA0070
      * Prof C Def Matrix-User
     I                                        5   5 ZA0071
      * Prof C Def Matrix-Ac Off
     I                                        6   6 ZA0072
      * Prof C Def Matrix-Cust
     I                                        7   7 ZA0073
      * Message data for 'GL Priorities in sequence'
      * Prof C Def Matrix-Book
     I                                        1   1 ZA0074
      * Prof C Def Matrix-T Type
     I                                        2   2 ZA0075
      * Prof C Def Matrix-S Type
     I                                        3   3 ZA0076
      * Prof C Def Matrix-Branch
     I                                        4   4 ZA0077
      * Prof C Def Matrix-Dept
     I                                        5   5 ZA0078
      * Prof C Def Matrix-User
     I                                        6   6 ZA0079
      * Prof C Def Matrix-Ac Off
     I                                        7   7 ZA0080
      * Prof C Def Matrix-Cust
     I                                        8   8 ZA0081
      * Message data for 'Value required'
      * *Required Value
     I                                        1  30 ZA0082
      * Message data for 'Inval value - must be Y/N'
      * Originating Branch Used
     I                                        1   1 ZA0083
      * Message data for 'Value required'
      * *Required Value
     I                                        1  30 ZA0084
      * Message data for 'Orig Brch/User Val Inval'
      * Orig Branch/User Vald Req
     I                                        1   1 ZA0085
      * Message data for 'Value required'
      * *Required Value
     I                                        1  30 ZA0086
      * Message data for 'Inval value - must be Y/N'
      * Originating Branch Used
     I                                        1   1 ZA0087
      * Message data for 'Value req. Batch or Item'
      * JE Int-Bch Ents @ Bch/Itm
     I                                        1   1 ZA0088
      * Message data for 'Invalid JE - Bch/Itm'
      * JE Int-Bch Ents @ Bch/Itm
     I                                        1   1 ZA0089
      * Message data for 'Value required'
      * *Required Value
     I                                        1  30 ZA0090
      * Message data for 'Inval value - must be Y/N'
      * Originating Branch Used
     I                                        1   1 ZA0091
      * Message data for 'Main Branch required'
      * Main Branch
     I                                        1   3 ZA0092
      * Message data for 'Processing Set Mandatory'
      * Periodic Processing Set
     I                                        1   1 ZA0093
      * Message data for 'Processing set not found'
      * Periodic Processing Set
     I                                        1   1 ZA0094
      *Message data for 'Priority cannot be deleted in GL prio'           125935
      * Book code                                                         125935
     I                                        1   9 ZA0110                125935
      *Message data for 'Priority cannot be deleted in GL prio'           125935
      * Transaction type                                                  125935
     I                                       10  15 ZA0111                125935
      *Message data for 'Priority cannot be deleted in GL prio'           125935
      * Sub type                                                          125935
     I                                       16  21 ZA0112                125935
      *Message data for 'Priority cannot be deleted in GL prio'           125935
      * Branch code                                                       125935
     I                                       22  27 ZA0113                125935
      *Message data for 'Priority cannot be deleted in GL prio'           125935
      * Dept code                                                         125935
     I                                       28  31 ZA0114                125935
      *Message data for 'Priority cannot be deleted in GL prio'           125935
      * User                                                              125935
     I                                       32  35 ZA0115                125935
      *Message data for 'Priority cannot be deleted in GL prio            125935
      * Account officer code                                              125935
     I                                       36  41 ZA0116                125935
      *Message data for 'Priority cannot be deleted in GL prio'           125935
      * Customer number                                                   125935
     I                                       42  45 ZA0117                125935
      *                                                                   CSD009
      ** Data structure for default matrix field                          CSD009
     I            DS                                                      CSD009
     I                                        1  12 #FLDS                 CSD009
     I                                        1   1 #1LICD                CSD009
     I                                        2   2 #1BNBI                CSD009
     I                                        3   3 #1CLOC                CSD009
     I                                        4   4 #1RLOC                CSD009
     I                                        5   5 #1CNCZ                CSD009
     I                                        6   6 #1RNCZ                CSD009
     I                                        7   7 #1CSTY                CSD009
     I                                        8   8 #1GPC1                CSD009
     I                                        9   9 #1GPC2                CSD009
     I                                       10  10 #1GPC3                CSD009
     I                                       11  11 #1GPC4                CSD009
     I                                       12  12 #1GPC5                CSD009
      * User field stared (10 Characters)                                 125935
     I              '**********'          C         STARS                 125935
      * User field  ( 9 Characters)                                       125935
     I              'BOOK CODE'           C         UUPMBK                125935
      * User field  ( 6 Characters)                                       125935
     I              'T TYPE'              C         UUPMTT                125935
      * User field  ( 6 Characters)                                       125935
     I              'S TYPE'              C         UUPMST                125935
      * User field  ( 6 Characters)                                       125935
     I              'BRANCH'              C         UUPMBH                125935
      * User field  ( 4 Characters)                                       125935
     I              'DEPT'                C         UUPMDT                125935
      * User field  ( 4 Characters)                                       125935
     I              'USER'                C         UUPMUR                125935
      * User field  ( 6 Characters)                                       125935
     I              'AC OFF'              C         UUPMAO                125935
      * User field  ( 4 Characters)                                       125935
     I              'CUST'                C         UUPMCU                125935
      *                                                                   CSD009
      ** Constant - digits upto 8 including blank                         CSD009
     I              ' 012345678'          C         DIGITS                CSD009
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1WRTC    PARM P1WRTC    WP0001  5        Work Return cod
     C                     PARM           P2PARM           KEY: General Le
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Check passed parameters
     C                     EXSR FACKPM
      * Perform once if all passed, else repeat
     C           W0RPT     DOUEQ'N'
      * Display and process key screen
     C                     EXSR BADSKY
     C                     END
      * Terminate program
     C                     EXSR ZXEXPG
      *****************************************************************
      /EJECT
     CSR         BADSKY    BEGSR
      *================================================================
      * Display and process key screen
      *================================================================
      * Initialize key screen
     C                     EXSR MDIZ#K
      * Bypass first display of key screen is possible
     C                     MOVEL'Y'       W0BYP   1
      * Signal start of transaction
     C                     MOVEL'Y'       W0TRN   1
     C           W0TRN     DOWEQ'Y'
     C           W0TRN     OREQ 'K'
      * Ensure transaction continues (if reset)
     C                     MOVEL'Y'       W0TRN   1
      * Conduct screen conversation
     C           W0TRN     DOWEQ'Y'
      * Is bypass key screen still viable?
     C           W0BYP     IFEQ 'Y'
     C           #1GNLG    IFEQ *BLANK                     General Ledger
      * One or more key fields is blank
     C           *IN05     OREQ '1'
      * HOME: Reset screen fields
     C                     MOVEL'N'       W0BYP
     C                     END
     C                     END
      * Bypass key screen
     C           W0BYP     IFNE 'Y'
      * Display key screen
     C                     EXSR BBEXFM
     C                     END
      * Cancel key screen bypass
     C                     MOVEL'N'       W0BYP
      * Process response to key screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   05                CAS            BDHMKY
      * Process key screen input
     C                     CAS            BEPRKY
     C                     END
     C           W0TRN     DOWEQ'R'
     C                     MOVEL'Y'       W0TRN
     C                     EXSR BEPRKY
     C                     END
      *
     C                     END
     C                     END
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBEXFM    BEGSR
      *================================================================
      * Display key screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSAK
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE HELP25    *IN25
      * PUTOVR unless conditioned fields change
     C                     SETON                         86*
     C           *IN89     IFNE BBIN89
     C                     SETOF                         86*
     C                     END
     C                     MOVE *IN89     BBIN89  1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDKEY
      * Test cursor
     C                     EXSR Y8TST
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1
      * Reset global error indicator
     C                     SETOF                         99*
     C                     MOVE *OFF      *IN80                           125935
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         BDHMKY    BEGSR
      *================================================================
      * Process HOME key
      *================================================================
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         BDEXIT    ENDSR
      /EJECT
     CSR         BEPRKY    BEGSR
      *================================================================
      * Process key screen input
      *================================================================
      * Initialise detail screen
     C                     EXSR MAIZ#1
      * Validate key fields
     C                     EXSR BFVLKY
     C           *IN99     CABEQ'1'       BEEXIT
     C           *IN80     CABEQ*ON       BEEXIT                          125935
      * Check for existing record
     C           KRTV      KLIST
     C                     KFLD           BKGNLG           General Ledger
      * Setup key
     C                     MOVEL#1GNLG    BKGNLG           General Ledger
     C           KRTV      CHAIN@BKREEC              9091  *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     SETON                     9932  *
     C                     GOTO BEEXIT
     C                     END                             FI 91
      *
      * If record does not exist, error
     C           *IN90     IFEQ '1'
     C                     SETON                     9932  *
      * Send message 'General Ledger Details NF'
     C                     MOVEL'USR0199' ZAMSID
     C                     EXSR ZASNMS
     C                     ELSE
     C                     EXSR MBFL#1
      * CALC: Detail screen function fields
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy member SD9172RSFF - General Ledger Details  *
     C*00/Copy member SD9172R   Calc Detail Function Flds
     C/COPY WNCPYSRC,SD9172RSFF
     C                     END                             *FI
      * USER: Initialize detail screen (existing record)
      * Start of Fix LN0592
      * If the system is single branched then ensure that the profit cent
      * priority for branch codes is always 0.
      * CASE: WRK.Multi-branching Indicator is Non-Multi-branched
     C           WUMBIN    IFEQ 'N'                        *IF
     C                     MOVEL'0'       #1PMBH           Prof C Def Matr
     C                     END                             *FI
      * End of Fix LN0592
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy member SD9172RISE - General Ledger Details  *
     C*00/Copy member SD9172R   Initialise Dtl Exist Rcd
     C/COPY WNCPYSRC,SD9172RISE
     C                     END                             *FI
     C                     END
      *
      *..................................................
     C   99                GOTO BEEXIT
      * No error: Display and process details
     C                     EXSR CADSDA
      *
      *================================================================
     CSR         BEEXIT    ENDSR
      /EJECT
     CSR         BFVLKY    BEGSR
      *================================================================
      * Validate key fields
      *================================================================
      * USER: Validate key screen
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy member SD9172RVKS - General Ledger Details  *
     C*00/Copy member SD9172R   Validate Key Screen
     C/COPY WNCPYSRC,SD9172RVKS
     C                     END                             *FI
      * General Ledger required
     C           #1GNLG    IFEQ *BLANK                     IF
     C                     SETON                     9932  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         BFEXIT    ENDSR
      /EJECT
     CSR         CADSDA    BEGSR
      *================================================================
      * Display and process detail screen
      *================================================================
      * Conduct detail screen conversation
      * - repeat until screen control flag is reset:
     C           W0TRN     DOWEQ'Y'
      * Display detail screen
     C                     EXSR CBEXFM
      * Process response to detail screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * Redisplay previous screen
     C   12                CAS            CCDSPV
      * HOME: Reset screen fields
     C   05                CAS            CCDSPV
      * Process detail screen input
     C                     CAS            CFPRSC
     C                     END
     C           W0TRN     IFEQ 'R'
     C           W0PMD     IFEQ 'ADD'
     C                     EXSR MAIZ#1
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         CBEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE HELP25    *IN25
      * PUTOVR unless conditioned fields change
     C                     SETON                         86*
     C           *IN89     IFNE CBIN89
     C                     SETOF                         86*
     C                     END
     C                     MOVE *IN89     CBIN89  1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y1SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT2
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1
      * Reset global error indicator
     C                     SETOF                         99*
     C                     MOVE *OFF      *IN80                           125935
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CBEXIT    ENDSR
      /EJECT
     CSR         CCDSPV    BEGSR
      *================================================================
      * Redisplay previous screen
      *================================================================
      * USER: Process key screen request
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy member SD9172RPKR - General Ledger Details  *
     C*00/Copy member SD9172R   Process Key Screen Rqst
     C/COPY WNCPYSRC,SD9172RPKR
     C                     END                             *FI
      * Bypass KEY screen, if F12 is pressed on detail screen
     C                     MOVEL'USR0790' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C   05                MOVEL'R'       W0TRN
     C   12                MOVEL'K'       W0TRN
      *================================================================
     CSR         CCEXIT    ENDSR
      /EJECT
     CSR         CFPRSC    BEGSR
      *================================================================
      * Validate record
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate details
     C                     EXSR DCVLDL
      * QUIT if error:
     C   99                GOTO CFEXIT
     C           *IN80     IFEQ *ON                                       125935
     C                     GOTO CFEXIT                                    125935
     C                     END                                            125935
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       CFEXIT
      * No error: update record
     C                     EXSR EBPR##
      *================================================================
     CSR         CFEXIT    ENDSR
      /EJECT
     CSR         DCVLDL    BEGSR
      *================================================================
      * Validate details
      *================================================================
      * Validate JE Special Character
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1JESP    W0NSRQ  1        JE Special Char
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1136542   Y2LSNO  70
     C           #1JESP    PARM #1JESP    W0EXVL 20        JE Special Char
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
      * USER: Validate detail screen fields
      * JE Special Character Validation.
     C                     EXSR UASUBR                     JE Special Char
      * Profit Centres Validation.
     C                     EXSR UBSUBR                     Profit Centres
      * Multi-branching Indicator Validation.
      * CASE: WRK.Multi-branching Indicator is Multi-branched
     C           WUMBIN    IFEQ 'Y'                        *IF
      * In Multi-branching environment, fields are mandatory.
      * Check if Orig. Branch Used is Blank or Invalid value.
     C                     EXSR UKSUBR                     Check if Orig.
      * Check if Orig. Branch/User Val Required is Blank or Invalid value
     C                     EXSR ULSUBR                     Check if Orig.
      * Check if JE Inter-branch entries @ Bch/Itm is Blank or Invalid va
     C                     EXSR UMSUBR                     Check if JE Int
      * Check if Inter-branch Entries via Main Branch is Blank or Invalid
     C                     EXSR UNSUBR                     Check if Inter-
      * Check if Main Branch Code is Blank.
      * CASE: DTL.Main Branch is blank
     C           #1MABR    IFEQ *BLANK                     *IF
     C           #1IEMB    ANDEQ'Y'                                                           237752
      * Setup message data for message
     C                     MOVEL#1MABR    ZA0092           Main Branch
      * Send message 'Main Branch required'
     C                     MOVEL'USR0803' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9948  *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: WRK.Multi-branching Indicator is Non-Multi-branched
     C           WUMBIN    IFEQ 'N'                        *IF
      * In non-Multi-branching environment, set fields to default values.
     C                     MOVEL'N'       #1OBRU           Originating Bra
     C                     MOVEL'N'       #1OBUV           Orig Branch/Use
     C                     MOVEL'B'       #1IEBI           JE Int-Bch Ents
     C                     MOVEL'N'       #1IEMB           Int-bch Ent Via
      * Retrieve Single Branch Cd - Bank Details  *
     C                     EXSR SARVGN
     C                     MOVELWUSBRC    #1MABR           Main Branch
     C                     END                             *FI
     C                     END                             *FI
      * Start of S10736
      * Validation for Management Accounts
      * CASE: WRK.Management Accounts is Yes
     C           WUNVST    IFEQ 'Y'                        *IF
      * CASE: DTL.Periodic Processing Set is Blank
     C           #1PSET    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1PSET    ZA0093           Periodic Proces
      * Send message 'Processing Set Mandatory'
     C                     MOVEL'USR1838' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9947  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * If Periodic Sets is '?', display a list of valid Sets
      * CASE: DTL.Periodic Processing Set is Question Mark
     C           #1PSET    IFEQ '?'                        *IF
     C                     MOVEL*BLANK    WUAPRC           Access Pgm Retu
      * Select Periodic sets - Standard Functions  *
     C                     CALL 'MC0100S'              90  Select Periodic
     C                     PARM WUAPRC    WQ0001  7        Access Pgm Retu
     C           #1PSET    PARM #1PSET    WQ0002  1        Periodic Proces
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'MC0100S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: *OTHERWISE
      * If not '?', Check whether it is an existing Set
      * Check Processing Set - Standard Functions  *
     C                     CALL 'AOPERSR0'             90  Check Processin
     C           WUAPRC    PARM WUAPRC    WQ0003  7        Access Pgm Retu
     C                     PARM '*KEY'    WQ0004  7        Option for ACCO
     C           #1PSET    PARM #1PSET    WQ0005  1        Periodic Proces
     C                     PARM '*BLANKS' WQ0006 76        Access obj dumm
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'AOPERSR0'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * CASE: WRK.Access Pgm Return Code is AP No Record Found
     C           WUAPRC    IFEQ '*NRF'                     *IF
      * Setup message data for message
     C                     MOVEL#1PSET    ZA0094           Periodic Proces
      * Send message 'Processing set not found'
     C                     MOVEL'USR1839' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9947  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Check Processing Set - Standard Functions  *
     C                     CALL 'AOPERSR0'             90  Check Processin
     C           WUAPRC    PARM WUAPRC    WQ0007  7        Access Pgm Retu
     C                     PARM '*FREE'   WQ0008  7        Option for ACCO
     C           #1PSET    PARM #1PSET    WQ0009  1        Periodic Proces
     C                     PARM '*BLANKS' WQ0010 76        Access obj dumm
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'AOPERSR0'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
     C                     END                             *FI
      * Endt of S10736
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy member SD9172RVSF - General Ledger Details  *
     C*00/Copy member SD9172R   Validate Detail Screen
     C/COPY WNCPYSRC,SD9172RVSF
     C                     END                             *FI
      * Check relations
      * Check reference to Branch Codes
     C                     EXSR VACKRL
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9948  *
     C                     END
      * CALC: Detail screen function fields
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy member SD9172RSFF - General Ledger Details  *
     C*00/Copy member SD9172R   Calc Detail Function Flds
     C/COPY WNCPYSRC,SD9172RSFF
     C                     END                             *FI
      *                                                                   CGL010
      ** Display Future Valued Journal Entry Information                  CGL010
      *                                                                   CGL010
     C           W0DCF     IFEQ 'N'                                       CGL010
     C           *IN75     ANDEQ'1'                                       CGL010
      *                                                                   CGL010
     C                     CLEARPARC                                      CGL010
     C                     MOVEL'GELR'    PAGNLG                          CGL010
      *                                                                   CGL010
     C                     CALL 'SD9173R'              90                 CGL010
     C                     PARM *BLANK    W0RTN                           CGL010
     C                     PARM           PARC                            CGL010
      *                                                                   CGL010
      ** Call to program ended in error                                   CGL010
      *                                                                   CGL010
     C           *IN90     IFEQ '1'                                       CGL010
     C                     MOVEL'Y2U0032' W0RTN                           CGL010
     C                     MOVEL*BLANKS   W0CLPG                          CGL010
     C                     MOVEL'SD9173R' W0CLPG                          CGL010
     C                     MOVEL'Y2U0032' ZAMSID                          CGL010
     C                     MOVEL'Y2USRMSG'ZAMSGF                          CGL010
     C                     MOVELW0CLPG    ZAMSDA                          CGL010
     C                     EXSR ZASNMS                                    CGL010
     C                     ENDIF                                          CGL010
      *                                                                   CGL010
      ** Error detected?                                                  CGL010
      *                                                                   CGL010
     C           W0RTN     IFNE *BLANK                                    CGL010
     C                     MOVE '1'       *IN99                           CGL010
     C                     ENDIF                                          CGL010
      *                                                                   CGL010
      ** CASE: PAR.Work Return code is Terminate                          CGL010
      *                                                                   CGL010
     C           W0RTN     IFEQ 'Y2U9999'                                 CGL010
     C                     MOVE 'CMD01'   P1WRTC                          CGL010
     C                     MOVELW0RTN     P0RTN                           CGL010
     C                     EXSR ZYEXPG                                    CGL010
     C                     ELSE                                           CGL010
      *                                                                   CGL010
      ** CASE: PGM.*Return code is *Previous Screen                       CGL010
      *                                                                   CGL010
     C           W0RTN     IFEQ 'USR0790'                                 CGL010
     C                     MOVEL'Y'       W0DCF                           CGL010
     C                     ENDIF                                          CGL010
     C                     ENDIF                                          CGL010
      *                                                                   CGL010
     C                     ENDIF                                          CGL010
      *                                                                   CGL010
      * USER: Validate detail screen relations
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy member SD9172RVSR - General Ledger Details  *
     C*00/Copy member SD9172R   Validate Screen Relns
     C/COPY WNCPYSRC,SD9172RVSR
     C                     END                             *FI
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         EBPR##    BEGSR
      *================================================================
      * Process record:
      *================================================================
      * Process update request
     C           W0PMD     CASNE'ADD'     EECHRQ
     C                     END
     C           W0RTN     IFNE *BLANK
      * ROLLBACK required
     C                     MOVEL'Y2U0018' P0RTN
     C                     EXSR ZYEXPG
     C                     END
     C           W0RTN     IFEQ *BLANK
      * USER: Process command keys
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy member SD9172RPCK - General Ledger Details  *
     C*00/Copy member SD9172R   Process Command Keys
     C/COPY WNCPYSRC,SD9172RPCK
     C                     END                             *FI
      * Restart program for next record
     C                     MOVEL'N'       W0TRN
     C                     END
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         EECHRQ    BEGSR
      *================================================================
      * Process update request
      *================================================================
      * USER: Change DBF record
      * Change General Ledger 2 - General Ledger Details  *
     C                     EXSR SBCHRC
     C           W0RTN     IFNE *BLANK
      * Data update error
      * Reset screen fields if changed record
     C           W0RTN     CASEQ'Y2U0007' MBFL#1
     C                     END
     C                     ELSE
      * Send message '*Record changed'
     C                     MOVEL'Y2U0012' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
      *================================================================
     CSR         EEEXIT    ENDSR
      /EJECT
     CSR         FACKPM    BEGSR
      *================================================================
      * Check passed parameters
      *================================================================
      * Is full key present?
     C           P2GNLG    IFEQ *BLANK                     General Ledger
      * Not every key field passed - loop program
     C                     MOVEL'Y'       W0RPT   1
     C                     ELSE
      * Full key passed, so single shot program
     C                     MOVEL'N'       W0RPT
     C                     END
      *================================================================
     CSR         FAEXIT    ENDSR
      /EJECT
     CSR         GADSAK    BEGSR
      *================================================================
      * Set key screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSAD    BEGSR
      *================================================================
      * Set detail screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      * Protect key fields on detail screen
     C                     SETON                     88    *
     C                     MOVEL'0'       *IN79
     C                     MOVEL'0'       *IN78
     C           WUMBIN    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           WUNVST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
      * Enable key screen
     C                     SETON                     87    *
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise record - except for key fields and "neither" paramete
      *================================================================
     C                     MOVELP1WRTC    #PWRTC           Work Return cod
     C                     MOVEL*BLANK    #1ACCD           Account Code
     C                     MOVEL*BLANK    #1PLAC           Profit & Loss A
     C                     MOVEL*BLANK    #1CUST           Customer Number
     C                     Z-ADD*ZERO     #1LCD            Last Change Dat
     C                     MOVEL*BLANK    #1TYLC           Type of Last Ch
     C                     MOVEL*BLANK    #1BCTF           Base Currency T
     C                     MOVEL*BLANK    #1AKSI           Accrual Key Sum
     C                     Z-ADD*ZERO     #1APDT           Accruals/Profit
     C                     MOVEL*BLANK    #1APFQ           Accruals/Profit
     C                     Z-ADD*ZERO     #1APFD           Accruals/Profit
     C                     MOVEL*BLANK    #1ALDI           Accrue on Last
     C                     Z-ADD*ZERO     #1APRP           A/c Posting Ret
     C                     MOVEL*BLANK    #1ANWD           Accrual Non-Wk
     C                     Z-ADD*ZERO     #1SRRP           Spot Rates Rete
     C                     Z-ADD*ZERO     #1BRRP           Base Rates Rete
     C                     MOVEL*BLANK    #1GLDI           GL Description
     C                     Z-ADD*ZERO     #1ELAP           End of Last Act
     C                     Z-ADD*ZERO     #1ECAP           End of Current
     C                     MOVEL*BLANK    #1DSFC           Default Stateme
     C                     MOVEL*BLANK    #1FCTF           Foreign CCY Tra
     C                     MOVEL*BLANK    #1FCRC           FC Tfr to Retai
     C                     Z-ADD*ZERO     #1JREP           Journal Retenti
     C                     MOVEL*BLANK    #1MHTN           Mand Batch Tot/
     C                     MOVEL*BLANK    #1JESP           JE Special Char
     C                     MOVEL*BLANK    #1PRCU           Profit Centres
     C                     MOVEL*BLANK    #1PRCA           Profit Centres
     C                     MOVEL*BLANK    #1PCDU           Profit Centre D
     C                     MOVEL*BLANK    #1PMBK           Prof C Def Matr
     C                     MOVEL*BLANK    #1PMTT           Prof C Def Matr
     C                     MOVEL*BLANK    #1PMST           Prof C Def Matr
     C                     MOVEL*BLANK    #1PMDT           Prof C Def Matr
     C                     MOVEL*BLANK    #1PMUR           Prof C Def Matr
     C                     MOVEL*BLANK    #1PMAO           Prof C Def Matr
     C                     MOVEL*BLANK    #1PMCU           Prof C Def Matr
     C                     MOVEL*BLANK    #1PMBH           Prof C Def Matr
      *                                                                   CSD009
      ** Initialise display file fields to blank                          CSD009
      *                                                                   CSD009
     C           CSD009    IFEQ 'Y'                                       CSD009
     C                     MOVEL*BLANK    #1LICD           Prof C Def MatrCSD009
     C                     MOVEL*BLANK    #1BNBI           Prof C Def MatrCSD009
     C                     MOVEL*BLANK    #1CLOC           Prof C Def MatrCSD009
     C                     MOVEL*BLANK    #1RLOC           Prof C Def MatrCSD009
     C                     MOVEL*BLANK    #1CNCZ           Prof C Def MatrCSD009
     C                     MOVEL*BLANK    #1RNCZ           Prof C Def MatrCSD009
     C                     MOVEL*BLANK    #1CSTY           Prof C Def MatrCSD009
     C                     MOVEL*BLANK    #1GPC1           Prof C Def MatrCSD009
     C                     MOVEL*BLANK    #1GPC2           Prof C Def MatrCSD009
     C                     MOVEL*BLANK    #1GPC3           Prof C Def MatrCSD009
     C                     MOVEL*BLANK    #1GPC4           Prof C Def MatrCSD009
     C                     MOVEL*BLANK    #1GPC5           Prof C Def MatrCSD009
     C                     ENDIF                                          CSD009
     C                     MOVEL*BLANK    #1OBRU           Originating Bra
     C                     MOVEL*BLANK    #1OBUV           Orig Branch/Use
     C                     MOVEL*BLANK    #1IEBI           JE Int-Bch Ents
     C                     MOVEL*BLANK    #1IEMB           Int-bch Ent Via
     C                     MOVEL*BLANK    #1PSET           Periodic Proces
     C                     MOVEL*BLANK    #1MABR           Main Branch
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @BKREEC fields to screen
      *================================================================
     C                     MOVELBKGNLG    #1GNLG           General Ledger
     C                     MOVELBKACCD    #1ACCD           Account Code
     C                     MOVELBKPLAC    #1PLAC           Profit & Loss A
     C                     MOVELBKCUST    #1CUST           Customer Number
     C                     Z-ADDBKLCD     #1LCD            Last Change Dat
     C                     MOVELBKTYLC    #1TYLC           Type of Last Ch
     C                     MOVELBKBCTF    #1BCTF           Base Currency T
     C                     MOVELBKAKSI    #1AKSI           Accrual Key Sum
     C                     Z-ADDBKAPDT    #1APDT           Accruals/Profit
     C                     MOVELBKAPFQ    #1APFQ           Accruals/Profit
     C                     Z-ADDBKAPFD    #1APFD           Accruals/Profit
     C                     MOVELBKALDI    #1ALDI           Accrue on Last
     C                     Z-ADDBKAPRP    #1APRP           A/c Posting Ret
     C                     MOVELBKANWD    #1ANWD           Accrual Non-Wk
     C                     Z-ADDBKSRRP    #1SRRP           Spot Rates Rete
     C                     Z-ADDBKBRRP    #1BRRP           Base Rates Rete
     C                     MOVELBKGLDI    #1GLDI           GL Description
     C                     Z-ADDBKELAP    #1ELAP           End of Last Act
     C                     Z-ADDBKECAP    #1ECAP           End of Current
     C                     MOVELBKDSFC    #1DSFC           Default Stateme
     C                     MOVELBKFCTF    #1FCTF           Foreign CCY Tra
     C                     MOVELBKFCRC    #1FCRC           FC Tfr to Retai
     C                     Z-ADDBKJREP    #1JREP           Journal Retenti
     C                     MOVELBKMHTN    #1MHTN           Mand Batch Tot/
     C                     MOVELBKJESP    #1JESP           JE Special Char
     C                     MOVELBKPRCU    #1PRCU           Profit Centres
     C                     MOVELBKPRCA    #1PRCA           Profit Centres
     C                     MOVELBKPCDU    #1PCDU           Profit Centre D
     C                     MOVELBKPMBK    #1PMBK           Prof C Def Matr
     C                     MOVELBKPMTT    #1PMTT           Prof C Def Matr
     C                     MOVELBKPMST    #1PMST           Prof C Def Matr
     C                     MOVELBKPMDT    #1PMDT           Prof C Def Matr
     C                     MOVELBKPMUR    #1PMUR           Prof C Def Matr
     C                     MOVELBKPMAO    #1PMAO           Prof C Def Matr
     C                     MOVELBKPMCU    #1PMCU           Prof C Def Matr
     C                     MOVELBKPMBH    #1PMBH           Prof C Def Matr
      *                                                                   CSD009
      ** Initialise dsp file fields to general ledger fields              CSD009
      *                                                                   CSD009
     C           CSD009    IFEQ 'Y'                                       CSD009
     C                     MOVELBKLICD    #1LICD           Prof C Def MatrCSD009
     C                     MOVELBKBNBI    #1BNBI           Prof C Def MatrCSD009
     C                     MOVELBKCLOC    #1CLOC           Prof C Def MatrCSD009
     C                     MOVELBKRLOC    #1RLOC           Prof C Def MatrCSD009
     C                     MOVELBKCNCZ    #1CNCZ           Prof C Def MatrCSD009
     C                     MOVELBKRNCZ    #1RNCZ           Prof C Def MatrCSD009
     C                     MOVELBKCSTY    #1CSTY           Prof C Def MatrCSD009
     C                     MOVELBKGPC1    #1GPC1           Prof C Def MatrCSD009
     C                     MOVELBKGPC2    #1GPC2           Prof C Def MatrCSD009
     C                     MOVELBKGPC3    #1GPC3           Prof C Def MatrCSD009
     C                     MOVELBKGPC4    #1GPC4           Prof C Def MatrCSD009
     C                     MOVELBKGPC5    #1GPC5           Prof C Def MatrCSD009
     C                     ENDIF                                          CSD009
     C                     MOVELBKOBRU    #1OBRU           Originating Bra
     C                     MOVELBKOBUV    #1OBUV           Orig Branch/Use
     C                     MOVELBKIEBI    #1IEBI           JE Int-Bch Ents
     C                     MOVELBKIEMB    #1IEMB           Int-bch Ent Via
     C                     MOVELBKPSET    #1PSET           Periodic Proces
     C                     MOVELBKMABR    #1MABR           Main Branch
      * Hold existing record image
     C                     MOVEL@1DBRC    #1DBRC
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MDIZ#K    BEGSR
      *================================================================
      * Initialize key screen
      *================================================================
     C                     MOVELP1WRTC    #PWRTC           Work Return cod
     C                     MOVELP2GNLG    #1GNLG           General Ledger
      * USER: Initialize key screen
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy member SD9172RIKS - General Ledger Details  *
     C*00/Copy member SD9172R   Initialise Key Screen
     C/COPY WNCPYSRC,SD9172RIKS
     C                     END                             *FI
      *================================================================
     CSR         MDEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Retrieve Single Branch Cd - Bank Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           BJBANK           Bank
      * Move fields to key list
     C                     MOVE *BLANK    BJBANK           Bank
     C                     MOVEL'BANK'    BJBANK           Bank
     C           KRSSA     CHAIN@BJREEF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0197' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SAEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBJSBRC    WUSBRC           Single Branch C
     C                     END
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBCHRC    BEGSR
      *================================================================
      * Change General Ledger 2 - General Ledger Details  *
      *================================================================
      * Clear all neither parameters
     C                     MOVEL*BLANK    WN0001  4        Account Code
     C                     MOVEL*BLANK    WN0002  4        Profit & Loss A
     C                     MOVEL*BLANK    WN0003  6        Customer Number
     C                     Z-ADD*ZERO     WN0004  50       Last Change Dat
     C                     MOVEL*BLANK    WN0005  1        Type of Last Ch
     C                     MOVEL*BLANK    WN0006  1        Base Currency T
     C                     MOVEL*BLANK    WN0007  1        Accrual Key Sum
     C                     Z-ADD*ZERO     WN0008  50       Accruals/Profit
     C                     MOVEL*BLANK    WN0009  1        Accruals/Profit
     C                     Z-ADD*ZERO     WN0010  20       Accruals/Profit
     C                     MOVEL*BLANK    WN0011  1        Accrue on Last
     C                     Z-ADD*ZERO     WN0012  20       A/c Posting Ret
     C                     MOVEL*BLANK    WN0013  1        Accrual Non-Wk
     C                     Z-ADD*ZERO     WN0014  20       Spot Rates Rete
     C                     Z-ADD*ZERO     WN0015  20       Base Rates Rete
     C                     MOVEL*BLANK    WN0016  1        GL Description
     C                     Z-ADD*ZERO     WN0017  50       End of Last Act
     C                     Z-ADD*ZERO     WN0018  50       End of Current
     C                     MOVEL*BLANK    WN0019  1        Default Stateme
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE 'N'       YARDC   1
      *
      * Move key fields to @BKREEB
     C                     MOVEL#1GNLG    BKGNLG           General Ledger
      *
     C           KLCHSB    KLIST
     C                     KFLD           BKGNLG           General Ledger
     C           KLCHSB    CHAIN@BKREEB              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     END
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     GOTO SBEXIT
     C                     END
      *                                                                   CGL010
      ** Update saved field because record has been updated in            CGL010
      ** SD9173R                                                          CGL010
      *                                                                   CGL010
     C           *IN75     IFEQ '1'                                       CGL010
     C                     MOVEL@1DBRC    #1DBRC                          CGL010
     C                     ENDIF                                          CGL010
      *
      * Check for changed record
     C           #1DBRC    IFNE @1DBRC                     IF
     C                     MOVEL'Y2U0007' W0RTN   7
      * Send message '*Update not accepted'
     C                     MOVEL'Y2U0007' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
      * Release record lock
     C                     UNLCKSDGELRL0               91  *
     C                     GOTO SBEXIT
     C                     END                             FI #1DBRC
      * Store record data for null update check
     C**********           MOVE @1DBRC    YARDCS                                              CGL029
     C                     MOVEL@1DBRC    YARDCS                                              CGL029
      * Move non-key fields to @BKREEB
     C                     MOVEL#1PRCU    BKPRCU           Profit Centres
     C                     MOVEL#1PRCA    BKPRCA           Profit Centres
     C                     MOVEL#1PCDU    BKPCDU           Profit Centre D
     C                     MOVEL#1PMBK    BKPMBK           Prof C Def Matr
     C                     MOVEL#1PMTT    BKPMTT           Prof C Def Matr
     C                     MOVEL#1PMST    BKPMST           Prof C Def Matr
     C                     MOVEL#1PMBH    BKPMBH           Prof C Def Matr
     C                     MOVEL#1PMDT    BKPMDT           Prof C Def Matr
     C                     MOVEL#1PMUR    BKPMUR           Prof C Def Matr
     C                     MOVEL#1PMAO    BKPMAO           Prof C Def Matr
     C                     MOVEL#1PMCU    BKPMCU           Prof C Def Matr
      *                                                                   CSD009
      ** Move Screen fields to general ledger icd file                    CSD009
      *                                                                   CSD009
     C           CSD009    IFEQ 'Y'                                       CSD009
     C                     MOVEL#1LICD    BKLICD           Prof C Def MatrCSD009
     C                     MOVEL#1BNBI    BKBNBI           Prof C Def MatrCSD009
     C                     MOVEL#1CLOC    BKCLOC           Prof C Def MatrCSD009
     C                     MOVEL#1RLOC    BKRLOC           Prof C Def MatrCSD009
     C                     MOVEL#1CNCZ    BKCNCZ           Prof C Def MatrCSD009
     C                     MOVEL#1RNCZ    BKRNCZ           Prof C Def MatrCSD009
     C                     MOVEL#1CSTY    BKCSTY           Prof C Def MatrCSD009
     C                     MOVEL#1GPC1    BKGPC1           Prof C Def MatrCSD009
     C                     MOVEL#1GPC2    BKGPC2           Prof C Def MatrCSD009
     C                     MOVEL#1GPC3    BKGPC3           Prof C Def MatrCSD009
     C                     MOVEL#1GPC4    BKGPC4           Prof C Def MatrCSD009
     C                     MOVEL#1GPC5    BKGPC5           Prof C Def MatrCSD009
     C                     ENDIF                                          CSD009
     C                     MOVEL#1OBRU    BKOBRU           Originating Bra
     C                     MOVEL#1OBUV    BKOBUV           Orig Branch/Use
     C                     MOVEL#1JESP    BKJESP           JE Special Char
     C                     MOVEL#1IEBI    BKIEBI           JE Int-Bch Ents
     C                     MOVEL#1MABR    BKMABR           Main Branch
     C                     MOVEL#1IEMB    BKIEMB           Int-bch Ent Via
     C                     MOVEL#1FCTF    BKFCTF           Foreign CCY Tra
     C                     MOVEL#1FCRC    BKFCRC           FC Tfr to Retai
     C                     MOVEL#1PSET    BKPSET           Periodic Proces
     C                     Z-ADD#1JREP    BKJREP           Journal Retenti
     C                     MOVEL#1MHTN    BKMHTN           Mand Batch Tot/
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YARDCS
     C                     MOVE 'Y'       YARDC
     C                     END
      * USER: Processing before Data update
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * CASE: WRK.Window processing requir. is Yes
     C           WUWDPR    IFEQ 'Y'                        *IF
      * WM call Window Manager - Window manager  *
     C/COPY WNCPYSRC,WN0481CCP1                                           S01408
     C***********          CALL 'WIND01'                                  S01212
     C                     CALL 'WN0010'                                  S01212
     C*********************PARM           ##PGM            Program        S01212
     C                     PARM ##PGM     UPGM   10        Program        S01212
     C*********************PARM *BLANK    FKEY    2        Function Key   S01212
     C                     PARM *BLANK    UFKEY   2        Function Key   S01212
     C*********************PARM           WUMEST           Action  S01212 S01229
     C*********************PARM           WUWMAC           Action  S01212 S01229
     C                     PARM 'A'       UACTCD  1        Action  S01212 S01229
     C                     PARM           DATA             Trans Data     S01212
     C                     PARM *BLANK    W0RTN            Return Code    S01212
     C                     PARM           SPARE 256        Spare Field    LN0355
      * WM Check Return
      * CASE: PAR.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
     C                     MOVELW0RTN     P0RTN            *Return code
     C/COPY WNCPYSRC,SD9172RC01
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: PAR.*Return code is WN Window Error
     C           W0RTN     IFEQ 'USR0563'                  *IF
      * Send message 'WN Window Error'
     C                     MOVEL'USR0563' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO SBEXIT                     *QUIT
     C                     ELSE
      * CASE: PAR.*Return code is *DBF update error
     C           W0RTN     IFEQ 'Y2U0004'                  *IF
      * Send message 'WN Database Error'
     C                     MOVEL'USR0567' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO SBEXIT                     *QUIT
     C                     ELSE
      * CASE: PAR.*Return code is *Previous Screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO SBEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy member SD9172RBUW - General Ledger Details  * S01212
     C*00/Copy member SD9172R   Before Update, Window on
     C/COPY WNCPYSRC,SD9172RBUW
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy member SD9172RBDU - General Ledger Details  *
     C*00/Copy member SD9172R   Processing Before Update
     C/COPY WNCPYSRC,SD9172RBDU
     C                     END                             *FI
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YARDCS
     C                     MOVE 'Y'       YARDC
     C                     END
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BKREEB                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKSDGELRL0               91  *
     C                     END
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * Update saved record image
     C                     MOVEL@1DBRC    #1DBRC
      * DBF change successful
      * USER: Processing after Data update
      * Update TABTB11, TABTB20, TABTB30 and TABTB40.   The program TABTB
      * will be called twice by General Ledger ICD - once by each of the
      * Edit Records - therefore the file controls will be updated twice
      * TABTB11 - General Ledger Details  *
     C                     CALL 'TABTB11'              90  TABTB11
     C**********           PARM BKACCD    WQ0012  4        Account Code                       CGL029
     C**********           PARM BKPLAC    WQ0013  4        Profit & Loss A                    CGL029
     C                     PARM BKACCD    WQ0012 10                                           CGL029
     C                     PARM BKPLAC    WQ0013 10                                           CGL029
     C                     PARM BKCUST    WQ0014  6        Customer Number
     C                     PARM WURDNB    WQ0015  50       Last Change Dat
     C                     PARM 'A'       WQ0016  1        Type of Last Ch
     C                     PARM BKBCTF    WQ0017  1        Base Currency T
     C                     PARM BKAKSI    WQ0018  1        Accrual Key Sum
     C                     PARM BKAPDT    WQ0019  50       Accruals/Profit
     C                     PARM BKAPFQ    WQ0020  1        Accruals/Profit
     C                     PARM BKAPFD    WQ0021  20       Accruals/Profit
     C                     PARM BKALDI    WQ0022  1        Accrue on Last
     C                     PARM BKAPRP    WQ0023  20       A/c Posting Ret
     C                     PARM BKANWD    WQ0024  1        Accrual Non-Wk
     C                     PARM BKPRCU    WQ0025  1        Profit Centres
     C                     PARM BKPRCA    WQ0026  1        Profit Centres
     C                     PARM BKPCDU    WQ0027  1        Profit Centre D
     C                     PARM BKOBRU    WQ0028  1        Originating Bra
     C                     PARM BKOBUV    WQ0029  1        Orig Branch/Use
     C                     PARM BKMABR    WQ0030  3        Main Branch
     C                     PARM BKIEMB    WQ0031  1        Int-bch Ent Via
     C           W0RTN     PARM *BLANK    WQ0032  7        *Return code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'TABTB11' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy member SD9172RADU - General Ledger Details  * S01212
     C*00/Copy member SD9172R   Processing After Update
     C/COPY WNCPYSRC,SD9172RADU
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Get Management Accounts - MIDAS Modules  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           BGMODS           Modules
      * Move fields to key list
     C                     MOVE *BLANK    BGMODS           Modules
     C                     MOVEL'MMOD'    BGMODS           Modules
     C           KRSSC     CHAIN@BGREC8              90    *
      * Data record not found
     C   90                MOVEL'USR0096' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Management Accounts is Yes
     C           BGNVST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUNVST           Management Acco
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUNVST           Management Acco
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Get 'Window required' ind - MIDAS Modules  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           BGMODS           Modules
      * Move fields to key list
     C                     MOVE *BLANK    BGMODS           Modules
     C                     MOVEL'MMOD'    BGMODS           Modules
     C           KRSSD     CHAIN@BGREC8              90    *
      * Data record not found
     C   90                MOVEL'USR0096' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Window processing requir. is Yes
     C           BGWDPR    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUWDPR           Window processi
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * JE Special Character Validation.
      *================================================================
      * CASE: DTL.JE Special Character is Blank
     C           #1JESP    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1JESP    ZA0001           JE Special Char
      * Send message 'Value required - press'?''
     C                     MOVEL'USR0825' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.JE Special Character is Valid Values
     C           #1JESP    IFEQ ''                        *IF
     C           #1JESP    OREQ '<'
     C           #1JESP    OREQ '('
     C           #1JESP    OREQ '|'
     C           #1JESP    OREQ '&'
     C           #1JESP    OREQ '!'
     C           #1JESP    OREQ '$'
     C           #1JESP    OREQ ')'
     C           #1JESP    OREQ ''
     C           #1JESP    OREQ '%'
     C           #1JESP    OREQ '_'
     C           #1JESP    OREQ '>'
     C           #1JESP    OREQ '#'
     C           #1JESP    OREQ '@'
     C           #1JESP    OREQ ''''
     C           #1JESP    OREQ '='
     C           #1JESP    OREQ '"'
     C           #1JESP    OREQ '{'
     C           #1JESP    OREQ '}'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1JESP    ZA0002           JE Special Char
      * Send message 'Invalid value - press '?''
     C                     MOVEL'USR0804' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Profit Centres Validation.
      *================================================================
      * Profit Centres Used must be 'Y' or 'N'.
      * CASE: DTL.Profit Centres Used is Valid values
     C           #1PRCU    IFEQ 'N'                        *IF
     C           #1PRCU    OREQ 'Y'
      * .. Valid Value
     C                     ELSE
      * CASE: DTL.Profit Centres Used is Blank
     C           #1PRCU    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1PRCU    ZA0003           Profit Centres
      * Send message 'Value required'
     C                     MOVEL'USR0740' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1PRCU    ZA0004           Profit Centres
      * Send message 'Profit Ctres Used Invalid'
     C                     MOVEL'USR0801' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Profit Centres Used Validation.
      * CASE: DTL.Profit Centres Used is No
     C           #1PRCU    IFEQ 'N'                        *IF
      * Profit Centres Used is No: PC Amendable & PC D'flts Used must be
      * CASE: DTL.Profit Centres Amendable is No
     C           #1PRCA    IFEQ 'N'                        *IF
      * .. Valid value.
     C                     ELSE
      * CASE: DTL.Profit Centres Amendable is Blank
     C           #1PRCA    IFEQ *BLANK                     *IF
     C                     MOVEL'N'       #1PRCA           Profit Centres
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.Profit Centres Amendable is Yes
     C           #1PRCA    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1PRCA    ZA0005           Profit Centres
      * Send message 'P.C.Used - Amend/Default'
     C                     MOVEL'USR0766' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1PRCA    ZA0006           Profit Centres
      * Send message 'Invalid PC Amend/Def Used'
     C                     MOVEL'USR0907' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DTL.Profit Centre Def'ts Used is No
     C           #1PCDU    IFEQ 'N'                        *IF
     C                     ELSE
      * CASE: DTL.Profit Centre Def'ts Used is Blank
     C           #1PCDU    IFEQ *BLANK                     *IF
     C                     MOVEL'N'       #1PCDU           Profit Centre D
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.Profit Centre Def'ts Used is Yes
     C           #1PCDU    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1PCDU    ZA0007           Profit Centre D
      * Send message 'P.C.Used - Amend/Default'
     C                     MOVEL'USR0766' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9934  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1PCDU    ZA0008           Profit Centre D
      * Send message 'Invalid PC Amend/Def Used'
     C                     MOVEL'USR0907' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9934  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Priorities fields must be blank.
      * PCDM Book must be blank.
      * CASE: DTL.Prof C Def Matrix-Book is Blank or Zero
     C           #1PMBK    IFEQ *BLANK                     *IF
     C           #1PMBK    OREQ '0'
     C                     MOVEL'0'       #1PMBK           Prof C Def Matr
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1PMBK    ZA0009           Prof C Def Matr
      * Send message 'Priorities must be blank'
     C                     MOVEL'USR0814' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
      *
     C                     END                             *FI
      * PCDM Trans-Type must be blank.
      * CASE: DTL.Prof C Def Matrix-T Type is Blank or Zero
     C           #1PMTT    IFEQ *BLANK                     *IF
     C           #1PMTT    OREQ '0'
     C                     MOVEL'0'       #1PMTT           Prof C Def Matr
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1PMTT    ZA0010           Prof C Def Matr
      * Send message 'Priorities must be blank'
     C                     MOVEL'USR0814' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9936  *
      *
     C                     END                             *FI
      * PCDM Sub-Type must be blank.
      * CASE: DTL.Prof C Def Matrix-S Type is Blank or Zero
     C           #1PMST    IFEQ *BLANK                     *IF
     C           #1PMST    OREQ '0'
     C                     MOVEL'0'       #1PMST           Prof C Def Matr
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1PMST    ZA0011           Prof C Def Matr
      * Send message 'Priorities must be blank'
     C                     MOVEL'USR0814' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     END                             *FI
      * PCDM Branch must be blank.
      * CASE: DTL.Prof C Def Matrix-Branch is Blank or Zero
     C           #1PMBH    IFEQ *BLANK                     *IF
     C           #1PMBH    OREQ '0'
     C                     MOVEL'0'       #1PMBH           Prof C Def Matr
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1PMBH    ZA0012           Prof C Def Matr
      * Send message 'Priorities must be blank'
     C                     MOVEL'USR0814' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9942  *
      *
     C                     END                             *FI
      * PCDM Dept must be blank.
      * CASE: DTL.Prof C Def Matrix-Dept is Blank or Zero
     C           #1PMDT    IFEQ *BLANK                     *IF
     C           #1PMDT    OREQ '0'
     C                     MOVEL'0'       #1PMDT           Prof C Def Matr
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1PMDT    ZA0013           Prof C Def Matr
      * Send message 'Priorities must be blank'
     C                     MOVEL'USR0814' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9938  *
      *
     C                     END                             *FI
      * PCDM User must be blank.
      * CASE: DTL.Prof C Def Matrix-User is Blank or Zero
     C           #1PMUR    IFEQ *BLANK                     *IF
     C           #1PMUR    OREQ '0'
     C                     MOVEL'0'       #1PMUR           Prof C Def Matr
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1PMUR    ZA0014           Prof C Def Matr
      * Send message 'Priorities must be blank'
     C                     MOVEL'USR0814' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     END                             *FI
      * PCDM A/c Officer must be blank.
      * CASE: DTL.Prof C Def Matrix-Ac Off is Blank or Zero
     C           #1PMAO    IFEQ *BLANK                     *IF
     C           #1PMAO    OREQ '0'
     C                     MOVEL'0'       #1PMAO           Prof C Def Matr
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1PMAO    ZA0015           Prof C Def Matr
      * Send message 'Priorities must be blank'
     C                     MOVEL'USR0814' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9940  *
      *
     C                     END                             *FI
      * PCDM Customer must be blank.
      * CASE: DTL.Prof C Def Matrix-Cust is Blank or Zero
     C           #1PMCU    IFEQ *BLANK                     *IF
     C           #1PMCU    OREQ '0'
     C                     MOVEL'0'       #1PMCU           Prof C Def Matr
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1PMCU    ZA0016           Prof C Def Matr
      * Send message 'Priorities must be blank'
     C                     MOVEL'USR0814' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9941  *
      *
     C                     END                             *FI
      *                                                                   CSD009
      ** New PCDM Fields must be blank or zero                            CSD009
      *                                                                   CSD009
     C           CSD009    IFEQ 'Y'                                       CSD009
     C                     Z-ADD51        E                               CSD009
     C                     Z-ADD1         Y                               CSD009
     C                     MOVEA#FLDS     ARRB,Y                          CSD009
     C           Y         DOWLE12                                        CSD009
      *                                                                   CSD009
     C           ARRB,Y    IFEQ *BLANK                                    CSD009
     C           ARRB,Y    OREQ '0'                                       CSD009
     C                     MOVEL'0'       ARRB,Y                          CSD009
     C                     ELSE                                           CSD009
      *                                                                   CSD009
      ** Send message 'Priorities must be blank'                          CSD009
      *                                                                   CSD009
     C                     MOVEL'USR0814' ZAMSID                          CSD009
     C                     EXSR ZASNMS                                    CSD009
     C                     MOVE *ON       *IN99                           CSD009
     C                     MOVE *ON       *IN,E                           CSD009
      *                                                                   CSD009
     C                     ENDIF                                          CSD009
     C                     ADD  1         E                               CSD009
     C                     ADD  1         Y                               CSD009
     C                     ENDDO                                          CSD009
     C                     MOVEAARRB,1    #FLDS                           CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
      * Profit Centres Used is Yes: PC Amendable and PC D'flts are mandat
     C                     ELSE
      * CASE: DTL.Profit Centres Used is Yes
     C           #1PRCU    IFEQ 'Y'                        *IF
      * CASE: DTL.Profit Centres Amendable is Blank
     C           #1PRCA    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1PRCA    ZA0017           Profit Centres
      * Send message 'Value required'
     C                     MOVEL'USR0740' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     ELSE
      * CASE: DTL.Profit Centres Amendable is Yes or No
     C           #1PRCA    IFEQ 'N'                        *IF
     C           #1PRCA    OREQ 'Y'
      * If PC Amendable is 'Y' or 'N', no action required.
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1PRCA    ZA0018           Profit Centres
      * Send message 'Inval value - must be Y/N'
     C                     MOVEL'USR0805' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DTL.Profit Centre Def'ts Used is Blank
     C           #1PCDU    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1PCDU    ZA0019           Profit Centre D
      * Send message 'Value required'
     C                     MOVEL'USR0740' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9934  *
      *
     C                     ELSE
      * CASE: DTL.Profit Centre Def'ts Used is Yes or No
     C           #1PCDU    IFEQ 'N'                        *IF
     C           #1PCDU    OREQ 'Y'
      * If PC Defaults Used is 'Y' or 'N', no action required.
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1PCDU    ZA0020           Profit Centre D
      * Send message 'Inval value - must be Y/N'
     C                     MOVEL'USR0805' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9934  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validation for P.C.D.M. Priorities.
      * CASE: DTL.Profit Centres Used is Yes
     C           #1PRCU    IFEQ 'Y'                        *IF
      * Check if Defaults are used.
      * CASE: DTL.Profit Centre Def'ts Used is No
     C           #1PCDU    IFEQ 'N'                        *IF
      * If PC Defaults are NOT used: Priorities must be 0.
      * PCDM Book must be set to 0.
     C                     EXSR UCSUBR                     PCDM Book must
      * PCDM T Type must be set to 0.
     C                     EXSR UDSUBR                     PCDM T Type mus
      * PCDM S Type must be set to 0.
     C                     EXSR UESUBR                     PCDM S Type mus
      * PCDM Branch must be set to 0.
     C                     EXSR UFSUBR                     PCDM Branch mus
      * PCDM Dept must be set to 0.
     C                     EXSR UGSUBR                     PCDM Dept must
      * PCDM User must be set to 0.
     C                     EXSR UHSUBR                     PCDM User must
      * PCDM Ac Off must be set to 0.
     C                     EXSR UISUBR                     PCDM Ac Off mus
      * PCDM Customer must be set to 0.
     C                     EXSR UJSUBR                     PCDM Customer m
      *                                                                   CSD009
      ** New PCDM fields must be set to 0.                                CSD009
      *                                                                   CSD009
     C           CSD009    IFEQ 'Y'                                       CSD009
     C                     EXSR UOSUBR                                    CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
     C                     ELSE
      * CASE: DTL.Profit Centre Def'ts Used is Yes
     C           #1PCDU    IFEQ 'Y'                        *IF
      * If PC Defaults are used: blank Priorities must be set to 0.
      * If PCDM Book is Blank, set to 0.
      * CASE: DTL.Prof C Def Matrix-Book is Blank
     C           #1PMBK    IFEQ *BLANK                     *IF
     C                     MOVEL'0'       #1PMBK           Prof C Def Matr
     C                     END                             *FI
      * If PCDM Trans-Type is Blank, set to 0.
      * CASE: DTL.Prof C Def Matrix-T Type is Blank
     C           #1PMTT    IFEQ *BLANK                     *IF
     C                     MOVEL'0'       #1PMTT           Prof C Def Matr
     C                     END                             *FI
      * If PCDM Sub-Type is Blank, set to 0.
      * CASE: DTL.Prof C Def Matrix-S Type is Blank
     C           #1PMST    IFEQ *BLANK                     *IF
     C                     MOVEL'0'       #1PMST           Prof C Def Matr
     C                     END                             *FI
      * If PCDM Branch is Blank, set to 0.
      * CASE: DTL.Prof C Def Matrix-Branch is Blank
     C           #1PMBH    IFEQ *BLANK                     *IF
     C                     MOVEL'0'       #1PMBH           Prof C Def Matr
     C                     END                             *FI
      * If PCDM Dept is Blank, set to 0.
      * CASE: DTL.Prof C Def Matrix-Dept is Blank
     C           #1PMDT    IFEQ *BLANK                     *IF
     C                     MOVEL'0'       #1PMDT           Prof C Def Matr
     C                     END                             *FI
      * If PCDM User is Blank, set to 0.
      * CASE: DTL.Prof C Def Matrix-User is Blank
     C           #1PMUR    IFEQ *BLANK                     *IF
     C                     MOVEL'0'       #1PMUR           Prof C Def Matr
     C                     END                             *FI
      * If PCDM A/c Officer is Blank, set to 0.
      * CASE: DTL.Prof C Def Matrix-Ac Off is Blank
     C           #1PMAO    IFEQ *BLANK                     *IF
     C                     MOVEL'0'       #1PMAO           Prof C Def Matr
     C                     END                             *FI
      * If PCDM Customer is Blank, set to 0.
      * CASE: DTL.Prof C Def Matrix-Cust is Blank
     C           #1PMCU    IFEQ *BLANK                     *IF
     C                     MOVEL'0'       #1PMCU           Prof C Def Matr
     C                     END                             *FI
      *                                                                   CSD009
      ** If the new PCDM fields is blank, set it to 0.                    CSD009
      *                                                                   CSD009
     C           CSD009    IFEQ 'Y'                                       CSD009
     C                     MOVEA#FLDS     ARRB,1                          CSD009
     C                     Z-ADD1         Y                               CSD009
      *                                                                   CSD009
     C           Y         DOWLE12                                        CSD009
      *                                                                   CSD009
     C           ARRB,Y    IFEQ *BLANK                                    CSD009
     C                     MOVE '0'       ARRB,Y                          CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
     C                     ADD  1         Y                               CSD009
     C                     ENDDO                                          CSD009
      *                                                                   CSD009
     C                     MOVEAARRB,1    #FLDS                           CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
      * Set Invalid Priority field to 'No'.
     C                     MOVEL'N'       WUIVPR           Invalid Priorit
      * Set Error Message Work Fields to 'No'.                            125935
     C                     MOVEL'N'       WUGLM5                          125935
     C* Set Work fields to 'No' used for message 4                        125935
     C                     MOVEL'N'       WWPMBK                          125935
     C                     MOVEL'N'       WWPMTT                          125935
     C                     MOVEL'N'       WWPMST                          125935
     C                     MOVEL'N'       WWPMBH                          125935
     C                     MOVEL'N'       WWPMDT                          125935
     C                     MOVEL'N'       WWPMUR                          125935
     C                     MOVEL'N'       WWPMAO                          125935
     C                     MOVEL'N'       WWPMCU                          125935
      *                                                                   CSD009
      ** Initialise the ff. fields to 'N' only if CSD009 is installed     CSD009
      *                                                                   CSD009
     C           CSD009    IFEQ 'Y'                                       CSD009
     C                     MOVEL'N'       WWLICD                          CSD009
     C                     MOVEL'N'       WWBNBI                          CSD009
     C                     MOVEL'N'       WWCLOC                          CSD009
     C                     MOVEL'N'       WWRLOC                          CSD009
     C                     MOVEL'N'       WWCNCZ                          CSD009
     C                     MOVEL'N'       WWRNCZ                          CSD009
     C                     MOVEL'N'       WWCSTY                          CSD009
     C                     MOVEL'N'       WWGPC1                          CSD009
     C                     MOVEL'N'       WWGPC2                          CSD009
     C                     MOVEL'N'       WWGPC3                          CSD009
     C                     MOVEL'N'       WWGPC4                          CSD009
     C                     MOVEL'N'       WWGPC5                          CSD009
     C                     ENDIF                                          CSD009
      * Check that the values entered into the Priority fields are valid.
      * Check PCDM Book is valid value.
      * CASE: DTL.Prof C Def Matrix-Book is Valid values
     C           #1PMBK    IFEQ *BLANK                     *IF
     C           #1PMBK    OREQ '0'
     C           #1PMBK    OREQ '1'
     C           #1PMBK    OREQ '2'
     C           #1PMBK    OREQ '3'
     C           #1PMBK    OREQ '4'
     C           #1PMBK    OREQ '5'
     C           #1PMBK    OREQ '6'
     C           #1PMBK    OREQ '7'
     C           #1PMBK    OREQ '8'
      *                                                                   125935
     C           #1PMBK    IFEQ *BLANK                                    125935
     C           #1PMBK    OREQ '0'                                       125935
      *                                                                   125935
     C           BKPMBK    IFNE '0'                                       125935
     C                     MOVE 'Y'       WWPMBK  1        Flag book code 125935
     C                     END                                            125935
      *                                                                   125935
     C                     ELSE                                           125935
     C*                                                                   125935
     C           BKPMBK    IFEQ '0'                                       125935
     C                     MOVE 'Y'       WUGLM5                          125935
     C                     ELSE                                           125935
     C           #1PMBK    COMP BKPMBK               7070  NOT EQUAL      125935
     C*                                                                   125935
     C           *IN70     IFEQ *ON                                       125935
     C                     MOVE 'Y'       WUGLM5                          125935
     C                     END                                            125935
     C*                                                                   125935
     C                     END                                            125935
     C*                                                                   125935
     C                     END                                            125935
     C*                                                                   125935
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1PMBK    ZA0029           Prof C Def Matr
      * Send message 'Priority not valid value'
     C                     MOVEL'USR0864' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
      *
     C                     MOVEL'Y'       WUIVPR           Invalid Priorit
     C                     END                             *FI
      * Check PCDM Trans-Type is valid value.
      * CASE: DTL.Prof C Def Matrix-T Type is Valid values
     C           #1PMTT    IFEQ *BLANK                     *IF
     C           #1PMTT    OREQ '0'
     C           #1PMTT    OREQ '1'
     C           #1PMTT    OREQ '2'
     C           #1PMTT    OREQ '3'
     C           #1PMTT    OREQ '4'
     C           #1PMTT    OREQ '5'
     C           #1PMTT    OREQ '6'
     C           #1PMTT    OREQ '7'
     C           #1PMTT    OREQ '8'
      *                                                                   125935
     C           #1PMTT    IFEQ *BLANK                                    125935
     C           #1PMTT    OREQ '0'                                       125935
      *                                                                   125935
     C           BKPMTT    IFNE '0'                                       125935
     C                     MOVE 'Y'       WWPMTT  1        Work prof ttp  125935
     C                     END                                            125935
      *                                                                   125935
     C                     ELSE                                           125935
     C*                                                                   125935
     C           BKPMTT    IFEQ '0'                                       125935
     C                     MOVE 'Y'       WUGLM5                          125935
     C                     ELSE                                           125935
     C           #1PMTT    COMP BKPMTT               7070  NOT EQUAL      125935
     C*                                                                   125935
     C           *IN70     IFEQ *ON                                       125935
     C                     MOVE 'Y'       WUGLM5                          125935
     C                     END                                            125935
     C*                                                                   125935
     C                     END                                            125935
     C*                                                                   125935
     C                     END                                            125935
     C*                                                                   125935
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1PMTT    ZA0030           Prof C Def Matr
      * Send message 'Priority not valid value'
     C                     MOVEL'USR0864' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9936  *
      *
     C                     MOVEL'Y'       WUIVPR           Invalid Priorit
     C                     END                             *FI
      * Check PCDM Sub-Type is valid value.
      * CASE: DTL.Prof C Def Matrix-S Type is Valid values
     C           #1PMST    IFEQ *BLANK                     *IF
     C           #1PMST    OREQ '0'
     C           #1PMST    OREQ '1'
     C           #1PMST    OREQ '2'
     C           #1PMST    OREQ '3'
     C           #1PMST    OREQ '4'
     C           #1PMST    OREQ '5'
     C           #1PMST    OREQ '6'
     C           #1PMST    OREQ '7'
     C           #1PMST    OREQ '8'
      *                                                                   125935
     C           #1PMST    IFEQ *BLANK                                    125935
     C           #1PMST    OREQ '0'                                       125935
      *                                                                   125935
     C           BKPMST    IFNE '0'                                       125935
     C                     MOVE 'Y'       WWPMST  1        Flag sub type  125935
     C                     END                                            125935
      *                                                                   125935
     C                     ELSE                                           125935
     C*                                                                   125935
     C           BKPMST    IFEQ '0'                                       125935
     C                     MOVE 'Y'       WUGLM5                          125935
     C                     ELSE                                           125935
     C           #1PMST    COMP BKPMST               7070  NOT EQUAL      125935
     C*                                                                   125935
     C           *IN70     IFEQ *ON                                       125935
     C                     MOVE 'Y'       WUGLM5                          125935
     C                     END                                            125935
     C*                                                                   125935
     C                     END                                            125935
     C*                                                                   125935
     C                     END                                            125935
     C*                                                                   125935
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1PMST    ZA0031           Prof C Def Matr
      * Send message 'Priority not valid value'
     C                     MOVEL'USR0864' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     MOVEL'Y'       WUIVPR           Invalid Priorit
     C                     END                             *FI
      * Check PCDM Branch is valid value.
      * CASE: DTL.Prof C Def Matrix-Branch is Valid values
     C           #1PMBH    IFEQ *BLANK                     *IF
     C           #1PMBH    OREQ '0'
     C           #1PMBH    OREQ '1'
     C           #1PMBH    OREQ '2'
     C           #1PMBH    OREQ '3'
     C           #1PMBH    OREQ '4'
     C           #1PMBH    OREQ '5'
     C           #1PMBH    OREQ '6'
     C           #1PMBH    OREQ '7'
     C           #1PMBH    OREQ '8'
      *                                                                   125935
     C           #1PMBH    IFEQ *BLANK                                    125935
     C           #1PMBH    OREQ '0'                                       125935
      *                                                                   125935
     C           BKPMBH    IFNE '0'                                       125935
     C                     MOVE 'Y'       WWPMBH  1        Flag branch cod125935
     C                     END                                            125935
      *                                                                   125935
     C                     ELSE                                           125935
     C*                                                                   125935
     C           BKPMBH    IFEQ '0'                                       125935
     C                     MOVE 'Y'       WUGLM5                          125935
     C                     ELSE                                           125935
     C           #1PMBH    COMP BKPMBH               7070  NOT EQUAL      125935
     C*                                                                   125935
     C           *IN70     IFEQ *ON                                       125935
     C                     MOVE 'Y'       WUGLM5                          125935
     C                     END                                            125935
     C*                                                                   125935
     C                     END                                            125935
     C*                                                                   125935
     C                     END                                            125935
     C*                                                                   125935
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1PMBH    ZA0032           Prof C Def Matr
      * Send message 'Priority not valid value'
     C                     MOVEL'USR0864' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9942  *
      *
     C                     MOVEL'Y'       WUIVPR           Invalid Priorit
     C                     END                             *FI
      * Check PCDM Dept is valid value.
      * CASE: DTL.Prof C Def Matrix-Dept is Valid values
     C           #1PMDT    IFEQ *BLANK                     *IF
     C           #1PMDT    OREQ '0'
     C           #1PMDT    OREQ '1'
     C           #1PMDT    OREQ '2'
     C           #1PMDT    OREQ '3'
     C           #1PMDT    OREQ '4'
     C           #1PMDT    OREQ '5'
     C           #1PMDT    OREQ '6'
     C           #1PMDT    OREQ '7'
     C           #1PMDT    OREQ '8'
      ****                                                                125935
     C           #1PMDT    IFEQ *BLANK                                    125935
     C           #1PMDT    OREQ '0'                                       125935
      *                                                                   125935
     C           BKPMDT    IFNE '0'                                       125935
     C                     MOVE 'Y'       WWPMDT  1        Flag Dept code 125935
     C                     END                                            125935
      *                                                                   125935
     C                     ELSE                                           125935
     C*                                                                   125935
     C           BKPMDT    IFEQ '0'                                       125935
     C                     MOVE 'Y'       WUGLM5                          125935
     C                     ELSE                                           125935
     C           #1PMDT    COMP BKPMDT               7070  NOT EQUAL      125935
     C*                                                                   125935
     C           *IN70     IFEQ *ON                                       125935
     C                     MOVE 'Y'       WUGLM5                          125935
     C                     END                                            125935
     C*                                                                   125935
     C                     END                                            125935
     C*                                                                   125935
     C                     END                                            125935
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1PMDT    ZA0033           Prof C Def Matr
      * Send message 'Priority not valid value'
     C                     MOVEL'USR0864' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9938  *
      *
     C                     MOVEL'Y'       WUIVPR           Invalid Priorit
     C                     END                             *FI
      * Check PCDM User is valid value.
      * CASE: DTL.Prof C Def Matrix-User is Valid values
     C           #1PMUR    IFEQ *BLANK                     *IF
     C           #1PMUR    OREQ '0'
     C           #1PMUR    OREQ '1'
     C           #1PMUR    OREQ '2'
     C           #1PMUR    OREQ '3'
     C           #1PMUR    OREQ '4'
     C           #1PMUR    OREQ '5'
     C           #1PMUR    OREQ '6'
     C           #1PMUR    OREQ '7'
     C           #1PMUR    OREQ '8'
      ****                                                                125935
     C           #1PMUR    IFEQ *BLANK                                    125935
     C           #1PMUR    OREQ '0'                                       125935
      *                                                                   125935
     C           BKPMUR    IFNE '0'                                       125935
     C                     MOVE 'Y'       WWPMUR  1        Flag user      125935
     C                     END                                            125935
      *                                                                   125935
     C                     ELSE                                           125935
     C*                                                                   125935
     C           BKPMUR    IFEQ '0'                                       125935
     C                     MOVEL'Y'       WUGLM5                          125935
     C                     ELSE                                           125935
     C           #1PMUR    COMP BKPMUR               7070  NOT EQUAL      125935
     C*                                                                   125935
     C           *IN70     IFEQ *ON                                       125935
     C                     MOVEL'Y'       WUGLM5                          125935
     C                     END                                            125935
     C*                                                                   125935
     C                     END                                            125935
     C*                                                                   125935
     C                     END                                            125935
      ****                                                                125935
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1PMUR    ZA0034           Prof C Def Matr
      * Send message 'Priority not valid value'
     C                     MOVEL'USR0864' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     MOVEL'Y'       WUIVPR           Invalid Priorit
     C                     END                             *FI
      * Check PCDM A/c Officer is valid value.
      * CASE: DTL.Prof C Def Matrix-Ac Off is Valid values
     C           #1PMAO    IFEQ *BLANK                     *IF
     C           #1PMAO    OREQ '0'
     C           #1PMAO    OREQ '1'
     C           #1PMAO    OREQ '2'
     C           #1PMAO    OREQ '3'
     C           #1PMAO    OREQ '4'
     C           #1PMAO    OREQ '5'
     C           #1PMAO    OREQ '6'
     C           #1PMAO    OREQ '7'
     C           #1PMAO    OREQ '8'
      *                                                                   125935
     C           #1PMAO    IFEQ *BLANK                                    125935
     C           #1PMAO    OREQ '0'                                       125935
      *                                                                   125935
     C           BKPMAO    IFNE '0'                                       125935
     C                     MOVE 'Y'       WWPMAO  1        Flag Acc Office125935
     C                     END                                            125935
      *                                                                   125935
     C                     ELSE                                           125935
     C*                                                                   125935
     C           BKPMAO    IFEQ '0'                                       125935
     C                     MOVEL'Y'       WUGLM5                          125935
     C                     ELSE                                           125935
     C           #1PMAO    COMP BKPMAO               7070  NOT EQUAL      125935
     C*                                                                   125935
     C           *IN70     IFEQ *ON                                       125935
     C                     MOVEL'Y'       WUGLM5                          125935
     C                     END                                            125935
     C*                                                                   125935
     C                     END                                            125935
     C*                                                                   125935
     C                     END                                            125935
      ****                                                                125935
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1PMAO    ZA0035           Prof C Def Matr
      * Send message 'Priority not valid value'
     C                     MOVEL'USR0864' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9940  *
      *
     C                     MOVEL'Y'       WUIVPR           Invalid Priorit
     C                     END                             *FI
      * Check PCDM Customer is valid value.
      * CASE: DTL.Prof C Def Matrix-Cust is Valid values
     C           #1PMCU    IFEQ *BLANK                     *IF
     C           #1PMCU    OREQ '0'
     C           #1PMCU    OREQ '1'
     C           #1PMCU    OREQ '2'
     C           #1PMCU    OREQ '3'
     C           #1PMCU    OREQ '4'
     C           #1PMCU    OREQ '5'
     C           #1PMCU    OREQ '6'
     C           #1PMCU    OREQ '7'
     C           #1PMCU    OREQ '8'
      *                                                                   125935
     C           #1PMCU    IFEQ *BLANK                                    125935
     C           #1PMCU    OREQ '0'                                       125935
      *                                                                   125935
     C           BKPMCU    IFNE '0'                                       125935
     C                     MOVE 'Y'       WWPMCU  1        Flag cust No   125935
     C                     END                                            125935
      *                                                                   125935
     C                     ELSE                                           125935
      *                                                                   125935
     C           BKPMCU    IFEQ '0'                                       125935
     C                     MOVEL'Y'       WUGLM5                          125935
     C                     ELSE                                           125935
     C           #1PMCU    COMP BKPMCU               7070  NOT EQUAL      125935
     C*                                                                   125935
     C           *IN70     IFEQ *ON                                       125935
     C                     MOVEL'Y'       WUGLM5                          125935
     C                     END                                            125935
     C*                                                                   125935
     C                     END                                            125935
     C*                                                                   125935
     C                     END                                            125935
      ****                                                                125935
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1PMCU    ZA0036           Prof C Def Matr
      * Send message 'Priority not valid value'
     C                     MOVEL'USR0864' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9941  *
      *
     C                     MOVEL'Y'       WUIVPR           Invalid Priorit
     C                     END                             *FI
      *                                                                   CSD009
      ** Check PCDM Local industry code value                             CSD009
      *                                                                   CSD009
     C           CSD009    IFEQ 'Y'                                       CSD009
     C                     Z-ADD0         X                               CSD009
     C           DIGITS    CHECK#1LICD    X                               CSD009
     C           X         IFEQ 0                                         CSD009
      *                                                                   CSD009
     C           #1LICD    IFEQ *BLANK                                    CSD009
     C           #1LICD    OREQ '0'                                       CSD009
      *                                                                   CSD009
     C           BKLICD    IFNE '0'                                       CSD009
     C                     MOVE 'Y'       WWLICD  1                       CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
     C                     ELSE                                           CSD009
      *                                                                   CSD009
     C           BKLICD    IFEQ '0'                                       CSD009
     C           BKLICD    ORNE '0'                                       CSD009
     C           #1LICD    ANDNEBKLICD                                    CSD009
     C                     MOVE 'Y'       WUGLM5                          CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
     C                     ELSE                                           CSD009
      *                                                                   CSD009
      ** Send message 'Priority not valid value'                          CSD009
      *                                                                   CSD009
     C                     MOVEL'USR0864' ZAMSID                          CSD009
     C                     EXSR ZASNMS                                    CSD009
     C                     MOVE *ON       *IN99                           CSD009
     C                     MOVE *ON       *IN51                           CSD009
      *                                                                   CSD009
     C                     MOVEL'Y'       WUIVPR                          CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
      ** Check PCDM Bank/Non-Bank Information                             CSD009
      *                                                                   CSD009
     C                     Z-ADD0         X                               CSD009
     C           DIGITS    CHECK#1BNBI    X                               CSD009
     C           X         IFEQ 0                                         CSD009
      *                                                                   CSD009
     C           #1BNBI    IFEQ *BLANK                                    CSD009
     C           #1BNBI    OREQ '0'                                       CSD009
      *                                                                   CSD009
     C           BKBNBI    IFNE '0'                                       CSD009
     C                     MOVE 'Y'       WWBNBI  1                       CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
     C                     ELSE                                           CSD009
      *                                                                   CSD009
     C           BKBNBI    IFEQ '0'                                       CSD009
     C           BKBNBI    ORNE '0'                                       CSD009
     C           #1BNBI    ANDNEBKBNBI                                    CSD009
     C                     MOVE 'Y'       WUGLM5                          CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
     C                     ELSE                                           CSD009
      *                                                                   CSD009
      ** Send message 'Priority not valid value'                          CSD009
      *                                                                   CSD009
     C                     MOVEL'USR0864' ZAMSID                          CSD009
     C                     EXSR ZASNMS                                    CSD009
     C                     MOVE *ON       *IN99                           CSD009
     C                     MOVE *ON       *IN52                           CSD009
      *                                                                   CSD009
     C                     MOVEL'Y'       WUIVPR                          CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
      ** Check PCDM Country of domicile                                   CSD009
      *                                                                   CSD009
     C                     Z-ADD0         X                               CSD009
     C           DIGITS    CHECK#1CLOC    X                               CSD009
     C           X         IFEQ 0                                         CSD009
      *                                                                   CSD009
     C           #1CLOC    IFEQ *BLANK                                    CSD009
     C           #1CLOC    OREQ '0'                                       CSD009
      *                                                                   CSD009
     C           BKCLOC    IFNE '0'                                       CSD009
     C                     MOVE 'Y'       WWCLOC  1                       CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
     C                     ELSE                                           CSD009
      *                                                                   CSD009
     C           BKCLOC    IFEQ '0'                                       CSD009
     C           BKCLOC    ORNE '0'                                       CSD009
     C           #1CLOC    ANDNEBKCLOC                                    CSD009
     C                     MOVE 'Y'       WUGLM5                          CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
     C                     ELSE                                           CSD009
      *                                                                   CSD009
      ** Send message 'Priority not valid value'                          CSD009
      *                                                                   CSD009
     C                     MOVEL'USR0864' ZAMSID                          CSD009
     C                     EXSR ZASNMS                                    CSD009
     C                     MOVE *ON       *IN99                           CSD009
     C                     MOVE *ON       *IN53                           CSD009
      *                                                                   CSD009
     C                     MOVEL'Y'       WUIVPR                          CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
      ** Check PCDM Region of domicile                                    CSD009
      *                                                                   CSD009
     C                     Z-ADD0         X                               CSD009
     C           DIGITS    CHECK#1RLOC    X                               CSD009
     C           X         IFEQ 0                                         CSD009
      *                                                                   CSD009
     C           #1RLOC    IFEQ *BLANK                                    CSD009
     C           #1RLOC    OREQ '0'                                       CSD009
      *                                                                   CSD009
     C           BKRLOC    IFNE '0'                                       CSD009
     C                     MOVE 'Y'       WWRLOC  1                       CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
     C                     ELSE                                           CSD009
      *                                                                   CSD009
     C           BKRLOC    IFEQ '0'                                       CSD009
     C           BKRLOC    ORNE '0'                                       CSD009
     C           #1RLOC    ANDNEBKCLOC                                    CSD009
     C                     MOVE 'Y'       WUGLM5                          CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
     C                     ELSE                                           CSD009
      *                                                                   CSD009
      ** Send message 'Priority not valid value'                          CSD009
      *                                                                   CSD009
     C                     MOVEL'USR0864' ZAMSID                          CSD009
     C                     EXSR ZASNMS                                    CSD009
     C                     MOVE *ON       *IN99                           CSD009
     C                     MOVE *ON       *IN54                           CSD009
     C                     MOVEL'Y'       WUIVPR                          CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
      ** Check PCDM Country of citizenship                                CSD009
      *                                                                   CSD009
     C                     Z-ADD0         X                               CSD009
     C           DIGITS    CHECK#1CNCZ    X                               CSD009
     C           X         IFEQ 0                                         CSD009
      *                                                                   CSD009
     C           #1CNCZ    IFEQ *BLANK                                    CSD009
     C           #1CNCZ    OREQ '0'                                       CSD009
      *                                                                   CSD009
     C           BKCNCZ    IFNE '0'                                       CSD009
     C                     MOVE 'Y'       WWCNCZ  1                       CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
     C                     ELSE                                           CSD009
      *                                                                   CSD009
     C           BKCNCZ    IFEQ '0'                                       CSD009
     C           BKCNCZ    ORNE '0'                                       CSD009
     C           #1CNCZ    ANDNEBKCNCZ                                    CSD009
     C                     MOVE 'Y'       WUGLM5                          CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
     C                     ELSE                                           CSD009
      *                                                                   CSD009
      ** Send message 'Priority not valid value'                          CSD009
      *                                                                   CSD009
     C                     MOVEL'USR0864' ZAMSID                          CSD009
     C                     EXSR ZASNMS                                    CSD009
     C                     MOVE *ON       *IN99                           CSD009
     C                     MOVE *ON       *IN55                           CSD009
      *                                                                   CSD009
     C                     MOVEL'Y'       WUIVPR                          CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
      ** Check PCDM Region of citizenship                                 CSD009
      *                                                                   CSD009
     C                     Z-ADD0         X                               CSD009
     C           DIGITS    CHECK#1RNCZ    X                               CSD009
     C           X         IFEQ 0                                         CSD009
      *                                                                   CSD009
     C           #1RNCZ    IFEQ *BLANK                                    CSD009
     C           #1RNCZ    OREQ '0'                                       CSD009
      *                                                                   CSD009
     C           BKRNCZ    IFNE '0'                                       CSD009
     C                     MOVE 'Y'       WWRNCZ  1                       CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
     C                     ELSE                                           CSD009
      *                                                                   CSD009
     C           BKRNCZ    IFEQ '0'                                       CSD009
     C           BKRNCZ    ORNE '0'                                       CSD009
     C           #1RNCZ    ANDNEBKRNCZ                                    CSD009
     C                     MOVE 'Y'       WUGLM5                          CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
     C                     ELSE                                           CSD009
      *                                                                   CSD009
      ** Send message 'Priority not valid value'                          CSD009
      *                                                                   CSD009
     C                     MOVEL'USR0864' ZAMSID                          CSD009
     C                     EXSR ZASNMS                                    CSD009
     C                     MOVE *ON       *IN99                           CSD009
     C                     MOVE *ON       *IN56                           CSD009
     C                     MOVEL'Y'       WUIVPR                          CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
      ** Check PCDM Customer type                                         CSD009
      *                                                                   CSD009
     C                     Z-ADD0         X                               CSD009
     C           DIGITS    CHECK#1CSTY    X                               CSD009
     C           X         IFEQ 0                                         CSD009
      *                                                                   CSD009
     C           #1CSTY    IFEQ *BLANK                                    CSD009
     C           #1CSTY    OREQ '0'                                       CSD009
      *                                                                   CSD009
     C           BKCSTY    IFNE '0'                                       CSD009
     C                     MOVE 'Y'       WWCSTY  1                       CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
     C                     ELSE                                           CSD009
      *                                                                   CSD009
     C           BKCSTY    IFEQ '0'                                       CSD009
     C           BKCSTY    ORNE '0'                                       CSD009
     C           #1CSTY    ANDNEBKCSTY                                    CSD009
     C                     MOVE 'Y'       WUGLM5                          CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
     C                     ELSE                                           CSD009
      *                                                                   CSD009
      ** Send message 'Priority not valid value'                          CSD009
      *                                                                   CSD009
     C                     MOVEL'USR0864' ZAMSID                          CSD009
     C                     EXSR ZASNMS                                    CSD009
     C                     MOVE *ON       *IN99                           CSD009
     C                     MOVE *ON       *IN57                           CSD009
     C                     MOVEL'Y'       WUIVPR                          CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
      ** Check PCDM Group code 1                                          CSD009
      *                                                                   CSD009
     C                     Z-ADD0         X                               CSD009
     C           DIGITS    CHECK#1GPC1    X                               CSD009
     C           X         IFEQ 0                                         CSD009
      *                                                                   CSD009
     C           #1GPC1    IFEQ *BLANK                                    CSD009
     C           #1GPC1    OREQ '0'                                       CSD009
      *                                                                   CSD009
     C           BKGPC1    IFNE '0'                                       CSD009
     C                     MOVE 'Y'       WWGPC1  1                       CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
     C                     ELSE                                           CSD009
      *                                                                   CSD009
     C           BKGPC1    IFEQ '0'                                       CSD009
     C           BKGPC1    ORNE '0'                                       CSD009
     C           #1GPC1    ANDNEBKGPC1                                    CSD009
     C                     MOVE 'Y'       WUGLM5                          CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
     C                     ELSE                                           CSD009
      *                                                                   CSD009
      ** Send message 'Priority not valid value'                          CSD009
      *                                                                   CSD009
     C                     MOVEL'USR0864' ZAMSID                          CSD009
     C                     EXSR ZASNMS                                    CSD009
     C                     MOVE *ON       *IN99                           CSD009
     C                     MOVE *ON       *IN58                           CSD009
      *                                                                   CSD009
     C                     MOVEL'Y'       WUIVPR                          CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
      ** Check PCDM Group code 2                                          CSD009
      *                                                                   CSD009
     C                     Z-ADD0         X                               CSD009
     C           DIGITS    CHECK#1GPC2    X                               CSD009
     C           X         IFEQ 0                                         CSD009
      *                                                                   CSD009
     C           #1GPC2    IFEQ *BLANK                                    CSD009
     C           #1GPC2    OREQ '0'                                       CSD009
      *                                                                   CSD009
     C           BKGPC2    IFNE '0'                                       CSD009
     C                     MOVE 'Y'       WWGPC2  1                       CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
     C                     ELSE                                           CSD009
      *                                                                   CSD009
     C           BKGPC2    IFEQ '0'                                       CSD009
     C           BKGPC2    ORNE '0'                                       CSD009
     C           #1GPC2    ANDNEBKGPC2                                    CSD009
     C                     MOVE 'Y'       WUGLM5                          CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
     C                     ELSE                                           CSD009
      *                                                                   CSD009
      ** Send message 'Priority not valid value'                          CSD009
      *                                                                   CSD009
     C                     MOVEL'USR0864' ZAMSID                          CSD009
     C                     EXSR ZASNMS                                    CSD009
     C                     MOVE *ON       *IN99                           CSD009
     C                     MOVE *ON       *IN59                           CSD009
      *                                                                   CSD009
     C                     MOVEL'Y'       WUIVPR                          CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
      ** Check PCDM Group code 3                                          CSD009
      *                                                                   CSD009
     C                     Z-ADD0         X                               CSD009
     C           DIGITS    CHECK#1GPC3    X                               CSD009
     C           X         IFEQ 0                                         CSD009
      *                                                                   CSD009
     C           #1GPC3    IFEQ *BLANK                                    CSD009
     C           #1GPC3    OREQ '0'                                       CSD009
      *                                                                   CSD009
     C           BKGPC3    IFNE '0'                                       CSD009
     C                     MOVE 'Y'       WWGPC3  1                       CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
     C                     ELSE                                           CSD009
      *                                                                   CSD009
     C           BKGPC3    IFEQ '0'                                       CSD009
     C           BKGPC3    ORNE '0'                                       CSD009
     C           #1GPC3    ANDNEBKGPC3                                    CSD009
     C                     MOVE 'Y'       WUGLM5                          CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
     C                     ELSE                                           CSD009
      *                                                                   CSD009
      ** Send message 'Priority not valid value'                          CSD009
      *                                                                   CSD009
     C                     MOVEL'USR0864' ZAMSID                          CSD009
     C                     EXSR ZASNMS                                    CSD009
     C                     MOVE *ON       *IN99                           CSD009
     C                     MOVE *ON       *IN60                           CSD009
      *                                                                   CSD009
     C                     MOVEL'Y'       WUIVPR                          CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
      ** Check PCDM Group code 4                                          CSD009
      *                                                                   CSD009
     C                     Z-ADD0         X                               CSD009
     C           DIGITS    CHECK#1GPC4    X                               CSD009
     C           X         IFEQ 0                                         CSD009
      *                                                                   CSD009
     C           #1GPC4    IFEQ *BLANK                                    CSD009
     C           #1GPC4    OREQ '0'                                       CSD009
      *                                                                   CSD009
     C           BKGPC4    IFNE '0'                                       CSD009
     C                     MOVE 'Y'       WWGPC4  1                       CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
     C                     ELSE                                           CSD009
      *                                                                   CSD009
     C           BKGPC4    IFEQ '0'                                       CSD009
     C           BKGPC4    ORNE '0'                                       CSD009
     C           #1GPC4    ANDNEBKGPC4                                    CSD009
     C                     MOVE 'Y'       WUGLM5                          CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
     C                     ELSE                                           CSD009
      *                                                                   CSD009
      ** Send message 'Priority not valid value'                          CSD009
      *                                                                   CSD009
     C                     MOVEL'USR0864' ZAMSID                          CSD009
     C                     EXSR ZASNMS                                    CSD009
     C                     MOVE *ON       *IN99                           CSD009
     C                     MOVE *ON       *IN61                           CSD009
      *                                                                   CSD009
     C                     MOVEL'Y'       WUIVPR                          CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
      ** Check PCDM Group code 5                                          CSD009
      *                                                                   CSD009
     C                     Z-ADD0         X                               CSD009
     C           DIGITS    CHECK#1GPC5    X                               CSD009
     C           X         IFEQ 0                                         CSD009
      *                                                                   CSD009
     C           #1GPC5    IFEQ *BLANK                                    CSD009
     C           #1GPC5    OREQ '0'                                       CSD009
      *                                                                   CSD009
     C           BKGPC4    IFNE '0'                                       CSD009
     C                     MOVE 'Y'       WWGPC5  1                       CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
     C                     ELSE                                           CSD009
      *                                                                   CSD009
     C           BKGPC5    IFEQ '0'                                       CSD009
     C           BKGPC5    ORNE '0'                                       CSD009
     C           #1GPC5    ANDNEBKGPC5                                    CSD009
     C                     MOVE 'Y'       WUGLM5                          CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
     C                     ELSE                                           CSD009
      *                                                                   CSD009
      ** Send message 'Priority not valid value'                          CSD009
      *                                                                   CSD009
     C                     MOVEL'USR0864' ZAMSID                          CSD009
     C                     EXSR ZASNMS                                    CSD009
     C                     MOVE *ON       *IN99                           CSD009
     C                     MOVE *ON       *IN62                           CSD009
      *                                                                   CSD009
     C                     MOVEL'Y'       WUIVPR                          CSD009
     C                     ENDIF                                          CSD009
     C                     ENDIF                                          CSD009
      *                                                                   CSD009
      * If Invalid Priority is 'Yes', QUIT.
      * CASE: WRK.Invalid Priority is Yes
     C           WUIVPR    IFEQ 'Y'                        *IF
     C                     GOTO UBEXIT                     *QUIT
     C                     END                             *FI
      * Set Error Message work fields to 'No'.
     C                     MOVEL'N'       WUGLM1           GL Priorities M
     C                     MOVEL'N'       WUGLM2           GL Priorities M
     C                     MOVEL'N'       WUGLM3           GL Priorities M
     C                     MOVEL'N'       WUGLM4           GL Priorities M125935
      * Check Priorities valid - General Ledger Details  *
     C*
     C                     MOVE *IN50     UINST   1
     C*
     C                     CLEARARRA                                      CSD009
     C                     MOVE #1PMBK    ARRA,1
     C                     MOVE #1PMTT    ARRA,2
     C                     MOVE #1PMST    ARRA,3
     C                     MOVE #1PMBH    ARRA,4
     C                     MOVE #1PMDT    ARRA,5
     C                     MOVE #1PMUR    ARRA,6
     C                     MOVE #1PMAO    ARRA,7
     C                     MOVE #1PMCU    ARRA,8
     C           CSD009    IFEQ 'Y'                                       CSD009
     C                     Z-ADD1         Y                               CSD009
     C                     Z-ADD9         X                               CSD009
     C                     MOVEA#FLDS     ARRB,Y                          CSD009
     C           Y         DOWLE12                                        CSD009
     C                     MOVE ARRB,Y    ARRA,X                          CSD009
     C                     ADD  1         Y                               CSD009
     C                     ADD  1         X                               CSD009
     C                     ENDDO                                          CSD009
     C                     ENDIF                                          CSD009
     C*
     C* Sort ARRA into ascending order.
     C*
     C                     SORTAARRA
     C*
     C* Check that at least one Priority Field contains the value '1'.
     C*
     C           1         LOKUPARRA,1                   50
     C           *IN50     IFNE '1'                        IF 1
     C*
     C* No Priority Field equals '1'.
     C                     MOVE 'Y'       WUGLM1
     C                     END                             FI 1
     C*
     C* Allow duplicate of '0' in the Priority Fields.
     C*
     C**********           Z-ADD1         X       10                      CSD009
     C                     Z-ADD1         X       20                      CSD009
     C*
     C********** X         DOUGT8                          DOU 1          CSD009
     C********** ARRA,X    ORGT 0                                         CSD009
     C           X         DOWLE20                                        CSD009
     C           ARRA,X    ANDEQ0                                         CSD009
     C           ARRA,X    IFEQ 0                           IF 1
     C                     ADD  1         X
     C                     END                              FI 1
     C                     END                             UOD 1
     C*
     C* Check that no duplicate values other than '0' exist in the
     C*   Priority Fields.
     C*
     C********** X         IFLT 8                          IF 1           CSD009
     C           X         IFLT 20                                        CSD009
      *                                                                   CSD009
     C********** X         DOWNE8                           DOW 1         CSD009
     C           X         DOWNE20                                        CSD009
     C********** X         ADD  1         Y       10                      CSD009
     C           X         ADD  1         Y       20                      CSD009
     C           ARRA,X    IFEQ ARRA,Y                       IF 2
     C*
     C* Duplicate Priority Field exists.
     C                     MOVE 'Y'       WUGLM2
     C                     END                               FI 2
     C*
     C* Ensure that the values entered into the Priority Fields run
     C*   in sequence.
     C*
     C           ARRA,Y    SUB  ARRA,X    DIFF    10
     C           DIFF      IFNE 1                             IF 3
     C*
     C* Priority Field are not in sequence.
     C                     MOVE 'Y'       WUGLM3
     C                     END                                FI 3
     C                     ADD  1         X
     C                     END                               WOD 1
     C*
     C                     ELSE                             X 1
     C********** X         IFEQ 9                            IF 2         CSD009
     C           X         IFEQ 21                                        CSD009
     C                     MOVE 'Y'       WUGLM1
     C                     END                               FI 2
     C                     END                              FI 1
     C*
     C                     MOVE UINST     *IN50
     C*
     C****                                                                125935
     C           WWPMBK    IFEQ 'Y'                                       125935
     C           WWPMTT    OREQ 'Y'                                       125935
     C           WWPMST    OREQ 'Y'                                       125935
     C           WWPMBH    OREQ 'Y'                                       125935
     C           WWPMDT    OREQ 'Y'                                       125935
     C           WWPMUR    OREQ 'Y'                                       125935
     C           WWPMAO    OREQ 'Y'                                       125935
     C           WWPMCU    OREQ 'Y'                                       125935
     C           WWLICD    OREQ 'Y'                                       CSD009
     C           WWBNBI    OREQ 'Y'                                       CSD009
     C           WWCLOC    OREQ 'Y'                                       CSD009
     C           WWRLOC    OREQ 'Y'                                       CSD009
     C           WWCNCZ    OREQ 'Y'                                       CSD009
     C           WWRNCZ    OREQ 'Y'                                       CSD009
     C           WWCSTY    OREQ 'Y'                                       CSD009
     C           WWGPC1    OREQ 'Y'                                       CSD009
     C           WWGPC2    OREQ 'Y'                                       CSD009
     C           WWGPC3    OREQ 'Y'                                       CSD009
     C           WWGPC4    OREQ 'Y'                                       CSD009
     C           WWGPC5    OREQ 'Y'                                       CSD009
     C                     MOVE *OFF      *IN93                           125935
     C           *LOVAL    SETLLSDPRFML1                                  125935
     C                     READ SDPRFML1                 93               125935
     C***                                                                 125935
     C           *IN93     DOWEQ*OFF                                      125935
     C*                                                                   125935
     C           WWPMBK    IFEQ 'Y'                                       125935
     C           DWBKCD    ANDNE'**'                                      125935
     C                     MOVE 'Y'       WUGLM4                          125935
     C                     MOVELUUPMBK    ZA0110                          125935
     C                     END                                            125935
     C*                                                                   125935
     C           WWPMTT    IFEQ 'Y'                                       125935
     C           DWPCTT    ANDNE'*****'                                   125935
     C                     MOVE 'Y'       WUGLM4                          125935
     C                     MOVELUUPMTT    ZA0111                          125935
     C                     END                                            125935
     C*                                                                   125935
     C           WWPMST    IFEQ 'Y'                                       125935
     C           DWSBTY    ANDNE'**'                                      125935
     C                     MOVE 'Y'       WUGLM4                          125935
     C                     MOVELUUPMST    ZA0112                          125935
     C                     END                                            125935
     C*                                                                   125935
     C           WWPMBH    IFEQ 'Y'                                       125935
     C           DWBRCD    ANDNE'***'                                     125935
     C                     MOVE 'Y'       WUGLM4                          125935
     C           WUMBIN    IFEQ 'Y'                                       125935
     C                     MOVELUUPMBH    ZA0113                          125935
     C                     END                                            125935
     C                     END                                            125935
     C*                                                                   125935
     C           WWPMDT    IFEQ 'Y'                                       125935
     C           DWDPCD    ANDNE'***'                                     125935
     C                     MOVE 'Y'       WUGLM4                          125935
     C                     MOVELUUPMDT    ZA0114                          125935
     C                     END                                            125935
     C*                                                                   125935
     C           WWPMUR    IFEQ 'Y'                                       125935
     C           DWUSID    ANDNESTARS                                     125935
     C                     MOVE 'Y'       WUGLM4                          125935
     C                     MOVELUUPMUR    ZA0115                          125935
     C                     END                                            125935
     C*                                                                   125935
     C           WWPMAO    IFEQ 'Y'                                       125935
     C           DWACOC    ANDNE'**'                                      125935
     C                     MOVE 'Y'       WUGLM4                          125935
     C                     MOVELUUPMAO    ZA0116                          125935
     C                     END                                            125935
     C*                                                                   125935
     C           WWPMCU    IFEQ 'Y'                                       125935
     C           DWCUST    ANDNE'******'                                  125935
     C                     MOVE 'Y'       WUGLM4                          125935
     C                     MOVELUUPMCU    ZA0117                          125935
     C                     END                                            125935
      *                                                                   CSD009
     C           CSD009    IFEQ 'Y'                                       CSD009
     C           WWLICD    IFEQ 'Y'                                       CSD009
     C           DWLICD    ANDNE'***'                                     CSD009
     C           WWBNBI    OREQ 'Y'                                       CSD009
     C           DWBNBI    ANDNE'*'                                       CSD009
     C           WWCLOC    OREQ 'Y'                                       CSD009
     C           DWCLOC    ANDNE'**'                                      CSD009
     C           WWRLOC    OREQ 'Y'                                       CSD009
     C           DWRLOC    ANDNE'**'                                      CSD009
     C           WWCNCZ    OREQ 'Y'                                       CSD009
     C           DWCNCZ    ANDNE'**'                                      CSD009
     C           WWRNCZ    OREQ 'Y'                                       CSD009
     C           DWRNCZ    ANDNE'**'                                      CSD009
     C           WWCSTY    OREQ 'Y'                                       CSD009
     C           DWCSTY    ANDNE'*'                                       CSD009
     C           WWGPC1    OREQ 'Y'                                       CSD009
     C           DWGPC1    ANDNE'****'                                    CSD009
     C           WWGPC2    OREQ 'Y'                                       CSD009
     C           DWGPC2    ANDNE'****'                                    CSD009
     C           WWGPC3    OREQ 'Y'                                       CSD009
     C           DWGPC3    ANDNE'****'                                    CSD009
     C           WWGPC4    OREQ 'Y'                                       CSD009
     C           DWGPC4    ANDNE'****'                                    CSD009
     C           WWGPC5    OREQ 'Y'                                       CSD009
     C           DWGPC5    ANDNE'****'                                    CSD009
     C                     MOVE 'Y'       WUGLM4                          CSD009
     C                     ENDIF                                          CSD009
     C                     ENDIF                                          CSD009
     C*                                                                   125935
     C                     READ SDPRFML1                 93               125935
     C                     END                                            125935
     C***                                                                 125935
     C                     END                                            125935
      * CASE: WRK.GL Priorities Message 1 is Yes
     C           WUGLM1    IFEQ 'Y'                        *IF
      * Start of Fix LN0592
      * CASE: WRK.Multi-branching Indicator is Non-Multi-branched
     C           WUMBIN    IFEQ 'N'                        *IF
      * Setup message data for message
     C                     MOVEL#1PMBK    ZA0037           Prof C Def Matr
     C                     MOVEL#1PMTT    ZA0038           Prof C Def Matr
     C                     MOVEL#1PMST    ZA0039           Prof C Def Matr
     C                     MOVEL#1PMDT    ZA0040           Prof C Def Matr
     C                     MOVEL#1PMUR    ZA0041           Prof C Def Matr
     C                     MOVEL#1PMAO    ZA0042           Prof C Def Matr
     C                     MOVEL#1PMCU    ZA0043           Prof C Def Matr
      * Send message 'SB One priority must be 1'
     C                     MOVEL'USR1444' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993536*
     C                     SETON                     373839*
     C                     SETON                     4041  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1PMBK    ZA0044           Prof C Def Matr
     C                     MOVEL#1PMTT    ZA0045           Prof C Def Matr
     C                     MOVEL#1PMST    ZA0046           Prof C Def Matr
     C                     MOVEL#1PMBH    ZA0047           Prof C Def Matr
     C                     MOVEL#1PMDT    ZA0048           Prof C Def Matr
     C                     MOVEL#1PMUR    ZA0049           Prof C Def Matr
     C                     MOVEL#1PMAO    ZA0050           Prof C Def Matr
     C                     MOVEL#1PMCU    ZA0051           Prof C Def Matr
      * Send message 'One GL Priority must be 1'
     C                     MOVEL'USR0768' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993536*
     C                     SETON                     374238*
     C                     SETON                     394041*
      *
     C                     END                             *FI
      *                                                                   CSD009
      ** Set on new PCDM error indicator fields                           CSD009
      *                                                                   CSD009
     C           CSD009    IFEQ 'Y'                                       CSD009
     C                     MOVEA'11111111'*IN,51                          CSD009
     C                     MOVEA'1111'    *IN,59                          CSD009
     C                     ENDIF                                          CSD009
      * End of Fix LN0592
     C                     END                             *FI
      * CASE: WRK.GL Priorities Message 2 is Yes
     C           WUGLM2    IFEQ 'Y'                        *IF
      * Start of Fix LN0592
      * CASE: WRK.Multi-branching Indicator is Non-Multi-branched
     C           WUMBIN    IFEQ 'N'                        *IF
      * Setup message data for message
     C                     MOVEL#1PMBK    ZA0052           Prof C Def Matr
     C                     MOVEL#1PMTT    ZA0053           Prof C Def Matr
     C                     MOVEL#1PMST    ZA0054           Prof C Def Matr
     C                     MOVEL#1PMDT    ZA0055           Prof C Def Matr
     C                     MOVEL#1PMUR    ZA0056           Prof C Def Matr
     C                     MOVEL#1PMAO    ZA0057           Prof C Def Matr
     C                     MOVEL#1PMCU    ZA0058           Prof C Def Matr
      * Send message 'SB No duplicates in Prior'
     C                     MOVEL'USR1445' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993536*
     C                     SETON                     373839*
     C                     SETON                     4041  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1PMBK    ZA0059           Prof C Def Matr
     C                     MOVEL#1PMTT    ZA0060           Prof C Def Matr
     C                     MOVEL#1PMST    ZA0061           Prof C Def Matr
     C                     MOVEL#1PMBH    ZA0062           Prof C Def Matr
     C                     MOVEL#1PMDT    ZA0063           Prof C Def Matr
     C                     MOVEL#1PMUR    ZA0064           Prof C Def Matr
     C                     MOVEL#1PMAO    ZA0065           Prof C Def Matr
     C                     MOVEL#1PMCU    ZA0066           Prof C Def Matr
      * Send message 'No duplicates in GL Prior'
     C                     MOVEL'USR0769' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993536*
     C                     SETON                     374238*
     C                     SETON                     394041*
      *
     C                     END                             *FI
      *                                                                   CSD009
      ** Set on new PCDM error indicator                                  CSD009
      *                                                                   CSD009
     C           CSD009    IFEQ 'Y'                                       CSD009
     C                     MOVEA'11111111'*IN,51                          CSD009
     C                     MOVEA'1111'    *IN,59                          CSD009
     C                     ENDIF                                          CSD009
      * End of Fix LN0592
     C                     END                             *FI
      * CASE: WRK.GL Priorities Message 3 is Yes
     C           WUGLM3    IFEQ 'Y'                        *IF
      * Start of Fix LN0592
      * CASE: WRK.Multi-branching Indicator is Non-Multi-branched
     C           WUMBIN    IFEQ 'N'                        *IF
      * Setup message data for message
     C                     MOVEL#1PMBK    ZA0067           Prof C Def Matr
     C                     MOVEL#1PMTT    ZA0068           Prof C Def Matr
     C                     MOVEL#1PMST    ZA0069           Prof C Def Matr
     C                     MOVEL#1PMDT    ZA0070           Prof C Def Matr
     C                     MOVEL#1PMUR    ZA0071           Prof C Def Matr
     C                     MOVEL#1PMAO    ZA0072           Prof C Def Matr
     C                     MOVEL#1PMCU    ZA0073           Prof C Def Matr
      * Send message 'SB Priorities in sequence'
     C                     MOVEL'USR1446' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993536*
     C                     SETON                     373839*
     C                     SETON                     4041  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1PMBK    ZA0074           Prof C Def Matr
     C                     MOVEL#1PMTT    ZA0075           Prof C Def Matr
     C                     MOVEL#1PMST    ZA0076           Prof C Def Matr
     C                     MOVEL#1PMBH    ZA0077           Prof C Def Matr
     C                     MOVEL#1PMDT    ZA0078           Prof C Def Matr
     C                     MOVEL#1PMUR    ZA0079           Prof C Def Matr
     C                     MOVEL#1PMAO    ZA0080           Prof C Def Matr
     C                     MOVEL#1PMCU    ZA0081           Prof C Def Matr
      * Send message 'GL Priorities in sequence'
     C                     MOVEL'USR0770' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993536*
     C                     SETON                     374238*
     C                     SETON                     394041*
      *
     C                     END                             *FI
      *                                                                   CSD009
      ** Set on new PCDM error indicator                                  CSD009
      *                                                                   CSD009
     C           CSD009    IFEQ 'Y'                                       CSD009
     C                     MOVEA'11111111'*IN,51                          CSD009
     C                     MOVEA'1111'    *IN,59                          CSD009
     C                     ENDIF                                          CSD009
      * End of Fix LN0592
     C                     END                             *FI
     C*                                                                   125935
      * CASE: WRK.GL Priorities Message 4 is Yes                          125935
     C           WUGLM4    IFEQ 'Y'                        *IF            125935
      * Send message 'GL Priorities cannot be deleted'                    125935
     C                     MOVEL'USR9100' ZAMSID                          125935
     C                     EXSR ZASNMS                                    125935
     C                     SETON                     993536*              125935
     C                     SETON                     374238*              125935
     C                     SETON                     394041*              125935
      *                                                                   CSD009
      ** Set on new PCDM error indicator                                  CSD009
      *                                                                   CSD009
     C           CSD009    IFEQ 'Y'                                       CSD009
     C                     MOVEA'11111111'*IN,51                          CSD009
     C                     MOVEA'1111'    *IN,59                          CSD009
     C                     ENDIF                                          CSD009
     C                     END                             *FI            125935
      *                                                                   125935
     C           *IN99     IFEQ *OFF                                      125935
      * CASE: WRK.GL Priorities Message 5 is Yes                          125935
     C           WUGLM5    IFEQ 'Y'                                       125935
     C* Warning is sent only once if no more fatal errors                 125935
     C           FLAG      IFEQ 'N'                                       125935
     C                     MOVE *ON       *IN80                           125935
     C                     MOVE 'Y'       FLAG                            125935
      ***    Send warning message 'Review default priorities matrix'      125935
     C                     MOVEL'USR9101' ZAMSID                          125935
     C                     MOVEL'*INFO'   ZAMSTP                          125935
     C                     EXSR ZASNMS                                    125935
     C                     ELSE                                           125935
     C                     MOVE *OFF      *IN80                           125935
     C                     MOVE 'N'       FLAG                            125935
     C                     END                                            125935
     C*                                                                   125935
     C                     END                                            125935
     C*                                                                   125935
     C                     ELSE                                           125935
     C                     MOVE 'N'       FLAG                            125935
     C                     END                                            125935
     C*                                                                   125935
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * PCDM Book must be set to 0.
      *================================================================
      * CASE: DTL.Prof C Def Matrix-Book is Blank or Zero
     C           #1PMBK    IFEQ *BLANK                     *IF
     C           #1PMBK    OREQ '0'
     C                     MOVEL'0'       #1PMBK           Prof C Def Matr
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1PMBK    ZA0021           Prof C Def Matr
      * Send message 'PC priority must be blank'
     C                     MOVEL'USR0767' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
      *
     C                     END                             *FI
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * PCDM T Type must be set to 0.
      *================================================================
      * CASE: DTL.Prof C Def Matrix-T Type is Blank or Zero
     C           #1PMTT    IFEQ *BLANK                     *IF
     C           #1PMTT    OREQ '0'
     C                     MOVEL'0'       #1PMTT           Prof C Def Matr
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1PMTT    ZA0022           Prof C Def Matr
      * Send message 'PC priority must be blank'
     C                     MOVEL'USR0767' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9936  *
      *
     C                     END                             *FI
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * PCDM S Type must be set to 0.
      *================================================================
      * CASE: DTL.Prof C Def Matrix-S Type is Blank or Zero
     C           #1PMST    IFEQ *BLANK                     *IF
     C           #1PMST    OREQ '0'
     C                     MOVEL'0'       #1PMST           Prof C Def Matr
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1PMST    ZA0023           Prof C Def Matr
      * Send message 'PC priority must be blank'
     C                     MOVEL'USR0767' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     END                             *FI
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * PCDM Branch must be set to 0.
      *================================================================
      * CASE: DTL.Prof C Def Matrix-Branch is Blank or Zero
     C           #1PMBH    IFEQ *BLANK                     *IF
     C           #1PMBH    OREQ '0'
     C                     MOVEL'0'       #1PMBH           Prof C Def Matr
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1PMBH    ZA0024           Prof C Def Matr
      * Send message 'PC priority must be blank'
     C                     MOVEL'USR0767' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9942  *
      *
     C                     END                             *FI
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * PCDM Dept must be set to 0.
      *================================================================
      * CASE: DTL.Prof C Def Matrix-Dept is Blank or Zero
     C           #1PMDT    IFEQ *BLANK                     *IF
     C           #1PMDT    OREQ '0'
     C                     MOVEL'0'       #1PMDT           Prof C Def Matr
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1PMDT    ZA0025           Prof C Def Matr
      * Send message 'PC priority must be blank'
     C                     MOVEL'USR0767' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9938  *
      *
     C                     END                             *FI
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * PCDM User must be set to 0.
      *================================================================
      * CASE: DTL.Prof C Def Matrix-User is Blank or Zero
     C           #1PMUR    IFEQ *BLANK                     *IF
     C           #1PMUR    OREQ '0'
     C                     MOVEL'0'       #1PMUR           Prof C Def Matr
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1PMUR    ZA0026           Prof C Def Matr
      * Send message 'PC priority must be blank'
     C                     MOVEL'USR0767' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     END                             *FI
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * PCDM Ac Off must be set to 0.
      *================================================================
      * CASE: DTL.Prof C Def Matrix-Ac Off is Blank or Zero
     C           #1PMAO    IFEQ *BLANK                     *IF
     C           #1PMAO    OREQ '0'
     C                     MOVEL'0'       #1PMAO           Prof C Def Matr
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1PMAO    ZA0027           Prof C Def Matr
      * Send message 'PC priority must be blank'
     C                     MOVEL'USR0767' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9940  *
      *
     C                     END                             *FI
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         UJSUBR    BEGSR
      *================================================================
      * PCDM Customer must be set to 0.
      *================================================================
      * CASE: DTL.Prof C Def Matrix-Cust is Blank or Zero
     C           #1PMCU    IFEQ *BLANK                     *IF
     C           #1PMCU    OREQ '0'
     C                     MOVEL'0'       #1PMCU           Prof C Def Matr
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1PMCU    ZA0028           Prof C Def Matr
      * Send message 'PC priority must be blank'
     C                     MOVEL'USR0767' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9941  *
      *
     C                     END                             *FI
      *================================================================
     CSR         UJEXIT    ENDSR
      /EJECT
     CSR         UOSUBR    BEGSR                                          CSD009
      *================================================================   CSD009
      * If New PCDM fields must be set to 0.                              CSD009
      *================================================================   CSD009
      *                                                                   CSD009
     C                     Z-ADD51        E       20                      CSD009
     C                     MOVEA#FLDS     ARRB,1                          CSD009
     C                     Z-ADD1         Y                               CSD009
      *                                                                   CSD009
     C           Y         DOWLE12                                        CSD009
     C           ARRB,Y    IFEQ *BLANK                                    CSD009
     C           ARRB,Y    OREQ '0'                                       CSD009
     C                     MOVEL'0'       ARRB,Y                          CSD009
     C                     ELSE                                           CSD009
      *                                                                   CSD009
      ** Send message 'PC priority must be blank'                         CSD009
      *                                                                   CSD009
     C                     MOVEL'USR0767' ZAMSID                          CSD009
     C                     EXSR ZASNMS                                    CSD009
     C                     MOVE '1'       *IN,E                           CSD009
     C                     MOVE '1'       *IN99                           CSD009
      *                                                                   CSD009
     C                     ENDIF                                          CSD009
     C                     ADD  1         Y                               CSD009
     C                     ADD  1         E                               CSD009
     C                     ENDDO                                          CSD009
     C                     MOVEAARRB,1    #FLDS                           CSD009
      *================================================================   CSD009
     CSR                   ENDSR                                          CSD009
      /EJECT                                                              CSD009
     CSR         UKSUBR    BEGSR
      *================================================================
      * Check if Orig. Branch Used is Blank or Invalid value.
      *================================================================
      * CASE: DTL.Originating Branch Used is Blank
     C           #1OBRU    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1OBRU    ZA0082           Originating Bra
      * Send message 'Value required'
     C                     MOVEL'USR0740' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9943  *
      *
     C                     ELSE
      * CASE: DTL.Originating Branch Used is Valid values
     C           #1OBRU    IFEQ 'N'                        *IF
     C           #1OBRU    OREQ 'Y'
      * .. Valid Value
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1OBRU    ZA0083           Originating Bra
      * Send message 'Inval value - must be Y/N'
     C                     MOVEL'USR0805' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9943  *
      *
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UKEXIT    ENDSR
      /EJECT
     CSR         ULSUBR    BEGSR
      *================================================================
      * Check if Orig. Branch/User Val Required is Blank or Invalid valu
      *================================================================
      * CASE: DTL.Originating Branch Used is No
     C           #1OBRU    IFEQ 'N'                        *IF
      * CASE: DTL.Orig Branch/User Vald Req is No
     C           #1OBUV    IFEQ 'N'                        *IF
      * Valid entry.
     C                     ELSE
      * CASE: DTL.Orig Branch/User Vald Req is Blank
     C           #1OBUV    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1OBUV    ZA0084           Orig Branch/Use
      * Send message 'Value required'
     C                     MOVEL'USR0740' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9944  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1OBUV    ZA0085           Orig Branch/Use
      * Send message 'Orig Brch/User Val Inval'
     C                     MOVEL'USR0850' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9944  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: DTL.Originating Branch Used is Yes
     C           #1OBRU    IFEQ 'Y'                        *IF
      * CASE: DTL.Orig Branch/User Vald Req is Blank
     C           #1OBUV    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1OBUV    ZA0086           Orig Branch/Use
      * Send message 'Value required'
     C                     MOVEL'USR0740' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9944  *
      *
     C                     ELSE
      * CASE: DTL.Orig Branch/User Vald Req is Valid values
     C           #1OBUV    IFEQ 'N'                        *IF
     C           #1OBUV    OREQ 'Y'
      * Valid entry.
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1OBUV    ZA0087           Orig Branch/Use
      * Send message 'Inval value - must be Y/N'
     C                     MOVEL'USR0805' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9944  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         ULEXIT    ENDSR
      /EJECT
     CSR         UMSUBR    BEGSR
      *================================================================
      * Check if JE Inter-branch entries @ Bch/Itm is Blank or Invalid v
      *================================================================
      * CASE: DTL.JE Int-Bch Ents @ Bch/Itm is Blank
     C           #1IEBI    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1IEBI    ZA0088           JE Int-Bch Ents
      * Send message 'Value req. Batch or Item'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9945  *
      *
     C                     ELSE
      * CASE: DTL.JE Int-Bch Ents @ Bch/Itm is Valid values
     C           #1IEBI    IFEQ 'B'                        *IF
     C           #1IEBI    OREQ 'I'
      * ..Valid value.
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1IEBI    ZA0089           JE Int-Bch Ents
      * Send message 'Invalid JE - Bch/Itm'
     C                     MOVEL'USR0806' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9945  *
      *
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UMEXIT    ENDSR
      /EJECT
     CSR         UNSUBR    BEGSR
      *================================================================
      * Check if Inter-branch Entries via Main Branch is Blank or Invali
      *================================================================
      * CASE: DTL.Int-bch Ent Via Main Brch is Blank
     C           #1IEMB    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1IEMB    ZA0090           Int-bch Ent Via
      * Send message 'Value required'
     C                     MOVEL'USR0740' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9946  *
      *
     C                     ELSE
      * CASE: DTL.Int-bch Ent Via Main Brch is Valid values
     C           #1IEMB    IFEQ 'N'                        *IF
     C           #1IEMB    OREQ 'Y'
      * ..Valid value.
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1IEMB    ZA0091           Int-bch Ent Via
      * Send message 'Inval value - must be Y/N'
     C                     MOVEL'USR0805' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9946  *
      *
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UNEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Check reference to Branch Codes
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1MABR    WK1X01  1
     C           WK1X01    IFEQ '?'                        Branch code
     C                     CALL 'SD0061S'              90  Select Branch C
     C                     PARM *BLANK    W0RTN   7
     C           #1MABR    PARM #1MABR    WQ0011  3        Branch code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0061S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9948  *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VAEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1MABR    IFEQ *BLANK                     Branch code
     C                     GOTO VAEXIT
     C                     END
      *
     C           KLVAA8    KLIST
     C                     KFLD           A8BRCD           Branch code
      * Setup key
     C                     MOVEL#1MABR    A8BRCD           Branch code
     C           KLVAA8    CHAIN@A8REB0              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VAEXIT
     C                     END
      * Send message 'Branch code            NF'
     C                     MOVEL'USR0075' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0075' W0RTN
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y1SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y1EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C           @#DFMT    IFEQ '#RCDKEY'
      * KEY Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     END
     C           @#DFMT    IFEQ '#RCDDTL1'
      * DETAIL Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     END
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM 1         YYLGCT  50       # of grps
     C                     PARM W0GRP     YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel and exit from key screen
      *================================================================
      * USER: Exit program processing
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy member SD9172REPP - General Ledger Details  *
     C*00/Copy member SD9172R   Exit Program Processing
     C/COPY WNCPYSRC,SD9172REPP
     C                     END                             *FI
      * CASE: KEY.*CMD key is *Exit
     C           *IN03     IFEQ '1'                        *IF
     C                     MOVEL'CMD01'   P1WRTC           Work Return cod
     C                     END                             *FI
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Setup job date/time
      *
     C                     Z-ADDUDATE     ##JDT
      * Set century digit (If YY prior to 1940 treat as 20YY)
     C           ##JYY     IFLT 40
     C                     Z-ADD1         ##JCC
     C                     ELSE
     C                     Z-ADD0         ##JCC
     C                     END
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Obtain default message file
     C           *NAMVAR   DEFN Y2MGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field S01212
     C                     MOVEL*BLANK    WUMFTS  1
      * Define work field Multi-branching Indicator
     C                     MOVEL*BLANK    WUMBIN  1
      * Define work field Invalid Priority
     C                     MOVEL*BLANK    WUIVPR  1
      * Define work field GL Priorities Message 1
     C                     MOVEL*BLANK    WUGLM1  1
      * Define work field GL Priorities Message 2
     C                     MOVEL*BLANK    WUGLM2  1
      * Define work field GL Priorities Message 3
     C                     MOVEL*BLANK    WUGLM3  1
      * Define work field GL Priorities Message 4                         125935
     C                     MOVEL*BLANK    WUGLM4  1                       125935
      * Define work field GL Priorities Message 5                         125935
     C                     MOVEL*BLANK    WUGLM5  1                       125935
     C* Define work field for warning message                             125935
     C                     MOVEL'N'       FLAG    1                       125935
      * Define work field Single Branch Code
     C                     MOVEL*BLANK    WUSBRC  3
      * Define work field Management Accounts
     C                     MOVEL*BLANK    WUNVST  1
      * Define work field Access Pgm Return Code
     C                     MOVEL*BLANK    WUAPRC  7
      * Define work field Window processing requir.
     C                     MOVEL*BLANK    WUWDPR  1
      * Define work field Run day number
     C                     Z-ADD*ZERO     WURDNB  50
      * Define work field Midas Run Date
     C                     MOVEL*BLANK    WUMRDT  7
      * Define work field Set Up Complete
     C                     MOVEL*BLANK    WUSUC   1
      * Define work field Date format flag
     C                     MOVEL*BLANK    WUDFF   1
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Open files
     C                     OPEN SD9172R#
     C                     OPEN SDGELRL1
     C                     OPEN SDBANKL1
     C                     OPEN SDBRCHL1
     C                     OPEN SDMMODL1
     C                     OPEN SDGELRL0
     C                     MOVEL'N'       W0PMT   1
      * Set to *CHANGE mode
     C                     MOVEL'CHG'     W0PMD   3
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * Start of change S01459.
      * SD9172R precompiler - General Ledger Details  *
      * Remove Last Amend Box and Creation Parameters functions.
      * End of change S01459.
      * Copyright Statement 1988 - Standard Functions  *
      * Get Management Accounts - MIDAS Modules  *
     C                     EXSR SCRVGN
      * Get Rundate - Rundate  *
     C           *NAMVAR   DEFN           RUNDAT
     C                     IN   RUNDAT
     C                     MOVE MRDT      ##MRDT  7        RUN DATE
     C                     MOVE MRDT      WUMRDT
     C                     MOVE RDNB      WURDNB           RUNDAY NO.
     C                     MOVE SUC       WUSUC            SET UP COMPLT
     C                     MOVE DFF       WUDFF            DTE FMT FLAG
     C                     MOVE MBIN      WUMBIN           MULTI BR. IND
     C                     MOVEL'Y'       WUMFTS           S01212
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * Get 'Window required' ind - MIDAS Modules  *
     C                     EXSR SDRVGN
      * Data Struct. for Gen Ledg - General Ledger Details  *
      * 00/Copy member SD9172RIPG - General Ledger Details  *
     C/COPY WNCPYSRC,SD9172RCPG
     C                     END                             *FI
      *                                                                   CGL010
      **  Access SAR details file to see if switchable feature            CGL010
      **  CGL010 is installed                                             CGL010
      *                                                                   CGL010
     C                     CALL 'AOSARDR0'                                CGL010
     C                     PARM *BLANKS   @RTCD   7                       CGL010
     C                     PARM '*VERIFY' @OPTN   7                       CGL010
     C                     PARM 'CGL010'  @SARD   6                       CGL010
      *                                                                   CGL010
     C           @RTCD     IFEQ *BLANK                                    CGL010
     C                     MOVE '1'       *IN75                           CGL010
     C                     ENDIF                                          CGL010
      *                                                                   CSD009
      **  Access SAR details file to see if switchable feature            CSD009
      **  CSD009 is installed                                             CSD009
      *                                                                   CSD009
     C                     CALL 'AOSARDR0'                                CSD009
     C                     PARM *BLANKS   @RTCD                           CSD009
     C                     PARM '*VERIFY' @OPTN                           CSD009
     C                     PARM 'CSD009'  @SARD                           CSD009
     C           SCSARD    PARM SCSARD    DSFDY                           CSD009
      *                                                                   CSD009
     C           @RTCD     IFEQ *BLANK                                    CSD009
     C                     MOVE '1'       *IN49                           CSD009
     C                     MOVE 'Y'       CSD009  1                       CSD009
     C                     ELSE                                           CSD009
     C                     MOVE '0'       *IN49                           CSD009
     C                     MOVE 'N'       CSD009                          CSD009
     C                     ENDIF                                          CSD009
      *
      *================================================================
     CSR         ZZEXIT    ENDSR
      /EJECT
     CSR         *PSSR     BEGSR
      *****************************************************************
      *                                                               *
      * *PSSR  - Program exception error routine                      *
      *          Called automatically if a program error occurs,      *
      *          or directly by the program code using EXSR.          *
      *          This subroutine DUMPs the program just once.         *
      *                                                               *
      *****************************************************************
      *
      * Core function specific processing.
      *
     C/COPY WNCPYSRC,SD9172RPSC
      *
      * Start of PSSR user point.
      *
     C/COPY WNCPYSRC,SD9172RPS1
      *
      * Standard Midas PSSR processing.
      *
     C/COPY SDCPYSRC,SDPSSRICD
      *
      * End of PSSR user point.
      *
     C/COPY WNCPYSRC,SD9172RPS2
      *
      *================================================================
     CSR                   ENDSR
      *================================================================
     O/COPY WNCPYSRC,SD9172ROPG
** CPY@     : Copyright notice for inclusion in all programs
(c) Misys International Banking Systems Ltd. 2001
