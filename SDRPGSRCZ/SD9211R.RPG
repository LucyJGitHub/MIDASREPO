     H        1   Y
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas SD Securities trading ICD maintenance')          *
      *****************************************************************
      *                                                               *
      *  Midas - Standing Data Module                                 *
      *                                                               *
      *  SD9211R - Securities ICD maintenance                         *
      *                                                               *
      *  Function:  This program maintains the Securities ICD record. *
      *                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
      *                                                               *
      *  Last Amend No. CER059             Date 19Jul10               *
      *  Prev Amend No. CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 BUG12434           Date 15Nov06               *
      *                 CSD031             Date 10Apr06               *
      *                 237753             Date 03Feb06               *
      *                 237754  Reopen     Date 31Jan06               *
      *                 237754             Date 26Jan06               *
      *                 CSD027             Date 09Dec05               *
      *                 CSW037A            Date 02May05               *
      *                 BUG6198            Date 04Apr05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 BUG3122            Date 16Jul04               *
      *                 CLE025             Date 20Oct03               *
      *                 224354             Date 16Jan04               *
      *                 217119             Date 03Jun03               *
      *                 CAS006             Date 21Jan03               *
      * Midas Release 4.01.02 ----------------------------------------*
      *                 203557             Date 22May02               *
      *                 203506             Date 12Apr02               *
      *                 198623             Date 12Apr02               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 CSE022             Date 29Mar01               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 182471             Date 09Aug00               *
      * Midas DBA 3.02 -----------------------------------------------*
      *                 CSE006             Date 13May99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 138229             Date 06Oct98               *
      *                 137886             DATE 14Jul98               *
      *                 CEU017             Date 03Mar98               *
      *                 CSE007             Date 01Dec97               *
      *                 CSD003             Date 19JUN98               *
      *                 098899             DATE 14AUG97               *
      *                 099343             DATE 29AUG96               *
      *                 S01408             DATE 02AUG96               *
      *                 094924             DATE 12JUL96               *
      *                 CPM004             DATE 27FEB96               *
      *                 CAC001             DATE 08JAN96               *
      *                 091684             DATE 10AUG95               *
      *                 CAAA01             DATE 22FEB95               *
      *                 S01502 (2)         DATE 15DEC94               *
      *                 S01502             DATE 03AUG94               *
      *                 S01496             DATE 19JUL94               *
      *                 S01464             DATE 04MAY94               *
      *                 066562             DATE 09FEB94               *
      *                 062031             DATE 14DEC93               *
      *                 S01459             DATE 14DEC93               *
      *                 S01433             Date 28OCT93               *
      *                 S01448             Date 09OCT93               *
      *                 S01446             Date 09OCT93               *
      *                 061345             Date 01OCT93               *
      *                 050715             Date 03MAR93               *
      *                 046900             Date 25NOV92               *
      *                 E41661             Date 13AUG92               *
      *                 E40226             Date 13AUG92               *
      *                 E41417             Date 12AUG92               *
      *                 E38886             DATE 11AUG92               *
      *                 S01339             DATE 21JUL92               *
      *                 E24517             Date 18SEP91               *
      *                 S01322             Date 30JAN91               *
      *                 LN1104             Date 24JAN91               *
      *                 LN0662             Date 24JAN91               *
      *                 E20535             Date 28NOV90               *
      *                 E22438             Date 28NOV90               *
      *                 E22735             Date 28NOV90               *
      *                 S01269             Date 05NOV90               *
      *                 LN0571             Date 01Aug90               *
      *                 LN0255             Date 15Jun90               *
      *                 E17978             Date 17FEB90               *
      *                 E18116             Date 05DEC89               *
      *                 E19199             Date 05DEC89               *
      *                 E20422             Date 05DEC89               *
      *                 E19793             Date 07NOV89               *
      *                 S01212             Date 14SEP89               *
      *****************************************************************
      *                                                               *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (Recompile)                                         *
      *  BUG12434 - Suppress validation of trade authorisation field. *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  237753 - Do not default Mark To Market Next Date when        *
      *           Frequency and Base Day is blank. Patterned after    *
      *           fix 185816.                                         *
      *  237754 - Recompiled due to changes in SD9211R# display file. *
      *  (Reopen)                                                     *
      *  237754 - COAC is used to reset field error indicators.       *
      *           Problem is *IN77-80 are not error indicators.  They *
      *           are non-display indicators. Applied 222409.         *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  BUG6198- Cannot save new Details for CUSD (Recompile)        *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  BUG3122 - Recompiled due to changes in SDSECSPD.             *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  224354 - Remove field Historic Prices Retention Period       *
      *  217119 - Errors retrieving date from ICD file - data structure
      *           not increased for CSE006 - and some CSE006 code was *
      *           dependent on CSE007 in error. Also moved fix 137886 *
      *           to put it with CSE007 code (where it logically fits)*
      *  CAS006 - Hedge Accounting Phase B                            *
      *  203557 - Early Redemption/Corporate actions fields           *
      *           not appearing on screen.                            *
      *           Continue 182471                                     *
      *  203506 - Drop SE: Retention period/Back-Value period         *
      *  198623 - Valid range of retention period of matured secu -   *
      *           rities, settled trades, and diary events entry      *
      *           must be from 1 to 99 months.                        *
      *  CSE022 - Depository Definition Enhancement                   *
      *  182471 - Corporate actions fields not appearing on screen.   *
      *  CSE006 - Repurchase Agreement (REPOS) enhancement. If switch *
      *           able feature (CSE006) is active then new fields    *
      *           will be displayed.                                  *
      *  138229 - Patterned after fix 129906.  Retention period of    *
      *           settled trade must be less than or equal to         *
      *           retention period for matured SE.  Valid range of    *
      *           retention of matured SE, settled trade, and diary   *
      *           entry must be from 1 to 12 months.                  *
      *  137886 - Corporate Actions: Add the possibility to allocate  *
      *           (or not) the balancing difference directly to the   *
      *           Dummy Customer.                                     *
      *  CEU017 - Securities Redenomination Euro Changes              *
      *  CSE007 - Corporate Action Feature                            *
      *  CSD003 - Synon Closedown Project (SD):                       *
      *           - Program removed from SD model.                    *
      *  088993 - The Retention Period for Trades added to the Back   *
      *           Value Period must be less than the Retention Period *
      *           for Securities.                                     *
      *  099343 - Do not default zero into Mark-to-Market Next Date   *
      *           field.                                              *
      *  S01408 - Addition of core hooks:                             *
      *           - SD9211RCP1                                        *
      *           - SD9211RCP2                                        *
      *           - WN0481CCP1 (shared window hook)                   *
      *  094924 - Depot customer fields 4 to 10 should also allow     *
      *           customers with a classification of 'M'.             *
      *  CPM004 - PM Bank Portfolios.                                 *
      *           SDBOOKL1 amended - regenerate & recompile.          *
      *  CAC001 - Profit Centre Accounting.                           *
      *           Additional field 'SE Profit Centre'.                *
      *  091684 - The Trade Number Range field should be a            *
      *           mandatory entry.                                    *
      *  CAAA01 - GUI/400 Development.                                *
      *           - Flag MODUPDATE data area for update when          *
      *             SE ICD has been amended.                          *
      *  S01502 - Telekurs Interface Development (2):                 *
      *           Update position 129 on SESTAT.                      *
      *  S01502 - Telekurs Interface Development:                     *
      *           - Addition of Telekurs Interface field.             *
      *           - Amend Extel Option validation to ensure that it   *
      *             is 'N' if the Telekurs Interface field is 'T'     *
      *             or 'C'.                                           *
      *  S01496 - Jyske Enhancements:                                 *
      *           - Addition of Priority Indicators for Charge Dft.   *
      *           - Addition of 'Retention of Position Settlement',   *
      *             'Early Redemption Dummy Customer' and             *
      *             'Trade Number Range'.                             *
      *  S01464 - Add 'Safe Custody Fees Flag' to SDSTRDPD.           *
      *           If this field is 'Y', call Safe custody fees        *
      *           maintenence program.                                *
      *  066562 - Field BVAPS renamed to BVAPST on SDSTRDPD.          *
      *           Regenerate and recompile program.                   *
      *  062031 - The 'Reprompt Defaults' and 'Reprompt Trade         *
      *           Defaults' fields have the same function.            *
      *           Remove 'Reprompt Trade Defaults', and change the    *
      *           'Repromt Defaults.:' text to                        *
      *           'Reprompts: Reprompt Defaults.:'                    *
      *           The validation for 'Autochange option', 'Charges    *
      *           Currency' and 'Adjust Commission same day trade'    *
      *           come before 'Default Brokerage' and 'Agency Book'.  *
      *  S01459 - Addition of headerbox and PSSR processing.          *
      *  S01433 - ENHANCED ROLLOVER PROCESSING:                       *
      *         - REGENERATE/RECOMPILE OVER CHANGED SDCURRPD   .      *
      *  S01448 - BULK INPUT ENHANCEMENTS:                            *
      *         - ADD 'DEFAULT AGENCY TRADE' FIELD.                   *
      *         - ADD 'REVIEW BULK TRADES DEFAULT' FIELD.             *
      *         - ADD 'ALLOW TRADES BETWEEN PORTFOLIO                 *
      *           CUSTOMERS' FIELD.                                   *
      *         - ADDED THE NEW FIELDS TO THE TABTB36 CALL.           *
      *  S01446 - CUSTOMER COMMISSIONS DEVELOPMENT:                   *
      *         - ADD 'CHARGES CURRENCY' FIELD.                       *
      *         - ADD 'ADJUST COMMISSIONS SAME DAY TRADE' FIELD.      *
      *         - ADDED THE NEW FIELDS TO THE TABTB36 CALL.           *
      *  061345 - USE THE 'DEPOT 1 (EUROCLEAR)' HIDDEN SCREEN FIELD   *
      *           AS OUTPUT PARAMETER WHEN RETRIEVING SHORTNAME       *
      *           FOR DEPOT 1 (WHICH IS THE EUROCLEAR DEPOT)          *
      *  050715 - MARK TO MARKET NEXT DATE DID NOT HANDLE US FORMAT   *
      *           CORRECTLY.                                          *
      *  046900 - "SUPPRESS KEYS ON T/V DATE" MUST BE OPTIONAL        *
      *           AND REMOVE E22438, AS IT WAS APPLIED TO THE WRONG   *
      *           FIELD.                                              *
      *  E41661 - RECOMPILED OVER SD9211X. THE FOLLOWING FIELDS       *
      *           WERE SHOWN AS BLANK                                 *
      *           COLLATERAL CCY CONVERSION, FX RISK, ALL             *
      *           HOLDINGS LIMIT FACTOR, CUSTOMER LIMIT FACTOR        *
      *           AND DISCRETIONARY LIMIT FACTOR.                     *
      *  E40226 - PROGRAM DID NOT ACCEPT SE DEPOT CUST ALTHOUGH       *
      *           IT ACCEPTED CUSTOMER SHORTNAME.                     *
      *           *RETURN CODE 'W0RTN' IN 'Check For Live Client'     *
      *           SHOULD BE SET  TO  *Normal (BLANK).                 *
      *  E41417 - Array index error in UERR if 10 depots entered,     *
      *           only 9 elements. Also incorrect initialising of     *
      *           array UDEP in dup. depot checking                   *
      *  E38886 - ALLOW MARK TO MARKET NEXT DATE TO BE TODAY          *
      *  S01339 - PROGRAM RUNS FROM MITEM.                            *
      *  E24517 - UPDATE STANDING DATA FILE CONTROLS                  *
      *  S01322 - REGENERATE AND RECOMPILE DUE TO CHANGE IN           *
      *           SDSTRDPD (LN1114)                                   *
      *  LN1104 - RECOMPILE DUE TO CHANGE IN SDCUSTPD                 *
      *  LN0662 - REGENERATE DUE TO CHANGE IN SDCURRPD                *
      *  E20535 - CHANGE DEFAULTING FOR FORIEGN EXCHANGE RISK AND     *
      *           COLLATERALL CURRENCY CONVERSION AND MAKE BOOK       *
      *           CODES OPTIONAL (LN1031)                             *
      *  E22438 - SUPPRESS KEYS ON TRADE/VALUE DATE SHOULD BE         *
      *           OPTIONAL (LN1031)                                   *
      *  E22735 - MARKET BOOK SHOULD BE OPTIONAL (LN1031)             *
      *  S01269 - TRADE AUTHORISATION - NEW FIELD (LN0952)            *
      *  LN0571 - Check to see if the Customer Number entered         *
      *           appears on Live Customers File. ( SDCUSTL5 )        *
      *  LN0255 - Standardise ICD Headers and Footers                 *
      *  E17978 - If Bulk Input is not selected, Default Brokerage &  *
      *           Agency Book should be left blank (otherwise both    *
      *           are mandatory).                                     *
      *  E18116 - ? processing only works on some of the input fields *
      *  E19199 - Euclid currency codes should be optional if Euclid  *
      *           interface is 'N'                                    *
      *  E20422 - Cursor is not placed on Depot fields that are in    *
      *           error                                               *
      *  E19793 - Settlements Discrepancy fields not validated        *
      *           correctly                                           *
      *  S01212 - Window processing incorporation                     *
      *                                                               *
      *****************************************************************
     F*
     F/COPY WNCPYSRC,SD9211RFPG
     F*
     FSD9211R#CF  E                    WORKSTN                        UC
     F                                              KINFDS INFDS#
     F                                              KINFSR *PSSR
      * DSP: Midas SD Securities trading ICD maintenance
      *
     FSDSTRDL1IF  E           K        DISK                           UC
     F                                              KINFDS INFDS1
     F                                              KINFSR *PSSR
      * RTV : Midas SD Securities trading ICD retrieval
      *
     FSDBANKL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0001
     F                                              KINFSR *PSSR
      * RTV : Midas SD Bank details ICD retrieval
      *
     FSDCURRL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0002
     F                                              KINFSR *PSSR
      * RTV : Midas SD Currency codes retrieval
      *
     FSDPRFCL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0003
     F                                              KINFSR *PSSR
      * RTV : Midas SD Profit centres retrieval
      *
     FSDDLSTL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0004
     F                                              KINFSR *PSSR
      * RTV : Midas SD Deal sub-types retrieval
      *
     FSDCUSTL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0005
     F                                              KINFSR *PSSR
      * RTV : Midas SD Customer details retrieval
      *
     FSDBOOKL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0006
     F                                              KINFSR *PSSR
      * RTV : Midas SD Book details retrieval
      *
     FSDCUSTL2IF  E           K        DISK                           UC
     F                                              KINFDS ID0007
     F                                              KINFSR *PSSR
      * RSQ : Midas SD Customer details by unique shortname
      *
     FSDCUSTL5IF  E           K        DISK                           UC
     F                                              KINFDS ID0008
     F                                              KINFSR *PSSR
      * RSQ : Midas SD Live customers
      *
     FSDSECSL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0009
     F                                              KINFSR *PSSR
      * RTV : Midas SD Securities clients retrieval
      *
     FSDMMODL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0010
     F                                              KINFSR *PSSR
      * RTV : Midas SD Midas module flags retrieval
      *
     FSDGELRL1IF  E           K        DISK                           UC
     F                                              KINFDS ID0011
     F                                              KINFSR *PSSR
      * RTV : Midas SD General ledger ICD details retrieval
      *
     FSDSTRDL0UF  E           K        DISK                           UC
     F                                              KCOMIT
     F                                              KINFDS ID0012
     F                                              KINFSR *PSSR
      * UPD : Midas SD Securities trading ICD update
      *
     FSDFCTLL0UF  E           K        DISK                           UC
     F                                              KCOMIT
     F                                              KINFDS ID0013
     F                                              KINFSR *PSSR
      * UPD : Midas SD Standing data controls update
      *
     E* Validate Default Broker Code - must be in range AA to 99.
     E*
     E                    ARRB   36  36  1
     E*
     E* Data Structure for field Default Broker Code.
     E*
     E                    UDEP       10 10
     E********************UERR        9  1                                E41417
     E                    UERR       10  1                                E41417
     E* Description     : Copyright notice for inclusion in all programs
     E*
     E********************************************************************
     E                    CPY@    1   1 80               Copyright array
     E*
     E/COPY WNCPYSRC,SD9211REPG
     E*
      * Screen one error indicator store
     E                    @I1       100  1
      * Screen two error indicator store
     E                    @I2       100  1
      * Screen three error indicator store
     E                    @I3       100  1
     I*
     I@CUSTD5
      * Midas SD Customer details by unique shortname
      * Renamed input format fields
     I              BBCUST                          WACUST
     I              BBCSSN                          WACSSN
     I              BBCNA1                          WACNA1
     I              BBCNA2                          WACNA2
     I              BBCNA3                          WACNA3
     I              BBCNA4                          WACNA4
     I              BBCRTN                          WACRTN
     I              BBPAIN                          WAPAIN
     I              BBCRNM                          WACRNM
     I              BBDRCS                          WADRCS
     I              BBLCCD                          WALCCD
     I              BBACOC                          WAACOC
     I              BBCNCZ                          WACNCZ
     I              BBCOLC                          WACOLC
     I              BBSSDT                          WASSDT
     I              BBDOIC                          WADOIC
     I              BBPCNB                          WAPCNB
     I              BBCASC                          WACASC
     I              BBBRCD                          WABRCD
     I              BBBNBI                          WABNBI
     I              BBLINC                          WALINC
     I              BBLICD                          WALICD
     I              BBCTNB                          WACTNB
     I              BBREID                          WAREID
     I              BBBSIN                          WABSIN
     I              BBCSTY                          WACSTY
     I              BBTAIN                          WATAIN
     I              BBCSID                          WACSID
     I              BBSTAD                          WASTAD
     I              BBTXA1                          WATXA1
     I              BBTXA2                          WATXA2
     I              BBTXA3                          WATXA3
     I              BBTXA4                          WATXA4
     I              BBTXA5                          WATXA5
     I              BBCHID                          WACHID
     I              BBCHSC                          WACHSC
     I              BBCABA                          WACABA
     I              BBBFIC                          WABFIC
     I              BBBLCD                          WABLCD
     I              BBFWCD                          WAFWCD
     I              BBLCD                           WALCD
     I              BBTYLC                          WATYLC
     I              BBLALD                          WALALD
     I              BBLDHD                          WALDHD
     I              BBLRLD                          WALRLD
     I              BBDTDL                          WADTDL
     I              BBLETI                          WALETI
     I              BBCMTI                          WACMTI
     I              BBGSFM                          WAGSFM
     I              BBSTFG                          WASTFG
     I              BBRWCD                          WARWCD
     I              BBNG01                          WANG01
     I              BBNG02                          WANG02
     I              BBNG03                          WANG03
     I              BBNG04                          WANG04
     I              BBNG05                          WANG05
     I              BBNG06                          WANG06
     I              BBNG07                          WANG07
     I              BBNG08                          WANG08
     I              BBNG09                          WANG09
     I              BBNG10                          WANG10
     I              BBNG11                          WANG11
     I              BBNG12                          WANG12
     I              BBNG13                          WANG13
     I              BBNG14                          WANG14
     I              BBNG15                          WANG15
     I              BBDS01                          WADS01
     I              BBDS02                          WADS02
     I              BBDS03                          WADS03
     I              BBDS04                          WADS04
     I              BBDS05                          WADS05
     I              BBDS06                          WADS06
     I              BBDS07                          WADS07
     I              BBDS08                          WADS08
     I              BBDS09                          WADS09
     I              BBDS10                          WADS10
     I              BBDS11                          WADS11
     I              BBDS12                          WADS12
     I              BBDS13                          WADS13
     I              BBDS14                          WADS14
     I              BBDS15                          WADS15
     I              BBDNW1                          WADNW1
     I              BBDNW2                          WADNW2
     I              BBDNW3                          WADNW3
     I              BBDNW4                          WADNW4
     I              BBDNW5                          WADNW5
     I              BBDNW6                          WADNW6
     I              BBDNW7                          WADNW7
     I              BBDNW8                          WADNW8
     I              BBDNW9                          WADNW9
     I              BBCGRP                          WACGRP
     I              BBCDEL                          WACDEL
     I              BBABA2                          WAABA2
     I              BBOGID                          WAOGID
     I              BBSSDL                          WASSDL
     I              BBORED                          WAORED
     I              BBMCAC                          WAMCAC
     I              BBCRPC                          WACRPC
     I              BBPSWC                          WAPSWC
     I              BBMGTP                          WAMGTP
     I              BBNET                           WANET
     I              BBNTGP                          WANTGP
     I              BBNTCP                          WANTCP
     I              BBNTND                          WANTND
     I              BBNTMM                          WANTMM
     I              BBTICS                          WATICS
     I              BBSWFI                          WASWFI
      *
     I@CUSTFT
      * Midas SD Live customers
      * Renamed input format fields
     I              BBCUST                          WBCUST
     I              BBCSSN                          WBCSSN
     I              BBCNA1                          WBCNA1
     I              BBCNA2                          WBCNA2
     I              BBCNA3                          WBCNA3
     I              BBCNA4                          WBCNA4
     I              BBCRTN                          WBCRTN
     I              BBPAIN                          WBPAIN
     I              BBCRNM                          WBCRNM
     I              BBDRCS                          WBDRCS
     I              BBLCCD                          WBLCCD
     I              BBACOC                          WBACOC
     I              BBCNCZ                          WBCNCZ
     I              BBCOLC                          WBCOLC
     I              BBSSDT                          WBSSDT
     I              BBDOIC                          WBDOIC
     I              BBPCNB                          WBPCNB
     I              BBCASC                          WBCASC
     I              BBBRCD                          WBBRCD
     I              BBBNBI                          WBBNBI
     I              BBLINC                          WBLINC
     I              BBLICD                          WBLICD
     I              BBCTNB                          WBCTNB
     I              BBREID                          WBREID
     I              BBBSIN                          WBBSIN
     I              BBCSTY                          WBCSTY
     I              BBTAIN                          WBTAIN
     I              BBCSID                          WBCSID
     I              BBSTAD                          WBSTAD
     I              BBTXA1                          WBTXA1
     I              BBTXA2                          WBTXA2
     I              BBTXA3                          WBTXA3
     I              BBTXA4                          WBTXA4
     I              BBTXA5                          WBTXA5
     I              BBCHID                          WBCHID
     I              BBCHSC                          WBCHSC
     I              BBCABA                          WBCABA
     I              BBBFIC                          WBBFIC
     I              BBBLCD                          WBBLCD
     I              BBFWCD                          WBFWCD
     I              BBLCD                           WBLCD
     I              BBTYLC                          WBTYLC
     I              BBLALD                          WBLALD
     I              BBLDHD                          WBLDHD
     I              BBLRLD                          WBLRLD
     I              BBDTDL                          WBDTDL
     I              BBLETI                          WBLETI
     I              BBCMTI                          WBCMTI
     I              BBGSFM                          WBGSFM
     I              BBSTFG                          WBSTFG
     I              BBRWCD                          WBRWCD
     I              BBNG01                          WBNG01
     I              BBNG02                          WBNG02
     I              BBNG03                          WBNG03
     I              BBNG04                          WBNG04
     I              BBNG05                          WBNG05
     I              BBNG06                          WBNG06
     I              BBNG07                          WBNG07
     I              BBNG08                          WBNG08
     I              BBNG09                          WBNG09
     I              BBNG10                          WBNG10
     I              BBNG11                          WBNG11
     I              BBNG12                          WBNG12
     I              BBNG13                          WBNG13
     I              BBNG14                          WBNG14
     I              BBNG15                          WBNG15
     I              BBDS01                          WBDS01
     I              BBDS02                          WBDS02
     I              BBDS03                          WBDS03
     I              BBDS04                          WBDS04
     I              BBDS05                          WBDS05
     I              BBDS06                          WBDS06
     I              BBDS07                          WBDS07
     I              BBDS08                          WBDS08
     I              BBDS09                          WBDS09
     I              BBDS10                          WBDS10
     I              BBDS11                          WBDS11
     I              BBDS12                          WBDS12
     I              BBDS13                          WBDS13
     I              BBDS14                          WBDS14
     I              BBDS15                          WBDS15
     I              BBDNW1                          WBDNW1
     I              BBDNW2                          WBDNW2
     I              BBDNW3                          WBDNW3
     I              BBDNW4                          WBDNW4
     I              BBDNW5                          WBDNW5
     I              BBDNW6                          WBDNW6
     I              BBDNW7                          WBDNW7
     I              BBDNW8                          WBDNW8
     I              BBDNW9                          WBDNW9
     I              BBCGRP                          WBCGRP
     I              BBCDEL                          WBCDEL
     I              BBABA2                          WBABA2
     I              BBOGID                          WBOGID
     I              BBSSDL                          WBSSDL
     I              BBORED                          WBORED
     I              BBMCAC                          WBMCAC
     I              BBCRPC                          WBCRPC
     I              BBPSWC                          WBPSWC
     I              BBMGTP                          WBMGTP
     I              BBNET                           WBNET
     I              BBNTGP                          WBNTGP
     I              BBNTCP                          WBNTCP
     I              BBNTND                          WBNTND
     I              BBNTMM                          WBNTMM
     I              BBTICS                          WBTICS
     I              BBSWFI                          WBSWFI
      *
     I*
     I* Description     : Copyright notice for inclusion in all programs
     I*
     I****/COPY QWINDSRC,I8E3DTA                                          S01229
     I/COPY QWINDSRC,SD9210GDTA                                           S01229
     I*
     I/COPY WNCPYSRC,SD9211RIPG
     I*
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     I@1DBRC    E DSSDSTRDL0
      * UPD : Midas SD Securities trading ICD update
      * Current/previous master file format fields for change control
      *
     I*#1DBRC*****DS****************************209                       CSE007
     I*#1DBRC******DS****************************218               CSE007 137886
     I**********#1DBRC******DS                            219     1378 86 CSE006
     I**********#1DBRC      DS                            225                          CSE006 CAS006
     I#1DBRC      DS                            228                                           CAS006
      * Stored master file format fields
     I                                        1   1 #1DB1
      *
     I@@I1        DS
      * Screen one error indicator store
     I                                        1 100 @I1
     I**********                             31  63 INSCR1                                    CAS006
     I                                       31  64 INSCR1                                    CAS006
     I@@I2        DS
      * Screen two error indicator store
     I                                        1 100 @I2
     I                                       31  48 INSCR2
     I***********                            71  73 COAC           CSE007 137886
     I***********                            71  74 COAC           137886 CSE006
     I***********                            71  82 COAC                  CSE006
     I                                       71  76 COAC                                      237754
     I                                       81  82 COAC2                                     237754
     I@@I3        DS
      * Screen three error indicator store
     I                                        1 100 @I3
     I                                       31  68 INSCR3
      * Outward parameters
     I*PARC****   DS                            209                                           217119
     IPARC        DS                            228                                           217119
      * RCD : Midas SD Securities trading ICD retrieval
      * I : MAP Mark to Market Base Date
     I                                      126 1270PAMMBD
      * I : MAP Mark to Market Next Date
     I                                    P 128 1300PAMMND
      * I : MAP Back value period
     I                                    P 144 1450PABVP
      * I : MAP Retention of settled trd
     I                                      146 1470PAROST
      * I : MAP Retention of diary
     I                                      148 1490PARODY
      * I : MAP Retention of matured sec.
     I                                      150 1510PAROMS
      * I : MAP Auto-transmission interfc
     I                                      153 153 PAATI
      * I : MAP Collateral Currency Convt
     I                                    P 159 1600PACCYC
      * I : MAP Foreign Exchange Risk
     I                                    P 161 1620PAFERK
      * I : MAP All Holdings Limit Factor
     I                                    P 164 1650PAAHLF
      * I : MAP Discretionary Limit Fact.
     I                                    P 166 1670PADLF
      * I : MAP Customers Limit Factor
     I                                    P 168 1690PACLF
      **********                                                                       CAS006 224354
      ***Historic*Prices*Retention*Period******************************                CAS006 224354
      **********                                                                       CAS006 224354
     I**********                          P 170 1720PABHPP                             CAS006 224354
      *
      * Outward parameters
     I*PBRC*****  DS                            209                                           217119
     IPBRC        DS                            228                                           217119
      * RCD : Midas SD Securities trading ICD retrieval
      * I : MAP Depot 1 (EUROCLEAR)
     I                                       32  37 PBDR1
      **I*:*MAP*Depot*Ref*3,*Kassenverein******************************   CSE022
      * I : MAP Depot Reference 3 Custome                                 CSE022
     I                                       38  43 PBDR3
      * I : MAP Depot Reference 2 - Cedel
     I                                       50  55 PBDR2
      * I : MAP Depot Reference 4 Custome
     I                                       56  61 PBDR4
      * I : MAP Depot Reference 5 Custome
     I                                       62  67 PBDR5
      *
      * Outward parameters
     I*PCRC*****  DS                            209                                           217119
     IPCRC        DS                            228                                           217119
      * RCD : Midas SD Securities trading ICD retrieval
      * I : MAP Depot Reference 10 Custom
     I                                       44  49 PCDR10
      * I : MAP Depot Reference 6 Custome
     I                                       68  73 PCDR6
      * I : MAP Depot Reference 7 Custome
     I                                       74  79 PCDR7
      * I : MAP Depot Reference 8 Custome
     I                                       80  85 PCDR8
      * I : MAP Depot Reference 9 Custome
     I                                       86  91 PCDR9
      *
     I            DS
     I                                        1   2 #1DBCD
     I                                        1   1 UUDBC1
     I                                        2   2 UUDBC2
     ISESTAT    E DS
     I*
      * Outward parameters
     IPDRC        DS                              6
      * KEY : Midas SD Securities clients retrieval
      * O : MAP Customer Number
     I                                        1   6 PDCUST
      *
     IINPUT       DS
     I                                        1  10 #DDP01
     I                                       11  20 #DDP02
     I                                       21  30 #DDP03
     I                                       31  40 #DDP04
     I                                       41  50 #DDP05
     I                                       51  60 #DDP06
     I                                       61  70 #DDP07
     I                                       71  80 #DDP08
     I                                       81  90 #DDP09
     I                                       91 100 #DDP10
     IOUTPUT      DS
     I                                        1   1 WUERR1
     I                                        2   2 WUERR2
     I                                        3   3 WUERR3
     I                                        4   4 WUERR4
     I                                        5   5 WUERR5
     I                                        6   6 WUERR6
     I                                        7   7 WUERR7
     I                                        8   8 WUERR8
     I                                        9   9 WUERR9
      * Outward parameters
     IPERC        DS                             10
      * KEY : Midas SD Safe custody fees ICD retrieval
      * I : RST Safe Custody Fees ICD Key
     I                                        1  10 PESCFE
      *
     I*YARDCS***  DS                            209                                           217119
     IYARDCS      DS                            228                                           217119
     IQSDFC1    E DSSDFCTLL0
      * UPD : Midas SD Standing data controls update
     IYBRDCS      DS                             22
     IA@CPY       DS
     I* Copyright array
     I                                        1  80 CPY@
     IRUNDAT      DS
     I                                        1   7 MRDT
     I                                    P   8  100RDNB
     I                                       11  11 SUC
     I                                       12  12 DFF
     I                                       13  13 MBIN
     IPRIOR       DS
      * Priority defaults
     I                                        1   5 WUPDFS
     I                                        1   1 WUPCD1
     I                                        2   2 WUPCD2
     I                                        3   3 WUPCD3
     I                                        4   4 WUPCD4
     I                                        5   5 WUPCD5
     IID0001      DS                            528
      * File information data structure
      *
     IID0002      DS                            528
      * File information data structure
      *
     IID0003      DS                            528
      * File information data structure
      *
     IID0004      DS                            528
      * File information data structure
      *
     IID0005      DS                            528
      * File information data structure
      *
     IID0006      DS                            528
      * File information data structure
      *
     IID0007      DS                            528
      * File information data structure
      *
     IID0008      DS                            528
      * File information data structure
      *
     IID0009      DS                            528
      * File information data structure
      *
     IID0010      DS                            528
      * File information data structure
      *
     IID0011      DS                            528
      * File information data structure
      *
     IID0012      DS                            528
      * File information data structure
      *
     IID0013      DS                            528
      * File information data structure
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS                             10
      * KEY: Midas SD Securities trading ICD retrieval
      * I : RST Securities Trading
     I                                        1  10 P1SCTR
     IP2PARM      DS
      * O : MAP *Return code
     I                                        1   7 P2RTN
     IP3PARM      DS
      * B : MAP Work Return code
     I                                        1   5 P3WRTC
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'PSSR Error in program'
      * program name
     I                                        1   8 ZA0001
      * Message data for 'Database Error (ICD)'
      * Filename
     I                                        1  10 ZA0002
      * Message data for 'Matured Securities is req'
      * Matured Securities func
     I                                        1   2 ZA0003
      * Message data for 'Matured Sec. numeric'
      * Matured Securities func
     I                                        1   2 ZA0004
      * Message data for 'Matured Securities range'
      * Matured Securities func
     I                                        1   2 ZA0005
      * Message data for 'Settled Trades required'
      * Settled Trades func fld.
     I                                        1   2 ZA0006
      * Message data for 'Settled Trades numeric'
      * Settled Trades func fld.
     I                                        1   2 ZA0007
      * Message data for 'Settled less than Matured'
      * Settled Trades func fld.
     I                                        1   2 ZA0008
      * Message data for 'Settled Trades range'
      * Settled Trades func fld.
     I                                        1   2 ZA0009
      * Message data for 'Back Valuation is req.'
      * Back Valuation Func fld
     I                                        1   3 ZA0010
      * Message data for 'Back Valuation numeric'
      * Back Valuation Func fld
     I                                        1   3 ZA0011
      * Message data for 'Back Valuation range'
      * Back Valuation Func fld
     I                                        1   3 ZA0012
      * Message data for 'Diary Entries required'
      * Diary Entries Func Field
     I                                        1   2 ZA0013
      * Message data for 'Diary Entries numeric'
      * Diary Entries Func Field
     I                                        1   2 ZA0014
      * Message data for 'Diary Entries range'
      * Diary Entries Func Field
     I                                        1   2 ZA0015
      * Message data for 'Currency Code - Cedel req'
      * Currency Code
     I                                        1   3 ZA0016
      * Message data for 'Euclid is required'
      * Euclid
     I                                        1   1 ZA0017
      * Message data for 'Invalid Euclid'
      * Euclid
     I                                        1   1 ZA0018
      * Message data for 'Dealing Events required'
      * Dealing Events Interface
     I                                        1   1 ZA0019
      * Message data for 'Invalid dealing events'
      * Dealing Events Interface
     I                                        1   1 ZA0020
      * Message data for 'FI Collateral is required'
      * FI Collateral Interface
     I                                        1   1 ZA0021
      * Message data for 'Invalid FI Collateral'
      * FI Collateral Interface
     I                                        1   1 ZA0022
      * Message data for 'Default trade market req'
      * Deal Sub-type Code
     I                                        1   2 ZA0023
      * Message data for 'Deflt Trade Portfolio req'
      * Default Portfolio Subtype
     I                                        1   2 ZA0024
      * Message data for 'Default Book Transfer req'
      * Default Transfer Deal Sub
     I                                        1   2 ZA0025
      * Message data for 'Reprompt Default required'
      * Reprompt defaults
     I                                        1   1 ZA0026
      * Message data for 'Invalid Reprompt defaults'
      * Reprompt defaults
     I                                        1   1 ZA0027
      * Message data for 'Bulk Input Option req.'
      * Bulk Input Option
     I                                        1   1 ZA0028
      * Message data for 'Invalid Bulk Input Option'
      * Bulk Input Option
     I                                        1   1 ZA0029
      * Message data for 'Review Trades Dft Invalid'
      * Review Bulk Trades Dft
     I                                        1   1 ZA0030
      * Message data for 'Review Trades Dft Non-blk'
      * Review Bulk Trades Dft
     I                                        1   1 ZA0031
      * Message data for 'Default Agency Trade inv'
      * Default Agency Trade
     I                                        1   1 ZA0032
      * Message data for 'Dft Agency Trade Non-blnk'
      * Default Agency Trade
     I                                        1   1 ZA0033
      * Message data for 'Allow Trad P/F cust inval'
      * Allow Trades P/folio Clnt
     I                                        1   1 ZA0034
      * Message data for 'Allow Trad P/F Cust Non-b'
      * Allow Trades P/folio Clnt
     I                                        1   1 ZA0035
      * Message data for 'Enter Default Brokerage'
      * Default brokerage code
     I                                        1   2 ZA0036
      * Message data for 'Enter Agency Book'
      * Book Code
     I                                        1   2 ZA0037
      * Message data for 'Default brokerage entered'
      * Default brokerage code
     I                                        1   2 ZA0038
      * Message data for 'Book Code entered'
      * Book Code
     I                                        1   2 ZA0039
      * Message data for 'Dflt Broker not rng AA-99'
      * Default brokerage code
     I                                        1   2 ZA0040
      * Message data for 'Autocharges option req.'
      * Autocharge Option
     I                                        1   1 ZA0041
      * Message data for 'Invalid Autocharges optn'
      * Autocharge Option
     I                                        1   1 ZA0042
      * Message data for 'Profit Centre cde not val'
      * Pft Cntr For Safe Ctdy Fe
     I                                        1   4 ZA0043
      * Message data for 'SE Charges Currency inval'
      * SE charges currency
     I                                        1   3 ZA0044
      * Message data for 'Charges Currency Non-blnk'
      * SE charges currency
     I                                        1   3 ZA0045
      * Message data for 'Adj Cust Comm SD Trad inv'
      * Adjust Comm s/day trade
     I                                        1   1 ZA0046
      * Message data for 'Adj Cust Comm SDT Non-blk'
      * Adjust Comm s/day trade
     I                                        1   1 ZA0047
      * Message data for 'Extel Option is required'
      * Extel Option
     I                                        1   1 ZA0048
      * Message data for 'Extel Option Must be N'
      * Extel Option
     I                                        1   1 ZA0049
      * Message data for 'Invalid Extel Option'
      * Extel Option
     I                                        1   1 ZA0050
      * Message data for 'Trade Authorisation Inval'
      * Trade Authorisation Type
     I                                        1   2 ZA0051
      * Message data for 'Safe custdy must be entrd'
      * Safe Custody Fees Flag
     I                                        1   1 ZA0052
      * Message data for 'Invalid safe custody flag'
      * Safe Custody Fees Flag
     I                                        1   1 ZA0053
      * Message data for 'Safe custody must be 'N'.'
      * Safe Custody Fees Flag
     I                                        1   1 ZA0054
      * Message data for 'Telekurs Interface not N'
      * Telekurs Interface
     I                                        1   1 ZA0055
      * Message data for 'Telekurs Interface Invald'
      * Telekurs Interface
     I                                        1   1 ZA0056
      * Message data for 'Reallowance for Bank req'
      * Reallowance bank av/price
     I                                        1   1 ZA0057
      * Message data for 'Invalid Reallowance bank'
      * Reallowance bank av/price
     I                                        1   1 ZA0058
      * Message data for 'Reallowance customer req.'
      * Reallowance cust. av/prc
     I                                        1   1 ZA0059
      * Message data for 'Invalid Reallowance Cust'
      * Reallowance cust. av/prc
     I                                        1   1 ZA0060
      * Message data for 'Charges for bank required'
      * Charges in bank av/price
     I                                        1   1 ZA0061
      * Message data for 'Invalid Charges for bank'
      * Charges in bank av/price
     I                                        1   1 ZA0062
      * Message data for 'Charges for Customer req'
      * Charges in customer av/pr
     I                                        1   1 ZA0063
      * Message data for 'Invalid Charges for Cust'
      * Charges in customer av/pr
     I                                        1   1 ZA0064
      * Message data for 'Commission for Bank  req'
      * Commission in bank av/prc
     I                                        1   1 ZA0065
      * Message data for 'Invalid Commission Bank'
      * Commission in bank av/prc
     I                                        1   1 ZA0066
      * Message data for 'Commission for Cust. req'
      * Commission in cust. av/pr
     I                                        1   1 ZA0067
      * Message data for 'Invalid Commission Cust'
      * Commission in cust. av/pr
     I                                        1   1 ZA0068
      * Message data for 'Trade/Value Valuation req'
      * Trade/Value Date Valuatn
     I                                        1   1 ZA0069
      * Message data for 'Invalid Trade/Value Valut'
      * Trade/Value Date Valuatn
     I                                        1   1 ZA0070
      * Message data for 'Trade/Value Collateral'
      * Trade/Value Collateral
     I                                        1   1 ZA0071
      * Message data for 'Invalid Trade/Value Coll'
      * Trade/Value Collateral
     I                                        1   1 ZA0072
      * Message data for 'Market/Book Exposure req'
      * Market/Book Exposure
     I                                        1   1 ZA0073
      * Message data for 'Invalid Market/Book expos'
      * Market/Book Exposure
     I                                        1   1 ZA0074
      * Message data for 'Collateral CCy numeric'
      * collateral ccy conv. func
     I                                        1   3 ZA0075
      * Message data for 'Collateral CCY Conv range'
      * collateral ccy conv. func
     I                                        1   3 ZA0076
      * Message data for 'Foreign Exchange numeric'
      * Foreign Exchange Risk fun
     I                                        1   3 ZA0077
      * Message data for 'Foreign Exchange range'
      * Foreign Exchange Risk fun
     I                                        1   3 ZA0078
      * Message data for 'All Holdings numeric'
      * All Holdings Limit Func.
     I                                        1   3 ZA0079
      * Message data for 'All Holdings range'
      * All Holdings Limit Func.
     I                                        1   3 ZA0080
      * Message data for 'Discretionary Lmt numeric'
      * Discretionary Limit func
     I                                        1   3 ZA0081
      * Message data for 'Discretionary Lmt range'
      * Discretionary Limit func
     I                                        1   3 ZA0082
      * Message data for 'Customers Limit numeric'
      * Customers Limit Fact. fun
     I                                        1   3 ZA0083
      * Message data for 'Customers Limit range'
      * Customers Limit Fact. fun
     I                                        1   3 ZA0084
      * Message data for 'Realised Profit Basis req'
      * Realised Profit Basis
     I                                        1   1 ZA0085
      * Message data for 'Invalid Realised Profit'
      * Realised Profit Basis
     I                                        1   1 ZA0086
      * Message data for 'Unreal. Profit Basis Reqd'
      * Unrealised Profit Basis
     I                                        1   1 ZA0087
      * Message data for 'Invalid Unrealised profit'
      * Unrealised Profit Basis
     I                                        1   1 ZA0088
      * Message data for 'Unrealised Proft Post req'
      * Unrealised Profit Posting
     I                                        1   1 ZA0089
      * Message data for 'Invalid Unrealised Pr pos'
      * Unrealised Profit Posting
     I                                        1   1 ZA0090
      * Message data for 'Adjust Unrealised req'
      * Adjust Unrealise Profit
     I                                        1   1 ZA0091
      * Message data for 'Invalid Adjust Unrelise'
      * Adjust Unrealise Profit
     I                                        1   1 ZA0092
      * Message data for 'Summarise Daily Trade req'
      * Summarise Daily Trades
     I                                        1   1 ZA0093
      * Message data for 'Invalid Summarise Trade'
      * Summarise Daily Trades
     I                                        1   1 ZA0094
      * Message data for 'FIFO Accounting required'
      * FIFO Accounting
     I                                        1   1 ZA0095
      * Message data for 'invalid FIFO Accounting'
      * FIFO Accounting
     I                                        1   1 ZA0096
      * Message data for 'Split Purchased Int req'
      * Split Purchased Interest
     I                                        1   1 ZA0097
      * Message data for 'Invalid Split purchased'
      * Split Purchased Interest
     I                                        1   1 ZA0098
      * Message data for 'Split Negative required'
      * Split Negative Interest
     I                                        1   1 ZA0099
      * Message data for 'Invalid Split Negative'
      * Split Negative Interest
     I                                        1   1 ZA0100
      * Message data for 'Trade Subtypes required'
      * Trade Subtypes in A/c key
     I                                        1   1 ZA0101
      * Message data for 'invalid Trade subtypes'
      * Trade Subtypes in A/c key
     I                                        1   1 ZA0102
      * Message data for 'Convertible on A/C req'
      * Convertible Indicator A/k
     I                                        1   1 ZA0103
      * Message data for 'Invalid Convertible'
      * Convertible Indicator A/k
     I                                        1   1 ZA0104
      * Message data for 'Negative Position req'
      * Negative position on A/K
     I                                        1   1 ZA0105
      * Message data for 'Invalid Negative Position'
      * Negative position on A/K
     I                                        1   1 ZA0106
      * Message data for 'Generate D/P req.'
      * General Disc/Prem Keys
     I                                        1   1 ZA0107
      * Message data for 'Invalid Generate D/P .'
      * General Disc/Prem Keys
     I                                        1   1 ZA0108
      * Message data for 'Invalid Supress on T/V'
      * Suppress keys on Trade/vl
     I                                        1   1 ZA0109
      * Message data for 'Post no Std Depot req'
      * Post no Stnd Depot Mvmts
     I                                        1   1 ZA0110
      * Message data for 'Invalid Post no std depot'
      * Post no Stnd Depot Mvmts
     I                                        1   1 ZA0111
      * Message data for 'Redemptions on sec req'
      * Redemptions on Sec Desc.
     I                                        1   1 ZA0112
      * Message data for 'Invalid Redemptions'
      * Redemptions on Sec Desc.
     I                                        1   1 ZA0113
      * Message data for 'Cross Currency Ent req'
      * Cross Currency Entries
     I                                        1   1 ZA0114
      * Message data for 'Invalid Cross Currency'
      * Cross Currency Entries
     I                                        1   1 ZA0115
      * Message data for 'Autopost Position req'
      * Autopost Position Settle
     I                                        1   1 ZA0116
      * Message data for 'Invalid Autopost position'
      * Autopost Position Settle
     I                                        1   1 ZA0117
      * Message data for 'Base Date not required'
      * Mark to Market BD Func
     I                                        1   2 ZA0118
      * Message data for 'mark to mkt not allowed'
      * Mark to Market Next func
     I                                        1   6 ZA0119
      * Message data for 'Base Day must be numeric'
      * Mark to Market BD Func
     I                                        1   2 ZA0120
      * Message data for 'Base Day range'
      * Mark to Market BD Func
     I                                        1   2 ZA0121
      * Message data for 'Mark to Market is req.'
      * Mark to Market BD Func
     I                                        1   2 ZA0122
      * Message data for 'Not allowed for this Freq'
      * Mark to Market BD Func
     I                                        1   2 ZA0123
      * Message data for 'Invalid Next Date'
      * Mark to Market Next func
     I                                        1   6 ZA0124
      * Message data for 'Next Date not in the past'
      * Mark to Market Next func
     I                                        1   6 ZA0125
      * Message data for 'Next Date is required'
      * Mark to Market Next func
     I                                        1   6 ZA0126
      * Message data for 'Invalid Mark to Mket freq'
      * Mark to Market Frequency
     I                                        1   1 ZA0127
      * Message data for 'Invalid Trade Confirmatn'
      * Trading Confirmation Type
     I                                        1   1 ZA0128
      * Message data for 'Trade & Book Posn Rec.'
      * Trade & Book Posn Recble
     I                                        1   1 ZA0129
      * Message data for 'Dflt Broker not rng AA-99'
      * Default brokerage code
     I                                        1   2 ZA0130
      * Message data for 'Setlment Discrep'cy blank'
      * Setl Discrepancy Over Fun
     I                                        1  14 ZA0131
      * Message data for 'Setlment Discrep'cy blank'
      * Setl Discrepancy Over Fun
     I                                        1  14 ZA0132
      * Message data for 'Setl Disc'pcy not numeric'
      * Setl Discrepancy Over Fun
     I                                        1  14 ZA0133
      * Message data for 'Setl Disc'pcy not numeric'
      * Setl Discrepancy Over Fun
     I                                        1  14 ZA0134
      * Message data for 'Currency Code Required'
      * Currency Code
     I                                        1   3 ZA0135
      * Message data for 'Currency Code Required'
      * Currency Code
     I                                        1   3 ZA0136
      * Message data for 'Currency Code Required'
      * Currency Code
     I                                        1   3 ZA0137
      * Message data for 'Currency Code Required'
      * Currency Code
     I                                        1   3 ZA0138
      * Message data for 'Auto-transmission req.'
      * Auto-transmission interfc
     I                                        1   1 ZA0139
      * Message data for 'Invalid Auto-transmission'
      * Auto-transmission interfc
     I                                        1   1 ZA0140
      * Message data for 'Auto-transmission not req'
      * Auto-transmission interfc
     I                                        1   1 ZA0141
      * Message data for 'Depot Reference Mandatory'
      * Depot 1
     I                                        1  10 ZA0142
      * Message data for 'No value selected'
      * Our Receive Branch
     I                                        1   3 ZA0143
      * Message data for 'Invalid Customer no/sname'
      * Depot 1
     I                                        1  10 ZA0144
      * Message data for 'Cust is not a Sec Client'
      * Depot 1
     I                                        1  10 ZA0145
      * Message data for 'Cust not Classified'
      * Depot 1
     I                                        1  10 ZA0146
      * Message data for 'Depot Reference Mandatory'
      * Depot 1
     I                                        1  10 ZA0147
      * Message data for 'No value selected'
      * Our Receive Branch
     I                                        1   3 ZA0148
      * Message data for 'Invalid Customer no/sname'
      * Depot 1
     I                                        1  10 ZA0149
      * Message data for 'Cust is not a Sec Client'
      * Depot 1
     I                                        1  10 ZA0150
      * Message data for 'Cust not Classified'
      * Depot 1
     I                                        1  10 ZA0151
      **Message*data*for*'Depot*Reference*Mandatory'*******************   CSE022
      **Depot*1********************************************************   CSE022
     I**********                              1  10 ZA0152                CSE022
      * Message data for 'No value selected'
      * Our Receive Branch
     I                                        1   3 ZA0153
      * Message data for 'Invalid Customer no/sname'
      * Depot 1
     I                                        1  10 ZA0154
      * Message data for 'Cust is not a Sec Client'
      * Depot 1
     I                                        1  10 ZA0155
      * Message data for 'Cust not Classified'
      * Depot 1
     I                                        1  10 ZA0156
      * Message data for 'No value selected'
      * Our Receive Branch
     I                                        1   3 ZA0157
      * Message data for 'Invalid Customer no/sname'
      * Depot 1
     I                                        1  10 ZA0158
      * Message data for 'Cust is not a Sec Client'
      * Depot 1
     I                                        1  10 ZA0159
      * Message data for 'Cust not Classified'
      * Depot 1
     I                                        1  10 ZA0160
      * Message data for 'embedded blank entries'
      * Depot 1
     I                                        1  10 ZA0161
      * Message data for 'No value selected'
      * Our Receive Branch
     I                                        1   3 ZA0162
      * Message data for 'Invalid Customer no/sname'
      * Depot 1
     I                                        1  10 ZA0163
      * Message data for 'Cust is not a Sec Client'
      * Depot 1
     I                                        1  10 ZA0164
      * Message data for 'Cust not Classified'
      * Depot 1
     I                                        1  10 ZA0165
      * Message data for 'embedded blank entries'
      * Depot 1
     I                                        1  10 ZA0166
      * Message data for 'No value selected'
      * Our Receive Branch
     I                                        1   3 ZA0167
      * Message data for 'Invalid Customer no/sname'
      * Depot 1
     I                                        1  10 ZA0168
      * Message data for 'Cust is not a Sec Client'
      * Depot 1
     I                                        1  10 ZA0169
      * Message data for 'Cust not Classified'
      * Depot 1
     I                                        1  10 ZA0170
      * Message data for 'embedded blank entries'
      * Depot 1
     I                                        1  10 ZA0171
      * Message data for 'No value selected'
      * Our Receive Branch
     I                                        1   3 ZA0172
      * Message data for 'Invalid Customer no/sname'
      * Depot 1
     I                                        1  10 ZA0173
      * Message data for 'Cust is not a Sec Client'
      * Depot 1
     I                                        1  10 ZA0174
      * Message data for 'Cust not Classified'
      * Depot 1
     I                                        1  10 ZA0175
      * Message data for 'embedded blank entries'
      * Depot 1
     I                                        1  10 ZA0176
      * Message data for 'No value selected'
      * Our Receive Branch
     I                                        1   3 ZA0177
      * Message data for 'Invalid Customer no/sname'
      * Depot 1
     I                                        1  10 ZA0178
      * Message data for 'Cust is not a Sec Client'
      * Depot 1
     I                                        1  10 ZA0179
      * Message data for 'Cust not Classified'
      * Depot 1
     I                                        1  10 ZA0180
      * Message data for 'embedded blank entries'
      * Depot 1
     I                                        1  10 ZA0181
      * Message data for 'No value selected'
      * Our Receive Branch
     I                                        1   3 ZA0182
      * Message data for 'Invalid Customer no/sname'
      * Depot 1
     I                                        1  10 ZA0183
      * Message data for 'Cust is not a Sec Client'
      * Depot 1
     I                                        1  10 ZA0184
      * Message data for 'Cust not Classified'
      * Depot 1
     I                                        1  10 ZA0185
      * Message data for 'embedded blank entries'
      * Depot 1
     I                                        1  10 ZA0186
      * Message data for 'No value selected'
      * Our Receive Branch
     I                                        1   3 ZA0187
      * Message data for 'Invalid Customer no/sname'
      * Depot 1
     I                                        1  10 ZA0188
      * Message data for 'Cust is not a Sec Client'
      * Depot 1
     I                                        1  10 ZA0189
      * Message data for 'Cust not Classified'
      * Depot 1
     I                                        1  10 ZA0190
      * Message data for 'depot must be unique'
      * Depot 1
     I                                        1  10 ZA0191
      * Message data for 'depot must be unique'
      * Depot 1
     I                                        1  10 ZA0192
      * Message data for 'depot must be unique'
      * Depot 1
     I                                        1  10 ZA0193
      * Message data for 'depot must be unique'
      * Depot 1
     I                                        1  10 ZA0194
      * Message data for 'depot must be unique'
      * Depot 1
     I                                        1  10 ZA0195
      * Message data for 'depot must be unique'
      * Depot 1
     I                                        1  10 ZA0196
      * Message data for 'depot must be unique'
      * Depot 1
     I                                        1  10 ZA0197
      * Message data for 'depot must be unique'
      * Depot 1
     I                                        1  10 ZA0198
      * Message data for 'depot must be unique'
      * Depot 1
     I                                        1  10 ZA0199
      * Message data for 'Priority Ind must be 1-5'
      * Priority of Branch Dft
     I                                        1   1 ZA0200
      * Message data for 'Priority Ind must be 1-5'
      * Priority of Branch Dft
     I                                        1   1 ZA0201
      * Message data for 'Priority Ind must be 1-5'
      * Priority of Branch Dft
     I                                        1   1 ZA0202
      * Message data for 'Priority Ind must be 1-5'
      * Priority of Branch Dft
     I                                        1   1 ZA0203
      * Message data for 'Priority Ind must be 1-5'
      * Priority of Branch Dft
     I                                        1   1 ZA0204
      * Message data for 'Priority Code Arrang Invd'
      * Priority of Branch Dft
     I                                        1   1 ZA0205
      * Priority of Cust Chrg Dft
     I                                        2   2 ZA0206
      * Priority of Cust Grp Dft
     I                                        3   3 ZA0207
      * Priority of Invst typ Dft
     I                                        4   4 ZA0208
      * Priority of Market Dft
     I                                        5   5 ZA0209
      * Message data for 'Priority Ind Chrg Dft Inv'
      * Priority of Branch Dft
     I                                        1   1 ZA0210
      * Message data for 'Ret of posn must be numbr'
      * Ret of Posn Settle SCR
     I                                        1   2 ZA0211
      * Message data for 'Ret of posn range 0 - 99'
      * Ret of Posn Settle SCR
     I                                        1   2 ZA0212
      * Message data for 'Early Red cust not S or D'
      * Early Redemption Dum. Cus
     I                                        1   6 ZA0213
      * Message data for 'Early Red cust not S or D'
      * Early Redemption Dum. Cus
     I                                        1   6 ZA0214
      * Message data for 'Trade no. range numeric'
      * Trade Number Range SCR
     I                                        1   2 ZA0215
      * Message data for 'Trade No. Range invalid'
      * Trade Number Range SCR
     I                                        1   2 ZA0216
      * Message data for 'Trade numb range missing'
      * Trade Number Range SCR
     I                                        1   2 ZA0217
      * Message data for 'Corp Actn Trade Cust man'                       CSE007
      * Corporate Action Trade Customer                                   CSE007
     I                                        1   6 ZA0218                CSE007
      * Message data for 'Corp Actn Trade Cust inv'                       CSE007
      * Corporate Action Trade Customer                                   CSE007
     I                                        1   6 ZA0219                CSE007
      * Message data for 'Corp Actn Trade Cust not a trad cust'           CSE007
      * Corporate Action Trade Cuatomer                                   CSE007
     I                                        1   6 ZA0220                CSE007
      * Message data for 'Corp Actn Trade Cust M, S or D class'           CSE007
      * Corporate Action Trade Customer                                   CSE007
     I                                        1   6 ZA0221                CSE007
      * Message data for 'Trade Sbtyp in Corp A/c key is 'Y' or 'N'       CSE007
      * Trade Subtypes in Corporate A/c Key                               CSE007
     I                                        1   1 ZA0222                CSE007
      * Message data for 'Trade no. range numeric'                        CSE007
      * Trade Number Range SCR                                            CSE007
     I                                        1   2 ZA0223                CSE007
      * Message data for 'Trade No. Range invalid'                        CSE007
      * Trade Number Range SCR                                            CSE007
     I                                        1   2 ZA0224                CSE007
      * Message data for 'Trade numb range missing'                       CSE007
      * Trade Number Range SCR                                            CSE007
     I                                        1   2 ZA0225                CSE007
      * Message data for 'Allocate Diff must be 'Y' or 'N''               137886
      * Allocate Difference to Dummy Customer                             137886
     I                                        1   2 ZA0226                137886
      * Message data for 'Invalid lower % for Cash Value Tolerance'       CSE006
      * Lower % Cash Value Tolerance                                      CSE006
     I                                        1   2 ZA0227                CSE006
      * Message data for 'Invalid upper % for Cash Value Tolerance'       CSE006
      * Upper % Cash Value Tolerance                                      CSE006
     I                                        1   2 ZA0228                CSE006
      * Message data for 'Invalid 'Repos-maturing securities' ind.'       CSE006
      * Maturing Securities                                               CSE006
     I                                        1   2 ZA0229                CSE006
      * Message data for 'Invalid 'Repos-coupon payments' ind.'           CSE006
      * Coupon Due                                                        CSE006
     I                                        1   2 ZA0230                CSE006
      *                                                                   CSE022
      ** Message data for 'embedded blank entries'                        CSE022
      ** Depot 4                                                          CSE022
      *                                                                   CSE022
     I                                        1  10 ZA0231                CSE022
      **********                                                                       CAS006 224354
      ***Message*data*for*'Historic*Price*required'*******************                 CAS006 224354
      **********                                                                       CAS006 224354
     I**********                              1   4 ZA0232                             CAS006 224354
      *                                                                   CSE007
      **  Customer Details                                                CSE007
     ISDCUST    E DSSDCUSTPD                                              CSE007
      *                                                                   CSE007
      **  Securities Trading Customer                                     CSE007
     ISDSECS    E DSSDSECSPD                                              CSE007
      *                                                                   CSE007
      ** DS for Access Programs, Long Data Structure                      CSE007
     IDSSDY     E DSDSSDY                                                 CSE007
      *                                                                   CSE007
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C                     PARM           P1PARM           KEY: Securities
     C           P2RTN     PARM P2RTN     WP0001  7        *Return code
     C           P3WRTC    PARM P3WRTC    WP0002  5        Work Return cod
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Display and process key screen
     C                     EXSR BADSKY
      * Terminate program
     C                     EXSR ZXEXPG
      *****************************************************************
      /EJECT
     CSR         BADSKY    BEGSR
      *================================================================
      * Display and process key screen
      *================================================================
      * Initialize key screen
     C                     EXSR MDIZ#K
      * Bypass first display of key screen is possible
     C                     MOVEL'Y'       W0BYP   1
      * Signal start of transaction
     C                     MOVEL'Y'       W0TRN   1
      *
     C           W0TRN     DOWEQ'Y'
     C           W0TRN     OREQ 'K'
      * Ensure transaction continues (if reset)
     C                     MOVEL'Y'       W0TRN   1
      * Set control to display first screen
     C                     Z-ADD1         W0SCR   30
      * Conduct screen conversation
     C           W0TRN     DOWEQ'Y'
      * Is bypass key screen still viable?
     C           W0BYP     IFEQ 'Y'
     C           #1SCTR    IFEQ *BLANK                     Securities Trad
      * One or more key fields is blank
     C           *IN05     OREQ '1'
      * HOME: Reset screen fields
     C                     MOVEL'N'       W0BYP
     C                     END
     C                     END
      * Bypass key screen
     C           W0BYP     IFNE 'Y'
      * Display key screen
     C                     EXSR BBEXFM
     C                     END
      * Cancel key screen bypass
     C                     MOVEL'N'       W0BYP
      * Process response to key screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   05                CAS            BDHMKY
      * Process key screen input
     C                     CAS            BEPRKY
     C                     END
     C           W0TRN     DOWEQ'R'
     C                     MOVEL'Y'       W0TRN
     C                     EXSR BEPRKY
     C                     END
      *
     C                     END
     C                     END
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBEXFM    BEGSR
      *================================================================
      * Display key screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSAK
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE HELP25    *IN25
      * PUTOVR unless conditioned fields change
     C                     SETON                         86*
     C           *IN89     IFNE BBIN89
     C                     SETOF                         86*
     C                     END
     C                     MOVE *IN89     BBIN89  1
      * Update screen time
     C                     TIME           ##TME
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDKEY
      * Test cursor
     C                     EXSR Y8TST
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         BDHMKY    BEGSR
      *================================================================
      * Process HOME key
      *================================================================
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         BDEXIT    ENDSR
      /EJECT
     CSR         BEPRKY    BEGSR
      *================================================================
      * Process key screen input
      *================================================================
      * Initialise detail screen
     C                     EXSR MAIZ#1
      * Validate key fields
     C                     EXSR BFVLKY
     C           *IN99     CABEQ'1'       BEEXIT
      * Check for existing record
     C           KRTV      KLIST
     C                     KFLD           BVSCTR           Securities Trad
      * Setup key
     C                     MOVEL#1SCTR    BVSCTR           Securities Trad
     C           KRTV      CHAIN@BVREFF              9091  *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     SETON                     99    *
     C                     GOTO BEEXIT
     C                     END                             FI 91
      *
      * If record does not exist, error
     C           *IN90     IFEQ '1'
     C                     SETON                     99    *
      * Send message 'Securities Trading Dat NF'
     C                     MOVEL'USR0239' ZAMSID
     C                     EXSR ZASNMS
     C                     ELSE
     C                     EXSR MBFL#1
      * CALC: Detail screen function fields
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy member SD9211RSFF - Securities Trading Data  * S01212
     C*
     C/COPY WNCPYSRC,SD9211RSFF
     C*
     C                     END                             *FI
      * USER: Initialize detail screen (existing record)
      * Init Fields for Sec. Trad - Securities Trading Data  *
     C                     CLEARPARC
     C                     Z-ADDBVMMBD    PAMMBD           Mark to Market
     C                     Z-ADDBVMMND    PAMMND           Mark to Market
     C                     Z-ADDBVBVP     PABVP            Back value peri
     C                     Z-ADDBVROST    PAROST           Retention of se
     C                     Z-ADDBVRODY    PARODY           Retention of di
     C                     Z-ADDBVROMS    PAROMS           Retention of ma
     C                     MOVELBVATI     PAATI            Auto-transmissi
     C                     Z-ADDBVCCYC    PACCYC           Collateral Curr
     C                     Z-ADDBVFERK    PAFERK           Foreign Exchang
     C                     Z-ADDBVAHLF    PAAHLF           All Holdings Li
     C                     Z-ADDBVDLF     PADLF            Discretionary L
     C                     Z-ADDBVCLF     PACLF            Customers Limit
      **********                                                                       CAS006 224354
      ***Move*BVBHPP(Historic*Price)*to*corresponding*field*in*PARC*DS*                CAS006 224354
      **********                                                                       CAS006 224354
     C********** CAS006    IFEQ 'Y'                                                    CAS006 224354
     C**********           Z-ADDBVBHPP    PABHPP                                       CAS006 224354
     C**********           ENDIF                                                       CAS006 224354
      *
     C                     CALL 'SD9211X'              90  Init Fields for
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Securities
     C           WUFFMP    PARM *BLANK    WQ0001  6        Func Fld Mat. P
     C           WUFFST    PARM *BLANK    WQ0002  6        Func Fld Settle
     C           WUFFBV    PARM *BLANK    WQ0003  6        Func Fld Back V
     C           WUFFDE    PARM *BLANK    WQ0004  6        Func Fld Diary
     C           WUFFAT    PARM *BLANK    WQ0005  6        Func Fld Auto T
     C           WUFFCC    PARM *BLANK    WQ0006  6        Func Fld Coll C
     C           WUFFFR    PARM *BLANK    WQ0007  6        Func Fld FX Ris
     C           WUFFAH    PARM *BLANK    WQ0008  6        Func Fld All Ho
     C           WUFFLF    PARM *BLANK    WQ0009  6        Func Fld Disc.
     C           WUFFCL    PARM *BLANK    WQ0010  6        Func Fld Cust L
     C           WUFFBD    PARM *BLANK    WQ0011  6        Func Fld M to M
     C           WUFFND    PARM *BLANK    WQ0012  6        Func Fld M to M
      **********                                                                       CAS006 224354
      ***Historic*Price*Retention*Period*******************************                CAS006 224354
      **********                                                                       CAS006 224354
     C********** WUBHPP    PARM *BLANK    WQ0319  4                                    CAS006 224354
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD9211X' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Start of S01459
      * Check return code PSSR
      * CASE: PGM.*Return code is PSSR error
     C           W0RTN     IFEQ 'PSSR'                     *IF
      * Setup message data for message
     C                     MOVEL'SD9211X' ZA0001           program name
      * Send message 'PSSR Error in program'
     C                     MOVEL'USR2207' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
      * End of S01459
      * Move right Screen fields - Securities Trading Data  *
     C*
     C*
     C                     MOVE WUFFMP    #DMSCF
     C                     MOVE WUFFST    #DSTFF
     C                     MOVE WUFFBV    #DBVFF
     C                     MOVE WUFFDE    #DDEFF
     C                     MOVE WUFFCC    #DCCCF
     C                     MOVE WUFFAT    #DATMF
     C*
      * Move screen fields right - Securities Trading Data  *
     C*
     C*
     C                     MOVE WUFFFR    #DFERF
     C                     MOVE WUFFAH    #DAHLM
     C                     MOVE WUFFLF    #DDLFF
     C                     MOVE WUFFCL    #DCLFF
     C                     MOVE WUFFBD    #DMBFF
     C                     MOVE WUFFND    #DMNXF
      **********                                                                       CAS006 224354
      ***Move*Historic*Price*to*Screen*Field***************************                CAS006 224354
      **********                                                                       CAS006 224354
     C********** CAS006    IFEQ 'Y'                                                    CAS006 224354
     C**********           MOVE WUBHPP    #DBHPP                                       CAS006 224354
     C**********           ENDIF                                                       CAS006 224354
     C*
      * Settlement Discrepancy Over is zero.
      * CASE: DB1.Settlement Descrepancy Ov is zero
     C           BVSDOV    IFEQ *ZERO                      *IF
     C                     MOVEL*BLANK    #DSDOF           Setl Discrepanc
     C                     MOVEL'*ZERO'   #DSDOF           Setl Discrepanc
     C                     END                             *FI
      * Settlement Discrepancy Under is zero.
      * CASE: DB1.Settlement Descrepancy Un is zero
     C           BVSDUN    IFEQ *ZERO                      *IF
     C                     MOVEL*BLANK    #DSDUF           Setl Discrepanc
     C                     MOVEL'*ZERO'   #DSDUF           Setl Discrepanc
     C                     END                             *FI
      * Start of 050715
      * Start of change 099343
      * Initialise mark to market date
      * CASE: DB1.Mark to Market Next Date is not zero
     C           BVMMND    IFNE *ZERO                      *IF
     C                     Z-ADDBVMMND    WUWMDT           Work Midas Date
      * Check File Date - Rundate  *
     C                     CALL 'ZDATE2'               90  Check File Date
     C                     PARM WUWMDT    WQ0013  50       Work Midas Date
     C                     PARM WUDFF     WQ0014  1        Date format fla
     C           WUWCDT    PARM *ZERO     WQ0015  60       Work Converted
     C           WUWADT    PARM *BLANK    WQ0016  7        Work Alpha Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZDATE2'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     MOVEL*BLANK    #DMNXF           Mark to Market
     C                     MOVELWUWCDT    #DMNXF           Mark to Market
     C                     END                             *FI
      * End of change 099343
      * End of 050715
      * Set up shortnames - Securities Trading Data  *
     C                     CLEARPBRC
     C                     MOVELBVDR1     PBDR1            Depot 1 (EUROCL
     C                     MOVELBVDR3     PBDR3            Depot Ref 3, Ka
     C                     MOVELBVDR2     PBDR2            Depot Reference
     C                     MOVELBVDR4     PBDR4            Depot Reference
     C                     MOVELBVDR5     PBDR5            Depot Reference
      *
     C                     CALL 'SD9212X'              90  Set up shortnam
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Securities
     C           #DDP01    PARM *BLANK    WQ0017 10        Depot 1
     C           #DDP02    PARM *BLANK    WQ0018 10        Depot 2
     C           #DDP03    PARM *BLANK    WQ0019 10        Depot 3
     C           #DDP04    PARM *BLANK    WQ0020 10        Depot 4
     C           #DDP05    PARM *BLANK    WQ0021 10        Depot 5
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD9212X' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set Up Shortnames 2 - Securities Trading Data  *
     C                     CLEARPCRC
     C                     MOVELBVDR10    PCDR10           Depot Reference
     C                     MOVELBVDR6     PCDR6            Depot Reference
     C                     MOVELBVDR7     PCDR7            Depot Reference
     C                     MOVELBVDR8     PCDR8            Depot Reference
     C                     MOVELBVDR9     PCDR9            Depot Reference
      *
     C                     CALL 'SD9213X'              90  Set Up Shortnam
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             RCD: Securities
     C           #DDP06    PARM *BLANK    WQ0022 10        Depot 6
     C           #DDP07    PARM *BLANK    WQ0023 10        Depot 7
     C           #DDP08    PARM *BLANK    WQ0024 10        Depot 8
     C           #DDP09    PARM *BLANK    WQ0025 10        Depot 9
     C           #DDP10    PARM *BLANK    WQ0026 10        Depot 10
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD9213X' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL*BLANK    W0RTN            *Return code
      * Start of fix E19793
      * Get Base Currency - Bank Details  *
     C                     EXSR SARVGN
      * Get Base Curr Details 2 - Currency Codes  *
     C                     EXSR SBRVGN
     C                     Z-ADDWUNBDP    WUZAND           ZALIGN No Of De
     C                     Z-ADDBVSDOV    WUZSNI           ZSEDIT Numeric
      * ZSEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZSEDIT'               90  ZSEDIT Screen F
     C                     PARM WUZSNI    WQ0027 150       ZSEDIT Numeric
     C                     PARM WUZAND    WQ0028  10       ZALIGN No Of De
     C                     PARM 'L'       WQ0029  1        ZSEDIT Edit Cod
     C           WUZSCO    PARM *BLANK    WQ0030 21        ZSEDIT Char Out
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZSEDIT'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Move ZS output to screen - Securities Trading Data  *
     C*
     C* Move ZSEDIT field into appropriate screen field
     C*
     C           1         IFEQ 1
     C                     MOVE WUZSCO    #DSDOF
     C                     ELSE
     C                     MOVE WUZSCO    #DSDUF
     C                     END
     C                     Z-ADDBVSDUN    WUZSNI           ZSEDIT Numeric
      * ZSEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZSEDIT'               90  ZSEDIT Screen F
     C                     PARM WUZSNI    WQ0031 150       ZSEDIT Numeric
     C                     PARM WUZAND    WQ0032  10       ZALIGN No Of De
     C                     PARM 'L'       WQ0033  1        ZSEDIT Edit Cod
     C           WUZSCO    PARM *BLANK    WQ0034 21        ZSEDIT Char Out
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZSEDIT'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Move ZS output to screen - Securities Trading Data  *
     C*
     C* Move ZSEDIT field into appropriate screen field
     C*
     C           2         IFEQ 1
     C                     MOVE WUZSCO    #DSDOF
     C                     ELSE
     C                     MOVE WUZSCO    #DSDUF
     C                     END
      * End of fix E19793
      * Start of S01496
      * Retention of Position Settlements
      * CASE: DB1.Retention of Posn Settl. is Zero
     C           BVROPS    IFEQ *ZERO                      *IF
     C                     MOVEL*BLANK    #DRPSS           Ret of Posn Set
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVELBVROPS    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0035  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0036 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0037  10       ZALIGN No Of De
     C                     PARM 2         WQ0038  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0039 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUERCD           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUERCD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0040 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0041  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * Zalign Ret of posn settle - Securities Trading Data  *
     C*
     C                     MOVE WUZASF    #DRPSS
     C*
     C                     END                             *FI
      * Trade number range
      * CASE: DB1.Trade Number Range is Zero
     C           BVTRNR    IFEQ *ZERO                      *IF
     C                     MOVEL*BLANK    #DTNRS           Trade Number Ra
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVELBVTRNR    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0042  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0043 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0044  10       ZALIGN No Of De
     C                     PARM 2         WQ0045  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0046 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUERCD           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUERCD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0047 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0048  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * Zalign Trade no. range - Securities Trading Data  *
     C*
     C                     MOVE WUZASF    #DTNRS
     C*
     C                     END                             *FI
      * End of S01496
      *                                                                   CSE007
      ** If SAR CSE007 is ON, display fields, 'Corporate Action Trade     CSE007
      ** Customer' and 'Trade Subtypes in Corporate A/C Key'.             CSE007
      *                                                                   CSE007
     C           WUCOAC    IFEQ 'Y'                                       CSE007
     C           WUEURO    OREQ 'Y'                                       CEU017
      *                                                                   CSE007
      ** Corporate Action Trade Customer                                  CSE007
      *                                                                   CSE007
     C                     MOVE BVCOTC    #1COTC                          CSE007
      *                                                                   CSE007
      ** Trade Subtypes in Corporate A/C key.                             CSE007
      *                                                                   CSE007
     C           BVCOTA    IFEQ *BLANKS                                   CSE007
     C                     MOVE 'N'       #1COTA                          CSE007
     C                     ELSE                                           CSE007
     C                     MOVE BVCOTA    #1COTA                          CSE007
     C                     ENDIF                                          CSE007
      *                                                                   CSE007
      * Trade number range                                                CSE007
      * CASE: DB1.Trade Number Range is Zero                              CSE007
     C           BVCTNR    IFEQ *ZERO                      *IF            CSE007
     C                     MOVEL*BLANK    #1CTNR           Trade Number RaCSE007
     C                     ELSE                                           CSE007
      * CASE: *OTHERWISE                                                  CSE007
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen FCSE007
     C                     MOVELBVCTNR    WUZASF           ZALIGN Screen FCSE007
      * Call ZALIGN & ZEDIT                                               CSE007
      * ZALIGN Screen Field - Standard Functions  *                       CSE007
     C                     CALL 'ZALIGN'               90  ZALIGN Screen FCSE007
     C           W0RTN     PARM W0RTN     WQ0042  7        *Return code   CSE007
     C           WUZASF    PARM WUZASF    WQ0043 16        ZALIGN Screen FCSE007
     C                     PARM *ZERO     WQ0044  10       ZALIGN No Of DeCSE007
     C                     PARM 2         WQ0045  20       ZALIGN No Of DiCSE007
     C           WUZAFF    PARM *BLANK    WQ0046 16        ZALIGN File FieCSE007
      *                                                                   CSE007
     C           *IN90     IFEQ '1'                                       CSE007
      * Call to program ended in error                                    CSE007
     C                     MOVEL'Y2U0032' W0RTN                           CSE007
     C                     MOVEL*BLANKS   W0CLPG 10                       CSE007
     C                     MOVEL'ZALIGN'  W0CLPG                          CSE007
      * Send message '*Error occured on CALL...'                          CSE007
     C                     MOVEL'Y2U0032' ZAMSID                          CSE007
     C                     MOVEL'Y2USRMSG'ZAMSGF                          CSE007
     C                     MOVELW0CLPG    ZAMSDA           Message data   CSE007
     C                     EXSR ZASNMS                                    CSE007
     C                     END                                            CSE007
      *                                                                   CSE007
      * Error detected?                                                   CSE007
     C           W0RTN     IFNE *BLANK                                    CSE007
     C                     SETON                     99    *              CSE007
     C                     END                                            CSE007
      * CASE: PGM.*Return code is Old Table Error                         CSE007
     C           W0RTN     IFEQ '*ERROR*'                  *IF            CSE007
     C                     MOVEL'Y'       WUERCD           Err Code       CSE007
     C                     ELSE                                           CSE007
      * CASE: *OTHERWISE                                                  CSE007
     C                     MOVEL'N'       WUERCD           Err Code       CSE007
      * ZEDIT Screen Field - Standard Functions  *                        CSE007
     C                     CALL 'ZEDIT'                90  ZEDIT Screen FiCSE007
     C           WUZASF    PARM WUZASF    WQ0047 16        ZALIGN Screen FCSE007
     C                     PARM *ZERO     WQ0048  10       ZALIGN No Of DeCSE007
      *                                                                   CSE007
     C           *IN90     IFEQ '1'                                       CSE007
      * Call to program ended in error                                    CSE007
     C                     MOVEL'Y2U0032' W0RTN                           CSE007
     C                     MOVEL*BLANKS   W0CLPG 10                       CSE007
     C                     MOVEL'ZEDIT'   W0CLPG                          CSE007
      * Send message '*Error occured on CALL...'                          CSE007
     C                     MOVEL'Y2U0032' ZAMSID                          CSE007
     C                     MOVEL'Y2USRMSG'ZAMSGF                          CSE007
     C                     MOVELW0CLPG    ZAMSDA           Message data   CSE007
     C                     EXSR ZASNMS                                    CSE007
     C                     END                                            CSE007
      *                                                                   CSE007
     C                     END                             *FI            CSE007
      * Zalign Trade no. range - Securities Trading Data  *               CSE007
     C*                                                                   CSE007
     C                     MOVE WUZASF    #1CTNR                          CSE007
     C*                                                                   CSE007
     C                     END                             *FI            CSE007
      *                                                                                       217119
      ** Allocate Difference to Dummy Customer                                                217119
      *                                                                                       217119
     C           BVALDC    IFEQ *BLANKS                                                       217119
     C                     MOVE 'N'       #1ALDC                                              217119
     C                     ELSE                                                               217119
     C                     MOVE BVALDC    #1ALDC                                              217119
     C                     ENDIF                                                              217119
      *                                                                                       217119
     C                     ENDIF                                                              217119
      *                                                                   137886
      * Repo cash tolerance upper percentage                              CSE006
      * CASE: DB1.upper tolerance is Zero                                 CSE006
     C           BVRCTU    IFEQ *ZERO                      *IF            CSE006
     C                     MOVEL*BLANK    #DRCTU           Upper percentagCSE006
     C                     ELSE                                           CSE006
      * CASE: *OTHERWISE                                                  CSE006
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen FCSE006
     C                     MOVELBVRCTU    WUZASF           ZALIGN Screen FCSE006
      * Call ZALIGN & ZEDIT                                               CSE006
      * ZALIGN Screen Field - Standard Functions  *                       CSE006
     C                     CALL 'ZALIGN'               90  ZALIGN Screen FCSE006
     C           W0RTN     PARM W0RTN     WQ0042  7        *Return code   CSE006
     C           WUZASF    PARM WUZASF    WQ0043 16        ZALIGN Screen FCSE006
     C                     PARM *ZERO     WQ0044  10       ZALIGN No Of DeCSE006
     C                     PARM 2         WQ0045  20       ZALIGN No Of DiCSE006
     C           WUZAFF    PARM *BLANK    WQ0046 16        ZALIGN File FieCSE006
      *                                                                   CSE006
     C           *IN90     IFEQ '1'                                       CSE006
      * Call to program ended in error                                    CSE006
     C                     MOVEL'Y2U0032' W0RTN                           CSE006
     C                     MOVEL*BLANKS   W0CLPG 10                       CSE006
     C                     MOVEL'ZALIGN'  W0CLPG                          CSE006
      * Send message '*Error occured on CALL...'                          CSE006
     C                     MOVEL'Y2U0032' ZAMSID                          CSE006
     C                     MOVEL'Y2USRMSG'ZAMSGF                          CSE006
     C                     MOVELW0CLPG    ZAMSDA           Message data   CSE006
     C                     EXSR ZASNMS                                    CSE006
     C                     END                                            CSE006
      *                                                                   CSE006
      * Error detected?                                                   CSE006
     C           W0RTN     IFNE *BLANK                                    CSE006
     C                     SETON                     99    *              CSE006
     C                     END                                            CSE006
      * CASE: PGM.*Return code is Old Table Error                         CSE006
     C           W0RTN     IFEQ '*ERROR*'                  *IF            CSE006
     C                     MOVEL'Y'       WUERCD           Err Code       CSE006
     C                     ELSE                                           CSE006
      * CASE: *OTHERWISE                                                  CSE006
     C                     MOVEL'N'       WUERCD           Err Code       CSE006
      * ZEDIT Screen Field - Standard Functions  *                        CSE006
     C                     CALL 'ZEDIT'                90  ZEDIT Screen FiCSE006
     C           WUZASF    PARM WUZASF    WQ0047 16        ZALIGN Screen FCSE006
     C                     PARM *ZERO     WQ0048  10       ZALIGN No Of DeCSE006
      *                                                                   CSE006
     C           *IN90     IFEQ '1'                                       CSE006
      * Call to program ended in error                                    CSE006
     C                     MOVEL'Y2U0032' W0RTN                           CSE006
     C                     MOVEL*BLANKS   W0CLPG 10                       CSE006
     C                     MOVEL'ZEDIT'   W0CLPG                          CSE006
      * Send message '*Error occured on CALL...'                          CSE006
     C                     MOVEL'Y2U0032' ZAMSID                          CSE006
     C                     MOVEL'Y2USRMSG'ZAMSGF                          CSE006
     C                     MOVELW0CLPG    ZAMSDA           Message data   CSE006
     C                     EXSR ZASNMS                                    CSE006
     C                     END                                            CSE006
      *                                                                   CSE006
     C                     END                             *FI            CSE006
      * Zalign Upper range                                *               CSE006
     C*                                                                   CSE006
     C                     MOVE WUZASF    #DRCTU                          CSE006
     C*                                                                   CSE006
     C                     END                             *FI            CSE006
     C*                                                                   CSE006
      * Repo cash tolerance lower percentage                              CSE006
      * CASE: DB1.upper tolerance is Zero                                 CSE006
     C           BVRCTL    IFEQ *ZERO                      *IF            CSE006
     C                     MOVEL*BLANK    #DRCTL           Upper percentagCSE006
     C                     ELSE                                           CSE006
      * CASE: *OTHERWISE                                                  CSE006
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen FCSE006
     C                     MOVELBVRCTL    WUZASF           ZALIGN Screen FCSE006
      * Call ZALIGN & ZEDIT                                               CSE006
      * ZALIGN Screen Field - Standard Functions  *                       CSE006
     C                     CALL 'ZALIGN'               90  ZALIGN Screen FCSE006
     C           W0RTN     PARM W0RTN     WQ0042  7        *Return code   CSE006
     C           WUZASF    PARM WUZASF    WQ0043 16        ZALIGN Screen FCSE006
     C                     PARM *ZERO     WQ0044  10       ZALIGN No Of DeCSE006
     C                     PARM 2         WQ0045  20       ZALIGN No Of DiCSE006
     C           WUZAFF    PARM *BLANK    WQ0046 16        ZALIGN File FieCSE006
      *                                                                   CSE006
     C           *IN90     IFEQ '1'                                       CSE006
      * Call to program ended in error                                    CSE006
     C                     MOVEL'Y2U0032' W0RTN                           CSE006
     C                     MOVEL*BLANKS   W0CLPG 10                       CSE006
     C                     MOVEL'ZALIGN'  W0CLPG                          CSE006
      * Send message '*Error occured on CALL...'                          CSE006
     C                     MOVEL'Y2U0032' ZAMSID                          CSE006
     C                     MOVEL'Y2USRMSG'ZAMSGF                          CSE006
     C                     MOVELW0CLPG    ZAMSDA           Message data   CSE006
     C                     EXSR ZASNMS                                    CSE006
     C                     END                                            CSE006
      *                                                                   CSE006
      * Error detected?                                                   CSE006
     C           W0RTN     IFNE *BLANK                                    CSE006
     C                     SETON                     99    *              CSE006
     C                     END                                            CSE006
      * CASE: PGM.*Return code is Old Table Error                         CSE006
     C           W0RTN     IFEQ '*ERROR*'                  *IF            CSE006
     C                     MOVEL'Y'       WUERCD           Err Code       CSE006
     C                     ELSE                                           CSE006
      * CASE: *OTHERWISE                                                  CSE006
     C                     MOVEL'N'       WUERCD           Err Code       CSE006
      * ZEDIT Screen Field - Standard Functions  *                        CSE006
     C                     CALL 'ZEDIT'                90  ZEDIT Screen FiCSE006
     C           WUZASF    PARM WUZASF    WQ0047 16        ZALIGN Screen FCSE006
     C                     PARM *ZERO     WQ0048  10       ZALIGN No Of DeCSE006
      *                                                                   CSE006
     C           *IN90     IFEQ '1'                                       CSE006
      * Call to program ended in error                                    CSE006
     C                     MOVEL'Y2U0032' W0RTN                           CSE006
     C                     MOVEL*BLANKS   W0CLPG 10                       CSE006
     C                     MOVEL'ZEDIT'   W0CLPG                          CSE006
      * Send message '*Error occured on CALL...'                          CSE006
     C                     MOVEL'Y2U0032' ZAMSID                          CSE006
     C                     MOVEL'Y2USRMSG'ZAMSGF                          CSE006
     C                     MOVELW0CLPG    ZAMSDA           Message data   CSE006
     C                     EXSR ZASNMS                                    CSE006
     C                     END                                            CSE006
      *                                                                   CSE006
     C                     END                             *FI            CSE006
      * Zalign Lower range     - Securities Trading Data  *               CSE006
     C*                                                                   CSE006
     C                     MOVE WUZASF    #DRCTL                          CSE006
     C*                                                                   CSE006
     C                     END                             *FI            CSE006
      ***Allocate*Difference to Dummy Customer                                         137886 217119
      **********                                                                       137886 217119
     C********** BVALDC    IFEQ *BLANKS                                                137886 217119
     C**********           MOVE 'N'       #1ALDC                                       137886 217119
     C**********           ELSE                                                        137886 217119
     C**********           MOVE BVALDC    #1ALDC                                       137886 217119
     C**********           ENDIF                                                       137886 217119
      **********                                                                       CSE007 217119
     C**********           ENDIF                                                       CSE007 217119
      **********                                                                       CSE007 217119
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy member SD9211RISE - Securities Trading Data  * S01212
     C*
     C/COPY WNCPYSRC,SD9211RISE
     C*
     C                     END                             *FI
     C                     END
      *
      *..................................................
     C   99                GOTO BEEXIT
      * No error: Display and process details
     C                     EXSR CADSDA
      *
      *================================================================
     CSR         BEEXIT    ENDSR
      /EJECT
     CSR         BFVLKY    BEGSR
      *================================================================
      * Validate key fields
      *================================================================
      * USER: Validate key screen
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy member SD9211RVKS - Securities Trading Data  * S01212
     C*
     C/COPY WNCPYSRC,SD9211RVKS
     C*
     C                     END                             *FI
      *================================================================
     CSR         BFEXIT    ENDSR
      /EJECT
     CSR         CADSDA    BEGSR
      *================================================================
      * Display and process detail screen
      *================================================================
      * Conduct detail screen conversation
      * - repeat until screen control flag is reset:
     C           W0TRN     DOWEQ'Y'
      * Display detail screen
     C                     EXSR CBEXFM
      * Process response to detail screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * Redisplay previous screen
     C   12                CAS            CCDSPV
      * HOME: Reset screen fields
     C   05                CAS            CCDSPV
      * Process detail screen input
     C                     CAS            CFPRSC
     C                     END
     C           W0TRN     IFEQ 'R'
     C           W0PMD     IFEQ 'ADD'
     C                     EXSR MAIZ#1
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         CBEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
     C           W0HLP     DOUEQ'N'
     C           W0ROL     ANDEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE HELP25    *IN25
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Update screen time
     C                     TIME           ##TME
      * PUTOVR unless conditioned fields change
     C                     SETON                         86*
     C           *IN89     IFNE CBIN89
     C                     SETOF                         86*
     C                     END
     C                     MOVE *IN89     CBIN89  1
     C           W0SCR     IFEQ 1
      * Set error
     C                     MOVEAINSCR1    *IN,31
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y1SET
     C                     END
      **********                                                                       CAS006 224354
      ***Do*not*display*Historic*Price*if*CAS006*is*'N'****************                CAS006 224354
      **********                                                                       CAS006 224354
     C********** CAS006    IFEQ 'N'                                                    CAS006 224354
     C**********           MOVE *ON       *IN65                                        CAS006 224354
     C**********           ENDIF                                                       CAS006 224354
      **********                                                                       CAS006 224354
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT2
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
     C                     ELSE
     C           W0SCR     IFEQ 2
      * Set error
     C                     MOVEAINSCR2    *IN,31
     C                     MOVEACOAC      *IN,71                          CSE007
     C                     MOVEACOAC2     *IN,81                                              237754
      *                                                                   182471
      *If Corporate Actions feature is on ensure fields will be displayed 182471
      *                                                                   182471
     C           WUCOAC    IFEQ 'Y'                                       182471
     C           WUEURO    OREQ 'Y'                                       203557
     C                     MOVE 1         *IN80                           182471
     C                     ENDIF                                          182471
      *                                                                   182471
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y2SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT3
      *                                                                   CSE006
      ***  If switchable feature for repos enhancement is on then         CSE006
      ***  write record format with additional fields.                    CSE006
      *                                                                   CSE006
     C           WUCSE6    IFEQ 'Y'                                       CSE006
     C                     EXFMT#RCDDT2B                                  CSE006
     C                     ELSE                                           CSE006
     C                     EXFMT#RCDDTL2
     C                     ENDIF                                          CSE006
      *                                                                   CSE006
      * Test cursor
     C                     EXSR Y8TST
     C                     ELSE
     C           W0SCR     IFEQ 3
      * Set error
     C                     MOVEAINSCR3    *IN,31
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y3SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT4
     C                     EXFMT#RCDDTL3
      * Test cursor
     C                     EXSR Y8TST
     C                     END
     C                     END
     C                     END
      * Reset roll flag
     C                     MOVEL'N'       W0ROL   1
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Show next page of details
     C   27                EXSR CDNXSC
      * Show previous page of details
     C   28                EXSR CEPVSC
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CBEXIT    ENDSR
      /EJECT
     CSR         CCDSPV    BEGSR
      *================================================================
      * Redisplay previous screen
      *================================================================
      * USER: Process key screen request
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy member SD9211RPKR - Securities Trading Data  * S01212
     C*
     C/COPY WNCPYSRC,SD9211RPKR
     C*
     C                     END                             *FI
      * Bypass KEY screen, if F12 is pressed on detail screen
     C                     MOVEL*BLANK    P3WRTC           Work Return cod
     C                     MOVEL'PREV'    P3WRTC           Work Return cod
     C                     MOVEL'PREV'    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C   05                MOVEL'R'       W0TRN
     C   12                MOVEL'K'       W0TRN
      * Initialise error memories
     C                     MOVE *ZERO     INSCR1
     C                     MOVE *ZERO     INSCR2
     C                     MOVE *ZERO     INSCR3
     C                     MOVE *ZERO     COAC                            CSE007
     C                     MOVE *ZERO     COAC2                                               237754
      *================================================================
     CSR         CCEXIT    ENDSR
      /EJECT
     CSR         CDNXSC    BEGSR
      *================================================================
      * Display next screen
      *================================================================
      * Set roll flag
     C                     MOVEL'Y'       W0ROL   1
     C           W0SCR     IFLT 3
     C                     ADD  1         W0SCR
     C                     END
      *================================================================
     CSR         CDEXIT    ENDSR
      /EJECT
     CSR         CEPVSC    BEGSR
      *================================================================
      * Display previous screen
      *================================================================
      * Set roll flag
     C                     MOVEL'Y'       W0ROL   1
     C           W0SCR     IFGT 1
     C                     SUB  1         W0SCR
     C                     END
      *================================================================
     CSR         CEEXIT    ENDSR
      /EJECT
     CSR         CFPRSC    BEGSR
      *================================================================
      * Validate record
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate details
     C                     MOVE *ZEROS    INSCR1
     C                     MOVE *ZEROS    INSCR2
     C                     MOVE *ZEROS    INSCR3
     C                     MOVE *ZEROS    COAC                            CSE007
     C                     MOVE *ZEROS    COAC2                                               237754
     C                     EXSR DCVLDL
      * Display first screen in error
     C           INSCR1    IFNE *ZERO
     C                     Z-ADD1         W0SCR
     C                     ELSE
     C           INSCR2    IFNE *ZERO
     C           COAC      ORNE *ZERO                                     CSE007
     C           COAC2     ORNE *ZERO                                                         237754
     C                     Z-ADD2         W0SCR
     C                     ELSE
     C           INSCR3    IFNE *ZERO
     C                     Z-ADD3         W0SCR
     C                     END
     C                     END
     C                     END
      * QUIT if error:
     C           *IN99     CABEQ'1'       CFEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       CFEXIT
      * No error: update record
     C                     EXSR EBPR##
      *================================================================
     CSR         CFEXIT    ENDSR
      /EJECT
     CSR         DCVLDL    BEGSR
      *================================================================
      * Validate details
      *================================================================
      * Validate Euclid
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1EUCD    W0NSRQ  1        Euclid
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1144681   Y2LSNO  70
     C           #1EUCD    PARM #1EUCD    W0EXVL 20        Euclid
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,40
     C                     SETON                     99    *
     C                     END
      * Validate Auto-transmission interfc
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1ATI     W0NSRQ  1        Auto-transmissi
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1112198   Y2LSNO  70
     C           #1ATI     PARM #1ATI     W0EXVL 20        Auto-transmissi
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,41
     C                     SETON                     99    *
     C                     END
      * Validate Dealing Events Interface
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1DEI     W0NSRQ  1        Dealing Events
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1144697   Y2LSNO  70
     C           #1DEI     PARM #1DEI     W0EXVL 20        Dealing Events
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,42
     C                     SETON                     99    *
     C                     END
      * Validate FI Collateral Interface
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1FICI    W0NSRQ  1        FI Collateral I
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1144702   Y2LSNO  70
     C           #1FICI    PARM #1FICI    W0EXVL 20        FI Collateral I
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,43
     C                     SETON                     99    *
     C                     END
      * Validate Reprompt defaults
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1REDE    W0NSRQ  1        Reprompt defaul
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1144706   Y2LSNO  70
     C           #1REDE    PARM #1REDE    W0EXVL 20        Reprompt defaul
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,49
     C                     SETON                     99    *
     C                     END
      * Validate Bulk Input Option
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1BIOP    W0NSRQ  1        Bulk Input Opti
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1144710   Y2LSNO  70
     C           #1BIOP    PARM #1BIOP    W0EXVL 20        Bulk Input Opti
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,50
     C                     SETON                     99    *
     C                     END
      * Validate Review Bulk Trades Dft
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1RVBT    W0NSRQ  1        Review Bulk Tra
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1173741   Y2LSNO  70
     C           #1RVBT    PARM #1RVBT    W0EXVL 20        Review Bulk Tra
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,51
     C                     SETON                     99    *
     C                     END
      * Validate Default Agency Trade
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1DEAT    W0NSRQ  1        Default Agency
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1173737   Y2LSNO  70
     C           #1DEAT    PARM #1DEAT    W0EXVL 20        Default Agency
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,52
     C                     SETON                     99    *
     C                     END
      * Validate Allow Trades P/folio Clnt
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1ATPC    W0NSRQ  1        Allow Trades P/
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1173745   Y2LSNO  70
     C           #1ATPC    PARM #1ATPC    W0EXVL 20        Allow Trades P/
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,53
     C                     SETON                     99    *
     C                     END
      * Validate Autocharge Option
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1ACOP    W0NSRQ  1        Autocharge Opti
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1144714   Y2LSNO  70
     C           #1ACOP    PARM #1ACOP    W0EXVL 20        Autocharge Opti
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,56
     C                     SETON                     99    *
     C                     END
      * Validate Adjust Comm s/day trade
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1ACSD    W0NSRQ  1        Adjust Comm s/d
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1173746   Y2LSNO  70
     C           #1ACSD    PARM #1ACSD    W0EXVL 20        Adjust Comm s/d
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,59
     C                     SETON                     99    *
     C                     END
      * Validate Extel Option
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1EXOP    W0NSRQ  1        Extel Option
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1144722   Y2LSNO  70
     C           #1EXOP    PARM #1EXOP    W0EXVL 20        Extel Option
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,60
     C                     SETON                     99    *
     C                     END
      * Validate Trade Authorisation Type
     C**********           MOVEL*BLANK    W0RTN                                             BUG12434
     C**********           MOVEL#1AUTH    W0NSRQ  1        Trade Authorisa                  BUG12434
      **Name*search*required?                                                               BUG12434
     C********** W0NSRQ    IFEQ '?'                                                         BUG12434
     C**********           CALL 'Y2VLLSR'              90  *                                BUG12434
     C**********           PARM           W0RTN   7                                         BUG12434
     C**********           PARM 1155330   Y2LSNO  70                                        BUG12434
     C********** #1AUTH    PARM #1AUTH    W0EXVL 20        Trade Authorisa                  BUG12434
      **Defer*confirm                                                                       BUG12434
     C**********           MOVEL'Y'       W0DCF   1                                         BUG12434
     C**********           END                                                              BUG12434
      *
     C********** W0RTN     IFNE *BLANK                                                      BUG12434
     C**********           MOVEL*BLANK    W0RTN                                             BUG12434
     C**********           MOVEL'1'       @I1,61                                            BUG12434
     C**********           SETON                     99    *                                BUG12434
     C**********           END                                                              BUG12434
      * Validate Telekurs Interface
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1TKIF    W0NSRQ  1        Telekurs Interf
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1181981   Y2LSNO  70
     C           #1TKIF    PARM #1TKIF    W0EXVL 20        Telekurs Interf
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,63
     C                     SETON                     99    *
     C                     END
      * Validate Priority of Branch Dft
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1PBDF    W0NSRQ  1        Priority of Bra
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1184657   Y2LSNO  70
     C           #1PBDF    PARM #1PBDF    W0EXVL 20        Priority of Bra
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I2,41
     C                     SETON                     99    *
     C                     END
      * Validate Priority of Cust Chrg Dft
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1POCD    W0NSRQ  1        Priority of Cus
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1184841   Y2LSNO  70
     C           #1POCD    PARM #1POCD    W0EXVL 20        Priority of Cus
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I2,42
     C                     SETON                     99    *
     C                     END
      * Validate Priority of Cust Grp Dft
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1PCSD    W0NSRQ  1        Priority of Cus
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1184847   Y2LSNO  70
     C           #1PCSD    PARM #1PCSD    W0EXVL 20        Priority of Cus
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I2,43
     C                     SETON                     99    *
     C                     END
      * Validate Priority of Invst typ Dft
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1PIDF    W0NSRQ  1        Priority of Inv
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1184853   Y2LSNO  70
     C           #1PIDF    PARM #1PIDF    W0EXVL 20        Priority of Inv
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I2,44
     C                     SETON                     99    *
     C                     END
      * Validate Priority of Market Dft
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1PMDF    W0NSRQ  1        Priority of Mar
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1184859   Y2LSNO  70
     C           #1PMDF    PARM #1PMDF    W0EXVL 20        Priority of Mar
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I2,45
     C                     SETON                     99    *
     C                     END
      * Validate Reallowance bank av/price
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1RBAP    W0NSRQ  1        Reallowance ban
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1144735   Y2LSNO  70
     C           #1RBAP    PARM #1RBAP    W0EXVL 20        Reallowance ban
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I3,31
     C                     SETON                     99    *
     C                     END
      * Validate Reallowance cust. av/prc
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1RCAP    W0NSRQ  1        Reallowance cus
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1144743   Y2LSNO  70
     C           #1RCAP    PARM #1RCAP    W0EXVL 20        Reallowance cus
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I3,32
     C                     SETON                     99    *
     C                     END
      * Validate Charges in bank av/price
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1CBAP    W0NSRQ  1        Charges in bank
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1144759   Y2LSNO  70
     C           #1CBAP    PARM #1CBAP    W0EXVL 20        Charges in bank
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I3,33
     C                     SETON                     99    *
     C                     END
      * Validate Commission in bank av/prc
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1CMBP    W0NSRQ  1        Commission in b
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1144767   Y2LSNO  70
     C           #1CMBP    PARM #1CMBP    W0EXVL 20        Commission in b
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I3,34
     C                     SETON                     99    *
     C                     END
      * Validate Charges in customer av/pr
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1CCAP    W0NSRQ  1        Charges in cust
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1144763   Y2LSNO  70
     C           #1CCAP    PARM #1CCAP    W0EXVL 20        Charges in cust
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I3,35
     C                     SETON                     99    *
     C                     END
      * Validate Commission in cust. av/pr
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1CMCP    W0NSRQ  1        Commission in c
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1144771   Y2LSNO  70
     C           #1CMCP    PARM #1CMCP    W0EXVL 20        Commission in c
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I3,36
     C                     SETON                     99    *
     C                     END
      * Validate Trade/Value Date Valuatn
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1TVDV    W0NSRQ  1        Trade/Value Dat
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1144784   Y2LSNO  70
     C           #1TVDV    PARM #1TVDV    W0EXVL 20        Trade/Value Dat
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I3,37
     C                     SETON                     99    *
     C                     END
      * Validate Trade/Value Collateral
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1TVC     W0NSRQ  1        Trade/Value Col
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1144788   Y2LSNO  70
     C           #1TVC     PARM #1TVC     W0EXVL 20        Trade/Value Col
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I3,38
     C                     SETON                     99    *
     C                     END
      * Validate Market/Book Exposure
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1MBEX    W0NSRQ  1        Market/Book Exp
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1144793   Y2LSNO  70
     C           #1MBEX    PARM #1MBEX    W0EXVL 20        Market/Book Exp
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I3,40
     C                     SETON                     99    *
     C                     END
      * Validate Realised Profit Basis
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1RPB     W0NSRQ  1        Realised Profit
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1144798   Y2LSNO  70
     C           #1RPB     PARM #1RPB     W0EXVL 20        Realised Profit
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I3,45
     C                     SETON                     99    *
     C                     END
      * Validate Unrealised Profit Basis
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1UPB     W0NSRQ  1        Unrealised Prof
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1144806   Y2LSNO  70
     C           #1UPB     PARM #1UPB     W0EXVL 20        Unrealised Prof
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I3,46
     C                     SETON                     99    *
     C                     END
      * Validate Unrealised Profit Posting
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1UPP     W0NSRQ  1        Unrealised Prof
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1144807   Y2LSNO  70
     C           #1UPP     PARM #1UPP     W0EXVL 20        Unrealised Prof
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I3,47
     C                     SETON                     99    *
     C                     END
      * Validate Adjust Unrealise Profit
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1AUP     W0NSRQ  1        Adjust Unrealis
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1144808   Y2LSNO  70
     C           #1AUP     PARM #1AUP     W0EXVL 20        Adjust Unrealis
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I3,48
     C                     SETON                     99    *
     C                     END
      * Validate Summarise Daily Trades
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1SDTR    W0NSRQ  1        Summarise Daily
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1144809   Y2LSNO  70
     C           #1SDTR    PARM #1SDTR    W0EXVL 20        Summarise Daily
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I3,49
     C                     SETON                     99    *
     C                     END
      * Validate FIFO Accounting
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1FIFO    W0NSRQ  1        FIFO Accounting
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1144810   Y2LSNO  70
     C           #1FIFO    PARM #1FIFO    W0EXVL 20        FIFO Accounting
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I3,50
     C                     SETON                     99    *
     C                     END
      * Validate Split Purchased Interest
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1SPIN    W0NSRQ  1        Split Purchased
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1144811   Y2LSNO  70
     C           #1SPIN    PARM #1SPIN    W0EXVL 20        Split Purchased
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I3,51
     C                     SETON                     99    *
     C                     END
      * Validate Split Negative Interest
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1SNIN    W0NSRQ  1        Split Negative
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1144812   Y2LSNO  70
     C           #1SNIN    PARM #1SNIN    W0EXVL 20        Split Negative
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I3,52
     C                     SETON                     99    *
     C                     END
      * Validate Trade Subtypes in A/c key
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1TSAK    W0NSRQ  1        Trade Subtypes
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1144813   Y2LSNO  70
     C           #1TSAK    PARM #1TSAK    W0EXVL 20        Trade Subtypes
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I3,53
     C                     SETON                     99    *
     C                     END
      * Validate Convertible Indicator A/k
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1CIAK    W0NSRQ  1        Convertible Ind
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1144814   Y2LSNO  70
     C           #1CIAK    PARM #1CIAK    W0EXVL 20        Convertible Ind
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I3,54
     C                     SETON                     99    *
     C                     END
      * Validate Negative position on A/K
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1NPAC    W0NSRQ  1        Negative positi
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1144815   Y2LSNO  70
     C           #1NPAC    PARM #1NPAC    W0EXVL 20        Negative positi
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I3,55
     C                     SETON                     99    *
     C                     END
      * Validate General Disc/Prem Keys
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1GDPK    W0NSRQ  1        General Disc/Pr
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1144816   Y2LSNO  70
     C           #1GDPK    PARM #1GDPK    W0EXVL 20        General Disc/Pr
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I3,56
     C                     SETON                     99    *
     C                     END
      * Validate Suppress keys on Trade/vl
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1SKTV    W0NSRQ  1        Suppress keys o
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1144817   Y2LSNO  70
     C           #1SKTV    PARM #1SKTV    W0EXVL 20        Suppress keys o
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I3,57
     C                     SETON                     99    *
     C                     END
      * Validate Post no Stnd Depot Mvmts
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1PSDM    W0NSRQ  1        Post no Stnd De
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1144818   Y2LSNO  70
     C           #1PSDM    PARM #1PSDM    W0EXVL 20        Post no Stnd De
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I3,58
     C                     SETON                     99    *
     C                     END
      * Validate Redemptions on Sec Desc.
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1ROSD    W0NSRQ  1        Redemptions on
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1145040   Y2LSNO  70
     C           #1ROSD    PARM #1ROSD    W0EXVL 20        Redemptions on
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I3,59
     C                     SETON                     99    *
     C                     END
      * Validate Cross Currency Entries
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1CCYE    W0NSRQ  1        Cross Currency
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1144820   Y2LSNO  70
     C           #1CCYE    PARM #1CCYE    W0EXVL 20        Cross Currency
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I3,60
     C                     SETON                     99    *
     C                     END
      * Validate Autopost Position Settle
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1APST    W0NSRQ  1        Autopost Positi
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1144821   Y2LSNO  70
     C           #1APST    PARM #1APST    W0EXVL 20        Autopost Positi
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I3,61
     C                     SETON                     99    *
     C                     END
      * Validate Mark to Market Frequency
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1MMFQ    W0NSRQ  1        Mark to Market
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1137909   Y2LSNO  70
     C           #1MMFQ    PARM #1MMFQ    W0EXVL 20        Mark to Market
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I3,62
     C                     SETON                     99    *
     C                     END
      * Validate Trading Confirmation Type
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1TCTY    W0NSRQ  1        Trading Confirm
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1145877   Y2LSNO  70
     C           #1TCTY    PARM #1TCTY    W0EXVL 20        Trading Confirm
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I3,67
     C                     SETON                     99    *
     C                     END
      * Validate Trade & Book Posn Recble
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1TBRC    W0NSRQ  1        Trade & Book Po
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C                     CALL 'Y2VLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1142931   Y2LSNO  70
     C           #1TBRC    PARM #1TBRC    W0EXVL 20        Trade & Book Po
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I3,68
     C                     SETON                     99    *
     C                     END
      * USER: Validate detail screen fields
      * Retention for Matured Securities
      * CASE: DTL.Matured Securities func is blank
     C           #DMSCF    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DMSCF    ZA0003           Matured Securit
      * Send message 'Matured Securities is req'
     C                     MOVEL'USR0966' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,31           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DMSCF    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0049  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0050 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0051  10       ZALIGN No Of De
     C                     PARM 3         WQ0052  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0053 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUERCD           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUERCD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0054 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0055  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * CASE: WRK.Err Code is Error Found
     C           WUERCD    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DMSCF    ZA0004           Matured Securit
      * Send message 'Matured Sec. numeric'
     C                     MOVEL'USR0967' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,31           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Zalign Matured Securities - Securities Trading Data  *
     C*
     C*
     C                     MOVE WUZASF    #DMSCF
     C*
     C*
     C                     MOVE WUZAFF    #1ROMS           Retention of ma
      * CASE: DTL.Retention of matured sec. is valid range
     C           #1ROMS    IFGE 1                          *IF
     C***********#1ROMS    ANDLE99                                        138229
     C********** #1ROMS    ANDLE12                                                     138229 198623
     C           #1ROMS    ANDLE99                                                            198623
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DMSCF    ZA0005           Matured Securit
      * Send message 'Matured Securities range'
     C                     MOVEL'USR0968' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,31           *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Retention for Settled Trades
      * CASE: DTL.Settled Trades func fld. is blank
     C           #DSTFF    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DSTFF    ZA0006           Settled Trades
      * Send message 'Settled Trades required'
     C                     MOVEL'USR0969' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,32           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DSTFF    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0056  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0057 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0058  10       ZALIGN No Of De
     C                     PARM 3         WQ0059  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0060 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUERCD           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUERCD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0061 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0062  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * CASE: WRK.Err Code is Error Found
     C           WUERCD    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DSTFF    ZA0007           Settled Trades
      * Send message 'Settled Trades numeric'
     C                     MOVEL'USR0970' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,32           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Zalign Settled Trades - Securities Trading Data  *
     C*
     C*
     C                     MOVE WUZASF    #DSTFF
     C*
     C*
     C                     MOVE WUZAFF    #1ROST           Retention of se
      * CASE: DTL.Retention of settled trd is valid range
     C           #1ROST    IFGE 1                          *IF
     C***********#1ROST    ANDLE99                                        138229
     C********** #1ROST    ANDLE12                                                     138229 198623
     C           #1ROST    ANDLE99                                                            198623
      **Check*that*the*retention*period*for*trades*+*the*back*value       138229
      **period*is*less*than*the*retention*period*for*securities.          138229
     C***********#1BVP     DIV  30        WUTRBV           Trade Ret Prd  138229
     C***********          ADD  1         WUTRBV           Trade Ret Prd  138229
     C***********          ADD  #1ROST    WUTRBV           Trade Ret Prd  138229
      **Compare*the*sum*of*ret*period*and*bvp*against*ret*period*for*secs 138229
      **CASE:*WRK.Trade*Ret*Prd*+*BVP*GT*DTL.Retention*of*matured*sec.    138229
     C***********WUTRBV    IFGT #1ROMS                     *IF            138229
      * CASE: DTL.Retention of settled trd GT DTL.Retention of matured SE 138229
     C           #1ROST    IFGT #1ROMS                     *IF            138229
      * Setup message data for message
     C                     MOVEL#DSTFF    ZA0008           Settled Trades
      * Send message 'Settled less than Matured'
     C                     MOVEL'USR0980' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,32           *
      *
     C                     END                             *FI
      *                                                                                       203506
      ** Check if CSE023 - Treaty Withholding Tax present                                     203506
      *                                                                                       203506
     C                     MOVE 'N'       CSE023  1                                           203506
     C                     CALL 'AOSARDR0'                                                    203506
     C                     PARM *BLANKS   @RTCD   7                                           203506
     C                     PARM '*VERIFY' @OPTN   7                                           203506
     C                     PARM 'CSE023'  @SARD   6                                           203506
      *                                                                                       203506
     C           @RTCD     IFEQ *BLANK                                                        203506
     C                     MOVE 'Y'       CSE023                                              203506
     C           31        MULT 18        @MINR   30                                          203506
     C                     ENDIF                                                              203506
     C*                                                                                       203506
     C** If CSE023 is present, the minimum retention period is                                203506
     C** 18 months.                                                                           203506
     C*                                                                                       203506
     C           CSE023    IFEQ 'Y'                                                           203506
     C           #1ROMS    IFLT 18                                                            203506
      * Setup message data for message                                                        203506
     C                     MOVEL#DMSCF    ZA0003           Matured Securi                     203506
      * Send message 'Settled great than Back valuation'                                      203506
     C                     MOVEL'USR9995' ZAMSID                                              203506
     C                     EXSR ZASNMS                                                        203506
     C                     SETON                     99    *                                  203506
     C                     MOVEL'1'       @I1,31           *                                  203506
     C                     END                                                                203506
      *                                                                                       203506
     C           #1ROST    IFLT 18                                                            203506
      * Setup message data for message                                                        203506
     C                     MOVEL#DSTFF    ZA0003           Settle Trd                         203506
      * Send message 'Settled great than Back valuation'                                      203506
     C                     MOVEL'USR9993' ZAMSID                                              203506
     C                     EXSR ZASNMS                                                        203506
     C                     SETON                     99    *                                  203506
     C                     MOVEL'1'       @I1,32           *                                  203506
     C                     END                                                                203506
      *                                                                                       203506
      *                                                                                       203506
     C                     END                                                                203506
     C*                                                                                       203506
      *                                                                                       203506
     C           31        MULT #1ROMS    WK4N    40                                          203506
     C           WK4N      IFLT #1BVP                                                         203506
      * Setup message data for message                                                        203506
     C                     MOVEL#DMSCF    ZA0010           Matured Securi                     203506
      * Send message 'Matured great than Back valuation'                                      203506
     C                     MOVEL'USR9997' ZAMSID                                              203506
     C                     EXSR ZASNMS                                                        203506
     C                     SETON                     99    *                                  203506
     C                     MOVEL'1'       @I1,31           *                                  203506
      *                                                                                       203506
     C                     END                             *FI                                203506
      *                                                                                       203506
     C           31        MULT #1ROST    WK4N    40                                          203506
     C           WK4N      IFLT #1BVP                                                         203506
      * Setup message data for message                                                        203506
     C                     MOVEL#DSTFF    ZA0011           Settled Trades                     203506
      * Send message 'Settled great than Back valuation'                                      203506
     C                     MOVEL'USR9998' ZAMSID                                              203506
     C                     EXSR ZASNMS                                                        203506
     C                     SETON                     99    *                                  203506
     C                     MOVEL'1'       @I1,32           *                                  203506
      *                                                                                       203506
     C                     END                             *FI                                203506
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DSTFF    ZA0009           Settled Trades
      * Send message 'Settled Trades range'
     C                     MOVEL'USR0971' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,32           *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Back Value Period
      * CASE: DTL.Back Valuation Func fld is blank
     C           #DBVFF    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DBVFF    ZA0010           Back Valuation
      * Send message 'Back Valuation is req.'
     C                     MOVEL'USR0972' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,33           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DBVFF    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0063  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0064 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0065  10       ZALIGN No Of De
     C                     PARM 3         WQ0066  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0067 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUERCD           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUERCD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0068 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0069  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * CASE: WRK.Err Code is Error Found
     C           WUERCD    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DBVFF    ZA0011           Back Valuation
      * Send message 'Back Valuation numeric'
     C                     MOVEL'USR0973' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,33           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Zalign Back Valuation - Securities Trading Data  *
     C*
     C*
     C                     MOVE WUZASF    #DBVFF
     C*
     C*
     C                     MOVE WUZAFF    #1BVP            Back value peri
      * CASE: DTL.Back value period is Valid No. Days for Year
     C           #1BVP     IFGE 1                          *IF
     C           #1BVP     ANDLE366
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DBVFF    ZA0012           Back Valuation
      * Send message 'Back Valuation range'
     C                     MOVEL'USR0974' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,33           *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Retention for Diaries
      * CASE: DTL.Diary Entries Func Field is blank
     C           #DDEFF    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DDEFF    ZA0013           Diary Entries F
      * Send message 'Diary Entries required'
     C                     MOVEL'USR0975' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,34           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DDEFF    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0070  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0071 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0072  10       ZALIGN No Of De
     C                     PARM 3         WQ0073  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0074 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUERCD           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUERCD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0075 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0076  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * CASE: WRK.Err Code is Error Found
     C           WUERCD    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DDEFF    ZA0014           Diary Entries F
      * Send message 'Diary Entries numeric'
     C                     MOVEL'USR0976' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,34           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Zalign Diary Entries - Securities Trading Data  *
     C*
     C*
     C                     MOVE WUZASF    #DDEFF
     C*
     C*
     C                     MOVE WUZAFF    #1RODY           Retention of di
      * CASE: DTL.Retention of diary is valid range
     C           #1RODY    IFGE 1                          *IF
     C***********#1RODY    ANDLE99                                        138229
     C********** #1RODY    ANDLE12                                                     138229 198623
     C           #1RODY    ANDLE99                                                            198623
      *                                                                                       203506
     C           31        MULT #1RODY    WK4N    40                                          203506
     C           WK4N      IFLT #1BVP                                                         203506
      * Setup message data for message                                                        203506
     C                     MOVEL#DDEFF    ZA0015           Diary Entries                      203506
      * Send message 'Diary great than Back valuation'                                        203506
     C                     MOVEL'USR9999' ZAMSID                                              203506
     C                     EXSR ZASNMS                                                        203506
     C                     SETON                     99    *                                  203506
     C                     MOVEL'1'       @I1,34           *                                  203506
      *                                                                                       203506
     C                     END                             *FI                                203506
      *                                                                                       203506
     C           CSE023    IFEQ 'Y'                                                           203506
     C           #1RODY    IFLT 18                                                            203506
      * Setup message data for message                                                        203506
     C                     MOVEL#DDEFF    ZA0003           Diary                              203506
      * Send message 'Settled great than Back valuation'                                      203506
     C                     MOVEL'USR9994' ZAMSID                                              203506
     C                     EXSR ZASNMS                                                        203506
     C                     SETON                     99    *                                  203506
     C                     MOVEL'1'       @I1,34           *                                  203506
     C                     END                                                                203506
     C                     END                                                                203506
      *                                                                                       203506
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DDEFF    ZA0015           Diary Entries F
      * Send message 'Diary Entries range'
     C                     MOVEL'USR0983' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,34           *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      **********                                                                       CAS006 224354
      ***Validate*Historic*Price*Retention*Period*if*CAS006*is*on******                CAS006 224354
      **********                                                                       CAS006 224354
     C********** CAS006    IFEQ 'Y'                                                    CAS006 224354
     C**********           EXSR SRCHNO                                                 CAS006 224354
     C**********           ENDIF                                                       CAS006 224354
      **********                                                                       CAS006 224354
      * Currency Code for Cedel
      * CASE: DTL.Cedel Currency Code is blank
     C           #1CCCY    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1CCCY    ZA0016           Cedel Currency
      * Send message 'Currency Code - Cedel req'
     C                     MOVEL'USR1088' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,36           *
      *
     C                     END                             *FI
      * Euclid Interface
      * CASE: DTL.Euclid is blank
     C           #1EUCD    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1EUCD    ZA0017           Euclid
      * Send message 'Euclid is required'
     C                     MOVEL'USR1003' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,40           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.Euclid is valid value
     C           #1EUCD    IFEQ 'N'                        *IF
     C           #1EUCD    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1EUCD    ZA0018           Euclid
      * Send message 'Invalid Euclid'
     C                     MOVEL'USR1004' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,40           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Start of SAR S01322
      * Validation for RT Bond Interface removed
      * End of SAR S01322
      * Dealing Events
      * CASE: DTL.Dealing Events Interface is blank
     C           #1DEI     IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1DEI     ZA0019           Dealing Events
      * Send message 'Dealing Events required'
     C                     MOVEL'USR1007' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,42           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.Dealing Events Interface is valid values
     C           #1DEI     IFEQ 'N'                        *IF
     C           #1DEI     OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1DEI     ZA0020           Dealing Events
      * Send message 'Invalid dealing events'
     C                     MOVEL'USR1008' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,42           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * FI Collateral Interface
      * CASE: DTL.FI Collateral Interface is blank
     C           #1FICI    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1FICI    ZA0021           FI Collateral I
      * Send message 'FI Collateral is required'
     C                     MOVEL'USR1009' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,43           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.FI Collateral Interface is valid values
     C           #1FICI    IFEQ 'N'                        *IF
     C           #1FICI    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1FICI    ZA0022           FI Collateral I
      * Send message 'Invalid FI Collateral'
     C                     MOVEL'USR1010' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,43           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Start of Fix E22735
      * Market book code should be optional
      * End of Fix E22735
      * Start of Fix E20535
      * Portfolio book code should be optional
      * End of Fix E20535
      * Default Trade Subtype - Market
      * CASE: DTL.Default Market Subtype is blank
     C           #1DMKS    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1DMKS    ZA0023           Default Market
      * Send message 'Default trade market req'
     C                     MOVEL'USR1091' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,46           *
      *
     C                     END                             *FI
      * Default Trade Subtype Portfolio
      * CASE: DTL.Default Portfolio Subtype is blank
     C           #1DPFS    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1DPFS    ZA0024           Default Portfol
      * Send message 'Deflt Trade Portfolio req'
     C                     MOVEL'USR1092' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,47           *
      *
     C                     END                             *FI
      * Default Trade Subtype - Transfer
      * CASE: DTL.Default Transfer Deal Sub is blank
     C           #1DTDS    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1DTDS    ZA0025           Default Transfe
      * Send message 'Default Book Transfer req'
     C                     MOVEL'USR1093' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,48           *
      *
     C                     END                             *FI
      * Reprompt Defaults
      * CASE: DTL.Reprompt defaults is blank
     C           #1REDE    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1REDE    ZA0026           Reprompt defaul
      * Send message 'Reprompt Default required'
     C                     MOVEL'USR1011' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,49           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.Reprompt defaults is valid values
     C           #1REDE    IFEQ 'N'                        *IF
     C           #1REDE    OREQ 'Y'
      * Start of 062031
      * Update 'Reprompt Trade Default' with the valid value entered
      * in 'Reprompt Defaults' to make sure that they are kept in step.
     C                     MOVEL#1REDE    #1RDOT           Reprompt Defaul
      * End of 062031
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1REDE    ZA0027           Reprompt defaul
      * Send message 'Invalid Reprompt defaults'
     C                     MOVEL'USR1012' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,49           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Bulk Input Option
      * CASE: DTL.Bulk Input Option is blank
     C           #1BIOP    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1BIOP    ZA0028           Bulk Input Opti
      * Send message 'Bulk Input Option req.'
     C                     MOVEL'USR1013' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,50           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.Bulk Input Option is valid values
     C           #1BIOP    IFEQ 'N'                        *IF
     C           #1BIOP    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1BIOP    ZA0029           Bulk Input Opti
      * Send message 'Invalid Bulk Input Option'
     C                     MOVEL'USR1014' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,50           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Start of S01448
      * Review Trades Default (S01448 - Bulk Input Enhancements)
      * CASE: WRK.SAR S01448 is Present
     C           WUBLKI    IFEQ 'Y'                        *IF
      * Check Bulk Input flag.
      * CASE: DTL.Bulk Input Option is Yes
     C           #1BIOP    IFEQ 'Y'                        *IF
      * Check for valid values.
      * CASE: DTL.Review Bulk Trades Dft is Valid Values
     C           #1RVBT    IFEQ 'N'                        *IF
     C           #1RVBT    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1RVBT    ZA0030           Review Bulk Tra
      * Send message 'Review Trades Dft Invalid'
     C                     MOVEL'USR2131' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,51           *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Blank value required.
      * CASE: DTL.Review Bulk Trades Dft is Blank
     C           #1RVBT    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1RVBT    ZA0031           Review Bulk Tra
      * Send message 'Review Trades Dft Non-blk'
     C                     MOVEL'USR2134' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,51           *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * End of S01448
      * Start of S01448
      * Default Agency Trade (S01448 - Bulk Input Enhancements)
      * CASE: WRK.SAR S01448 is Present
     C           WUBLKI    IFEQ 'Y'                        *IF
      * Check Bulk Input flag.
      * CASE: DTL.Bulk Input Option is Yes
     C           #1BIOP    IFEQ 'Y'                        *IF
      * Check for valid values.
      * CASE: DTL.Default Agency Trade is Valid Values
     C           #1DEAT    IFEQ 'N'                        *IF
     C           #1DEAT    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1DEAT    ZA0032           Default Agency
      * Send message 'Default Agency Trade inv'
     C                     MOVEL'USR2132' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,52           *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Blank value required.
      * CASE: DTL.Default Agency Trade is Blank
     C           #1DEAT    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1DEAT    ZA0033           Default Agency
      * Send message 'Dft Agency Trade Non-blnk'
     C                     MOVEL'USR2133' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,52           *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * End of S01448
      * Start of S01448
      * Allow Trades Between P/folio Cust - (S01448 - Bulk Input Enhancem
      * CASE: WRK.SAR S01448 is Present
     C           WUBLKI    IFEQ 'Y'                        *IF
      * Check Bulk Input flag.
      * CASE: DTL.Bulk Input Option is Yes
     C           #1BIOP    IFEQ 'Y'                        *IF
      * Check for valid values.
      * CASE: DTL.Allow Trades P/folio Clnt is Valid Values
     C           #1ATPC    IFEQ 'N'                        *IF
     C           #1ATPC    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1ATPC    ZA0034           Allow Trades P/
      * Send message 'Allow Trad P/F cust inval'
     C                     MOVEL'USR2135' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,53           *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Blank value required.
      * CASE: DTL.Allow Trades P/folio Clnt is Blank
     C           #1ATPC    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1ATPC    ZA0035           Allow Trades P/
      * Send message 'Allow Trad P/F Cust Non-b'
     C                     MOVEL'USR2136' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,53           *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * End of S01448
      * Start of 062031
      * Moved this validation to this part of the program,
      * so that 'Bulk input' and all other fields related to it
      * are validated together.
      * Start of fix E17978
      * Bulk input: Validate
      * CASE: DTL.Bulk Input Option is Yes
     C           #1BIOP    IFEQ 'Y'                        *IF
      * Default Brokerage: Validate
     C                     EXSR UASUBR                     Default Brokera
      * Agency Book: Validate
     C                     EXSR UBSUBR                     Agency Book: Va
     C                     ELSE
      * CASE: *OTHERWISE
      * Default Brokerage must be blank
     C                     EXSR UCSUBR                     Default Brokera
      * Agency Book must be blank
     C                     EXSR UDSUBR                     Agency Book mus
     C                     END                             *FI
      * End of fix E17978
      * Start of fix E18116
      * Check Brokerage code if it is not blank
      * CASE: DTL.Default brokerage code is Not Blank
     C           #1DBCD    IFNE *BLANK                     *IF
      * Validate Default Broker - Securities Trading Data  *
     C*
     C                     MOVE *IN,70    UUIND   1
     C                     MOVE 'N'       WUDBII
     C*
     C* Check if UUDBC1 is in the range A-Z or 0-9. If not, set up
     C* work field to send error message.
     C*
     C           UUDBC1    LOKUPARRB                     70
     C           *IN70     IFEQ '0'
     C                     MOVE 'Y'       WUDBII
     C*
     C* Check if UUDBC2 is in the range A-Z or 0-9. If not, set up
     C* work field to send error message.
     C*
     C                     ELSE
     C           UUDBC2    LOKUPARRB                     70
     C           *IN70     IFEQ '0'
     C                     MOVE 'Y'       WUDBII
     C                     END
     C                     END
     C*
     C                     MOVE UUIND     *IN,70
      * CASE: WRK.Dft Broker invalid indic. is Yes
     C           WUDBII    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1DBCD    ZA0040           Default brokera
      * Send message 'Dflt Broker not rng AA-99'
     C                     MOVEL'USR1168' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,54           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * End of fix E18116
      * End of 062031
      * Autocharges Option
      * CASE: DTL.Autocharge Option is Blank
     C           #1ACOP    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1ACOP    ZA0041           Autocharge Opti
      * Send message 'Autocharges option req.'
     C                     MOVEL'USR1015' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,56           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.Autocharge Option is valid values
     C           #1ACOP    IFEQ 'N'                        *IF
     C           #1ACOP    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1ACOP    ZA0042           Autocharge Opti
      * Send message 'Invalid Autocharges optn'
     C                     MOVEL'USR1016' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,56           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Start of 062031
      * Remove the validation for Reprompt Defaults on Trades.
      * Update 'Reprompt Trade Default' with the valid value entered
      * in 'Reprompt Defaults' to make sure that they are kept in step.
      * End of 062031
      * Start CAC001
      * Securities Profit Centre
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Profit Centres Used is Yes
      *   |- c2    : WRK.Analytical Accounting is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUPRCU    IFEQ 'Y'                        *IF
     C           WUN0ST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: DTL.SE Profit Centre is Entered
     C           #1SEPC    IFNE *BLANK                     *IF
      * Securities Profit Centre has been entered.
      * CASE: DTL.SE Profit Centre is Question Mark
     C           #1SEPC    IFEQ '?'                        *IF
      * Select Profit Centres - Profit Centres  *
     C                     CALL 'SD0480S'              90  Select Profit C
     C                     PARM *BLANK    W0RTN   7
     C           #1SEPC    PARM #1SEPC    WQ0077  4        Profit Centre C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0480S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,57           *
     C                     END
      * If a Profit Centre is not selected blank out '?'
      * CASE: DTL.SE Profit Centre is Question Mark
     C           #1SEPC    IFEQ '?'                        *IF
     C                     MOVEL*BLANK    #1SEPC           SE Profit Centr
     C                     END                             *FI
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: *OTHERWISE
      * Retrieve Profit Centre - Profit Centres  *
     C                     EXSR SCRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#1SEPC    ZA0043           SE Profit Centr
      * Send message 'Profit Centre cde not val'
     C                     MOVEL'USR2855' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,57           *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * End CAC001
      * Start of S01446
      * Charges Currency - (S01446 - Customer Commissions)
      * CASE: WRK.SAR S01446 is Present
     C           WUCUSC    IFEQ 'Y'                        *IF
      * Check Autocharges flag.
      * CASE: DTL.Autocharge Option is Yes
     C           #1ACOP    IFEQ 'Y'                        *IF
     C                     MOVEL#1CHRC    WUTQKF           Test ? in Key F
     C                     MOVEL#1CHRC    WUCYCD           Currency Code
      * ? processing.
      * CASE: WRK.Test ? in Key Field is Question Mark
     C           WUTQKF    IFEQ '?'                        *IF
      * Select Currency Codes - Currency Codes  *
     C                     CALL 'SD0020S'              90  Select Currency
     C                     PARM *BLANK    W0RTN   7
     C           WUCYCD    PARM WUCYCD    WQ0078  3        Currency Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0020S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUCYCD    #1CHRC           SE charges curr
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: *OTHERWISE
      * If an entry has been made in the currency field.
      * CASE: DTL.SE charges currency is Blank
     C           #1CHRC    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Check for ccy existance - Currency Codes  *
     C                     EXSR SDRVGN
      * Check return code.
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#1CHRC    ZA0044           SE charges curr
      * Send message 'SE Charges Currency inval'
     C                     MOVEL'USR2140' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,58           *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * If an entry has been made in the currency field.
      * CASE: DTL.SE charges currency is Blank
     C           #1CHRC    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1CHRC    ZA0045           SE charges curr
      * Send message 'Charges Currency Non-blnk'
     C                     MOVEL'USR2139' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,58           *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * End of S01446
      * Start of S01446
      * Adjust Cust Comm for Same Day Trades - (S01446 - Customer Commiss
      * CASE: WRK.SAR S01446 is Present
     C           WUCUSC    IFEQ 'Y'                        *IF
      * Check Autocharges flag.
      * CASE: DTL.Autocharge Option is Yes
     C           #1ACOP    IFEQ 'Y'                        *IF
      * Check for valid values.
      * CASE: DTL.Adjust Comm s/day trade is Valid Values
     C           #1ACSD    IFEQ 'N'                        *IF
     C           #1ACSD    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1ACSD    ZA0046           Adjust Comm s/d
      * Send message 'Adj Cust Comm SD Trad inv'
     C                     MOVEL'USR2137' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,59           *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Blank value required.
      * CASE: DTL.Adjust Comm s/day trade is Blank
     C           #1ACSD    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1ACSD    ZA0047           Adjust Comm s/d
      * Send message 'Adj Cust Comm SDT Non-blk'
     C                     MOVEL'USR2138' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,59           *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * End of S01446
      * Extel Option
      * CASE: DTL.Extel Option is blank
     C           #1EXOP    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1EXOP    ZA0048           Extel Option
      * Send message 'Extel Option is required'
     C                     MOVEL'USR1017' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,60           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Validate Extel Option.
      * CASE: DTL.Extel Option is valid value
     C           #1EXOP    IFEQ 'N'                        *IF
     C           #1EXOP    OREQ 'Y'
      * Start of change S01502.
      * Check the Telekurs Interface flag.
      * CASE: DTL.Telekurs Interface is Tape or Communications
     C           #1TKIF    IFEQ 'C'                        *IF
     C           #1TKIF    OREQ 'T'
      * Extel Option must be 'N'.
      * CASE: DTL.Extel Option is No
     C           #1EXOP    IFEQ 'N'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1EXOP    ZA0049           Extel Option
      * Send message 'Extel Option Must be N'
     C                     MOVEL'USR2572' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,60           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * End of change S01502.
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1EXOP    ZA0050           Extel Option
      * Send message 'Invalid Extel Option'
     C                     MOVEL'USR1018' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,60           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Start of S01464
      * Start of SAR S01269
      * Trade Authorisation Type.
      * CASE: DTL.Trade Authorisation Type is *ALL values
     C********** #1AUTH    IFEQ '00'                       *IF                              BUG12434
     C********** #1AUTH    OREQ '10'                                                        BUG12434
     C********** #1AUTH    OREQ '15'                                                        BUG12434
     C********** #1AUTH    OREQ '20'                                                        BUG12434
     C********** #1AUTH    OREQ '25'                                                        BUG12434
     C********** #1AUTH    OREQ *BLANK                                                      BUG12434
     C**********           ELSE                                                             BUG12434
      **CASE:**OTHERWISE                                                                    BUG12434
      **Setup*message*data*for*message                                                      BUG12434
     C**********           MOVEL#1AUTH    ZA0051           Trade Authorisa                  BUG12434
      **Send*message*'Trade*Authorisation*Inval'                                            BUG12434
     C**********           MOVEL'USR1490' ZAMSID                                            BUG12434
     C**********           EXSR ZASNMS                                                      BUG12434
     C**********           SETON                     99    *                                BUG12434
     C**********           MOVEL'1'       @I1,61           *                                BUG12434
      *
     C**********           END                             *FI                              BUG12434
      * End of SAR S01269
      * Safe Custody Fees
      * CASE: WRK.SAR S01464 is Present
     C           WURTST    IFEQ 'Y'                        *IF
      * Validate
      * CASE: DTL.Safe Custody Fees Flag is Blank
     C           #1CUIN    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1CUIN    ZA0052           Safe Custody Fe
      * Send message 'Safe custdy must be entrd'
     C                     MOVEL'USR2276' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,62           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Check for valid values.
      * CASE: DTL.Safe Custody Fees Flag is Valid values
     C           #1CUIN    IFEQ 'N'                        *IF
     C           #1CUIN    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1CUIN    ZA0053           Safe Custody Fe
      * Send message 'Invalid safe custody flag'
     C                     MOVEL'USR2277' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,62           *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.Safe Custody Fees Flag is No
     C           #1CUIN    IFEQ 'N'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1CUIN    ZA0054           Safe Custody Fe
      * Send message 'Safe custody must be 'N'.'
     C                     MOVEL'USR2278' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,62           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * End of S01464
      * Start of S01502.
      * Validate Telekurs Interface.
      * CASE: DTL.Telekurs Interface is Valid values
     C           #1TKIF    IFEQ 'C'                        *IF
     C           #1TKIF    OREQ 'N'
     C           #1TKIF    OREQ 'T'
      * Check the Extel Option.
      * CASE: DTL.Extel Option is Yes
     C           #1EXOP    IFEQ 'Y'                        *IF
      * Check that Telekurs Interface is 'N'.
      * CASE: DTL.Telekurs Interface is No Telekurs interface
     C           #1TKIF    IFEQ 'N'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1TKIF    ZA0055           Telekurs Interf
      * Send message 'Telekurs Interface not N'
     C                     MOVEL'USR2571' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,63           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Start of S01502 (2)
      * Update SESTAT - Securities Trading Data  *
     C*
     C** Update Telekurs Interface position on SESTAT.
     C*
     C           *NAMVAR   DEFN           SESTAT
     C           *LOCK     IN   SESTAT
     C                     MOVE #1TKIF    TKINTF  1
     C                     OUT  SESTAT
     C*
      * End S01502 (2)
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1TKIF    ZA0056           Telekurs Interf
      * Send message 'Telekurs Interface Invald'
     C                     MOVEL'USR2570' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,63           *
      *
     C                     END                             *FI
      * End of S01502.
      * Reallowance for Bank
      * CASE: 3RD.Reallowance bank av/price is blank
     C           #1RBAP    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1RBAP    ZA0057           Reallowance ban
      * Send message 'Reallowance for Bank req'
     C                     MOVEL'USR1019' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,31           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: 3RD.Reallowance bank av/price is valid value
     C           #1RBAP    IFEQ 'N'                        *IF
     C           #1RBAP    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1RBAP    ZA0058           Reallowance ban
      * Send message 'Invalid Reallowance bank'
     C                     MOVEL'USR1020' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,31           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Reallowance for Customer
      * CASE: 3RD.Reallowance cust. av/prc is blank
     C           #1RCAP    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1RCAP    ZA0059           Reallowance cus
      * Send message 'Reallowance customer req.'
     C                     MOVEL'USR1021' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,32           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: 3RD.Reallowance cust. av/prc is valid value
     C           #1RCAP    IFEQ 'N'                        *IF
     C           #1RCAP    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1RCAP    ZA0060           Reallowance cus
      * Send message 'Invalid Reallowance Cust'
     C                     MOVEL'USR1022' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,32           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Charges for Bank
      * CASE: 3RD.Charges in bank av/price is blank
     C           #1CBAP    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1CBAP    ZA0061           Charges in bank
      * Send message 'Charges for bank required'
     C                     MOVEL'USR1023' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,33           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: 3RD.Charges in bank av/price is valid value
     C           #1CBAP    IFEQ 'N'                        *IF
     C           #1CBAP    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1CBAP    ZA0062           Charges in bank
      * Send message 'Invalid Charges for bank'
     C                     MOVEL'USR1025' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,33           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Charges for Customer
      * CASE: 3RD.Charges in customer av/pr is blank
     C           #1CCAP    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1CCAP    ZA0063           Charges in cust
      * Send message 'Charges for Customer req'
     C                     MOVEL'USR1026' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,35           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: 3RD.Charges in customer av/pr is valid value
     C           #1CCAP    IFEQ 'N'                        *IF
     C           #1CCAP    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1CCAP    ZA0064           Charges in cust
      * Send message 'Invalid Charges for Cust'
     C                     MOVEL'USR1027' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,35           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Commission  for Bank
      * CASE: 3RD.Commission in bank av/prc is blank
     C           #1CMBP    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1CMBP    ZA0065           Commission in b
      * Send message 'Commission for Bank  req'
     C                     MOVEL'USR1028' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,34           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: 3RD.Commission in bank av/prc is valid value
     C           #1CMBP    IFEQ 'N'                        *IF
     C           #1CMBP    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1CMBP    ZA0066           Commission in b
      * Send message 'Invalid Commission Bank'
     C                     MOVEL'USR1029' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,34           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Commission for Customer
      * CASE: 3RD.Commission in cust. av/pr is blank
     C           #1CMCP    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1CMCP    ZA0067           Commission in c
      * Send message 'Commission for Cust. req'
     C                     MOVEL'USR1030' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,36           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: 3RD.Commission in cust. av/pr is valid value
     C           #1CMCP    IFEQ 'N'                        *IF
     C           #1CMCP    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1CMCP    ZA0068           Commission in c
      * Send message 'Invalid Commission Cust'
     C                     MOVEL'USR1031' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,36           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Start of 046900,  remove Fix E22438
      * Make trade value date Mandatory, as this was made
      * optional by mistake.
      * Trade/Value Date valuations
      * CASE: 3RD.Trade/Value Date Valuatn is blank
     C           #1TVDV    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1TVDV    ZA0069           Trade/Value Dat
      * Send message 'Trade/Value Valuation req'
     C                     MOVEL'USR1032' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,37           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: 3RD.Trade/Value Date Valuatn is Trade or Value
     C           #1TVDV    IFEQ 'T'                        *IF
     C           #1TVDV    OREQ 'V'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1TVDV    ZA0070           Trade/Value Dat
      * Send message 'Invalid Trade/Value Valut'
     C                     MOVEL'USR1033' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,37           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * End of 046900, remove Fix E22438
      * Trade/Value date Collateral
      * CASE: 3RD.Trade/Value Collateral is blank
     C           #1TVC     IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1TVC     ZA0071           Trade/Value Col
      * Send message 'Trade/Value Collateral'
     C                     MOVEL'USR1034' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,38           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: 3RD.Trade/Value Collateral is valid value
     C           #1TVC     IFEQ 'T'                        *IF
     C           #1TVC     OREQ 'V'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1TVC     ZA0072           Trade/Value Col
      * Send message 'Invalid Trade/Value Coll'
     C                     MOVEL'USR1035' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,38           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Market Book Exposure
      * CASE: 3RD.Market/Book Exposure is blank
     C           #1MBEX    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1MBEX    ZA0073           Market/Book Exp
      * Send message 'Market/Book Exposure req'
     C                     MOVEL'USR1036' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,40           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: 3RD.Market/Book Exposure is valid value
     C           #1MBEX    IFEQ 'B'                        *IF
     C           #1MBEX    OREQ 'M'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1MBEX    ZA0074           Market/Book Exp
      * Send message 'Invalid Market/Book expos'
     C                     MOVEL'USR1037' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,40           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Collateral Currency Conversion
      * CASE: 3RD.collateral ccy conv. func is Blank
     C           #DCCCF    IFEQ *BLANK                     *IF
     C                     Z-ADD*ZERO     #1CCYC           Collateral Curr
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DCCCF    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0079  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0080 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0081  10       ZALIGN No Of De
     C                     PARM 3         WQ0082  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0083 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUERCD           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUERCD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0084 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0085  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * CASE: WRK.Err Code is Error Found
     C           WUERCD    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DCCCF    ZA0075           collateral ccy
      * Send message 'Collateral CCy numeric'
     C                     MOVEL'USR0950' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,39           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Zalign Collateral CCY - Securities Trading Data  *
     C*
     C*
     C                     MOVE WUZASF    #DCCCF
     C*
     C*
     C                     MOVE WUZAFF    #1CCYC           Collateral Curr
      * CASE: 3RD.Collateral Currency Convt is Valid Value
     C           #1CCYC    IFGE 1                          *IF
     C           #1CCYC    ANDLE100
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DCCCF    ZA0076           collateral ccy
      * Send message 'Collateral CCY Conv range'
     C                     MOVEL'USR0953' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,39           *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Foreign Exchange Risk
      * CASE: 3RD.Foreign Exchange Risk fun is Blank
     C           #DFERF    IFEQ *BLANK                     *IF
      * Start of Fix E20535
      * If the function field is blank default to 100 and redisplay the
      * screen.
     C                     Z-ADD100       #1FERK           Foreign Exchang
     C                     MOVEL'100'     #DFERF           Foreign Exchang
     C                     MOVEL'Y'       W0DCF            *Defer confirm
      * End of Fix E20535
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DFERF    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0086  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0087 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0088  10       ZALIGN No Of De
     C                     PARM 3         WQ0089  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0090 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUERCD           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUERCD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0091 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0092  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * CASE: WRK.Err Code is Error Found
     C           WUERCD    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DFERF    ZA0077           Foreign Exchang
      * Send message 'Foreign Exchange numeric'
     C                     MOVEL'USR0955' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,41           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Zalign Foreign Exchange - Securities Trading Data  *
     C*
     C*
     C                     MOVE WUZASF    #DFERF
     C*
     C*
     C                     MOVE WUZAFF    #1FERK           Foreign Exchang
      * CASE: 3RD.Foreign Exchange Risk is Valid Value
     C           #1FERK    IFGE 1                          *IF
     C           #1FERK    ANDLE100
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DFERF    ZA0078           Foreign Exchang
      * Send message 'Foreign Exchange range'
     C                     MOVEL'USR0956' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,41           *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * All Holdings Limit Factor
      * CASE: 3RD.All Holdings limit Func. is Blank
     C           #DAHLM    IFEQ *BLANK                     *IF
     C                     Z-ADD*ZERO     #1AHLF           All Holdings Li
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DAHLM    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0093  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0094 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0095  10       ZALIGN No Of De
     C                     PARM 3         WQ0096  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0097 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUERCD           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUERCD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0098 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0099  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * CASE: WRK.Err Code is Error Found
     C           WUERCD    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DAHLM    ZA0079           All Holdings Li
      * Send message 'All Holdings numeric'
     C                     MOVEL'USR0958' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,42           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Zalign All Holdings - Securities Trading Data  *
     C*
     C*
     C                     MOVE WUZASF    #DAHLM
     C*
     C*
     C                     MOVE WUZAFF    #1AHLF           All Holdings Li
      * CASE: 3RD.All Holdings Limit Factor is valid value
     C           #1AHLF    IFGE 1                          *IF
     C           #1AHLF    ANDLE100
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DAHLM    ZA0080           All Holdings Li
      * Send message 'All Holdings range'
     C                     MOVEL'USR0959' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,42           *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Discretionary Limit Factor
      * CASE: 3RD.Discretionary Limit func is Blank
     C           #DDLFF    IFEQ *BLANK                     *IF
     C                     Z-ADD*ZERO     #1DLF            Discretionary L
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DDLFF    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0100  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0101 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0102  10       ZALIGN No Of De
     C                     PARM 3         WQ0103  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0104 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUERCD           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUERCD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0105 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0106  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * CASE: WRK.Err Code is Error Found
     C           WUERCD    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DDLFF    ZA0081           Discretionary L
      * Send message 'Discretionary Lmt numeric'
     C                     MOVEL'USR0961' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,43           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Zalign Discretionary Lmt - Securities Trading Data  *
     C*
     C*
     C                     MOVE WUZASF    #DDLFF
     C*
     C*
     C                     MOVE WUZAFF    #1DLF            Discretionary L
      * CASE: 3RD.Discretionary Limit Fact. is valid value
     C           #1DLF     IFGE 1                          *IF
     C           #1DLF     ANDLE100
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DDLFF    ZA0082           Discretionary L
      * Send message 'Discretionary Lmt range'
     C                     MOVEL'USR0962' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,43           *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Customers Limit Factor
      * CASE: 3RD.Customers Limit Fact. fun is Blank
     C           #DCLFF    IFEQ *BLANK                     *IF
     C                     Z-ADD*ZERO     #1CLF            Customers Limit
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DCLFF    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0107  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0108 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0109  10       ZALIGN No Of De
     C                     PARM 3         WQ0110  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0111 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUERCD           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUERCD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0112 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0113  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * CASE: WRK.Err Code is Error Found
     C           WUERCD    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DCLFF    ZA0083           Customers Limit
      * Send message 'Customers Limit numeric'
     C                     MOVEL'USR0964' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,44           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Zalign Customers Limit - Securities Trading Data  *
     C*
     C*
     C                     MOVE WUZASF    #DCLFF
     C*
     C*
     C                     MOVE WUZAFF    #1CLF            Customers Limit
      * CASE: 3RD.Customers Limit Factor is valid value
     C           #1CLF     IFGE 1                          *IF
     C           #1CLF     ANDLE100
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DCLFF    ZA0084           Customers Limit
      * Send message 'Customers Limit range'
     C                     MOVEL'USR0965' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,44           *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Realised Profit Basis
      * CASE: 3RD.Realised Profit Basis is blank
     C           #1RPB     IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1RPB     ZA0085           Realised Profit
      * Send message 'Realised Profit Basis req'
     C                     MOVEL'USR1038' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,45           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: 3RD.Realised Profit Basis is valid value
     C           #1RPB     IFEQ 'B'                        *IF
     C           #1RPB     OREQ 'T'
     C           #1RPB     OREQ 'V'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1RPB     ZA0086           Realised Profit
      * Send message 'Invalid Realised Profit'
     C                     MOVEL'USR1039' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,45           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Unrealised Profit Basis
      * CASE: 3RD.Unrealised Profit Basis is blank
     C           #1UPB     IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1UPB     ZA0087           Unrealised Prof
      * Send message 'Unreal. Profit Basis Reqd'
     C                     MOVEL'USR1165' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,46           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: 3RD.Unrealised Profit Basis is valid value
     C           #1UPB     IFEQ 'B'                        *IF
     C           #1UPB     OREQ 'T'
     C           #1UPB     OREQ 'V'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1UPB     ZA0088           Unrealised Prof
      * Send message 'Invalid Unrealised profit'
     C                     MOVEL'USR1041' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,46           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Unrealised Profit Posting
      * CASE: 3RD.Unrealised Profit Posting is blank
     C           #1UPP     IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1UPP     ZA0089           Unrealised Prof
      * Send message 'Unrealised Proft Post req'
     C                     MOVEL'USR1042' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,47           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: 3RD.Unrealised Profit Posting is valid values
     C           #1UPP     IFEQ 'B'                        *IF
     C           #1UPP     OREQ 'L'
     C           #1UPP     OREQ 'P'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1UPP     ZA0090           Unrealised Prof
      * Send message 'Invalid Unrealised Pr pos'
     C                     MOVEL'USR1043' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,47           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Adjust Unrealised Profit
      * CASE: 3RD.Adjust Unrealise Profit is blank
     C           #1AUP     IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1AUP     ZA0091           Adjust Unrealis
      * Send message 'Adjust Unrealised req'
     C                     MOVEL'USR1044' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,48           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: 3RD.Adjust Unrealise Profit is valid values
     C           #1AUP     IFEQ 'N'                        *IF
     C           #1AUP     OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1AUP     ZA0092           Adjust Unrealis
      * Send message 'Invalid Adjust Unrelise'
     C                     MOVEL'USR1045' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,48           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Summarise Daily Trades
      * CASE: 3RD.Summarise Daily Trades is blank
     C           #1SDTR    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1SDTR    ZA0093           Summarise Daily
      * Send message 'Summarise Daily Trade req'
     C                     MOVEL'USR1046' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,49           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: 3RD.Summarise Daily Trades is valid values
     C           #1SDTR    IFEQ 'N'                        *IF
     C           #1SDTR    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1SDTR    ZA0094           Summarise Daily
      * Send message 'Invalid Summarise Trade'
     C                     MOVEL'USR1047' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,49           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * 00/Copy member SD9211RCP1 - Securities Trading Data  *
     C/COPY WNCPYSRC,SD9211RCP1
      * FIFO Accounting
      * CASE: 3RD.FIFO Accounting is blank
     C           #1FIFO    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1FIFO    ZA0095           FIFO Accounting
      * Send message 'FIFO Accounting required'
     C                     MOVEL'USR1048' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,50           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: 3RD.FIFO Accounting is valid values
     C           #1FIFO    IFEQ 'N'                        *IF
     C           #1FIFO    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1FIFO    ZA0096           FIFO Accounting
      * Send message 'invalid FIFO Accounting'
     C                     MOVEL'USR1049' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,50           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * 00/Copy member SD9211RCP2 - Securities Trading Data  *
     C/COPY WNCPYSRC,SD9211RCP2
      * Split Purchased Interest
      * CASE: 3RD.Split Purchased Interest is blank
     C           #1SPIN    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1SPIN    ZA0097           Split Purchased
      * Send message 'Split Purchased Int req'
     C                     MOVEL'USR1050' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,51           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: 3RD.Split Purchased Interest is valid values
     C           #1SPIN    IFEQ 'N'                        *IF
     C           #1SPIN    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1SPIN    ZA0098           Split Purchased
      * Send message 'Invalid Split purchased'
     C                     MOVEL'USR1051' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,51           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Split Negative Accruals
      * CASE: 3RD.Split Negative Interest is blank
     C           #1SNIN    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1SNIN    ZA0099           Split Negative
      * Send message 'Split Negative required'
     C                     MOVEL'USR1052' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,52           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: 3RD.Split Negative Interest is valid values
     C           #1SNIN    IFEQ 'N'                        *IF
     C           #1SNIN    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1SNIN    ZA0100           Split Negative
      * Send message 'Invalid Split Negative'
     C                     MOVEL'USR1053' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,52           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Trade Subtypes on A/C Keys
      * CASE: 3RD.Trade Subtypes in A/c key is blank
     C           #1TSAK    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1TSAK    ZA0101           Trade Subtypes
      * Send message 'Trade Subtypes required'
     C                     MOVEL'USR1054' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,53           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: 3RD.Trade Subtypes in A/c key is valid values
     C           #1TSAK    IFEQ 'N'                        *IF
     C           #1TSAK    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1TSAK    ZA0102           Trade Subtypes
      * Send message 'invalid Trade subtypes'
     C                     MOVEL'USR1055' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,53           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Convertible on A/C Key
      * CASE: 3RD.Convertible Indicator A/k is blank
     C           #1CIAK    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1CIAK    ZA0103           Convertible Ind
      * Send message 'Convertible on A/C req'
     C                     MOVEL'USR1056' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,54           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: 3RD.Convertible Indicator A/k is valid values
     C           #1CIAK    IFEQ 'N'                        *IF
     C           #1CIAK    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1CIAK    ZA0104           Convertible Ind
      * Send message 'Invalid Convertible'
     C                     MOVEL'USR1057' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,54           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Negative Position on A/C Key
      * CASE: 3RD.Negative position on A/K is blank
     C           #1NPAC    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1NPAC    ZA0105           Negative positi
      * Send message 'Negative Position req'
     C                     MOVEL'USR1058' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,55           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: 3RD.Negative position on A/K is valid values
     C           #1NPAC    IFEQ 'N'                        *IF
     C           #1NPAC    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1NPAC    ZA0106           Negative positi
      * Send message 'Invalid Negative Position'
     C                     MOVEL'USR1059' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,55           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Generate Discount Premium Keys for non-Amortising Books
      * CASE: 3RD.General Disc/Prem Keys is blank
     C           #1GDPK    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1GDPK    ZA0107           General Disc/Pr
      * Send message 'Generate D/P req.'
     C                     MOVEL'USR1068' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,56           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: 3RD.General Disc/Prem Keys is valid values
     C           #1GDPK    IFEQ 'N'                        *IF
     C           #1GDPK    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1GDPK    ZA0108           General Disc/Pr
      * Send message 'Invalid Generate D/P .'
     C                     MOVEL'USR1069' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,56           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Start of 046900
      * Suppress Keys on T/V Date
      * CASE: 3RD.Suppress keys on Trade/vl is blank
     C           #1SKTV    IFEQ *BLANK                     *IF
      * Error message has been removed for SC 046900 to allow blank.
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: 3RD.Suppress keys on Trade/vl is Trade or Value
     C           #1SKTV    IFEQ 'T'                        *IF
     C           #1SKTV    OREQ 'V'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1SKTV    ZA0109           Suppress keys o
      * Send message 'Invalid Supress on T/V'
     C                     MOVEL'USR1071' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,57           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * End of 046900
      * Post no Standard Depot Movements
      * CASE: 3RD.Post no Stnd Depot Mvmts is blank
     C           #1PSDM    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1PSDM    ZA0110           Post no Stnd De
      * Send message 'Post no Std Depot req'
     C                     MOVEL'USR1072' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,58           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: 3RD.Post no Stnd Depot Mvmts is valid values
     C           #1PSDM    IFEQ 'N'                        *IF
     C           #1PSDM    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1PSDM    ZA0111           Post no Stnd De
      * Send message 'Invalid Post no std depot'
     C                     MOVEL'USR1073' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,58           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Redemptions on Security Descriptions
      * CASE: 3RD.Redemptions on Sec Desc. is blank
     C           #1ROSD    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1ROSD    ZA0112           Redemptions on
      * Send message 'Redemptions on sec req'
     C                     MOVEL'USR1074' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,59           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: 3RD.Redemptions on Sec Desc. is valid values
     C           #1ROSD    IFEQ 'N'                        *IF
     C           #1ROSD    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1ROSD    ZA0113           Redemptions on
      * Send message 'Invalid Redemptions'
     C                     MOVEL'USR1075' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,59           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Cross Currency Entries
      * CASE: 3RD.Cross Currency Entries is blank
     C           #1CCYE    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1CCYE    ZA0114           Cross Currency
      * Send message 'Cross Currency Ent req'
     C                     MOVEL'USR1076' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,60           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: 3RD.Cross Currency Entries is valid values
     C           #1CCYE    IFEQ 'B'                        *IF
     C           #1CCYE    OREQ 'T'
     C           #1CCYE    OREQ 'V'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1CCYE    ZA0115           Cross Currency
      * Send message 'Invalid Cross Currency'
     C                     MOVEL'USR1077' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,60           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Autopost Position Settlement
      * CASE: 3RD.Autopost Position Settle is blank
     C           #1APST    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1APST    ZA0116           Autopost Positi
      * Send message 'Autopost Position req'
     C                     MOVEL'USR1078' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,61           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: 3RD.Autopost Position Settle is valid values
     C           #1APST    IFEQ 'N'                        *IF
     C           #1APST    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1APST    ZA0117           Autopost Positi
      * Send message 'Invalid Autopost position'
     C                     MOVEL'USR1079' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,61           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Mark to Market Frequency: Base Day and Next Date.
      * CASE: 3RD.Mark to Market Frequency is equal blank
     C           #1MMFQ    IFEQ *BLANK                     *IF
      *                                                                                       237753
      ** Move zero into next date                                                             237753
      *                                                                                       237753
     C                     Z-ADD0         #1MMND                                              237753
      *                                                                                       237753
      * Frequency Base Day
      * CASE: 3RD.Mark to Market BD Func is entered
     C           #DMBFF    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DMBFF    ZA0118           Mark to Market
      * Send message 'Base Date not required'
     C                     MOVEL'USR0987' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,63           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     #1MMBD           Mark to Market
     C                     END                             *FI
      * Frequency Next Date
      * CASE: 3RD.Mark to Market Next func is Entered
     C           #DMNXF    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DMNXF    ZA0119           Mark to Market
      * Send message 'mark to mkt not allowed'
     C                     MOVEL'USR0356' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,64           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * 099343 - Remove default of 0 into the Next Date field
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: 3RD.Mark to Market Frequency is Mark to Market Frequency
     C           #1MMFQ    IFEQ 'T'                        *IF
     C           #1MMFQ    OREQ 'D'
     C           #1MMFQ    OREQ 'F'
     C           #1MMFQ    OREQ 'L'
     C           #1MMFQ    OREQ 'B'
     C           #1MMFQ    OREQ 'M'
     C           #1MMFQ    OREQ 'Q'
     C           #1MMFQ    OREQ 'S'
     C           #1MMFQ    OREQ 'X'
     C           #1MMFQ    OREQ 'W'
     C           #1MMFQ    OREQ 'Y'
     C           #1MMFQ    OREQ 'R'
      * Mark to Market Base Day
      * CASE: 3RD.Mark to Market Frequency is L,M,Q,R,S,T,X,Y
     C           #1MMFQ    IFEQ 'T'                        *IF
     C           #1MMFQ    OREQ 'L'
     C           #1MMFQ    OREQ 'M'
     C           #1MMFQ    OREQ 'Q'
     C           #1MMFQ    OREQ 'S'
     C           #1MMFQ    OREQ 'X'
     C           #1MMFQ    OREQ 'Y'
     C           #1MMFQ    OREQ 'R'
      * Mark to Mrket Base Day
      * CASE: 3RD.Mark to Market BD Func is entered
     C           #DMBFF    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DMBFF    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0114  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0115 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0116  10       ZALIGN No Of De
     C                     PARM 3         WQ0117  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0118 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUERCD           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUERCD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0119 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0120  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * CASE: WRK.Err Code is Error Found
     C           WUERCD    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DMBFF    ZA0120           Mark to Market
      * Send message 'Base Day must be numeric'
     C                     MOVEL'USR0978' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,63           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Zalign Mark to Market day - Securities Trading Data  *
     C*
     C*
     C                     MOVE WUZASF    #DMBFF
     C*
     C*
     C                     MOVE WUZAFF    #1MMBD           Mark to Market
      * CASE: 3RD.Mark to Market Base Date is valid value
     C           #1MMBD    IFGE 1                          *IF
     C           #1MMBD    ANDLE31
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DMBFF    ZA0121           Mark to Market
      * Send message 'Base Day range'
     C                     MOVEL'USR0979' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,63           *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DMBFF    ZA0122           Mark to Market
      * Send message 'Mark to Market is req.'
     C                     MOVEL'USR0977' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,63           *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: 3RD.Mark to Market BD Func is entered
     C           #DMBFF    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DMBFF    ZA0123           Mark to Market
      * Send message 'Not allowed for this Freq'
     C                     MOVEL'USR0348' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,63           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     #1MMBD           Mark to Market
     C                     END                             *FI
     C                     END                             *FI
      * Mark to Market Next Date
      * CASE: 3RD.Mark to Market Next func is Entered
     C           #DMNXF    IFNE *BLANK                     *IF
     C                     MOVE #DMNXF    WUWSDT           Work Screen Dat
      * Check Screen Date - Rundate  *
     C                     CALL 'ZDATE1'               90  Check Screen Da
     C           W0RTN     PARM W0RTN     WQ0121  7        *Return code
     C           WUWSDT    PARM WUWSDT    WQ0122  60       Work Screen Dat
     C           WUDFF     PARM WUDFF     WQ0123  1        Date format fla
     C           WUWFDT    PARM *ZERO     WQ0124  50       Work File Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZDATE1'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
      * Setup message data for message
     C                     MOVEL#DMNXF    ZA0124           Mark to Market
      * Send message 'Invalid Next Date'
     C                     MOVEL'USR0981' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,64           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWUWFDT    #1MMND           Mark to Market
      * Start of E38886   allow Next date to be today.
      * CASE: 3RD.Mark to Market Next Date LT WRK.Run day number
     C           #1MMND    IFLT WURDNB                     *IF
      * Setup message data for message
     C                     MOVEL#DMNXF    ZA0125           Mark to Market
      * Send message 'Next Date not in the past'
     C                     MOVEL'USR0982' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,64           *
      *
     C                     END                             *FI
      * End of E38886
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DMNXF    ZA0126           Mark to Market
      * Send message 'Next Date is required'
     C                     MOVEL'USR0984' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,64           *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1MMFQ    ZA0127           Mark to Market
      * Send message 'Invalid Mark to Mket freq'
     C                     MOVEL'USR1080' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,62           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Trading Confirmation Type
      * CASE: 3RD.Trading Confirmation Type is blank
     C           #1TCTY    IFEQ *BLANK                     *IF
     C                     MOVEL'A'       #1TCTY           Trading Confirm
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: 3RD.Trading Confirmation Type is valid values
     C           #1TCTY    IFEQ 'B'                        *IF
     C           #1TCTY    OREQ 'C'
     C           #1TCTY    OREQ 'D'
     C           #1TCTY    OREQ 'A'
     C           #1TCTY    OREQ 'E'
     C           #1TCTY    OREQ 'F'
     C           #1TCTY    OREQ 'G'
     C           #1TCTY    OREQ 'H'
     C           #1TCTY    OREQ 'I'
     C           #1TCTY    OREQ 'J'
     C           #1TCTY    OREQ 'K'
     C           #1TCTY    OREQ 'L'
     C           #1TCTY    OREQ 'M'
     C           #1TCTY    OREQ 'N'
     C           #1TCTY    OREQ 'O'
     C           #1TCTY    OREQ 'P'
     C           #1TCTY    OREQ 'Q'
     C           #1TCTY    OREQ 'R'
     C           #1TCTY    OREQ 'S'
     C           #1TCTY    OREQ 'T'
     C           #1TCTY    OREQ 'U'
     C           #1TCTY    OREQ 'V'
     C           #1TCTY    OREQ 'W'
     C           #1TCTY    OREQ 'X'
     C           #1TCTY    OREQ 'Y'
     C           #1TCTY    OREQ 'Z'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1TCTY    ZA0128           Trading Confirm
      * Send message 'Invalid Trade Confirmatn'
     C                     MOVEL'USR1094' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,67           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Trade & Book Position Reconcilable
      * CASE: 3RD.Trade & Book Posn Recble is Blank
     C           #1TBRC    IFEQ *BLANK                     *IF
     C                     MOVEL'N'       #1TBRC           Trade & Book Po
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: 3RD.Trade & Book Posn Recble is Valid Values
     C           #1TBRC    IFEQ 'N'                        *IF
     C           #1TBRC    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1TBRC    ZA0129           Trade & Book Po
      * Send message 'Trade & Book Posn Rec.'
     C                     MOVEL'USR0919' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,68           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Start of fix E18116
      * Check Brokerage code if it is not blank
      * CASE: DTL.Default brokerage code is Not Blank
     C           #1DBCD    IFNE *BLANK                     *IF
      * Validate Default Broker - Securities Trading Data  *
     C*
     C                     MOVE *IN,70    UUIND   1
     C                     MOVE 'N'       WUDBII
     C*
     C* Check if UUDBC1 is in the range A-Z or 0-9. If not, set up
     C* work field to send error message.
     C*
     C           UUDBC1    LOKUPARRB                     70
     C           *IN70     IFEQ '0'
     C                     MOVE 'Y'       WUDBII
     C*
     C* Check if UUDBC2 is in the range A-Z or 0-9. If not, set up
     C* work field to send error message.
     C*
     C                     ELSE
     C           UUDBC2    LOKUPARRB                     70
     C           *IN70     IFEQ '0'
     C                     MOVE 'Y'       WUDBII
     C                     END
     C                     END
     C*
     C                     MOVE UUIND     *IN,70
      * CASE: WRK.Dft Broker invalid indic. is Yes
     C           WUDBII    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1DBCD    ZA0130           Default brokera
      * Send message 'Dflt Broker not rng AA-99'
     C                     MOVEL'USR1168' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,54           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * End of fix E18116
      * Start of 062031
      * Moved the validation for 'Default Brokerage' & 'Agency Book'
      * so that 'Bulk input' and all other fields related to it are
      * validated together.
      * End of 062031
      * Start of fix E19793
      * Ensure that Settlement Discrepancy Over field is not blank
      * CASE: 3RD.Setl Discrepancy Over Fun is Blank
     C           #DSDOF    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DSDOF    ZA0131           Setl Discrepanc
      * Send message 'Setlment Discrep'cy blank'
     C                     MOVEL'USR0785' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,65           *
      *
     C                     END                             *FI
      * Ensure that Settlement Discrepancy Under field is not blank
      * CASE: 3RD.Setl Discrepancy Undr Fun is Blank
     C           #DSDUF    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DSDUF    ZA0132           Setl Discrepanc
      * Send message 'Setlment Discrep'cy blank'
     C                     MOVEL'USR0785' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,66           *
      *
     C                     END                             *FI
     C           12        SUB  WUNBDP    WUZADG           ZALIGN No Of Di
     C                     Z-ADDWUNBDP    WUZAND           ZALIGN No Of De
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DSDOF    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0125  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0126 16        ZALIGN Screen F
     C                     PARM WUZAND    WQ0127  10       ZALIGN No Of De
     C                     PARM WUZADG    WQ0128  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0129 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUERCD           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUERCD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0130 16        ZALIGN Screen F
     C                     PARM WUZAND    WQ0131  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * Check Settlement Discrepancy Over field is numeric and correct no
      * CASE: WRK.Err Code is Error Found
     C           WUERCD    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DSDOF    ZA0133           Setl Discrepanc
      * Send message 'Setl Disc'pcy not numeric'
     C                     MOVEL'USR0786' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,65           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUZAFF    #1SDOV           Settlement Desc
     C                     END                             *FI
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DSDUF    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0132  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0133 16        ZALIGN Screen F
     C                     PARM WUZAND    WQ0134  10       ZALIGN No Of De
     C                     PARM WUZADG    WQ0135  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0136 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUERCD           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUERCD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0137 16        ZALIGN Screen F
     C                     PARM WUZAND    WQ0138  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * Check Settlement Discrepancy field under is numeric and correct n
      * CASE: WRK.Err Code is Error Found
     C           WUERCD    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DSDUF    ZA0134           Setl Discrepanc
      * Send message 'Setl Disc'pcy not numeric'
     C                     MOVEL'USR0786' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,66           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUZAFF    #1SDUN           Settlement Desc
     C                     END                             *FI
      * End of fix E19793
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy member SD9211RVSF - Securities Trading Data  * S01212
     C*
     C/COPY WNCPYSRC,SD9211RVSF
     C*
     C                     END                             *FI
      * Check relations
      * Check reference to Deal Sub-types
     C                     EXSR VACKRL
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,46
     C                     SETON                     99    *
     C                     END
      * Check reference to Deal Sub-types
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,47
     C                     SETON                     99    *
     C                     END
      * Check reference to Deal Sub-types
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,48
     C                     SETON                     99    *
     C                     END
      * Check reference to Currency Codes
     C                     EXSR VDCKRL
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,36
     C                     SETON                     99    *
     C                     END
      * Check reference to Currency Codes
     C                     EXSR VECKRL
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,38
     C                     SETON                     99    *
     C                     END
      * Check reference to Currency Codes
     C                     EXSR VFCKRL
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,37
     C                     SETON                     99    *
     C                     END
      * Check reference to Currency Codes
     C                     EXSR VGCKRL
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,39
     C                     SETON                     99    *
     C                     END
      * Check reference to Currency Codes
     C                     EXSR VHCKRL
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,35
     C                     SETON                     99    *
     C                     END
      * Check reference to Client Details
     C                     EXSR VICKRL
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     99    *
     C                     END
      * Check reference to Client Details
     C                     EXSR VJCKRL
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     99    *
     C                     END
      * Check reference to Client Details
     C                     EXSR VKCKRL
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     99    *
     C                     END
      * Check reference to Client Details
     C                     EXSR VLCKRL
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     99    *
     C                     END
      * Check reference to Client Details
     C                     EXSR VMCKRL
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     99    *
     C                     END
      * Check reference to Client Details
     C                     EXSR VNCKRL
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     99    *
     C                     END
      * Check reference to Client Details
     C                     EXSR VOCKRL
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     99    *
     C                     END
      * Check reference to Client Details
     C                     EXSR VPCKRL
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     99    *
     C                     END
      * Check reference to Client Details
     C                     EXSR VQCKRL
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     99    *
     C                     END
      * Check reference to Client Details
     C                     EXSR VRCKRL
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     99    *
     C                     END
      * Check reference to Book Details
     C                     EXSR VSCKRL
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,55
     C                     SETON                     99    *
     C                     END
      * Check reference to Book Details
     C                     EXSR VTCKRL
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,44
     C                     SETON                     99    *
     C                     END
      * Check reference to Book Details
     C                     EXSR VUCKRL
     C           W0RTN     IFNE *BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,45
     C                     SETON                     99    *
     C                     END
      * CALC: Detail screen function fields
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy member SD9211RSFF - Securities Trading Data  * S01212
     C*
     C/COPY WNCPYSRC,SD9211RSFF
     C*
     C                     END                             *FI
      * USER: Validate detail screen relations
      * Euclid Dependencies
      * CASE: DTL.Euclid is Yes
     C           #1EUCD    IFEQ 'Y'                        *IF
      * Entries Mandatory
      * Euroclear Currency Code
      * CASE: DTL.Euroclear Currency Code is not blank
     C           #1EUCY    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1EUCY    ZA0135           Euroclear Curre
      * Send message 'Currency Code Required'
     C                     MOVEL'USR0233' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,35           *
      *
     C                     END                             *FI
      * Euroclear Deutsch Mark
      * CASE: DTL.E/C Deutsch Mark Equival. is not blank
     C           #1ECDM    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1ECDM    ZA0136           E/C Deutsch Mar
      * Send message 'Currency Code Required'
     C                     MOVEL'USR0233' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,37           *
      *
     C                     END                             *FI
      * Euroclear Belgian Franc
      * CASE: DTL.E/C Belgian Franc equiv. is not blank
     C           #1ECBF    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1ECBF    ZA0137           E/C Belgian Fra
      * Send message 'Currency Code Required'
     C                     MOVEL'USR0233' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,38           *
      *
     C                     END                             *FI
      * Euroclear Japanese Yen
      * CASE: DTL.E/C Japanese Yen Equival. is not blank
     C           #1ECJY    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1ECJY    ZA0138           E/C Japanese Ye
      * Send message 'Currency Code Required'
     C                     MOVEL'USR0233' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,39           *
      *
     C                     END                             *FI
      * Auto-transmission
      * CASE: DTL.Auto-transmission interfc is blank
     C           #1ATI     IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1ATI     ZA0139           Auto-transmissi
      * Send message 'Auto-transmission req.'
     C                     MOVEL'USR0988' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,41           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.Auto-transmission interfc is Valid Entries
     C           #1ATI     IFEQ '3'                        *IF
     C           #1ATI     OREQ '2'
     C           #1ATI     OREQ '1'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1ATI     ZA0140           Auto-transmissi
      * Send message 'Invalid Auto-transmission'
     C                     MOVEL'USR0989' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,41           *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Entries Forbidden
      * Start of fix E19199
      * This fix was to remove some validation that had been incorrectly
      * End of fix E19199
      * Auto-Transmission Interface
      * CASE: DTL.Auto-transmission interfc is blank
     C           #1ATI     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1ATI     ZA0141           Auto-transmissi
      * Send message 'Auto-transmission not req'
     C                     MOVEL'USR0990' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,41           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Depot Reference 1 - Euroclear: select
      * CASE: 2ND.Depot 1 is blank
     C           #DDP01    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    #DDP01           Depot 1
      * Setup message data for message
     C                     MOVEL#DDP01    ZA0142           Depot 1
      * Send message 'Depot Reference Mandatory'
     C                     MOVEL'USR0351' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,31           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#DDP01    WUCAKY           Check For Aster
      * CASE: WRK.Check For Asterisk in Key is Question Mark
     C           WUCAKY    IFEQ '?'                        *IF
      * Select Sec Client Dsp - Securities Clients  *
     C                     CLEARPDRC
     C                     CALL 'SD0342D'              90  Select Sec Clie
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             KEY: Securities
     C           WUCSSN    PARM *BLANK    WQ0160 10        Customer Shortn
     C                     PARM *BLANK    WQ0161 10        Customer Report
     C                     PARM *BLANK    WQ0162 20        Customer Report
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0342D' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     MOVELPDCUST    WUCUST           Customer Number
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Customer Shortname is blank
     C           WUCSSN    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DDP01    ZA0143           Depot 1
      * Send message 'No value selected'
     C                     MOVEL'USR0944' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,31           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWUCUST    #1DR1            Depot 1 (EUROCL
     C                     MOVELWUCSSN    #DDP01           Depot 1
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Depot Reference 1 - Euroclear: Validate
      * CASE: 2ND.Depot 1 is Not blank
     C           #DDP01    IFNE *BLANK                     *IF
      * Start of 061345
      * Use DTL.Deport 1 (EUROCLEAR) as output parameter and
      * not WRK.Customer number
      * Retrieve from shortname - Client Details  *
     C                     EXSR SERVGN
      * End of 061345
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#DDP01    WUCUST           Customer Number
     C                     EXSR UESUBR
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Start of 061345
      * Use DTL. Depot 1 (EUROCLEAR) for the customer number, not
      * DTL.Depot 1
     C                     MOVELWUCUST    #1DR1            Depot 1 (EUROCL
      * End of 061345
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DDP01    ZA0144           Depot 1
      * Send message 'Invalid Customer no/sname'
     C                     MOVEL'USR0352' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,31           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Retrieve for E18502 - Securities Clients  *
     C                     EXSR SGRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#DDP01    ZA0145           Depot 1
      * Send message 'Cust is not a Sec Client'
     C                     MOVEL'USR0539' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,31           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.Classification is Euroclear
     C           WUCLAS    IFEQ 'E'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DDP01    ZA0146           Depot 1
      * Send message 'Cust not Classified'
     C                     MOVEL'USR0540' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,31           *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Depot Reference 2 - Cedel: Select
      * CASE: 2ND.Depot 2 is blank
     C           #DDP02    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    #1DR2            Depot Reference
      * Setup message data for message
     C                     MOVEL#DDP02    ZA0147           Depot 2
      * Send message 'Depot Reference Mandatory'
     C                     MOVEL'USR0351' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,33           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#DDP02    WUCAKY           Check For Aster
      * CASE: WRK.Check For Asterisk in Key is Question Mark
     C           WUCAKY    IFEQ '?'                        *IF
      * Select Sec Client Dsp - Securities Clients  *
     C                     CLEARPDRC
     C                     CALL 'SD0342D'              90  Select Sec Clie
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             KEY: Securities
     C           WUCSSN    PARM *BLANK    WQ0163 10        Customer Shortn
     C                     PARM *BLANK    WQ0164 10        Customer Report
     C                     PARM *BLANK    WQ0165 20        Customer Report
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0342D' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     MOVELPDCUST    WUCUST           Customer Number
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Customer Shortname is blank
     C           WUCSSN    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DDP02    ZA0148           Depot 2
      * Send message 'No value selected'
     C                     MOVEL'USR0944' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,33           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWUCUST    #1DR2            Depot Reference
     C                     MOVELWUCSSN    #DDP02           Depot 2
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Depot Reference 2 - Cedel: Validate
      * CASE: 2ND.Depot 2 is Not blank
     C           #DDP02    IFNE *BLANK                     *IF
      * Retrieve from shortname - Client Details  *
     C                     EXSR SHRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Start of S01117
      * Removal of test for duplicate depots
      * End of S01117
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#DDP02    WUCUST           Customer Number
     C                     EXSR UFSUBR
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVELWUCUST    #1DR2            Depot Reference
      * Start of S01117
      * Removal of test for duplicate depots
      * End of S01117
     C                     ELSE
      * CASE: *OTHERWISE
      * Start of fix E20422
      * Setup message data for message
     C                     MOVEL#DDP02    ZA0149           Depot 2
      * Send message 'Invalid Customer no/sname'
     C                     MOVEL'USR0352' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,33           *
      *
      * End of fix E20422
     C                     END                             *FI
     C                     END                             *FI
      * Retrieve for E18502 - Securities Clients  *
     C                     EXSR SJRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#DDP02    ZA0150           Depot 2
      * Send message 'Cust is not a Sec Client'
     C                     MOVEL'USR0539' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,33           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.Classification is Cedel
     C           WUCLAS    IFEQ 'C'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DDP02    ZA0151           Depot 2
      * Send message 'Cust not Classified'
     C                     MOVEL'USR0540' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,33           *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      **********                                                          CSE022
      **Depot*Reference*3*-*Kasserverein:*Select***********************   CSE022
      **CASE:*2ND.Depot*3*is*blank*************************************   CSE022
     C********** #DDP03    IFEQ *BLANK                     *IF            CSE022
     C**********           MOVEL*BLANK    #1DR3            Depot Ref 3,Ka CSE022
      **Setup*message*data*for*message*********************************   CSE022
     C**********           MOVEL#DDP03    ZA0152           Depot 3        CSE022
      **Send*message*'Depot*Reference*Mandatory'***********************   CSE022
     C**********           MOVEL'USR0351' ZAMSID                          CSE022
     C**********           EXSR ZASNMS                                    CSE022
     C**********           SETON                     99    *              CSE022
     C**********           MOVEL'1'       @I2,35           *              CSE022
      **********                                                          CSE022
     C**********           ELSE                                           CSE022
      **CASE:**OTHERWISE***********************************************   CSE022
     C**********           MOVEL#DDP03    WUCAKY           Check ForAster CSE022
      **CASE:*WRK.Check*For*Asterisk*in*Key*is*Question*Mark***********   CSE022
     C********** WUCAKY    IFEQ '?'                        *IF            CSE022
      **Select*Sec*Client*Dsp*-*Securities*Clients*** *****************   CSE022
     C**********           CLEARPDRC                                      CSE022
     C**********           CALL 'SD0342D'              90  Select SecClie CSE022
     C**********           PARM *BLANK    W0RTN   7                       CSE022
     C**********           PARM           PDRC             KEY:Securities CSE022
     C********** WUCSSN    PARM *BLANK    WQ0166 10        CustomerShortn CSE022
     C**********           PARM *BLANK    WQ0167 10        CustomerReport CSE022
     C**********           PARM *BLANK    WQ0168 20        CustomerReport CSE022
      **********                                                          CSE022
     C********** *IN90     IFEQ '1'                                       CSE022
      **Call*to*program*ended*in*error*********************************   CSE022
     C**********           MOVEL'Y2U0032' W0RTN                           CSE022
     C**********           MOVEL*BLANKS   W0CLPG 10                       CSE022
     C**********           MOVEL'SD0342D' W0CLPG                          CSE022
      **Send*message*'*Error*occured*on*CALL...'***********************   CSE022
     C**********           MOVEL'Y2U0032' ZAMSID                          CSE022
     C**********           MOVEL'Y2USRMSG'ZAMSGF                          CSE022
     C**********           MOVELW0CLPG    ZAMSDA           Message data   CSE022
     C**********           EXSR ZASNMS                                    CSE022
     C**********           END                                            CSE022
      **********                                                          CSE022
     C**********           MOVELPDCUST    WUCUST           CustomerNumber CSE022
      **********                                                          CSE022
      **Error*detected?************************************************   CSE022
     C********** W0RTN     IFNE *BLANK                                    CSE022
     C**********           SETON                     99    *              CSE022
     C**********           END                                            CSE022
      **CASE:*WRK.Customer*Shortname*is*blank**************************   CSE022
     C********** WUCSSN    IFEQ *BLANK                     *IF            CSE022
      **Setup*message*data*for*message*********************************   CSE022
     C**********           MOVEL#DDP03    ZA0153           Depot 3        CSE022
      **Send*message*'No*value*selected'*******************************   CSE022
     C**********           MOVEL'USR0944' ZAMSID                          CSE022
     C**********           EXSR ZASNMS                                    CSE022
     C**********           SETON                     99    *              CSE022
     C**********           MOVEL'1'       @I2,35           *              CSE022
      **********                                                          CSE022
     C**********           ELSE                                           CSE022
      **CASE:**OTHERWISE***********************************************   CSE022
     C**********           MOVELWUCUST    #1DR3            Depot Ref 3,Ka CSE022
     C**********           MOVELWUCSSN    #DDP03           Depot 3        CSE022
     C**********           MOVEL'Y'       W0DCF            *Defer confirm CSE022
     C**********           END                             *FI            CSE022
     C**********           END                             *FI            CSE022
     C**********           END                             *FI            CSE022
      **Depot*Reference*3*-*Kasserverein:*Validate*********************   CSE022
      **CASE:*2ND.Depot*3*is*Not*blank*********************************   CSE022
     C********** #DDP03    IFNE *BLANK                     *IF            CSE022
      **Retrieve*from*shortname*-*Client*Details*** *******************   CSE022
     C**********           EXSR SKRVGN                                    CSE022
      **CASE:*PGM.*Return*code*is**Normal******************************   CSE022
     C********** W0RTN     IFEQ *BLANK                     *IF            CSE022
      **Start*of*S01117************************************************   CSE022
      **Removal*of*test*for*duplicate*depots***************************   CSE022
      **End*of*S01117**************************************************   CSE022
     C**********           ELSE                                           CSE022
      **CASE:**OTHERWISE***********************************************   CSE022
     C**********           MOVEL#DDP03    WUCUST           CustomerNumber CSE022
     C**********           EXSR UGSUBR                                    CSE022
      **CASE:*PGM.*Return*code*is**Normal******************************   CSE022
     C********** W0RTN     IFEQ *BLANK                     *IF            CSE022
     C**********           MOVELWUCUST    #1DR3            Depot Ref 3,Ka CSE022
      **Start*of*S01117************************************************   CSE022
      **Removal*of*test*for*duplicate*depots***************************   CSE022
      **End*of*S01117**************************************************   CSE022
     C**********           ELSE                                           CSE022
      **CASE:**OTHERWISE***********************************************   CSE022
      **Start*of*fix*E20422********************************************   CSE022
      **Setup*message*data*for*message*********************************   CSE022
     C**********           MOVEL#DDP03    ZA0154           Depot 3        CSE022
      **Send*message*'Invalid*Customer*no/sname'***********************   CSE022
     C**********           MOVEL'USR0352' ZAMSID                          CSE022
     C**********           EXSR ZASNMS                                    CSE022
     C**********           SETON                     99    *              CSE022
     C**********           MOVEL'1'       @I2,35           *              CSE022
      **********                                                          CSE022
      **End*of*fix*E20422**********************************************   CSE022
     C**********           END                             *FI            CSE022
     C**********           END                             *FI            CSE022
      **Retrieve*for*E18502*-*Securities*Clients*** *******************   CSE022
     C**********           EXSR SMRVGN                                    CSE022
      **CASE:*PGM.*Return*code*is**Record*does*not*exist***************   CSE022
     C********** W0RTN     IFEQ 'Y2U0005'                  *IF            CSE022
      **Setup*message*data*for*message*********************************   CSE022
     C**********           MOVEL#DDP03    ZA0155           Depot 3        CSE022
      **Send*message*'Cust*is*not*a*Sec*Client'************************   CSE022
     C**********           MOVEL'USR0539' ZAMSID                          CSE022
     C**********           EXSR ZASNMS                                    CSE022
     C**********           SETON                     99    *              CSE022
     C**********           MOVEL'1'       @I2,35           *              CSE022
      **********                                                          CSE022
     C**********           ELSE                                           CSE022
      **CASE:**OTHERWISE***********************************************   CSE022
      **CASE:*WRK.Classification*is*Kassenverein***********************   CSE022
     C********** WUCLAS    IFEQ 'K'                        *IF            CSE022
     C**********           ELSE                                           CSE022
      **CASE:**OTHERWISE***********************************************   CSE022
      **Setup*message*data*for*message*********************************   CSE022
     C**********           MOVEL#DDP03    ZA0156           Depot 3        CSE022
      **Send*message*'Cust*not*Classified'*****************************   CSE022
     C**********           MOVEL'USR0540' ZAMSID                          CSE022
     C**********           EXSR ZASNMS                                    CSE022
     C**********           SETON                     99    *              CSE022
     C**********           MOVEL'1'       @I2,35           *              CSE022
      **********                                                          CSE022
     C**********           END                             *FI            CSE022
     C**********           END                             *FI            CSE022
     C**********           END                             *FI            CSE022
      *                                                                   CSE022
      ** Depot Reference 3: Select                                        CSE022
      *                                                                   CSE022
     C                     MOVEL#DDP03    WUCAKY                          CSE022
      *                                                                   CSE022
      ** CASE: WRK.Check For Asterisk in Key is Question Mark             CSE022
      *                                                                   CSE022
     C           WUCAKY    IFEQ '?'                                       CSE022
      *                                                                   CSE022
      ** Select Sec Client Dsp - Securities Clients                       CSE022
      *                                                                   CSE022
     C                     CLEARPDRC                                      CSE022
     C                     CALL 'SD0342D'              90                 CSE022
     C                     PARM *BLANK    W0RTN   7                       CSE022
     C                     PARM           PDRC                            CSE022
     C           WUCSSN    PARM *BLANK    WQ0166 10                       CSE022
     C                     PARM *BLANK    WQ0167 10                       CSE022
     C                     PARM *BLANK    WQ0168 20                       CSE022
      *                                                                   CSE022
     C           *IN90     IFEQ '1'                                       CSE022
      *                                                                   CSE022
      ** Call to program ended in error                                   CSE022
      *                                                                   CSE022
     C                     MOVEL'Y2U0032' W0RTN                           CSE022
     C                     MOVEL*BLANKS   W0CLPG 10                       CSE022
     C                     MOVEL'SD0342D' W0CLPG                          CSE022
      *                                                                   CSE022
      ** Send message '*Error occured on CALL...'                         CSE022
      *                                                                   CSE022
     C                     MOVEL'Y2U0032' ZAMSID                          CSE022
     C                     MOVEL'Y2USRMSG'ZAMSGF                          CSE022
     C                     MOVELW0CLPG    ZAMSDA                          CSE022
     C                     EXSR ZASNMS                                    CSE022
      *                                                                   CSE022
     C                     ENDIF                                          CSE022
      *                                                                   CSE022
     C                     MOVELPDCUST    WUCUST                          CSE022
      *                                                                   CSE022
      ** Error detected?                                                  CSE022
      *                                                                   CSE022
     C           W0RTN     IFNE *BLANK                                    CSE022
      *                                                                   CSE022
     C                     SETON                     99                   CSE022
      *                                                                   CSE022
     C                     ENDIF                                          CSE022
      *                                                                   CSE022
      ** CASE: WRK.Customer Shortname is blank                            CSE022
      *                                                                   CSE022
     C           WUCSSN    IFEQ *BLANK                                    CSE022
      *                                                                   CSE022
      ** Setup message data for message                                   CSE022
      *                                                                   CSE022
     C                     MOVEL#DDP03    ZA0153                          CSE022
      *                                                                   CSE022
      ** Send message 'No value selected'                                 CSE022
      *                                                                   CSE022
     C                     MOVEL'USR0944' ZAMSID                          CSE022
     C                     EXSR ZASNMS                                    CSE022
     C                     MOVE *ON       *IN99                           CSE022
     C                     MOVEL'1'       @I2,35                          CSE022
      *                                                                   CSE022
     C                     ELSE                                           CSE022
      *                                                                   CSE022
      ** CASE: *OTHERWISE                                                 CSE022
      *                                                                   CSE022
     C                     MOVELWUCUST    #1DR3                           CSE022
     C                     MOVELWUCSSN    #DDP03                          CSE022
     C                     MOVEL'Y'       W0DCF                           CSE022
      *                                                                   CSE022
     C                     ENDIF                                          CSE022
      *                                                                   CSE022
     C                     ENDIF                                          CSE022
      *                                                                   CSE022
      ** Depot Reference 3: Validate                                      CSE022
      ** CASE: 2ND.Depot 3 is Not blank                                   CSE022
      *                                                                   CSE022
     C           #DDP03    IFNE *BLANK                                    CSE022
      *                                                                   CSE022
      ** Retrieve from shortname - Client Details                         CSE022
      *                                                                   CSE022
     C                     EXSR SKRVGN                                    CSE022
      *                                                                   CSE022
      ** CASE: PGM.*Return code is *Normal                                CSE022
      *                                                                   CSE022
     C           W0RTN     IFEQ *BLANK                                    CSE022
      *                                                                   CSE022
     C                     ELSE                                           CSE022
      *                                                                   CSE022
      ** CASE: *OTHERWISE                                                 CSE022
      *                                                                   CSE022
     C                     MOVEL#DDP03    WUCUST                          CSE022
     C                     EXSR UGSUBR                                    CSE022
      *                                                                   CSE022
      ** CASE: PGM.*Return code is *Normal                                CSE022
      *                                                                   CSE022
     C           W0RTN     IFEQ *BLANK                                    CSE022
      *                                                                   CSE022
     C                     MOVELWUCUST    #1DR3                           CSE022
      *                                                                   CSE022
     C                     ELSE                                           CSE022
      *                                                                   CSE022
      ** CASE: *OTHERWISE                                                 CSE022
      ** Setup message data for message                                   CSE022
      *                                                                   CSE022
     C                     MOVEL#DDP03    ZA0154                          CSE022
      *                                                                   CSE022
      ** Send message 'Invalid Customer no/sname'                         CSE022
      *                                                                   CSE022
     C                     MOVEL'USR0352' ZAMSID                          CSE022
     C                     EXSR ZASNMS                                    CSE022
     C                     MOVE *ON       *IN99                           CSE022
     C                     MOVEL'1'       @I2,35                          CSE022
      *                                                                   CSE022
     C                     ENDIF                                          CSE022
      *                                                                   CSE022
     C                     ENDIF                                          CSE022
      *                                                                   CSE022
      ** Retrieve for E18502 - Securities Clients                         CSE022
      *                                                                   CSE022
     C                     EXSR SMRVGN                                    CSE022
      *                                                                   CSE022
      ** CASE: PGM.*Return code is *Record does not exist                 CSE022
      *                                                                   CSE022
     C           W0RTN     IFEQ 'Y2U0005'                                 CSE022
      *                                                                   CSE022
      ** Setup message data for message                                   CSE022
      *                                                                   CSE022
     C                     MOVEL#DDP03    ZA0155                          CSE022
      *                                                                   CSE022
      ** Send message 'Cust is not a Sec Client'                          CSE022
      *                                                                   CSE022
     C                     MOVEL'USR0539' ZAMSID                          CSE022
     C                     EXSR ZASNMS                                    CSE022
     C                     MOVE *ON       *IN99                           CSE022
     C                     MOVEL'1'       @I2,35                          CSE022
      *                                                                   CSE022
     C                     ELSE                                           CSE022
      *                                                                   CSE022
      ** CASE: *OTHERWISE                                                 CSE022
      ** CASE: WRK.Classification is M or X                               CSE022
      *                                                                   CSE022
     C           WUCLAS    IFEQ 'X'                                       CSE022
     C           WUCLAS    OREQ 'M'                                       CSE022
      *                                                                   CSE022
     C                     ELSE                                           CSE022
      *                                                                   CSE022
      ** CASE: *OTHERWISE                                                 CSE022
      ** Setup message data for message                                   CSE022
      *                                                                   CSE022
     C                     MOVEL#DDP03    ZA0156                          CSE022
      *                                                                   CSE022
      ** Send message 'Cust not Classified'                               CSE022
      *                                                                   CSE022
     C                     MOVEL'USR0540' ZAMSID                          CSE022
     C                     EXSR ZASNMS                                    CSE022
     C                     MOVE *ON       *IN99                           CSE022
     C                     MOVEL'1'       @I2,35                          CSE022
      *                                                                   CSE022
     C                     ENDIF                                          CSE022
      *                                                                   CSE022
     C                     ENDIF                                          CSE022
      *                                                                   CSE022
     C                     ELSE                                           CSE022
      *                                                                   CSE022
      ** CASE: *OTHERWISE                                                 CSE022
      *                                                                   CSE022
     C                     MOVEL#DDP03    #1DR3                           CSE022
      *                                                                   CSE022
     C                     ENDIF                                          CSE022
      *                                                                   CSE022
      * Depot Reference 4: Select
      *                                                                   CSE022
      ** Check depot 3                                                    CSE022
      *                                                                   CSE022
      ** CASE: 2ND.Depot 3 is blank                                       CSE022
      *                                                                   CSE022
     C           #DDP03    IFEQ *BLANK                                    CSE022
      *                                                                   CSE022
      ** CASE: 2ND.Depot 4 is Not blank                                   CSE022
      *                                                                   CSE022
     C           #DDP04    IFNE *BLANK                                    CSE022
      *                                                                   CSE022
      ** Setup message data for message                                   CSE022
      *                                                                   CSE022
     C                     MOVEL#DDP04    ZA0231                          CSE022
      *                                                                   CSE022
      ** Send message 'embedded blank entries'                            CSE022
      *                                                                   CSE022
     C                     MOVEL'USR0353' ZAMSID                          CSE022
     C                     EXSR ZASNMS                                    CSE022
     C                     MOVE *ON       *IN99                           CSE022
     C                     MOVEL'1'       @I2,37                          CSE022
      *                                                                   CSE022
     C                     ENDIF                                          CSE022
      *                                                                   CSE022
     C                     ELSE                                           CSE022
      *                                                                   CSE022
     C                     EXSR UHSUBR                     Depot Reference
      *                                                                   CSE022
     C                     ENDIF                                          CSE022
      *                                                                   CSE022
      * Depot Reference 4: Validate
      * CASE: 2ND.Depot 4 is Not blank
     C           #DDP04    IFNE *BLANK                     *IF
      * Retrieve from shortname - Client Details  *
     C                     EXSR SNRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Start of S01117
      * Removal of test for duplicate depots
      * End of S01117
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#DDP04    WUCUST           Customer Number
     C                     EXSR UISUBR
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVELWUCUST    #1DR4            Depot Reference
      * Start of S01117
      * Removal of test for duplicate depots
      * End of S01117
     C                     ELSE
      * CASE: *OTHERWISE
      * Start of Fix E20422
      * Setup message data for message
     C                     MOVEL#DDP04    ZA0158           Depot 4
      * Send message 'Invalid Customer no/sname'
     C                     MOVEL'USR0352' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,37           *
      *                                                                   CSE022
     C                     GOTO EXIT04                                    CSE022
      *
      * End of Fix E20422
     C                     END                             *FI
     C                     END                             *FI
      * Retrieve for E18502 - Securities Clients  *
     C                     EXSR SPRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#DDP04    ZA0159           Depot 4
      * Send message 'Cust is not a Sec Client'
     C                     MOVEL'USR0539' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,37           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.Classification is M or X
     C           WUCLAS    IFEQ 'X'                        *IF
     C           WUCLAS    OREQ 'M'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DDP04    ZA0160           Depot 4
      * Send message 'Cust not Classified'
     C                     MOVEL'USR0540' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,37           *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#DDP04    #1DR4            Depot Reference
     C                     END                             *FI
      *                                                                   CSE022
     C           EXIT04    TAG                                            CSE022
      *                                                                   CSE022
      * Depot Reference 5: select & check depot 4
      * CASE: 2ND.Depot 4 is blank
     C           #DDP04    IFEQ *BLANK                     *IF
      * CASE: 2ND.Depot 5 is Not blank
     C           #DDP05    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DDP05    ZA0161           Depot 5
      * Send message 'embedded blank entries'
     C                     MOVEL'USR0353' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,39           *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#DDP05    WUCAKY           Check For Aster
      * CASE: WRK.Check For Asterisk in Key is Question Mark
     C           WUCAKY    IFEQ '?'                        *IF
      * Select Sec Client Dsp - Securities Clients  *
     C                     CLEARPDRC
     C                     CALL 'SD0342D'              90  Select Sec Clie
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             KEY: Securities
     C           WUCSSN    PARM *BLANK    WQ0172 10        Customer Shortn
     C                     PARM *BLANK    WQ0173 10        Customer Report
     C                     PARM *BLANK    WQ0174 20        Customer Report
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0342D' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     MOVELPDCUST    WUCUST           Customer Number
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Customer Shortname is blank
     C           WUCSSN    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DDP05    ZA0162           Depot 5
      * Send message 'No value selected'
     C                     MOVEL'USR0944' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,39           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWUCUST    #1DR5            Depot Reference
     C                     MOVELWUCSSN    #DDP05           Depot 5
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Depot Reference 5: Validate
     C                     EXSR UJSUBR                     Depot Reference
      * Depot Reference 6: select & check depot 5
      * CASE: 2ND.Depot 5 is blank
     C           #DDP05    IFEQ *BLANK                     *IF
      * CASE: 2ND.Depot 6 is Not blank
     C           #DDP06    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DDP06    ZA0166           Depot 6
      * Send message 'embedded blank entries'
     C                     MOVEL'USR0353' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,32           *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#DDP06    WUCAKY           Check For Aster
      * CASE: WRK.Check For Asterisk in Key is Question Mark
     C           WUCAKY    IFEQ '?'                        *IF
      * Select Sec Client Dsp - Securities Clients  *
     C                     CLEARPDRC
     C                     CALL 'SD0342D'              90  Select Sec Clie
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             KEY: Securities
     C           WUCSSN    PARM *BLANK    WQ0175 10        Customer Shortn
     C                     PARM *BLANK    WQ0176 10        Customer Report
     C                     PARM *BLANK    WQ0177 20        Customer Report
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0342D' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     MOVELPDCUST    WUCUST           Customer Number
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Customer Shortname is blank
     C           WUCSSN    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DDP06    ZA0167           Depot 6
      * Send message 'No value selected'
     C                     MOVEL'USR0944' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,32           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWUCUST    #1DR6            Depot Reference
     C                     MOVELWUCSSN    #DDP06           Depot 6
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Depot Reference 6: Validate
     C                     EXSR ULSUBR                     Depot Reference
      * Depot Reference 7: select & check depot 6
      * CASE: 2ND.Depot 6 is blank
     C           #DDP06    IFEQ *BLANK                     *IF
      * CASE: 2ND.Depot 7 is Not blank
     C           #DDP07    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DDP07    ZA0171           Depot 7
      * Send message 'embedded blank entries'
     C                     MOVEL'USR0353' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,34           *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#DDP07    WUCAKY           Check For Aster
      * CASE: WRK.Check For Asterisk in Key is Question Mark
     C           WUCAKY    IFEQ '?'                        *IF
      * Select Sec Client Dsp - Securities Clients  *
     C                     CLEARPDRC
     C                     CALL 'SD0342D'              90  Select Sec Clie
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             KEY: Securities
     C           WUCSSN    PARM *BLANK    WQ0178 10        Customer Shortn
     C                     PARM *BLANK    WQ0179 10        Customer Report
     C                     PARM *BLANK    WQ0180 20        Customer Report
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0342D' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     MOVELPDCUST    WUCUST           Customer Number
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Customer Shortname is blank
     C           WUCSSN    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DDP07    ZA0172           Depot 7
      * Send message 'No value selected'
     C                     MOVEL'USR0944' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,34           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWUCUST    #1DR7            Depot Reference
     C                     MOVELWUCSSN    #DDP07           Depot 7
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Depot Reference 7: Validate
     C                     EXSR UNSUBR                     Depot Reference
      * Depot Reference 8: select & check depot 7
      * CASE: 2ND.Depot 7 is blank
     C           #DDP07    IFEQ *BLANK                     *IF
      * CASE: 2ND.Depot 8 is Not blank
     C           #DDP08    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DDP08    ZA0176           Depot 8
      * Send message 'embedded blank entries'
     C                     MOVEL'USR0353' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,36           *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#DDP08    WUCAKY           Check For Aster
      * CASE: WRK.Check For Asterisk in Key is Question Mark
     C           WUCAKY    IFEQ '?'                        *IF
      * Select Sec Client Dsp - Securities Clients  *
     C                     CLEARPDRC
     C                     CALL 'SD0342D'              90  Select Sec Clie
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             KEY: Securities
     C           WUCSSN    PARM *BLANK    WQ0181 10        Customer Shortn
     C                     PARM *BLANK    WQ0182 10        Customer Report
     C                     PARM *BLANK    WQ0183 20        Customer Report
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0342D' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     MOVELPDCUST    WUCUST           Customer Number
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Customer Shortname is blank
     C           WUCSSN    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DDP08    ZA0177           Depot 8
      * Send message 'No value selected'
     C                     MOVEL'USR0944' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,36           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWUCUST    #1DR8            Depot Reference
     C                     MOVELWUCSSN    #DDP08           Depot 8
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Depot Reference 8: Validate
     C                     EXSR UPSUBR                     Depot Reference
      * Depot Reference 9: select & check depot 8
      * CASE: 2ND.Depot 8 is blank
     C           #DDP08    IFEQ *BLANK                     *IF
      * CASE: 2ND.Depot 9 is Not blank
     C           #DDP09    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DDP09    ZA0181           Depot 9
      * Send message 'embedded blank entries'
     C                     MOVEL'USR0353' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,38           *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#DDP09    WUCAKY           Check For Aster
      * CASE: WRK.Check For Asterisk in Key is Question Mark
     C           WUCAKY    IFEQ '?'                        *IF
      * Select Sec Client Dsp - Securities Clients  *
     C                     CLEARPDRC
     C                     CALL 'SD0342D'              90  Select Sec Clie
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             KEY: Securities
     C           WUCSSN    PARM *BLANK    WQ0184 10        Customer Shortn
     C                     PARM *BLANK    WQ0185 10        Customer Report
     C                     PARM *BLANK    WQ0186 20        Customer Report
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0342D' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     MOVELPDCUST    WUCUST           Customer Number
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Customer Shortname is blank
     C           WUCSSN    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DDP09    ZA0182           Depot 9
      * Send message 'No value selected'
     C                     MOVEL'USR0944' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,38           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWUCUST    #1DR9            Depot Reference
     C                     MOVELWUCSSN    #DDP09           Depot 9
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Depot Reference 9: Validate
     C                     EXSR URSUBR                     Depot Reference
      * Depot Reference 10: select & check depot 9
      * CASE: 2ND.Depot 9 is blank
     C           #DDP09    IFEQ *BLANK                     *IF
      * CASE: 2ND.Depot 10 is Not blank
     C           #DDP10    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DDP10    ZA0186           Depot 10
      * Send message 'embedded blank entries'
     C                     MOVEL'USR0353' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,40           *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#DDP10    WUCAKY           Check For Aster
      * CASE: WRK.Check For Asterisk in Key is Question Mark
     C           WUCAKY    IFEQ '?'                        *IF
      * Select Sec Client Dsp - Securities Clients  *
     C                     CLEARPDRC
     C                     CALL 'SD0342D'              90  Select Sec Clie
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             KEY: Securities
     C           WUCSSN    PARM *BLANK    WQ0187 10        Customer Shortn
     C                     PARM *BLANK    WQ0188 10        Customer Report
     C                     PARM *BLANK    WQ0189 20        Customer Report
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0342D' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     MOVELPDCUST    WUCUST           Customer Number
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Customer Shortname is blank
     C           WUCSSN    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DDP10    ZA0187           Depot 10
      * Send message 'No value selected'
     C                     MOVEL'USR0944' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,40           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWUCUST    #1DR10           Depot Reference
     C                     MOVELWUCSSN    #DDP10           Depot 10
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Depot Reference 10: Validate
     C                     EXSR UTSUBR                     Depot Reference
     C                     MOVEL*BLANK    W0RTN            *Return code
      * Start of S01117
      * All validation concerning duplication of the depots is now perfor
      * in one place only
      * Check for Duplicate Depot - Securities Trading Data  *
     C*
     C** INITIALISE ARRAYS
     C*
     C                     MOVE *BLANKS   UERR
     C*********************MOVE INPUT     UDEP                            E41417
     C                     MOVEAINPUT     UDEP                            E41417
     C                     MOVE *IN90     US90    1
     C*
     C** CHECK EACH DEPOT FROM 1 TO 9
     C*
     C           1         DO   9         UC      20
     C           UC        ADD  1         U       20
     C           UDEP,UC   IFNE *BLANK
     C           UDEP,UC   LOKUPUDEP,U                   90
     C*
     C** IF *IN90 IS ON THEN A DUPLICATE DEPOT HAS BEEN FOUND
     C*
     C           *IN90     IFEQ '1'
     C                     MOVE 'Y'       UERR,U
     C                     END
     C                     END
     C                     END
     C                     MOVE US90      *IN90
     C                     MOVEAUERR      OUTPUT
      * Send error messages for duplicate depots
      * CASE: WRK.Error Code 1 is Error
     C           WUERR1    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DDP02    ZA0191           Depot 2
      * Send message 'depot must be unique'
     C                     MOVEL'USR0354' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: WRK.Error Code 2 is Error
     C           WUERR2    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DDP03    ZA0192           Depot 3
      * Send message 'depot must be unique'
     C                     MOVEL'USR0354' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: WRK.Error Code 3 is Error
     C           WUERR3    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DDP04    ZA0193           Depot 4
      * Send message 'depot must be unique'
     C                     MOVEL'USR0354' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: WRK.Error Code 4 is Error
     C           WUERR4    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DDP05    ZA0194           Depot 5
      * Send message 'depot must be unique'
     C                     MOVEL'USR0354' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: WRK.Error Code 5 is Error
     C           WUERR5    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DDP06    ZA0195           Depot 6
      * Send message 'depot must be unique'
     C                     MOVEL'USR0354' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: WRK.Error Code 6 is Error
     C           WUERR6    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DDP07    ZA0196           Depot 7
      * Send message 'depot must be unique'
     C                     MOVEL'USR0354' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: WRK.Error Code 7 is Error
     C           WUERR7    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DDP08    ZA0197           Depot 8
      * Send message 'depot must be unique'
     C                     MOVEL'USR0354' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: WRK.Error Code 8 is Error
     C           WUERR8    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DDP09    ZA0198           Depot 9
      * Send message 'depot must be unique'
     C                     MOVEL'USR0354' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: WRK.Error Code 9 is Error
     C           WUERR9    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DDP10    ZA0199           Depot 10
      * Send message 'depot must be unique'
     C                     MOVEL'USR0354' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * End of S01117
      * Start of change S01496.
      * Validate Jyske fields
      * CASE: WRK.SAR S01496 is Present
     C           WUJYSK    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WUPDIE           Priority Defaul
      * Validate Branch Code entry.
      * CASE: DTL.Priority of Branch Dft is Blank
     C           #1PBDF    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Check for valid values.
      * CASE: DTL.Priority of Branch Dft is Valid values
     C           #1PBDF    IFEQ '5'                        *IF
     C           #1PBDF    OREQ '4'
     C           #1PBDF    OREQ '1'
     C           #1PBDF    OREQ '3'
     C           #1PBDF    OREQ '2'
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'E'       WUPDIE           Priority Defaul
      * Setup message data for message
     C                     MOVEL#1PBDF    ZA0200           Priority of Bra
      * Send message 'Priority Ind must be 1-5'
     C                     MOVEL'USR2505' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate Customer entry.
      * CASE: DTL.Priority of Cust Chrg Dft is Blank
     C           #1POCD    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Check for valid values.
      * CASE: DTL.Priority of Cust Chrg Dft is Valid values
     C           #1POCD    IFEQ '5'                        *IF
     C           #1POCD    OREQ '4'
     C           #1POCD    OREQ '1'
     C           #1POCD    OREQ '3'
     C           #1POCD    OREQ '2'
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'E'       WUPDIE           Priority Defaul
      * Setup message data for message
     C                     MOVEL#1POCD    ZA0201           Priority of Cus
      * Send message 'Priority Ind must be 1-5'
     C                     MOVEL'USR2505' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate Customer Group entry.
      * CASE: DTL.Priority of Cust Grp Dft is Blank
     C           #1PCSD    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Check for valid values.
      * CASE: DTL.Priority of Cust Grp Dft is Valid values
     C           #1PCSD    IFEQ '5'                        *IF
     C           #1PCSD    OREQ '4'
     C           #1PCSD    OREQ '1'
     C           #1PCSD    OREQ '3'
     C           #1PCSD    OREQ '2'
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'E'       WUPDIE           Priority Defaul
      * Setup message data for message
     C                     MOVEL#1PCSD    ZA0202           Priority of Cus
      * Send message 'Priority Ind must be 1-5'
     C                     MOVEL'USR2505' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate Investment Type entry.
      * CASE: DTL.Priority of Invst typ Dft is Blank
     C           #1PIDF    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Check for valid values.
      * CASE: DTL.Priority of Invst typ Dft is Valid values
     C           #1PIDF    IFEQ '5'                        *IF
     C           #1PIDF    OREQ '4'
     C           #1PIDF    OREQ '1'
     C           #1PIDF    OREQ '3'
     C           #1PIDF    OREQ '2'
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'E'       WUPDIE           Priority Defaul
      * Setup message data for message
     C                     MOVEL#1PIDF    ZA0203           Priority of Inv
      * Send message 'Priority Ind must be 1-5'
     C                     MOVEL'USR2505' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate Market Centre entry.
      * CASE: DTL.Priority of Market Dft is Blank
     C           #1PMDF    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Check for valid values.
      * CASE: DTL.Priority of Market Dft is Valid values
     C           #1PMDF    IFEQ '5'                        *IF
     C           #1PMDF    OREQ '4'
     C           #1PMDF    OREQ '1'
     C           #1PMDF    OREQ '3'
     C           #1PMDF    OREQ '2'
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'E'       WUPDIE           Priority Defaul
      * Setup message data for message
     C                     MOVEL#1PMDF    ZA0204           Priority of Mar
      * Send message 'Priority Ind must be 1-5'
     C                     MOVEL'USR2505' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Check for valid combination.
      * CASE: WRK.Priority Default in Error is Not in error
     C           WUPDIE    IFEQ 'N'                        *IF
      * Initialise work fields.
     C                     MOVEL*BLANK    WUPDWS           Priority Dft Wo
     C                     MOVEL*BLANK    WUPDFS           Priority Dft St
      * Validate Branch Code Charge Default.
     C                     MOVEL#1PBDF    WUPDWS           Priority Dft Wo
      * Flag Charge Default Value.
      * CASE: WRK.Priority Dft Work String is Priority one
     C           WUPDWS    IFEQ '1'                        *IF
     C                     MOVEL'1'       WUPCD1           Priority Ind Ch
     C                     ELSE
      * CASE: WRK.Priority Dft Work String is Priority two
     C           WUPDWS    IFEQ '2'                        *IF
     C                     MOVEL'2'       WUPCD2           Priority Ind Ch
     C                     ELSE
      * CASE: WRK.Priority Dft Work String is Priority three
     C           WUPDWS    IFEQ '3'                        *IF
     C                     MOVEL'3'       WUPCD3           Priority Ind Ch
     C                     ELSE
      * CASE: WRK.Priority Dft Work String is Priority four
     C           WUPDWS    IFEQ '4'                        *IF
     C                     MOVEL'4'       WUPCD4           Priority Ind Ch
     C                     ELSE
      * CASE: WRK.Priority Dft Work String is Priority five
     C           WUPDWS    IFEQ '5'                        *IF
     C                     MOVEL'5'       WUPCD5           Priority Ind Ch
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate Customer Charge Default.
     C                     MOVEL#1POCD    WUPDWS           Priority Dft Wo
      * Flag Charge Default Value.
      * CASE: WRK.Priority Dft Work String is Priority one
     C           WUPDWS    IFEQ '1'                        *IF
     C                     MOVEL'1'       WUPCD1           Priority Ind Ch
     C                     ELSE
      * CASE: WRK.Priority Dft Work String is Priority two
     C           WUPDWS    IFEQ '2'                        *IF
     C                     MOVEL'2'       WUPCD2           Priority Ind Ch
     C                     ELSE
      * CASE: WRK.Priority Dft Work String is Priority three
     C           WUPDWS    IFEQ '3'                        *IF
     C                     MOVEL'3'       WUPCD3           Priority Ind Ch
     C                     ELSE
      * CASE: WRK.Priority Dft Work String is Priority four
     C           WUPDWS    IFEQ '4'                        *IF
     C                     MOVEL'4'       WUPCD4           Priority Ind Ch
     C                     ELSE
      * CASE: WRK.Priority Dft Work String is Priority five
     C           WUPDWS    IFEQ '5'                        *IF
     C                     MOVEL'5'       WUPCD5           Priority Ind Ch
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate Customer Group Charge Default.
     C                     MOVEL#1PCSD    WUPDWS           Priority Dft Wo
      * Flag Charge Default Value.
      * CASE: WRK.Priority Dft Work String is Priority one
     C           WUPDWS    IFEQ '1'                        *IF
     C                     MOVEL'1'       WUPCD1           Priority Ind Ch
     C                     ELSE
      * CASE: WRK.Priority Dft Work String is Priority two
     C           WUPDWS    IFEQ '2'                        *IF
     C                     MOVEL'2'       WUPCD2           Priority Ind Ch
     C                     ELSE
      * CASE: WRK.Priority Dft Work String is Priority three
     C           WUPDWS    IFEQ '3'                        *IF
     C                     MOVEL'3'       WUPCD3           Priority Ind Ch
     C                     ELSE
      * CASE: WRK.Priority Dft Work String is Priority four
     C           WUPDWS    IFEQ '4'                        *IF
     C                     MOVEL'4'       WUPCD4           Priority Ind Ch
     C                     ELSE
      * CASE: WRK.Priority Dft Work String is Priority five
     C           WUPDWS    IFEQ '5'                        *IF
     C                     MOVEL'5'       WUPCD5           Priority Ind Ch
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate Investment Type Charge Default.
     C                     MOVEL#1PIDF    WUPDWS           Priority Dft Wo
      * Flag Charge Default Value.
      * CASE: WRK.Priority Dft Work String is Priority one
     C           WUPDWS    IFEQ '1'                        *IF
     C                     MOVEL'1'       WUPCD1           Priority Ind Ch
     C                     ELSE
      * CASE: WRK.Priority Dft Work String is Priority two
     C           WUPDWS    IFEQ '2'                        *IF
     C                     MOVEL'2'       WUPCD2           Priority Ind Ch
     C                     ELSE
      * CASE: WRK.Priority Dft Work String is Priority three
     C           WUPDWS    IFEQ '3'                        *IF
     C                     MOVEL'3'       WUPCD3           Priority Ind Ch
     C                     ELSE
      * CASE: WRK.Priority Dft Work String is Priority four
     C           WUPDWS    IFEQ '4'                        *IF
     C                     MOVEL'4'       WUPCD4           Priority Ind Ch
     C                     ELSE
      * CASE: WRK.Priority Dft Work String is Priority five
     C           WUPDWS    IFEQ '5'                        *IF
     C                     MOVEL'5'       WUPCD5           Priority Ind Ch
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate Market Centre Charge Default.
     C                     MOVEL#1PMDF    WUPDWS           Priority Dft Wo
      * Flag Charge Default Value.
      * CASE: WRK.Priority Dft Work String is Priority one
     C           WUPDWS    IFEQ '1'                        *IF
     C                     MOVEL'1'       WUPCD1           Priority Ind Ch
     C                     ELSE
      * CASE: WRK.Priority Dft Work String is Priority two
     C           WUPDWS    IFEQ '2'                        *IF
     C                     MOVEL'2'       WUPCD2           Priority Ind Ch
     C                     ELSE
      * CASE: WRK.Priority Dft Work String is Priority three
     C           WUPDWS    IFEQ '3'                        *IF
     C                     MOVEL'3'       WUPCD3           Priority Ind Ch
     C                     ELSE
      * CASE: WRK.Priority Dft Work String is Priority four
     C           WUPDWS    IFEQ '4'                        *IF
     C                     MOVEL'4'       WUPCD4           Priority Ind Ch
     C                     ELSE
      * CASE: WRK.Priority Dft Work String is Priority five
     C           WUPDWS    IFEQ '5'                        *IF
     C                     MOVEL'5'       WUPCD5           Priority Ind Ch
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate for a valid combination of defaults.
     C                     MOVEL*BLANK    WUFTPR           field text para
     C                     MOVELWUPDFS    WUFTPR           field text para
      * Check for alphanumerics - Standard Functions  *
     C                     CALL 'SD0811'               90  Check for alpha
     C                     PARM WUFTPR    WQ0190256        field text para
     C                     PARM 5         WQ0191  30       Field length
     C           WUWRTC    PARM *BLANK    WQ0192  5        Work Return cod
     C                     PARM 'N'       WQ0193  1        Allow Embedded
     C                     PARM 'ANBLNK'  WQ0194  6        String Validati
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0811'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Check for leading/embedded blanks.
      * CASE: WRK.Work Return code is Invalid entry
     C           WUWRTC    IFEQ 'INVAL'                    *IF
      * Setup message data for message
     C                     MOVEL#1PBDF    ZA0205           Priority of Bra
     C                     MOVEL#1POCD    ZA0206           Priority of Cus
     C                     MOVEL#1PCSD    ZA0207           Priority of Cus
     C                     MOVEL#1PIDF    ZA0208           Priority of Inv
     C                     MOVEL#1PMDF    ZA0209           Priority of Mar
      * Send message 'Priority Code Arrang Invd'
     C                     MOVEL'USR2482' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1PBDF    ZA0210           Priority of Bra
      * Send message 'Priority Ind Chrg Dft Inv'
     C                     MOVEL'USR2481' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * Retention of Positiion Settlements
      * CASE: 2ND.Ret of Posn Settle SCR is Entered
     C           #DRPSS    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DRPSS    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0195  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0196 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0197  10       ZALIGN No Of De
     C                     PARM 2         WQ0198  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0199 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUERCD           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUERCD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0200 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0201  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * CASE: WRK.Err Code is Error Found
     C           WUERCD    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DRPSS    ZA0211           Ret of Posn Set
      * Send message 'Ret of posn must be numbr'
     C                     MOVEL'USR2585' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,46           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUZAFF    #1ROPS           Retention of Po
      * Zalign Ret of posn settle - Securities Trading Data  *
     C*
     C                     MOVE WUZASF    #DRPSS
     C*
      * CASE: 2ND.Retention of Posn Settl. is Valid range
     C           #1ROPS    IFGE *ZERO                      *IF
     C           #1ROPS    ANDLE99
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DRPSS    ZA0212           Ret of Posn Set
      * Send message 'Ret of posn range 0 - 99'
     C                     MOVEL'USR2586' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,46           *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     #1ROPS           Retention of Po
     C                     END                             *FI
      * Early Redemption Dummy Customer
      * CASE: 2ND.Early Redemption Dum. Cus is Entered
     C           #1ERCU    IFNE *BLANK                     *IF
     C                     MOVEL#1ERCU    WUTQKF           Test ? in Key F
      * CASE: WRK.Test ? in Key Field is Question Mark
     C           WUTQKF    IFEQ '?'                        *IF
     C                     MOVEL*BLANK    WUCUST           Customer Number
      * Select Securities Clients - Securities Clients  *
     C                     CALL 'SD0340S'              90  Select Securiti
     C                     PARM *BLANK    W0RTN   7
     C           WUCUST    PARM WUCUST    WQ0202  6        Customer Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0340S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUCUST    #1ERCU           Early Redemptio
      * Retrieve classification - Securities Clients  *
     C                     EXSR TIRVGN
      * Check the classification
      * CASE: WRK.Classification is 'S' or 'D'
     C           WUCLAS    IFEQ 'D'                        *IF
     C           WUCLAS    OREQ 'S'
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1ERCU    ZA0213           Early Redemptio
      * Send message 'Early Red cust not S or D'
     C                     MOVEL'USR2587' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,47           *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#1ERCU    WUCUST           Customer Number
      * Retrieve classification - Securities Clients  *
     C                     EXSR TJRVGN
      * Check the classification
      * CASE: WRK.Classification is 'S' or 'D'
     C           WUCLAS    IFEQ 'D'                        *IF
     C           WUCLAS    OREQ 'S'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1ERCU    ZA0214           Early Redemptio
      * Send message 'Early Red cust not S or D'
     C                     MOVEL'USR2587' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,47           *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Trade Number Range
      * CASE: 2ND.Trade Number Range SCR is Entered
     C           #DTNRS    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen F
     C                     MOVEL#DTNRS    WUZASF           ZALIGN Screen F
      * Call ZALIGN & ZEDIT
      * ZALIGN Screen Field - Standard Functions  *
     C                     CALL 'ZALIGN'               90  ZALIGN Screen F
     C           W0RTN     PARM W0RTN     WQ0203  7        *Return code
     C           WUZASF    PARM WUZASF    WQ0204 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0205  10       ZALIGN No Of De
     C                     PARM 2         WQ0206  20       ZALIGN No Of Di
     C           WUZAFF    PARM *BLANK    WQ0207 16        ZALIGN File Fie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZALIGN'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Old Table Error
     C           W0RTN     IFEQ '*ERROR*'                  *IF
     C                     MOVEL'Y'       WUERCD           Err Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUERCD           Err Code
      * ZEDIT Screen Field - Standard Functions  *
     C                     CALL 'ZEDIT'                90  ZEDIT Screen Fi
     C           WUZASF    PARM WUZASF    WQ0208 16        ZALIGN Screen F
     C                     PARM *ZERO     WQ0209  10       ZALIGN No Of De
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ZEDIT'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     END                             *FI
      * Error code found
      * CASE: WRK.Err Code is Error Found
     C           WUERCD    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DTNRS    ZA0215           Trade Number Ra
      * Send message 'Trade no. range numeric'
     C                     MOVEL'USR2597' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,48           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUZAFF    WUWTNR           Work Trade no.
      * Access TNRAN - Standard Functions  *       *VERIFY
     C                     CALL 'AOTNRNR0'             90  Access TNRAN
     C           WUAPRC    PARM WUAPRC    WQ0210  7        Access Pgm Retu
     C                     PARM '*VERIFY' WQ0211  7        Option for ACCO
     C                     PARM WUWTNR    WQ0212  20       Work Trade no.
     C                     PARM *BLANK    WQ0213200        Access Object F
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'AOTNRNR0'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Check return code
      * CASE: WRK.Access Pgm Return Code is *Normal
     C           WUAPRC    IFEQ *BLANK                     *IF
     C                     MOVE WUZAFF    #1TRNR           Trade Number Ra
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DTNRS    ZA0216           Trade Number Ra
      * Send message 'Trade No. Range invalid'
     C                     MOVEL'USR2588' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,48           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Access TNRAN - Standard Functions  *       *FREE
     C                     CALL 'AOTNRNR0'             90  Access TNRAN
     C           WUAPRC    PARM WUAPRC    WQ0214  7        Access Pgm Retu
     C                     PARM '*FREE'   WQ0215  7        Option for ACCO
     C                     PARM WUWTNR    WQ0216  20       Work Trade no.
     C                     PARM *BLANK    WQ0217200        Access Object F
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'AOTNRNR0'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Start of change 091684.
      * Setup message data for message
     C                     MOVEL#DTNRS    ZA0217           Trade Number Ra
      * Send message 'Trade numb range missing'
     C                     MOVEL'USR2847' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,48           *
      *
      * End of change 091684.
     C                     END                             *FI
     C                     END                             *FI
      * End of change S01496.
      *                                                                   CSE007
      ** If SAR CSE007 is ON                                              CSE007
      *                                                                   CSE007
     C           WUCOAC    IFEQ 'Y'                                       CSE007
     C           WUEURO    OREQ 'Y'                                       CEU017
      *                                                                   CSE007
      ** Corporate Action Trade Customer.                                 CSE007
      *                                                                   CSE007
     C           #1COTC    IFEQ *BLANKS                                   CSE007
      * Setup message data for message                                    CSE007
     C                     MOVEL#1COTC    ZA0218                          CSE007
      * Send message 'Trade Cust. mandatory'                              CSE007
     C                     MOVEL'USR3591' ZAMSID                          CSE007
     C                     EXSR ZASNMS                                    CSE007
     C                     MOVE *ON       *IN99                           CSE007
     C                     MOVE '1'       @I2,71                          CSE007
     C                     ELSE                                           CSE007
      *                                                                   CSE007
      ** Check if it is a valid customer number                           CSE007
      *                                                                   CSE007
     C                     CALL 'AOCUSTR0'             90                 CSE007
     C                     PARM *BLANKS   @RTCD   7                       CSE007
     C                     PARM '*VERIFY' @OPTN   7                       CSE007
     C                     PARM #1COTC    @KY10  10                       CSE007
     C                     PARM *BLANKS   @KYST   7                       CSE007
     C           SDCUST    PARM SDCUST    DSSDY                           CSE007
      *                                                                   CSE007
     C           @RTCD     IFNE *BLANKS                                   CSE007
      * Setup message data for message                                    CSE007
     C                     MOVEL#1COTC    ZA0219                          CSE007
      * Send message 'Trade Cust. invalid'                                CSE007
     C                     MOVEL'USR3594' ZAMSID                          CSE007
     C                     EXSR ZASNMS                                    CSE007
     C                     MOVE *ON       *IN99                           CSE007
     C                     MOVE '1'       @I2,71                          CSE007
     C                     ELSE                                           CSE007
      *                                                                   CSE007
      ** Check if it is a valid Securities Trading Customer.              CSE007
      *                                                                   CSE007
     C                     CALL 'AOSECSR0'                                CSE007
     C                     PARM *BLANKS   @RTCD   7                       CSE007
     C                     PARM '*KEY   ' @OPTN   7                       CSE007
     C                     PARM #1COTC    @KY10  10                       CSE007
     C           SDSECS    PARM SDSECS    DSSDY                           CSE007
      *                                                                   CSE007
     C           @RTCD     IFNE *BLANKS                                   CSE007
      * Setup message data for message                                    CSE007
     C                     MOVEL#1COTC    ZA0220                          CSE007
      * Send message 'Trade Cust. not a trading cust.'                    CSE007
     C                     MOVEL'USR3592' ZAMSID                          CSE007
     C                     EXSR ZASNMS                                    CSE007
     C                     MOVE *ON       *IN99                           CSE007
     C                     MOVE '1'       @I2,71                          CSE007
     C                     ELSE                                           CSE007
      *                                                                   CSE007
     C           BFCLAS    IFNE 'M'                                       CSE007
     C           BFCLAS    ANDNE'S'                                       CSE007
     C           BFCLAS    ANDNE'D'                                       CSE007
      * Setup message data for message                                    CSE007
     C                     MOVEL#1COTC    ZA0221                          CSE007
      * Send message 'Trade cust. must be class 'M', 'S' or 'D''          CSE007
     C                     MOVEL'USR3593' ZAMSID                          CSE007
     C                     EXSR ZASNMS                                    CSE007
     C                     MOVE *ON       *IN99                           CSE007
     C                     MOVE '1'       @I2,71                          CSE007
      *                                                                   CSE007
     C                     ELSE                                           CSE007
     C                     MOVE #1COTC    #1HOTC                          CSE007
     C                     ENDIF                                          CSE007
      *                                                                   CSE007
     C                     ENDIF                                          CSE007
      *                                                                   CSE007
     C                     ENDIF                                          CSE007
      *                                                                   CSE007
     C                     ENDIF                                          CSE007
      *                                                                   CSE007
      ** Trade Subtypes in Corporate A/C key.                             CSE007
      *                                                                   CSE007
     C           #1COTA    IFNE 'Y'                                       CSE007
     C           #1COTA    ANDNE'N'                                       CSE007
     C           #1COTA    ANDNE' '                                       CSE007
      * Setup message data for message                                    CSE007
     C                     MOVEL#1COTA    ZA0222                          CSE007
      * Send message 'Trade subtypes must be 'Y' or 'N'.'                 CSE007
     C                     MOVEL'USR3595' ZAMSID                          CSE007
     C                     EXSR ZASNMS                                    CSE007
     C                     MOVE *ON       *IN99                           CSE007
     C                     MOVE '1'       @I2,72                          CSE007
      *                                                                   CSE007
     C                     ELSE                                           CSE007
     C                     MOVE #1COTA    #1HOTA                          CSE007
      *                                                                   CSE007
     C           #1COTA    IFEQ *BLANKS                                   CSE007
     C                     MOVEL'N'       #1HOTA                          CSE007
     C                     ENDIF                                          CSE007
      *                                                                   CSE007
     C                     ENDIF                                          CSE007
      *                                                                   CSE007
      * Trade Number Range                                                CSE007
      * CASE: 2ND.Trade Number Range SCR is Entered                       CSE007
     C           #1CTNR    IFNE *BLANK                     *IF            CSE007
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen FCSE007
     C                     MOVEL#1CTNR    WUZASF           ZALIGN Screen FCSE007
      * Call ZALIGN & ZEDIT                                               CSE007
      * ZALIGN Screen Field - Standard Functions  *                       CSE007
     C                     CALL 'ZALIGN'               90  ZALIGN Screen FCSE007
     C           W0RTN     PARM W0RTN     WQ0203  7        *Return code   CSE007
     C           WUZASF    PARM WUZASF    WQ0204 16        ZALIGN Screen FCSE007
     C                     PARM *ZERO     WQ0205  10       ZALIGN No Of DeCSE007
     C                     PARM 2         WQ0206  20       ZALIGN No Of DiCSE007
     C           WUZAFF    PARM *BLANK    WQ0207 16        ZALIGN File FieCSE007
      *                                                                   CSE007
     C           *IN90     IFEQ '1'                                       CSE007
      * Call to program ended in error                                    CSE007
     C                     MOVEL'Y2U0032' W0RTN                           CSE007
     C                     MOVEL*BLANKS   W0CLPG 10                       CSE007
     C                     MOVEL'ZALIGN'  W0CLPG                          CSE007
      * Send message '*Error occured on CALL...'                          CSE007
     C                     MOVEL'Y2U0032' ZAMSID                          CSE007
     C                     MOVEL'Y2USRMSG'ZAMSGF                          CSE007
     C                     MOVELW0CLPG    ZAMSDA           Message data   CSE007
     C                     EXSR ZASNMS                                    CSE007
     C                     END                                            CSE007
      *                                                                   CSE007
      * Error detected?                                                   CSE007
     C           W0RTN     IFNE *BLANK                                    CSE007
     C                     SETON                     99    *              CSE007
     C                     END                                            CSE007
      * CASE: PGM.*Return code is Old Table Error                         CSE007
     C           W0RTN     IFEQ '*ERROR*'                  *IF            CSE007
     C                     MOVEL'Y'       WUERCD           Err Code       CSE007
     C                     ELSE                                           CSE007
      * CASE: *OTHERWISE                                                  CSE007
     C                     MOVEL'N'       WUERCD           Err Code       CSE007
      * ZEDIT Screen Field - Standard Functions  *                        CSE007
     C                     CALL 'ZEDIT'                90  ZEDIT Screen FiCSE007
     C           WUZASF    PARM WUZASF    WQ0208 16        ZALIGN Screen FCSE007
     C                     PARM *ZERO     WQ0209  10       ZALIGN No Of DeCSE007
      *                                                                   CSE007
     C           *IN90     IFEQ '1'                                       CSE007
      * Call to program ended in error                                    CSE007
     C                     MOVEL'Y2U0032' W0RTN                           CSE007
     C                     MOVEL*BLANKS   W0CLPG 10                       CSE007
     C                     MOVEL'ZEDIT'   W0CLPG                          CSE007
      * Send message '*Error occured on CALL...'                          CSE007
     C                     MOVEL'Y2U0032' ZAMSID                          CSE007
     C                     MOVEL'Y2USRMSG'ZAMSGF                          CSE007
     C                     MOVELW0CLPG    ZAMSDA           Message data   CSE007
     C                     EXSR ZASNMS                                    CSE007
     C                     END                                            CSE007
      *                                                                   CSE007
     C                     END                             *FI            CSE007
      * Error code found                                                  CSE007
      * CASE: WRK.Err Code is Error Found                                 CSE007
     C           WUERCD    IFEQ 'Y'                        *IF            CSE007
      * Setup message data for message                                    CSE007
     C                     MOVEL#1CTNR    ZA0223           Trade Number RaCSE007
      * Send message 'Trade no. range numeric'                            CSE007
     C                     MOVEL'USR2597' ZAMSID                          CSE007
     C                     EXSR ZASNMS                                    CSE007
     C                     SETON                     99    *              CSE007
     C                     MOVEL'1'       @I2,73           *              CSE007
      *                                                                   CSE007
     C                     ELSE                                           CSE007
      * CASE: *OTHERWISE                                                  CSE007
     C                     MOVE WUZAFF    WUWTNR           Work Trade no. CSE007
      * Access TNRAN - Standard Functions  *       *VERIFY                CSE007
     C                     CALL 'AOTNRNR0'             90  Access TNRAN   CSE007
     C           WUAPRC    PARM WUAPRC    WQ0210  7        Access Pgm RetuCSE007
     C                     PARM '*VERIFY' WQ0211  7        Option for ACCOCSE007
     C                     PARM WUWTNR    WQ0212  20       Work Trade no. CSE007
     C                     PARM *BLANK    WQ0213200        Access Object FCSE007
      *                                                                   CSE007
     C           *IN90     IFEQ '1'                                       CSE007
      * Call to program ended in error                                    CSE007
     C                     MOVEL'Y2U0032' W0RTN                           CSE007
     C                     MOVEL*BLANKS   W0CLPG 10                       CSE007
     C                     MOVEL'AOTNRNR0'W0CLPG                          CSE007
      * Send message '*Error occured on CALL...'                          CSE007
     C                     MOVEL'Y2U0032' ZAMSID                          CSE007
     C                     MOVEL'Y2USRMSG'ZAMSGF                          CSE007
     C                     MOVELW0CLPG    ZAMSDA           Message data   CSE007
     C                     EXSR ZASNMS                                    CSE007
     C                     END                                            CSE007
      *                                                                   CSE007
      * Check return code                                                 CSE007
      * CASE: WRK.Access Pgm Return Code is *Normal                       CSE007
     C           WUAPRC    IFEQ *BLANK                     *IF            CSE007
     C                     MOVE WUZAFF    #1HTNR           Trade Number RaCSE007
     C                     ELSE                                           CSE007
      * CASE: *OTHERWISE                                                  CSE007
      * Setup message data for message                                    CSE007
     C                     MOVEL#1CTNR    ZA0224           Trade Number RaCSE007
      * Send message 'Trade No. Range invalid'                            CSE007
     C                     MOVEL'USR2588' ZAMSID                          CSE007
     C                     EXSR ZASNMS                                    CSE007
     C                     SETON                     99    *              CSE007
     C                     MOVEL'1'       @I2,73           *              CSE007
      *                                                                   CSE007
     C                     END                             *FI            CSE007
     C                     END                             *FI            CSE007
      * Access TNRAN - Standard Functions  *       *FREE                  CSE007
     C                     CALL 'AOTNRNR0'             90  Access TNRAN   CSE007
     C           WUAPRC    PARM WUAPRC    WQ0214  7        Access Pgm RetuCSE007
     C                     PARM '*FREE'   WQ0215  7        Option for ACCOCSE007
     C                     PARM WUWTNR    WQ0216  20       Work Trade no. CSE007
     C                     PARM *BLANK    WQ0217200        Access Object FCSE007
      *                                                                   CSE007
     C           *IN90     IFEQ '1'                                       CSE007
      * Call to program ended in error                                    CSE007
     C                     MOVEL'Y2U0032' W0RTN                           CSE007
     C                     MOVEL*BLANKS   W0CLPG 10                       CSE007
     C                     MOVEL'AOTNRNR0'W0CLPG                          CSE007
      * Send message '*Error occured on CALL...'                          CSE007
     C                     MOVEL'Y2U0032' ZAMSID                          CSE007
     C                     MOVEL'Y2USRMSG'ZAMSGF                          CSE007
     C                     MOVELW0CLPG    ZAMSDA           Message data   CSE007
     C                     EXSR ZASNMS                                    CSE007
     C                     END                                            CSE007
      *                                                                   CSE007
     C                     ELSE                                           CSE007
      * CASE: *OTHERWISE                                                  CSE007
      * Setup message data for message                                    CSE007
     C                     MOVEL#1CTNR    ZA0225           Trade Number RaCSE007
      * Send message 'Trade numb range missing'                           CSE007
     C                     MOVEL'USR2847' ZAMSID                          CSE007
     C                     EXSR ZASNMS                                    CSE007
     C                     SETON                     99    *              CSE007
     C                     MOVEL'1'       @I2,73           *              CSE007
      *                                                                   CSE007
     C                     END                             *FI            CSE007
      *                                                                   137886
      ** Allocate Difference to Dummy Customer                            137886
      *                                                                   137886
     C           #1ALDC    IFNE 'Y'                                       137886
     C           #1ALDC    ANDNE'N'                                       137886
     C           #1ALDC    ANDNE' '                                       137886
      * Setup message data for message                                    137886
     C                     MOVEL#1ALDC    ZA0226                          137886
      * Send message 'Alloc. to Dummy Cust. must be 'Y' or 'N'.'          137886
     C                     MOVEL'USR3620' ZAMSID                          137886
     C                     EXSR ZASNMS                                    137886
     C                     MOVE *ON       *IN99                           137886
     C                     MOVE '1'       @I2,74                          137886
      *                                                                   137886
     C                     ELSE                                           137886
     C                     MOVE #1ALDC    #1HLDC                          137886
      *                                                                   137886
     C           #1ALDC    IFEQ *BLANKS                                   137886
     C                     MOVEL'N'       #1HLDC                          137886
     C                     ENDIF                                          137886
      *                                                                   137886
     C                     ENDIF                                          137886
      * SAR                                                               CSE007
     C                     ENDIF                                          CSE007
      *                                                                   CSE007
      *                                                                   137886
      *** Validation of Cash value tolerance (Lower)                      CSE006
      *                                                                   CSE006
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen FCSE006
     C                     MOVEL#DRCTL    WUZASF           ZALIGN Screen FCSE006
      * Call ZALIGN & ZEDIT                                               CSE006
      * ZALIGN Screen Field - Standard Functions  *                       CSE006
     C                     CALL 'ZALIGN'               90  ZALIGN Screen FCSE006
     C           W0RTN     PARM W0RTN     WQ0203  7        *Return code   CSE006
     C           WUZASF    PARM WUZASF    WQ0204 16        ZALIGN Screen FCSE006
     C                     PARM *ZERO     WQ0205  10       ZALIGN No Of DeCSE006
     C                     PARM 2         WQ0206  20       ZALIGN No Of DiCSE006
     C           WUZAFF    PARM *BLANK    WQ0207 16        ZALIGN File FieCSE006
      *                                                                   CSE006
     C           *IN90     IFEQ '1'                                       CSE006
      * Call to program ended in error                                    CSE006
     C                     MOVEL'Y2U0032' W0RTN                           CSE006
     C                     MOVEL*BLANKS   W0CLPG 10                       CSE006
     C                     MOVEL'ZALIGN'  W0CLPG                          CSE006
      * Send message '*Error occured on CALL...'                          CSE006
     C                     MOVEL'Y2U0032' ZAMSID                          CSE006
     C                     MOVEL'Y2USRMSG'ZAMSGF                          CSE006
     C                     MOVELW0CLPG    ZAMSDA           Message data   CSE006
     C                     EXSR ZASNMS                                    CSE006
     C                     END                                            CSE006
      *                                                                   CSE006
      * Error detected?                                                   CSE006
     C           W0RTN     IFNE *BLANK                                    CSE006
     C                     SETON                     99    *              CSE006
     C                     END                                            CSE006
      * CASE: PGM.*Return code is Old Table Error                         CSE006
     C           W0RTN     IFEQ '*ERROR*'                  *IF            CSE006
     C                     MOVEL'Y'       WUERCD           Err Code       CSE006
     C                     ELSE                                           CSE006
      * CASE: *OTHERWISE                                                  CSE006
     C                     MOVEL'N'       WUERCD           Err Code       CSE006
      * ZEDIT Screen Field - Standard Functions  *                        CSE006
     C                     CALL 'ZEDIT'                90  ZEDIT Screen FiCSE006
     C           WUZASF    PARM WUZASF    WQ0208 16        ZALIGN Screen FCSE006
     C                     PARM *ZERO     WQ0209  10       ZALIGN No Of DeCSE006
      *                                                                   CSE006
     C           *IN90     IFEQ '1'                                       CSE006
      * Call to program ended in error                                    CSE006
     C                     MOVEL'Y2U0032' W0RTN                           CSE006
     C                     MOVEL*BLANKS   W0CLPG 10                       CSE006
     C                     MOVEL'ZEDIT'   W0CLPG                          CSE006
      * Send message '*Error occured on CALL...'                          CSE006
     C                     MOVEL'Y2U0032' ZAMSID                          CSE006
     C                     MOVEL'Y2USRMSG'ZAMSGF                          CSE006
     C                     MOVELW0CLPG    ZAMSDA           Message data   CSE006
     C                     EXSR ZASNMS                                    CSE006
     C                     END                                            CSE006
      *                                                                   CSE006
     C                     END                             *FI            CSE006
      * Error code found                                                  CSE006
      * CASE: WRK.Err Code is Error Found                                 CSE006
     C           WUERCD    IFEQ 'Y'                        *IF            CSE006
      * Setup message data for message                                    CSE006
     C                     MOVEL#DRCTL    ZA0227           Trade Number RaCSE006
      * Send message 'Invalid lower range    '                            CSE006
     C                     MOVEL'USR3744' ZAMSID                          CSE006
     C                     EXSR ZASNMS                                    CSE006
     C                     SETON                     99    *              CSE006
     C                     MOVEL'1'       @I2,75           *              CSE006
      *                                                                   CSE006
      *                                                                   CSE006
     C                     ELSE                                           CSE006
     C                     MOVE WUZAFF    #1RCTL           *              CSE006
     C                     END                                            CSE006
      *** Validation of Cash value tolerance (Upper)                      CSE006
      *                                                                   CSE006
     C                     MOVEL*BLANK    WUZASF           ZALIGN Screen FCSE006
     C                     MOVEL#DRCTU    WUZASF           ZALIGN Screen FCSE006
      * Call ZALIGN & ZEDIT                                               CSE006
      * ZALIGN Screen Field - Standard Functions  *                       CSE006
     C                     CALL 'ZALIGN'               90  ZALIGN Screen FCSE006
     C           W0RTN     PARM W0RTN     WQ0203  7        *Return code   CSE006
     C           WUZASF    PARM WUZASF    WQ0204 16        ZALIGN Screen FCSE006
     C                     PARM *ZERO     WQ0205  10       ZALIGN No Of DeCSE006
     C                     PARM 2         WQ0206  20       ZALIGN No Of DiCSE006
     C           WUZAFF    PARM *BLANK    WQ0207 16        ZALIGN File FieCSE006
      *                                                                   CSE006
     C           *IN90     IFEQ '1'                                       CSE006
      * Call to program ended in error                                    CSE006
     C                     MOVEL'Y2U0032' W0RTN                           CSE006
     C                     MOVEL*BLANKS   W0CLPG 10                       CSE006
     C                     MOVEL'ZALIGN'  W0CLPG                          CSE006
      * Send message '*Error occured on CALL...'                          CSE006
     C                     MOVEL'Y2U0032' ZAMSID                          CSE006
     C                     MOVEL'Y2USRMSG'ZAMSGF                          CSE006
     C                     MOVELW0CLPG    ZAMSDA           Message data   CSE006
     C                     EXSR ZASNMS                                    CSE006
     C                     END                                            CSE006
      *                                                                   CSE006
      * Error detected?                                                   CSE006
     C           W0RTN     IFNE *BLANK                                    CSE006
     C                     SETON                     99    *              CSE006
     C                     END                                            CSE006
      * CASE: PGM.*Return code is Old Table Error                         CSE006
     C           W0RTN     IFEQ '*ERROR*'                  *IF            CSE006
     C                     MOVEL'Y'       WUERCD           Err Code       CSE006
     C                     ELSE                                           CSE006
      * CASE: *OTHERWISE                                                  CSE006
     C                     MOVEL'N'       WUERCD           Err Code       CSE006
      * ZEDIT Screen Field - Standard Functions  *                        CSE006
     C                     CALL 'ZEDIT'                90  ZEDIT Screen FiCSE006
     C           WUZASF    PARM WUZASF    WQ0208 16        ZALIGN Screen FCSE006
     C                     PARM *ZERO     WQ0209  10       ZALIGN No Of DeCSE006
      *                                                                   CSE006
     C           *IN90     IFEQ '1'                                       CSE006
      * Call to program ended in error                                    CSE006
     C                     MOVEL'Y2U0032' W0RTN                           CSE006
     C                     MOVEL*BLANKS   W0CLPG 10                       CSE006
     C                     MOVEL'ZEDIT'   W0CLPG                          CSE006
      * Send message '*Error occured on CALL...'                          CSE006
     C                     MOVEL'Y2U0032' ZAMSID                          CSE006
     C                     MOVEL'Y2USRMSG'ZAMSGF                          CSE006
     C                     MOVELW0CLPG    ZAMSDA           Message data   CSE006
     C                     EXSR ZASNMS                                    CSE006
     C                     END                                            CSE006
      *                                                                   CSE006
     C                     END                             *FI            CSE006
      * Error code found                                                  CSE006
      * CASE: WRK.Err Code is Error Found                                 CSE006
     C           WUERCD    IFEQ 'Y'                        *IF            CSE006
      * Setup message data for message                                    CSE006
     C                     MOVEL#DRCTU    ZA0228           Trade Number RaCSE006
      * Send message 'Invalid lower range    '                            CSE006
     C                     MOVEL'USR3745' ZAMSID                          CSE006
     C                     EXSR ZASNMS                                    CSE006
     C                     SETON                     99    *              CSE006
     C                     MOVEL'1'       @I2,76           *              CSE006
      *                                                                   CSE006
     C                     ELSE                                           CSE006
     C                     MOVE WUZAFF    #1RCTU           *              CSE006
     C                     END                                            CSE006
      *                                                                   CSE006
      *** Validation of Cash value tolerance (Lower and Upper %)          CSE006
      *                                                                   CSE006
     C           #1RCTL    IFNE *ZEROS                                    CSE006
      *                                                                   137886
      *** Upper % if lower field entered                                  CSE006
      *                                                                   CSE006
     C           #1RCTU    IFEQ *ZEROS                                    CSE006
     C           #1RCTU    ORLT #1RCTL                                    CSE006
     C           #1RCTU    ORGT 99                                        CSE006
     C           #1RCTU    ORLT 00                                        CSE006
      *                                                                   CSE006
      *** Setup message data for message                                  CSE006
      *                                                                   CSE006
     C                     MOVEL#1RCTU    ZA0228                          CSE006
      *                                                                   CSE006
      *** Send message 'Invalid Cash Value Tolerance Upper %'             CSE006
      *                                                                   CSE006
     C                     MOVEL'USR3745' ZAMSID                          CSE006
     C                     EXSR ZASNMS                                    CSE006
     C                     MOVE *ON       *IN99                           CSE006
     C                     MOVE '1'       @I2,76                          CSE006
     C                     ENDIF                                          CSE006
      *                                                                   CSE006
     C                     ELSE                                           CSE006
      *                                                                   CSE006
     C                     MOVEL00        #1RCTL                          CSE006
      *                                                                   CSE006
     C                     ENDIF                                          CSE006
      *                                                                   CSE006
      *** Validation of Repos - maturing securities                       CSE006
      *                                                                   CSE006
     C           #1RMAT    IFNE *BLANKS                                   CSE006
     C           #1RMAT    IFNE 'Y'                                       CSE006
     C           #1RMAT    ANDNE'N'                                       CSE006
      *                                                                   CSE006
      *** Setup message data for message                                  CSE006
      *                                                                   CSE006
     C                     MOVEL#1RMAT    ZA0229                          CSE006
      *                                                                   CSE006
      *** Send message 'Invalid Repos maturing securities ind.'           CSE006
      *                                                                   CSE006
     C                     MOVEL'USR3739' ZAMSID                          CSE006
     C                     EXSR ZASNMS                                    CSE006
     C                     MOVE *ON       *IN99                           CSE006
     C                     MOVE '1'       @I2,81                          CSE006
     C                     ENDIF                                          CSE006
      *                                                                   CSE006
     C                     ENDIF                                          CSE006
      *                                                                   137886
      *** Validation of Repos - coupons payment                           CSE006
      *                                                                   CSE006
     C           #1RCPN    IFNE *BLANKS                                   CSE006
     C           #1RCPN    IFNE 'Y'                                       CSE006
     C           #1RCPN    ANDNE'N'                                       CSE006
      *                                                                   CSE006
      *** Setup message data for message                                  CSE006
      *                                                                   CSE006
     C                     MOVEL#1RCPN    ZA0230                          CSE006
      *                                                                   CSE006
      *** Send message 'Invalid Repos maturing securities ind.'           CSE006
      *                                                                   CSE006
     C                     MOVEL'USR3740' ZAMSID                          CSE006
     C                     EXSR ZASNMS                                    CSE006
     C                     MOVE *ON       *IN99                           CSE006
     C                     MOVE '1'       @I2,82                          CSE006
     C                     ENDIF                                          CSE006
      *                                                                   CSE006
     C                     ENDIF                                          CSE006
      *                                                                   CSE006
      * Start of S01464 - Safe Custody Fees
      * Check for errors - Securities Trading Data  *
     C*
     C* IF INDICATOR 99 IS ON, THERE HAS BEEN AN ERROR, IN THAT CASE
     C* SET 'ERROR FOUND' FIELD TO 'Y'.
     C* CALL THE SECOND SCREEN ONLY IF 'ERROR FOUND' IS 'N'.
     C*
     C                     MOVE 'N'       WUERFD
     C*
     C           *IN99     IFEQ '1'
     C                     MOVE 'Y'       WUERFD
     C                     END
      * Check *Defer confirm before calling the Safe Custody Pgm. S01496
      * CASE: PGM.*Defer confirm is Proceed to confirm
     C           W0DCF     IFEQ 'N'                        *IF
      * No errors and Safe custody fees flag is 'Y'
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.Safe Custody Fees Flag is Yes
      *   |- c2    : WRK.Error found is Error not found
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1CUIN    IFEQ 'Y'                        *IF
     C           WUERFD    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Edit Safe Custody ICD - Safe Custody Fees ICD  *
     C                     CLEARPERC
     C                     MOVEL'SCFE'    PESCFE           Safe Custody Fe
      *
     C                     CALL 'SD9371R'              90  Edit Safe Custo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PERC             KEY: Safe Custo
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD9371R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check the return code
      * CASE: PGM.*Return code is *Previous Screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * End of S01464 -
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy member SD9211RVSR - Securities Trading Data  * S01212
     C*
     C/COPY WNCPYSRC,SD9211RVSR
     C*
     C                     END                             *FI
      * Trade Authorisation Type required
     C********** #1AUTH    IFEQ *BLANK                     IF                               BUG12434
     C**********           MOVEL'1'       @I1,61                                            BUG12434
     C**********           SETON                     99    *                                BUG12434
      **Send*message*'*Value*required'                                                      BUG12434
     C**********           MOVEL'Y2U0001' ZAMSID                                            BUG12434
     C**********           MOVEL'Y2USRMSG'ZAMSGF                                            BUG12434
     C**********           EXSR ZASNMS                                                      BUG12434
     C**********           END                             FI                               BUG12434
      * Telekurs Interface required
     C           #1TKIF    IFEQ *BLANK                     IF
     C                     MOVEL'1'       @I1,63
     C                     SETON                     99    *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         EBPR##    BEGSR
      *================================================================
      * Process record:
      *================================================================
      * Process update request
     C           W0PMD     CASNE'ADD'     EECHRQ
     C                     END
     C           W0RTN     IFNE *BLANK
      * Error: ROLLBACK any DBF changes
     C                     ROLBK
     C                     GOTO EBEXIT
     C                     ELSE
      * Otherwise COMMIT any DBF changes
     C                     COMIT
     C                     END
     C           W0RTN     IFEQ *BLANK
      * USER: Process command keys
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy member SD9211RPCK - Securities Trading Data  * S01212
     C*
     C/COPY WNCPYSRC,SD9211RPCK
     C*
     C                     END                             *FI
      * Restart program for next record
     C                     MOVEL'N'       W0TRN
     C                     END
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         EECHRQ    BEGSR
      *================================================================
      * Process update request
      *================================================================
      * USER: Change DBF record
      * Change Sec. Trading - Securities Trading Data  *
     C                     EXSR TKCHRC
     C           W0RTN     IFNE *BLANK
      * Data update error
      * Reset screen fields if changed record
     C           W0RTN     CASEQ'Y2U0007' MBFL#1
     C                     END
     C                     ELSE
      * Send message '*Record changed'
     C                     MOVEL'Y2U0012' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
      *================================================================
     CSR         EEEXIT    ENDSR
      /EJECT
     CSR         GADSAK    BEGSR
      *================================================================
      * Set key screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSAD    BEGSR
      *================================================================
      * Set detail screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      * Protect key fields on detail screen
     C                     SETON                     88    *
     C           W0SCR     IFNE 1
     C                     MOVEL'0'       *IN79
     C                     MOVEL'0'       *IN78
     C                     MOVEL'0'       *IN77
     C                     END
     C           W0SCR     IFNE 2
     C                     MOVEL'0'       *IN78
     C                     MOVEL'0'       *IN79
     C                     END
     C           W0SCR     IFNE 3
     C                     END
     C           W0SCR     IFEQ 1
     C                     MOVEL'0'       *IN79
     C           WUBLKI    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           WUDPCT    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           WUCUSC    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     ELSE
     C           W0SCR     IFEQ 2
     C                     MOVEL'0'       *IN78
     C                     MOVEL'0'       *IN79
     C           WUJYSK    IFEQ 'N'                        *IF
     C           WUCOAC    ANDEQ'N'                                       CSE007
     C           WUEURO    ANDEQ'N'                                       CEU017
     C                     MOVEL'1'       *IN78
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     ELSE
     C           W0SCR     IFEQ 3
     C                     END
     C                     END
     C                     END
      * Enable key screen
     C                     SETON                     87    *
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise record - except for key fields and "neither" paramete
      *================================================================
     C                     MOVELP3WRTC    #PWRTC           Work Return cod
     C                     MOVEL*BLANK    #PRTN            *Return code
     C                     MOVEL*BLANK    #DDP01           Depot 1
     C                     MOVEL*BLANK    #DDP04           Depot 4
     C                     MOVEL*BLANK    #DDP07           Depot 7
     C                     MOVEL*BLANK    #DDP10           Depot 10
     C                     MOVEL*BLANK    #DDP02           Depot 2
     C                     MOVEL*BLANK    #DDP05           Depot 5
     C                     MOVEL*BLANK    #DDP08           Depot 8
     C                     MOVEL*BLANK    #DDP03           Depot 3
     C                     MOVEL*BLANK    #DDP06           Depot 6
     C                     MOVEL*BLANK    #DDP09           Depot 9
     C                     MOVEL*BLANK    #1DR3            Depot Ref 3, Ka
     C                     MOVEL*BLANK    #1DR2            Depot Reference
     C                     MOVEL*BLANK    #1DR4            Depot Reference
     C                     MOVEL*BLANK    #1DR5            Depot Reference
     C                     MOVEL*BLANK    #1DR6            Depot Reference
     C                     MOVEL*BLANK    #1DR7            Depot Reference
     C                     MOVEL*BLANK    #1DR8            Depot Reference
     C                     MOVEL*BLANK    #1DR9            Depot Reference
     C                     MOVEL*BLANK    #1DR10           Depot Reference
     C                     Z-ADD*ZERO     #1LCD            Last Change Dat
     C                     MOVEL*BLANK    #1TYLC           Type of Last Ch
     C                     MOVEL*BLANK    #1RPB            Realised Profit
     C                     MOVEL*BLANK    #1UPB            Unrealised Prof
     C                     MOVEL*BLANK    #1UPP            Unrealised Prof
     C                     MOVEL*BLANK    #1AUP            Adjust Unrealis
     C                     MOVEL*BLANK    #1SDTR           Summarise Daily
     C                     MOVEL*BLANK    #1TCTY           Trading Confirm
     C                     MOVEL*BLANK    #1TBRC           Trade & Book Po
     C                     MOVEL*BLANK    #1FIFO           FIFO Accounting
     C                     MOVEL*BLANK    #1SPIN           Split Purchased
     C                     MOVEL*BLANK    #1SNIN           Split Negative
     C                     MOVEL*BLANK    #1TSAK           Trade Subtypes
     C                     MOVEL*BLANK    #1CIAK           Convertible Ind
     C                     MOVEL*BLANK    #1NPAC           Negative positi
     C                     MOVEL*BLANK    #1GDPK           General Disc/Pr
     C                     MOVEL*BLANK    #1SKTV           Suppress keys o
     C                     MOVEL*BLANK    #1PSDM           Post no Stnd De
     C                     MOVEL*BLANK    #1CCYE           Cross Currency
     C                     Z-ADD*ZERO     #1SDOV           Settlement Desc
     C                     Z-ADD*ZERO     #1SDUN           Settlement Desc
     C                     MOVEL*BLANK    #1APST           Autopost Positi
     C                     MOVEL*BLANK    #1MMFQ           Mark to Market
     C                     Z-ADD*ZERO     #1MMBD           Mark to Market
     C                     Z-ADD*ZERO     #DMMNS           Mark to Market
     C                     Z-ADD*ZERO     #1MMND           Mark to Market
     C                     MOVEL*BLANK    #1RBAP           Reallowance ban
     C                     MOVEL*BLANK    #1CBAP           Charges in bank
     C                     MOVEL*BLANK    #1CMBP           Commission in b
     C                     MOVEL*BLANK    #1RCAP           Reallowance cus
     C                     MOVEL*BLANK    #1CCAP           Charges in cust
     C                     MOVEL*BLANK    #1CMCP           Commission in c
     C                     Z-ADD*ZERO     #1ROMS           Retention of ma
     C                     MOVEL*BLANK    #DBVPF           Back value peri
     C                     Z-ADD*ZERO     #1ROST           Retention of se
     C                     Z-ADD*ZERO     #1BVP            Back value peri
     C                     Z-ADD*ZERO     #1RODY           Retention of di
     C                     MOVEL*BLANK    #1DR1            Depot 1 (EUROCL
     C                     MOVEL*BLANK    #DATMF           Auto Transmissi
     C                     MOVEL*BLANK    #1TVDV           Trade/Value Dat
     C                     MOVEL*BLANK    #1TVC            Trade/Value Col
     C                     Z-ADD*ZERO     #1CCYC           Collateral Curr
     C                     Z-ADD*ZERO     #1FERK           Foreign Exchang
     C                     MOVEL*BLANK    #1MBEX           Market/Book Exp
     C                     Z-ADD*ZERO     #1AHLF           All Holdings Li
     C                     Z-ADD*ZERO     #1DLF            Discretionary L
     C                     Z-ADD*ZERO     #1CLF            Customers Limit
     C                     MOVEL*BLANK    #1ROSD           Redemptions on
     C                     MOVEL*BLANK    #1RIDF           Redemptions in
     C                     MOVEL*BLANK    #1RDOT           Reprompt Defaul
     C                     MOVEL*BLANK    #1PBDF           Priority of Bra
     C                     MOVEL*BLANK    #1PCSD           Priority of Cus
     C                     MOVEL*BLANK    #1PIDF           Priority of Inv
     C                     MOVEL*BLANK    #1PMDF           Priority of Mar
     C                     MOVEL*BLANK    #1POCD           Priority of Cus
     C                     Z-ADD*ZERO     #1ROPS           Retention of Po
     C                     MOVEL*BLANK    #1ERCU           Early Redemptio
     C                     Z-ADD*ZERO     #1TRNR           Trade Number Ra
      *                                                                   CSE007
     C**********           Z-ADD*ZERO     #1HOTC           Corporate Actio             CSE007 CSD027
     C                     MOVE *BLANKS   #1HOTC           Corporate Actio                    CSD027
     C                     MOVEL*BLANK    #1HOTA           Trade Subtypes CSE007
     C                     Z-ADD*ZEROS    #1HTNR           Trade Number RaCSE007
     C                     MOVEL*BLANKS   #1HLDC           Diff to Dummy  137886
      *                                                                   CSE007
     C                     MOVEL*BLANK    #DMSCF           Matured Securit
     C                     MOVEL*BLANK    #DSTFF           Settled Trades
     C                     MOVEL*BLANK    #DBVFF           Back Valuation
     C                     MOVEL*BLANK    #DDEFF           Diary Entries F
     C                     MOVEL*BLANK    #1EUCY           Euroclear Curre
     C                     MOVEL*BLANK    #1CCCY           Cedel Currency
     C                     MOVEL*BLANK    #1ECDM           E/C Deutsch Mar
     C                     MOVEL*BLANK    #1ECBF           E/C Belgian Fra
     C                     MOVEL*BLANK    #1ECJY           E/C Japanese Ye
     C                     MOVEL*BLANK    #1EUCD           Euclid
     C                     MOVEL*BLANK    #1ATI            Auto-transmissi
     C                     MOVEL*BLANK    #1DEI            Dealing Events
     C                     MOVEL*BLANK    #1FICI           FI Collateral I
     C                     MOVEL*BLANK    #1DMBC           Default Market
     C                     MOVEL*BLANK    #1DPBC           Default Portfol
     C                     MOVEL*BLANK    #1DMKS           Default Market
     C                     MOVEL*BLANK    #1DPFS           Default Portfol
     C                     MOVEL*BLANK    #1DTDS           Default Transfe
     C                     MOVEL*BLANK    #1REDE           Reprompt defaul
     C                     MOVEL*BLANK    #1BIOP           Bulk Input Opti
     C                     MOVEL*BLANK    #1RVBT           Review Bulk Tra
     C                     MOVEL*BLANK    #1DEAT           Default Agency
     C                     MOVEL*BLANK    #1ATPC           Allow Trades P/
     C                     MOVEL*BLANK    #1DBCD           Default brokera
     C                     MOVEL*BLANK    #1ATBK           Agency Trading
     C                     MOVEL*BLANK    #1ACOP           Autocharge Opti
     C                     MOVEL*BLANK    #1SEPC           SE Profit Centr
     C                     MOVEL*BLANK    #1CHRC           SE charges curr
     C                     MOVEL*BLANK    #1ACSD           Adjust Comm s/d
     C                     MOVEL*BLANK    #1EXOP           Extel Option
     C**********           MOVEL*BLANK    #1AUTH           Trade Authorisa                  BUG12434
     C                     MOVEL'00'      #1AUTH                                            BUG12434
     C                     MOVEL*BLANK    #1CUIN           Safe Custody Fe
     C                     MOVEL*BLANK    #1TKIF           Telekurs Interf
     C                     MOVELP3WRTC    #PWRTC           Work Return cod
     C                     MOVEL*BLANK    #PRTN            *Return code
     C                     MOVEL*BLANK    #DDP01           Depot 1
     C                     MOVEL*BLANK    #DDP06           Depot 6
     C                     MOVEL*BLANK    #DDP02           Depot 2
     C                     MOVEL*BLANK    #DDP07           Depot 7
     C                     MOVEL*BLANK    #DDP03           Depot 3
     C                     MOVEL*BLANK    #DDP08           Depot 8
     C                     MOVEL*BLANK    #DDP04           Depot 4
     C                     MOVEL*BLANK    #DDP09           Depot 9
     C                     MOVEL*BLANK    #DDP05           Depot 5
     C                     MOVEL*BLANK    #DDP10           Depot 10
     C                     MOVEL*BLANK    #DRPSS           Ret of Posn Set
     C                     MOVEL*BLANK    #DTNRS           Trade Number Ra
     C                     MOVELP3WRTC    #PWRTC           Work Return cod
     C                     MOVEL*BLANK    #PRTN            *Return code
     C                     Z-ADD*ZERO     #DMMNS           Mark to Market
     C                     MOVEL*BLANK    #DCCCF           collateral ccy
     C                     MOVEL*BLANK    #DFERF           Foreign Exchang
     C                     MOVEL*BLANK    #DAHLM           All Holdings Li
     C                     MOVEL*BLANK    #DDLFF           Discretionary L
     C                     MOVEL*BLANK    #DCLFF           Customers Limit
     C                     MOVEL*BLANK    #DMBFF           Mark to Market
     C                     MOVEL*BLANK    #DMNXF           Mark to Market
     C                     MOVEL*BLANK    #DSDOF           Setl Discrepanc
     C                     MOVEL*BLANK    #DSDUF           Setl Discrepanc
     C                     MOVEL*BLANK    #1CTNR           Trade Number RaCSE007
     C                     MOVEL*BLANKS   #1ALDC           Diff to Dummy  137886
     C                     Z-ADD*ZEROS    #1RCTL           Lower %        CSE006
     C                     Z-ADD*ZEROS    #1RCTU           Upper %        CSE006
     C                     MOVEL*BLANK    #DRCTL           Lower %        CSE006
     C                     MOVEL*BLANK    #DRCTU           Upper %        CSE006
     C                     MOVEL*BLANK    #1RMAT           Maturing Secur CSE006
     C                     MOVEL*BLANK    #1RCPN           Coupon Payment CSE006
      **********                                                                       CAS006 224354
      ***Initialize*newly*added*display*fields*for*CAS006**************                CAS006 224354
      **********                                                                       CAS006 224354
     C********** CAS006    IFEQ 'Y'                                                    CAS006 224354
     C**********           MOVE *BLANK    #DBHPP                                       CAS006 224354
     C**********           Z-ADD0         #1BHPP                                       CAS006 224354
     C**********           ENDIF                                                       CAS006 224354
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @BVREFF fields to screen
      *================================================================
     C                     MOVELBVSCTR    #1SCTR           Securities Trad
     C                     MOVELBVDR3     #1DR3            Depot Ref 3, Ka
     C                     MOVELBVDR2     #1DR2            Depot Reference
     C                     MOVELBVDR4     #1DR4            Depot Reference
     C                     MOVELBVDR5     #1DR5            Depot Reference
     C                     MOVELBVDR6     #1DR6            Depot Reference
     C                     MOVELBVDR7     #1DR7            Depot Reference
     C                     MOVELBVDR8     #1DR8            Depot Reference
     C                     MOVELBVDR9     #1DR9            Depot Reference
     C                     MOVELBVDR10    #1DR10           Depot Reference
     C                     Z-ADDBVLCD     #1LCD            Last Change Dat
     C                     MOVELBVTYLC    #1TYLC           Type of Last Ch
     C                     MOVELBVRPB     #1RPB            Realised Profit
     C                     MOVELBVUPB     #1UPB            Unrealised Prof
     C                     MOVELBVUPP     #1UPP            Unrealised Prof
     C                     MOVELBVAUP     #1AUP            Adjust Unrealis
     C                     MOVELBVSDTR    #1SDTR           Summarise Daily
     C                     MOVELBVTCTY    #1TCTY           Trading Confirm
     C                     MOVELBVTBRC    #1TBRC           Trade & Book Po
     C                     MOVELBVFIFO    #1FIFO           FIFO Accounting
     C                     MOVELBVSPIN    #1SPIN           Split Purchased
     C                     MOVELBVSNIN    #1SNIN           Split Negative
     C                     MOVELBVTSAK    #1TSAK           Trade Subtypes
     C                     MOVELBVCIAK    #1CIAK           Convertible Ind
     C                     MOVELBVNPAC    #1NPAC           Negative positi
     C                     MOVELBVGDPK    #1GDPK           General Disc/Pr
     C                     MOVELBVSKTV    #1SKTV           Suppress keys o
     C                     MOVELBVPSDM    #1PSDM           Post no Stnd De
     C                     MOVELBVCCYE    #1CCYE           Cross Currency
     C                     Z-ADDBVSDOV    #1SDOV           Settlement Desc
     C                     Z-ADDBVSDUN    #1SDUN           Settlement Desc
     C                     MOVELBVAPST    #1APST           Autopost Positi
     C                     MOVELBVMMFQ    #1MMFQ           Mark to Market
     C                     Z-ADDBVMMBD    #1MMBD           Mark to Market
     C                     Z-ADDBVMMND    #1MMND           Mark to Market
     C                     MOVELBVRBAP    #1RBAP           Reallowance ban
     C                     MOVELBVCBAP    #1CBAP           Charges in bank
     C                     MOVELBVCMBP    #1CMBP           Commission in b
     C                     MOVELBVRCAP    #1RCAP           Reallowance cus
     C                     MOVELBVCCAP    #1CCAP           Charges in cust
     C                     MOVELBVCMCP    #1CMCP           Commission in c
     C                     Z-ADDBVROMS    #1ROMS           Retention of ma
     C                     Z-ADDBVROST    #1ROST           Retention of se
     C                     Z-ADDBVBVP     #1BVP            Back value peri
     C                     Z-ADDBVRODY    #1RODY           Retention of di
     C                     MOVELBVDR1     #1DR1            Depot 1 (EUROCL
     C                     MOVELBVTVDV    #1TVDV           Trade/Value Dat
     C                     MOVELBVTVC     #1TVC            Trade/Value Col
     C                     Z-ADDBVCCYC    #1CCYC           Collateral Curr
     C                     Z-ADDBVFERK    #1FERK           Foreign Exchang
     C                     MOVELBVMBEX    #1MBEX           Market/Book Exp
     C                     Z-ADDBVAHLF    #1AHLF           All Holdings Li
     C                     Z-ADDBVDLF     #1DLF            Discretionary L
     C                     Z-ADDBVCLF     #1CLF            Customers Limit
     C                     MOVELBVROSD    #1ROSD           Redemptions on
     C                     MOVELBVRIDF    #1RIDF           Redemptions in
     C                     MOVELBVRDOT    #1RDOT           Reprompt Defaul
     C                     MOVELBVPBDF    #1PBDF           Priority of Bra
     C                     MOVELBVPCSD    #1PCSD           Priority of Cus
     C                     MOVELBVPIDF    #1PIDF           Priority of Inv
     C                     MOVELBVPMDF    #1PMDF           Priority of Mar
     C                     MOVELBVPOCD    #1POCD           Priority of Cus
     C                     Z-ADDBVROPS    #1ROPS           Retention of Po
     C                     MOVELBVERCU    #1ERCU           Early Redemptio
     C                     Z-ADDBVTRNR    #1TRNR           Trade Number Ra
      *                                                                   CSE007
     C**********           Z-ADDBVCOTC    #1HOTC           Corporate Actio             CSE007 CSD027
     C                     MOVE BVCOTC    #1HOTC           Corporate Actio                    CSD027
     C                     MOVELBVCOTA    #1HOTA           Trade Subtypes CSE007
     C                     Z-ADDBVCTNR    #1HTNR           Trade Number RaCSE007
     C                     MOVELBVALDC    #1HLDC           Diff to Dummy  137886
      *                                                                   CSE007
     C                     MOVELBVEUCY    #1EUCY           Euroclear Curre
     C                     MOVELBVCCCY    #1CCCY           Cedel Currency
     C                     MOVELBVECDM    #1ECDM           E/C Deutsch Mar
     C                     MOVELBVECBF    #1ECBF           E/C Belgian Fra
     C                     MOVELBVECJY    #1ECJY           E/C Japanese Ye
     C                     MOVELBVEUCD    #1EUCD           Euclid
     C                     MOVELBVATI     #1ATI            Auto-transmissi
     C                     MOVELBVDEI     #1DEI            Dealing Events
     C                     MOVELBVFICI    #1FICI           FI Collateral I
     C                     MOVELBVDMBC    #1DMBC           Default Market
     C                     MOVELBVDPBC    #1DPBC           Default Portfol
     C                     MOVELBVDMKS    #1DMKS           Default Market
     C                     MOVELBVDPFS    #1DPFS           Default Portfol
     C                     MOVELBVDTDS    #1DTDS           Default Transfe
     C                     MOVELBVREDE    #1REDE           Reprompt defaul
     C                     MOVELBVBIOP    #1BIOP           Bulk Input Opti
     C                     MOVELBVRVBT    #1RVBT           Review Bulk Tra
     C                     MOVELBVDEAT    #1DEAT           Default Agency
     C                     MOVELBVATPC    #1ATPC           Allow Trades P/
     C                     MOVELBVDBCD    #1DBCD           Default brokera
     C                     MOVELBVATBK    #1ATBK           Agency Trading
     C                     MOVELBVACOP    #1ACOP           Autocharge Opti
     C                     MOVELBVSEPC    #1SEPC           SE Profit Centr
     C                     MOVELBVCHRC    #1CHRC           SE charges curr
     C                     MOVELBVACSD    #1ACSD           Adjust Comm s/d
     C                     MOVELBVEXOP    #1EXOP           Extel Option
     C                     MOVELBVAUTH    #1AUTH           Trade Authorisa
     C                     MOVELBVCUIN    #1CUIN           Safe Custody Fe
     C                     MOVELBVTKIF    #1TKIF           Telekurs Interf
     C                     Z-ADDBVRCTL    #1RCTL           Lower %        CSE006
     C                     Z-ADDBVRCTU    #1RCTU           Upper %        CSE006
     C                     MOVELBVRMAT    #1RMAT           Maturing Secur CSE006
     C                     MOVELBVRCPN    #1RCPN           Coupon Payment CSE006
      **********                                                                       CAS006 224354
      ***Move*Historic*Price*to*Screen*Field***************************                CAS006 224354
      **********                                                                       CAS006 224354
     C********** CAS006    IFEQ 'Y'                                                    CAS006 224354
     C**********           Z-ADDBVBHPP    #1BHPP                                       CAS006 224354
     C**********           ENDIF                                                       CAS006 224354
      **********                                                                       CAS006 224354
      * Hold existing record image
     C                     MOVEL@1DBRC    #1DBRC
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MDIZ#K    BEGSR
      *================================================================
      * Initialize key screen
      *================================================================
     C                     MOVELP3WRTC    #PWRTC           Work Return cod
     C                     MOVEL*BLANK    #PRTN            *Return code
     C                     MOVELP1SCTR    #1SCTR           Securities Trad
      * USER: Initialize key screen
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy member SD9211RIKS - Securities Trading Data  * S01212
     C*
     C/COPY WNCPYSRC,SD9211RIKS
     C*
     C                     END                             *FI
      *================================================================
     CSR         MDEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Get Base Currency - Bank Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           BJBANK           Bank
      * Move fields to key list
     C                     MOVE *BLANK    BJBANK           Bank
     C                     MOVEL'BANK'    BJBANK           Bank
     C           KRSSA     CHAIN@BJREEF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0197' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * Setup message data for message
     C                     MOVEL'SDBANKPD'ZA0002           Filename
      * Send message 'Database Error (ICD)'
     C                     MOVEL'USR0377' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO SAEXIT                     *QUIT
     C                     GOTO SAEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBJCYCD    WUCYCD           Currency Code
     C                     END
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Get Base Curr Details 2 - Currency Codes  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           A6CYCD           Currency Code
      * Move fields to key list
     C                     MOVELWUCYCD    A6CYCD           Currency Code
     C           KRSSB     CHAIN@A6REA3              90    *
      * Data record not found
     C   90                MOVEL'USR0071' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDA6NBDP    WUNBDP           Number of Decim
     C                     END
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Retrieve Profit Centre - Profit Centres  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           DSPCCD           Profit Centre C
      * Move fields to key list
     C                     MOVEL#1SEPC    DSPCCD           Profit Centre C
     C           KRSSC     CHAIN@DSREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0647' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     END
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Check for ccy existance - Currency Codes  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           A6CYCD           Currency Code
      * Move fields to key list
     C                     MOVELWUCYCD    A6CYCD           Currency Code
     C           KRSSD     CHAIN@A6REA3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0071' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     END
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Retrieve from shortname - Client Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WACSSN    WQSE01           Customer Shortn
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Customer Shortn
      * Move fields to key list
     C                     MOVEL#DDP01    WQSE01           Customer Shortn
     C           KRSSE     SETLL@CUSTD5                    *
     C           KRSSE     READE@CUSTD5                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0081' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SEEXIT
     C                     END
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWACUST    #1DR1            Customer Number
     C           KRSSE     READE@CUSTD5                  90*
     C                     END
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Check For Live Client - Client Details  * LN0571
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBCUST    WQSF01           Customer Number
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Customer Number
      * Move fields to key list
     C                     MOVELWUCUST    WQSF01           Customer Number
     C           KRSSF     SETLL@CUSTFT                    *
     C           KRSSF     READE@CUSTFT                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0081' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SFEXIT
     C                     END
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Start of E40226
      * *Return code should be set to *Normal (Blank), NOT
      * *Record already exists
     C                     MOVEL*BLANK    W0RTN            *Return code
      * End of E40226
      * PAR = DB1 By name
     C           KRSSF     READE@CUSTFT                  90*
     C                     END
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Retrieve for E18502 - Securities Clients  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           BFCUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1DR1     BFCUST           Customer Number
     C           KRSSG     CHAIN@BFREDQ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0094' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBFCLAS    WUCLAS           Classification
     C                     END
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Retrieve from shortname - Client Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WACSSN    WQSH01           Customer Shortn
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Customer Shortn
      * Move fields to key list
     C                     MOVEL#DDP02    WQSH01           Customer Shortn
     C           KRSSH     SETLL@CUSTD5                    *
     C           KRSSH     READE@CUSTD5                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0081' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SHEXIT
     C                     END
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWACUST    #1DR2            Customer Number
     C           KRSSH     READE@CUSTD5                  90*
     C                     END
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Check For Live Client - Client Details  * LN0571
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBCUST    WQSI01           Customer Number
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Customer Number
      * Move fields to key list
     C                     MOVELWUCUST    WQSI01           Customer Number
     C           KRSSI     SETLL@CUSTFT                    *
     C           KRSSI     READE@CUSTFT                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0081' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SIEXIT
     C                     END
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Start of E40226
      * *Return code should be set to *Normal (Blank), NOT
      * *Record already exists
     C                     MOVEL*BLANK    W0RTN            *Return code
      * End of E40226
      * PAR = DB1 By name
     C           KRSSI     READE@CUSTFT                  90*
     C                     END
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Retrieve for E18502 - Securities Clients  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           BFCUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1DR2     BFCUST           Customer Number
     C           KRSSJ     CHAIN@BFREDQ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0094' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SJEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBFCLAS    WUCLAS           Classification
     C                     END
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Retrieve from shortname - Client Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WACSSN    WQSK01           Customer Shortn
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           Customer Shortn
      * Move fields to key list
     C                     MOVEL#DDP03    WQSK01           Customer Shortn
     C           KRSSK     SETLL@CUSTD5                    *
     C           KRSSK     READE@CUSTD5                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0081' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SKEXIT
     C                     END
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWACUST    #1DR3            Customer Number
     C           KRSSK     READE@CUSTD5                  90*
     C                     END
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Check For Live Client - Client Details  * LN0571
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBCUST    WQSL01           Customer Number
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Customer Number
      * Move fields to key list
     C                     MOVELWUCUST    WQSL01           Customer Number
     C           KRSSL     SETLL@CUSTFT                    *
     C           KRSSL     READE@CUSTFT                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0081' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SLEXIT
     C                     END
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Start of E40226
      * *Return code should be set to *Normal (Blank), NOT
      * *Record already exists
     C                     MOVEL*BLANK    W0RTN            *Return code
      * End of E40226
      * PAR = DB1 By name
     C           KRSSL     READE@CUSTFT                  90*
     C                     END
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Retrieve for E18502 - Securities Clients  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           BFCUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1DR3     BFCUST           Customer Number
     C           KRSSM     CHAIN@BFREDQ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0094' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SMEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBFCLAS    WUCLAS           Classification
     C                     END
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Retrieve from shortname - Client Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WACSSN    WQSN01           Customer Shortn
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Customer Shortn
      * Move fields to key list
     C                     MOVEL#DDP04    WQSN01           Customer Shortn
     C           KRSSN     SETLL@CUSTD5                    *
     C           KRSSN     READE@CUSTD5                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0081' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SNEXIT
     C                     END
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWACUST    #1DR4            Customer Number
     C           KRSSN     READE@CUSTD5                  90*
     C                     END
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Check For Live Client - Client Details  * LN0571
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBCUST    WQSO01           Customer Number
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Customer Number
      * Move fields to key list
     C                     MOVELWUCUST    WQSO01           Customer Number
     C           KRSSO     SETLL@CUSTFT                    *
     C           KRSSO     READE@CUSTFT                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0081' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SOEXIT
     C                     END
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Start of E40226
      * *Return code should be set to *Normal (Blank), NOT
      * *Record already exists
     C                     MOVEL*BLANK    W0RTN            *Return code
      * End of E40226
      * PAR = DB1 By name
     C           KRSSO     READE@CUSTFT                  90*
     C                     END
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Retrieve for E18502 - Securities Clients  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           BFCUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1DR4     BFCUST           Customer Number
     C           KRSSP     CHAIN@BFREDQ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0094' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SPEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBFCLAS    WUCLAS           Classification
     C                     END
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Retrieve from shortname - Client Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WACSSN    WQSQ01           Customer Shortn
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           Customer Shortn
      * Move fields to key list
     C                     MOVEL#DDP05    WQSQ01           Customer Shortn
     C           KRSSQ     SETLL@CUSTD5                    *
     C           KRSSQ     READE@CUSTD5                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0081' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SQEXIT
     C                     END
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWACUST    #1DR5            Customer Number
     C           KRSSQ     READE@CUSTD5                  90*
     C                     END
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Check For Live Client - Client Details  * LN0571
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBCUST    WQSR01           Customer Number
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           Customer Number
      * Move fields to key list
     C                     MOVELWUCUST    WQSR01           Customer Number
     C           KRSSR     SETLL@CUSTFT                    *
     C           KRSSR     READE@CUSTFT                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0081' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SREXIT
     C                     END
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Start of E40226
      * *Return code should be set to *Normal (Blank), NOT
      * *Record already exists
     C                     MOVEL*BLANK    W0RTN            *Return code
      * End of E40226
      * PAR = DB1 By name
     C           KRSSR     READE@CUSTFT                  90*
     C                     END
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Retrieve for E18502 - Securities Clients  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           BFCUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1DR5     BFCUST           Customer Number
     C           KRSSS     CHAIN@BFREDQ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0094' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SSEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBFCLAS    WUCLAS           Classification
     C                     END
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Retrieve from shortname - Client Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WACSSN    WQST01           Customer Shortn
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST01           Customer Shortn
      * Move fields to key list
     C                     MOVEL#DDP06    WQST01           Customer Shortn
     C           KRSST     SETLL@CUSTD5                    *
     C           KRSST     READE@CUSTD5                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0081' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO STEXIT
     C                     END
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWACUST    #1DR6            Customer Number
     C           KRSST     READE@CUSTD5                  90*
     C                     END
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Check For Live Client - Client Details  * LN0571
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBCUST    WQSU01           Customer Number
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WQSU01           Customer Number
      * Move fields to key list
     C                     MOVELWUCUST    WQSU01           Customer Number
     C           KRSSU     SETLL@CUSTFT                    *
     C           KRSSU     READE@CUSTFT                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0081' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SUEXIT
     C                     END
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Start of E40226
      * *Return code should be set to *Normal (Blank), NOT
      * *Record already exists
     C                     MOVEL*BLANK    W0RTN            *Return code
      * End of E40226
      * PAR = DB1 By name
     C           KRSSU     READE@CUSTFT                  90*
     C                     END
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Retrieve for E18502 - Securities Clients  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           BFCUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1DR6     BFCUST           Customer Number
     C           KRSSV     CHAIN@BFREDQ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0094' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SVEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBFCLAS    WUCLAS           Classification
     C                     END
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Retrieve from shortname - Client Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WACSSN    WQSW01           Customer Shortn
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WQSW01           Customer Shortn
      * Move fields to key list
     C                     MOVEL#DDP07    WQSW01           Customer Shortn
     C           KRSSW     SETLL@CUSTD5                    *
     C           KRSSW     READE@CUSTD5                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0081' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SWEXIT
     C                     END
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWACUST    #1DR7            Customer Number
     C           KRSSW     READE@CUSTD5                  90*
     C                     END
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * Check For Live Client - Client Details  * LN0571
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBCUST    WQSX01           Customer Number
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WQSX01           Customer Number
      * Move fields to key list
     C                     MOVELWUCUST    WQSX01           Customer Number
     C           KRSSX     SETLL@CUSTFT                    *
     C           KRSSX     READE@CUSTFT                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0081' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SXEXIT
     C                     END
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Start of E40226
      * *Return code should be set to *Normal (Blank), NOT
      * *Record already exists
     C                     MOVEL*BLANK    W0RTN            *Return code
      * End of E40226
      * PAR = DB1 By name
     C           KRSSX     READE@CUSTFT                  90*
     C                     END
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * Retrieve for E18502 - Securities Clients  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           BFCUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1DR7     BFCUST           Customer Number
     C           KRSSY     CHAIN@BFREDQ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0094' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SYEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBFCLAS    WUCLAS           Classification
     C                     END
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * Retrieve from shortname - Client Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WACSSN    WQSZ01           Customer Shortn
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WQSZ01           Customer Shortn
      * Move fields to key list
     C                     MOVEL#DDP08    WQSZ01           Customer Shortn
     C           KRSSZ     SETLL@CUSTD5                    *
     C           KRSSZ     READE@CUSTD5                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0081' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SZEXIT
     C                     END
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWACUST    #1DR8            Customer Number
     C           KRSSZ     READE@CUSTD5                  90*
     C                     END
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * Check For Live Client - Client Details  * LN0571
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBCUST    WQTA01           Customer Number
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WQTA01           Customer Number
      * Move fields to key list
     C                     MOVELWUCUST    WQTA01           Customer Number
     C           KRSTA     SETLL@CUSTFT                    *
     C           KRSTA     READE@CUSTFT                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0081' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TAEXIT
     C                     END
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Start of E40226
      * *Return code should be set to *Normal (Blank), NOT
      * *Record already exists
     C                     MOVEL*BLANK    W0RTN            *Return code
      * End of E40226
      * PAR = DB1 By name
     C           KRSTA     READE@CUSTFT                  90*
     C                     END
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * Retrieve for E18502 - Securities Clients  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           BFCUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1DR8     BFCUST           Customer Number
     C           KRSTB     CHAIN@BFREDQ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0094' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TBEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBFCLAS    WUCLAS           Classification
     C                     END
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * Retrieve from shortname - Client Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WACSSN    WQTC01           Customer Shortn
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WQTC01           Customer Shortn
      * Move fields to key list
     C                     MOVEL#DDP09    WQTC01           Customer Shortn
     C           KRSTC     SETLL@CUSTD5                    *
     C           KRSTC     READE@CUSTD5                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0081' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TCEXIT
     C                     END
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWACUST    #1DR9            Customer Number
     C           KRSTC     READE@CUSTD5                  90*
     C                     END
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * Check For Live Client - Client Details  * LN0571
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBCUST    WQTD01           Customer Number
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WQTD01           Customer Number
      * Move fields to key list
     C                     MOVELWUCUST    WQTD01           Customer Number
     C           KRSTD     SETLL@CUSTFT                    *
     C           KRSTD     READE@CUSTFT                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0081' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TDEXIT
     C                     END
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Start of E40226
      * *Return code should be set to *Normal (Blank), NOT
      * *Record already exists
     C                     MOVEL*BLANK    W0RTN            *Return code
      * End of E40226
      * PAR = DB1 By name
     C           KRSTD     READE@CUSTFT                  90*
     C                     END
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * Retrieve for E18502 - Securities Clients  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           BFCUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1DR9     BFCUST           Customer Number
     C           KRSTE     CHAIN@BFREDQ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0094' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TEEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBFCLAS    WUCLAS           Classification
     C                     END
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * Retrieve from shortname - Client Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WACSSN    WQTF01           Customer Shortn
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           WQTF01           Customer Shortn
      * Move fields to key list
     C                     MOVEL#DDP10    WQTF01           Customer Shortn
     C           KRSTF     SETLL@CUSTD5                    *
     C           KRSTF     READE@CUSTD5                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0081' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TFEXIT
     C                     END
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWACUST    #1DR10           Customer Number
     C           KRSTF     READE@CUSTD5                  90*
     C                     END
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * Check For Live Client - Client Details  * LN0571
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBCUST    WQTG01           Customer Number
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           WQTG01           Customer Number
      * Move fields to key list
     C                     MOVELWUCUST    WQTG01           Customer Number
     C           KRSTG     SETLL@CUSTFT                    *
     C           KRSTG     READE@CUSTFT                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0081' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TGEXIT
     C                     END
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Start of E40226
      * *Return code should be set to *Normal (Blank), NOT
      * *Record already exists
     C                     MOVEL*BLANK    W0RTN            *Return code
      * End of E40226
      * PAR = DB1 By name
     C           KRSTG     READE@CUSTFT                  90*
     C                     END
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * Retrieve for E18502 - Securities Clients  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           BFCUST           Customer Number
      * Move fields to key list
     C                     MOVEL#1DR10    BFCUST           Customer Number
     C           KRSTH     CHAIN@BFREDQ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0094' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO THEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBFCLAS    WUCLAS           Classification
     C                     END
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * Retrieve classification - Securities Clients  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTI     KLIST
     C                     KFLD           BFCUST           Customer Number
      * Move fields to key list
     C                     MOVELWUCUST    BFCUST           Customer Number
     C           KRSTI     CHAIN@BFREDQ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0094' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TIEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBFCLAS    WUCLAS           Classification
     C                     END
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * Retrieve classification - Securities Clients  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           BFCUST           Customer Number
      * Move fields to key list
     C                     MOVELWUCUST    BFCUST           Customer Number
     C           KRSTJ     CHAIN@BFREDQ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0094' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TJEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBFCLAS    WUCLAS           Classification
     C                     END
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKCHRC    BEGSR
      *================================================================
      * Change Sec. Trading - Securities Trading Data  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE 'N'       YARDC   1
      *
      * Move key fields to @BVREFE
     C                     MOVEL#1SCTR    BVSCTR           Securities Trad
      *
     C           KLCHTK    KLIST
     C                     KFLD           BVSCTR           Securities Trad
     C           KLCHTK    CHAIN@BVREFE              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TKEXIT
     C                     END
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     GOTO TKEXIT
     C                     END
      *
      * Check for changed record
     C           #1DBRC    IFNE @1DBRC                     IF
     C                     MOVEL'Y2U0007' W0RTN   7
      * Send message '*Update not accepted'
     C                     MOVEL'Y2U0007' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
      * Release record lock
     C                     UNLCKSDSTRDL0               91  *
     C                     GOTO TKEXIT
     C                     END                             FI #1DBRC
      * Store record data for null update check
     C                     MOVE @1DBRC    YARDCS
      * USER: Processing after Data read
      * start E24517
      * save Last Change Date from record
     C                     Z-ADDBVLCD     WULCD            Last Change Dat
      * end E24517
      * Move non-key fields to @BVREFE
     C                     MOVEL#1DMKS    BVDMKS           Default Market
     C                     MOVEL#1DPFS    BVDPFS           Default Portfol
     C                     MOVEL#1DTDS    BVDTDS           Default Transfe
     C                     MOVEL#1CCCY    BVCCCY           Cedel Currency
     C                     MOVEL#1ECBF    BVECBF           E/C Belgian Fra
     C                     MOVEL#1ECDM    BVECDM           E/C Deutsch Mar
     C                     MOVEL#1ECJY    BVECJY           E/C Japanese Ye
     C                     MOVEL#1EUCY    BVEUCY           Euroclear Curre
     C                     MOVEL#1DR1     BVDR1            Depot 1 (EUROCL
     C                     MOVEL#1DR3     BVDR3            Depot Ref 3, Ka
     C                     MOVEL#1DR10    BVDR10           Depot Reference
     C                     MOVEL#1DR2     BVDR2            Depot Reference
     C                     MOVEL#1DR4     BVDR4            Depot Reference
     C                     MOVEL#1DR5     BVDR5            Depot Reference
     C                     MOVEL#1DR6     BVDR6            Depot Reference
     C                     MOVEL#1DR7     BVDR7            Depot Reference
     C                     MOVEL#1DR8     BVDR8            Depot Reference
     C                     MOVEL#1DR9     BVDR9            Depot Reference
     C                     MOVEL#1ATBK    BVATBK           Agency Trading
     C                     MOVEL#1DMBC    BVDMBC           Default Market
     C                     MOVEL#1DPBC    BVDPBC           Default Portfol
     C                     Z-ADDWURDNB    BVLCD            Last Change Dat
     C                     MOVEL'A'       BVTYLC           Type of Last Ch
     C                     MOVEL#1RPB     BVRPB            Realised Profit
     C                     MOVEL#1UPB     BVUPB            Unrealised Prof
     C                     MOVEL#1UPP     BVUPP            Unrealised Prof
     C                     MOVEL#1AUP     BVAUP            Adjust Unrealis
     C                     MOVEL#1SDTR    BVSDTR           Summarise Daily
     C                     MOVEL#1FIFO    BVFIFO           FIFO Accounting
     C                     MOVEL#1SPIN    BVSPIN           Split Purchased
     C                     MOVEL#1SNIN    BVSNIN           Split Negative
     C                     MOVEL#1TSAK    BVTSAK           Trade Subtypes
     C                     MOVEL#1CIAK    BVCIAK           Convertible Ind
     C                     MOVEL#1NPAC    BVNPAC           Negative positi
     C                     MOVEL#1GDPK    BVGDPK           General Disc/Pr
     C                     MOVEL#1SKTV    BVSKTV           Suppress keys o
     C                     MOVEL#1PSDM    BVPSDM           Post no Stnd De
     C                     MOVEL#1CCYE    BVCCYE           Cross Currency
     C                     Z-ADD#1SDOV    BVSDOV           Settlement Desc
     C                     MOVEL#1APST    BVAPST           Autopost Positi
     C                     MOVEL#1MMFQ    BVMMFQ           Mark to Market
     C                     Z-ADD#1MMBD    BVMMBD           Mark to Market
     C                     Z-ADD#1MMND    BVMMND           Mark to Market
     C                     MOVEL#1RBAP    BVRBAP           Reallowance ban
     C                     MOVEL#1CBAP    BVCBAP           Charges in bank
     C                     Z-ADD#1SDUN    BVSDUN           Settlement Desc
     C                     MOVEL#1CMBP    BVCMBP           Commission in b
     C                     MOVEL#1RCAP    BVRCAP           Reallowance cus
     C                     MOVEL#1CCAP    BVCCAP           Charges in cust
     C                     MOVEL#1CMCP    BVCMCP           Commission in c
     C                     Z-ADD#1BVP     BVBVP            Back value peri
     C                     Z-ADD#1ROST    BVROST           Retention of se
     C                     Z-ADD#1RODY    BVRODY           Retention of di
     C                     Z-ADD#1ROMS    BVROMS           Retention of ma
     C                     MOVEL#1EUCD    BVEUCD           Euclid
     C                     MOVEL#1ATI     BVATI            Auto-transmissi
     C                     MOVEL#1DEI     BVDEI            Dealing Events
     C                     MOVEL#1FICI    BVFICI           FI Collateral I
     C                     MOVEL#1REDE    BVREDE           Reprompt defaul
     C                     MOVEL#1TVDV    BVTVDV           Trade/Value Dat
     C                     MOVEL#1TVC     BVTVC            Trade/Value Col
     C                     Z-ADD#1CCYC    BVCCYC           Collateral Curr
     C                     Z-ADD#1FERK    BVFERK           Foreign Exchang
     C                     MOVEL#1MBEX    BVMBEX           Market/Book Exp
     C                     Z-ADD#1AHLF    BVAHLF           All Holdings Li
     C                     Z-ADD#1DLF     BVDLF            Discretionary L
     C                     Z-ADD#1CLF     BVCLF            Customers Limit
     C                     MOVEL#1ROSD    BVROSD           Redemptions on
     C                     MOVEL#1RIDF    BVRIDF           Redemptions in
     C                     MOVEL#1DBCD    BVDBCD           Default brokera
     C                     MOVEL#1BIOP    BVBIOP           Bulk Input Opti
     C                     MOVEL#1ACOP    BVACOP           Autocharge Opti
     C                     MOVEL#1EXOP    BVEXOP           Extel Option
     C                     MOVEL#1TCTY    BVTCTY           Trading Confirm
     C                     MOVEL#1TBRC    BVTBRC           Trade & Book Po
     C                     MOVEL#1RDOT    BVRDOT           Reprompt Defaul
     C                     MOVEL#1AUTH    BVAUTH           Trade Authorisa
     C                     MOVEL#1CHRC    BVCHRC           SE charges curr
     C                     MOVEL#1ACSD    BVACSD           Adjust Comm s/d
     C                     MOVEL#1DEAT    BVDEAT           Default Agency
     C                     MOVEL#1RVBT    BVRVBT           Review Bulk Tra
     C                     MOVEL#1ATPC    BVATPC           Allow Trades P/
     C                     MOVEL#1CUIN    BVCUIN           Safe Custody Fe
     C                     MOVEL#1PBDF    BVPBDF           Priority of Bra
     C                     MOVEL#1PCSD    BVPCSD           Priority of Cus
     C                     MOVEL#1PIDF    BVPIDF           Priority of Inv
     C                     MOVEL#1PMDF    BVPMDF           Priority of Mar
     C                     MOVEL#1POCD    BVPOCD           Priority of Cus
     C                     MOVEL#1TKIF    BVTKIF           Telekurs Interf
     C                     Z-ADD#1ROPS    BVROPS           Retention of Po
     C                     MOVEL#1ERCU    BVERCU           Early Redemptio
     C                     Z-ADD#1TRNR    BVTRNR           Trade Number Ra
     C                     MOVEL#1SEPC    BVSEPC           SE Profit Centr
     C**********           Z-ADD#1HOTC    BVCOTC           Corporate Actio             CSE007 CSD027
     C                     MOVE #1HOTC    BVCOTC           Corporate Actio                    CSD027
     C                     MOVEL#1HOTA    BVCOTA           Trade Subtypes CSE007
     C                     Z-ADD#1HTNR    BVCTNR           Trade Number RaCSE007
     C                     MOVEL#1HLDC    BVALDC           Diff to Dummy  137886
     C                     Z-ADD#1RCTL    BVRCTL           Lower %        CSE006
     C                     Z-ADD#1RCTU    BVRCTU           Upper %        CSE006
     C                     MOVEL#1RMAT    BVRMAT           Maturing Secur CSE006
     C                     MOVEL#1RCPN    BVRCPN           Coupon Payment CSE006
      **********                                                                       CAS006 224354
      ***Move*Historic*Price*from*diplay*file*to*BVBHPP*(file*format)**                CAS006 224354
      **********                                                                       CAS006 224354
     C********** CAS006    IFEQ 'Y'                                                    CAS006 224354
     C**********           Z-ADD#1BHPP    BVBHPP                                       CAS006 224354
     C**********           ENDIF                                                       CAS006 224354
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YARDCS
     C                     MOVE 'Y'       YARDC
     C                     END
      * USER: Processing before Data update
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * CASE: WRK.Window processing requir. is Yes
     C           WUWDPR    IFEQ 'Y'                        *IF
      * CASE: PGM.*Program mode is *DISPLAY
     C           W0PMD     IFEQ 'DSP'                      *IF
     C                     MOVEL'E'       WUWMAC           WM action code
     C                     END                             *FI
      * CASE: PGM.*Program mode is *CHANGE
     C           W0PMD     IFEQ 'CHG'                      *IF
     C                     MOVEL'A'       WUWMAC           WM action code
     C                     END                             *FI
      * WM call Window Manager - Window manager  *
     C/COPY WNCPYSRC,WN0481CCP1                                           S01408
     C***********          CALL 'WIND01'                                  S01212
     C                     CALL 'WN0010'                                  S01212
     C*********************PARM           ##PGM            Program        S01212
     C                     PARM ##PGM     UPGM   10        Program        S01212
     C*********************PARM *BLANK    FKEY    2        Function Key   S01212
     C                     PARM *BLANK    UFKEY   2        Function Key   S01212
     C*********************PARM           WUMEST           Action  S01212 S01229
     C*********************PARM           WUWMAC           Action  S01212 S01229
     C                     PARM 'A'       UACTCD  1        Action  S01212 S01229
     C                     PARM           DATA             Trans Data     S01212
     C                     PARM *BLANK    W0RTN            Return Code    S01212
     C                     PARM           SPARE 256        Spare Field    LN0355
      * WM Check Return
      * CASE: PAR.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: PAR.*Return code is WN Window Error
     C           W0RTN     IFEQ 'USR0563'                  *IF
      * Send message 'WN Window Error'
     C                     MOVEL'USR0563' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO TKEXIT                     *QUIT
     C                     ELSE
      * CASE: PAR.*Return code is *DBF update error
     C           W0RTN     IFEQ 'Y2U0004'                  *IF
      * Send message 'WN Database Error'
     C                     MOVEL'USR0567' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO TKEXIT                     *QUIT
     C                     ELSE
      * CASE: PAR.*Return code is *Previous Screen
     C           W0RTN     IFEQ 'USR0790'                  *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO TKEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 00/Copy member SD9211RBUW - Securities Trading Data  * S01212
     C*
     C/COPY WNCPYSRC,SD9211RBUW
     C*
     C                     END                             *FI
     C                     END                             *FI
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy member SD9211RBDU - Securities Trading Data  * S01212
     C*
     C/COPY WNCPYSRC,SD9211RBDU
     C*
     C                     END                             *FI
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YARDCS
     C                     MOVE 'Y'       YARDC
     C                     END
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BVREFE                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKSDSTRDL0               91  *
     C                     END
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * Update saved record image
     C                     MOVEL@1DBRC    #1DBRC
      * DBF change successful
      * USER: Processing after Data update
      * Start of change CAAA01.
     C                     MOVEL'Y'       WUUPRQ           Update Request
      * Set update SDMMIDPD flag - MIDAS Modules  *
     C                     CALL 'SDC9011'              90  Set update SDMM
     C           WUUPRQ    PARM WUUPRQ    WQ0218  1        Update Request
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SDC9011' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * End of change CAAA01.
      * start E24517 - update Standing Data file controls
      * CASE: WRK.Last Change Date NE WRK.Run day number
     C           WULCD     IFNE WURDNB                     *IF
      * only update file controls if record has not been updated already
     C                     Z-ADD*ZERO     WUNORC           No. of Records
     C                     Z-ADD*ZERO     WUNOIN           No. of Inserts
     C                     Z-ADD*ZERO     WUNODL           No. of Deletes
     C                     Z-ADD1         WUNOAM           No. of Amends
      * Change Standing Data Cont - Standing Data Controls  *
     C                     EXSR TLCHRC
     C                     END                             *FI
      * end E24517
      * Start of SAR S01269
      * Add parameter to call to TABTB36 for the trade authorisation type
      * End of SAR S01269
      * TABTB36 - Securities Trading Data  *
     C                     CALL 'TABTB36'              90  TABTB36
     C           W0RTN     PARM *BLANK    WQ0219  7        *Return code
     C                     PARM BVDMKS    WQ0220  2        Default Market
     C                     PARM BVDPFS    WQ0221  2        Default Portfol
     C                     PARM BVDTDS    WQ0222  2        Default Transfe
     C                     PARM BVCCCY    WQ0223  3        Cedel Currency
     C                     PARM BVECBF    WQ0224  3        E/C Belgian Fra
     C                     PARM BVECDM    WQ0225  3        E/C Deutsch Mar
     C                     PARM BVECJY    WQ0226  3        E/C Japanese Ye
     C                     PARM BVEUCY    WQ0227  3        Euroclear Curre
     C                     PARM BVDR1     WQ0228  6        Depot 1 (EUROCL
     C                     PARM BVDR3     WQ0229  6        Depot Ref 3, Ka
     C                     PARM BVDR10    WQ0230  6        Depot Reference
     C                     PARM BVDR2     WQ0231  6        Depot Reference
     C                     PARM BVDR4     WQ0232  6        Depot Reference
     C                     PARM BVDR5     WQ0233  6        Depot Reference
     C                     PARM BVDR6     WQ0234  6        Depot Reference
     C                     PARM BVDR7     WQ0235  6        Depot Reference
     C                     PARM BVDR8     WQ0236  6        Depot Reference
     C                     PARM BVDR9     WQ0237  6        Depot Reference
     C                     PARM BVATBK    WQ0238  2        Agency Trading
     C                     PARM BVDMBC    WQ0239  2        Default Market
     C                     PARM BVDPBC    WQ0240  2        Default Portfol
     C                     PARM BVLCD     WQ0241  50       Last Change Dat
     C                     PARM 'A'       WQ0242  1        Type of Last Ch
     C                     PARM BVRPB     WQ0243  1        Realised Profit
     C                     PARM BVUPB     WQ0244  1        Unrealised Prof
     C                     PARM BVUPP     WQ0245  1        Unrealised Prof
     C                     PARM BVAUP     WQ0246  1        Adjust Unrealis
     C                     PARM BVSDTR    WQ0247  1        Summarise Daily
     C                     PARM BVFIFO    WQ0248  1        FIFO Accounting
     C                     PARM BVSPIN    WQ0249  1        Split Purchased
     C                     PARM BVSNIN    WQ0250  1        Split Negative
     C                     PARM BVTSAK    WQ0251  1        Trade Subtypes
     C                     PARM BVCIAK    WQ0252  1        Convertible Ind
     C                     PARM BVNPAC    WQ0253  1        Negative positi
     C                     PARM BVGDPK    WQ0254  1        General Disc/Pr
     C                     PARM BVSKTV    WQ0255  1        Suppress keys o
     C                     PARM BVPSDM    WQ0256  1        Post no Stnd De
     C                     PARM BVCCYE    WQ0257  1        Cross Currency
     C                     PARM BVSDOV    WQ0258 130       Settlement Desc
     C                     PARM BVAPST    WQ0259  1        Autopost Positi
     C                     PARM BVMMFQ    WQ0260  1        Mark to Market
     C                     PARM BVMMBD    WQ0261  20       Mark to Market
     C                     PARM BVMMND    WQ0262  50       Mark to Market
     C                     PARM BVRBAP    WQ0263  1        Reallowance ban
     C                     PARM BVCBAP    WQ0264  1        Charges in bank
     C                     PARM BVSDUN    WQ0265 130       Settlement Desc
     C                     PARM BVCMBP    WQ0266  1        Commission in b
     C                     PARM BVRCAP    WQ0267  1        Reallowance cus
     C                     PARM BVCCAP    WQ0268  1        Charges in cust
     C                     PARM BVCMCP    WQ0269  1        Commission in c
     C                     PARM BVBVP     WQ0270  30       Back value peri
     C                     PARM BVROST    WQ0271  20       Retention of se
     C                     PARM BVRODY    WQ0272  20       Retention of di
     C                     PARM BVROMS    WQ0273  20       Retention of ma
     C                     PARM BVEUCD    WQ0274  1        Euclid
     C                     PARM BVATI     WQ0275  1        Auto-transmissi
     C                     PARM BVDEI     WQ0276  1        Dealing Events
     C                     PARM BVFICI    WQ0277  1        FI Collateral I
     C                     PARM BVREDE    WQ0278  1        Reprompt defaul
     C                     PARM BVTVDV    WQ0279  1        Trade/Value Dat
     C                     PARM BVTVC     WQ0280  1        Trade/Value Col
     C                     PARM BVCCYC    WQ0281  30       Collateral Curr
     C                     PARM BVFERK    WQ0282  30       Foreign Exchang
     C                     PARM BVMBEX    WQ0283  1        Market/Book Exp
     C                     PARM BVAHLF    WQ0284  30       All Holdings Li
     C                     PARM BVDLF     WQ0285  30       Discretionary L
     C                     PARM BVCLF     WQ0286  30       Customers Limit
     C                     PARM BVROSD    WQ0287  1        Redemptions on
     C                     PARM BVRIDF    WQ0288  1        Redemptions in
     C                     PARM BVDBCD    WQ0289  2        Default brokera
     C                     PARM BVBIOP    WQ0290  1        Bulk Input Opti
     C                     PARM BVACOP    WQ0291  1        Autocharge Opti
     C                     PARM BVEXOP    WQ0292  1        Extel Option
     C                     PARM BVTCTY    WQ0293  1        Trading Confirm
     C                     PARM BVTBRC    WQ0294  1        Trade & Book Po
     C                     PARM BVRDOT    WQ0295  1        Reprompt Defaul
     C                     PARM BVAUTH    WQ0296  2        Trade Authorisa
     C                     PARM BVCHRC    WQ0297  3        SE charges curr
     C                     PARM BVACSD    WQ0298  1        Adjust Comm s/d
     C                     PARM BVDEAT    WQ0299  1        Default Agency
     C                     PARM BVRVBT    WQ0300  1        Review Bulk Tra
     C                     PARM BVATPC    WQ0301  1        Allow Trades P/
      **********                                                                       CAS006 224354
      ***Historic*Prices*Retention*Period******************************                CAS006 224354
      **********                                                                       CAS006 224354
     C**********           PARM BVBHPP    WQ0318  40                                   CAS006 224354
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'TABTB36' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy member SD9211RADU - Securities Trading Data  * S01212
     C*
     C/COPY WNCPYSRC,SD9211RADU
     C*
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLCHRC    BEGSR
      *================================================================
      * Change Standing Data Cont - Standing Data Controls  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE 'N'       YBRDC   1
      *
      * Move key fields to @AHREAU
     C                     MOVE *BLANK    AHFLNM           Filename
     C                     MOVEL'SDICDRPD'AHFLNM           Filename
      *
     C           KLCHTL    KLIST
     C                     KFLD           AHFLNM           Filename
     C           KLCHTL    CHAIN@AHREAU              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TLEXIT
     C                     END
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     GOTO TLEXIT
     C                     END
      *
      * Store record data for null update check
     C                     MOVE QSDFC1    YBRDCS
      * USER: Processing after Data read
     C                     ADD  AHNORC    WUNORC           No. of Records
     C                     ADD  AHNOIN    WUNOIN           No. of Inserts
     C                     ADD  AHNOAM    WUNOAM           No. of Amends
     C                     ADD  AHNODL    WUNODL           No. of Deletes
      * Move non-key fields to @AHREAU
     C                     Z-ADDWUNORC    AHNORC           No. of Records
     C                     Z-ADDWUNOIN    AHNOIN           No. of Inserts
     C                     Z-ADDWUNOAM    AHNOAM           No. of Amends
     C                     Z-ADDWUNODL    AHNODL           No. of Deletes
      *
      * Set PGM.*Record Data Changed flag
     C           QSDFC1    IFNE YBRDCS
     C                     MOVE 'Y'       YBRDC
     C                     END
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@AHREAU                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKSDFCTLL0               91  *
     C                     END
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     END
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMRVGN    BEGSR
      *================================================================
      * Get Analytical Accounting - MIDAS Modules  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTM     KLIST
     C                     KFLD           BGMODS           Modules
      * Move fields to key list
     C                     MOVE *BLANK    BGMODS           Modules
     C                     MOVEL'MMOD'    BGMODS           Modules
     C           KRSTM     CHAIN@BGREC8              90    *
      * Data record not found
     C   90                MOVEL'USR0096' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Analytical Accounting is Yes
     C           BGN0ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUN0ST           Analytical Acco
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUN0ST           Analytical Acco
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNRVGN    BEGSR
      *================================================================
      * Check Profit Centres Used - General Ledger Details  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTN     KLIST
     C                     KFLD           BKGNLG           General Ledger
      * Move fields to key list
     C                     MOVE *BLANK    BKGNLG           General Ledger
     C                     MOVEL'GELR'    BKGNLG           General Ledger
     C           KRSTN     CHAIN@BKREEC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0199' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TNEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBKPRCU    WUPRCU           Profit Centres
     C                     END
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TORVGN    BEGSR
      *================================================================
      * Get 'Window required' ind - MIDAS Modules  *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTO     KLIST
     C                     KFLD           BGMODS           Modules
      * Move fields to key list
     C                     MOVE *BLANK    BGMODS           Modules
     C                     MOVEL'MMOD'    BGMODS           Modules
     C           KRSTO     CHAIN@BGREC8              90    *
      * Data record not found
     C   90                MOVEL'USR0096' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Window processing requir. is Yes
     C           BGWDPR    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUWDPR           Window processi
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Default Brokerage: Validate
      *================================================================
      * CASE: DTL.default brokerage code is Blank
     C           #1DBCD    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1DBCD    ZA0036           Default brokera
      * Send message 'Enter Default Brokerage'
     C                     MOVEL'USR0525' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,54           *
      *
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Agency Book: Validate
      *================================================================
      * CASE: DTL.Agency Trading Book is equal to blank
     C           #1ATBK    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1ATBK    ZA0037           Agency Trading
      * Send message 'Enter Agency Book'
     C                     MOVEL'USR0526' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,55           *
      *
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Default Brokerage must be blank
      *================================================================
      * CASE: DTL.default brokerage code is Not Blank
     C           #1DBCD    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1DBCD    ZA0038           Default brokera
      * Send message 'Default brokerage entered'
     C                     MOVEL'USR0524' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,54           *
      *
     C                     END                             *FI
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Agency Book must be blank
      *================================================================
      * CASE: DTL.Agency Trading Book is Not Blank
     C           #1ATBK    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1ATBK    ZA0039           Agency Trading
      * Send message 'Book Code entered'
     C                     MOVEL'USR0528' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,55           *
      *
     C                     END                             *FI
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      *
      *================================================================
      * Start of Fix LN0571
      * Check For Live Client - Client Details  * LN0571
     C                     EXSR SFRVGN
      * End of Fix LN0571
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      *
      *================================================================
      * Start of Fix LN0571
      * Check For Live Client - Client Details  * LN0571
     C                     EXSR SIRVGN
      * End of Fix LN0571
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      *
      *================================================================
      * Start of Fix LN0571
      * Check For Live Client - Client Details  * LN0571
     C                     EXSR SLRVGN
      * End of Fix LN0571
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * Depot Reference 4: Select
      *================================================================
     C                     MOVEL#DDP04    WUCAKY           Check For Aster
      * CASE: WRK.Check For Asterisk in Key is Question Mark
     C           WUCAKY    IFEQ '?'                        *IF
      * Select Sec Client Dsp - Securities Clients  *
     C                     CLEARPDRC
     C                     CALL 'SD0342D'              90  Select Sec Clie
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             KEY: Securities
     C           WUCSSN    PARM *BLANK    WQ0169 10        Customer Shortn
     C                     PARM *BLANK    WQ0170 10        Customer Report
     C                     PARM *BLANK    WQ0171 20        Customer Report
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0342D' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     MOVELPDCUST    WUCUST           Customer Number
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Customer Shortname is blank
     C           WUCSSN    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DDP04    ZA0157           Depot 4
      * Send message 'No value selected'
     C                     MOVEL'USR0944' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,37           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWUCUST    #1DR4            Depot Reference
     C                     MOVELWUCSSN    #DDP04           Depot 4
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      *
      *================================================================
      * Start of Fix LN0571
      * Check For Live Client - Client Details  * LN0571
     C                     EXSR SORVGN
      * End of Fix LN0571
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         UJSUBR    BEGSR
      *================================================================
      * Depot Reference 5: Validate
      *================================================================
      * Depot Reference 5: Validate
      * CASE: 2ND.Depot 5 is Not blank
     C           #DDP05    IFNE *BLANK                     *IF
      * Retrieve from shortname - Client Details  *
     C                     EXSR SQRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Start of S01117
      * Removal of test for duplicate depots
      * End of S01117
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#DDP05    WUCUST           Customer Number
     C                     EXSR UKSUBR
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVELWUCUST    #1DR5            Depot Reference
      * Start of S01117
      * Removal of test for duplicate depots
      * End of S01117
     C                     ELSE
      * CASE: *OTHERWISE
      * Start of fix E20422
      * Setup message data for message
     C                     MOVEL#DDP05    ZA0163           Depot 5
      * Send message 'Invalid Customer no/sname'
     C                     MOVEL'USR0352' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,39           *
      *
     C                     GOTO UJEXIT                     *QUIT
      * End of fix E20422
     C                     END                             *FI
     C                     END                             *FI
      * Retrieve for E18502 - Securities Clients  *
     C                     EXSR SSRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#DDP05    ZA0164           Depot 5
      * Send message 'Cust is not a Sec Client'
     C                     MOVEL'USR0539' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,39           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.Classification is M or X
     C           WUCLAS    IFEQ 'X'                        *IF
     C           WUCLAS    OREQ 'M'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DDP05    ZA0165           Depot 5
      * Send message 'Cust not Classified'
     C                     MOVEL'USR0540' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,39           *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#DDP05    #1DR5            Depot Reference
     C                     END                             *FI
      *================================================================
     CSR         UJEXIT    ENDSR
      /EJECT
     CSR         UKSUBR    BEGSR
      *================================================================
      *
      *================================================================
      * Start of Fix LN0571
      * Check For Live Client - Client Details  * LN0571
     C                     EXSR SRRVGN
      * End of Fix LN0571
      *================================================================
     CSR         UKEXIT    ENDSR
      /EJECT
     CSR         ULSUBR    BEGSR
      *================================================================
      * Depot Reference 6: Validate
      *================================================================
      * Depot Reference 6: Validate
      * CASE: 2ND.Depot 6 is Not blank
     C           #DDP06    IFNE *BLANK                     *IF
      * Retrieve from shortname - Client Details  *
     C                     EXSR STRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Start of S01117
      * Removal of test for duplicate depots
      * End of S01117
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#DDP06    WUCUST           Customer Number
     C                     EXSR UMSUBR
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVELWUCUST    #1DR6            Depot Reference
      * Start of S01117
      * Removal of test for duplicate depots
      * End of S01117
     C                     ELSE
      * CASE: *OTHERWISE
      * Start of fix E20422
      * Setup message data for message
     C                     MOVEL#DDP06    ZA0168           Depot 6
      * Send message 'Invalid Customer no/sname'
     C                     MOVEL'USR0352' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,32           *
      *
     C                     GOTO ULEXIT                     *QUIT
      * End of fix E20422
     C                     END                             *FI
     C                     END                             *FI
      * Retrieve for E18502 - Securities Clients  *
     C                     EXSR SVRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#DDP06    ZA0169           Depot 6
      * Send message 'Cust is not a Sec Client'
     C                     MOVEL'USR0539' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,32           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.Classification is M or X
     C           WUCLAS    IFEQ 'X'                        *IF
     C           WUCLAS    OREQ 'M'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DDP06    ZA0170           Depot 6
      * Send message 'Cust not Classified'
     C                     MOVEL'USR0540' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,32           *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#DDP06    #1DR6            Depot Reference
     C                     END                             *FI
      *================================================================
     CSR         ULEXIT    ENDSR
      /EJECT
     CSR         UMSUBR    BEGSR
      *================================================================
      *
      *================================================================
      * Start of Fix LN0571
      * Check For Live Client - Client Details  * LN0571
     C                     EXSR SURVGN
      * End of Fix LN0571
      *================================================================
     CSR         UMEXIT    ENDSR
      /EJECT
     CSR         UNSUBR    BEGSR
      *================================================================
      * Depot Reference 7: Validate
      *================================================================
      * Depot Reference 7: Validate
      * CASE: 2ND.Depot 7 is Not blank
     C           #DDP07    IFNE *BLANK                     *IF
      * Retrieve from shortname - Client Details  *
     C                     EXSR SWRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Start of S01117
      * Removal of test for duplicate depots
      * End of S01117
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#DDP07    WUCUST           Customer Number
     C                     EXSR UOSUBR
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVELWUCUST    #1DR7            Depot Reference
      * Start of S01117
      * Removal of test for duplicate depots
      * End of S01117
     C                     ELSE
      * CASE: *OTHERWISE
      * Start of fix E20422
      * Setup message data for message
     C                     MOVEL#DDP07    ZA0173           Depot 7
      * Send message 'Invalid Customer no/sname'
     C                     MOVEL'USR0352' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,34           *
      *
     C                     GOTO UNEXIT                     *QUIT
      * End of fix E20422
     C                     END                             *FI
     C                     END                             *FI
      * Retrieve for E18502 - Securities Clients  *
     C                     EXSR SYRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#DDP07    ZA0174           Depot 7
      * Send message 'Cust is not a Sec Client'
     C                     MOVEL'USR0539' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,34           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.Classification is M or X
     C           WUCLAS    IFEQ 'X'                        *IF
     C           WUCLAS    OREQ 'M'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DDP07    ZA0175           Depot 7
      * Send message 'Cust not Classified'
     C                     MOVEL'USR0540' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,34           *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#DDP07    #1DR7            Depot Reference
     C                     END                             *FI
      *================================================================
     CSR         UNEXIT    ENDSR
      /EJECT
     CSR         UOSUBR    BEGSR
      *================================================================
      *
      *================================================================
      * Start of Fix LN0571
      * Check For Live Client - Client Details  * LN0571
     C                     EXSR SXRVGN
      * End of Fix LN0571
      *================================================================
     CSR         UOEXIT    ENDSR
      /EJECT
     CSR         UPSUBR    BEGSR
      *================================================================
      * Depot Reference 8: Validate
      *================================================================
      * Depot Reference 8: Validate
      * CASE: 2ND.Depot 8 is Not blank
     C           #DDP08    IFNE *BLANK                     *IF
      * Retrieve from shortname - Client Details  *
     C                     EXSR SZRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Start of S01117
      * Removal of test for duplicate depots
      * End of S01117
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#DDP08    WUCUST           Customer Number
     C                     EXSR UQSUBR
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVELWUCUST    #1DR8            Depot Reference
      * Start of S01117
      * Removal of test for duplicate depots
      * End of S01117
     C                     ELSE
      * CASE: *OTHERWISE
      * Start of fix E20422
      * Setup message data for message
     C                     MOVEL#DDP08    ZA0178           Depot 8
      * Send message 'Invalid Customer no/sname'
     C                     MOVEL'USR0352' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,36           *
      *
     C                     GOTO UPEXIT                     *QUIT
      * End of fix E20422
     C                     END                             *FI
     C                     END                             *FI
      * Retrieve for E18502 - Securities Clients  *
     C                     EXSR TBRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#DDP08    ZA0179           Depot 8
      * Send message 'Cust is not a Sec Client'
     C                     MOVEL'USR0539' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,36           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.Classification is M or X
     C           WUCLAS    IFEQ 'X'                        *IF
     C           WUCLAS    OREQ 'M'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DDP08    ZA0180           Depot 8
      * Send message 'Cust not Classified'
     C                     MOVEL'USR0540' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,36           *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#DDP08    #1DR8            Depot Reference
     C                     END                             *FI
      *================================================================
     CSR         UPEXIT    ENDSR
      /EJECT
     CSR         UQSUBR    BEGSR
      *================================================================
      *
      *================================================================
      * Start of Fix LN0571
      * Check For Live Client - Client Details  * LN0571
     C                     EXSR TARVGN
      * End of Fix LN0571
      *================================================================
     CSR         UQEXIT    ENDSR
      /EJECT
     CSR         URSUBR    BEGSR
      *================================================================
      * Depot Reference 9: Validate
      *================================================================
      * Depot Reference 9: Validate
      * CASE: 2ND.Depot 9 is Not blank
     C           #DDP09    IFNE *BLANK                     *IF
      * Retrieve from shortname - Client Details  *
     C                     EXSR TCRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Start of S01117
      * Removal of test for duplicate depots
      * End of S01117
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#DDP09    WUCUST           Customer Number
     C                     EXSR USSUBR
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVELWUCUST    #1DR9            Depot Reference
      * Start of S01117
      * Removal of test for duplicate depots
      * End of S01117
     C                     ELSE
      * CASE: *OTHERWISE
      * Start of fix E20422
      * Setup message data for message
     C                     MOVEL#DDP09    ZA0183           Depot 9
      * Send message 'Invalid Customer no/sname'
     C                     MOVEL'USR0352' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,38           *
      *
     C                     GOTO UREXIT                     *QUIT
      * End of fix E20422
     C                     END                             *FI
     C                     END                             *FI
      * Retrieve for E18502 - Securities Clients  *
     C                     EXSR TERVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#DDP09    ZA0184           Depot 9
      * Send message 'Cust is not a Sec Client'
     C                     MOVEL'USR0539' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,38           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.Classification is M or X
     C           WUCLAS    IFEQ 'X'                        *IF
     C           WUCLAS    OREQ 'M'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DDP09    ZA0185           Depot 9
      * Send message 'Cust not Classified'
     C                     MOVEL'USR0540' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,38           *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#DDP09    #1DR9            Depot Reference
     C                     END                             *FI
      *================================================================
     CSR         UREXIT    ENDSR
      /EJECT
     CSR         USSUBR    BEGSR
      *================================================================
      *
      *================================================================
      * Start of Fix LN0571
      * Check For Live Client - Client Details  * LN0571
     C                     EXSR TDRVGN
      * End of Fix LN0571
      *================================================================
     CSR         USEXIT    ENDSR
      /EJECT
     CSR         UTSUBR    BEGSR
      *================================================================
      * Depot Reference 10: Validate
      *================================================================
      * Depot Reference 10: Validate
      * CASE: 2ND.Depot 10 is Not blank
     C           #DDP10    IFNE *BLANK                     *IF
      * Retrieve from shortname - Client Details  *
     C                     EXSR TFRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Start of S01117
      * Removal of test for duplicate depots
      * End of S01117
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#DDP10    WUCUST           Customer Number
     C                     EXSR UUSUBR
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVELWUCUST    #1DR10           Depot Reference
      * Start of S01117
      * Removal of test for duplicate depots
      * End of S01117
     C                     ELSE
      * CASE: *OTHERWISE
      * Start of fix E20422
      * Setup message data for message
     C                     MOVEL#DDP10    ZA0188           Depot 10
      * Send message 'Invalid Customer no/sname'
     C                     MOVEL'USR0352' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,40           *
      *
     C                     GOTO UTEXIT                     *QUIT
      * End of fix E20422
     C                     END                             *FI
     C                     END                             *FI
      * Retrieve for E18502 - Securities Clients  *
     C                     EXSR THRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#DDP10    ZA0189           Depot 10
      * Send message 'Cust is not a Sec Client'
     C                     MOVEL'USR0539' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,40           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.Classification is M or X
     C           WUCLAS    IFEQ 'X'                        *IF
     C           WUCLAS    OREQ 'M'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DDP10    ZA0190           Depot 10
      * Send message 'Cust not Classified'
     C                     MOVEL'USR0540' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,40           *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#DDP10    #1DR10           Depot Reference
     C                     END                             *FI
      *================================================================
     CSR         UTEXIT    ENDSR
      /EJECT
     CSR         UUSUBR    BEGSR
      *================================================================
      *
      *================================================================
      * Start of Fix LN0571
      * Check For Live Client - Client Details  * LN0571
     C                     EXSR TGRVGN
      * End of Fix LN0571
      *================================================================
     CSR         UUEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Check reference to Deal Sub-types
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DMKS    WK1X01  1
     C           WK1X01    IFEQ '?'                        Deal Sub-type C
     C                     CALL 'SD0250S'              90  Select Deal Sub
     C                     PARM *BLANK    W0RTN   7
     C           #1DMKS    PARM #1DMKS    WQ0139  2        Deal Sub-type C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0250S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,46           *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VAEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DMKS    IFEQ *BLANK                     Deal Sub-type C
     C                     GOTO VAEXIT
     C                     END
      *
     C           KLVAAS    KLIST
     C                     KFLD           ASDSTC           Deal Sub-type C
      * Setup key
     C                     MOVEL#1DMKS    ASDSTC           Deal Sub-type C
     C           KLVAAS    CHAIN@ASRECO              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VAEXIT
     C                     END
      * Send message 'Deal Sub-types         NF'
     C                     MOVEL'USR0043' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0043' W0RTN
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to Deal Sub-types
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DPFS    WK1X01  1
     C           WK1X01    IFEQ '?'                        Deal Sub-type C
     C                     CALL 'SD0250S'              90  Select Deal Sub
     C                     PARM *BLANK    W0RTN   7
     C           #1DPFS    PARM #1DPFS    WQ0140  2        Deal Sub-type C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0250S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,47           *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VBEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DPFS    IFEQ *BLANK                     Deal Sub-type C
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBAS    KLIST
     C                     KFLD           ASDSTC           Deal Sub-type C
      * Setup key
     C                     MOVEL#1DPFS    ASDSTC           Deal Sub-type C
     C           KLVBAS    CHAIN@ASRECO              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
      * Send message 'Deal Sub-types         NF'
     C                     MOVEL'USR0043' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0043' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Deal Sub-types
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DTDS    WK1X01  1
     C           WK1X01    IFEQ '?'                        Deal Sub-type C
     C                     CALL 'SD0250S'              90  Select Deal Sub
     C                     PARM *BLANK    W0RTN   7
     C           #1DTDS    PARM #1DTDS    WQ0141  2        Deal Sub-type C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0250S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,48           *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DTDS    IFEQ *BLANK                     Deal Sub-type C
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCAS    KLIST
     C                     KFLD           ASDSTC           Deal Sub-type C
      * Setup key
     C                     MOVEL#1DTDS    ASDSTC           Deal Sub-type C
     C           KLVCAS    CHAIN@ASRECO              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Deal Sub-types         NF'
     C                     MOVEL'USR0043' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0043' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check reference to Currency Codes
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1CCCY    WK1X01  1
     C           WK1X01    IFEQ '?'                        Currency Code
     C                     CALL 'SD0020S'              90  Select Currency
     C                     PARM *BLANK    W0RTN   7
     C           #1CCCY    PARM #1CCCY    WQ0142  3        Currency Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0020S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,36           *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VDEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1CCCY    IFEQ *BLANK                     Currency Code
     C                     GOTO VDEXIT
     C                     END
      *
     C           KLVDA6    KLIST
     C                     KFLD           A6CYCD           Currency Code
      * Setup key
     C                     MOVEL#1CCCY    A6CYCD           Currency Code
     C           KLVDA6    CHAIN@A6REA3              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VDEXIT
     C                     END
      * Send message 'Currency Codes         NF'
     C                     MOVEL'USR0071' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0071' W0RTN
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         VECKRL    BEGSR
      *================================================================
      * Check reference to Currency Codes
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1ECBF    WK1X01  1
     C           WK1X01    IFEQ '?'                        Currency Code
     C                     CALL 'SD0020S'              90  Select Currency
     C                     PARM *BLANK    W0RTN   7
     C           #1ECBF    PARM #1ECBF    WQ0143  3        Currency Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0020S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,38           *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VEEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1ECBF    IFEQ *BLANK                     Currency Code
     C                     GOTO VEEXIT
     C                     END
      *
     C           KLVEA6    KLIST
     C                     KFLD           A6CYCD           Currency Code
      * Setup key
     C                     MOVEL#1ECBF    A6CYCD           Currency Code
     C           KLVEA6    CHAIN@A6REA3              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VEEXIT
     C                     END
      * Send message 'Currency Codes         NF'
     C                     MOVEL'USR0071' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0071' W0RTN
      *================================================================
     CSR         VEEXIT    ENDSR
      /EJECT
     CSR         VFCKRL    BEGSR
      *================================================================
      * Check reference to Currency Codes
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1ECDM    WK1X01  1
     C           WK1X01    IFEQ '?'                        Currency Code
     C                     CALL 'SD0020S'              90  Select Currency
     C                     PARM *BLANK    W0RTN   7
     C           #1ECDM    PARM #1ECDM    WQ0144  3        Currency Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0020S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,37           *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VFEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1ECDM    IFEQ *BLANK                     Currency Code
     C                     GOTO VFEXIT
     C                     END
      *
     C           KLVFA6    KLIST
     C                     KFLD           A6CYCD           Currency Code
      * Setup key
     C                     MOVEL#1ECDM    A6CYCD           Currency Code
     C           KLVFA6    CHAIN@A6REA3              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VFEXIT
     C                     END
      * Send message 'Currency Codes         NF'
     C                     MOVEL'USR0071' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0071' W0RTN
      *================================================================
     CSR         VFEXIT    ENDSR
      /EJECT
     CSR         VGCKRL    BEGSR
      *================================================================
      * Check reference to Currency Codes
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1ECJY    WK1X01  1
     C           WK1X01    IFEQ '?'                        Currency Code
     C                     CALL 'SD0020S'              90  Select Currency
     C                     PARM *BLANK    W0RTN   7
     C           #1ECJY    PARM #1ECJY    WQ0145  3        Currency Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0020S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,39           *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VGEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1ECJY    IFEQ *BLANK                     Currency Code
     C                     GOTO VGEXIT
     C                     END
      *
     C           KLVGA6    KLIST
     C                     KFLD           A6CYCD           Currency Code
      * Setup key
     C                     MOVEL#1ECJY    A6CYCD           Currency Code
     C           KLVGA6    CHAIN@A6REA3              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VGEXIT
     C                     END
      * Send message 'Currency Codes         NF'
     C                     MOVEL'USR0071' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0071' W0RTN
      *================================================================
     CSR         VGEXIT    ENDSR
      /EJECT
     CSR         VHCKRL    BEGSR
      *================================================================
      * Check reference to Currency Codes
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1EUCY    WK1X01  1
     C           WK1X01    IFEQ '?'                        Currency Code
     C                     CALL 'SD0020S'              90  Select Currency
     C                     PARM *BLANK    W0RTN   7
     C           #1EUCY    PARM #1EUCY    WQ0146  3        Currency Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0020S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,35           *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VHEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1EUCY    IFEQ *BLANK                     Currency Code
     C                     GOTO VHEXIT
     C                     END
      *
     C           KLVHA6    KLIST
     C                     KFLD           A6CYCD           Currency Code
      * Setup key
     C                     MOVEL#1EUCY    A6CYCD           Currency Code
     C           KLVHA6    CHAIN@A6REA3              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VHEXIT
     C                     END
      * Send message 'Currency Codes         NF'
     C                     MOVEL'USR0071' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0071' W0RTN
      *================================================================
     CSR         VHEXIT    ENDSR
      /EJECT
     CSR         VICKRL    BEGSR
      *================================================================
      * Check reference to Client Details
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DR1     WK1X01  1
     C           WK1X01    IFEQ '?'                        Customer Number
     C                     CALL 'SD0010S'              90  Select Client D
     C                     PARM *BLANK    W0RTN   7
     C           #1DR1     PARM #1DR1     WQ0147  6        Customer Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0010S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VIEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DR1     IFEQ *BLANK                     Customer Number
     C                     GOTO VIEXIT
     C                     END
      *
     C           KLVIBB    KLIST
     C                     KFLD           BBCUST           Customer Number
      * Setup key
     C                     MOVEL#1DR1     BBCUST           Customer Number
     C           KLVIBB    CHAIN@BBREBF              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VIEXIT
     C                     END
      * Send message 'Client Details         NF'
     C                     MOVEL'USR0081' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0081' W0RTN
      *================================================================
     CSR         VIEXIT    ENDSR
      /EJECT
     CSR         VJCKRL    BEGSR
      *================================================================
      * Check reference to Client Details
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DR3     WK1X01  1
     C           WK1X01    IFEQ '?'                        Customer Number
     C                     CALL 'SD0010S'              90  Select Client D
     C                     PARM *BLANK    W0RTN   7
     C           #1DR3     PARM #1DR3     WQ0148  6        Customer Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0010S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VJEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DR3     IFEQ *BLANK                     Customer Number
     C                     GOTO VJEXIT
     C                     END
      *
     C           KLVJBB    KLIST
     C                     KFLD           BBCUST           Customer Number
      * Setup key
     C                     MOVEL#1DR3     BBCUST           Customer Number
     C           KLVJBB    CHAIN@BBREBF              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VJEXIT
     C                     END
      * Send message 'Client Details         NF'
     C                     MOVEL'USR0081' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0081' W0RTN
      *================================================================
     CSR         VJEXIT    ENDSR
      /EJECT
     CSR         VKCKRL    BEGSR
      *================================================================
      * Check reference to Client Details
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DR10    WK1X01  1
     C           WK1X01    IFEQ '?'                        Customer Number
     C                     CALL 'SD0010S'              90  Select Client D
     C                     PARM *BLANK    W0RTN   7
     C           #1DR10    PARM #1DR10    WQ0149  6        Customer Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0010S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VKEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DR10    IFEQ *BLANK                     Customer Number
     C                     GOTO VKEXIT
     C                     END
      *
     C           KLVKBB    KLIST
     C                     KFLD           BBCUST           Customer Number
      * Setup key
     C                     MOVEL#1DR10    BBCUST           Customer Number
     C           KLVKBB    CHAIN@BBREBF              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VKEXIT
     C                     END
      * Send message 'Client Details         NF'
     C                     MOVEL'USR0081' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0081' W0RTN
      *================================================================
     CSR         VKEXIT    ENDSR
      /EJECT
     CSR         VLCKRL    BEGSR
      *================================================================
      * Check reference to Client Details
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DR2     WK1X01  1
     C           WK1X01    IFEQ '?'                        Customer Number
     C                     CALL 'SD0010S'              90  Select Client D
     C                     PARM *BLANK    W0RTN   7
     C           #1DR2     PARM #1DR2     WQ0150  6        Customer Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0010S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VLEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DR2     IFEQ *BLANK                     Customer Number
     C                     GOTO VLEXIT
     C                     END
      *
     C           KLVLBB    KLIST
     C                     KFLD           BBCUST           Customer Number
      * Setup key
     C                     MOVEL#1DR2     BBCUST           Customer Number
     C           KLVLBB    CHAIN@BBREBF              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VLEXIT
     C                     END
      * Send message 'Client Details         NF'
     C                     MOVEL'USR0081' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0081' W0RTN
      *================================================================
     CSR         VLEXIT    ENDSR
      /EJECT
     CSR         VMCKRL    BEGSR
      *================================================================
      * Check reference to Client Details
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DR4     WK1X01  1
     C           WK1X01    IFEQ '?'                        Customer Number
     C                     CALL 'SD0010S'              90  Select Client D
     C                     PARM *BLANK    W0RTN   7
     C           #1DR4     PARM #1DR4     WQ0151  6        Customer Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0010S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VMEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DR4     IFEQ *BLANK                     Customer Number
     C                     GOTO VMEXIT
     C                     END
      *
     C           KLVMBB    KLIST
     C                     KFLD           BBCUST           Customer Number
      * Setup key
     C                     MOVEL#1DR4     BBCUST           Customer Number
     C           KLVMBB    CHAIN@BBREBF              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VMEXIT
     C                     END
      * Send message 'Client Details         NF'
     C                     MOVEL'USR0081' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0081' W0RTN
      *================================================================
     CSR         VMEXIT    ENDSR
      /EJECT
     CSR         VNCKRL    BEGSR
      *================================================================
      * Check reference to Client Details
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DR5     WK1X01  1
     C           WK1X01    IFEQ '?'                        Customer Number
     C                     CALL 'SD0010S'              90  Select Client D
     C                     PARM *BLANK    W0RTN   7
     C           #1DR5     PARM #1DR5     WQ0152  6        Customer Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0010S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VNEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DR5     IFEQ *BLANK                     Customer Number
     C                     GOTO VNEXIT
     C                     END
      *
     C           KLVNBB    KLIST
     C                     KFLD           BBCUST           Customer Number
      * Setup key
     C                     MOVEL#1DR5     BBCUST           Customer Number
     C           KLVNBB    CHAIN@BBREBF              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VNEXIT
     C                     END
      * Send message 'Client Details         NF'
     C                     MOVEL'USR0081' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0081' W0RTN
      *================================================================
     CSR         VNEXIT    ENDSR
      /EJECT
     CSR         VOCKRL    BEGSR
      *================================================================
      * Check reference to Client Details
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DR6     WK1X01  1
     C           WK1X01    IFEQ '?'                        Customer Number
     C                     CALL 'SD0010S'              90  Select Client D
     C                     PARM *BLANK    W0RTN   7
     C           #1DR6     PARM #1DR6     WQ0153  6        Customer Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0010S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VOEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DR6     IFEQ *BLANK                     Customer Number
     C                     GOTO VOEXIT
     C                     END
      *
     C           KLVOBB    KLIST
     C                     KFLD           BBCUST           Customer Number
      * Setup key
     C                     MOVEL#1DR6     BBCUST           Customer Number
     C           KLVOBB    CHAIN@BBREBF              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VOEXIT
     C                     END
      * Send message 'Client Details         NF'
     C                     MOVEL'USR0081' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0081' W0RTN
      *================================================================
     CSR         VOEXIT    ENDSR
      /EJECT
     CSR         VPCKRL    BEGSR
      *================================================================
      * Check reference to Client Details
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DR7     WK1X01  1
     C           WK1X01    IFEQ '?'                        Customer Number
     C                     CALL 'SD0010S'              90  Select Client D
     C                     PARM *BLANK    W0RTN   7
     C           #1DR7     PARM #1DR7     WQ0154  6        Customer Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0010S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VPEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DR7     IFEQ *BLANK                     Customer Number
     C                     GOTO VPEXIT
     C                     END
      *
     C           KLVPBB    KLIST
     C                     KFLD           BBCUST           Customer Number
      * Setup key
     C                     MOVEL#1DR7     BBCUST           Customer Number
     C           KLVPBB    CHAIN@BBREBF              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VPEXIT
     C                     END
      * Send message 'Client Details         NF'
     C                     MOVEL'USR0081' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0081' W0RTN
      *================================================================
     CSR         VPEXIT    ENDSR
      /EJECT
     CSR         VQCKRL    BEGSR
      *================================================================
      * Check reference to Client Details
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DR8     WK1X01  1
     C           WK1X01    IFEQ '?'                        Customer Number
     C                     CALL 'SD0010S'              90  Select Client D
     C                     PARM *BLANK    W0RTN   7
     C           #1DR8     PARM #1DR8     WQ0155  6        Customer Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0010S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VQEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DR8     IFEQ *BLANK                     Customer Number
     C                     GOTO VQEXIT
     C                     END
      *
     C           KLVQBB    KLIST
     C                     KFLD           BBCUST           Customer Number
      * Setup key
     C                     MOVEL#1DR8     BBCUST           Customer Number
     C           KLVQBB    CHAIN@BBREBF              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VQEXIT
     C                     END
      * Send message 'Client Details         NF'
     C                     MOVEL'USR0081' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0081' W0RTN
      *================================================================
     CSR         VQEXIT    ENDSR
      /EJECT
     CSR         VRCKRL    BEGSR
      *================================================================
      * Check reference to Client Details
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DR9     WK1X01  1
     C           WK1X01    IFEQ '?'                        Customer Number
     C                     CALL 'SD0010S'              90  Select Client D
     C                     PARM *BLANK    W0RTN   7
     C           #1DR9     PARM #1DR9     WQ0156  6        Customer Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0010S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VREXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DR9     IFEQ *BLANK                     Customer Number
     C                     GOTO VREXIT
     C                     END
      *
     C           KLVRBB    KLIST
     C                     KFLD           BBCUST           Customer Number
      * Setup key
     C                     MOVEL#1DR9     BBCUST           Customer Number
     C           KLVRBB    CHAIN@BBREBF              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VREXIT
     C                     END
      * Send message 'Client Details         NF'
     C                     MOVEL'USR0081' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0081' W0RTN
      *================================================================
     CSR         VREXIT    ENDSR
      /EJECT
     CSR         VSCKRL    BEGSR
      *================================================================
      * Check reference to Book Details
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1ATBK    WK1X01  1
     C           WK1X01    IFEQ '?'                        Book Code
     C                     CALL 'SD0310S'              90  Select Book Det
     C                     PARM *BLANK    W0RTN   7
     C           #1ATBK    PARM #1ATBK    WQ0157  2        Book Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0310S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,55           *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VSEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1ATBK    IFEQ *BLANK                     Book Code
     C                     GOTO VSEXIT
     C                     END
      *
     C           KLVSBD    KLIST
     C                     KFLD           BDBKCD           Book Code
      * Setup key
     C                     MOVEL#1ATBK    BDBKCD           Book Code
     C           KLVSBD    CHAIN@BDREDK              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VSEXIT
     C                     END
      * Send message 'Book Details           NF'
     C                     MOVEL'USR0085' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0085' W0RTN
      *================================================================
     CSR         VSEXIT    ENDSR
      /EJECT
     CSR         VTCKRL    BEGSR
      *================================================================
      * Check reference to Book Details
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DMBC    WK1X01  1
     C           WK1X01    IFEQ '?'                        Book Code
     C                     CALL 'SD0310S'              90  Select Book Det
     C                     PARM *BLANK    W0RTN   7
     C           #1DMBC    PARM #1DMBC    WQ0158  2        Book Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0310S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,44           *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VTEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DMBC    IFEQ *BLANK                     Book Code
     C                     GOTO VTEXIT
     C                     END
      *
     C           KLVTBD    KLIST
     C                     KFLD           BDBKCD           Book Code
      * Setup key
     C                     MOVEL#1DMBC    BDBKCD           Book Code
     C           KLVTBD    CHAIN@BDREDK              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VTEXIT
     C                     END
      * Send message 'Book Details           NF'
     C                     MOVEL'USR0085' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0085' W0RTN
      *================================================================
     CSR         VTEXIT    ENDSR
      /EJECT
     CSR         VUCKRL    BEGSR
      *================================================================
      * Check reference to Book Details
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DPBC    WK1X01  1
     C           WK1X01    IFEQ '?'                        Book Code
     C                     CALL 'SD0310S'              90  Select Book Det
     C                     PARM *BLANK    W0RTN   7
     C           #1DPBC    PARM #1DPBC    WQ0159  2        Book Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'SD0310S' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,45           *
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C                     GOTO VUEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DPBC    IFEQ *BLANK                     Book Code
     C                     GOTO VUEXIT
     C                     END
      *
     C           KLVUBD    KLIST
     C                     KFLD           BDBKCD           Book Code
      * Setup key
     C                     MOVEL#1DPBC    BDBKCD           Book Code
     C           KLVUBD    CHAIN@BDREDK              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VUEXIT
     C                     END
      * Send message 'Book Details           NF'
     C                     MOVEL'USR0085' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0085' W0RTN
      *================================================================
     CSR         VUEXIT    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y1SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y1EXIT    ENDSR
      /EJECT
     CSR         Y2SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y2EXIT    ENDSR
      /EJECT
     CSR         Y3SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y3EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C           @#DFMT    IFEQ '#RCDKEY'
      * KEY Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     END
     C           @#DFMT    IFEQ '#RCDDTL1'
      * DETAIL Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     END
     C           @#DFMT    IFEQ '#RCDDTL2'
     C           @#DFMT    OREQ '#RCDDT2B'                                CSE006
      * DETAIL 2 Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     END
     C           @#DFMT    IFEQ '#RCDDTL3'
      * DETAIL 3 Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     END
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM 1         YYLGCT  50       # of grps
     C                     PARM W0GRP     YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel and exit from key screen
      *================================================================
      * USER: Exit program processing
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * 00/Copy member SD9211REPP - Securities Trading Data  * S01212
     C*
     C/COPY WNCPYSRC,SD9211REPP
     C*
     C                     END                             *FI
      * CASE: KEY.*CMD key is *Exit
     C           *IN03     IFEQ '1'                        *IF
     C                     MOVEL'**CMD**' P2RTN            *Return code
     C                     MOVEL'CMD01'   P3WRTC           Work Return cod
     C                     END                             *FI
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * ROLLBACK any uncommitted DBF changes
     C                     ROLBK                       90
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Setup job date/time
      *
     C                     Z-ADDUDATE     ##JDT
      * Set century digit (If YY prior to 1940 treat as 20YY)
     C           ##JYY     IFLT 40
     C                     Z-ADD1         ##JCC
     C                     ELSE
     C                     Z-ADD0         ##JCC
     C                     END
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Obtain default message file
     C           *NAMVAR   DEFN Y2MGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field S01212
     C                     MOVEL*BLANK    WUMFTS  1
      * Define work field Func Fld Mat. Period
     C                     MOVEL*BLANK    WUFFMP  6
      * Define work field Func Fld Settled Trades
     C                     MOVEL*BLANK    WUFFST  6
      * Define work field Func Fld Back Valuation
     C                     MOVEL*BLANK    WUFFBV  6
      * Define work field Func Fld Diary Entries
     C                     MOVEL*BLANK    WUFFDE  6
      * Define work field Func Fld Auto Trans
     C                     MOVEL*BLANK    WUFFAT  6
      * Define work field Func Fld Coll Curr Conv
     C                     MOVEL*BLANK    WUFFCC  6
      * Define work field Func Fld FX Risk
     C                     MOVEL*BLANK    WUFFFR  6
      * Define work field Func Fld All Holding Lmt
     C                     MOVEL*BLANK    WUFFAH  6
      * Define work field Func Fld Disc. Limit Fact
     C                     MOVEL*BLANK    WUFFLF  6
      * Define work field Func Fld Cust Limit Fact
     C                     MOVEL*BLANK    WUFFCL  6
      * Define work field Func Fld M to M Base Day
     C                     MOVEL*BLANK    WUFFBD  6
      * Define work field Func Fld M to M Next Date
     C                     MOVEL*BLANK    WUFFND  6
      * Define work field Work Midas Date
     C                     Z-ADD*ZERO     WUWMDT  50
      * Define work field Date format flag
     C                     MOVEL*BLANK    WUDFF   1
      * Define work field Work Converted Date
     C                     Z-ADD*ZERO     WUWCDT  60
      * Define work field Work Alpha Date
     C                     MOVEL*BLANK    WUWADT  7
      * Define work field Currency Code
     C                     MOVEL*BLANK    WUCYCD  3
      * Define work field Number of Decimal Places
     C                     Z-ADD*ZERO     WUNBDP  10
      * Define work field ZALIGN No Of Decimals
     C                     Z-ADD*ZERO     WUZAND  10
      * Define work field ZSEDIT Numeric Input
     C                     Z-ADD*ZERO     WUZSNI 150
      * Define work field ZSEDIT Char Output (21)
     C                     MOVEL*BLANK    WUZSCO 21
      * Define work field ZALIGN Screen Fun Field
     C                     MOVEL*BLANK    WUZASF 16
      * Define work field ZALIGN File Field
     C                     MOVEL*BLANK    WUZAFF 16
      * Define work field Err Code
     C                     MOVEL*BLANK    WUERCD  1
      * Define work field Trade Ret Prd + BVP
     C                     Z-ADD*ZERO     WUTRBV  30
      * Define work field SAR S01448
     C                     MOVEL*BLANK    WUBLKI  1
      * Define work field Dft Broker invalid indic.
     C                     MOVEL*BLANK    WUDBII  1
      * Define work field Profit Centres Used
     C                     MOVEL*BLANK    WUPRCU  1
      * Define work field Analytical Accounting
     C                     MOVEL*BLANK    WUN0ST  1
      * Define work field SAR S01446
     C                     MOVEL*BLANK    WUCUSC  1
      * Define work field Test ? in Key Field
     C                     MOVEL*BLANK    WUTQKF  1
      * Define work field SAR S01464
     C                     MOVEL*BLANK    WURTST  1
      * Define work field Work Screen Date
     C                     Z-ADD*ZERO     WUWSDT  60
      * Define work field Work File Date
     C                     Z-ADD*ZERO     WUWFDT  50
      * Define work field Run day number
     C                     Z-ADD*ZERO     WURDNB  50
      * Define work field ZALIGN No Of Digits
     C                     Z-ADD*ZERO     WUZADG  20
      * Define work field Check For Asterisk in Key
     C                     MOVEL*BLANK    WUCAKY  1
      * Define work field Customer Number
     C                     MOVEL*BLANK    WUCUST  6
      * Define work field Customer Shortname
     C                     MOVEL*BLANK    WUCSSN 10
      * Define work field Classification
     C                     MOVEL*BLANK    WUCLAS  1
      * Define work field Error Code 1
     C                     MOVEL*BLANK    WUERR1  1
      * Define work field Error Code 2
     C                     MOVEL*BLANK    WUERR2  1
      * Define work field Error Code 3
     C                     MOVEL*BLANK    WUERR3  1
      * Define work field Error Code 4
     C                     MOVEL*BLANK    WUERR4  1
      * Define work field Error Code 5
     C                     MOVEL*BLANK    WUERR5  1
      * Define work field Error Code 6
     C                     MOVEL*BLANK    WUERR6  1
      * Define work field Error Code 7
     C                     MOVEL*BLANK    WUERR7  1
      * Define work field Error Code 8
     C                     MOVEL*BLANK    WUERR8  1
      * Define work field Error Code 9
     C                     MOVEL*BLANK    WUERR9  1
      * Define work field SAR S01496
     C                     MOVEL*BLANK    WUJYSK  1
      * Define work field Priority Default in Error
     C                     MOVEL*BLANK    WUPDIE  1
      * Define work field Priority Dft Work String
     C                     MOVEL*BLANK    WUPDWS  1
      * Define work field Priority Dft String
     C                     MOVEL*BLANK    WUPDFS  5
      * Define work field Priority Ind Chrg Dft 1
     C                     MOVEL*BLANK    WUPCD1  1
      * Define work field Priority Ind Chrg Dft 2
     C                     MOVEL*BLANK    WUPCD2  1
      * Define work field Priority Ind Chrg Dft 3
     C                     MOVEL*BLANK    WUPCD3  1
      * Define work field Priority Ind Chrg Dft 4
     C                     MOVEL*BLANK    WUPCD4  1
      * Define work field Priority Ind Chrg Dft 5
     C                     MOVEL*BLANK    WUPCD5  1
      * Define work field field text parameter
     C                     MOVEL*BLANK    WUFTPR256
      * Define work field Work Return code
     C                     MOVEL*BLANK    WUWRTC  5
      * Define work field Work Trade no. range
     C                     Z-ADD*ZERO     WUWTNR  20
      * Define work field Access Pgm Return Code
     C                     MOVEL*BLANK    WUAPRC  7
      * Define work field Error found
     C                     MOVEL*BLANK    WUERFD  1
      * Define work field Last Change Date
     C                     Z-ADD*ZERO     WULCD   50
      * Define work field Window processing requir.
     C                     MOVEL*BLANK    WUWDPR  1
      * Define work field WM action code
     C                     MOVEL*BLANK    WUWMAC  1
      * Define work field Update Request
     C                     MOVEL*BLANK    WUUPRQ  1
      * Define work field No. of Records
     C                     Z-ADD*ZERO     WUNORC  50
      * Define work field No. of Inserts
     C                     Z-ADD*ZERO     WUNOIN  50
      * Define work field No. of Deletes
     C                     Z-ADD*ZERO     WUNODL  50
      * Define work field No. of Amends
     C                     Z-ADD*ZERO     WUNOAM  50
      * Define work field Display Profit Centre
     C                     MOVEL*BLANK    WUDPCT  1
      * Define work field Midas Run Date
     C                     MOVEL*BLANK    WUMRDT  7
      * Define work field Set Up Complete
     C                     MOVEL*BLANK    WUSUC   1
      * Define work field Multi-branching Indicator
     C                     MOVEL*BLANK    WUMBIN  1
      * Define work field SAR number field
     C                     MOVEL*BLANK    WUSARN  6
      * Define work field Access obj dummy DS (76)
     C                     MOVEL*BLANK    WUFDY  76
      * Define work field SAR CSE007                                      CSE007
     C                     MOVEL*BLANK    WUCOAC  1                       CSE007
      * Define work field SAR CEU017                                      CEU017
     C                     MOVEL*BLANK    WUEURO  1                       CEU017
      *                                                                   CSE006
      * Define work field CSE006                                          CSE006
     C                     MOVEL*BLANK    WUCSE6  1                       CSE006
      *                                                                   CSE006
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      **********                                                                       CAS006 224354
      ***Define*work*field*for*CAS006**********************************                CAS006 224354
      **********                                                                       CAS006 224354
     C********** CAS006    IFEQ 'Y'                                                    CAS006 224354
     C**********           MOVE *BLANKS   WUBHPP  4                                    CAS006 224354
     C**********           ENDIF                                                       CAS006 224354
      * Open files
      * Begin commit control
     C                     CALL 'Y2BGCMC'
     C                     PARM           W0RTN   7
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'CPF8351'
     C                     EXSR ZYEXPG
     C                     END
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     OPEN SD9211R#
     C                     OPEN SDSTRDL1
     C                     OPEN SDBANKL1
     C                     OPEN SDCURRL1
     C                     OPEN SDPRFCL1
     C                     OPEN SDDLSTL1
     C                     OPEN SDCUSTL1
     C                     OPEN SDBOOKL1
     C                     OPEN SDCUSTL2
     C                     OPEN SDCUSTL5
     C                     OPEN SDSECSL1
     C                     OPEN SDMMODL1
     C                     OPEN SDGELRL1
     C                     OPEN SDSTRDL0
     C                     OPEN SDFCTLL0
     C                     MOVEL'N'       W0PMT   1
      * Initialise error memories
     C                     MOVE *ZERO     @@I1
     C                     MOVE *ZERO     @@I2
     C                     MOVE *ZERO     @@I3
      * Set to *CHANGE mode
     C                     MOVEL'CHG'     W0PMD   3
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * Start of S01459
      * SD9211R Precompiler - Securities Trading Data  *
      * End of S01459
      * Copyright Statement 1988 - Standard Functions  * copyright
      * Get Rundate - Rundate  *
     C           *NAMVAR   DEFN           RUNDAT
     C                     IN   RUNDAT
     C                     MOVE MRDT      ##MRDT  7        RUN DATE
     C                     MOVE MRDT      WUMRDT
     C                     MOVE RDNB      WURDNB           RUNDAY NO.
     C                     MOVE SUC       WUSUC            SET UP COMPLT
     C                     MOVE DFF       WUDFF            DTE FMT FLAG
     C                     MOVE MBIN      WUMBIN           MULTI BR. IND
     C                     MOVEL'Y'       WUMFTS           S01212
      * Start of change S01446
      * Check to see if S01446 - Corrency Commissions - is present.
     C                     MOVEL'S01446'  WUSARN           SAR number fiel
      * SAR switched on check - Standard Functions  *
     C                     CALL 'AOSARDR0'             90  SAR switched on
     C           WUAPRC    PARM WUAPRC    WQ0302  7        Access Pgm Retu
     C                     PARM '*VERIFY' WQ0303  7        Option for ACCO
     C           WUSARN    PARM WUSARN    WQ0304  6        SAR number fiel
     C                     PARM WUFDY     WQ0305 76        Access obj dumm
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'AOSARDR0'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Check return code.
      * CASE: WRK.Access Pgm Return Code is *Normal
     C           WUAPRC    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       WUCUSC           SAR S01446
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUCUSC           SAR S01446
     C                     END                             *FI
      * End of change S01446
      * Start of change S01448
      * Check to see if S01448 - Bulk Input Enhancements - is present.
     C                     MOVEL'S01448'  WUSARN           SAR number fiel
      * SAR switched on check - Standard Functions  *
     C                     CALL 'AOSARDR0'             90  SAR switched on
     C           WUAPRC    PARM WUAPRC    WQ0306  7        Access Pgm Retu
     C                     PARM '*VERIFY' WQ0307  7        Option for ACCO
     C           WUSARN    PARM WUSARN    WQ0308  6        SAR number fiel
     C                     PARM WUFDY     WQ0309 76        Access obj dumm
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'AOSARDR0'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Check return code.
      * CASE: WRK.Access Pgm Return Code is *Normal
     C           WUAPRC    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       WUBLKI           SAR S01448
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUBLKI           SAR S01448
     C                     END                             *FI
      * End of change S01448
      * Start of change S01464
      * Check to see if S01464 - Safe Custody Fees - is present.
     C                     MOVEL'S01464'  WUSARN           SAR number fiel
      * SAR switched on check - Standard Functions  *
     C                     CALL 'AOSARDR0'             90  SAR switched on
     C           WUAPRC    PARM WUAPRC    WQ0310  7        Access Pgm Retu
     C                     PARM '*VERIFY' WQ0311  7        Option for ACCO
     C           WUSARN    PARM WUSARN    WQ0312  6        SAR number fiel
     C                     PARM WUFDY     WQ0313 76        Access obj dumm
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'AOSARDR0'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Check return code.
      * CASE: WRK.Access Pgm Return Code is *Normal
     C           WUAPRC    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       WURTST           SAR S01464
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WURTST           SAR S01464
     C                     END                             *FI
      * End of change S01464
      * Start of change S01496.
      * Check to see if the Jyske Enhancements feature is present.
      * Priority Default DS - Securities Trading Data  *
     C                     MOVEL'S01496'  WUSARN           SAR number fiel
      * SAR switched on check - Standard Functions  *
     C                     CALL 'AOSARDR0'             90  SAR switched on
     C           WUAPRC    PARM WUAPRC    WQ0314  7        Access Pgm Retu
     C                     PARM '*VERIFY' WQ0315  7        Option for ACCO
     C           WUSARN    PARM WUSARN    WQ0316  6        SAR number fiel
     C                     PARM WUFDY     WQ0317 76        Access obj dumm
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'AOSARDR0'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Check return code.
      * CASE: WRK.Access Pgm Return Code is *Normal
     C           WUAPRC    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       WUJYSK           SAR S01496
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUJYSK           SAR S01496
     C                     END                             *FI
      * End of change S01496.
      *                                                                   CSE007
      ** Start of change CSE007.                                          CSE007
      ** Check if Corporate Action feature is present.                    CSE007
      *                                                                   CSE007
     C                     MOVEL'CSE007'  WUSARN           SAR number fielCSE007
      * SAR switched on check - Standard Functions  *                     CSE007
     C                     CALL 'AOSARDR0'             90  SAR switched onCSE007
     C           WUAPRC    PARM WUAPRC    PRTCD   7        Access Pgm RetuCSE007
     C                     PARM '*VERIFY' POPTN   7        Option for ACCOCSE007
     C           WUSARN    PARM WUSARN    PRTTY   6        SAR number fielCSE007
     C                     PARM WUFDY     PUFDY  76        Access obj dummCSE007
      *                                                                   CSE007
     C           *IN90     IFEQ '1'                                       CSE007
      * Call to program ended in error                                    CSE007
     C                     MOVEL'Y2U0032' W0RTN                           CSE007
     C                     MOVEL*BLANKS   W0CLPG 10                       CSE007
     C                     MOVEL'AOSARDR0'W0CLPG                          CSE007
      * Send message '*Error occured on CALL...'                          CSE007
     C                     MOVEL'Y2U0032' ZAMSID                          CSE007
     C                     MOVEL'Y2USRMSG'ZAMSGF                          CSE007
     C                     MOVELW0CLPG    ZAMSDA           Message data   CSE007
     C                     EXSR ZASNMS                                    CSE007
     C                     ENDIF                                          CSE007
      *                                                                   CSE007
     C                     MOVE '0'       *IN80                           CSE007
      *                                                                   CSE007
      * Check return code.                                                CSE007
      * CASE: WRK.Access Pgm Return Code is *Normal                       CSE007
     C           WUAPRC    IFEQ *BLANK                     *IF            CSE007
     C                     MOVE '1'       *IN80                           CSE007
     C                     MOVEL'Y'       WUCOAC           SAR CSE007     CSE007
     C                     ELSE                                           CSE007
      * CASE: *OTHERWISE                                                  CSE007
     C                     MOVEL'N'       WUCOAC           SAR CSE007     CSE007
     C                     ENDIF                           *FI            CSE007
      *                                                                   CSE007
      ** End of change CSE007.                                            CSE007
      *                                                                   CSE007
      *                                                                   CEU017
      ** Start of change CEU017.                                          CEU017
      ** Check if Corporate Action feature is present.                    CEU017
      *                                                                   CEU017
     C                     MOVEL'CEU017'  WUSARN           SAR number fielCEU017
      * SAR switched on check - Standard Functions  *                     CEU017
     C                     CALL 'AOSARDR0'             90  SAR switched onCEU017
     C           WUAPRC    PARM WUAPRC    PRTCD   7        Access Pgm RetuCEU017
     C                     PARM '*VERIFY' POPTN   7        Option for ACCOCEU017
     C           WUSARN    PARM WUSARN    PRTTY   6        SAR number fielCEU017
     C                     PARM WUFDY     PUFDY  76        Access obj dummCEU017
      *                                                                   CEU017
     C           *IN90     IFEQ '1'                                       CEU017
      * Call to program ended in error                                    CEU017
     C                     MOVEL'Y2U0032' W0RTN                           CEU017
     C                     MOVEL*BLANKS   W0CLPG 10                       CEU017
     C                     MOVEL'AOSARDR0'W0CLPG                          CEU017
      * Send message '*Error occured on CALL...'                          CEU017
     C                     MOVEL'Y2U0032' ZAMSID                          CEU017
     C                     MOVEL'Y2USRMSG'ZAMSGF                          CEU017
     C                     MOVELW0CLPG    ZAMSDA           Message data   CEU017
     C                     EXSR ZASNMS                                    CEU017
     C                     ENDIF                                          CEU017
      *                                                                   CEU017
      * Check return code.                                                CEU017
      * CASE: WRK.Access Pgm Return Code is *Normal                       CEU017
     C           WUAPRC    IFEQ *BLANK                     *IF            CEU017
     C                     MOVE '1'       *IN80                           CEU017
     C                     MOVEL'Y'       WUEURO           SAR CEU017     CEU017
     C                     ELSE                                           CEU017
      * CASE: *OTHERWISE                                                  CEU017
     C                     MOVEL'N'       WUEURO           SAR CEU017     CEU017
     C                     ENDIF                           *FI            CEU017
      *                                                                   CEU017
      ** End of change CEU017.                                            CEU017
      *                                                                   CEU017
      *                                                                   CSE006
      *** Use access program AOSARDR0 to retrieve switchable features     CSE006
      *                                                                   CSE006
     C                     MOVEL'CSE006'  WUSARN           SAR number fielCSE006
      *                                                                   CSE006
      *** SAR switched on check - Standard Functions  *                   CSE006
      *                                                                   CSE006
     C                     CALL 'AOSARDR0'             90  SAR switched onCSE006
     C           WUAPRC    PARM WUAPRC    PRTCD   7        Access Pgm RetuCSE006
     C                     PARM '*VERIFY' POPTN   7        Option for ACCOCSE006
     C           WUSARN    PARM WUSARN    PRTTY   6        SAR number fielCSE006
     C                     PARM WUFDY     PUFDY  76        Access obj dummCSE006
      *                                                                   CSE006
      *** If call to program ended in error                               CSE006
      *                                                                   CSE006
     C           *IN90     IFEQ '1'                                       CSE006
      *                                                                   CSE006
     C                     MOVEL'Y2U0032' W0RTN                           CSE006
     C                     MOVEL*BLANKS   W0CLPG 10                       CSE006
     C                     MOVEL'AOSARDR0'W0CLPG                          CSE006
      *                                                                   CSE006
      *** Send message '*Error occured on CALL...'                        CSE006
      *                                                                   CSE006
     C                     MOVEL'Y2U0032' ZAMSID                          CSE006
     C                     MOVEL'Y2USRMSG'ZAMSGF                          CSE006
     C                     MOVELW0CLPG    ZAMSDA           Message data   CSE006
     C                     EXSR ZASNMS                                    CSE006
     C                     END                                            CSE006
      *                                                                   CSE006
      ***  Otherwise check return code.                                   CSE006
      *                                                                   CSE006
     C           WUAPRC    IFEQ *BLANK                                    CSE006
     C                     MOVEL'Y'       WUCSE6                          CSE006
     C                     ELSE                                           CSE006
      ***  Else                                                           CSE006
     C                     MOVEL'N'       WUCSE6                          CSE006
     C                     ENDIF                                          CSE006
      *                                                                   CSE006
      **********                                                                       CAS006 224354
     C**********           CALL 'AOSARDR0'                                             CAS006 224354
     C**********           PARM *BLANKS   PRTCD                                        CAS006 224354
     C**********           PARM '*VERIFY 'POPTN                                        CAS006 224354
     C**********           PARM 'CAS006'  PRTTY                                        CAS006 224354
     C**********           PARM WUFDY     PUFDY                                        CAS006 224354
      **********                                                                       CAS006 224354
     C********** PRTCD     IFNE *BLANKS                                                CAS006 224354
     C********** PRTCD     ANDNE'*NRF   '                                              CAS006 224354
     C**********           MOVEL'Y2U0032' W0RTN                                        CAS006 224354
     C**********           MOVEL*BLANKS   W0CLPG                                       CAS006 224354
     C**********           MOVEL'AOSARDR0'W0CLPG                                       CAS006 224354
     C**********           MOVEL'Y2U0032' ZAMSID                                       CAS006 224354
     C**********           MOVEL'Y2USRMSG'ZAMSGF                                       CAS006 224354
     C**********           MOVELW0CLPG    ZAMSDA                                       CAS006 224354
     C**********           EXSR ZASNMS                                                 CAS006 224354
     C**********           ENDIF                                                       CAS006 224354
      **********                                                                       CAS006 224354
     C********** PRTCD     IFEQ *BLANKS                                                CAS006 224354
     C**********           MOVE 'Y'       CAS006  1                                    CAS006 224354
     C**********           ELSE                                                        CAS006 224354
     C**********           MOVE 'N'       CAS006                                       CAS006 224354
     C**********           MOVE *ON       *IN65                                        CAS006 224354
     C**********           ENDIF                                                       CAS006 224354
      **********                                                                       CAS006 224354
     C/COPY WNCPYSRC,SD9211RC01
      * Start CAC001
      * Get Analytical Accounting - MIDAS Modules  *
     C                     EXSR TMRVGN
      * Check Profit Centres Used - General Ledger Details  *
     C                     EXSR TNRVGN
      * Display Securities Profit Centre ?
      * CASE: WRK.Analytical Accounting is Yes
     C           WUN0ST    IFEQ 'Y'                        *IF
      * CASE: WRK.Profit Centres Used is Yes
     C           WUPRCU    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUDPCT           Display Profit
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUDPCT           Display Profit
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUDPCT           Display Profit
     C                     END                             *FI
      * End CAC001
      * Windows and /COPYs.
      * CASE: WRK.S01212 is Fix installed
     C           WUMFTS    IFEQ 'Y'                        *IF
      * Get 'Window required' ind - MIDAS Modules  *
     C                     EXSR TORVGN
      * Data Struct. for Sec. Trd - Securities Trading Data  *
      * 00/Copy member SD9211RFPG - Securities Trading Data  * S01212
      * 00/Copy member SD9211REPG - Securities Trading Data  * S01212
      * 00/Copy member SD9211RIPG - Securities Trading Data  * S01212
      * 00/Copy member SD9211RCPG - Securities Trading Data  * S01212
     C*
     C/COPY WNCPYSRC,SD9211RCPG
     C*
      * 00/Copy member SD9211ROPG - Securities Trading Data  * S01212
     C                     END                             *FI
      *================================================================
     CSR         ZZEXIT    ENDSR
      /EJECT
     CSR         *PSSR     BEGSR
      *****************************************************************
      *                                                               *
      * *PSSR  - Program exception error routine                      *
      *          Called automatically if a program error occurs,      *
      *          or directly by the program code using EXSR.          *
      *          This subroutine DUMPs the program just once.         *
      *                                                               *
      *****************************************************************
      *
      * Core function specific processing.
      *
     C/COPY WNCPYSRC,SD9211RPSC
      *
      * Start of PSSR user point.
      *
     C/COPY WNCPYSRC,SD9211RPS1
      *
      * Standard Midas PSSR processing.
      *
     C/COPY SDCPYSRC,SDPSSRICD
      *
      * End of PSSR user point.
      *
     C/COPY WNCPYSRC,SD9211RPS2
      *
      *================================================================
     CSR                   ENDSR
      *****************************************************************                CAS006 224354
      */EJECT***                                                                       CAS006 224354
      *****************************************************************                CAS006 224354
      **********                                                      *                CAS006 224354
      **SRCHNO*-*Subroutine*that*checks*if*#DBHPP*is*numeric.**********                CAS006 224354
      **********                                                      *                CAS006 224354
      *****************************************************************                CAS006 224354
     C********** SRCHNO    BEGSR                                                       CAS006 224354
      **********                                                                       CAS006 224354
      ***Store*current*value*ZAMSGF*and*use*GBY2USRMSG*****************                CAS006 224354
      **********                                                                       CAS006 224354
     C**********           MOVELZAMSGF    WZAMSG 10                                    CAS006 224354
     C**********           MOVEL'Y2USRMSG'ZAMSGF                                       CAS006 224354
      **********                                                                       CAS006 224354
      ***If*Historic*Price*is*blank************************************                CAS006 224354
      **********                                                                       CAS006 224354
     C********** #DBHPP    IFEQ *BLANK                                                 CAS006 224354
     C**********           MOVEL#DBHPP    ZA0232                                       CAS006 224354
     C**********           MOVEL'Y2U0001' ZAMSID                                       CAS006 224354
     C**********           EXSR ZASNMS                                                 CAS006 224354
     C**********           MOVE *ON       *IN99                                        CAS006 224354
     C**********           MOVEL'1'       @I1,64                                       CAS006 224354
      **********                                                                       CAS006 224354
     C**********           ELSE                                                        CAS006 224354
      **********                                                                       CAS006 224354
      ***Test*if*#DBHPP*is*numeric*************************************                CAS006 224354
      **********                                                                       CAS006 224354
     C**********           CALL 'ZALIGN'                                               CAS006 224354
     C**********           PARM *BLANK    PZRTN   7                                    CAS006 224354
     C**********           PARM #DBHPP    PZFLD  16                                    CAS006 224354
     C**********           PARM *ZERO     PZADEC  10                                   CAS006 224354
     C**********           PARM 4         PZADIG  20                                   CAS006 224354
     C**********           PARM *BLANK    PZAFLD 16                                    CAS006 224354
      **********                                                                       CAS006 224354
      ***Setup*error*message*if*call*to*ZALIGN*ended*in*error**********                CAS006 224354
      **********                                                                       CAS006 224354
     C********** PZRTN     IFNE *BLANK                                                 CAS006 224354
     C********** PZRTN     ANDNE'*ERROR*'                                              CAS006 224354
     C**********           MOVEL*BLANKS   W0CLPG                                       CAS006 224354
     C**********           MOVEL'ZALIGN'  W0CLPG                                       CAS006 224354
     C**********           MOVEL'Y2U0032' ZAMSID                                       CAS006 224354
     C**********           MOVELW0CLPG    ZAMSDA                                       CAS006 224354
     C**********           EXSR ZASNMS                                                 CAS006 224354
     C**********           ENDIF                                                       CAS006 224354
      **********                                                                       CAS006 224354
      ***Setup*error*message*if*#DBHPP*is*not*numeric******************                CAS006 224354
      **********                                                                       CAS006 224354
     C********** PZRTN     IFNE *BLANK                                                 CAS006 224354
     C**********           MOVEL'Y2U0010' ZAMSID                                       CAS006 224354
     C**********           EXSR ZASNMS                                                 CAS006 224354
     C**********           MOVE *ON       *IN99                                        CAS006 224354
     C**********           MOVEL'1'       @I1,64                                       CAS006 224354
      **********                                                                       CAS006 224354
      ***else,*put*the*numeric*value*of*#DBHPP*to*#1BHPP***************                CAS006 224354
      **********                                                                       CAS006 224354
     C**********           ELSE                                                        CAS006 224354
     C**********           MOVE PZAFLD    #1BHPP                                       CAS006 224354
      **********                                                                       CAS006 224354
      ***Historic*Price*must*be*greater*than*Back*Value*Period*********                CAS006 224354
      **********                                                                       CAS006 224354
     C********** #1BHPP    IFLE #1BVP                                                  CAS006 224354
     C**********           MOVEL'Y2U0065' ZAMSID                                       CAS006 224354
     C**********           EXSR ZASNMS                                                 CAS006 224354
     C**********           MOVE *ON       *IN99                                        CAS006 224354
     C**********           MOVEL'1'       @I1,64                                       CAS006 224354
     C**********           ENDIF                                                       CAS006 224354
     C**********           ENDIF                                                       CAS006 224354
     C**********           ENDIF                                                       CAS006 224354
      **********                                                                       CAS006 224354
      ***Return*the*original*value*of*ZAMSGF***************************                CAS006 224354
      **********                                                                       CAS006 224354
     C**********           MOVELWZAMSG    ZAMSGF                                       CAS006 224354
      **********                                                                       CAS006 224354
     C**********           ENDSR                                                       CAS006 224354
      *================================================================
     O*
     O*
     O/COPY WNCPYSRC,SD9211ROPG
     O*
**
ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789
** CPY@     : Copyright notice for inclusion in all programs
(c) Misys International Banking Systems Ltd. 2001
