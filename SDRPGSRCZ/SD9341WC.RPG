000100230707     H        1
000200230707      *****************************************************************
000300230707/*STD *  RPGBASE                                                      *
000400230707/*EXI *  TEXT('Midas ICD For New Retail-Window controller')
000500230707     F*****************************************************************
000600230707     F*                                                               *
000700230707     F*  Midas   Standing Data Module
000800230707     F*                                                               *
000900230707     F*  SD9341WC - ICD FOR NEW RETAIL - WINDOW CONTROLER             *
001000230707     F*                                                               *
001100230707      *  (c) Finastra International Limited 2001                      *
001200230707     F*                                                               *
001201230707      *  Last Amend No. AR1006692          Date 07Jul23               *
001300230707      *  Prev Amend No. MD046248           Date 27Oct17               *
001400230707      * Bank Fusion Midas 1.4 Base -----------------------------------*
001500230707      * Midas Plus 1.4 Base 04 ---------------------------------------*
001600230707      * Midas Plus 1.4 Base ------------------------------------------*
001700230707      * Midas Plus 1.3 ----------- Base ------------------------------*
001800230707      *                 CSD031             Date 10Apr06               *
001900230707      *                 CSD027             Date 09Dec05               *
002000230707      *                 CGL029             Date 01Sep03               *
002100230707      * Midas Release 4 --------------- Base -------------------------*
002200230707      * Midas DBA 3.00 ---------------- Base -------------------------*
002300230707      *                 CSD005             Date 01Mar99               *
002400230707      *                 CTI002             Date 23Sep98               *
002500230707     F*                 062539             DATE 19NOV93               *
002600230707     F*                 S01413 *CREATE     DATE 13APR93               *
002700230707     F*                                                               *
002800230707     F*****************************************************************
002900230707     F*                                                               *
002901230707      *  AR1006692 - The system does not accept American date format. *
002902230721      *              Fix is to read RUNDAT.  (Child: AR1006693)       *
003000230707      *  MD046248 - Finastra Rebranding                               *
003100230707      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
003200230707      *  CSD027 - Conversion Of Customer Number to Alpha              *
003300230707      *  CGL029 - Increase Account Code to 10 digits                  *
003400230707      *  CSD005 - Standing Data Account Narrative.  Add new field     *
003500230707      *           to SDACODPD.  Recompilation of programs.            *
003600230707      *  CTI002 - Recompiled : File SDACODPD changed                  *
003700230707     F*  062539 - Checks for title only accounts and also validates   *
003800230707     F*           income flag .                                       *
003900230707     F*  S01413 - Retail 3 Incorporation.                             *
004000230707     F*                                                               *
004100230707     F*****************************************************************
004200230707     F*  C R E A T I O N     P A R A M E T E R S                      *
004300230707     F*                                                               *
004400230707     F*                                                               *
004500230707     F*****************************************************************
004600230707     FTABTREY0IF  E           K        DISK
004700230707     F            TABTREF0                          KRENAMERTVIDX
004800230707     F*                                Retreival index
004900230707     FTABTREXCUF  E           K        DISK         KCOMIT       A
005000230707     F            TABTREF0                          KRENAMEUPDIDX
005100230707     F*                                Update index
005200230707     FTABTBRE IF  E                    DISK
005300230707     F*
005400230707     FSD9341W#CF  E                    WORKSTN
005500230707     F            SD9341F0                          KRENAMESCREEN
005600230707     F            SD9341F1                          KRENAMESCREEN1
005700230707     F            SD9341F2                          KRENAMESCREEN2
005800230707     F*                                Display file
005900230707     F/EJECT
006000230707     F*****************************************************************
006100230707     F*
006200230707     F*   U S E   O F     I N D I C A T O R S
006300230707     F*
006400230707     F*  (Screen field error indicators should start with 20 in
006500230707     F*   ascending order)
006600230707     F*
006700230707     F*  *IN10  -  On=Delete/Enquiry, Protect field.
006800230707     F*            Off=Insert/Amdend, Underline field.
006900230707     F*  *IN11  -  On=Delete - Display 'F10=Confirm Delete'
007000230707     F*  *IN20  -  Invalid #1SCIA field
007100230707     F*  *IN21  -  Invalid #1ACIA field
007200230707     F*  *IN22  -  Invalid #1ACCD field
007300230707     F*  *IN23  -  Invalid #1ACCF field
007400230707     F*  *IN24  -  Invalid #1ACBD field
007500230707     F*  *IN30  -  Field numeric
007600230707     F*  *IN70  -  Extension record not found via update index
007700230707     F*  *IN71  -  Unable to allocate record via update index
007800230707     F*  *IN72  -  Statement charges processed
007900230707     F*  *IN73  -  Fixed A/C charges processed
008000230707     F*  *IN75  -  General error indicator. Used to condition output
008100230707     F*  *IN78  -  Error occured during DBF update
008200230707     F*            of error messages and redisplay screen.
008300230707     F*  *IN80  -  Unable to allocate extension record
008400230707     F*  *IN81  -  Call to DBERRCTL ended in error
008500230707     F*  *IN88  -  Data base error indicator
008600230707     F*  *IN89  -  Extension record not found via retrieval index
008700230707     F*  *INKJ  -  F10 pressed, enable delete
008800230707     F*  *INKL  -  F12 pressed, exit
008900230707     F*  *INLR  -  End processing
009000230707     F*****************************************************************
009100230707     E/EJECT
009200230707     E                    ZYDY    4   4  4 0             ZDATE2 SR.ARRAY
009300230707     E                    ZMDY   13  13  3 0             ZDATE2 SR.ARRAY
009400230707     E                    ZMNM   12  12  3               ZDATE2 SR.ARRAY
009500230707     E                    CPY@    1   1 80               COPYRIGHT
009600230707     I/EJECT
009700230707     I*                                                                -
009800230707     I           SDS
009900230707     I*
010000230707     I** Get program name from PSDS
010100230707     I*
010200230707     I                                     *PROGRAM WWPGM
010300230707     I*
010400230707     INWRCD     E DSTABTREXC
010500230707     I*
010600230707     I** Current/previous master file fields
010700230707     I*
010800230707     I*
010900230707     I***SVRCD**  DS                             15                                           CGL029
011000230707     ISVRCD       DS                             35                                           CGL029
011100230707     I*
011200230707     I** Stored master file fields
011300230707     I*
011400230707     IRUNDAT      DS
011500230707     I                                       12  12 DATF
011501230707     I                                       13  13 MBIN                                   AR1006692
011600230707     I*                                      13  13 MBIN
011700230707     I** Data Area Rundat
011800230707     I*
011900230707     I*
012000230707     I** Get the data structure passed from calling program
012100230707     I*
012200230707     I/COPY QWINDSRC,SD9341DTA
012300230707     I*
012400230707     ISDACOD    E DSSDACODPD
012500230707     I*
012600230707     I** Account Code Details
012700230707     I*
012800230707     IDSFDY     E DSDSFDY
012900230707     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE
013000230707     I*
013100230707     IDSSDY     E DSDSSDY
013200230707     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE
013300230707     C/EJECT
013400230707     C*---------------------------------------------------------------
013500230707     C* Main processing
013600230707     C*---------------------------------------------------------------
013700230707     C*
013800230707     C** Copyright Statement
013900230707     C*
014000230707     C                     MOVEACPY@      BIS@   80
014100230707     C*
014200230707     C** Execute initial routine
014300230707     C*
014400230707     C                     EXSR SRINIT
014500230707     C*
014600230707     C** Execute specific routine depending on action
014700230707     C*
014800230707     C           ACTION    CASEQ'I'       SRINS
014900230707     C           ACTION    CASEQ'A'       SRAMD
015000230707     C           ACTION    CASEQ'E'       SRENQ
015100230707     C           ACTION    CASEQ'D'       SRDEL
015200230707     C                     END
015300230707     C*
015400230707     C** Execute routine to setup return code and exit program
015500230707     C*
015600230707     C                     EXSR SRRTRN
015700230707     C*
015800230707     C/EJECT
015900230707     C*---------------------------------------------------------------
016000230707     C* SRINS - Routine to handle 'INSERT' action
016100230707     C*---------------------------------------------------------------
016200230707     C*
016300230707     C           SRINS     BEGSR
016400230707     C*
016500230707     C** Check whether record exists
016600230707     C*
016700230707     C                     EXSR SRREC
016800230707     C*
016900230707     C** If record found,
017000230707     C** set DB error indicator, setup message, display screen, exit
017100230707     C*
017200230707     C           *IN89     IFEQ '0'
017300230707     C*
017400230707     C                     MOVE '1'       *IN88
017500230707     C                     MOVEL'WNE9995' ZAMSID
017600230707     C                     EXSR SRSMSG
017700230707     C*
017800230707     C** Initialize fields with file values for display
017900230707     C*
018000230707     C                     EXSR SRFTOS
018100230707     C*
018200230707     C** Protect fields for display
018300230707     C*
018400230707     C                     MOVE '1'       *IN10
018500230707     C*
018600230707     C** Display screen
018700230707     C*
018800230707     C                     EXSR SRSCRN
018900230707     C*
019000230707     C** Execute DB error routine
019100230707     C*
019200230707     C                     EXSR SRDBER
019300230707     C*
019400230707     C                     ELSE
019500230707     C*
019600230707     C** Record not found, initialize fields
019700230707     C*
019800230707     C                     EXSR SRINZ
019900230707     C*
020000230707     C** Display and handle screen until no more errors or F12
020100230707     C*
020200230707     C           *IN75     DOUEQ'0'
020300230707     C           *INKL     OREQ '1'
020400230707     C*
020500230707     C                     EXSR SRSCRN
020600230707     C*
020700230707     C** Bypass any further validation if previous DB error or F12
020800230707     C*
020900230707     C           *IN88     IFEQ '0'
021000230707     C           *INKL     ANDEQ'0'
021100230707     C*
021200230707     C** Clear messages for redisplay
021300230707     C*
021400230707     C                     EXSR SRCMSG
021500230707     C*
021600230707     C** Validate input
021700230707     C*
021800230707     C                     EXSR SRVAL
021900230707     C*
022000230707     C** No errors
022100230707     C*
022200230707     C           *IN75     IFEQ '0'
022300230707     C*
022400230707     C** Move screen fields to file fields
022500230707     C*
022600230707     C                     EXSR SRSTOF
022700230707     C*
022800230707     C** Write new record
022900230707     C*
023000230707     C                     EXSR SRWRT
023100230707     C*
023200230707     C                     END
023300230707     C                     END
023400230707     C                     END
023500230707     C                     END
023600230707     C*
023700230707     C                     ENDSR
023800230707     C/EJECT
023900230707     C*---------------------------------------------------------------
024000230707     C* SRAMD - Routine to handle 'AMEND' action
024100230707     C*---------------------------------------------------------------
024200230707     C*
024300230707     C           SRAMD     BEGSR
024400230707     C*
024500230707     C** Check whether record exists
024600230707     C*
024700230707     C                     EXSR SRREC
024800230707     C*
024900230707     C** If record not found,
025000230707     C** set DB error indicator, setup message, display screen, exit
025100230707     C*
025200230707     C           *IN89     IFEQ '1'
025300230707     C*
025400230707     C                     MOVE '1'       *IN88
025500230707     C                     MOVEL'WNE9999' ZAMSID
025600230707     C                     EXSR SRSMSG
025700230707     C*
025800230707     C** Protect fields for display
025900230707     C*
026000230707     C                     MOVE '1'       *IN10
026100230707     C*
026200230707     C** Display screen
026300230707     C*
026400230707     C                     EXSR SRSCRN
026500230707     C*
026600230707     C**Execute DB error routine
026700230707     C*
026800230707     C                     EXSR SRDBER
026900230707     C*
027000230707     C                     ELSE
027100230707     C*
027200230707     C** Record found,
027300230707     C** set file fields to screen fields and save before image
027400230707     C*
027500230707     C                     EXSR SRFTOS
027600230707     C                     EXSR SRSAVE
027700230707     C*
027800230707     C** Display and handle screen until record can be allocated and
027900230707     C** record on file and no errors left or F12 pressed
028000230707     C*
028100230707     C           *IN71     DOUEQ'0'
028200230707     C           *IN70     ANDEQ'0'
028300230707     C           *IN75     ANDEQ'0'
028400230707     C           *INKL     OREQ '1'
028500230707     C*
028600230707     C                     EXSR SRSCRN
028700230707     C*
028800230707     C** Bypass any further validation if previous DB error or F12
028900230707     C*
029000230707     C           *IN88     IFEQ '0'
029100230707     C           *INKL     ANDEQ'0'
029200230707     C*
029300230707     C** Clear messages for redisplay
029400230707     C*
029500230707     C                     EXSR SRCMSG
029600230707     C*
029700230707     C** Validate input
029800230707     C*
029900230707     C                     EXSR SRVAL
030000230707     C*
030100230707     C** No errors
030200230707     C*
030300230707     C           *IN75     IFEQ '0'
030400230707     C*
030500230707     C** Allocate record via update index
030600230707     C*
030700230707     C                     EXSR SRALOC
030800230707     C*
030900230707     C** If record on file and allocated, compare record images,
031000230707     C** else, screen will be redisplayed
031100230707     C*
031200230707     C           *IN70     IFEQ '0'
031300230707     C           *IN71     ANDEQ'0'
031400230707     C*
031500230707     C                     EXSR SRCOMP
031600230707     C*
031700230707     C** If images do not match, screen will be redisplayed with
031800230707     C** relevant message
031900230707     C*
032000230707     C           WWMTCH    IFEQ 'Y'
032100230707     C*
032200230707     C** Images match, move screen values to file fields
032300230707     C*
032400230707     C                     EXSR SRSTOF
032500230707     C*
032600230707     C** Update record
032700230707     C*
032800230707     C                     EXSR SRUPD
032900230707     C*
033000230707     C                     END
033100230707     C*
033200230707     C                     END
033300230707     C*
033400230707     C                     END
033500230707     C*
033600230707     C                     END
033700230707     C*
033800230707     C                     END
033900230707     C*
034000230707     C                     END
034100230707     C*
034200230707     C                     ENDSR
034300230707     C/EJECT
034400230707     C*----------------------------------------------------------------
034500230707     C* SRDEL - Routine to handle 'DELETE' action
034600230707     C*----------------------------------------------------------------
034700230707     C*
034800230707     C           SRDEL     BEGSR
034900230707     C*
035000230707     C** Set indicators on for 'DELETE' mode to protect fields
035100230707     C*
035200230707     C                     MOVE '1'       *IN10
035300230707     C*
035400230707     C** Check whether record exists
035500230707     C*
035600230707     C                     EXSR SRREC
035700230707     C*
035800230707     C** If record not found,
035900230707     C** set DB error indicator, setup message, display screen, exit
036000230707     C*
036100230707     C           *IN89     IFEQ '1'
036200230707     C*
036300230707     C                     MOVE '1'       *IN88
036400230707     C                     MOVEL'WNE9996' ZAMSID
036500230707     C                     EXSR SRSMSG
036600230707     C*
036700230707     C* Disable F10 key
036800230707     C*
036900230707     C                     MOVE '0'       *IN11
037000230707     C*
037100230707     C* Display screen
037200230707     C*
037300230707     C                     EXSR SRSCRN
037400230707     C*
037500230707     C** Execute DB error routine
037600230707     C*
037700230707     C                     EXSR SRDBER
037800230707     C*
037900230707     C                     ELSE
038000230707     C*
038100230707     C** Record found,
038200230707     C** set file fields to screen fields and save before image
038300230707     C*
038400230707     C                     EXSR SRFTOS
038500230707     C                     EXSR SRSAVE
038600230707     C*
038700230707     C** Enable F10 key
038800230707     C*
038900230707     C                     MOVE '1'       *IN11
039000230707     C*
039100230707     C** Display and handle screen until record can be allocated and
039200230707     C** record on file and F10 pressed or F12 pressed
039300230707     C*
039400230707     C           *IN71     DOUEQ'0'
039500230707     C           *IN70     ANDEQ'0'
039600230707     C           *INKJ     ANDEQ'1'
039700230707     C           *INKL     OREQ '1'
039800230707     C*
039900230707     C                     EXSR SRSCRN
040000230707     C*
040100230707     C** F12 not pressed, F10 pressed
040200230707     C*
040300230707     C           *INKL     IFEQ '0'
040400230707     C           *INKJ     ANDEQ'1'
040500230707     C*
040600230707     C** Allocate record via update index
040700230707     C*
040800230707     C                     EXSR SRALOC
040900230707     C*
041000230707     C** If record on file and allocated, compare record images,
041100230707     C** else, screen will be redisplayed
041200230707     C*
041300230707     C           *IN70     IFEQ '0'
041400230707     C           *IN71     ANDEQ'0'
041500230707     C*
041600230707     C                     EXSR SRCOMP
041700230707     C*
041800230707     C** If images do not match, screen will be redisplayed with
041900230707     C** relevant message
042000230707     C*
042100230707     C           WWMTCH    IFEQ 'Y'
042200230707     C*
042300230707     C** Images match, delete record
042400230707     C*
042500230707     C                     EXSR SRDELR
042600230707     C*
042700230707     C                     END
042800230707     C*
042900230707     C                     END
043000230707     C*
043100230707     C                     END
043200230707     C*
043300230707     C                     END
043400230707     C*
043500230707     C                     END
043600230707     C*
043700230707     C                     ENDSR
043800230707     C/EJECT
043900230707     C*-----------------------------------------------------------------
044000230707     C* SRENQ - Routine to handle 'ENQUIRY' action
044100230707     C*-----------------------------------------------------------------
044200230707     C*
044300230707     C           SRENQ     BEGSR
044400230707     C*
044500230707     C** Set indicators on for 'ENQUIRY' mode to protect fields
044600230707     C*
044700230707     C                     MOVE '1'       *IN10
044800230707     C*
044900230707     C** Check whether record exists
045000230707     C*
045100230707     C                     EXSR SRREC
045200230707     C*
045300230707     C** If record not found,
045400230707     C** set DB error indicator, setup message, display screen, exit
045500230707     C*
045600230707     C           *IN89     IFEQ '1'
045700230707     C*
045800230707     C                     MOVE '1'       *IN88
045900230707     C                     MOVEL'WNE9994' ZAMSID
046000230707     C                     EXSR SRSMSG
046100230707     C*
046200230707     C** Protect fields
046300230707     C*
046400230707     C                     MOVE '1'       *IN10
046500230707     C*
046600230707     C** Display screen
046700230707     C*
046800230707     C                     EXSR SRSCRN
046900230707     C*
047000230707     C** Execute DB error routine
047100230707     C*
047200230707     C                     EXSR SRDBER
047300230707     C*
047400230707     C                     ELSE
047500230707     C*
047600230707     C** Record found, set file fields to screen fields
047700230707     C*
047800230707     C                     EXSR SRFTOS
047900230707     C*
048000230707     C** Display and handle screen
048100230707     C*
048200230707     C                     EXSR SRSCRN
048300230707     C*
048400230707     C                     END
048500230707     C*
048600230707     C                     ENDSR
048700230707     C/EJECT
048800230707     C*--------------------------------------------------------------
048900230707     C* SRSMSG - Routine to send messages to message subfile.
049000230707     C*--------------------------------------------------------------
049100230707     C*
049200230707     C           SRSMSG    BEGSR
049300230707     C*
049400230707     C** If message file not set up, use default
049500230707     C*
049600230707     C           ZAMSGF    IFEQ *BLANKS
049700230707     C                     MOVELWWDMSF    ZAMSGF
049800230707     C                     END
049900230707     C*
050000230707     C                     CALL 'SNDERMSG'
050100230707     C                     PARM WWPGM     ZAPGM  10        Program queue
050200230707     C                     PARM           ZAPGRL  5        Rel queue
050300230707     C                     PARM           ZAMSID  7        Message Id.
050400230707     C                     PARM           ZAMSGF 10        Message file.
050500230707     C                     PARM           ZAMSDA132        Message data.
050600230707     C                     PARM           ZAMSTP  7        Message type.
050700230707     C*
050800230707     C* Clear all fields for default mechanism next time.
050900230707     C*
051000230707     C                     MOVEL*BLANKS   ZAPGRL           Rel queue
051100230707     C                     MOVEL*BLANKS   ZAMSID           Message Id.
051200230707     C                     MOVEL*BLANKS   ZAMSGF           Message file.
051300230707     C                     MOVEL*BLANKS   ZAMSDA           Message data.
051400230707     C                     MOVEL*BLANKS   ZAMSTP           Message type.
051500230707     C*
051600230707     C                     ENDSR
051700230707     C/EJECT
051800230707     C*-------------------------------------------------------------
051900230707     C* SRCMSG - Routine to clear program's message queue.
052000230707     C*-------------------------------------------------------------
052100230707     C*
052200230707     C           SRCMSG    BEGSR
052300230707     C*
052400230707     C                     CALL 'CLRERMSG'
052500230707     C                     PARM WWPGM     ZAPGM
052600230707     C                     PARM '*SAME'   ZAPGRL
052700230707     C*
052800230707     C                     ENDSR
052900230707     C/EJECT
053000230707     C*-------------------------------------------------------------
053100230707     C* SRREC - Routine to access file via retrieve index
053200230707     C*-------------------------------------------------------------
053300230707     C*
053400230707     C           SRREC     BEGSR
053500230707     C*
053600230707     C           KLIST     CHAINRTVIDX               89
053700230707     C*
053800230707     C                     ENDSR
053900230707     C/EJECT
054000230707     C*-------------------------------------------------------------
054100230707     C* SRALOC - Routine to access record via update index
054200230707     C*--------------------------------------------------------------
054300230707     C*
054400230707     C           SRALOC    BEGSR
054500230707     C*
054600230707     C           KLIST     CHAINUPDIDX               7071
054700230707     C*
054800230707     C** If record not on file, setup message 'Record deleted'
054900230707     C*
055000230707     C           *IN70     IFEQ '1'
055100230707     C                     MOVEL'WNE9998' ZAMSID
055200230707     C                     EXSR SRSMSG
055300230707     C                     END
055400230707     C*
055500230707     C                     ENDSR
055600230707     C/EJECT
055700230707     C*-------------------------------------------------------------
055800230707     C* SRUPD - Routine to update file.
055900230707     C*-------------------------------------------------------------
056000230707     C*
056100230707     C           SRUPD     BEGSR
056200230707     C*
056300230707     C                     UPDATUPDIDX                 78
056400230707     C*
056500230707     C                     COMIT
056600230707     C*
056700230707     C                     ENDSR
056800230707     C/EJECT
056900230707     C*-----------------------------------------------------------
057000230707     C* SRWRT - Routine to write a new record to the file.
057100230707     C*--------------------------------------------------------------
057200230707     C*
057300230707     C           SRWRT     BEGSR
057400230707     C*
057500230707     C                     WRITEUPDIDX                 78
057600230707     C*
057700230707     C                     COMIT
057800230707     C*
057900230707     C                     ENDSR
058000230707     C/EJECT
058100230707     C*-------------------------------------------------------------
058200230707     C* SRDELR - Routine to delete a record
058300230707     C*-------------------------------------------------------------
058400230707     C*
058500230707     C           SRDELR    BEGSR
058600230707     C*
058700230707     C                     DELETUPDIDX                 78
058800230707     C*
058900230707     C                     ENDSR
059000230707     C/EJECT
059100230707     C*--------------------------------------------------------------
059200230707     C* SRCOMP - Routine to compare before/after image of records
059300230707     C*--------------------------------------------------------------
059400230707     C*
059500230707     C           SRCOMP    BEGSR
059600230707     C*
059700230707     C           SVRCD     IFEQ NWRCD
059800230707     C                     MOVE 'Y'       WWMTCH  1
059900230707     C                     ELSE
060000230707     C                     MOVE 'N'       WWMTCH
060100230707     C                     MOVEL'WNE9997' ZAMSID
060200230707     C                     EXSR SRSMSG
060300230707     C*
060400230707     C** Use SETLL to release record lock
060500230707     C*
060600230707     C           KLIST     SETLLUPDIDX
060700230707     C*
060800230707     C** Set condition to redisplay screen
060900230707     C*
061000230707     C                     MOVE '1'       *IN70
061100230707     C*
061200230707     C                     END
061300230707     C*
061400230707     C                     ENDSR
061500230707     C/EJECT
061600230707     C*------------------------------------------------------------
061700230707     C* SRSAVE - Routine to save before image of record via DS
061800230707     C*--------------------------------------------------------------
061900230707     C*
062000230707     C           SRSAVE    BEGSR
062100230707     C*
062200230707     C                     MOVELNWRCD     SVRCD
062300230707     C*
062400230707     C                     ENDSR
062500230707     C/EJECT
062600230707     C*--------------------------------------------------------------
062700230707     C* SRRTRN - Routine to set up return code for calling program
062800230707     C*--------------------------------------------------------------
062900230707     C*
063000230707     C           SRRTRN    BEGSR
063100230707     C*
063200230707     C** DBF update error
063300230707     C*
063400230707     C           *IN78     IFEQ '1'
063500230707     C                     MOVE 'USR0563' WWRTRN
063600230707     C                     ROLBK
063700230707     C                     ELSE
063800230707     C** Database error
063900230707     C*
064000230707     C           *IN88     IFEQ '1'
064100230707     C                     MOVE 'Y2U0004' WWRTRN
064200230707     C                     ROLBK
064300230707     C                     ELSE
064400230707     C*
064500230707     C** F12 pressed
064600230707     C*
064700230707     C           *INKL     IFEQ '1'
064800230707     C                     MOVE 'USR0790' WWRTRN
064900230707     C                     ELSE
065000230707     C*
065100230707     C** No errors
065200230707     C*
065300230707     C                     MOVE *BLANKS   WWRTRN
065400230707     C                     END
065500230707     C*
065600230707     C                     END
065700230707     C*
065800230707     C                     END
065900230707     C*
066000230707     C** Exit program
066100230707     C*
066200230707     C                     MOVE '1'       *INLR
066300230707     C*
066400230707     C                     ENDSR
066500230707     C/EJECT
066600230707     C*----------------------------------------------------------
066700230707     C* SRDBER - Routine to handle database errors
066800230707     C*----------------------------------------------------------
066900230707     C*
067000230707     C           SRDBER    BEGSR
067100230707     C*
067200230707     C** Dump program
067300230707     C*
067400230707     C           @RUN      IFEQ *BLANK
067500230707     C                     MOVE 'Y'       @RUN    1
067600230707     C                     DUMP
067700230707     C                     END
067800230707     C*
067900230707     C** Call standard DB error handler
068000230707     C*
068100230707     C                     CALL 'DBERRCTL'             81
068200230707     C*
068300230707     C                     ENDSR
068400230707     C/EJECT
068500230707     C*----------------------------------------------------------
068600230707     C* SRSCRN - Routine to handle screen and validation
068700230707     C*----------------------------------------------------------
068800230707     C*
068900230707     C           SRSCRN    BEGSR
069000230707     C*
069100230707     C** Display messages
069200230707     C*
069300230707     C                     WRITE#MSGCTL
069400230707     C*
069500230707     C** Display main screen
069600230707     C*
069700230707     C           *IN72     IFEQ '1'
069800230707     C           *IN73     ANDEQ'1'
069900230707     C                     EXFMTSCREEN
070000230707     C                     ELSE
070100230707     C           *IN72     IFEQ '1'
070200230707     C                     EXFMTSCREEN1
070300230707     C                     ELSE
070400230707     C           *IN73     IFEQ '1'
070500230707     C                     EXFMTSCREEN2
070600230707     C                     END
070700230707     C                     END
070800230707     C                     END
070900230707     C*
071000230707     C                     ENDSR
071100230707     C/EJECT
071200230707     C*---------------------------------------------------------
071300230707     C* The routines that can be changed start here...
071400230707     C*---------------------------------------------------------
071500230707     C* SRVAL - Routine to control validation of each field.
071600230707     C*---------------------------------------------------------
071700230707     C*
071800230707     C           SRVAL     BEGSR
071900230707     C*
072000230707     C** Initialize error condition indicators
072100230707     C*
072200230707     C                     MOVE '0'       *IN75
072300230707     C                     MOVEA'00000000'*IN,20
072400230707     C*
072500230707     C** Validate each screen field.
072600230707     C*
072700230707     C** #1SCIA validation
072800230707     C*
072900230707     C           *IN72     IFEQ '1'
073000230707     C                     EXSR SCIATS
073100230707     C                     END
073200230707     C           *IN73     IFEQ '1'
073300230707     C*
073400230707     C** #1ACIA validation
073500230707     C*
073600230707     C                     EXSR ACIATS
073700230707     C*
073800230707     C** #1ACCD validation
073900230707     C*
074000230707     C                     EXSR ACCDTS
074100230707     C*
074200230707     C** #1ACCF validation
074300230707     C*
074400230707     C                     EXSR ACCFTS
074500230707     C*
074600230707     C** #1ACBD validation
074700230707     C*
074800230707     C                     EXSR ACBDTS
074900230707     C                     END
075000230707     C*
075100230707     C                     ENDSR
075200230707     C/EJECT
075300230707     C****************************************************************
075400230707     C*                                                              *
075500230707     C* SCIATS - CHECK STATEMENT CHARGE INCOME ACCOUNT CODE FIELD    *
075600230707     C*                                                              *
075700230707     C*                                                              *
075800230707     C****************************************************************
075900230707     C           SCIATS    BEGSR
076000230707     C*
076100230707     C** Validate field
076200230707     C** If no value is entered, display message for mandatory field.
076300230707     C*
076400230707     C                     MOVE '0'       *IN20
076500230707     C                     MOVE '0'       *IN30
076600230707     C                     MOVE '0'       *IN50
076700230707     C*
076800230707     C           #1SCIA    IFEQ *BLANKS
076900230707     C*
077000230707     C                     MOVEL'LZW1501' ZAMSID
077100230707     C                     MOVEL'REUSRMSG'ZAMSGF
077200230707     C                     MOVE '1'       *IN20
077300230707     C                     MOVE '1'       *IN75
077400230707     C                     EXSR SRSMSG
077500230707     C*
077600230707     C                     ELSE
077700230707     C*
077800230707     C** Test numeric
077900230707     C*
078000230707     C**********           MOVEL#1SCIA    NUM5    50                                          CGL029
078100230707     C**********           MOVELNUM5      ALP4    4                                           CGL029
078200230707     C                     MOVEL#1SCIA    NUM5   110                                          CGL029
078300230707     C                     MOVELNUM5      ALP4   10                                           CGL029
078400230707     C*
078500230707     C           ALP4      IFLE #1SCIA
078600230707     C                     MOVE '1'       *IN30
078700230707     C                     END
078800230707     C*
078900230707     C           *IN30     IFEQ '1'
079000230707     C*
079100230707     C** If field is input, access on FILE/SDACODL0
079200230707     C*
079300230707     C                     CALL 'AOACODR0'
079400230707     C                     PARM *BLANKS   @RTCD   7
079500230707     C                     PARM '*KEY    '@OPTN   7
079600230707     C**********           PARM #1SCIA    @ACOD   4                                           CGL029
079700230707     C                     PARM #1SCIA    @ACOD  10                                           CGL029
079800230707     C           SDACOD    PARM SDACOD    DSFDY
079900230707     C*
080000230707     C** If chain failed, display message for invalid  field.
080100230707     C*
080200230707     C           @RTCD     IFNE *BLANKS
080300230707     C*
080400230707     C                     MOVEL'LZW1502' ZAMSID
080500230707     C                     MOVEL'REUSRMSG'ZAMSGF
080600230707     C                     MOVE '1'       *IN20
080700230707     C                     MOVE '1'       *IN75
080800230707     C                     EXSR SRSMSG
080900230707     C                     END
081000230707     C*
081100230707     C           A5ACTY    IFEQ 'R'
081200230707     C                     MOVEL'LZW1508' ZAMSID
081300230707     C                     MOVEL'REUSRMSG'ZAMSGF
081400230707     C                     MOVE '1'       *IN20
081500230707     C                     MOVE '1'       *IN75
081600230707     C                     EXSR SRSMSG
081700230707     C                     END
081800230707     C*                                                                   062539
081900230707     C*  Check for title only accounts                                    062539
082000230707     C*                                                                   062539
082100230707     C           A5TOIN    IFEQ 'Y'                                       062539
082200230707     C                     MOVEL'WND0002' ZAMSID                          062539
082300230707     C                     MOVEL'MIDAS   'ZAMSGF                          062539
082400230707     C                     MOVE '1'       *IN20                           062539
082500230707     C                     MOVE '1'       *IN75                           062539
082600230707     C                     EXSR SRSMSG                                    062539
082700230707     C                     END                                            062539
082800230707     C*                                                                   062539
082900230707     C*  Must be Income or Expense                                        062539
083000230707     C*                                                                   062539
083100230707     C           A5ACSC    IFNE 'IN'                                      062539
083200230707     C           A5ACSC    ANDNE'EX'                                      062539
083300230707     C                     MOVEL'WND0003' ZAMSID                          062539
083400230707     C                     MOVEL'MIDAS   'ZAMSGF                          062539
083500230707     C                     MOVE '1'       *IN20                           062539
083600230707     C                     MOVE '1'       *IN75                           062539
083700230707     C                     EXSR SRSMSG                                    062539
083800230707     C                     END                                            062539
083900230707     C*
084000230707     C                     ELSE
084100230707     C*
084200230707     C                     MOVEL'LZW1502' ZAMSID
084300230707     C                     MOVEL'REUSRMSG'ZAMSGF
084400230707     C                     MOVE '1'       *IN20
084500230707     C                     MOVE '1'       *IN75
084600230707     C                     EXSR SRSMSG
084700230707     C                     END
084800230707     C                     END
084900230707     C*
085000230707     C                     ENDSR
085100230707     C/EJECT
085200230707     C****************************************************************
085300230707     C*                                                              *
085400230707     C* ACIATS - CHECK ACCOUNT CHARGE INCOME ACCOUNT CODE FIELD      *
085500230707     C*                                                              *
085600230707     C*                                                              *
085700230707     C****************************************************************
085800230707     C           ACIATS    BEGSR
085900230707     C*
086000230707     C** Validate field
086100230707     C** If no value is entered, display message for mandatory field.
086200230707     C*
086300230707     C                     MOVE '0'       *IN21
086400230707     C                     MOVE '0'       *IN30
086500230707     C                     MOVE '0'       *IN50
086600230707     C*
086700230707     C           #1ACIA    IFEQ *BLANKS
086800230707     C*
086900230707     C                     MOVEL'LZW1601' ZAMSID
087000230707     C                     MOVEL'REUSRMSG'ZAMSGF
087100230707     C                     MOVE '1'       *IN21
087200230707     C                     MOVE '1'       *IN75
087300230707     C                     EXSR SRSMSG
087400230707     C*
087500230707     C                     ELSE
087600230707     C*
087700230707     C** Test numeric
087800230707     C*
087900230707     C**********           MOVEL#1ACIA    NUM5    50                                          CGL029
088000230707     C**********           MOVELNUM5      ALP4    4                                           CGL029
088100230707     C                     MOVEL#1ACIA    NUM5   110                                          CGL029
088200230707     C                     MOVELNUM5      ALP4   10                                           CGL029
088300230707     C*
088400230707     C           ALP4      IFLE #1ACIA
088500230707     C                     MOVE '1'       *IN30
088600230707     C                     END
088700230707     C*
088800230707     C           *IN30     IFEQ '1'
088900230707     C*
089000230707     C** If field is input, access on FILE/SDACODL0
089100230707     C*
089200230707     C                     CALL 'AOACODR0'
089300230707     C                     PARM *BLANKS   @RTCD   7
089400230707     C                     PARM '*KEY    '@OPTN   7
089500230707     C**********           PARM #1ACIA    @ACOD   4                                           CGL029
089600230707     C                     PARM #1ACIA    @ACOD  10                                           CGL029
089700230707     C           SDACOD    PARM SDACOD    DSFDY
089800230707     C*
089900230707     C** If chain failed, display message for invalid  field.
090000230707     C*
090100230707     C           @RTCD     IFNE *BLANKS
090200230707     C*
090300230707     C                     MOVEL'LZW1602' ZAMSID
090400230707     C                     MOVEL'REUSRMSG'ZAMSGF
090500230707     C                     MOVE '1'       *IN21
090600230707     C                     MOVE '1'       *IN75
090700230707     C                     EXSR SRSMSG
090800230707     C                     END
090900230707     C*
091000230707     C           A5ACTY    IFEQ 'R'
091100230707     C                     MOVEL'LZW1620' ZAMSID
091200230707     C                     MOVEL'REUSRMSG'ZAMSGF
091300230707     C                     MOVE '1'       *IN21
091400230707     C                     MOVE '1'       *IN75
091500230707     C                     EXSR SRSMSG
091600230707     C                     END
091700230707     C*                                                                   062539
091800230707     C*  Check for title only accounts                                    062539
091900230707     C*                                                                   062539
092000230707     C           A5TOIN    IFEQ 'Y'                                       062539
092100230707     C                     MOVEL'WND0002' ZAMSID                          062539
092200230707     C                     MOVEL'MIDAS   'ZAMSGF                          062539
092300230707     C                     MOVE '1'       *IN21                           062539
092400230707     C                     MOVE '1'       *IN75                           062539
092500230707     C                     EXSR SRSMSG                                    062539
092600230707     C                     END                                            062539
092700230707     C*                                                                   062539
092800230707     C*  Must be Income or Expense                                        062539
092900230707     C*                                                                   062539
093000230707     C           A5ACSC    IFNE 'IN'                                      062539
093100230707     C           A5ACSC    ANDNE'EX'                                      062539
093200230707     C                     MOVEL'WND0003' ZAMSID                          062539
093300230707     C                     MOVEL'MIDAS   'ZAMSGF                          062539
093400230707     C                     MOVE '1'       *IN21                           062539
093500230707     C                     MOVE '1'       *IN75                           062539
093600230707     C                     EXSR SRSMSG                                    062539
093700230707     C                     END                                            062539
093800230707     C*
093900230707     C                     ELSE
094000230707     C                     MOVEL'LZW1602' ZAMSID
094100230707     C                     MOVEL'REUSRMSG'ZAMSGF
094200230707     C                     MOVE '1'       *IN21
094300230707     C                     MOVE '1'       *IN75
094400230707     C                     EXSR SRSMSG
094500230707     C                     END
094600230707     C*
094700230707     C                     END
094800230707     C*
094900230707     C                     ENDSR
095000230707     C/EJECT
095100230707     C****************************************************************
095200230707     C*                                                              *
095300230707     C* ACCDTS - CHECK ACCOUNT  CHARGE DATE FIELD                    *
095400230707     C*                                                              *
095500230707     C*                                                              *
095600230707     C****************************************************************
095700230707     C           ACCDTS    BEGSR
095800230707     C*
095900230707     C** Validate field
096000230707     C** If no value is entered, display message for mandatory field.
096100230707     C*
096200230707     C                     MOVE '0'       *IN22
096300230707     C                     MOVE '0'       *IN30
096400230707     C*
096500230707     C           #1ACCD    IFEQ *BLANKS
096600230707     C*
096700230707     C                     MOVEL'LZW1603' ZAMSID
096800230707     C                     MOVEL'REUSRMSG'ZAMSGF
096900230707     C                     MOVE '1'       *IN22
097000230707     C                     MOVE '1'       *IN75
097100230707     C                     EXSR SRSMSG
097200230707     C*
097300230707     C                     ELSE
097400230707     C*
097500230707     C**  Test numeric
097600230707     C*
097700230707     C                     MOVEL#1ACCD    NUM7    70
097800230707     C                     MOVELNUM7      ALP6    6
097900230707     C*
098000230707     C           ALP6      IFLE #1ACCD
098100230707     C                     MOVE '1'       *IN30
098200230707     C                     END
098300230707     C*
098400230707     C           *IN30     IFEQ '1'
098500230707     C*
098600230707     C** Load date format indicator
098700230707     C*
098800230707     C                     MOVELP1DFIN    WUDFIN  1        Date Format Ind
098900230707     C*
099000230707     C** If value is entered, check for a valid date
099100230707     C*
099200230707     C*
099300230707     C** Check Screen Date  *
099400230707     C*
099500230707     C                     MOVE #1ACCD    ZDATE   60
099600230707     C                     EXSR ZDATE1
099700230707     C*
099800230707     C** Error detected ?  Display message for invalid field  else saveen midas
099900230707     C** date
100000230707     C*
100100230707     C           *IN99     IFEQ '1'
100200230707     C                     MOVEL'LZW1604' ZAMSID
100300230707     C                     MOVEL'REUSRMSG'ZAMSGF
100400230707     C                     MOVE '1'       *IN22
100500230707     C                     MOVE '1'       *IN75
100600230707     C                     EXSR SRSMSG
100700230707     C                     ELSE
100800230707     C                     MOVE ZDAYNO    ACCDP5  50
100900230707     C                     END
101000230707     C                     ELSE
101100230707     C*
101200230707     C                     MOVEL'LZW1604' ZAMSID
101300230707     C                     MOVEL'REUSRMSG'ZAMSGF
101400230707     C                     MOVE '1'       *IN22
101500230707     C                     MOVE '1'       *IN75
101600230707     C                     EXSR SRSMSG
101700230707     C                     END
101800230707     C*
101900230707     C                     END
102000230707     C                     ENDSR
102100230707     C/EJECT
102200230707     C****************************************************************
102300230707     C*                                                              *
102400230707     C* ACCFTS - CHECK ACCOUNT CHARGE FREQUENCY                      *
102500230707     C*                                                              *
102600230707     C*                                                              *
102700230707     C****************************************************************
102800230707     C           ACCFTS    BEGSR
102900230707     C*
103000230707     C** Validate field
103100230707     C** If no value is entered, display message for mandatory field.
103200230707     C*
103300230707     C                     MOVE '0'       *IN23
103400230707     C*
103500230707     C           #1ACCF    IFEQ *BLANKS
103600230707     C*
103700230707     C                     MOVEL'LZW1605' ZAMSID
103800230707     C                     MOVEL'REUSRMSG'ZAMSGF
103900230707     C                     MOVE '1'       *IN23
104000230707     C                     MOVE '1'       *IN75
104100230707     C                     EXSR SRSMSG
104200230707     C*
104300230707     C                     ELSE
104400230707     C*
104500230707     C** If value  entered NOT  'M','Q','X','Y', display message for invalid
104600230707     C** field.
104700230707     C*
104800230707     C           #1ACCF    IFNE 'M'
104900230707     C           #1ACCF    ANDNE'Q'
105000230707     C           #1ACCF    ANDNE'X'
105100230707     C           #1ACCF    ANDNE'Y'
105200230707     C*
105300230707     C                     MOVEL'LZW1606' ZAMSID
105400230707     C                     MOVEL'REUSRMSG'ZAMSGF
105500230707     C                     MOVE '1'       *IN23
105600230707     C                     MOVE '1'       *IN75
105700230707     C                     EXSR SRSMSG
105800230707     C                     END
105900230707     C*
106000230707     C                     END
106100230707     C*
106200230707     C                     ENDSR
106300230707     C/EJECT
106400230707     C****************************************************************
106500230707     C*                                                              *
106600230707     C* ACBDTS - CHECK ACCOUNT  CHARGE BASE DATE                     *
106700230707     C*                                                              *
106800230707     C*                                                              *
106900230707     C****************************************************************
107000230707     C           ACBDTS    BEGSR
107100230707     C*
107200230707     C** Validate field
107300230707     C** If no value is entered, display message for mandatory field.
107400230707     C*
107500230707     C                     MOVE '0'       *IN24
107600230707     C                     MOVE '0'       *IN30
107700230707     C                     MOVE '0'       *IN31
107800230707     C*
107900230707     C           #1ACBD    IFEQ *BLANKS
108000230707     C*
108100230707     C                     MOVEL'LZW1607' ZAMSID
108200230707     C                     MOVEL'REUSRMSG'ZAMSGF
108300230707     C                     MOVE '1'       *IN24
108400230707     C                     MOVE '1'       *IN75
108500230707     C                     EXSR SRSMSG
108600230707     C*
108700230707     C                     ELSE
108800230707     C*
108900230707     C** If value  entered NOT  between '01'-'30' , display message for invalid
109000230707     C** field.
109100230707     C*
109200230707     C                     MOVE #1ACBD    ACBDN   20
109300230707     C*
109400230707     C**  Test numeric
109500230707     C*
109600230707     C                     MOVEL#1ACBD    NUM3    30
109700230707     C                     MOVELNUM3      ALP2    2
109800230707     C*
109900230707     C           ALP2      IFLE #1ACBD
110000230707     C                     MOVE '1'       *IN30
110100230707     C                     END
110200230707     C*
110300230707     C           *IN30     IFEQ '1'
110400230707     C*
110500230707     C**  Validation field
110600230707     C*
110700230707     C           ACBDN     IFLT 1
110800230707     C           ACBDN     ORGT 31
110900230707     C*
111000230707     C                     MOVEL'LZW1608' ZAMSID
111100230707     C                     MOVEL'REUSRMSG'ZAMSGF
111200230707     C                     MOVE '1'       *IN24
111300230707     C                     MOVE '1'       *IN75
111400230707     C                     EXSR SRSMSG
111500230707     C                     END
111600230707     C*
111700230707     C                     ELSE
111800230707     C*
111900230707     C                     MOVEL'LZW1608' ZAMSID
112000230707     C                     MOVEL'REUSRMSG'ZAMSGF
112100230707     C                     MOVE '1'       *IN24
112200230707     C                     MOVE '1'       *IN75
112300230707     C                     EXSR SRSMSG
112400230707     C                     END
112500230707     C                     END
112600230707     C*
112700230707     C                     ENDSR
112800230707     C/EJECT
112900230707     C*------------------------------------------------------------
113000230707     C* SRINZ - Routine to initialize screen fields with defaults
113100230707     C*------------------------------------------------------------
113200230707     C*
113300230707     C           SRINZ     BEGSR
113400230707     C*
113500230707     C           *IN72     IFEQ '1'
113600230707     C                     MOVE *BLANKS   #1SCIA
113700230707     C                     END
113800230707     C           *IN73     IFEQ '1'
113900230707     C                     MOVE *BLANKS   #1ACIA
114000230707     C                     MOVE *BLANKS   #1ACCD
114100230707     C                     MOVEL*BLANKS   #1ACCF
114200230707     C                     MOVE *BLANKS   #1ACBD
114300230707     C                     END
114400230707     C*
114500230707     C                     ENDSR
114600230707     C/EJECT
114700230707     C*------------------------------------------------------------
114800230707     C* SRFTOS - Routine to move file fields to screen fields
114900230707     C*------------------------------------------------------------
115000230707     C*
115100230707     C           SRFTOS    BEGSR
115200230707     C*
115300230707     C           *IN72     IFEQ '1'
115400230707     C                     MOVE RESCIA    #1SCIA
115500230707     C                     END
115600230707     C           *IN73     IFEQ '1'
115700230707     C                     MOVE REACIA    #1ACIA
115800230707     C*
115900230707     C** Convert day number to date formats
116000230707     C*
116100230707     C                     MOVE REACCD    ZDAYNO
116200230707     C                     EXSR ZDATE2
116300230707     C                     MOVE ZDATE     #1ACCD
116400230707     C*
116500230707     C                     MOVE REACCF    #1ACCF
116600230707     C                     MOVE REACBD    #1ACBD
116700230707     C                     END
116800230707     C*
116900230707     C                     ENDSR
117000230707     C/EJECT
117100230707     C*------------------------------------------------------------
117200230707     C* SRSTOF - Routine to move screen fields to file fields
117300230707     C*------------------------------------------------------------
117400230707     C*
117500230707     C           SRSTOF    BEGSR
117600230707     C*
117700230707     C** Move data fields to file fields
117800230707     C*
117900230707     C           *IN72     IFEQ '1'
118000230707     C                     MOVE #1SCIA    RESCIA
118100230707     C                     END
118200230707     C           *IN73     IFEQ '1'
118300230707     C                     MOVE #1ACIA    REACIA
118400230707     C                     MOVE ACCDP5    REACCD
118500230707     C                     MOVE #1ACCF    REACCF
118600230707     C                     MOVE #1ACBD    REACBD
118700230707     C                     END
118800230707     C                     ENDSR
118900230707     C/EJECT
119000230707     C*------------------------------------------------------------
119100230707     C* SRINIT - Routine to handle initial processing
119200230707     C*------------------------------------------------------------
119300230707     C*
119400230707     C           SRINIT    BEGSR
119500230707     C*
119600230707     C** Get parameters from calling program
119700230707     C*
119800230707     C           *ENTRY    PLIST
119900230707     C                     PARM           ACTION  1
120000230707     C                     PARM           DATA
120100230707     C                     PARM           WWRTRN  7
120200230707     C*
120300230707     C** Dummy parameters (used for non-DDS window method)
120400230707     C*
120500230707     C                     PARM           DUMMY1  30
120600230707     C                     PARM           DUMMY2  30
120700230707     C                     PARM           DUMMY3  30
120800230707     C                     PARM           DUMMY4  30
120900230707     C                     PARM           DUMMY5 10
121000230707     C*
121100230707     C** The following parameter is needed from PTF16 on.
121200230707     C** Every PTF level below should omit this parameter
121300230707     C*
121400230707     C                     PARM           SPARE 256
121500230707     C*
121600230707     C** Setup key values using transaction data passed from caller
121700230707     C*
121800230707     C*
121900230707     C** Define KLIST for file access
122000230707     C*
122100230707     C                     MOVE P1RECI    KRECI   1
122200230707     C           KLIST     KLIST
122300230707     C                     KFLD           KRECI
122400230707     C*
122500230707     C** Setup default message file for CE system
122600230707     C*
122700230707     C                     MOVEL'REUSRMSG'WWDMSF 10
122800230707     C*
122900230707     C** Data Area Rundat
123000230707     C*
123100230707     C           *NAMVAR   DEFN           RUNDAT
123101230707     C                     IN   RUNDAT                                                     AR1006692
123200230707     C*
123300230707     C**   *IN98 used in SR ZDATE1 & ZDATE 2 is set on
123400230707     C*
123500230707     C           DATF      IFEQ 'M'
123600230707     C                     MOVE '1'       *IN98
123700230707     C                     END
123800230707     C*
123900230707     C** Read TABTBRE
124000230707     C*
124100230707     C           1         SETLLTABTBRE
124200230707     C                     READ TABTBRE                  87
124300230707     C*
124400230707     C           P1STMC    IFEQ 'Y'
124500230707     C                     MOVE '1'       *IN72
124600230707     C                     END
124700230707     C           P1FACH    IFEQ 'Y'
124800230707     C                     MOVE '1'       *IN73
124900230707     C                     END
125000230707     C*
125100230707     C                     ENDSR
125200230707     C*************************************************************
125300230707     C/EJECT
125400230707     C/COPY ZSRSRC,ZDATE1Z2
125500230707     C/EJECT
125600230707     C/COPY ZSRSRC,ZDATE2Z2
125700230707     C*
125800230707** ZYDY -- YEARS IN DAYS CUMULATIVE IN FOUR YEAR SPAN
1259002307070366073110961461
126000230707** ZMDY -- MONTHS IN DAYS CUMULATIVE THROUGH YEAR
126100230707000031059090120151181212243273304334365
126200230707** ZMNM -- MONTHS SHORT NAMES
126300230707JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
126400230707**  CPY@
126500230707(c) Finastra International Limited 2001
