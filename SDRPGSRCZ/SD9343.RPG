     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas SD Get Charges for Mult Transactions')
     F********************************************************************
     F*                                                                  *
     F*  Midas  STANDING DATA
     F*                                                                  *
     F*     SD9342   - READ RETAIL DETAILS OPTIONAL FEATURES FILE        *
     F*                FOR CHARGES FOR MULTIPLE TRANSACTIONS             *
     F*                I.C.D. RECORD - ONLY ONE RECORD IN FILE           *
     F*                                                                  *
     F*     (c) Finastra International Limited 2001                      *
     F*                                                                  *
      *  Last Amend No. MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
     F*     Prev Amend No. BUG2593            Date 05May04
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*                    XXXXXX             Date DDMMMYY               *
     F*                                                                  *
     F********************************************************************
     F*                                                                  *
     F*     MD046248 - Finastra Rebranding                               *
     F*     BUG2593- INVALID DATABASE ERROR
     F*     XXXXXX - xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx         *
     F*                                                                  *
     F********************************************************************
     F*  P R O G R A M     C R E A T I O N     P A R A M E T E R S    *
     F*                                                               *
     F*                                                               *
     F********************************************************************
     F*
     F* ID F  C  H  L     FUNCTION OF INDICATORS
     F*
     F*       01       OPEN FILE - TABTBRE
     F*       90       FILE ERROR
     F*       91       OPEN ERROR
     F*       92       CLOSE ERROR
     F*       93       EMPTY FILE
     F*
     F********************************************************************
      /EJECT
     F*FSTART
      ************************************************************
     FTABTBRE IF  E           K        DISK                           UC
      * IN  - TABTBREF Retail Details Optional Features
      ************************************************************
      /EJECT
     E*ESTART
      ************************************************************
     E* Description     : Copyright notice for inclusion in all programs
     E*
     E********************************************************************
     E                    CPY@    1   1 80               Copyright     array
     E                    OVRC    1   1 75                                                   BUG2593
      ************************************************************
      /EJECT
     I*ISTART
      ************************************************************
      *
     IPGMDS      SDS
      * Program Status data structure
     I                                        1  10 PGNAME
     I                                       81  90 PGLIBR
     I                                      244 253 PGJBNM
     I                                      254 263 PGUSER
     I                                      264 2690PGJBNO
      *
     ID@FMT     E DSTABTBRE
      * TABTBREF - Retail Details Optional Features Data Record Format
     I*
     I* Description     : Copyright notice for inclusion in all programs
     I*
     IA@CPY       DS
     I* Copyright array
     I                                        1  80 CPY@
      ************************************************************
      /EJECT
     C*CSTART
      *****************************************************
     C           *ENTRY    PLIST
     C                     PARM           P@RTCD  7        B:Return code
     C                     PARM CMTR      PCMTR   1        O:Comm on Dr Turnover
      *****************************************************
      *MAIN
     C                     SETOF                     909192 ¦ Reset
     C                     SETOF                     9396   ¦ error flags
      *
      * First call - open file - read record - close file
      *
     C           *IN01     IFEQ '0'                        IF 2 FIRST TIME
     C                     SETON                     01      Set ind.
     C                     CALL 'QCMDEXC'                                                    BUG2593
     C                     PARM           OVRC                                               BUG2593
     C                     PARM 75        QCLEN  155                                         BUG2593
     C                     OPEN TABTBRE                91    Open file
     C           *IN91     CABEQ'1'       T@SKIP         LR  Open error
     C                     READ TABTBREF               9093  Read record
     C                     CLOSETABTBRE                92    Close file
     C           *IN92     CABEQ'1'       T@SKIP         LR  Close error
     C           *IN93     CABEQ'1'       T@SKIP         LR  Empty error
     C                     SETON                     LR      Set ind.
     C                     END                             FI 2
      *
      * No record found or End of file - return error code :
      *          _____________
     C           T@SKIP    TAG                             +++ SKIP +++
      *          ~~~~~~~~~~~~~
     C                     MOVE *BLANK    P@RTCD           No Errors
     C   90                MOVE '*ERROR ' P@RTCD           File error
     C   91                MOVE '*OPEN  ' P@RTCD           Open error
     C   92                MOVE '*CLOSE ' P@RTCD           Close error
     C   93                MOVE '*EMPTY ' P@RTCD           Empty file
      *
      *
      * Return to caller :
      *
     C                     RETRN
      *
      *****************************************************
      *ENDMAIN
** CPY@     : Copyright notice for inclusion in all programs
(c) Finastra International Limited 2001
** OVR                                                                                       BUG2593
OVRDBF FILE(TABTBRE) TOFILE(TABTBRE) SHARE(*NO)                                              BUG2593
